(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var Cp={exports:{}},Dc={};var wb;function UA(){if(wb)return Dc;wb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var h in a)h!=="key"&&(l[h]=a[h])}else l=a;return a=l.ref,{$$typeof:t,type:i,key:c,ref:a!==void 0?a:null,props:l}}return Dc.Fragment=e,Dc.jsx=n,Dc.jsxs=n,Dc}var Tb;function FA(){return Tb||(Tb=1,Cp.exports=UA()),Cp.exports}var d=FA(),Rp={exports:{}},qe={};var Ab;function qA(){if(Ab)return qe;Ab=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),b=Symbol.iterator;function S(V){return V===null||typeof V!="object"?null:(V=b&&V[b]||V["@@iterator"],typeof V=="function"?V:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,j={};function z(V,H,oe){this.props=V,this.context=H,this.refs=j,this.updater=oe||T}z.prototype.isReactComponent={},z.prototype.setState=function(V,H){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,H,"setState")},z.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function q(){}q.prototype=z.prototype;function U(V,H,oe){this.props=V,this.context=H,this.refs=j,this.updater=oe||T}var Z=U.prototype=new q;Z.constructor=U,C(Z,z.prototype),Z.isPureReactComponent=!0;var J=Array.isArray;function ne(){}var k={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function D(V,H,oe){var se=oe.ref;return{$$typeof:t,type:V,key:H,ref:se!==void 0?se:null,props:oe}}function P(V,H){return D(V.type,H,V.props)}function O(V){return typeof V=="object"&&V!==null&&V.$$typeof===t}function N(V){var H={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(oe){return H[oe]})}var I=/\/+/g;function K(V,H){return typeof V=="object"&&V!==null&&V.key!=null?N(""+V.key):H.toString(36)}function F(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(ne,ne):(V.status="pending",V.then(function(H){V.status==="pending"&&(V.status="fulfilled",V.value=H)},function(H){V.status==="pending"&&(V.status="rejected",V.reason=H)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function L(V,H,oe,se,te){var ge=typeof V;(ge==="undefined"||ge==="boolean")&&(V=null);var xe=!1;if(V===null)xe=!0;else switch(ge){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(V.$$typeof){case t:case e:xe=!0;break;case _:return xe=V._init,L(xe(V._payload),H,oe,se,te)}}if(xe)return te=te(V),xe=se===""?"."+K(V,0):se,J(te)?(oe="",xe!=null&&(oe=xe.replace(I,"$&/")+"/"),L(te,H,oe,"",function(he){return he})):te!=null&&(O(te)&&(te=P(te,oe+(te.key==null||V&&V.key===te.key?"":(""+te.key).replace(I,"$&/")+"/")+xe)),H.push(te)),1;xe=0;var pe=se===""?".":se+":";if(J(V))for(var Ee=0;Ee<V.length;Ee++)se=V[Ee],ge=pe+K(se,Ee),xe+=L(se,H,oe,ge,te);else if(Ee=S(V),typeof Ee=="function")for(V=Ee.call(V),Ee=0;!(se=V.next()).done;)se=se.value,ge=pe+K(se,Ee++),xe+=L(se,H,oe,ge,te);else if(ge==="object"){if(typeof V.then=="function")return L(F(V),H,oe,se,te);throw H=String(V),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return xe}function $(V,H,oe){if(V==null)return V;var se=[],te=0;return L(V,se,"","",function(ge){return H.call(oe,ge,te++)}),se}function Y(V){if(V._status===-1){var H=V._result;H=H(),H.then(function(oe){(V._status===0||V._status===-1)&&(V._status=1,V._result=oe)},function(oe){(V._status===0||V._status===-1)&&(V._status=2,V._result=oe)}),V._status===-1&&(V._status=0,V._result=H)}if(V._status===1)return V._result.default;throw V._result}var Q=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},X={map:$,forEach:function(V,H,oe){$(V,function(){H.apply(this,arguments)},oe)},count:function(V){var H=0;return $(V,function(){H++}),H},toArray:function(V){return $(V,function(H){return H})||[]},only:function(V){if(!O(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return qe.Activity=v,qe.Children=X,qe.Component=z,qe.Fragment=n,qe.Profiler=a,qe.PureComponent=U,qe.StrictMode=i,qe.Suspense=f,qe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,qe.__COMPILER_RUNTIME={__proto__:null,c:function(V){return k.H.useMemoCache(V)}},qe.cache=function(V){return function(){return V.apply(null,arguments)}},qe.cacheSignal=function(){return null},qe.cloneElement=function(V,H,oe){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var se=C({},V.props),te=V.key;if(H!=null)for(ge in H.key!==void 0&&(te=""+H.key),H)!A.call(H,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&H.ref===void 0||(se[ge]=H[ge]);var ge=arguments.length-2;if(ge===1)se.children=oe;else if(1<ge){for(var xe=Array(ge),pe=0;pe<ge;pe++)xe[pe]=arguments[pe+2];se.children=xe}return D(V.type,te,se)},qe.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:l,_context:V},V},qe.createElement=function(V,H,oe){var se,te={},ge=null;if(H!=null)for(se in H.key!==void 0&&(ge=""+H.key),H)A.call(H,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(te[se]=H[se]);var xe=arguments.length-2;if(xe===1)te.children=oe;else if(1<xe){for(var pe=Array(xe),Ee=0;Ee<xe;Ee++)pe[Ee]=arguments[Ee+2];te.children=pe}if(V&&V.defaultProps)for(se in xe=V.defaultProps,xe)te[se]===void 0&&(te[se]=xe[se]);return D(V,ge,te)},qe.createRef=function(){return{current:null}},qe.forwardRef=function(V){return{$$typeof:h,render:V}},qe.isValidElement=O,qe.lazy=function(V){return{$$typeof:_,_payload:{_status:-1,_result:V},_init:Y}},qe.memo=function(V,H){return{$$typeof:p,type:V,compare:H===void 0?null:H}},qe.startTransition=function(V){var H=k.T,oe={};k.T=oe;try{var se=V(),te=k.S;te!==null&&te(oe,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(ne,Q)}catch(ge){Q(ge)}finally{H!==null&&oe.types!==null&&(H.types=oe.types),k.T=H}},qe.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},qe.use=function(V){return k.H.use(V)},qe.useActionState=function(V,H,oe){return k.H.useActionState(V,H,oe)},qe.useCallback=function(V,H){return k.H.useCallback(V,H)},qe.useContext=function(V){return k.H.useContext(V)},qe.useDebugValue=function(){},qe.useDeferredValue=function(V,H){return k.H.useDeferredValue(V,H)},qe.useEffect=function(V,H){return k.H.useEffect(V,H)},qe.useEffectEvent=function(V){return k.H.useEffectEvent(V)},qe.useId=function(){return k.H.useId()},qe.useImperativeHandle=function(V,H,oe){return k.H.useImperativeHandle(V,H,oe)},qe.useInsertionEffect=function(V,H){return k.H.useInsertionEffect(V,H)},qe.useLayoutEffect=function(V,H){return k.H.useLayoutEffect(V,H)},qe.useMemo=function(V,H){return k.H.useMemo(V,H)},qe.useOptimistic=function(V,H){return k.H.useOptimistic(V,H)},qe.useReducer=function(V,H,oe){return k.H.useReducer(V,H,oe)},qe.useRef=function(V){return k.H.useRef(V)},qe.useState=function(V){return k.H.useState(V)},qe.useSyncExternalStore=function(V,H,oe){return k.H.useSyncExternalStore(V,H,oe)},qe.useTransition=function(){return k.H.useTransition()},qe.version="19.2.3",qe}var Cb;function Fg(){return Cb||(Cb=1,Rp.exports=qA()),Rp.exports}var R=Fg(),Dp={exports:{}},Ic={},Ip={exports:{}},jp={};var Rb;function HA(){return Rb||(Rb=1,(function(t){function e(L,$){var Y=L.length;L.push($);e:for(;0<Y;){var Q=Y-1>>>1,X=L[Q];if(0<a(X,$))L[Q]=$,L[Y]=X,Y=Q;else break e}}function n(L){return L.length===0?null:L[0]}function i(L){if(L.length===0)return null;var $=L[0],Y=L.pop();if(Y!==$){L[0]=Y;e:for(var Q=0,X=L.length,V=X>>>1;Q<V;){var H=2*(Q+1)-1,oe=L[H],se=H+1,te=L[se];if(0>a(oe,Y))se<X&&0>a(te,oe)?(L[Q]=te,L[se]=Y,Q=se):(L[Q]=oe,L[H]=Y,Q=H);else if(se<X&&0>a(te,Y))L[Q]=te,L[se]=Y,Q=se;else break e}}return $}function a(L,$){var Y=L.sortIndex-$.sortIndex;return Y!==0?Y:L.id-$.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,h=c.now();t.unstable_now=function(){return c.now()-h}}var f=[],p=[],_=1,v=null,b=3,S=!1,T=!1,C=!1,j=!1,z=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;function Z(L){for(var $=n(p);$!==null;){if($.callback===null)i(p);else if($.startTime<=L)i(p),$.sortIndex=$.expirationTime,e(f,$);else break;$=n(p)}}function J(L){if(C=!1,Z(L),!T)if(n(f)!==null)T=!0,ne||(ne=!0,N());else{var $=n(p);$!==null&&F(J,$.startTime-L)}}var ne=!1,k=-1,A=5,D=-1;function P(){return j?!0:!(t.unstable_now()-D<A)}function O(){if(j=!1,ne){var L=t.unstable_now();D=L;var $=!0;try{e:{T=!1,C&&(C=!1,q(k),k=-1),S=!0;var Y=b;try{t:{for(Z(L),v=n(f);v!==null&&!(v.expirationTime>L&&P());){var Q=v.callback;if(typeof Q=="function"){v.callback=null,b=v.priorityLevel;var X=Q(v.expirationTime<=L);if(L=t.unstable_now(),typeof X=="function"){v.callback=X,Z(L),$=!0;break t}v===n(f)&&i(f),Z(L)}else i(f);v=n(f)}if(v!==null)$=!0;else{var V=n(p);V!==null&&F(J,V.startTime-L),$=!1}}break e}finally{v=null,b=Y,S=!1}$=void 0}}finally{$?N():ne=!1}}}var N;if(typeof U=="function")N=function(){U(O)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,K=I.port2;I.port1.onmessage=O,N=function(){K.postMessage(null)}}else N=function(){z(O,0)};function F(L,$){k=z(function(){L(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_next=function(L){switch(b){case 1:case 2:case 3:var $=3;break;default:$=b}var Y=b;b=$;try{return L()}finally{b=Y}},t.unstable_requestPaint=function(){j=!0},t.unstable_runWithPriority=function(L,$){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var Y=b;b=L;try{return $()}finally{b=Y}},t.unstable_scheduleCallback=function(L,$,Y){var Q=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?Q+Y:Q):Y=Q,L){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=Y+X,L={id:_++,callback:$,priorityLevel:L,startTime:Y,expirationTime:X,sortIndex:-1},Y>Q?(L.sortIndex=Y,e(p,L),n(f)===null&&L===n(p)&&(C?(q(k),k=-1):C=!0,F(J,Y-Q))):(L.sortIndex=X,e(f,L),T||S||(T=!0,ne||(ne=!0,N()))),L},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(L){var $=b;return function(){var Y=b;b=$;try{return L.apply(this,arguments)}finally{b=Y}}}})(jp)),jp}var Db;function GA(){return Db||(Db=1,Ip.exports=HA()),Ip.exports}var kp={exports:{}},wn={};var Ib;function QA(){if(Ib)return wn;Ib=1;var t=Fg();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(f,p,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:f,containerInfo:p,implementation:_}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,wn.createPortal=function(f,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return l(f,p,null,_)},wn.flushSync=function(f){var p=c.T,_=i.p;try{if(c.T=null,i.p=2,f)return f()}finally{c.T=p,i.p=_,i.d.f()}},wn.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(f,p))},wn.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},wn.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var _=p.as,v=h(_,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,S=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;_==="style"?i.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:S}):_==="script"&&i.d.X(f,{crossOrigin:v,integrity:b,fetchPriority:S,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},wn.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var _=h(p.as,p.crossOrigin);i.d.M(f,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(f)},wn.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var _=p.as,v=h(_,p.crossOrigin);i.d.L(f,_,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},wn.preloadModule=function(f,p){if(typeof f=="string")if(p){var _=h(p.as,p.crossOrigin);i.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(f)},wn.requestFormReset=function(f){i.d.r(f)},wn.unstable_batchedUpdates=function(f,p){return f(p)},wn.useFormState=function(f,p,_){return c.H.useFormState(f,p,_)},wn.useFormStatus=function(){return c.H.useHostTransitionStatus()},wn.version="19.2.3",wn}var jb;function $A(){if(jb)return kp.exports;jb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),kp.exports=QA(),kp.exports}var kb;function KA(){if(kb)return Ic;kb=1;var t=GA(),e=Fg(),n=$A();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var s=r,o=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(o=s.return),r=s.return;while(r)}return s.tag===3?o:null}function c(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function h(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function f(r){if(l(r)!==r)throw Error(i(188))}function p(r){var s=r.alternate;if(!s){if(s=l(r),s===null)throw Error(i(188));return s!==r?null:r}for(var o=r,u=s;;){var g=o.return;if(g===null)break;var y=g.alternate;if(y===null){if(u=g.return,u!==null){o=u;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===o)return f(g),r;if(y===u)return f(g),s;y=y.sibling}throw Error(i(188))}if(o.return!==u.return)o=g,u=y;else{for(var E=!1,M=g.child;M;){if(M===o){E=!0,o=g,u=y;break}if(M===u){E=!0,u=g,o=y;break}M=M.sibling}if(!E){for(M=y.child;M;){if(M===o){E=!0,o=y,u=g;break}if(M===u){E=!0,u=y,o=g;break}M=M.sibling}if(!E)throw Error(i(189))}}if(o.alternate!==u)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?r:s}function _(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=_(r),s!==null)return s;r=r.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),q=Symbol.for("react.consumer"),U=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),ne=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function N(r){return r===null||typeof r!="object"?null:(r=O&&r[O]||r["@@iterator"],typeof r=="function"?r:null)}var I=Symbol.for("react.client.reference");function K(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===I?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case C:return"Fragment";case z:return"Profiler";case j:return"StrictMode";case J:return"Suspense";case ne:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case T:return"Portal";case U:return r.displayName||"Context";case q:return(r._context.displayName||"Context")+".Consumer";case Z:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case k:return s=r.displayName||null,s!==null?s:K(r.type)||"Memo";case A:s=r._payload,r=r._init;try{return K(r(s))}catch{}}return null}var F=Array.isArray,L=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y={pending:!1,data:null,method:null,action:null},Q=[],X=-1;function V(r){return{current:r}}function H(r){0>X||(r.current=Q[X],Q[X]=null,X--)}function oe(r,s){X++,Q[X]=r.current,r.current=s}var se=V(null),te=V(null),ge=V(null),xe=V(null);function pe(r,s){switch(oe(ge,s),oe(te,r),oe(se,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?$v(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=$v(s),r=Kv(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}H(se),oe(se,r)}function Ee(){H(se),H(te),H(ge)}function he(r){r.memoizedState!==null&&oe(xe,r);var s=se.current,o=Kv(s,r.type);s!==o&&(oe(te,r),oe(se,o))}function Re(r){te.current===r&&(H(se),H(te)),xe.current===r&&(H(xe),Tc._currentValue=Y)}var De,vt;function Ie(r){if(De===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);De=s&&s[1]||"",vt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+De+r+vt}var ze=!1;function Je(r,s){if(!r||ze)return"";ze=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(de){var ce=de}Reflect.construct(r,[],_e)}else{try{_e.call()}catch(de){ce=de}r.call(_e.prototype)}}else{try{throw Error()}catch(de){ce=de}(_e=r())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(de){if(de&&ce&&typeof de.stack=="string")return[de.stack,ce.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),E=y[0],M=y[1];if(E&&M){var G=E.split(`
`),ae=M.split(`
`);for(g=u=0;u<G.length&&!G[u].includes("DetermineComponentFrameRoot");)u++;for(;g<ae.length&&!ae[g].includes("DetermineComponentFrameRoot");)g++;if(u===G.length||g===ae.length)for(u=G.length-1,g=ae.length-1;1<=u&&0<=g&&G[u]!==ae[g];)g--;for(;1<=u&&0<=g;u--,g--)if(G[u]!==ae[g]){if(u!==1||g!==1)do if(u--,g--,0>g||G[u]!==ae[g]){var me=`
`+G[u].replace(" at new "," at ");return r.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",r.displayName)),me}while(1<=u&&0<=g);break}}}finally{ze=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?Ie(o):""}function Ct(r,s){switch(r.tag){case 26:case 27:case 5:return Ie(r.type);case 16:return Ie("Lazy");case 13:return r.child!==s&&s!==null?Ie("Suspense Fallback"):Ie("Suspense");case 19:return Ie("SuspenseList");case 0:case 15:return Je(r.type,!1);case 11:return Je(r.type.render,!1);case 1:return Je(r.type,!0);case 31:return Ie("Activity");default:return""}}function Ke(r){try{var s="",o=null;do s+=Ct(r,o),o=r,r=r.return;while(r);return s}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Ue=Object.prototype.hasOwnProperty,lt=t.unstable_scheduleCallback,Mt=t.unstable_cancelCallback,fn=t.unstable_shouldYield,Dn=t.unstable_requestPaint,nn=t.unstable_now,Zs=t.unstable_getCurrentPriorityLevel,Rl=t.unstable_ImmediatePriority,Dl=t.unstable_UserBlockingPriority,Wi=t.unstable_NormalPriority,If=t.unstable_LowPriority,Eu=t.unstable_IdlePriority,Su=t.log,wu=t.unstable_setDisableYieldValue,vr=null,mn=null;function rr(r){if(typeof Su=="function"&&wu(r),mn&&typeof mn.setStrictMode=="function")try{mn.setStrictMode(vr,r)}catch{}}var Lt=Math.clz32?Math.clz32:Au,Tu=Math.log,qa=Math.LN2;function Au(r){return r>>>=0,r===0?32:31-(Tu(r)/qa|0)|0}var Vr=256,ea=262144,Ht=4194304;function Br(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function zr(r,s,o){var u=r.pendingLanes;if(u===0)return 0;var g=0,y=r.suspendedLanes,E=r.pingedLanes;r=r.warmLanes;var M=u&134217727;return M!==0?(u=M&~y,u!==0?g=Br(u):(E&=M,E!==0?g=Br(E):o||(o=M&~r,o!==0&&(g=Br(o))))):(M=u&~y,M!==0?g=Br(M):E!==0?g=Br(E):o||(o=u&~r,o!==0&&(g=Br(o)))),g===0?0:s!==0&&s!==g&&(s&y)===0&&(y=g&-g,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:g}function br(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function jf(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cu(){var r=Ht;return Ht<<=1,(Ht&62914560)===0&&(Ht=4194304),r}function Ur(r){for(var s=[],o=0;31>o;o++)s.push(r);return s}function ta(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function kf(r,s,o,u,g,y){var E=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var M=r.entanglements,G=r.expirationTimes,ae=r.hiddenUpdates;for(o=E&~o;0<o;){var me=31-Lt(o),_e=1<<me;M[me]=0,G[me]=-1;var ce=ae[me];if(ce!==null)for(ae[me]=null,me=0;me<ce.length;me++){var de=ce[me];de!==null&&(de.lane&=-536870913)}o&=~_e}u!==0&&na(r,u,0),y!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=y&~(E&~s))}function na(r,s,o){r.pendingLanes|=s,r.suspendedLanes&=~s;var u=31-Lt(s);r.entangledLanes|=s,r.entanglements[u]=r.entanglements[u]|1073741824|o&261930}function Il(r,s){var o=r.entangledLanes|=s;for(r=r.entanglements;o;){var u=31-Lt(o),g=1<<u;g&s|r[u]&s&&(r[u]|=s),o&=~g}}function jl(r,s){var o=s&-s;return o=(o&42)!==0?1:ra(o),(o&(r.suspendedLanes|s))!==0?0:o}function ra(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function yi(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Ru(){var r=$.p;return r!==0?r:(r=window.event,r===void 0?32:yb(r.type))}function xr(r,s){var o=$.p;try{return $.p=r,s()}finally{$.p=o}}var Er=Math.random().toString(36).slice(2),Gt="__reactFiber$"+Er,ln="__reactProps$"+Er,Fr="__reactContainer$"+Er,Ha="__reactEvents$"+Er,Of="__reactListeners$"+Er,Du="__reactHandles$"+Er,Iu="__reactResources$"+Er,qr="__reactMarker$"+Er;function Ga(r){delete r[Gt],delete r[ln],delete r[Ha],delete r[Of],delete r[Du]}function Hr(r){var s=r[Gt];if(s)return s;for(var o=r.parentNode;o;){if(s=o[Fr]||o[Gt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(r=tb(r);r!==null;){if(o=r[Gt])return o;r=tb(r)}return s}r=o,o=r.parentNode}return null}function ir(r){if(r=r[Gt]||r[Fr]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function Gn(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function Gr(r){var s=r[Iu];return s||(s=r[Iu]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Qt(r){r[qr]=!0}var kl=new Set,Ol={};function Qr(r,s){$r(r,s),$r(r+"Capture",s)}function $r(r,s){for(Ol[r]=s,r=0;r<s.length;r++)kl.add(s[r])}var Ml=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nl={},Pl={};function ju(r){return Ue.call(Pl,r)?!0:Ue.call(Nl,r)?!1:Ml.test(r)?Pl[r]=!0:(Nl[r]=!0,!1)}function Qa(r,s,o){if(ju(s))if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+o)}}function Qn(r,s,o){if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+o)}}function $t(r,s,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(s,o,""+u)}}function cn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Yi(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ll(r,s,o){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,y=u.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return g.call(this)},set:function(E){o=""+E,y.call(this,E)}}),Object.defineProperty(r,s,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function ht(r){if(!r._valueTracker){var s=Yi(r)?"checked":"value";r._valueTracker=Ll(r,s,""+r[s])}}function ia(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var o=s.getValue(),u="";return r&&(u=Yi(r)?r.checked?"true":"false":r.value),r=u,r!==o?(s.setValue(r),!0):!1}function Kr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var sa=/[\n"\\]/g;function On(r){return r.replace(sa,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function $a(r,s,o,u,g,y,E,M){r.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?r.type=E:r.removeAttribute("type"),s!=null?E==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+cn(s)):r.value!==""+cn(s)&&(r.value=""+cn(s)):E!=="submit"&&E!=="reset"||r.removeAttribute("value"),s!=null?Vl(r,E,cn(s)):o!=null?Vl(r,E,cn(o)):u!=null&&r.removeAttribute("value"),g==null&&y!=null&&(r.defaultChecked=!!y),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?r.name=""+cn(M):r.removeAttribute("name")}function ku(r,s,o,u,g,y,E,M){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ht(r);return}o=o!=null?""+cn(o):"",s=s!=null?""+cn(s):o,M||s===r.value||(r.value=s),r.defaultValue=s}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=M?r.checked:!!u,r.defaultChecked=!!u,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.name=E),ht(r)}function Vl(r,s,o){s==="number"&&Kr(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function Xi(r,s,o,u){if(r=r.options,s){s={};for(var g=0;g<o.length;g++)s["$"+o[g]]=!0;for(o=0;o<r.length;o++)g=s.hasOwnProperty("$"+r[o].value),r[o].selected!==g&&(r[o].selected=g),g&&u&&(r[o].defaultSelected=!0)}else{for(o=""+cn(o),s=null,g=0;g<r.length;g++){if(r[g].value===o){r[g].selected=!0,u&&(r[g].defaultSelected=!0);return}s!==null||r[g].disabled||(s=r[g])}s!==null&&(s.selected=!0)}}function Ou(r,s,o){if(s!=null&&(s=""+cn(s),s!==r.value&&(r.value=s),o==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=o!=null?""+cn(o):""}function Ji(r,s,o,u){if(s==null){if(u!=null){if(o!=null)throw Error(i(92));if(F(u)){if(1<u.length)throw Error(i(93));u=u[0]}o=u}o==null&&(o=""),s=o}o=cn(s),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u),ht(r)}function Mn(r,s){if(s){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=s;return}}r.textContent=s}var Mu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Bl(r,s,o){var u=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":u?r.setProperty(s,o):typeof o!="number"||o===0||Mu.has(s)?s==="float"?r.cssFloat=o:r[s]=(""+o).trim():r[s]=o+"px"}function zl(r,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var g in s)u=s[g],s.hasOwnProperty(g)&&o[g]!==u&&Bl(r,g,u)}else for(var y in s)s.hasOwnProperty(y)&&Bl(r,y,s[y])}function Ka(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Wa(r){return Zi.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Sr(){}var Ul=null;function sr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var es=null,Wr=null;function aa(r){var s=ir(r);if(s&&(r=s.stateNode)){var o=r[ln]||null;e:switch(r=s.stateNode,s.type){case"input":if($a(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+On(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var u=o[s];if(u!==r&&u.form===r.form){var g=u[ln]||null;if(!g)throw Error(i(90));$a(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<o.length;s++)u=o[s],u.form===r.form&&ia(u)}break e;case"textarea":Ou(r,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&Xi(r,!!o.multiple,s,!1)}}}var Ya=!1;function ts(r,s,o){if(Ya)return r(s,o);Ya=!0;try{var u=r(s);return u}finally{if(Ya=!1,(es!==null||Wr!==null)&&(Rd(),es&&(s=es,r=Wr,Wr=es=null,aa(s),r)))for(s=0;s<r.length;s++)aa(r[s])}}function wr(r,s){var o=r.stateNode;if(o===null)return null;var u=o[ln]||null;if(u===null)return null;o=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var ar=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),oa=!1;if(ar)try{var pt={};Object.defineProperty(pt,"passive",{get:function(){oa=!0}}),window.addEventListener("test",pt,pt),window.removeEventListener("test",pt,pt)}catch{oa=!1}var Yr=null,Fl=null,la=null;function ql(){if(la)return la;var r,s=Fl,o=s.length,u,g="value"in Yr?Yr.value:Yr.textContent,y=g.length;for(r=0;r<o&&s[r]===g[r];r++);var E=o-r;for(u=1;u<=E&&s[o-u]===g[y-u];u++);return la=g.slice(r,1<u?1-u:void 0)}function ca(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function _i(){return!0}function Tr(){return!1}function pn(r){function s(o,u,g,y,E){this._reactName=o,this._targetInst=g,this.type=u,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var M in r)r.hasOwnProperty(M)&&(o=r[M],this[M]=o?o(y):y[M]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?_i:Tr,this.isPropagationStopped=Tr,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=_i)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=_i)},persist:function(){},isPersistent:_i}),s}var vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xr=pn(vi),ns=v({},vi,{view:0,detail:0}),Hl=pn(ns),rs,Xa,Jr,Ja=v({},ns,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:is,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Jr&&(Jr&&r.type==="mousemove"?(rs=r.screenX-Jr.screenX,Xa=r.screenY-Jr.screenY):Xa=rs=0,Jr=r),rs)},movementY:function(r){return"movementY"in r?r.movementY:Xa}}),Gl=pn(Ja),ua=v({},Ja,{dataTransfer:0}),Pu=pn(ua),Lu=v({},ns,{relatedTarget:0}),da=pn(Lu),Ql=v({},vi,{animationName:0,elapsedTime:0,pseudoElement:0}),Vu=pn(Ql),Za=v({},vi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Bu=pn(Za),zu=v({},vi,{data:0}),Zr=pn(zu),Uu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hu(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=qu[r])?!!s[r]:!1}function is(){return Hu}var In=v({},ns,{key:function(r){if(r.key){var s=Uu[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=ca(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Fu[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:is,charCode:function(r){return r.type==="keypress"?ca(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ca(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Gu=pn(In),Qu=v({},Ja,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bi=pn(Qu),m=v({},ns,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:is}),x=pn(m),w=v({},vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),B=pn(w),re=v({},Ja,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),ue=pn(re),Se=v({},vi,{newState:0,oldState:0}),Ge=pn(Se),Vt=[9,13,27,32],ct=ar&&"CompositionEvent"in window,Rt=null;ar&&"documentMode"in document&&(Rt=document.documentMode);var or=ar&&"TextEvent"in window&&!Rt,ei=ar&&(!ct||Rt&&8<Rt&&11>=Rt),Ar=" ",Cr=!1;function ha(r,s){switch(r){case"keyup":return Vt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eo(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var to=!1;function dT(r,s){switch(r){case"compositionend":return eo(s);case"keypress":return s.which!==32?null:(Cr=!0,Ar);case"textInput":return r=s.data,r===Ar&&Cr?null:r;default:return null}}function hT(r,s){if(to)return r==="compositionend"||!ct&&ha(r,s)?(r=ql(),la=Fl=Yr=null,to=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ei&&s.locale!=="ko"?null:s.data;default:return null}}var fT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function i_(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!fT[r.type]:s==="textarea"}function s_(r,s,o,u){es?Wr?Wr.push(u):Wr=[u]:es=u,s=Nd(s,"onChange"),0<s.length&&(o=new Xr("onChange","change",null,o,u),r.push({event:o,listeners:s}))}var $l=null,Kl=null;function mT(r){Uv(r,0)}function $u(r){var s=Gn(r);if(ia(s))return r}function a_(r,s){if(r==="change")return s}var o_=!1;if(ar){var Mf;if(ar){var Nf="oninput"in document;if(!Nf){var l_=document.createElement("div");l_.setAttribute("oninput","return;"),Nf=typeof l_.oninput=="function"}Mf=Nf}else Mf=!1;o_=Mf&&(!document.documentMode||9<document.documentMode)}function c_(){$l&&($l.detachEvent("onpropertychange",u_),Kl=$l=null)}function u_(r){if(r.propertyName==="value"&&$u(Kl)){var s=[];s_(s,Kl,r,sr(r)),ts(mT,s)}}function pT(r,s,o){r==="focusin"?(c_(),$l=s,Kl=o,$l.attachEvent("onpropertychange",u_)):r==="focusout"&&c_()}function gT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return $u(Kl)}function yT(r,s){if(r==="click")return $u(s)}function _T(r,s){if(r==="input"||r==="change")return $u(s)}function vT(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var $n=typeof Object.is=="function"?Object.is:vT;function Wl(r,s){if($n(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var o=Object.keys(r),u=Object.keys(s);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var g=o[u];if(!Ue.call(s,g)||!$n(r[g],s[g]))return!1}return!0}function d_(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function h_(r,s){var o=d_(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=s&&u>=s)return{node:o,offset:s-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=d_(o)}}function f_(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?f_(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function m_(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=Kr(r.document);s instanceof r.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)r=s.contentWindow;else break;s=Kr(r.document)}return s}function Pf(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var bT=ar&&"documentMode"in document&&11>=document.documentMode,no=null,Lf=null,Yl=null,Vf=!1;function p_(r,s,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Vf||no==null||no!==Kr(u)||(u=no,"selectionStart"in u&&Pf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Yl&&Wl(Yl,u)||(Yl=u,u=Nd(Lf,"onSelect"),0<u.length&&(s=new Xr("onSelect","select",null,s,o),r.push({event:s,listeners:u}),s.target=no)))}function fa(r,s){var o={};return o[r.toLowerCase()]=s.toLowerCase(),o["Webkit"+r]="webkit"+s,o["Moz"+r]="moz"+s,o}var ro={animationend:fa("Animation","AnimationEnd"),animationiteration:fa("Animation","AnimationIteration"),animationstart:fa("Animation","AnimationStart"),transitionrun:fa("Transition","TransitionRun"),transitionstart:fa("Transition","TransitionStart"),transitioncancel:fa("Transition","TransitionCancel"),transitionend:fa("Transition","TransitionEnd")},Bf={},g_={};ar&&(g_=document.createElement("div").style,"AnimationEvent"in window||(delete ro.animationend.animation,delete ro.animationiteration.animation,delete ro.animationstart.animation),"TransitionEvent"in window||delete ro.transitionend.transition);function ma(r){if(Bf[r])return Bf[r];if(!ro[r])return r;var s=ro[r],o;for(o in s)if(s.hasOwnProperty(o)&&o in g_)return Bf[r]=s[o];return r}var y_=ma("animationend"),__=ma("animationiteration"),v_=ma("animationstart"),xT=ma("transitionrun"),ET=ma("transitionstart"),ST=ma("transitioncancel"),b_=ma("transitionend"),x_=new Map,zf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");zf.push("scrollEnd");function Rr(r,s){x_.set(r,s),Qr(s,[r])}var Ku=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},lr=[],io=0,Uf=0;function Wu(){for(var r=io,s=Uf=io=0;s<r;){var o=lr[s];lr[s++]=null;var u=lr[s];lr[s++]=null;var g=lr[s];lr[s++]=null;var y=lr[s];if(lr[s++]=null,u!==null&&g!==null){var E=u.pending;E===null?g.next=g:(g.next=E.next,E.next=g),u.pending=g}y!==0&&E_(o,g,y)}}function Yu(r,s,o,u){lr[io++]=r,lr[io++]=s,lr[io++]=o,lr[io++]=u,Uf|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function Ff(r,s,o,u){return Yu(r,s,o,u),Xu(r)}function pa(r,s){return Yu(r,null,null,s),Xu(r)}function E_(r,s,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var g=!1,y=r.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(g=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,g&&s!==null&&(g=31-Lt(o),r=y.hiddenUpdates,u=r[g],u===null?r[g]=[s]:u.push(s),s.lane=o|536870912),y):null}function Xu(r){if(50<_c)throw _c=0,Xm=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var so={};function wT(r,s,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kn(r,s,o,u){return new wT(r,s,o,u)}function qf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function xi(r,s){var o=r.alternate;return o===null?(o=Kn(r.tag,s,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=s,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,s=r.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function S_(r,s){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,s=o.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function Ju(r,s,o,u,g,y){var E=0;if(u=r,typeof r=="function")qf(r)&&(E=1);else if(typeof r=="string")E=DA(r,o,se.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case D:return r=Kn(31,o,s,g),r.elementType=D,r.lanes=y,r;case C:return ga(o.children,g,y,s);case j:E=8,g|=24;break;case z:return r=Kn(12,o,s,g|2),r.elementType=z,r.lanes=y,r;case J:return r=Kn(13,o,s,g),r.elementType=J,r.lanes=y,r;case ne:return r=Kn(19,o,s,g),r.elementType=ne,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case U:E=10;break e;case q:E=9;break e;case Z:E=11;break e;case k:E=14;break e;case A:E=16,u=null;break e}E=29,o=Error(i(130,r===null?"null":typeof r,"")),u=null}return s=Kn(E,o,s,g),s.elementType=r,s.type=u,s.lanes=y,s}function ga(r,s,o,u){return r=Kn(7,r,u,s),r.lanes=o,r}function Hf(r,s,o){return r=Kn(6,r,null,s),r.lanes=o,r}function w_(r){var s=Kn(18,null,null,0);return s.stateNode=r,s}function Gf(r,s,o){return s=Kn(4,r.children!==null?r.children:[],r.key,s),s.lanes=o,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var T_=new WeakMap;function cr(r,s){if(typeof r=="object"&&r!==null){var o=T_.get(r);return o!==void 0?o:(s={value:r,source:s,stack:Ke(s)},T_.set(r,s),s)}return{value:r,source:s,stack:Ke(s)}}var ao=[],oo=0,Zu=null,Xl=0,ur=[],dr=0,ss=null,ti=1,ni="";function Ei(r,s){ao[oo++]=Xl,ao[oo++]=Zu,Zu=r,Xl=s}function A_(r,s,o){ur[dr++]=ti,ur[dr++]=ni,ur[dr++]=ss,ss=r;var u=ti;r=ni;var g=32-Lt(u)-1;u&=~(1<<g),o+=1;var y=32-Lt(s)+g;if(30<y){var E=g-g%5;y=(u&(1<<E)-1).toString(32),u>>=E,g-=E,ti=1<<32-Lt(s)+g|o<<g|u,ni=y+r}else ti=1<<y|o<<g|u,ni=r}function Qf(r){r.return!==null&&(Ei(r,1),A_(r,1,0))}function $f(r){for(;r===Zu;)Zu=ao[--oo],ao[oo]=null,Xl=ao[--oo],ao[oo]=null;for(;r===ss;)ss=ur[--dr],ur[dr]=null,ni=ur[--dr],ur[dr]=null,ti=ur[--dr],ur[dr]=null}function C_(r,s){ur[dr++]=ti,ur[dr++]=ni,ur[dr++]=ss,ti=s.id,ni=s.overflow,ss=r}var gn=null,St=null,it=!1,as=null,hr=!1,Kf=Error(i(519));function os(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Jl(cr(s,r)),Kf}function R_(r){var s=r.stateNode,o=r.type,u=r.memoizedProps;switch(s[Gt]=r,s[ln]=u,o){case"dialog":Ye("cancel",s),Ye("close",s);break;case"iframe":case"object":case"embed":Ye("load",s);break;case"video":case"audio":for(o=0;o<bc.length;o++)Ye(bc[o],s);break;case"source":Ye("error",s);break;case"img":case"image":case"link":Ye("error",s),Ye("load",s);break;case"details":Ye("toggle",s);break;case"input":Ye("invalid",s),ku(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ye("invalid",s);break;case"textarea":Ye("invalid",s),Ji(s,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||u.suppressHydrationWarning===!0||Gv(s.textContent,o)?(u.popover!=null&&(Ye("beforetoggle",s),Ye("toggle",s)),u.onScroll!=null&&Ye("scroll",s),u.onScrollEnd!=null&&Ye("scrollend",s),u.onClick!=null&&(s.onclick=Sr),s=!0):s=!1,s||os(r,!0)}function D_(r){for(gn=r.return;gn;)switch(gn.tag){case 5:case 31:case 13:hr=!1;return;case 27:case 3:hr=!0;return;default:gn=gn.return}}function lo(r){if(r!==gn)return!1;if(!it)return D_(r),it=!0,!1;var s=r.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||hp(r.type,r.memoizedProps)),o=!o),o&&St&&os(r),D_(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));St=eb(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));St=eb(r)}else s===27?(s=St,xs(r.type)?(r=yp,yp=null,St=r):St=s):St=gn?mr(r.stateNode.nextSibling):null;return!0}function ya(){St=gn=null,it=!1}function Wf(){var r=as;return r!==null&&(Vn===null?Vn=r:Vn.push.apply(Vn,r),as=null),r}function Jl(r){as===null?as=[r]:as.push(r)}var Yf=V(null),_a=null,Si=null;function ls(r,s,o){oe(Yf,s._currentValue),s._currentValue=o}function wi(r){r._currentValue=Yf.current,H(Yf)}function Xf(r,s,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),r===o)break;r=r.return}}function Jf(r,s,o,u){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var y=g.dependencies;if(y!==null){var E=g.child;y=y.firstContext;e:for(;y!==null;){var M=y;y=g;for(var G=0;G<s.length;G++)if(M.context===s[G]){y.lanes|=o,M=y.alternate,M!==null&&(M.lanes|=o),Xf(y.return,o,r),u||(E=null);break e}y=M.next}}else if(g.tag===18){if(E=g.return,E===null)throw Error(i(341));E.lanes|=o,y=E.alternate,y!==null&&(y.lanes|=o),Xf(E,o,r),E=null}else E=g.child;if(E!==null)E.return=g;else for(E=g;E!==null;){if(E===r){E=null;break}if(g=E.sibling,g!==null){g.return=E.return,E=g;break}E=E.return}g=E}}function co(r,s,o,u){r=null;for(var g=s,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var E=g.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var M=g.type;$n(g.pendingProps.value,E.value)||(r!==null?r.push(M):r=[M])}}else if(g===xe.current){if(E=g.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(Tc):r=[Tc])}g=g.return}r!==null&&Jf(s,r,o,u),s.flags|=262144}function ed(r){for(r=r.firstContext;r!==null;){if(!$n(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function va(r){_a=r,Si=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function yn(r){return I_(_a,r)}function td(r,s){return _a===null&&va(r),I_(r,s)}function I_(r,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Si===null){if(r===null)throw Error(i(308));Si=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else Si=Si.next=s;return o}var TT=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){s.aborted=!0,r.forEach(function(o){return o()})}},AT=t.unstable_scheduleCallback,CT=t.unstable_NormalPriority,Kt={$$typeof:U,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zf(){return{controller:new TT,data:new Map,refCount:0}}function Zl(r){r.refCount--,r.refCount===0&&AT(CT,function(){r.controller.abort()})}var ec=null,em=0,uo=0,ho=null;function RT(r,s){if(ec===null){var o=ec=[];em=0,uo=rp(),ho={status:"pending",value:void 0,then:function(u){o.push(u)}}}return em++,s.then(j_,j_),s}function j_(){if(--em===0&&ec!==null){ho!==null&&(ho.status="fulfilled");var r=ec;ec=null,uo=0,ho=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function DT(r,s){var o=[],u={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return r.then(function(){u.status="fulfilled",u.value=s;for(var g=0;g<o.length;g++)(0,o[g])(s)},function(g){for(u.status="rejected",u.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),u}var k_=L.S;L.S=function(r,s){pv=nn(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&RT(r,s),k_!==null&&k_(r,s)};var ba=V(null);function tm(){var r=ba.current;return r!==null?r:bt.pooledCache}function nd(r,s){s===null?oe(ba,ba.current):oe(ba,s.pool)}function O_(){var r=tm();return r===null?null:{parent:Kt._currentValue,pool:r}}var fo=Error(i(460)),nm=Error(i(474)),rd=Error(i(542)),id={then:function(){}};function M_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function N_(r,s,o){switch(o=r[o],o===void 0?r.push(s):o!==s&&(s.then(Sr,Sr),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,L_(r),r;default:if(typeof s.status=="string")s.then(Sr,Sr);else{if(r=bt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(u){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=u}},function(u){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,L_(r),r}throw Ea=s,fo}}function xa(r){try{var s=r._init;return s(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ea=o,fo):o}}var Ea=null;function P_(){if(Ea===null)throw Error(i(459));var r=Ea;return Ea=null,r}function L_(r){if(r===fo||r===rd)throw Error(i(483))}var mo=null,tc=0;function sd(r){var s=tc;return tc+=1,mo===null&&(mo=[]),N_(mo,r,s)}function nc(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function ad(r,s){throw s.$$typeof===b?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function V_(r){function s(ee,W){if(r){var ie=ee.deletions;ie===null?(ee.deletions=[W],ee.flags|=16):ie.push(W)}}function o(ee,W){if(!r)return null;for(;W!==null;)s(ee,W),W=W.sibling;return null}function u(ee){for(var W=new Map;ee!==null;)ee.key!==null?W.set(ee.key,ee):W.set(ee.index,ee),ee=ee.sibling;return W}function g(ee,W){return ee=xi(ee,W),ee.index=0,ee.sibling=null,ee}function y(ee,W,ie){return ee.index=ie,r?(ie=ee.alternate,ie!==null?(ie=ie.index,ie<W?(ee.flags|=67108866,W):ie):(ee.flags|=67108866,W)):(ee.flags|=1048576,W)}function E(ee){return r&&ee.alternate===null&&(ee.flags|=67108866),ee}function M(ee,W,ie,ye){return W===null||W.tag!==6?(W=Hf(ie,ee.mode,ye),W.return=ee,W):(W=g(W,ie),W.return=ee,W)}function G(ee,W,ie,ye){var Me=ie.type;return Me===C?me(ee,W,ie.props.children,ye,ie.key):W!==null&&(W.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===A&&xa(Me)===W.type)?(W=g(W,ie.props),nc(W,ie),W.return=ee,W):(W=Ju(ie.type,ie.key,ie.props,null,ee.mode,ye),nc(W,ie),W.return=ee,W)}function ae(ee,W,ie,ye){return W===null||W.tag!==4||W.stateNode.containerInfo!==ie.containerInfo||W.stateNode.implementation!==ie.implementation?(W=Gf(ie,ee.mode,ye),W.return=ee,W):(W=g(W,ie.children||[]),W.return=ee,W)}function me(ee,W,ie,ye,Me){return W===null||W.tag!==7?(W=ga(ie,ee.mode,ye,Me),W.return=ee,W):(W=g(W,ie),W.return=ee,W)}function _e(ee,W,ie){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Hf(""+W,ee.mode,ie),W.return=ee,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case S:return ie=Ju(W.type,W.key,W.props,null,ee.mode,ie),nc(ie,W),ie.return=ee,ie;case T:return W=Gf(W,ee.mode,ie),W.return=ee,W;case A:return W=xa(W),_e(ee,W,ie)}if(F(W)||N(W))return W=ga(W,ee.mode,ie,null),W.return=ee,W;if(typeof W.then=="function")return _e(ee,sd(W),ie);if(W.$$typeof===U)return _e(ee,td(ee,W),ie);ad(ee,W)}return null}function ce(ee,W,ie,ye){var Me=W!==null?W.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Me!==null?null:M(ee,W,""+ie,ye);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case S:return ie.key===Me?G(ee,W,ie,ye):null;case T:return ie.key===Me?ae(ee,W,ie,ye):null;case A:return ie=xa(ie),ce(ee,W,ie,ye)}if(F(ie)||N(ie))return Me!==null?null:me(ee,W,ie,ye,null);if(typeof ie.then=="function")return ce(ee,W,sd(ie),ye);if(ie.$$typeof===U)return ce(ee,W,td(ee,ie),ye);ad(ee,ie)}return null}function de(ee,W,ie,ye,Me){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ee=ee.get(ie)||null,M(W,ee,""+ye,Me);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case S:return ee=ee.get(ye.key===null?ie:ye.key)||null,G(W,ee,ye,Me);case T:return ee=ee.get(ye.key===null?ie:ye.key)||null,ae(W,ee,ye,Me);case A:return ye=xa(ye),de(ee,W,ie,ye,Me)}if(F(ye)||N(ye))return ee=ee.get(ie)||null,me(W,ee,ye,Me,null);if(typeof ye.then=="function")return de(ee,W,ie,sd(ye),Me);if(ye.$$typeof===U)return de(ee,W,ie,td(W,ye),Me);ad(W,ye)}return null}function Ce(ee,W,ie,ye){for(var Me=null,at=null,je=W,$e=W=0,et=null;je!==null&&$e<ie.length;$e++){je.index>$e?(et=je,je=null):et=je.sibling;var ot=ce(ee,je,ie[$e],ye);if(ot===null){je===null&&(je=et);break}r&&je&&ot.alternate===null&&s(ee,je),W=y(ot,W,$e),at===null?Me=ot:at.sibling=ot,at=ot,je=et}if($e===ie.length)return o(ee,je),it&&Ei(ee,$e),Me;if(je===null){for(;$e<ie.length;$e++)je=_e(ee,ie[$e],ye),je!==null&&(W=y(je,W,$e),at===null?Me=je:at.sibling=je,at=je);return it&&Ei(ee,$e),Me}for(je=u(je);$e<ie.length;$e++)et=de(je,ee,$e,ie[$e],ye),et!==null&&(r&&et.alternate!==null&&je.delete(et.key===null?$e:et.key),W=y(et,W,$e),at===null?Me=et:at.sibling=et,at=et);return r&&je.forEach(function(As){return s(ee,As)}),it&&Ei(ee,$e),Me}function Pe(ee,W,ie,ye){if(ie==null)throw Error(i(151));for(var Me=null,at=null,je=W,$e=W=0,et=null,ot=ie.next();je!==null&&!ot.done;$e++,ot=ie.next()){je.index>$e?(et=je,je=null):et=je.sibling;var As=ce(ee,je,ot.value,ye);if(As===null){je===null&&(je=et);break}r&&je&&As.alternate===null&&s(ee,je),W=y(As,W,$e),at===null?Me=As:at.sibling=As,at=As,je=et}if(ot.done)return o(ee,je),it&&Ei(ee,$e),Me;if(je===null){for(;!ot.done;$e++,ot=ie.next())ot=_e(ee,ot.value,ye),ot!==null&&(W=y(ot,W,$e),at===null?Me=ot:at.sibling=ot,at=ot);return it&&Ei(ee,$e),Me}for(je=u(je);!ot.done;$e++,ot=ie.next())ot=de(je,ee,$e,ot.value,ye),ot!==null&&(r&&ot.alternate!==null&&je.delete(ot.key===null?$e:ot.key),W=y(ot,W,$e),at===null?Me=ot:at.sibling=ot,at=ot);return r&&je.forEach(function(zA){return s(ee,zA)}),it&&Ei(ee,$e),Me}function _t(ee,W,ie,ye){if(typeof ie=="object"&&ie!==null&&ie.type===C&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case S:e:{for(var Me=ie.key;W!==null;){if(W.key===Me){if(Me=ie.type,Me===C){if(W.tag===7){o(ee,W.sibling),ye=g(W,ie.props.children),ye.return=ee,ee=ye;break e}}else if(W.elementType===Me||typeof Me=="object"&&Me!==null&&Me.$$typeof===A&&xa(Me)===W.type){o(ee,W.sibling),ye=g(W,ie.props),nc(ye,ie),ye.return=ee,ee=ye;break e}o(ee,W);break}else s(ee,W);W=W.sibling}ie.type===C?(ye=ga(ie.props.children,ee.mode,ye,ie.key),ye.return=ee,ee=ye):(ye=Ju(ie.type,ie.key,ie.props,null,ee.mode,ye),nc(ye,ie),ye.return=ee,ee=ye)}return E(ee);case T:e:{for(Me=ie.key;W!==null;){if(W.key===Me)if(W.tag===4&&W.stateNode.containerInfo===ie.containerInfo&&W.stateNode.implementation===ie.implementation){o(ee,W.sibling),ye=g(W,ie.children||[]),ye.return=ee,ee=ye;break e}else{o(ee,W);break}else s(ee,W);W=W.sibling}ye=Gf(ie,ee.mode,ye),ye.return=ee,ee=ye}return E(ee);case A:return ie=xa(ie),_t(ee,W,ie,ye)}if(F(ie))return Ce(ee,W,ie,ye);if(N(ie)){if(Me=N(ie),typeof Me!="function")throw Error(i(150));return ie=Me.call(ie),Pe(ee,W,ie,ye)}if(typeof ie.then=="function")return _t(ee,W,sd(ie),ye);if(ie.$$typeof===U)return _t(ee,W,td(ee,ie),ye);ad(ee,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,W!==null&&W.tag===6?(o(ee,W.sibling),ye=g(W,ie),ye.return=ee,ee=ye):(o(ee,W),ye=Hf(ie,ee.mode,ye),ye.return=ee,ee=ye),E(ee)):o(ee,W)}return function(ee,W,ie,ye){try{tc=0;var Me=_t(ee,W,ie,ye);return mo=null,Me}catch(je){if(je===fo||je===rd)throw je;var at=Kn(29,je,null,ee.mode);return at.lanes=ye,at.return=ee,at}}}var Sa=V_(!0),B_=V_(!1),cs=!1;function rm(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function im(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function us(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ds(r,s,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(ut&2)!==0){var g=u.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),u.pending=s,s=Xu(r),E_(r,null,o),s}return Yu(r,u,s,o),Xu(r)}function rc(r,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var u=s.lanes;u&=r.pendingLanes,o|=u,s.lanes=o,Il(r,o)}}function sm(r,s){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var g=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?g=y=E:y=y.next=E,o=o.next}while(o!==null);y===null?g=y=s:y=y.next=s}else g=y=s;o={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=s:r.next=s,o.lastBaseUpdate=s}var am=!1;function ic(){if(am){var r=ho;if(r!==null)throw r}}function sc(r,s,o,u){am=!1;var g=r.updateQueue;cs=!1;var y=g.firstBaseUpdate,E=g.lastBaseUpdate,M=g.shared.pending;if(M!==null){g.shared.pending=null;var G=M,ae=G.next;G.next=null,E===null?y=ae:E.next=ae,E=G;var me=r.alternate;me!==null&&(me=me.updateQueue,M=me.lastBaseUpdate,M!==E&&(M===null?me.firstBaseUpdate=ae:M.next=ae,me.lastBaseUpdate=G))}if(y!==null){var _e=g.baseState;E=0,me=ae=G=null,M=y;do{var ce=M.lane&-536870913,de=ce!==M.lane;if(de?(Ze&ce)===ce:(u&ce)===ce){ce!==0&&ce===uo&&(am=!0),me!==null&&(me=me.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var Ce=r,Pe=M;ce=s;var _t=o;switch(Pe.tag){case 1:if(Ce=Pe.payload,typeof Ce=="function"){_e=Ce.call(_t,_e,ce);break e}_e=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=Pe.payload,ce=typeof Ce=="function"?Ce.call(_t,_e,ce):Ce,ce==null)break e;_e=v({},_e,ce);break e;case 2:cs=!0}}ce=M.callback,ce!==null&&(r.flags|=64,de&&(r.flags|=8192),de=g.callbacks,de===null?g.callbacks=[ce]:de.push(ce))}else de={lane:ce,tag:M.tag,payload:M.payload,callback:M.callback,next:null},me===null?(ae=me=de,G=_e):me=me.next=de,E|=ce;if(M=M.next,M===null){if(M=g.shared.pending,M===null)break;de=M,M=de.next,de.next=null,g.lastBaseUpdate=de,g.shared.pending=null}}while(!0);me===null&&(G=_e),g.baseState=G,g.firstBaseUpdate=ae,g.lastBaseUpdate=me,y===null&&(g.shared.lanes=0),gs|=E,r.lanes=E,r.memoizedState=_e}}function z_(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function U_(r,s){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)z_(o[r],s)}var po=V(null),od=V(0);function F_(r,s){r=Oi,oe(od,r),oe(po,s),Oi=r|s.baseLanes}function om(){oe(od,Oi),oe(po,po.current)}function lm(){Oi=od.current,H(po),H(od)}var Wn=V(null),fr=null;function hs(r){var s=r.alternate;oe(Bt,Bt.current&1),oe(Wn,r),fr===null&&(s===null||po.current!==null||s.memoizedState!==null)&&(fr=r)}function cm(r){oe(Bt,Bt.current),oe(Wn,r),fr===null&&(fr=r)}function q_(r){r.tag===22?(oe(Bt,Bt.current),oe(Wn,r),fr===null&&(fr=r)):fs()}function fs(){oe(Bt,Bt.current),oe(Wn,Wn.current)}function Yn(r){H(Wn),fr===r&&(fr=null),H(Bt)}var Bt=V(0);function ld(r){for(var s=r;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||pp(o)||gp(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ti=0,Qe=null,gt=null,Wt=null,cd=!1,go=!1,wa=!1,ud=0,ac=0,yo=null,IT=0;function Nt(){throw Error(i(321))}function um(r,s){if(s===null)return!1;for(var o=0;o<s.length&&o<r.length;o++)if(!$n(r[o],s[o]))return!1;return!0}function dm(r,s,o,u,g,y){return Ti=y,Qe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,L.H=r===null||r.memoizedState===null?A0:Am,wa=!1,y=o(u,g),wa=!1,go&&(y=G_(s,o,u,g)),H_(r),y}function H_(r){L.H=cc;var s=gt!==null&&gt.next!==null;if(Ti=0,Wt=gt=Qe=null,cd=!1,ac=0,yo=null,s)throw Error(i(300));r===null||Yt||(r=r.dependencies,r!==null&&ed(r)&&(Yt=!0))}function G_(r,s,o,u){Qe=r;var g=0;do{if(go&&(yo=null),ac=0,go=!1,25<=g)throw Error(i(301));if(g+=1,Wt=gt=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}L.H=C0,y=s(o,u)}while(go);return y}function jT(){var r=L.H,s=r.useState()[0];return s=typeof s.then=="function"?oc(s):s,r=r.useState()[0],(gt!==null?gt.memoizedState:null)!==r&&(Qe.flags|=1024),s}function hm(){var r=ud!==0;return ud=0,r}function fm(r,s,o){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~o}function mm(r){if(cd){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}cd=!1}Ti=0,Wt=gt=Qe=null,go=!1,ac=ud=0,yo=null}function jn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?Qe.memoizedState=Wt=r:Wt=Wt.next=r,Wt}function zt(){if(gt===null){var r=Qe.alternate;r=r!==null?r.memoizedState:null}else r=gt.next;var s=Wt===null?Qe.memoizedState:Wt.next;if(s!==null)Wt=s,gt=r;else{if(r===null)throw Qe.alternate===null?Error(i(467)):Error(i(310));gt=r,r={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},Wt===null?Qe.memoizedState=Wt=r:Wt=Wt.next=r}return Wt}function dd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function oc(r){var s=ac;return ac+=1,yo===null&&(yo=[]),r=N_(yo,r,s),s=Qe,(Wt===null?s.memoizedState:Wt.next)===null&&(s=s.alternate,L.H=s===null||s.memoizedState===null?A0:Am),r}function hd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return oc(r);if(r.$$typeof===U)return yn(r)}throw Error(i(438,String(r)))}function pm(r){var s=null,o=Qe.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var u=Qe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=dd(),Qe.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(r),u=0;u<r;u++)o[u]=P;return s.index++,o}function Ai(r,s){return typeof s=="function"?s(r):s}function fd(r){var s=zt();return gm(s,gt,r)}function gm(r,s,o){var u=r.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=o;var g=r.baseQueue,y=u.pending;if(y!==null){if(g!==null){var E=g.next;g.next=y.next,y.next=E}s.baseQueue=g=y,u.pending=null}if(y=r.baseState,g===null)r.memoizedState=y;else{s=g.next;var M=E=null,G=null,ae=s,me=!1;do{var _e=ae.lane&-536870913;if(_e!==ae.lane?(Ze&_e)===_e:(Ti&_e)===_e){var ce=ae.revertLane;if(ce===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),_e===uo&&(me=!0);else if((Ti&ce)===ce){ae=ae.next,ce===uo&&(me=!0);continue}else _e={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},G===null?(M=G=_e,E=y):G=G.next=_e,Qe.lanes|=ce,gs|=ce;_e=ae.action,wa&&o(y,_e),y=ae.hasEagerState?ae.eagerState:o(y,_e)}else ce={lane:_e,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},G===null?(M=G=ce,E=y):G=G.next=ce,Qe.lanes|=_e,gs|=_e;ae=ae.next}while(ae!==null&&ae!==s);if(G===null?E=y:G.next=M,!$n(y,r.memoizedState)&&(Yt=!0,me&&(o=ho,o!==null)))throw o;r.memoizedState=y,r.baseState=E,r.baseQueue=G,u.lastRenderedState=y}return g===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function ym(r){var s=zt(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var u=o.dispatch,g=o.pending,y=s.memoizedState;if(g!==null){o.pending=null;var E=g=g.next;do y=r(y,E.action),E=E.next;while(E!==g);$n(y,s.memoizedState)||(Yt=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,u]}function Q_(r,s,o){var u=Qe,g=zt(),y=it;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var E=!$n((gt||g).memoizedState,o);if(E&&(g.memoizedState=o,Yt=!0),g=g.queue,bm(W_.bind(null,u,g,r),[r]),g.getSnapshot!==s||E||Wt!==null&&Wt.memoizedState.tag&1){if(u.flags|=2048,_o(9,{destroy:void 0},K_.bind(null,u,g,o,s),null),bt===null)throw Error(i(349));y||(Ti&127)!==0||$_(u,s,o)}return o}function $_(r,s,o){r.flags|=16384,r={getSnapshot:s,value:o},s=Qe.updateQueue,s===null?(s=dd(),Qe.updateQueue=s,s.stores=[r]):(o=s.stores,o===null?s.stores=[r]:o.push(r))}function K_(r,s,o,u){s.value=o,s.getSnapshot=u,Y_(s)&&X_(r)}function W_(r,s,o){return o(function(){Y_(s)&&X_(r)})}function Y_(r){var s=r.getSnapshot;r=r.value;try{var o=s();return!$n(r,o)}catch{return!0}}function X_(r){var s=pa(r,2);s!==null&&Bn(s,r,2)}function _m(r){var s=jn();if(typeof r=="function"){var o=r;if(r=o(),wa){rr(!0);try{o()}finally{rr(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:r},s}function J_(r,s,o,u){return r.baseState=o,gm(r,gt,typeof u=="function"?u:Ai)}function kT(r,s,o,u,g){if(gd(r))throw Error(i(485));if(r=s.action,r!==null){var y={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){y.listeners.push(E)}};L.T!==null?o(!0):y.isTransition=!1,u(y),o=s.pending,o===null?(y.next=s.pending=y,Z_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function Z_(r,s){var o=s.action,u=s.payload,g=r.state;if(s.isTransition){var y=L.T,E={};L.T=E;try{var M=o(g,u),G=L.S;G!==null&&G(E,M),e0(r,s,M)}catch(ae){vm(r,s,ae)}finally{y!==null&&E.types!==null&&(y.types=E.types),L.T=y}}else try{y=o(g,u),e0(r,s,y)}catch(ae){vm(r,s,ae)}}function e0(r,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){t0(r,s,u)},function(u){return vm(r,s,u)}):t0(r,s,o)}function t0(r,s,o){s.status="fulfilled",s.value=o,n0(s),r.state=o,s=r.pending,s!==null&&(o=s.next,o===s?r.pending=null:(o=o.next,s.next=o,Z_(r,o)))}function vm(r,s,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=o,n0(s),s=s.next;while(s!==u)}r.action=null}function n0(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function r0(r,s){return s}function i0(r,s){if(it){var o=bt.formState;if(o!==null){e:{var u=Qe;if(it){if(St){t:{for(var g=St,y=hr;g.nodeType!==8;){if(!y){g=null;break t}if(g=mr(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){St=mr(g.nextSibling),u=g.data==="F!";break e}}os(u)}u=!1}u&&(s=o[0])}}return o=jn(),o.memoizedState=o.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r0,lastRenderedState:s},o.queue=u,o=S0.bind(null,Qe,u),u.dispatch=o,u=_m(!1),y=Tm.bind(null,Qe,!1,u.queue),u=jn(),g={state:s,dispatch:null,action:r,pending:null},u.queue=g,o=kT.bind(null,Qe,g,y,o),g.dispatch=o,u.memoizedState=r,[s,o,!1]}function s0(r){var s=zt();return a0(s,gt,r)}function a0(r,s,o){if(s=gm(r,s,r0)[0],r=fd(Ai)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var u=oc(s)}catch(E){throw E===fo?rd:E}else u=s;s=zt();var g=s.queue,y=g.dispatch;return o!==s.memoizedState&&(Qe.flags|=2048,_o(9,{destroy:void 0},OT.bind(null,g,o),null)),[u,y,r]}function OT(r,s){r.action=s}function o0(r){var s=zt(),o=gt;if(o!==null)return a0(s,o,r);zt(),s=s.memoizedState,o=zt();var u=o.queue.dispatch;return o.memoizedState=r,[s,u,!1]}function _o(r,s,o,u){return r={tag:r,create:o,deps:u,inst:s,next:null},s=Qe.updateQueue,s===null&&(s=dd(),Qe.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,s.lastEffect=r),r}function l0(){return zt().memoizedState}function md(r,s,o,u){var g=jn();Qe.flags|=r,g.memoizedState=_o(1|s,{destroy:void 0},o,u===void 0?null:u)}function pd(r,s,o,u){var g=zt();u=u===void 0?null:u;var y=g.memoizedState.inst;gt!==null&&u!==null&&um(u,gt.memoizedState.deps)?g.memoizedState=_o(s,y,o,u):(Qe.flags|=r,g.memoizedState=_o(1|s,y,o,u))}function c0(r,s){md(8390656,8,r,s)}function bm(r,s){pd(2048,8,r,s)}function MT(r){Qe.flags|=4;var s=Qe.updateQueue;if(s===null)s=dd(),Qe.updateQueue=s,s.events=[r];else{var o=s.events;o===null?s.events=[r]:o.push(r)}}function u0(r){var s=zt().memoizedState;return MT({ref:s,nextImpl:r}),function(){if((ut&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function d0(r,s){return pd(4,2,r,s)}function h0(r,s){return pd(4,4,r,s)}function f0(r,s){if(typeof s=="function"){r=r();var o=s(r);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function m0(r,s,o){o=o!=null?o.concat([r]):null,pd(4,4,f0.bind(null,s,r),o)}function xm(){}function p0(r,s){var o=zt();s=s===void 0?null:s;var u=o.memoizedState;return s!==null&&um(s,u[1])?u[0]:(o.memoizedState=[r,s],r)}function g0(r,s){var o=zt();s=s===void 0?null:s;var u=o.memoizedState;if(s!==null&&um(s,u[1]))return u[0];if(u=r(),wa){rr(!0);try{r()}finally{rr(!1)}}return o.memoizedState=[u,s],u}function Em(r,s,o){return o===void 0||(Ti&1073741824)!==0&&(Ze&261930)===0?r.memoizedState=s:(r.memoizedState=o,r=yv(),Qe.lanes|=r,gs|=r,o)}function y0(r,s,o,u){return $n(o,s)?o:po.current!==null?(r=Em(r,o,u),$n(r,s)||(Yt=!0),r):(Ti&42)===0||(Ti&1073741824)!==0&&(Ze&261930)===0?(Yt=!0,r.memoizedState=o):(r=yv(),Qe.lanes|=r,gs|=r,s)}function _0(r,s,o,u,g){var y=$.p;$.p=y!==0&&8>y?y:8;var E=L.T,M={};L.T=M,Tm(r,!1,s,o);try{var G=g(),ae=L.S;if(ae!==null&&ae(M,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var me=DT(G,u);lc(r,s,me,Zn(r))}else lc(r,s,u,Zn(r))}catch(_e){lc(r,s,{then:function(){},status:"rejected",reason:_e},Zn())}finally{$.p=y,E!==null&&M.types!==null&&(E.types=M.types),L.T=E}}function NT(){}function Sm(r,s,o,u){if(r.tag!==5)throw Error(i(476));var g=v0(r).queue;_0(r,g,s,Y,o===null?NT:function(){return b0(r),o(u)})}function v0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:Y},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:o},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function b0(r){var s=v0(r);s.next===null&&(s=r.alternate.memoizedState),lc(r,s.next.queue,{},Zn())}function wm(){return yn(Tc)}function x0(){return zt().memoizedState}function E0(){return zt().memoizedState}function PT(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var o=Zn();r=us(o);var u=ds(s,r,o);u!==null&&(Bn(u,s,o),rc(u,s,o)),s={cache:Zf()},r.payload=s;return}s=s.return}}function LT(r,s,o){var u=Zn();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},gd(r)?w0(s,o):(o=Ff(r,s,o,u),o!==null&&(Bn(o,r,u),T0(o,s,u)))}function S0(r,s,o){var u=Zn();lc(r,s,o,u)}function lc(r,s,o,u){var g={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(gd(r))w0(s,g);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var E=s.lastRenderedState,M=y(E,o);if(g.hasEagerState=!0,g.eagerState=M,$n(M,E))return Yu(r,s,g,0),bt===null&&Wu(),!1}catch{}if(o=Ff(r,s,g,u),o!==null)return Bn(o,r,u),T0(o,s,u),!0}return!1}function Tm(r,s,o,u){if(u={lane:2,revertLane:rp(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},gd(r)){if(s)throw Error(i(479))}else s=Ff(r,o,u,2),s!==null&&Bn(s,r,2)}function gd(r){var s=r.alternate;return r===Qe||s!==null&&s===Qe}function w0(r,s){go=cd=!0;var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}function T0(r,s,o){if((o&4194048)!==0){var u=s.lanes;u&=r.pendingLanes,o|=u,s.lanes=o,Il(r,o)}}var cc={readContext:yn,use:hd,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useLayoutEffect:Nt,useInsertionEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useSyncExternalStore:Nt,useId:Nt,useHostTransitionStatus:Nt,useFormState:Nt,useActionState:Nt,useOptimistic:Nt,useMemoCache:Nt,useCacheRefresh:Nt};cc.useEffectEvent=Nt;var A0={readContext:yn,use:hd,useCallback:function(r,s){return jn().memoizedState=[r,s===void 0?null:s],r},useContext:yn,useEffect:c0,useImperativeHandle:function(r,s,o){o=o!=null?o.concat([r]):null,md(4194308,4,f0.bind(null,s,r),o)},useLayoutEffect:function(r,s){return md(4194308,4,r,s)},useInsertionEffect:function(r,s){md(4,2,r,s)},useMemo:function(r,s){var o=jn();s=s===void 0?null:s;var u=r();if(wa){rr(!0);try{r()}finally{rr(!1)}}return o.memoizedState=[u,s],u},useReducer:function(r,s,o){var u=jn();if(o!==void 0){var g=o(s);if(wa){rr(!0);try{o(s)}finally{rr(!1)}}}else g=s;return u.memoizedState=u.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},u.queue=r,r=r.dispatch=LT.bind(null,Qe,r),[u.memoizedState,r]},useRef:function(r){var s=jn();return r={current:r},s.memoizedState=r},useState:function(r){r=_m(r);var s=r.queue,o=S0.bind(null,Qe,s);return s.dispatch=o,[r.memoizedState,o]},useDebugValue:xm,useDeferredValue:function(r,s){var o=jn();return Em(o,r,s)},useTransition:function(){var r=_m(!1);return r=_0.bind(null,Qe,r.queue,!0,!1),jn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,o){var u=Qe,g=jn();if(it){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),bt===null)throw Error(i(349));(Ze&127)!==0||$_(u,s,o)}g.memoizedState=o;var y={value:o,getSnapshot:s};return g.queue=y,c0(W_.bind(null,u,y,r),[r]),u.flags|=2048,_o(9,{destroy:void 0},K_.bind(null,u,y,o,s),null),o},useId:function(){var r=jn(),s=bt.identifierPrefix;if(it){var o=ni,u=ti;o=(u&~(1<<32-Lt(u)-1)).toString(32)+o,s="_"+s+"R_"+o,o=ud++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=IT++,s="_"+s+"r_"+o.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:wm,useFormState:i0,useActionState:i0,useOptimistic:function(r){var s=jn();s.memoizedState=s.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=Tm.bind(null,Qe,!0,o),o.dispatch=s,[r,s]},useMemoCache:pm,useCacheRefresh:function(){return jn().memoizedState=PT.bind(null,Qe)},useEffectEvent:function(r){var s=jn(),o={impl:r};return s.memoizedState=o,function(){if((ut&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},Am={readContext:yn,use:hd,useCallback:p0,useContext:yn,useEffect:bm,useImperativeHandle:m0,useInsertionEffect:d0,useLayoutEffect:h0,useMemo:g0,useReducer:fd,useRef:l0,useState:function(){return fd(Ai)},useDebugValue:xm,useDeferredValue:function(r,s){var o=zt();return y0(o,gt.memoizedState,r,s)},useTransition:function(){var r=fd(Ai)[0],s=zt().memoizedState;return[typeof r=="boolean"?r:oc(r),s]},useSyncExternalStore:Q_,useId:x0,useHostTransitionStatus:wm,useFormState:s0,useActionState:s0,useOptimistic:function(r,s){var o=zt();return J_(o,gt,r,s)},useMemoCache:pm,useCacheRefresh:E0};Am.useEffectEvent=u0;var C0={readContext:yn,use:hd,useCallback:p0,useContext:yn,useEffect:bm,useImperativeHandle:m0,useInsertionEffect:d0,useLayoutEffect:h0,useMemo:g0,useReducer:ym,useRef:l0,useState:function(){return ym(Ai)},useDebugValue:xm,useDeferredValue:function(r,s){var o=zt();return gt===null?Em(o,r,s):y0(o,gt.memoizedState,r,s)},useTransition:function(){var r=ym(Ai)[0],s=zt().memoizedState;return[typeof r=="boolean"?r:oc(r),s]},useSyncExternalStore:Q_,useId:x0,useHostTransitionStatus:wm,useFormState:o0,useActionState:o0,useOptimistic:function(r,s){var o=zt();return gt!==null?J_(o,gt,r,s):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:pm,useCacheRefresh:E0};C0.useEffectEvent=u0;function Cm(r,s,o,u){s=r.memoizedState,o=o(u,s),o=o==null?s:v({},s,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var Rm={enqueueSetState:function(r,s,o){r=r._reactInternals;var u=Zn(),g=us(u);g.payload=s,o!=null&&(g.callback=o),s=ds(r,g,u),s!==null&&(Bn(s,r,u),rc(s,r,u))},enqueueReplaceState:function(r,s,o){r=r._reactInternals;var u=Zn(),g=us(u);g.tag=1,g.payload=s,o!=null&&(g.callback=o),s=ds(r,g,u),s!==null&&(Bn(s,r,u),rc(s,r,u))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var o=Zn(),u=us(o);u.tag=2,s!=null&&(u.callback=s),s=ds(r,u,o),s!==null&&(Bn(s,r,o),rc(s,r,o))}};function R0(r,s,o,u,g,y,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,y,E):s.prototype&&s.prototype.isPureReactComponent?!Wl(o,u)||!Wl(g,y):!0}function D0(r,s,o,u){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,u),s.state!==r&&Rm.enqueueReplaceState(s,s.state,null)}function Ta(r,s){var o=s;if("ref"in s){o={};for(var u in s)u!=="ref"&&(o[u]=s[u])}if(r=r.defaultProps){o===s&&(o=v({},o));for(var g in r)o[g]===void 0&&(o[g]=r[g])}return o}function I0(r){Ku(r)}function j0(r){console.error(r)}function k0(r){Ku(r)}function yd(r,s){try{var o=r.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function O0(r,s,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Dm(r,s,o){return o=us(o),o.tag=3,o.payload={element:null},o.callback=function(){yd(r,s)},o}function M0(r){return r=us(r),r.tag=3,r}function N0(r,s,o,u){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;r.payload=function(){return g(y)},r.callback=function(){O0(s,o,u)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(r.callback=function(){O0(s,o,u),typeof g!="function"&&(ys===null?ys=new Set([this]):ys.add(this));var M=u.stack;this.componentDidCatch(u.value,{componentStack:M!==null?M:""})})}function VT(r,s,o,u,g){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=o.alternate,s!==null&&co(s,o,g,!0),o=Wn.current,o!==null){switch(o.tag){case 31:case 13:return fr===null?Dd():o.alternate===null&&Pt===0&&(Pt=3),o.flags&=-257,o.flags|=65536,o.lanes=g,u===id?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([u]):s.add(u),ep(r,u,g)),!1;case 22:return o.flags|=65536,u===id?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([u]):o.add(u)),ep(r,u,g)),!1}throw Error(i(435,o.tag))}return ep(r,u,g),Dd(),!1}if(it)return s=Wn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,u!==Kf&&(r=Error(i(422),{cause:u}),Jl(cr(r,o)))):(u!==Kf&&(s=Error(i(423),{cause:u}),Jl(cr(s,o))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,u=cr(u,o),g=Dm(r.stateNode,u,g),sm(r,g),Pt!==4&&(Pt=2)),!1;var y=Error(i(520),{cause:u});if(y=cr(y,o),yc===null?yc=[y]:yc.push(y),Pt!==4&&(Pt=2),s===null)return!0;u=cr(u,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,r=g&-g,o.lanes|=r,r=Dm(o.stateNode,u,r),sm(o,r),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ys===null||!ys.has(y))))return o.flags|=65536,g&=-g,o.lanes|=g,g=M0(g),N0(g,r,o,u),sm(o,g),!1}o=o.return}while(o!==null);return!1}var Im=Error(i(461)),Yt=!1;function _n(r,s,o,u){s.child=r===null?B_(s,null,o,u):Sa(s,r.child,o,u)}function P0(r,s,o,u,g){o=o.render;var y=s.ref;if("ref"in u){var E={};for(var M in u)M!=="ref"&&(E[M]=u[M])}else E=u;return va(s),u=dm(r,s,o,E,y,g),M=hm(),r!==null&&!Yt?(fm(r,s,g),Ci(r,s,g)):(it&&M&&Qf(s),s.flags|=1,_n(r,s,u,g),s.child)}function L0(r,s,o,u,g){if(r===null){var y=o.type;return typeof y=="function"&&!qf(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,V0(r,s,y,u,g)):(r=Ju(o.type,null,u,s,s.mode,g),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,!Vm(r,g)){var E=y.memoizedProps;if(o=o.compare,o=o!==null?o:Wl,o(E,u)&&r.ref===s.ref)return Ci(r,s,g)}return s.flags|=1,r=xi(y,u),r.ref=s.ref,r.return=s,s.child=r}function V0(r,s,o,u,g){if(r!==null){var y=r.memoizedProps;if(Wl(y,u)&&r.ref===s.ref)if(Yt=!1,s.pendingProps=u=y,Vm(r,g))(r.flags&131072)!==0&&(Yt=!0);else return s.lanes=r.lanes,Ci(r,s,g)}return jm(r,s,o,u,g)}function B0(r,s,o,u){var g=u.children,y=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(u=s.child=r.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~y}else u=0,s.child=null;return z0(r,s,y,o,u)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&nd(s,y!==null?y.cachePool:null),y!==null?F_(s,y):om(),q_(s);else return u=s.lanes=536870912,z0(r,s,y!==null?y.baseLanes|o:o,o,u)}else y!==null?(nd(s,y.cachePool),F_(s,y),fs(),s.memoizedState=null):(r!==null&&nd(s,null),om(),fs());return _n(r,s,g,o),s.child}function uc(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function z0(r,s,o,u,g){var y=tm();return y=y===null?null:{parent:Kt._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},r!==null&&nd(s,null),om(),q_(s),r!==null&&co(r,s,u,!0),s.childLanes=g,null}function _d(r,s){return s=bd({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function U0(r,s,o){return Sa(s,r.child,null,o),r=_d(s,s.pendingProps),r.flags|=2,Yn(s),s.memoizedState=null,r}function BT(r,s,o){var u=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(it){if(u.mode==="hidden")return r=_d(s,u),s.lanes=536870912,uc(null,r);if(cm(s),(r=St)?(r=Zv(r,hr),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:ss!==null?{id:ti,overflow:ni}:null,retryLane:536870912,hydrationErrors:null},o=w_(r),o.return=s,s.child=o,gn=s,St=null)):r=null,r===null)throw os(s);return s.lanes=536870912,null}return _d(s,u)}var y=r.memoizedState;if(y!==null){var E=y.dehydrated;if(cm(s),g)if(s.flags&256)s.flags&=-257,s=U0(r,s,o);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(Yt||co(r,s,o,!1),g=(o&r.childLanes)!==0,Yt||g){if(u=bt,u!==null&&(E=jl(u,o),E!==0&&E!==y.retryLane))throw y.retryLane=E,pa(r,E),Bn(u,r,E),Im;Dd(),s=U0(r,s,o)}else r=y.treeContext,St=mr(E.nextSibling),gn=s,it=!0,as=null,hr=!1,r!==null&&C_(s,r),s=_d(s,u),s.flags|=4096;return s}return r=xi(r.child,{mode:u.mode,children:u.children}),r.ref=s.ref,s.child=r,r.return=s,r}function vd(r,s){var o=s.ref;if(o===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(r===null||r.ref!==o)&&(s.flags|=4194816)}}function jm(r,s,o,u,g){return va(s),o=dm(r,s,o,u,void 0,g),u=hm(),r!==null&&!Yt?(fm(r,s,g),Ci(r,s,g)):(it&&u&&Qf(s),s.flags|=1,_n(r,s,o,g),s.child)}function F0(r,s,o,u,g,y){return va(s),s.updateQueue=null,o=G_(s,u,o,g),H_(r),u=hm(),r!==null&&!Yt?(fm(r,s,y),Ci(r,s,y)):(it&&u&&Qf(s),s.flags|=1,_n(r,s,o,y),s.child)}function q0(r,s,o,u,g){if(va(s),s.stateNode===null){var y=so,E=o.contextType;typeof E=="object"&&E!==null&&(y=yn(E)),y=new o(u,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Rm,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=u,y.state=s.memoizedState,y.refs={},rm(s),E=o.contextType,y.context=typeof E=="object"&&E!==null?yn(E):so,y.state=s.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(Cm(s,o,E,u),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(E=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),E!==y.state&&Rm.enqueueReplaceState(y,y.state,null),sc(s,u,y,g),ic(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(r===null){y=s.stateNode;var M=s.memoizedProps,G=Ta(o,M);y.props=G;var ae=y.context,me=o.contextType;E=so,typeof me=="object"&&me!==null&&(E=yn(me));var _e=o.getDerivedStateFromProps;me=typeof _e=="function"||typeof y.getSnapshotBeforeUpdate=="function",M=s.pendingProps!==M,me||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(M||ae!==E)&&D0(s,y,u,E),cs=!1;var ce=s.memoizedState;y.state=ce,sc(s,u,y,g),ic(),ae=s.memoizedState,M||ce!==ae||cs?(typeof _e=="function"&&(Cm(s,o,_e,u),ae=s.memoizedState),(G=cs||R0(s,o,G,u,ce,ae,E))?(me||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=ae),y.props=u,y.state=ae,y.context=E,u=G):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{y=s.stateNode,im(r,s),E=s.memoizedProps,me=Ta(o,E),y.props=me,_e=s.pendingProps,ce=y.context,ae=o.contextType,G=so,typeof ae=="object"&&ae!==null&&(G=yn(ae)),M=o.getDerivedStateFromProps,(ae=typeof M=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(E!==_e||ce!==G)&&D0(s,y,u,G),cs=!1,ce=s.memoizedState,y.state=ce,sc(s,u,y,g),ic();var de=s.memoizedState;E!==_e||ce!==de||cs||r!==null&&r.dependencies!==null&&ed(r.dependencies)?(typeof M=="function"&&(Cm(s,o,M,u),de=s.memoizedState),(me=cs||R0(s,o,me,u,ce,de,G)||r!==null&&r.dependencies!==null&&ed(r.dependencies))?(ae||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,de,G),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,de,G)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&ce===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&ce===r.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=de),y.props=u,y.state=de,y.context=G,u=me):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&ce===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&ce===r.memoizedState||(s.flags|=1024),u=!1)}return y=u,vd(r,s),u=(s.flags&128)!==0,y||u?(y=s.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,r!==null&&u?(s.child=Sa(s,r.child,null,g),s.child=Sa(s,null,o,g)):_n(r,s,o,g),s.memoizedState=y.state,r=s.child):r=Ci(r,s,g),r}function H0(r,s,o,u){return ya(),s.flags|=256,_n(r,s,o,u),s.child}var km={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Om(r){return{baseLanes:r,cachePool:O_()}}function Mm(r,s,o){return r=r!==null?r.childLanes&~o:0,s&&(r|=Jn),r}function G0(r,s,o){var u=s.pendingProps,g=!1,y=(s.flags&128)!==0,E;if((E=y)||(E=r!==null&&r.memoizedState===null?!1:(Bt.current&2)!==0),E&&(g=!0,s.flags&=-129),E=(s.flags&32)!==0,s.flags&=-33,r===null){if(it){if(g?hs(s):fs(),(r=St)?(r=Zv(r,hr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:ss!==null?{id:ti,overflow:ni}:null,retryLane:536870912,hydrationErrors:null},o=w_(r),o.return=s,s.child=o,gn=s,St=null)):r=null,r===null)throw os(s);return gp(r)?s.lanes=32:s.lanes=536870912,null}var M=u.children;return u=u.fallback,g?(fs(),g=s.mode,M=bd({mode:"hidden",children:M},g),u=ga(u,g,o,null),M.return=s,u.return=s,M.sibling=u,s.child=M,u=s.child,u.memoizedState=Om(o),u.childLanes=Mm(r,E,o),s.memoizedState=km,uc(null,u)):(hs(s),Nm(s,M))}var G=r.memoizedState;if(G!==null&&(M=G.dehydrated,M!==null)){if(y)s.flags&256?(hs(s),s.flags&=-257,s=Pm(r,s,o)):s.memoizedState!==null?(fs(),s.child=r.child,s.flags|=128,s=null):(fs(),M=u.fallback,g=s.mode,u=bd({mode:"visible",children:u.children},g),M=ga(M,g,o,null),M.flags|=2,u.return=s,M.return=s,u.sibling=M,s.child=u,Sa(s,r.child,null,o),u=s.child,u.memoizedState=Om(o),u.childLanes=Mm(r,E,o),s.memoizedState=km,s=uc(null,u));else if(hs(s),gp(M)){if(E=M.nextSibling&&M.nextSibling.dataset,E)var ae=E.dgst;E=ae,u=Error(i(419)),u.stack="",u.digest=E,Jl({value:u,source:null,stack:null}),s=Pm(r,s,o)}else if(Yt||co(r,s,o,!1),E=(o&r.childLanes)!==0,Yt||E){if(E=bt,E!==null&&(u=jl(E,o),u!==0&&u!==G.retryLane))throw G.retryLane=u,pa(r,u),Bn(E,r,u),Im;pp(M)||Dd(),s=Pm(r,s,o)}else pp(M)?(s.flags|=192,s.child=r.child,s=null):(r=G.treeContext,St=mr(M.nextSibling),gn=s,it=!0,as=null,hr=!1,r!==null&&C_(s,r),s=Nm(s,u.children),s.flags|=4096);return s}return g?(fs(),M=u.fallback,g=s.mode,G=r.child,ae=G.sibling,u=xi(G,{mode:"hidden",children:u.children}),u.subtreeFlags=G.subtreeFlags&65011712,ae!==null?M=xi(ae,M):(M=ga(M,g,o,null),M.flags|=2),M.return=s,u.return=s,u.sibling=M,s.child=u,uc(null,u),u=s.child,M=r.child.memoizedState,M===null?M=Om(o):(g=M.cachePool,g!==null?(G=Kt._currentValue,g=g.parent!==G?{parent:G,pool:G}:g):g=O_(),M={baseLanes:M.baseLanes|o,cachePool:g}),u.memoizedState=M,u.childLanes=Mm(r,E,o),s.memoizedState=km,uc(r.child,u)):(hs(s),o=r.child,r=o.sibling,o=xi(o,{mode:"visible",children:u.children}),o.return=s,o.sibling=null,r!==null&&(E=s.deletions,E===null?(s.deletions=[r],s.flags|=16):E.push(r)),s.child=o,s.memoizedState=null,o)}function Nm(r,s){return s=bd({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function bd(r,s){return r=Kn(22,r,null,s),r.lanes=0,r}function Pm(r,s,o){return Sa(s,r.child,null,o),r=Nm(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function Q0(r,s,o){r.lanes|=s;var u=r.alternate;u!==null&&(u.lanes|=s),Xf(r.return,s,o)}function Lm(r,s,o,u,g,y){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:g,treeForkCount:y}:(E.isBackwards=s,E.rendering=null,E.renderingStartTime=0,E.last=u,E.tail=o,E.tailMode=g,E.treeForkCount=y)}function $0(r,s,o){var u=s.pendingProps,g=u.revealOrder,y=u.tail;u=u.children;var E=Bt.current,M=(E&2)!==0;if(M?(E=E&1|2,s.flags|=128):E&=1,oe(Bt,E),_n(r,s,u,o),u=it?Xl:0,!M&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Q0(r,o,s);else if(r.tag===19)Q0(r,o,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(g){case"forwards":for(o=s.child,g=null;o!==null;)r=o.alternate,r!==null&&ld(r)===null&&(g=o),o=o.sibling;o=g,o===null?(g=s.child,s.child=null):(g=o.sibling,o.sibling=null),Lm(s,!1,g,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=s.child,s.child=null;g!==null;){if(r=g.alternate,r!==null&&ld(r)===null){s.child=g;break}r=g.sibling,g.sibling=o,o=g,g=r}Lm(s,!0,o,null,y,u);break;case"together":Lm(s,!1,null,null,void 0,u);break;default:s.memoizedState=null}return s.child}function Ci(r,s,o){if(r!==null&&(s.dependencies=r.dependencies),gs|=s.lanes,(o&s.childLanes)===0)if(r!==null){if(co(r,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,o=xi(r,r.pendingProps),s.child=o,o.return=s;r.sibling!==null;)r=r.sibling,o=o.sibling=xi(r,r.pendingProps),o.return=s;o.sibling=null}return s.child}function Vm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&ed(r)))}function zT(r,s,o){switch(s.tag){case 3:pe(s,s.stateNode.containerInfo),ls(s,Kt,r.memoizedState.cache),ya();break;case 27:case 5:he(s);break;case 4:pe(s,s.stateNode.containerInfo);break;case 10:ls(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,cm(s),null;break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(hs(s),s.flags|=128,null):(o&s.child.childLanes)!==0?G0(r,s,o):(hs(s),r=Ci(r,s,o),r!==null?r.sibling:null);hs(s);break;case 19:var g=(r.flags&128)!==0;if(u=(o&s.childLanes)!==0,u||(co(r,s,o,!1),u=(o&s.childLanes)!==0),g){if(u)return $0(r,s,o);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),oe(Bt,Bt.current),u)break;return null;case 22:return s.lanes=0,B0(r,s,o,s.pendingProps);case 24:ls(s,Kt,r.memoizedState.cache)}return Ci(r,s,o)}function K0(r,s,o){if(r!==null)if(r.memoizedProps!==s.pendingProps)Yt=!0;else{if(!Vm(r,o)&&(s.flags&128)===0)return Yt=!1,zT(r,s,o);Yt=(r.flags&131072)!==0}else Yt=!1,it&&(s.flags&1048576)!==0&&A_(s,Xl,s.index);switch(s.lanes=0,s.tag){case 16:e:{var u=s.pendingProps;if(r=xa(s.elementType),s.type=r,typeof r=="function")qf(r)?(u=Ta(r,u),s.tag=1,s=q0(null,s,r,u,o)):(s.tag=0,s=jm(null,s,r,u,o));else{if(r!=null){var g=r.$$typeof;if(g===Z){s.tag=11,s=P0(null,s,r,u,o);break e}else if(g===k){s.tag=14,s=L0(null,s,r,u,o);break e}}throw s=K(r)||r,Error(i(306,s,""))}}return s;case 0:return jm(r,s,s.type,s.pendingProps,o);case 1:return u=s.type,g=Ta(u,s.pendingProps),q0(r,s,u,g,o);case 3:e:{if(pe(s,s.stateNode.containerInfo),r===null)throw Error(i(387));u=s.pendingProps;var y=s.memoizedState;g=y.element,im(r,s),sc(s,u,null,o);var E=s.memoizedState;if(u=E.cache,ls(s,Kt,u),u!==y.cache&&Jf(s,[Kt],o,!0),ic(),u=E.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:E.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=H0(r,s,u,o);break e}else if(u!==g){g=cr(Error(i(424)),s),Jl(g),s=H0(r,s,u,o);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,St=mr(r.firstChild),gn=s,it=!0,as=null,hr=!0,o=B_(s,null,u,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ya(),u===g){s=Ci(r,s,o);break e}_n(r,s,u,o)}s=s.child}return s;case 26:return vd(r,s),r===null?(o=sb(s.type,null,s.pendingProps,null))?s.memoizedState=o:it||(o=s.type,r=s.pendingProps,u=Pd(ge.current).createElement(o),u[Gt]=s,u[ln]=r,vn(u,o,r),Qt(u),s.stateNode=u):s.memoizedState=sb(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return he(s),r===null&&it&&(u=s.stateNode=nb(s.type,s.pendingProps,ge.current),gn=s,hr=!0,g=St,xs(s.type)?(yp=g,St=mr(u.firstChild)):St=g),_n(r,s,s.pendingProps.children,o),vd(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&it&&((g=u=St)&&(u=gA(u,s.type,s.pendingProps,hr),u!==null?(s.stateNode=u,gn=s,St=mr(u.firstChild),hr=!1,g=!0):g=!1),g||os(s)),he(s),g=s.type,y=s.pendingProps,E=r!==null?r.memoizedProps:null,u=y.children,hp(g,y)?u=null:E!==null&&hp(g,E)&&(s.flags|=32),s.memoizedState!==null&&(g=dm(r,s,jT,null,null,o),Tc._currentValue=g),vd(r,s),_n(r,s,u,o),s.child;case 6:return r===null&&it&&((r=o=St)&&(o=yA(o,s.pendingProps,hr),o!==null?(s.stateNode=o,gn=s,St=null,r=!0):r=!1),r||os(s)),null;case 13:return G0(r,s,o);case 4:return pe(s,s.stateNode.containerInfo),u=s.pendingProps,r===null?s.child=Sa(s,null,u,o):_n(r,s,u,o),s.child;case 11:return P0(r,s,s.type,s.pendingProps,o);case 7:return _n(r,s,s.pendingProps,o),s.child;case 8:return _n(r,s,s.pendingProps.children,o),s.child;case 12:return _n(r,s,s.pendingProps.children,o),s.child;case 10:return u=s.pendingProps,ls(s,s.type,u.value),_n(r,s,u.children,o),s.child;case 9:return g=s.type._context,u=s.pendingProps.children,va(s),g=yn(g),u=u(g),s.flags|=1,_n(r,s,u,o),s.child;case 14:return L0(r,s,s.type,s.pendingProps,o);case 15:return V0(r,s,s.type,s.pendingProps,o);case 19:return $0(r,s,o);case 31:return BT(r,s,o);case 22:return B0(r,s,o,s.pendingProps);case 24:return va(s),u=yn(Kt),r===null?(g=tm(),g===null&&(g=bt,y=Zf(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=o),g=y),s.memoizedState={parent:u,cache:g},rm(s),ls(s,Kt,g)):((r.lanes&o)!==0&&(im(r,s),sc(s,null,null,o),ic()),g=r.memoizedState,y=s.memoizedState,g.parent!==u?(g={parent:u,cache:u},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),ls(s,Kt,u)):(u=y.cache,ls(s,Kt,u),u!==g.cache&&Jf(s,[Kt],o,!0))),_n(r,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Ri(r){r.flags|=4}function Bm(r,s,o,u,g){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(g&335544128)===g)if(r.stateNode.complete)r.flags|=8192;else if(xv())r.flags|=8192;else throw Ea=id,nm}else r.flags&=-16777217}function W0(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!ub(s))if(xv())r.flags|=8192;else throw Ea=id,nm}function xd(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?Cu():536870912,r.lanes|=s,Eo|=s)}function dc(r,s){if(!it)switch(r.tailMode){case"hidden":s=r.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function wt(r){var s=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(s)for(var g=r.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=u,r.childLanes=o,s}function UT(r,s,o){var u=s.pendingProps;switch($f(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wt(s),null;case 1:return wt(s),null;case 3:return o=s.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),wi(Kt),Ee(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(lo(s)?Ri(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Wf())),wt(s),null;case 26:var g=s.type,y=s.memoizedState;return r===null?(Ri(s),y!==null?(wt(s),W0(s,y)):(wt(s),Bm(s,g,null,u,o))):y?y!==r.memoizedState?(Ri(s),wt(s),W0(s,y)):(wt(s),s.flags&=-16777217):(r=r.memoizedProps,r!==u&&Ri(s),wt(s),Bm(s,g,r,u,o)),null;case 27:if(Re(s),o=ge.current,g=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==u&&Ri(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return wt(s),null}r=se.current,lo(s)?R_(s):(r=nb(g,u,o),s.stateNode=r,Ri(s))}return wt(s),null;case 5:if(Re(s),g=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==u&&Ri(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return wt(s),null}if(y=se.current,lo(s))R_(s);else{var E=Pd(ge.current);switch(y){case 1:y=E.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=E.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=E.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=E.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=E.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?E.createElement("select",{is:u.is}):E.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?E.createElement(g,{is:u.is}):E.createElement(g)}}y[Gt]=s,y[ln]=u;e:for(E=s.child;E!==null;){if(E.tag===5||E.tag===6)y.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===s)break e;for(;E.sibling===null;){if(E.return===null||E.return===s)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}s.stateNode=y;e:switch(vn(y,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Ri(s)}}return wt(s),Bm(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,o),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==u&&Ri(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(i(166));if(r=ge.current,lo(s)){if(r=s.stateNode,o=s.memoizedProps,u=null,g=gn,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}r[Gt]=s,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Gv(r.nodeValue,o)),r||os(s,!0)}else r=Pd(r).createTextNode(u),r[Gt]=s,s.stateNode=r}return wt(s),null;case 31:if(o=s.memoizedState,r===null||r.memoizedState!==null){if(u=lo(s),o!==null){if(r===null){if(!u)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Gt]=s}else ya(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;wt(s),r=!1}else o=Wf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return s.flags&256?(Yn(s),s):(Yn(s),null);if((s.flags&128)!==0)throw Error(i(558))}return wt(s),null;case 13:if(u=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=lo(s),u!==null&&u.dehydrated!==null){if(r===null){if(!g)throw Error(i(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[Gt]=s}else ya(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;wt(s),g=!1}else g=Wf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(Yn(s),s):(Yn(s),null)}return Yn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=u!==null,r=r!==null&&r.memoizedState!==null,o&&(u=s.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==g&&(u.flags|=2048)),o!==r&&o&&(s.child.flags|=8192),xd(s,s.updateQueue),wt(s),null);case 4:return Ee(),r===null&&op(s.stateNode.containerInfo),wt(s),null;case 10:return wi(s.type),wt(s),null;case 19:if(H(Bt),u=s.memoizedState,u===null)return wt(s),null;if(g=(s.flags&128)!==0,y=u.rendering,y===null)if(g)dc(u,!1);else{if(Pt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(y=ld(r),y!==null){for(s.flags|=128,dc(u,!1),r=y.updateQueue,s.updateQueue=r,xd(s,r),s.subtreeFlags=0,r=o,o=s.child;o!==null;)S_(o,r),o=o.sibling;return oe(Bt,Bt.current&1|2),it&&Ei(s,u.treeForkCount),s.child}r=r.sibling}u.tail!==null&&nn()>Ad&&(s.flags|=128,g=!0,dc(u,!1),s.lanes=4194304)}else{if(!g)if(r=ld(y),r!==null){if(s.flags|=128,g=!0,r=r.updateQueue,s.updateQueue=r,xd(s,r),dc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!it)return wt(s),null}else 2*nn()-u.renderingStartTime>Ad&&o!==536870912&&(s.flags|=128,g=!0,dc(u,!1),s.lanes=4194304);u.isBackwards?(y.sibling=s.child,s.child=y):(r=u.last,r!==null?r.sibling=y:s.child=y,u.last=y)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=nn(),r.sibling=null,o=Bt.current,oe(Bt,g?o&1|2:o&1),it&&Ei(s,u.treeForkCount),r):(wt(s),null);case 22:case 23:return Yn(s),lm(),u=s.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?(o&536870912)!==0&&(s.flags&128)===0&&(wt(s),s.subtreeFlags&6&&(s.flags|=8192)):wt(s),o=s.updateQueue,o!==null&&xd(s,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==o&&(s.flags|=2048),r!==null&&H(ba),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),wi(Kt),wt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function FT(r,s){switch($f(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return wi(Kt),Ee(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return Re(s),null;case 31:if(s.memoizedState!==null){if(Yn(s),s.alternate===null)throw Error(i(340));ya()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(Yn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));ya()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return H(Bt),null;case 4:return Ee(),null;case 10:return wi(s.type),null;case 22:case 23:return Yn(s),lm(),r!==null&&H(ba),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return wi(Kt),null;case 25:return null;default:return null}}function Y0(r,s){switch($f(s),s.tag){case 3:wi(Kt),Ee();break;case 26:case 27:case 5:Re(s);break;case 4:Ee();break;case 31:s.memoizedState!==null&&Yn(s);break;case 13:Yn(s);break;case 19:H(Bt);break;case 10:wi(s.type);break;case 22:case 23:Yn(s),lm(),r!==null&&H(ba);break;case 24:wi(Kt)}}function hc(r,s){try{var o=s.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var g=u.next;o=g;do{if((o.tag&r)===r){u=void 0;var y=o.create,E=o.inst;u=y(),E.destroy=u}o=o.next}while(o!==g)}}catch(M){mt(s,s.return,M)}}function ms(r,s,o){try{var u=s.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var y=g.next;u=y;do{if((u.tag&r)===r){var E=u.inst,M=E.destroy;if(M!==void 0){E.destroy=void 0,g=s;var G=o,ae=M;try{ae()}catch(me){mt(g,G,me)}}}u=u.next}while(u!==y)}}catch(me){mt(s,s.return,me)}}function X0(r){var s=r.updateQueue;if(s!==null){var o=r.stateNode;try{U_(s,o)}catch(u){mt(r,r.return,u)}}}function J0(r,s,o){o.props=Ta(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){mt(r,s,u)}}function fc(r,s){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(g){mt(r,s,g)}}function ri(r,s){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(g){mt(r,s,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){mt(r,s,g)}else o.current=null}function Z0(r){var s=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(g){mt(r,r.return,g)}}function zm(r,s,o){try{var u=r.stateNode;uA(u,r.type,o,s),u[ln]=s}catch(g){mt(r,r.return,g)}}function ev(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&xs(r.type)||r.tag===4}function Um(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||ev(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&xs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Fm(r,s,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(r),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=Sr));else if(u!==4&&(u===27&&xs(r.type)&&(o=r.stateNode,s=null),r=r.child,r!==null))for(Fm(r,s,o),r=r.sibling;r!==null;)Fm(r,s,o),r=r.sibling}function Ed(r,s,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,s?o.insertBefore(r,s):o.appendChild(r);else if(u!==4&&(u===27&&xs(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(Ed(r,s,o),r=r.sibling;r!==null;)Ed(r,s,o),r=r.sibling}function tv(r){var s=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);vn(s,u,o),s[Gt]=r,s[ln]=o}catch(y){mt(r,r.return,y)}}var Di=!1,Xt=!1,qm=!1,nv=typeof WeakSet=="function"?WeakSet:Set,un=null;function qT(r,s){if(r=r.containerInfo,up=qd,r=m_(r),Pf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var g=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var E=0,M=-1,G=-1,ae=0,me=0,_e=r,ce=null;t:for(;;){for(var de;_e!==o||g!==0&&_e.nodeType!==3||(M=E+g),_e!==y||u!==0&&_e.nodeType!==3||(G=E+u),_e.nodeType===3&&(E+=_e.nodeValue.length),(de=_e.firstChild)!==null;)ce=_e,_e=de;for(;;){if(_e===r)break t;if(ce===o&&++ae===g&&(M=E),ce===y&&++me===u&&(G=E),(de=_e.nextSibling)!==null)break;_e=ce,ce=_e.parentNode}_e=de}o=M===-1||G===-1?null:{start:M,end:G}}else o=null}o=o||{start:0,end:0}}else o=null;for(dp={focusedElem:r,selectionRange:o},qd=!1,un=s;un!==null;)if(s=un,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,un=r;else for(;un!==null;){switch(s=un,y=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)g=r[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=s,g=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var Ce=Ta(o.type,g);r=u.getSnapshotBeforeUpdate(Ce,y),u.__reactInternalSnapshotBeforeUpdate=r}catch(Pe){mt(o,o.return,Pe)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,o=r.nodeType,o===9)mp(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":mp(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,un=r;break}un=s.return}}function rv(r,s,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:ji(r,o),u&4&&hc(5,o);break;case 1:if(ji(r,o),u&4)if(r=o.stateNode,s===null)try{r.componentDidMount()}catch(E){mt(o,o.return,E)}else{var g=Ta(o.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(g,s,r.__reactInternalSnapshotBeforeUpdate)}catch(E){mt(o,o.return,E)}}u&64&&X0(o),u&512&&fc(o,o.return);break;case 3:if(ji(r,o),u&64&&(r=o.updateQueue,r!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{U_(r,s)}catch(E){mt(o,o.return,E)}}break;case 27:s===null&&u&4&&tv(o);case 26:case 5:ji(r,o),s===null&&u&4&&Z0(o),u&512&&fc(o,o.return);break;case 12:ji(r,o);break;case 31:ji(r,o),u&4&&av(r,o);break;case 13:ji(r,o),u&4&&ov(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=JT.bind(null,o),_A(r,o))));break;case 22:if(u=o.memoizedState!==null||Di,!u){s=s!==null&&s.memoizedState!==null||Xt,g=Di;var y=Xt;Di=u,(Xt=s)&&!y?ki(r,o,(o.subtreeFlags&8772)!==0):ji(r,o),Di=g,Xt=y}break;case 30:break;default:ji(r,o)}}function iv(r){var s=r.alternate;s!==null&&(r.alternate=null,iv(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&Ga(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Dt=null,Nn=!1;function Ii(r,s,o){for(o=o.child;o!==null;)sv(r,s,o),o=o.sibling}function sv(r,s,o){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(vr,o)}catch{}switch(o.tag){case 26:Xt||ri(o,s),Ii(r,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Xt||ri(o,s);var u=Dt,g=Nn;xs(o.type)&&(Dt=o.stateNode,Nn=!1),Ii(r,s,o),Ec(o.stateNode),Dt=u,Nn=g;break;case 5:Xt||ri(o,s);case 6:if(u=Dt,g=Nn,Dt=null,Ii(r,s,o),Dt=u,Nn=g,Dt!==null)if(Nn)try{(Dt.nodeType===9?Dt.body:Dt.nodeName==="HTML"?Dt.ownerDocument.body:Dt).removeChild(o.stateNode)}catch(y){mt(o,s,y)}else try{Dt.removeChild(o.stateNode)}catch(y){mt(o,s,y)}break;case 18:Dt!==null&&(Nn?(r=Dt,Xv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),Io(r)):Xv(Dt,o.stateNode));break;case 4:u=Dt,g=Nn,Dt=o.stateNode.containerInfo,Nn=!0,Ii(r,s,o),Dt=u,Nn=g;break;case 0:case 11:case 14:case 15:ms(2,o,s),Xt||ms(4,o,s),Ii(r,s,o);break;case 1:Xt||(ri(o,s),u=o.stateNode,typeof u.componentWillUnmount=="function"&&J0(o,s,u)),Ii(r,s,o);break;case 21:Ii(r,s,o);break;case 22:Xt=(u=Xt)||o.memoizedState!==null,Ii(r,s,o),Xt=u;break;default:Ii(r,s,o)}}function av(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Io(r)}catch(o){mt(s,s.return,o)}}}function ov(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Io(r)}catch(o){mt(s,s.return,o)}}function HT(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new nv),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new nv),s;default:throw Error(i(435,r.tag))}}function Sd(r,s){var o=HT(r);s.forEach(function(u){if(!o.has(u)){o.add(u);var g=ZT.bind(null,r,u);u.then(g,g)}})}function Pn(r,s){var o=s.deletions;if(o!==null)for(var u=0;u<o.length;u++){var g=o[u],y=r,E=s,M=E;e:for(;M!==null;){switch(M.tag){case 27:if(xs(M.type)){Dt=M.stateNode,Nn=!1;break e}break;case 5:Dt=M.stateNode,Nn=!1;break e;case 3:case 4:Dt=M.stateNode.containerInfo,Nn=!0;break e}M=M.return}if(Dt===null)throw Error(i(160));sv(y,E,g),Dt=null,Nn=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)lv(s,r),s=s.sibling}var Dr=null;function lv(r,s){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Pn(s,r),Ln(r),u&4&&(ms(3,r,r.return),hc(3,r),ms(5,r,r.return));break;case 1:Pn(s,r),Ln(r),u&512&&(Xt||o===null||ri(o,o.return)),u&64&&Di&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var g=Dr;if(Pn(s,r),Ln(r),u&512&&(Xt||o===null||ri(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":y=g.getElementsByTagName("title")[0],(!y||y[qr]||y[Gt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(u),g.head.insertBefore(y,g.querySelector("head > title"))),vn(y,u,o),y[Gt]=r,Qt(y),u=y;break e;case"link":var E=lb("link","href",g).get(u+(o.href||""));if(E){for(var M=0;M<E.length;M++)if(y=E[M],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(M,1);break t}}y=g.createElement(u),vn(y,u,o),g.head.appendChild(y);break;case"meta":if(E=lb("meta","content",g).get(u+(o.content||""))){for(M=0;M<E.length;M++)if(y=E[M],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(M,1);break t}}y=g.createElement(u),vn(y,u,o),g.head.appendChild(y);break;default:throw Error(i(468,u))}y[Gt]=r,Qt(y),u=y}r.stateNode=u}else cb(g,r.type,r.stateNode);else r.stateNode=ob(g,u,r.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?cb(g,r.type,r.stateNode):ob(g,u,r.memoizedProps)):u===null&&r.stateNode!==null&&zm(r,r.memoizedProps,o.memoizedProps)}break;case 27:Pn(s,r),Ln(r),u&512&&(Xt||o===null||ri(o,o.return)),o!==null&&u&4&&zm(r,r.memoizedProps,o.memoizedProps);break;case 5:if(Pn(s,r),Ln(r),u&512&&(Xt||o===null||ri(o,o.return)),r.flags&32){g=r.stateNode;try{Mn(g,"")}catch(Ce){mt(r,r.return,Ce)}}u&4&&r.stateNode!=null&&(g=r.memoizedProps,zm(r,g,o!==null?o.memoizedProps:g)),u&1024&&(qm=!0);break;case 6:if(Pn(s,r),Ln(r),u&4){if(r.stateNode===null)throw Error(i(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(Ce){mt(r,r.return,Ce)}}break;case 3:if(Bd=null,g=Dr,Dr=Ld(s.containerInfo),Pn(s,r),Dr=g,Ln(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Io(s.containerInfo)}catch(Ce){mt(r,r.return,Ce)}qm&&(qm=!1,cv(r));break;case 4:u=Dr,Dr=Ld(r.stateNode.containerInfo),Pn(s,r),Ln(r),Dr=u;break;case 12:Pn(s,r),Ln(r);break;case 31:Pn(s,r),Ln(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,Sd(r,u)));break;case 13:Pn(s,r),Ln(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Td=nn()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,Sd(r,u)));break;case 22:g=r.memoizedState!==null;var G=o!==null&&o.memoizedState!==null,ae=Di,me=Xt;if(Di=ae||g,Xt=me||G,Pn(s,r),Xt=me,Di=ae,Ln(r),u&8192)e:for(s=r.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(o===null||G||Di||Xt||Aa(r)),o=null,s=r;;){if(s.tag===5||s.tag===26){if(o===null){G=o=s;try{if(y=G.stateNode,g)E=y.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{M=G.stateNode;var _e=G.memoizedProps.style,ce=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;M.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(Ce){mt(G,G.return,Ce)}}}else if(s.tag===6){if(o===null){G=s;try{G.stateNode.nodeValue=g?"":G.memoizedProps}catch(Ce){mt(G,G.return,Ce)}}}else if(s.tag===18){if(o===null){G=s;try{var de=G.stateNode;g?Jv(de,!0):Jv(G.stateNode,!1)}catch(Ce){mt(G,G.return,Ce)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Sd(r,o))));break;case 19:Pn(s,r),Ln(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,Sd(r,u)));break;case 30:break;case 21:break;default:Pn(s,r),Ln(r)}}function Ln(r){var s=r.flags;if(s&2){try{for(var o,u=r.return;u!==null;){if(ev(u)){o=u;break}u=u.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var g=o.stateNode,y=Um(r);Ed(r,y,g);break;case 5:var E=o.stateNode;o.flags&32&&(Mn(E,""),o.flags&=-33);var M=Um(r);Ed(r,M,E);break;case 3:case 4:var G=o.stateNode.containerInfo,ae=Um(r);Fm(r,ae,G);break;default:throw Error(i(161))}}catch(me){mt(r,r.return,me)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function cv(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;cv(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function ji(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)rv(r,s.alternate,s),s=s.sibling}function Aa(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:ms(4,s,s.return),Aa(s);break;case 1:ri(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&J0(s,s.return,o),Aa(s);break;case 27:Ec(s.stateNode);case 26:case 5:ri(s,s.return),Aa(s);break;case 22:s.memoizedState===null&&Aa(s);break;case 30:Aa(s);break;default:Aa(s)}r=r.sibling}}function ki(r,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,g=r,y=s,E=y.flags;switch(y.tag){case 0:case 11:case 15:ki(g,y,o),hc(4,y);break;case 1:if(ki(g,y,o),u=y,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ae){mt(u,u.return,ae)}if(u=y,g=u.updateQueue,g!==null){var M=u.stateNode;try{var G=g.shared.hiddenCallbacks;if(G!==null)for(g.shared.hiddenCallbacks=null,g=0;g<G.length;g++)z_(G[g],M)}catch(ae){mt(u,u.return,ae)}}o&&E&64&&X0(y),fc(y,y.return);break;case 27:tv(y);case 26:case 5:ki(g,y,o),o&&u===null&&E&4&&Z0(y),fc(y,y.return);break;case 12:ki(g,y,o);break;case 31:ki(g,y,o),o&&E&4&&av(g,y);break;case 13:ki(g,y,o),o&&E&4&&ov(g,y);break;case 22:y.memoizedState===null&&ki(g,y,o),fc(y,y.return);break;case 30:break;default:ki(g,y,o)}s=s.sibling}}function Hm(r,s){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&Zl(o))}function Gm(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Zl(r))}function Ir(r,s,o,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)uv(r,s,o,u),s=s.sibling}function uv(r,s,o,u){var g=s.flags;switch(s.tag){case 0:case 11:case 15:Ir(r,s,o,u),g&2048&&hc(9,s);break;case 1:Ir(r,s,o,u);break;case 3:Ir(r,s,o,u),g&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Zl(r)));break;case 12:if(g&2048){Ir(r,s,o,u),r=s.stateNode;try{var y=s.memoizedProps,E=y.id,M=y.onPostCommit;typeof M=="function"&&M(E,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(G){mt(s,s.return,G)}}else Ir(r,s,o,u);break;case 31:Ir(r,s,o,u);break;case 13:Ir(r,s,o,u);break;case 23:break;case 22:y=s.stateNode,E=s.alternate,s.memoizedState!==null?y._visibility&2?Ir(r,s,o,u):mc(r,s):y._visibility&2?Ir(r,s,o,u):(y._visibility|=2,vo(r,s,o,u,(s.subtreeFlags&10256)!==0||!1)),g&2048&&Hm(E,s);break;case 24:Ir(r,s,o,u),g&2048&&Gm(s.alternate,s);break;default:Ir(r,s,o,u)}}function vo(r,s,o,u,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=r,E=s,M=o,G=u,ae=E.flags;switch(E.tag){case 0:case 11:case 15:vo(y,E,M,G,g),hc(8,E);break;case 23:break;case 22:var me=E.stateNode;E.memoizedState!==null?me._visibility&2?vo(y,E,M,G,g):mc(y,E):(me._visibility|=2,vo(y,E,M,G,g)),g&&ae&2048&&Hm(E.alternate,E);break;case 24:vo(y,E,M,G,g),g&&ae&2048&&Gm(E.alternate,E);break;default:vo(y,E,M,G,g)}s=s.sibling}}function mc(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=r,u=s,g=u.flags;switch(u.tag){case 22:mc(o,u),g&2048&&Hm(u.alternate,u);break;case 24:mc(o,u),g&2048&&Gm(u.alternate,u);break;default:mc(o,u)}s=s.sibling}}var pc=8192;function bo(r,s,o){if(r.subtreeFlags&pc)for(r=r.child;r!==null;)dv(r,s,o),r=r.sibling}function dv(r,s,o){switch(r.tag){case 26:bo(r,s,o),r.flags&pc&&r.memoizedState!==null&&IA(o,Dr,r.memoizedState,r.memoizedProps);break;case 5:bo(r,s,o);break;case 3:case 4:var u=Dr;Dr=Ld(r.stateNode.containerInfo),bo(r,s,o),Dr=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=pc,pc=16777216,bo(r,s,o),pc=u):bo(r,s,o));break;default:bo(r,s,o)}}function hv(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function gc(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];un=u,mv(u,r)}hv(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)fv(r),r=r.sibling}function fv(r){switch(r.tag){case 0:case 11:case 15:gc(r),r.flags&2048&&ms(9,r,r.return);break;case 3:gc(r);break;case 12:gc(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,wd(r)):gc(r);break;default:gc(r)}}function wd(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];un=u,mv(u,r)}hv(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:ms(8,s,s.return),wd(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,wd(s));break;default:wd(s)}r=r.sibling}}function mv(r,s){for(;un!==null;){var o=un;switch(o.tag){case 0:case 11:case 15:ms(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Zl(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,un=u;else e:for(o=r;un!==null;){u=un;var g=u.sibling,y=u.return;if(iv(u),u===o){un=null;break e}if(g!==null){g.return=y,un=g;break e}un=y}}}var GT={getCacheForType:function(r){var s=yn(Kt),o=s.data.get(r);return o===void 0&&(o=r(),s.data.set(r,o)),o},cacheSignal:function(){return yn(Kt).controller.signal}},QT=typeof WeakMap=="function"?WeakMap:Map,ut=0,bt=null,We=null,Ze=0,ft=0,Xn=null,ps=!1,xo=!1,Qm=!1,Oi=0,Pt=0,gs=0,Ca=0,$m=0,Jn=0,Eo=0,yc=null,Vn=null,Km=!1,Td=0,pv=0,Ad=1/0,Cd=null,ys=null,rn=0,_s=null,So=null,Mi=0,Wm=0,Ym=null,gv=null,_c=0,Xm=null;function Zn(){return(ut&2)!==0&&Ze!==0?Ze&-Ze:L.T!==null?rp():Ru()}function yv(){if(Jn===0)if((Ze&536870912)===0||it){var r=ea;ea<<=1,(ea&3932160)===0&&(ea=262144),Jn=r}else Jn=536870912;return r=Wn.current,r!==null&&(r.flags|=32),Jn}function Bn(r,s,o){(r===bt&&(ft===2||ft===9)||r.cancelPendingCommit!==null)&&(wo(r,0),vs(r,Ze,Jn,!1)),ta(r,o),((ut&2)===0||r!==bt)&&(r===bt&&((ut&2)===0&&(Ca|=o),Pt===4&&vs(r,Ze,Jn,!1)),ii(r))}function _v(r,s,o){if((ut&6)!==0)throw Error(i(327));var u=!o&&(s&127)===0&&(s&r.expiredLanes)===0||br(r,s),g=u?WT(r,s):Zm(r,s,!0),y=u;do{if(g===0){xo&&!u&&vs(r,s,0,!1);break}else{if(o=r.current.alternate,y&&!$T(o)){g=Zm(r,s,!1),y=!1;continue}if(g===2){if(y=s,r.errorRecoveryDisabledLanes&y)var E=0;else E=r.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){s=E;e:{var M=r;g=yc;var G=M.current.memoizedState.isDehydrated;if(G&&(wo(M,E).flags|=256),E=Zm(M,E,!1),E!==2){if(Qm&&!G){M.errorRecoveryDisabledLanes|=y,Ca|=y,g=4;break e}y=Vn,Vn=g,y!==null&&(Vn===null?Vn=y:Vn.push.apply(Vn,y))}g=E}if(y=!1,g!==2)continue}}if(g===1){wo(r,0),vs(r,s,0,!0);break}e:{switch(u=r,y=g,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:vs(u,s,Jn,!ps);break e;case 2:Vn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(g=Td+300-nn(),10<g)){if(vs(u,s,Jn,!ps),zr(u,0,!0)!==0)break e;Mi=s,u.timeoutHandle=Wv(vv.bind(null,u,o,Vn,Cd,Km,s,Jn,Ca,Eo,ps,y,"Throttled",-0,0),g);break e}vv(u,o,Vn,Cd,Km,s,Jn,Ca,Eo,ps,y,null,-0,0)}}break}while(!0);ii(r)}function vv(r,s,o,u,g,y,E,M,G,ae,me,_e,ce,de){if(r.timeoutHandle=-1,_e=s.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Sr},dv(s,y,_e);var Ce=(y&62914560)===y?Td-nn():(y&4194048)===y?pv-nn():0;if(Ce=jA(_e,Ce),Ce!==null){Mi=y,r.cancelPendingCommit=Ce(Cv.bind(null,r,s,y,o,u,g,E,M,G,me,_e,null,ce,de)),vs(r,y,E,!ae);return}}Cv(r,s,y,o,u,g,E,M,G)}function $T(r){for(var s=r;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var g=o[u],y=g.getSnapshot;g=g.value;try{if(!$n(y(),g))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function vs(r,s,o,u){s&=~$m,s&=~Ca,r.suspendedLanes|=s,r.pingedLanes&=~s,u&&(r.warmLanes|=s),u=r.expirationTimes;for(var g=s;0<g;){var y=31-Lt(g),E=1<<y;u[y]=-1,g&=~E}o!==0&&na(r,o,s)}function Rd(){return(ut&6)===0?(vc(0),!1):!0}function Jm(){if(We!==null){if(ft===0)var r=We.return;else r=We,Si=_a=null,mm(r),mo=null,tc=0,r=We;for(;r!==null;)Y0(r.alternate,r),r=r.return;We=null}}function wo(r,s){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,fA(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),Mi=0,Jm(),bt=r,We=o=xi(r.current,null),Ze=s,ft=0,Xn=null,ps=!1,xo=br(r,s),Qm=!1,Eo=Jn=$m=Ca=gs=Pt=0,Vn=yc=null,Km=!1,(s&8)!==0&&(s|=s&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=s;0<u;){var g=31-Lt(u),y=1<<g;s|=r[g],u&=~y}return Oi=s,Wu(),o}function bv(r,s){Qe=null,L.H=cc,s===fo||s===rd?(s=P_(),ft=3):s===nm?(s=P_(),ft=4):ft=s===Im?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Xn=s,We===null&&(Pt=1,yd(r,cr(s,r.current)))}function xv(){var r=Wn.current;return r===null?!0:(Ze&4194048)===Ze?fr===null:(Ze&62914560)===Ze||(Ze&536870912)!==0?r===fr:!1}function Ev(){var r=L.H;return L.H=cc,r===null?cc:r}function Sv(){var r=L.A;return L.A=GT,r}function Dd(){Pt=4,ps||(Ze&4194048)!==Ze&&Wn.current!==null||(xo=!0),(gs&134217727)===0&&(Ca&134217727)===0||bt===null||vs(bt,Ze,Jn,!1)}function Zm(r,s,o){var u=ut;ut|=2;var g=Ev(),y=Sv();(bt!==r||Ze!==s)&&(Cd=null,wo(r,s)),s=!1;var E=Pt;e:do try{if(ft!==0&&We!==null){var M=We,G=Xn;switch(ft){case 8:Jm(),E=6;break e;case 3:case 2:case 9:case 6:Wn.current===null&&(s=!0);var ae=ft;if(ft=0,Xn=null,To(r,M,G,ae),o&&xo){E=0;break e}break;default:ae=ft,ft=0,Xn=null,To(r,M,G,ae)}}KT(),E=Pt;break}catch(me){bv(r,me)}while(!0);return s&&r.shellSuspendCounter++,Si=_a=null,ut=u,L.H=g,L.A=y,We===null&&(bt=null,Ze=0,Wu()),E}function KT(){for(;We!==null;)wv(We)}function WT(r,s){var o=ut;ut|=2;var u=Ev(),g=Sv();bt!==r||Ze!==s?(Cd=null,Ad=nn()+500,wo(r,s)):xo=br(r,s);e:do try{if(ft!==0&&We!==null){s=We;var y=Xn;t:switch(ft){case 1:ft=0,Xn=null,To(r,s,y,1);break;case 2:case 9:if(M_(y)){ft=0,Xn=null,Tv(s);break}s=function(){ft!==2&&ft!==9||bt!==r||(ft=7),ii(r)},y.then(s,s);break e;case 3:ft=7;break e;case 4:ft=5;break e;case 7:M_(y)?(ft=0,Xn=null,Tv(s)):(ft=0,Xn=null,To(r,s,y,7));break;case 5:var E=null;switch(We.tag){case 26:E=We.memoizedState;case 5:case 27:var M=We;if(E?ub(E):M.stateNode.complete){ft=0,Xn=null;var G=M.sibling;if(G!==null)We=G;else{var ae=M.return;ae!==null?(We=ae,Id(ae)):We=null}break t}}ft=0,Xn=null,To(r,s,y,5);break;case 6:ft=0,Xn=null,To(r,s,y,6);break;case 8:Jm(),Pt=6;break e;default:throw Error(i(462))}}YT();break}catch(me){bv(r,me)}while(!0);return Si=_a=null,L.H=u,L.A=g,ut=o,We!==null?0:(bt=null,Ze=0,Wu(),Pt)}function YT(){for(;We!==null&&!fn();)wv(We)}function wv(r){var s=K0(r.alternate,r,Oi);r.memoizedProps=r.pendingProps,s===null?Id(r):We=s}function Tv(r){var s=r,o=s.alternate;switch(s.tag){case 15:case 0:s=F0(o,s,s.pendingProps,s.type,void 0,Ze);break;case 11:s=F0(o,s,s.pendingProps,s.type.render,s.ref,Ze);break;case 5:mm(s);default:Y0(o,s),s=We=S_(s,Oi),s=K0(o,s,Oi)}r.memoizedProps=r.pendingProps,s===null?Id(r):We=s}function To(r,s,o,u){Si=_a=null,mm(s),mo=null,tc=0;var g=s.return;try{if(VT(r,g,s,o,Ze)){Pt=1,yd(r,cr(o,r.current)),We=null;return}}catch(y){if(g!==null)throw We=g,y;Pt=1,yd(r,cr(o,r.current)),We=null;return}s.flags&32768?(it||u===1?r=!0:xo||(Ze&536870912)!==0?r=!1:(ps=r=!0,(u===2||u===9||u===3||u===6)&&(u=Wn.current,u!==null&&u.tag===13&&(u.flags|=16384))),Av(s,r)):Id(s)}function Id(r){var s=r;do{if((s.flags&32768)!==0){Av(s,ps);return}r=s.return;var o=UT(s.alternate,s,Oi);if(o!==null){We=o;return}if(s=s.sibling,s!==null){We=s;return}We=s=r}while(s!==null);Pt===0&&(Pt=5)}function Av(r,s){do{var o=FT(r.alternate,r);if(o!==null){o.flags&=32767,We=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(r=r.sibling,r!==null)){We=r;return}We=r=o}while(r!==null);Pt=6,We=null}function Cv(r,s,o,u,g,y,E,M,G){r.cancelPendingCommit=null;do jd();while(rn!==0);if((ut&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=Uf,kf(r,o,y,E,M,G),r===bt&&(We=bt=null,Ze=0),So=s,_s=r,Mi=o,Wm=y,Ym=g,gv=u,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,eA(Wi,function(){return kv(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||u){u=L.T,L.T=null,g=$.p,$.p=2,E=ut,ut|=4;try{qT(r,s,o)}finally{ut=E,$.p=g,L.T=u}}rn=1,Rv(),Dv(),Iv()}}function Rv(){if(rn===1){rn=0;var r=_s,s=So,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=L.T,L.T=null;var u=$.p;$.p=2;var g=ut;ut|=4;try{lv(s,r);var y=dp,E=m_(r.containerInfo),M=y.focusedElem,G=y.selectionRange;if(E!==M&&M&&M.ownerDocument&&f_(M.ownerDocument.documentElement,M)){if(G!==null&&Pf(M)){var ae=G.start,me=G.end;if(me===void 0&&(me=ae),"selectionStart"in M)M.selectionStart=ae,M.selectionEnd=Math.min(me,M.value.length);else{var _e=M.ownerDocument||document,ce=_e&&_e.defaultView||window;if(ce.getSelection){var de=ce.getSelection(),Ce=M.textContent.length,Pe=Math.min(G.start,Ce),_t=G.end===void 0?Pe:Math.min(G.end,Ce);!de.extend&&Pe>_t&&(E=_t,_t=Pe,Pe=E);var ee=h_(M,Pe),W=h_(M,_t);if(ee&&W&&(de.rangeCount!==1||de.anchorNode!==ee.node||de.anchorOffset!==ee.offset||de.focusNode!==W.node||de.focusOffset!==W.offset)){var ie=_e.createRange();ie.setStart(ee.node,ee.offset),de.removeAllRanges(),Pe>_t?(de.addRange(ie),de.extend(W.node,W.offset)):(ie.setEnd(W.node,W.offset),de.addRange(ie))}}}}for(_e=[],de=M;de=de.parentNode;)de.nodeType===1&&_e.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<_e.length;M++){var ye=_e[M];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}qd=!!up,dp=up=null}finally{ut=g,$.p=u,L.T=o}}r.current=s,rn=2}}function Dv(){if(rn===2){rn=0;var r=_s,s=So,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=L.T,L.T=null;var u=$.p;$.p=2;var g=ut;ut|=4;try{rv(r,s.alternate,s)}finally{ut=g,$.p=u,L.T=o}}rn=3}}function Iv(){if(rn===4||rn===3){rn=0,Dn();var r=_s,s=So,o=Mi,u=gv;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?rn=5:(rn=0,So=_s=null,jv(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(ys=null),yi(o),s=s.stateNode,mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(vr,s,void 0,(s.current.flags&128)===128)}catch{}if(u!==null){s=L.T,g=$.p,$.p=2,L.T=null;try{for(var y=r.onRecoverableError,E=0;E<u.length;E++){var M=u[E];y(M.value,{componentStack:M.stack})}}finally{L.T=s,$.p=g}}(Mi&3)!==0&&jd(),ii(r),g=r.pendingLanes,(o&261930)!==0&&(g&42)!==0?r===Xm?_c++:(_c=0,Xm=r):_c=0,vc(0)}}function jv(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,Zl(s)))}function jd(){return Rv(),Dv(),Iv(),kv()}function kv(){if(rn!==5)return!1;var r=_s,s=Wm;Wm=0;var o=yi(Mi),u=L.T,g=$.p;try{$.p=32>o?32:o,L.T=null,o=Ym,Ym=null;var y=_s,E=Mi;if(rn=0,So=_s=null,Mi=0,(ut&6)!==0)throw Error(i(331));var M=ut;if(ut|=4,fv(y.current),uv(y,y.current,E,o),ut=M,vc(0,!1),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(vr,y)}catch{}return!0}finally{$.p=g,L.T=u,jv(r,s)}}function Ov(r,s,o){s=cr(o,s),s=Dm(r.stateNode,s,2),r=ds(r,s,2),r!==null&&(ta(r,2),ii(r))}function mt(r,s,o){if(r.tag===3)Ov(r,r,o);else for(;s!==null;){if(s.tag===3){Ov(s,r,o);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ys===null||!ys.has(u))){r=cr(o,r),o=M0(2),u=ds(s,o,2),u!==null&&(N0(o,u,s,r),ta(u,2),ii(u));break}}s=s.return}}function ep(r,s,o){var u=r.pingCache;if(u===null){u=r.pingCache=new QT;var g=new Set;u.set(s,g)}else g=u.get(s),g===void 0&&(g=new Set,u.set(s,g));g.has(o)||(Qm=!0,g.add(o),r=XT.bind(null,r,s,o),s.then(r,r))}function XT(r,s,o){var u=r.pingCache;u!==null&&u.delete(s),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,bt===r&&(Ze&o)===o&&(Pt===4||Pt===3&&(Ze&62914560)===Ze&&300>nn()-Td?(ut&2)===0&&wo(r,0):$m|=o,Eo===Ze&&(Eo=0)),ii(r)}function Mv(r,s){s===0&&(s=Cu()),r=pa(r,s),r!==null&&(ta(r,s),ii(r))}function JT(r){var s=r.memoizedState,o=0;s!==null&&(o=s.retryLane),Mv(r,o)}function ZT(r,s){var o=0;switch(r.tag){case 31:case 13:var u=r.stateNode,g=r.memoizedState;g!==null&&(o=g.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(s),Mv(r,o)}function eA(r,s){return lt(r,s)}var kd=null,Ao=null,tp=!1,Od=!1,np=!1,bs=0;function ii(r){r!==Ao&&r.next===null&&(Ao===null?kd=Ao=r:Ao=Ao.next=r),Od=!0,tp||(tp=!0,nA())}function vc(r,s){if(!np&&Od){np=!0;do for(var o=!1,u=kd;u!==null;){if(r!==0){var g=u.pendingLanes;if(g===0)var y=0;else{var E=u.suspendedLanes,M=u.pingedLanes;y=(1<<31-Lt(42|r)+1)-1,y&=g&~(E&~M),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,Vv(u,y))}else y=Ze,y=zr(u,u===bt?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||br(u,y)||(o=!0,Vv(u,y));u=u.next}while(o);np=!1}}function tA(){Nv()}function Nv(){Od=tp=!1;var r=0;bs!==0&&hA()&&(r=bs);for(var s=nn(),o=null,u=kd;u!==null;){var g=u.next,y=Pv(u,s);y===0?(u.next=null,o===null?kd=g:o.next=g,g===null&&(Ao=o)):(o=u,(r!==0||(y&3)!==0)&&(Od=!0)),u=g}rn!==0&&rn!==5||vc(r),bs!==0&&(bs=0)}function Pv(r,s){for(var o=r.suspendedLanes,u=r.pingedLanes,g=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var E=31-Lt(y),M=1<<E,G=g[E];G===-1?((M&o)===0||(M&u)!==0)&&(g[E]=jf(M,s)):G<=s&&(r.expiredLanes|=M),y&=~M}if(s=bt,o=Ze,o=zr(r,r===s?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===s&&(ft===2||ft===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&Mt(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||br(r,o)){if(s=o&-o,s===r.callbackPriority)return s;switch(u!==null&&Mt(u),yi(o)){case 2:case 8:o=Dl;break;case 32:o=Wi;break;case 268435456:o=Eu;break;default:o=Wi}return u=Lv.bind(null,r),o=lt(o,u),r.callbackPriority=s,r.callbackNode=o,s}return u!==null&&u!==null&&Mt(u),r.callbackPriority=2,r.callbackNode=null,2}function Lv(r,s){if(rn!==0&&rn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(jd()&&r.callbackNode!==o)return null;var u=Ze;return u=zr(r,r===bt?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(_v(r,u,s),Pv(r,nn()),r.callbackNode!=null&&r.callbackNode===o?Lv.bind(null,r):null)}function Vv(r,s){if(jd())return null;_v(r,s,!0)}function nA(){mA(function(){(ut&6)!==0?lt(Rl,tA):Nv()})}function rp(){if(bs===0){var r=uo;r===0&&(r=Vr,Vr<<=1,(Vr&261888)===0&&(Vr=256)),bs=r}return bs}function Bv(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Wa(""+r)}function zv(r,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,r.id&&o.setAttribute("form",r.id),s.parentNode.insertBefore(o,s),r=new FormData(r),o.parentNode.removeChild(o),r}function rA(r,s,o,u,g){if(s==="submit"&&o&&o.stateNode===g){var y=Bv((g[ln]||null).action),E=u.submitter;E&&(s=(s=E[ln]||null)?Bv(s.formAction):E.getAttribute("formAction"),s!==null&&(y=s,E=null));var M=new Xr("action","action",null,u,g);r.push({event:M,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(bs!==0){var G=E?zv(g,E):new FormData(g);Sm(o,{pending:!0,data:G,method:g.method,action:y},null,G)}}else typeof y=="function"&&(M.preventDefault(),G=E?zv(g,E):new FormData(g),Sm(o,{pending:!0,data:G,method:g.method,action:y},y,G))},currentTarget:g}]})}}for(var ip=0;ip<zf.length;ip++){var sp=zf[ip],iA=sp.toLowerCase(),sA=sp[0].toUpperCase()+sp.slice(1);Rr(iA,"on"+sA)}Rr(y_,"onAnimationEnd"),Rr(__,"onAnimationIteration"),Rr(v_,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(xT,"onTransitionRun"),Rr(ET,"onTransitionStart"),Rr(ST,"onTransitionCancel"),Rr(b_,"onTransitionEnd"),$r("onMouseEnter",["mouseout","mouseover"]),$r("onMouseLeave",["mouseout","mouseover"]),$r("onPointerEnter",["pointerout","pointerover"]),$r("onPointerLeave",["pointerout","pointerover"]),Qr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(bc));function Uv(r,s){s=(s&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],g=u.event;u=u.listeners;e:{var y=void 0;if(s)for(var E=u.length-1;0<=E;E--){var M=u[E],G=M.instance,ae=M.currentTarget;if(M=M.listener,G!==y&&g.isPropagationStopped())break e;y=M,g.currentTarget=ae;try{y(g)}catch(me){Ku(me)}g.currentTarget=null,y=G}else for(E=0;E<u.length;E++){if(M=u[E],G=M.instance,ae=M.currentTarget,M=M.listener,G!==y&&g.isPropagationStopped())break e;y=M,g.currentTarget=ae;try{y(g)}catch(me){Ku(me)}g.currentTarget=null,y=G}}}}function Ye(r,s){var o=s[Ha];o===void 0&&(o=s[Ha]=new Set);var u=r+"__bubble";o.has(u)||(Fv(s,r,2,!1),o.add(u))}function ap(r,s,o){var u=0;s&&(u|=4),Fv(o,r,u,s)}var Md="_reactListening"+Math.random().toString(36).slice(2);function op(r){if(!r[Md]){r[Md]=!0,kl.forEach(function(o){o!=="selectionchange"&&(aA.has(o)||ap(o,!1,r),ap(o,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Md]||(s[Md]=!0,ap("selectionchange",!1,s))}}function Fv(r,s,o,u){switch(yb(s)){case 2:var g=MA;break;case 8:g=NA;break;default:g=Ep}o=g.bind(null,s,o,r),g=void 0,!oa||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),u?g!==void 0?r.addEventListener(s,o,{capture:!0,passive:g}):r.addEventListener(s,o,!0):g!==void 0?r.addEventListener(s,o,{passive:g}):r.addEventListener(s,o,!1)}function lp(r,s,o,u,g){var y=u;if((s&1)===0&&(s&2)===0&&u!==null)e:for(;;){if(u===null)return;var E=u.tag;if(E===3||E===4){var M=u.stateNode.containerInfo;if(M===g)break;if(E===4)for(E=u.return;E!==null;){var G=E.tag;if((G===3||G===4)&&E.stateNode.containerInfo===g)return;E=E.return}for(;M!==null;){if(E=Hr(M),E===null)return;if(G=E.tag,G===5||G===6||G===26||G===27){u=y=E;continue e}M=M.parentNode}}u=u.return}ts(function(){var ae=y,me=sr(o),_e=[];e:{var ce=x_.get(r);if(ce!==void 0){var de=Xr,Ce=r;switch(r){case"keypress":if(ca(o)===0)break e;case"keydown":case"keyup":de=Gu;break;case"focusin":Ce="focus",de=da;break;case"focusout":Ce="blur",de=da;break;case"beforeblur":case"afterblur":de=da;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=Gl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=Pu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=x;break;case y_:case __:case v_:de=Vu;break;case b_:de=B;break;case"scroll":case"scrollend":de=Hl;break;case"wheel":de=ue;break;case"copy":case"cut":case"paste":de=Bu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=bi;break;case"toggle":case"beforetoggle":de=Ge}var Pe=(s&4)!==0,_t=!Pe&&(r==="scroll"||r==="scrollend"),ee=Pe?ce!==null?ce+"Capture":null:ce;Pe=[];for(var W=ae,ie;W!==null;){var ye=W;if(ie=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||ie===null||ee===null||(ye=wr(W,ee),ye!=null&&Pe.push(xc(W,ye,ie))),_t)break;W=W.return}0<Pe.length&&(ce=new de(ce,Ce,null,o,me),_e.push({event:ce,listeners:Pe}))}}if((s&7)===0){e:{if(ce=r==="mouseover"||r==="pointerover",de=r==="mouseout"||r==="pointerout",ce&&o!==Ul&&(Ce=o.relatedTarget||o.fromElement)&&(Hr(Ce)||Ce[Fr]))break e;if((de||ce)&&(ce=me.window===me?me:(ce=me.ownerDocument)?ce.defaultView||ce.parentWindow:window,de?(Ce=o.relatedTarget||o.toElement,de=ae,Ce=Ce?Hr(Ce):null,Ce!==null&&(_t=l(Ce),Pe=Ce.tag,Ce!==_t||Pe!==5&&Pe!==27&&Pe!==6)&&(Ce=null)):(de=null,Ce=ae),de!==Ce)){if(Pe=Gl,ye="onMouseLeave",ee="onMouseEnter",W="mouse",(r==="pointerout"||r==="pointerover")&&(Pe=bi,ye="onPointerLeave",ee="onPointerEnter",W="pointer"),_t=de==null?ce:Gn(de),ie=Ce==null?ce:Gn(Ce),ce=new Pe(ye,W+"leave",de,o,me),ce.target=_t,ce.relatedTarget=ie,ye=null,Hr(me)===ae&&(Pe=new Pe(ee,W+"enter",Ce,o,me),Pe.target=ie,Pe.relatedTarget=_t,ye=Pe),_t=ye,de&&Ce)t:{for(Pe=oA,ee=de,W=Ce,ie=0,ye=ee;ye;ye=Pe(ye))ie++;ye=0;for(var Me=W;Me;Me=Pe(Me))ye++;for(;0<ie-ye;)ee=Pe(ee),ie--;for(;0<ye-ie;)W=Pe(W),ye--;for(;ie--;){if(ee===W||W!==null&&ee===W.alternate){Pe=ee;break t}ee=Pe(ee),W=Pe(W)}Pe=null}else Pe=null;de!==null&&qv(_e,ce,de,Pe,!1),Ce!==null&&_t!==null&&qv(_e,_t,Ce,Pe,!0)}}e:{if(ce=ae?Gn(ae):window,de=ce.nodeName&&ce.nodeName.toLowerCase(),de==="select"||de==="input"&&ce.type==="file")var at=a_;else if(i_(ce))if(o_)at=_T;else{at=gT;var je=pT}else de=ce.nodeName,!de||de.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?ae&&Ka(ae.elementType)&&(at=a_):at=yT;if(at&&(at=at(r,ae))){s_(_e,at,o,me);break e}je&&je(r,ce,ae),r==="focusout"&&ae&&ce.type==="number"&&ae.memoizedProps.value!=null&&Vl(ce,"number",ce.value)}switch(je=ae?Gn(ae):window,r){case"focusin":(i_(je)||je.contentEditable==="true")&&(no=je,Lf=ae,Yl=null);break;case"focusout":Yl=Lf=no=null;break;case"mousedown":Vf=!0;break;case"contextmenu":case"mouseup":case"dragend":Vf=!1,p_(_e,o,me);break;case"selectionchange":if(bT)break;case"keydown":case"keyup":p_(_e,o,me)}var $e;if(ct)e:{switch(r){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else to?ha(r,o)&&(et="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(et="onCompositionStart");et&&(ei&&o.locale!=="ko"&&(to||et!=="onCompositionStart"?et==="onCompositionEnd"&&to&&($e=ql()):(Yr=me,Fl="value"in Yr?Yr.value:Yr.textContent,to=!0)),je=Nd(ae,et),0<je.length&&(et=new Zr(et,r,null,o,me),_e.push({event:et,listeners:je}),$e?et.data=$e:($e=eo(o),$e!==null&&(et.data=$e)))),($e=or?dT(r,o):hT(r,o))&&(et=Nd(ae,"onBeforeInput"),0<et.length&&(je=new Zr("onBeforeInput","beforeinput",null,o,me),_e.push({event:je,listeners:et}),je.data=$e)),rA(_e,r,ae,o,me)}Uv(_e,s)})}function xc(r,s,o){return{instance:r,listener:s,currentTarget:o}}function Nd(r,s){for(var o=s+"Capture",u=[];r!==null;){var g=r,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=wr(r,o),g!=null&&u.unshift(xc(r,g,y)),g=wr(r,s),g!=null&&u.push(xc(r,g,y))),r.tag===3)return u;r=r.return}return[]}function oA(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function qv(r,s,o,u,g){for(var y=s._reactName,E=[];o!==null&&o!==u;){var M=o,G=M.alternate,ae=M.stateNode;if(M=M.tag,G!==null&&G===u)break;M!==5&&M!==26&&M!==27||ae===null||(G=ae,g?(ae=wr(o,y),ae!=null&&E.unshift(xc(o,ae,G))):g||(ae=wr(o,y),ae!=null&&E.push(xc(o,ae,G)))),o=o.return}E.length!==0&&r.push({event:s,listeners:E})}var lA=/\r\n?/g,cA=/\u0000|\uFFFD/g;function Hv(r){return(typeof r=="string"?r:""+r).replace(lA,`
`).replace(cA,"")}function Gv(r,s){return s=Hv(s),Hv(r)===s}function yt(r,s,o,u,g,y){switch(o){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||Mn(r,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&Mn(r,""+u);break;case"className":Qn(r,"class",u);break;case"tabIndex":Qn(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Qn(r,o,u);break;case"style":zl(r,u,y);break;case"data":if(s!=="object"){Qn(r,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=Wa(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&yt(r,s,"name",g.name,g,null),yt(r,s,"formEncType",g.formEncType,g,null),yt(r,s,"formMethod",g.formMethod,g,null),yt(r,s,"formTarget",g.formTarget,g,null)):(yt(r,s,"encType",g.encType,g,null),yt(r,s,"method",g.method,g,null),yt(r,s,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=Wa(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=Sr);break;case"onScroll":u!=null&&Ye("scroll",r);break;case"onScrollEnd":u!=null&&Ye("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=Wa(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":Ye("beforetoggle",r),Ye("toggle",r),Qa(r,"popover",u);break;case"xlinkActuate":$t(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":$t(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":$t(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":$t(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":$t(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":$t(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":$t(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":$t(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":$t(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Qa(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Nu.get(o)||o,Qa(r,o,u))}}function cp(r,s,o,u,g,y){switch(o){case"style":zl(r,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"children":typeof u=="string"?Mn(r,u):(typeof u=="number"||typeof u=="bigint")&&Mn(r,""+u);break;case"onScroll":u!=null&&Ye("scroll",r);break;case"onScrollEnd":u!=null&&Ye("scrollend",r);break;case"onClick":u!=null&&(r.onclick=Sr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ol.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),s=o.slice(2,g?o.length-7:void 0),y=r[ln]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(s,y,g),typeof u=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(s,u,g);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):Qa(r,o,u)}}}function vn(r,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ye("error",r),Ye("load",r);var u=!1,g=!1,y;for(y in o)if(o.hasOwnProperty(y)){var E=o[y];if(E!=null)switch(y){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:yt(r,s,y,E,o,null)}}g&&yt(r,s,"srcSet",o.srcSet,o,null),u&&yt(r,s,"src",o.src,o,null);return;case"input":Ye("invalid",r);var M=y=E=g=null,G=null,ae=null;for(u in o)if(o.hasOwnProperty(u)){var me=o[u];if(me!=null)switch(u){case"name":g=me;break;case"type":E=me;break;case"checked":G=me;break;case"defaultChecked":ae=me;break;case"value":y=me;break;case"defaultValue":M=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,s));break;default:yt(r,s,u,me,o,null)}}ku(r,y,M,G,ae,E,g,!1);return;case"select":Ye("invalid",r),u=E=y=null;for(g in o)if(o.hasOwnProperty(g)&&(M=o[g],M!=null))switch(g){case"value":y=M;break;case"defaultValue":E=M;break;case"multiple":u=M;default:yt(r,s,g,M,o,null)}s=y,o=E,r.multiple=!!u,s!=null?Xi(r,!!u,s,!1):o!=null&&Xi(r,!!u,o,!0);return;case"textarea":Ye("invalid",r),y=g=u=null;for(E in o)if(o.hasOwnProperty(E)&&(M=o[E],M!=null))switch(E){case"value":u=M;break;case"defaultValue":g=M;break;case"children":y=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(i(91));break;default:yt(r,s,E,M,o,null)}Ji(r,u,g,y);return;case"option":for(G in o)o.hasOwnProperty(G)&&(u=o[G],u!=null)&&(G==="selected"?r.selected=u&&typeof u!="function"&&typeof u!="symbol":yt(r,s,G,u,o,null));return;case"dialog":Ye("beforetoggle",r),Ye("toggle",r),Ye("cancel",r),Ye("close",r);break;case"iframe":case"object":Ye("load",r);break;case"video":case"audio":for(u=0;u<bc.length;u++)Ye(bc[u],r);break;case"image":Ye("error",r),Ye("load",r);break;case"details":Ye("toggle",r);break;case"embed":case"source":case"link":Ye("error",r),Ye("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in o)if(o.hasOwnProperty(ae)&&(u=o[ae],u!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:yt(r,s,ae,u,o,null)}return;default:if(Ka(s)){for(me in o)o.hasOwnProperty(me)&&(u=o[me],u!==void 0&&cp(r,s,me,u,o,void 0));return}}for(M in o)o.hasOwnProperty(M)&&(u=o[M],u!=null&&yt(r,s,M,u,o,null))}function uA(r,s,o,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,E=null,M=null,G=null,ae=null,me=null;for(de in o){var _e=o[de];if(o.hasOwnProperty(de)&&_e!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":G=_e;default:u.hasOwnProperty(de)||yt(r,s,de,null,u,_e)}}for(var ce in u){var de=u[ce];if(_e=o[ce],u.hasOwnProperty(ce)&&(de!=null||_e!=null))switch(ce){case"type":y=de;break;case"name":g=de;break;case"checked":ae=de;break;case"defaultChecked":me=de;break;case"value":E=de;break;case"defaultValue":M=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,s));break;default:de!==_e&&yt(r,s,ce,de,u,_e)}}$a(r,E,M,G,ae,me,y,g);return;case"select":de=E=M=ce=null;for(y in o)if(G=o[y],o.hasOwnProperty(y)&&G!=null)switch(y){case"value":break;case"multiple":de=G;default:u.hasOwnProperty(y)||yt(r,s,y,null,u,G)}for(g in u)if(y=u[g],G=o[g],u.hasOwnProperty(g)&&(y!=null||G!=null))switch(g){case"value":ce=y;break;case"defaultValue":M=y;break;case"multiple":E=y;default:y!==G&&yt(r,s,g,y,u,G)}s=M,o=E,u=de,ce!=null?Xi(r,!!o,ce,!1):!!u!=!!o&&(s!=null?Xi(r,!!o,s,!0):Xi(r,!!o,o?[]:"",!1));return;case"textarea":de=ce=null;for(M in o)if(g=o[M],o.hasOwnProperty(M)&&g!=null&&!u.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:yt(r,s,M,null,u,g)}for(E in u)if(g=u[E],y=o[E],u.hasOwnProperty(E)&&(g!=null||y!=null))switch(E){case"value":ce=g;break;case"defaultValue":de=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==y&&yt(r,s,E,g,u,y)}Ou(r,ce,de);return;case"option":for(var Ce in o)ce=o[Ce],o.hasOwnProperty(Ce)&&ce!=null&&!u.hasOwnProperty(Ce)&&(Ce==="selected"?r.selected=!1:yt(r,s,Ce,null,u,ce));for(G in u)ce=u[G],de=o[G],u.hasOwnProperty(G)&&ce!==de&&(ce!=null||de!=null)&&(G==="selected"?r.selected=ce&&typeof ce!="function"&&typeof ce!="symbol":yt(r,s,G,ce,u,de));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pe in o)ce=o[Pe],o.hasOwnProperty(Pe)&&ce!=null&&!u.hasOwnProperty(Pe)&&yt(r,s,Pe,null,u,ce);for(ae in u)if(ce=u[ae],de=o[ae],u.hasOwnProperty(ae)&&ce!==de&&(ce!=null||de!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,s));break;default:yt(r,s,ae,ce,u,de)}return;default:if(Ka(s)){for(var _t in o)ce=o[_t],o.hasOwnProperty(_t)&&ce!==void 0&&!u.hasOwnProperty(_t)&&cp(r,s,_t,void 0,u,ce);for(me in u)ce=u[me],de=o[me],!u.hasOwnProperty(me)||ce===de||ce===void 0&&de===void 0||cp(r,s,me,ce,u,de);return}}for(var ee in o)ce=o[ee],o.hasOwnProperty(ee)&&ce!=null&&!u.hasOwnProperty(ee)&&yt(r,s,ee,null,u,ce);for(_e in u)ce=u[_e],de=o[_e],!u.hasOwnProperty(_e)||ce===de||ce==null&&de==null||yt(r,s,_e,ce,u,de)}function Qv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function dA(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var g=o[u],y=g.transferSize,E=g.initiatorType,M=g.duration;if(y&&M&&Qv(E)){for(E=0,M=g.responseEnd,u+=1;u<o.length;u++){var G=o[u],ae=G.startTime;if(ae>M)break;var me=G.transferSize,_e=G.initiatorType;me&&Qv(_e)&&(G=G.responseEnd,E+=me*(G<M?1:(M-ae)/(G-ae)))}if(--u,s+=8*(y+E)/(g.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var up=null,dp=null;function Pd(r){return r.nodeType===9?r:r.ownerDocument}function $v(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Kv(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function hp(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var fp=null;function hA(){var r=window.event;return r&&r.type==="popstate"?r===fp?!1:(fp=r,!0):(fp=null,!1)}var Wv=typeof setTimeout=="function"?setTimeout:void 0,fA=typeof clearTimeout=="function"?clearTimeout:void 0,Yv=typeof Promise=="function"?Promise:void 0,mA=typeof queueMicrotask=="function"?queueMicrotask:typeof Yv<"u"?function(r){return Yv.resolve(null).then(r).catch(pA)}:Wv;function pA(r){setTimeout(function(){throw r})}function xs(r){return r==="head"}function Xv(r,s){var o=s,u=0;do{var g=o.nextSibling;if(r.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(u===0){r.removeChild(g),Io(s);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")Ec(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,Ec(o);for(var y=o.firstChild;y;){var E=y.nextSibling,M=y.nodeName;y[qr]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=E}}else o==="body"&&Ec(r.ownerDocument.body);o=g}while(o);Io(s)}function Jv(r,s){var o=r;r=0;do{var u=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=u}while(o)}function mp(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":mp(o),Ga(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function gA(r,s,o,u){for(;r.nodeType===1;){var g=o;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[qr])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=mr(r.nextSibling),r===null)break}return null}function yA(r,s,o){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=mr(r.nextSibling),r===null))return null;return r}function Zv(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=mr(r.nextSibling),r===null))return null;return r}function pp(r){return r.data==="$?"||r.data==="$~"}function gp(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function _A(r,s){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||o.readyState!=="loading")s();else{var u=function(){s(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function mr(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var yp=null;function eb(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(s===0)return mr(r.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}r=r.nextSibling}return null}function tb(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return r;s--}else o!=="/$"&&o!=="/&"||s++}r=r.previousSibling}return null}function nb(r,s,o){switch(s=Pd(o),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Ec(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);Ga(r)}var pr=new Map,rb=new Set;function Ld(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ni=$.d;$.d={f:vA,r:bA,D:xA,C:EA,L:SA,m:wA,X:AA,S:TA,M:CA};function vA(){var r=Ni.f(),s=Rd();return r||s}function bA(r){var s=ir(r);s!==null&&s.tag===5&&s.type==="form"?b0(s):Ni.r(r)}var Co=typeof document>"u"?null:document;function ib(r,s,o){var u=Co;if(u&&typeof s=="string"&&s){var g=On(s);g='link[rel="'+r+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),rb.has(g)||(rb.add(g),r={rel:r,crossOrigin:o,href:s},u.querySelector(g)===null&&(s=u.createElement("link"),vn(s,"link",r),Qt(s),u.head.appendChild(s)))}}function xA(r){Ni.D(r),ib("dns-prefetch",r,null)}function EA(r,s){Ni.C(r,s),ib("preconnect",r,s)}function SA(r,s,o){Ni.L(r,s,o);var u=Co;if(u&&r&&s){var g='link[rel="preload"][as="'+On(s)+'"]';s==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+On(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+On(o.imageSizes)+'"]')):g+='[href="'+On(r)+'"]';var y=g;switch(s){case"style":y=Ro(r);break;case"script":y=Do(r)}pr.has(y)||(r=v({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:r,as:s},o),pr.set(y,r),u.querySelector(g)!==null||s==="style"&&u.querySelector(Sc(y))||s==="script"&&u.querySelector(wc(y))||(s=u.createElement("link"),vn(s,"link",r),Qt(s),u.head.appendChild(s)))}}function wA(r,s){Ni.m(r,s);var o=Co;if(o&&r){var u=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+On(u)+'"][href="'+On(r)+'"]',y=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Do(r)}if(!pr.has(y)&&(r=v({rel:"modulepreload",href:r},s),pr.set(y,r),o.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(wc(y)))return}u=o.createElement("link"),vn(u,"link",r),Qt(u),o.head.appendChild(u)}}}function TA(r,s,o){Ni.S(r,s,o);var u=Co;if(u&&r){var g=Gr(u).hoistableStyles,y=Ro(r);s=s||"default";var E=g.get(y);if(!E){var M={loading:0,preload:null};if(E=u.querySelector(Sc(y)))M.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":s},o),(o=pr.get(y))&&_p(r,o);var G=E=u.createElement("link");Qt(G),vn(G,"link",r),G._p=new Promise(function(ae,me){G.onload=ae,G.onerror=me}),G.addEventListener("load",function(){M.loading|=1}),G.addEventListener("error",function(){M.loading|=2}),M.loading|=4,Vd(E,s,u)}E={type:"stylesheet",instance:E,count:1,state:M},g.set(y,E)}}}function AA(r,s){Ni.X(r,s);var o=Co;if(o&&r){var u=Gr(o).hoistableScripts,g=Do(r),y=u.get(g);y||(y=o.querySelector(wc(g)),y||(r=v({src:r,async:!0},s),(s=pr.get(g))&&vp(r,s),y=o.createElement("script"),Qt(y),vn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function CA(r,s){Ni.M(r,s);var o=Co;if(o&&r){var u=Gr(o).hoistableScripts,g=Do(r),y=u.get(g);y||(y=o.querySelector(wc(g)),y||(r=v({src:r,async:!0,type:"module"},s),(s=pr.get(g))&&vp(r,s),y=o.createElement("script"),Qt(y),vn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function sb(r,s,o,u){var g=(g=ge.current)?Ld(g):null;if(!g)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Ro(o.href),o=Gr(g).hoistableStyles,u=o.get(s),u||(u={type:"style",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=Ro(o.href);var y=Gr(g).hoistableStyles,E=y.get(r);if(E||(g=g.ownerDocument||g,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,E),(y=g.querySelector(Sc(r)))&&!y._p&&(E.instance=y,E.state.loading=5),pr.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},pr.set(r,o),y||RA(g,r,o,E.state))),s&&u===null)throw Error(i(528,""));return E}if(s&&u!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Do(o),o=Gr(g).hoistableScripts,u=o.get(s),u||(u={type:"script",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Ro(r){return'href="'+On(r)+'"'}function Sc(r){return'link[rel="stylesheet"]['+r+"]"}function ab(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function RA(r,s,o,u){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=r.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),vn(s,"link",o),Qt(s),r.head.appendChild(s))}function Do(r){return'[src="'+On(r)+'"]'}function wc(r){return"script[async]"+r}function ob(r,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var u=r.querySelector('style[data-href~="'+On(o.href)+'"]');if(u)return s.instance=u,Qt(u),u;var g=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),Qt(u),vn(u,"style",g),Vd(u,o.precedence,r),s.instance=u;case"stylesheet":g=Ro(o.href);var y=r.querySelector(Sc(g));if(y)return s.state.loading|=4,s.instance=y,Qt(y),y;u=ab(o),(g=pr.get(g))&&_p(u,g),y=(r.ownerDocument||r).createElement("link"),Qt(y);var E=y;return E._p=new Promise(function(M,G){E.onload=M,E.onerror=G}),vn(y,"link",u),s.state.loading|=4,Vd(y,o.precedence,r),s.instance=y;case"script":return y=Do(o.src),(g=r.querySelector(wc(y)))?(s.instance=g,Qt(g),g):(u=o,(g=pr.get(y))&&(u=v({},o),vp(u,g)),r=r.ownerDocument||r,g=r.createElement("script"),Qt(g),vn(g,"link",u),r.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(u=s.instance,s.state.loading|=4,Vd(u,o.precedence,r));return s.instance}function Vd(r,s,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,y=g,E=0;E<u.length;E++){var M=u[E];if(M.dataset.precedence===s)y=M;else if(y!==g)break}y?y.parentNode.insertBefore(r,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(r,s.firstChild))}function _p(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function vp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var Bd=null;function lb(r,s,o){if(Bd===null){var u=new Map,g=Bd=new Map;g.set(o,u)}else g=Bd,u=g.get(o),u||(u=new Map,g.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),g=0;g<o.length;g++){var y=o[g];if(!(y[qr]||y[Gt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var E=y.getAttribute(s)||"";E=r+E;var M=u.get(E);M?M.push(y):u.set(E,[y])}}return u}function cb(r,s,o){r=r.ownerDocument||r,r.head.insertBefore(o,s==="title"?r.querySelector("head > title"):null)}function DA(r,s,o){if(o===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function ub(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function IA(r,s,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Ro(u.href),y=s.querySelector(Sc(g));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=zd.bind(r),s.then(r,r)),o.state.loading|=4,o.instance=y,Qt(y);return}y=s.ownerDocument||s,u=ab(u),(g=pr.get(g))&&_p(u,g),y=y.createElement("link"),Qt(y);var E=y;E._p=new Promise(function(M,G){E.onload=M,E.onerror=G}),vn(y,"link",u),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=zd.bind(r),s.addEventListener("load",o),s.addEventListener("error",o))}}var bp=0;function jA(r,s){return r.stylesheets&&r.count===0&&Fd(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var u=setTimeout(function(){if(r.stylesheets&&Fd(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+s);0<r.imgBytes&&bp===0&&(bp=62500*dA());var g=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Fd(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>bp?50:800)+s);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function zd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Fd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Ud=null;function Fd(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Ud=new Map,s.forEach(kA,r),Ud=null,zd.call(r))}function kA(r,s){if(!(s.state.loading&4)){var o=Ud.get(r);if(o)var u=o.get(null);else{o=new Map,Ud.set(r,o);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var E=g[y];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),u=E)}u&&o.set(null,u)}g=s.instance,E=g.getAttribute("data-precedence"),y=o.get(E)||u,y===u&&o.set(null,g),o.set(E,g),this.count++,u=zd.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),y?y.parentNode.insertBefore(g,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),s.state.loading|=4}}var Tc={$$typeof:U,Provider:null,Consumer:null,_currentValue:Y,_currentValue2:Y,_threadCount:0};function OA(r,s,o,u,g,y,E,M,G){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ur(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ur(0),this.hiddenUpdates=Ur(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function db(r,s,o,u,g,y,E,M,G,ae,me,_e){return r=new OA(r,s,o,E,G,ae,me,_e,M),s=1,y===!0&&(s|=24),y=Kn(3,null,null,s),r.current=y,y.stateNode=r,s=Zf(),s.refCount++,r.pooledCache=s,s.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:s},rm(y),r}function hb(r){return r?(r=so,r):so}function fb(r,s,o,u,g,y){g=hb(g),u.context===null?u.context=g:u.pendingContext=g,u=us(s),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=ds(r,u,s),o!==null&&(Bn(o,r,s),rc(o,r,s))}function mb(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<s?o:s}}function xp(r,s){mb(r,s),(r=r.alternate)&&mb(r,s)}function pb(r){if(r.tag===13||r.tag===31){var s=pa(r,67108864);s!==null&&Bn(s,r,67108864),xp(r,67108864)}}function gb(r){if(r.tag===13||r.tag===31){var s=Zn();s=ra(s);var o=pa(r,s);o!==null&&Bn(o,r,s),xp(r,s)}}var qd=!0;function MA(r,s,o,u){var g=L.T;L.T=null;var y=$.p;try{$.p=2,Ep(r,s,o,u)}finally{$.p=y,L.T=g}}function NA(r,s,o,u){var g=L.T;L.T=null;var y=$.p;try{$.p=8,Ep(r,s,o,u)}finally{$.p=y,L.T=g}}function Ep(r,s,o,u){if(qd){var g=Sp(u);if(g===null)lp(r,s,u,Hd,o),_b(r,u);else if(LA(g,r,s,o,u))u.stopPropagation();else if(_b(r,u),s&4&&-1<PA.indexOf(r)){for(;g!==null;){var y=ir(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var E=Br(y.pendingLanes);if(E!==0){var M=y;for(M.pendingLanes|=2,M.entangledLanes|=2;E;){var G=1<<31-Lt(E);M.entanglements[1]|=G,E&=~G}ii(y),(ut&6)===0&&(Ad=nn()+500,vc(0))}}break;case 31:case 13:M=pa(y,2),M!==null&&Bn(M,y,2),Rd(),xp(y,2)}if(y=Sp(u),y===null&&lp(r,s,u,Hd,o),y===g)break;g=y}g!==null&&u.stopPropagation()}else lp(r,s,u,null,o)}}function Sp(r){return r=sr(r),wp(r)}var Hd=null;function wp(r){if(Hd=null,r=Hr(r),r!==null){var s=l(r);if(s===null)r=null;else{var o=s.tag;if(o===13){if(r=c(s),r!==null)return r;r=null}else if(o===31){if(r=h(s),r!==null)return r;r=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return Hd=r,null}function yb(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Zs()){case Rl:return 2;case Dl:return 8;case Wi:case If:return 32;case Eu:return 268435456;default:return 32}default:return 32}}var Tp=!1,Es=null,Ss=null,ws=null,Ac=new Map,Cc=new Map,Ts=[],PA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _b(r,s){switch(r){case"focusin":case"focusout":Es=null;break;case"dragenter":case"dragleave":Ss=null;break;case"mouseover":case"mouseout":ws=null;break;case"pointerover":case"pointerout":Ac.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cc.delete(s.pointerId)}}function Rc(r,s,o,u,g,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[g]},s!==null&&(s=ir(s),s!==null&&pb(s)),r):(r.eventSystemFlags|=u,s=r.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),r)}function LA(r,s,o,u,g){switch(s){case"focusin":return Es=Rc(Es,r,s,o,u,g),!0;case"dragenter":return Ss=Rc(Ss,r,s,o,u,g),!0;case"mouseover":return ws=Rc(ws,r,s,o,u,g),!0;case"pointerover":var y=g.pointerId;return Ac.set(y,Rc(Ac.get(y)||null,r,s,o,u,g)),!0;case"gotpointercapture":return y=g.pointerId,Cc.set(y,Rc(Cc.get(y)||null,r,s,o,u,g)),!0}return!1}function vb(r){var s=Hr(r.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){r.blockedOn=s,xr(r.priority,function(){gb(o)});return}}else if(s===31){if(s=h(o),s!==null){r.blockedOn=s,xr(r.priority,function(){gb(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Gd(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var o=Sp(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);Ul=u,o.target.dispatchEvent(u),Ul=null}else return s=ir(o),s!==null&&pb(s),r.blockedOn=o,!1;s.shift()}return!0}function bb(r,s,o){Gd(r)&&o.delete(s)}function VA(){Tp=!1,Es!==null&&Gd(Es)&&(Es=null),Ss!==null&&Gd(Ss)&&(Ss=null),ws!==null&&Gd(ws)&&(ws=null),Ac.forEach(bb),Cc.forEach(bb)}function Qd(r,s){r.blockedOn===s&&(r.blockedOn=null,Tp||(Tp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,VA)))}var $d=null;function xb(r){$d!==r&&($d=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){$d===r&&($d=null);for(var s=0;s<r.length;s+=3){var o=r[s],u=r[s+1],g=r[s+2];if(typeof u!="function"){if(wp(u||o)===null)continue;break}var y=ir(o);y!==null&&(r.splice(s,3),s-=3,Sm(y,{pending:!0,data:g,method:o.method,action:u},u,g))}}))}function Io(r){function s(G){return Qd(G,r)}Es!==null&&Qd(Es,r),Ss!==null&&Qd(Ss,r),ws!==null&&Qd(ws,r),Ac.forEach(s),Cc.forEach(s);for(var o=0;o<Ts.length;o++){var u=Ts[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<Ts.length&&(o=Ts[0],o.blockedOn===null);)vb(o),o.blockedOn===null&&Ts.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var g=o[u],y=o[u+1],E=g[ln]||null;if(typeof y=="function")E||xb(o);else if(E){var M=null;if(y&&y.hasAttribute("formAction")){if(g=y,E=y[ln]||null)M=E.formAction;else if(wp(g)!==null)continue}else M=E.action;typeof M=="function"?o[u+1]=M:(o.splice(u,3),u-=3),xb(o)}}}function Eb(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(E){return g=E})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function Ap(r){this._internalRoot=r}Kd.prototype.render=Ap.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,u=Zn();fb(o,u,r,s,null,null)},Kd.prototype.unmount=Ap.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;fb(r.current,2,null,r,null,null),Rd(),s[Fr]=null}};function Kd(r){this._internalRoot=r}Kd.prototype.unstable_scheduleHydration=function(r){if(r){var s=Ru();r={blockedOn:null,target:r,priority:s};for(var o=0;o<Ts.length&&s!==0&&s<Ts[o].priority;o++);Ts.splice(o,0,r),o===0&&vb(r)}};var Sb=e.version;if(Sb!=="19.2.3")throw Error(i(527,Sb,"19.2.3"));$.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=p(s),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var BA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wd.isDisabled&&Wd.supportsFiber)try{vr=Wd.inject(BA),mn=Wd}catch{}}return Ic.createRoot=function(r,s){if(!a(r))throw Error(i(299));var o=!1,u="",g=I0,y=j0,E=k0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(E=s.onRecoverableError)),s=db(r,1,!1,null,null,o,u,null,g,y,E,Eb),r[Fr]=s.current,op(r),new Ap(s)},Ic.hydrateRoot=function(r,s,o){if(!a(r))throw Error(i(299));var u=!1,g="",y=I0,E=j0,M=k0,G=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(M=o.onRecoverableError),o.formState!==void 0&&(G=o.formState)),s=db(r,1,!0,s,o??null,u,g,G,y,E,M,Eb),s.context=hb(null),o=s.current,u=Zn(),u=ra(u),g=us(u),g.callback=null,ds(o,g,u),o=u,s.current.lanes=o,ta(s,o),ii(s),r[Fr]=s.current,op(r),new Kd(s)},Ic.version="19.2.3",Ic}var Ob;function WA(){if(Ob)return Dp.exports;Ob=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Dp.exports=KA(),Dp.exports}var YA=WA();var Mb="popstate";function XA(t={}){function e(i,a){let{pathname:l,search:c,hash:h}=i.location;return eg("",{pathname:l,search:c,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:Gc(a)}return ZA(e,n,null,t)}function jt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function tr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function JA(){return Math.random().toString(36).substring(2,10)}function Nb(t,e){return{usr:t.state,key:t.key,idx:e}}function eg(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?cl(e):e,state:n,key:e&&e.key||i||JA()}}function Gc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function cl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function ZA(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,h="POP",f=null,p=_();p==null&&(p=0,c.replaceState({...c.state,idx:p},""));function _(){return(c.state||{idx:null}).idx}function v(){h="POP";let j=_(),z=j==null?null:j-p;p=j,f&&f({action:h,location:C.location,delta:z})}function b(j,z){h="PUSH";let q=eg(C.location,j,z);p=_()+1;let U=Nb(q,p),Z=C.createHref(q);try{c.pushState(U,"",Z)}catch(J){if(J instanceof DOMException&&J.name==="DataCloneError")throw J;a.location.assign(Z)}l&&f&&f({action:h,location:C.location,delta:1})}function S(j,z){h="REPLACE";let q=eg(C.location,j,z);p=_();let U=Nb(q,p),Z=C.createHref(q);c.replaceState(U,"",Z),l&&f&&f({action:h,location:C.location,delta:0})}function T(j){return eC(j)}let C={get action(){return h},get location(){return t(a,c)},listen(j){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Mb,v),f=j,()=>{a.removeEventListener(Mb,v),f=null}},createHref(j){return e(a,j)},createURL:T,encodeLocation(j){let z=T(j);return{pathname:z.pathname,search:z.search,hash:z.hash}},push:b,replace:S,go(j){return c.go(j)}};return C}function eC(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),jt(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Gc(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function HE(t,e,n="/"){return tC(t,e,n,!1)}function tC(t,e,n,i){let a=typeof e=="string"?cl(e):e,l=Fi(a.pathname||"/",n);if(l==null)return null;let c=GE(t);nC(c);let h=null;for(let f=0;h==null&&f<c.length;++f){let p=fC(l);h=dC(c[f],p,i)}return h}function GE(t,e=[],n=[],i="",a=!1){let l=(c,h,f=a,p)=>{let _={relativePath:p===void 0?c.path||"":p,caseSensitive:c.caseSensitive===!0,childrenIndex:h,route:c};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&f)return;jt(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let v=zi([i,_.relativePath]),b=n.concat(_);c.children&&c.children.length>0&&(jt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),GE(c.children,e,b,v,f)),!(c.path==null&&!c.index)&&e.push({path:v,score:cC(v,c.index),routesMeta:b})};return t.forEach((c,h)=>{if(c.path===""||!c.path?.includes("?"))l(c,h);else for(let f of QE(c.path))l(c,h,!0,f)}),e}function QE(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=QE(i.join("/")),h=[];return h.push(...c.map(f=>f===""?l:[l,f].join("/"))),a&&h.push(...c),h.map(f=>t.startsWith("/")&&f===""?"/":f)}function nC(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:uC(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var rC=/^:[\w-]+$/,iC=3,sC=2,aC=1,oC=10,lC=-2,Pb=t=>t==="*";function cC(t,e){let n=t.split("/"),i=n.length;return n.some(Pb)&&(i+=lC),e&&(i+=sC),n.filter(a=>!Pb(a)).reduce((a,l)=>a+(rC.test(l)?iC:l===""?aC:oC),i)}function uC(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function dC(t,e,n=!1){let{routesMeta:i}=t,a={},l="/",c=[];for(let h=0;h<i.length;++h){let f=i[h],p=h===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",v=wh({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},_),b=f.route;if(!v&&p&&n&&!i[i.length-1].route.index&&(v=wh({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},_)),!v)return null;Object.assign(a,v.params),c.push({params:a,pathname:zi([l,v.pathname]),pathnameBase:yC(zi([l,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(l=zi([l,v.pathnameBase]))}return c}function wh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=hC(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:i.reduce((p,{paramName:_,isOptional:v},b)=>{if(_==="*"){let T=h[b]||"";c=l.slice(0,l.length-T.length).replace(/(.)\/+$/,"$1")}const S=h[b];return v&&!S?p[_]=void 0:p[_]=(S||"").replace(/%2F/g,"/"),p},{}),pathname:l,pathnameBase:c,pattern:t}}function hC(t,e=!1,n=!0){tr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,h,f)=>(i.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function fC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return tr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Fi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var $E=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mC=t=>$E.test(t);function pC(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?cl(t):t,l;if(n)if(mC(n))l=n;else{if(n.includes("//")){let c=n;n=n.replace(/\/\/+/g,"/"),tr(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${n}`)}n.startsWith("/")?l=Lb(n.substring(1),"/"):l=Lb(n,e)}else l=e;return{pathname:l,search:_C(i),hash:vC(a)}}function Lb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Op(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function gC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function qg(t){let e=gC(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function Hg(t,e,n,i=!1){let a;typeof t=="string"?a=cl(t):(a={...t},jt(!a.pathname||!a.pathname.includes("?"),Op("?","pathname","search",a)),jt(!a.pathname||!a.pathname.includes("#"),Op("#","pathname","hash",a)),jt(!a.search||!a.search.includes("#"),Op("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,h;if(c==null)h=n;else{let v=e.length-1;if(!i&&c.startsWith("..")){let b=c.split("/");for(;b[0]==="..";)b.shift(),v-=1;a.pathname=b.join("/")}h=v>=0?e[v]:"/"}let f=pC(a,h),p=c&&c!=="/"&&c.endsWith("/"),_=(l||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(p||_)&&(f.pathname+="/"),f}var zi=t=>t.join("/").replace(/\/\/+/g,"/"),yC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),_C=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,vC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,bC=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function xC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function EC(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var KE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function WE(t,e){let n=t;if(typeof n!="string"||!$E.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if(KE)try{let l=new URL(window.location.href),c=n.startsWith("//")?new URL(l.protocol+n):new URL(n),h=Fi(c.pathname,e);c.origin===l.origin&&h!=null?n=h+c.search+c.hash:a=!0}catch{tr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var YE=["POST","PUT","PATCH","DELETE"];new Set(YE);var SC=["GET",...YE];new Set(SC);var ul=R.createContext(null);ul.displayName="DataRouter";var Jh=R.createContext(null);Jh.displayName="DataRouterState";var wC=R.createContext(!1),XE=R.createContext({isTransitioning:!1});XE.displayName="ViewTransition";var TC=R.createContext(new Map);TC.displayName="Fetchers";var AC=R.createContext(null);AC.displayName="Await";var nr=R.createContext(null);nr.displayName="Navigation";var iu=R.createContext(null);iu.displayName="Location";var _r=R.createContext({outlet:null,matches:[],isDataRoute:!1});_r.displayName="Route";var Gg=R.createContext(null);Gg.displayName="RouteError";var JE="REACT_ROUTER_ERROR",CC="REDIRECT",RC="ROUTE_ERROR_RESPONSE";function DC(t){if(t.startsWith(`${JE}:${CC}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function IC(t){if(t.startsWith(`${JE}:${RC}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new bC(e.status,e.statusText,e.data)}catch{}}function jC(t,{relative:e}={}){jt(dl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=R.useContext(nr),{hash:a,pathname:l,search:c}=au(t,{relative:e}),h=l;return n!=="/"&&(h=l==="/"?n:zi([n,l])),i.createHref({pathname:h,search:c,hash:a})}function dl(){return R.useContext(iu)!=null}function kn(){return jt(dl(),"useLocation() may be used only in the context of a <Router> component."),R.useContext(iu).location}var ZE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function eS(t){R.useContext(nr).static||R.useLayoutEffect(t)}function su(){let{isDataRoute:t}=R.useContext(_r);return t?$C():kC()}function kC(){jt(dl(),"useNavigate() may be used only in the context of a <Router> component.");let t=R.useContext(ul),{basename:e,navigator:n}=R.useContext(nr),{matches:i}=R.useContext(_r),{pathname:a}=kn(),l=JSON.stringify(qg(i)),c=R.useRef(!1);return eS(()=>{c.current=!0}),R.useCallback((f,p={})=>{if(tr(c.current,ZE),!c.current)return;if(typeof f=="number"){n.go(f);return}let _=Hg(f,JSON.parse(l),a,p.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:zi([e,_.pathname])),(p.replace?n.replace:n.push)(_,p.state,p)},[e,n,l,a,t])}var OC=R.createContext(null);function MC(t){let e=R.useContext(_r).outlet;return R.useMemo(()=>e&&R.createElement(OC.Provider,{value:t},e),[e,t])}function NC(){let{matches:t}=R.useContext(_r),e=t[t.length-1];return e?e.params:{}}function au(t,{relative:e}={}){let{matches:n}=R.useContext(_r),{pathname:i}=kn(),a=JSON.stringify(qg(n));return R.useMemo(()=>Hg(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function PC(t,e){return tS(t,e)}function tS(t,e,n,i,a){jt(dl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=R.useContext(nr),{matches:c}=R.useContext(_r),h=c[c.length-1],f=h?h.params:{},p=h?h.pathname:"/",_=h?h.pathnameBase:"/",v=h&&h.route;{let q=v&&v.path||"";rS(p,!v||q.endsWith("*")||q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${q}"> to <Route path="${q==="/"?"*":`${q}/*`}">.`)}let b=kn(),S;if(e){let q=typeof e=="string"?cl(e):e;jt(_==="/"||q.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${q.pathname}" was given in the \`location\` prop.`),S=q}else S=b;let T=S.pathname||"/",C=T;if(_!=="/"){let q=_.replace(/^\//,"").split("/");C="/"+T.replace(/^\//,"").split("/").slice(q.length).join("/")}let j=HE(t,{pathname:C});tr(v||j!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),tr(j==null||j[j.length-1].route.element!==void 0||j[j.length-1].route.Component!==void 0||j[j.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let z=UC(j&&j.map(q=>Object.assign({},q,{params:Object.assign({},f,q.params),pathname:zi([_,l.encodeLocation?l.encodeLocation(q.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:q.pathname]),pathnameBase:q.pathnameBase==="/"?_:zi([_,l.encodeLocation?l.encodeLocation(q.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:q.pathnameBase])})),c,n,i,a);return e&&z?R.createElement(iu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},z):z}function LC(){let t=QC(),e=xC(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=R.createElement(R.Fragment,null,R.createElement("p",null," Hey developer "),R.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",R.createElement("code",{style:l},"ErrorBoundary")," or"," ",R.createElement("code",{style:l},"errorElement")," prop on your route.")),R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),n?R.createElement("pre",{style:a},n):null,c)}var VC=R.createElement(LC,null),nS=class extends R.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=IC(t.digest);n&&(t=n)}let e=t!==void 0?R.createElement(_r.Provider,{value:this.props.routeContext},R.createElement(Gg.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?R.createElement(BC,{error:t},e):e}};nS.contextType=wC;var Mp=new WeakMap;function BC({children:t,error:e}){let{basename:n}=R.useContext(nr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=DC(e.digest);if(i){let a=Mp.get(e);if(a)throw a;let l=WE(i.location,n);if(KE&&!Mp.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw Mp.set(e,c),c}return R.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function zC({routeContext:t,match:e,children:n}){let i=R.useContext(ul);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),R.createElement(_r.Provider,{value:t},n)}function UC(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=n?.errors;if(c!=null){let _=l.findIndex(v=>v.route.id&&c?.[v.route.id]!==void 0);jt(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let h=!1,f=-1;if(n)for(let _=0;_<l.length;_++){let v=l[_];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(f=_),v.route.id){let{loaderData:b,errors:S}=n,T=v.route.loader&&!b.hasOwnProperty(v.route.id)&&(!S||S[v.route.id]===void 0);if(v.route.lazy||T){h=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}let p=n&&i?(_,v)=>{i(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:EC(n.matches),errorInfo:v})}:void 0;return l.reduceRight((_,v,b)=>{let S,T=!1,C=null,j=null;n&&(S=c&&v.route.id?c[v.route.id]:void 0,C=v.route.errorElement||VC,h&&(f<0&&b===0?(rS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),T=!0,j=null):f===b&&(T=!0,j=v.route.hydrateFallbackElement||null)));let z=e.concat(l.slice(0,b+1)),q=()=>{let U;return S?U=C:T?U=j:v.route.Component?U=R.createElement(v.route.Component,null):v.route.element?U=v.route.element:U=_,R.createElement(zC,{match:v,routeContext:{outlet:_,matches:z,isDataRoute:n!=null},children:U})};return n&&(v.route.ErrorBoundary||v.route.errorElement||b===0)?R.createElement(nS,{location:n.location,revalidation:n.revalidation,component:C,error:S,children:q(),routeContext:{outlet:null,matches:z,isDataRoute:!0},onError:p}):q()},null)}function Qg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function FC(t){let e=R.useContext(ul);return jt(e,Qg(t)),e}function qC(t){let e=R.useContext(Jh);return jt(e,Qg(t)),e}function HC(t){let e=R.useContext(_r);return jt(e,Qg(t)),e}function $g(t){let e=HC(t),n=e.matches[e.matches.length-1];return jt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function GC(){return $g("useRouteId")}function QC(){let t=R.useContext(Gg),e=qC("useRouteError"),n=$g("useRouteError");return t!==void 0?t:e.errors?.[n]}function $C(){let{router:t}=FC("useNavigate"),e=$g("useNavigate"),n=R.useRef(!1);return eS(()=>{n.current=!0}),R.useCallback(async(a,l={})=>{tr(n.current,ZE),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var Vb={};function rS(t,e,n){!e&&!Vb[t]&&(Vb[t]=!0,tr(!1,n))}R.memo(KC);function KC({routes:t,future:e,state:n,onError:i}){return tS(t,void 0,n,i,e)}function Zh({to:t,replace:e,state:n,relative:i}){jt(dl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=R.useContext(nr);tr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=R.useContext(_r),{pathname:c}=kn(),h=su(),f=Hg(t,qg(l),c,i==="path"),p=JSON.stringify(f);return R.useEffect(()=>{h(JSON.parse(p),{replace:e,state:n,relative:i})},[h,p,i,e,n]),null}function ef(t){return MC(t.context)}function Jt(t){jt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function WC({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){jt(!dl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=t.replace(/^\/*/,"/"),f=R.useMemo(()=>({basename:h,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[h,a,l,c]);typeof n=="string"&&(n=cl(n));let{pathname:p="/",search:_="",hash:v="",state:b=null,key:S="default"}=n,T=R.useMemo(()=>{let C=Fi(p,h);return C==null?null:{location:{pathname:C,search:_,hash:v,state:b,key:S},navigationType:i}},[h,p,_,v,b,S,i]);return tr(T!=null,`<Router basename="${h}"> is not able to match the URL "${p}${_}${v}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:R.createElement(nr.Provider,{value:f},R.createElement(iu.Provider,{children:e,value:T}))}function YC({children:t,location:e}){return PC(tg(t),e)}function tg(t,e=[]){let n=[];return R.Children.forEach(t,(i,a)=>{if(!R.isValidElement(i))return;let l=[...e,a];if(i.type===R.Fragment){n.push.apply(n,tg(i.props.children,l));return}jt(i.type===Jt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),jt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=tg(i.props.children,l)),n.push(c)}),n}var sh="get",ah="application/x-www-form-urlencoded";function tf(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function XC(t){return tf(t)&&t.tagName.toLowerCase()==="button"}function JC(t){return tf(t)&&t.tagName.toLowerCase()==="form"}function ZC(t){return tf(t)&&t.tagName.toLowerCase()==="input"}function eR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function tR(t,e){return t.button===0&&(!e||e==="_self")&&!eR(t)}function ng(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(a=>[n,a]):[[n,i]])},[]))}function nR(t,e){let n=ng(t);return e&&e.forEach((i,a)=>{n.has(a)||e.getAll(a).forEach(l=>{n.append(a,l)})}),n}var Yd=null;function rR(){if(Yd===null)try{new FormData(document.createElement("form"),0),Yd=!1}catch{Yd=!0}return Yd}var iR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Np(t){return t!=null&&!iR.has(t)?(tr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ah}"`),null):t}function sR(t,e){let n,i,a,l,c;if(JC(t)){let h=t.getAttribute("action");i=h?Fi(h,e):null,n=t.getAttribute("method")||sh,a=Np(t.getAttribute("enctype"))||ah,l=new FormData(t)}else if(XC(t)||ZC(t)&&(t.type==="submit"||t.type==="image")){let h=t.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||h.getAttribute("action");if(i=f?Fi(f,e):null,n=t.getAttribute("formmethod")||h.getAttribute("method")||sh,a=Np(t.getAttribute("formenctype"))||Np(h.getAttribute("enctype"))||ah,l=new FormData(h,t),!rR()){let{name:p,type:_,value:v}=t;if(_==="image"){let b=p?`${p}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else p&&l.append(p,v)}}else{if(tf(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=sh,i=null,a=ah,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Kg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function aR(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Fi(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function oR(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function lR(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function cR(t,e,n){let i=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let c=await oR(l,n);return c.links?c.links():[]}return[]}));return fR(i.flat(1).filter(lR).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Bb(t,e,n,i,a,l){let c=(f,p)=>n[p]?f.route.id!==n[p].route.id:!0,h=(f,p)=>n[p].pathname!==f.pathname||n[p].route.path?.endsWith("*")&&n[p].params["*"]!==f.params["*"];return l==="assets"?e.filter((f,p)=>c(f,p)||h(f,p)):l==="data"?e.filter((f,p)=>{let _=i.routes[f.route.id];if(!_||!_.hasLoader)return!1;if(c(f,p)||h(f,p))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function uR(t,e,{includeHydrateFallback:n}={}){return dR(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function dR(t){return[...new Set(t)]}function hR(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function fR(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let l=JSON.stringify(hR(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function iS(){let t=R.useContext(ul);return Kg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function mR(){let t=R.useContext(Jh);return Kg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Wg=R.createContext(void 0);Wg.displayName="FrameworkContext";function sS(){let t=R.useContext(Wg);return Kg(t,"You must render this element inside a <HydratedRouter> element"),t}function pR(t,e){let n=R.useContext(Wg),[i,a]=R.useState(!1),[l,c]=R.useState(!1),{onFocus:h,onBlur:f,onMouseEnter:p,onMouseLeave:_,onTouchStart:v}=e,b=R.useRef(null);R.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let C=z=>{z.forEach(q=>{c(q.isIntersecting)})},j=new IntersectionObserver(C,{threshold:.5});return b.current&&j.observe(b.current),()=>{j.disconnect()}}},[t]),R.useEffect(()=>{if(i){let C=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(C)}}},[i]);let S=()=>{a(!0)},T=()=>{a(!1),c(!1)};return n?t!=="intent"?[l,b,{}]:[l,b,{onFocus:jc(h,S),onBlur:jc(f,T),onMouseEnter:jc(p,S),onMouseLeave:jc(_,T),onTouchStart:jc(v,S)}]:[!1,b,{}]}function jc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function gR({page:t,...e}){let{router:n}=iS(),i=R.useMemo(()=>HE(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?R.createElement(_R,{page:t,matches:i,...e}):null}function yR(t){let{manifest:e,routeModules:n}=sS(),[i,a]=R.useState([]);return R.useEffect(()=>{let l=!1;return cR(t,e,n).then(c=>{l||a(c)}),()=>{l=!0}},[t,e,n]),i}function _R({page:t,matches:e,...n}){let i=kn(),{manifest:a,routeModules:l}=sS(),{basename:c}=iS(),{loaderData:h,matches:f}=mR(),p=R.useMemo(()=>Bb(t,e,f,a,i,"data"),[t,e,f,a,i]),_=R.useMemo(()=>Bb(t,e,f,a,i,"assets"),[t,e,f,a,i]),v=R.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let T=new Set,C=!1;if(e.forEach(z=>{let q=a.routes[z.route.id];!q||!q.hasLoader||(!p.some(U=>U.route.id===z.route.id)&&z.route.id in h&&l[z.route.id]?.shouldRevalidate||q.hasClientLoader?C=!0:T.add(z.route.id))}),T.size===0)return[];let j=aR(t,c,"data");return C&&T.size>0&&j.searchParams.set("_routes",e.filter(z=>T.has(z.route.id)).map(z=>z.route.id).join(",")),[j.pathname+j.search]},[c,h,i,a,p,e,t,l]),b=R.useMemo(()=>uR(_,a),[_,a]),S=yR(_);return R.createElement(R.Fragment,null,v.map(T=>R.createElement("link",{key:T,rel:"prefetch",as:"fetch",href:T,...n})),b.map(T=>R.createElement("link",{key:T,rel:"modulepreload",href:T,...n})),S.map(({key:T,link:C})=>R.createElement("link",{key:T,nonce:n.nonce,...C})))}function vR(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var bR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{bR&&(window.__reactRouterVersion="7.11.0")}catch{}function xR({basename:t,children:e,unstable_useTransitions:n,window:i}){let a=R.useRef();a.current==null&&(a.current=XA({window:i,v5Compat:!0}));let l=a.current,[c,h]=R.useState({action:l.action,location:l.location}),f=R.useCallback(p=>{n===!1?h(p):R.startTransition(()=>h(p))},[n]);return R.useLayoutEffect(()=>l.listen(f),[l,f]),R.createElement(WC,{basename:t,children:e,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:n})}var aS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kt=R.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,state:h,target:f,to:p,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...S},T){let{basename:C,unstable_useTransitions:j}=R.useContext(nr),z=typeof p=="string"&&aS.test(p),q=WE(p,C);p=q.to;let U=jC(p,{relative:a}),[Z,J,ne]=pR(i,S),k=TR(p,{replace:c,state:h,target:f,preventScrollReset:_,relative:a,viewTransition:v,unstable_defaultShouldRevalidate:b,unstable_useTransitions:j});function A(P){e&&e(P),P.defaultPrevented||k(P)}let D=R.createElement("a",{...S,...ne,href:q.absoluteURL||U,onClick:q.isExternal||l?e:A,ref:vR(T,J),target:f,"data-discover":!z&&n==="render"?"true":void 0});return Z&&!z?R.createElement(R.Fragment,null,D,R.createElement(gR,{page:U})):D});kt.displayName="Link";var ER=R.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:h,children:f,...p},_){let v=au(c,{relative:p.relative}),b=kn(),S=R.useContext(Jh),{navigator:T,basename:C}=R.useContext(nr),j=S!=null&&jR(v)&&h===!0,z=T.encodeLocation?T.encodeLocation(v).pathname:v.pathname,q=b.pathname,U=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;n||(q=q.toLowerCase(),U=U?U.toLowerCase():null,z=z.toLowerCase()),U&&C&&(U=Fi(U,C)||U);const Z=z!=="/"&&z.endsWith("/")?z.length-1:z.length;let J=q===z||!a&&q.startsWith(z)&&q.charAt(Z)==="/",ne=U!=null&&(U===z||!a&&U.startsWith(z)&&U.charAt(z.length)==="/"),k={isActive:J,isPending:ne,isTransitioning:j},A=J?e:void 0,D;typeof i=="function"?D=i(k):D=[i,J?"active":null,ne?"pending":null,j?"transitioning":null].filter(Boolean).join(" ");let P=typeof l=="function"?l(k):l;return R.createElement(kt,{...p,"aria-current":A,className:D,ref:_,style:P,to:c,viewTransition:h},typeof f=="function"?f(k):f)});ER.displayName="NavLink";var SR=R.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:l,method:c=sh,action:h,onSubmit:f,relative:p,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...S},T)=>{let{unstable_useTransitions:C}=R.useContext(nr),j=DR(),z=IR(h,{relative:p}),q=c.toLowerCase()==="get"?"get":"post",U=typeof h=="string"&&aS.test(h),Z=J=>{if(f&&f(J),J.defaultPrevented)return;J.preventDefault();let ne=J.nativeEvent.submitter,k=ne?.getAttribute("formmethod")||c,A=()=>j(ne||J.currentTarget,{fetcherKey:e,method:k,navigate:n,replace:a,state:l,relative:p,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b});C&&n!==!1?R.startTransition(()=>A()):A()};return R.createElement("form",{ref:T,method:q,action:z,onSubmit:i?f:Z,...S,"data-discover":!U&&t==="render"?"true":void 0})});SR.displayName="Form";function wR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oS(t){let e=R.useContext(ul);return jt(e,wR(t)),e}function TR(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:h,unstable_useTransitions:f}={}){let p=su(),_=kn(),v=au(t,{relative:l});return R.useCallback(b=>{if(tR(b,e)){b.preventDefault();let S=n!==void 0?n:Gc(_)===Gc(v),T=()=>p(t,{replace:S,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:h});f?R.startTransition(()=>T()):T()}},[_,p,v,n,i,e,t,a,l,c,h,f])}function AR(t){tr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=R.useRef(ng(t)),n=R.useRef(!1),i=kn(),a=R.useMemo(()=>nR(i.search,n.current?null:e.current),[i.search]),l=su(),c=R.useCallback((h,f)=>{const p=ng(typeof h=="function"?h(new URLSearchParams(a)):h);n.current=!0,l("?"+p,f)},[l,a]);return[a,c]}var CR=0,RR=()=>`__${String(++CR)}__`;function DR(){let{router:t}=oS("useSubmit"),{basename:e}=R.useContext(nr),n=GC(),i=t.fetch,a=t.navigate;return R.useCallback(async(l,c={})=>{let{action:h,method:f,encType:p,formData:_,body:v}=sR(l,e);if(c.navigate===!1){let b=c.fetcherKey||RR();await i(b,n,c.action||h,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||f,formEncType:c.encType||p,flushSync:c.flushSync})}else await a(c.action||h,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||f,formEncType:c.encType||p,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,e,n])}function IR(t,{relative:e}={}){let{basename:n}=R.useContext(nr),i=R.useContext(_r);jt(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...au(t||".",{relative:e})},c=kn();if(t==null){l.search=c.search;let h=new URLSearchParams(l.search),f=h.getAll("index");if(f.some(_=>_==="")){h.delete("index"),f.filter(v=>v).forEach(v=>h.append("index",v));let _=h.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:zi([n,l.pathname])),Gc(l)}function jR(t,{relative:e}={}){let n=R.useContext(XE);jt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=oS("useViewTransitionState"),a=au(t,{relative:e});if(!n.isTransitioning)return!1;let l=Fi(n.currentLocation.pathname,i)||n.currentLocation.pathname,c=Fi(n.nextLocation.pathname,i)||n.nextLocation.pathname;return wh(a.pathname,c)!=null||wh(a.pathname,l)!=null}const kR=function(){},OR={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:kR},ou=R.createContext(OR);var hl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},MR={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},NR=class{#e=MR;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Pi=new NR;function PR(t){setTimeout(t,0)}var ja=typeof window>"u"||"Deno"in globalThis;function sn(){}function LR(t,e){return typeof t=="function"?t(e):t}function rg(t){return typeof t=="number"&&t>=0&&t!==1/0}function lS(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Ms(t,e){return typeof t=="function"?t(e):t}function gr(t,e){return typeof t=="function"?t(e):t}function zb(t,e){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:c,stale:h}=t;if(c){if(i){if(e.queryHash!==Yg(c,e.options))return!1}else if(!Qc(e.queryKey,c))return!1}if(n!=="all"){const f=e.isActive();if(n==="active"&&!f||n==="inactive"&&f)return!1}return!(typeof h=="boolean"&&e.isStale()!==h||a&&a!==e.state.fetchStatus||l&&!l(e))}function Ub(t,e){const{exact:n,status:i,predicate:a,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(ka(e.options.mutationKey)!==ka(l))return!1}else if(!Qc(e.options.mutationKey,l))return!1}return!(i&&e.state.status!==i||a&&!a(e))}function Yg(t,e){return(e?.queryKeyHashFn||ka)(t)}function ka(t){return JSON.stringify(t,(e,n)=>ig(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function Qc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Qc(t[n],e[n])):!1}var VR=Object.prototype.hasOwnProperty;function cS(t,e){if(t===e)return t;const n=Fb(t)&&Fb(e);if(!n&&!(ig(t)&&ig(e)))return e;const a=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),c=l.length,h=n?new Array(c):{};let f=0;for(let p=0;p<c;p++){const _=n?p:l[p],v=t[_],b=e[_];if(v===b){h[_]=v,(n?p<a:VR.call(t,_))&&f++;continue}if(v===null||b===null||typeof v!="object"||typeof b!="object"){h[_]=b;continue}const S=cS(v,b);h[_]=S,S===v&&f++}return a===c&&f===a?t:h}function Th(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Fb(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function ig(t){if(!qb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!qb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function qb(t){return Object.prototype.toString.call(t)==="[object Object]"}function BR(t){return new Promise(e=>{Pi.setTimeout(e,t)})}function sg(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?cS(t,e):e}function zR(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function UR(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var Xg=Symbol();function uS(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Xg?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function dS(t,e){return typeof t=="function"?t(...e):!!t}var FR=class extends hl{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!ja&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Jg=new FR;function ag(){let t,e;const n=new Promise((a,l)=>{t=a,e=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),e(a)},n}function qR(t){let e;if(t.then(n=>(e=n,n),sn)?.catch(sn),e!==void 0)return{data:e}}function hS(t){return t}function HR(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function GR(t,e,n){const i=()=>{const a=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return a?.catch(sn),a};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:i()},...t.meta&&{meta:t.meta}}}function QR(t){return t.state.isPaused}function $R(t){return t.state.status==="success"}function KR(t){return!0}function WR(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??QR,i=t.getMutationCache().getAll().flatMap(f=>n(f)?[HR(f)]:[]),a=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??$R,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??KR,c=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??hS,h=t.getQueryCache().getAll().flatMap(f=>a(f)?[GR(f,c,l)]:[]);return{mutations:i,queries:h}}function YR(t,e,n){if(typeof e!="object"||e===null)return;const i=t.getMutationCache(),a=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??hS,c=e.mutations||[],h=e.queries||[];c.forEach(({state:f,...p})=>{i.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...p},f)}),h.forEach(({queryKey:f,state:p,queryHash:_,meta:v,promise:b,dehydratedAt:S})=>{const T=b?qR(b):void 0,C=p.data===void 0?T?.data:p.data,j=C===void 0?C:l(C);let z=a.get(_);const q=z?.state.status==="pending",U=z?.state.fetchStatus==="fetching";if(z){const Z=T&&S!==void 0&&S>z.state.dataUpdatedAt;if(p.dataUpdatedAt>z.state.dataUpdatedAt||Z){const{fetchStatus:J,...ne}=p;z.setState({...ne,data:j})}}else z=a.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:f,queryHash:_,meta:v},{...p,data:j,fetchStatus:"idle",status:j!==void 0?"success":p.status});b&&!q&&!U&&(S===void 0||S>z.state.dataUpdatedAt)&&z.fetch(void 0,{initialPromise:Promise.resolve(b).then(l)}).catch(sn)})}var XR=PR;function JR(){let t=[],e=0,n=h=>{h()},i=h=>{h()},a=XR;const l=h=>{e?t.push(h):a(()=>{n(h)})},c=()=>{const h=t;t=[],h.length&&a(()=>{i(()=>{h.forEach(f=>{n(f)})})})};return{batch:h=>{let f;e++;try{f=h()}finally{e--,e||c()}return f},batchCalls:h=>(...f)=>{l(()=>{h(...f)})},schedule:l,setNotifyFunction:h=>{n=h},setBatchNotifyFunction:h=>{i=h},setScheduler:h=>{a=h}}}var an=JR(),ZR=class extends hl{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!ja&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},Ah=new ZR;function eD(t){return Math.min(1e3*2**t,3e4)}function fS(t){return(t??"online")==="online"?Ah.isOnline():!0}var og=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function mS(t){let e=!1,n=0,i;const a=ag(),l=()=>a.status!=="pending",c=C=>{if(!l()){const j=new og(C);b(j),t.onCancel?.(j)}},h=()=>{e=!0},f=()=>{e=!1},p=()=>Jg.isFocused()&&(t.networkMode==="always"||Ah.isOnline())&&t.canRun(),_=()=>fS(t.networkMode)&&t.canRun(),v=C=>{l()||(i?.(),a.resolve(C))},b=C=>{l()||(i?.(),a.reject(C))},S=()=>new Promise(C=>{i=j=>{(l()||p())&&C(j)},t.onPause?.()}).then(()=>{i=void 0,l()||t.onContinue?.()}),T=()=>{if(l())return;let C;const j=n===0?t.initialPromise:void 0;try{C=j??t.fn()}catch(z){C=Promise.reject(z)}Promise.resolve(C).then(v).catch(z=>{if(l())return;const q=t.retry??(ja?0:3),U=t.retryDelay??eD,Z=typeof U=="function"?U(n,z):U,J=q===!0||typeof q=="number"&&n<q||typeof q=="function"&&q(n,z);if(e||!J){b(z);return}n++,t.onFail?.(n,z),BR(Z).then(()=>p()?void 0:S()).then(()=>{e?b(z):T()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(i?.(),a),cancelRetry:h,continueRetry:f,canStart:_,start:()=>(_()?T():S().then(T),a)}}var pS=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),rg(this.gcTime)&&(this.#e=Pi.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(ja?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Pi.clearTimeout(this.#e),this.#e=void 0)}},tD=class extends pS{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=Gb(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Gb(this.options);n.data!==void 0&&(this.setState(Hb(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const i=sg(this.state.data,e,this.options);return this.#s({data:i,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),i}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then(sn).catch(sn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>gr(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Xg||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Ms(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!lS(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const i=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(this.#o=!0,i.signal)})},l=()=>{const f=uS(this.options,n),_=(()=>{const v={client:this.#i,queryKey:this.queryKey,meta:this.meta};return a(v),v})();return this.#o=!1,this.options.persister?this.options.persister(f,_,this):f(_)},h=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return a(f),f})();this.options.behavior?.onFetch(h,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==h.fetchOptions?.meta)&&this.#s({type:"fetch",meta:h.fetchOptions?.meta}),this.#r=mS({initialPromise:n?.initialPromise,fn:h.fetchFn,onCancel:f=>{f instanceof og&&f.revert&&this.setState({...this.#t,fetchStatus:"idle"}),i.abort()},onFail:(f,p)=>{this.#s({type:"failed",failureCount:f,error:p})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0});try{const f=await this.#r.start();if(f===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(f),this.#n.config.onSuccess?.(f,this),this.#n.config.onSettled?.(f,this.state.error,this),f}catch(f){if(f instanceof og){if(f.silent)return this.#r.promise;if(f.revert){if(this.state.data===void 0)throw f;return this.state.data}}throw this.#s({type:"error",error:f}),this.#n.config.onError?.(f,this),this.#n.config.onSettled?.(this.state.data,f,this),f}finally{this.scheduleGc()}}#s(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...gS(i.data,this.options),fetchMeta:e.meta??null};case"success":const a={...i,...Hb(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const l=e.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),an.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function gS(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:fS(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Hb(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Gb(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var nD=class extends hl{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=ag(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Qb(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return lg(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return lg(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#x(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof gr(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#E(),this.#t.setOptions(this.options),e._defaulted&&!Th(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&$b(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),i&&(this.#t!==n||gr(this.options.enabled,this.#t)!==gr(e.enabled,this.#t)||Ms(this.options.staleTime,this.#t)!==Ms(e.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||gr(this.options.enabled,this.#t)!==gr(e.enabled,this.#t)||a!==this.#l)&&this.#_(a)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return iD(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),e?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#E();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(sn)),e}#g(){this.#b();const t=Ms(this.options.staleTime,this.#t);if(ja||this.#i.isStale||!rg(t))return;const n=lS(this.#i.dataUpdatedAt,t)+1;this.#c=Pi.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#x(),this.#l=t,!(ja||gr(this.options.enabled,this.#t)===!1||!rg(this.#l)||this.#l===0)&&(this.#u=Pi.setInterval(()=>{(this.options.refetchIntervalInBackground||Jg.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#b(){this.#c&&(Pi.clearTimeout(this.#c),this.#c=void 0)}#x(){this.#u&&(Pi.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,i=this.options,a=this.#i,l=this.#r,c=this.#a,f=t!==n?t.state:this.#n,{state:p}=t;let _={...p},v=!1,b;if(e._optimisticResults){const A=this.hasListeners(),D=!A&&Qb(t,e),P=A&&$b(t,n,e,i);(D||P)&&(_={..._,...gS(p.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:S,errorUpdatedAt:T,status:C}=_;b=_.data;let j=!1;if(e.placeholderData!==void 0&&b===void 0&&C==="pending"){let A;a?.isPlaceholderData&&e.placeholderData===c?.placeholderData?(A=a.data,j=!0):A=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,A!==void 0&&(C="success",b=sg(a?.data,A,e),v=!0)}if(e.select&&b!==void 0&&!j)if(a&&b===l?.data&&e.select===this.#p)b=this.#h;else try{this.#p=e.select,b=e.select(b),b=sg(a?.data,b,e),this.#h=b,this.#s=null}catch(A){this.#s=A}this.#s&&(S=this.#s,b=this.#h,T=Date.now(),C="error");const z=_.fetchStatus==="fetching",q=C==="pending",U=C==="error",Z=q&&z,J=b!==void 0,k={status:C,fetchStatus:_.fetchStatus,isPending:q,isSuccess:C==="success",isError:U,isInitialLoading:Z,isLoading:Z,data:b,dataUpdatedAt:_.dataUpdatedAt,error:S,errorUpdatedAt:T,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>f.dataUpdateCount||_.errorUpdateCount>f.errorUpdateCount,isFetching:z,isRefetching:z&&!q,isLoadingError:U&&!J,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:U&&J,isStale:Zg(t,e),refetch:this.refetch,promise:this.#o,isEnabled:gr(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const A=O=>{k.status==="error"?O.reject(k.error):k.data!==void 0&&O.resolve(k.data)},D=()=>{const O=this.#o=k.promise=ag();A(O)},P=this.#o;switch(P.status){case"pending":t.queryHash===n.queryHash&&A(P);break;case"fulfilled":(k.status==="error"||k.data!==P.value)&&D();break;case"rejected":(k.status!=="error"||k.error!==P.reason)&&D();break}}return k}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),Th(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(c=>{const h=c;return this.#i[h]!==t[h]&&l.has(h)})};this.#S({listeners:n()})}#E(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#S(t){an.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function rD(t,e){return gr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Qb(t,e){return rD(t,e)||t.state.data!==void 0&&lg(t,e,e.refetchOnMount)}function lg(t,e,n){if(gr(e.enabled,t)!==!1&&Ms(e.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&Zg(t,e)}return!1}function $b(t,e,n,i){return(t!==e||gr(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Zg(t,n)}function Zg(t,e){return gr(e.enabled,t)!==!1&&t.isStaleByTime(Ms(e.staleTime,t))}function iD(t,e){return!Th(t.getCurrentResult(),e)}function Kb(t){return{onFetch:(e,n)=>{const i=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],c=e.state.data?.pageParams||[];let h={pages:[],pageParams:[]},f=0;const p=async()=>{let _=!1;const v=T=>{Object.defineProperty(T,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},b=uS(e.options,e.fetchOptions),S=async(T,C,j)=>{if(_)return Promise.reject();if(C==null&&T.pages.length)return Promise.resolve(T);const q=(()=>{const ne={client:e.client,queryKey:e.queryKey,pageParam:C,direction:j?"backward":"forward",meta:e.options.meta};return v(ne),ne})(),U=await b(q),{maxPages:Z}=e.options,J=j?UR:zR;return{pages:J(T.pages,U,Z),pageParams:J(T.pageParams,C,Z)}};if(a&&l.length){const T=a==="backward",C=T?sD:Wb,j={pages:l,pageParams:c},z=C(i,j);h=await S(j,z,T)}else{const T=t??l.length;do{const C=f===0?c[0]??i.initialPageParam:Wb(i,h);if(f>0&&C==null)break;h=await S(h,C),f++}while(f<T)}return h};e.options.persister?e.fetchFn=()=>e.options.persister?.(p,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=p}}}function Wb(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function sD(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var aD=class extends pS{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||yS(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=mS({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(c,h)=>{this.#r({type:"failed",failureCount:c,error:h})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",l=!this.#i.canStart();try{if(a)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,i);const h=await this.options.onMutate?.(e,i);h!==this.state.context&&this.#r({type:"pending",context:h,variables:e,isPaused:l})}const c=await this.#i.start();return await this.#n.config.onSuccess?.(c,e,this.state.context,this,i),await this.options.onSuccess?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(c,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(c,null,e,this.state.context,i),this.#r({type:"success",data:c}),c}catch(c){try{throw await this.#n.config.onError?.(c,e,this.state.context,this,i),await this.options.onError?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(void 0,c,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,c,e,this.state.context,i),c}finally{this.#r({type:"error",error:c})}}finally{this.#n.runNext(this)}}#r(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),an.batch(()=>{this.#t.forEach(i=>{i.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function yS(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var oD=class extends hl{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const i=new aD({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){this.#e.add(t);const e=Xd(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Xd(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Xd(t);if(typeof e=="string"){const i=this.#t.get(e)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const e=Xd(t);return typeof e=="string"?this.#t.get(e)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){an.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Ub(e,n))}findAll(t={}){return this.getAll().filter(e=>Ub(t,e))}notify(t){an.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return an.batch(()=>Promise.all(t.map(e=>e.continue().catch(sn))))}};function Xd(t){return t.options.scope?.id}var lD=class extends hl{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),Th(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&ka(n.mutationKey)!==ka(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??yS();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){an.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,i,a),this.#i.onSettled?.(e.data,null,n,i,a)):e?.type==="error"&&(this.#i.onError?.(e.error,n,i,a),this.#i.onSettled?.(void 0,e.error,n,i,a))}this.listeners.forEach(n=>{n(this.#t)})})}},cD=class extends hl{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const i=e.queryKey,a=e.queryHash??Yg(i,e);let l=this.get(a);return l||(l=new tD({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){an.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>zb(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>zb(t,n)):e}notify(t){an.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){an.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){an.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},uD=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new cD,this.#t=t.mutationCache||new oD,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=Jg.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=Ah.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Ms(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(i.queryHash)?.state.data,c=LR(e,l);if(c!==void 0)return this.#e.build(this,i).setData(c,{...n,manual:!0})}setQueriesData(t,e,n){return an.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;an.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return an.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=an.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then(sn).catch(sn)}invalidateQueries(t,e={}){return an.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=an.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(sn)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(sn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Ms(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(sn).catch(sn)}fetchInfiniteQuery(t){return t.behavior=Kb(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(sn).catch(sn)}ensureInfiniteQueryData(t){return t.behavior=Kb(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Ah.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(ka(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(i=>{Qc(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(ka(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(i=>{Qc(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Yg(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Xg&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},_S=R.createContext(void 0),gi=t=>{const e=R.useContext(_S);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},dD=({client:t,children:e})=>(R.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),d.jsx(_S.Provider,{value:t,children:e})),vS=R.createContext(!1),hD=()=>R.useContext(vS),fD=vS.Provider;function mD(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var pD=R.createContext(mD()),gD=()=>R.useContext(pD),yD=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},_D=t=>{R.useEffect(()=>{t.clearReset()},[t])},vD=({result:t,errorResetBoundary:e,throwOnError:n,query:i,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||dS(n,[t.error,i])),bD=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},xD=(t,e)=>t.isLoading&&t.isFetching&&!e,ED=(t,e)=>t?.suspense&&e.isPending,Yb=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function SD(t,e,n){const i=hD(),a=gD(),l=gi(),c=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c),c._optimisticResults=i?"isRestoring":"optimistic",bD(c),yD(c,a),_D(a);const h=!l.getQueryCache().get(c.queryHash),[f]=R.useState(()=>new e(l,c)),p=f.getOptimisticResult(c),_=!i&&t.subscribed!==!1;if(R.useSyncExternalStore(R.useCallback(v=>{const b=_?f.subscribe(an.batchCalls(v)):sn;return f.updateResult(),b},[f,_]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),R.useEffect(()=>{f.setOptions(c)},[c,f]),ED(c,p))throw Yb(c,f,a);if(vD({result:p,errorResetBoundary:a,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw p.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,p),c.experimental_prefetchInRender&&!ja&&xD(p,i)&&(h?Yb(c,f,a):l.getQueryCache().get(c.queryHash)?.promise)?.catch(sn).finally(()=>{f.updateResult()}),c.notifyOnChangeProps?p:f.trackResult(p)}function fl(t,e){return SD(t,nD)}function xt(t,e){const n=gi(),[i]=R.useState(()=>new lD(n,t));R.useEffect(()=>{i.setOptions(t)},[i,t]);const a=R.useSyncExternalStore(R.useCallback(c=>i.subscribe(an.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=R.useCallback((c,h)=>{i.mutate(c,h).catch(sn)},[i]);if(a.error&&dS(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}function cg(){}function wD(t,{interval:e=1e3,onError:n=cg}={}){if(typeof t!="function")throw new Error("argument is not function.");let i=0,a=null,l=!1,c=!1;return async(...h)=>{if(a=h,!c){for(c=!0;l;)await new Promise(f=>Pi.setTimeout(f,e));for(;Date.now()<i;)await new Promise(f=>Pi.setTimeout(f,i-Date.now()));c=!1,l=!0;try{await t(...a)}catch(f){try{n(f)}catch{}}i=Date.now()+e,l=!1}}}var TD=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:i=JSON.stringify,deserialize:a=JSON.parse,retry:l})=>{if(t){const c=async h=>{try{const f=await i(h);await t.setItem(e,f);return}catch(f){return f}};return{persistClient:wD(async h=>{let f=h,p=await c(f),_=0;for(;p&&f;)_++,f=await l?.({persistedClient:f,error:p,errorCount:_}),f&&(p=await c(f))},{interval:n}),restoreClient:async()=>{const h=await t.getItem(e);if(h)return await a(h)},removeClient:()=>t.removeItem(e)}}return{persistClient:cg,restoreClient:()=>Promise.resolve(void 0),removeClient:cg}};const Oe=new uD({defaultOptions:{queries:{staleTime:300*1e3,gcTime:1440*60*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}});Oe.getQueryCache().subscribe(t=>{const e=t?.query;if(e&&t.type==="updated"){const{state:n}=e;n.status==="error"&&n.error&&console.error("[RQ] Query FAILED:",e.queryKey,n.error)}});const AD=TD({storage:typeof window<"u"?{getItem:t=>Promise.resolve(localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(localStorage.removeItem(t))}:void 0,key:"BUDGET_APP_QUERY_CACHE"}),le={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};var CD=["added","removed","updated"];function Xb(t){return CD.includes(t)}async function RD({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:i="",hydrateOptions:a}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const c=Date.now()-l.timestamp>n,h=l.buster!==i;if(c||h)return e.removeClient();YR(t,l.clientState,a)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function Jb({queryClient:t,persister:e,buster:n="",dehydrateOptions:i}){const a={buster:n,timestamp:Date.now(),clientState:WR(t,i)};await e.persistClient(a)}function DD(t){const e=t.queryClient.getQueryCache().subscribe(i=>{Xb(i.type)&&Jb(t)}),n=t.queryClient.getMutationCache().subscribe(i=>{Xb(i.type)&&Jb(t)});return()=>{e(),n()}}var ID=({children:t,persistOptions:e,onSuccess:n,onError:i,...a})=>{const[l,c]=R.useState(!0),h=R.useRef({persistOptions:e,onSuccess:n,onError:i}),f=R.useRef(!1);return R.useEffect(()=>{h.current={persistOptions:e,onSuccess:n,onError:i}}),R.useEffect(()=>{const p={...h.current.persistOptions,queryClient:a.client};return f.current||(f.current=!0,RD(p).then(()=>h.current.onSuccess?.()).catch(()=>h.current.onError?.()).finally(()=>{c(!1)})),l?void 0:DD(p)},[a.client,l]),d.jsx(dD,{...a,children:d.jsx(fD,{value:l,children:t})})};function jD({children:t}){return d.jsx(ID,{client:Oe,persistOptions:{persister:AD,maxAge:1440*60*1e3,buster:"v1"},children:t})}const kD=()=>{};var Zb={};const bS=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},OD=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],c=t[n++],h=t[n++],f=((a&7)<<18|(l&63)<<12|(c&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const l=t[n++],c=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},xS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],c=a+1<t.length,h=c?t[a+1]:0,f=a+2<t.length,p=f?t[a+2]:0,_=l>>2,v=(l&3)<<4|h>>4;let b=(h&15)<<2|p>>6,S=p&63;f||(S=64,c||(b=64)),i.push(n[_],n[v],n[b],n[S])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(bS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):OD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],h=a<t.length?n[t.charAt(a)]:0;++a;const p=a<t.length?n[t.charAt(a)]:64;++a;const v=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||h==null||p==null||v==null)throw new MD;const b=l<<2|h>>4;if(i.push(b),p!==64){const S=h<<4&240|p>>2;if(i.push(S),v!==64){const T=p<<6&192|v;i.push(T)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class MD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ND=function(t){const e=bS(t);return xS.encodeByteArray(e,!0)},Ch=function(t){return ND(t).replace(/\./g,"")},ES=function(t){try{return xS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function PD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const LD=()=>PD().__FIREBASE_DEFAULTS__,VD=()=>{if(typeof process>"u"||typeof Zb>"u")return;const t=Zb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},BD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ES(t[1]);return e&&JSON.parse(e)},nf=()=>{try{return kD()||LD()||VD()||BD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},SS=t=>nf()?.emulatorHosts?.[t],zD=t=>{const e=SS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},wS=()=>nf()?.config,TS=t=>nf()?.[`_${t}`];class UD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function ml(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function AS(t){return(await fetch(t,{credentials:"include"})).ok}function FD(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Ch(JSON.stringify(n)),Ch(JSON.stringify(c)),""].join(".")}const Bc={};function qD(){const t={prod:[],emulator:[]};for(const e of Object.keys(Bc))Bc[e]?t.emulator.push(e):t.prod.push(e);return t}function HD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let ex=!1;function CS(t,e){if(typeof window>"u"||typeof document>"u"||!ml(window.location.host)||Bc[t]===e||Bc[t]||ex)return;Bc[t]=e;function n(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=qD().prod.length>0;function c(){const b=document.getElementById(i);b&&b.remove()}function h(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function f(b,S){b.setAttribute("width","24"),b.setAttribute("id",S),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function p(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{ex=!0,c()},b}function _(b,S){b.setAttribute("id",S),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function v(){const b=HD(i),S=n("text"),T=document.getElementById(S)||document.createElement("span"),C=n("learnmore"),j=document.getElementById(C)||document.createElement("a"),z=n("preprendIcon"),q=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const U=b.element;h(U),_(j,C);const Z=p();f(q,z),U.append(q,T,j,Z),document.body.appendChild(U)}l?(T.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function Rn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function GD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rn())}function QD(){const t=nf()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $D(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function KD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function WD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function YD(){const t=Rn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function XD(){return!QD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function JD(){try{return typeof indexedDB=="object"}catch{return!1}}function ZD(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const eI="FirebaseError";class $i extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=eI,Object.setPrototypeOf(this,$i.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lu.prototype.create)}}class lu{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?tI(l,i):"Error",h=`${this.serviceName}: ${c} (${a}).`;return new $i(a,h,i)}}function tI(t,e){return t.replace(nI,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const nI=/\{\$([^}]+)}/g;function rI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function qs(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],c=e[a];if(tx(l)&&tx(c)){if(!qs(l,c))return!1}else if(l!==c)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function tx(t){return t!==null&&typeof t=="object"}function cu(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Oc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Mc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function iI(t,e){const n=new sI(t,e);return n.subscribe.bind(n)}class sI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");aI(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=Pp),a.error===void 0&&(a.error=Pp),a.complete===void 0&&(a.complete=Pp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function aI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Pp(){}function hn(t){return t&&t._delegate?t._delegate:t}class Oa{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ra="[DEFAULT]";class oI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new UD;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cI(e))try{this.getOrInitializeService({instanceIdentifier:Ra})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=Ra){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ra){return this.instances.has(e)}getOptions(e=Ra){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(l);i===h&&c.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:lI(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ra){return this.component?this.component.multipleInstances?e:Ra:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lI(t){return t===Ra?void 0:t}function cI(t){return t.instantiationMode==="EAGER"}class uI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new oI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var tt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(tt||(tt={}));const dI={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},hI=tt.INFO,fI={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},mI=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=fI[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ey{constructor(e){this.name=e,this._logLevel=hI,this._logHandler=mI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}}const pI=(t,e)=>e.some(n=>t instanceof n);let nx,rx;function gI(){return nx||(nx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yI(){return rx||(rx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const RS=new WeakMap,ug=new WeakMap,DS=new WeakMap,Lp=new WeakMap,ty=new WeakMap;function _I(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",c)},l=()=>{n(Ns(t.result)),a()},c=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",c)});return e.then(n=>{n instanceof IDBCursor&&RS.set(n,t)}).catch(()=>{}),ty.set(e,t),e}function vI(t){if(ug.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",c),t.removeEventListener("abort",c)},l=()=>{n(),a()},c=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",c),t.addEventListener("abort",c)});ug.set(t,e)}let dg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ug.get(t);if(e==="objectStoreNames")return t.objectStoreNames||DS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ns(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function bI(t){dg=t(dg)}function xI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(Vp(this),e,...n);return DS.set(i,e.sort?e.sort():[e]),Ns(i)}:yI().includes(t)?function(...e){return t.apply(Vp(this),e),Ns(RS.get(this))}:function(...e){return Ns(t.apply(Vp(this),e))}}function EI(t){return typeof t=="function"?xI(t):(t instanceof IDBTransaction&&vI(t),pI(t,gI())?new Proxy(t,dg):t)}function Ns(t){if(t instanceof IDBRequest)return _I(t);if(Lp.has(t))return Lp.get(t);const e=EI(t);return e!==t&&(Lp.set(t,e),ty.set(e,t)),e}const Vp=t=>ty.get(t);function SI(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const c=indexedDB.open(t,e),h=Ns(c);return i&&c.addEventListener("upgradeneeded",f=>{i(Ns(c.result),f.oldVersion,f.newVersion,Ns(c.transaction),f)}),n&&c.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),h.then(f=>{l&&f.addEventListener("close",()=>l()),a&&f.addEventListener("versionchange",p=>a(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const wI=["get","getKey","getAll","getAllKeys","count"],TI=["put","add","delete","clear"],Bp=new Map;function ix(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bp.get(e))return Bp.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=TI.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||wI.includes(n)))return;const l=async function(c,...h){const f=this.transaction(c,a?"readwrite":"readonly");let p=f.store;return i&&(p=p.index(h.shift())),(await Promise.all([p[n](...h),a&&f.done]))[0]};return Bp.set(e,l),l}bI(t=>({...t,get:(e,n,i)=>ix(e,n)||t.get(e,n,i),has:(e,n)=>!!ix(e,n)||t.has(e,n)}));class AI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(CI(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function CI(t){return t.getComponent()?.type==="VERSION"}const hg="@firebase/app",sx="0.14.6";const qi=new ey("@firebase/app"),RI="@firebase/app-compat",DI="@firebase/analytics-compat",II="@firebase/analytics",jI="@firebase/app-check-compat",kI="@firebase/app-check",OI="@firebase/auth",MI="@firebase/auth-compat",NI="@firebase/database",PI="@firebase/data-connect",LI="@firebase/database-compat",VI="@firebase/functions",BI="@firebase/functions-compat",zI="@firebase/installations",UI="@firebase/installations-compat",FI="@firebase/messaging",qI="@firebase/messaging-compat",HI="@firebase/performance",GI="@firebase/performance-compat",QI="@firebase/remote-config",$I="@firebase/remote-config-compat",KI="@firebase/storage",WI="@firebase/storage-compat",YI="@firebase/firestore",XI="@firebase/ai",JI="@firebase/firestore-compat",ZI="firebase",ej="12.6.0";const fg="[DEFAULT]",tj={[hg]:"fire-core",[RI]:"fire-core-compat",[II]:"fire-analytics",[DI]:"fire-analytics-compat",[kI]:"fire-app-check",[jI]:"fire-app-check-compat",[OI]:"fire-auth",[MI]:"fire-auth-compat",[NI]:"fire-rtdb",[PI]:"fire-data-connect",[LI]:"fire-rtdb-compat",[VI]:"fire-fn",[BI]:"fire-fn-compat",[zI]:"fire-iid",[UI]:"fire-iid-compat",[FI]:"fire-fcm",[qI]:"fire-fcm-compat",[HI]:"fire-perf",[GI]:"fire-perf-compat",[QI]:"fire-rc",[$I]:"fire-rc-compat",[KI]:"fire-gcs",[WI]:"fire-gcs-compat",[YI]:"fire-fst",[JI]:"fire-fst-compat",[XI]:"fire-vertex","fire-js":"fire-js",[ZI]:"fire-js-all"};const Rh=new Map,nj=new Map,mg=new Map;function ax(t,e){try{t.container.addComponent(e)}catch(n){qi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Jo(t){const e=t.name;if(mg.has(e))return qi.debug(`There were multiple attempts to register component ${e}.`),!1;mg.set(e,t);for(const n of Rh.values())ax(n,t);for(const n of nj.values())ax(n,t);return!0}function ny(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function jr(t){return t==null?!1:t.settings!==void 0}const rj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ps=new lu("app","Firebase",rj);class ij{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Oa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ps.create("app-deleted",{appName:this._name})}}const pl=ej;function IS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:fg,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Ps.create("bad-app-name",{appName:String(a)});if(n||(n=wS()),!n)throw Ps.create("no-options");const l=Rh.get(a);if(l){if(qs(n,l.options)&&qs(i,l.config))return l;throw Ps.create("duplicate-app",{appName:a})}const c=new uI(a);for(const f of mg.values())c.addComponent(f);const h=new ij(n,i,c);return Rh.set(a,h),h}function jS(t=fg){const e=Rh.get(t);if(!e&&t===fg&&wS())return IS();if(!e)throw Ps.create("no-app",{appName:t});return e}function Ls(t,e,n){let i=tj[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qi.warn(c.join(" "));return}Jo(new Oa(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const sj="firebase-heartbeat-database",aj=1,$c="firebase-heartbeat-store";let zp=null;function kS(){return zp||(zp=SI(sj,aj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore($c)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ps.create("idb-open",{originalErrorMessage:t.message})})),zp}async function oj(t){try{const n=(await kS()).transaction($c),i=await n.objectStore($c).get(OS(t));return await n.done,i}catch(e){if(e instanceof $i)qi.warn(e.message);else{const n=Ps.create("idb-get",{originalErrorMessage:e?.message});qi.warn(n.message)}}}async function ox(t,e){try{const i=(await kS()).transaction($c,"readwrite");await i.objectStore($c).put(e,OS(t)),await i.done}catch(n){if(n instanceof $i)qi.warn(n.message);else{const i=Ps.create("idb-set",{originalErrorMessage:n?.message});qi.warn(i.message)}}}function OS(t){return`${t.name}!${t.options.appId}`}const lj=1024,cj=30;class uj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new hj(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=lx();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>cj){const a=fj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){qi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=lx(),{heartbeatsToSend:n,unsentEntries:i}=dj(this._heartbeatsCache.heartbeats),a=Ch(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return qi.warn(e),""}}}function lx(){return new Date().toISOString().substring(0,10)}function dj(t,e=lj){const n=[];let i=t.slice();for(const a of t){const l=n.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),cx(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),cx(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class hj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return JD()?ZD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await oj(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return ox(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return ox(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function cx(t){return Ch(JSON.stringify({version:2,heartbeats:t})).length}function fj(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function mj(t){Jo(new Oa("platform-logger",e=>new AI(e),"PRIVATE")),Jo(new Oa("heartbeat",e=>new uj(e),"PRIVATE")),Ls(hg,sx,t),Ls(hg,sx,"esm2020"),Ls("fire-js","")}mj("");var ux=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Vs,MS;(function(){var t;function e(k,A){function D(){}D.prototype=A.prototype,k.F=A.prototype,k.prototype=new D,k.prototype.constructor=k,k.D=function(P,O,N){for(var I=Array(arguments.length-2),K=2;K<arguments.length;K++)I[K-2]=arguments[K];return A.prototype[O].apply(P,I)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(k,A,D){D||(D=0);const P=Array(16);if(typeof A=="string")for(var O=0;O<16;++O)P[O]=A.charCodeAt(D++)|A.charCodeAt(D++)<<8|A.charCodeAt(D++)<<16|A.charCodeAt(D++)<<24;else for(O=0;O<16;++O)P[O]=A[D++]|A[D++]<<8|A[D++]<<16|A[D++]<<24;A=k.g[0],D=k.g[1],O=k.g[2];let N=k.g[3],I;I=A+(N^D&(O^N))+P[0]+3614090360&4294967295,A=D+(I<<7&4294967295|I>>>25),I=N+(O^A&(D^O))+P[1]+3905402710&4294967295,N=A+(I<<12&4294967295|I>>>20),I=O+(D^N&(A^D))+P[2]+606105819&4294967295,O=N+(I<<17&4294967295|I>>>15),I=D+(A^O&(N^A))+P[3]+3250441966&4294967295,D=O+(I<<22&4294967295|I>>>10),I=A+(N^D&(O^N))+P[4]+4118548399&4294967295,A=D+(I<<7&4294967295|I>>>25),I=N+(O^A&(D^O))+P[5]+1200080426&4294967295,N=A+(I<<12&4294967295|I>>>20),I=O+(D^N&(A^D))+P[6]+2821735955&4294967295,O=N+(I<<17&4294967295|I>>>15),I=D+(A^O&(N^A))+P[7]+4249261313&4294967295,D=O+(I<<22&4294967295|I>>>10),I=A+(N^D&(O^N))+P[8]+1770035416&4294967295,A=D+(I<<7&4294967295|I>>>25),I=N+(O^A&(D^O))+P[9]+2336552879&4294967295,N=A+(I<<12&4294967295|I>>>20),I=O+(D^N&(A^D))+P[10]+4294925233&4294967295,O=N+(I<<17&4294967295|I>>>15),I=D+(A^O&(N^A))+P[11]+2304563134&4294967295,D=O+(I<<22&4294967295|I>>>10),I=A+(N^D&(O^N))+P[12]+1804603682&4294967295,A=D+(I<<7&4294967295|I>>>25),I=N+(O^A&(D^O))+P[13]+4254626195&4294967295,N=A+(I<<12&4294967295|I>>>20),I=O+(D^N&(A^D))+P[14]+2792965006&4294967295,O=N+(I<<17&4294967295|I>>>15),I=D+(A^O&(N^A))+P[15]+1236535329&4294967295,D=O+(I<<22&4294967295|I>>>10),I=A+(O^N&(D^O))+P[1]+4129170786&4294967295,A=D+(I<<5&4294967295|I>>>27),I=N+(D^O&(A^D))+P[6]+3225465664&4294967295,N=A+(I<<9&4294967295|I>>>23),I=O+(A^D&(N^A))+P[11]+643717713&4294967295,O=N+(I<<14&4294967295|I>>>18),I=D+(N^A&(O^N))+P[0]+3921069994&4294967295,D=O+(I<<20&4294967295|I>>>12),I=A+(O^N&(D^O))+P[5]+3593408605&4294967295,A=D+(I<<5&4294967295|I>>>27),I=N+(D^O&(A^D))+P[10]+38016083&4294967295,N=A+(I<<9&4294967295|I>>>23),I=O+(A^D&(N^A))+P[15]+3634488961&4294967295,O=N+(I<<14&4294967295|I>>>18),I=D+(N^A&(O^N))+P[4]+3889429448&4294967295,D=O+(I<<20&4294967295|I>>>12),I=A+(O^N&(D^O))+P[9]+568446438&4294967295,A=D+(I<<5&4294967295|I>>>27),I=N+(D^O&(A^D))+P[14]+3275163606&4294967295,N=A+(I<<9&4294967295|I>>>23),I=O+(A^D&(N^A))+P[3]+4107603335&4294967295,O=N+(I<<14&4294967295|I>>>18),I=D+(N^A&(O^N))+P[8]+1163531501&4294967295,D=O+(I<<20&4294967295|I>>>12),I=A+(O^N&(D^O))+P[13]+2850285829&4294967295,A=D+(I<<5&4294967295|I>>>27),I=N+(D^O&(A^D))+P[2]+4243563512&4294967295,N=A+(I<<9&4294967295|I>>>23),I=O+(A^D&(N^A))+P[7]+1735328473&4294967295,O=N+(I<<14&4294967295|I>>>18),I=D+(N^A&(O^N))+P[12]+2368359562&4294967295,D=O+(I<<20&4294967295|I>>>12),I=A+(D^O^N)+P[5]+4294588738&4294967295,A=D+(I<<4&4294967295|I>>>28),I=N+(A^D^O)+P[8]+2272392833&4294967295,N=A+(I<<11&4294967295|I>>>21),I=O+(N^A^D)+P[11]+1839030562&4294967295,O=N+(I<<16&4294967295|I>>>16),I=D+(O^N^A)+P[14]+4259657740&4294967295,D=O+(I<<23&4294967295|I>>>9),I=A+(D^O^N)+P[1]+2763975236&4294967295,A=D+(I<<4&4294967295|I>>>28),I=N+(A^D^O)+P[4]+1272893353&4294967295,N=A+(I<<11&4294967295|I>>>21),I=O+(N^A^D)+P[7]+4139469664&4294967295,O=N+(I<<16&4294967295|I>>>16),I=D+(O^N^A)+P[10]+3200236656&4294967295,D=O+(I<<23&4294967295|I>>>9),I=A+(D^O^N)+P[13]+681279174&4294967295,A=D+(I<<4&4294967295|I>>>28),I=N+(A^D^O)+P[0]+3936430074&4294967295,N=A+(I<<11&4294967295|I>>>21),I=O+(N^A^D)+P[3]+3572445317&4294967295,O=N+(I<<16&4294967295|I>>>16),I=D+(O^N^A)+P[6]+76029189&4294967295,D=O+(I<<23&4294967295|I>>>9),I=A+(D^O^N)+P[9]+3654602809&4294967295,A=D+(I<<4&4294967295|I>>>28),I=N+(A^D^O)+P[12]+3873151461&4294967295,N=A+(I<<11&4294967295|I>>>21),I=O+(N^A^D)+P[15]+530742520&4294967295,O=N+(I<<16&4294967295|I>>>16),I=D+(O^N^A)+P[2]+3299628645&4294967295,D=O+(I<<23&4294967295|I>>>9),I=A+(O^(D|~N))+P[0]+4096336452&4294967295,A=D+(I<<6&4294967295|I>>>26),I=N+(D^(A|~O))+P[7]+1126891415&4294967295,N=A+(I<<10&4294967295|I>>>22),I=O+(A^(N|~D))+P[14]+2878612391&4294967295,O=N+(I<<15&4294967295|I>>>17),I=D+(N^(O|~A))+P[5]+4237533241&4294967295,D=O+(I<<21&4294967295|I>>>11),I=A+(O^(D|~N))+P[12]+1700485571&4294967295,A=D+(I<<6&4294967295|I>>>26),I=N+(D^(A|~O))+P[3]+2399980690&4294967295,N=A+(I<<10&4294967295|I>>>22),I=O+(A^(N|~D))+P[10]+4293915773&4294967295,O=N+(I<<15&4294967295|I>>>17),I=D+(N^(O|~A))+P[1]+2240044497&4294967295,D=O+(I<<21&4294967295|I>>>11),I=A+(O^(D|~N))+P[8]+1873313359&4294967295,A=D+(I<<6&4294967295|I>>>26),I=N+(D^(A|~O))+P[15]+4264355552&4294967295,N=A+(I<<10&4294967295|I>>>22),I=O+(A^(N|~D))+P[6]+2734768916&4294967295,O=N+(I<<15&4294967295|I>>>17),I=D+(N^(O|~A))+P[13]+1309151649&4294967295,D=O+(I<<21&4294967295|I>>>11),I=A+(O^(D|~N))+P[4]+4149444226&4294967295,A=D+(I<<6&4294967295|I>>>26),I=N+(D^(A|~O))+P[11]+3174756917&4294967295,N=A+(I<<10&4294967295|I>>>22),I=O+(A^(N|~D))+P[2]+718787259&4294967295,O=N+(I<<15&4294967295|I>>>17),I=D+(N^(O|~A))+P[9]+3951481745&4294967295,k.g[0]=k.g[0]+A&4294967295,k.g[1]=k.g[1]+(O+(I<<21&4294967295|I>>>11))&4294967295,k.g[2]=k.g[2]+O&4294967295,k.g[3]=k.g[3]+N&4294967295}i.prototype.v=function(k,A){A===void 0&&(A=k.length);const D=A-this.blockSize,P=this.C;let O=this.h,N=0;for(;N<A;){if(O==0)for(;N<=D;)a(this,k,N),N+=this.blockSize;if(typeof k=="string"){for(;N<A;)if(P[O++]=k.charCodeAt(N++),O==this.blockSize){a(this,P),O=0;break}}else for(;N<A;)if(P[O++]=k[N++],O==this.blockSize){a(this,P),O=0;break}}this.h=O,this.o+=A},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var A=1;A<k.length-8;++A)k[A]=0;A=this.o*8;for(var D=k.length-8;D<k.length;++D)k[D]=A&255,A/=256;for(this.v(k),k=Array(16),A=0,D=0;D<4;++D)for(let P=0;P<32;P+=8)k[A++]=this.g[D]>>>P&255;return k};function l(k,A){var D=h;return Object.prototype.hasOwnProperty.call(D,k)?D[k]:D[k]=A(k)}function c(k,A){this.h=A;const D=[];let P=!0;for(let O=k.length-1;O>=0;O--){const N=k[O]|0;P&&N==A||(D[O]=N,P=!1)}this.g=D}var h={};function f(k){return-128<=k&&k<128?l(k,function(A){return new c([A|0],A<0?-1:0)}):new c([k|0],k<0?-1:0)}function p(k){if(isNaN(k)||!isFinite(k))return v;if(k<0)return j(p(-k));const A=[];let D=1;for(let P=0;k>=D;P++)A[P]=k/D|0,D*=4294967296;return new c(A,0)}function _(k,A){if(k.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(k.charAt(0)=="-")return j(_(k.substring(1),A));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=p(Math.pow(A,8));let P=v;for(let N=0;N<k.length;N+=8){var O=Math.min(8,k.length-N);const I=parseInt(k.substring(N,N+O),A);O<8?(O=p(Math.pow(A,O)),P=P.j(O).add(p(I))):(P=P.j(D),P=P.add(p(I)))}return P}var v=f(0),b=f(1),S=f(16777216);t=c.prototype,t.m=function(){if(C(this))return-j(this).m();let k=0,A=1;for(let D=0;D<this.g.length;D++){const P=this.i(D);k+=(P>=0?P:4294967296+P)*A,A*=4294967296}return k},t.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(T(this))return"0";if(C(this))return"-"+j(this).toString(k);const A=p(Math.pow(k,6));var D=this;let P="";for(;;){const O=Z(D,A).g;D=z(D,O.j(A));let N=((D.g.length>0?D.g[0]:D.h)>>>0).toString(k);if(D=O,T(D))return N+P;for(;N.length<6;)N="0"+N;P=N+P}},t.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function T(k){if(k.h!=0)return!1;for(let A=0;A<k.g.length;A++)if(k.g[A]!=0)return!1;return!0}function C(k){return k.h==-1}t.l=function(k){return k=z(this,k),C(k)?-1:T(k)?0:1};function j(k){const A=k.g.length,D=[];for(let P=0;P<A;P++)D[P]=~k.g[P];return new c(D,~k.h).add(b)}t.abs=function(){return C(this)?j(this):this},t.add=function(k){const A=Math.max(this.g.length,k.g.length),D=[];let P=0;for(let O=0;O<=A;O++){let N=P+(this.i(O)&65535)+(k.i(O)&65535),I=(N>>>16)+(this.i(O)>>>16)+(k.i(O)>>>16);P=I>>>16,N&=65535,I&=65535,D[O]=I<<16|N}return new c(D,D[D.length-1]&-2147483648?-1:0)};function z(k,A){return k.add(j(A))}t.j=function(k){if(T(this)||T(k))return v;if(C(this))return C(k)?j(this).j(j(k)):j(j(this).j(k));if(C(k))return j(this.j(j(k)));if(this.l(S)<0&&k.l(S)<0)return p(this.m()*k.m());const A=this.g.length+k.g.length,D=[];for(var P=0;P<2*A;P++)D[P]=0;for(P=0;P<this.g.length;P++)for(let O=0;O<k.g.length;O++){const N=this.i(P)>>>16,I=this.i(P)&65535,K=k.i(O)>>>16,F=k.i(O)&65535;D[2*P+2*O]+=I*F,q(D,2*P+2*O),D[2*P+2*O+1]+=N*F,q(D,2*P+2*O+1),D[2*P+2*O+1]+=I*K,q(D,2*P+2*O+1),D[2*P+2*O+2]+=N*K,q(D,2*P+2*O+2)}for(k=0;k<A;k++)D[k]=D[2*k+1]<<16|D[2*k];for(k=A;k<2*A;k++)D[k]=0;return new c(D,0)};function q(k,A){for(;(k[A]&65535)!=k[A];)k[A+1]+=k[A]>>>16,k[A]&=65535,A++}function U(k,A){this.g=k,this.h=A}function Z(k,A){if(T(A))throw Error("division by zero");if(T(k))return new U(v,v);if(C(k))return A=Z(j(k),A),new U(j(A.g),j(A.h));if(C(A))return A=Z(k,j(A)),new U(j(A.g),A.h);if(k.g.length>30){if(C(k)||C(A))throw Error("slowDivide_ only works with positive integers.");for(var D=b,P=A;P.l(k)<=0;)D=J(D),P=J(P);var O=ne(D,1),N=ne(P,1);for(P=ne(P,2),D=ne(D,2);!T(P);){var I=N.add(P);I.l(k)<=0&&(O=O.add(D),N=I),P=ne(P,1),D=ne(D,1)}return A=z(k,O.j(A)),new U(O,A)}for(O=v;k.l(A)>=0;){for(D=Math.max(1,Math.floor(k.m()/A.m())),P=Math.ceil(Math.log(D)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),N=p(D),I=N.j(A);C(I)||I.l(k)>0;)D-=P,N=p(D),I=N.j(A);T(N)&&(N=b),O=O.add(N),k=z(k,I)}return new U(O,k)}t.B=function(k){return Z(this,k).h},t.and=function(k){const A=Math.max(this.g.length,k.g.length),D=[];for(let P=0;P<A;P++)D[P]=this.i(P)&k.i(P);return new c(D,this.h&k.h)},t.or=function(k){const A=Math.max(this.g.length,k.g.length),D=[];for(let P=0;P<A;P++)D[P]=this.i(P)|k.i(P);return new c(D,this.h|k.h)},t.xor=function(k){const A=Math.max(this.g.length,k.g.length),D=[];for(let P=0;P<A;P++)D[P]=this.i(P)^k.i(P);return new c(D,this.h^k.h)};function J(k){const A=k.g.length+1,D=[];for(let P=0;P<A;P++)D[P]=k.i(P)<<1|k.i(P-1)>>>31;return new c(D,k.h)}function ne(k,A){const D=A>>5;A%=32;const P=k.g.length-D,O=[];for(let N=0;N<P;N++)O[N]=A>0?k.i(N+D)>>>A|k.i(N+D+1)<<32-A:k.i(N+D);return new c(O,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,MS=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=_,Vs=c}).apply(typeof ux<"u"?ux:typeof self<"u"?self:typeof window<"u"?window:{});var Jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var NS,Nc,PS,oh,pg,LS,VS,BS;(function(){var t,e=Object.defineProperty;function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jd=="object"&&Jd];for(var x=0;x<m.length;++x){var w=m[x];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var i=n(this);function a(m,x){if(x)e:{var w=i;m=m.split(".");for(var B=0;B<m.length-1;B++){var re=m[B];if(!(re in w))break e;w=w[re]}m=m[m.length-1],B=w[m],x=x(B),x!=B&&x!=null&&e(w,m,{configurable:!0,writable:!0,value:x})}}a("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(m){return m||function(x){var w=[],B;for(B in x)Object.prototype.hasOwnProperty.call(x,B)&&w.push([B,x[B]]);return w}});var l=l||{},c=this||self;function h(m){var x=typeof m;return x=="object"&&m!=null||x=="function"}function f(m,x,w){return m.call.apply(m.bind,arguments)}function p(m,x,w){return p=f,p.apply(null,arguments)}function _(m,x){var w=Array.prototype.slice.call(arguments,1);return function(){var B=w.slice();return B.push.apply(B,arguments),m.apply(this,B)}}function v(m,x){function w(){}w.prototype=x.prototype,m.Z=x.prototype,m.prototype=new w,m.prototype.constructor=m,m.Ob=function(B,re,ue){for(var Se=Array(arguments.length-2),Ge=2;Ge<arguments.length;Ge++)Se[Ge-2]=arguments[Ge];return x.prototype[re].apply(B,Se)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function S(m){const x=m.length;if(x>0){const w=Array(x);for(let B=0;B<x;B++)w[B]=m[B];return w}return[]}function T(m,x){for(let B=1;B<arguments.length;B++){const re=arguments[B];var w=typeof re;if(w=w!="object"?w:re?Array.isArray(re)?"array":w:"null",w=="array"||w=="object"&&typeof re.length=="number"){w=m.length||0;const ue=re.length||0;m.length=w+ue;for(let Se=0;Se<ue;Se++)m[w+Se]=re[Se]}else m.push(re)}}class C{constructor(x,w){this.i=x,this.j=w,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function j(m){c.setTimeout(()=>{throw m},0)}function z(){var m=k;let x=null;return m.g&&(x=m.g,m.g=m.g.next,m.g||(m.h=null),x.next=null),x}class q{constructor(){this.h=this.g=null}add(x,w){const B=U.get();B.set(x,w),this.h?this.h.next=B:this.g=B,this.h=B}}var U=new C(()=>new Z,m=>m.reset());class Z{constructor(){this.next=this.g=this.h=null}set(x,w){this.h=x,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let J,ne=!1,k=new q,A=()=>{const m=Promise.resolve(void 0);J=()=>{m.then(D)}};function D(){for(var m;m=z();){try{m.h.call(m.g)}catch(w){j(w)}var x=U;x.j(m),x.h<100&&(x.h++,m.next=x.g,x.g=m)}ne=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(m,x){this.type=m,this.g=this.target=x,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var N=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var m=!1,x=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const w=()=>{};c.addEventListener("test",w,x),c.removeEventListener("test",w,x)}catch{}return m})();function I(m){return/^[\s\xa0]*$/.test(m)}function K(m,x){O.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,x)}v(K,O),K.prototype.init=function(m,x){const w=this.type=m.type,B=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=x,x=m.relatedTarget,x||(w=="mouseover"?x=m.fromElement:w=="mouseout"&&(x=m.toElement)),this.relatedTarget=x,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&K.Z.h.call(this)},K.prototype.h=function(){K.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var F="closure_listenable_"+(Math.random()*1e6|0),L=0;function $(m,x,w,B,re){this.listener=m,this.proxy=null,this.src=x,this.type=w,this.capture=!!B,this.ha=re,this.key=++L,this.da=this.fa=!1}function Y(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function Q(m,x,w){for(const B in m)x.call(w,m[B],B,m)}function X(m,x){for(const w in m)x.call(void 0,m[w],w,m)}function V(m){const x={};for(const w in m)x[w]=m[w];return x}const H="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function oe(m,x){let w,B;for(let re=1;re<arguments.length;re++){B=arguments[re];for(w in B)m[w]=B[w];for(let ue=0;ue<H.length;ue++)w=H[ue],Object.prototype.hasOwnProperty.call(B,w)&&(m[w]=B[w])}}function se(m){this.src=m,this.g={},this.h=0}se.prototype.add=function(m,x,w,B,re){const ue=m.toString();m=this.g[ue],m||(m=this.g[ue]=[],this.h++);const Se=ge(m,x,B,re);return Se>-1?(x=m[Se],w||(x.fa=!1)):(x=new $(x,this.src,ue,!!B,re),x.fa=w,m.push(x)),x};function te(m,x){const w=x.type;if(w in m.g){var B=m.g[w],re=Array.prototype.indexOf.call(B,x,void 0),ue;(ue=re>=0)&&Array.prototype.splice.call(B,re,1),ue&&(Y(x),m.g[w].length==0&&(delete m.g[w],m.h--))}}function ge(m,x,w,B){for(let re=0;re<m.length;++re){const ue=m[re];if(!ue.da&&ue.listener==x&&ue.capture==!!w&&ue.ha==B)return re}return-1}var xe="closure_lm_"+(Math.random()*1e6|0),pe={};function Ee(m,x,w,B,re){if(Array.isArray(x)){for(let ue=0;ue<x.length;ue++)Ee(m,x[ue],w,B,re);return null}return w=Ke(w),m&&m[F]?m.J(x,w,h(B)?!!B.capture:!1,re):he(m,x,w,!1,B,re)}function he(m,x,w,B,re,ue){if(!x)throw Error("Invalid event type");const Se=h(re)?!!re.capture:!!re;let Ge=Je(m);if(Ge||(m[xe]=Ge=new se(m)),w=Ge.add(x,w,B,Se,ue),w.proxy)return w;if(B=Re(),w.proxy=B,B.src=m,B.listener=w,m.addEventListener)N||(re=Se),re===void 0&&(re=!1),m.addEventListener(x.toString(),B,re);else if(m.attachEvent)m.attachEvent(Ie(x.toString()),B);else if(m.addListener&&m.removeListener)m.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Re(){function m(w){return x.call(m.src,m.listener,w)}const x=ze;return m}function De(m,x,w,B,re){if(Array.isArray(x))for(var ue=0;ue<x.length;ue++)De(m,x[ue],w,B,re);else B=h(B)?!!B.capture:!!B,w=Ke(w),m&&m[F]?(m=m.i,ue=String(x).toString(),ue in m.g&&(x=m.g[ue],w=ge(x,w,B,re),w>-1&&(Y(x[w]),Array.prototype.splice.call(x,w,1),x.length==0&&(delete m.g[ue],m.h--)))):m&&(m=Je(m))&&(x=m.g[x.toString()],m=-1,x&&(m=ge(x,w,B,re)),(w=m>-1?x[m]:null)&&vt(w))}function vt(m){if(typeof m!="number"&&m&&!m.da){var x=m.src;if(x&&x[F])te(x.i,m);else{var w=m.type,B=m.proxy;x.removeEventListener?x.removeEventListener(w,B,m.capture):x.detachEvent?x.detachEvent(Ie(w),B):x.addListener&&x.removeListener&&x.removeListener(B),(w=Je(x))?(te(w,m),w.h==0&&(w.src=null,x[xe]=null)):Y(m)}}}function Ie(m){return m in pe?pe[m]:pe[m]="on"+m}function ze(m,x){if(m.da)m=!0;else{x=new K(x,this);const w=m.listener,B=m.ha||m.src;m.fa&&vt(m),m=w.call(B,x)}return m}function Je(m){return m=m[xe],m instanceof se?m:null}var Ct="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ke(m){return typeof m=="function"?m:(m[Ct]||(m[Ct]=function(x){return m.handleEvent(x)}),m[Ct])}function Ue(){P.call(this),this.i=new se(this),this.M=this,this.G=null}v(Ue,P),Ue.prototype[F]=!0,Ue.prototype.removeEventListener=function(m,x,w,B){De(this,m,x,w,B)};function lt(m,x){var w,B=m.G;if(B)for(w=[];B;B=B.G)w.push(B);if(m=m.M,B=x.type||x,typeof x=="string")x=new O(x,m);else if(x instanceof O)x.target=x.target||m;else{var re=x;x=new O(B,m),oe(x,re)}re=!0;let ue,Se;if(w)for(Se=w.length-1;Se>=0;Se--)ue=x.g=w[Se],re=Mt(ue,B,!0,x)&&re;if(ue=x.g=m,re=Mt(ue,B,!0,x)&&re,re=Mt(ue,B,!1,x)&&re,w)for(Se=0;Se<w.length;Se++)ue=x.g=w[Se],re=Mt(ue,B,!1,x)&&re}Ue.prototype.N=function(){if(Ue.Z.N.call(this),this.i){var m=this.i;for(const x in m.g){const w=m.g[x];for(let B=0;B<w.length;B++)Y(w[B]);delete m.g[x],m.h--}}this.G=null},Ue.prototype.J=function(m,x,w,B){return this.i.add(String(m),x,!1,w,B)},Ue.prototype.K=function(m,x,w,B){return this.i.add(String(m),x,!0,w,B)};function Mt(m,x,w,B){if(x=m.i.g[String(x)],!x)return!0;x=x.concat();let re=!0;for(let ue=0;ue<x.length;++ue){const Se=x[ue];if(Se&&!Se.da&&Se.capture==w){const Ge=Se.listener,Vt=Se.ha||Se.src;Se.fa&&te(m.i,Se),re=Ge.call(Vt,B)!==!1&&re}}return re&&!B.defaultPrevented}function fn(m,x){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=p(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:c.setTimeout(m,x||0)}function Dn(m){m.g=fn(()=>{m.g=null,m.i&&(m.i=!1,Dn(m))},m.l);const x=m.h;m.h=null,m.m.apply(null,x)}class nn extends P{constructor(x,w){super(),this.m=x,this.l=w,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Dn(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zs(m){P.call(this),this.h=m,this.g={}}v(Zs,P);var Rl=[];function Dl(m){Q(m.g,function(x,w){this.g.hasOwnProperty(w)&&vt(x)},m),m.g={}}Zs.prototype.N=function(){Zs.Z.N.call(this),Dl(this)},Zs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wi=c.JSON.stringify,If=c.JSON.parse,Eu=class{stringify(m){return c.JSON.stringify(m,void 0)}parse(m){return c.JSON.parse(m,void 0)}};function Su(){}function wu(){}var vr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function mn(){O.call(this,"d")}v(mn,O);function rr(){O.call(this,"c")}v(rr,O);var Lt={},Tu=null;function qa(){return Tu=Tu||new Ue}Lt.Ia="serverreachability";function Au(m){O.call(this,Lt.Ia,m)}v(Au,O);function Vr(m){const x=qa();lt(x,new Au(x))}Lt.STAT_EVENT="statevent";function ea(m,x){O.call(this,Lt.STAT_EVENT,m),this.stat=x}v(ea,O);function Ht(m){const x=qa();lt(x,new ea(x,m))}Lt.Ja="timingevent";function Br(m,x){O.call(this,Lt.Ja,m),this.size=x}v(Br,O);function zr(m,x){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){m()},x)}function br(){this.g=!0}br.prototype.ua=function(){this.g=!1};function jf(m,x,w,B,re,ue){m.info(function(){if(m.g)if(ue){var Se="",Ge=ue.split("&");for(let ct=0;ct<Ge.length;ct++){var Vt=Ge[ct].split("=");if(Vt.length>1){const Rt=Vt[0];Vt=Vt[1];const or=Rt.split("_");Se=or.length>=2&&or[1]=="type"?Se+(Rt+"="+Vt+"&"):Se+(Rt+"=redacted&")}}}else Se=null;else Se=ue;return"XMLHTTP REQ ("+B+") [attempt "+re+"]: "+x+`
`+w+`
`+Se})}function Cu(m,x,w,B,re,ue,Se){m.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+re+"]: "+x+`
`+w+`
`+ue+" "+Se})}function Ur(m,x,w,B){m.info(function(){return"XMLHTTP TEXT ("+x+"): "+kf(m,w)+(B?" "+B:"")})}function ta(m,x){m.info(function(){return"TIMEOUT: "+x})}br.prototype.info=function(){};function kf(m,x){if(!m.g)return x;if(!x)return null;try{const ue=JSON.parse(x);if(ue){for(m=0;m<ue.length;m++)if(Array.isArray(ue[m])){var w=ue[m];if(!(w.length<2)){var B=w[1];if(Array.isArray(B)&&!(B.length<1)){var re=B[0];if(re!="noop"&&re!="stop"&&re!="close")for(let Se=1;Se<B.length;Se++)B[Se]=""}}}}return Wi(ue)}catch{return x}}var na={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Il={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},jl;function ra(){}v(ra,Su),ra.prototype.g=function(){return new XMLHttpRequest},jl=new ra;function yi(m){return encodeURIComponent(String(m))}function Ru(m){var x=1;m=m.split(":");const w=[];for(;x>0&&m.length;)w.push(m.shift()),x--;return m.length&&w.push(m.join(":")),w}function xr(m,x,w,B){this.j=m,this.i=x,this.l=w,this.S=B||1,this.V=new Zs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Er}function Er(){this.i=null,this.g="",this.h=!1}var Gt={},ln={};function Fr(m,x,w){m.M=1,m.A=ia($t(x)),m.u=w,m.R=!0,Ha(m,null)}function Ha(m,x){m.F=Date.now(),qr(m),m.B=$t(m.A);var w=m.B,B=m.S;Array.isArray(B)||(B=[String(B)]),Ka(w.i,"t",B),m.C=0,w=m.j.L,m.h=new Er,m.g=qu(m.j,w?x:null,!m.u),m.P>0&&(m.O=new nn(p(m.Y,m,m.g),m.P)),x=m.V,w=m.g,B=m.ba;var re="readystatechange";Array.isArray(re)||(re&&(Rl[0]=re.toString()),re=Rl);for(let ue=0;ue<re.length;ue++){const Se=Ee(w,re[ue],B||x.handleEvent,!1,x.h||x);if(!Se)break;x.g[Se.key]=Se}x=m.J?V(m.J):{},m.u?(m.v||(m.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,x)):(m.v="GET",m.g.ea(m.B,m.v,null,x)),Vr(),jf(m.i,m.v,m.B,m.l,m.S,m.u)}xr.prototype.ba=function(m){m=m.target;const x=this.O;x&&Tr(m)==3?x.j():this.Y(m)},xr.prototype.Y=function(m){try{if(m==this.g)e:{const Ge=Tr(this.g),Vt=this.g.ya(),ct=this.g.ca();if(!(Ge<3)&&(Ge!=3||this.g&&(this.h.h||this.g.la()||pn(this.g)))){this.K||Ge!=4||Vt==7||(Vt==8||ct<=0?Vr(3):Vr(2)),Hr(this);var x=this.g.ca();this.X=x;var w=Of(this);if(this.o=x==200,Cu(this.i,this.v,this.B,this.l,this.S,Ge,x),this.o){if(this.U&&!this.L){t:{if(this.g){var B,re=this.g;if((B=re.g?re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(B)){var ue=B;break t}}ue=null}if(m=ue)Ur(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Gr(this,m);else{this.o=!1,this.m=3,Ht(12),Gn(this),ir(this);break e}}if(this.R){m=!0;let Rt;for(;!this.K&&this.C<w.length;)if(Rt=Iu(this,w),Rt==ln){Ge==4&&(this.m=4,Ht(14),m=!1),Ur(this.i,this.l,null,"[Incomplete Response]");break}else if(Rt==Gt){this.m=4,Ht(15),Ur(this.i,this.l,w,"[Invalid Chunk]"),m=!1;break}else Ur(this.i,this.l,Rt,null),Gr(this,Rt);if(Du(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ge!=4||w.length!=0||this.h.h||(this.m=1,Ht(16),m=!1),this.o=this.o&&m,!m)Ur(this.i,this.l,w,"[Invalid Chunked Response]"),Gn(this),ir(this);else if(w.length>0&&!this.W){this.W=!0;var Se=this.j;Se.g==this&&Se.aa&&!Se.P&&(Se.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Ql(Se),Se.P=!0,Ht(11))}}else Ur(this.i,this.l,w,null),Gr(this,w);Ge==4&&Gn(this),this.o&&!this.K&&(Ge==4?Bu(this.j,this):(this.o=!1,qr(this)))}else vi(this.g),x==400&&w.indexOf("Unknown SID")>0?(this.m=3,Ht(12)):(this.m=0,Ht(13)),Gn(this),ir(this)}}}catch{}};function Of(m){if(!Du(m))return m.g.la();const x=pn(m.g);if(x==="")return"";let w="";const B=x.length,re=Tr(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Gn(m),ir(m),"";m.h.i=new c.TextDecoder}for(let ue=0;ue<B;ue++)m.h.h=!0,w+=m.h.i.decode(x[ue],{stream:!(re&&ue==B-1)});return x.length=0,m.h.g+=w,m.C=0,m.h.g}function Du(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function Iu(m,x){var w=m.C,B=x.indexOf(`
`,w);return B==-1?ln:(w=Number(x.substring(w,B)),isNaN(w)?Gt:(B+=1,B+w>x.length?ln:(x=x.slice(B,B+w),m.C=B+w,x)))}xr.prototype.cancel=function(){this.K=!0,Gn(this)};function qr(m){m.T=Date.now()+m.H,Ga(m,m.H)}function Ga(m,x){if(m.D!=null)throw Error("WatchDog timer not null");m.D=zr(p(m.aa,m),x)}function Hr(m){m.D&&(c.clearTimeout(m.D),m.D=null)}xr.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(ta(this.i,this.B),this.M!=2&&(Vr(),Ht(17)),Gn(this),this.m=2,ir(this)):Ga(this,this.T-m)};function ir(m){m.j.I==0||m.K||Bu(m.j,m)}function Gn(m){Hr(m);var x=m.O;x&&typeof x.dispose=="function"&&x.dispose(),m.O=null,Dl(m.V),m.g&&(x=m.g,m.g=null,x.abort(),x.dispose())}function Gr(m,x){try{var w=m.j;if(w.I!=0&&(w.g==m||$r(w.h,m))){if(!m.L&&$r(w.h,m)&&w.I==3){try{var B=w.Ba.g.parse(x)}catch{B=null}if(Array.isArray(B)&&B.length==3){var re=B;if(re[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<m.F)Za(w),rs(w);else break e;da(w),Ht(18)}}else w.xa=re[1],0<w.xa-w.K&&re[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=zr(p(w.Va,w),6e3));Qr(w.h)<=1&&w.ta&&(w.ta=void 0)}else Zr(w,11)}else if((m.L||w.g==m)&&Za(w),!I(x))for(re=w.Ba.g.parse(x),x=0;x<re.length;x++){let ct=re[x];const Rt=ct[0];if(!(Rt<=w.K))if(w.K=Rt,ct=ct[1],w.I==2)if(ct[0]=="c"){w.M=ct[1],w.ba=ct[2];const or=ct[3];or!=null&&(w.ka=or,w.j.info("VER="+w.ka));const ei=ct[4];ei!=null&&(w.za=ei,w.j.info("SVER="+w.za));const Ar=ct[5];Ar!=null&&typeof Ar=="number"&&Ar>0&&(B=1.5*Ar,w.O=B,w.j.info("backChannelRequestTimeoutMs_="+B)),B=w;const Cr=m.g;if(Cr){const ha=Cr.g?Cr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ha){var ue=B.h;ue.g||ha.indexOf("spdy")==-1&&ha.indexOf("quic")==-1&&ha.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(Ml(ue,ue.h),ue.h=null))}if(B.G){const eo=Cr.g?Cr.g.getResponseHeader("X-HTTP-Session-Id"):null;eo&&(B.wa=eo,ht(B.J,B.G,eo))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-m.F,w.j.info("Handshake RTT: "+w.T+"ms")),B=w;var Se=m;if(B.na=Fu(B,B.L?B.ba:null,B.W),Se.L){Nl(B.h,Se);var Ge=Se,Vt=B.O;Vt&&(Ge.H=Vt),Ge.D&&(Hr(Ge),qr(Ge)),B.g=Se}else Lu(B);w.i.length>0&&Jr(w)}else ct[0]!="stop"&&ct[0]!="close"||Zr(w,7);else w.I==3&&(ct[0]=="stop"||ct[0]=="close"?ct[0]=="stop"?Zr(w,7):Hl(w):ct[0]!="noop"&&w.l&&w.l.qa(ct),w.A=0)}}Vr(4)}catch{}}var Qt=class{constructor(m,x){this.g=m,this.map=x}};function kl(m){this.l=m||10,c.PerformanceNavigationTiming?(m=c.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ol(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function Qr(m){return m.h?1:m.g?m.g.size:0}function $r(m,x){return m.h?m.h==x:m.g?m.g.has(x):!1}function Ml(m,x){m.g?m.g.add(x):m.h=x}function Nl(m,x){m.h&&m.h==x?m.h=null:m.g&&m.g.has(x)&&m.g.delete(x)}kl.prototype.cancel=function(){if(this.i=Pl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Pl(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let x=m.i;for(const w of m.g.values())x=x.concat(w.G);return x}return S(m.i)}var ju=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qa(m,x){if(m){m=m.split("&");for(let w=0;w<m.length;w++){const B=m[w].indexOf("=");let re,ue=null;B>=0?(re=m[w].substring(0,B),ue=m[w].substring(B+1)):re=m[w],x(re,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function Qn(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;m instanceof Qn?(this.l=m.l,cn(this,m.j),this.o=m.o,this.g=m.g,Yi(this,m.u),this.h=m.h,Ll(this,Nu(m.i)),this.m=m.m):m&&(x=String(m).match(ju))?(this.l=!1,cn(this,x[1]||"",!0),this.o=Kr(x[2]||""),this.g=Kr(x[3]||"",!0),Yi(this,x[4]),this.h=Kr(x[5]||"",!0),Ll(this,x[6]||"",!0),this.m=Kr(x[7]||"")):(this.l=!1,this.i=new Ji(null,this.l))}Qn.prototype.toString=function(){const m=[];var x=this.j;x&&m.push(sa(x,$a,!0),":");var w=this.g;return(w||x=="file")&&(m.push("//"),(x=this.o)&&m.push(sa(x,$a,!0),"@"),m.push(yi(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&m.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&m.push("/"),m.push(sa(w,w.charAt(0)=="/"?Vl:ku,!0))),(w=this.i.toString())&&m.push("?",w),(w=this.m)&&m.push("#",sa(w,Ou)),m.join("")},Qn.prototype.resolve=function(m){const x=$t(this);let w=!!m.j;w?cn(x,m.j):w=!!m.o,w?x.o=m.o:w=!!m.g,w?x.g=m.g:w=m.u!=null;var B=m.h;if(w)Yi(x,m.u);else if(w=!!m.h){if(B.charAt(0)!="/")if(this.g&&!this.h)B="/"+B;else{var re=x.h.lastIndexOf("/");re!=-1&&(B=x.h.slice(0,re+1)+B)}if(re=B,re==".."||re==".")B="";else if(re.indexOf("./")!=-1||re.indexOf("/.")!=-1){B=re.lastIndexOf("/",0)==0,re=re.split("/");const ue=[];for(let Se=0;Se<re.length;){const Ge=re[Se++];Ge=="."?B&&Se==re.length&&ue.push(""):Ge==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),B&&Se==re.length&&ue.push("")):(ue.push(Ge),B=!0)}B=ue.join("/")}else B=re}return w?x.h=B:w=m.i.toString()!=="",w?Ll(x,Nu(m.i)):w=!!m.m,w&&(x.m=m.m),x};function $t(m){return new Qn(m)}function cn(m,x,w){m.j=w?Kr(x,!0):x,m.j&&(m.j=m.j.replace(/:$/,""))}function Yi(m,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);m.u=x}else m.u=null}function Ll(m,x,w){x instanceof Ji?(m.i=x,Wa(m.i,m.l)):(w||(x=sa(x,Xi)),m.i=new Ji(x,m.l))}function ht(m,x,w){m.i.set(x,w)}function ia(m){return ht(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Kr(m,x){return m?x?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function sa(m,x,w){return typeof m=="string"?(m=encodeURI(m).replace(x,On),w&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function On(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var $a=/[#\/\?@]/g,ku=/[#\?:]/g,Vl=/[#\?]/g,Xi=/[#\?@]/g,Ou=/#/g;function Ji(m,x){this.h=this.g=null,this.i=m||null,this.j=!!x}function Mn(m){m.g||(m.g=new Map,m.h=0,m.i&&Qa(m.i,function(x,w){m.add(decodeURIComponent(x.replace(/\+/g," ")),w)}))}t=Ji.prototype,t.add=function(m,x){Mn(this),this.i=null,m=Zi(this,m);let w=this.g.get(m);return w||this.g.set(m,w=[]),w.push(x),this.h+=1,this};function Mu(m,x){Mn(m),x=Zi(m,x),m.g.has(x)&&(m.i=null,m.h-=m.g.get(x).length,m.g.delete(x))}function Bl(m,x){return Mn(m),x=Zi(m,x),m.g.has(x)}t.forEach=function(m,x){Mn(this),this.g.forEach(function(w,B){w.forEach(function(re){m.call(x,re,B,this)},this)},this)};function zl(m,x){Mn(m);let w=[];if(typeof x=="string")Bl(m,x)&&(w=w.concat(m.g.get(Zi(m,x))));else for(m=Array.from(m.g.values()),x=0;x<m.length;x++)w=w.concat(m[x]);return w}t.set=function(m,x){return Mn(this),this.i=null,m=Zi(this,m),Bl(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[x]),this.h+=1,this},t.get=function(m,x){return m?(m=zl(this,m),m.length>0?String(m[0]):x):x};function Ka(m,x,w){Mu(m,x),w.length>0&&(m.i=null,m.g.set(Zi(m,x),S(w)),m.h+=w.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],x=Array.from(this.g.keys());for(let B=0;B<x.length;B++){var w=x[B];const re=yi(w);w=zl(this,w);for(let ue=0;ue<w.length;ue++){let Se=re;w[ue]!==""&&(Se+="="+yi(w[ue])),m.push(Se)}}return this.i=m.join("&")};function Nu(m){const x=new Ji;return x.i=m.i,m.g&&(x.g=new Map(m.g),x.h=m.h),x}function Zi(m,x){return x=String(x),m.j&&(x=x.toLowerCase()),x}function Wa(m,x){x&&!m.j&&(Mn(m),m.i=null,m.g.forEach(function(w,B){const re=B.toLowerCase();B!=re&&(Mu(this,B),Ka(this,re,w))},m)),m.j=x}function Sr(m,x){const w=new br;if(c.Image){const B=new Image;B.onload=_(sr,w,"TestLoadImage: loaded",!0,x,B),B.onerror=_(sr,w,"TestLoadImage: error",!1,x,B),B.onabort=_(sr,w,"TestLoadImage: abort",!1,x,B),B.ontimeout=_(sr,w,"TestLoadImage: timeout",!1,x,B),c.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=m}else x(!1)}function Ul(m,x){const w=new br,B=new AbortController,re=setTimeout(()=>{B.abort(),sr(w,"TestPingServer: timeout",!1,x)},1e4);fetch(m,{signal:B.signal}).then(ue=>{clearTimeout(re),ue.ok?sr(w,"TestPingServer: ok",!0,x):sr(w,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(re),sr(w,"TestPingServer: error",!1,x)})}function sr(m,x,w,B,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),B(w)}catch{}}function es(){this.g=new Eu}function Wr(m){this.i=m.Sb||null,this.h=m.ab||!1}v(Wr,Su),Wr.prototype.g=function(){return new aa(this.i,this.h)};function aa(m,x){Ue.call(this),this.H=m,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(aa,Ue),t=aa.prototype,t.open=function(m,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=x,this.readyState=1,wr(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(x.body=m),(this.H||c).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ts(this)),this.readyState=0},t.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,wr(this)),this.g&&(this.readyState=3,wr(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ya(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ya(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}t.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var x=m.value?m.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!m.done}))&&(this.response=this.responseText+=x)}m.done?ts(this):wr(this),this.readyState==3&&Ya(this)}},t.Oa=function(m){this.g&&(this.response=this.responseText=m,ts(this))},t.Na=function(m){this.g&&(this.response=m,ts(this))},t.ga=function(){this.g&&ts(this)};function ts(m){m.readyState=4,m.l=null,m.j=null,m.B=null,wr(m)}t.setRequestHeader=function(m,x){this.A.append(m,x)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],x=this.h.entries();for(var w=x.next();!w.done;)w=w.value,m.push(w[0]+": "+w[1]),w=x.next();return m.join(`\r
`)};function wr(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(aa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function ar(m){let x="";return Q(m,function(w,B){x+=B,x+=":",x+=w,x+=`\r
`}),x}function oa(m,x,w){e:{for(B in w){var B=!1;break e}B=!0}B||(w=ar(w),typeof m=="string"?w!=null&&yi(w):ht(m,x,w))}function pt(m){Ue.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(pt,Ue);var Yr=/^https?$/i,Fl=["POST","PUT"];t=pt.prototype,t.Fa=function(m){this.H=m},t.ea=function(m,x,w,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);x=x?x.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():jl.g(),this.g.onreadystatechange=b(p(this.Ca,this));try{this.B=!0,this.g.open(x,String(m),!0),this.B=!1}catch(ue){la(this,ue);return}if(m=w||"",w=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var re in B)w.set(re,B[re]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const ue of B.keys())w.set(ue,B.get(ue));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(w.keys()).find(ue=>ue.toLowerCase()=="content-type"),re=c.FormData&&m instanceof c.FormData,!(Array.prototype.indexOf.call(Fl,x,void 0)>=0)||B||re||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,Se]of w)this.g.setRequestHeader(ue,Se);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(ue){la(this,ue)}};function la(m,x){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=x,m.o=5,ql(m),_i(m)}function ql(m){m.A||(m.A=!0,lt(m,"complete"),lt(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,lt(this,"complete"),lt(this,"abort"),_i(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_i(this,!0)),pt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ca(this):this.Xa())},t.Xa=function(){ca(this)};function ca(m){if(m.h&&typeof l<"u"){if(m.v&&Tr(m)==4)setTimeout(m.Ca.bind(m),0);else if(lt(m,"readystatechange"),Tr(m)==4){m.h=!1;try{const ue=m.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var w;if(!(w=x)){var B;if(B=ue===0){let Se=String(m.D).match(ju)[1]||null;!Se&&c.self&&c.self.location&&(Se=c.self.location.protocol.slice(0,-1)),B=!Yr.test(Se?Se.toLowerCase():"")}w=B}if(w)lt(m,"complete"),lt(m,"success");else{m.o=6;try{var re=Tr(m)>2?m.g.statusText:""}catch{re=""}m.l=re+" ["+m.ca()+"]",ql(m)}}finally{_i(m)}}}}function _i(m,x){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const w=m.g;m.g=null,x||lt(m,"ready");try{w.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Tr(m){return m.g?m.g.readyState:0}t.ca=function(){try{return Tr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(m){if(this.g){var x=this.g.responseText;return m&&x.indexOf(m)==0&&(x=x.substring(m.length)),If(x)}};function pn(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function vi(m){const x={};m=(m.g&&Tr(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<m.length;B++){if(I(m[B]))continue;var w=Ru(m[B]);const re=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const ue=x[re]||[];x[re]=ue,ue.push(w)}X(x,function(B){return B.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Xr(m,x,w){return w&&w.internalChannelParams&&w.internalChannelParams[m]||x}function ns(m){this.za=0,this.i=[],this.j=new br,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Xr("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Xr("baseRetryDelayMs",5e3,m),this.Za=Xr("retryDelaySeedMs",1e4,m),this.Ta=Xr("forwardChannelMaxRetries",2,m),this.va=Xr("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new kl(m&&m.concurrentRequestLimit),this.Ba=new es,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ns.prototype,t.ka=8,t.I=1,t.connect=function(m,x,w,B){Ht(0),this.W=m,this.H=x||{},w&&B!==void 0&&(this.H.OSID=w,this.H.OAID=B),this.F=this.X,this.J=Fu(this,null,this.W),Jr(this)};function Hl(m){if(Xa(m),m.I==3){var x=m.V++,w=$t(m.J);if(ht(w,"SID",m.M),ht(w,"RID",x),ht(w,"TYPE","terminate"),ua(m,w),x=new xr(m,m.j,x),x.M=2,x.A=ia($t(w)),w=!1,c.navigator&&c.navigator.sendBeacon)try{w=c.navigator.sendBeacon(x.A.toString(),"")}catch{}!w&&c.Image&&(new Image().src=x.A,w=!0),w||(x.g=qu(x.j,null),x.g.ea(x.A)),x.F=Date.now(),qr(x)}Uu(m)}function rs(m){m.g&&(Ql(m),m.g.cancel(),m.g=null)}function Xa(m){rs(m),m.v&&(c.clearTimeout(m.v),m.v=null),Za(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&c.clearTimeout(m.m),m.m=null)}function Jr(m){if(!Ol(m.h)&&!m.m){m.m=!0;var x=m.Ea;J||A(),ne||(J(),ne=!0),k.add(x,m),m.D=0}}function Ja(m,x){return Qr(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=x.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=zr(p(m.Ea,m,x),zu(m,m.D)),m.D++,!0)}t.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const re=new xr(this,this.j,m);let ue=this.o;if(this.U&&(ue?(ue=V(ue),oe(ue,this.U)):ue=this.U),this.u!==null||this.R||(re.J=ue,ue=null),this.S)e:{for(var x=0,w=0;w<this.i.length;w++){t:{var B=this.i[w];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(x+=B,x>4096){x=w;break e}if(x===4096||w===this.i.length-1){x=w+1;break e}}x=1e3}else x=1e3;x=Pu(this,re,x),w=$t(this.J),ht(w,"RID",m),ht(w,"CVER",22),this.G&&ht(w,"X-HTTP-Session-Id",this.G),ua(this,w),ue&&(this.R?x="headers="+yi(ar(ue))+"&"+x:this.u&&oa(w,this.u,ue)),Ml(this.h,re),this.Ra&&ht(w,"TYPE","init"),this.S?(ht(w,"$req",x),ht(w,"SID","null"),re.U=!0,Fr(re,w,null)):Fr(re,w,x),this.I=2}}else this.I==3&&(m?Gl(this,m):this.i.length==0||Ol(this.h)||Gl(this))};function Gl(m,x){var w;x?w=x.l:w=m.V++;const B=$t(m.J);ht(B,"SID",m.M),ht(B,"RID",w),ht(B,"AID",m.K),ua(m,B),m.u&&m.o&&oa(B,m.u,m.o),w=new xr(m,m.j,w,m.D+1),m.u===null&&(w.J=m.o),x&&(m.i=x.G.concat(m.i)),x=Pu(m,w,1e3),w.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),Ml(m.h,w),Fr(w,B,x)}function ua(m,x){m.H&&Q(m.H,function(w,B){ht(x,B,w)}),m.l&&Q({},function(w,B){ht(x,B,w)})}function Pu(m,x,w){w=Math.min(m.i.length,w);const B=m.l?p(m.l.Ka,m.l,m):null;e:{var re=m.i;let Ge=-1;for(;;){const Vt=["count="+w];Ge==-1?w>0?(Ge=re[0].g,Vt.push("ofs="+Ge)):Ge=0:Vt.push("ofs="+Ge);let ct=!0;for(let Rt=0;Rt<w;Rt++){var ue=re[Rt].g;const or=re[Rt].map;if(ue-=Ge,ue<0)Ge=Math.max(0,re[Rt].g-100),ct=!1;else try{ue="req"+ue+"_"||"";try{var Se=or instanceof Map?or:Object.entries(or);for(const[ei,Ar]of Se){let Cr=Ar;h(Ar)&&(Cr=Wi(Ar)),Vt.push(ue+ei+"="+encodeURIComponent(Cr))}}catch(ei){throw Vt.push(ue+"type="+encodeURIComponent("_badmap")),ei}}catch{B&&B(or)}}if(ct){Se=Vt.join("&");break e}}Se=void 0}return m=m.i.splice(0,w),x.G=m,Se}function Lu(m){if(!m.g&&!m.v){m.Y=1;var x=m.Da;J||A(),ne||(J(),ne=!0),k.add(x,m),m.A=0}}function da(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=zr(p(m.Da,m),zu(m,m.A)),m.A++,!0)}t.Da=function(){if(this.v=null,Vu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=zr(p(this.Wa,this),m)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ht(10),rs(this),Vu(this))};function Ql(m){m.B!=null&&(c.clearTimeout(m.B),m.B=null)}function Vu(m){m.g=new xr(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var x=$t(m.na);ht(x,"RID","rpc"),ht(x,"SID",m.M),ht(x,"AID",m.K),ht(x,"CI",m.F?"0":"1"),!m.F&&m.ia&&ht(x,"TO",m.ia),ht(x,"TYPE","xmlhttp"),ua(m,x),m.u&&m.o&&oa(x,m.u,m.o),m.O&&(m.g.H=m.O);var w=m.g;m=m.ba,w.M=1,w.A=ia($t(x)),w.u=null,w.R=!0,Ha(w,m)}t.Va=function(){this.C!=null&&(this.C=null,rs(this),da(this),Ht(19))};function Za(m){m.C!=null&&(c.clearTimeout(m.C),m.C=null)}function Bu(m,x){var w=null;if(m.g==x){Za(m),Ql(m),m.g=null;var B=2}else if($r(m.h,x))w=x.G,Nl(m.h,x),B=1;else return;if(m.I!=0){if(x.o)if(B==1){w=x.u?x.u.length:0,x=Date.now()-x.F;var re=m.D;B=qa(),lt(B,new Br(B,w)),Jr(m)}else Lu(m);else if(re=x.m,re==3||re==0&&x.X>0||!(B==1&&Ja(m,x)||B==2&&da(m)))switch(w&&w.length>0&&(x=m.h,x.i=x.i.concat(w)),re){case 1:Zr(m,5);break;case 4:Zr(m,10);break;case 3:Zr(m,6);break;default:Zr(m,2)}}}function zu(m,x){let w=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(w*=2),w*x}function Zr(m,x){if(m.j.info("Error code "+x),x==2){var w=p(m.bb,m),B=m.Ua;const re=!B;B=new Qn(B||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||cn(B,"https"),ia(B),re?Sr(B.toString(),w):Ul(B.toString(),w)}else Ht(2);m.I=0,m.l&&m.l.pa(x),Uu(m),Xa(m)}t.bb=function(m){m?(this.j.info("Successfully pinged google.com"),Ht(2)):(this.j.info("Failed to ping google.com"),Ht(1))};function Uu(m){if(m.I=0,m.ja=[],m.l){const x=Pl(m.h);(x.length!=0||m.i.length!=0)&&(T(m.ja,x),T(m.ja,m.i),m.h.i.length=0,S(m.i),m.i.length=0),m.l.oa()}}function Fu(m,x,w){var B=w instanceof Qn?$t(w):new Qn(w);if(B.g!="")x&&(B.g=x+"."+B.g),Yi(B,B.u);else{var re=c.location;B=re.protocol,x=x?x+"."+re.hostname:re.hostname,re=+re.port;const ue=new Qn(null);B&&cn(ue,B),x&&(ue.g=x),re&&Yi(ue,re),w&&(ue.h=w),B=ue}return w=m.G,x=m.wa,w&&x&&ht(B,w,x),ht(B,"VER",m.ka),ua(m,B),B}function qu(m,x,w){if(x&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=m.Aa&&!m.ma?new pt(new Wr({ab:w})):new pt(m.ma),x.Fa(m.L),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hu(){}t=Hu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function is(){}is.prototype.g=function(m,x){return new In(m,x)};function In(m,x){Ue.call(this),this.g=new ns(x),this.l=m,this.h=x&&x.messageUrlParams||null,m=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(m?m["X-WebChannel-Content-Type"]=x.messageContentType:m={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(m?m["X-WebChannel-Client-Profile"]=x.sa:m={"X-WebChannel-Client-Profile":x.sa}),this.g.U=m,(m=x&&x.Qb)&&!I(m)&&(this.g.u=m),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!I(x)&&(this.g.G=x,m=this.h,m!==null&&x in m&&(m=this.h,x in m&&delete m[x])),this.j=new bi(this)}v(In,Ue),In.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},In.prototype.close=function(){Hl(this.g)},In.prototype.o=function(m){var x=this.g;if(typeof m=="string"){var w={};w.__data__=m,m=w}else this.v&&(w={},w.__data__=Wi(m),m=w);x.i.push(new Qt(x.Ya++,m)),x.I==3&&Jr(x)},In.prototype.N=function(){this.g.l=null,delete this.j,Hl(this.g),delete this.g,In.Z.N.call(this)};function Gu(m){mn.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var x=m.__sm__;if(x){e:{for(const w in x){m=w;break e}m=void 0}(this.i=m)&&(m=this.i,x=x!==null&&m in x?x[m]:void 0),this.data=x}else this.data=m}v(Gu,mn);function Qu(){rr.call(this),this.status=1}v(Qu,rr);function bi(m){this.g=m}v(bi,Hu),bi.prototype.ra=function(){lt(this.g,"a")},bi.prototype.qa=function(m){lt(this.g,new Gu(m))},bi.prototype.pa=function(m){lt(this.g,new Qu)},bi.prototype.oa=function(){lt(this.g,"b")},is.prototype.createWebChannel=is.prototype.g,In.prototype.send=In.prototype.o,In.prototype.open=In.prototype.m,In.prototype.close=In.prototype.close,BS=function(){return new is},VS=function(){return qa()},LS=Lt,pg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},na.NO_ERROR=0,na.TIMEOUT=8,na.HTTP_ERROR=6,oh=na,Il.COMPLETE="complete",PS=Il,wu.EventType=vr,vr.OPEN="a",vr.CLOSE="b",vr.ERROR="c",vr.MESSAGE="d",Ue.prototype.listen=Ue.prototype.J,Nc=wu,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,NS=pt}).apply(typeof Jd<"u"?Jd:typeof self<"u"?self:typeof window<"u"?window:{});const dx="@firebase/firestore",hx="4.9.3";class An{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}An.UNAUTHENTICATED=new An(null),An.GOOGLE_CREDENTIALS=new An("google-credentials-uid"),An.FIRST_PARTY=new An("first-party-uid"),An.MOCK_USER=new An("mock-user");let gl="12.7.0";const Ma=new ey("@firebase/firestore");function Mo(){return Ma.logLevel}function Te(t,...e){if(Ma.logLevel<=tt.DEBUG){const n=e.map(ry);Ma.debug(`Firestore (${gl}): ${t}`,...n)}}function Hi(t,...e){if(Ma.logLevel<=tt.ERROR){const n=e.map(ry);Ma.error(`Firestore (${gl}): ${t}`,...n)}}function Zo(t,...e){if(Ma.logLevel<=tt.WARN){const n=e.map(ry);Ma.warn(`Firestore (${gl}): ${t}`,...n)}}function ry(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Ve(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,zS(t,i,n)}function zS(t,e,n){let i=`FIRESTORE (${gl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Hi(i),new Error(i)}function dt(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||zS(e,a,i)}function He(t,e){return t}const ve={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends $i{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ui{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class US{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class pj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(An.UNAUTHENTICATED)))}shutdown(){}}class gj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class yj{constructor(e){this.t=e,this.currentUser=An.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){dt(this.o===void 0,42304);let i=this.i;const a=f=>this.i!==i?(i=this.i,n(f)):Promise.resolve();let l=new Ui;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ui,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const f=l;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},h=f=>{Te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((f=>h(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(Te("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ui)}}),0),c()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(Te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(dt(typeof i.accessToken=="string",31837,{l:i}),new US(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return dt(e===null||typeof e=="string",2055,{h:e}),new An(e)}}class _j{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=An.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class vj{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new _j(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(An.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class fx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bj{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,jr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){dt(this.o===void 0,3512);const i=l=>{l.error!=null&&Te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Te("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{Te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new fx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(dt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new fx(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function xj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class iy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=xj(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function nt(t,e){return t<e?-1:t>e?1:0}function gg(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return Up(a)===Up(l)?nt(a,l):Up(a)?1:-1}return nt(t.length,e.length)}const Ej=55296,Sj=57343;function Up(t){const e=t.charCodeAt(0);return e>=Ej&&e<=Sj}function el(t,e,n){return t.length===e.length&&t.every(((i,a)=>n(i,e[a])))}const mx="__name__";class si{constructor(e,n,i){n===void 0?n=0:n>e.length&&Ve(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Ve(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return si.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof si?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=si.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return nt(e.length,n.length)}static compareSegments(e,n){const i=si.isNumericId(e),a=si.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?si.extractNumericId(e).compare(si.extractNumericId(n)):gg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vs.fromString(e.substring(4,e.length-2))}}class Et extends si{construct(e,n,i){return new Et(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new we(ve.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((a=>a.length>0)))}return new Et(n)}static emptyPath(){return new Et([])}}const wj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xn extends si{construct(e,n,i){return new xn(e,n,i)}static isValidIdentifier(e){return wj.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===mx}static keyField(){return new xn([mx])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new we(ve.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let c=!1;for(;a<e.length;){const h=e[a];if(h==="\\"){if(a+1===e.length)throw new we(ve.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new we(ve.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,a+=2}else h==="`"?(c=!c,a++):h!=="."||c?(i+=h,a++):(l(),a++)}if(l(),c)throw new we(ve.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xn(n)}static emptyPath(){return new xn([])}}class Ne{constructor(e){this.path=e}static fromPath(e){return new Ne(Et.fromString(e))}static fromName(e){return new Ne(Et.fromString(e).popFirst(5))}static empty(){return new Ne(Et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Et.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ne(new Et(e.slice()))}}function FS(t,e,n){if(!n)throw new we(ve.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Tj(t,e,n,i){if(e===!0&&i===!0)throw new we(ve.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function px(t){if(!Ne.isDocumentKey(t))throw new we(ve.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function gx(t){if(Ne.isDocumentKey(t))throw new we(ve.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function qS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function rf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ve(12329,{type:typeof t})}function mi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new we(ve.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rf(t);throw new we(ve.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function tn(t,e){const n={typeString:t};return e&&(n.value=e),n}function uu(t,e){if(!qS(t))throw new we(ve.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const c=t[i];if(a&&typeof c!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new we(ve.INVALID_ARGUMENT,n);return!0}const yx=-62135596800,_x=1e6;class At{static now(){return At.fromMillis(Date.now())}static fromDate(e){return At.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*_x);return new At(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new we(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new we(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<yx)throw new we(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_x}_compareTo(e){return this.seconds===e.seconds?nt(this.nanoseconds,e.nanoseconds):nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:At._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(uu(e,At._jsonSchema))return new At(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-yx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}At._jsonSchemaVersion="firestore/timestamp/1.0",At._jsonSchema={type:tn("string",At._jsonSchemaVersion),seconds:tn("number"),nanoseconds:tn("number")};class Fe{static fromTimestamp(e){return new Fe(e)}static min(){return new Fe(new At(0,0))}static max(){return new Fe(new At(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Kc=-1;function Aj(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Fe.fromTimestamp(i===1e9?new At(n+1,0):new At(n,i));return new Hs(a,Ne.empty(),e)}function Cj(t){return new Hs(t.readTime,t.key,Kc)}class Hs{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Hs(Fe.min(),Ne.empty(),Kc)}static max(){return new Hs(Fe.max(),Ne.empty(),Kc)}}function Rj(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ne.comparator(t.documentKey,e.documentKey),n!==0?n:nt(t.largestBatchId,e.largestBatchId))}const Dj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ij{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function yl(t){if(t.code!==ve.FAILED_PRECONDITION||t.message!==Dj)throw t;Te("LocalStore","Unexpectedly lost primary lease")}class be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new be(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof be?n:be.resolve(n)}catch(n){return be.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):be.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):be.reject(n)}static resolve(e){return new be(((n,i)=>{n(e)}))}static reject(e){return new be(((n,i)=>{i(e)}))}static waitFor(e){return new be(((n,i)=>{let a=0,l=0,c=!1;e.forEach((h=>{++a,h.next((()=>{++l,c&&l===a&&n()}),(f=>i(f)))})),c=!0,l===a&&n()}))}static or(e){let n=be.resolve(!1);for(const i of e)n=n.next((a=>a?be.resolve(a):i()));return n}static forEach(e,n){const i=[];return e.forEach(((a,l)=>{i.push(n.call(this,a,l))})),this.waitFor(i)}static mapArray(e,n){return new be(((i,a)=>{const l=e.length,c=new Array(l);let h=0;for(let f=0;f<l;f++){const p=f;n(e[p]).next((_=>{c[p]=_,++h,h===l&&i(c)}),(_=>a(_)))}}))}static doWhile(e,n){return new be(((i,a)=>{const l=()=>{e()===!0?n().next((()=>{l()}),a):i()};l()}))}}function jj(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function _l(t){return t.name==="IndexedDbTransactionError"}class sf{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}sf.ce=-1;const sy=-1;function af(t){return t==null}function Dh(t){return t===0&&1/t==-1/0}function kj(t){return typeof t=="number"&&Number.isInteger(t)&&!Dh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const HS="";function Oj(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=vx(e)),e=Mj(t.get(n),e);return vx(e)}function Mj(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case HS:n+="";break;default:n+=l}}return n}function vx(t){return t+HS+""}function bx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ys(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function GS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Ot{constructor(e,n){this.comparator=e,this.root=n||bn.EMPTY}insert(e,n){return new Ot(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,bn.BLACK,null,null))}remove(e){return new Ot(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zd(this.root,e,this.comparator,!0)}}class Zd{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class bn{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??bn.RED,this.left=a??bn.EMPTY,this.right=l??bn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new bn(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return bn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return bn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,bn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,bn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ve(27949);return e+(this.isRed()?0:1)}}bn.EMPTY=null,bn.RED=!0,bn.BLACK=!1;bn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ve(57766)}get value(){throw Ve(16141)}get color(){throw Ve(16727)}get left(){throw Ve(29726)}get right(){throw Ve(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new bn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class on{constructor(e){this.comparator=e,this.data=new Ot(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new xx(this.data.getIterator())}getIteratorFrom(e){return new xx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof on)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new on(this.comparator);return n.data=e,n}}class xx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class er{constructor(e){this.fields=e,e.sort(xn.comparator)}static empty(){return new er([])}unionWith(e){let n=new on(xn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new er(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return el(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class QS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class En{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new QS("Invalid base64 string: "+l):l}})(e);return new En(n)}static fromUint8Array(e){const n=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new En(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}En.EMPTY_BYTE_STRING=new En("");const Nj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gs(t){if(dt(!!t,39018),typeof t=="string"){let e=0;const n=Nj.exec(t);if(dt(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ut(t.seconds),nanos:Ut(t.nanos)}}function Ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Qs(t){return typeof t=="string"?En.fromBase64String(t):En.fromUint8Array(t)}const $S="server_timestamp",KS="__type__",WS="__previous_value__",YS="__local_write_time__";function ay(t){return(t?.mapValue?.fields||{})[KS]?.stringValue===$S}function of(t){const e=t.mapValue.fields[WS];return ay(e)?of(e):e}function Wc(t){const e=Gs(t.mapValue.fields[YS].timestampValue);return new At(e.seconds,e.nanos)}class Pj{constructor(e,n,i,a,l,c,h,f,p,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=_}}const Ih="(default)";class Yc{constructor(e,n){this.projectId=e,this.database=n||Ih}static empty(){return new Yc("","")}get isDefaultDatabase(){return this.database===Ih}isEqual(e){return e instanceof Yc&&e.projectId===this.projectId&&e.database===this.database}}const XS="__type__",Lj="__max__",eh={mapValue:{}},JS="__vector__",jh="value";function $s(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ay(t)?4:Bj(t)?9007199254740991:Vj(t)?10:11:Ve(28295,{value:t})}function pi(t,e){if(t===e)return!0;const n=$s(t);if(n!==$s(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Wc(t).isEqual(Wc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=Gs(a.timestampValue),h=Gs(l.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return Qs(a.bytesValue).isEqual(Qs(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return Ut(a.geoPointValue.latitude)===Ut(l.geoPointValue.latitude)&&Ut(a.geoPointValue.longitude)===Ut(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Ut(a.integerValue)===Ut(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=Ut(a.doubleValue),h=Ut(l.doubleValue);return c===h?Dh(c)===Dh(h):isNaN(c)&&isNaN(h)}return!1})(t,e);case 9:return el(t.arrayValue.values||[],e.arrayValue.values||[],pi);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},h=l.mapValue.fields||{};if(bx(c)!==bx(h))return!1;for(const f in c)if(c.hasOwnProperty(f)&&(h[f]===void 0||!pi(c[f],h[f])))return!1;return!0})(t,e);default:return Ve(52216,{left:t})}}function Xc(t,e){return(t.values||[]).find((n=>pi(n,e)))!==void 0}function tl(t,e){if(t===e)return 0;const n=$s(t),i=$s(e);if(n!==i)return nt(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return nt(t.booleanValue,e.booleanValue);case 2:return(function(l,c){const h=Ut(l.integerValue||l.doubleValue),f=Ut(c.integerValue||c.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1})(t,e);case 3:return Ex(t.timestampValue,e.timestampValue);case 4:return Ex(Wc(t),Wc(e));case 5:return gg(t.stringValue,e.stringValue);case 6:return(function(l,c){const h=Qs(l),f=Qs(c);return h.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(l,c){const h=l.split("/"),f=c.split("/");for(let p=0;p<h.length&&p<f.length;p++){const _=nt(h[p],f[p]);if(_!==0)return _}return nt(h.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,c){const h=nt(Ut(l.latitude),Ut(c.latitude));return h!==0?h:nt(Ut(l.longitude),Ut(c.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return Sx(t.arrayValue,e.arrayValue);case 10:return(function(l,c){const h=l.fields||{},f=c.fields||{},p=h[jh]?.arrayValue,_=f[jh]?.arrayValue,v=nt(p?.values?.length||0,_?.values?.length||0);return v!==0?v:Sx(p,_)})(t.mapValue,e.mapValue);case 11:return(function(l,c){if(l===eh.mapValue&&c===eh.mapValue)return 0;if(l===eh.mapValue)return 1;if(c===eh.mapValue)return-1;const h=l.fields||{},f=Object.keys(h),p=c.fields||{},_=Object.keys(p);f.sort(),_.sort();for(let v=0;v<f.length&&v<_.length;++v){const b=gg(f[v],_[v]);if(b!==0)return b;const S=tl(h[f[v]],p[_[v]]);if(S!==0)return S}return nt(f.length,_.length)})(t.mapValue,e.mapValue);default:throw Ve(23264,{he:n})}}function Ex(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return nt(t,e);const n=Gs(t),i=Gs(e),a=nt(n.seconds,i.seconds);return a!==0?a:nt(n.nanos,i.nanos)}function Sx(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=tl(n[a],i[a]);if(l)return l}return nt(n.length,i.length)}function nl(t){return yg(t)}function yg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=Gs(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Qs(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return Ne.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=yg(l);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const c of i)l?l=!1:a+=",",a+=`${c}:${yg(n.fields[c])}`;return a+"}"})(t.mapValue):Ve(61005,{value:t})}function lh(t){switch($s(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=of(t);return e?16+lh(e):16;case 5:return 2*t.stringValue.length;case 6:return Qs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+lh(l)),0)})(t.arrayValue);case 10:case 11:return(function(i){let a=0;return Ys(i.fields,((l,c)=>{a+=l.length+lh(c)})),a})(t.mapValue);default:throw Ve(13486,{value:t})}}function wx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function _g(t){return!!t&&"integerValue"in t}function oy(t){return!!t&&"arrayValue"in t}function Tx(t){return!!t&&"nullValue"in t}function Ax(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ch(t){return!!t&&"mapValue"in t}function Vj(t){return(t?.mapValue?.fields||{})[XS]?.stringValue===JS}function zc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ys(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=zc(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=zc(t.arrayValue.values[n]);return e}return{...t}}function Bj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Lj}class Un{constructor(e){this.value=e}static empty(){return new Un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!ch(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=zc(n)}setAll(e){let n=xn.emptyPath(),i={},a=[];e.forEach(((c,h)=>{if(!n.isImmediateParentOf(h)){const f=this.getFieldsMap(n);this.applyChanges(f,i,a),i={},a=[],n=h.popLast()}c?i[h.lastSegment()]=zc(c):a.push(h.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());ch(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return pi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];ch(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){Ys(n,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new Un(zc(this.value))}}function ZS(t){const e=[];return Ys(t.fields,((n,i)=>{const a=new xn([n]);if(ch(i)){const l=ZS(i.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new er(e)}class Cn{constructor(e,n,i,a,l,c,h){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=c,this.documentState=h}static newInvalidDocument(e){return new Cn(e,0,Fe.min(),Fe.min(),Fe.min(),Un.empty(),0)}static newFoundDocument(e,n,i,a){return new Cn(e,1,n,Fe.min(),i,a,0)}static newNoDocument(e,n){return new Cn(e,2,n,Fe.min(),Fe.min(),Un.empty(),0)}static newUnknownDocument(e,n){return new Cn(e,3,n,Fe.min(),Fe.min(),Un.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Cn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Cn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class kh{constructor(e,n){this.position=e,this.inclusive=n}}function Cx(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],c=t.position[a];if(l.field.isKeyField()?i=Ne.comparator(Ne.fromName(c.referenceValue),n.key):i=tl(c,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function Rx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!pi(t.position[n],e.position[n]))return!1;return!0}class Oh{constructor(e,n="asc"){this.field=e,this.dir=n}}function zj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class ew{}class en extends ew{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new Fj(e,n,i):n==="array-contains"?new Gj(e,i):n==="in"?new Qj(e,i):n==="not-in"?new $j(e,i):n==="array-contains-any"?new Kj(e,i):new en(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new qj(e,i):new Hj(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(tl(n,this.value)):n!==null&&$s(this.value)===$s(n)&&this.matchesComparison(tl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pr extends ew{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Pr(e,n)}matches(e){return tw(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function tw(t){return t.op==="and"}function nw(t){return Uj(t)&&tw(t)}function Uj(t){for(const e of t.filters)if(e instanceof Pr)return!1;return!0}function vg(t){if(t instanceof en)return t.field.canonicalString()+t.op.toString()+nl(t.value);if(nw(t))return t.filters.map((e=>vg(e))).join(",");{const e=t.filters.map((n=>vg(n))).join(",");return`${t.op}(${e})`}}function rw(t,e){return t instanceof en?(function(i,a){return a instanceof en&&i.op===a.op&&i.field.isEqual(a.field)&&pi(i.value,a.value)})(t,e):t instanceof Pr?(function(i,a){return a instanceof Pr&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,c,h)=>l&&rw(c,a.filters[h])),!0):!1})(t,e):void Ve(19439)}function iw(t){return t instanceof en?(function(n){return`${n.field.canonicalString()} ${n.op} ${nl(n.value)}`})(t):t instanceof Pr?(function(n){return n.op.toString()+" {"+n.getFilters().map(iw).join(" ,")+"}"})(t):"Filter"}class Fj extends en{constructor(e,n,i){super(e,n,i),this.key=Ne.fromName(i.referenceValue)}matches(e){const n=Ne.comparator(e.key,this.key);return this.matchesComparison(n)}}class qj extends en{constructor(e,n){super(e,"in",n),this.keys=sw("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class Hj extends en{constructor(e,n){super(e,"not-in",n),this.keys=sw("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function sw(t,e){return(e.arrayValue?.values||[]).map((n=>Ne.fromName(n.referenceValue)))}class Gj extends en{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return oy(n)&&Xc(n.arrayValue,this.value)}}class Qj extends en{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Xc(this.value.arrayValue,n)}}class $j extends en{constructor(e,n){super(e,"not-in",n)}matches(e){if(Xc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Xc(this.value.arrayValue,n)}}class Kj extends en{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!oy(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>Xc(this.value.arrayValue,i)))}}class Wj{constructor(e,n=null,i=[],a=[],l=null,c=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=c,this.endAt=h,this.Te=null}}function Dx(t,e=null,n=[],i=[],a=null,l=null,c=null){return new Wj(t,e,n,i,a,l,c)}function ly(t){const e=He(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>vg(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),af(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>nl(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>nl(i))).join(",")),e.Te=n}return e.Te}function cy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!zj(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!rw(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Rx(t.startAt,e.startAt)&&Rx(t.endAt,e.endAt)}function bg(t){return Ne.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class du{constructor(e,n=null,i=[],a=[],l=null,c="F",h=null,f=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=c,this.startAt=h,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Yj(t,e,n,i,a,l,c,h){return new du(t,e,n,i,a,l,c,h)}function uy(t){return new du(t)}function Ix(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function aw(t){return t.collectionGroup!==null}function Uc(t){const e=He(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new on(xn.comparator);return c.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(h=h.add(p.field))}))})),h})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Oh(l,i))})),n.has(xn.keyField().canonicalString())||e.Ie.push(new Oh(xn.keyField(),i))}return e.Ie}function oi(t){const e=He(t);return e.Ee||(e.Ee=Xj(e,Uc(t))),e.Ee}function Xj(t,e){if(t.limitType==="F")return Dx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Oh(a.field,l)}));const n=t.endAt?new kh(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new kh(t.startAt.position,t.startAt.inclusive):null;return Dx(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function xg(t,e){const n=t.filters.concat([e]);return new du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Eg(t,e,n){return new du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function lf(t,e){return cy(oi(t),oi(e))&&t.limitType===e.limitType}function ow(t){return`${ly(oi(t))}|lt:${t.limitType}`}function No(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((a=>iw(a))).join(", ")}]`),af(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((a=>nl(a))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((a=>nl(a))).join(",")),`Target(${i})`})(oi(t))}; limitType=${t.limitType})`}function cf(t,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Ne.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(t,e)&&(function(i,a){for(const l of Uc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(i,a){return!(i.startAt&&!(function(c,h,f){const p=Cx(c,h,f);return c.inclusive?p<=0:p<0})(i.startAt,Uc(i),a)||i.endAt&&!(function(c,h,f){const p=Cx(c,h,f);return c.inclusive?p>=0:p>0})(i.endAt,Uc(i),a))})(t,e)}function Jj(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function lw(t){return(e,n)=>{let i=!1;for(const a of Uc(t)){const l=Zj(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function Zj(t,e,n){const i=t.field.isKeyField()?Ne.comparator(e.key,n.key):(function(l,c,h){const f=c.data.field(l),p=h.data.field(l);return f!==null&&p!==null?tl(f,p):Ve(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Ve(19790,{direction:t.dir})}}class La{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ys(this.inner,((n,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return GS(this.inner)}size(){return this.innerSize}}const e2=new Ot(Ne.comparator);function Gi(){return e2}const cw=new Ot(Ne.comparator);function Pc(...t){let e=cw;for(const n of t)e=e.insert(n.key,n);return e}function uw(t){let e=cw;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function Da(){return Fc()}function dw(){return Fc()}function Fc(){return new La((t=>t.toString()),((t,e)=>t.isEqual(e)))}const t2=new Ot(Ne.comparator),n2=new on(Ne.comparator);function rt(...t){let e=n2;for(const n of t)e=e.add(n);return e}const r2=new on(nt);function i2(){return r2}function dy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dh(e)?"-0":e}}function hw(t){return{integerValue:""+t}}function s2(t,e){return kj(e)?hw(e):dy(t,e)}class uf{constructor(){this._=void 0}}function a2(t,e,n){return t instanceof Mh?(function(a,l){const c={fields:{[KS]:{stringValue:$S},[YS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&ay(l)&&(l=of(l)),l&&(c.fields[WS]=l),{mapValue:c}})(n,e):t instanceof rl?mw(t,e):t instanceof Jc?pw(t,e):(function(a,l){const c=fw(a,l),h=jx(c)+jx(a.Ae);return _g(c)&&_g(a.Ae)?hw(h):dy(a.serializer,h)})(t,e)}function o2(t,e,n){return t instanceof rl?mw(t,e):t instanceof Jc?pw(t,e):n}function fw(t,e){return t instanceof Nh?(function(i){return _g(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Mh extends uf{}class rl extends uf{constructor(e){super(),this.elements=e}}function mw(t,e){const n=gw(e);for(const i of t.elements)n.some((a=>pi(a,i)))||n.push(i);return{arrayValue:{values:n}}}class Jc extends uf{constructor(e){super(),this.elements=e}}function pw(t,e){let n=gw(e);for(const i of t.elements)n=n.filter((a=>!pi(a,i)));return{arrayValue:{values:n}}}class Nh extends uf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function jx(t){return Ut(t.integerValue||t.doubleValue)}function gw(t){return oy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class l2{constructor(e,n){this.field=e,this.transform=n}}function c2(t,e){return t.field.isEqual(e.field)&&(function(i,a){return i instanceof rl&&a instanceof rl||i instanceof Jc&&a instanceof Jc?el(i.elements,a.elements,pi):i instanceof Nh&&a instanceof Nh?pi(i.Ae,a.Ae):i instanceof Mh&&a instanceof Mh})(t.transform,e.transform)}class u2{constructor(e,n){this.version=e,this.transformResults=n}}class Mr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Mr}static exists(e){return new Mr(void 0,e)}static updateTime(e){return new Mr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function uh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class df{}function yw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new hy(t.key,Mr.none()):new hu(t.key,t.data,Mr.none());{const n=t.data,i=Un.empty();let a=new on(xn.comparator);for(let l of e.fields)if(!a.has(l)){let c=n.field(l);c===null&&l.length>1&&(l=l.popLast(),c=n.field(l)),c===null?i.delete(l):i.set(l,c),a=a.add(l)}return new Xs(t.key,i,new er(a.toArray()),Mr.none())}}function d2(t,e,n){t instanceof hu?(function(a,l,c){const h=a.value.clone(),f=Ox(a.fieldTransforms,l,c.transformResults);h.setAll(f),l.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(t,e,n):t instanceof Xs?(function(a,l,c){if(!uh(a.precondition,l))return void l.convertToUnknownDocument(c.version);const h=Ox(a.fieldTransforms,l,c.transformResults),f=l.data;f.setAll(_w(a)),f.setAll(h),l.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(t,e,n):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,n)}function qc(t,e,n,i){return t instanceof hu?(function(l,c,h,f){if(!uh(l.precondition,c))return h;const p=l.value.clone(),_=Mx(l.fieldTransforms,f,c);return p.setAll(_),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(t,e,n,i):t instanceof Xs?(function(l,c,h,f){if(!uh(l.precondition,c))return h;const p=Mx(l.fieldTransforms,f,c),_=c.data;return _.setAll(_w(l)),_.setAll(p),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),h===null?null:h.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,n,i):(function(l,c,h){return uh(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(t,e,n)}function h2(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=fw(i.transform,a||null);l!=null&&(n===null&&(n=Un.empty()),n.set(i.field,l))}return n||null}function kx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&el(i,a,((l,c)=>c2(l,c)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class hu extends df{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Xs extends df{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function _w(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Ox(t,e,n){const i=new Map;dt(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],c=l.transform,h=e.data.field(l.field);i.set(l.field,o2(c,h,n[a]))}return i}function Mx(t,e,n){const i=new Map;for(const a of t){const l=a.transform,c=n.data.field(a.field);i.set(a.field,a2(l,c,e))}return i}class hy extends df{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class f2 extends df{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class m2{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&d2(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=qc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=qc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=dw();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let h=this.applyToLocalView(c,l.mutatedFields);h=n.has(a.key)?null:h;const f=yw(c,h);f!==null&&i.set(a.key,f),c.isValidDocument()||c.convertToNoDocument(Fe.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),rt())}isEqual(e){return this.batchId===e.batchId&&el(this.mutations,e.mutations,((n,i)=>kx(n,i)))&&el(this.baseMutations,e.baseMutations,((n,i)=>kx(n,i)))}}class fy{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){dt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return t2})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,i[c].version);return new fy(e,n,i,a)}}class p2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class g2{constructor(e,n){this.count=e,this.unchangedNames=n}}var Zt,st;function y2(t){switch(t){case ve.OK:return Ve(64938);case ve.CANCELLED:case ve.UNKNOWN:case ve.DEADLINE_EXCEEDED:case ve.RESOURCE_EXHAUSTED:case ve.INTERNAL:case ve.UNAVAILABLE:case ve.UNAUTHENTICATED:return!1;case ve.INVALID_ARGUMENT:case ve.NOT_FOUND:case ve.ALREADY_EXISTS:case ve.PERMISSION_DENIED:case ve.FAILED_PRECONDITION:case ve.ABORTED:case ve.OUT_OF_RANGE:case ve.UNIMPLEMENTED:case ve.DATA_LOSS:return!0;default:return Ve(15467,{code:t})}}function vw(t){if(t===void 0)return Hi("GRPC error has no .code"),ve.UNKNOWN;switch(t){case Zt.OK:return ve.OK;case Zt.CANCELLED:return ve.CANCELLED;case Zt.UNKNOWN:return ve.UNKNOWN;case Zt.DEADLINE_EXCEEDED:return ve.DEADLINE_EXCEEDED;case Zt.RESOURCE_EXHAUSTED:return ve.RESOURCE_EXHAUSTED;case Zt.INTERNAL:return ve.INTERNAL;case Zt.UNAVAILABLE:return ve.UNAVAILABLE;case Zt.UNAUTHENTICATED:return ve.UNAUTHENTICATED;case Zt.INVALID_ARGUMENT:return ve.INVALID_ARGUMENT;case Zt.NOT_FOUND:return ve.NOT_FOUND;case Zt.ALREADY_EXISTS:return ve.ALREADY_EXISTS;case Zt.PERMISSION_DENIED:return ve.PERMISSION_DENIED;case Zt.FAILED_PRECONDITION:return ve.FAILED_PRECONDITION;case Zt.ABORTED:return ve.ABORTED;case Zt.OUT_OF_RANGE:return ve.OUT_OF_RANGE;case Zt.UNIMPLEMENTED:return ve.UNIMPLEMENTED;case Zt.DATA_LOSS:return ve.DATA_LOSS;default:return Ve(39323,{code:t})}}(st=Zt||(Zt={}))[st.OK=0]="OK",st[st.CANCELLED=1]="CANCELLED",st[st.UNKNOWN=2]="UNKNOWN",st[st.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",st[st.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",st[st.NOT_FOUND=5]="NOT_FOUND",st[st.ALREADY_EXISTS=6]="ALREADY_EXISTS",st[st.PERMISSION_DENIED=7]="PERMISSION_DENIED",st[st.UNAUTHENTICATED=16]="UNAUTHENTICATED",st[st.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",st[st.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",st[st.ABORTED=10]="ABORTED",st[st.OUT_OF_RANGE=11]="OUT_OF_RANGE",st[st.UNIMPLEMENTED=12]="UNIMPLEMENTED",st[st.INTERNAL=13]="INTERNAL",st[st.UNAVAILABLE=14]="UNAVAILABLE",st[st.DATA_LOSS=15]="DATA_LOSS";function _2(){return new TextEncoder}const v2=new Vs([4294967295,4294967295],0);function Nx(t){const e=_2().encode(t),n=new MS;return n.update(e),new Uint8Array(n.digest())}function Px(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Vs([n,i],0),new Vs([a,l],0)]}class my{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Lc(`Invalid padding: ${n}`);if(i<0)throw new Lc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Lc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Lc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Vs.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(Vs.fromNumber(i)));return a.compare(v2)===1&&(a=new Vs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Nx(e),[i,a]=Px(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);if(!this.we(c))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new my(l,a,n);return i.forEach((h=>c.insert(h))),c}insert(e){if(this.ge===0)return;const n=Nx(e),[i,a]=Px(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);this.Se(c)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Lc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class hf{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,fu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new hf(Fe.min(),a,new Ot(nt),Gi(),rt())}}class fu{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new fu(i,n,rt(),rt(),rt())}}class dh{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class bw{constructor(e,n){this.targetId=e,this.Ce=n}}class xw{constructor(e,n,i=En.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class Lx{constructor(){this.ve=0,this.Fe=Vx(),this.Me=En.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=rt(),n=rt(),i=rt();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:Ve(38017,{changeType:l})}})),new fu(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=Vx()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,dt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class b2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Gi(),this.Je=th(),this.He=th(),this.Ye=new Ot(nt)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Ve(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(bg(l))if(i===0){const c=new Ne(l.path);this.et(n,c,Cn.newNoDocument(c,Fe.min()))}else dt(i===1,20013,{expectedCount:i});else{const c=this._t(n);if(c!==i){const h=this.ut(e),f=h?this.ct(h,e,c):1;if(f!==0){this.it(n);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,p)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let c,h;try{c=Qs(i).toUint8Array()}catch(f){if(f instanceof QS)return Zo("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new my(c,a,l)}catch(f){return Zo(f instanceof Lc?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.ge===0?null:h}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach((l=>{const c=this.Ge.ht(),h=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(h)||(this.et(n,l,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((l,c)=>{const h=this.ot(c);if(h){if(l.current&&bg(h.target)){const f=new Ne(h.target.path);this.It(f).has(c)||this.Et(c,f)||this.et(c,f,Cn.newNoDocument(f,e))}l.Be&&(n.set(c,l.ke()),l.qe())}}));let i=rt();this.He.forEach(((l,c)=>{let h=!0;c.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new hf(e,n,this.Ye,this.je,i);return this.je=Gi(),this.Je=th(),this.He=th(),this.Ye=new Ot(nt),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Lx,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new on(nt),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new on(nt),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Te("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Lx),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function th(){return new Ot(Ne.comparator)}function Vx(){return new Ot(Ne.comparator)}const x2={asc:"ASCENDING",desc:"DESCENDING"},E2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},S2={and:"AND",or:"OR"};class w2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Sg(t,e){return t.useProto3Json||af(e)?e:{value:e}}function Ph(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ew(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function T2(t,e){return Ph(t,e.toTimestamp())}function li(t){return dt(!!t,49232),Fe.fromTimestamp((function(n){const i=Gs(n);return new At(i.seconds,i.nanos)})(t))}function py(t,e){return wg(t,e).canonicalString()}function wg(t,e){const n=(function(a){return new Et(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function Sw(t){const e=Et.fromString(t);return dt(Rw(e),10190,{key:e.toString()}),e}function Tg(t,e){return py(t.databaseId,e.path)}function Fp(t,e){const n=Sw(e);if(n.get(1)!==t.databaseId.projectId)throw new we(ve.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new we(ve.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ne(Tw(n))}function ww(t,e){return py(t.databaseId,e)}function A2(t){const e=Sw(t);return e.length===4?Et.emptyPath():Tw(e)}function Ag(t){return new Et(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Tw(t){return dt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Bx(t,e,n){return{name:Tg(t,e),fields:n.value.mapValue.fields}}function C2(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Ve(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(p,_){return p.useProto3Json?(dt(_===void 0||typeof _=="string",58123),En.fromBase64String(_||"")):(dt(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),En.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&(function(p){const _=p.code===void 0?ve.UNKNOWN:vw(p.code);return new we(_,p.message||"")})(c);n=new xw(i,a,l,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Fp(t,i.document.name),l=li(i.document.updateTime),c=i.document.createTime?li(i.document.createTime):Fe.min(),h=new Un({mapValue:{fields:i.document.fields}}),f=Cn.newFoundDocument(a,l,c,h),p=i.targetIds||[],_=i.removedTargetIds||[];n=new dh(p,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Fp(t,i.document),l=i.readTime?li(i.readTime):Fe.min(),c=Cn.newNoDocument(a,l),h=i.removedTargetIds||[];n=new dh([],h,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Fp(t,i.document),l=i.removedTargetIds||[];n=new dh([],l,a,null)}else{if(!("filter"in e))return Ve(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,c=new g2(a,l),h=i.targetId;n=new bw(h,c)}}return n}function R2(t,e){let n;if(e instanceof hu)n={update:Bx(t,e.key,e.value)};else if(e instanceof hy)n={delete:Tg(t,e.key)};else if(e instanceof Xs)n={update:Bx(t,e.key,e.data),updateMask:L2(e.fieldMask)};else{if(!(e instanceof f2))return Ve(16599,{Vt:e.type});n={verify:Tg(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const h=c.transform;if(h instanceof Mh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof rl)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Jc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Nh)return{fieldPath:c.field.canonicalString(),increment:h.Ae};throw Ve(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:T2(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ve(27497)})(t,e.precondition)),n}function D2(t,e){return t&&t.length>0?(dt(e!==void 0,14353),t.map((n=>(function(a,l){let c=a.updateTime?li(a.updateTime):li(l);return c.isEqual(Fe.min())&&(c=li(l)),new u2(c,a.transformResults||[])})(n,e)))):[]}function I2(t,e){return{documents:[ww(t,e.path)]}}function j2(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=ww(t,a);const l=(function(p){if(p.length!==0)return Cw(Pr.create(p,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const c=(function(p){if(p.length!==0)return p.map((_=>(function(b){return{field:Po(b.field),direction:M2(b.dir)}})(_)))})(e.orderBy);c&&(n.structuredQuery.orderBy=c);const h=Sg(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:n,parent:a}}function k2(t){let e=A2(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){dt(i===1,65062);const _=n.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(v){const b=Aw(v);return b instanceof Pr&&nw(b)?b.getFilters():[b]})(n.where));let c=[];n.orderBy&&(c=(function(v){return v.map((b=>(function(T){return new Oh(Lo(T.field),(function(j){switch(j){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(b)))})(n.orderBy));let h=null;n.limit&&(h=(function(v){let b;return b=typeof v=="object"?v.value:v,af(b)?null:b})(n.limit));let f=null;n.startAt&&(f=(function(v){const b=!!v.before,S=v.values||[];return new kh(S,b)})(n.startAt));let p=null;return n.endAt&&(p=(function(v){const b=!v.before,S=v.values||[];return new kh(S,b)})(n.endAt)),Yj(e,a,c,l,h,"F",f,p)}function O2(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ve(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Aw(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Lo(n.unaryFilter.field);return en.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=Lo(n.unaryFilter.field);return en.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Lo(n.unaryFilter.field);return en.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Lo(n.unaryFilter.field);return en.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ve(61313);default:return Ve(60726)}})(t):t.fieldFilter!==void 0?(function(n){return en.create(Lo(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ve(58110);default:return Ve(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Pr.create(n.compositeFilter.filters.map((i=>Aw(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ve(1026)}})(n.compositeFilter.op))})(t):Ve(30097,{filter:t})}function M2(t){return x2[t]}function N2(t){return E2[t]}function P2(t){return S2[t]}function Po(t){return{fieldPath:t.canonicalString()}}function Lo(t){return xn.fromServerFormat(t.fieldPath)}function Cw(t){return t instanceof en?(function(n){if(n.op==="=="){if(Ax(n.value))return{unaryFilter:{field:Po(n.field),op:"IS_NAN"}};if(Tx(n.value))return{unaryFilter:{field:Po(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Ax(n.value))return{unaryFilter:{field:Po(n.field),op:"IS_NOT_NAN"}};if(Tx(n.value))return{unaryFilter:{field:Po(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Po(n.field),op:N2(n.op),value:n.value}}})(t):t instanceof Pr?(function(n){const i=n.getFilters().map((a=>Cw(a)));return i.length===1?i[0]:{compositeFilter:{op:P2(n.op),filters:i}}})(t):Ve(54877,{filter:t})}function L2(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function Rw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Os{constructor(e,n,i,a,l=Fe.min(),c=Fe.min(),h=En.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new Os(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Os(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Os(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Os(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class V2{constructor(e){this.yt=e}}function B2(t){const e=k2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Eg(e,e.limit,"L"):e}class z2{constructor(){this.Cn=new U2}addToCollectionParentIndex(e,n){return this.Cn.add(n),be.resolve()}getCollectionParents(e,n){return be.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return be.resolve()}deleteFieldIndex(e,n){return be.resolve()}deleteAllFieldIndexes(e){return be.resolve()}createTargetIndexes(e,n){return be.resolve()}getDocumentsMatchingTarget(e,n){return be.resolve(null)}getIndexType(e,n){return be.resolve(0)}getFieldIndexes(e,n){return be.resolve([])}getNextCollectionGroupToUpdate(e){return be.resolve(null)}getMinOffset(e,n){return be.resolve(Hs.min())}getMinOffsetFromCollectionGroup(e,n){return be.resolve(Hs.min())}updateCollectionGroup(e,n,i){return be.resolve()}updateIndexEntries(e,n){return be.resolve()}}class U2{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new on(Et.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new on(Et.comparator)).toArray()}}const zx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Dw=41943040;class zn{static withCacheSize(e){return new zn(e,zn.DEFAULT_COLLECTION_PERCENTILE,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}zn.DEFAULT_COLLECTION_PERCENTILE=10,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zn.DEFAULT=new zn(Dw,zn.DEFAULT_COLLECTION_PERCENTILE,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zn.DISABLED=new zn(-1,0,0);class il{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new il(0)}static cr(){return new il(-1)}}const Ux="LruGarbageCollector",F2=1048576;function Fx([t,e],[n,i]){const a=nt(t,n);return a===0?nt(e,i):a}class q2{constructor(e){this.Ir=e,this.buffer=new on(Fx),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Fx(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class H2{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Te(Ux,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){_l(n)?Te(Ux,"Ignoring IndexedDB error during garbage collection: ",n):await yl(n)}await this.Vr(3e5)}))}}class G2{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return be.resolve(sf.ce);const i=new q2(n);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Te("LruGarbageCollector","Garbage collection skipped; disabled"),be.resolve(zx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Te("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zx):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,c,h,f,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,c=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(i=v,h=Date.now(),this.removeTargets(e,i,n)))).next((v=>(l=v,f=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(p=Date.now(),Mo()<=tt.DEBUG&&Te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${a} in `+(h-c)+`ms
	Removed ${l} targets in `+(f-h)+`ms
	Removed ${v} documents in `+(p-f)+`ms
Total Duration: ${p-_}ms`),be.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:v}))))}}function Q2(t,e){return new G2(t,e)}class $2{constructor(){this.changes=new La((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Cn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?be.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class K2{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class W2{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(i!==null&&qc(i.mutation,a,er.empty(),At.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,rt()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=rt()){const a=Da();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,i).next((l=>{let c=Pc();return l.forEach(((h,f)=>{c=c.insert(h,f.overlayedDocument)})),c}))))}getOverlayedDocuments(e,n){const i=Da();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,rt())))}populateOverlays(e,n,i){const a=[];return i.forEach((l=>{n.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,h)=>{n.set(c,h)}))}))}computeViews(e,n,i,a){let l=Gi();const c=Fc(),h=(function(){return Fc()})();return n.forEach(((f,p)=>{const _=i.get(p.key);a.has(p.key)&&(_===void 0||_.mutation instanceof Xs)?l=l.insert(p.key,p):_!==void 0?(c.set(p.key,_.mutation.getFieldMask()),qc(_.mutation,p,_.mutation.getFieldMask(),At.now())):c.set(p.key,er.empty())})),this.recalculateAndSaveOverlays(e,l).next((f=>(f.forEach(((p,_)=>c.set(p,_))),n.forEach(((p,_)=>h.set(p,new K2(_,c.get(p)??null)))),h)))}recalculateAndSaveOverlays(e,n){const i=Fc();let a=new Ot(((c,h)=>c-h)),l=rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((c=>{for(const h of c)h.keys().forEach((f=>{const p=n.get(f);if(p===null)return;let _=i.get(f)||er.empty();_=h.applyToLocalView(p,_),i.set(f,_);const v=(a.get(h.batchId)||rt()).add(f);a=a.insert(h.batchId,v)}))})).next((()=>{const c=[],h=a.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),p=f.key,_=f.value,v=dw();_.forEach((b=>{if(!l.has(b)){const S=yw(n.get(b),i.get(b));S!==null&&v.set(b,S),l=l.add(b)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,v))}return be.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,a){return(function(c){return Ne.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):aw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):be.resolve(Da());let h=Kc,f=l;return c.next((p=>be.forEach(p,((_,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),l.get(_)?be.resolve():this.remoteDocumentCache.getEntry(e,_).next((b=>{f=f.insert(_,b)}))))).next((()=>this.populateOverlays(e,p,l))).next((()=>this.computeViews(e,f,p,rt()))).next((_=>({batchId:h,changes:uw(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ne(n)).next((i=>{let a=Pc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let c=Pc();return this.indexManager.getCollectionParents(e,l).next((h=>be.forEach(h,(f=>{const p=(function(v,b){return new du(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,f.child(l));return this.getDocumentsMatchingCollectionQuery(e,p,i,a).next((_=>{_.forEach(((v,b)=>{c=c.insert(v,b)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a)))).next((c=>{l.forEach(((f,p)=>{const _=p.getKey();c.get(_)===null&&(c=c.insert(_,Cn.newInvalidDocument(_)))}));let h=Pc();return c.forEach(((f,p)=>{const _=l.get(f);_!==void 0&&qc(_.mutation,p,er.empty(),At.now()),cf(n,p)&&(h=h.insert(f,p))})),h}))}}class Y2{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return be.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:li(a.createTime)}})(n)),be.resolve()}getNamedQuery(e,n){return be.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:B2(a.bundledQuery),readTime:li(a.readTime)}})(n)),be.resolve()}}class X2{constructor(){this.overlays=new Ot(Ne.comparator),this.qr=new Map}getOverlay(e,n){return be.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Da();return be.forEach(n,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((a,l)=>{this.St(e,n,l)})),be.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),be.resolve()}getOverlaysForCollection(e,n,i){const a=Da(),l=n.length+1,c=new Ne(n.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const f=h.getNext().value,p=f.getKey();if(!n.isPrefixOf(p.path))break;p.path.length===l&&f.largestBatchId>i&&a.set(f.getKey(),f)}return be.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new Ot(((p,_)=>p-_));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===n&&p.largestBatchId>i){let _=l.get(p.largestBatchId);_===null&&(_=Da(),l=l.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const h=Da(),f=l.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,_)=>h.set(p,_))),!(h.size()>=a)););return be.resolve(h)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const c=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new p2(n,i));let l=this.qr.get(n);l===void 0&&(l=rt(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}class J2{constructor(){this.sessionToken=En.EMPTY_BYTE_STRING}getSessionToken(e){return be.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,be.resolve()}}class gy{constructor(){this.Qr=new on(dn.$r),this.Ur=new on(dn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new dn(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new dn(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new Ne(new Et([])),i=new dn(n,e),a=new dn(n,e+1),l=[];return this.Ur.forEachInRange([i,a],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Ne(new Et([])),i=new dn(n,e),a=new dn(n,e+1);let l=rt();return this.Ur.forEachInRange([i,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const n=new dn(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class dn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Ne.comparator(e.key,n.key)||nt(e.Yr,n.Yr)}static Kr(e,n){return nt(e.Yr,n.Yr)||Ne.comparator(e.key,n.key)}}class Z2{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new on(dn.$r)}checkEmpty(e){return be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new m2(l,n,i,a);this.mutationQueue.push(c);for(const h of a)this.Zr=this.Zr.add(new dn(h.key,l)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return be.resolve(c)}lookupMutationBatch(e,n){return be.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return be.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return be.resolve(this.mutationQueue.length===0?sy:this.tr-1)}getAllMutationBatches(e){return be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new dn(n,0),a=new dn(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(c=>{const h=this.Xr(c.Yr);l.push(h)})),be.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new on(nt);return n.forEach((a=>{const l=new dn(a,0),c=new dn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(h=>{i=i.add(h.Yr)}))})),be.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;Ne.isDocumentKey(l)||(l=l.child(""));const c=new dn(new Ne(l),0);let h=new on(nt);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!i.isPrefixOf(p)&&(p.length===a&&(h=h.add(f.Yr)),!0)}),c),be.resolve(this.ti(h))}ti(e){const n=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){dt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return be.forEach(n.mutations,(a=>{const l=new dn(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new dn(n,0),a=this.Zr.firstAfterOrEqual(i);return be.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,be.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class e5{constructor(e){this.ri=e,this.docs=(function(){return new Ot(Ne.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,c=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return be.resolve(i?i.document.mutableCopy():Cn.newInvalidDocument(n))}getEntries(e,n){let i=Gi();return n.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():Cn.newInvalidDocument(a))})),be.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=Gi();const c=n.path,h=new Ne(c.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:p,value:{document:_}}=f.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||Rj(Cj(_),i)<=0||(a.has(_.key)||cf(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return be.resolve(l)}getAllFromCollectionGroup(e,n,i,a){Ve(9500)}ii(e,n){return be.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new t5(this)}getSize(e){return be.resolve(this.size)}}class t5 extends $2{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),be.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class n5{constructor(e){this.persistence=e,this.si=new La((n=>ly(n)),cy),this.lastRemoteSnapshotVersion=Fe.min(),this.highestTargetId=0,this.oi=0,this._i=new gy,this.targetCount=0,this.ai=il.ur()}forEachTarget(e,n){return this.si.forEach(((i,a)=>n(a))),be.resolve()}getLastRemoteSnapshotVersion(e){return be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return be.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),be.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),be.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new il(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,be.resolve()}updateTargetData(e,n){return this.Pr(n),be.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,be.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach(((c,h)=>{h.sequenceNumber<=n&&i.get(h.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,h.targetId)),a++)})),be.waitFor(l).next((()=>a))}getTargetCount(e){return be.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return be.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),be.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),be.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),be.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return be.resolve(i)}containsKey(e,n){return be.resolve(this._i.containsKey(n))}}class Iw{constructor(e,n){this.ui={},this.overlays={},this.ci=new sf(0),this.li=!1,this.li=!0,this.hi=new J2,this.referenceDelegate=e(this),this.Pi=new n5(this),this.indexManager=new z2,this.remoteDocumentCache=(function(a){return new e5(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new V2(n),this.Ii=new Y2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new X2,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new Z2(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){Te("MemoryPersistence","Starting transaction:",e);const a=new r5(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,n){return be.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class r5 extends Ij{constructor(e){super(),this.currentSequenceNumber=e}}class yy{constructor(e){this.persistence=e,this.Ri=new gy,this.Vi=null}static mi(e){return new yy(e)}get fi(){if(this.Vi)return this.Vi;throw Ve(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),be.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),be.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),be.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return be.forEach(this.fi,(i=>{const a=Ne.fromPath(i);return this.gi(e,a).next((l=>{l||n.removeEntry(a,Fe.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return be.or([()=>be.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Lh{constructor(e,n){this.persistence=e,this.pi=new La((i=>Oj(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=Q2(this,n)}static mi(e,n){return new Lh(e,n)}Ei(){}di(e){return be.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((a=>i+a))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return be.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?be.resolve():n(a)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(c=>this.br(e,c,n).next((h=>{h||(i++,l.removeEntry(c,Fe.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),be.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),be.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),be.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),be.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=lh(e.data.value)),n}br(e,n,i){return be.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return be.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class _y{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=rt(),a=rt();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new _y(e,n.fromCache,i,a)}}class i5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class s5{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return XD()?8:jj(Rn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,n,a,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new i5;return this.Ss(e,n,c).next((h=>{if(l.result=h,this.Vs)return this.bs(e,n,c,h.size)}))})).next((()=>l.result))}bs(e,n,i,a){return i.documentReadCount<this.fs?(Mo()<=tt.DEBUG&&Te("QueryEngine","SDK will not create cache indexes for query:",No(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),be.resolve()):(Mo()<=tt.DEBUG&&Te("QueryEngine","Query:",No(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(Mo()<=tt.DEBUG&&Te("QueryEngine","The SDK decides to create cache indexes for query:",No(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,oi(n))):be.resolve())}ys(e,n){if(Ix(n))return be.resolve(null);let i=oi(n);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=Eg(n,null,"F"),i=oi(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=rt(...l);return this.ps.getDocuments(e,c).next((h=>this.indexManager.getMinOffset(e,i).next((f=>{const p=this.Ds(n,h);return this.Cs(n,p,c,f.readTime)?this.ys(e,Eg(n,null,"F")):this.vs(e,p,n,f)}))))})))))}ws(e,n,i,a){return Ix(n)||a.isEqual(Fe.min())?be.resolve(null):this.ps.getDocuments(e,i).next((l=>{const c=this.Ds(n,l);return this.Cs(n,c,i,a)?be.resolve(null):(Mo()<=tt.DEBUG&&Te("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),No(n)),this.vs(e,c,n,Aj(a,Kc)).next((h=>h)))}))}Ds(e,n){let i=new on(lw(e));return n.forEach(((a,l)=>{cf(e,l)&&(i=i.add(l))})),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return Mo()<=tt.DEBUG&&Te("QueryEngine","Using full collection scan to execute query:",No(n)),this.ps.getDocumentsMatchingQuery(e,n,Hs.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(n.forEach((c=>{l=l.insert(c.key,c)})),l)))}}const vy="LocalStore",a5=3e8;class o5{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new Ot(nt),this.xs=new La((l=>ly(l)),cy),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new W2(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function l5(t,e,n,i){return new o5(t,e,n,i)}async function jw(t,e){const n=He(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],h=[];let f=rt();for(const p of a){c.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}for(const p of l){h.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}return n.localDocuments.getDocuments(i,f).next((p=>({Ls:p,removedBatchIds:c,addedBatchIds:h})))}))}))}function c5(t,e){const n=He(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,f,p,_){const v=p.batch,b=v.keys();let S=be.resolve();return b.forEach((T=>{S=S.next((()=>_.getEntry(f,T))).next((C=>{const j=p.docVersions.get(T);dt(j!==null,48541),C.version.compareTo(j)<0&&(v.applyToRemoteDocument(C,p),C.isValidDocument()&&(C.setReadTime(p.commitVersion),_.addEntry(C)))}))})),S.next((()=>h.mutationQueue.removeMutationBatch(f,v)))})(n,i,e,l).next((()=>l.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(h){let f=rt();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(f=f.add(h.batch.mutations[p].key));return f})(e)))).next((()=>n.localDocuments.getDocuments(i,a)))}))}function kw(t){const e=He(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function u5(t,e){const n=He(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const h=[];e.targetChanges.forEach(((_,v)=>{const b=a.get(v);if(!b)return;h.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,v))));let S=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?S=S.withResumeToken(En.EMPTY_BYTE_STRING,Fe.min()).withLastLimboFreeSnapshotVersion(Fe.min()):_.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(_.resumeToken,i)),a=a.insert(v,S),(function(C,j,z){return C.resumeToken.approximateByteSize()===0||j.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=a5?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0})(b,S,_)&&h.push(n.Pi.updateTargetData(l,S))}));let f=Gi(),p=rt();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),h.push(d5(l,c,e.documentUpdates).next((_=>{f=_.ks,p=_.qs}))),!i.isEqual(Fe.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));h.push(_)}return be.waitFor(h).next((()=>c.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,f,p))).next((()=>f))})).then((l=>(n.Ms=a,l)))}function d5(t,e,n){let i=rt(),a=rt();return n.forEach((l=>i=i.add(l))),e.getEntries(t,i).next((l=>{let c=Gi();return n.forEach(((h,f)=>{const p=l.get(h);f.isFoundDocument()!==p.isFoundDocument()&&(a=a.add(h)),f.isNoDocument()&&f.version.isEqual(Fe.min())?(e.removeEntry(h,f.readTime),c=c.insert(h,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),c=c.insert(h,f)):Te(vy,"Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",f.version)})),{ks:c,qs:a}}))}function h5(t,e){const n=He(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=sy),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function f5(t,e){const n=He(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return n.Pi.getTargetData(i,e).next((l=>l?(a=l,be.resolve(a)):n.Pi.allocateTargetId(i).next((c=>(a=new Os(e,c,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function Cg(t,e,n){const i=He(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!_l(c))throw c;Te(vy,`Failed to update sequence numbers for target ${e}: ${c}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function qx(t,e,n){const i=He(t);let a=Fe.min(),l=rt();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(f,p,_){const v=He(f),b=v.xs.get(_);return b!==void 0?be.resolve(v.Ms.get(b)):v.Pi.getTargetData(p,_)})(i,c,oi(e)).next((h=>{if(h)return a=h.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(c,h.targetId).next((f=>{l=f}))})).next((()=>i.Fs.getDocumentsMatchingQuery(c,e,n?a:Fe.min(),n?l:rt()))).next((h=>(m5(i,Jj(e),h),{documents:h,Qs:l})))))}function m5(t,e,n){let i=t.Os.get(e)||Fe.min();n.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),t.Os.set(e,i)}class Hx{constructor(){this.activeTargetIds=i2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class p5{constructor(){this.Mo=new Hx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Hx,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class g5{Oo(e){}shutdown(){}}const Gx="ConnectivityMonitor";class Qx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Te(Gx,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Te(Gx,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let nh=null;function Rg(){return nh===null?nh=(function(){return 268435456+Math.round(2147483648*Math.random())})():nh++,"0x"+nh.toString(16)}const qp="RestConnection",y5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class _5{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===Ih?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const c=Rg(),h=this.zo(e,n.toUriEncodedString());Te(qp,`Sending RPC '${e}' ${c}:`,h,i);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,l);const{host:p}=new URL(h),_=ml(p);return this.Jo(e,h,f,i,_).then((v=>(Te(qp,`Received RPC '${e}' ${c}: `,v),v)),(v=>{throw Zo(qp,`RPC '${e}' ${c} failed with error: `,v,"url: ",h,"request:",i),v}))}Ho(e,n,i,a,l,c){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+gl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,n){const i=y5[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class v5{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Tn="WebChannelConnection";class b5 extends _5{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const c=Rg();return new Promise(((h,f)=>{const p=new NS;p.setWithCredentials(!0),p.listenOnce(PS.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case oh.NO_ERROR:const v=p.getResponseJson();Te(Tn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(v)),h(v);break;case oh.TIMEOUT:Te(Tn,`RPC '${e}' ${c} timed out`),f(new we(ve.DEADLINE_EXCEEDED,"Request time out"));break;case oh.HTTP_ERROR:const b=p.getStatus();if(Te(Tn,`RPC '${e}' ${c} failed with status:`,b,"response text:",p.getResponseText()),b>0){let S=p.getResponseJson();Array.isArray(S)&&(S=S[0]);const T=S?.error;if(T&&T.status&&T.message){const C=(function(z){const q=z.toLowerCase().replace(/_/g,"-");return Object.values(ve).indexOf(q)>=0?q:ve.UNKNOWN})(T.status);f(new we(C,T.message))}else f(new we(ve.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new we(ve.UNAVAILABLE,"Connection failed."));break;default:Ve(9055,{l_:e,streamId:c,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Te(Tn,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(a);Te(Tn,`RPC '${e}' ${c} sending request:`,a),p.send(n,"POST",_,i,15)}))}T_(e,n,i){const a=Rg(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=BS(),h=VS(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,n,i),f.encodeInitMessageHeaders=!0;const _=l.join("");Te(Tn,`Creating RPC '${e}' stream ${a}: ${_}`,f);const v=c.createWebChannel(_,f);this.I_(v);let b=!1,S=!1;const T=new v5({Yo:j=>{S?Te(Tn,`Not sending because RPC '${e}' stream ${a} is closed:`,j):(b||(Te(Tn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),b=!0),Te(Tn,`RPC '${e}' stream ${a} sending:`,j),v.send(j))},Zo:()=>v.close()}),C=(j,z,q)=>{j.listen(z,(U=>{try{q(U)}catch(Z){setTimeout((()=>{throw Z}),0)}}))};return C(v,Nc.EventType.OPEN,(()=>{S||(Te(Tn,`RPC '${e}' stream ${a} transport opened.`),T.o_())})),C(v,Nc.EventType.CLOSE,(()=>{S||(S=!0,Te(Tn,`RPC '${e}' stream ${a} transport closed`),T.a_(),this.E_(v))})),C(v,Nc.EventType.ERROR,(j=>{S||(S=!0,Zo(Tn,`RPC '${e}' stream ${a} transport errored. Name:`,j.name,"Message:",j.message),T.a_(new we(ve.UNAVAILABLE,"The operation could not be completed")))})),C(v,Nc.EventType.MESSAGE,(j=>{if(!S){const z=j.data[0];dt(!!z,16349);const q=z,U=q?.error||q[0]?.error;if(U){Te(Tn,`RPC '${e}' stream ${a} received error:`,U);const Z=U.status;let J=(function(A){const D=Zt[A];if(D!==void 0)return vw(D)})(Z),ne=U.message;J===void 0&&(J=ve.INTERNAL,ne="Unknown error status: "+Z+" with message "+U.message),S=!0,T.a_(new we(J,ne)),v.close()}else Te(Tn,`RPC '${e}' stream ${a} received:`,z),T.u_(z)}})),C(h,LS.STAT_EVENT,(j=>{j.stat===pg.PROXY?Te(Tn,`RPC '${e}' stream ${a} detected buffering proxy`):j.stat===pg.NOPROXY&&Te(Tn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{T.__()}),0),T}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function Hp(){return typeof document<"u"?document:null}function ff(t){return new w2(t,!0)}class Ow{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&Te("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const $x="PersistentStream";class Mw{constructor(e,n,i,a,l,c,h,f){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ow(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===ve.RESOURCE_EXHAUSTED?(Hi(n.toString()),Hi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===ve.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===n&&this.G_(i,a)}),(i=>{e((()=>{const a=new we(ve.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Te($x,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Te($x,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class x5 extends Mw{constructor(e,n,i,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=C2(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Fe.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Fe.min():c.readTime?li(c.readTime):Fe.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=Ag(this.serializer),n.addTarget=(function(l,c){let h;const f=c.target;if(h=bg(f)?{documents:I2(l,f)}:{query:j2(l,f).ft},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=Ew(l,c.resumeToken);const p=Sg(l,c.expectedCount);p!==null&&(h.expectedCount=p)}else if(c.snapshotVersion.compareTo(Fe.min())>0){h.readTime=Ph(l,c.snapshotVersion.toTimestamp());const p=Sg(l,c.expectedCount);p!==null&&(h.expectedCount=p)}return h})(this.serializer,e);const i=O2(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=Ag(this.serializer),n.removeTarget=e,this.q_(n)}}class E5 extends Mw{constructor(e,n,i,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return dt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,dt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){dt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=D2(e.writeResults,e.commitTime),i=li(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=Ag(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>R2(this.serializer,i)))};this.q_(n)}}class S5{}class w5 extends S5{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new we(ve.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,wg(n,i),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new we(ve.UNKNOWN,l.toString())}))}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Ho(e,wg(n,i),a,c,h,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new we(ve.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class T5{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Hi(n),this.aa=!1):Te("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Na="RemoteStore";class A5{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{i.enqueueAndForget((async()=>{Va(this)&&(Te(Na,"Restarting streams for network reachability change."),await(async function(f){const p=He(f);p.Ea.add(4),await mu(p),p.Ra.set("Unknown"),p.Ea.delete(4),await mf(p)})(this))}))})),this.Ra=new T5(i,a)}}async function mf(t){if(Va(t))for(const e of t.da)await e(!0)}async function mu(t){for(const e of t.da)await e(!1)}function Nw(t,e){const n=He(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Sy(n)?Ey(n):vl(n).O_()&&xy(n,e))}function by(t,e){const n=He(t),i=vl(n);n.Ia.delete(e),i.O_()&&Pw(n,e),n.Ia.size===0&&(i.O_()?i.L_():Va(n)&&n.Ra.set("Unknown"))}function xy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Fe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}vl(t).Y_(e)}function Pw(t,e){t.Va.Ue(e),vl(t).Z_(e)}function Ey(t){t.Va=new b2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),vl(t).start(),t.Ra.ua()}function Sy(t){return Va(t)&&!vl(t).x_()&&t.Ia.size>0}function Va(t){return He(t).Ea.size===0}function Lw(t){t.Va=void 0}async function C5(t){t.Ra.set("Online")}async function R5(t){t.Ia.forEach(((e,n)=>{xy(t,e)}))}async function D5(t,e){Lw(t),Sy(t)?(t.Ra.ha(e),Ey(t)):t.Ra.set("Unknown")}async function I5(t,e,n){if(t.Ra.set("Online"),e instanceof xw&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const h of l.targetIds)a.Ia.has(h)&&(await a.remoteSyncer.rejectListen(h,c),a.Ia.delete(h),a.Va.removeTarget(h))})(t,e)}catch(i){Te(Na,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Vh(t,i)}else if(e instanceof dh?t.Va.Ze(e):e instanceof bw?t.Va.st(e):t.Va.tt(e),!n.isEqual(Fe.min()))try{const i=await kw(t.localStore);n.compareTo(i)>=0&&await(function(l,c){const h=l.Va.Tt(c);return h.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const _=l.Ia.get(p);_&&l.Ia.set(p,_.withResumeToken(f.resumeToken,c))}})),h.targetMismatches.forEach(((f,p)=>{const _=l.Ia.get(f);if(!_)return;l.Ia.set(f,_.withResumeToken(En.EMPTY_BYTE_STRING,_.snapshotVersion)),Pw(l,f);const v=new Os(_.target,f,p,_.sequenceNumber);xy(l,v)})),l.remoteSyncer.applyRemoteEvent(h)})(t,n)}catch(i){Te(Na,"Failed to raise snapshot:",i),await Vh(t,i)}}async function Vh(t,e,n){if(!_l(e))throw e;t.Ea.add(1),await mu(t),t.Ra.set("Offline"),n||(n=()=>kw(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Te(Na,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await mf(t)}))}function Vw(t,e){return e().catch((n=>Vh(t,n,e)))}async function pf(t){const e=He(t),n=Ks(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:sy;for(;j5(e);)try{const a=await h5(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,k5(e,a)}catch(a){await Vh(e,a)}Bw(e)&&zw(e)}function j5(t){return Va(t)&&t.Ta.length<10}function k5(t,e){t.Ta.push(e);const n=Ks(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Bw(t){return Va(t)&&!Ks(t).x_()&&t.Ta.length>0}function zw(t){Ks(t).start()}async function O5(t){Ks(t).ra()}async function M5(t){const e=Ks(t);for(const n of t.Ta)e.ea(n.mutations)}async function N5(t,e,n){const i=t.Ta.shift(),a=fy.from(i,e,n);await Vw(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await pf(t)}async function P5(t,e){e&&Ks(t).X_&&await(async function(i,a){if((function(c){return y2(c)&&c!==ve.ABORTED})(a.code)){const l=i.Ta.shift();Ks(i).B_(),await Vw(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await pf(i)}})(t,e),Bw(t)&&zw(t)}async function Kx(t,e){const n=He(t);n.asyncQueue.verifyOperationInProgress(),Te(Na,"RemoteStore received new credentials");const i=Va(n);n.Ea.add(3),await mu(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await mf(n)}async function L5(t,e){const n=He(t);e?(n.Ea.delete(2),await mf(n)):e||(n.Ea.add(2),await mu(n),n.Ra.set("Unknown"))}function vl(t){return t.ma||(t.ma=(function(n,i,a){const l=He(n);return l.sa(),new x5(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:C5.bind(null,t),t_:R5.bind(null,t),r_:D5.bind(null,t),H_:I5.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Sy(t)?Ey(t):t.Ra.set("Unknown")):(await t.ma.stop(),Lw(t))}))),t.ma}function Ks(t){return t.fa||(t.fa=(function(n,i,a){const l=He(n);return l.sa(),new E5(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:O5.bind(null,t),r_:P5.bind(null,t),ta:M5.bind(null,t),na:N5.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await pf(t)):(await t.fa.stop(),t.Ta.length>0&&(Te(Na,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class wy{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Ui,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const c=Date.now()+i,h=new wy(e,n,c,a,l);return h.start(i),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(ve.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ty(t,e){if(Hi("AsyncQueue",`${e}: ${t}`),_l(t))return new we(ve.UNAVAILABLE,`${e}: ${t}`);throw t}class Bo{static emptySet(e){return new Bo(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||Ne.comparator(n.key,i.key):(n,i)=>Ne.comparator(n.key,i.key),this.keyedMap=Pc(),this.sortedSet=new Ot(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Bo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Bo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class Wx{constructor(){this.ga=new Ot(Ne.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ve(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class sl{constructor(e,n,i,a,l,c,h,f,p){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,n,i,a,l){const c=[];return n.forEach((h=>{c.push({type:0,doc:h})})),new sl(e,n,Bo.emptySet(n),c,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&lf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}class V5{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class B5{constructor(){this.queries=Yx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=He(n),l=a.queries;a.queries=Yx(),l.forEach(((c,h)=>{for(const f of h.Sa)f.onError(i)}))})(this,new we(ve.ABORTED,"Firestore shutting down"))}}function Yx(){return new La((t=>ow(t)),lf)}async function Uw(t,e){const n=He(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new V5,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(c){const h=Ty(c,`Initialization of query '${No(e.query)}' failed`);return void e.onError(h)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&Ay(n)}async function Fw(t,e){const n=He(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function z5(t,e){const n=He(t);let i=!1;for(const a of e){const l=a.query,c=n.queries.get(l);if(c){for(const h of c.Sa)h.Fa(a)&&(i=!0);c.wa=a}}i&&Ay(n)}function U5(t,e,n){const i=He(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function Ay(t){t.Ca.forEach((e=>{e.next()}))}var Dg,Xx;(Xx=Dg||(Dg={})).Ma="default",Xx.Cache="cache";class qw{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new sl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=sl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Dg.Cache}}class Hw{constructor(e){this.key=e}}class Gw{constructor(e){this.key=e}}class F5{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=rt(),this.mutatedKeys=rt(),this.eu=lw(e),this.tu=new Bo(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new Wx,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,c=a,h=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,p=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,v)=>{const b=a.get(_),S=cf(this.query,v)?v:null,T=!!b&&this.mutatedKeys.has(b.key),C=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let j=!1;b&&S?b.data.isEqual(S.data)?T!==C&&(i.track({type:3,doc:S}),j=!0):this.su(b,S)||(i.track({type:2,doc:S}),j=!0,(f&&this.eu(S,f)>0||p&&this.eu(S,p)<0)&&(h=!0)):!b&&S?(i.track({type:0,doc:S}),j=!0):b&&!S&&(i.track({type:1,doc:b}),j=!0,(f||p)&&(h=!0)),j&&(S?(c=c.add(S),l=C?l.add(_):l.delete(_)):(c=c.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:c,iu:i,Cs:h,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,v)=>(function(S,T){const C=j=>{switch(j){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ve(20277,{Rt:j})}};return C(S)-C(T)})(_.type,v.type)||this.eu(_.doc,v.doc))),this.ou(i),a=a??!1;const h=n&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,p=f!==this.Za;return this.Za=f,c.length!==0||p?{snapshot:new sl(this.query,e.tu,l,c,e.mutatedKeys,f===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Wx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=rt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new Gw(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new Hw(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=rt();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return sl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Cy="SyncEngine";class q5{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class H5{constructor(e){this.key=e,this.hu=!1}}class G5{constructor(e,n,i,a,l,c){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new La((h=>ow(h)),lf),this.Iu=new Map,this.Eu=new Set,this.du=new Ot(Ne.comparator),this.Au=new Map,this.Ru=new gy,this.Vu={},this.mu=new Map,this.fu=il.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Q5(t,e,n=!0){const i=Xw(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await Qw(i,e,n,!0),a}async function $5(t,e){const n=Xw(t);await Qw(n,e,!0,!1)}async function Qw(t,e,n,i){const a=await f5(t.localStore,oi(e)),l=a.targetId,c=t.sharedClientState.addLocalQueryTarget(l,n);let h;return i&&(h=await K5(t,e,l,c==="current",a.resumeToken)),t.isPrimaryClient&&n&&Nw(t.remoteStore,a),h}async function K5(t,e,n,i,a){t.pu=(v,b,S)=>(async function(C,j,z,q){let U=j.view.ru(z);U.Cs&&(U=await qx(C.localStore,j.query,!1).then((({documents:k})=>j.view.ru(k,U))));const Z=q&&q.targetChanges.get(j.targetId),J=q&&q.targetMismatches.get(j.targetId)!=null,ne=j.view.applyChanges(U,C.isPrimaryClient,Z,J);return Zx(C,j.targetId,ne.au),ne.snapshot})(t,v,b,S);const l=await qx(t.localStore,e,!0),c=new F5(e,l.Qs),h=c.ru(l.documents),f=fu.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),p=c.applyChanges(h,t.isPrimaryClient,f);Zx(t,n,p.au);const _=new q5(e,n,c);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),p.snapshot}async function W5(t,e,n){const i=He(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((c=>!lf(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await Cg(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&by(i.remoteStore,a.targetId),Ig(i,a.targetId)})).catch(yl)):(Ig(i,a.targetId),await Cg(i.localStore,a.targetId,!0))}async function Y5(t,e){const n=He(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),by(n.remoteStore,i.targetId))}async function X5(t,e,n){const i=ik(t);try{const a=await(function(c,h){const f=He(c),p=At.now(),_=h.reduce(((S,T)=>S.add(T.key)),rt());let v,b;return f.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let T=Gi(),C=rt();return f.Ns.getEntries(S,_).next((j=>{T=j,T.forEach(((z,q)=>{q.isValidDocument()||(C=C.add(z))}))})).next((()=>f.localDocuments.getOverlayedDocuments(S,T))).next((j=>{v=j;const z=[];for(const q of h){const U=h2(q,v.get(q.key).overlayedDocument);U!=null&&z.push(new Xs(q.key,U,ZS(U.value.mapValue),Mr.exists(!0)))}return f.mutationQueue.addMutationBatch(S,p,z,h)})).next((j=>{b=j;const z=j.applyToLocalDocumentSet(v,C);return f.documentOverlayCache.saveOverlays(S,j.batchId,z)}))})).then((()=>({batchId:b.batchId,changes:uw(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(c,h,f){let p=c.Vu[c.currentUser.toKey()];p||(p=new Ot(nt)),p=p.insert(h,f),c.Vu[c.currentUser.toKey()]=p})(i,a.batchId,n),await pu(i,a.changes),await pf(i.remoteStore)}catch(a){const l=Ty(a,"Failed to persist write");n.reject(l)}}async function $w(t,e){const n=He(t);try{const i=await u5(n.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=n.Au.get(l);c&&(dt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?dt(c.hu,14607):a.removedDocuments.size>0&&(dt(c.hu,42227),c.hu=!1))})),await pu(n,i,e)}catch(i){await yl(i)}}function Jx(t,e,n){const i=He(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach(((l,c)=>{const h=c.view.va(e);h.snapshot&&a.push(h.snapshot)})),(function(c,h){const f=He(c);f.onlineState=h;let p=!1;f.queries.forEach(((_,v)=>{for(const b of v.Sa)b.va(h)&&(p=!0)})),p&&Ay(f)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function J5(t,e,n){const i=He(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let c=new Ot(Ne.comparator);c=c.insert(l,Cn.newNoDocument(l,Fe.min()));const h=rt().add(l),f=new hf(Fe.min(),new Map,new Ot(nt),c,h);await $w(i,f),i.du=i.du.remove(l),i.Au.delete(e),Ry(i)}else await Cg(i.localStore,e,!1).then((()=>Ig(i,e,n))).catch(yl)}async function Z5(t,e){const n=He(t),i=e.batch.batchId;try{const a=await c5(n.localStore,e);Ww(n,i,null),Kw(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await pu(n,a)}catch(a){await yl(a)}}async function ek(t,e,n){const i=He(t);try{const a=await(function(c,h){const f=He(c);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let _;return f.mutationQueue.lookupMutationBatch(p,h).next((v=>(dt(v!==null,37113),_=v.keys(),f.mutationQueue.removeMutationBatch(p,v)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,_,h))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_))).next((()=>f.localDocuments.getDocuments(p,_)))}))})(i.localStore,e);Ww(i,e,n),Kw(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await pu(i,a)}catch(a){await yl(a)}}function Kw(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Ww(t,e,n){const i=He(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function Ig(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||Yw(t,i)}))}function Yw(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(by(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Ry(t))}function Zx(t,e,n){for(const i of n)i instanceof Hw?(t.Ru.addReference(i.key,e),tk(t,i)):i instanceof Gw?(Te(Cy,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||Yw(t,i.key)):Ve(19791,{wu:i})}function tk(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(Te(Cy,"New document in limbo: "+n),t.Eu.add(i),Ry(t))}function Ry(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Ne(Et.fromString(e)),i=t.fu.next();t.Au.set(i,new H5(n)),t.du=t.du.insert(n,i),Nw(t.remoteStore,new Os(oi(uy(n.path)),i,"TargetPurposeLimboResolution",sf.ce))}}async function pu(t,e,n){const i=He(t),a=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((h,f)=>{c.push(i.pu(f,e,n).then((p=>{if((p||n)&&i.isPrimaryClient){const _=p?!p.fromCache:n?.targetChanges.get(f.targetId)?.current;i.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(p){a.push(p);const _=_y.As(f.targetId,p);l.push(_)}})))})),await Promise.all(c),i.Pu.H_(a),await(async function(f,p){const _=He(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>be.forEach(p,(b=>be.forEach(b.Es,(S=>_.persistence.referenceDelegate.addReference(v,b.targetId,S))).next((()=>be.forEach(b.ds,(S=>_.persistence.referenceDelegate.removeReference(v,b.targetId,S)))))))))}catch(v){if(!_l(v))throw v;Te(vy,"Failed to update sequence numbers: "+v)}for(const v of p){const b=v.targetId;if(!v.fromCache){const S=_.Ms.get(b),T=S.snapshotVersion,C=S.withLastLimboFreeSnapshotVersion(T);_.Ms=_.Ms.insert(b,C)}}})(i.localStore,l))}async function nk(t,e){const n=He(t);if(!n.currentUser.isEqual(e)){Te(Cy,"User change. New user:",e.toKey());const i=await jw(n.localStore,e);n.currentUser=e,(function(l,c){l.mu.forEach((h=>{h.forEach((f=>{f.reject(new we(ve.CANCELLED,c))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await pu(n,i.Ls)}}function rk(t,e){const n=He(t),i=n.Au.get(e);if(i&&i.hu)return rt().add(i.key);{let a=rt();const l=n.Iu.get(e);if(!l)return a;for(const c of l){const h=n.Tu.get(c);a=a.unionWith(h.view.nu)}return a}}function Xw(t){const e=He(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=$w.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=J5.bind(null,e),e.Pu.H_=z5.bind(null,e.eventManager),e.Pu.yu=U5.bind(null,e.eventManager),e}function ik(t){const e=He(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Z5.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ek.bind(null,e),e}class Bh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ff(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return l5(this.persistence,new s5,e.initialUser,this.serializer)}Cu(e){return new Iw(yy.mi,this.serializer)}Du(e){return new p5}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Bh.provider={build:()=>new Bh};class sk extends Bh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){dt(this.persistence.referenceDelegate instanceof Lh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new H2(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?zn.withCacheSize(this.cacheSizeBytes):zn.DEFAULT;return new Iw((i=>Lh.mi(i,n)),this.serializer)}}class jg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Jx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=nk.bind(null,this.syncEngine),await L5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new B5})()}createDatastore(e){const n=ff(e.databaseInfo.databaseId),i=(function(l){return new b5(l)})(e.databaseInfo);return(function(l,c,h,f){return new w5(l,c,h,f)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,a,l,c,h){return new A5(i,a,l,c,h)})(this.localStore,this.datastore,e.asyncQueue,(n=>Jx(this.syncEngine,n,0)),(function(){return Qx.v()?new Qx:new g5})())}createSyncEngine(e,n){return(function(a,l,c,h,f,p,_){const v=new G5(a,l,c,h,f,p);return _&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=He(n);Te(Na,"RemoteStore shutting down."),i.Ea.add(5),await mu(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}jg.provider={build:()=>new jg};class Jw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Hi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Ws="FirestoreClient";class ak{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=An.UNAUTHENTICATED,this.clientId=iy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{Te(Ws,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Te(Ws,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ui;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=Ty(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Gp(t,e){t.asyncQueue.verifyOperationInProgress(),Te(Ws,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async a=>{i.isEqual(a)||(await jw(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function eE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await ok(t);Te(Ws,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>Kx(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,a)=>Kx(e.remoteStore,a))),t._onlineComponents=e}async function ok(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Te(Ws,"Using user provided OfflineComponentProvider");try{await Gp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ve.FAILED_PRECONDITION||a.code===ve.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;Zo("Error using user provided cache. Falling back to memory cache: "+n),await Gp(t,new Bh)}}else Te(Ws,"Using default OfflineComponentProvider"),await Gp(t,new sk(void 0));return t._offlineComponents}async function Zw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Te(Ws,"Using user provided OnlineComponentProvider"),await eE(t,t._uninitializedComponentsProvider._online)):(Te(Ws,"Using default OnlineComponentProvider"),await eE(t,new jg))),t._onlineComponents}function lk(t){return Zw(t).then((e=>e.syncEngine))}async function e1(t){const e=await Zw(t),n=e.eventManager;return n.onListen=Q5.bind(null,e.syncEngine),n.onUnlisten=W5.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=$5.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Y5.bind(null,e.syncEngine),n}function ck(t,e,n={}){const i=new Ui;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,h,f,p){const _=new Jw({next:b=>{_.Nu(),c.enqueueAndForget((()=>Fw(l,v)));const S=b.docs.has(h);!S&&b.fromCache?p.reject(new we(ve.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&b.fromCache&&f&&f.source==="server"?p.reject(new we(ve.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(b)},error:b=>p.reject(b)}),v=new qw(uy(h.path),_,{includeMetadataChanges:!0,qa:!0});return Uw(l,v)})(await e1(t),t.asyncQueue,e,n,i))),i.promise}function uk(t,e,n={}){const i=new Ui;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,h,f,p){const _=new Jw({next:b=>{_.Nu(),c.enqueueAndForget((()=>Fw(l,v))),b.fromCache&&f.source==="server"?p.reject(new we(ve.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(b)},error:b=>p.reject(b)}),v=new qw(h,_,{includeMetadataChanges:!0,qa:!0});return Uw(l,v)})(await e1(t),t.asyncQueue,e,n,i))),i.promise}function t1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const tE=new Map;const n1="firestore.googleapis.com",nE=!0;class rE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new we(ve.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=n1,this.ssl=nE}else this.host=e.host,this.ssl=e.ssl??nE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Dw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<F2)throw new we(ve.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Tj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=t1(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new we(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new we(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new we(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gf{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(ve.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(ve.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new pj;switch(i.type){case"firstParty":return new vj(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new we(ve.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=tE.get(n);i&&(Te("ComponentProvider","Removing Datastore"),tE.delete(n),i.terminate())})(this),Promise.resolve()}}function dk(t,e,n,i={}){t=mi(t,gf);const a=ml(e),l=t._getSettings(),c={...l,emulatorOptions:t._getEmulatorOptions()},h=`${e}:${n}`;a&&(AS(`https://${h}`),CS("Firestore",!0)),l.host!==n1&&l.host!==h&&Zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...l,host:h,ssl:a,emulatorOptions:i};if(!qs(f,c)&&(t._setSettings(f),i.mockUserToken)){let p,_;if(typeof i.mockUserToken=="string")p=i.mockUserToken,_=An.MOCK_USER;else{p=FD(i.mockUserToken,t._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new we(ve.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new An(v)}t._authCredentials=new gj(new US(p,_))}}class bl{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new bl(this.firestore,e,this._query)}}class Ft{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ft(this.firestore,e,this._key)}toJSON(){return{type:Ft._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(uu(n,Ft._jsonSchema))return new Ft(e,i||null,new Ne(Et.fromString(n.referencePath)))}}Ft._jsonSchemaVersion="firestore/documentReference/1.0",Ft._jsonSchema={type:tn("string",Ft._jsonSchemaVersion),referencePath:tn("string")};class Bs extends bl{constructor(e,n,i){super(e,n,uy(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ft(this.firestore,null,new Ne(e))}withConverter(e){return new Bs(this.firestore,e,this._path)}}function hk(t,e,...n){if(t=hn(t),FS("collection","path",e),t instanceof gf){const i=Et.fromString(e,...n);return gx(i),new Bs(t,null,i)}{if(!(t instanceof Ft||t instanceof Bs))throw new we(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Et.fromString(e,...n));return gx(i),new Bs(t.firestore,null,i)}}function yf(t,e,...n){if(t=hn(t),arguments.length===1&&(e=iy.newId()),FS("doc","path",e),t instanceof gf){const i=Et.fromString(e,...n);return px(i),new Ft(t,null,new Ne(i))}{if(!(t instanceof Ft||t instanceof Bs))throw new we(ve.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Et.fromString(e,...n));return px(i),new Ft(t.firestore,t instanceof Bs?t.converter:null,new Ne(i))}}const iE="AsyncQueue";class sE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ow(this,"async_queue_retry"),this._c=()=>{const i=Hp();i&&Te(iE,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Hp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Hp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Ui;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!_l(e))throw e;Te(iE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Hi("INTERNAL UNHANDLED ERROR: ",aE(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=wy.createAndSchedule(this,e,n,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Ve(47125,{Pc:aE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function aE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class xl extends gf{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new sE,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new sE(e),this._firestoreClient=void 0,await e}}}function fk(t,e){const n=typeof t=="object"?t:jS(),i=typeof t=="string"?t:Ih,a=ny(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=zD("firestore");l&&dk(a,...l)}return a}function Dy(t){if(t._terminated)throw new we(ve.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||mk(t),t._firestoreClient}function mk(t){const e=t._freezeSettings(),n=(function(a,l,c,h){return new Pj(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,t1(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new ak(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(t._componentsProvider))}class yr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yr(En.fromBase64String(e))}catch(n){throw new we(ve.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new yr(En.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(uu(e,yr._jsonSchema))return yr.fromBase64String(e.bytes)}}yr._jsonSchemaVersion="firestore/bytes/1.0",yr._jsonSchema={type:tn("string",yr._jsonSchemaVersion),bytes:tn("string")};class _f{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new we(ve.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class vf{constructor(e){this._methodName=e}}class ci{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new we(ve.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new we(ve.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return nt(this._lat,e._lat)||nt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ci._jsonSchemaVersion}}static fromJSON(e){if(uu(e,ci._jsonSchema))return new ci(e.latitude,e.longitude)}}ci._jsonSchemaVersion="firestore/geoPoint/1.0",ci._jsonSchema={type:tn("string",ci._jsonSchemaVersion),latitude:tn("number"),longitude:tn("number")};class ui{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ui._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(uu(e,ui._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new ui(e.vectorValues);throw new we(ve.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ui._jsonSchemaVersion="firestore/vectorValue/1.0",ui._jsonSchema={type:tn("string",ui._jsonSchemaVersion),vectorValues:tn("object")};const pk=/^__.*__$/;class gk{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new Xs(e,this.data,this.fieldMask,n,this.fieldTransforms):new hu(e,this.data,n,this.fieldTransforms)}}class r1{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new Xs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function i1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ve(40011,{Ac:t})}}class bf{constructor(e,n,i,a,l,c){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new bf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return zh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(i1(this.Ac)&&pk.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class yk{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||ff(e)}Cc(e,n,i,a=!1){return new bf({Ac:e,methodName:n,Dc:i,path:xn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Iy(t){const e=t._freezeSettings(),n=ff(t._databaseId);return new yk(t._databaseId,!!e.ignoreUndefinedProperties,n)}function _k(t,e,n,i,a,l={}){const c=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);ky("Data must be an object, but it was:",c,i);const h=s1(i,c);let f,p;if(l.merge)f=new er(c.fieldMask),p=c.fieldTransforms;else if(l.mergeFields){const _=[];for(const v of l.mergeFields){const b=kg(e,v,n);if(!c.contains(b))throw new we(ve.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);o1(_,b)||_.push(b)}f=new er(_),p=c.fieldTransforms.filter((v=>f.covers(v.field)))}else f=null,p=c.fieldTransforms;return new gk(new Un(h),f,p)}class xf extends vf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof xf}}function vk(t,e,n){return new bf({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class jy extends vf{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=vk(this,e,!0),i=this.vc.map((l=>El(l,n))),a=new rl(i);return new l2(e.path,a)}isEqual(e){return e instanceof jy&&qs(this.vc,e.vc)}}function bk(t,e,n,i){const a=t.Cc(1,e,n);ky("Data must be an object, but it was:",a,i);const l=[],c=Un.empty();Ys(i,((f,p)=>{const _=Oy(e,f,n);p=hn(p);const v=a.yc(_);if(p instanceof xf)l.push(_);else{const b=El(p,v);b!=null&&(l.push(_),c.set(_,b))}}));const h=new er(l);return new r1(c,h,a.fieldTransforms)}function xk(t,e,n,i,a,l){const c=t.Cc(1,e,n),h=[kg(e,i,n)],f=[a];if(l.length%2!=0)throw new we(ve.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<l.length;b+=2)h.push(kg(e,l[b])),f.push(l[b+1]);const p=[],_=Un.empty();for(let b=h.length-1;b>=0;--b)if(!o1(p,h[b])){const S=h[b];let T=f[b];T=hn(T);const C=c.yc(S);if(T instanceof xf)p.push(S);else{const j=El(T,C);j!=null&&(p.push(S),_.set(S,j))}}const v=new er(p);return new r1(_,v,c.fieldTransforms)}function Ek(t,e,n,i=!1){return El(n,t.Cc(i?4:3,e))}function El(t,e){if(a1(t=hn(t)))return ky("Unsupported field value:",e,t),s1(t,e);if(t instanceof vf)return(function(i,a){if(!i1(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let c=0;for(const h of i){let f=El(h,a.wc(c));f==null&&(f={nullValue:"NULL_VALUE"}),l.push(f),c++}return{arrayValue:{values:l}}})(t,e)}return(function(i,a){if((i=hn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return s2(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=At.fromDate(i);return{timestampValue:Ph(a.serializer,l)}}if(i instanceof At){const l=new At(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ph(a.serializer,l)}}if(i instanceof ci)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof yr)return{bytesValue:Ew(a.serializer,i._byteString)};if(i instanceof Ft){const l=a.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw a.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:py(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof ui)return(function(c,h){return{mapValue:{fields:{[XS]:{stringValue:JS},[jh]:{arrayValue:{values:c.toArray().map((p=>{if(typeof p!="number")throw h.Sc("VectorValues must only contain numeric values.");return dy(h.serializer,p)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${rf(i)}`)})(t,e)}function s1(t,e){const n={};return GS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ys(t,((i,a)=>{const l=El(a,e.mc(i));l!=null&&(n[i]=l)})),{mapValue:{fields:n}}}function a1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof At||t instanceof ci||t instanceof yr||t instanceof Ft||t instanceof vf||t instanceof ui)}function ky(t,e,n){if(!a1(n)||!qS(n)){const i=rf(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function kg(t,e,n){if((e=hn(e))instanceof _f)return e._internalPath;if(typeof e=="string")return Oy(t,e);throw zh("Field path arguments must be of type string or ",t,!1,void 0,n)}const Sk=new RegExp("[~\\*/\\[\\]]");function Oy(t,e,n){if(e.search(Sk)>=0)throw zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new _f(...e.split("."))._internalPath}catch{throw zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function zh(t,e,n,i,a){const l=i&&!i.isEmpty(),c=a!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(l||c)&&(f+=" (found",l&&(f+=` in field ${i}`),c&&(f+=` in document ${a}`),f+=")"),new we(ve.INVALID_ARGUMENT,h+t+f)}function o1(t,e){return t.some((n=>n.isEqual(e)))}class l1{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new wk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(My("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class wk extends l1{data(){return super.data()}}function My(t,e){return typeof e=="string"?Oy(t,e):e instanceof _f?e._internalPath:e._delegate._internalPath}function Tk(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new we(ve.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ny{}class Ak extends Ny{}function Ck(t,e,...n){let i=[];e instanceof Ny&&i.push(e),i=i.concat(n),(function(l){const c=l.filter((f=>f instanceof Py)).length,h=l.filter((f=>f instanceof Ef)).length;if(c>1||c>0&&h>0)throw new we(ve.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)t=a._apply(t);return t}class Ef extends Ak{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new Ef(e,n,i)}_apply(e){const n=this._parse(e);return c1(e._query,n),new bl(e.firestore,e.converter,xg(e._query,n))}_parse(e){const n=Iy(e.firestore);return(function(l,c,h,f,p,_,v){let b;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new we(ve.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){lE(v,_);const T=[];for(const C of v)T.push(oE(f,l,C));b={arrayValue:{values:T}}}else b=oE(f,l,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||lE(v,_),b=Ek(h,c,v,_==="in"||_==="not-in");return en.create(p,_,b)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Rk(t,e,n){const i=e,a=My("where",t);return Ef._create(a,i,n)}class Py extends Ny{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Py(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Pr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,l){let c=a;const h=l.getFlattenedFilters();for(const f of h)c1(c,f),c=xg(c,f)})(e._query,n),new bl(e.firestore,e.converter,xg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function oE(t,e,n){if(typeof(n=hn(n))=="string"){if(n==="")throw new we(ve.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!aw(e)&&n.indexOf("/")!==-1)throw new we(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Et.fromString(n));if(!Ne.isDocumentKey(i))throw new we(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return wx(t,new Ne(i))}if(n instanceof Ft)return wx(t,n._key);throw new we(ve.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rf(n)}.`)}function lE(t,e){if(!Array.isArray(t)||t.length===0)throw new we(ve.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function c1(t,e){const n=(function(a,l){for(const c of a)for(const h of c.getFlattenedFilters())if(l.indexOf(h.op)>=0)return h.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new we(ve.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new we(ve.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Dk{convertValue(e,n="none"){switch($s(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Qs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ve(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return Ys(e,((a,l)=>{i[a]=this.convertValue(l,n)})),i}convertVectorValue(e){const n=e.fields?.[jh].arrayValue?.values?.map((i=>Ut(i.doubleValue)));return new ui(n)}convertGeoPoint(e){return new ci(Ut(e.latitude),Ut(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=of(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Wc(e));default:return null}}convertTimestamp(e){const n=Gs(e);return new At(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=Et.fromString(e);dt(Rw(i),9688,{name:e});const a=new Yc(i.get(1),i.get(3)),l=new Ne(i.popFirst(5));return a.isEqual(n)||Hi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function Ik(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Vc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ia extends l1{constructor(e,n,i,a,l,c){super(e,n,i,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new hh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(My("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new we(ve.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ia._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ia._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ia._jsonSchema={type:tn("string",Ia._jsonSchemaVersion),bundleSource:tn("string","DocumentSnapshot"),bundleName:tn("string"),bundle:tn("string")};class hh extends Ia{data(e={}){return super.data(e)}}class zo{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Vc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new hh(this._firestore,this._userDataWriter,i.key,i,new Vc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new we(ve.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((h=>{const f=new hh(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Vc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((h=>l||h.type!==3)).map((h=>{const f=new hh(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Vc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);let p=-1,_=-1;return h.type!==0&&(p=c.indexOf(h.doc.key),c=c.delete(h.doc.key)),h.type!==1&&(c=c.add(h.doc),_=c.indexOf(h.doc.key)),{type:jk(h.type),doc:f,oldIndex:p,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new we(ve.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=zo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=iy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function jk(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ve(61501,{type:t})}}function kk(t){t=mi(t,Ft);const e=mi(t.firestore,xl);return ck(Dy(e),t._key).then((n=>Lk(e,t,n)))}zo._jsonSchemaVersion="firestore/querySnapshot/1.0",zo._jsonSchema={type:tn("string",zo._jsonSchemaVersion),bundleSource:tn("string","QuerySnapshot"),bundleName:tn("string"),bundle:tn("string")};class u1 extends Dk{constructor(e){super(),this.firestore=e}convertBytes(e){return new yr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,n)}}function Ok(t){t=mi(t,bl);const e=mi(t.firestore,xl),n=Dy(e),i=new u1(e);return Tk(t._query),uk(n,t._query).then((a=>new zo(e,i,t,a)))}function Mk(t,e,n){t=mi(t,Ft);const i=mi(t.firestore,xl),a=Ik(t.converter,e,n);return Ly(i,[_k(Iy(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,Mr.none())])}function Nk(t,e,n,...i){t=mi(t,Ft);const a=mi(t.firestore,xl),l=Iy(a);let c;return c=typeof(e=hn(e))=="string"||e instanceof _f?xk(l,"updateDoc",t._key,e,n,i):bk(l,"updateDoc",t._key,e),Ly(a,[c.toMutation(t._key,Mr.exists(!0))])}function Pk(t){return Ly(mi(t.firestore,xl),[new hy(t._key,Mr.none())])}function Ly(t,e){return(function(i,a){const l=new Ui;return i.asyncQueue.enqueueAndForget((async()=>X5(await lk(i),a,l))),l.promise})(Dy(t),e)}function Lk(t,e,n){const i=n.docs.get(e._key),a=new u1(t);return new Ia(t,a,e._key,i,new Vc(n.hasPendingWrites,n.fromCache),e.converter)}function Vk(...t){return new jy("arrayUnion",t)}(function(e,n=!0){(function(a){gl=a})(pl),Jo(new Oa("firestore",((i,{instanceIdentifier:a,options:l})=>{const c=i.getProvider("app").getImmediate(),h=new xl(new yj(i.getProvider("auth-internal")),new bj(c,i.getProvider("app-check-internal")),(function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new we(ve.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yc(p.options.projectId,_)})(c,a),c);return l={useFetchStreams:n,...l},h._setSettings(l),h}),"PUBLIC").setMultipleInstances(!0)),Ls(dx,hx,e),Ls(dx,hx,"esm2020")})();var Bk="firebase",zk="12.7.0";Ls(Bk,zk,"app");const Uk={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},d1=IS(Uk);function gu(t,e,n,i=1){{let a=e;if(e.startsWith("budgets/"))a="budgets";else if(e.startsWith("months/")){const c=e.replace("months/","").split("_");if(c.length>=2){const h=c[c.length-1];a=`months/${c[c.length-2]}/${h}`}}console.log(`[Firebase] ${t}(${i}): ${a}  ${n}`)}}function yu(){return fk(d1)}function cE(t){return t===null||typeof t!="object"?!1:"_methodName"in t}function Uh(t){const e={};for(const[n,i]of Object.entries(t))i!==void 0&&(cE(i)?e[n]=i:i!==null&&typeof i=="object"&&!Array.isArray(i)?e[n]=Uh(i):Array.isArray(i)?e[n]=i.map(a=>a!==null&&typeof a=="object"&&!cE(a)?Uh(a):a):e[n]=i);return e}async function Ae(t,e,n){const i=yf(yu(),t,e),a=`${t}/${e}`;gu("READ",a,n);const l=await kk(i);return{exists:l.exists(),data:l.exists()?l.data():null,ref:i}}async function Xe(t,e,n,i,a){const l=yf(yu(),t,e),c=Uh(n),h=`${t}/${e}`;return gu("WRITE",h,i),Mk(l,c,a??{})}async function rh(t,e,n,i){const a=yf(yu(),t,e),l=Uh(n),c=`${t}/${e}`;return gu("UPDATE",c,i),Nk(a,l)}async function h1(t,e,n){const i=yf(yu(),t,e),a=`${t}/${e}`;return gu("DELETE",a,n),Pk(i)}async function Nr(t,e,n){const i=yu(),a=hk(i,t);let l;if(n&&n.length>0){const f=n.map(p=>Rk(p.field,p.op,p.value));l=Ck(a,...f)}else l=a;const c=await Ok(l);let h=t;if(n&&n.length>0){const f=n.map(p=>`${p.field} ${p.op} ${JSON.stringify(p.value)}`).join(", ");h+=` WHERE ${f}`}return gu("QUERY",h,e,c.docs.length),{docs:c.docs.map(f=>({id:f.id,data:f.data()}))}}function Og(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname,balance:i.balance,account_group_id:i.account_group_id??null,sort_order:i.sort_order},i.is_income_account!==void 0&&(e[n].is_income_account=i.is_income_account),i.is_income_default!==void 0&&(e[n].is_income_default=i.is_income_default),i.is_outgo_account!==void 0&&(e[n].is_outgo_account=i.is_outgo_account),i.is_outgo_default!==void 0&&(e[n].is_outgo_default=i.is_outgo_default),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function Fk(t){return t.map(e=>{const n={id:e.id,amount:e.amount,account_id:e.account_id,date:e.date,created_at:e.created_at};return e.payee&&(n.payee=e.payee),e.description&&(n.description=e.description),n})}function qk(t){return t.map(e=>({category_id:e.category_id,amount:e.amount}))}function Hk(t){return t.map(e=>{const n={id:e.id,amount:e.amount,category_id:e.category_id,account_id:e.account_id,date:e.date,created_at:e.created_at};return e.payee&&(n.payee=e.payee),e.description&&(n.description=e.description),n})}function Gk(t){return t.map(e=>({category_id:e.category_id,start_balance:e.start_balance,allocated:e.allocated,spent:e.spent,end_balance:e.end_balance}))}function It(t,e,n){const i=n.toString().padStart(2,"0");return`${t}_${e}_${i}`}function Qk(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname,balance:i.balance,account_group_id:i.account_group_id??null,sort_order:i.sort_order??0,is_income_account:i.is_income_account,is_income_default:i.is_income_default,is_outgo_account:i.is_outgo_account,is_outgo_default:i.is_outgo_default,on_budget:i.on_budget,is_active:i.is_active}}),e}function $k(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order??0,expected_balance:i.expected_balance??"positive",on_budget:i.on_budget,is_active:i.is_active}}),e}function Kk(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,description:i.description,category_group_id:i.category_group_id??null,sort_order:i.sort_order??0,default_monthly_amount:i.default_monthly_amount,default_monthly_type:i.default_monthly_type,balance:i.balance??0}}),e}function Wk(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,i)=>n.sort_order-i.sort_order),e}function Yk(t){return!t||typeof t.computed_at!="string"||typeof t.computed_for_year!="number"||typeof t.computed_for_month!="number"||typeof t.is_stale!="boolean"||!t.balances?null:{computed_at:t.computed_at,computed_for_year:t.computed_for_year,computed_for_month:t.computed_for_month,is_stale:t.is_stale,balances:t.balances}}function Xk(t){return!t||typeof t.computed_at!="string"||typeof t.computed_for_year!="number"||typeof t.computed_for_month!="number"||typeof t.is_stale!="boolean"||!t.balances?null:{computed_at:t.computed_at,computed_for_year:t.computed_for_year,computed_for_month:t.computed_for_month,is_stale:t.is_stale,balances:t.balances}}async function Jk(t){const{exists:e,data:n}=await Ae("budgets",t,"loading budget data (cache miss or stale)");if(!e||!n)throw new Error(`Budget ${t} not found`);return{budget:{id:t,name:n.name,user_ids:n.user_ids||[],accepted_user_ids:n.accepted_user_ids||[],owner_id:n.owner_id||n.user_ids?.[0]||"",owner_email:n.owner_email||null},accounts:Qk(n.accounts),accountGroups:$k(n.account_groups),categories:Kk(n.categories),categoryGroups:Wk(n.category_groups),categoryBalancesSnapshot:Yk(n.category_balances_snapshot),accountBalancesSnapshot:Xk(n.account_balances_snapshot)}}function Zk(t,e){return fl({queryKey:t?le.budget(t):["budget","none"],queryFn:()=>Jk(t),enabled:!!t&&e?.enabled!==!1})}function fh(t,e,n){let i=e,a=n+1;a>12&&(a=1,i+=1);const l=le.month(t,i,a),c=Oe.getQueryData(l);c&&!c.month.previous_month_snapshot_stale&&Oe.setQueryData(l,{month:{...c.month,previous_month_snapshot_stale:!0}})}async function eO(t,e,n){let i=e,a=n+1;a>12&&(a=1,i+=1);const l=le.month(t,i,a),c=It(t,i,a);let h=null;const f=Oe.getQueryData(l);if(f?.month)h=f.month;else{const{exists:p,data:_}=await Ae("months",c,"checking if next month exists to mark its snapshot stale");if(!p||!_)return;h=_,Oe.setQueryData(l,{month:h})}h.previous_month_snapshot_stale||(await Xe("months",c,{...h,previous_month_snapshot_stale:!0,updated_at:new Date().toISOString()},"marking next month snapshot as stale (previous month was edited)"),Oe.setQueryData(l,{month:{...h,previous_month_snapshot_stale:!0}}))}function Sf(t,e,n,i){const a=(t.income||[]).map(p=>({id:p.id,amount:p.amount,account_id:p.account_id,date:p.date,payee:p.payee,description:p.description,created_at:p.created_at})),l=(t.expenses||[]).map(p=>({id:p.id,amount:p.amount,category_id:p.category_id,account_id:p.account_id,date:p.date,payee:p.payee,description:p.description,created_at:p.created_at})),c=(t.allocations||[]).map(p=>({category_id:p.category_id,amount:p.amount})),h=(t.category_balances||[]).map(p=>({category_id:p.category_id,start_balance:p.start_balance,allocated:p.allocated,spent:p.spent,end_balance:p.end_balance}));let f;return t.previous_month_snapshot&&(f={total_income:t.previous_month_snapshot.total_income??0,account_balances_end:t.previous_month_snapshot.account_balances_end??{},category_balances_end:t.previous_month_snapshot.category_balances_end??{},snapshot_taken_at:t.previous_month_snapshot.snapshot_taken_at}),{budget_id:e,year:n,month:i,income:a,total_income:t.total_income??a.reduce((p,_)=>p+_.amount,0),expenses:l,total_expenses:t.total_expenses??l.reduce((p,_)=>p+_.amount,0),allocations:c,allocations_finalized:t.allocations_finalized||!1,account_balances_start:t.account_balances_start,account_balances_end:t.account_balances_end,category_balances:h,category_balances_stale:t.category_balances_stale??!1,previous_month_snapshot:f,previous_month_snapshot_stale:t.previous_month_snapshot_stale??!1,created_at:t.created_at,updated_at:t.updated_at||t.created_at}}function f1(t,e){let n=t,i=e-1;return i<1&&(i=12,n-=1),{prevYear:n,prevMonth:i}}function Mg(t){const e={};return t.category_balances&&t.category_balances.forEach(n=>{e[n.category_id]=n.end_balance}),{total_income:t.total_income??0,account_balances_end:t.account_balances_end??{},category_balances_end:e,snapshot_taken_at:new Date().toISOString()}}async function tO(t,e,n){const i=It(t,e,n),{exists:a,data:l}=await Ae("months",i,"loading month document (cache miss or stale)");if(a&&l){const h=Sf(l,t,e,n);return h.previous_month_snapshot_stale===!0||h.previous_month_snapshot===void 0&&n!==1?await nO(t,e,n,h):h}return await rO(t,e,n)}async function nO(t,e,n,i){const{prevYear:a,prevMonth:l}=f1(e,n),c=It(t,e,n);let h=null;const f=Oe.getQueryData(le.month(t,a,l));if(f)h=f.month;else{const b=It(t,a,l),{exists:S,data:T}=await Ae("months",b,"fetching previous month to rebuild stale snapshot (not in cache)");S&&T&&(h=Sf(T,t,a,l),Oe.setQueryData(le.month(t,a,l),{month:h}))}const p=h?Mg(h):{total_income:0,account_balances_end:{},category_balances_end:{},snapshot_taken_at:new Date().toISOString()},_={...i,previous_month_snapshot:p,previous_month_snapshot_stale:!1,updated_at:new Date().toISOString()},v={budget_id:_.budget_id,year:_.year,month:_.month,income:_.income??[],total_income:_.total_income??0,expenses:_.expenses??[],total_expenses:_.total_expenses??0,allocations:_.allocations??[],allocations_finalized:_.allocations_finalized??!1,category_balances:_.category_balances??[],previous_month_snapshot:p,previous_month_snapshot_stale:!1,created_at:_.created_at??new Date().toISOString(),updated_at:_.updated_at};return _.account_balances_start!==void 0&&(v.account_balances_start=_.account_balances_start),_.account_balances_end!==void 0&&(v.account_balances_end=_.account_balances_end),await Xe("months",c,v,"saving month with fresh snapshot rebuilt from previous month"),_}async function rO(t,e,n){const i=new Date().toISOString(),a=It(t,e,n);let l;if(n>1||e>new Date().getFullYear()-10){const{prevYear:f,prevMonth:p}=f1(e,n),_=Oe.getQueryData(le.month(t,f,p));if(_)l=Mg(_.month);else{const v=It(t,f,p),{exists:b,data:S}=await Ae("months",v,"fetching previous month to create snapshot for new month (not in cache)");if(b&&S){const T=Sf(S,t,f,p);l=Mg(T),Oe.setQueryData(le.month(t,f,p),{month:T})}}}const c={budget_id:t,year:e,month:n,income:[],total_income:0,expenses:[],total_expenses:0,allocations:[],allocations_finalized:!1,category_balances:[],previous_month_snapshot:l,previous_month_snapshot_stale:!1,created_at:i,updated_at:i},h={budget_id:t,year:e,month:n,income:[],total_income:0,expenses:[],total_expenses:0,allocations:[],allocations_finalized:!1,category_balances:[],previous_month_snapshot_stale:!1,created_at:i,updated_at:i};return l&&(h.previous_month_snapshot=l),await Xe("months",a,h,"creating new month document (first time viewing this month)"),c}function iO(t,e,n,i){return fl({queryKey:t?le.month(t,e,n):["month","none"],queryFn:async()=>({month:await tO(t,e,n)}),enabled:!!t&&i?.enabled!==!1})}async function sO(t){const{exists:e,data:n}=await Ae("payees",t,"loading payees for autocomplete (cache miss or stale)");return e&&n?n.payees||[]:[]}function aO(t,e){return fl({queryKey:t?le.payees(t):["payees","none"],queryFn:()=>sO(t),enabled:!!t&&e?.enabled!==!1})}async function oO(t,e){const{exists:n,data:i}=await Ae("users",t,"loading user profile (cache miss or stale)");if(n&&i)return i;const a={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await Xe("users",t,a,"creating new user document (first login)"),a}function lO(t,e,n){return fl({queryKey:t?le.user(t):["user","none"],queryFn:()=>oO(t,e),enabled:!!t&&n?.enabled!==!1})}async function cO(t,e){const n=await Nr("budgets","loading budgets user has access to (cache miss or stale)",[{field:"user_ids",op:"array-contains",value:t}]),i=[],a=[];for(const l of n.docs){const c=l.data;c.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(l.id)?i.push({id:l.id,name:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null,isOwner:c.owner_id===t,isPending:!1}):a.push({budgetId:l.id,budgetName:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null})}return{budgets:i,pendingInvites:a}}function uO(t,e,n){return fl({queryKey:t?le.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?cO(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}function dO(t){if(Array.isArray(t))return t;if(t&&typeof t=="object"&&!Array.isArray(t)){const e=t;if(e._methodName==="arrayUnion"&&Array.isArray(e.vc))return console.warn("[useFeedbackQuery] Found corrupted arrayUnion in feedback document - extracting items from vc"),e.vc}return[]}async function hO(){const t=await Nr("feedback","admin loading all feedback (cache miss or stale)"),e=[];for(const n of t.docs){const i=dO(n.data.items),a=n.data.user_email||n.id;i.forEach(l=>{e.push({...l,doc_id:n.id,user_email:a})})}return{items:e}}function fO(t){return fl({queryKey:le.feedback(),queryFn:hO,enabled:t?.enabled!==!1})}function mO(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order},i.expected_balance!==void 0&&(e[n].expected_balance=i.expected_balance),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function pO(){const t=gi(),e=xt({mutationFn:async({budgetId:a,accounts:l})=>{const{exists:c,data:h}=await Ae("budgets",a,"PRE-EDIT-READ");if(!c||!h)throw new Error("Budget not found");const f=Og(l);return await Xe("budgets",a,{...h,accounts:f},"saving updated accounts (user edited account settings)"),l},onMutate:async({budgetId:a,accounts:l})=>{await t.cancelQueries({queryKey:le.budget(a)});const c=t.getQueryData(le.budget(a));return c&&t.setQueryData(le.budget(a),{...c,accounts:l}),{previousData:c}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(le.budget(l));c&&t.setQueryData(le.budget(l),{...c,accounts:a})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(le.budget(l),c.previousData)}}),n=xt({mutationFn:async({budgetId:a,accountGroups:l})=>{const{exists:c,data:h}=await Ae("budgets",a,"PRE-EDIT-READ");if(!c||!h)throw new Error("Budget not found");const f=mO(l);return await Xe("budgets",a,{...h,account_groups:f},"saving updated account groups (user edited group settings)"),l},onMutate:async({budgetId:a,accountGroups:l})=>{await t.cancelQueries({queryKey:le.budget(a)});const c=t.getQueryData(le.budget(a));return c&&t.setQueryData(le.budget(a),{...c,accountGroups:l}),{previousData:c}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(le.budget(l));c&&t.setQueryData(le.budget(l),{...c,accountGroups:a})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(le.budget(l),c.previousData)}}),i=xt({mutationFn:async({budgetId:a,accountId:l,delta:c})=>{const{exists:h,data:f}=await Ae("budgets",a,"PRE-EDIT-READ");if(!h||!f)throw new Error("Budget not found");const p=f.accounts||{};if(!p[l])throw new Error("Account not found");const _={...p,[l]:{...p[l],balance:p[l].balance+c}};return await Xe("budgets",a,{...f,accounts:Og(_)},"saving updated account balance"),_},onMutate:async({budgetId:a,accountId:l,delta:c})=>{await t.cancelQueries({queryKey:le.budget(a)});const h=t.getQueryData(le.budget(a));if(h&&h.accounts[l]){const f={...h.accounts,[l]:{...h.accounts[l],balance:h.accounts[l].balance+c}};t.setQueryData(le.budget(a),{...h,accounts:f})}return{previousData:h}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(le.budget(l));c&&t.setQueryData(le.budget(l),{...c,accounts:a})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(le.budget(l),c.previousData)}});return{updateAccounts:e,updateAccountGroups:n,updateAccountBalance:i}}function uE(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,category_group_id:i.category_group_id??null,sort_order:i.sort_order,balance:i.balance??0},i.description!==void 0&&(e[n].description=i.description),i.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=i.default_monthly_amount),i.default_monthly_type!==void 0&&(e[n].default_monthly_type=i.default_monthly_type)}),e}function gO(){const t=gi(),e=xt({mutationFn:async({budgetId:l,categories:c})=>{const{exists:h,data:f}=await Ae("budgets",l,"PRE-EDIT-READ");if(!h||!f)throw new Error("Budget not found");const p=uE(c);return await Xe("budgets",l,{...f,categories:p},"saving updated categories (user edited category settings)"),c},onMutate:async({budgetId:l,categories:c})=>{await t.cancelQueries({queryKey:le.budget(l)});const h=t.getQueryData(le.budget(l));return h&&t.setQueryData(le.budget(l),{...h,categories:c}),{previousData:h}},onSuccess:(l,{budgetId:c})=>{const h=t.getQueryData(le.budget(c));h&&t.setQueryData(le.budget(c),{...h,categories:l})},onError:(l,{budgetId:c},h)=>{h?.previousData&&t.setQueryData(le.budget(c),h.previousData)}}),n=xt({mutationFn:async({budgetId:l,categoryGroups:c})=>{const{exists:h,data:f}=await Ae("budgets",l,"PRE-EDIT-READ");if(!h||!f)throw new Error("Budget not found");return await Xe("budgets",l,{...f,category_groups:c},"saving updated category groups (user edited group settings)"),c},onMutate:async({budgetId:l,categoryGroups:c})=>{await t.cancelQueries({queryKey:le.budget(l)});const h=t.getQueryData(le.budget(l));return h&&t.setQueryData(le.budget(l),{...h,categoryGroups:c}),{previousData:h}},onSuccess:(l,{budgetId:c})=>{const h=t.getQueryData(le.budget(c));h&&t.setQueryData(le.budget(c),{...h,categoryGroups:l})},onError:(l,{budgetId:c},h)=>{h?.previousData&&t.setQueryData(le.budget(c),h.previousData)}}),i=xt({mutationFn:async({budgetId:l,balances:c,year:h,month:f})=>{const p={computed_at:new Date().toISOString(),computed_for_year:h,computed_for_month:f,is_stale:!1,balances:c},{exists:_,data:v}=await Ae("budgets",l,"PRE-EDIT-READ");if(!_||!v)throw new Error("Budget not found");return await Xe("budgets",l,{...v,category_balances_snapshot:p},"saving category balances snapshot (caching computed balances)"),p},onMutate:async({budgetId:l,balances:c,year:h,month:f})=>{await t.cancelQueries({queryKey:le.budget(l)});const p=t.getQueryData(le.budget(l)),_={computed_at:new Date().toISOString(),computed_for_year:h,computed_for_month:f,is_stale:!1,balances:c};return p&&t.setQueryData(le.budget(l),{...p,categoryBalancesSnapshot:_}),{previousData:p}},onSuccess:(l,{budgetId:c})=>{const h=t.getQueryData(le.budget(c));h&&t.setQueryData(le.budget(c),{...h,categoryBalancesSnapshot:l})},onError:(l,{budgetId:c},h)=>{h?.previousData&&t.setQueryData(le.budget(c),h.previousData)}}),a=xt({mutationFn:async({budgetId:l,categories:c,balances:h,year:f,month:p})=>{const _={computed_at:new Date().toISOString(),computed_for_year:f,computed_for_month:p,is_stale:!1,balances:h},{exists:v,data:b}=await Ae("budgets",l,"PRE-EDIT-READ");if(!v||!b)throw new Error("Budget not found");return await Xe("budgets",l,{...b,categories:uE(c),category_balances_snapshot:_},"saving recalculated category balances and snapshot (user triggered recalculation)"),{categories:c,snapshot:_}},onMutate:async({budgetId:l,categories:c,balances:h,year:f,month:p})=>{await t.cancelQueries({queryKey:le.budget(l)});const _=t.getQueryData(le.budget(l)),v={computed_at:new Date().toISOString(),computed_for_year:f,computed_for_month:p,is_stale:!1,balances:h};return _&&t.setQueryData(le.budget(l),{..._,categories:c,categoryBalancesSnapshot:v}),{previousData:_}},onSuccess:({categories:l,snapshot:c},{budgetId:h})=>{const f=t.getQueryData(le.budget(h));f&&t.setQueryData(le.budget(h),{...f,categories:l,categoryBalancesSnapshot:c})},onError:(l,{budgetId:c},h)=>{h?.previousData&&t.setQueryData(le.budget(c),h.previousData)}});return{updateCategories:e,updateCategoryGroups:n,saveCategoryBalancesSnapshot:i,recalculateCategoryBalances:a}}function yO(){const t=gi(),e=pO(),n=gO(),i=xt({mutationFn:async({budgetId:a,newName:l})=>{const{exists:c,data:h}=await Ae("budgets",a,"PRE-EDIT-READ");if(!c||!h)throw new Error("Budget not found");return await Xe("budgets",a,{...h,name:l.trim()},`renaming budget to "${l.trim()}"`),l.trim()},onMutate:async({budgetId:a,newName:l})=>{await t.cancelQueries({queryKey:le.budget(a)});const c=t.getQueryData(le.budget(a));return c&&t.setQueryData(le.budget(a),{...c,budget:{...c.budget,name:l.trim()}}),{previousData:c}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(le.budget(l));c&&t.setQueryData(le.budget(l),{...c,budget:{...c.budget,name:a}})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(le.budget(l),c.previousData)}});return{updateAccounts:e.updateAccounts,updateAccountGroups:e.updateAccountGroups,updateAccountBalance:e.updateAccountBalance,updateCategories:n.updateCategories,updateCategoryGroups:n.updateCategoryGroups,saveCategoryBalancesSnapshot:n.saveCategoryBalancesSnapshot,recalculateCategoryBalances:n.recalculateCategoryBalances,renameBudget:i}}function _O(t){const e=le.budget(t),n=Oe.getQueryData(e);n?.categoryBalancesSnapshot&&!n.categoryBalancesSnapshot.is_stale&&Oe.setQueryData(e,{...n,categoryBalancesSnapshot:{...n.categoryBalancesSnapshot,is_stale:!0}})}async function mh(t){try{const e=le.budget(t),n=Oe.getQueryData(e);if(n?.categoryBalancesSnapshot?.is_stale)return;const{exists:i,data:a}=await Ae("budgets",t,"checking if budget category snapshot needs stale flag");i&&a&&a.category_balances_snapshot&&!a.category_balances_snapshot.is_stale&&(await Xe("budgets",t,{...a,category_balances_snapshot:{...a.category_balances_snapshot,is_stale:!0}},"marking budget category balances snapshot as stale (expense or allocation changed)"),n&&Oe.setQueryData(e,{...n,categoryBalancesSnapshot:n.categoryBalancesSnapshot?{...n.categoryBalancesSnapshot,is_stale:!0}:null}))}catch(e){console.error("Error marking category balances snapshot stale in Firestore:",e)}}function ph(t,e,n){const i=le.month(t,e,n),a=Oe.getQueryData(i);a?.month&&!a.month.category_balances_stale&&Oe.setQueryData(i,{...a,month:{...a.month,category_balances_stale:!0}})}async function vO(t,e,n){const i=le.month(t,e,n),a=It(t,e,n);try{const l=await Oe.fetchQuery({queryKey:i,queryFn:async()=>{const{exists:c,data:h}=await Ae("months",a,`checking if ${e}/${n} category balances need stale flag`);if(!c||!h)throw new Error("MONTH_NOT_EXISTS");return{month:h}}});if(l.month.category_balances_stale)return;await Xe("months",a,{...l.month,category_balances_stale:!0},`marking ${e}/${n} category balances as stale`),Oe.setQueryData(i,{month:{...l.month,category_balances_stale:!0}})}catch(l){if(l instanceof Error&&l.message==="MONTH_NOT_EXISTS")return;console.error("Error marking month category balances stale in Firestore:",l)}}function gh(t,e,n){const a=Oe.getQueryCache().findAll({predicate:l=>{const c=l.queryKey;return c[0]==="month"&&c[1]===t}});for(const l of a){const c=l.queryKey,h=c[2],f=c[3];if(h>e||h===e&&f>n){const _=Oe.getQueryData(c);_?.month&&!_.month.category_balances_stale&&Oe.setQueryData(c,{..._,month:{..._.month,category_balances_stale:!0}})}}}async function yh(t,e,n){try{const a=Oe.getQueryCache().findAll({predicate:f=>{const p=f.queryKey;return p[0]==="month"&&p[1]===t}});let l=!1,c=!1;for(const f of a){const p=f.queryKey,_=p[2],v=p[3];if(_>e||_===e&&v>n){c=!0;const S=Oe.getQueryData(p);if(S?.month&&!S.month.category_balances_stale){l=!0;break}}}if(c&&!l)return;const h=await Nr("months",`finding months >= ${e} to mark category balances stale`,[{field:"budget_id",op:"==",value:t},{field:"year",op:">=",value:e}]);for(const f of h.docs){const p=f.data.year,_=f.data.month;if((p>e||p===e&&_>n)&&!f.data.category_balances_stale){await Xe("months",f.id,{...f.data,budget_id:t,category_balances_stale:!0},`marking ${p}/${_} category balances as stale (earlier month was edited)`);const b=le.month(t,p,_),S=Oe.getQueryData(b);S&&Oe.setQueryData(b,{month:{...S.month,category_balances_stale:!0}})}}}catch(i){console.error("Error marking future months category balances stale in Firestore:",i)}}async function kr(t,e,n){const i=It(t,e.year,e.month),a={budget_id:e.budget_id,year:e.year,month:e.month,income:Fk(e.income),total_income:e.total_income,updated_at:new Date().toISOString()};e.created_at&&(a.created_at=e.created_at),e.expenses&&(a.expenses=Hk(e.expenses)),e.total_expenses!==void 0&&(a.total_expenses=e.total_expenses),e.allocations&&(a.allocations=qk(e.allocations)),e.allocations_finalized!==void 0&&(a.allocations_finalized=e.allocations_finalized),e.category_balances&&(a.category_balances=Gk(e.category_balances)),e.category_balances_stale!==void 0&&(a.category_balances_stale=e.category_balances_stale),e.account_balances_start&&(a.account_balances_start=e.account_balances_start),e.account_balances_end&&(a.account_balances_end=e.account_balances_end),e.previous_month_snapshot&&(a.previous_month_snapshot=e.previous_month_snapshot),e.previous_month_snapshot_stale!==void 0&&(a.previous_month_snapshot_stale=e.previous_month_snapshot_stale),await Xe("months",i,a,"saveMonthToFirestore: saving month document after mutation"),n?.skipNextMonthStale||await eO(t,e.year,e.month)}async function ai(t,e,n){const{exists:i,data:a}=await Ae("budgets",t,`reading budget to update account balance (delta: ${n})`);if(!i||!a)return null;const l=a.accounts||{};if(!l[e])return null;const c={...l,[e]:{...l[e],balance:l[e].balance+n}};return await Xe("budgets",t,{...a,accounts:Og(c)},"saving updated account balance after income/expense change"),c}async function Fh(t,e,n){const i=e.trim();if(!i||n.includes(i))return null;const a=[...n,i].sort((l,c)=>l.toLowerCase().localeCompare(c.toLowerCase()));return await Xe("payees",t,{budget_id:t,payees:a,updated_at:new Date().toISOString()},`adding new payee "${i}" to autocomplete list`),a}function Qp(t,e,n,i){const a=t.previous_month_snapshot?.category_balances_end??{},l=t.expenses??[];return e.map(c=>{const h=a[c]??0;let f=0;if(i){const _=n.find(v=>v.category_id===c);_&&(f=_.amount)}const p=l.filter(_=>_.category_id===c).reduce((_,v)=>_+v.amount,0);return{category_id:c,start_balance:h,allocated:f,spent:p,end_balance:h+f-p}})}function Uo(t,e,n){const i=t.previous_month_snapshot?.account_balances_end??{},a=t.income??[],l=t.expenses??[],c={},h=[];return e.forEach(f=>{const p=i[f]??n[f]??0,_=a.filter(T=>T.account_id===f).reduce((T,C)=>T+C.amount,0),v=l.filter(T=>T.account_id===f).reduce((T,C)=>T+C.amount,0),b=_-v,S=p+b;c[f]=S,h.push({account_id:f,start_balance:p,income:_,expenses:v,net_change:b,end_balance:S})}),{accountBalancesEnd:c,accountMonthBalances:h}}function bO(t){const e=le.budget(t),n=Oe.getQueryData(e);n?.accountBalancesSnapshot&&!n.accountBalancesSnapshot.is_stale&&Oe.setQueryData(e,{...n,accountBalancesSnapshot:{...n.accountBalancesSnapshot,is_stale:!0}})}async function xO(t){try{const e=le.budget(t),n=Oe.getQueryData(e);if(n?.accountBalancesSnapshot?.is_stale)return;const{exists:i,data:a}=await Ae("budgets",t,"checking if budget account snapshot needs stale flag");i&&a&&a.account_balances_snapshot&&!a.account_balances_snapshot.is_stale&&(await Xe("budgets",t,{...a,account_balances_snapshot:{...a.account_balances_snapshot,is_stale:!0}},"marking budget account balances snapshot as stale (income or expense changed)"),n&&Oe.setQueryData(e,{...n,accountBalancesSnapshot:n.accountBalancesSnapshot?{...n.accountBalancesSnapshot,is_stale:!0}:null}))}catch(e){console.error("Error marking account balances snapshot stale in Firestore:",e)}}function EO(t,e,n){const i=le.month(t,e,n),a=Oe.getQueryData(i);a?.month&&!a.month.account_balances_stale&&Oe.setQueryData(i,{...a,month:{...a.month,account_balances_stale:!0}})}async function SO(t,e,n){const i=le.month(t,e,n),a=It(t,e,n);try{const l=await Oe.fetchQuery({queryKey:i,queryFn:async()=>{const{exists:c,data:h}=await Ae("months",a,`checking if ${e}/${n} account balances need stale flag`);if(!c||!h)throw new Error("MONTH_NOT_EXISTS");return{month:h}}});if(l.month.account_balances_stale)return;await Xe("months",a,{...l.month,account_balances_stale:!0},`marking ${e}/${n} account balances as stale`),Oe.setQueryData(i,{month:{...l.month,account_balances_stale:!0}})}catch(l){if(l instanceof Error&&l.message==="MONTH_NOT_EXISTS")return;console.error("Error marking month account balances stale in Firestore:",l)}}function wO(t,e,n){const a=Oe.getQueryCache().findAll({predicate:l=>{const c=l.queryKey;return c[0]==="month"&&c[1]===t}});for(const l of a){const c=l.queryKey,h=c[2],f=c[3];if(h>e||h===e&&f>n){const _=Oe.getQueryData(c);_?.month&&!_.month.account_balances_stale&&Oe.setQueryData(c,{..._,month:{..._.month,account_balances_stale:!0}})}}}async function TO(t,e,n){try{const a=Oe.getQueryCache().findAll({predicate:f=>{const p=f.queryKey;return p[0]==="month"&&p[1]===t}});let l=!1,c=!1;for(const f of a){const p=f.queryKey,_=p[2],v=p[3];if(_>e||_===e&&v>n){c=!0;const S=Oe.getQueryData(p);if(S?.month&&!S.month.account_balances_stale){l=!0;break}}}if(c&&!l)return;const h=await Nr("months",`finding months >= ${e} to mark account balances stale`,[{field:"budget_id",op:"==",value:t},{field:"year",op:">=",value:e}]);for(const f of h.docs){const p=f.data.year,_=f.data.month;if((p>e||p===e&&_>n)&&!f.data.account_balances_stale){await Xe("months",f.id,{...f.data,budget_id:t,account_balances_stale:!0},`marking ${p}/${_} account balances as stale (earlier month was edited)`);const b=le.month(t,p,_),S=Oe.getQueryData(b);S&&Oe.setQueryData(b,{month:{...S.month,account_balances_stale:!0}})}}}catch(i){console.error("Error marking future months account balances stale in Firestore:",i)}}async function Fo(t,e,n,i){const a=le.month(e,n,i),l=le.budget(e);return await t.cancelQueries({queryKey:a}),await t.cancelQueries({queryKey:l}),{monthKey:a,budgetKey:l}}function qo(t,e,n){return{previousMonth:t.getQueryData(e),previousBudget:t.getQueryData(n)}}function Ho(t,e,n,i={}){const{includeCategoryBalances:a=!0}=i;fh(t,e,n),bO(t),EO(t,e,n),wO(t,e,n),a&&(_O(t),ph(t,e,n),gh(t,e,n))}async function Go(t,e,n,i={}){const{includeCategoryBalances:a=!0}=i;await xO(t),await SO(t,e,n),await TO(t,e,n),a&&(await mh(t),await vO(t,e,n),await yh(t,e,n))}function qh(t,e,n,i,a){n&&n.accounts[i]&&t.setQueryData(e,{...n,accounts:{...n.accounts,[i]:{...n.accounts[i],balance:n.accounts[i].balance+a}}})}function m1(t,e,n,i,a,l,c,h){if(!n)return;const f={...n.accounts},p=h?1:-1;a!==i?(f[i]&&(f[i]={...f[i],balance:f[i].balance-l*p}),f[a]&&(f[a]={...f[a],balance:f[a].balance+c*p})):c!==l&&f[a]&&(f[a]={...f[a],balance:f[a].balance+(c-l)*p}),t.setQueryData(e,{...n,accounts:f})}function Qo(t,e,n){if(!n)return;const i=le.budget(e),a=t.getQueryData(i);a&&t.setQueryData(i,{...a,accounts:n})}function $o(t,e,n,i,a){a?.previousMonth&&t.setQueryData(le.month(e,n,i),a.previousMonth),a?.previousBudget&&t.setQueryData(le.budget(e),a.previousBudget)}function AO(){const t=gi(),e=xt({mutationFn:async a=>{const{budgetId:l,year:c,month:h,amount:f,accountId:p,date:_,payee:v,description:b}=a,S=It(l,c,h),{exists:T,data:C}=await Ae("months",S,"PRE-EDIT-READ");if(!T||!C)throw new Error("Month data not found in Firestore");const j={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:f,account_id:p,date:_,created_at:new Date().toISOString()};v?.trim()&&(j.payee=v.trim()),b&&(j.description=b);const z=await ai(l,p,f),q=[...C.income||[],j];let U={...C,income:q,total_income:q.reduce((J,ne)=>J+ne.amount,0),updated_at:new Date().toISOString()};if(z){const J=Object.keys(z),ne={};J.forEach(A=>{ne[A]=z[A].balance});const{accountBalancesEnd:k}=Uo(U,J,ne);U={...U,account_balances_end:k}}await kr(l,U);let Z=null;if(v?.trim()){const{data:J}=await Ae("payees",l,"checking payees");Z=await Fh(l,v,J?.payees||[])}return await Go(l,c,h,{includeCategoryBalances:!1}),{updatedMonth:U,newIncome:j,updatedAccounts:z,updatedPayees:Z}},onMutate:async a=>{const{budgetId:l,year:c,month:h,amount:f,accountId:p,date:_,payee:v,description:b}=a,{monthKey:S,budgetKey:T}=await Fo(t,l,c,h),{previousMonth:C,previousBudget:j}=qo(t,S,T);if(C){const z={id:`income_optimistic_${Date.now()}`,amount:f,account_id:p,date:_,created_at:new Date().toISOString()};v?.trim()&&(z.payee=v.trim()),b&&(z.description=b);const q=[...C.month.income,z];t.setQueryData(S,{...C,month:{...C.month,income:q,total_income:q.reduce((U,Z)=>U+Z.amount,0)}})}return qh(t,T,j,p,f),Ho(l,c,h,{includeCategoryBalances:!1}),{previousMonth:C,previousBudget:j}},onSuccess:(a,l)=>{const{budgetId:c,year:h,month:f}=l;t.setQueryData(le.month(c,h,f),{month:a.updatedMonth}),Qo(t,c,a.updatedAccounts),a.updatedPayees&&t.setQueryData(le.payees(c),a.updatedPayees)},onError:(a,l,c)=>$o(t,l.budgetId,l.year,l.month,c)}),n=xt({mutationFn:async a=>{const{budgetId:l,year:c,month:h,incomeId:f,amount:p,accountId:_,date:v,payee:b,description:S,oldAmount:T,oldAccountId:C}=a,j=It(l,c,h),{exists:z,data:q}=await Ae("months",j,"PRE-EDIT-READ");if(!z||!q)throw new Error("Month data not found in Firestore");let U=null;if(_!==C)await ai(l,C,-T),U=await ai(l,_,p);else if(p!==T)U=await ai(l,_,p-T);else{const{data:A}=await Ae("budgets",l,"reading accounts");A?.accounts&&(U=A.accounts)}const Z={id:f,amount:p,account_id:_,date:v,created_at:(q.income||[]).find(A=>A.id===f)?.created_at||new Date().toISOString()};b?.trim()&&(Z.payee=b.trim()),S&&(Z.description=S);const J=(q.income||[]).map(A=>A.id===f?Z:A);let ne={...q,income:J,total_income:J.reduce((A,D)=>A+D.amount,0),updated_at:new Date().toISOString()};if(U){const A=Object.keys(U),D={};A.forEach(O=>{D[O]=U[O].balance});const{accountBalancesEnd:P}=Uo(ne,A,D);ne={...ne,account_balances_end:P}}await kr(l,ne);let k=null;if(b?.trim()){const{data:A}=await Ae("payees",l,"checking payees");k=await Fh(l,b,A?.payees||[])}return await Go(l,c,h,{includeCategoryBalances:!1}),{updatedMonth:ne,updatedAccounts:U,updatedPayees:k}},onMutate:async a=>{const{budgetId:l,year:c,month:h,incomeId:f,amount:p,accountId:_,date:v,payee:b,description:S,oldAmount:T,oldAccountId:C}=a,{monthKey:j,budgetKey:z}=await Fo(t,l,c,h),{previousMonth:q,previousBudget:U}=qo(t,j,z);if(q){const Z={id:f,amount:p,account_id:_,date:v,created_at:q.month.income.find(ne=>ne.id===f)?.created_at||new Date().toISOString()};b?.trim()&&(Z.payee=b.trim()),S&&(Z.description=S);const J=q.month.income.map(ne=>ne.id===f?Z:ne);t.setQueryData(j,{...q,month:{...q.month,income:J,total_income:J.reduce((ne,k)=>ne+k.amount,0)}})}return m1(t,z,U,C,_,T,p,!0),Ho(l,c,h,{includeCategoryBalances:!1}),{previousMonth:q,previousBudget:U}},onSuccess:(a,l)=>{const{budgetId:c,year:h,month:f}=l;t.setQueryData(le.month(c,h,f),{month:a.updatedMonth}),Qo(t,c,a.updatedAccounts),a.updatedPayees&&t.setQueryData(le.payees(c),a.updatedPayees)},onError:(a,l,c)=>$o(t,l.budgetId,l.year,l.month,c)}),i=xt({mutationFn:async a=>{const{budgetId:l,year:c,month:h,incomeId:f,amount:p,accountId:_}=a,v=It(l,c,h),{exists:b,data:S}=await Ae("months",v,"PRE-EDIT-READ");if(!b||!S)throw new Error("Month data not found in Firestore");const T=await ai(l,_,-p),C=(S.income||[]).filter(z=>z.id!==f);let j={...S,income:C,total_income:C.reduce((z,q)=>z+q.amount,0),updated_at:new Date().toISOString()};if(T){const z=Object.keys(T),q={};z.forEach(Z=>{q[Z]=T[Z].balance});const{accountBalancesEnd:U}=Uo(j,z,q);j={...j,account_balances_end:U}}return await kr(l,j),await Go(l,c,h,{includeCategoryBalances:!1}),{updatedMonth:j,updatedAccounts:T}},onMutate:async a=>{const{budgetId:l,year:c,month:h,incomeId:f,amount:p,accountId:_}=a,{monthKey:v,budgetKey:b}=await Fo(t,l,c,h),{previousMonth:S,previousBudget:T}=qo(t,v,b);if(S){const C=S.month.income.filter(j=>j.id!==f);t.setQueryData(v,{...S,month:{...S.month,income:C,total_income:C.reduce((j,z)=>j+z.amount,0)}})}return qh(t,b,T,_,-p),Ho(l,c,h,{includeCategoryBalances:!1}),{previousMonth:S,previousBudget:T}},onSuccess:(a,l)=>{const{budgetId:c,year:h,month:f}=l;t.setQueryData(le.month(c,h,f),{month:a.updatedMonth}),Qo(t,c,a.updatedAccounts)},onError:(a,l,c)=>$o(t,l.budgetId,l.year,l.month,c)});return{addIncome:e,updateIncome:n,deleteIncome:i}}function CO(){const t=gi(),e=xt({mutationFn:async a=>{const{budgetId:l,year:c,month:h,amount:f,categoryId:p,accountId:_,date:v,payee:b,description:S,cleared:T}=a,C=It(l,c,h),{exists:j,data:z}=await Ae("months",C,"PRE-EDIT-READ");if(!j||!z)throw new Error("Month data not found in Firestore");const q=await ai(l,_,-f),U={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:f,category_id:p,account_id:_,date:v,created_at:new Date().toISOString()};b?.trim()&&(U.payee=b.trim()),S&&(U.description=S),T!==void 0&&(U.cleared=T);const Z=[...z.expenses||[],U];let J={...z,expenses:Z,total_expenses:Z.reduce((k,A)=>k+A.amount,0),updated_at:new Date().toISOString()};if(q){const k=Object.keys(q),A={};k.forEach(P=>{A[P]=q[P].balance});const{accountBalancesEnd:D}=Uo(J,k,A);J={...J,account_balances_end:D}}await kr(l,J);let ne=null;if(b?.trim()){const{data:k}=await Ae("payees",l,"checking payees");ne=await Fh(l,b,k?.payees||[])}return await Go(l,c,h),{updatedMonth:J,newExpense:U,updatedAccounts:q,updatedPayees:ne}},onMutate:async a=>{const{budgetId:l,year:c,month:h,amount:f,categoryId:p,accountId:_,date:v,payee:b,description:S,cleared:T}=a,{monthKey:C,budgetKey:j}=await Fo(t,l,c,h),{previousMonth:z,previousBudget:q}=qo(t,C,j);if(z){const U={id:`expense_optimistic_${Date.now()}`,amount:f,category_id:p,account_id:_,date:v,created_at:new Date().toISOString()};b?.trim()&&(U.payee=b.trim()),S&&(U.description=S),T!==void 0&&(U.cleared=T);const Z=[...z.month.expenses||[],U];t.setQueryData(C,{...z,month:{...z.month,expenses:Z,total_expenses:Z.reduce((J,ne)=>J+ne.amount,0)}})}return qh(t,j,q,_,-f),Ho(l,c,h),{previousMonth:z,previousBudget:q}},onSuccess:(a,l)=>{const{budgetId:c,year:h,month:f}=l;t.setQueryData(le.month(c,h,f),{month:a.updatedMonth}),Qo(t,c,a.updatedAccounts),a.updatedPayees&&t.setQueryData(le.payees(c),a.updatedPayees)},onError:(a,l,c)=>$o(t,l.budgetId,l.year,l.month,c)}),n=xt({mutationFn:async a=>{const{budgetId:l,year:c,month:h,expenseId:f,amount:p,categoryId:_,accountId:v,date:b,payee:S,description:T,cleared:C,oldAmount:j,oldAccountId:z}=a,q=It(l,c,h),{exists:U,data:Z}=await Ae("months",q,"PRE-EDIT-READ");if(!U||!Z)throw new Error("Month data not found in Firestore");let J=null;if(v!==z)await ai(l,z,j),J=await ai(l,v,-p);else if(p!==j)J=await ai(l,v,j-p);else{const{data:P}=await Ae("budgets",l,"reading accounts");P?.accounts&&(J=P.accounts)}const ne={id:f,amount:p,category_id:_,account_id:v,date:b,created_at:Z.expenses?.find(P=>P.id===f)?.created_at||new Date().toISOString()};S?.trim()&&(ne.payee=S.trim()),T&&(ne.description=T),C!==void 0&&(ne.cleared=C);const k=(Z.expenses||[]).map(P=>P.id===f?ne:P);let A={...Z,expenses:k,total_expenses:k.reduce((P,O)=>P+O.amount,0),updated_at:new Date().toISOString()};if(J){const P=Object.keys(J),O={};P.forEach(I=>{O[I]=J[I].balance});const{accountBalancesEnd:N}=Uo(A,P,O);A={...A,account_balances_end:N}}await kr(l,A);let D=null;if(S?.trim()){const{data:P}=await Ae("payees",l,"checking payees");D=await Fh(l,S,P?.payees||[])}return await Go(l,c,h),{updatedMonth:A,updatedAccounts:J,updatedPayees:D}},onMutate:async a=>{const{budgetId:l,year:c,month:h,expenseId:f,amount:p,categoryId:_,accountId:v,date:b,payee:S,description:T,cleared:C,oldAmount:j,oldAccountId:z}=a,{monthKey:q,budgetKey:U}=await Fo(t,l,c,h),{previousMonth:Z,previousBudget:J}=qo(t,q,U);if(Z){const ne={id:f,amount:p,category_id:_,account_id:v,date:b,created_at:Z.month.expenses?.find(A=>A.id===f)?.created_at||new Date().toISOString()};S?.trim()&&(ne.payee=S.trim()),T&&(ne.description=T),C!==void 0&&(ne.cleared=C);const k=(Z.month.expenses||[]).map(A=>A.id===f?ne:A);t.setQueryData(q,{...Z,month:{...Z.month,expenses:k,total_expenses:k.reduce((A,D)=>A+D.amount,0)}})}return m1(t,U,J,z,v,j,p,!1),Ho(l,c,h),{previousMonth:Z,previousBudget:J}},onSuccess:(a,l)=>{const{budgetId:c,year:h,month:f}=l;t.setQueryData(le.month(c,h,f),{month:a.updatedMonth}),Qo(t,c,a.updatedAccounts),a.updatedPayees&&t.setQueryData(le.payees(c),a.updatedPayees)},onError:(a,l,c)=>$o(t,l.budgetId,l.year,l.month,c)}),i=xt({mutationFn:async a=>{const{budgetId:l,year:c,month:h,expenseId:f,amount:p,accountId:_}=a,v=It(l,c,h),{exists:b,data:S}=await Ae("months",v,"PRE-EDIT-READ");if(!b||!S)throw new Error("Month data not found in Firestore");const T=await ai(l,_,p),C=(S.expenses||[]).filter(z=>z.id!==f);let j={...S,expenses:C,total_expenses:C.reduce((z,q)=>z+q.amount,0),updated_at:new Date().toISOString()};if(T){const z=Object.keys(T),q={};z.forEach(Z=>{q[Z]=T[Z].balance});const{accountBalancesEnd:U}=Uo(j,z,q);j={...j,account_balances_end:U}}return await kr(l,j),await Go(l,c,h),{updatedMonth:j,updatedAccounts:T}},onMutate:async a=>{const{budgetId:l,year:c,month:h,expenseId:f,amount:p,accountId:_}=a,{monthKey:v,budgetKey:b}=await Fo(t,l,c,h),{previousMonth:S,previousBudget:T}=qo(t,v,b);if(S){const C=(S.month.expenses||[]).filter(j=>j.id!==f);t.setQueryData(v,{...S,month:{...S.month,expenses:C,total_expenses:C.reduce((j,z)=>j+z.amount,0)}})}return qh(t,b,T,_,p),Ho(l,c,h),{previousMonth:S,previousBudget:T}},onSuccess:(a,l)=>{const{budgetId:c,year:h,month:f}=l;t.setQueryData(le.month(c,h,f),{month:a.updatedMonth}),Qo(t,c,a.updatedAccounts)},onError:(a,l,c)=>$o(t,l.budgetId,l.year,l.month,c)});return{addExpense:e,updateExpense:n,deleteExpense:i}}function RO(){const t=gi(),e=xt({mutationFn:async l=>{const{budgetId:c,year:h,month:f,allocations:p}=l,_=It(c,h,f),{exists:v,data:b}=await Ae("months",_,"PRE-EDIT-READ");if(!v||!b)throw new Error("Month data not found in Firestore");const S={...b,allocations:p,updated_at:new Date().toISOString()};return await kr(c,S,{skipNextMonthStale:!0}),{updatedMonth:S}},onMutate:async l=>{const{budgetId:c,year:h,month:f,allocations:p}=l,_=le.month(c,h,f);await t.cancelQueries({queryKey:_});const v=t.getQueryData(_);return v&&t.setQueryData(_,{...v,month:{...v.month,allocations:p}}),{previousMonth:v}},onSuccess:(l,c)=>{const{budgetId:h,year:f,month:p}=c;t.setQueryData(le.month(h,f,p),{month:l.updatedMonth})},onError:(l,c,h)=>{h?.previousMonth&&t.setQueryData(le.month(c.budgetId,c.year,c.month),h.previousMonth)}}),n=xt({mutationFn:async l=>{const{budgetId:c,year:h,month:f,allocations:p}=l,_=It(c,h,f),{exists:v,data:b}=await Ae("months",_,"PRE-EDIT-READ");if(!v||!b)throw new Error("Month data not found in Firestore");const S=b.category_balances?.map(j=>j.category_id)??Object.keys(b.previous_month_snapshot?.category_balances_end??{}),T=S.length>0?Qp(b,S,p,!0):b.category_balances,C={...b,allocations:p,allocations_finalized:!0,category_balances:T,category_balances_stale:!1,updated_at:new Date().toISOString()};return await kr(c,C),await mh(c),await yh(c,h,f),{updatedMonth:C}},onMutate:async l=>{const{budgetId:c,year:h,month:f,allocations:p}=l,_=le.month(c,h,f),v=le.budget(c);await t.cancelQueries({queryKey:_}),await t.cancelQueries({queryKey:v});const b=t.getQueryData(_),S=t.getQueryData(v);if(b&&t.setQueryData(_,{...b,month:{...b.month,allocations:p,allocations_finalized:!0}}),S){const T=b?.month?.allocations_finalized?b.month.allocations||[]:[],C={};for(const z of p)C[z.category_id]=(C[z.category_id]||0)+z.amount;for(const z of T)C[z.category_id]=(C[z.category_id]||0)-z.amount;const j={};Object.entries(S.categories).forEach(([z,q])=>{j[z]={...q,balance:q.balance+(C[z]||0)}}),t.setQueryData(v,{...S,categories:j,categoryBalancesSnapshot:S.categoryBalancesSnapshot?{...S.categoryBalancesSnapshot,is_stale:!0}:null})}return fh(c,h,f),ph(c,h,f),gh(c,h,f),{previousMonth:b,previousBudget:S}},onSuccess:(l,c)=>{const{budgetId:h,year:f,month:p}=c,_=le.month(h,f,p);t.setQueryData(_,{month:l.updatedMonth})},onError:(l,c,h)=>{h?.previousMonth&&t.setQueryData(le.month(c.budgetId,c.year,c.month),h.previousMonth),h?.previousBudget&&t.setQueryData(le.budget(c.budgetId),h.previousBudget)}}),i=xt({mutationFn:async l=>{const{budgetId:c,year:h,month:f}=l,p=It(c,h,f),{exists:_,data:v}=await Ae("months",p,"PRE-EDIT-READ");if(!_||!v)throw new Error("Month data not found in Firestore");const b=v.category_balances?.map(C=>C.category_id)??Object.keys(v.previous_month_snapshot?.category_balances_end??{}),S=b.length>0?Qp(v,b,v.allocations??[],!1):v.category_balances,T={...v,allocations_finalized:!1,category_balances:S,category_balances_stale:!1,updated_at:new Date().toISOString()};return await kr(c,T),await mh(c),await yh(c,h,f),{updatedMonth:T}},onMutate:async l=>{const{budgetId:c,year:h,month:f}=l,p=le.month(c,h,f),_=le.budget(c);await t.cancelQueries({queryKey:p}),await t.cancelQueries({queryKey:_});const v=t.getQueryData(p),b=t.getQueryData(_);if(v&&t.setQueryData(p,{...v,month:{...v.month,allocations_finalized:!1}}),b&&v?.month?.allocations_finalized){const S=v.month.allocations||[],T={};for(const j of S)T[j.category_id]=(T[j.category_id]||0)-j.amount;const C={};Object.entries(b.categories).forEach(([j,z])=>{C[j]={...z,balance:z.balance+(T[j]||0)}}),t.setQueryData(_,{...b,categories:C,categoryBalancesSnapshot:b.categoryBalancesSnapshot?{...b.categoryBalancesSnapshot,is_stale:!0}:null})}return fh(c,h,f),ph(c,h,f),gh(c,h,f),{previousMonth:v,previousBudget:b}},onSuccess:(l,c)=>{const{budgetId:h,year:f,month:p}=c;t.setQueryData(le.month(h,f,p),{month:l.updatedMonth})},onError:(l,c,h)=>{h?.previousMonth&&t.setQueryData(le.month(c.budgetId,c.year,c.month),h.previousMonth),h?.previousBudget&&t.setQueryData(le.budget(c.budgetId),h.previousBudget)}}),a=xt({mutationFn:async l=>{const{budgetId:c,year:h,month:f}=l,p=It(c,h,f),{exists:_,data:v}=await Ae("months",p,"PRE-EDIT-READ");if(!_||!v)throw new Error("Month data not found in Firestore");const b=v.category_balances?.map(C=>C.category_id)??Object.keys(v.previous_month_snapshot?.category_balances_end??{}),S=b.length>0?Qp(v,b,[],!1):v.category_balances,T={...v,allocations:[],allocations_finalized:!1,category_balances:S,category_balances_stale:!1,updated_at:new Date().toISOString()};return await kr(c,T),await mh(c),await yh(c,h,f),{updatedMonth:T}},onMutate:async l=>{const{budgetId:c,year:h,month:f}=l,p=le.month(c,h,f),_=le.budget(c);await t.cancelQueries({queryKey:p}),await t.cancelQueries({queryKey:_});const v=t.getQueryData(p),b=t.getQueryData(_);if(v&&t.setQueryData(p,{...v,month:{...v.month,allocations:[],allocations_finalized:!1}}),b&&v?.month?.allocations_finalized){const S=v.month.allocations||[],T={};for(const j of S)T[j.category_id]=(T[j.category_id]||0)-j.amount;const C={};Object.entries(b.categories).forEach(([j,z])=>{C[j]={...z,balance:z.balance+(T[j]||0)}}),t.setQueryData(_,{...b,categories:C,categoryBalancesSnapshot:b.categoryBalancesSnapshot?{...b.categoryBalancesSnapshot,is_stale:!0}:null})}return fh(c,h,f),ph(c,h,f),gh(c,h,f),{previousMonth:v,previousBudget:b}},onSuccess:(l,c)=>{const{budgetId:h,year:f,month:p}=c;t.setQueryData(le.month(h,f,p),{month:l.updatedMonth})},onError:(l,c,h)=>{h?.previousMonth&&t.setQueryData(le.month(c.budgetId,c.year,c.month),h.previousMonth),h?.previousBudget&&t.setQueryData(le.budget(c.budgetId),h.previousBudget)}});return{saveAllocations:e,finalizeAllocations:n,unfinalizeAllocations:i,deleteAllocations:a}}function DO(){const{addIncome:t,updateIncome:e,deleteIncome:n}=AO(),{addExpense:i,updateExpense:a,deleteExpense:l}=CO(),{saveAllocations:c,finalizeAllocations:h,unfinalizeAllocations:f,deleteAllocations:p}=RO();return{addIncome:t,updateIncome:e,deleteIncome:n,addExpense:i,updateExpense:a,deleteExpense:l,saveAllocations:c,finalizeAllocations:h,unfinalizeAllocations:f,deleteAllocations:p}}function IO(){const t=gi(),e=xt({mutationFn:async({name:h,userId:f,userEmail:p})=>{const _=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,v=new Date().toISOString(),b={name:h.trim()||"My Budget",user_ids:[f],accepted_user_ids:[f],owner_id:f,owner_email:p,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:v,updated_at:v};await Xe("budgets",_,b,"creating new budget document");const{exists:S,data:T}=await Ae("users",f,"reading user document to add new budget to their list");return S&&T?await Xe("users",f,{...T,budget_ids:[_,...T.budget_ids],updated_at:v},"adding new budget to user's budget list"):await Xe("users",f,{uid:f,email:p,budget_ids:[_],created_at:v,updated_at:v},"creating new user document with first budget"),{budgetId:_,budget:{id:_,...b}}},onSuccess:(h,{userId:f})=>{t.invalidateQueries({queryKey:le.user(f)}),t.invalidateQueries({queryKey:le.accessibleBudgets(f)})}}),n=xt({mutationFn:async({budgetId:h,userId:f})=>{const p=new Date().toISOString(),{exists:_,data:v}=await Ae("budgets",h,"verifying user was invited to this budget");if(!_||!v)throw new Error("Budget not found");if(!v.user_ids?.includes(f))throw new Error("You have not been invited to this budget");const{data:b}=await Ae("users",f,"PRE-EDIT-READ");if(b?.budget_ids?.includes(h))throw new Error("You have already accepted this invite");return await Xe("users",f,{...b||{uid:f,email:null},budget_ids:[h,...b?.budget_ids||[]],updated_at:p},"adding accepted budget to user's budget list"),await Xe("budgets",h,{...v,accepted_user_ids:[...v.accepted_user_ids||[],f]},"marking user as accepted in budget's accepted_user_ids"),{budgetId:h}},onSuccess:(h,{userId:f})=>{t.invalidateQueries({queryKey:le.user(f)}),t.invalidateQueries({queryKey:le.accessibleBudgets(f)}),t.invalidateQueries({queryKey:le.budget(h.budgetId)})}}),i=xt({mutationFn:async({budgetId:h,userId:f})=>{const{exists:p,data:_}=await Ae("budgets",h,"PRE-EDIT-READ");if(!p||!_)throw new Error("Budget not found");if(_.user_ids?.includes(f))throw new Error("User is already invited");return await Xe("budgets",h,{..._,user_ids:[..._.user_ids||[],f]},"adding user to budget's invited users list"),{budgetId:h}},onMutate:async({budgetId:h,userId:f})=>{await t.cancelQueries({queryKey:le.budget(h)});const p=t.getQueryData(le.budget(h));return p&&t.setQueryData(le.budget(h),{...p,budget:{...p.budget,user_ids:[...p.budget.user_ids,f]}}),{previousData:p}},onSuccess:(h,{budgetId:f})=>{const p=t.getQueryData(le.budget(f));p&&t.setQueryData(le.budget(f),p)},onError:(h,{budgetId:f},p)=>{p?.previousData&&t.setQueryData(le.budget(f),p.previousData)}}),a=xt({mutationFn:async({budgetId:h,userId:f})=>{const{exists:p,data:_}=await Ae("budgets",h,"PRE-EDIT-READ");if(!p||!_)throw new Error("Budget not found");return await Xe("budgets",h,{..._,user_ids:(_.user_ids||[]).filter(v=>v!==f),accepted_user_ids:(_.accepted_user_ids||[]).filter(v=>v!==f)},"removing user from budget's access lists"),{budgetId:h}},onMutate:async({budgetId:h,userId:f})=>{await t.cancelQueries({queryKey:le.budget(h)});const p=t.getQueryData(le.budget(h));return p&&t.setQueryData(le.budget(h),{...p,budget:{...p.budget,user_ids:p.budget.user_ids.filter(_=>_!==f),accepted_user_ids:p.budget.accepted_user_ids.filter(_=>_!==f)}}),{previousData:p}},onSuccess:(h,{budgetId:f})=>{const p=t.getQueryData(le.budget(f));p&&t.setQueryData(le.budget(f),p)},onError:(h,{budgetId:f},p)=>{p?.previousData&&t.setQueryData(le.budget(f),p.previousData)}}),l=xt({mutationFn:async({budgetId:h,userId:f})=>{const{exists:p,data:_}=await Ae("users",f,"PRE-EDIT-READ");if(!p||!_)throw new Error("User document not found");const v=[h,..._.budget_ids.filter(b=>b!==h)];return await Xe("users",f,{..._,budget_ids:v,updated_at:new Date().toISOString()},"reordering budget list to make selected budget active"),{budgetId:h}},onMutate:async({budgetId:h,userId:f})=>{await t.cancelQueries({queryKey:le.user(f)});const p=t.getQueryData(le.user(f));return p&&t.setQueryData(le.user(f),{...p,budget_ids:[h,...p.budget_ids.filter(_=>_!==h)]}),{previousData:p}},onSuccess:(h,{userId:f})=>{const p=t.getQueryData(le.user(f));p&&t.setQueryData(le.user(f),p)},onError:(h,{userId:f},p)=>{p?.previousData&&t.setQueryData(le.user(f),p.previousData)}}),c=xt({mutationFn:async({budgetId:h,userId:f,userBudgetIds:p})=>{const{exists:_,data:v}=await Ae("budgets",h,"checking if user has pending invite for this budget");return!_||!v||!v.user_ids?.includes(f)||p.includes(h)?null:{budgetId:h,budgetName:v.name,ownerEmail:v.owner_email||null}}});return{createBudget:e,acceptInvite:n,inviteUser:i,revokeUser:a,switchBudget:l,checkInvite:c}}function p1(){const t=gi(),e=xt({mutationFn:async({userId:a,userEmail:l,text:c,feedbackType:h,currentPath:f})=>{const p=l||a,_={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`${c}

(Submitted from: ${f})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:h},{exists:v}=await Ae("feedback",p,"checking if user has existing feedback document");return v?await Xe("feedback",p,{items:Vk(_),user_email:l,updated_at:new Date().toISOString()},"adding new feedback item to existing document",{merge:!0}):await Xe("feedback",p,{items:[_],user_email:l,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},"creating new feedback document for user"),{feedbackItem:_,docId:p}},onMutate:async({userId:a,userEmail:l,text:c,feedbackType:h,currentPath:f})=>{await t.cancelQueries({queryKey:le.feedback()});const p=t.getQueryData(le.feedback()),_=l||a,v={id:`feedback_optimistic_${Date.now()}`,text:`${c}

(Submitted from: ${f})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:h,doc_id:_,user_email:l};return t.setQueryData(le.feedback(),b=>b?{items:[...b.items,v]}:{items:[v]}),{previousData:p,optimisticItemId:v.id}},onSuccess:(a,l,c)=>{t.setQueryData(le.feedback(),h=>h&&{items:h.items.map(f=>f.id===c?.optimisticItemId?{...a.feedbackItem,doc_id:a.docId,user_email:l.userEmail}:f)})},onError:(a,l,c)=>{c?.previousData&&t.setQueryData(le.feedback(),c.previousData)}}),n=xt({mutationFn:async({item:a})=>{const{exists:l,data:c}=await Ae("feedback",a.doc_id,"PRE-EDIT-READ");if(!l||!c)throw new Error(`Feedback document not found: ${a.doc_id}`);const h=!a.is_done,f=h?new Date().toISOString():null,p=c.items||[];let _=!1;const v=p.map(b=>b.id===a.id?(_=!0,{...b,is_done:h,completed_at:f}):b);if(!_)throw console.error("[toggleFeedback] Item not found in document",{searchingFor:a.id,inDocument:a.doc_id,availableIds:p.map(b=>b.id)}),new Error(`Feedback item not found in document. Item ID: ${a.id}, Doc ID: ${a.doc_id}`);return await Xe("feedback",a.doc_id,{...c,items:v,updated_at:new Date().toISOString()},`marking feedback item as ${h?"done":"not done"}`),{itemId:a.id,isDone:h,completedAt:f}},onMutate:async({item:a})=>{await t.cancelQueries({queryKey:le.feedback()});const l=t.getQueryData(le.feedback()),c=!a.is_done,h=c?new Date().toISOString():null;return t.setQueryData(le.feedback(),f=>f&&{items:f.items.map(p=>p.id===a.id?{...p,is_done:c,completed_at:h}:p)}),{previousData:l}},onError:(a,l,c)=>{c?.previousData&&t.setQueryData(le.feedback(),c.previousData)}}),i=xt({mutationFn:async({docId:a,items:l})=>{const{exists:c,data:h}=await Ae("feedback",a,"PRE-EDIT-READ");if(!c||!h)throw new Error("Feedback document not found");return await Xe("feedback",a,{...h,items:l,updated_at:new Date().toISOString()},"saving reordered feedback items"),{docId:a,items:l}},onMutate:async({docId:a,items:l})=>{await t.cancelQueries({queryKey:le.feedback()});const c=t.getQueryData(le.feedback());return t.setQueryData(le.feedback(),h=>{if(!h)return h;const f=new Map;return l.forEach(p=>{f.set(p.id,p.sort_order)}),{items:h.items.map(p=>p.doc_id===a&&f.has(p.id)?{...p,sort_order:f.get(p.id)}:p)}}),{previousData:c}},onError:(a,l,c)=>{c?.previousData&&t.setQueryData(le.feedback(),c.previousData)}});return{submitFeedback:e,toggleFeedback:n,updateSortOrder:i}}async function jO(t,e){return Oe.fetchQuery({queryKey:["budgetInvite",t,e],queryFn:async()=>{const{exists:n,data:i}=await Ae("budgets",t,"checking if user has pending invite for budget");return!n||!i?null:{isInvited:i.user_ids?.includes(e)??!1,hasAccepted:i.accepted_user_ids?.includes(e)??!1,budgetName:i.name||"Unnamed Budget",ownerEmail:i.owner_email||null}},staleTime:60*1e3})}async function Ng(t,e,n){const i=It(t,e,n),a=Oe.getQueryData(le.month(t,e,n));if(a?.month)return{year:a.month.year,month:a.month.month,category_balances:a.month.category_balances,category_balances_stale:a.month.category_balances_stale,allocations_finalized:a.month.allocations_finalized,allocations:a.month.allocations,expenses:a.month.expenses};const{exists:l,data:c}=await Ae("months",i,`fetching month for balance calculation (not in cache, walking ${e}/${n})`);if(!l||!c)return null;const h=Sf(c,t,e,n);return Oe.setQueryData(le.month(t,e,n),{month:h}),{year:h.year,month:h.month,category_balances:h.category_balances,category_balances_stale:h.category_balances_stale,allocations_finalized:h.allocations_finalized,allocations:h.allocations,expenses:h.expenses}}function kO(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function OO(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}async function MO(t,e,n,i){const a={};e.forEach(b=>{a[b]=0});const l=await Ng(t,n,i);if(l?.category_balances&&!l.category_balances_stale){for(const b of l.category_balances)e.includes(b.category_id)&&(a[b.category_id]=b.end_balance);return a}const c={};e.forEach(b=>{c[b]=0});const h=[];l&&h.push(l);let f=n,p=i,_=!1;const v=120;for(let b=0;b<v&&!_;b++){const S=kO(f,p);f=S.year,p=S.month;const T=await Ng(t,f,p);if(!T)_=!0;else if(T.category_balances&&!T.category_balances_stale){_=!0;for(const C of T.category_balances)e.includes(C.category_id)&&(c[C.category_id]=C.end_balance)}else h.push(T)}h.reverse(),Object.assign(a,c);for(const b of h){if(b.allocations_finalized&&b.allocations)for(const S of b.allocations)e.includes(S.category_id)&&(a[S.category_id]=(a[S.category_id]||0)+S.amount);if(b.expenses)for(const S of b.expenses)e.includes(S.category_id)&&(a[S.category_id]=(a[S.category_id]||0)-S.amount)}return a}async function NO(t,e,n,i,a){const l={...n};let c=i,h=a;const f=24;for(let p=0;p<f;p++){const _=OO(c,h);c=_.year,h=_.month;const v=await Ng(t,c,h);if(!v)break;if(v.allocations_finalized&&v.allocations)for(const b of v.allocations)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)+b.amount);if(v.expenses)for(const b of v.expenses)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)-b.amount)}return l}async function $p(t,e,n,i,a){const l=await MO(t,e,n,i);let c;return a&&!a.is_stale&&a.computed_for_year===n&&a.computed_for_month===i?(c={},e.forEach(f=>{c[f]=a.balances[f]?.total??l[f]??0})):c=await NO(t,e,l,n,i),{current:l,total:c}}function g1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const PO=g1,y1=new lu("auth","Firebase",g1());const Hh=new ey("@firebase/auth");function LO(t,...e){Hh.logLevel<=tt.WARN&&Hh.warn(`Auth (${pl}): ${t}`,...e)}function _h(t,...e){Hh.logLevel<=tt.ERROR&&Hh.error(`Auth (${pl}): ${t}`,...e)}function Lr(t,...e){throw Vy(t,...e)}function di(t,...e){return Vy(t,...e)}function _1(t,e,n){const i={...PO(),[e]:n};return new lu("auth","Firebase",i).create(e,{appName:t.name})}function zs(t){return _1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vy(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return y1.create(t,...e)}function Le(t,e,...n){if(!t)throw Vy(e,...n)}function Li(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _h(e),new Error(e)}function Qi(t,e){t||Li(e)}function Pg(){return typeof self<"u"&&self.location?.href||""}function VO(){return dE()==="http:"||dE()==="https:"}function dE(){return typeof self<"u"&&self.location?.protocol||null}function BO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(VO()||KD()||"connection"in navigator)?navigator.onLine:!0}function zO(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class _u{constructor(e,n){this.shortDelay=e,this.longDelay=n,Qi(n>e,"Short delay should be less than long delay!"),this.isMobile=GD()||WD()}get(){return BO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function By(t,e){Qi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class v1{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Li("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Li("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Li("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const UO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const FO=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qO=new _u(3e4,6e4);function Ba(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Js(t,e,n,i,a={}){return b1(t,a,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const h=cu({key:t.config.apiKey,...c}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const p={method:e,headers:f,...l};return $D()||(p.referrerPolicy="no-referrer"),t.emulatorConfig&&ml(t.emulatorConfig.host)&&(p.credentials="include"),v1.fetch()(await x1(t,t.config.apiHost,n,h),p)})}async function b1(t,e,n){t._canInitEmulator=!1;const i={...UO,...e};try{const a=new GO(t),l=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw ih(t,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const h=l.ok?c.errorMessage:c.error.message,[f,p]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw ih(t,"credential-already-in-use",c);if(f==="EMAIL_EXISTS")throw ih(t,"email-already-in-use",c);if(f==="USER_DISABLED")throw ih(t,"user-disabled",c);const _=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw _1(t,_,p);Lr(t,_)}}catch(a){if(a instanceof $i)throw a;Lr(t,"network-request-failed",{message:String(a)})}}async function wf(t,e,n,i,a={}){const l=await Js(t,e,n,i,a);return"mfaPendingCredential"in l&&Lr(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function x1(t,e,n,i){const a=`${e}${n}?${i}`,l=t,c=l.config.emulator?By(t.config,a):`${t.config.apiScheme}://${a}`;return FO.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function HO(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GO{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(di(this.auth,"network-request-failed")),qO.get())})}}function ih(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=di(t,e,i);return a.customData._tokenResponse=n,a}function hE(t){return t!==void 0&&t.enterprise!==void 0}class QO{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return HO(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function $O(t,e){return Js(t,"GET","/v2/recaptchaConfig",Ba(t,e))}async function KO(t,e){return Js(t,"POST","/v1/accounts:delete",e)}async function Gh(t,e){return Js(t,"POST","/v1/accounts:lookup",e)}function Hc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function WO(t,e=!1){const n=hn(t),i=await n.getIdToken(e),a=zy(i);Le(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l?.sign_in_provider;return{claims:a,token:i,authTime:Hc(Kp(a.auth_time)),issuedAtTime:Hc(Kp(a.iat)),expirationTime:Hc(Kp(a.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Kp(t){return Number(t)*1e3}function zy(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return _h("JWT malformed, contained fewer than 3 sections"),null;try{const a=ES(n);return a?JSON.parse(a):(_h("Failed to decode base64 JWT payload"),null)}catch(a){return _h("Caught error parsing JWT payload as JSON",a?.toString()),null}}function fE(t){const e=zy(t);return Le(e,"internal-error"),Le(typeof e.exp<"u","internal-error"),Le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Zc(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof $i&&YO(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function YO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class XO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Lg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hc(this.lastLoginAt),this.creationTime=Hc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Qh(t){const e=t.auth,n=await t.getIdToken(),i=await Zc(t,Gh(e,{idToken:n}));Le(i?.users.length,e,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=a.providerUserInfo?.length?E1(a.providerUserInfo):[],c=ZO(t.providerData,l),h=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!c?.length,p=h?f:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Lg(a.createdAt,a.lastLoginAt),isAnonymous:p};Object.assign(t,_)}async function JO(t){const e=hn(t);await Qh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ZO(t,e){return[...t.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function E1(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function eM(t,e){const n=await b1(t,{},async()=>{const i=cu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,c=await x1(t,a,"/v1/token",`key=${l}`),h=await t._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:h,body:i};return t.emulatorConfig&&ml(t.emulatorConfig.host)&&(f.credentials="include"),v1.fetch()(c,f)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function tM(t,e){return Js(t,"POST","/v2/accounts:revokeToken",Ba(t,e))}class Ko{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Le(e.idToken,"internal-error"),Le(typeof e.idToken<"u","internal-error"),Le(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):fE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Le(e.length!==0,"internal-error");const n=fE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:a,expiresIn:l}=await eM(e,n);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:a,expirationTime:l}=n,c=new Ko;return i&&(Le(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),a&&(Le(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Le(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ko,this.toJSON())}_performRefresh(){return Li("not implemented")}}function Cs(t,e){Le(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Or{constructor({uid:e,auth:n,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new XO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Lg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await Zc(this,this.stsTokenManager.getToken(this.auth,e));return Le(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return WO(this,e)}reload(){return JO(this)}_assign(e){this!==e&&(Le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Or({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Qh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(jr(this.auth.app))return Promise.reject(zs(this.auth));const e=await this.getIdToken();return await Zc(this,KO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,a=n.email??void 0,l=n.phoneNumber??void 0,c=n.photoURL??void 0,h=n.tenantId??void 0,f=n._redirectEventId??void 0,p=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:v,emailVerified:b,isAnonymous:S,providerData:T,stsTokenManager:C}=n;Le(v&&C,e,"internal-error");const j=Ko.fromJSON(this.name,C);Le(typeof v=="string",e,"internal-error"),Cs(i,e.name),Cs(a,e.name),Le(typeof b=="boolean",e,"internal-error"),Le(typeof S=="boolean",e,"internal-error"),Cs(l,e.name),Cs(c,e.name),Cs(h,e.name),Cs(f,e.name),Cs(p,e.name),Cs(_,e.name);const z=new Or({uid:v,auth:e,email:a,emailVerified:b,displayName:i,isAnonymous:S,photoURL:c,phoneNumber:l,tenantId:h,stsTokenManager:j,createdAt:p,lastLoginAt:_});return T&&Array.isArray(T)&&(z.providerData=T.map(q=>({...q}))),f&&(z._redirectEventId=f),z}static async _fromIdTokenResponse(e,n,i=!1){const a=new Ko;a.updateFromServerResponse(n);const l=new Or({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Qh(l),l}static async _fromGetAccountInfoResponse(e,n,i){const a=n.users[0];Le(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?E1(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!l?.length,h=new Ko;h.updateFromIdToken(i);const f=new Or({uid:a.localId,auth:e,stsTokenManager:h,isAnonymous:c}),p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Lg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(f,p),f}}const mE=new Map;function Vi(t){Qi(t instanceof Function,"Expected a class definition");let e=mE.get(t);return e?(Qi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,mE.set(t,e),e)}class S1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}S1.type="NONE";const pE=S1;function vh(t,e,n){return`firebase:${t}:${e}:${n}`}class Wo{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=vh(this.userKey,a.apiKey,l),this.fullPersistenceKey=vh("persistence",a.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Gh(this.auth,{idToken:e}).catch(()=>{});return n?Or._fromGetAccountInfoResponse(this.auth,n,e):null}return Or._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Wo(Vi(pE),e,i);const a=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let l=a[0]||Vi(pE);const c=vh(i,e.config.apiKey,e.name);let h=null;for(const p of n)try{const _=await p._get(c);if(_){let v;if(typeof _=="string"){const b=await Gh(e,{idToken:_}).catch(()=>{});if(!b)break;v=await Or._fromGetAccountInfoResponse(e,b,_)}else v=Or._fromJSON(e,_);p!==l&&(h=v),l=p;break}}catch{}const f=a.filter(p=>p._shouldAllowMigration);return!l._shouldAllowMigration||!f.length?new Wo(l,e,i):(l=f[0],h&&await l._set(c,h.toJSON()),await Promise.all(n.map(async p=>{if(p!==l)try{await p._remove(c)}catch{}})),new Wo(l,e,i))}}function gE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(C1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(w1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(D1(e))return"Blackberry";if(I1(e))return"Webos";if(T1(e))return"Safari";if((e.includes("chrome/")||A1(e))&&!e.includes("edge/"))return"Chrome";if(R1(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function w1(t=Rn()){return/firefox\//i.test(t)}function T1(t=Rn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function A1(t=Rn()){return/crios\//i.test(t)}function C1(t=Rn()){return/iemobile/i.test(t)}function R1(t=Rn()){return/android/i.test(t)}function D1(t=Rn()){return/blackberry/i.test(t)}function I1(t=Rn()){return/webos/i.test(t)}function Uy(t=Rn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function nM(t=Rn()){return Uy(t)&&!!window.navigator?.standalone}function rM(){return YD()&&document.documentMode===10}function j1(t=Rn()){return Uy(t)||R1(t)||I1(t)||D1(t)||/windows phone/i.test(t)||C1(t)}function k1(t,e=[]){let n;switch(t){case"Browser":n=gE(Rn());break;case"Worker":n=`${gE(Rn())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${pl}/${i}`}class iM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=l=>new Promise((c,h)=>{try{const f=e(l);c(f)}catch(f){h(f)}});i.onAbort=n,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function sM(t,e={}){return Js(t,"GET","/v2/passwordPolicy",Ba(t,e))}const aM=6;class oM{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??aM,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class lM{constructor(e,n,i,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new yE(this),this.idTokenSubscription=new yE(this),this.beforeStateQueue=new iM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=y1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Vi(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Wo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Gh(this,{idToken:e}),i=await Or._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(jr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,c=i?._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===c)&&h?.user&&(i=h.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Qh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(jr(this.app))return Promise.reject(zs(this));const n=e?hn(e):null;return n&&Le(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return jr(this.app)?Promise.reject(zs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return jr(this.app)?Promise.reject(zs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await sM(this),n=new oM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lu("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await tM(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Vi(e)||this._popupRedirectResolver;Le(n,this,"argument-error"),this.redirectPersistenceManager=await Wo.create(this,[Vi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,a){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let c=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(h,this,"internal-error"),h.then(()=>{c||l(this.currentUser)}),typeof n=="function"){const f=e.addObserver(n,i,a);return()=>{c=!0,f()}}else{const f=e.addObserver(n);return()=>{c=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=k1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(jr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&LO(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Sl(t){return hn(t)}class yE{constructor(e){this.auth=e,this.observer=null,this.addObserver=iI(n=>this.observer=n)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Tf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cM(t){Tf=t}function O1(t){return Tf.loadJS(t)}function uM(){return Tf.recaptchaEnterpriseScript}function dM(){return Tf.gapiScript}function hM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class fM{constructor(){this.enterprise=new mM}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class mM{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const pM="recaptcha-enterprise",M1="NO_RECAPTCHA";class gM{constructor(e){this.type=pM,this.auth=Sl(e)}async verify(e="verify",n=!1){async function i(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,h)=>{$O(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new QO(f);return l.tenantId==null?l._agentRecaptchaConfig=p:l._tenantRecaptchaConfigs[l.tenantId]=p,c(p.siteKey)}}).catch(f=>{h(f)})})}function a(l,c,h){const f=window.grecaptcha;hE(f)?f.enterprise.ready(()=>{f.enterprise.execute(l,{action:e}).then(p=>{c(p)}).catch(()=>{c(M1)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new fM().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(h=>{if(!n&&hE(window.grecaptcha))a(h,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let f=uM();f.length!==0&&(f+=h),O1(f).then(()=>{a(h,l,c)}).catch(p=>{c(p)})}}).catch(h=>{c(h)})})}}async function _E(t,e,n,i=!1,a=!1){const l=new gM(t);let c;if(a)c=M1;else try{c=await l.verify(n)}catch{c=await l.verify(n,!0)}const h={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const f=h.phoneEnrollmentInfo.phoneNumber,p=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const f=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return i?Object.assign(h,{captchaResp:c}):Object.assign(h,{captchaResponse:c}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function vE(t,e,n,i,a){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await _E(t,e,n,n==="getOobCode");return i(t,l)}else return i(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await _E(t,e,n,n==="getOobCode");return i(t,c)}else return Promise.reject(l)})}function yM(t,e){const n=ny(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),l=n.getOptions();if(qs(l,e??{}))return a;Lr(a,"already-initialized")}return n.initialize({options:e})}function _M(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(Vi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function vM(t,e,n){const i=Sl(t);Le(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=N1(e),{host:c,port:h}=bM(e),f=h===null?"":`:${h}`,p={url:`${l}//${c}${f}/`},_=Object.freeze({host:c,port:h,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Le(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Le(qs(p,i.config.emulator)&&qs(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,ml(c)?(AS(`${l}//${c}${f}`),CS("Auth",!0)):xM()}function N1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function bM(t){const e=N1(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:bE(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:bE(c)}}}function bE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function xM(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Fy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Li("not implemented")}_getIdTokenResponse(e){return Li("not implemented")}_linkToIdToken(e,n){return Li("not implemented")}_getReauthenticationResolver(e){return Li("not implemented")}}async function EM(t,e){return Js(t,"POST","/v1/accounts:signUp",e)}async function SM(t,e){return wf(t,"POST","/v1/accounts:signInWithPassword",Ba(t,e))}async function wM(t,e){return wf(t,"POST","/v1/accounts:signInWithEmailLink",Ba(t,e))}async function TM(t,e){return wf(t,"POST","/v1/accounts:signInWithEmailLink",Ba(t,e))}class eu extends Fy{constructor(e,n,i,a=null){super("password",i),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new eu(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new eu(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return vE(e,n,"signInWithPassword",SM);case"emailLink":return wM(e,{email:this._email,oobCode:this._password});default:Lr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return vE(e,i,"signUpPassword",EM);case"emailLink":return TM(e,{idToken:n,email:this._email,oobCode:this._password});default:Lr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Yo(t,e){return wf(t,"POST","/v1/accounts:signInWithIdp",Ba(t,e))}const AM="http://localhost";class Pa extends Fy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Pa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Lr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=n;if(!i||!a)return null;const c=new Pa(i,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const n=this.buildRequest();return Yo(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,Yo(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Yo(e,n)}buildRequest(){const e={requestUri:AM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=cu(n)}return e}}function CM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function RM(t){const e=Oc(Mc(t)).link,n=e?Oc(Mc(e)).deep_link_id:null,i=Oc(Mc(t)).deep_link_id;return(i?Oc(Mc(i)).link:null)||i||n||e||t}class qy{constructor(e){const n=Oc(Mc(e)),i=n.apiKey??null,a=n.oobCode??null,l=CM(n.mode??null);Le(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=RM(e);try{return new qy(n)}catch{return null}}}class wl{constructor(){this.providerId=wl.PROVIDER_ID}static credential(e,n){return eu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=qy.parseLink(n);return Le(i,"argument-error"),eu._fromEmailAndCode(e,i.code,i.tenantId)}}wl.PROVIDER_ID="password";wl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";wl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class P1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class vu extends P1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ds extends vu{constructor(){super("facebook.com")}static credential(e){return Pa._fromParams({providerId:Ds.PROVIDER_ID,signInMethod:Ds.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ds.credentialFromTaggedObject(e)}static credentialFromError(e){return Ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ds.credential(e.oauthAccessToken)}catch{return null}}}Ds.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ds.PROVIDER_ID="facebook.com";class Is extends vu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Pa._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return Is.credential(n,i)}catch{return null}}}Is.GOOGLE_SIGN_IN_METHOD="google.com";Is.PROVIDER_ID="google.com";class js extends vu{constructor(){super("github.com")}static credential(e){return Pa._fromParams({providerId:js.PROVIDER_ID,signInMethod:js.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return js.credentialFromTaggedObject(e)}static credentialFromError(e){return js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return js.credential(e.oauthAccessToken)}catch{return null}}}js.GITHUB_SIGN_IN_METHOD="github.com";js.PROVIDER_ID="github.com";class ks extends vu{constructor(){super("twitter.com")}static credential(e,n){return Pa._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return ks.credential(n,i)}catch{return null}}}ks.TWITTER_SIGN_IN_METHOD="twitter.com";ks.PROVIDER_ID="twitter.com";class al{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,a=!1){const l=await Or._fromIdTokenResponse(e,i,a),c=xE(i);return new al({user:l,providerId:c,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const a=xE(i);return new al({user:e,providerId:a,_tokenResponse:i,operationType:n})}}function xE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class $h extends $i{constructor(e,n,i,a){super(n.code,n.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,$h.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,a){return new $h(e,n,i,a)}}function L1(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?$h._fromErrorAndOperation(t,l,e,i):l})}async function DM(t,e,n=!1){const i=await Zc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return al._forOperation(t,"link",i)}async function IM(t,e,n=!1){const{auth:i}=t;if(jr(i.app))return Promise.reject(zs(i));const a="reauthenticate";try{const l=await Zc(t,L1(i,a,e,t),n);Le(l.idToken,i,"internal-error");const c=zy(l.idToken);Le(c,i,"internal-error");const{sub:h}=c;return Le(t.uid===h,i,"user-mismatch"),al._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Lr(i,"user-mismatch"),l}}async function V1(t,e,n=!1){if(jr(t.app))return Promise.reject(zs(t));const i="signIn",a=await L1(t,i,e),l=await al._fromIdTokenResponse(t,i,a);return n||await t._updateCurrentUser(l.user),l}async function jM(t,e){return V1(Sl(t),e)}async function kM(t){const e=Sl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function OM(t,e,n){return jr(t.app)?Promise.reject(zs(t)):jM(hn(t),wl.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&kM(t),i})}function MM(t,e,n,i){return hn(t).onIdTokenChanged(e,n,i)}function NM(t,e,n){return hn(t).beforeAuthStateChanged(e,n)}function PM(t,e,n,i){return hn(t).onAuthStateChanged(e,n,i)}function LM(t){return hn(t).signOut()}const Kh="__sak";class B1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Kh,"1"),this.storage.removeItem(Kh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const VM=1e3,BM=10;class z1 extends B1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=j1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),a=this.localCache[n];i!==a&&e(n,a,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((c,h,f)=>{this.notifyListeners(c,f)});return}const i=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(i);!n&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);rM()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,BM):a()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},VM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}z1.type="LOCAL";const zM=z1;class U1 extends B1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}U1.type="SESSION";const F1=U1;function UM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class Af{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const i=new Af(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:a,data:l}=n.data,c=this.handlersMap[a];if(!c?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const h=Array.from(c).map(async p=>p(n.origin,l)),f=await UM(h);n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:f})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Af.receivers=[];function Hy(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class FM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((h,f)=>{const p=Hy("",20);a.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},i);c={messageChannel:a,onMessage(v){const b=v;if(b.data.eventId===p)switch(b.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),h(b.data.response);break;default:clearTimeout(_),clearTimeout(l),f(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:n},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function hi(){return window}function qM(t){hi().location.href=t}function q1(){return typeof hi().WorkerGlobalScope<"u"&&typeof hi().importScripts=="function"}async function HM(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GM(){return navigator?.serviceWorker?.controller||null}function QM(){return q1()?self:null}const H1="firebaseLocalStorageDb",$M=1,Wh="firebaseLocalStorage",G1="fbase_key";class bu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Cf(t,e){return t.transaction([Wh],e?"readwrite":"readonly").objectStore(Wh)}function KM(){const t=indexedDB.deleteDatabase(H1);return new bu(t).toPromise()}function Vg(){const t=indexedDB.open(H1,$M);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Wh,{keyPath:G1})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Wh)?e(i):(i.close(),await KM(),e(await Vg()))})})}async function EE(t,e,n){const i=Cf(t,!0).put({[G1]:e,value:n});return new bu(i).toPromise()}async function WM(t,e){const n=Cf(t,!1).get(e),i=await new bu(n).toPromise();return i===void 0?null:i.value}function SE(t,e){const n=Cf(t,!0).delete(e);return new bu(n).toPromise()}const YM=800,XM=3;class Q1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>XM)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return q1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Af._getInstance(QM()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await HM(),!this.activeServiceWorker)return;this.sender=new FM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||GM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vg();return await EE(e,Kh,"1"),await SE(e,Kh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>EE(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>WM(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>SE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Cf(a,!1).getAll();return new bu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Q1.type="LOCAL";const JM=Q1;new _u(3e4,6e4);function ZM(t,e){return e?Vi(e):(Le(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Gy extends Fy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Yo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Yo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function eN(t){return V1(t.auth,new Gy(t),t.bypassAuthState)}function tN(t){const{auth:e,user:n}=t;return Le(n,e,"internal-error"),IM(n,new Gy(t),t.bypassAuthState)}async function nN(t){const{auth:e,user:n}=t;return Le(n,e,"internal-error"),DM(n,new Gy(t),t.bypassAuthState)}class $1{constructor(e,n,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:a,tenantId:l,error:c,type:h}=e;if(c){this.reject(c);return}const f={auth:this.auth,requestUri:n,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eN;case"linkViaPopup":case"linkViaRedirect":return nN;case"reauthViaPopup":case"reauthViaRedirect":return tN;default:Lr(this.auth,"internal-error")}}resolve(e){Qi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const rN=new _u(2e3,1e4);class Vo extends $1{constructor(e,n,i,a,l){super(e,n,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Vo.currentPopupAction&&Vo.currentPopupAction.cancel(),Vo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Le(e,this.auth,"internal-error"),e}async onExecution(){Qi(this.filter.length===1,"Popup operations only handle one event");const e=Hy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(di(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(di(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(di(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rN.get())};e()}}Vo.currentPopupAction=null;const iN="pendingRedirect",bh=new Map;class sN extends $1{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=bh.get(this.auth._key());if(!e){try{const i=await aN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}bh.set(this.auth._key(),e)}return this.bypassAuthState||bh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aN(t,e){const n=cN(e),i=lN(t);if(!await i._isAvailable())return!1;const a=await i._get(n)==="true";return await i._remove(n),a}function oN(t,e){bh.set(t._key(),e)}function lN(t){return Vi(t._redirectPersistence)}function cN(t){return vh(iN,t.config.apiKey,t.name)}async function uN(t,e,n=!1){if(jr(t.app))return Promise.reject(zs(t));const i=Sl(t),a=ZM(i,e),c=await new sN(i,a,n).execute();return c&&!n&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}const dN=600*1e3;class hN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!fN(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!K1(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(di(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=dN&&this.cachedEventUids.clear(),this.cachedEventUids.has(wE(e))}saveEventToCache(e){this.cachedEventUids.add(wE(e)),this.lastProcessedEventTime=Date.now()}}function wE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function K1({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function fN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return K1(t);default:return!1}}async function mN(t,e={}){return Js(t,"GET","/v1/projects",e)}const pN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,gN=/^https?/;async function yN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await mN(t);for(const n of e)try{if(_N(n))return}catch{}Lr(t,"unauthorized-domain")}function _N(t){const e=Pg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&c.hostname===i}if(!gN.test(n))return!1;if(pN.test(t))return i===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const vN=new _u(3e4,6e4);function TE(){const t=hi().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function bN(t){return new Promise((e,n)=>{function i(){TE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{TE(),n(di(t,"network-request-failed"))},timeout:vN.get()})}if(hi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(hi().gapi?.load)i();else{const a=hM("iframefcb");return hi()[a]=()=>{gapi.load?i():n(di(t,"network-request-failed"))},O1(`${dM()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw xh=null,e})}let xh=null;function xN(t){return xh=xh||bN(t),xh}const EN=new _u(5e3,15e3),SN="__/auth/iframe",wN="emulator/auth/iframe",TN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},AN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function CN(t){const e=t.config;Le(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?By(e,wN):`https://${t.config.authDomain}/${SN}`,i={apiKey:e.apiKey,appName:t.name,v:pl},a=AN.get(t.config.apiHost);a&&(i.eid=a);const l=t._getFrameworks();return l.length&&(i.fw=l.join(",")),`${n}?${cu(i).slice(1)}`}async function RN(t){const e=await xN(t),n=hi().gapi;return Le(n,t,"internal-error"),e.open({where:document.body,url:CN(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:TN,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const c=di(t,"network-request-failed"),h=hi().setTimeout(()=>{l(c)},EN.get());function f(){hi().clearTimeout(h),a(i)}i.ping(f).then(f,()=>{l(c)})}))}const DN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},IN=500,jN=600,kN="_blank",ON="http://localhost";class AE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function MN(t,e,n,i=IN,a=jN){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const f={...DN,width:i.toString(),height:a.toString(),top:l,left:c},p=Rn().toLowerCase();n&&(h=A1(p)?kN:n),w1(p)&&(e=e||ON,f.scrollbars="yes");const _=Object.entries(f).reduce((b,[S,T])=>`${b}${S}=${T},`,"");if(nM(p)&&h!=="_self")return NN(e||"",h),new AE(null);const v=window.open(e||"",h,_);Le(v,t,"popup-blocked");try{v.focus()}catch{}return new AE(v)}function NN(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const PN="__/auth/handler",LN="emulator/auth/handler",VN=encodeURIComponent("fac");async function CE(t,e,n,i,a,l){Le(t.config.authDomain,t,"auth-domain-config-required"),Le(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:pl,eventId:a};if(e instanceof P1){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",rI(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))c[_]=v}if(e instanceof vu){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(c.scopes=_.join(","))}t.tenantId&&(c.tid=t.tenantId);const h=c;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const f=await t._getAppCheckToken(),p=f?`#${VN}=${encodeURIComponent(f)}`:"";return`${BN(t)}?${cu(h).slice(1)}${p}`}function BN({config:t}){return t.emulator?By(t,LN):`https://${t.authDomain}/${PN}`}const Wp="webStorageSupport";class zN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=F1,this._completeRedirectFn=uN,this._overrideRedirectResult=oN}async _openPopup(e,n,i,a){Qi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await CE(e,n,i,Pg(),a);return MN(e,l,Hy())}async _openRedirect(e,n,i,a){await this._originValidation(e);const l=await CE(e,n,i,Pg(),a);return qM(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:l}=this.eventManagers[n];return a?Promise.resolve(a):(Qi(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await RN(e),i=new hN(e);return n.register("authEvent",a=>(Le(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Wp,{type:Wp},a=>{const l=a?.[0]?.[Wp];l!==void 0&&n(!!l),Lr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=yN(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return j1()||T1()||Uy()}}const UN=zN;var RE="@firebase/auth",DE="1.12.0";class FN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function qN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HN(t){Jo(new Oa("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:h}=i.options;Le(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:c,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:k1(t)},p=new lM(i,a,l,f);return _M(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Jo(new Oa("auth-internal",e=>{const n=Sl(e.getProvider("auth").getImmediate());return(i=>new FN(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ls(RE,DE,qN(t)),Ls(RE,DE,"esm2020")}const GN=300,QN=TS("authIdTokenMaxAge")||GN;let IE=null;const $N=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>QN)return;const a=n?.token;IE!==a&&(IE=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function KN(t=jS()){const e=ny(t,"auth");if(e.isInitialized())return e.getImmediate();const n=yM(t,{popupRedirectResolver:UN,persistence:[JM,zM,F1]}),i=TS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=$N(l.toString());NM(n,c,()=>c(n.currentUser)),MM(n,h=>c(h))}}const a=SS("auth");return a&&vM(n,`http://${a}`),n}function WN(){return document.getElementsByTagName("head")?.[0]??document}cM({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=a=>{const l=di("internal-error");l.customData=a,n(l)},i.type="text/javascript",i.charset="UTF-8",WN().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HN("Browser");function za(){const t=KN(d1);async function e(){return!1}async function n(h,f){return OM(t,h,f)}function i(){return LM(t)}function a(h){PM(t,f=>{h(f)})}function l(){return t.currentUser}return{set_user_listener:a,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:i,get_current_firebase_user:l}}const YN={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,lastActiveTab:"balances",lastSettingsTab:"categories",lastAdminTab:"budget",lastBalancesView:"categories",setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},setLastActiveTab:()=>{},setLastSettingsTab:()=>{},setLastAdminTab:()=>{},setLastBalancesView:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},W1=R.createContext(YN);function XN({children:t}){const n=za().get_current_firebase_user(),[i,a]=R.useState(null),[l,c]=R.useState(new Date().getFullYear()),[h,f]=R.useState(new Date().getMonth()+1),[p,_]=R.useState("balances"),[v,b]=R.useState("categories"),[S,T]=R.useState("budget"),[C,j]=R.useState("categories"),[z,q]=R.useState(!1),[U,Z]=R.useState(!1),J=lO(n?.uid||null,n?.email||null),ne=J.data&&J.data.budget_ids.length===0,k=uO(n?.uid||null,J.data||null,{enabled:!!n?.uid&&!!J.data&&ne}),A=J.data?.permission_flags?.is_admin===!0,D=J.data?.permission_flags?.is_test===!0,P=k.data?.pendingInvites||[],O=k.data?.budgets||[],N=P.length>0;R.useEffect(()=>{if(!n||z||J.isLoading)return;const X=J.data;if(!(!X&&!J.isError))if(X&&X.budget_ids.length>0)a(X.budget_ids[0]),Z(!1),q(!0);else{if(k.isLoading)return;const V=k.data;V?.pendingInvites&&V.pendingInvites.length>0?Z(!1):Z(!0),q(!0)}},[n,z,J.data,J.isLoading,J.isError,k.data,k.isLoading]);const I=R.useCallback(()=>{f(X=>X===1?(c(V=>V-1),12):X-1)},[]),K=R.useCallback(()=>{f(X=>X===12?(c(V=>V+1),1):X+1)},[]),F=R.useCallback(async()=>{await k.refetch()},[k]),L=R.useCallback(X=>{a(X)},[]),$=R.useCallback(async X=>{if(!n)return null;try{const V=await jO(X,n.uid);return V&&V.isInvited&&!V.hasAccepted?{budgetId:X,budgetName:V.budgetName,ownerEmail:V.ownerEmail}:null}catch(V){return console.error("[BudgetContext] Error checking budget invite:",V),null}},[n]),Y=R.useCallback(()=>{Oe.clear(),localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),Q={currentUserId:n?.uid||null,selectedBudgetId:i,currentYear:l,currentMonthNumber:h,lastActiveTab:p,lastSettingsTab:v,lastAdminTab:S,lastBalancesView:C,setSelectedBudgetId:a,setCurrentYear:c,setCurrentMonthNumber:f,setLastActiveTab:_,setLastSettingsTab:b,setLastAdminTab:T,setLastBalancesView:j,isInitialized:z,needsFirstBudget:U,goToPreviousMonth:I,goToNextMonth:K,pendingInvites:P,hasPendingInvites:N,accessibleBudgets:O,isAdmin:A,isTest:D,loadAccessibleBudgets:F,switchToBudget:L,checkBudgetInvite:$,clearCache:Y};return d.jsx(W1.Provider,{value:Q,children:t})}function Sn(){const t=R.useContext(W1);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}const Bi={mobile:640,wide:1200},JN=Bi.mobile,Qy=["January","February","March","April","May","June","July","August","September","October","November","December"],fe={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15"},qn={maxWidth:"var(--page-max-width, 85rem)",margin:"0 auto",padding:"var(--page-padding, 2rem)"},xu={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},ZN={...xu,padding:"0.6rem 0.875rem",gap:"0.5rem"},e6={background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1rem 1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},t6={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},n6={display:"flex",flexDirection:"column",gap:"0.5rem"},r6={fontSize:"0.9rem",fontWeight:500},Ua={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit"},i6={...Ua,cursor:"pointer"},$y={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},Y1={...$y,background:fe.primary,color:"white",border:"none"},s6={...Y1,padding:"0.75rem 1.5rem",borderRadius:"8px"},a6={...$y,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},o6={...$y,background:"transparent",border:`1px solid ${fe.errorBorder}`,color:fe.error},l6={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},c6={display:"flex",gap:"0.5rem"},u6={display:"flex",gap:"0.25rem"},X1={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},d6={...X1,borderColor:fe.errorBorder,color:fe.error},ol={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},Ky={display:"flex",flexDirection:"column",gap:"2px"},h6={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},J1={opacity:.4,cursor:"grab"},Z1={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:fe.primary,borderRadius:"2px",transition:"opacity 0.15s"},f6={position:"relative",height:"2rem",marginTop:"-0.25rem"},m6={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:fe.primary,borderRadius:"2px",transition:"opacity 0.15s"},p6={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},g6={background:fe.errorBg,border:`1px solid ${fe.errorBorder}`,color:fe.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},y6={background:"transparent",border:"none",color:fe.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},tu={opacity:.7,marginBottom:"1.5rem"},Tl={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},Wy={fontWeight:500,fontSize:"1.1rem"},ll={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function _6(){return d.jsxs("div",{style:qn,children:[d.jsx("nav",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:d.jsx(kt,{to:"/",style:{display:"flex",alignItems:"center"},title:"Tarron Lane Home",children:d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane Home",style:{width:"2rem",height:"2rem"}})})}),d.jsx("h1",{children:"Tarron Lane Homepage"}),d.jsx("nav",{children:d.jsxs("ul",{children:[d.jsx("li",{children:d.jsx(kt,{to:"/sql-test",children:"SQL Test"})}),d.jsx("li",{children:d.jsx(kt,{to:"/budget",children:"Budget"})}),d.jsx("li",{children:d.jsx(kt,{to:"/account",children:"Account"})})]})})]})}function Xo({children:t}){return d.jsx("div",{style:qn,children:t})}function Al({message:t,children:e,onDismiss:n,style:i}){return d.jsxs("div",{style:{...g6,...i},children:[d.jsx("span",{children:e??t}),n&&d.jsx("button",{onClick:n,style:y6,children:""})]})}const v6={primary:Y1,"primary-large":s6,secondary:a6,danger:o6,small:l6};function Be({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:i,disabled:a,style:l,...c}){const h=v6[t],f=a||e;return d.jsx("button",{disabled:f,style:{...h,cursor:f?"not-allowed":"pointer",opacity:f?.7:1,...l},...c,children:e?n:i})}function Bg(t,e){const n=t.toLowerCase(),i=e.toLowerCase();if(i.includes(n)){const h=i.indexOf(n);return{match:!0,score:h===0||/\s/.test(i[h-1])?100:90}}let a=0,l=0,c=0;for(let h=0;h<i.length&&a<n.length;h++)i[h]===n[a]?(a++,c++,l+=c*2):c=0;return a===n.length?{match:!0,score:l}:{match:!1,score:0}}function Yp({id:t,value:e,onChange:n,payees:i,placeholder:a="Enter payee name"}){const[l,c]=R.useState(!1),[h,f]=R.useState(-1),p=R.useRef(null),_=R.useRef(null),v=e.trim()?i.map(T=>({payee:T,...Bg(e,T)})).filter(T=>T.match).sort((T,C)=>C.score-T.score).slice(0,8).map(T=>T.payee):[];R.useEffect(()=>{function T(C){p.current&&!p.current.contains(C.target)&&c(!1)}return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[]);function b(T){!l||v.length===0||(T.key==="ArrowDown"?(T.preventDefault(),f(C=>Math.min(C+1,v.length-1))):T.key==="ArrowUp"?(T.preventDefault(),f(C=>Math.max(C-1,-1))):T.key==="Enter"&&h>=0?(T.preventDefault(),n(v[h]),c(!1),f(-1)):T.key==="Escape"&&(c(!1),f(-1)))}function S(T){n(T),c(!1),f(-1),_.current?.focus()}return d.jsxs("div",{ref:p,style:{position:"relative"},children:[d.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:T=>{n(T.target.value),c(!0),f(-1)},onFocus:()=>c(!0),onKeyDown:b,placeholder:a,autoComplete:"off",style:Ua}),l&&v.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:v.map((T,C)=>d.jsx("div",{onClick:()=>S(T),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:C===h?`color-mix(in srgb, ${fe.primary} 20%, transparent)`:"transparent",borderBottom:C<v.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>f(C),children:T},T))})]})}function b6({id:t,value:e,onChange:n,categories:i,categoryGroups:a,placeholder:l="Search categories...",required:c}){const h=Object.fromEntries(a.map(N=>[N.id,N.name])),f=Object.entries(i).map(([N,I])=>({id:N,name:I.name,groupId:I.category_group_id,groupName:I.category_group_id&&h[I.category_group_id]||null,sortOrder:I.sort_order})),_=(e?i[e]:null)?.name||"",[v,b]=R.useState(_),[S,T]=R.useState(!1),[C,j]=R.useState(-1),z=R.useRef(null),q=R.useRef(null);R.useEffect(()=>{const N=e?i[e]:null;b(N?.name||"")},[e,i]);const U=v.trim()?f.map(N=>({...N,...Bg(v,N.name),groupMatch:N.groupName?Bg(v,N.groupName):{match:!1,score:0}})).filter(N=>N.match||N.groupMatch.match).sort((N,I)=>{const K=Math.max(N.score,N.groupMatch.score*.5),F=Math.max(I.score,I.groupMatch.score*.5);if(F!==K)return F-K;if(N.groupId!==I.groupId){if(!N.groupId)return 1;if(!I.groupId)return-1;const L=(N.groupName||"").localeCompare(I.groupName||"");return L!==0?L:N.groupId.localeCompare(I.groupId)}return N.sortOrder-I.sortOrder}).slice(0,10):[...f].sort((N,I)=>{if(N.groupId!==I.groupId){if(!N.groupId)return 1;if(!I.groupId)return-1;const K=(N.groupName||"").localeCompare(I.groupName||"");return K!==0?K:N.groupId.localeCompare(I.groupId)}return N.sortOrder-I.sortOrder}).slice(0,10);R.useEffect(()=>{function N(I){if(z.current&&!z.current.contains(I.target)){T(!1);const K=e?i[e]:null;b(K?.name||"")}}return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[e,i]);function Z(N){if(N.key==="ArrowDown")N.preventDefault(),S?j(I=>Math.min(I+1,U.length-1)):(T(!0),j(0));else if(N.key==="ArrowUp")N.preventDefault(),j(I=>Math.max(I-1,0));else if(N.key==="Enter")N.preventDefault(),S&&C>=0&&U[C]&&J(U[C]);else if(N.key==="Escape"){T(!1),j(-1);const I=e?i[e]:null;b(I?.name||"")}else if(N.key==="Tab"&&S&&U.length>0){const I=C>=0?C:0;J(U[I])}}function J(N){n(N.id),b(N.name),T(!1),j(-1),q.current?.focus()}function ne(N){const I=N.target.value;b(I),T(!0),j(-1),I!==_&&n("")}function k(){T(!0),U.length>0&&j(0)}const A=[];let D="__initial__";U.forEach(N=>{N.groupId!==D&&(D=N.groupId,A.push({groupId:N.groupId,groupName:N.groupName,items:[]})),A[A.length-1].items.push(N)});let P=-1;const O=()=>++P;return d.jsxs("div",{ref:z,style:{position:"relative"},children:[d.jsx("input",{ref:q,id:t,type:"text",value:v,onChange:ne,onFocus:k,onKeyDown:Z,placeholder:l,autoComplete:"off",required:c,style:{...Ua,borderColor:c&&!e?fe.error:void 0}}),S&&U.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"250px",overflowY:"auto"},children:A.map(N=>d.jsxs("div",{children:[N.groupName&&d.jsx("div",{style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6,background:"color-mix(in srgb, currentColor 5%, transparent)",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:N.groupName}),N.items.map(I=>{const K=O();return d.jsx("div",{onClick:()=>J(I),style:{padding:"0.6rem 0.8rem",paddingLeft:N.groupName?"1.2rem":"0.8rem",cursor:"pointer",background:K===C?`color-mix(in srgb, ${fe.primary} 20%, transparent)`:"transparent",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",transition:"background 0.1s"},onMouseEnter:()=>j(K),children:I.name},I.id)})]},N.groupId||"ungrouped"))}),S&&U.length===0&&v.trim()&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,padding:"0.6rem 0.8rem",opacity:.6,fontStyle:"italic"},children:"No matching categories"})]})}function Us({children:t,onSubmit:e}){return d.jsx("form",{onSubmit:e,style:t6,children:t})}function Tt({label:t,htmlFor:e,children:n,hint:i}){return d.jsxs("div",{style:n6,children:[d.jsx("label",{htmlFor:e,style:r6,children:t}),n,i&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:i})]})}function Fs(t){return d.jsx("input",{style:Ua,...t})}function x6(t){if(!t)return"";try{return new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return t}}function Xp({value:t,onChange:e,style:n,...i}){const a=R.useRef(null),l=x6(t);function c(){a.current?.showPicker?.()}return d.jsxs("div",{style:{position:"relative"},children:[d.jsx("input",{ref:a,type:"date",value:t||"",onChange:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,cursor:"pointer"},...i}),d.jsx("div",{onClick:c,style:{...Ua,cursor:"pointer",display:"flex",alignItems:"center",fontSize:"0.85rem",fontFamily:"monospace",color:t?"inherit":"color-mix(in srgb, currentColor 50%, transparent)",...n},children:l||"Select date"})]})}function nu({children:t,...e}){return d.jsx("select",{style:i6,...e,children:t})}function Yy({minHeight:t="6rem",style:e,...n}){return d.jsx("textarea",{style:{...Ua,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function Fa({children:t}){return d.jsx("div",{style:h6,children:t})}function Jp(t){const n=t.replace(/[^\d.]/g,"").split("."),i=n[0]||"",a=n[1],l=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return a!==void 0?`$${l}.${a.slice(0,2)}`:l?`$${l}`:""}function E6(t){return t.replace(/[$,]/g,"")}function Eh({id:t,value:e,onChange:n,placeholder:i="$0.00",required:a,autoFocus:l}){const[c,h]=R.useState(()=>Jp(e)),f=R.useRef(null);R.useEffect(()=>{const _=Jp(e);E6(c)!==e&&h(_)},[e]);function p(_){const v=_.target.value;if(!v||v==="$"){h(""),n("");return}const S=v.replace(/[^\d.]/g,"").split(".");let T=S[0];S.length>1&&(T+="."+S.slice(1).join("").slice(0,2));const C=Jp(T);h(C),n(T)}return d.jsx("input",{ref:f,id:t,type:"text",inputMode:"decimal",value:c,onChange:p,placeholder:i,required:a,autoFocus:l,style:Ua})}function Ki(t=JN){const[e,n]=R.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return R.useEffect(()=>{function i(){n(window.innerWidth<t)}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[t]),e}function Rf({children:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:h,onEdit:f,onDelete:p,onMoveUp:_,onMoveDown:v,canMoveUp:b=!0,canMoveDown:S=!0}){const T=Ki(),C=_||v;return d.jsxs("div",{onDragOver:j=>{j.stopPropagation(),a(j)},onDragLeave:j=>{j.stopPropagation(),l()},onDrop:j=>{j.stopPropagation(),h(j)},style:{position:"relative"},children:[d.jsx("div",{style:{...Z1,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{style:{...T?ZN:xu,opacity:e?.5:1},children:[d.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:T?"0.5rem":"0.75rem",minWidth:0},children:[d.jsx("span",{draggable:!0,onDragStart:i,onDragEnd:c,style:{...J1,fontSize:T?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),d.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),d.jsxs("div",{style:T?u6:c6,children:[T?d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:f,style:X1,title:"Edit","aria-label":"Edit",children:""}),d.jsx("button",{onClick:p,style:d6,title:"Delete","aria-label":"Delete",children:""})]}):d.jsxs(d.Fragment,{children:[d.jsx(Be,{variant:"secondary",onClick:f,children:"Edit"}),d.jsx(Be,{variant:"danger",onClick:p,children:"Delete"})]}),C&&d.jsxs("div",{style:Ky,children:[d.jsx("button",{onClick:j=>{j.stopPropagation(),_?.()},disabled:!b,style:{...ol,opacity:b?.6:.2,cursor:b?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:j=>{j.stopPropagation(),v?.()},disabled:!S,style:{...ol,opacity:S?.6:.2,cursor:S?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function Xy({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i,label:a="Move to end"}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:f6,children:[d.jsx("div",{style:{...m6,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:p6,children:a})]})}function kc({children:t,style:e}){return d.jsx("div",{style:{...e6,...e},children:t})}function S6({items:t}){const e=Ki(),n=a=>e?[1,3,4,2][a]:a+1,i=a=>{if(e)switch(a){case 0:return{borderRight:!0,borderBottom:!0};case 3:return{borderRight:!1,borderBottom:!0};case 1:return{borderRight:!0,borderBottom:!1};case 2:return{borderRight:!1,borderBottom:!1};default:return{borderRight:!1,borderBottom:!1}}else return{borderRight:a<3,borderBottom:!1}};return d.jsx("div",{style:{display:"grid",gridTemplateColumns:e?"1fr 1fr":"repeat(4, 1fr)",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",marginBottom:"1.5rem",overflow:"hidden"},children:t.map((a,l)=>{const c=i(l);return d.jsxs("div",{style:{padding:"0.75rem 1rem",borderRight:c.borderRight?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",borderBottom:c.borderBottom?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center",order:n(l)},children:[d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:a.label}),d.jsx("div",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600},children:a.value}),a.subtitle&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.65rem",opacity:.5},children:a.subtitle}),a.action&&d.jsx("div",{style:{marginTop:"0.25rem"},children:a.action})]},l)})})}function ke(t){return`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function qt(t){return t>=0?fe.success:fe.danger}function ru({isOpen:t,onClose:e,title:n,children:i,width:a="28rem"}){return t?d.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:e,children:d.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:a,maxWidth:"calc(100vw - 2rem)",flexShrink:0,boxSizing:"border-box",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:l=>l.stopPropagation(),children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[d.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),d.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),i]})}):null}const w6=2e3,T6={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function A6(){const[t,e]=R.useState(!1),[n,i]=R.useState(""),[a,l]=R.useState("bug"),[c,h]=R.useState(!1),f=R.useContext(ou),_=za().get_current_firebase_user(),v=kn(),b=p1();if(R.useEffect(()=>{if(c){const C=setTimeout(()=>h(!1),w6);return()=>clearTimeout(C)}},[c]),v.pathname.includes("/admin/feedback")||!f.is_logged_in)return null;function T(C){C.preventDefault(),!(!n.trim()||!f.username||!_)&&(b.submitFeedback.mutate({userId:_.uid,userEmail:f.username,text:n.trim(),feedbackType:a,currentPath:v.pathname}),i(""),l("bug"),e(!1),h(!0))}return d.jsxs(d.Fragment,{children:[c&&d.jsxs("div",{style:{position:"fixed",bottom:"5rem",right:"1.5rem",background:"rgba(46, 213, 115, 0.95)",color:"white",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1001,display:"flex",alignItems:"center",gap:"0.5rem",animation:"fadeInUp 0.2s ease-out"},children:[d.jsx("span",{children:""}),d.jsx("span",{children:"Feedback submitted!"})]}),d.jsx("button",{onClick:()=>e(!0),style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:fe.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:C=>{C.currentTarget.style.transform="scale(1.1)",C.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:C=>{C.currentTarget.style.transform="scale(1)",C.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),d.jsx(ru,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:d.jsxs("form",{onSubmit:T,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(C=>{const j=T6[C],z=a===C;return d.jsxs("button",{type:"button",onClick:()=>l(C),style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${j.color}`,borderRadius:"0.5rem",background:z?j.bgColor:"transparent",color:z?j.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:z?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:z?1:.5,boxShadow:z?`0 0 12px ${j.bgColor}`:"none",position:"relative"},children:[j.label,z&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},C)})}),d.jsx(Yy,{value:n,onChange:C=>i(C.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),d.jsxs(Fa,{children:[d.jsx(Be,{type:"button",variant:"secondary",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),d.jsx(Be,{type:"submit",disabled:!n.trim(),children:"Submit"})]})]})})]})}function Rs({children:t,labelStyle:e,...n}){return d.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[d.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:fe.primary},...n}),t]})}function C6({title:t,count:e,children:n,defaultExpanded:i=!1}){const[a,l]=R.useState(i);return d.jsxs("div",{style:{marginTop:"2rem"},children:[d.jsxs("button",{onClick:()=>l(!a),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[d.jsx("span",{style:{transition:"transform 0.2s",transform:a?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),a&&n]})}const R6=t=>{switch(t){case 2:return 220;case 3:return 320;case 4:return 420;case 5:return 520;case 6:return 620;default:return t*100+20}},D6=t=>t<=4?2:t<=6?3:Math.ceil(t/2);function Jy(t){const{tabs:e,activeTab:n}=t,i=e.filter(v=>!v.hidden),a=i.length,l=R6(a),c=D6(a),h=Math.floor(100/c),f=`tab-nav-${a}`,p=v=>({flex:"1 1 0",padding:"0.6rem 0.5rem",border:"none",borderRadius:0,background:"transparent",cursor:"pointer",fontWeight:v?600:400,fontSize:"0.9rem",color:"inherit",opacity:v?1:.5,transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem",position:"relative",boxSizing:"border-box",outline:"none"}),_=(v,b)=>d.jsxs(d.Fragment,{children:[d.jsx("span",{children:v.label}),v.checkmark&&d.jsx("span",{style:{color:fe.success,fontWeight:600},children:""}),b&&d.jsx("span",{style:{position:"absolute",bottom:"-1px",left:"15%",right:"15%",height:"3px",background:"white",borderRadius:"2px"}})]});return d.jsxs(d.Fragment,{children:[d.jsx("style",{children:`
        .${f} {
          display: flex;
          flex-wrap: wrap;
          margin-bottom: 1.5rem;
          border-bottom: 1px solid color-mix(in srgb, currentColor 15%, transparent);
        }
        .${f} > button,
        .${f} > a {
          border: none !important;
          border-radius: 0 !important;
          outline: none !important;
        }
        .${f} > button:hover,
        .${f} > button:focus,
        .${f} > a:hover,
        .${f} > a:focus {
          border: none !important;
          border-color: transparent !important;
        }
        @media (max-width: ${l}px) {
          .${f} > * {
            flex: 1 1 ${h}% !important;
            min-width: ${h}% !important;
          }
        }
      `}),d.jsx("div",{className:f,children:i.map(v=>{const b=n===v.id;return t.mode==="link"?d.jsx(kt,{to:`${t.linkPrefix}/${v.id}`,style:p(b),children:_(v,b)},v.id):d.jsx("button",{onClick:()=>t.onTabChange(v.id),style:p(b),children:_(v,b)},v.id)})})]})}function Zy({items:t}){const[e,n]=R.useState(!1),i=R.useRef(null),l=kn().pathname;R.useEffect(()=>{function h(f){i.current&&!i.current.contains(f.target)&&n(!1)}if(e)return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[e]),R.useEffect(()=>{function h(f){f.key==="Escape"&&n(!1)}if(e)return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[e]);const c=t.filter(h=>h.hidden?!1:h.to?h.to==="/budget"?!(l==="/budget"||/^\/budget\/\d{4}\/\d{1,2}\/\w+$/.test(l)):h.to==="/account"||h.to==="/"?l!==h.to:!l.startsWith(h.to):!0);return d.jsxs("div",{ref:i,style:{position:"relative"},children:[d.jsx("button",{onClick:()=>n(!e),style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:e?"color-mix(in srgb, currentColor 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:"none",cursor:"pointer",fontSize:"1.25rem",color:"inherit",transition:"background 0.15s",lineHeight:1},title:"Menu","aria-expanded":e,"aria-haspopup":"true",children:""}),e&&d.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",minWidth:"180px",background:"#1a1a2e",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",zIndex:1e3,overflow:"hidden"},children:c.map((h,f)=>{if(h.divider)return d.jsx("div",{style:{height:"1px",background:"color-mix(in srgb, currentColor 15%, transparent)",margin:"0.25rem 0"}},f);const p=d.jsxs(d.Fragment,{children:[h.icon&&d.jsx("span",{style:{width:"1.5rem",textAlign:"center"},children:h.icon}),d.jsx("span",{children:h.label})]}),_={display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",fontSize:"0.95rem",color:"inherit",textDecoration:"none",cursor:"pointer",transition:"background 0.15s",background:"transparent",border:"none",width:"100%",textAlign:"left"},v={background:"color-mix(in srgb, currentColor 10%, transparent)"};return h.to?d.jsx(kt,{to:h.to,style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",onClick:()=>n(!1),children:p},f):d.jsx("button",{onClick:()=>{h.onClick?.(),n(!1)},style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",children:p},f)})})]})}function fi({title:t,showBackArrow:e=!1,hideMenu:n=!1}){const{isAdmin:i}=Sn(),a=[{label:"Budget",icon:"",to:"/budget"},{label:"Budget Settings",icon:"",to:"/budget/settings"},{label:"Analytics",icon:"",to:"/budget/analytics"},...i?[{label:"Admin",icon:"",to:"/budget/admin"}]:[],{label:"Switch Budgets",icon:"",to:"/budget/my-budgets"},{divider:!0,label:""},{label:"Exit Budget App",icon:"",to:"/"}];return d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{children:e?d.jsx(kt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none"},title:"Back to Home",children:""}):d.jsx(kt,{to:"/budget",title:"Budget Home",children:d.jsx("img",{src:"/budget-icon.svg",alt:"Budget",style:{width:"1.5rem",height:"1.5rem"}})})}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem",textAlign:"center"},children:t}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:!n&&d.jsx(Zy,{items:a})})]})}function I6({children:t,style:e}){return d.jsx("div",{style:{width:"100%",maxWidth:"var(--content-max-width, 900px)",marginLeft:"auto",marginRight:"auto",...e},children:t})}function e_({label:t,value:e,action:n,inlineAction:i,compact:a}){const l=Ki();return a?d.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("span",{style:{display:"flex",alignItems:"baseline",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsxs("h3",{style:{margin:0,fontSize:"1.1rem"},children:[t,":"]}),d.jsx("span",{style:{fontSize:"1.1rem",fontWeight:600},children:e})]}),n]}),i]}):d.jsxs("div",{style:{display:"flex",flexDirection:l?"column":"row",justifyContent:"space-between",alignItems:l?"stretch":"center",gap:l?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("div",{children:[d.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:t}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0.25rem 0 0 0"},children:[d.jsx("span",{style:{fontSize:"1.25rem",fontWeight:600},children:e}),i]})]}),n]})}function j6({isVisible:t,message:e="Loading..."}){return t?d.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999,gap:"1rem"},children:[d.jsx("div",{style:{width:"3rem",height:"3rem",border:"3px solid rgba(255, 255, 255, 0.2)",borderTopColor:fe.primary,borderRadius:"50%",animation:"loadingOverlaySpin 0.8s linear infinite"}}),d.jsx("p",{style:{color:"white",fontSize:"1.1rem",fontWeight:500},children:e}),d.jsx("style",{children:`
        @keyframes loadingOverlaySpin {
          to { transform: rotate(360deg); }
        }
      `})]}):null}function zg(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function k6(){return d.jsxs("div",{style:qn,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(kt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(kt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"SQL Test"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(Zy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"SQL Test"}),d.jsx("h2",{children:"Setup"}),d.jsxs("h3",{children:["1. Open up your preferred web browser to ",d.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),d.jsxs("ul",{children:[d.jsx("li",{children:"This is a basic online sql query editor"}),d.jsxs("li",{children:["It will include three tables: ",d.jsx("b",{children:'"Customer"'}),", ",d.jsx("b",{children:'"Orders"'}),", and ",d.jsx("b",{children:'"Shippings"'})]})]}),d.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),d.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:d.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),d.jsx("h2",{children:"SQL Problems"}),d.jsx("p",{children:"Write queries in the online editor to answer these questions."}),d.jsx("h3",{children:"Question #1"}),d.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),d.jsx("h3",{children:"Question #2"}),d.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function O6(){const t=R.useContext(ou),e=za(),[n,i]=R.useState(!1),a=kn(),l=su(),c=a.state?.from||"/";R.useEffect(()=>{t.is_logged_in&&c!=="/"&&l(c,{replace:!0})},[t.is_logged_in,c,l]);function h(){i(!0),e.logout_firebase_user().then(function(){i(!1)})}return d.jsxs("div",{style:qn,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(kt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(kt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"Account"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(Zy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"Account"}),t.is_logged_in?n?d.jsx("p",{children:"Logging Out..."}):d.jsxs(d.Fragment,{children:[d.jsxs("p",{children:["You are logged in as ",t.username]}),d.jsx("button",{onClick:h,style:{marginTop:"1rem"},children:"Logout"})]}):d.jsx(M6,{})]})}function M6(){const t=za(),[e,n]=R.useState(""),[i,a]=R.useState(""),[l,c]=R.useState(!1),[h,f]=R.useState("");function p(b){n(b.target.value)}function _(b){a(b.target.value)}function v(b){b.preventDefault(),c(!0),f(""),t.login_firebase_user(e,i).then(function(){}).catch(function(){f("Incorrect login credentials")}).finally(function(){c(!1)})}return d.jsxs("form",{onSubmit:v,children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"username",children:"Email: "}),d.jsx("input",{id:"username",type:"email",value:e,onChange:p})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",children:"Password: "}),d.jsx("input",{id:"password",type:"password",value:i,onChange:_})]}),l?d.jsx("p",{children:"Logging in..."}):d.jsx("button",{children:"Login"}),h&&d.jsx("p",{style:{color:"red"},children:h})]})}function N6(){const[t,e]=R.useState(()=>typeof window>"u"?1200:window.innerWidth);return R.useEffect(()=>{function n(){e(window.innerWidth)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),{width:t,isWide:t>=Bi.wide,isMedium:t>=Bi.mobile&&t<Bi.wide,isMobile:t<Bi.mobile}}function Hn(t,e){const n=Zk(t),i=yO(),a=IO(),l=n.data,c=l?.budget||null,h=R.useMemo(()=>l?.accounts||{},[l?.accounts]),f=R.useMemo(()=>l?.accountGroups||{},[l?.accountGroups]),p=R.useMemo(()=>l?.categories||{},[l?.categories]),_=R.useMemo(()=>l?.categoryGroups||[],[l?.categoryGroups]),v=l?.categoryBalancesSnapshot||null,b=c?.owner_id===e,S=R.useMemo(()=>c?.user_ids||[],[c?.user_ids]),T=R.useMemo(()=>c?.accepted_user_ids||[],[c?.accepted_user_ids]),C=R.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.updateAccounts.mutateAsync({budgetId:t,accounts:Q})},[t,i.updateAccounts]),j=R.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.updateAccountGroups.mutateAsync({budgetId:t,accountGroups:Q})},[t,i.updateAccountGroups]),z=R.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.updateCategories.mutateAsync({budgetId:t,categories:Q})},[t,i.updateCategories]),q=R.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.updateCategoryGroups.mutateAsync({budgetId:t,categoryGroups:Q})},[t,i.updateCategoryGroups]),U=R.useCallback(async(Q,X)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.updateAccounts.mutateAsync({budgetId:t,accounts:Q}),i.updateAccountGroups.mutateAsync({budgetId:t,accountGroups:X})])},[t,i]),Z=R.useCallback(async(Q,X)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.updateCategories.mutateAsync({budgetId:t,categories:Q}),i.updateCategoryGroups.mutateAsync({budgetId:t,categoryGroups:X})])},[t,i]),J=R.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.renameBudget.mutateAsync({budgetId:t,newName:Q})},[t,i.renameBudget]),ne=R.useCallback(async Q=>{if(!e)throw new Error("Not authenticated");return await a.createBudget.mutateAsync({name:Q.trim()||"My Budget",userId:e,userEmail:null})},[e,a.createBudget]),k=R.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await a.inviteUser.mutateAsync({budgetId:t,userId:Q})},[t,a.inviteUser]),A=R.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await a.revokeUser.mutateAsync({budgetId:t,userId:Q})},[t,a.revokeUser]),D=R.useCallback(async Q=>{if(!e)throw new Error("Not authenticated");await a.acceptInvite.mutateAsync({budgetId:Q,userId:e})},[e,a.acceptInvite]),P=R.useCallback(async(Q,X,V)=>{if(!t)throw new Error("No budget selected");await i.saveCategoryBalancesSnapshot.mutateAsync({budgetId:t,balances:Q,year:X,month:V})},[t,i.saveCategoryBalancesSnapshot]),O=R.useCallback(async(Q,X,V,H)=>{if(!t)throw new Error("No budget selected");await i.recalculateCategoryBalances.mutateAsync({budgetId:t,categories:Q,balances:X,year:V,month:H})},[t,i.recalculateCategoryBalances]),N=R.useCallback(Q=>{if(!t)return;const X=Oe.getQueryData(le.budget(t));X&&Oe.setQueryData(le.budget(t),{...X,accounts:Q})},[t]),I=R.useCallback(Q=>{if(!t)return;const X=Oe.getQueryData(le.budget(t));X&&Oe.setQueryData(le.budget(t),{...X,accountGroups:Q})},[t]),K=R.useCallback(Q=>{if(!t)return;const X=Oe.getQueryData(le.budget(t));X&&Oe.setQueryData(le.budget(t),{...X,categories:Q})},[t]),F=R.useCallback(Q=>{if(!t)return;const X=Oe.getQueryData(le.budget(t));X&&Oe.setQueryData(le.budget(t),{...X,categoryGroups:Q})},[t]),L=R.useCallback(Q=>{if(!t)return;const X=Oe.getQueryData(le.budget(t));X&&Oe.setQueryData(le.budget(t),{...X,categoryBalancesSnapshot:Q})},[t]),$=R.useCallback(async()=>{t&&await Oe.invalidateQueries({queryKey:le.budget(t)})},[t]),Y=R.useCallback(()=>Object.entries(h).filter(([,Q])=>{const X=Q.account_group_id?f[Q.account_group_id]:void 0,V=X?.on_budget!==void 0?X.on_budget:Q.on_budget!==!1,H=X?.is_active!==void 0?X.is_active:Q.is_active!==!1;return V&&H}).reduce((Q,[,X])=>Q+X.balance,0),[h,f]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:c,accounts:h,accountGroups:f,categories:p,categoryGroups:_,categoryBalancesSnapshot:v,isOwner:b,budgetUserIds:S,acceptedUserIds:T,saveAccounts:C,saveAccountGroups:j,saveCategories:z,saveCategoryGroups:q,saveAccountsAndGroups:U,saveCategoriesAndGroups:Z,renameBudget:J,createBudget:ne,inviteUser:k,revokeUser:A,acceptInvite:D,saveCategoryBalancesSnapshot:P,recalculateCategoryBalances:O,setAccountsOptimistic:N,setAccountGroupsOptimistic:I,setCategoriesOptimistic:K,setCategoryGroupsOptimistic:F,setCategoryBalancesSnapshotOptimistic:L,refreshBudget:$,getOnBudgetTotal:Y}}function Cl(t,e,n){const i=iO(t,e,n,{enabled:!!t}),a=aO(t,{enabled:!!t}),l=DO(),c=i.data?.month||null,h=c?.income||[],f=c?.expenses||[],p=c?.allocations||[],_=c?.category_balances||[],v=c?.total_income||0,b=c?.total_expenses||0,S=c?.allocations_finalized||!1,T=R.useMemo(()=>{if(c?.previous_month_snapshot?.total_income!==void 0)return c.previous_month_snapshot.total_income;if(!t)return 0;let O=e,N=n-1;return N<1&&(N=12,O-=1),Oe.getQueryData(le.month(t,O,N))?.month?.total_income||0},[c,t,e,n]),C=a.data||[],j=R.useCallback(async(O,N,I,K,F)=>{if(!t)throw new Error("No budget selected");const[L,$]=I.split("-").map(Number);await l.addIncome.mutateAsync({budgetId:t,year:L,month:$,amount:O,accountId:N,date:I,payee:K,description:F})},[t,l.addIncome]),z=R.useCallback(async(O,N,I,K,F,L)=>{if(!t||!c)throw new Error("No budget or month loaded");const $=c.income.find(Y=>Y.id===O);if(!$)throw new Error("Income not found");await l.updateIncome.mutateAsync({budgetId:t,year:e,month:n,incomeId:O,amount:N,accountId:I,date:K,payee:F,description:L,oldAmount:$.amount,oldAccountId:$.account_id})},[t,c,e,n,l.updateIncome]),q=R.useCallback(async O=>{if(!t||!c)throw new Error("No budget or month loaded");const N=c.income.find(I=>I.id===O);if(!N)throw new Error("Income not found");await l.deleteIncome.mutateAsync({budgetId:t,year:e,month:n,incomeId:O,amount:N.amount,accountId:N.account_id})},[t,c,e,n,l.deleteIncome]),U=R.useCallback(async(O,N,I,K,F,L,$)=>{if(!t)throw new Error("No budget selected");const[Y,Q]=K.split("-").map(Number);await l.addExpense.mutateAsync({budgetId:t,year:Y,month:Q,amount:O,categoryId:N,accountId:I,date:K,payee:F,description:L,cleared:$})},[t,l.addExpense]),Z=R.useCallback(async(O,N,I,K,F,L,$,Y)=>{if(!t||!c)throw new Error("No budget or month loaded");const Q=c.expenses?.find(X=>X.id===O);if(!Q)throw new Error("Expense not found");await l.updateExpense.mutateAsync({budgetId:t,year:e,month:n,expenseId:O,amount:N,categoryId:I,accountId:K,date:F,payee:L,description:$,cleared:Y,oldAmount:Q.amount,oldAccountId:Q.account_id})},[t,c,e,n,l.updateExpense]),J=R.useCallback(async O=>{if(!t||!c)throw new Error("No budget or month loaded");const N=c.expenses?.find(I=>I.id===O);if(!N)throw new Error("Expense not found");await l.deleteExpense.mutateAsync({budgetId:t,year:e,month:n,expenseId:O,amount:N.amount,accountId:N.account_id})},[t,c,e,n,l.deleteExpense]),ne=R.useCallback(async O=>{if(!t)throw new Error("No budget selected");await l.saveAllocations.mutateAsync({budgetId:t,year:e,month:n,allocations:O})},[t,e,n,l.saveAllocations]),k=R.useCallback(async O=>{if(!t)throw new Error("No budget selected");await l.finalizeAllocations.mutateAsync({budgetId:t,year:e,month:n,allocations:O})},[t,e,n,l.finalizeAllocations]),A=R.useCallback(async()=>{if(!t)throw new Error("No budget selected");await l.unfinalizeAllocations.mutateAsync({budgetId:t,year:e,month:n})},[t,e,n,l.unfinalizeAllocations]),D=R.useCallback(async()=>{if(!t)throw new Error("No budget selected");await l.deleteAllocations.mutateAsync({budgetId:t,year:e,month:n})},[t,e,n,l.deleteAllocations]),P=R.useCallback(async()=>{t&&await Oe.invalidateQueries({queryKey:le.month(t,e,n)})},[t,e,n]);return{isLoading:i.isLoading,isFetching:i.isFetching,error:i.error,month:c,income:h,expenses:f,allocations:p,categoryBalances:_,totalIncome:v,totalExpenses:b,allocationsFinalized:S,previousMonthIncome:T,payees:C,payeesLoading:a.isLoading,addIncome:j,updateIncome:z,deleteIncome:q,addExpense:U,updateExpense:Z,deleteExpense:J,saveAllocations:ne,finalizeAllocations:k,unfinalizeAllocations:A,deleteAllocations:D,refreshMonth:P}}function P6(){const{selectedBudgetId:t,currentUserId:e}=Sn(),{budget:n,accounts:i,accountGroups:a,saveAccounts:l,saveAccountGroups:c,saveAccountsAndGroups:h,setAccountsOptimistic:f,setAccountGroupsOptimistic:p}=Hn(t,e),[_,v]=R.useState(null),b=R.useMemo(()=>Object.entries(i).reduce((A,[D,P])=>{const O=P.account_group_id||"ungrouped";return A[O]||(A[O]=[]),A[O].push({...P,id:D}),A},{}),[i]),S=R.useMemo(()=>Object.entries(a).sort(([,A],[,D])=>A.sort_order-D.sort_order).map(([A,D])=>({...D,id:A})),[a]),T=R.useCallback((A,D)=>{if(!n)return;const P=Object.values(i).filter(F=>D==="ungrouped"?!F.account_group_id:F.account_group_id===D),O=P.length>0?Math.max(...P.map(F=>F.sort_order)):-1,N=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,I={nickname:A.nickname,balance:0,account_group_id:D==="ungrouped"?null:D,sort_order:O+1,is_income_account:A.is_income_account,is_income_default:A.is_income_default,is_outgo_account:A.is_outgo_account,is_outgo_default:A.is_outgo_default,on_budget:A.on_budget!==!1,is_active:A.is_active!==!1},K={...i};A.is_income_default&&Object.keys(K).forEach(F=>{K[F]={...K[F],is_income_default:!1}}),A.is_outgo_default&&Object.keys(K).forEach(F=>{K[F]={...K[F],is_outgo_default:!1}}),K[N]=I,f(K),l(K).catch(F=>{console.error("[useAccountHandlers] Error creating account:",F),v(F instanceof Error?F.message:"Failed to create account.")})},[n,i,f,l]),C=R.useCallback((A,D)=>{if(!n)return;const P=i[A];if(!P)return;const O=P.account_group_id||"ungrouped",N=D.account_group_id;let I=P.sort_order;if(O!==(N||"ungrouped")){const F=Object.values(i).filter(L=>(L.account_group_id||"ungrouped")===(N||"ungrouped"));I=F.length>0?Math.max(...F.map(L=>L.sort_order))+1:0}const K={};Object.entries(i).forEach(([F,L])=>{F===A?K[F]={...L,nickname:D.nickname,account_group_id:N,sort_order:I,is_income_account:D.is_income_account,is_income_default:D.is_income_default,is_outgo_account:D.is_outgo_account,is_outgo_default:D.is_outgo_default,on_budget:D.on_budget!==!1,is_active:D.is_active!==!1}:(K[F]={...L},D.is_income_default&&!P.is_income_default&&(K[F].is_income_default=!1),D.is_outgo_default&&!P.is_outgo_default&&(K[F].is_outgo_default=!1))}),f(K),l(K).catch(F=>{console.error("[useAccountHandlers] Error saving account:",F),v(F instanceof Error?F.message:"Failed to save account.")})},[n,i,f,l]),j=R.useCallback(A=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[A]:D,...P}=i;f(P),l(P).catch(O=>{console.error("[useAccountHandlers] Error deleting account:",O),v(O instanceof Error?O.message:"Failed to delete account.")})},[n,i,f,l]),z=R.useCallback(async(A,D)=>{const P=i[A];if(!P)return;const O=P.account_group_id||"ungrouped",N=Object.entries(i).filter(([,Y])=>(Y.account_group_id||"ungrouped")===O).sort(([,Y],[,Q])=>Y.sort_order-Q.sort_order),I=N.findIndex(([Y])=>Y===A),K=D==="up"?I-1:I+1;if(K<0||K>=N.length)return;const[F,L]=N[K],$={};if(Object.entries(i).forEach(([Y,Q])=>{Y===A?$[Y]={...Q,sort_order:L.sort_order}:Y===F?$[Y]={...Q,sort_order:P.sort_order}:$[Y]={...Q}}),f($),!!n)try{await l($)}catch(Y){f(i),v(Y instanceof Error?Y.message:"Failed to move account")}},[n,i,f,l]),q=R.useCallback(A=>{if(!n)return;const D=Object.values(a).map(K=>K.sort_order),P=D.length>0?Math.max(...D):-1,O=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,N={name:A.name,sort_order:P+1,expected_balance:A.expected_balance,on_budget:A.on_budget,is_active:A.is_active},I={...a,[O]:N};p(I),c(I).catch(K=>{console.error("[useAccountHandlers] Error creating group:",K),v(K instanceof Error?K.message:"Failed to create account type.")})},[n,a,p,c]),U=R.useCallback((A,D)=>{if(!n)return;const P={...a,[A]:{...a[A],name:D.name,expected_balance:D.expected_balance,on_budget:D.on_budget,is_active:D.is_active}};p(P),c(P).catch(O=>{console.error("[useAccountHandlers] Error updating group:",O),v(O instanceof Error?O.message:"Failed to update account type.")})},[n,a,p,c]),Z=R.useCallback(A=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const D={};Object.entries(i).forEach(([N,I])=>{D[N]=I.account_group_id===A?{...I,account_group_id:null}:I});const{[A]:P,...O}=a;f(D),p(O),h(D,O).catch(N=>{console.error("[useAccountHandlers] Error deleting group:",N),v(N instanceof Error?N.message:"Failed to delete account type.")})},[n,i,a,f,p,h]),J=R.useCallback(async(A,D)=>{const P=Object.entries(a).sort(([,F],[,L])=>F.sort_order-L.sort_order),O=P.findIndex(([F])=>F===A),N=D==="up"?O-1:O+1;if(N<0||N>=P.length)return;const[I]=P.splice(O,1);P.splice(N,0,I);const K={};if(P.forEach(([F,L],$)=>{K[F]={...L,sort_order:$}}),p(K),!!n)try{await c(K)}catch(F){p(a),v(F instanceof Error?F.message:"Failed to move account type")}},[n,a,p,c]),ne=R.useCallback(async(A,D,P)=>{const O=i[A];if(!O)return;const N=P==="ungrouped"?null:P,I=Object.entries(i).filter(([,L])=>(L.account_group_id||"ungrouped")===P),K={};Object.entries(i).forEach(([L,$])=>{L!==A&&(K[L]={...$})});let F;if(D==="__group_end__"||I.length===0||!I.find(([L])=>L===D))F=(I.length>0?Math.max(...I.filter(([$])=>$!==A).map(([,$])=>$.sort_order)):-1)+1;else{const L=I.find(([$])=>$===D);if(L){const[,$]=L;F=$.sort_order,Object.entries(K).forEach(([Y,Q])=>{(Q.account_group_id||"ungrouped")===P&&Q.sort_order>=F&&(K[Y]={...Q,sort_order:Q.sort_order+1})})}else F=0}if(K[A]={...O,account_group_id:N,sort_order:F},f(K),!!n)try{await l(K)}catch(L){v(L instanceof Error?L.message:"Failed to save changes")}},[n,i,f,l]),k=R.useCallback(async(A,D)=>{if(A===D)return;const P=Object.entries(a).sort(([,F],[,L])=>F.sort_order-L.sort_order),O=P.findIndex(([F])=>F===A),N=[...P],[I]=N.splice(O,1);if(D==="__end__")N.push(I);else{const F=N.findIndex(([L])=>L===D);N.splice(F,0,I)}const K={};if(N.forEach(([F,L],$)=>{K[F]={...L,sort_order:$}}),p(K),!!n)try{await c(K)}catch(F){v(F instanceof Error?F.message:"Failed to save new order")}},[n,a,p,c]);return{accounts:i,accountGroups:a,accountsByGroup:b,sortedGroups:S,currentBudget:n,error:_,setError:v,handleCreateAccount:T,handleUpdateAccount:C,handleDeleteAccount:j,handleMoveAccount:z,handleCreateGroup:q,handleUpdateGroup:U,handleDeleteGroup:Z,handleMoveGroup:J,reorderAccountsInGroup:ne,reorderGroups:k}}function jE(t,e){if(!t)return{};const n={};return Object.entries(e).forEach(([i,a])=>{if(a.default_monthly_type==="percentage")return;const l=t.allocations?.find(c=>c.category_id===i);l?n[i]=l.amount.toString():a.default_monthly_amount!==void 0&&a.default_monthly_amount>0?n[i]=a.default_monthly_amount.toString():n[i]=""}),n}function L6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Sn(),{categories:a,categoryBalancesSnapshot:l,getOnBudgetTotal:c}=Hn(t,e),{month:h,isLoading:f,previousMonthIncome:p,saveAllocations:_,finalizeAllocations:v,deleteAllocations:b}=Cl(t,n,i),S=R.useMemo(()=>jE(h,a),[h,a]),[T,C]=R.useState(S),[j,z]=R.useState(!1),[q,U]=R.useState(!1),[Z,J]=R.useState(!1),[ne,k]=R.useState(!1),[A,D]=R.useState(null),P=R.useRef(null),O=R.useMemo(()=>l&&!l.is_stale?Object.values(l.balances).reduce((te,ge)=>te+(ge?.current??0),0):Object.values(a).reduce((te,ge)=>te+ge.balance,0),[a,l]);R.useEffect(()=>{if(!h)return;const te=`${h.year}-${h.month}`;P.current!==te&&(C(jE(h,a)),P.current=te)},[h,a]);const N=R.useCallback((te,ge)=>{if(ge.default_monthly_type==="percentage"&&ge.default_monthly_amount!==void 0)return ge.default_monthly_amount/100*p;const xe=T[te],pe=parseFloat(xe||"0");return isNaN(pe)?0:pe},[T,p]),I=R.useMemo(()=>Object.entries(a).reduce((te,[ge,xe])=>te+N(ge,xe),0),[a,N]),K=c(),F=h?.allocations_finalized?(h.allocations||[]).reduce((te,ge)=>te+ge.amount,0):0,L=K-O,$=R.useMemo(()=>L-I+F,[L,I,F]),Y=R.useCallback((te,ge)=>{C(xe=>({...xe,[te]:ge}))},[]),Q=R.useCallback(()=>{if(!h)return;const te={};Object.entries(a).forEach(([ge,xe])=>{if(xe.default_monthly_type==="percentage")return;const pe=h.allocations?.find(Ee=>Ee.category_id===ge);pe?te[ge]=pe.amount.toString():xe.default_monthly_amount!==void 0&&xe.default_monthly_amount>0?te[ge]=xe.default_monthly_amount.toString():te[ge]=""}),C(te),k(!1)},[h,a]),X=R.useCallback(()=>{const te=[];return Object.entries(a).forEach(([ge,xe])=>{const pe=N(ge,xe);pe>0&&te.push({category_id:ge,amount:pe})}),te},[a,N]),V=R.useCallback(async()=>{D(null),z(!0);try{await _(X()),k(!1)}catch(te){D(te instanceof Error?te.message:"Failed to save allocations")}finally{z(!1)}},[_,X]),H=R.useCallback(async()=>{D(null),U(!0);try{await v(X()),k(!1)}catch(te){D(te instanceof Error?te.message:"Failed to finalize allocations")}finally{U(!1)}},[v,X]),oe=R.useCallback(async()=>{D(null),J(!0);try{await b();const te={};Object.entries(a).forEach(([ge,xe])=>{xe.default_monthly_type!=="percentage"&&(xe.default_monthly_amount!==void 0&&xe.default_monthly_amount>0?te[ge]=xe.default_monthly_amount.toString():te[ge]="")}),C(te),k(!1)}catch(te){D(te instanceof Error?te.message:"Failed to delete allocations")}finally{J(!1)}},[b,a]),se=I-F;return{localAllocations:T,isSavingAllocations:j,isFinalizingAllocations:q,isDeletingAllocations:Z,isEditingAppliedAllocations:ne,error:A,monthLoading:f,onBudgetTotal:K,availableNow:L,currentDraftTotal:I,draftChangeAmount:se,availableAfterApply:$,previousMonthIncome:p,allocationsFinalized:h?.allocations_finalized??!1,getAllocationAmount:N,handleAllocationChange:Y,resetAllocationsToSaved:Q,handleSaveAllocations:V,handleFinalizeAllocations:H,handleDeleteAllocations:oe,setIsEditingAppliedAllocations:k,setError:D}}function V6({budgetId:t,categories:e,categoryBalancesSnapshot:n,currentYear:i,currentMonth:a,saveCategoryBalancesSnapshot:l,recalculateCategoryBalancesMutation:c}){const h=R.useCallback(q=>!(!q||q.is_stale||q.computed_for_year!==i||q.computed_for_month!==a),[i,a]),f=R.useMemo(()=>{if(!h(n))return{};const q={};return Object.keys(e).forEach(U=>{const Z=n.balances[U];q[U]=Z||{current:0,total:0}}),q},[n,e,h]),[p,_]=R.useState(f),[v,b]=R.useState(!1),[S,T]=R.useState(null),C=R.useRef(null);R.useEffect(()=>{if(!t||Object.keys(e).length===0)return;const q=`${t}_${i}_${a}`;if(C.current===q)return;if(h(n)){const Z={};Object.keys(e).forEach(J=>{const ne=n.balances[J];Z[J]=ne||{current:0,total:0}}),_(Z),C.current=q;return}(async()=>{b(!0);try{const Z=Object.keys(e),{current:J,total:ne}=await $p(t,Z,i,a,n),k={};Z.forEach(A=>{k[A]={current:J[A]??0,total:ne[A]??0}}),_(k),C.current=q,await l(k,i,a)}catch(Z){console.error("Error loading category balances:",Z)}finally{b(!1)}})()},[t,e,i,a,n,h,l]);const j=R.useCallback(async()=>{if(!t||Object.keys(e).length===0)return null;const q=Object.keys(e),{total:U}=await $p(t,q,i,a,null),Z={};Object.entries(e).forEach(([ne,k])=>{const A=k.balance,D=U[ne]??0;Math.abs(A-D)>.01&&(Z[ne]={stored:A,calculated:D})});const J=Object.keys(Z).length>0?Z:null;return T(J),J},[t,e,i,a]),z=R.useCallback(async()=>{if(!(!t||Object.keys(e).length===0)){b(!0);try{const q=Object.keys(e),{current:U,total:Z}=await $p(t,q,i,a,null),J={};Object.entries(e).forEach(([k,A])=>{J[k]={...A,balance:Z[k]??0}});const ne={};q.forEach(k=>{ne[k]={current:U[k]??0,total:Z[k]??0}}),await c(J,ne,i,a),_(ne),T(null)}finally{b(!1)}}},[t,e,c,i,a]);return{categoryBalances:p,loadingBalances:v,categoryBalanceMismatch:S,checkCategoryBalanceMismatch:j,recalculateAndSaveCategoryBalances:z}}function B6({categories:t,categoryGroups:e,currentBudget:n,setCategoriesOptimistic:i,setCategoryGroupsOptimistic:a,saveCategories:l,saveCategoryGroups:c,setError:h}){const[f,p]=R.useState(null),[_,v]=R.useState(null),[b,S]=R.useState(null),[T,C]=R.useState(null);function j(P,O){p("category"),v(O),P.dataTransfer.effectAllowed="move"}function z(P,O,N){P.preventDefault(),f==="category"&&(O!==_&&S(O),C(N))}function q(P,O){P.preventDefault(),f==="category"?(C(O),S(null)):f==="group"&&O!==_&&S(O)}function U(){S(null)}function Z(){C(null)}function J(){p(null),v(null),S(null),C(null)}async function ne(P,O,N){if(P.preventDefault(),P.stopPropagation(),!_||f!=="category"){J();return}const I=t[_];if(!I)return;const K=N==="ungrouped"?null:N,F=Object.entries(t).filter(([,Y])=>(Y.category_group_id||"ungrouped")===N),L={};Object.entries(t).forEach(([Y,Q])=>{Y!==_&&(L[Y]=Q)});let $;if(O==="__group_end__"||F.length===0||!F.find(([Y])=>Y===O))$=(F.length>0?Math.max(...F.filter(([Q])=>Q!==_).map(([,Q])=>Q.sort_order)):-1)+1;else{const Y=F.find(([Q])=>Q===O);Y?($=Y[1].sort_order,Object.entries(L).forEach(([Q,X])=>{(X.category_group_id||"ungrouped")===N&&X.sort_order>=$&&(L[Q]={...X,sort_order:X.sort_order+1})})):$=0}if(L[_]={...I,category_group_id:K,sort_order:$},i(L),J(),!!n)try{await l(L)}catch(Y){h(Y instanceof Error?Y.message:"Failed to save changes")}}async function k(P,O){P.preventDefault(),f==="category"?await ne(P,"__group_end__",O):f==="group"&&await D(P,O)}function A(P,O){P.stopPropagation(),p("group"),v(O),P.dataTransfer.effectAllowed="move"}async function D(P,O){if(P.preventDefault(),!_||f!=="group"||_===O){J();return}const N=e.findIndex(L=>L.id===_),I=[...e],[K]=I.splice(N,1);if(O==="__end__")I.push(K);else{const L=I.findIndex($=>$.id===O);I.splice(L,0,K)}const F=I.map((L,$)=>({...L,sort_order:$}));if(a(F),J(),!!n)try{await c(F)}catch(L){h(L instanceof Error?L.message:"Failed to save new order")}}return{dragType:f,draggedId:_,dragOverId:b,dragOverGroupId:T,setDragOverId:S,setDragOverGroupId:C,handleCategoryDragStart:j,handleCategoryDragOver:z,handleDragOverGroup:q,handleDragLeave:U,handleDragLeaveGroup:Z,handleDragEnd:J,handleCategoryDrop:ne,handleDropOnGroup:k,handleGroupDragStart:A,handleGroupDrop:D}}function z6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Sn(),{budget:a,categories:l,categoryGroups:c,categoryBalancesSnapshot:h,isLoading:f,saveCategories:p,saveCategoryGroups:_,saveCategoriesAndGroups:v,setCategoriesOptimistic:b,setCategoryGroupsOptimistic:S,saveCategoryBalancesSnapshot:T,recalculateCategoryBalances:C,getOnBudgetTotal:j}=Hn(t,e),[z,q]=R.useState(null),{categoryBalances:U,loadingBalances:Z,categoryBalanceMismatch:J,checkCategoryBalanceMismatch:ne,recalculateAndSaveCategoryBalances:k}=V6({budgetId:t,categories:l,categoryBalancesSnapshot:h,currentYear:n,currentMonth:i,saveCategoryBalancesSnapshot:T,recalculateCategoryBalancesMutation:C}),A=B6({categories:l,categoryGroups:c,currentBudget:a,setCategoriesOptimistic:b,setCategoryGroupsOptimistic:S,saveCategories:p,saveCategoryGroups:_,setError:q});async function D(Q,X){if(!a)return;const V=X==="ungrouped"?null:X,H=Object.values(l).filter(xe=>X==="ungrouped"?!xe.category_group_id:xe.category_group_id===X),oe=H.length>0?Math.max(...H.map(xe=>xe.sort_order)):-1,se=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,te={name:Q.name,description:Q.description,category_group_id:V,sort_order:oe+1,default_monthly_amount:Q.default_monthly_amount,default_monthly_type:Q.default_monthly_type,balance:0},ge={...l,[se]:te};b(ge);try{await p(ge)}catch(xe){b(l),q(xe instanceof Error?xe.message:"Failed to create category")}}async function P(Q,X){if(a)try{const V=l[Q];if(!V)return;const H=V.category_group_id||"ungrouped",oe=X.category_group_id;let se=V.sort_order;if(H!==(oe||"ungrouped")){const ge=Object.values(l).filter(xe=>(xe.category_group_id||"ungrouped")===(oe||"ungrouped")).filter((xe,pe,Ee)=>l[Q]!==Ee[pe]);se=ge.length>0?Math.max(...ge.map(xe=>xe.sort_order))+1:0}const te={...l,[Q]:{...V,name:X.name,description:X.description,category_group_id:oe,sort_order:se,default_monthly_amount:X.default_monthly_amount,default_monthly_type:X.default_monthly_type}};b(te),await p(te)}catch(V){q(V instanceof Error?V.message:"Failed to update category")}}async function O(Q){if(confirm("Are you sure you want to delete this category?")&&a)try{const{[Q]:X,...V}=l;b(V),await p(V)}catch(X){q(X instanceof Error?X.message:"Failed to delete category")}}async function N(Q,X){const V=l[Q];if(!V)return;const H=V.category_group_id||"ungrouped",oe=Object.entries(l).filter(([,Ee])=>(Ee.category_group_id||"ungrouped")===H).sort((Ee,he)=>Ee[1].sort_order-he[1].sort_order),se=oe.findIndex(([Ee])=>Ee===Q),te=X==="up"?se-1:se+1;if(te<0||te>=oe.length)return;const[ge,xe]=oe[te],pe={};if(Object.entries(l).forEach(([Ee,he])=>{Ee===Q?pe[Ee]={...he,sort_order:xe.sort_order}:Ee===ge?pe[Ee]={...he,sort_order:V.sort_order}:pe[Ee]=he}),b(pe),!!a)try{await p(pe)}catch(Ee){b(l),q(Ee instanceof Error?Ee.message:"Failed to move category")}}async function I(Q){if(a)try{const X=c.length>0?Math.max(...c.map(oe=>oe.sort_order)):-1,V={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:Q.name,sort_order:X+1},H=[...c,V];S(H),await _(H)}catch(X){q(X instanceof Error?X.message:"Failed to create group")}}async function K(Q,X){if(a)try{const V=c.map(H=>H.id===Q?{...H,name:X.name}:H);S(V),await _(V)}catch(V){q(V instanceof Error?V.message:"Failed to update group")}}async function F(Q){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&a)try{const X={};Object.entries(l).forEach(([H,oe])=>{X[H]=oe.category_group_id===Q?{...oe,category_group_id:null}:oe});const V=c.filter(H=>H.id!==Q);b(X),S(V),await v(X,V)}catch(X){q(X instanceof Error?X.message:"Failed to delete group")}}async function L(Q,X){const V=[...c].sort((ge,xe)=>ge.sort_order-xe.sort_order),H=V.findIndex(ge=>ge.id===Q),oe=X==="up"?H-1:H+1;if(oe<0||oe>=V.length)return;const[se]=V.splice(H,1);V.splice(oe,0,se);const te=V.map((ge,xe)=>({...ge,sort_order:xe}));if(S(te),!!a)try{await _(te)}catch(ge){S(c),q(ge instanceof Error?ge.message:"Failed to move group")}}const $=Object.entries(l).reduce((Q,[X,V])=>{const H=V.category_group_id||"ungrouped";return Q[H]||(Q[H]=[]),Q[H].push([X,V]),Q},{}),Y=[...c].sort((Q,X)=>Q.sort_order-X.sort_order);return{currentBudget:a,categories:l,categoryGroups:c,categoriesByGroup:$,sortedGroups:Y,categoryBalances:U,isLoading:f,loadingBalances:Z,error:z,setError:q,getOnBudgetTotal:j,categoryBalanceMismatch:J,checkCategoryBalanceMismatch:ne,recalculateAndSaveCategoryBalances:k,handleCreateCategory:D,handleUpdateCategory:P,handleDeleteCategory:O,handleMoveCategory:N,handleCreateGroup:I,handleUpdateGroup:K,handleDeleteGroup:F,handleMoveGroup:L,dragType:A.dragType,draggedId:A.draggedId,dragOverId:A.dragOverId,dragOverGroupId:A.dragOverGroupId,setDragOverId:A.setDragOverId,setDragOverGroupId:A.setDragOverGroupId,handleCategoryDragStart:A.handleCategoryDragStart,handleCategoryDragOver:A.handleCategoryDragOver,handleDragOverGroup:A.handleDragOverGroup,handleDragLeave:A.handleDragLeave,handleDragLeaveGroup:A.handleDragLeaveGroup,handleDragEnd:A.handleDragEnd,handleCategoryDrop:A.handleCategoryDrop,handleDropOnGroup:A.handleDropOnGroup,handleGroupDragStart:A.handleGroupDragStart,handleGroupDrop:A.handleGroupDrop}}function U6({currentUser:t,onComplete:e}){const[n,i]=R.useState(!1),[a,l]=R.useState(!1),[c,h]=R.useState(null),[f,p]=R.useState(null);async function _(){if(t){l(!0);try{const T=await Nr("budgets","budget data migration: scanning all budgets for migration status");let C=0,j=0,z=0;for(const q of T.docs){const U=q.data;if(Array.isArray(U.categories)&&C++,Array.isArray(U.accounts)&&j++,U.categories&&typeof U.categories=="object"&&!Array.isArray(U.categories)){const Z=U.categories;Object.values(Z).some(ne=>ne.balance===void 0)&&z++}}p({categoriesArrayMigrationNeeded:C>0,accountsArrayMigrationNeeded:j>0,budgetsToMigrateCategories:C,budgetsToMigrateAccounts:j,budgetsNeedingCategoryBalance:z,totalBudgetsChecked:T.docs.length})}catch(T){console.error("Failed to scan migration status:",T)}finally{l(!1)}}}async function v(T,C){const j={};C.forEach(z=>{j[z]=0});try{const z=await Nr("months",`budget data migration: calculating category balances for budget ${T}`,[{field:"budget_id",op:"==",value:T}]);for(const q of z.docs){const U=q.data;if(U.allocations_finalized&&U.allocations)for(const Z of U.allocations)j[Z.category_id]=(j[Z.category_id]||0)+Z.amount}}catch(z){console.error("Error calculating balances for budget:",T,z)}return j}async function b(T){try{const{exists:C,data:j}=await Ae("budgets",T,"budget data migration: reading budget to check if migration needed");if(!C||!j)return{budgetId:T,budgetName:"Unknown",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Budget not found"};const z=j.name||"Unnamed Budget",q=Array.isArray(j.categories),U=Array.isArray(j.accounts),Z=Array.isArray(j.account_groups);if(!q&&!U&&!Z)return{budgetId:T,budgetName:z,categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Already migrated"};let J=j.categories,ne=j.accounts,k=j.account_groups,A=0,D=0,P=0,O=!1;if(q){const K=j.categories,F={},L=[];for(const Q of K){const X=Q.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;L.push(X),F[X]={name:Q.name,description:Q.description,category_group_id:Q.category_group_id??null,sort_order:Q.sort_order??0,default_monthly_amount:Q.default_monthly_amount,default_monthly_type:Q.default_monthly_type,balance:0}}const $=await v(T,L);for(const Q of L)F[Q]&&(F[Q].balance=$[Q]||0);const Y={};Object.entries(F).forEach(([Q,X])=>{Y[Q]={name:X.name,category_group_id:X.category_group_id??null,sort_order:X.sort_order,balance:X.balance},X.description&&(Y[Q].description=X.description),X.default_monthly_amount!==void 0&&(Y[Q].default_monthly_amount=X.default_monthly_amount),X.default_monthly_type!==void 0&&(Y[Q].default_monthly_type=X.default_monthly_type)}),J=Y,A=K.length,O=!0}if(U){const K=j.accounts,F={};for(const L of K){const $=L.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;F[$]={nickname:L.nickname,balance:L.balance??0,account_group_id:L.account_group_id??null,sort_order:L.sort_order??0},L.is_income_account!==void 0&&(F[$].is_income_account=L.is_income_account),L.is_income_default!==void 0&&(F[$].is_income_default=L.is_income_default),L.is_outgo_account!==void 0&&(F[$].is_outgo_account=L.is_outgo_account),L.is_outgo_default!==void 0&&(F[$].is_outgo_default=L.is_outgo_default),L.on_budget!==void 0&&(F[$].on_budget=L.on_budget),L.is_active!==void 0&&(F[$].is_active=L.is_active)}ne=F,D=K.length}if(Z){const K=j.account_groups,F={};for(const L of K){const $=L.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;F[$]={name:L.name,sort_order:L.sort_order??0},L.expected_balance!==void 0&&(F[$].expected_balance=L.expected_balance),L.on_budget!==void 0&&(F[$].on_budget=L.on_budget),L.is_active!==void 0&&(F[$].is_active=L.is_active)}if(U&&ne){const L=ne,$=j.account_groups,Y={};$.forEach((Q,X)=>{const V=Q.id||String(X),H=Object.keys(F)[X];H&&(Y[V]=H)}),Object.entries(L).forEach(([Q,X])=>{X.account_group_id&&Y[X.account_group_id]&&(L[Q].account_group_id=Y[X.account_group_id])})}k=F,P=K.length}const{category_balances:N,...I}=j;return await Xe("budgets",T,{...I,categories:J,accounts:ne,account_groups:k},`budget data migration: saving migrated budget data (categories: ${A}, accounts: ${D}, groups: ${P})`),{budgetId:T,budgetName:z,categoriesMigrated:A,accountsMigrated:D,accountGroupsMigrated:P,balancesCalculated:O}}catch(C){return{budgetId:T,budgetName:"Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:C instanceof Error?C.message:"Migration failed"}}}async function S(){if(!t)return;i(!0),h(null);const T=[];try{const C=await Nr("budgets","budget data migration: listing all budgets in system to migrate");if(C.docs.length===0){h([{budgetId:"",budgetName:"No budgets found",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"No budgets in system"}]),i(!1);return}for(const j of C.docs){const z=await b(j.id);T.push(z)}h(T),e?.()}catch(C){h([{budgetId:"",budgetName:"Migration Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:C instanceof Error?C.message:"Migration failed"}])}finally{i(!1)}}return{status:f,isScanning:a,scanStatus:_,isMigrating:n,migrationResults:c,runMigration:S}}function F6(){const t=new Date,e=t.getFullYear();let i=t.getMonth()+1+2,a=e;return i>12&&(i-=12,a+=1),{year:a,month:i}}function q6(t,e,n){return t>n.year||t===n.year&&e>n.month}function H6({currentUser:t,onComplete:e}){const[n,i]=R.useState(!1),[a,l]=R.useState(!1),[c,h]=R.useState(null),[f,p]=R.useState(null);async function _(){if(t){i(!0);try{const b=F6(),S=await Nr("months","future months cleanup: scanning for future months"),T=[];for(const C of S.docs){const{budget_id:j,year:z,month:q}=C.data;q6(z,q,b)&&T.push({docId:C.id,budgetId:j,year:z,month:q})}T.sort((C,j)=>C.year!==j.year?C.year-j.year:C.month-j.month),h({futureMonthsToDelete:T,futureMonthsCount:T.length})}catch(b){console.error("Failed to scan future months:",b)}finally{i(!1)}}}async function v(){if(!t||!c||c.futureMonthsToDelete.length===0)return;l(!0),p(null);let b=0;const S=[];for(const T of c.futureMonthsToDelete)try{await h1("months",T.docId,`future months cleanup: deleting future month ${T.year}-${T.month}`),b++}catch(C){S.push(`Failed to delete ${T.docId}: ${C instanceof Error?C.message:"Unknown error"}`)}p({deleted:b,errors:S}),l(!1),e?.()}return{status:c,isScanning:n,scanStatus:_,isCleaningFutureMonths:a,futureMonthsCleanupResult:f,cleanupFutureMonths:v}}function Zp(t){return t.includes("@")?!1:!!(/_[a-z0-9]+_(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=2||/_[a-z0-9]+\.(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=1)}function G6(t){let e=t;const n=/^(.+)_(gmail|yahoo|hotmail|outlook|icloud|aol|proton|protonmail)\.(.+)$/i,i=e.match(n);return i?`${i[1]}@${i[2]}.${i[3]}`:(e=e.replace(/_com$/,".com").replace(/_net$/,".net").replace(/_org$/,".org").replace(/_edu$/,".edu").replace(/_io$/,".io"),e=e.replace(/_gmail_/,"@gmail.").replace(/_yahoo_/,"@yahoo.").replace(/_hotmail_/,"@hotmail.").replace(/_outlook_/,"@outlook.").replace(/_icloud_/,"@icloud."),e)}function Sh(t){if(t===null||typeof t!="object"||Array.isArray(t))return!1;const e=t;return e._methodName==="arrayUnion"&&Array.isArray(e.vc)}function eT(t){return t.vc||[]}function kE(t){return Array.isArray(t.items)?t.items:Sh(t.items)?eT(t.items):[]}function Q6({currentUser:t}){const[e,n]=R.useState(!1),[i,a]=R.useState(!1),[l,c]=R.useState(null),[h,f]=R.useState(null);async function p(){if(!t)return;n(!0);const v={documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],isHealthy:!0};try{const b=await Nr("feedback","feedback migration: scanning for issues");v.documentsFound=b.docs.length;for(const S of b.docs)Zp(S.id)&&v.sanitizedDocuments.push(S.id),Sh(S.data.items)&&v.corruptedDocuments.push(S.id);v.isHealthy=v.sanitizedDocuments.length===0&&v.corruptedDocuments.length===0,c(v)}catch(b){console.error("Failed to scan feedback:",b)}finally{n(!1)}}async function _(){if(!t)return;a(!0);const v=h?{...h,mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]}:{documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]};try{const b=await Nr("feedback","feedback migration: listing all documents");v.documentsFound=b.docs.length,v.sanitizedDocuments=[],v.corruptedDocuments=[];for(const S of b.docs){const T=Zp(S.id);if(Sh(S.data.items)&&!T){v.corruptedDocuments.push(S.id);const j=eT(S.data.items);try{await Xe("feedback",S.id,{items:j,user_email:S.data.user_email||S.id,created_at:S.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: fixing corrupted arrayUnion in ${S.id}`),v.fixedDocuments++}catch(z){v.errors.push(`Failed to fix ${S.id}: ${z instanceof Error?z.message:"Unknown error"}`)}}}for(const S of b.docs)if(Zp(S.id)){v.sanitizedDocuments.push(S.id);const T=S.id,C=G6(T),j=kE(S.data),{exists:z,data:q}=await Ae("feedback",C,`feedback migration: checking if ${C} exists`);if(z&&q){const U=kE(q),Z=new Set(U.map(ne=>ne.id)),J=j.filter(ne=>!Z.has(ne.id));if(J.length>0||Sh(q.items)){const ne=[...U,...J];await Xe("feedback",C,{...q,items:ne,updated_at:new Date().toISOString()},`feedback migration: merging ${J.length} items from ${T}`),v.mergedItems+=J.length}}else j.length>0&&(await Xe("feedback",C,{items:j,user_email:C,created_at:S.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: creating ${C} from ${T}`),v.mergedItems+=j.length);try{await h1("feedback",T,`feedback migration: deleting sanitized document ${T}`),v.deletedDocuments++}catch(U){v.errors.push(`Failed to delete ${T}: ${U instanceof Error?U.message:"Unknown error"}`)}}f(v)}catch(b){v.errors.push(b instanceof Error?b.message:"Migration failed"),f(v)}finally{a(!1)}}return{status:l,isScanning:e,scanStatus:p,isMigratingFeedback:i,feedbackMigrationResult:h,migrateFeedbackDocuments:_}}function $6({onCreateNew:t}){const[e,n]=R.useState(""),[i,a]=R.useState(!1),[l,c]=R.useState(null);async function h(f){f.preventDefault(),a(!0),c(null);try{await t(e.trim()||void 0)}catch(p){c(p instanceof Error?p.message:"Failed to create budget"),a(!1)}}return d.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:l}),d.jsx("button",{onClick:()=>c(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Create Your Budget"]}),d.jsxs("form",{onSubmit:h,children:[d.jsxs("div",{style:{marginBottom:"1.5rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:e,onChange:f=>n(f.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),d.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),d.jsx("button",{type:"submit",disabled:i,style:{width:"100%",background:fe.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontWeight:600,opacity:i?.7:1,fontSize:"1rem"},children:i?"Creating...":"Create Budget"})]})]}),d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function K6({invites:t,onAccept:e,onCreateNew:n}){const[i,a]=R.useState(null),[l,c]=R.useState(!1),[h,f]=R.useState(""),[p,_]=R.useState(!1),[v,b]=R.useState(null);async function S(C){a(C),b(null);try{await e(C)}catch(j){b(j instanceof Error?j.message:"Failed to accept invitation"),a(null)}}async function T(C){C.preventDefault(),_(!0),b(null);try{await n(h.trim()||void 0)}catch(j){b(j instanceof Error?j.message:"Failed to create new budget"),_(!1)}}return d.jsxs("div",{children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Budget Invitations"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(C=>d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:C.budgetName}),C.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",C.ownerEmail]})]}),d.jsx("button",{onClick:()=>S(C.budgetId),disabled:i!==null||p,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null||p?"not-allowed":"pointer",fontWeight:500,opacity:i!==null||p?.7:1,fontSize:"0.9rem"},children:i===C.budgetId?"Joining...":"Accept & Join"})]},C.budgetId))})]}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?d.jsxs("form",{onSubmit:T,children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),d.jsxs("div",{style:{marginBottom:"1rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:h,onChange:C=>f(C.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{type:"submit",disabled:p||i!==null,style:{background:fe.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p||i!==null?"not-allowed":"pointer",fontWeight:500,opacity:p||i!==null?.7:1,fontSize:"0.9rem"},children:p?"Creating...":"Create Budget"}),d.jsx("button",{type:"button",onClick:()=>{c(!1),f("")},disabled:p,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p?"not-allowed":"pointer",fontWeight:500,opacity:p?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),d.jsx("button",{onClick:()=>c(!0),disabled:i!==null,style:{background:fe.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null?"not-allowed":"pointer",fontWeight:500,opacity:i!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function W6({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const i=R.useMemo(()=>[{id:"income",label:"Income"},{id:"balances",label:"Balances",checkmark:n},{id:"spend",label:"Spend"}],[n]);return d.jsx(Jy,{mode:"button",tabs:i,activeTab:t,onTabChange:a=>e(a)})}function Y6({isOpen:t,onClose:e,onProceed:n,results:i}){const a=!i||i.status==="confirming",l=i&&!["confirming","done","error"].includes(i.status),c=a||i?.status==="done"||i?.status==="error";function h(){c&&e()}return d.jsx(ru,{isOpen:t,onClose:h,title:"Recalculate Balances",width:"540px",children:d.jsxs("div",{style:{padding:"0.5rem 0"},children:[a&&d.jsxs(d.Fragment,{children:[d.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",lineHeight:1.5},children:["This will recalculate category balances and account balances from the ",d.jsx("strong",{children:"current month forward"}),"."]}),d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Use this if your data seems out of sync or after fixing bugs. Past months will not be modified."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginBottom:"1.5rem"},children:[d.jsx(jo,{status:"waiting",label:"Find all months to process"}),d.jsx(jo,{status:"waiting",label:"Process months"}),d.jsx(jo,{status:"waiting",label:"Update budget totals"})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Be,{variant:"secondary",onClick:e,children:"Cancel"}),d.jsx(Be,{onClick:n,children:"Proceed"})]})]}),!a&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Recalculating category balances and account balances..."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx(jo,{status:i?.status==="pending"?"waiting":"complete",label:"Find all months to process",detail:i&&i.status!=="pending"?`Found ${i.monthsFound||0} month${i.monthsFound!==1?"s":""}`:void 0}),d.jsx(jo,{status:OE(i?.status,["pending","finding_months"],"processing_months"),label:"Process months",detail:i?.status==="processing_months"?`Processing: ${i.currentMonthLabel} (${(i.currentMonthIndex||0)+1}/${i.monthsFound||0})`:i?.monthsProcessed!==void 0?`Processed ${i.monthsProcessed} month${i.monthsProcessed!==1?"s":""}`:void 0}),d.jsx(jo,{status:i?.status==="error"?"error":OE(i?.status,["pending","finding_months","processing_months"],"updating_budget"),label:"Update budget totals",detail:i?.status==="error"?i.error:void 0,isError:i?.status==="error"})]}),i?.status==="done"&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${fe.success} 10%, transparent)`,border:`1px solid ${fe.success}`,borderRadius:"8px",textAlign:"center"},children:[d.jsx("p",{style:{margin:0,fontWeight:600,color:fe.success},children:" Recalculation complete!"}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:[i.monthsProcessed," month",i.monthsProcessed!==1?"s":""," processed",d.jsx("br",{}),"Total Income: ",ke(i.totalIncomeRecalculated||0),d.jsx("br",{}),"Total Expenses: ",ke(i.totalExpensesRecalculated||0)]})]}),(i?.status==="done"||i?.status==="error")&&d.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"center"},children:d.jsx(Be,{onClick:e,children:"Done"})}),l&&d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"Please wait, do not close this window..."})]})]})})}function OE(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function jo({status:t,label:e,detail:n,isError:i}){const a=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:a}),d.jsxs("div",{style:{flex:1},children:[d.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:i?1:.6,color:i?fe.error:"inherit"},children:n})]})]})}function t_({isDisabled:t}){const{selectedBudgetId:e,currentUserId:n,currentYear:i,currentMonthNumber:a}=Sn(),{categories:l,accounts:c,recalculateCategoryBalances:h,saveAccounts:f}=Hn(e,n),[p,_]=R.useState(!1),[v,b]=R.useState(!1),[S,T]=R.useState(null);function C(){b(!0),T({status:"confirming"})}async function j(){if(e){_(!0),T({status:"pending"});try{T({status:"finding_months"});const U=(await Nr("months","recalculate: finding all months for budget",[{field:"budget_id",op:"==",value:e}])).docs.map(H=>({id:H.id,...H.data})).sort((H,oe)=>H.year!==oe.year?H.year-oe.year:H.month-oe.month),Z=new Date,J=i||Z.getFullYear(),ne=a||Z.getMonth()+1,k=U.filter(H=>H.year>J||H.year===J&&H.month>=ne),A=U.filter(H=>H.year<J||H.year===J&&H.month<ne),D=A.length>0?A[A.length-1]:null,P=Object.keys(l);T({status:"finding_months",monthsFound:k.length}),await new Promise(H=>setTimeout(H,100));const O={};if(D){const H=It(e,D.year,D.month),{exists:oe,data:se}=await Ae("months",H,"recalculate: reading previous month for starting balances");if(oe&&se?.category_balances)for(const te of se.category_balances)O[te.category_id]=te.end_balance??0}P.forEach(H=>{O[H]===void 0&&(O[H]=0)});let N=0,I=0;for(let H=0;H<k.length;H++){const oe=k[H],se=`${Qy[oe.month-1]} ${oe.year}`;T({status:"processing_months",monthsFound:k.length,currentMonthIndex:H,currentMonthLabel:se});const te=It(e,oe.year,oe.month),{exists:ge,data:xe}=await Ae("months",te,`recalculate: reading full month data for ${se}`);if(!ge||!xe){console.warn(`Month ${se} not found, skipping`);continue}const pe=xe.income||[],Ee=xe.expenses||[],he=xe.allocations||[],Re=xe.allocations_finalized||!1,De=pe.reduce((Ke,Ue)=>Ke+Ue.amount,0),vt=Ee.reduce((Ke,Ue)=>Ke+Ue.amount,0);N+=De,I+=vt;const Ie=P.map(Ke=>{const Ue=O[Ke]??0;let lt=0;if(Re&&he.length>0){const Dn=he.find(nn=>nn.category_id===Ke);Dn&&(lt=Dn.amount)}let Mt=0;Ee.length>0&&(Mt=Ee.filter(Dn=>Dn.category_id===Ke).reduce((Dn,nn)=>Dn+nn.amount,0));const fn=Ue+lt-Mt;return{category_id:Ke,start_balance:Ue,allocated:lt,spent:Mt,end_balance:fn}});Ie.forEach(Ke=>{O[Ke.category_id]=Ke.end_balance});let ze=xe.previous_month_snapshot;const Je=H===0?D:k[H-1];if(Je){const Ke={};Ie.forEach(Ue=>{Ke[Ue.category_id]=Ue.start_balance}),ze={...ze||{},total_income:Je.total_income||0,account_balances_end:ze?.account_balances_end||{},category_balances_end:Ke,snapshot_taken_at:new Date().toISOString()}}const Ct={budget_id:e,year:oe.year,month:oe.month,income:pe,total_income:De,expenses:Ee,total_expenses:vt,allocations:he,allocations_finalized:Re,category_balances:Ie,category_balances_stale:!1,previous_month_snapshot:ze,previous_month_snapshot_stale:!1,account_balances_start:xe.account_balances_start,account_balances_end:xe.account_balances_end,created_at:xe.created_at||new Date().toISOString(),updated_at:new Date().toISOString()};await kr(e,Ct),await new Promise(Ke=>setTimeout(Ke,50))}const K={};Object.keys(c).forEach(H=>{K[H]=0});for(const H of U){const oe=It(e,H.year,H.month),{exists:se,data:te}=await Ae("months",oe,`recalculate: reading month ${H.year}/${H.month} for account balances`);if(!se||!te)continue;const ge=te.income||[],xe=te.expenses||[];for(const pe of ge)pe.account_id&&K[pe.account_id]!==void 0&&(K[pe.account_id]+=pe.amount);for(const pe of xe)pe.account_id&&K[pe.account_id]!==void 0&&(K[pe.account_id]-=pe.amount)}const F={};Object.entries(c).forEach(([H,oe])=>{F[H]={...oe,balance:K[H]??0}}),await f(F),T({status:"updating_budget",monthsFound:k.length,monthsProcessed:k.length,totalIncomeRecalculated:N,totalExpensesRecalculated:I});const L=k.findIndex(H=>H.year===i&&H.month===a),$={},Y={};if(D){const H=It(e,D.year,D.month),{exists:oe,data:se}=await Ae("months",H,"recalculate: reading previous month for current balance calculation");if(oe&&se?.category_balances)for(const te of se.category_balances)Y[te.category_id]=te.end_balance??0}P.forEach(H=>{Y[H]===void 0&&(Y[H]=0)});for(let H=0;H<=L&&H<k.length;H++){const oe=k[H];P.forEach(se=>{const te=Y[se]??0;let ge=0;if(oe.allocations_finalized&&oe.allocations){const pe=oe.allocations.find(Ee=>Ee.category_id===se);pe&&(ge=pe.amount)}let xe=0;oe.expenses&&(xe=oe.expenses.filter(pe=>pe.category_id===se).reduce((pe,Ee)=>pe+Ee.amount,0)),Y[se]=te+ge-xe})}P.forEach(H=>{$[H]=Y[H]??0});const Q={...O},X={};Object.entries(l).forEach(([H,oe])=>{X[H]={...oe,balance:Q[H]??0}});const V={};P.forEach(H=>{V[H]={current:$[H]??0,total:Q[H]??0}}),await h(X,V,i,a);for(const H of k)Oe.invalidateQueries({queryKey:le.month(e,H.year,H.month)});T({status:"done",monthsFound:k.length,monthsProcessed:k.length,totalIncomeRecalculated:N,totalExpensesRecalculated:I})}catch(q){console.error("Recalculate error:",q),T({status:"error",error:q instanceof Error?q.message:"Failed to recalculate"})}finally{_(!1)}}}function z(){b(!1),T(null)}return d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:C,disabled:t||p,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:t||p?"not-allowed":"pointer",opacity:t||p?.5:1,fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},title:"Recalculate balances from this month forward",children:[p?"":""," Recalculate"]}),d.jsx(Y6,{isOpen:v,onClose:z,onProceed:j,results:S})]})}function X6({isLoading:t,onPreviousMonth:e,onNextMonth:n}){const{currentYear:i,currentMonthNumber:a,isAdmin:l,selectedBudgetId:c,currentUserId:h}=Sn(),{budget:f}=Hn(c,h),{month:p}=Cl(c,i,a),[_,v]=R.useState(!1),b=R.useRef(null);R.useEffect(()=>{if(!_)return;function T(C){b.current&&!b.current.contains(C.target)&&v(!1)}return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[_]);function S(){if(!p||!f)return;const T={...p,_meta:{downloaded_at:new Date().toISOString(),budget_id:f.id,budget_name:f.name}},C=new Blob([JSON.stringify(T,null,2)],{type:"application/json"}),j=URL.createObjectURL(C),z=document.createElement("a");z.href=j,z.download=`month_${i}_${String(a).padStart(2,"0")}.json`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(j),v(!1)}return d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[d.jsx("button",{onClick:e,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Previous month",children:""}),d.jsxs("div",{ref:b,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[d.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[Qy[a-1]," ",i]}),d.jsx("button",{onClick:()=>v(!_),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:_?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),t&&d.jsxs(d.Fragment,{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:fe.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),_&&d.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[d.jsx(t_,{isDisabled:t}),l&&p&&d.jsx("button",{onClick:S,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),d.jsx("button",{onClick:n,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Next month",children:""})]})}const J6={background:fe.primary,border:"none",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px",color:"white"},Z6={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"},e4={background:"transparent",border:`1px solid ${fe.errorBorder}`,color:fe.error,cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"};function tT({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:c,defaultDate:h,config:f,onSubmit:p,onCancel:_,onDelete:v,extraContent:b}){const{isMedium:S,isMobile:T}=N6(),{showCategory:C=!1,showCleared:j=!1,accountLabel:z="Account",payeePlaceholder:q="Payee name",descriptionPlaceholder:U="Optional note",submitLabel:Z}=f,J=new Date().toISOString().split("T")[0],[ne,k]=R.useState(l?.date||h||J),[A,D]=R.useState(l?.payee||""),[P,O]=R.useState(l?.categoryId||""),[N,I]=R.useState(l?.accountId||c||(t[0]?t[0][0]:"")),[K,F]=R.useState(l?.amount?.toString()||""),[L,$]=R.useState(l?.description||""),[Y,Q]=R.useState(l?.cleared||!1),X={},V=[];t.forEach(([Re,De])=>{De.account_group_id?(X[De.account_group_id]||(X[De.account_group_id]=[]),X[De.account_group_id].push([Re,De])):V.push([Re,De])});function H(Re){Re.preventDefault();const De=parseFloat(K);isNaN(De)||De<=0||C&&!P||!N||!ne||p({date:ne,payee:A.trim()||void 0,categoryId:C?P:void 0,accountId:N,amount:De,description:L.trim()||void 0,cleared:j?Y:void 0})}const oe=d.jsxs(nu,{id:"txn-account",value:N,onChange:Re=>I(Re.target.value),required:!0,style:{fontSize:"0.85rem",padding:"0.5rem"},children:[Object.entries(e).map(([Re,De])=>{const vt=X[Re];return vt?.length?d.jsx("optgroup",{label:De.name,children:vt.map(([Ie,ze])=>d.jsx("option",{value:Ie,children:ze.nickname},Ie))},Re):null}),V.length>0&&d.jsx("optgroup",{label:"Other",children:V.map(([Re,De])=>d.jsx("option",{value:Re,children:De.nickname},Re))})]}),se=C&&n&&i?d.jsx(Tt,{label:"Category",htmlFor:"txn-category",children:d.jsx(b6,{id:"txn-category",value:P,onChange:O,categories:n,categoryGroups:i,placeholder:"Search...",required:!0})}):null,te=j?d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.35rem"},children:[d.jsx("label",{htmlFor:"txn-cleared",style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:"Clr"}),d.jsx(Rs,{id:"txn-cleared",checked:Y,onChange:Re=>Q(Re.target.checked)})]}):null,ge=d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.1rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[d.jsx("button",{type:"submit",title:Z,style:J6,children:""}),d.jsx("button",{type:"button",onClick:_,title:"Cancel",style:Z6,children:""}),v&&d.jsx("button",{type:"button",onClick:v,title:"Delete",style:e4,children:""})]})]}),xe=d.jsxs(Fa,{children:[d.jsx(Be,{type:"submit",children:Z}),d.jsx(Be,{type:"button",variant:"secondary",onClick:_,children:"Cancel"}),v&&d.jsx(Be,{type:"button",variant:"danger",onClick:v,children:" Delete"})]});if(T)return d.jsxs(Us,{onSubmit:H,children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[d.jsx(Tt,{label:"Date",htmlFor:"txn-date",children:d.jsx(Xp,{id:"txn-date",value:ne,onChange:Re=>k(Re.target.value),required:!0})}),d.jsx(Tt,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(Eh,{id:"txn-amount",value:K,onChange:F,placeholder:"$0.00",required:!0,autoFocus:!0})})]}),d.jsx(Tt,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(Yp,{id:"txn-payee",value:A,onChange:D,payees:a,placeholder:q})}),se,d.jsx(Tt,{label:z,htmlFor:"txn-account",children:oe}),d.jsx(Tt,{label:"Description (optional)",htmlFor:"txn-description",children:d.jsx(Fs,{id:"txn-description",value:L,onChange:Re=>$(Re.target.value),placeholder:U})}),j&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx(Rs,{id:"txn-cleared-mobile",checked:Y,onChange:Re=>Q(Re.target.checked)}),d.jsx("label",{htmlFor:"txn-cleared-mobile",style:{fontSize:"0.9rem",cursor:"pointer"},children:"Cleared (appeared in bank account)"})]}),b]}),xe]});const pe=C&&n&&i,Ee={fontSize:"0.85rem",padding:"0.5rem"};if(S)return d.jsxs(Us,{onSubmit:H,children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:pe?"6rem 1fr 1fr 1fr":"6rem 1fr 1fr",gap:"0.75rem",alignItems:"end"},children:[d.jsx(Tt,{label:"Date",htmlFor:"txn-date",children:d.jsx(Xp,{id:"txn-date",value:ne,onChange:Re=>k(Re.target.value),required:!0,style:Ee})}),d.jsx(Tt,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(Yp,{id:"txn-payee",value:A,onChange:D,payees:a,placeholder:q})}),se,d.jsx(Tt,{label:z,htmlFor:"txn-account",children:oe})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:j?"7rem 1fr auto auto":"7rem 1fr auto",gap:"0.75rem",alignItems:"end",marginTop:"0.75rem"},children:[d.jsx(Tt,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(Eh,{id:"txn-amount",value:K,onChange:F,placeholder:"$0.00",required:!0,autoFocus:!0})}),d.jsx(Tt,{label:"Description",htmlFor:"txn-description",children:d.jsx(Fs,{id:"txn-description",value:L,onChange:Re=>$(Re.target.value),placeholder:U,style:Ee})}),te,ge]}),b]});const he=pe?j?"6rem 1fr 1fr 1fr 6rem 1fr auto auto":"6rem 1fr 1fr 1fr 6rem 1fr auto":j?"6rem 1fr 1fr 6rem 1fr auto auto":"6rem 1fr 1fr 6rem 1fr auto";return d.jsxs(Us,{onSubmit:H,children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:he,gap:"0.75rem",alignItems:"end"},children:[d.jsx(Tt,{label:"Date",htmlFor:"txn-date",children:d.jsx(Xp,{id:"txn-date",value:ne,onChange:Re=>k(Re.target.value),required:!0,style:Ee})}),d.jsx(Tt,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(Yp,{id:"txn-payee",value:A,onChange:D,payees:a,placeholder:q})}),se,d.jsx(Tt,{label:z,htmlFor:"txn-account",children:oe}),d.jsx(Tt,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(Eh,{id:"txn-amount",value:K,onChange:F,placeholder:"$0.00",required:!0,autoFocus:!0})}),d.jsx(Tt,{label:"Description",htmlFor:"txn-description",children:d.jsx(Fs,{id:"txn-description",value:L,onChange:Re=>$(Re.target.value),placeholder:U,style:Ee})}),te,ge]}),b]})}function ME({accounts:t,accountGroups:e,payees:n,initialData:i,defaultAccountId:a,defaultDate:l,onSubmit:c,onCancel:h,onDelete:f,submitLabel:p}){function _(v){c(v.amount,v.accountId,v.date,v.payee,v.description)}return d.jsx(tT,{accounts:t,accountGroups:e,payees:n,initialData:i?{date:i.date,payee:i.payee,accountId:i.account_id,amount:i.amount,description:i.description}:void 0,defaultAccountId:a,defaultDate:l,config:{showCategory:!1,showCleared:!1,accountLabel:"Deposit To",payeePlaceholder:"e.g., Employer, Client name",descriptionPlaceholder:"e.g., January paycheck",submitLabel:p},onSubmit:_,onCancel:h,onDelete:f})}function nT(){const[t,e]=R.useState(()=>typeof window>"u"?!0:window.innerWidth>=Bi.wide);return R.useEffect(()=>{function n(){e(window.innerWidth>=Bi.wide)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}function t4({income:t,accountName:e,accountGroupName:n,onEdit:i,onDelete:a,isMobile:l}){const c=nT(),h=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",f=n?`${n} / ${e}`:e;return l?d.jsxs("div",{onClick:i,style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:h}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""})]}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",f]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:fe.success,fontFamily:"monospace"},children:["+",ke(t.amount)]})})]}):c?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 6rem 1fr 4rem",gap:"0.75rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:p=>p.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:p=>p.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:h}),d.jsx("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),d.jsx("span",{style:{fontSize:"0.85rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:f}),d.jsxs("span",{style:{fontWeight:600,color:fe.success,fontFamily:"monospace",textAlign:"right"},children:["+",ke(t.amount)]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description||""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:p=>p.currentTarget.style.opacity="1",onMouseLeave:p=>p.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:p=>p.currentTarget.style.opacity="1",onMouseLeave:p=>p.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 6rem 4rem",gap:"0.5rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:p=>p.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:p=>p.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:h}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),t.description&&d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e}),d.jsxs("span",{style:{fontWeight:600,color:fe.success,fontFamily:"monospace",textAlign:"right",fontSize:"0.9rem"},children:["+",ke(t.amount)]}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:p=>p.currentTarget.style.opacity="1",onMouseLeave:p=>p.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:p=>p.currentTarget.style.opacity="1",onMouseLeave:p=>p.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function n4(){return nT()?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 6rem 1fr 4rem",gap:"0.75rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{children:"Description"}),d.jsx("span",{})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 6rem 4rem",gap:"0.5rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{})]})}function r4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Sn(),{accounts:a,accountGroups:l}=Hn(t,e),{month:c,isLoading:h,payees:f,addIncome:p,updateIncome:_,deleteIncome:v}=Cl(t,n,i),b=Ki(),[S,T]=R.useState(null),[C,j]=R.useState(!1),[z,q]=R.useState(null);function U(K){const F=K.account_group_id?l[K.account_group_id]:void 0;return F?.is_active!==void 0?F.is_active:K.is_active!==!1}function Z(K){const F=K.account_group_id?l[K.account_group_id]:void 0;return F?.on_budget!==void 0?F.on_budget:K.on_budget!==!1}const J=Object.entries(a).filter(([,K])=>U(K)&&Z(K)),ne=J.filter(([,K])=>K.is_income_account),k=ne.length>0?ne:J,A=J.find(([,K])=>K.is_income_default),D=A?A[0]:void 0,P=c?.income.reduce((K,F)=>K+F.amount,0)||0;function O(K,F,L,$,Y){T(null),j(!1),p(K,F,L,$,Y).catch(Q=>{T(Q instanceof Error?Q.message:"Failed to add income")})}function N(K,F,L,$,Y,Q){T(null),q(null),_(K,F,L,$,Y,Q).catch(X=>{T(X instanceof Error?X.message:"Failed to update income")})}function I(K){confirm("Are you sure you want to delete this income entry?")&&(T(null),v(K).catch(F=>{T(F instanceof Error?F.message:"Failed to delete income")}))}return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:h?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:h?"none":"auto"},children:[S&&d.jsx("div",{style:{background:`color-mix(in srgb, ${fe.error} 15%, transparent)`,border:`1px solid ${fe.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:fe.error},children:S}),d.jsx(e_,{label:"Total",value:d.jsx("span",{style:{color:qt(P)},children:ke(P)}),action:!C&&d.jsx(Be,{onClick:()=>j(!0),disabled:k.length===0,children:"+ Add Income"})}),k.length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",d.jsx(kt,{to:"/budget/accounts",style:{color:fe.primaryLight},children:"Manage accounts "})]}),C&&d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx(ME,{accounts:k,accountGroups:l,payees:f,defaultAccountId:D,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:O,onCancel:()=>j(!1),submitLabel:"Add Income",isMobile:b})}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem"},children:[!b&&c?.income&&c.income.length>0&&d.jsx(n4,{}),c?.income.slice().sort((K,F)=>(K.date||"").localeCompare(F.date||"")).map(K=>z===K.id?d.jsx("div",{style:{padding:"0.5rem"},children:d.jsx(ME,{accounts:k,accountGroups:l,payees:f,initialData:K,onSubmit:(F,L,$,Y,Q)=>N(K.id,F,L,$,Y,Q),onCancel:()=>q(null),onDelete:()=>I(K.id),submitLabel:"Save",isMobile:b})},K.id):d.jsx(t4,{income:K,accountName:a[K.account_id]?.nickname||"Unknown Account",accountGroupName:a[K.account_id]?.account_group_id?l[a[K.account_id].account_group_id]?.name:void 0,onEdit:()=>q(K.id),onDelete:()=>I(K.id),isMobile:b},K.id)),(!c?.income||c.income.length===0)&&!C&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No income recorded for this month"})]})]})}function NE({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:c,defaultDate:h,onSubmit:f,onCancel:p,onDelete:_,submitLabel:v}){function b(S){f(S.amount,S.categoryId,S.accountId,S.date,S.payee,S.description,S.cleared)}return d.jsx(tT,{accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l?{date:l.date,payee:l.payee,categoryId:l.category_id,accountId:l.account_id,amount:l.amount,description:l.description,cleared:l.cleared}:void 0,defaultAccountId:c,defaultDate:h,config:{showCategory:!0,showCleared:!0,accountLabel:"Pay From",payeePlaceholder:"e.g., Grocery Store",descriptionPlaceholder:"e.g., Weekly groceries",submitLabel:v},onSubmit:b,onCancel:p,onDelete:_})}function rT(){const[t,e]=R.useState(()=>typeof window>"u"?!0:window.innerWidth>=Bi.wide);return R.useEffect(()=>{function n(){e(window.innerWidth>=Bi.wide)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}function i4({expense:t,categoryName:e,accountName:n,accountGroupName:i,onEdit:a,onDelete:l,isMobile:c}){const h=rT(),f=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",p=i?`${i} / ${n}`:n;return c?d.jsxs("div",{onClick:a,style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:f}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""}),t.cleared&&d.jsx("span",{style:{fontSize:"0.7rem",color:fe.success},title:"Cleared",children:""})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:{fontSize:"0.7rem",background:`color-mix(in srgb, ${fe.primary} 20%, transparent)`,color:fe.primaryLight,padding:"0.1rem 0.4rem",borderRadius:"3px"},children:e}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",p]})]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:fe.error,fontFamily:"monospace"},children:["-",ke(t.amount)]})})]}):h?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 8rem 6rem 1fr 3rem 4rem",gap:"0.75rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:_=>_.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:f}),d.jsx("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),d.jsx("span",{style:{fontSize:"0.8rem",background:`color-mix(in srgb, ${fe.primary} 15%, transparent)`,color:fe.primaryLight,padding:"0.2rem 0.5rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e}),d.jsx("span",{style:{fontSize:"0.85rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:p}),d.jsxs("span",{style:{fontWeight:600,color:fe.error,fontFamily:"monospace",textAlign:"right"},children:["-",ke(t.amount)]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description||""}),d.jsx("span",{style:{textAlign:"center",color:t.cleared?fe.success:"inherit",opacity:t.cleared?1:.3,fontSize:"1rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 7rem 6rem 3rem 4rem",gap:"0.5rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:_=>_.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:f}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),t.description&&d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]}),d.jsx("span",{style:{fontSize:"0.75rem",background:`color-mix(in srgb, ${fe.primary} 15%, transparent)`,color:fe.primaryLight,padding:"0.15rem 0.4rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n}),d.jsxs("span",{style:{fontWeight:600,color:fe.error,fontFamily:"monospace",textAlign:"right",fontSize:"0.9rem"},children:["-",ke(t.amount)]}),d.jsx("span",{style:{textAlign:"center",color:t.cleared?fe.success:"inherit",opacity:t.cleared?1:.3,fontSize:"0.9rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function s4(){return rT()?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 8rem 6rem 1fr 3rem 4rem",gap:"0.75rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{style:{textAlign:"center"},children:"Category"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{children:"Description"}),d.jsx("span",{style:{textAlign:"center"},children:"Clr"}),d.jsx("span",{})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 7rem 6rem 3rem 4rem",gap:"0.5rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{style:{textAlign:"center"},children:"Category"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{style:{textAlign:"center"},children:"Clr"}),d.jsx("span",{})]})}function a4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Sn(),{accounts:a,accountGroups:l,categories:c,categoryGroups:h}=Hn(t,e),{month:f,isLoading:p,payees:_,addExpense:v,updateExpense:b,deleteExpense:S}=Cl(t,n,i),T=Ki(),[C,j]=R.useState(null),[z,q]=R.useState(!1),[U,Z]=R.useState(null);function J(L){const $=L.account_group_id?l[L.account_group_id]:void 0;return $?.is_active!==void 0?$.is_active:L.is_active!==!1}function ne(L){const $=L.account_group_id?l[L.account_group_id]:void 0;return $?.on_budget!==void 0?$.on_budget:L.on_budget!==!1}const k=Object.entries(a).filter(([,L])=>J(L)&&ne(L)),A=k.filter(([,L])=>L.is_outgo_account),D=A.length>0?A:k,P=k.find(([,L])=>L.is_outgo_default),O=P?P[0]:void 0,N=f?.expenses?.reduce((L,$)=>L+$.amount,0)||0;function I(L,$,Y,Q,X,V,H){j(null),q(!1),v(L,$,Y,Q,X,V,H).catch(oe=>{j(oe instanceof Error?oe.message:"Failed to add expense")})}function K(L,$,Y,Q,X,V,H,oe){j(null),Z(null),b(L,$,Y,Q,X,V,H,oe).catch(se=>{j(se instanceof Error?se.message:"Failed to update expense")})}function F(L){confirm("Are you sure you want to delete this expense?")&&(j(null),S(L).catch($=>{j($ instanceof Error?$.message:"Failed to delete expense")}))}return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:p?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:p?"none":"auto"},children:[C&&d.jsx("div",{style:{background:`color-mix(in srgb, ${fe.error} 15%, transparent)`,border:`1px solid ${fe.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:fe.error},children:C}),d.jsx(e_,{label:"Total Expenses",value:d.jsxs("span",{style:{color:N>0?fe.error:"inherit"},children:[N>0?"-":"",ke(N)]}),action:!z&&d.jsx(Be,{onClick:()=>q(!0),disabled:D.length===0||Object.keys(c).length===0,children:"+ Add Expense"})}),D.length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",d.jsx(kt,{to:"/budget/accounts",style:{color:fe.primaryLight},children:"Manage accounts "})]}),Object.keys(c).length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:["You need to create at least one category before adding expenses."," ",d.jsx(kt,{to:"/budget/settings/categories",style:{color:fe.primaryLight},children:"Create categories "})]}),z&&d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx(NE,{accounts:D,accountGroups:l,categories:c,categoryGroups:h,payees:_,defaultAccountId:O,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:I,onCancel:()=>q(!1),submitLabel:"Add Expense",isMobile:T})}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem"},children:[!T&&f?.expenses&&f.expenses.length>0&&d.jsx(s4,{}),f?.expenses?.slice().sort((L,$)=>(L.date||"").localeCompare($.date||"")).map(L=>U===L.id?d.jsx("div",{style:{padding:"0.5rem"},children:d.jsx(NE,{accounts:D,accountGroups:l,categories:c,categoryGroups:h,payees:_,initialData:L,onSubmit:($,Y,Q,X,V,H,oe)=>K(L.id,$,Y,Q,X,V,H,oe),onCancel:()=>Z(null),onDelete:()=>F(L.id),submitLabel:"Save",isMobile:T})},L.id):d.jsx(i4,{expense:L,categoryName:c[L.category_id]?.name||"Unknown Category",accountName:a[L.account_id]?.nickname||"Unknown Account",accountGroupName:a[L.account_id]?.account_group_id?l[a[L.account_id].account_group_id]?.name:void 0,onEdit:()=>Z(L.id),onDelete:()=>F(L.id),isMobile:T},L.id)),(!f?.expenses||f.expenses.length===0)&&!z&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No expenses recorded for this month"})]})]})}function o4({accounts:t,accountGroups:e,accountBalances:n,isMobile:i}){const a=R.useMemo(()=>Object.entries(e).map(([c,h])=>({id:c,...h})).sort((c,h)=>c.sort_order-h.sort_order),[e]),l=R.useMemo(()=>{const c={};return Object.entries(t).forEach(([h,f])=>{const p=f.account_group_id||"ungrouped";c[p]||(c[p]=[]),c[p].push([h,f])}),Object.keys(c).forEach(h=>{c[h].sort((f,p)=>f[1].sort_order-p[1].sort_order)}),c},[t]);return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(t).length===0&&d.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No accounts yet."," ",d.jsx(kt,{to:"/budget/settings/accounts",style:{color:fe.primaryLight},children:"Add accounts "})]}),a.map(c=>{const h=l[c.id]||[];if(h.length===0)return null;const f=h.reduce((p,[_])=>{const v=n[_];return v?{start:p.start+v.start_balance,income:p.income+v.income,expenses:p.expenses+v.expenses,netChange:p.netChange+v.net_change,end:p.end+v.end_balance}:p},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(PE,{name:c.name,accounts:h,groupTotals:f,accountBalances:n,isMobile:i},c.id)}),l.ungrouped?.length>0&&(()=>{const c=l.ungrouped,h=c.reduce((f,[p])=>{const _=n[p];return _?{start:f.start+_.start_balance,income:f.income+_.income,expenses:f.expenses+_.expenses,netChange:f.netChange+_.net_change,end:f.end+_.end_balance}:f},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(PE,{name:"Ungrouped",accounts:c,groupTotals:h,accountBalances:n,isMobile:i,isUngrouped:!0},"ungrouped")})()]})}function PE({name:t,accounts:e,groupTotals:n,accountBalances:i,isMobile:a,isUngrouped:l}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Tl,margin:0,opacity:l?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"0.8rem",color:n.netChange>=0?fe.success:fe.error},children:[n.netChange>=0?"+":"",ke(n.netChange)]}),d.jsx("span",{style:{fontWeight:600,color:qt(n.end)},children:ke(n.end)})]})]}),!a&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Start"}),d.jsx("span",{style:{textAlign:"right"},children:"Net Change"}),d.jsx("span",{style:{textAlign:"right"},children:"End"}),d.jsx("span",{style:{textAlign:"right"}})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:e.map(([c,h])=>{const f=i[c];return f?a?d.jsx(l4,{account:h,balance:f},c):d.jsx(c4,{account:h,balance:f},c):null})})]})}function l4({account:t,balance:e}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.nickname})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:ke(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Net Change"}),d.jsxs("span",{style:{color:e.net_change>=0?fe.success:fe.error},children:[e.net_change>=0?"+":"",ke(e.net_change)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:qt(e.end_balance)},children:ke(e.end_balance)})]})]}),(e.income>0||e.expenses>0)&&d.jsxs("div",{style:{marginTop:"0.5rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)",display:"flex",gap:"1rem",fontSize:"0.7rem",opacity:.7},children:[e.income>0&&d.jsxs("span",{children:["+",ke(e.income)," income"]}),e.expenses>0&&d.jsxs("span",{children:["-",ke(e.expenses)," expenses"]})]})]})}function c4({account:t,balance:e}){return d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[d.jsxs("div",{style:{minWidth:0,overflow:"hidden"},children:[d.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.nickname}),(e.income>0||e.expenses>0)&&d.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5},children:[e.income>0&&`+${ke(e.income)}`,e.income>0&&e.expenses>0&&" / ",e.expenses>0&&`-${ke(e.expenses)}`]})]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:ke(e.start_balance)}),d.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.net_change>=0?fe.success:fe.error},children:[e.net_change>=0?"+":"",ke(e.net_change)]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:qt(e.end_balance)},children:ke(e.end_balance)}),d.jsx("span",{})]})}function u4({isFinalizingAllocations:t,monthLoading:e,onFinalize:n}){return d.jsxs("div",{style:{background:`color-mix(in srgb, ${fe.warning} 12%, transparent)`,border:`1px solid ${fe.warning}`,borderRadius:"8px",padding:"0.75rem 1rem",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("p",{style:{margin:0,fontWeight:600,color:fe.warning},children:" Allocations Not Applied"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:"Apply to update category balances."})]}),d.jsx(Be,{onClick:n,disabled:t||e,children:t?" Applying...":" Save & Apply"})]})}function d4({availableNow:t,currentDraftTotal:e,draftChangeAmount:n,availableAfterApply:i,allocationsFinalized:a}){return d.jsxs("div",{style:{background:`color-mix(in srgb, ${fe.primary} 8%, transparent)`,borderRadius:"8px",padding:"0.6rem 1rem",marginBottom:"1rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",fontSize:"0.9rem",flexWrap:"wrap"},children:[d.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.35rem"},children:[d.jsx("span",{style:{opacity:.6,fontSize:"0.75rem"},children:"Available"}),d.jsx("span",{style:{color:qt(t),fontWeight:600},children:ke(t)})]}),d.jsx("span",{style:{opacity:.4},children:a?n>=0?"":"+":""}),d.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.35rem"},children:[d.jsx("span",{style:{opacity:.6,fontSize:"0.75rem"},children:a?"Change":"Draft"}),d.jsx("span",{style:{color:a?n===0?"inherit":n>0?fe.warning:fe.success:fe.primary,fontWeight:600},children:a?n===0?"$0.00":ke(Math.abs(n)):ke(e)})]}),d.jsx("span",{style:{opacity:.4},children:"="}),d.jsxs("span",{style:{display:"flex",alignItems:"center",gap:"0.35rem"},children:[d.jsx("span",{style:{opacity:.6,fontSize:"0.75rem"},children:"If Applied"}),d.jsx("span",{style:{color:qt(i),fontWeight:600},children:ke(i)})]})]})}function LE({name:t,categories:e,groupEndBalance:n,groupAllocated:i,getCategoryBalance:a,localAllocations:l,previousMonthIncome:c,isDraftMode:h,onAllocationChange:f,isMobile:p,isUngrouped:_}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Tl,margin:0,opacity:_?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"0.8rem",opacity:.6},children:["+",ke(i)]}),d.jsx("span",{style:{fontWeight:600,color:qt(n)},children:ke(n)})]})]}),!p&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:h?"2fr 120px 1fr 1fr 1fr":"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[d.jsx("span",{children:"Category"}),d.jsx("span",{style:{textAlign:h?"center":"right"},children:"Allocated"}),d.jsx("span",{style:{textAlign:"right"},children:"Start"}),d.jsx("span",{style:{textAlign:"right"},children:"Spent"}),d.jsx("span",{style:{textAlign:"right"},children:"End"})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:h?"0.5rem":"0.25rem"},children:e.map(([v,b])=>{const S=a(v);return S?p?d.jsx(h4,{category:b,balance:S,localAllocation:l[v]||"",previousMonthIncome:c,isDraftMode:h,onAllocationChange:T=>f(v,T)},v):d.jsx(f4,{category:b,balance:S,localAllocation:l[v]||"",previousMonthIncome:c,isDraftMode:h,onAllocationChange:T=>f(v,T)},v):null})})]})}function h4({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l}){const c=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,h=c?t.default_monthly_amount/100*i:0,f=c?h.toFixed(2):n;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.name})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:ke(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),d.jsxs("span",{style:{color:e.allocated>0?fe.success:"inherit"},children:[e.allocated>0?"+":"",ke(e.allocated)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),d.jsxs("span",{style:{color:e.spent>0?fe.error:"inherit"},children:[e.spent>0?"-":"",ke(e.spent)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:qt(e.end_balance)},children:ke(e.end_balance)})]})]}),a&&d.jsx("div",{style:{marginTop:"0.5rem"},children:c?d.jsxs("span",{style:{fontSize:"0.8rem"},children:[d.jsxs("span",{style:{opacity:.6},children:[ke(i),"  "]}),d.jsxs("span",{style:{color:fe.primary},children:[t.default_monthly_amount,"%"]}),d.jsx("span",{style:{opacity:.6},children:" = "}),d.jsx("span",{style:{color:fe.primary},children:ke(h)})]}):d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{opacity:.6,fontSize:"0.75rem"},children:"Allocate:"}),d.jsx("input",{type:"text",inputMode:"decimal",value:f?`$${f}`:"",onChange:p=>{const _=p.target.value.replace(/[^\d.]/g,"");l(_)},placeholder:"$0",style:{width:"100px",padding:"0.35rem 0.5rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.85rem",color:"inherit",boxSizing:"border-box"}})]})})]})}function f4({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l}){const c=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,h=c?t.default_monthly_amount/100*i:0,f=c?h.toFixed(2):n;let p=null;return a&&!c&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&(p=ke(t.default_monthly_amount)),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:a?"2fr 120px 1fr 1fr 1fr":"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[d.jsxs("div",{style:{minWidth:0,overflow:"hidden"},children:[d.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),p&&d.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5},children:["Suggested: ",p]})]}),a?d.jsx("div",{children:c?d.jsxs("div",{style:{textAlign:"center",fontSize:"0.8rem"},children:[d.jsxs("span",{style:{opacity:.5},children:[ke(i),"  "]}),d.jsxs("span",{style:{color:fe.primary},children:[t.default_monthly_amount,"%"]}),d.jsxs("span",{style:{display:"block",marginTop:"0.15rem"},children:[d.jsx("span",{style:{opacity:.5},children:"= "}),d.jsx("span",{style:{color:fe.primary},children:ke(h)})]})]}):d.jsx("input",{type:"text",inputMode:"decimal",value:f?`$${f}`:"",onChange:_=>{const v=_.target.value.replace(/[^\d.]/g,"");l(v)},placeholder:"$0.00",style:{width:"100%",padding:"0.4rem 0.5rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box"}})}):d.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.allocated>0?fe.success:"inherit"},children:[e.allocated>0?"+":"",ke(e.allocated)]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:ke(e.start_balance)}),d.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.spent>0?fe.error:"inherit"},children:[e.spent>0?"-":"",ke(e.spent)]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:qt(e.end_balance)},children:ke(e.end_balance)})]})}const VE=["categories","accounts"];function m4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,lastBalancesView:a,setLastBalancesView:l}=Sn(),{categories:c,categoryGroups:h,accounts:f,accountGroups:p}=Hn(t,e),{month:_,isLoading:v}=Cl(t,n,i),b=Ki(),[S,T]=AR(),C=()=>{const Ie=S.get("view");return Ie&&VE.includes(Ie)?Ie:a},[j,z]=R.useState(C),[q,U]=R.useState(!1),Z=Ie=>{z(Ie),l(Ie),T({view:Ie},{replace:!0})};R.useEffect(()=>{const Ie=S.get("view");(!Ie||!VE.includes(Ie))&&T({view:a},{replace:!0})},[]);const{localAllocations:J,isSavingAllocations:ne,isFinalizingAllocations:k,isDeletingAllocations:A,isEditingAppliedAllocations:D,error:P,availableNow:O,currentDraftTotal:N,draftChangeAmount:I,availableAfterApply:K,previousMonthIncome:F,allocationsFinalized:L,getAllocationAmount:$,handleAllocationChange:Y,resetAllocationsToSaved:Q,handleSaveAllocations:X,handleFinalizeAllocations:V,handleDeleteAllocations:H,setIsEditingAppliedAllocations:oe,setError:se}=L6(),te=[...h].sort((Ie,ze)=>Ie.sort_order-ze.sort_order),ge=R.useMemo(()=>{const Ie=Object.entries(c).reduce((ze,[Je,Ct])=>{const Ke=Ct.category_group_id||"ungrouped";return ze[Ke]||(ze[Ke]=[]),ze[Ke].push([Je,Ct]),ze},{});return Object.keys(Ie).forEach(ze=>{Ie[ze].sort((Je,Ct)=>Je[1].sort_order-Ct[1].sort_order)}),Ie},[c]),xe=k||A,pe=!L||D,Ee=R.useMemo(()=>{const Ie=_?.previous_month_snapshot?.category_balances_end??{},ze={};return Object.entries(c).forEach(([Je,Ct])=>{const Ke=Ie[Je]??0;let Ue=0;if(pe)Ue=$(Je,Ct);else if(L&&_?.allocations){const Mt=_.allocations.find(fn=>fn.category_id===Je);Mt&&(Ue=Mt.amount)}let lt=0;_?.expenses&&(lt=_.expenses.filter(Mt=>Mt.category_id===Je).reduce((Mt,fn)=>Mt+fn.amount,0)),ze[Je]={category_id:Je,start_balance:Ke,allocated:Ue,spent:lt,end_balance:Ke+Ue-lt}}),ze},[_,c,pe,L,$]),he=Ie=>Ee[Ie],Re=R.useMemo(()=>{const Ie=_?.previous_month_snapshot?.account_balances_end??{},ze={};return Object.entries(f).forEach(([Je,Ct])=>{const Ke=Ie[Je]??Ct.balance;let Ue=0;_?.income&&(Ue=_.income.filter(fn=>fn.account_id===Je).reduce((fn,Dn)=>fn+Dn.amount,0));let lt=0;_?.expenses&&(lt=_.expenses.filter(fn=>fn.account_id===Je).reduce((fn,Dn)=>fn+Dn.amount,0));const Mt=Ue-lt;ze[Je]={account_id:Je,start_balance:Ke,income:Ue,expenses:lt,net_change:Mt,end_balance:Ke+Mt}}),ze},[_,f]),De=R.useMemo(()=>Object.values(Re).reduce((Ie,ze)=>({start:Ie.start+ze.start_balance,income:Ie.income+ze.income,expenses:Ie.expenses+ze.expenses,netChange:Ie.netChange+ze.net_change,end:Ie.end+ze.end_balance}),{start:0,income:0,expenses:0,netChange:0,end:0}),[Re]),vt=R.useMemo(()=>Object.values(Ee).reduce((Ie,ze)=>({start:Ie.start+ze.start_balance,allocated:Ie.allocated+ze.allocated,spent:Ie.spent+ze.spent,end:Ie.end+ze.end_balance}),{start:0,allocated:0,spent:0,end:0}),[Ee]);return d.jsxs("div",{style:{opacity:v?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:v?"none":"auto"},children:[d.jsx(j6,{isVisible:xe,message:A?"Deleting allocations...":"Saving allocations..."}),P&&d.jsx(Al,{message:P,onDismiss:()=>se(null)}),d.jsx(S6,{items:j==="categories"?[{label:"Start of Month",value:d.jsx("span",{style:{color:qt(vt.start)},children:ke(vt.start)})},{label:pe?"Draft Allocations":"Allocated",value:d.jsxs("span",{style:{color:pe?fe.primary:fe.success},children:["+",ke(vt.allocated)]})},{label:"Spent",value:d.jsxs("span",{style:{color:fe.error},children:["-",ke(vt.spent)]})},{label:"End of Month",value:d.jsx("span",{style:{color:qt(vt.end)},children:ke(vt.end)})}]:[{label:"Start of Month",value:d.jsx("span",{style:{color:qt(De.start)},children:ke(De.start)})},{label:"Income",value:d.jsxs("span",{style:{color:fe.success},children:["+",ke(De.income)]})},{label:"Expenses",value:d.jsxs("span",{style:{color:fe.error},children:["-",ke(De.expenses)]})},{label:"End of Month",value:d.jsx("span",{style:{color:qt(De.end)},children:ke(De.end)})}]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:[d.jsx(Be,{onClick:()=>Z(j==="categories"?"accounts":"categories"),variant:"secondary",style:{fontSize:"0.85rem"},children:j==="categories"?" Switch to Account Balances":" Switch to Category Balances"}),j==="categories"&&!pe&&L&&d.jsx(Be,{onClick:()=>oe(!0),variant:"secondary",style:{fontSize:"0.85rem"},children:" Edit Allocations"})]}),j==="accounts"&&d.jsx(o4,{accounts:f,accountGroups:p,accountBalances:Re,isMobile:b}),j==="categories"&&d.jsxs(d.Fragment,{children:[pe&&d.jsx(e_,{label:D?"Editing Allocations":"Draft Allocations",value:null,compact:!0,action:d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[d.jsx(Be,{onClick:D?V:X,disabled:ne||k||v,variant:"secondary",style:{padding:"0.35rem 0.75rem",fontSize:"0.85rem"},children:ne||k?"...":D?" Apply":" Save"}),L&&D&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:Q,disabled:k||A||v,style:{background:"transparent",border:"none",cursor:k||A||v?"not-allowed":"pointer",padding:"0.25rem",opacity:k||A||v?.5:.7,fontSize:"1rem",lineHeight:1},title:"Cancel Editing",children:""}),d.jsx("button",{onClick:()=>U(!0),disabled:A||v,style:{background:"transparent",border:"none",cursor:A||v?"not-allowed":"pointer",padding:"0.25rem",opacity:A||v?.5:.7,fontSize:"1rem",lineHeight:1,color:fe.error},title:"Delete Allocations",children:""})]})]})}),pe&&d.jsx(d4,{availableNow:O,currentDraftTotal:N,draftChangeAmount:I,availableAfterApply:K,allocationsFinalized:L}),pe&&!D&&d.jsx(u4,{isFinalizingAllocations:k,monthLoading:v,onFinalize:V}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(c).length===0&&d.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",d.jsx(kt,{to:"/budget/settings/categories",style:{color:fe.primaryLight},children:"Create categories "})]}),te.map(Ie=>{const ze=ge[Ie.id]||[];if(ze.length===0)return null;const Je=ze.reduce((Ct,[Ke])=>{const Ue=he(Ke);return Ue?{start:Ct.start+Ue.start_balance,allocated:Ct.allocated+Ue.allocated,spent:Ct.spent+Ue.spent,end:Ct.end+Ue.end_balance}:Ct},{start:0,allocated:0,spent:0,end:0});return d.jsx(LE,{name:Ie.name,categories:ze,groupEndBalance:Je.end,groupAllocated:Je.allocated,getCategoryBalance:he,localAllocations:J,previousMonthIncome:F,isDraftMode:pe,onAllocationChange:Y,isMobile:b},Ie.id)}),ge.ungrouped?.length>0&&(()=>{const Ie=ge.ungrouped,ze=Ie.reduce((Je,[Ct])=>{const Ke=he(Ct);return Ke?{start:Je.start+Ke.start_balance,allocated:Je.allocated+Ke.allocated,spent:Je.spent+Ke.spent,end:Je.end+Ke.end_balance}:Je},{start:0,allocated:0,spent:0,end:0});return d.jsx(LE,{name:"Uncategorized",categories:Ie,groupEndBalance:ze.end,groupAllocated:ze.allocated,getCategoryBalance:he,localAllocations:J,previousMonthIncome:F,isDraftMode:pe,onAllocationChange:Y,isMobile:b,isUngrouped:!0},"ungrouped")})()]})]}),d.jsxs(ru,{isOpen:q,onClose:()=>U(!1),title:"Delete Allocations",children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to delete all allocations for this month? This will remove all allocated amounts and reset the month to unfinalized."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Be,{variant:"secondary",onClick:()=>U(!1),children:"Cancel"}),d.jsx(Be,{variant:"danger",onClick:()=>{U(!1),H()},children:"Delete Allocations"})]})]})]})}const p4=["income","balances","spend"];function BE(t){const e=t.year?parseInt(t.year,10):null,n=t.month?parseInt(t.month,10):null,i=t.tab&&p4.includes(t.tab)?t.tab:null;return{year:e&&!isNaN(e)&&e>=2e3&&e<=2100?e:null,month:n&&!isNaN(n)&&n>=1&&n<=12?n:null,tab:i}}function zE(){const t=NC(),e=su(),{currentUserId:n,selectedBudgetId:i,currentYear:a,currentMonthNumber:l,lastActiveTab:c,setCurrentYear:h,setCurrentMonthNumber:f,setLastActiveTab:p,goToPreviousMonth:_,goToNextMonth:v,hasPendingInvites:b,pendingInvites:S,needsFirstBudget:T}=Sn(),{budget:C,createBudget:j,acceptInvite:z}=Hn(i,n),{month:q,isLoading:U}=Cl(i,a,l),[Z,J]=R.useState(null),ne=R.useRef(!1),[k,A]=R.useState(()=>{const{tab:K}=BE(t);return K??c}),D=K=>{A(K),p(K)};R.useEffect(()=>{if(ne.current)return;const{year:K,month:F}=BE(t);K&&h(K),F&&f(F),ne.current=!0},[t,h,f]),R.useEffect(()=>{if(!ne.current)return;const K=`/budget/${a}/${l}/${k}`,F=`/budget/${t.year}/${t.month}/${t.tab}`;K!==F&&e(K,{replace:!0})},[a,l,k,e,t]);async function P(K){try{await z(K)}catch(F){J(F instanceof Error?F.message:"Failed to accept invite")}}async function O(K){try{await j(K||"My Budget")}catch(F){J(F instanceof Error?F.message:"Failed to create budget")}}if(!C&&b)return d.jsxs(Xo,{children:[d.jsx(fi,{title:"Budget",showBackArrow:!0,hideMenu:!0}),d.jsx(K6,{invites:S,onAccept:P,onCreateNew:O})]});if(!C&&T)return d.jsxs(Xo,{children:[d.jsx(fi,{title:"Budget",showBackArrow:!0,hideMenu:!0}),d.jsx($6,{onCreateNew:O})]});function N(){J(null),_()}function I(){J(null),v()}return d.jsxs(Xo,{children:[d.jsx(fi,{title:C?.name||"Budget"}),d.jsxs(I6,{children:[Z&&d.jsx(Al,{message:Z,onDismiss:()=>J(null)}),d.jsx(X6,{isLoading:U,onPreviousMonth:N,onNextMonth:I}),d.jsx(W6,{activeTab:k,setActiveTab:D,allocationsFinalized:q?.allocations_finalized}),k==="income"&&d.jsx(r4,{}),k==="balances"&&d.jsx(m4,{}),k==="spend"&&d.jsx(a4,{})]})]})}function g4(){return d.jsxs(Xo,{children:[d.jsx(fi,{title:"Analytics"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[d.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),d.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),d.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),d.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),d.jsx(kt,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:fe.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})]})}function Yh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,accountGroups:a,showGroupSelector:l=!1,showIncomeSettings:c=!1,hasExistingIncomeDefault:h=!1,hasExistingOutgoDefault:f=!1,currentGroupId:p}){const[_,v]=R.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),b=_.account_group_id||p,S=b?a.find(U=>U.id===b):null,T=S?.is_active!==void 0,C=S?.on_budget!==void 0;function j(U){U.preventDefault(),_.nickname.trim()&&e(_)}function z(U){v({..._,is_income_account:U,is_income_default:U?_.is_income_default:!1})}function q(U){v({..._,is_outgo_account:U,is_outgo_default:U?_.is_outgo_default:!1})}return d.jsxs(Us,{onSubmit:j,children:[d.jsx(Tt,{label:"Account Nickname",htmlFor:"account-nickname",children:d.jsx(Fs,{id:"account-nickname",type:"text",value:_.nickname,onChange:U=>v({..._,nickname:U.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&d.jsx(Tt,{label:"Account Type",htmlFor:"account-group",children:d.jsxs(nu,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:U=>v({..._,account_group_id:U.target.value==="ungrouped"?null:U.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Ungrouped"}),a.map(U=>d.jsx("option",{value:U.id,children:U.name},U.id))]})}),c&&d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(Rs,{id:"is-active",checked:T?S.is_active:_.is_active!==!1,onChange:U=>v({..._,is_active:U.target.checked}),disabled:T,children:d.jsx("span",{style:{opacity:T?.5:1},children:"Active account"})}),T&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:fe.warning},children:['Set by account type "',S.name,'"']})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(Rs,{id:"on-budget",checked:C?S.on_budget:_.on_budget!==!1,onChange:U=>v({..._,on_budget:U.target.checked}),disabled:C,children:d.jsx("span",{style:{opacity:C?.5:1},children:"On budget (affects budget totals)"})}),C&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:fe.warning},children:['Set by account type "',S.name,'"']})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),d.jsx(Rs,{id:"is-income-account",checked:_.is_income_account||!1,onChange:U=>z(U.target.checked),children:"Show in income deposit list"}),_.is_income_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(Rs,{id:"is-income-default",checked:_.is_income_default||!1,onChange:U=>v({..._,is_income_default:U.target.checked}),disabled:h&&!t?.is_income_default,children:"Default account for new income"}),h&&!t?.is_income_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),d.jsx(Rs,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:U=>q(U.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(Rs,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:U=>v({..._,is_outgo_default:U.target.checked}),disabled:f&&!t?.is_outgo_default,children:"Default account for new expenses"}),f&&!t?.is_outgo_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),d.jsxs(Fa,{children:[d.jsx(Be,{type:"submit",children:i}),d.jsx(Be,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function UE({label:t,value:e,onChange:n,trueLabel:i,falseLabel:a,undefinedLabel:l}){function c(){n(e===void 0?!0:e===!0?!1:void 0)}const h=e===!0?i:e===!1?a:l,f=e===!0?fe.success:e===!1?fe.warning:"inherit",p=e===!0?"":e===!1?"":"";return d.jsxs("button",{type:"button",onClick:c,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${f} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${f} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[d.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?f:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:p}),d.jsxs("span",{style:{flex:1},children:[d.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",d.jsx("span",{style:{fontWeight:500,color:f},children:h})]}),d.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function iT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=R.useState(t||{name:"",expected_balance:"positive"});function c(h){h.preventDefault(),a.name.trim()&&e(a)}return d.jsxs(Us,{onSubmit:c,children:[d.jsx(Tt,{label:"Account Type Name",htmlFor:"group-name",children:d.jsx(Fs,{id:"group-name",type:"text",value:a.name,onChange:h=>l({...a,name:h.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),d.jsx(Tt,{label:"Expected Balance",htmlFor:"expected-balance",children:d.jsxs(nu,{id:"expected-balance",value:a.expected_balance,onChange:h=>l({...a,expected_balance:h.target.value}),children:[d.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),d.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),d.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",d.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),d.jsx(UE,{label:"Active status",value:a.is_active,onChange:h=>l({...a,is_active:h}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),d.jsx(UE,{label:"Budget status",value:a.on_budget,onChange:h=>l({...a,on_budget:h}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),d.jsxs(Fa,{children:[d.jsx(Be,{type:"submit",children:i}),d.jsx(Be,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function ko({icon:t,label:e,variant:n,title:i}){const l={success:{background:`color-mix(in srgb, ${fe.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${fe.success} 40%, transparent)`,color:fe.success,opacity:1},warning:{background:`color-mix(in srgb, ${fe.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${fe.warning} 35%, transparent)`,color:fe.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${fe.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${fe.success} 25%, transparent)`,color:fe.success,opacity:.7},expense:{background:`color-mix(in srgb, ${fe.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${fe.warning} 25%, transparent)`,color:fe.warning,opacity:.7}}[n];return d.jsxs("span",{title:i||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[d.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function sT({account:t,accountGroups:e}){const n=[],i=t.account_group_id?e.find(c=>c.id===t.account_group_id):null,a=i?.is_active!==void 0?i.is_active:t.is_active!==!1,l=i?.on_budget!==void 0?i.on_budget:t.on_budget!==!1;if(!a){const c=i?.is_active!==void 0;n.push(d.jsx(ko,{icon:"",label:c?"Inactive (type)":"Inactive",variant:"warning",title:c?`Set by "${i.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const c=i?.on_budget!==void 0;n.push(d.jsx(ko,{icon:"",label:c?"Off Budget (type)":"Off Budget",variant:"warning",title:c?`Set by "${i.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(d.jsx(ko,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(d.jsx(ko,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(d.jsx(ko,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(d.jsx(ko,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:d.jsx(d.Fragment,{children:n})}function y4({group:t}){const e=[];return t.is_active===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${fe.warning} 20%, transparent)`,color:fe.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${fe.success} 20%, transparent)`,color:fe.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${fe.warning} 20%, transparent)`,color:fe.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${fe.success} 20%, transparent)`,color:fe.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:d.jsx(d.Fragment,{children:e})}function aT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:fe.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function _4(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function v4(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function b4({group:t,groupIndex:e,totalGroups:n,accounts:i,allGroups:a,allAccounts:l,editingAccountId:c,editingGroupId:h,createForGroupId:f,setEditingAccountId:p,setEditingGroupId:_,setCreateForGroupId:v,dragType:b,draggedId:S,dragOverId:T,dragOverGroupId:C,setDragOverId:j,setDragOverGroupId:z,onAccountDragStart:q,onAccountDragOver:U,onAccountDrop:Z,onGroupDragStart:J,onGroupDragOver:ne,onGroupDrop:k,onDragLeave:A,onDragLeaveGroup:D,onDragEnd:P,onDropOnGroup:O,onCreateAccount:N,onUpdateAccount:I,onDeleteAccount:K,onMoveAccount:F,onUpdateGroup:L,onDeleteGroup:$,onMoveGroup:Y}){const Q=Ki(),X=[...i].sort((he,Re)=>he.sort_order-Re.sort_order),V=b==="group"&&S===t.id,H=b==="group"&&T===t.id,oe=b==="account"&&C===t.id,te=(S&&b==="account"?l[S]:null)&&Object.entries(l).find(([he])=>he===S)?.[1]&&Object.entries(l).find(([he])=>he===S)?.[1]?.account_group_id!==t.id,ge=b==="group"&&H&&S!==t.id,xe=e>0,pe=e<n-1,Ee=X.reduce((he,Re)=>he+Re.balance,0);return d.jsxs("div",{children:[b==="group"&&!V&&d.jsxs("div",{onDragOver:he=>{he.preventDefault(),j(t.id)},onDragLeave:A,onDrop:he=>k(he,t.id),style:{position:"relative",height:ge?"2.5rem":"0.5rem",marginBottom:ge?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:fe.primary,borderRadius:"2px",opacity:ge?1:0,transition:"opacity 0.15s",boxShadow:ge?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),ge&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{draggable:h!==t.id,onDragStart:he=>J(he,t.id),onDragOver:he=>ne(he,t.id),onDragLeave:D,onDragEnd:P,onDrop:he=>O(he,t.id),style:{background:V?"color-mix(in srgb, currentColor 3%, transparent)":oe&&te?`color-mix(in srgb, ${fe.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:V?.5:1,border:oe&&te?`2px dashed ${fe.primary}`:"2px solid transparent",cursor:h===t.id?"default":"grab",transition:"all 0.15s"},children:h===t.id?d.jsx(iT,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:he=>L(t.id,he),onCancel:()=>_(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsx(x4,{group:t,accountCount:X.length,groupTotal:Ee,canMoveUp:xe,canMoveDown:pe,isMobile:Q,createForGroupId:f,onEdit:()=>_(t.id),onDelete:()=>$(t.id),onMoveUp:()=>Y(t.id,"up"),onMoveDown:()=>Y(t.id,"down"),onAddAccount:()=>v(t.id)}),Q&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Be,{variant:"small",onClick:()=>v(t.id),disabled:f!==null,children:"+ Account"})}),d.jsxs("div",{style:ll,children:[X.map((he,Re)=>c===he.id?d.jsx(Yh,{initialData:{nickname:he.nickname,account_group_id:he.account_group_id,is_income_account:he.is_income_account,is_income_default:he.is_income_default,is_outgo_account:he.is_outgo_account,is_outgo_default:he.is_outgo_default,on_budget:he.on_budget,is_active:he.is_active},onSubmit:De=>I(he.id,De),onCancel:()=>p(null),submitLabel:"Save",accountGroups:a,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:he.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([De,vt])=>vt.is_income_default&&De!==he.id),hasExistingOutgoDefault:Object.entries(l).some(([De,vt])=>vt.is_outgo_default&&De!==he.id)},he.id):d.jsx(Rf,{isDragging:b==="account"&&S===he.id,isDragOver:T===he.id,onDragStart:De=>{De.stopPropagation(),q(De,he.id)},onDragOver:De=>U(De,he.id,t.id),onDragLeave:A,onDragEnd:P,onDrop:De=>Z(De,he.id,t.id),onEdit:()=>p(he.id),onDelete:()=>K(he.id),onMoveUp:()=>F(he.id,"up"),onMoveDown:()=>F(he.id,"down"),canMoveUp:Re>0,canMoveDown:Re<X.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Wy,children:he.nickname}),d.jsx(sT,{account:he,accountGroups:a})]}),d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:qt(he.balance)},children:[ke(he.balance),_4(he.balance,t.expected_balance)&&d.jsx("span",{title:v4(he.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},he.id)),X.length===0&&!f&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),b==="account"&&X.length>0&&d.jsx(aT,{groupId:t.id,isActive:T===`__end__${t.id}`,onDragOver:he=>{he.preventDefault(),he.stopPropagation(),j(`__end__${t.id}`),z(t.id)},onDragLeave:he=>{he.stopPropagation(),j(null)},onDrop:he=>{he.stopPropagation(),Z(he,"__group_end__",t.id)}}),f===t.id&&d.jsx(Yh,{initialData:{nickname:"",account_group_id:t.id},onSubmit:he=>N(he,t.id),onCancel:()=>v(null),submitLabel:"Create",accountGroups:a,showIncomeSettings:!0,currentGroupId:t.id})]}),f!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Be,{variant:"small",onClick:()=>v(t.id),disabled:f!==null,children:"+ Add Account"})})]})})]})}function x4({group:t,accountCount:e,groupTotal:n,canMoveUp:i,canMoveDown:a,isMobile:l,createForGroupId:c,onEdit:h,onDelete:f,onMoveUp:p,onMoveDown:_,onAddAccount:v}){return d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{...Tl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&d.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:qt(n),flexShrink:0},children:ke(n)}),d.jsx(y4,{group:t})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&d.jsx(Be,{variant:"small",onClick:v,disabled:c!==null,children:"+ Account"}),d.jsx("button",{onClick:h,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),d.jsx("button",{onClick:f,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),d.jsxs("div",{style:Ky,children:[d.jsx("button",{onClick:p,disabled:!i,style:{...ol,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:_,disabled:!a,style:{...ol,opacity:a?.6:.2,cursor:a?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function E4({accounts:t,allGroups:e,allAccounts:n,hasGroups:i,editingAccountId:a,createForGroupId:l,setEditingAccountId:c,setCreateForGroupId:h,dragType:f,draggedId:p,dragOverId:_,dragOverGroupId:v,setDragOverId:b,setDragOverGroupId:S,onAccountDragStart:T,onAccountDragOver:C,onAccountDrop:j,onDragOverGroup:z,onDropOnGroup:q,onDragLeave:U,onDragLeaveGroup:Z,onDragEnd:J,onCreateAccount:ne,onUpdateAccount:k,onDeleteAccount:A,onMoveAccount:D}){const P=[...t].sort((F,L)=>F.sort_order-L.sort_order),O=f==="account"&&v==="ungrouped",I=(p&&f==="account"?n[p]:null)&&Object.entries(n).find(([F])=>F===p)?.[1]&&Object.entries(n).find(([F])=>F===p)?.[1]?.account_group_id!==null;if(P.length===0&&!l&&i&&f!=="account")return null;const K=P.reduce((F,L)=>F+L.balance,0);return d.jsxs("div",{onDragOver:F=>z(F,"ungrouped"),onDragLeave:Z,onDrop:F=>q(F,"ungrouped"),style:{background:O&&I?`color-mix(in srgb, ${fe.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:O&&I?`2px dashed ${fe.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Tl,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",P.length,")"]}),P.length>0&&d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:qt(K)},children:ke(K)})]}),d.jsx(Be,{variant:"small",onClick:()=>h("ungrouped"),disabled:l!==null,children:"+ Account"})]}),d.jsxs("div",{style:ll,children:[P.map((F,L)=>a===F.id?d.jsx(Yh,{initialData:{nickname:F.nickname,account_group_id:F.account_group_id,is_income_account:F.is_income_account,is_income_default:F.is_income_default,is_outgo_account:F.is_outgo_account,is_outgo_default:F.is_outgo_default,on_budget:F.on_budget,is_active:F.is_active},onSubmit:$=>k(F.id,$),onCancel:()=>c(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([$,Y])=>Y.is_income_default&&$!==F.id),hasExistingOutgoDefault:Object.entries(n).some(([$,Y])=>Y.is_outgo_default&&$!==F.id)},F.id):d.jsx(Rf,{isDragging:f==="account"&&p===F.id,isDragOver:_===F.id,onDragStart:$=>T($,F.id),onDragOver:$=>C($,F.id,"ungrouped"),onDragLeave:U,onDragEnd:J,onDrop:$=>j($,F.id,"ungrouped"),onEdit:()=>c(F.id),onDelete:()=>A(F.id),onMoveUp:()=>D(F.id,"up"),onMoveDown:()=>D(F.id,"down"),canMoveUp:L>0,canMoveDown:L<P.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Wy,children:F.nickname}),d.jsx(sT,{account:F,accountGroups:e})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:qt(F.balance)},children:ke(F.balance)})]})},F.id)),P.length===0&&f==="account"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),f==="account"&&P.length>0&&d.jsx(aT,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:F=>{F.preventDefault(),F.stopPropagation(),b("__end__ungrouped"),S("ungrouped")},onDragLeave:F=>{F.stopPropagation(),b(null)},onDrop:F=>{F.stopPropagation(),j(F,"__group_end__","ungrouped")}}),l==="ungrouped"&&d.jsx(Yh,{initialData:{nickname:"",account_group_id:null},onSubmit:F=>ne(F,"ungrouped"),onCancel:()=>h(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Be,{variant:"small",onClick:()=>h("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function S4(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:i,error:a,setError:l,handleCreateAccount:c,handleUpdateAccount:h,handleDeleteAccount:f,handleMoveAccount:p,handleCreateGroup:_,handleUpdateGroup:v,handleDeleteGroup:b,handleMoveGroup:S,reorderAccountsInGroup:T,reorderGroups:C}=P6(),j=Ki(),[z,q]=R.useState(null),[U,Z]=R.useState(null),[J,ne]=R.useState(null),[k,A]=R.useState(!1),[D,P]=R.useState(null),[O,N]=R.useState(null),[I,K]=R.useState(null),[F,L]=R.useState(null);function $(pe,Ee){P("account"),N(Ee),pe.dataTransfer.effectAllowed="move"}function Y(pe,Ee,he){pe.preventDefault(),D==="account"&&(Ee!==O&&K(Ee),L(he))}function Q(pe,Ee){pe.preventDefault(),D==="account"?(L(Ee),K(null)):D==="group"&&Ee!==O&&K(Ee)}function X(){K(null)}function V(){L(null)}function H(){P(null),N(null),K(null),L(null)}async function oe(pe,Ee,he){if(pe.preventDefault(),pe.stopPropagation(),!O||D!=="account"){H();return}await T(O,Ee,he),H()}async function se(pe,Ee){pe.preventDefault(),D==="account"?await oe(pe,"__group_end__",Ee):D==="group"&&await ge(pe,Ee)}function te(pe,Ee){pe.stopPropagation(),P("group"),N(Ee),pe.dataTransfer.effectAllowed="move"}async function ge(pe,Ee){if(pe.preventDefault(),!O||D!=="group"||O===Ee){H();return}await C(O,Ee),H()}if(!i)return d.jsx("p",{children:"No budget found. Please log in."});const xe=e.ungrouped||[];return d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Accounts"}),d.jsxs("p",{style:tu,children:["Organize your financial accounts by type.",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"0.9rem"},children:j?"Use  buttons to reorder items, or drag to move between types.":"Drag accounts between types, or use  buttons to reorder."})]}),a&&d.jsx(Al,{message:a,onDismiss:()=>l(null)}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:d.jsx(t_,{})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(t).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((pe,Ee)=>d.jsx(b4,{group:pe,groupIndex:Ee,totalGroups:n.length,accounts:e[pe.id]||[],allGroups:n,allAccounts:t,editingAccountId:z,editingGroupId:J,createForGroupId:U,setEditingAccountId:q,setEditingGroupId:ne,setCreateForGroupId:Z,dragType:D,draggedId:O,dragOverId:I,dragOverGroupId:F,setDragOverId:K,setDragOverGroupId:L,onAccountDragStart:$,onAccountDragOver:Y,onAccountDrop:oe,onGroupDragStart:te,onGroupDragOver:Q,onGroupDrop:ge,onDragLeave:X,onDragLeaveGroup:V,onDragEnd:H,onDropOnGroup:se,onCreateAccount:c,onUpdateAccount:(he,Re)=>{h(he,Re),q(null)},onDeleteAccount:f,onMoveAccount:p,onUpdateGroup:(he,Re)=>{v(he,Re),ne(null)},onDeleteGroup:b,onMoveGroup:S},pe.id)),D==="group"&&n.length>0&&d.jsx(Xy,{isActive:I==="__end__",onDragOver:pe=>{pe.preventDefault(),K("__end__")},onDragLeave:X,onDrop:pe=>ge(pe,"__end__"),label:"Move account type to end"}),d.jsx(E4,{accounts:xe,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:z,createForGroupId:U,setEditingAccountId:q,setCreateForGroupId:Z,dragType:D,draggedId:O,dragOverId:I,dragOverGroupId:F,setDragOverId:K,setDragOverGroupId:L,onAccountDragStart:$,onAccountDragOver:Y,onAccountDrop:oe,onDragOverGroup:Q,onDropOnGroup:se,onDragLeave:X,onDragLeaveGroup:V,onDragEnd:H,onCreateAccount:c,onUpdateAccount:(pe,Ee)=>{h(pe,Ee),q(null)},onDeleteAccount:f,onMoveAccount:p})]}),k?d.jsx(iT,{onSubmit:pe=>{_(pe),A(!1)},onCancel:()=>A(!1),submitLabel:"Create Account Type"}):d.jsx(Be,{variant:"primary-large",onClick:()=>A(!0),children:"+ Add Account Type"})]})}function Xh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,categoryGroups:a=[],showGroupSelector:l=!1}){const[c,h]=R.useState(t||{name:"",category_group_id:null}),[f,p]=R.useState(t?.default_monthly_amount?.toString()||""),[_,v]=R.useState(t?.default_monthly_type||"fixed"),[b,S]=R.useState(!1);function T(C){if(C.preventDefault(),!c.name.trim())return;S(!0);const j=parseFloat(f),z=!isNaN(j)&&j>0;e({...c,description:c.description?.trim()||void 0,default_monthly_amount:z?j:void 0,default_monthly_type:z?_:void 0})}return d.jsxs(Us,{onSubmit:T,children:[d.jsx(Tt,{label:"Category Name",htmlFor:"category-name",children:d.jsx(Fs,{id:"category-name",type:"text",value:c.name,onChange:C=>h({...c,name:C.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),d.jsx(Tt,{label:"Description (optional)",htmlFor:"category-description",children:d.jsx(Yy,{id:"category-description",value:c.description||"",onChange:C=>h({...c,description:C.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&d.jsx(Tt,{label:"Category Group",htmlFor:"category-group",children:d.jsxs(nu,{id:"category-group",value:c.category_group_id||"ungrouped",onChange:C=>h({...c,category_group_id:C.target.value==="ungrouped"?null:C.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Uncategorized"}),a.map(C=>d.jsx("option",{value:C.id,children:C.name},C.id))]})}),d.jsxs(Tt,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[d.jsxs(nu,{id:"default-type",value:_,onChange:C=>v(C.target.value),style:{width:"auto",flex:"0 0 auto"},children:[d.jsx("option",{value:"fixed",children:"Fixed $"}),d.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?d.jsx(Eh,{id:"default-amount",value:f,onChange:p,placeholder:"$0.00"}):d.jsx(Fs,{id:"default-amount",type:"number",value:f,onChange:C=>p(C.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&d.jsx("span",{style:{opacity:.6},children:"%"})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),d.jsxs(Fa,{children:[d.jsx(Be,{type:"submit",isLoading:b,children:i}),d.jsx(Be,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function oT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=R.useState(t||{name:""}),[c,h]=R.useState(!1);function f(p){p.preventDefault(),a.name.trim()&&(h(!0),e(a))}return d.jsxs(Us,{onSubmit:f,children:[d.jsx(Tt,{label:"Group Name",htmlFor:"group-name",children:d.jsx(Fs,{id:"group-name",type:"text",value:a.name,onChange:p=>l({...a,name:p.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),d.jsxs(Fa,{children:[d.jsx(Be,{type:"submit",isLoading:c,children:i}),d.jsx(Be,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function lT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:fe.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function w4({group:t,groupIndex:e,groupCategories:n,sortedGroups:i,categoryGroups:a,categoryBalances:l,loadingBalances:c,dragType:h,draggedId:f,dragOverId:p,dragOverGroupId:_,editingCategoryId:v,setEditingCategoryId:b,createForGroupId:S,setCreateForGroupId:T,editingGroupId:C,setEditingGroupId:j,handleCreateCategory:z,handleUpdateCategory:q,handleDeleteCategory:U,handleMoveCategory:Z,handleUpdateGroup:J,handleDeleteGroup:ne,handleMoveGroup:k,handleCategoryDragStart:A,handleCategoryDragOver:D,handleDragOverGroup:P,handleDragLeave:O,handleDragLeaveGroup:N,handleDragEnd:I,handleCategoryDrop:K,handleDropOnGroup:F,handleGroupDragStart:L,handleGroupDrop:$,setDragOverId:Y,setDragOverGroupId:Q,isMobile:X,categories:V}){const H=h==="group"&&f===t.id,oe=h==="group"&&p===t.id,se=h==="category"&&_===t.id,te=f&&h==="category"?V[f]:null,ge=te&&(te.category_group_id||"ungrouped")!==t.id,xe=h==="group"&&oe&&f!==t.id,pe=e>0,Ee=e<i.length-1;return d.jsxs("div",{children:[h==="group"&&!H&&d.jsxs("div",{onDragOver:he=>{he.preventDefault(),Y(t.id)},onDragLeave:O,onDrop:he=>$(he,t.id),style:{position:"relative",height:xe?"2.5rem":"0.5rem",marginBottom:xe?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:fe.primary,borderRadius:"2px",opacity:xe?1:0,transition:"opacity 0.15s",boxShadow:xe?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),xe&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{onDragOver:he=>P(he,t.id),onDragLeave:N,onDrop:he=>F(he,t.id),style:{background:H?"color-mix(in srgb, currentColor 3%, transparent)":se&&ge?`color-mix(in srgb, ${fe.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:H?.5:1,border:se&&ge?`2px dashed ${fe.primary}`:"2px solid transparent",transition:"all 0.15s"},children:C===t.id?d.jsx(oT,{initialData:{name:t.name},onSubmit:he=>J(t.id,he),onCancel:()=>j(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:X?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:X?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{...Tl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!X&&d.jsx("span",{draggable:!0,onDragStart:he=>L(he,t.id),onDragEnd:I,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",n.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!X&&d.jsx(Be,{variant:"small",onClick:()=>T(t.id),disabled:S!==null,children:"+ Category"}),d.jsx("button",{onClick:()=>j(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),d.jsx("button",{onClick:()=>ne(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),d.jsxs("div",{style:Ky,children:[d.jsx("button",{onClick:()=>k(t.id,"up"),disabled:!pe,style:{...ol,opacity:pe?.6:.2,cursor:pe?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),d.jsx("button",{onClick:()=>k(t.id,"down"),disabled:!Ee,style:{...ol,opacity:Ee?.6:.2,cursor:Ee?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),X&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Be,{variant:"small",onClick:()=>T(t.id),disabled:S!==null,children:"+ Category"})}),d.jsxs("div",{style:ll,children:[n.map(([he,Re])=>v===he?d.jsx(Xh,{initialData:{name:Re.name,description:Re.description,category_group_id:Re.category_group_id,default_monthly_amount:Re.default_monthly_amount,default_monthly_type:Re.default_monthly_type},onSubmit:De=>q(he,De),onCancel:()=>b(null),submitLabel:"Save",categoryGroups:a,showGroupSelector:!0},he):d.jsx(Rf,{isDragging:h==="category"&&f===he,isDragOver:p===he,onDragStart:De=>{De.stopPropagation(),A(De,he)},onDragOver:De=>D(De,he,t.id),onDragLeave:O,onDragEnd:I,onDrop:De=>K(De,he,t.id),onEdit:()=>b(he),onDelete:()=>U(he),onMoveUp:()=>Z(he,"up"),onMoveDown:()=>Z(he,"down"),canMoveUp:n.findIndex(([De])=>De===he)>0,canMoveDown:n.findIndex(([De])=>De===he)<n.length-1,children:d.jsx(cT,{category:Re,catId:he,categoryBalances:l,loadingBalances:c})},he)),n.length===0&&!S&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),h==="category"&&n.length>0&&d.jsx(lT,{groupId:t.id,isActive:p===`__end__${t.id}`,onDragOver:he=>{he.preventDefault(),he.stopPropagation(),Y(`__end__${t.id}`),Q(t.id)},onDragLeave:he=>{he.stopPropagation(),Y(null)},onDrop:he=>{he.stopPropagation(),K(he,"__group_end__",t.id)}}),S===t.id&&d.jsx(Xh,{initialData:{name:"",category_group_id:t.id},onSubmit:he=>z(he,t.id),onCancel:()=>T(null),submitLabel:"Create",categoryGroups:a})]}),S!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Be,{variant:"small",onClick:()=>T(t.id),disabled:S!==null,children:"+ Add Category"})})]})})]})}function cT({category:t,catId:e,categoryBalances:n,loadingBalances:i}){const a=n[e]||{current:0,total:0};return d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Wy,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?d.jsxs(d.Fragment,{children:[d.jsxs("span",{style:{color:fe.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{style:{color:fe.success,fontWeight:500},children:ke(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),d.jsxs("div",{style:{marginTop:"0.25rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:qt(a.current)},children:[i?"...":ke(a.current),d.jsx("span",{style:{fontSize:"0.75rem",fontWeight:400,opacity:.6,marginLeft:"0.35rem"},children:"available now"})]}),d.jsxs("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.85rem",fontWeight:500,color:qt(a.total),opacity:.75},children:[i?"...":ke(a.total),d.jsx("span",{style:{fontSize:"0.7rem",fontWeight:400,opacity:.7,marginLeft:"0.35rem"},children:"total allocated"})]})]})]})}function T4({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:i,dragType:a,draggedId:l,dragOverId:c,dragOverGroupId:h,editingCategoryId:f,setEditingCategoryId:p,createForGroupId:_,setCreateForGroupId:v,handleCreateCategory:b,handleUpdateCategory:S,handleDeleteCategory:T,handleMoveCategory:C,handleCategoryDragStart:j,handleCategoryDragOver:z,handleDragOverGroup:q,handleDragLeaveGroup:U,handleDragLeave:Z,handleDragEnd:J,handleCategoryDrop:ne,handleDropOnGroup:k,setDragOverId:A,setDragOverGroupId:D,categories:P,hasGroups:O}){const N=a==="category"&&h==="ungrouped",I=l&&a==="category"?P[l]:null,K=I&&I.category_group_id!==null;return t.length===0&&!_&&O&&a!=="category"?null:d.jsxs("div",{onDragOver:F=>q(F,"ungrouped"),onDragLeave:U,onDrop:F=>k(F,"ungrouped"),style:{background:N&&K?`color-mix(in srgb, ${fe.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:N&&K?`2px dashed ${fe.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Tl,margin:0,opacity:.7},children:["Uncategorized",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),d.jsx(Be,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Category"})]}),d.jsxs("div",{style:ll,children:[t.map(([F,L])=>f===F?d.jsx(Xh,{initialData:{name:L.name,description:L.description,category_group_id:L.category_group_id,default_monthly_amount:L.default_monthly_amount,default_monthly_type:L.default_monthly_type},onSubmit:$=>S(F,$),onCancel:()=>p(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},F):d.jsx(Rf,{isDragging:a==="category"&&l===F,isDragOver:c===F,onDragStart:$=>j($,F),onDragOver:$=>z($,F,"ungrouped"),onDragLeave:Z,onDragEnd:J,onDrop:$=>ne($,F,"ungrouped"),onEdit:()=>p(F),onDelete:()=>T(F),onMoveUp:()=>C(F,"up"),onMoveDown:()=>C(F,"down"),canMoveUp:t.findIndex(([$])=>$===F)>0,canMoveDown:t.findIndex(([$])=>$===F)<t.length-1,children:d.jsx(cT,{category:L,catId:F,categoryBalances:n,loadingBalances:i})},F)),t.length===0&&a==="category"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),a==="category"&&t.length>0&&d.jsx(lT,{groupId:"ungrouped",isActive:c==="__end__ungrouped",onDragOver:F=>{F.preventDefault(),F.stopPropagation(),A("__end__ungrouped"),D("ungrouped")},onDragLeave:F=>{F.stopPropagation(),A(null)},onDrop:F=>{F.stopPropagation(),ne(F,"__group_end__","ungrouped")}}),_==="ungrouped"&&d.jsx(Xh,{initialData:{name:"",category_group_id:null},onSubmit:F=>b(F,"ungrouped"),onCancel:()=>v(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Be,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function A4(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:i,sortedGroups:a,categoryBalances:l,isLoading:c,loadingBalances:h,error:f,setError:p,getOnBudgetTotal:_,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:S,handleMoveCategory:T,handleCreateGroup:C,handleUpdateGroup:j,handleDeleteGroup:z,handleMoveGroup:q,dragType:U,draggedId:Z,dragOverId:J,dragOverGroupId:ne,setDragOverId:k,setDragOverGroupId:A,handleCategoryDragStart:D,handleCategoryDragOver:P,handleDragOverGroup:O,handleDragLeave:N,handleDragLeaveGroup:I,handleDragEnd:K,handleCategoryDrop:F,handleDropOnGroup:L,handleGroupDragStart:$,handleGroupDrop:Y}=z6(),Q=Ki(),[X,V]=R.useState(null),[H,oe]=R.useState(null),[se,te]=R.useState(null),[ge,xe]=R.useState(!1);return t?c?d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),d.jsx("p",{style:tu,children:"Organize your spending categories into groups."}),d.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",opacity:.7},children:d.jsx("p",{children:"Loading..."})})]}):d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),d.jsxs("p",{style:tu,children:["Organize your spending categories into groups.",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"0.9rem"},children:Q?"Use  buttons to reorder items, or drag to move between groups.":"Drag categories between groups, or use  buttons to reorder."})]}),f&&d.jsx(Al,{message:f,onDismiss:()=>p(null)}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:d.jsx(t_,{})}),(()=>{const pe=Object.values(l).reduce((vt,Ie)=>vt+Ie.current,0),Ee=Object.values(l).reduce((vt,Ie)=>vt+Ie.total,0),he=_()-pe,Re=_()-Ee,De=Math.abs(Ee-pe)>.01;return d.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[d.jsxs(kc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Categories"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:Object.keys(e).length})]}),d.jsxs(kc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Groups"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:n.length})]}),d.jsxs(kc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"On-Budget"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:qt(_())},children:ke(_())})]}),d.jsxs(kc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Allocated Now"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:fe.primary},children:h?"...":ke(pe)}),De&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:h?"":`${ke(Ee)} total`})]}),d.jsxs(kc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Available Now"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:qt(he)},children:h?"...":ke(he)}),De&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:h?"":`${ke(Re)} after future`})]})]})})(),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(e).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),a.map((pe,Ee)=>{const he=(i[pe.id]||[]).sort((Re,De)=>Re[1].sort_order-De[1].sort_order);return d.jsx(w4,{group:pe,groupIndex:Ee,groupCategories:he,sortedGroups:a,categoryGroups:n,categoryBalances:l,loadingBalances:h,dragType:U,draggedId:Z,dragOverId:J,dragOverGroupId:ne,editingCategoryId:X,setEditingCategoryId:V,createForGroupId:H,setCreateForGroupId:oe,editingGroupId:se,setEditingGroupId:te,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:S,handleMoveCategory:T,handleUpdateGroup:j,handleDeleteGroup:z,handleMoveGroup:q,handleCategoryDragStart:D,handleCategoryDragOver:P,handleDragOverGroup:O,handleDragLeave:N,handleDragLeaveGroup:I,handleDragEnd:K,handleCategoryDrop:F,handleDropOnGroup:L,handleGroupDragStart:$,handleGroupDrop:Y,setDragOverId:k,setDragOverGroupId:A,isMobile:Q,categories:e},pe.id)}),U==="group"&&a.length>0&&d.jsx(Xy,{isActive:J==="__end__",onDragOver:pe=>{pe.preventDefault(),k("__end__")},onDragLeave:N,onDrop:pe=>Y(pe,"__end__"),label:"Move group to end"}),d.jsx(T4,{ungroupedCategories:(i.ungrouped||[]).sort((pe,Ee)=>pe[1].sort_order-Ee[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:h,dragType:U,draggedId:Z,dragOverId:J,dragOverGroupId:ne,editingCategoryId:X,setEditingCategoryId:V,createForGroupId:H,setCreateForGroupId:oe,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:S,handleMoveCategory:T,handleCategoryDragStart:D,handleCategoryDragOver:P,handleDragOverGroup:O,handleDragLeaveGroup:I,handleDragLeave:N,handleDragEnd:K,handleCategoryDrop:F,handleDropOnGroup:L,setDragOverId:k,setDragOverGroupId:A,categories:e,hasGroups:n.length>0})]}),ge?d.jsx(oT,{onSubmit:pe=>{C(pe),xe(!1)},onCancel:()=>xe(!1),submitLabel:"Create Group"}):d.jsx(Be,{variant:"primary-large",onClick:()=>xe(!0),children:"+ Add Category Group"})]}):d.jsx("p",{children:"No budget found. Please log in."})}const C4=["accounts","categories","users"];function R4(){const{selectedBudgetId:t,currentUserId:e,lastSettingsTab:n,setLastSettingsTab:i}=Sn(),{isOwner:a,isLoading:l}=Hn(t,e),c=kn(),h=c.pathname==="/budget/settings",f=R.useMemo(()=>{const S=c.pathname;return S.includes("/settings/accounts")?"accounts":S.includes("/settings/categories")?"categories":S.includes("/settings/users")?"users":"categories"},[c.pathname]),p=f==="users";R.useEffect(()=>{h||i(f)},[f,h,i]);function _(){return!C4.includes(n)||n==="users"&&!a?"categories":n}const v=R.useMemo(()=>[{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!a}],[a]);return l?d.jsx("div",{style:qn,children:d.jsx("p",{children:"Loading..."})}):!a&&p?d.jsxs("div",{style:qn,children:[d.jsx(fi,{title:"Budget Settings"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only the budget owner can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(kt,{to:"/budget/settings/categories",style:{color:"#646cff"},children:"Go to Categories "})})]}):d.jsxs("div",{style:qn,children:[d.jsx(fi,{title:"Budget Settings"}),d.jsx(Jy,{mode:"link",linkPrefix:"/budget/settings",tabs:v,activeTab:h?_():f}),h?d.jsx(Zh,{to:`/budget/settings/${_()}`,replace:!0}):d.jsx(ef,{})]})}function D4(){const{selectedBudgetId:t,currentUserId:e}=Sn(),{budget:n,budgetUserIds:i,acceptedUserIds:a,inviteUser:l,revokeUser:c}=Hn(t,e),[h,f]=R.useState(""),[p,_]=R.useState(!1),[v,b]=R.useState(null),[S,T]=R.useState(null);if(!n)return d.jsx("p",{children:"No budget found."});async function C(U){if(U.preventDefault(),!(!h.trim()||!n)){_(!0),b(null),T(null);try{await l(h.trim()),f(""),T("Invite sent! The user can now accept the invitation from their account.")}catch(Z){b(Z instanceof Error?Z.message:"Failed to invite user")}finally{_(!1)}}}async function j(U){if(!n)return;if(U===n.owner_id){b("Cannot revoke the budget owner");return}if(U===e){b("Cannot revoke yourself from the budget");return}const Z=a.includes(U);if(confirm(Z?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){b(null),T(null);try{await c(U),T(Z?"User access revoked.":"Invitation cancelled.")}catch(ne){b(ne instanceof Error?ne.message:"Failed to revoke user")}}}const z=i.filter(U=>a.includes(U)),q=i.filter(U=>!a.includes(U));return d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),S&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:S}),d.jsx("button",{onClick:()=>T(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",z.length,")"]}),z.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:z.map(U=>{const Z=U===n.owner_id,J=U===e;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:U}),Z&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),J&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!Z&&!J&&d.jsx("button",{onClick:()=>j(U),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},U)})})]}),q.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",q.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:q.map(U=>d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:U}),d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),d.jsx("button",{onClick:()=>j(U),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},U))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),d.jsxs("form",{onSubmit:C,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:h,onChange:U=>f(U.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:p||!h.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p||!h.trim()?"not-allowed":"pointer",fontWeight:500,opacity:p||!h.trim()?.7:1,whiteSpace:"nowrap"},children:p?"Inviting...":"Send Invite"})]}),d.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),d.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}const I4=["budget","feedback","migration","tests"];function j4(){const{isAdmin:t,isTest:e,lastAdminTab:n,setLastAdminTab:i}=Sn(),a=kn(),l=a.pathname==="/budget/admin",c=R.useMemo(()=>{const _=a.pathname;return _.includes("/admin/budget")?"budget":_.includes("/admin/feedback")?"feedback":_.includes("/admin/migration")?"migration":_.includes("/admin/tests")?"tests":"budget"},[a.pathname]),h=c==="tests";R.useEffect(()=>{l||i(c)},[c,l,i]);function f(){return!I4.includes(n)||n==="tests"&&!e?"budget":n}const p=R.useMemo(()=>[{id:"budget",label:"Budget",icon:""},{id:"feedback",label:"Feedback",icon:""},{id:"migration",label:"Migration",icon:""},{id:"tests",label:"Tests",icon:"",hidden:!e}],[e]);return t?!e&&h?d.jsxs("div",{style:qn,children:[d.jsx(fi,{title:"Budget Admin"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only test users can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(kt,{to:"/budget/admin/budget",style:{color:"#646cff"},children:"Go to Admin "})})]}):d.jsxs("div",{style:qn,children:[d.jsx(fi,{title:"Budget Admin"}),d.jsx(Jy,{mode:"link",linkPrefix:"/budget/admin",tabs:p,activeTab:c}),l?d.jsx(Zh,{to:`/budget/admin/${f()}`,replace:!0}):d.jsx(ef,{})]}):d.jsxs("div",{style:qn,children:[d.jsx(fi,{title:"Budget Admin"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only administrators can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(kt,{to:"/budget",style:{color:"#646cff"},children:"Go to Budget "})})]})}function k4(){const{selectedBudgetId:t,currentUserId:e,isAdmin:n}=Sn(),{budget:i,accounts:a,accountGroups:l,categories:c,categoryGroups:h,isOwner:f,isLoading:p}=Hn(t,e);return p?d.jsx("p",{children:"Loading budget info..."}):i?d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Summary"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Information about the currently selected budget."}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",fontSize:"0.95rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Name:"}),d.jsx("strong",{children:i.name})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"ID:"}),d.jsx("code",{style:{background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:i.id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Owner:"}),d.jsx("strong",{children:i.owner_email||i.owner_id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Users:"}),d.jsxs("span",{children:[i.user_ids.length," user",i.user_ids.length!==1?"s":"",d.jsxs("span",{style:{opacity:.7},children:["  ",f?"You are the owner":"Shared with you"]})]})]})]})}),n&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem"},children:"Admin Tools"}),d.jsx("button",{onClick:()=>{const _={...i,accounts:a,account_groups:l,categories:c,category_groups:h,_meta:{downloaded_at:new Date().toISOString()}},v=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),b=URL.createObjectURL(v),S=document.createElement("a");S.href=b,S.download=`budget_${i.id}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(b)},style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",transition:"background 0.15s"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]})]}):d.jsx("p",{style:{opacity:.7},children:"No budget selected."})}function FE({budget:t,isCurrent:e,isAccepting:n,isSwitching:i,isEditing:a,editName:l,isRenaming:c,onAccept:h,onSwitch:f,onStartEdit:p,onCancelEdit:_,onEditNameChange:v,onSaveEdit:b}){const S=e&&t.isOwner;return d.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:a?d.jsxs("form",{onSubmit:b,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:d.jsx("input",{type:"text",value:l,onChange:T=>v(T.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[d.jsx("button",{type:"submit",disabled:c||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:c||!l.trim()?.7:1,fontSize:"0.8rem"},children:c?"Saving...":"Save"}),d.jsx("button",{type:"button",onClick:_,disabled:c,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c?"not-allowed":"pointer",fontWeight:500,opacity:c?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[d.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),S&&d.jsx("button",{onClick:p,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),d.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?d.jsx("button",{onClick:h,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:d.jsx("button",{onClick:f,disabled:i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,fontSize:"0.85rem"},children:i?"Switching...":"Switch"})})]})})}const Ug={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function uT({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,i=n&&n in Ug?n:"bug",a=Ug[i];return d.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:a.bgColor,color:a.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:a.label})}function O4({item:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:h,onToggleDone:f,onTypeClick:p}){return d.jsxs("div",{onDragOver:_=>{_.stopPropagation(),a(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),h(_)},style:{position:"relative"},children:[d.jsx("div",{style:{...Z1,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:c,style:{...xu,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{...J1},children:""}),d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:f,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:fe.primary,flexShrink:0}}),d.jsx(uT,{type:t.feedback_type,onClick:p})]}),d.jsxs("div",{style:{marginLeft:"3.25rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",zg(t.created_at)]})]})]})]})}function M4({item:t,onToggleDone:e,onTypeClick:n}){return d.jsxs("div",{style:{...xu,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:fe.primary,flexShrink:0}}),d.jsx(uT,{type:t.feedback_type,onClick:n})]}),d.jsxs("div",{style:{marginLeft:"2rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",zg(t.created_at)]}),t.completed_at&&d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:fe.success},children:[" Completed: ",zg(t.completed_at)]})]})]})}function Df({noMargin:t}={}){return d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:t?0:"0.5rem",verticalAlign:"middle"}})}function n_({title:t,description:e,status:n,statusText:i,onRefresh:a,isRefreshing:l,isBusy:c=!1,children:h}){const p=(()=>{switch(n){case"unknown":return{color:"#9ca3af",text:i??"Unknown"};case"clean":case"complete":return{color:"#22c55e",text:i??" Clean"};case"needs-action":return{color:"#f59e0b",text:i??"Action Needed"}}})(),_=l||c;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:t}),d.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.9rem"},children:e})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexShrink:0},children:[n!=="unknown"&&d.jsx("span",{style:{color:p.color,fontWeight:600,fontSize:"0.9rem"},children:p.text}),d.jsxs("button",{onClick:a,disabled:_,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem 0.65rem",borderRadius:"6px",cursor:_?"not-allowed":"pointer",fontWeight:500,fontSize:"0.85rem",opacity:_?.6:1,display:"flex",alignItems:"center",gap:"0.3rem"},title:"Refresh status",children:[l?d.jsx(Df,{noMargin:!0}):""," Refresh"]})]})]}),h]})}const N4={unknown:{bg:"rgba(100, 100, 100, 0.1)",border:"rgba(100, 100, 100, 0.3)",color:"#9ca3af"},clean:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"},warning:{bg:"rgba(245, 158, 11, 0.1)",border:"rgba(245, 158, 11, 0.3)",color:"#fbbf24"},running:{bg:"rgba(100, 108, 255, 0.1)",border:"rgba(100, 108, 255, 0.3)",color:"#a5b4fc"},success:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"}};function Fn({type:t,children:e}){const n=N4[t];return d.jsx("div",{style:{background:n.bg,border:`1px solid ${n.border}`,color:n.color,padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:e})}function r_({onClick:t,disabled:e,isBusy:n,busyText:i,children:a}){const l=e||n;return d.jsx("button",{onClick:t,disabled:l,style:{marginTop:"1rem",background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:l?"not-allowed":"pointer",fontWeight:500,opacity:l?.7:1,display:"flex",alignItems:"center",gap:"0.4rem"},children:n?d.jsxs(d.Fragment,{children:[d.jsx(Df,{noMargin:!0})," ",i??"Running..."]}):a})}function P4({title:t,description:e,isComplete:n,isMigrating:i,needsMigration:a,totalBudgetsToMigrate:l,budgetsToMigrateCategories:c,budgetsToMigrateAccounts:h,onRunMigration:f,onRefresh:p,isRefreshing:_,disabled:v,isUnknown:b,children:S}){const T=()=>b?"unknown":n?"complete":a?"needs-action":"clean",C=()=>b?"Unknown":n?" Complete":a?"Required":" Clean";return d.jsxs(n_,{title:t,description:e,status:T(),statusText:C(),onRefresh:p,isRefreshing:_,isBusy:i,children:[i?d.jsxs(Fn,{type:"running",children:[d.jsx(Df,{})," Running migration across all budgets..."]}):b?d.jsx(Fn,{type:"unknown",children:" Status unknown  click Refresh to check migration status"}):n?d.jsx(Fn,{type:"clean",children:" All budgets are using the new map structure"}):a?d.jsxs(d.Fragment,{children:[d.jsx(Fn,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",l," budget(s) needing migration:"]}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[c>0&&d.jsxs("li",{children:[c," with categories to migrate"]}),h>0&&d.jsxs("li",{children:[h," with accounts to migrate"]})]})]})}),d.jsx(r_,{onClick:f,disabled:v,children:"Migrate All Budgets"})]}):null,S]})}function L4({results:t}){return d.jsxs("div",{style:{marginTop:"1rem"},children:[d.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem"},children:"Migration Results:"}),d.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:t.map((e,n)=>d.jsx(V4,{result:e,isLast:n===t.length-1},n))})]})}function V4({result:t,isLast:e}){const n=t.error&&t.error!=="Already migrated",i=t.error==="Already migrated";return d.jsxs("div",{style:{padding:"0.5rem",marginBottom:e?0:"0.5rem",borderRadius:"4px",background:n?"rgba(220, 38, 38, 0.1)":i?"rgba(100, 100, 100, 0.1)":"rgba(34, 197, 94, 0.1)",border:n?"1px solid rgba(220, 38, 38, 0.3)":i?"1px solid rgba(100, 100, 100, 0.3)":"1px solid rgba(34, 197, 94, 0.3)"},children:[d.jsxs("div",{style:{fontWeight:500},children:[n?"":i?"":""," ",t.budgetName]}),n?d.jsxs("div",{style:{fontSize:"0.85rem",opacity:.8,color:"#f87171"},children:["Error: ",t.error]}):i?d.jsx("div",{style:{fontSize:"0.85rem",opacity:.6},children:"Already using map structure"}):d.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7},children:[t.categoriesMigrated>0&&`Migrated ${t.categoriesMigrated} categories`,t.categoriesMigrated>0&&(t.accountsMigrated>0||t.accountGroupsMigrated>0)&&", ",t.accountsMigrated>0&&`${t.accountsMigrated} accounts`,t.accountsMigrated>0&&t.accountGroupsMigrated>0&&", ",t.accountGroupsMigrated>0&&`${t.accountGroupsMigrated} account groups`,t.balancesCalculated&&" with calculated balances"]})]})}function B4({hasData:t,futureMonthsCount:e,futureMonthsToDelete:n,isCleaningFutureMonths:i,onCleanup:a,onRefresh:l,isRefreshing:c,disabled:h,cleanupResult:f}){const p=()=>t?f&&f.deleted>0?"complete":e===0?"clean":"needs-action":"unknown";return d.jsx(n_,{title:" Clean Up Future Months",description:"Deletes month documents that are more than 2 months in the future. These can be created accidentally when navigating too far ahead.",status:p(),onRefresh:l,isRefreshing:c,isBusy:i,children:i?d.jsx(Fn,{type:"running",children:"Deleting future months..."}):f?d.jsx(Fn,{type:f.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[f.errors.length>0?"":""," Deleted ",f.deleted," month",f.deleted!==1?"s":"",f.errors.length>0&&d.jsx("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem"},children:f.errors.map((_,v)=>d.jsx("li",{children:_},v))})]})}):t?e>0?d.jsxs(d.Fragment,{children:[d.jsx(Fn,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e," month",e!==1?"s":""," to delete:"]}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[n.slice(0,10).map(_=>d.jsxs("li",{children:[Qy[_.month-1]," ",_.year," (budget: ",_.budgetId.slice(0,8),"...)"]},_.docId)),e>10&&d.jsxs("li",{style:{opacity:.7},children:["...and ",e-10," more"]})]})]})}),d.jsxs(r_,{onClick:a,disabled:h,isBusy:i,busyText:"Deleting...",children:[" Delete ",e," Future Month",e!==1?"s":""]})]}):d.jsx(Fn,{type:"clean",children:" No future months found beyond 2 months from now."}):d.jsx(Fn,{type:"unknown",children:" Status unknown  click Refresh to check for future months"})})}function z4({hasData:t,status:e,isMigrating:n,onMigrate:i,onRefresh:a,isRefreshing:l,disabled:c,migrationResult:h}){const f=e&&(e.sanitizedDocuments.length>0||e.corruptedDocuments.length>0),p=h&&(h.deletedDocuments>0||h.fixedDocuments>0),_=()=>t?p?"complete":f?"needs-action":"clean":"unknown";return d.jsx(n_,{title:" Consolidate Feedback Documents",description:"Fixes corrupted feedback data and merges documents with sanitized IDs into proper email format.",status:_(),onRefresh:a,isRefreshing:l,isBusy:n,children:n?d.jsx(Fn,{type:"running",children:"Migrating feedback documents..."}):t?p?d.jsx(Fn,{type:"success",children:d.jsxs("div",{children:[" Migration complete:",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[h.fixedDocuments>0&&d.jsxs("li",{children:["Fixed ",h.fixedDocuments," corrupted document(s)"]}),h.deletedDocuments>0&&d.jsxs("li",{children:["Merged & deleted ",h.deletedDocuments," sanitized document(s)"]}),h.mergedItems>0&&d.jsxs("li",{children:["Merged ",h.mergedItems," feedback item(s)"]})]}),h.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{marginTop:"0.5rem"},children:" Errors:"}),d.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:h.errors.map((v,b)=>d.jsx("li",{children:v},b))})]})]})}):f?d.jsxs(d.Fragment,{children:[d.jsx(Fn,{type:"warning",children:d.jsxs("div",{children:[e?.corruptedDocuments&&e.corruptedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.corruptedDocuments.length," corrupted document(s):"]}),d.jsx("ul",{style:{margin:"0 0 0.75rem 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.corruptedDocuments.map(v=>d.jsxs("li",{children:[v," ",d.jsx("span",{style:{opacity:.6},children:"(broken arrayUnion)"})]},v))})]}),e?.sanitizedDocuments&&e.sanitizedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.sanitizedDocuments.length," sanitized document(s) to merge:"]}),d.jsx("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.sanitizedDocuments.map(v=>d.jsx("li",{children:v},v))})]})]})}),d.jsx(r_,{onClick:i,disabled:c,isBusy:n,busyText:"Migrating...",children:"Run Migration"})]}):d.jsxs(Fn,{type:"clean",children:[" No issues found. All feedback documents are healthy.",d.jsxs("span",{style:{display:"block",fontSize:"0.85rem",opacity:.7,marginTop:"0.25rem"},children:["Found ",e?.documentsFound??0," document(s) total."]})]}):d.jsx(Fn,{type:"unknown",children:" Status unknown  click Refresh to scan for issues"})})}function U4(){Oe.clear();try{localStorage.removeItem("BUDGET_APP_QUERY_CACHE"),console.log("[Cache] Cleared all React Query caches from memory and localStorage")}catch(t){console.warn("Failed to clear localStorage cache:",t)}window.location.reload()}function F4(){const e=za().get_current_firebase_user(),n=U6({currentUser:e}),i=H6({currentUser:e}),a=Q6({currentUser:e}),l=n.status?.categoriesArrayMigrationNeeded||n.status?.accountsArrayMigrationNeeded,c=Math.max(n.status?.budgetsToMigrateCategories??0,n.status?.budgetsToMigrateAccounts??0),h=n.isScanning||i.isScanning||a.isScanning,f=n.isMigrating||i.isCleaningFutureMonths||a.isMigratingFeedback,p=async()=>{await Promise.all([n.scanStatus(),i.scanStatus(),a.scanStatus()])};return d.jsxs("div",{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[d.jsx("h2",{style:{margin:0},children:"Data Migrations"}),d.jsxs("button",{onClick:p,disabled:h||f,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:h||f?"not-allowed":"pointer",fontWeight:500,opacity:h||f?.7:1,display:"flex",alignItems:"center",gap:"0.4rem",minWidth:"130px",minHeight:"36px"},children:[d.jsx("span",{style:{width:"18px",height:"18px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:h?d.jsx(Df,{noMargin:!0}):""}),"Refresh All"]})]}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:'Run migrations to update your budget data structure. Click "Refresh All" to scan Firestore directly.'}),d.jsx(P4,{title:"Migrate Data to Map Structure",description:"Converts categories, accounts, and account groups from array format to map structure. This improves performance and enables direct lookup by ID.",isComplete:n.status?!l:!1,isMigrating:n.isMigrating,needsMigration:n.status?!!l:!1,totalBudgetsToMigrate:c,budgetsToMigrateCategories:n.status?.budgetsToMigrateCategories??0,budgetsToMigrateAccounts:n.status?.budgetsToMigrateAccounts??0,onRunMigration:n.runMigration,onRefresh:n.scanStatus,isRefreshing:n.isScanning,disabled:!e,isUnknown:!n.status,children:n.migrationResults&&d.jsx(L4,{results:n.migrationResults})}),d.jsx(B4,{hasData:!!i.status,futureMonthsCount:i.status?.futureMonthsCount??0,futureMonthsToDelete:i.status?.futureMonthsToDelete??[],isCleaningFutureMonths:i.isCleaningFutureMonths,onCleanup:i.cleanupFutureMonths,onRefresh:i.scanStatus,isRefreshing:i.isScanning,disabled:!e,cleanupResult:i.futureMonthsCleanupResult}),d.jsx(z4,{hasData:!!a.status,status:a.status,isMigrating:a.isMigratingFeedback,onMigrate:a.migrateFeedbackDocuments,onRefresh:a.scanStatus,isRefreshing:a.isScanning,disabled:!e,migrationResult:a.feedbackMigrationResult}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:d.jsxs("p",{style:{margin:0,opacity:.7},children:[d.jsx("strong",{children:"Note:"})," This migration will process ",d.jsxs("strong",{children:["all ",n.status?.totalBudgetsChecked??"?"," budgets"]})," in the system, not just the ones you own or are invited to."]})}),d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, #ff6b6b 10%, transparent)",borderRadius:"8px",border:"1px solid color-mix(in srgb, #ff6b6b 30%, transparent)"},children:[d.jsxs("p",{style:{margin:"0 0 0.75rem 0",fontSize:"0.9rem"},children:[d.jsx("strong",{children:" Clear All Caches"}),d.jsx("span",{style:{opacity:.7,display:"block",marginTop:"0.25rem"},children:"If you're seeing stale data after running migrations, clear all cached data and reload to fetch fresh data from Firestore."})]}),d.jsx("button",{onClick:U4,style:{background:"#dc2626",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,display:"flex",alignItems:"center",gap:"0.4rem"},children:" Clear All Caches & Reload"})]})]})}function q4(){const[t,e]=R.useState(null),[n,i]=R.useState(null),[a,l]=R.useState(null),[c,h]=R.useState(!1),[f,p]=R.useState(""),[_,v]=R.useState("bug"),[b,S]=R.useState(null),[T,C]=R.useState(null),j=R.useContext(ou),q=za().get_current_firebase_user(),U=fO(),Z=p1(),J=U.data?.items||[];function ne(Y){Y.preventDefault(),!(!f.trim()||!j.username||!q)&&(Z.submitFeedback.mutate({userId:q.uid,userEmail:j.username,text:f.trim(),feedbackType:_,currentPath:"/settings/feedback"}),p(""),v("bug"),h(!1))}function k(Y){Y.is_done?A(Y):S(Y)}async function A(Y){try{await Z.toggleFeedback.mutateAsync({item:Y})}catch(Q){e(Q instanceof Error?Q.message:"Failed to update feedback")}}function D(){b&&(A(b),S(null))}async function P(Y){if(T){try{const X=J.filter(V=>V.doc_id===T.doc_id).map(V=>V.id===T.id?{id:V.id,text:V.text,created_at:V.created_at,is_done:V.is_done,completed_at:V.completed_at,sort_order:V.sort_order,feedback_type:Y}:{id:V.id,text:V.text,created_at:V.created_at,is_done:V.is_done,completed_at:V.completed_at,sort_order:V.sort_order,feedback_type:V.feedback_type});await Z.updateSortOrder.mutateAsync({docId:T.doc_id,items:X})}catch(Q){e(Q instanceof Error?Q.message:"Failed to update feedback type")}C(null)}}const O=J.filter(Y=>!Y.is_done).sort((Y,Q)=>Y.sort_order-Q.sort_order),N=J.filter(Y=>Y.is_done).sort((Y,Q)=>{const X=Y.completed_at?new Date(Y.completed_at).getTime():0;return(Q.completed_at?new Date(Q.completed_at).getTime():0)-X});function I(Y,Q){i(Q),Y.dataTransfer.effectAllowed="move"}function K(Y,Q){Y.preventDefault(),Q!==n&&l(Q)}function F(){l(null)}function L(){i(null),l(null)}async function $(Y,Q){if(Y.preventDefault(),!n||n===Q){L();return}const X=O.findIndex(te=>te.id===n),V=[...O],[H]=V.splice(X,1);if(Q==="__end__")V.push(H);else{const te=V.findIndex(ge=>ge.id===Q);V.splice(te,0,H)}const oe=V.map((te,ge)=>({...te,sort_order:ge}));L();const se=new Map;for(const te of oe)se.has(te.doc_id)||se.set(te.doc_id,[]),se.get(te.doc_id).push({id:te.id,text:te.text,created_at:te.created_at,is_done:te.is_done,completed_at:te.completed_at,sort_order:te.sort_order,feedback_type:te.feedback_type});for(const te of N)se.has(te.doc_id)||se.set(te.doc_id,[]),se.get(te.doc_id).push({id:te.id,text:te.text,created_at:te.created_at,is_done:te.is_done,completed_at:te.completed_at,sort_order:te.sort_order,feedback_type:te.feedback_type});try{for(const[te,ge]of se)await Z.updateSortOrder.mutateAsync({docId:te,items:ge})}catch(te){e(te instanceof Error?te.message:"Failed to save order")}}return U.isLoading?d.jsx("p",{children:"Loading feedback..."}):d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Feedback"}),d.jsx("p",{style:{...tu,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&d.jsx(Al,{message:t,onDismiss:()=>e(null)}),d.jsxs("div",{style:ll,children:[O.length===0&&!c&&d.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),O.map(Y=>d.jsx(O4,{item:Y,isDragging:n===Y.id,isDragOver:a===Y.id,onDragStart:Q=>I(Q,Y.id),onDragOver:Q=>K(Q,Y.id),onDragLeave:F,onDragEnd:L,onDrop:Q=>$(Q,Y.id),onToggleDone:()=>k(Y),onTypeClick:()=>C(Y)},Y.id)),n&&O.length>0&&d.jsx(Xy,{isActive:a==="__end__",onDragOver:Y=>K(Y,"__end__"),onDragLeave:F,onDrop:Y=>$(Y,"__end__")})]}),c?d.jsxs(Us,{onSubmit:ne,children:[d.jsx(qE,{selectedType:_,onSelect:v}),d.jsx(Yy,{value:f,onChange:Y=>p(Y.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),d.jsxs(Fa,{children:[d.jsx(Be,{type:"submit",disabled:!f.trim(),children:"Add Feedback"}),d.jsx(Be,{type:"button",variant:"secondary",onClick:()=>{h(!1),p(""),v("bug")},children:"Cancel"})]})]}):d.jsx(Be,{variant:"primary-large",onClick:()=>h(!0),children:"+ Add Feedback"}),N.length>0&&d.jsx(C6,{title:"Completed",count:N.length,children:d.jsx("div",{style:{...ll,marginTop:"0.5rem"},children:N.map(Y=>d.jsx(M4,{item:Y,onToggleDone:()=>k(Y),onTypeClick:()=>C(Y)},Y.id))})}),d.jsxs(ru,{isOpen:b!==null,onClose:()=>S(null),title:"Mark as Complete",children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),b&&d.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',b.text,'"']}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Be,{variant:"secondary",onClick:()=>S(null),children:"Cancel"}),d.jsx(Be,{variant:"primary",onClick:D,children:"Mark Complete"})]})]}),d.jsxs(ru,{isOpen:T!==null,onClose:()=>C(null),title:"Change Feedback Type",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),d.jsx(qE,{selectedType:T?.feedback_type||"bug",onSelect:P}),d.jsx(Be,{variant:"secondary",onClick:()=>C(null),style:{width:"100%"},children:"Cancel"})]})]})}function qE({selectedType:t,onSelect:e}){return d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const i=Ug[n],a=t==="feature"?"new_feature":t,l=a===n||!a&&n==="bug";return d.jsxs("button",{type:"button",onClick:()=>e(n),style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${i.color}`,borderRadius:"0.5rem",background:l?i.bgColor:"transparent",color:l?i.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${i.bgColor}`:"none",position:"relative"},children:[i.label,l&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function H4(){const{currentUserId:t}=Sn(),[e,n]=R.useState([]),[i,a]=R.useState(!1);function l(b,S){n(T=>T.map(C=>C.name===b?{...C,...S}:C))}async function c(){a(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await h("Read unauthorized budget",async()=>(await Ae("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0),await h("Read another user's document",async()=>(await Ae("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0),await h("Read unauthorized budget month",async()=>(await Ae("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0),await h("Toggle is_admin in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:S}=await Ae("users",t,"security test: reading own user to get current is_admin value"),T=S?.permission_flags?.is_admin??!1;return await rh("users",t,{"permission_flags.is_admin":!T},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${T} to ${!T} (SECURITY ISSUE!)`},!0),await h("Toggle is_test in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:S}=await Ae("users",t,"security test: reading own user to get current is_test value"),T=S?.permission_flags?.is_test??!1;return await rh("users",t,{"permission_flags.is_test":!T},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${T} to ${!T} (SECURITY ISSUE!)`},!0),await h("Read own user document",async()=>{if(!t)throw new Error("Not authenticated");const{exists:S}=await Ae("users",t,"security test: reading own user document (should succeed)");if(S)return"Successfully read own document";throw new Error("Document does not exist")},!1),a(!1)}async function h(b,S,T){l(b,{status:"running",message:"Running..."});try{const C=await S();T?l(b,{status:"failed",message:` ${C}`}):l(b,{status:"passed",message:` ${C}`})}catch(C){const j=C instanceof Error?C.message:"Unknown error";T?l(b,{status:"passed",message:` Blocked as expected: ${j}`}):l(b,{status:"failed",message:` ${j}`})}}async function f(b){switch(e.find(T=>T.name===b)||n(T=>[...T,{name:b,status:"pending",message:"",expectedToFail:!0}]),a(!0),b){case"Read unauthorized budget":await h(b,async()=>(await Ae("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0);break;case"Read another user's document":await h(b,async()=>(await Ae("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0);break;case"Read unauthorized budget month":await h(b,async()=>(await Ae("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0);break;case"Toggle is_admin in own permission_flags":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:T}=await Ae("users",t,"security test: reading own user to get current is_admin value"),C=T?.permission_flags?.is_admin??!1;return await rh("users",t,{"permission_flags.is_admin":!C},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${C} to ${!C} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:T}=await Ae("users",t,"security test: reading own user to get current is_test value"),C=T?.permission_flags?.is_test??!1;return await rh("users",t,{"permission_flags.is_test":!C},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${C} to ${!C} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{exists:T}=await Ae("users",t,"security test: reading own user document (should succeed)");if(T)return"Successfully read own document";throw new Error("Document does not exist")},!1);break}a(!1)}const p=e.filter(b=>b.status==="passed").length,_=e.filter(b=>b.status==="failed").length,v=e.length;return d.jsxs("div",{children:[d.jsx("p",{style:tu,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsx(Be,{onClick:c,disabled:i,variant:"primary",children:i?"Running Tests...":"Run All Tests"})}),e.length>0&&d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[d.jsxs("span",{children:["Total: ",d.jsx("strong",{children:v})]}),d.jsxs("span",{style:{color:fe.success},children:["Passed: ",d.jsx("strong",{children:p})]}),d.jsxs("span",{style:{color:fe.danger},children:["Failed: ",d.jsx("strong",{children:_})]})]})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),d.jsx(Oo,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read unauthorized budget"),onRun:()=>f("Read unauthorized budget"),disabled:i}),d.jsx(Oo,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read another user's document"),onRun:()=>f("Read another user's document"),disabled:i}),d.jsx(Oo,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(b=>b.name==="Read unauthorized budget month"),onRun:()=>f("Read unauthorized budget month"),disabled:i}),d.jsx(Oo,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_admin in own permission_flags"),onRun:()=>f("Toggle is_admin in own permission_flags"),disabled:i}),d.jsx(Oo,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_test in own permission_flags"),onRun:()=>f("Toggle is_test in own permission_flags"),disabled:i}),d.jsx(Oo,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(b=>b.name==="Read own user document"),onRun:()=>f("Read own user document"),disabled:i,expectedToSucceed:!0})]}),_>0&&d.jsxs(Al,{style:{marginTop:"1.5rem"},children:[" ",_," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function Oo({name:t,description:e,expectedBehavior:n,result:i,onRun:a,disabled:l,expectedToSucceed:c}){const h=i?.status==="passed"?fe.success:i?.status==="failed"?fe.danger:i?.status==="running"?fe.warning:"inherit";return d.jsxs("div",{style:{...xu,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),d.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),d.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:c?fe.success:fe.warning},children:["Expected: ",n]})]}),d.jsx(Be,{onClick:a,disabled:l,variant:"secondary",style:{flexShrink:0},children:i?.status==="running"?"":"Run"})]}),i&&i.status!=="pending"&&d.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${h} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${h} 30%, transparent)`,fontSize:"0.85rem",color:h},children:i.message})]})}function G4(){const{selectedBudgetId:t,currentUserId:e,accessibleBudgets:n,loadAccessibleBudgets:i,switchToBudget:a,checkBudgetInvite:l,isInitialized:c}=Sn();R.useEffect(()=>{c&&i()},[c,i]);const{budget:h,renameBudget:f,acceptInvite:p,isLoading:_}=Hn(t,e),[v,b]=R.useState(null),[S,T]=R.useState(null),[C,j]=R.useState(null),[z,q]=R.useState(null),[U,Z]=R.useState(null),[J,ne]=R.useState(""),[k,A]=R.useState(!1),[D,P]=R.useState(""),[O,N]=R.useState(!1),[I,K]=R.useState(null);async function F(se){if(se!==h?.id){b(se),j(null),q(null);try{await a(se),q("Switched to budget successfully!"),await i()}catch(te){j(te instanceof Error?te.message:"Failed to switch budget")}finally{b(null)}}}async function L(se){T(se),j(null),q(null);try{await p(se),q("Invitation accepted! You now have access to this budget."),await i()}catch(te){j(te instanceof Error?te.message:"Failed to accept invitation")}finally{T(null)}}async function $(se){if(se.preventDefault(),!!D.trim()){N(!0),j(null),K(null);try{const te=await l(D.trim());te?K(te):j("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(te){j(te instanceof Error?te.message:"Failed to check invitation")}finally{N(!1)}}}async function Y(){if(I){T(I.budgetId),j(null);try{await p(I.budgetId),q(`Successfully joined "${I.budgetName}"!`),K(null),P(""),await i()}catch(se){j(se instanceof Error?se.message:"Failed to accept invitation")}finally{T(null)}}}function Q(se,te){ne(te),Z(se)}function X(){Z(null),ne("")}async function V(se){if(se.preventDefault(),!(!J.trim()||!U)){A(!0),j(null),q(null);try{await f(J.trim()),q("Budget renamed successfully!"),Z(null),await i()}catch(te){j(te instanceof Error?te.message:"Failed to rename budget")}finally{A(!1)}}}const H=n.filter(se=>!se.isPending),oe=n.filter(se=>se.isPending);return _||!c?d.jsx(Xo,{children:d.jsx("p",{children:"Loading your budgets..."})}):d.jsxs(Xo,{children:[d.jsx(fi,{title:"My Budgets"}),d.jsx("h1",{children:"My Budgets"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Switch between budgets, accept invitations, or join a budget by ID."}),C&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:C}),d.jsx("button",{onClick:()=>j(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),z&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:z}),d.jsx("button",{onClick:()=>q(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),oe.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Pending Invitations (",oe.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:oe.map(se=>d.jsx(FE,{budget:se,isCurrent:!1,isAccepting:S===se.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>L(se.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},se.id))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Your Budgets (",H.length,")"]}),H.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:H.map(se=>{const te=se.id===h?.id,ge=U===se.id;return d.jsx(FE,{budget:se,isCurrent:te,isAccepting:!1,isSwitching:v===se.id,isEditing:ge,editName:ge?J:"",isRenaming:k,onAccept:()=>{},onSwitch:()=>F(se.id),onStartEdit:()=>Q(se.id,se.name),onCancelEdit:X,onEditNameChange:ne,onSaveEdit:V},se.id)})})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Join Budget by ID"]}),d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),I?d.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[d.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:I.budgetName}),I.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",I.ownerEmail]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{onClick:Y,disabled:S===I.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:S===I.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:S===I.budgetId?.7:1},children:S===I.budgetId?"Accepting...":"Accept Invitation"}),d.jsx("button",{onClick:()=>{K(null),P("")},disabled:S===I.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:S===I.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:S===I.budgetId?.7:.8},children:"Cancel"})]})]}):d.jsxs("form",{onSubmit:$,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:D,onChange:se=>P(se.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:O||!D.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:O||!D.trim()?"not-allowed":"pointer",fontWeight:500,opacity:O||!D.trim()?.7:1,whiteSpace:"nowrap"},children:O?"Checking...":"Check Invite"})]})]}),e&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[d.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),d.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:e})]})]})}function Q4({children:t}){const e=R.useContext(ou),n=kn();return e.is_auth_checked?e.is_logged_in?t?d.jsx(d.Fragment,{children:t}):d.jsx(ef,{}):d.jsx(Zh,{to:"/account",state:{from:n.pathname},replace:!0}):d.jsx("div",{style:qn,children:d.jsx("p",{children:"Loading..."})})}function $4(){const{selectedBudgetId:t,currentUserId:e,isInitialized:n}=Sn(),{isLoading:i,error:a}=Hn(t,e);return n?a?(console.error("[BudgetLayout] Error:",a),d.jsx("div",{style:qn,children:d.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",a.message]})})):d.jsx("div",{style:{paddingBottom:"5rem"},children:d.jsx(ef,{})}):d.jsxs("div",{style:qn,children:[d.jsx("p",{children:"Loading budget..."}),i&&d.jsx("p",{style:{opacity:.6},children:"Fetching data from server..."})]})}const K4={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function W4(){const[t,e]=R.useState(K4),n=za(),i=R.useRef(!1);return R.useEffect(function(){i.current||(i.current=!0,n.set_user_listener(a=>{e({is_logged_in:a!=null,is_auth_checked:!0,username:a?.email??"",set_user_context:e})}))},[n]),t.is_auth_checked?d.jsx(ou.Provider,{value:t,children:d.jsx(jD,{children:d.jsx(XN,{children:d.jsxs(xR,{children:[d.jsxs(YC,{children:[d.jsx(Jt,{path:"/",element:d.jsx(_6,{})}),d.jsx(Jt,{path:"/account",element:d.jsx(O6,{})}),d.jsx(Jt,{path:"/sql-test",element:d.jsx(k6,{})}),d.jsx(Jt,{path:"/budget",element:d.jsx(Q4,{}),children:d.jsxs(Jt,{element:d.jsx($4,{}),children:[d.jsx(Jt,{index:!0,element:d.jsx(zE,{})}),d.jsx(Jt,{path:":year/:month/:tab",element:d.jsx(zE,{})}),d.jsx(Jt,{path:"analytics",element:d.jsx(g4,{})}),d.jsx(Jt,{path:"my-budgets",element:d.jsx(G4,{})}),d.jsxs(Jt,{path:"settings",element:d.jsx(R4,{}),children:[d.jsx(Jt,{index:!0,element:d.jsx(Zh,{to:"categories",replace:!0})}),d.jsx(Jt,{path:"accounts",element:d.jsx(S4,{})}),d.jsx(Jt,{path:"categories",element:d.jsx(A4,{})}),d.jsx(Jt,{path:"users",element:d.jsx(D4,{})})]}),d.jsxs(Jt,{path:"admin",element:d.jsx(j4,{}),children:[d.jsx(Jt,{path:"budget",element:d.jsx(k4,{})}),d.jsx(Jt,{path:"feedback",element:d.jsx(q4,{})}),d.jsx(Jt,{path:"migration",element:d.jsx(F4,{})}),d.jsx(Jt,{path:"tests",element:d.jsx(H4,{})})]})]})})]}),d.jsx(A6,{})]})})})}):d.jsx("div",{style:qn,children:d.jsx("p",{children:"Loading..."})})}YA.createRoot(document.getElementById("root")).render(d.jsx(R.StrictMode,{children:d.jsx(W4,{})}));
