(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var gp={exports:{}},Ic={};var hb;function tC(){if(hb)return Ic;hb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var h in a)h!=="key"&&(l[h]=a[h])}else l=a;return a=l.ref,{$$typeof:t,type:i,key:c,ref:a!==void 0?a:null,props:l}}return Ic.Fragment=e,Ic.jsx=n,Ic.jsxs=n,Ic}var fb;function nC(){return fb||(fb=1,gp.exports=tC()),gp.exports}var d=nC(),yp={exports:{}},ze={};var mb;function rC(){if(mb)return ze;mb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),b=Symbol.iterator;function w(B){return B===null||typeof B!="object"?null:(B=b&&B[b]||B["@@iterator"],typeof B=="function"?B:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,M={};function F(B,U,G){this.props=B,this.context=U,this.refs=M,this.updater=G||A}F.prototype.isReactComponent={},F.prototype.setState=function(B,U){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,U,"setState")},F.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function H(){}H.prototype=F.prototype;function z(B,U,G){this.props=B,this.context=U,this.refs=M,this.updater=G||A}var ee=z.prototype=new H;ee.constructor=z,S(ee,F.prototype),ee.isPureReactComponent=!0;var J=Array.isArray;function me(){}var P={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function I(B,U,G){var K=G.ref;return{$$typeof:t,type:B,key:U,ref:K!==void 0?K:null,props:G}}function N(B,U){return I(B.type,U,B.props)}function O(B){return typeof B=="object"&&B!==null&&B.$$typeof===t}function k(B){var U={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(G){return U[G]})}var R=/\/+/g;function ae(B,U){return typeof B=="object"&&B!==null&&B.key!=null?k(""+B.key):U.toString(36)}function q(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(me,me):(B.status="pending",B.then(function(U){B.status==="pending"&&(B.status="fulfilled",B.value=U)},function(U){B.status==="pending"&&(B.status="rejected",B.reason=U)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function V(B,U,G,K,te){var he=typeof B;(he==="undefined"||he==="boolean")&&(B=null);var be=!1;if(B===null)be=!0;else switch(he){case"bigint":case"string":case"number":be=!0;break;case"object":switch(B.$$typeof){case t:case e:be=!0;break;case _:return be=B._init,V(be(B._payload),U,G,K,te)}}if(be)return te=te(B),be=K===""?"."+ae(B,0):K,J(te)?(G="",be!=null&&(G=be.replace(R,"$&/")+"/"),V(te,U,G,"",function(Y){return Y})):te!=null&&(O(te)&&(te=N(te,G+(te.key==null||B&&B.key===te.key?"":(""+te.key).replace(R,"$&/")+"/")+be)),U.push(te)),1;be=0;var xe=K===""?".":K+":";if(J(B))for(var oe=0;oe<B.length;oe++)K=B[oe],he=xe+ae(K,oe),be+=V(K,U,G,he,te);else if(oe=w(B),typeof oe=="function")for(B=oe.call(B),oe=0;!(K=B.next()).done;)K=K.value,he=xe+ae(K,oe++),be+=V(K,U,G,he,te);else if(he==="object"){if(typeof B.then=="function")return V(q(B),U,G,K,te);throw U=String(B),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return be}function Q(B,U,G){if(B==null)return B;var K=[],te=0;return V(B,K,"","",function(he){return U.call(G,he,te++)}),K}function W(B){if(B._status===-1){var U=B._result;U=U(),U.then(function(G){(B._status===0||B._status===-1)&&(B._status=1,B._result=G)},function(G){(B._status===0||B._status===-1)&&(B._status=2,B._result=G)}),B._status===-1&&(B._status=0,B._result=U)}if(B._status===1)return B._result.default;throw B._result}var de=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},ne={map:Q,forEach:function(B,U,G){Q(B,function(){U.apply(this,arguments)},G)},count:function(B){var U=0;return Q(B,function(){U++}),U},toArray:function(B){return Q(B,function(U){return U})||[]},only:function(B){if(!O(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return ze.Activity=v,ze.Children=ne,ze.Component=F,ze.Fragment=n,ze.Profiler=a,ze.PureComponent=z,ze.StrictMode=i,ze.Suspense=m,ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,ze.__COMPILER_RUNTIME={__proto__:null,c:function(B){return P.H.useMemoCache(B)}},ze.cache=function(B){return function(){return B.apply(null,arguments)}},ze.cacheSignal=function(){return null},ze.cloneElement=function(B,U,G){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var K=S({},B.props),te=B.key;if(U!=null)for(he in U.key!==void 0&&(te=""+U.key),U)!D.call(U,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&U.ref===void 0||(K[he]=U[he]);var he=arguments.length-2;if(he===1)K.children=G;else if(1<he){for(var be=Array(he),xe=0;xe<he;xe++)be[xe]=arguments[xe+2];K.children=be}return I(B.type,te,K)},ze.createContext=function(B){return B={$$typeof:c,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:l,_context:B},B},ze.createElement=function(B,U,G){var K,te={},he=null;if(U!=null)for(K in U.key!==void 0&&(he=""+U.key),U)D.call(U,K)&&K!=="key"&&K!=="__self"&&K!=="__source"&&(te[K]=U[K]);var be=arguments.length-2;if(be===1)te.children=G;else if(1<be){for(var xe=Array(be),oe=0;oe<be;oe++)xe[oe]=arguments[oe+2];te.children=xe}if(B&&B.defaultProps)for(K in be=B.defaultProps,be)te[K]===void 0&&(te[K]=be[K]);return I(B,he,te)},ze.createRef=function(){return{current:null}},ze.forwardRef=function(B){return{$$typeof:h,render:B}},ze.isValidElement=O,ze.lazy=function(B){return{$$typeof:_,_payload:{_status:-1,_result:B},_init:W}},ze.memo=function(B,U){return{$$typeof:g,type:B,compare:U===void 0?null:U}},ze.startTransition=function(B){var U=P.T,G={};P.T=G;try{var K=B(),te=P.S;te!==null&&te(G,K),typeof K=="object"&&K!==null&&typeof K.then=="function"&&K.then(me,de)}catch(he){de(he)}finally{U!==null&&G.types!==null&&(U.types=G.types),P.T=U}},ze.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},ze.use=function(B){return P.H.use(B)},ze.useActionState=function(B,U,G){return P.H.useActionState(B,U,G)},ze.useCallback=function(B,U){return P.H.useCallback(B,U)},ze.useContext=function(B){return P.H.useContext(B)},ze.useDebugValue=function(){},ze.useDeferredValue=function(B,U){return P.H.useDeferredValue(B,U)},ze.useEffect=function(B,U){return P.H.useEffect(B,U)},ze.useEffectEvent=function(B){return P.H.useEffectEvent(B)},ze.useId=function(){return P.H.useId()},ze.useImperativeHandle=function(B,U,G){return P.H.useImperativeHandle(B,U,G)},ze.useInsertionEffect=function(B,U){return P.H.useInsertionEffect(B,U)},ze.useLayoutEffect=function(B,U){return P.H.useLayoutEffect(B,U)},ze.useMemo=function(B,U){return P.H.useMemo(B,U)},ze.useOptimistic=function(B,U){return P.H.useOptimistic(B,U)},ze.useReducer=function(B,U,G){return P.H.useReducer(B,U,G)},ze.useRef=function(B){return P.H.useRef(B)},ze.useState=function(B){return P.H.useState(B)},ze.useSyncExternalStore=function(B,U,G){return P.H.useSyncExternalStore(B,U,G)},ze.useTransition=function(){return P.H.useTransition()},ze.version="19.2.3",ze}var pb;function Dg(){return pb||(pb=1,yp.exports=rC()),yp.exports}var C=Dg(),_p={exports:{}},jc={},vp={exports:{}},bp={};var gb;function iC(){return gb||(gb=1,(function(t){function e(V,Q){var W=V.length;V.push(Q);e:for(;0<W;){var de=W-1>>>1,ne=V[de];if(0<a(ne,Q))V[de]=Q,V[W]=ne,W=de;else break e}}function n(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var Q=V[0],W=V.pop();if(W!==Q){V[0]=W;e:for(var de=0,ne=V.length,B=ne>>>1;de<B;){var U=2*(de+1)-1,G=V[U],K=U+1,te=V[K];if(0>a(G,W))K<ne&&0>a(te,G)?(V[de]=te,V[K]=W,de=K):(V[de]=G,V[U]=W,de=U);else if(K<ne&&0>a(te,W))V[de]=te,V[K]=W,de=K;else break e}}return Q}function a(V,Q){var W=V.sortIndex-Q.sortIndex;return W!==0?W:V.id-Q.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,h=c.now();t.unstable_now=function(){return c.now()-h}}var m=[],g=[],_=1,v=null,b=3,w=!1,A=!1,S=!1,M=!1,F=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;function ee(V){for(var Q=n(g);Q!==null;){if(Q.callback===null)i(g);else if(Q.startTime<=V)i(g),Q.sortIndex=Q.expirationTime,e(m,Q);else break;Q=n(g)}}function J(V){if(S=!1,ee(V),!A)if(n(m)!==null)A=!0,me||(me=!0,k());else{var Q=n(g);Q!==null&&q(J,Q.startTime-V)}}var me=!1,P=-1,D=5,I=-1;function N(){return M?!0:!(t.unstable_now()-I<D)}function O(){if(M=!1,me){var V=t.unstable_now();I=V;var Q=!0;try{e:{A=!1,S&&(S=!1,H(P),P=-1),w=!0;var W=b;try{t:{for(ee(V),v=n(m);v!==null&&!(v.expirationTime>V&&N());){var de=v.callback;if(typeof de=="function"){v.callback=null,b=v.priorityLevel;var ne=de(v.expirationTime<=V);if(V=t.unstable_now(),typeof ne=="function"){v.callback=ne,ee(V),Q=!0;break t}v===n(m)&&i(m),ee(V)}else i(m);v=n(m)}if(v!==null)Q=!0;else{var B=n(g);B!==null&&q(J,B.startTime-V),Q=!1}}break e}finally{v=null,b=W,w=!1}Q=void 0}}finally{Q?k():me=!1}}}var k;if(typeof z=="function")k=function(){z(O)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,ae=R.port2;R.port1.onmessage=O,k=function(){ae.postMessage(null)}}else k=function(){F(O,0)};function q(V,Q){P=F(function(){V(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_next=function(V){switch(b){case 1:case 2:case 3:var Q=3;break;default:Q=b}var W=b;b=Q;try{return V()}finally{b=W}},t.unstable_requestPaint=function(){M=!0},t.unstable_runWithPriority=function(V,Q){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var W=b;b=V;try{return Q()}finally{b=W}},t.unstable_scheduleCallback=function(V,Q,W){var de=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?de+W:de):W=de,V){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=W+ne,V={id:_++,callback:Q,priorityLevel:V,startTime:W,expirationTime:ne,sortIndex:-1},W>de?(V.sortIndex=W,e(g,V),n(m)===null&&V===n(g)&&(S?(H(P),P=-1):S=!0,q(J,W-de))):(V.sortIndex=ne,e(m,V),A||w||(A=!0,me||(me=!0,k()))),V},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(V){var Q=b;return function(){var W=b;b=Q;try{return V.apply(this,arguments)}finally{b=W}}}})(bp)),bp}var yb;function sC(){return yb||(yb=1,vp.exports=iC()),vp.exports}var xp={exports:{}},En={};var _b;function aC(){if(_b)return En;_b=1;var t=Dg();function e(m){var g="https://react.dev/errors/"+m;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(m,g,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:m,containerInfo:g,implementation:_}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(m,g){if(m==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return En.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,En.createPortal=function(m,g){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return l(m,g,null,_)},En.flushSync=function(m){var g=c.T,_=i.p;try{if(c.T=null,i.p=2,m)return m()}finally{c.T=g,i.p=_,i.d.f()}},En.preconnect=function(m,g){typeof m=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(m,g))},En.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},En.preinit=function(m,g){if(typeof m=="string"&&g&&typeof g.as=="string"){var _=g.as,v=h(_,g.crossOrigin),b=typeof g.integrity=="string"?g.integrity:void 0,w=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;_==="style"?i.d.S(m,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:w}):_==="script"&&i.d.X(m,{crossOrigin:v,integrity:b,fetchPriority:w,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},En.preinitModule=function(m,g){if(typeof m=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var _=h(g.as,g.crossOrigin);i.d.M(m,{crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(m)},En.preload=function(m,g){if(typeof m=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var _=g.as,v=h(_,g.crossOrigin);i.d.L(m,_,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},En.preloadModule=function(m,g){if(typeof m=="string")if(g){var _=h(g.as,g.crossOrigin);i.d.m(m,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(m)},En.requestFormReset=function(m){i.d.r(m)},En.unstable_batchedUpdates=function(m,g){return m(g)},En.useFormState=function(m,g,_){return c.H.useFormState(m,g,_)},En.useFormStatus=function(){return c.H.useHostTransitionStatus()},En.version="19.2.3",En}var vb;function oC(){if(vb)return xp.exports;vb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),xp.exports=aC(),xp.exports}var bb;function lC(){if(bb)return jc;bb=1;var t=sC(),e=Dg(),n=oC();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var s=r,o=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(o=s.return),r=s.return;while(r)}return s.tag===3?o:null}function c(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function h(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function m(r){if(l(r)!==r)throw Error(i(188))}function g(r){var s=r.alternate;if(!s){if(s=l(r),s===null)throw Error(i(188));return s!==r?null:r}for(var o=r,u=s;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(u=p.return,u!==null){o=u;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return m(p),r;if(y===u)return m(p),s;y=y.sibling}throw Error(i(188))}if(o.return!==u.return)o=p,u=y;else{for(var E=!1,j=p.child;j;){if(j===o){E=!0,o=p,u=y;break}if(j===u){E=!0,u=p,o=y;break}j=j.sibling}if(!E){for(j=y.child;j;){if(j===o){E=!0,o=y,u=p;break}if(j===u){E=!0,u=y,o=p;break}j=j.sibling}if(!E)throw Error(i(189))}}if(o.alternate!==u)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?r:s}function _(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=_(r),s!==null)return s;r=r.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),z=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),me=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),N=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function k(r){return r===null||typeof r!="object"?null:(r=O&&r[O]||r["@@iterator"],typeof r=="function"?r:null)}var R=Symbol.for("react.client.reference");function ae(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===R?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case S:return"Fragment";case F:return"Profiler";case M:return"StrictMode";case J:return"Suspense";case me:return"SuspenseList";case I:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case A:return"Portal";case z:return r.displayName||"Context";case H:return(r._context.displayName||"Context")+".Consumer";case ee:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case P:return s=r.displayName||null,s!==null?s:ae(r.type)||"Memo";case D:s=r._payload,r=r._init;try{return ae(r(s))}catch{}}return null}var q=Array.isArray,V=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},de=[],ne=-1;function B(r){return{current:r}}function U(r){0>ne||(r.current=de[ne],de[ne]=null,ne--)}function G(r,s){ne++,de[ne]=r.current,r.current=s}var K=B(null),te=B(null),he=B(null),be=B(null);function xe(r,s){switch(G(he,s),G(te,r),G(K,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?Nv(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=Nv(s),r=Pv(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}U(K),G(K,r)}function oe(){U(K),U(te),U(he)}function Y(r){r.memoizedState!==null&&G(be,r);var s=K.current,o=Pv(s,r.type);s!==o&&(G(te,r),G(K,o))}function Se(r){te.current===r&&(U(K),U(te)),be.current===r&&(U(be),Ac._currentValue=W)}var Re,Ge;function Be(r){if(Re===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Re=s&&s[1]||"",Ge=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Re+r+Ge}var yt=!1;function Cn(r,s){if(!r||yt)return"";yt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(fe){var le=fe}Reflect.construct(r,[],ye)}else{try{ye.call()}catch(fe){le=fe}r.call(ye.prototype)}}else{try{throw Error()}catch(fe){le=fe}(ye=r())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(fe){if(fe&&le&&typeof fe.stack=="string")return[fe.stack,le.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),E=y[0],j=y[1];if(E&&j){var $=E.split(`
`),se=j.split(`
`);for(p=u=0;u<$.length&&!$[u].includes("DetermineComponentFrameRoot");)u++;for(;p<se.length&&!se[p].includes("DetermineComponentFrameRoot");)p++;if(u===$.length||p===se.length)for(u=$.length-1,p=se.length-1;1<=u&&0<=p&&$[u]!==se[p];)p--;for(;1<=u&&0<=p;u--,p--)if($[u]!==se[p]){if(u!==1||p!==1)do if(u--,p--,0>p||$[u]!==se[p]){var pe=`
`+$[u].replace(" at new "," at ");return r.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",r.displayName)),pe}while(1<=u&&0<=p);break}}}finally{yt=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?Be(o):""}function dn(r,s){switch(r.tag){case 26:case 27:case 5:return Be(r.type);case 16:return Be("Lazy");case 13:return r.child!==s&&s!==null?Be("Suspense Fallback"):Be("Suspense");case 19:return Be("SuspenseList");case 0:case 15:return Cn(r.type,!1);case 11:return Cn(r.type.render,!1);case 1:return Cn(r.type,!0);case 31:return Be("Activity");default:return""}}function sr(r){try{var s="",o=null;do s+=dn(r,o),o=r,r=r.return;while(r);return s}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Ct=Object.prototype.hasOwnProperty,jt=t.unstable_scheduleCallback,rt=t.unstable_cancelCallback,qn=t.unstable_shouldYield,wr=t.unstable_requestPaint,Rt=t.unstable_now,Hn=t.unstable_getCurrentPriorityLevel,Vt=t.unstable_ImmediatePriority,Gn=t.unstable_UserBlockingPriority,Zi=t.unstable_NormalPriority,vf=t.unstable_LowPriority,Eu=t.unstable_IdlePriority,wu=t.log,Su=t.unstable_setDisableYieldValue,Sr=null,hn=null;function ar(r){if(typeof wu=="function"&&Su(r),hn&&typeof hn.setStrictMode=="function")try{hn.setStrictMode(Sr,r)}catch{}}var Ot=Math.clz32?Math.clz32:Au,Tu=Math.log,Ja=Math.LN2;function Au(r){return r>>>=0,r===0?32:31-(Tu(r)/Ja|0)|0}var Fr=256,ra=262144,zt=4194304;function qr(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Hr(r,s,o){var u=r.pendingLanes;if(u===0)return 0;var p=0,y=r.suspendedLanes,E=r.pingedLanes;r=r.warmLanes;var j=u&134217727;return j!==0?(u=j&~y,u!==0?p=qr(u):(E&=j,E!==0?p=qr(E):o||(o=j&~r,o!==0&&(p=qr(o))))):(j=u&~y,j!==0?p=qr(j):E!==0?p=qr(E):o||(o=u&~r,o!==0&&(p=qr(o)))),p===0?0:s!==0&&s!==p&&(s&y)===0&&(y=p&-p,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:p}function Tr(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function bf(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Cu(){var r=zt;return zt<<=1,(zt&62914560)===0&&(zt=4194304),r}function Gr(r){for(var s=[],o=0;31>o;o++)s.push(r);return s}function ia(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function xf(r,s,o,u,p,y){var E=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var j=r.entanglements,$=r.expirationTimes,se=r.hiddenUpdates;for(o=E&~o;0<o;){var pe=31-Ot(o),ye=1<<pe;j[pe]=0,$[pe]=-1;var le=se[pe];if(le!==null)for(se[pe]=null,pe=0;pe<le.length;pe++){var fe=le[pe];fe!==null&&(fe.lane&=-536870913)}o&=~ye}u!==0&&sa(r,u,0),y!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=y&~(E&~s))}function sa(r,s,o){r.pendingLanes|=s,r.suspendedLanes&=~s;var u=31-Ot(s);r.entangledLanes|=s,r.entanglements[u]=r.entanglements[u]|1073741824|o&261930}function jl(r,s){var o=r.entangledLanes|=s;for(r=r.entanglements;o;){var u=31-Ot(o),p=1<<u;p&s|r[u]&s&&(r[u]|=s),o&=~p}}function Ol(r,s){var o=s&-s;return o=(o&42)!==0?1:aa(o),(o&(r.suspendedLanes|s))!==0?0:o}function aa(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function xi(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Ru(){var r=Q.p;return r!==0?r:(r=window.event,r===void 0?32:sb(r.type))}function Ar(r,s){var o=Q.p;try{return Q.p=r,s()}finally{Q.p=o}}var Cr=Math.random().toString(36).slice(2),Ut="__reactFiber$"+Cr,sn="__reactProps$"+Cr,$r="__reactContainer$"+Cr,Za="__reactEvents$"+Cr,Ef="__reactListeners$"+Cr,Du="__reactHandles$"+Cr,Iu="__reactResources$"+Cr,Qr="__reactMarker$"+Cr;function eo(r){delete r[Ut],delete r[sn],delete r[Za],delete r[Ef],delete r[Du]}function Wr(r){var s=r[Ut];if(s)return s;for(var o=r.parentNode;o;){if(s=o[$r]||o[Ut]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(r=qv(r);r!==null;){if(o=r[Ut])return o;r=qv(r)}return s}r=o,o=r.parentNode}return null}function or(r){if(r=r[Ut]||r[$r]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function $n(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function Kr(r){var s=r[Iu];return s||(s=r[Iu]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Bt(r){r[Qr]=!0}var Ml=new Set,kl={};function Yr(r,s){Xr(r,s),Xr(r+"Capture",s)}function Xr(r,s){for(kl[r]=s,r=0;r<s.length;r++)Ml.add(s[r])}var Nl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Pl={},Ll={};function ju(r){return Ct.call(Ll,r)?!0:Ct.call(Pl,r)?!1:Nl.test(r)?Ll[r]=!0:(Pl[r]=!0,!1)}function to(r,s,o){if(ju(s))if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+o)}}function Qn(r,s,o){if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+o)}}function Ft(r,s,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(s,o,""+u)}}function an(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function es(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Vl(r,s,o){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,y=u.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return p.call(this)},set:function(E){o=""+E,y.call(this,E)}}),Object.defineProperty(r,s,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function ot(r){if(!r._valueTracker){var s=es(r)?"checked":"value";r._valueTracker=Vl(r,s,""+r[s])}}function oa(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var o=s.getValue(),u="";return r&&(u=es(r)?r.checked?"true":"false":r.value),r=u,r!==o?(s.setValue(r),!0):!1}function Jr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var la=/[\n"\\]/g;function On(r){return r.replace(la,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function no(r,s,o,u,p,y,E,j){r.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?r.type=E:r.removeAttribute("type"),s!=null?E==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+an(s)):r.value!==""+an(s)&&(r.value=""+an(s)):E!=="submit"&&E!=="reset"||r.removeAttribute("value"),s!=null?zl(r,E,an(s)):o!=null?zl(r,E,an(o)):u!=null&&r.removeAttribute("value"),p==null&&y!=null&&(r.defaultChecked=!!y),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?r.name=""+an(j):r.removeAttribute("name")}function Ou(r,s,o,u,p,y,E,j){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ot(r);return}o=o!=null?""+an(o):"",s=s!=null?""+an(s):o,j||s===r.value||(r.value=s),r.defaultValue=s}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=j?r.checked:!!u,r.defaultChecked=!!u,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.name=E),ot(r)}function zl(r,s,o){s==="number"&&Jr(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function ts(r,s,o,u){if(r=r.options,s){s={};for(var p=0;p<o.length;p++)s["$"+o[p]]=!0;for(o=0;o<r.length;o++)p=s.hasOwnProperty("$"+r[o].value),r[o].selected!==p&&(r[o].selected=p),p&&u&&(r[o].defaultSelected=!0)}else{for(o=""+an(o),s=null,p=0;p<r.length;p++){if(r[p].value===o){r[p].selected=!0,u&&(r[p].defaultSelected=!0);return}s!==null||r[p].disabled||(s=r[p])}s!==null&&(s.selected=!0)}}function Mu(r,s,o){if(s!=null&&(s=""+an(s),s!==r.value&&(r.value=s),o==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=o!=null?""+an(o):""}function ns(r,s,o,u){if(s==null){if(u!=null){if(o!=null)throw Error(i(92));if(q(u)){if(1<u.length)throw Error(i(93));u=u[0]}o=u}o==null&&(o=""),s=o}o=an(s),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u),ot(r)}function Mn(r,s){if(s){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=s;return}}r.textContent=s}var ku=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ul(r,s,o){var u=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":u?r.setProperty(s,o):typeof o!="number"||o===0||ku.has(s)?s==="float"?r.cssFloat=o:r[s]=(""+o).trim():r[s]=o+"px"}function Bl(r,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var p in s)u=s[p],s.hasOwnProperty(p)&&o[p]!==u&&Ul(r,p,u)}else for(var y in s)s.hasOwnProperty(y)&&Ul(r,y,s[y])}function ro(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),rs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function io(r){return rs.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Rr(){}var Fl=null;function lr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var is=null,Zr=null;function ca(r){var s=or(r);if(s&&(r=s.stateNode)){var o=r[sn]||null;e:switch(r=s.stateNode,s.type){case"input":if(no(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+On(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var u=o[s];if(u!==r&&u.form===r.form){var p=u[sn]||null;if(!p)throw Error(i(90));no(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<o.length;s++)u=o[s],u.form===r.form&&oa(u)}break e;case"textarea":Mu(r,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&ts(r,!!o.multiple,s,!1)}}}var so=!1;function ss(r,s,o){if(so)return r(s,o);so=!0;try{var u=r(s);return u}finally{if(so=!1,(is!==null||Zr!==null)&&(Rd(),is&&(s=is,r=Zr,Zr=is=null,ca(s),r)))for(s=0;s<r.length;s++)ca(r[s])}}function Dr(r,s){var o=r.stateNode;if(o===null)return null;var u=o[sn]||null;if(u===null)return null;o=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ua=!1;if(cr)try{var ut={};Object.defineProperty(ut,"passive",{get:function(){ua=!0}}),window.addEventListener("test",ut,ut),window.removeEventListener("test",ut,ut)}catch{ua=!1}var ei=null,ql=null,da=null;function Hl(){if(da)return da;var r,s=ql,o=s.length,u,p="value"in ei?ei.value:ei.textContent,y=p.length;for(r=0;r<o&&s[r]===p[r];r++);var E=o-r;for(u=1;u<=E&&s[o-u]===p[y-u];u++);return da=p.slice(r,1<u?1-u:void 0)}function ha(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function Ei(){return!0}function Ir(){return!1}function fn(r){function s(o,u,p,y,E){this._reactName=o,this._targetInst=p,this.type=u,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var j in r)r.hasOwnProperty(j)&&(o=r[j],this[j]=o?o(y):y[j]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ei:Ir,this.isPropagationStopped=Ir,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ei)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ei)},persist:function(){},isPersistent:Ei}),s}var wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ti=fn(wi),as=v({},wi,{view:0,detail:0}),Gl=fn(as),os,ao,ni,oo=v({},as,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ls,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ni&&(ni&&r.type==="mousemove"?(os=r.screenX-ni.screenX,ao=r.screenY-ni.screenY):ao=os=0,ni=r),os)},movementY:function(r){return"movementY"in r?r.movementY:ao}}),$l=fn(oo),fa=v({},oo,{dataTransfer:0}),Pu=fn(fa),Lu=v({},as,{relatedTarget:0}),ma=fn(Lu),Ql=v({},wi,{animationName:0,elapsedTime:0,pseudoElement:0}),Vu=fn(Ql),lo=v({},wi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),zu=fn(lo),Uu=v({},wi,{data:0}),ri=fn(Uu),Bu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hu(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=qu[r])?!!s[r]:!1}function ls(){return Hu}var Rn=v({},as,{key:function(r){if(r.key){var s=Bu[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=ha(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Fu[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ls,charCode:function(r){return r.type==="keypress"?ha(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ha(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Gu=fn(Rn),$u=v({},oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Si=fn($u),f=v({},as,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ls}),x=fn(f),T=v({},wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),L=fn(T),re=v({},oo,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),ue=fn(re),we=v({},wi,{newState:0,oldState:0}),Fe=fn(we),Mt=[9,13,27,32],it=cr&&"CompositionEvent"in window,Et=null;cr&&"documentMode"in document&&(Et=document.documentMode);var ur=cr&&"TextEvent"in window&&!Et,ii=cr&&(!it||Et&&8<Et&&11>=Et),jr=" ",Or=!1;function pa(r,s){switch(r){case"keyup":return Mt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function co(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var uo=!1;function TT(r,s){switch(r){case"compositionend":return co(s);case"keypress":return s.which!==32?null:(Or=!0,jr);case"textInput":return r=s.data,r===jr&&Or?null:r;default:return null}}function AT(r,s){if(uo)return r==="compositionend"||!it&&pa(r,s)?(r=Hl(),da=ql=ei=null,uo=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ii&&s.locale!=="ko"?null:s.data;default:return null}}var CT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $y(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!CT[r.type]:s==="textarea"}function Qy(r,s,o,u){is?Zr?Zr.push(u):Zr=[u]:is=u,s=Nd(s,"onChange"),0<s.length&&(o=new ti("onChange","change",null,o,u),r.push({event:o,listeners:s}))}var Wl=null,Kl=null;function RT(r){Dv(r,0)}function Qu(r){var s=$n(r);if(oa(s))return r}function Wy(r,s){if(r==="change")return s}var Ky=!1;if(cr){var wf;if(cr){var Sf="oninput"in document;if(!Sf){var Yy=document.createElement("div");Yy.setAttribute("oninput","return;"),Sf=typeof Yy.oninput=="function"}wf=Sf}else wf=!1;Ky=wf&&(!document.documentMode||9<document.documentMode)}function Xy(){Wl&&(Wl.detachEvent("onpropertychange",Jy),Kl=Wl=null)}function Jy(r){if(r.propertyName==="value"&&Qu(Kl)){var s=[];Qy(s,Kl,r,lr(r)),ss(RT,s)}}function DT(r,s,o){r==="focusin"?(Xy(),Wl=s,Kl=o,Wl.attachEvent("onpropertychange",Jy)):r==="focusout"&&Xy()}function IT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Qu(Kl)}function jT(r,s){if(r==="click")return Qu(s)}function OT(r,s){if(r==="input"||r==="change")return Qu(s)}function MT(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Wn=typeof Object.is=="function"?Object.is:MT;function Yl(r,s){if(Wn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var o=Object.keys(r),u=Object.keys(s);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var p=o[u];if(!Ct.call(s,p)||!Wn(r[p],s[p]))return!1}return!0}function Zy(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function e_(r,s){var o=Zy(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=s&&u>=s)return{node:o,offset:s-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Zy(o)}}function t_(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?t_(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function n_(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=Jr(r.document);s instanceof r.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)r=s.contentWindow;else break;s=Jr(r.document)}return s}function Tf(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var kT=cr&&"documentMode"in document&&11>=document.documentMode,ho=null,Af=null,Xl=null,Cf=!1;function r_(r,s,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Cf||ho==null||ho!==Jr(u)||(u=ho,"selectionStart"in u&&Tf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Xl&&Yl(Xl,u)||(Xl=u,u=Nd(Af,"onSelect"),0<u.length&&(s=new ti("onSelect","select",null,s,o),r.push({event:s,listeners:u}),s.target=ho)))}function ga(r,s){var o={};return o[r.toLowerCase()]=s.toLowerCase(),o["Webkit"+r]="webkit"+s,o["Moz"+r]="moz"+s,o}var fo={animationend:ga("Animation","AnimationEnd"),animationiteration:ga("Animation","AnimationIteration"),animationstart:ga("Animation","AnimationStart"),transitionrun:ga("Transition","TransitionRun"),transitionstart:ga("Transition","TransitionStart"),transitioncancel:ga("Transition","TransitionCancel"),transitionend:ga("Transition","TransitionEnd")},Rf={},i_={};cr&&(i_=document.createElement("div").style,"AnimationEvent"in window||(delete fo.animationend.animation,delete fo.animationiteration.animation,delete fo.animationstart.animation),"TransitionEvent"in window||delete fo.transitionend.transition);function ya(r){if(Rf[r])return Rf[r];if(!fo[r])return r;var s=fo[r],o;for(o in s)if(s.hasOwnProperty(o)&&o in i_)return Rf[r]=s[o];return r}var s_=ya("animationend"),a_=ya("animationiteration"),o_=ya("animationstart"),NT=ya("transitionrun"),PT=ya("transitionstart"),LT=ya("transitioncancel"),l_=ya("transitionend"),c_=new Map,Df="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Df.push("scrollEnd");function Mr(r,s){c_.set(r,s),Yr(s,[r])}var Wu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},dr=[],mo=0,If=0;function Ku(){for(var r=mo,s=If=mo=0;s<r;){var o=dr[s];dr[s++]=null;var u=dr[s];dr[s++]=null;var p=dr[s];dr[s++]=null;var y=dr[s];if(dr[s++]=null,u!==null&&p!==null){var E=u.pending;E===null?p.next=p:(p.next=E.next,E.next=p),u.pending=p}y!==0&&u_(o,p,y)}}function Yu(r,s,o,u){dr[mo++]=r,dr[mo++]=s,dr[mo++]=o,dr[mo++]=u,If|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function jf(r,s,o,u){return Yu(r,s,o,u),Xu(r)}function _a(r,s){return Yu(r,null,null,s),Xu(r)}function u_(r,s,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var p=!1,y=r.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(p=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,p&&s!==null&&(p=31-Ot(o),r=y.hiddenUpdates,u=r[p],u===null?r[p]=[s]:u.push(s),s.lane=o|536870912),y):null}function Xu(r){if(50<vc)throw vc=0,Um=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var po={};function VT(r,s,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kn(r,s,o,u){return new VT(r,s,o,u)}function Of(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ti(r,s){var o=r.alternate;return o===null?(o=Kn(r.tag,s,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=s,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,s=r.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function d_(r,s){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,s=o.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function Ju(r,s,o,u,p,y){var E=0;if(u=r,typeof r=="function")Of(r)&&(E=1);else if(typeof r=="string")E=qA(r,o,K.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case I:return r=Kn(31,o,s,p),r.elementType=I,r.lanes=y,r;case S:return va(o.children,p,y,s);case M:E=8,p|=24;break;case F:return r=Kn(12,o,s,p|2),r.elementType=F,r.lanes=y,r;case J:return r=Kn(13,o,s,p),r.elementType=J,r.lanes=y,r;case me:return r=Kn(19,o,s,p),r.elementType=me,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case z:E=10;break e;case H:E=9;break e;case ee:E=11;break e;case P:E=14;break e;case D:E=16,u=null;break e}E=29,o=Error(i(130,r===null?"null":typeof r,"")),u=null}return s=Kn(E,o,s,p),s.elementType=r,s.type=u,s.lanes=y,s}function va(r,s,o,u){return r=Kn(7,r,u,s),r.lanes=o,r}function Mf(r,s,o){return r=Kn(6,r,null,s),r.lanes=o,r}function h_(r){var s=Kn(18,null,null,0);return s.stateNode=r,s}function kf(r,s,o){return s=Kn(4,r.children!==null?r.children:[],r.key,s),s.lanes=o,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var f_=new WeakMap;function hr(r,s){if(typeof r=="object"&&r!==null){var o=f_.get(r);return o!==void 0?o:(s={value:r,source:s,stack:sr(s)},f_.set(r,s),s)}return{value:r,source:s,stack:sr(s)}}var go=[],yo=0,Zu=null,Jl=0,fr=[],mr=0,cs=null,si=1,ai="";function Ai(r,s){go[yo++]=Jl,go[yo++]=Zu,Zu=r,Jl=s}function m_(r,s,o){fr[mr++]=si,fr[mr++]=ai,fr[mr++]=cs,cs=r;var u=si;r=ai;var p=32-Ot(u)-1;u&=~(1<<p),o+=1;var y=32-Ot(s)+p;if(30<y){var E=p-p%5;y=(u&(1<<E)-1).toString(32),u>>=E,p-=E,si=1<<32-Ot(s)+p|o<<p|u,ai=y+r}else si=1<<y|o<<p|u,ai=r}function Nf(r){r.return!==null&&(Ai(r,1),m_(r,1,0))}function Pf(r){for(;r===Zu;)Zu=go[--yo],go[yo]=null,Jl=go[--yo],go[yo]=null;for(;r===cs;)cs=fr[--mr],fr[mr]=null,ai=fr[--mr],fr[mr]=null,si=fr[--mr],fr[mr]=null}function p_(r,s){fr[mr++]=si,fr[mr++]=ai,fr[mr++]=cs,si=s.id,ai=s.overflow,cs=r}var mn=null,vt=null,Ze=!1,us=null,pr=!1,Lf=Error(i(519));function ds(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Zl(hr(s,r)),Lf}function g_(r){var s=r.stateNode,o=r.type,u=r.memoizedProps;switch(s[Ut]=r,s[sn]=u,o){case"dialog":Qe("cancel",s),Qe("close",s);break;case"iframe":case"object":case"embed":Qe("load",s);break;case"video":case"audio":for(o=0;o<xc.length;o++)Qe(xc[o],s);break;case"source":Qe("error",s);break;case"img":case"image":case"link":Qe("error",s),Qe("load",s);break;case"details":Qe("toggle",s);break;case"input":Qe("invalid",s),Ou(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Qe("invalid",s);break;case"textarea":Qe("invalid",s),ns(s,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||u.suppressHydrationWarning===!0||Mv(s.textContent,o)?(u.popover!=null&&(Qe("beforetoggle",s),Qe("toggle",s)),u.onScroll!=null&&Qe("scroll",s),u.onScrollEnd!=null&&Qe("scrollend",s),u.onClick!=null&&(s.onclick=Rr),s=!0):s=!1,s||ds(r,!0)}function y_(r){for(mn=r.return;mn;)switch(mn.tag){case 5:case 31:case 13:pr=!1;return;case 27:case 3:pr=!0;return;default:mn=mn.return}}function _o(r){if(r!==mn)return!1;if(!Ze)return y_(r),Ze=!0,!1;var s=r.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||tp(r.type,r.memoizedProps)),o=!o),o&&vt&&ds(r),y_(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));vt=Fv(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));vt=Fv(r)}else s===27?(s=vt,Ts(r.type)?(r=ap,ap=null,vt=r):vt=s):vt=mn?yr(r.stateNode.nextSibling):null;return!0}function ba(){vt=mn=null,Ze=!1}function Vf(){var r=us;return r!==null&&(Ln===null?Ln=r:Ln.push.apply(Ln,r),us=null),r}function Zl(r){us===null?us=[r]:us.push(r)}var zf=B(null),xa=null,Ci=null;function hs(r,s,o){G(zf,s._currentValue),s._currentValue=o}function Ri(r){r._currentValue=zf.current,U(zf)}function Uf(r,s,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),r===o)break;r=r.return}}function Bf(r,s,o,u){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var y=p.dependencies;if(y!==null){var E=p.child;y=y.firstContext;e:for(;y!==null;){var j=y;y=p;for(var $=0;$<s.length;$++)if(j.context===s[$]){y.lanes|=o,j=y.alternate,j!==null&&(j.lanes|=o),Uf(y.return,o,r),u||(E=null);break e}y=j.next}}else if(p.tag===18){if(E=p.return,E===null)throw Error(i(341));E.lanes|=o,y=E.alternate,y!==null&&(y.lanes|=o),Uf(E,o,r),E=null}else E=p.child;if(E!==null)E.return=p;else for(E=p;E!==null;){if(E===r){E=null;break}if(p=E.sibling,p!==null){p.return=E.return,E=p;break}E=E.return}p=E}}function vo(r,s,o,u){r=null;for(var p=s,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var E=p.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var j=p.type;Wn(p.pendingProps.value,E.value)||(r!==null?r.push(j):r=[j])}}else if(p===be.current){if(E=p.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(Ac):r=[Ac])}p=p.return}r!==null&&Bf(s,r,o,u),s.flags|=262144}function ed(r){for(r=r.firstContext;r!==null;){if(!Wn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ea(r){xa=r,Ci=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function pn(r){return __(xa,r)}function td(r,s){return xa===null&&Ea(r),__(r,s)}function __(r,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Ci===null){if(r===null)throw Error(i(308));Ci=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else Ci=Ci.next=s;return o}var zT=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){s.aborted=!0,r.forEach(function(o){return o()})}},UT=t.unstable_scheduleCallback,BT=t.unstable_NormalPriority,qt={$$typeof:z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ff(){return{controller:new zT,data:new Map,refCount:0}}function ec(r){r.refCount--,r.refCount===0&&UT(BT,function(){r.controller.abort()})}var tc=null,qf=0,bo=0,xo=null;function FT(r,s){if(tc===null){var o=tc=[];qf=0,bo=$m(),xo={status:"pending",value:void 0,then:function(u){o.push(u)}}}return qf++,s.then(v_,v_),s}function v_(){if(--qf===0&&tc!==null){xo!==null&&(xo.status="fulfilled");var r=tc;tc=null,bo=0,xo=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function qT(r,s){var o=[],u={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return r.then(function(){u.status="fulfilled",u.value=s;for(var p=0;p<o.length;p++)(0,o[p])(s)},function(p){for(u.status="rejected",u.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),u}var b_=V.S;V.S=function(r,s){rv=Rt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&FT(r,s),b_!==null&&b_(r,s)};var wa=B(null);function Hf(){var r=wa.current;return r!==null?r:pt.pooledCache}function nd(r,s){s===null?G(wa,wa.current):G(wa,s.pool)}function x_(){var r=Hf();return r===null?null:{parent:qt._currentValue,pool:r}}var Eo=Error(i(460)),Gf=Error(i(474)),rd=Error(i(542)),id={then:function(){}};function E_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function w_(r,s,o){switch(o=r[o],o===void 0?r.push(s):o!==s&&(s.then(Rr,Rr),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,T_(r),r;default:if(typeof s.status=="string")s.then(Rr,Rr);else{if(r=pt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(u){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=u}},function(u){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,T_(r),r}throw Ta=s,Eo}}function Sa(r){try{var s=r._init;return s(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ta=o,Eo):o}}var Ta=null;function S_(){if(Ta===null)throw Error(i(459));var r=Ta;return Ta=null,r}function T_(r){if(r===Eo||r===rd)throw Error(i(483))}var wo=null,nc=0;function sd(r){var s=nc;return nc+=1,wo===null&&(wo=[]),w_(wo,r,s)}function rc(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function ad(r,s){throw s.$$typeof===b?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function A_(r){function s(Z,X){if(r){var ie=Z.deletions;ie===null?(Z.deletions=[X],Z.flags|=16):ie.push(X)}}function o(Z,X){if(!r)return null;for(;X!==null;)s(Z,X),X=X.sibling;return null}function u(Z){for(var X=new Map;Z!==null;)Z.key!==null?X.set(Z.key,Z):X.set(Z.index,Z),Z=Z.sibling;return X}function p(Z,X){return Z=Ti(Z,X),Z.index=0,Z.sibling=null,Z}function y(Z,X,ie){return Z.index=ie,r?(ie=Z.alternate,ie!==null?(ie=ie.index,ie<X?(Z.flags|=67108866,X):ie):(Z.flags|=67108866,X)):(Z.flags|=1048576,X)}function E(Z){return r&&Z.alternate===null&&(Z.flags|=67108866),Z}function j(Z,X,ie,ge){return X===null||X.tag!==6?(X=Mf(ie,Z.mode,ge),X.return=Z,X):(X=p(X,ie),X.return=Z,X)}function $(Z,X,ie,ge){var je=ie.type;return je===S?pe(Z,X,ie.props.children,ge,ie.key):X!==null&&(X.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===D&&Sa(je)===X.type)?(X=p(X,ie.props),rc(X,ie),X.return=Z,X):(X=Ju(ie.type,ie.key,ie.props,null,Z.mode,ge),rc(X,ie),X.return=Z,X)}function se(Z,X,ie,ge){return X===null||X.tag!==4||X.stateNode.containerInfo!==ie.containerInfo||X.stateNode.implementation!==ie.implementation?(X=kf(ie,Z.mode,ge),X.return=Z,X):(X=p(X,ie.children||[]),X.return=Z,X)}function pe(Z,X,ie,ge,je){return X===null||X.tag!==7?(X=va(ie,Z.mode,ge,je),X.return=Z,X):(X=p(X,ie),X.return=Z,X)}function ye(Z,X,ie){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return X=Mf(""+X,Z.mode,ie),X.return=Z,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case w:return ie=Ju(X.type,X.key,X.props,null,Z.mode,ie),rc(ie,X),ie.return=Z,ie;case A:return X=kf(X,Z.mode,ie),X.return=Z,X;case D:return X=Sa(X),ye(Z,X,ie)}if(q(X)||k(X))return X=va(X,Z.mode,ie,null),X.return=Z,X;if(typeof X.then=="function")return ye(Z,sd(X),ie);if(X.$$typeof===z)return ye(Z,td(Z,X),ie);ad(Z,X)}return null}function le(Z,X,ie,ge){var je=X!==null?X.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return je!==null?null:j(Z,X,""+ie,ge);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case w:return ie.key===je?$(Z,X,ie,ge):null;case A:return ie.key===je?se(Z,X,ie,ge):null;case D:return ie=Sa(ie),le(Z,X,ie,ge)}if(q(ie)||k(ie))return je!==null?null:pe(Z,X,ie,ge,null);if(typeof ie.then=="function")return le(Z,X,sd(ie),ge);if(ie.$$typeof===z)return le(Z,X,td(Z,ie),ge);ad(Z,ie)}return null}function fe(Z,X,ie,ge,je){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return Z=Z.get(ie)||null,j(X,Z,""+ge,je);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case w:return Z=Z.get(ge.key===null?ie:ge.key)||null,$(X,Z,ge,je);case A:return Z=Z.get(ge.key===null?ie:ge.key)||null,se(X,Z,ge,je);case D:return ge=Sa(ge),fe(Z,X,ie,ge,je)}if(q(ge)||k(ge))return Z=Z.get(ie)||null,pe(X,Z,ge,je,null);if(typeof ge.then=="function")return fe(Z,X,ie,sd(ge),je);if(ge.$$typeof===z)return fe(Z,X,ie,td(X,ge),je);ad(X,ge)}return null}function De(Z,X,ie,ge){for(var je=null,tt=null,Ie=X,He=X=0,Ke=null;Ie!==null&&He<ie.length;He++){Ie.index>He?(Ke=Ie,Ie=null):Ke=Ie.sibling;var nt=le(Z,Ie,ie[He],ge);if(nt===null){Ie===null&&(Ie=Ke);break}r&&Ie&&nt.alternate===null&&s(Z,Ie),X=y(nt,X,He),tt===null?je=nt:tt.sibling=nt,tt=nt,Ie=Ke}if(He===ie.length)return o(Z,Ie),Ze&&Ai(Z,He),je;if(Ie===null){for(;He<ie.length;He++)Ie=ye(Z,ie[He],ge),Ie!==null&&(X=y(Ie,X,He),tt===null?je=Ie:tt.sibling=Ie,tt=Ie);return Ze&&Ai(Z,He),je}for(Ie=u(Ie);He<ie.length;He++)Ke=fe(Ie,Z,He,ie[He],ge),Ke!==null&&(r&&Ke.alternate!==null&&Ie.delete(Ke.key===null?He:Ke.key),X=y(Ke,X,He),tt===null?je=Ke:tt.sibling=Ke,tt=Ke);return r&&Ie.forEach(function(Is){return s(Z,Is)}),Ze&&Ai(Z,He),je}function ke(Z,X,ie,ge){if(ie==null)throw Error(i(151));for(var je=null,tt=null,Ie=X,He=X=0,Ke=null,nt=ie.next();Ie!==null&&!nt.done;He++,nt=ie.next()){Ie.index>He?(Ke=Ie,Ie=null):Ke=Ie.sibling;var Is=le(Z,Ie,nt.value,ge);if(Is===null){Ie===null&&(Ie=Ke);break}r&&Ie&&Is.alternate===null&&s(Z,Ie),X=y(Is,X,He),tt===null?je=Is:tt.sibling=Is,tt=Is,Ie=Ke}if(nt.done)return o(Z,Ie),Ze&&Ai(Z,He),je;if(Ie===null){for(;!nt.done;He++,nt=ie.next())nt=ye(Z,nt.value,ge),nt!==null&&(X=y(nt,X,He),tt===null?je=nt:tt.sibling=nt,tt=nt);return Ze&&Ai(Z,He),je}for(Ie=u(Ie);!nt.done;He++,nt=ie.next())nt=fe(Ie,Z,He,nt.value,ge),nt!==null&&(r&&nt.alternate!==null&&Ie.delete(nt.key===null?He:nt.key),X=y(nt,X,He),tt===null?je=nt:tt.sibling=nt,tt=nt);return r&&Ie.forEach(function(eC){return s(Z,eC)}),Ze&&Ai(Z,He),je}function ft(Z,X,ie,ge){if(typeof ie=="object"&&ie!==null&&ie.type===S&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case w:e:{for(var je=ie.key;X!==null;){if(X.key===je){if(je=ie.type,je===S){if(X.tag===7){o(Z,X.sibling),ge=p(X,ie.props.children),ge.return=Z,Z=ge;break e}}else if(X.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===D&&Sa(je)===X.type){o(Z,X.sibling),ge=p(X,ie.props),rc(ge,ie),ge.return=Z,Z=ge;break e}o(Z,X);break}else s(Z,X);X=X.sibling}ie.type===S?(ge=va(ie.props.children,Z.mode,ge,ie.key),ge.return=Z,Z=ge):(ge=Ju(ie.type,ie.key,ie.props,null,Z.mode,ge),rc(ge,ie),ge.return=Z,Z=ge)}return E(Z);case A:e:{for(je=ie.key;X!==null;){if(X.key===je)if(X.tag===4&&X.stateNode.containerInfo===ie.containerInfo&&X.stateNode.implementation===ie.implementation){o(Z,X.sibling),ge=p(X,ie.children||[]),ge.return=Z,Z=ge;break e}else{o(Z,X);break}else s(Z,X);X=X.sibling}ge=kf(ie,Z.mode,ge),ge.return=Z,Z=ge}return E(Z);case D:return ie=Sa(ie),ft(Z,X,ie,ge)}if(q(ie))return De(Z,X,ie,ge);if(k(ie)){if(je=k(ie),typeof je!="function")throw Error(i(150));return ie=je.call(ie),ke(Z,X,ie,ge)}if(typeof ie.then=="function")return ft(Z,X,sd(ie),ge);if(ie.$$typeof===z)return ft(Z,X,td(Z,ie),ge);ad(Z,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,X!==null&&X.tag===6?(o(Z,X.sibling),ge=p(X,ie),ge.return=Z,Z=ge):(o(Z,X),ge=Mf(ie,Z.mode,ge),ge.return=Z,Z=ge),E(Z)):o(Z,X)}return function(Z,X,ie,ge){try{nc=0;var je=ft(Z,X,ie,ge);return wo=null,je}catch(Ie){if(Ie===Eo||Ie===rd)throw Ie;var tt=Kn(29,Ie,null,Z.mode);return tt.lanes=ge,tt.return=Z,tt}}}var Aa=A_(!0),C_=A_(!1),fs=!1;function $f(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qf(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ms(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ps(r,s,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(st&2)!==0){var p=u.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),u.pending=s,s=Xu(r),u_(r,null,o),s}return Yu(r,u,s,o),Xu(r)}function ic(r,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var u=s.lanes;u&=r.pendingLanes,o|=u,s.lanes=o,jl(r,o)}}function Wf(r,s){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?p=y=E:y=y.next=E,o=o.next}while(o!==null);y===null?p=y=s:y=y.next=s}else p=y=s;o={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=s:r.next=s,o.lastBaseUpdate=s}var Kf=!1;function sc(){if(Kf){var r=xo;if(r!==null)throw r}}function ac(r,s,o,u){Kf=!1;var p=r.updateQueue;fs=!1;var y=p.firstBaseUpdate,E=p.lastBaseUpdate,j=p.shared.pending;if(j!==null){p.shared.pending=null;var $=j,se=$.next;$.next=null,E===null?y=se:E.next=se,E=$;var pe=r.alternate;pe!==null&&(pe=pe.updateQueue,j=pe.lastBaseUpdate,j!==E&&(j===null?pe.firstBaseUpdate=se:j.next=se,pe.lastBaseUpdate=$))}if(y!==null){var ye=p.baseState;E=0,pe=se=$=null,j=y;do{var le=j.lane&-536870913,fe=le!==j.lane;if(fe?(We&le)===le:(u&le)===le){le!==0&&le===bo&&(Kf=!0),pe!==null&&(pe=pe.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var De=r,ke=j;le=s;var ft=o;switch(ke.tag){case 1:if(De=ke.payload,typeof De=="function"){ye=De.call(ft,ye,le);break e}ye=De;break e;case 3:De.flags=De.flags&-65537|128;case 0:if(De=ke.payload,le=typeof De=="function"?De.call(ft,ye,le):De,le==null)break e;ye=v({},ye,le);break e;case 2:fs=!0}}le=j.callback,le!==null&&(r.flags|=64,fe&&(r.flags|=8192),fe=p.callbacks,fe===null?p.callbacks=[le]:fe.push(le))}else fe={lane:le,tag:j.tag,payload:j.payload,callback:j.callback,next:null},pe===null?(se=pe=fe,$=ye):pe=pe.next=fe,E|=le;if(j=j.next,j===null){if(j=p.shared.pending,j===null)break;fe=j,j=fe.next,fe.next=null,p.lastBaseUpdate=fe,p.shared.pending=null}}while(!0);pe===null&&($=ye),p.baseState=$,p.firstBaseUpdate=se,p.lastBaseUpdate=pe,y===null&&(p.shared.lanes=0),bs|=E,r.lanes=E,r.memoizedState=ye}}function R_(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function D_(r,s){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)R_(o[r],s)}var So=B(null),od=B(0);function I_(r,s){r=Li,G(od,r),G(So,s),Li=r|s.baseLanes}function Yf(){G(od,Li),G(So,So.current)}function Xf(){Li=od.current,U(So),U(od)}var Yn=B(null),gr=null;function gs(r){var s=r.alternate;G(kt,kt.current&1),G(Yn,r),gr===null&&(s===null||So.current!==null||s.memoizedState!==null)&&(gr=r)}function Jf(r){G(kt,kt.current),G(Yn,r),gr===null&&(gr=r)}function j_(r){r.tag===22?(G(kt,kt.current),G(Yn,r),gr===null&&(gr=r)):ys()}function ys(){G(kt,kt.current),G(Yn,Yn.current)}function Xn(r){U(Yn),gr===r&&(gr=null),U(kt)}var kt=B(0);function ld(r){for(var s=r;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ip(o)||sp(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Di=0,qe=null,dt=null,Ht=null,cd=!1,To=!1,Ca=!1,ud=0,oc=0,Ao=null,HT=0;function Dt(){throw Error(i(321))}function Zf(r,s){if(s===null)return!1;for(var o=0;o<s.length&&o<r.length;o++)if(!Wn(r[o],s[o]))return!1;return!0}function em(r,s,o,u,p,y){return Di=y,qe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,V.H=r===null||r.memoizedState===null?m0:pm,Ca=!1,y=o(u,p),Ca=!1,To&&(y=M_(s,o,u,p)),O_(r),y}function O_(r){V.H=uc;var s=dt!==null&&dt.next!==null;if(Di=0,Ht=dt=qe=null,cd=!1,oc=0,Ao=null,s)throw Error(i(300));r===null||Gt||(r=r.dependencies,r!==null&&ed(r)&&(Gt=!0))}function M_(r,s,o,u){qe=r;var p=0;do{if(To&&(Ao=null),oc=0,To=!1,25<=p)throw Error(i(301));if(p+=1,Ht=dt=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}V.H=p0,y=s(o,u)}while(To);return y}function GT(){var r=V.H,s=r.useState()[0];return s=typeof s.then=="function"?lc(s):s,r=r.useState()[0],(dt!==null?dt.memoizedState:null)!==r&&(qe.flags|=1024),s}function tm(){var r=ud!==0;return ud=0,r}function nm(r,s,o){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~o}function rm(r){if(cd){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}cd=!1}Di=0,Ht=dt=qe=null,To=!1,oc=ud=0,Ao=null}function Dn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?qe.memoizedState=Ht=r:Ht=Ht.next=r,Ht}function Nt(){if(dt===null){var r=qe.alternate;r=r!==null?r.memoizedState:null}else r=dt.next;var s=Ht===null?qe.memoizedState:Ht.next;if(s!==null)Ht=s,dt=r;else{if(r===null)throw qe.alternate===null?Error(i(467)):Error(i(310));dt=r,r={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},Ht===null?qe.memoizedState=Ht=r:Ht=Ht.next=r}return Ht}function dd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function lc(r){var s=oc;return oc+=1,Ao===null&&(Ao=[]),r=w_(Ao,r,s),s=qe,(Ht===null?s.memoizedState:Ht.next)===null&&(s=s.alternate,V.H=s===null||s.memoizedState===null?m0:pm),r}function hd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return lc(r);if(r.$$typeof===z)return pn(r)}throw Error(i(438,String(r)))}function im(r){var s=null,o=qe.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var u=qe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=dd(),qe.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(r),u=0;u<r;u++)o[u]=N;return s.index++,o}function Ii(r,s){return typeof s=="function"?s(r):s}function fd(r){var s=Nt();return sm(s,dt,r)}function sm(r,s,o){var u=r.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=o;var p=r.baseQueue,y=u.pending;if(y!==null){if(p!==null){var E=p.next;p.next=y.next,y.next=E}s.baseQueue=p=y,u.pending=null}if(y=r.baseState,p===null)r.memoizedState=y;else{s=p.next;var j=E=null,$=null,se=s,pe=!1;do{var ye=se.lane&-536870913;if(ye!==se.lane?(We&ye)===ye:(Di&ye)===ye){var le=se.revertLane;if(le===0)$!==null&&($=$.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),ye===bo&&(pe=!0);else if((Di&le)===le){se=se.next,le===bo&&(pe=!0);continue}else ye={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},$===null?(j=$=ye,E=y):$=$.next=ye,qe.lanes|=le,bs|=le;ye=se.action,Ca&&o(y,ye),y=se.hasEagerState?se.eagerState:o(y,ye)}else le={lane:ye,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},$===null?(j=$=le,E=y):$=$.next=le,qe.lanes|=ye,bs|=ye;se=se.next}while(se!==null&&se!==s);if($===null?E=y:$.next=j,!Wn(y,r.memoizedState)&&(Gt=!0,pe&&(o=xo,o!==null)))throw o;r.memoizedState=y,r.baseState=E,r.baseQueue=$,u.lastRenderedState=y}return p===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function am(r){var s=Nt(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var u=o.dispatch,p=o.pending,y=s.memoizedState;if(p!==null){o.pending=null;var E=p=p.next;do y=r(y,E.action),E=E.next;while(E!==p);Wn(y,s.memoizedState)||(Gt=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,u]}function k_(r,s,o){var u=qe,p=Nt(),y=Ze;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var E=!Wn((dt||p).memoizedState,o);if(E&&(p.memoizedState=o,Gt=!0),p=p.queue,cm(L_.bind(null,u,p,r),[r]),p.getSnapshot!==s||E||Ht!==null&&Ht.memoizedState.tag&1){if(u.flags|=2048,Co(9,{destroy:void 0},P_.bind(null,u,p,o,s),null),pt===null)throw Error(i(349));y||(Di&127)!==0||N_(u,s,o)}return o}function N_(r,s,o){r.flags|=16384,r={getSnapshot:s,value:o},s=qe.updateQueue,s===null?(s=dd(),qe.updateQueue=s,s.stores=[r]):(o=s.stores,o===null?s.stores=[r]:o.push(r))}function P_(r,s,o,u){s.value=o,s.getSnapshot=u,V_(s)&&z_(r)}function L_(r,s,o){return o(function(){V_(s)&&z_(r)})}function V_(r){var s=r.getSnapshot;r=r.value;try{var o=s();return!Wn(r,o)}catch{return!0}}function z_(r){var s=_a(r,2);s!==null&&Vn(s,r,2)}function om(r){var s=Dn();if(typeof r=="function"){var o=r;if(r=o(),Ca){ar(!0);try{o()}finally{ar(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ii,lastRenderedState:r},s}function U_(r,s,o,u){return r.baseState=o,sm(r,dt,typeof u=="function"?u:Ii)}function $T(r,s,o,u,p){if(gd(r))throw Error(i(485));if(r=s.action,r!==null){var y={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){y.listeners.push(E)}};V.T!==null?o(!0):y.isTransition=!1,u(y),o=s.pending,o===null?(y.next=s.pending=y,B_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function B_(r,s){var o=s.action,u=s.payload,p=r.state;if(s.isTransition){var y=V.T,E={};V.T=E;try{var j=o(p,u),$=V.S;$!==null&&$(E,j),F_(r,s,j)}catch(se){lm(r,s,se)}finally{y!==null&&E.types!==null&&(y.types=E.types),V.T=y}}else try{y=o(p,u),F_(r,s,y)}catch(se){lm(r,s,se)}}function F_(r,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){q_(r,s,u)},function(u){return lm(r,s,u)}):q_(r,s,o)}function q_(r,s,o){s.status="fulfilled",s.value=o,H_(s),r.state=o,s=r.pending,s!==null&&(o=s.next,o===s?r.pending=null:(o=o.next,s.next=o,B_(r,o)))}function lm(r,s,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=o,H_(s),s=s.next;while(s!==u)}r.action=null}function H_(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function G_(r,s){return s}function $_(r,s){if(Ze){var o=pt.formState;if(o!==null){e:{var u=qe;if(Ze){if(vt){t:{for(var p=vt,y=pr;p.nodeType!==8;){if(!y){p=null;break t}if(p=yr(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){vt=yr(p.nextSibling),u=p.data==="F!";break e}}ds(u)}u=!1}u&&(s=o[0])}}return o=Dn(),o.memoizedState=o.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:G_,lastRenderedState:s},o.queue=u,o=d0.bind(null,qe,u),u.dispatch=o,u=om(!1),y=mm.bind(null,qe,!1,u.queue),u=Dn(),p={state:s,dispatch:null,action:r,pending:null},u.queue=p,o=$T.bind(null,qe,p,y,o),p.dispatch=o,u.memoizedState=r,[s,o,!1]}function Q_(r){var s=Nt();return W_(s,dt,r)}function W_(r,s,o){if(s=sm(r,s,G_)[0],r=fd(Ii)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var u=lc(s)}catch(E){throw E===Eo?rd:E}else u=s;s=Nt();var p=s.queue,y=p.dispatch;return o!==s.memoizedState&&(qe.flags|=2048,Co(9,{destroy:void 0},QT.bind(null,p,o),null)),[u,y,r]}function QT(r,s){r.action=s}function K_(r){var s=Nt(),o=dt;if(o!==null)return W_(s,o,r);Nt(),s=s.memoizedState,o=Nt();var u=o.queue.dispatch;return o.memoizedState=r,[s,u,!1]}function Co(r,s,o,u){return r={tag:r,create:o,deps:u,inst:s,next:null},s=qe.updateQueue,s===null&&(s=dd(),qe.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,s.lastEffect=r),r}function Y_(){return Nt().memoizedState}function md(r,s,o,u){var p=Dn();qe.flags|=r,p.memoizedState=Co(1|s,{destroy:void 0},o,u===void 0?null:u)}function pd(r,s,o,u){var p=Nt();u=u===void 0?null:u;var y=p.memoizedState.inst;dt!==null&&u!==null&&Zf(u,dt.memoizedState.deps)?p.memoizedState=Co(s,y,o,u):(qe.flags|=r,p.memoizedState=Co(1|s,y,o,u))}function X_(r,s){md(8390656,8,r,s)}function cm(r,s){pd(2048,8,r,s)}function WT(r){qe.flags|=4;var s=qe.updateQueue;if(s===null)s=dd(),qe.updateQueue=s,s.events=[r];else{var o=s.events;o===null?s.events=[r]:o.push(r)}}function J_(r){var s=Nt().memoizedState;return WT({ref:s,nextImpl:r}),function(){if((st&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function Z_(r,s){return pd(4,2,r,s)}function e0(r,s){return pd(4,4,r,s)}function t0(r,s){if(typeof s=="function"){r=r();var o=s(r);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function n0(r,s,o){o=o!=null?o.concat([r]):null,pd(4,4,t0.bind(null,s,r),o)}function um(){}function r0(r,s){var o=Nt();s=s===void 0?null:s;var u=o.memoizedState;return s!==null&&Zf(s,u[1])?u[0]:(o.memoizedState=[r,s],r)}function i0(r,s){var o=Nt();s=s===void 0?null:s;var u=o.memoizedState;if(s!==null&&Zf(s,u[1]))return u[0];if(u=r(),Ca){ar(!0);try{r()}finally{ar(!1)}}return o.memoizedState=[u,s],u}function dm(r,s,o){return o===void 0||(Di&1073741824)!==0&&(We&261930)===0?r.memoizedState=s:(r.memoizedState=o,r=sv(),qe.lanes|=r,bs|=r,o)}function s0(r,s,o,u){return Wn(o,s)?o:So.current!==null?(r=dm(r,o,u),Wn(r,s)||(Gt=!0),r):(Di&42)===0||(Di&1073741824)!==0&&(We&261930)===0?(Gt=!0,r.memoizedState=o):(r=sv(),qe.lanes|=r,bs|=r,s)}function a0(r,s,o,u,p){var y=Q.p;Q.p=y!==0&&8>y?y:8;var E=V.T,j={};V.T=j,mm(r,!1,s,o);try{var $=p(),se=V.S;if(se!==null&&se(j,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var pe=qT($,u);cc(r,s,pe,er(r))}else cc(r,s,u,er(r))}catch(ye){cc(r,s,{then:function(){},status:"rejected",reason:ye},er())}finally{Q.p=y,E!==null&&j.types!==null&&(E.types=j.types),V.T=E}}function KT(){}function hm(r,s,o,u){if(r.tag!==5)throw Error(i(476));var p=o0(r).queue;a0(r,p,s,W,o===null?KT:function(){return l0(r),o(u)})}function o0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ii,lastRenderedState:W},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ii,lastRenderedState:o},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function l0(r){var s=o0(r);s.next===null&&(s=r.alternate.memoizedState),cc(r,s.next.queue,{},er())}function fm(){return pn(Ac)}function c0(){return Nt().memoizedState}function u0(){return Nt().memoizedState}function YT(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var o=er();r=ms(o);var u=ps(s,r,o);u!==null&&(Vn(u,s,o),ic(u,s,o)),s={cache:Ff()},r.payload=s;return}s=s.return}}function XT(r,s,o){var u=er();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},gd(r)?h0(s,o):(o=jf(r,s,o,u),o!==null&&(Vn(o,r,u),f0(o,s,u)))}function d0(r,s,o){var u=er();cc(r,s,o,u)}function cc(r,s,o,u){var p={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(gd(r))h0(s,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var E=s.lastRenderedState,j=y(E,o);if(p.hasEagerState=!0,p.eagerState=j,Wn(j,E))return Yu(r,s,p,0),pt===null&&Ku(),!1}catch{}if(o=jf(r,s,p,u),o!==null)return Vn(o,r,u),f0(o,s,u),!0}return!1}function mm(r,s,o,u){if(u={lane:2,revertLane:$m(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},gd(r)){if(s)throw Error(i(479))}else s=jf(r,o,u,2),s!==null&&Vn(s,r,2)}function gd(r){var s=r.alternate;return r===qe||s!==null&&s===qe}function h0(r,s){To=cd=!0;var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}function f0(r,s,o){if((o&4194048)!==0){var u=s.lanes;u&=r.pendingLanes,o|=u,s.lanes=o,jl(r,o)}}var uc={readContext:pn,use:hd,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useLayoutEffect:Dt,useInsertionEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useSyncExternalStore:Dt,useId:Dt,useHostTransitionStatus:Dt,useFormState:Dt,useActionState:Dt,useOptimistic:Dt,useMemoCache:Dt,useCacheRefresh:Dt};uc.useEffectEvent=Dt;var m0={readContext:pn,use:hd,useCallback:function(r,s){return Dn().memoizedState=[r,s===void 0?null:s],r},useContext:pn,useEffect:X_,useImperativeHandle:function(r,s,o){o=o!=null?o.concat([r]):null,md(4194308,4,t0.bind(null,s,r),o)},useLayoutEffect:function(r,s){return md(4194308,4,r,s)},useInsertionEffect:function(r,s){md(4,2,r,s)},useMemo:function(r,s){var o=Dn();s=s===void 0?null:s;var u=r();if(Ca){ar(!0);try{r()}finally{ar(!1)}}return o.memoizedState=[u,s],u},useReducer:function(r,s,o){var u=Dn();if(o!==void 0){var p=o(s);if(Ca){ar(!0);try{o(s)}finally{ar(!1)}}}else p=s;return u.memoizedState=u.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},u.queue=r,r=r.dispatch=XT.bind(null,qe,r),[u.memoizedState,r]},useRef:function(r){var s=Dn();return r={current:r},s.memoizedState=r},useState:function(r){r=om(r);var s=r.queue,o=d0.bind(null,qe,s);return s.dispatch=o,[r.memoizedState,o]},useDebugValue:um,useDeferredValue:function(r,s){var o=Dn();return dm(o,r,s)},useTransition:function(){var r=om(!1);return r=a0.bind(null,qe,r.queue,!0,!1),Dn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,o){var u=qe,p=Dn();if(Ze){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),pt===null)throw Error(i(349));(We&127)!==0||N_(u,s,o)}p.memoizedState=o;var y={value:o,getSnapshot:s};return p.queue=y,X_(L_.bind(null,u,y,r),[r]),u.flags|=2048,Co(9,{destroy:void 0},P_.bind(null,u,y,o,s),null),o},useId:function(){var r=Dn(),s=pt.identifierPrefix;if(Ze){var o=ai,u=si;o=(u&~(1<<32-Ot(u)-1)).toString(32)+o,s="_"+s+"R_"+o,o=ud++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=HT++,s="_"+s+"r_"+o.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:fm,useFormState:$_,useActionState:$_,useOptimistic:function(r){var s=Dn();s.memoizedState=s.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=mm.bind(null,qe,!0,o),o.dispatch=s,[r,s]},useMemoCache:im,useCacheRefresh:function(){return Dn().memoizedState=YT.bind(null,qe)},useEffectEvent:function(r){var s=Dn(),o={impl:r};return s.memoizedState=o,function(){if((st&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},pm={readContext:pn,use:hd,useCallback:r0,useContext:pn,useEffect:cm,useImperativeHandle:n0,useInsertionEffect:Z_,useLayoutEffect:e0,useMemo:i0,useReducer:fd,useRef:Y_,useState:function(){return fd(Ii)},useDebugValue:um,useDeferredValue:function(r,s){var o=Nt();return s0(o,dt.memoizedState,r,s)},useTransition:function(){var r=fd(Ii)[0],s=Nt().memoizedState;return[typeof r=="boolean"?r:lc(r),s]},useSyncExternalStore:k_,useId:c0,useHostTransitionStatus:fm,useFormState:Q_,useActionState:Q_,useOptimistic:function(r,s){var o=Nt();return U_(o,dt,r,s)},useMemoCache:im,useCacheRefresh:u0};pm.useEffectEvent=J_;var p0={readContext:pn,use:hd,useCallback:r0,useContext:pn,useEffect:cm,useImperativeHandle:n0,useInsertionEffect:Z_,useLayoutEffect:e0,useMemo:i0,useReducer:am,useRef:Y_,useState:function(){return am(Ii)},useDebugValue:um,useDeferredValue:function(r,s){var o=Nt();return dt===null?dm(o,r,s):s0(o,dt.memoizedState,r,s)},useTransition:function(){var r=am(Ii)[0],s=Nt().memoizedState;return[typeof r=="boolean"?r:lc(r),s]},useSyncExternalStore:k_,useId:c0,useHostTransitionStatus:fm,useFormState:K_,useActionState:K_,useOptimistic:function(r,s){var o=Nt();return dt!==null?U_(o,dt,r,s):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:im,useCacheRefresh:u0};p0.useEffectEvent=J_;function gm(r,s,o,u){s=r.memoizedState,o=o(u,s),o=o==null?s:v({},s,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var ym={enqueueSetState:function(r,s,o){r=r._reactInternals;var u=er(),p=ms(u);p.payload=s,o!=null&&(p.callback=o),s=ps(r,p,u),s!==null&&(Vn(s,r,u),ic(s,r,u))},enqueueReplaceState:function(r,s,o){r=r._reactInternals;var u=er(),p=ms(u);p.tag=1,p.payload=s,o!=null&&(p.callback=o),s=ps(r,p,u),s!==null&&(Vn(s,r,u),ic(s,r,u))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var o=er(),u=ms(o);u.tag=2,s!=null&&(u.callback=s),s=ps(r,u,o),s!==null&&(Vn(s,r,o),ic(s,r,o))}};function g0(r,s,o,u,p,y,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,y,E):s.prototype&&s.prototype.isPureReactComponent?!Yl(o,u)||!Yl(p,y):!0}function y0(r,s,o,u){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,u),s.state!==r&&ym.enqueueReplaceState(s,s.state,null)}function Ra(r,s){var o=s;if("ref"in s){o={};for(var u in s)u!=="ref"&&(o[u]=s[u])}if(r=r.defaultProps){o===s&&(o=v({},o));for(var p in r)o[p]===void 0&&(o[p]=r[p])}return o}function _0(r){Wu(r)}function v0(r){console.error(r)}function b0(r){Wu(r)}function yd(r,s){try{var o=r.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function x0(r,s,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function _m(r,s,o){return o=ms(o),o.tag=3,o.payload={element:null},o.callback=function(){yd(r,s)},o}function E0(r){return r=ms(r),r.tag=3,r}function w0(r,s,o,u){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var y=u.value;r.payload=function(){return p(y)},r.callback=function(){x0(s,o,u)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(r.callback=function(){x0(s,o,u),typeof p!="function"&&(xs===null?xs=new Set([this]):xs.add(this));var j=u.stack;this.componentDidCatch(u.value,{componentStack:j!==null?j:""})})}function JT(r,s,o,u,p){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=o.alternate,s!==null&&vo(s,o,p,!0),o=Yn.current,o!==null){switch(o.tag){case 31:case 13:return gr===null?Dd():o.alternate===null&&It===0&&(It=3),o.flags&=-257,o.flags|=65536,o.lanes=p,u===id?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([u]):s.add(u),qm(r,u,p)),!1;case 22:return o.flags|=65536,u===id?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([u]):o.add(u)),qm(r,u,p)),!1}throw Error(i(435,o.tag))}return qm(r,u,p),Dd(),!1}if(Ze)return s=Yn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,u!==Lf&&(r=Error(i(422),{cause:u}),Zl(hr(r,o)))):(u!==Lf&&(s=Error(i(423),{cause:u}),Zl(hr(s,o))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,u=hr(u,o),p=_m(r.stateNode,u,p),Wf(r,p),It!==4&&(It=2)),!1;var y=Error(i(520),{cause:u});if(y=hr(y,o),_c===null?_c=[y]:_c.push(y),It!==4&&(It=2),s===null)return!0;u=hr(u,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,r=p&-p,o.lanes|=r,r=_m(o.stateNode,u,r),Wf(o,r),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(xs===null||!xs.has(y))))return o.flags|=65536,p&=-p,o.lanes|=p,p=E0(p),w0(p,r,o,u),Wf(o,p),!1}o=o.return}while(o!==null);return!1}var vm=Error(i(461)),Gt=!1;function gn(r,s,o,u){s.child=r===null?C_(s,null,o,u):Aa(s,r.child,o,u)}function S0(r,s,o,u,p){o=o.render;var y=s.ref;if("ref"in u){var E={};for(var j in u)j!=="ref"&&(E[j]=u[j])}else E=u;return Ea(s),u=em(r,s,o,E,y,p),j=tm(),r!==null&&!Gt?(nm(r,s,p),ji(r,s,p)):(Ze&&j&&Nf(s),s.flags|=1,gn(r,s,u,p),s.child)}function T0(r,s,o,u,p){if(r===null){var y=o.type;return typeof y=="function"&&!Of(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,A0(r,s,y,u,p)):(r=Ju(o.type,null,u,s,s.mode,p),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,!Cm(r,p)){var E=y.memoizedProps;if(o=o.compare,o=o!==null?o:Yl,o(E,u)&&r.ref===s.ref)return ji(r,s,p)}return s.flags|=1,r=Ti(y,u),r.ref=s.ref,r.return=s,s.child=r}function A0(r,s,o,u,p){if(r!==null){var y=r.memoizedProps;if(Yl(y,u)&&r.ref===s.ref)if(Gt=!1,s.pendingProps=u=y,Cm(r,p))(r.flags&131072)!==0&&(Gt=!0);else return s.lanes=r.lanes,ji(r,s,p)}return bm(r,s,o,u,p)}function C0(r,s,o,u){var p=u.children,y=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(u=s.child=r.child,p=0;u!==null;)p=p|u.lanes|u.childLanes,u=u.sibling;u=p&~y}else u=0,s.child=null;return R0(r,s,y,o,u)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&nd(s,y!==null?y.cachePool:null),y!==null?I_(s,y):Yf(),j_(s);else return u=s.lanes=536870912,R0(r,s,y!==null?y.baseLanes|o:o,o,u)}else y!==null?(nd(s,y.cachePool),I_(s,y),ys(),s.memoizedState=null):(r!==null&&nd(s,null),Yf(),ys());return gn(r,s,p,o),s.child}function dc(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function R0(r,s,o,u,p){var y=Hf();return y=y===null?null:{parent:qt._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},r!==null&&nd(s,null),Yf(),j_(s),r!==null&&vo(r,s,u,!0),s.childLanes=p,null}function _d(r,s){return s=bd({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function D0(r,s,o){return Aa(s,r.child,null,o),r=_d(s,s.pendingProps),r.flags|=2,Xn(s),s.memoizedState=null,r}function ZT(r,s,o){var u=s.pendingProps,p=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(Ze){if(u.mode==="hidden")return r=_d(s,u),s.lanes=536870912,dc(null,r);if(Jf(s),(r=vt)?(r=Bv(r,pr),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:cs!==null?{id:si,overflow:ai}:null,retryLane:536870912,hydrationErrors:null},o=h_(r),o.return=s,s.child=o,mn=s,vt=null)):r=null,r===null)throw ds(s);return s.lanes=536870912,null}return _d(s,u)}var y=r.memoizedState;if(y!==null){var E=y.dehydrated;if(Jf(s),p)if(s.flags&256)s.flags&=-257,s=D0(r,s,o);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(Gt||vo(r,s,o,!1),p=(o&r.childLanes)!==0,Gt||p){if(u=pt,u!==null&&(E=Ol(u,o),E!==0&&E!==y.retryLane))throw y.retryLane=E,_a(r,E),Vn(u,r,E),vm;Dd(),s=D0(r,s,o)}else r=y.treeContext,vt=yr(E.nextSibling),mn=s,Ze=!0,us=null,pr=!1,r!==null&&p_(s,r),s=_d(s,u),s.flags|=4096;return s}return r=Ti(r.child,{mode:u.mode,children:u.children}),r.ref=s.ref,s.child=r,r.return=s,r}function vd(r,s){var o=s.ref;if(o===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(r===null||r.ref!==o)&&(s.flags|=4194816)}}function bm(r,s,o,u,p){return Ea(s),o=em(r,s,o,u,void 0,p),u=tm(),r!==null&&!Gt?(nm(r,s,p),ji(r,s,p)):(Ze&&u&&Nf(s),s.flags|=1,gn(r,s,o,p),s.child)}function I0(r,s,o,u,p,y){return Ea(s),s.updateQueue=null,o=M_(s,u,o,p),O_(r),u=tm(),r!==null&&!Gt?(nm(r,s,y),ji(r,s,y)):(Ze&&u&&Nf(s),s.flags|=1,gn(r,s,o,y),s.child)}function j0(r,s,o,u,p){if(Ea(s),s.stateNode===null){var y=po,E=o.contextType;typeof E=="object"&&E!==null&&(y=pn(E)),y=new o(u,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=ym,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=u,y.state=s.memoizedState,y.refs={},$f(s),E=o.contextType,y.context=typeof E=="object"&&E!==null?pn(E):po,y.state=s.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(gm(s,o,E,u),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(E=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),E!==y.state&&ym.enqueueReplaceState(y,y.state,null),ac(s,u,y,p),sc(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(r===null){y=s.stateNode;var j=s.memoizedProps,$=Ra(o,j);y.props=$;var se=y.context,pe=o.contextType;E=po,typeof pe=="object"&&pe!==null&&(E=pn(pe));var ye=o.getDerivedStateFromProps;pe=typeof ye=="function"||typeof y.getSnapshotBeforeUpdate=="function",j=s.pendingProps!==j,pe||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(j||se!==E)&&y0(s,y,u,E),fs=!1;var le=s.memoizedState;y.state=le,ac(s,u,y,p),sc(),se=s.memoizedState,j||le!==se||fs?(typeof ye=="function"&&(gm(s,o,ye,u),se=s.memoizedState),($=fs||g0(s,o,$,u,le,se,E))?(pe||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=se),y.props=u,y.state=se,y.context=E,u=$):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{y=s.stateNode,Qf(r,s),E=s.memoizedProps,pe=Ra(o,E),y.props=pe,ye=s.pendingProps,le=y.context,se=o.contextType,$=po,typeof se=="object"&&se!==null&&($=pn(se)),j=o.getDerivedStateFromProps,(se=typeof j=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(E!==ye||le!==$)&&y0(s,y,u,$),fs=!1,le=s.memoizedState,y.state=le,ac(s,u,y,p),sc();var fe=s.memoizedState;E!==ye||le!==fe||fs||r!==null&&r.dependencies!==null&&ed(r.dependencies)?(typeof j=="function"&&(gm(s,o,j,u),fe=s.memoizedState),(pe=fs||g0(s,o,pe,u,le,fe,$)||r!==null&&r.dependencies!==null&&ed(r.dependencies))?(se||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,fe,$),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,fe,$)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&le===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&le===r.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=fe),y.props=u,y.state=fe,y.context=$,u=pe):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&le===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&le===r.memoizedState||(s.flags|=1024),u=!1)}return y=u,vd(r,s),u=(s.flags&128)!==0,y||u?(y=s.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,r!==null&&u?(s.child=Aa(s,r.child,null,p),s.child=Aa(s,null,o,p)):gn(r,s,o,p),s.memoizedState=y.state,r=s.child):r=ji(r,s,p),r}function O0(r,s,o,u){return ba(),s.flags|=256,gn(r,s,o,u),s.child}var xm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Em(r){return{baseLanes:r,cachePool:x_()}}function wm(r,s,o){return r=r!==null?r.childLanes&~o:0,s&&(r|=Zn),r}function M0(r,s,o){var u=s.pendingProps,p=!1,y=(s.flags&128)!==0,E;if((E=y)||(E=r!==null&&r.memoizedState===null?!1:(kt.current&2)!==0),E&&(p=!0,s.flags&=-129),E=(s.flags&32)!==0,s.flags&=-33,r===null){if(Ze){if(p?gs(s):ys(),(r=vt)?(r=Bv(r,pr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:cs!==null?{id:si,overflow:ai}:null,retryLane:536870912,hydrationErrors:null},o=h_(r),o.return=s,s.child=o,mn=s,vt=null)):r=null,r===null)throw ds(s);return sp(r)?s.lanes=32:s.lanes=536870912,null}var j=u.children;return u=u.fallback,p?(ys(),p=s.mode,j=bd({mode:"hidden",children:j},p),u=va(u,p,o,null),j.return=s,u.return=s,j.sibling=u,s.child=j,u=s.child,u.memoizedState=Em(o),u.childLanes=wm(r,E,o),s.memoizedState=xm,dc(null,u)):(gs(s),Sm(s,j))}var $=r.memoizedState;if($!==null&&(j=$.dehydrated,j!==null)){if(y)s.flags&256?(gs(s),s.flags&=-257,s=Tm(r,s,o)):s.memoizedState!==null?(ys(),s.child=r.child,s.flags|=128,s=null):(ys(),j=u.fallback,p=s.mode,u=bd({mode:"visible",children:u.children},p),j=va(j,p,o,null),j.flags|=2,u.return=s,j.return=s,u.sibling=j,s.child=u,Aa(s,r.child,null,o),u=s.child,u.memoizedState=Em(o),u.childLanes=wm(r,E,o),s.memoizedState=xm,s=dc(null,u));else if(gs(s),sp(j)){if(E=j.nextSibling&&j.nextSibling.dataset,E)var se=E.dgst;E=se,u=Error(i(419)),u.stack="",u.digest=E,Zl({value:u,source:null,stack:null}),s=Tm(r,s,o)}else if(Gt||vo(r,s,o,!1),E=(o&r.childLanes)!==0,Gt||E){if(E=pt,E!==null&&(u=Ol(E,o),u!==0&&u!==$.retryLane))throw $.retryLane=u,_a(r,u),Vn(E,r,u),vm;ip(j)||Dd(),s=Tm(r,s,o)}else ip(j)?(s.flags|=192,s.child=r.child,s=null):(r=$.treeContext,vt=yr(j.nextSibling),mn=s,Ze=!0,us=null,pr=!1,r!==null&&p_(s,r),s=Sm(s,u.children),s.flags|=4096);return s}return p?(ys(),j=u.fallback,p=s.mode,$=r.child,se=$.sibling,u=Ti($,{mode:"hidden",children:u.children}),u.subtreeFlags=$.subtreeFlags&65011712,se!==null?j=Ti(se,j):(j=va(j,p,o,null),j.flags|=2),j.return=s,u.return=s,u.sibling=j,s.child=u,dc(null,u),u=s.child,j=r.child.memoizedState,j===null?j=Em(o):(p=j.cachePool,p!==null?($=qt._currentValue,p=p.parent!==$?{parent:$,pool:$}:p):p=x_(),j={baseLanes:j.baseLanes|o,cachePool:p}),u.memoizedState=j,u.childLanes=wm(r,E,o),s.memoizedState=xm,dc(r.child,u)):(gs(s),o=r.child,r=o.sibling,o=Ti(o,{mode:"visible",children:u.children}),o.return=s,o.sibling=null,r!==null&&(E=s.deletions,E===null?(s.deletions=[r],s.flags|=16):E.push(r)),s.child=o,s.memoizedState=null,o)}function Sm(r,s){return s=bd({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function bd(r,s){return r=Kn(22,r,null,s),r.lanes=0,r}function Tm(r,s,o){return Aa(s,r.child,null,o),r=Sm(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function k0(r,s,o){r.lanes|=s;var u=r.alternate;u!==null&&(u.lanes|=s),Uf(r.return,s,o)}function Am(r,s,o,u,p,y){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:p,treeForkCount:y}:(E.isBackwards=s,E.rendering=null,E.renderingStartTime=0,E.last=u,E.tail=o,E.tailMode=p,E.treeForkCount=y)}function N0(r,s,o){var u=s.pendingProps,p=u.revealOrder,y=u.tail;u=u.children;var E=kt.current,j=(E&2)!==0;if(j?(E=E&1|2,s.flags|=128):E&=1,G(kt,E),gn(r,s,u,o),u=Ze?Jl:0,!j&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&k0(r,o,s);else if(r.tag===19)k0(r,o,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(p){case"forwards":for(o=s.child,p=null;o!==null;)r=o.alternate,r!==null&&ld(r)===null&&(p=o),o=o.sibling;o=p,o===null?(p=s.child,s.child=null):(p=o.sibling,o.sibling=null),Am(s,!1,p,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=s.child,s.child=null;p!==null;){if(r=p.alternate,r!==null&&ld(r)===null){s.child=p;break}r=p.sibling,p.sibling=o,o=p,p=r}Am(s,!0,o,null,y,u);break;case"together":Am(s,!1,null,null,void 0,u);break;default:s.memoizedState=null}return s.child}function ji(r,s,o){if(r!==null&&(s.dependencies=r.dependencies),bs|=s.lanes,(o&s.childLanes)===0)if(r!==null){if(vo(r,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,o=Ti(r,r.pendingProps),s.child=o,o.return=s;r.sibling!==null;)r=r.sibling,o=o.sibling=Ti(r,r.pendingProps),o.return=s;o.sibling=null}return s.child}function Cm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&ed(r)))}function eA(r,s,o){switch(s.tag){case 3:xe(s,s.stateNode.containerInfo),hs(s,qt,r.memoizedState.cache),ba();break;case 27:case 5:Y(s);break;case 4:xe(s,s.stateNode.containerInfo);break;case 10:hs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Jf(s),null;break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(gs(s),s.flags|=128,null):(o&s.child.childLanes)!==0?M0(r,s,o):(gs(s),r=ji(r,s,o),r!==null?r.sibling:null);gs(s);break;case 19:var p=(r.flags&128)!==0;if(u=(o&s.childLanes)!==0,u||(vo(r,s,o,!1),u=(o&s.childLanes)!==0),p){if(u)return N0(r,s,o);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),G(kt,kt.current),u)break;return null;case 22:return s.lanes=0,C0(r,s,o,s.pendingProps);case 24:hs(s,qt,r.memoizedState.cache)}return ji(r,s,o)}function P0(r,s,o){if(r!==null)if(r.memoizedProps!==s.pendingProps)Gt=!0;else{if(!Cm(r,o)&&(s.flags&128)===0)return Gt=!1,eA(r,s,o);Gt=(r.flags&131072)!==0}else Gt=!1,Ze&&(s.flags&1048576)!==0&&m_(s,Jl,s.index);switch(s.lanes=0,s.tag){case 16:e:{var u=s.pendingProps;if(r=Sa(s.elementType),s.type=r,typeof r=="function")Of(r)?(u=Ra(r,u),s.tag=1,s=j0(null,s,r,u,o)):(s.tag=0,s=bm(null,s,r,u,o));else{if(r!=null){var p=r.$$typeof;if(p===ee){s.tag=11,s=S0(null,s,r,u,o);break e}else if(p===P){s.tag=14,s=T0(null,s,r,u,o);break e}}throw s=ae(r)||r,Error(i(306,s,""))}}return s;case 0:return bm(r,s,s.type,s.pendingProps,o);case 1:return u=s.type,p=Ra(u,s.pendingProps),j0(r,s,u,p,o);case 3:e:{if(xe(s,s.stateNode.containerInfo),r===null)throw Error(i(387));u=s.pendingProps;var y=s.memoizedState;p=y.element,Qf(r,s),ac(s,u,null,o);var E=s.memoizedState;if(u=E.cache,hs(s,qt,u),u!==y.cache&&Bf(s,[qt],o,!0),sc(),u=E.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:E.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=O0(r,s,u,o);break e}else if(u!==p){p=hr(Error(i(424)),s),Zl(p),s=O0(r,s,u,o);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,vt=yr(r.firstChild),mn=s,Ze=!0,us=null,pr=!0,o=C_(s,null,u,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ba(),u===p){s=ji(r,s,o);break e}gn(r,s,u,o)}s=s.child}return s;case 26:return vd(r,s),r===null?(o=Qv(s.type,null,s.pendingProps,null))?s.memoizedState=o:Ze||(o=s.type,r=s.pendingProps,u=Pd(he.current).createElement(o),u[Ut]=s,u[sn]=r,yn(u,o,r),Bt(u),s.stateNode=u):s.memoizedState=Qv(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return Y(s),r===null&&Ze&&(u=s.stateNode=Hv(s.type,s.pendingProps,he.current),mn=s,pr=!0,p=vt,Ts(s.type)?(ap=p,vt=yr(u.firstChild)):vt=p),gn(r,s,s.pendingProps.children,o),vd(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&Ze&&((p=u=vt)&&(u=IA(u,s.type,s.pendingProps,pr),u!==null?(s.stateNode=u,mn=s,vt=yr(u.firstChild),pr=!1,p=!0):p=!1),p||ds(s)),Y(s),p=s.type,y=s.pendingProps,E=r!==null?r.memoizedProps:null,u=y.children,tp(p,y)?u=null:E!==null&&tp(p,E)&&(s.flags|=32),s.memoizedState!==null&&(p=em(r,s,GT,null,null,o),Ac._currentValue=p),vd(r,s),gn(r,s,u,o),s.child;case 6:return r===null&&Ze&&((r=o=vt)&&(o=jA(o,s.pendingProps,pr),o!==null?(s.stateNode=o,mn=s,vt=null,r=!0):r=!1),r||ds(s)),null;case 13:return M0(r,s,o);case 4:return xe(s,s.stateNode.containerInfo),u=s.pendingProps,r===null?s.child=Aa(s,null,u,o):gn(r,s,u,o),s.child;case 11:return S0(r,s,s.type,s.pendingProps,o);case 7:return gn(r,s,s.pendingProps,o),s.child;case 8:return gn(r,s,s.pendingProps.children,o),s.child;case 12:return gn(r,s,s.pendingProps.children,o),s.child;case 10:return u=s.pendingProps,hs(s,s.type,u.value),gn(r,s,u.children,o),s.child;case 9:return p=s.type._context,u=s.pendingProps.children,Ea(s),p=pn(p),u=u(p),s.flags|=1,gn(r,s,u,o),s.child;case 14:return T0(r,s,s.type,s.pendingProps,o);case 15:return A0(r,s,s.type,s.pendingProps,o);case 19:return N0(r,s,o);case 31:return ZT(r,s,o);case 22:return C0(r,s,o,s.pendingProps);case 24:return Ea(s),u=pn(qt),r===null?(p=Hf(),p===null&&(p=pt,y=Ff(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=o),p=y),s.memoizedState={parent:u,cache:p},$f(s),hs(s,qt,p)):((r.lanes&o)!==0&&(Qf(r,s),ac(s,null,null,o),sc()),p=r.memoizedState,y=s.memoizedState,p.parent!==u?(p={parent:u,cache:u},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),hs(s,qt,u)):(u=y.cache,hs(s,qt,u),u!==p.cache&&Bf(s,[qt],o,!0))),gn(r,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Oi(r){r.flags|=4}function Rm(r,s,o,u,p){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(p&335544128)===p)if(r.stateNode.complete)r.flags|=8192;else if(cv())r.flags|=8192;else throw Ta=id,Gf}else r.flags&=-16777217}function L0(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Jv(s))if(cv())r.flags|=8192;else throw Ta=id,Gf}function xd(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?Cu():536870912,r.lanes|=s,jo|=s)}function hc(r,s){if(!Ze)switch(r.tailMode){case"hidden":s=r.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function bt(r){var s=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(s)for(var p=r.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=u,r.childLanes=o,s}function tA(r,s,o){var u=s.pendingProps;switch(Pf(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(s),null;case 1:return bt(s),null;case 3:return o=s.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),Ri(qt),oe(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(_o(s)?Oi(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Vf())),bt(s),null;case 26:var p=s.type,y=s.memoizedState;return r===null?(Oi(s),y!==null?(bt(s),L0(s,y)):(bt(s),Rm(s,p,null,u,o))):y?y!==r.memoizedState?(Oi(s),bt(s),L0(s,y)):(bt(s),s.flags&=-16777217):(r=r.memoizedProps,r!==u&&Oi(s),bt(s),Rm(s,p,r,u,o)),null;case 27:if(Se(s),o=he.current,p=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==u&&Oi(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return bt(s),null}r=K.current,_o(s)?g_(s):(r=Hv(p,u,o),s.stateNode=r,Oi(s))}return bt(s),null;case 5:if(Se(s),p=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==u&&Oi(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return bt(s),null}if(y=K.current,_o(s))g_(s);else{var E=Pd(he.current);switch(y){case 1:y=E.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=E.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=E.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?E.createElement("select",{is:u.is}):E.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?E.createElement(p,{is:u.is}):E.createElement(p)}}y[Ut]=s,y[sn]=u;e:for(E=s.child;E!==null;){if(E.tag===5||E.tag===6)y.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===s)break e;for(;E.sibling===null;){if(E.return===null||E.return===s)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}s.stateNode=y;e:switch(yn(y,p,u),p){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Oi(s)}}return bt(s),Rm(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,o),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==u&&Oi(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(i(166));if(r=he.current,_o(s)){if(r=s.stateNode,o=s.memoizedProps,u=null,p=mn,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}r[Ut]=s,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Mv(r.nodeValue,o)),r||ds(s,!0)}else r=Pd(r).createTextNode(u),r[Ut]=s,s.stateNode=r}return bt(s),null;case 31:if(o=s.memoizedState,r===null||r.memoizedState!==null){if(u=_o(s),o!==null){if(r===null){if(!u)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Ut]=s}else ba(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;bt(s),r=!1}else o=Vf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return s.flags&256?(Xn(s),s):(Xn(s),null);if((s.flags&128)!==0)throw Error(i(558))}return bt(s),null;case 13:if(u=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=_o(s),u!==null&&u.dehydrated!==null){if(r===null){if(!p)throw Error(i(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Ut]=s}else ba(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;bt(s),p=!1}else p=Vf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(Xn(s),s):(Xn(s),null)}return Xn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=u!==null,r=r!==null&&r.memoizedState!==null,o&&(u=s.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==p&&(u.flags|=2048)),o!==r&&o&&(s.child.flags|=8192),xd(s,s.updateQueue),bt(s),null);case 4:return oe(),r===null&&Ym(s.stateNode.containerInfo),bt(s),null;case 10:return Ri(s.type),bt(s),null;case 19:if(U(kt),u=s.memoizedState,u===null)return bt(s),null;if(p=(s.flags&128)!==0,y=u.rendering,y===null)if(p)hc(u,!1);else{if(It!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(y=ld(r),y!==null){for(s.flags|=128,hc(u,!1),r=y.updateQueue,s.updateQueue=r,xd(s,r),s.subtreeFlags=0,r=o,o=s.child;o!==null;)d_(o,r),o=o.sibling;return G(kt,kt.current&1|2),Ze&&Ai(s,u.treeForkCount),s.child}r=r.sibling}u.tail!==null&&Rt()>Ad&&(s.flags|=128,p=!0,hc(u,!1),s.lanes=4194304)}else{if(!p)if(r=ld(y),r!==null){if(s.flags|=128,p=!0,r=r.updateQueue,s.updateQueue=r,xd(s,r),hc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!Ze)return bt(s),null}else 2*Rt()-u.renderingStartTime>Ad&&o!==536870912&&(s.flags|=128,p=!0,hc(u,!1),s.lanes=4194304);u.isBackwards?(y.sibling=s.child,s.child=y):(r=u.last,r!==null?r.sibling=y:s.child=y,u.last=y)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=Rt(),r.sibling=null,o=kt.current,G(kt,p?o&1|2:o&1),Ze&&Ai(s,u.treeForkCount),r):(bt(s),null);case 22:case 23:return Xn(s),Xf(),u=s.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?(o&536870912)!==0&&(s.flags&128)===0&&(bt(s),s.subtreeFlags&6&&(s.flags|=8192)):bt(s),o=s.updateQueue,o!==null&&xd(s,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==o&&(s.flags|=2048),r!==null&&U(wa),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Ri(qt),bt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function nA(r,s){switch(Pf(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Ri(qt),oe(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return Se(s),null;case 31:if(s.memoizedState!==null){if(Xn(s),s.alternate===null)throw Error(i(340));ba()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(Xn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));ba()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return U(kt),null;case 4:return oe(),null;case 10:return Ri(s.type),null;case 22:case 23:return Xn(s),Xf(),r!==null&&U(wa),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return Ri(qt),null;case 25:return null;default:return null}}function V0(r,s){switch(Pf(s),s.tag){case 3:Ri(qt),oe();break;case 26:case 27:case 5:Se(s);break;case 4:oe();break;case 31:s.memoizedState!==null&&Xn(s);break;case 13:Xn(s);break;case 19:U(kt);break;case 10:Ri(s.type);break;case 22:case 23:Xn(s),Xf(),r!==null&&U(wa);break;case 24:Ri(qt)}}function fc(r,s){try{var o=s.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var p=u.next;o=p;do{if((o.tag&r)===r){u=void 0;var y=o.create,E=o.inst;u=y(),E.destroy=u}o=o.next}while(o!==p)}}catch(j){ct(s,s.return,j)}}function _s(r,s,o){try{var u=s.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var y=p.next;u=y;do{if((u.tag&r)===r){var E=u.inst,j=E.destroy;if(j!==void 0){E.destroy=void 0,p=s;var $=o,se=j;try{se()}catch(pe){ct(p,$,pe)}}}u=u.next}while(u!==y)}}catch(pe){ct(s,s.return,pe)}}function z0(r){var s=r.updateQueue;if(s!==null){var o=r.stateNode;try{D_(s,o)}catch(u){ct(r,r.return,u)}}}function U0(r,s,o){o.props=Ra(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){ct(r,s,u)}}function mc(r,s){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(p){ct(r,s,p)}}function oi(r,s){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(p){ct(r,s,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){ct(r,s,p)}else o.current=null}function B0(r){var s=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(p){ct(r,r.return,p)}}function Dm(r,s,o){try{var u=r.stateNode;SA(u,r.type,o,s),u[sn]=s}catch(p){ct(r,r.return,p)}}function F0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Ts(r.type)||r.tag===4}function Im(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||F0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Ts(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function jm(r,s,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(r),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=Rr));else if(u!==4&&(u===27&&Ts(r.type)&&(o=r.stateNode,s=null),r=r.child,r!==null))for(jm(r,s,o),r=r.sibling;r!==null;)jm(r,s,o),r=r.sibling}function Ed(r,s,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,s?o.insertBefore(r,s):o.appendChild(r);else if(u!==4&&(u===27&&Ts(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(Ed(r,s,o),r=r.sibling;r!==null;)Ed(r,s,o),r=r.sibling}function q0(r){var s=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);yn(s,u,o),s[Ut]=r,s[sn]=o}catch(y){ct(r,r.return,y)}}var Mi=!1,$t=!1,Om=!1,H0=typeof WeakSet=="function"?WeakSet:Set,on=null;function rA(r,s){if(r=r.containerInfo,Zm=qd,r=n_(r),Tf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var p=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var E=0,j=-1,$=-1,se=0,pe=0,ye=r,le=null;t:for(;;){for(var fe;ye!==o||p!==0&&ye.nodeType!==3||(j=E+p),ye!==y||u!==0&&ye.nodeType!==3||($=E+u),ye.nodeType===3&&(E+=ye.nodeValue.length),(fe=ye.firstChild)!==null;)le=ye,ye=fe;for(;;){if(ye===r)break t;if(le===o&&++se===p&&(j=E),le===y&&++pe===u&&($=E),(fe=ye.nextSibling)!==null)break;ye=le,le=ye.parentNode}ye=fe}o=j===-1||$===-1?null:{start:j,end:$}}else o=null}o=o||{start:0,end:0}}else o=null;for(ep={focusedElem:r,selectionRange:o},qd=!1,on=s;on!==null;)if(s=on,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,on=r;else for(;on!==null;){switch(s=on,y=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)p=r[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=s,p=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var De=Ra(o.type,p);r=u.getSnapshotBeforeUpdate(De,y),u.__reactInternalSnapshotBeforeUpdate=r}catch(ke){ct(o,o.return,ke)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,o=r.nodeType,o===9)rp(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":rp(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,on=r;break}on=s.return}}function G0(r,s,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:Ni(r,o),u&4&&fc(5,o);break;case 1:if(Ni(r,o),u&4)if(r=o.stateNode,s===null)try{r.componentDidMount()}catch(E){ct(o,o.return,E)}else{var p=Ra(o.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(p,s,r.__reactInternalSnapshotBeforeUpdate)}catch(E){ct(o,o.return,E)}}u&64&&z0(o),u&512&&mc(o,o.return);break;case 3:if(Ni(r,o),u&64&&(r=o.updateQueue,r!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{D_(r,s)}catch(E){ct(o,o.return,E)}}break;case 27:s===null&&u&4&&q0(o);case 26:case 5:Ni(r,o),s===null&&u&4&&B0(o),u&512&&mc(o,o.return);break;case 12:Ni(r,o);break;case 31:Ni(r,o),u&4&&W0(r,o);break;case 13:Ni(r,o),u&4&&K0(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=hA.bind(null,o),OA(r,o))));break;case 22:if(u=o.memoizedState!==null||Mi,!u){s=s!==null&&s.memoizedState!==null||$t,p=Mi;var y=$t;Mi=u,($t=s)&&!y?Pi(r,o,(o.subtreeFlags&8772)!==0):Ni(r,o),Mi=p,$t=y}break;case 30:break;default:Ni(r,o)}}function $0(r){var s=r.alternate;s!==null&&(r.alternate=null,$0(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&eo(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var wt=null,kn=!1;function ki(r,s,o){for(o=o.child;o!==null;)Q0(r,s,o),o=o.sibling}function Q0(r,s,o){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(Sr,o)}catch{}switch(o.tag){case 26:$t||oi(o,s),ki(r,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:$t||oi(o,s);var u=wt,p=kn;Ts(o.type)&&(wt=o.stateNode,kn=!1),ki(r,s,o),wc(o.stateNode),wt=u,kn=p;break;case 5:$t||oi(o,s);case 6:if(u=wt,p=kn,wt=null,ki(r,s,o),wt=u,kn=p,wt!==null)if(kn)try{(wt.nodeType===9?wt.body:wt.nodeName==="HTML"?wt.ownerDocument.body:wt).removeChild(o.stateNode)}catch(y){ct(o,s,y)}else try{wt.removeChild(o.stateNode)}catch(y){ct(o,s,y)}break;case 18:wt!==null&&(kn?(r=wt,zv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),zo(r)):zv(wt,o.stateNode));break;case 4:u=wt,p=kn,wt=o.stateNode.containerInfo,kn=!0,ki(r,s,o),wt=u,kn=p;break;case 0:case 11:case 14:case 15:_s(2,o,s),$t||_s(4,o,s),ki(r,s,o);break;case 1:$t||(oi(o,s),u=o.stateNode,typeof u.componentWillUnmount=="function"&&U0(o,s,u)),ki(r,s,o);break;case 21:ki(r,s,o);break;case 22:$t=(u=$t)||o.memoizedState!==null,ki(r,s,o),$t=u;break;default:ki(r,s,o)}}function W0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{zo(r)}catch(o){ct(s,s.return,o)}}}function K0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{zo(r)}catch(o){ct(s,s.return,o)}}function iA(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new H0),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new H0),s;default:throw Error(i(435,r.tag))}}function wd(r,s){var o=iA(r);s.forEach(function(u){if(!o.has(u)){o.add(u);var p=fA.bind(null,r,u);u.then(p,p)}})}function Nn(r,s){var o=s.deletions;if(o!==null)for(var u=0;u<o.length;u++){var p=o[u],y=r,E=s,j=E;e:for(;j!==null;){switch(j.tag){case 27:if(Ts(j.type)){wt=j.stateNode,kn=!1;break e}break;case 5:wt=j.stateNode,kn=!1;break e;case 3:case 4:wt=j.stateNode.containerInfo,kn=!0;break e}j=j.return}if(wt===null)throw Error(i(160));Q0(y,E,p),wt=null,kn=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Y0(s,r),s=s.sibling}var kr=null;function Y0(r,s){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Nn(s,r),Pn(r),u&4&&(_s(3,r,r.return),fc(3,r),_s(5,r,r.return));break;case 1:Nn(s,r),Pn(r),u&512&&($t||o===null||oi(o,o.return)),u&64&&Mi&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var p=kr;if(Nn(s,r),Pn(r),u&512&&($t||o===null||oi(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,p=p.ownerDocument||p;t:switch(u){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Qr]||y[Ut]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(u),p.head.insertBefore(y,p.querySelector("head > title"))),yn(y,u,o),y[Ut]=r,Bt(y),u=y;break e;case"link":var E=Yv("link","href",p).get(u+(o.href||""));if(E){for(var j=0;j<E.length;j++)if(y=E[j],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(j,1);break t}}y=p.createElement(u),yn(y,u,o),p.head.appendChild(y);break;case"meta":if(E=Yv("meta","content",p).get(u+(o.content||""))){for(j=0;j<E.length;j++)if(y=E[j],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(j,1);break t}}y=p.createElement(u),yn(y,u,o),p.head.appendChild(y);break;default:throw Error(i(468,u))}y[Ut]=r,Bt(y),u=y}r.stateNode=u}else Xv(p,r.type,r.stateNode);else r.stateNode=Kv(p,u,r.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?Xv(p,r.type,r.stateNode):Kv(p,u,r.memoizedProps)):u===null&&r.stateNode!==null&&Dm(r,r.memoizedProps,o.memoizedProps)}break;case 27:Nn(s,r),Pn(r),u&512&&($t||o===null||oi(o,o.return)),o!==null&&u&4&&Dm(r,r.memoizedProps,o.memoizedProps);break;case 5:if(Nn(s,r),Pn(r),u&512&&($t||o===null||oi(o,o.return)),r.flags&32){p=r.stateNode;try{Mn(p,"")}catch(De){ct(r,r.return,De)}}u&4&&r.stateNode!=null&&(p=r.memoizedProps,Dm(r,p,o!==null?o.memoizedProps:p)),u&1024&&(Om=!0);break;case 6:if(Nn(s,r),Pn(r),u&4){if(r.stateNode===null)throw Error(i(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(De){ct(r,r.return,De)}}break;case 3:if(zd=null,p=kr,kr=Ld(s.containerInfo),Nn(s,r),kr=p,Pn(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{zo(s.containerInfo)}catch(De){ct(r,r.return,De)}Om&&(Om=!1,X0(r));break;case 4:u=kr,kr=Ld(r.stateNode.containerInfo),Nn(s,r),Pn(r),kr=u;break;case 12:Nn(s,r),Pn(r);break;case 31:Nn(s,r),Pn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,wd(r,u)));break;case 13:Nn(s,r),Pn(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Td=Rt()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,wd(r,u)));break;case 22:p=r.memoizedState!==null;var $=o!==null&&o.memoizedState!==null,se=Mi,pe=$t;if(Mi=se||p,$t=pe||$,Nn(s,r),$t=pe,Mi=se,Pn(r),u&8192)e:for(s=r.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(o===null||$||Mi||$t||Da(r)),o=null,s=r;;){if(s.tag===5||s.tag===26){if(o===null){$=o=s;try{if(y=$.stateNode,p)E=y.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{j=$.stateNode;var ye=$.memoizedProps.style,le=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;j.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(De){ct($,$.return,De)}}}else if(s.tag===6){if(o===null){$=s;try{$.stateNode.nodeValue=p?"":$.memoizedProps}catch(De){ct($,$.return,De)}}}else if(s.tag===18){if(o===null){$=s;try{var fe=$.stateNode;p?Uv(fe,!0):Uv($.stateNode,!1)}catch(De){ct($,$.return,De)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,wd(r,o))));break;case 19:Nn(s,r),Pn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,wd(r,u)));break;case 30:break;case 21:break;default:Nn(s,r),Pn(r)}}function Pn(r){var s=r.flags;if(s&2){try{for(var o,u=r.return;u!==null;){if(F0(u)){o=u;break}u=u.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var p=o.stateNode,y=Im(r);Ed(r,y,p);break;case 5:var E=o.stateNode;o.flags&32&&(Mn(E,""),o.flags&=-33);var j=Im(r);Ed(r,j,E);break;case 3:case 4:var $=o.stateNode.containerInfo,se=Im(r);jm(r,se,$);break;default:throw Error(i(161))}}catch(pe){ct(r,r.return,pe)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function X0(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;X0(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Ni(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)G0(r,s.alternate,s),s=s.sibling}function Da(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:_s(4,s,s.return),Da(s);break;case 1:oi(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&U0(s,s.return,o),Da(s);break;case 27:wc(s.stateNode);case 26:case 5:oi(s,s.return),Da(s);break;case 22:s.memoizedState===null&&Da(s);break;case 30:Da(s);break;default:Da(s)}r=r.sibling}}function Pi(r,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,p=r,y=s,E=y.flags;switch(y.tag){case 0:case 11:case 15:Pi(p,y,o),fc(4,y);break;case 1:if(Pi(p,y,o),u=y,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(se){ct(u,u.return,se)}if(u=y,p=u.updateQueue,p!==null){var j=u.stateNode;try{var $=p.shared.hiddenCallbacks;if($!==null)for(p.shared.hiddenCallbacks=null,p=0;p<$.length;p++)R_($[p],j)}catch(se){ct(u,u.return,se)}}o&&E&64&&z0(y),mc(y,y.return);break;case 27:q0(y);case 26:case 5:Pi(p,y,o),o&&u===null&&E&4&&B0(y),mc(y,y.return);break;case 12:Pi(p,y,o);break;case 31:Pi(p,y,o),o&&E&4&&W0(p,y);break;case 13:Pi(p,y,o),o&&E&4&&K0(p,y);break;case 22:y.memoizedState===null&&Pi(p,y,o),mc(y,y.return);break;case 30:break;default:Pi(p,y,o)}s=s.sibling}}function Mm(r,s){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&ec(o))}function km(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&ec(r))}function Nr(r,s,o,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)J0(r,s,o,u),s=s.sibling}function J0(r,s,o,u){var p=s.flags;switch(s.tag){case 0:case 11:case 15:Nr(r,s,o,u),p&2048&&fc(9,s);break;case 1:Nr(r,s,o,u);break;case 3:Nr(r,s,o,u),p&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&ec(r)));break;case 12:if(p&2048){Nr(r,s,o,u),r=s.stateNode;try{var y=s.memoizedProps,E=y.id,j=y.onPostCommit;typeof j=="function"&&j(E,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch($){ct(s,s.return,$)}}else Nr(r,s,o,u);break;case 31:Nr(r,s,o,u);break;case 13:Nr(r,s,o,u);break;case 23:break;case 22:y=s.stateNode,E=s.alternate,s.memoizedState!==null?y._visibility&2?Nr(r,s,o,u):pc(r,s):y._visibility&2?Nr(r,s,o,u):(y._visibility|=2,Ro(r,s,o,u,(s.subtreeFlags&10256)!==0||!1)),p&2048&&Mm(E,s);break;case 24:Nr(r,s,o,u),p&2048&&km(s.alternate,s);break;default:Nr(r,s,o,u)}}function Ro(r,s,o,u,p){for(p=p&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=r,E=s,j=o,$=u,se=E.flags;switch(E.tag){case 0:case 11:case 15:Ro(y,E,j,$,p),fc(8,E);break;case 23:break;case 22:var pe=E.stateNode;E.memoizedState!==null?pe._visibility&2?Ro(y,E,j,$,p):pc(y,E):(pe._visibility|=2,Ro(y,E,j,$,p)),p&&se&2048&&Mm(E.alternate,E);break;case 24:Ro(y,E,j,$,p),p&&se&2048&&km(E.alternate,E);break;default:Ro(y,E,j,$,p)}s=s.sibling}}function pc(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=r,u=s,p=u.flags;switch(u.tag){case 22:pc(o,u),p&2048&&Mm(u.alternate,u);break;case 24:pc(o,u),p&2048&&km(u.alternate,u);break;default:pc(o,u)}s=s.sibling}}var gc=8192;function Do(r,s,o){if(r.subtreeFlags&gc)for(r=r.child;r!==null;)Z0(r,s,o),r=r.sibling}function Z0(r,s,o){switch(r.tag){case 26:Do(r,s,o),r.flags&gc&&r.memoizedState!==null&&HA(o,kr,r.memoizedState,r.memoizedProps);break;case 5:Do(r,s,o);break;case 3:case 4:var u=kr;kr=Ld(r.stateNode.containerInfo),Do(r,s,o),kr=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=gc,gc=16777216,Do(r,s,o),gc=u):Do(r,s,o));break;default:Do(r,s,o)}}function ev(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function yc(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];on=u,nv(u,r)}ev(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)tv(r),r=r.sibling}function tv(r){switch(r.tag){case 0:case 11:case 15:yc(r),r.flags&2048&&_s(9,r,r.return);break;case 3:yc(r);break;case 12:yc(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,Sd(r)):yc(r);break;default:yc(r)}}function Sd(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];on=u,nv(u,r)}ev(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:_s(8,s,s.return),Sd(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,Sd(s));break;default:Sd(s)}r=r.sibling}}function nv(r,s){for(;on!==null;){var o=on;switch(o.tag){case 0:case 11:case 15:_s(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:ec(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,on=u;else e:for(o=r;on!==null;){u=on;var p=u.sibling,y=u.return;if($0(u),u===o){on=null;break e}if(p!==null){p.return=y,on=p;break e}on=y}}}var sA={getCacheForType:function(r){var s=pn(qt),o=s.data.get(r);return o===void 0&&(o=r(),s.data.set(r,o)),o},cacheSignal:function(){return pn(qt).controller.signal}},aA=typeof WeakMap=="function"?WeakMap:Map,st=0,pt=null,$e=null,We=0,lt=0,Jn=null,vs=!1,Io=!1,Nm=!1,Li=0,It=0,bs=0,Ia=0,Pm=0,Zn=0,jo=0,_c=null,Ln=null,Lm=!1,Td=0,rv=0,Ad=1/0,Cd=null,xs=null,Jt=0,Es=null,Oo=null,Vi=0,Vm=0,zm=null,iv=null,vc=0,Um=null;function er(){return(st&2)!==0&&We!==0?We&-We:V.T!==null?$m():Ru()}function sv(){if(Zn===0)if((We&536870912)===0||Ze){var r=ra;ra<<=1,(ra&3932160)===0&&(ra=262144),Zn=r}else Zn=536870912;return r=Yn.current,r!==null&&(r.flags|=32),Zn}function Vn(r,s,o){(r===pt&&(lt===2||lt===9)||r.cancelPendingCommit!==null)&&(Mo(r,0),ws(r,We,Zn,!1)),ia(r,o),((st&2)===0||r!==pt)&&(r===pt&&((st&2)===0&&(Ia|=o),It===4&&ws(r,We,Zn,!1)),li(r))}function av(r,s,o){if((st&6)!==0)throw Error(i(327));var u=!o&&(s&127)===0&&(s&r.expiredLanes)===0||Tr(r,s),p=u?cA(r,s):Fm(r,s,!0),y=u;do{if(p===0){Io&&!u&&ws(r,s,0,!1);break}else{if(o=r.current.alternate,y&&!oA(o)){p=Fm(r,s,!1),y=!1;continue}if(p===2){if(y=s,r.errorRecoveryDisabledLanes&y)var E=0;else E=r.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){s=E;e:{var j=r;p=_c;var $=j.current.memoizedState.isDehydrated;if($&&(Mo(j,E).flags|=256),E=Fm(j,E,!1),E!==2){if(Nm&&!$){j.errorRecoveryDisabledLanes|=y,Ia|=y,p=4;break e}y=Ln,Ln=p,y!==null&&(Ln===null?Ln=y:Ln.push.apply(Ln,y))}p=E}if(y=!1,p!==2)continue}}if(p===1){Mo(r,0),ws(r,s,0,!0);break}e:{switch(u=r,y=p,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:ws(u,s,Zn,!vs);break e;case 2:Ln=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(p=Td+300-Rt(),10<p)){if(ws(u,s,Zn,!vs),Hr(u,0,!0)!==0)break e;Vi=s,u.timeoutHandle=Lv(ov.bind(null,u,o,Ln,Cd,Lm,s,Zn,Ia,jo,vs,y,"Throttled",-0,0),p);break e}ov(u,o,Ln,Cd,Lm,s,Zn,Ia,jo,vs,y,null,-0,0)}}break}while(!0);li(r)}function ov(r,s,o,u,p,y,E,j,$,se,pe,ye,le,fe){if(r.timeoutHandle=-1,ye=s.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Rr},Z0(s,y,ye);var De=(y&62914560)===y?Td-Rt():(y&4194048)===y?rv-Rt():0;if(De=GA(ye,De),De!==null){Vi=y,r.cancelPendingCommit=De(pv.bind(null,r,s,y,o,u,p,E,j,$,pe,ye,null,le,fe)),ws(r,y,E,!se);return}}pv(r,s,y,o,u,p,E,j,$)}function oA(r){for(var s=r;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var p=o[u],y=p.getSnapshot;p=p.value;try{if(!Wn(y(),p))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ws(r,s,o,u){s&=~Pm,s&=~Ia,r.suspendedLanes|=s,r.pingedLanes&=~s,u&&(r.warmLanes|=s),u=r.expirationTimes;for(var p=s;0<p;){var y=31-Ot(p),E=1<<y;u[y]=-1,p&=~E}o!==0&&sa(r,o,s)}function Rd(){return(st&6)===0?(bc(0),!1):!0}function Bm(){if($e!==null){if(lt===0)var r=$e.return;else r=$e,Ci=xa=null,rm(r),wo=null,nc=0,r=$e;for(;r!==null;)V0(r.alternate,r),r=r.return;$e=null}}function Mo(r,s){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,CA(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),Vi=0,Bm(),pt=r,$e=o=Ti(r.current,null),We=s,lt=0,Jn=null,vs=!1,Io=Tr(r,s),Nm=!1,jo=Zn=Pm=Ia=bs=It=0,Ln=_c=null,Lm=!1,(s&8)!==0&&(s|=s&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=s;0<u;){var p=31-Ot(u),y=1<<p;s|=r[p],u&=~y}return Li=s,Ku(),o}function lv(r,s){qe=null,V.H=uc,s===Eo||s===rd?(s=S_(),lt=3):s===Gf?(s=S_(),lt=4):lt=s===vm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Jn=s,$e===null&&(It=1,yd(r,hr(s,r.current)))}function cv(){var r=Yn.current;return r===null?!0:(We&4194048)===We?gr===null:(We&62914560)===We||(We&536870912)!==0?r===gr:!1}function uv(){var r=V.H;return V.H=uc,r===null?uc:r}function dv(){var r=V.A;return V.A=sA,r}function Dd(){It=4,vs||(We&4194048)!==We&&Yn.current!==null||(Io=!0),(bs&134217727)===0&&(Ia&134217727)===0||pt===null||ws(pt,We,Zn,!1)}function Fm(r,s,o){var u=st;st|=2;var p=uv(),y=dv();(pt!==r||We!==s)&&(Cd=null,Mo(r,s)),s=!1;var E=It;e:do try{if(lt!==0&&$e!==null){var j=$e,$=Jn;switch(lt){case 8:Bm(),E=6;break e;case 3:case 2:case 9:case 6:Yn.current===null&&(s=!0);var se=lt;if(lt=0,Jn=null,ko(r,j,$,se),o&&Io){E=0;break e}break;default:se=lt,lt=0,Jn=null,ko(r,j,$,se)}}lA(),E=It;break}catch(pe){lv(r,pe)}while(!0);return s&&r.shellSuspendCounter++,Ci=xa=null,st=u,V.H=p,V.A=y,$e===null&&(pt=null,We=0,Ku()),E}function lA(){for(;$e!==null;)hv($e)}function cA(r,s){var o=st;st|=2;var u=uv(),p=dv();pt!==r||We!==s?(Cd=null,Ad=Rt()+500,Mo(r,s)):Io=Tr(r,s);e:do try{if(lt!==0&&$e!==null){s=$e;var y=Jn;t:switch(lt){case 1:lt=0,Jn=null,ko(r,s,y,1);break;case 2:case 9:if(E_(y)){lt=0,Jn=null,fv(s);break}s=function(){lt!==2&&lt!==9||pt!==r||(lt=7),li(r)},y.then(s,s);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:E_(y)?(lt=0,Jn=null,fv(s)):(lt=0,Jn=null,ko(r,s,y,7));break;case 5:var E=null;switch($e.tag){case 26:E=$e.memoizedState;case 5:case 27:var j=$e;if(E?Jv(E):j.stateNode.complete){lt=0,Jn=null;var $=j.sibling;if($!==null)$e=$;else{var se=j.return;se!==null?($e=se,Id(se)):$e=null}break t}}lt=0,Jn=null,ko(r,s,y,5);break;case 6:lt=0,Jn=null,ko(r,s,y,6);break;case 8:Bm(),It=6;break e;default:throw Error(i(462))}}uA();break}catch(pe){lv(r,pe)}while(!0);return Ci=xa=null,V.H=u,V.A=p,st=o,$e!==null?0:(pt=null,We=0,Ku(),It)}function uA(){for(;$e!==null&&!qn();)hv($e)}function hv(r){var s=P0(r.alternate,r,Li);r.memoizedProps=r.pendingProps,s===null?Id(r):$e=s}function fv(r){var s=r,o=s.alternate;switch(s.tag){case 15:case 0:s=I0(o,s,s.pendingProps,s.type,void 0,We);break;case 11:s=I0(o,s,s.pendingProps,s.type.render,s.ref,We);break;case 5:rm(s);default:V0(o,s),s=$e=d_(s,Li),s=P0(o,s,Li)}r.memoizedProps=r.pendingProps,s===null?Id(r):$e=s}function ko(r,s,o,u){Ci=xa=null,rm(s),wo=null,nc=0;var p=s.return;try{if(JT(r,p,s,o,We)){It=1,yd(r,hr(o,r.current)),$e=null;return}}catch(y){if(p!==null)throw $e=p,y;It=1,yd(r,hr(o,r.current)),$e=null;return}s.flags&32768?(Ze||u===1?r=!0:Io||(We&536870912)!==0?r=!1:(vs=r=!0,(u===2||u===9||u===3||u===6)&&(u=Yn.current,u!==null&&u.tag===13&&(u.flags|=16384))),mv(s,r)):Id(s)}function Id(r){var s=r;do{if((s.flags&32768)!==0){mv(s,vs);return}r=s.return;var o=tA(s.alternate,s,Li);if(o!==null){$e=o;return}if(s=s.sibling,s!==null){$e=s;return}$e=s=r}while(s!==null);It===0&&(It=5)}function mv(r,s){do{var o=nA(r.alternate,r);if(o!==null){o.flags&=32767,$e=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(r=r.sibling,r!==null)){$e=r;return}$e=r=o}while(r!==null);It=6,$e=null}function pv(r,s,o,u,p,y,E,j,$){r.cancelPendingCommit=null;do jd();while(Jt!==0);if((st&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=If,xf(r,o,y,E,j,$),r===pt&&($e=pt=null,We=0),Oo=s,Es=r,Vi=o,Vm=y,zm=p,iv=u,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,mA(Zi,function(){return bv(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||u){u=V.T,V.T=null,p=Q.p,Q.p=2,E=st,st|=4;try{rA(r,s,o)}finally{st=E,Q.p=p,V.T=u}}Jt=1,gv(),yv(),_v()}}function gv(){if(Jt===1){Jt=0;var r=Es,s=Oo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=V.T,V.T=null;var u=Q.p;Q.p=2;var p=st;st|=4;try{Y0(s,r);var y=ep,E=n_(r.containerInfo),j=y.focusedElem,$=y.selectionRange;if(E!==j&&j&&j.ownerDocument&&t_(j.ownerDocument.documentElement,j)){if($!==null&&Tf(j)){var se=$.start,pe=$.end;if(pe===void 0&&(pe=se),"selectionStart"in j)j.selectionStart=se,j.selectionEnd=Math.min(pe,j.value.length);else{var ye=j.ownerDocument||document,le=ye&&ye.defaultView||window;if(le.getSelection){var fe=le.getSelection(),De=j.textContent.length,ke=Math.min($.start,De),ft=$.end===void 0?ke:Math.min($.end,De);!fe.extend&&ke>ft&&(E=ft,ft=ke,ke=E);var Z=e_(j,ke),X=e_(j,ft);if(Z&&X&&(fe.rangeCount!==1||fe.anchorNode!==Z.node||fe.anchorOffset!==Z.offset||fe.focusNode!==X.node||fe.focusOffset!==X.offset)){var ie=ye.createRange();ie.setStart(Z.node,Z.offset),fe.removeAllRanges(),ke>ft?(fe.addRange(ie),fe.extend(X.node,X.offset)):(ie.setEnd(X.node,X.offset),fe.addRange(ie))}}}}for(ye=[],fe=j;fe=fe.parentNode;)fe.nodeType===1&&ye.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<ye.length;j++){var ge=ye[j];ge.element.scrollLeft=ge.left,ge.element.scrollTop=ge.top}}qd=!!Zm,ep=Zm=null}finally{st=p,Q.p=u,V.T=o}}r.current=s,Jt=2}}function yv(){if(Jt===2){Jt=0;var r=Es,s=Oo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=V.T,V.T=null;var u=Q.p;Q.p=2;var p=st;st|=4;try{G0(r,s.alternate,s)}finally{st=p,Q.p=u,V.T=o}}Jt=3}}function _v(){if(Jt===4||Jt===3){Jt=0,wr();var r=Es,s=Oo,o=Vi,u=iv;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Jt=5:(Jt=0,Oo=Es=null,vv(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&(xs=null),xi(o),s=s.stateNode,hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(Sr,s,void 0,(s.current.flags&128)===128)}catch{}if(u!==null){s=V.T,p=Q.p,Q.p=2,V.T=null;try{for(var y=r.onRecoverableError,E=0;E<u.length;E++){var j=u[E];y(j.value,{componentStack:j.stack})}}finally{V.T=s,Q.p=p}}(Vi&3)!==0&&jd(),li(r),p=r.pendingLanes,(o&261930)!==0&&(p&42)!==0?r===Um?vc++:(vc=0,Um=r):vc=0,bc(0)}}function vv(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,ec(s)))}function jd(){return gv(),yv(),_v(),bv()}function bv(){if(Jt!==5)return!1;var r=Es,s=Vm;Vm=0;var o=xi(Vi),u=V.T,p=Q.p;try{Q.p=32>o?32:o,V.T=null,o=zm,zm=null;var y=Es,E=Vi;if(Jt=0,Oo=Es=null,Vi=0,(st&6)!==0)throw Error(i(331));var j=st;if(st|=4,tv(y.current),J0(y,y.current,E,o),st=j,bc(0,!1),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(Sr,y)}catch{}return!0}finally{Q.p=p,V.T=u,vv(r,s)}}function xv(r,s,o){s=hr(o,s),s=_m(r.stateNode,s,2),r=ps(r,s,2),r!==null&&(ia(r,2),li(r))}function ct(r,s,o){if(r.tag===3)xv(r,r,o);else for(;s!==null;){if(s.tag===3){xv(s,r,o);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(xs===null||!xs.has(u))){r=hr(o,r),o=E0(2),u=ps(s,o,2),u!==null&&(w0(o,u,s,r),ia(u,2),li(u));break}}s=s.return}}function qm(r,s,o){var u=r.pingCache;if(u===null){u=r.pingCache=new aA;var p=new Set;u.set(s,p)}else p=u.get(s),p===void 0&&(p=new Set,u.set(s,p));p.has(o)||(Nm=!0,p.add(o),r=dA.bind(null,r,s,o),s.then(r,r))}function dA(r,s,o){var u=r.pingCache;u!==null&&u.delete(s),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,pt===r&&(We&o)===o&&(It===4||It===3&&(We&62914560)===We&&300>Rt()-Td?(st&2)===0&&Mo(r,0):Pm|=o,jo===We&&(jo=0)),li(r)}function Ev(r,s){s===0&&(s=Cu()),r=_a(r,s),r!==null&&(ia(r,s),li(r))}function hA(r){var s=r.memoizedState,o=0;s!==null&&(o=s.retryLane),Ev(r,o)}function fA(r,s){var o=0;switch(r.tag){case 31:case 13:var u=r.stateNode,p=r.memoizedState;p!==null&&(o=p.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(s),Ev(r,o)}function mA(r,s){return jt(r,s)}var Od=null,No=null,Hm=!1,Md=!1,Gm=!1,Ss=0;function li(r){r!==No&&r.next===null&&(No===null?Od=No=r:No=No.next=r),Md=!0,Hm||(Hm=!0,gA())}function bc(r,s){if(!Gm&&Md){Gm=!0;do for(var o=!1,u=Od;u!==null;){if(r!==0){var p=u.pendingLanes;if(p===0)var y=0;else{var E=u.suspendedLanes,j=u.pingedLanes;y=(1<<31-Ot(42|r)+1)-1,y&=p&~(E&~j),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,Av(u,y))}else y=We,y=Hr(u,u===pt?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||Tr(u,y)||(o=!0,Av(u,y));u=u.next}while(o);Gm=!1}}function pA(){wv()}function wv(){Md=Hm=!1;var r=0;Ss!==0&&AA()&&(r=Ss);for(var s=Rt(),o=null,u=Od;u!==null;){var p=u.next,y=Sv(u,s);y===0?(u.next=null,o===null?Od=p:o.next=p,p===null&&(No=o)):(o=u,(r!==0||(y&3)!==0)&&(Md=!0)),u=p}Jt!==0&&Jt!==5||bc(r),Ss!==0&&(Ss=0)}function Sv(r,s){for(var o=r.suspendedLanes,u=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var E=31-Ot(y),j=1<<E,$=p[E];$===-1?((j&o)===0||(j&u)!==0)&&(p[E]=bf(j,s)):$<=s&&(r.expiredLanes|=j),y&=~j}if(s=pt,o=We,o=Hr(r,r===s?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===s&&(lt===2||lt===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&rt(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||Tr(r,o)){if(s=o&-o,s===r.callbackPriority)return s;switch(u!==null&&rt(u),xi(o)){case 2:case 8:o=Gn;break;case 32:o=Zi;break;case 268435456:o=Eu;break;default:o=Zi}return u=Tv.bind(null,r),o=jt(o,u),r.callbackPriority=s,r.callbackNode=o,s}return u!==null&&u!==null&&rt(u),r.callbackPriority=2,r.callbackNode=null,2}function Tv(r,s){if(Jt!==0&&Jt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(jd()&&r.callbackNode!==o)return null;var u=We;return u=Hr(r,r===pt?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(av(r,u,s),Sv(r,Rt()),r.callbackNode!=null&&r.callbackNode===o?Tv.bind(null,r):null)}function Av(r,s){if(jd())return null;av(r,s,!0)}function gA(){RA(function(){(st&6)!==0?jt(Vt,pA):wv()})}function $m(){if(Ss===0){var r=bo;r===0&&(r=Fr,Fr<<=1,(Fr&261888)===0&&(Fr=256)),Ss=r}return Ss}function Cv(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:io(""+r)}function Rv(r,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,r.id&&o.setAttribute("form",r.id),s.parentNode.insertBefore(o,s),r=new FormData(r),o.parentNode.removeChild(o),r}function yA(r,s,o,u,p){if(s==="submit"&&o&&o.stateNode===p){var y=Cv((p[sn]||null).action),E=u.submitter;E&&(s=(s=E[sn]||null)?Cv(s.formAction):E.getAttribute("formAction"),s!==null&&(y=s,E=null));var j=new ti("action","action",null,u,p);r.push({event:j,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Ss!==0){var $=E?Rv(p,E):new FormData(p);hm(o,{pending:!0,data:$,method:p.method,action:y},null,$)}}else typeof y=="function"&&(j.preventDefault(),$=E?Rv(p,E):new FormData(p),hm(o,{pending:!0,data:$,method:p.method,action:y},y,$))},currentTarget:p}]})}}for(var Qm=0;Qm<Df.length;Qm++){var Wm=Df[Qm],_A=Wm.toLowerCase(),vA=Wm[0].toUpperCase()+Wm.slice(1);Mr(_A,"on"+vA)}Mr(s_,"onAnimationEnd"),Mr(a_,"onAnimationIteration"),Mr(o_,"onAnimationStart"),Mr("dblclick","onDoubleClick"),Mr("focusin","onFocus"),Mr("focusout","onBlur"),Mr(NT,"onTransitionRun"),Mr(PT,"onTransitionStart"),Mr(LT,"onTransitionCancel"),Mr(l_,"onTransitionEnd"),Xr("onMouseEnter",["mouseout","mouseover"]),Xr("onMouseLeave",["mouseout","mouseover"]),Xr("onPointerEnter",["pointerout","pointerover"]),Xr("onPointerLeave",["pointerout","pointerover"]),Yr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Yr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Yr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Yr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Yr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Yr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xc));function Dv(r,s){s=(s&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],p=u.event;u=u.listeners;e:{var y=void 0;if(s)for(var E=u.length-1;0<=E;E--){var j=u[E],$=j.instance,se=j.currentTarget;if(j=j.listener,$!==y&&p.isPropagationStopped())break e;y=j,p.currentTarget=se;try{y(p)}catch(pe){Wu(pe)}p.currentTarget=null,y=$}else for(E=0;E<u.length;E++){if(j=u[E],$=j.instance,se=j.currentTarget,j=j.listener,$!==y&&p.isPropagationStopped())break e;y=j,p.currentTarget=se;try{y(p)}catch(pe){Wu(pe)}p.currentTarget=null,y=$}}}}function Qe(r,s){var o=s[Za];o===void 0&&(o=s[Za]=new Set);var u=r+"__bubble";o.has(u)||(Iv(s,r,2,!1),o.add(u))}function Km(r,s,o){var u=0;s&&(u|=4),Iv(o,r,u,s)}var kd="_reactListening"+Math.random().toString(36).slice(2);function Ym(r){if(!r[kd]){r[kd]=!0,Ml.forEach(function(o){o!=="selectionchange"&&(bA.has(o)||Km(o,!1,r),Km(o,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[kd]||(s[kd]=!0,Km("selectionchange",!1,s))}}function Iv(r,s,o,u){switch(sb(s)){case 2:var p=WA;break;case 8:p=KA;break;default:p=dp}o=p.bind(null,s,o,r),p=void 0,!ua||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),u?p!==void 0?r.addEventListener(s,o,{capture:!0,passive:p}):r.addEventListener(s,o,!0):p!==void 0?r.addEventListener(s,o,{passive:p}):r.addEventListener(s,o,!1)}function Xm(r,s,o,u,p){var y=u;if((s&1)===0&&(s&2)===0&&u!==null)e:for(;;){if(u===null)return;var E=u.tag;if(E===3||E===4){var j=u.stateNode.containerInfo;if(j===p)break;if(E===4)for(E=u.return;E!==null;){var $=E.tag;if(($===3||$===4)&&E.stateNode.containerInfo===p)return;E=E.return}for(;j!==null;){if(E=Wr(j),E===null)return;if($=E.tag,$===5||$===6||$===26||$===27){u=y=E;continue e}j=j.parentNode}}u=u.return}ss(function(){var se=y,pe=lr(o),ye=[];e:{var le=c_.get(r);if(le!==void 0){var fe=ti,De=r;switch(r){case"keypress":if(ha(o)===0)break e;case"keydown":case"keyup":fe=Gu;break;case"focusin":De="focus",fe=ma;break;case"focusout":De="blur",fe=ma;break;case"beforeblur":case"afterblur":fe=ma;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=$l;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=Pu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=x;break;case s_:case a_:case o_:fe=Vu;break;case l_:fe=L;break;case"scroll":case"scrollend":fe=Gl;break;case"wheel":fe=ue;break;case"copy":case"cut":case"paste":fe=zu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Si;break;case"toggle":case"beforetoggle":fe=Fe}var ke=(s&4)!==0,ft=!ke&&(r==="scroll"||r==="scrollend"),Z=ke?le!==null?le+"Capture":null:le;ke=[];for(var X=se,ie;X!==null;){var ge=X;if(ie=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||ie===null||Z===null||(ge=Dr(X,Z),ge!=null&&ke.push(Ec(X,ge,ie))),ft)break;X=X.return}0<ke.length&&(le=new fe(le,De,null,o,pe),ye.push({event:le,listeners:ke}))}}if((s&7)===0){e:{if(le=r==="mouseover"||r==="pointerover",fe=r==="mouseout"||r==="pointerout",le&&o!==Fl&&(De=o.relatedTarget||o.fromElement)&&(Wr(De)||De[$r]))break e;if((fe||le)&&(le=pe.window===pe?pe:(le=pe.ownerDocument)?le.defaultView||le.parentWindow:window,fe?(De=o.relatedTarget||o.toElement,fe=se,De=De?Wr(De):null,De!==null&&(ft=l(De),ke=De.tag,De!==ft||ke!==5&&ke!==27&&ke!==6)&&(De=null)):(fe=null,De=se),fe!==De)){if(ke=$l,ge="onMouseLeave",Z="onMouseEnter",X="mouse",(r==="pointerout"||r==="pointerover")&&(ke=Si,ge="onPointerLeave",Z="onPointerEnter",X="pointer"),ft=fe==null?le:$n(fe),ie=De==null?le:$n(De),le=new ke(ge,X+"leave",fe,o,pe),le.target=ft,le.relatedTarget=ie,ge=null,Wr(pe)===se&&(ke=new ke(Z,X+"enter",De,o,pe),ke.target=ie,ke.relatedTarget=ft,ge=ke),ft=ge,fe&&De)t:{for(ke=xA,Z=fe,X=De,ie=0,ge=Z;ge;ge=ke(ge))ie++;ge=0;for(var je=X;je;je=ke(je))ge++;for(;0<ie-ge;)Z=ke(Z),ie--;for(;0<ge-ie;)X=ke(X),ge--;for(;ie--;){if(Z===X||X!==null&&Z===X.alternate){ke=Z;break t}Z=ke(Z),X=ke(X)}ke=null}else ke=null;fe!==null&&jv(ye,le,fe,ke,!1),De!==null&&ft!==null&&jv(ye,ft,De,ke,!0)}}e:{if(le=se?$n(se):window,fe=le.nodeName&&le.nodeName.toLowerCase(),fe==="select"||fe==="input"&&le.type==="file")var tt=Wy;else if($y(le))if(Ky)tt=OT;else{tt=IT;var Ie=DT}else fe=le.nodeName,!fe||fe.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?se&&ro(se.elementType)&&(tt=Wy):tt=jT;if(tt&&(tt=tt(r,se))){Qy(ye,tt,o,pe);break e}Ie&&Ie(r,le,se),r==="focusout"&&se&&le.type==="number"&&se.memoizedProps.value!=null&&zl(le,"number",le.value)}switch(Ie=se?$n(se):window,r){case"focusin":($y(Ie)||Ie.contentEditable==="true")&&(ho=Ie,Af=se,Xl=null);break;case"focusout":Xl=Af=ho=null;break;case"mousedown":Cf=!0;break;case"contextmenu":case"mouseup":case"dragend":Cf=!1,r_(ye,o,pe);break;case"selectionchange":if(kT)break;case"keydown":case"keyup":r_(ye,o,pe)}var He;if(it)e:{switch(r){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else uo?pa(r,o)&&(Ke="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ke="onCompositionStart");Ke&&(ii&&o.locale!=="ko"&&(uo||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&uo&&(He=Hl()):(ei=pe,ql="value"in ei?ei.value:ei.textContent,uo=!0)),Ie=Nd(se,Ke),0<Ie.length&&(Ke=new ri(Ke,r,null,o,pe),ye.push({event:Ke,listeners:Ie}),He?Ke.data=He:(He=co(o),He!==null&&(Ke.data=He)))),(He=ur?TT(r,o):AT(r,o))&&(Ke=Nd(se,"onBeforeInput"),0<Ke.length&&(Ie=new ri("onBeforeInput","beforeinput",null,o,pe),ye.push({event:Ie,listeners:Ke}),Ie.data=He)),yA(ye,r,se,o,pe)}Dv(ye,s)})}function Ec(r,s,o){return{instance:r,listener:s,currentTarget:o}}function Nd(r,s){for(var o=s+"Capture",u=[];r!==null;){var p=r,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Dr(r,o),p!=null&&u.unshift(Ec(r,p,y)),p=Dr(r,s),p!=null&&u.push(Ec(r,p,y))),r.tag===3)return u;r=r.return}return[]}function xA(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function jv(r,s,o,u,p){for(var y=s._reactName,E=[];o!==null&&o!==u;){var j=o,$=j.alternate,se=j.stateNode;if(j=j.tag,$!==null&&$===u)break;j!==5&&j!==26&&j!==27||se===null||($=se,p?(se=Dr(o,y),se!=null&&E.unshift(Ec(o,se,$))):p||(se=Dr(o,y),se!=null&&E.push(Ec(o,se,$)))),o=o.return}E.length!==0&&r.push({event:s,listeners:E})}var EA=/\r\n?/g,wA=/\u0000|\uFFFD/g;function Ov(r){return(typeof r=="string"?r:""+r).replace(EA,`
`).replace(wA,"")}function Mv(r,s){return s=Ov(s),Ov(r)===s}function ht(r,s,o,u,p,y){switch(o){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||Mn(r,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&Mn(r,""+u);break;case"className":Qn(r,"class",u);break;case"tabIndex":Qn(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Qn(r,o,u);break;case"style":Bl(r,u,y);break;case"data":if(s!=="object"){Qn(r,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=io(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&ht(r,s,"name",p.name,p,null),ht(r,s,"formEncType",p.formEncType,p,null),ht(r,s,"formMethod",p.formMethod,p,null),ht(r,s,"formTarget",p.formTarget,p,null)):(ht(r,s,"encType",p.encType,p,null),ht(r,s,"method",p.method,p,null),ht(r,s,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=io(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=Rr);break;case"onScroll":u!=null&&Qe("scroll",r);break;case"onScrollEnd":u!=null&&Qe("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=io(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":Qe("beforetoggle",r),Qe("toggle",r),to(r,"popover",u);break;case"xlinkActuate":Ft(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ft(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ft(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ft(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ft(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ft(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":to(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Nu.get(o)||o,to(r,o,u))}}function Jm(r,s,o,u,p,y){switch(o){case"style":Bl(r,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"children":typeof u=="string"?Mn(r,u):(typeof u=="number"||typeof u=="bigint")&&Mn(r,""+u);break;case"onScroll":u!=null&&Qe("scroll",r);break;case"onScrollEnd":u!=null&&Qe("scrollend",r);break;case"onClick":u!=null&&(r.onclick=Rr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!kl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),s=o.slice(2,p?o.length-7:void 0),y=r[sn]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(s,y,p),typeof u=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(s,u,p);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):to(r,o,u)}}}function yn(r,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qe("error",r),Qe("load",r);var u=!1,p=!1,y;for(y in o)if(o.hasOwnProperty(y)){var E=o[y];if(E!=null)switch(y){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ht(r,s,y,E,o,null)}}p&&ht(r,s,"srcSet",o.srcSet,o,null),u&&ht(r,s,"src",o.src,o,null);return;case"input":Qe("invalid",r);var j=y=E=p=null,$=null,se=null;for(u in o)if(o.hasOwnProperty(u)){var pe=o[u];if(pe!=null)switch(u){case"name":p=pe;break;case"type":E=pe;break;case"checked":$=pe;break;case"defaultChecked":se=pe;break;case"value":y=pe;break;case"defaultValue":j=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(i(137,s));break;default:ht(r,s,u,pe,o,null)}}Ou(r,y,j,$,se,E,p,!1);return;case"select":Qe("invalid",r),u=E=y=null;for(p in o)if(o.hasOwnProperty(p)&&(j=o[p],j!=null))switch(p){case"value":y=j;break;case"defaultValue":E=j;break;case"multiple":u=j;default:ht(r,s,p,j,o,null)}s=y,o=E,r.multiple=!!u,s!=null?ts(r,!!u,s,!1):o!=null&&ts(r,!!u,o,!0);return;case"textarea":Qe("invalid",r),y=p=u=null;for(E in o)if(o.hasOwnProperty(E)&&(j=o[E],j!=null))switch(E){case"value":u=j;break;case"defaultValue":p=j;break;case"children":y=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(i(91));break;default:ht(r,s,E,j,o,null)}ns(r,u,p,y);return;case"option":for($ in o)o.hasOwnProperty($)&&(u=o[$],u!=null)&&($==="selected"?r.selected=u&&typeof u!="function"&&typeof u!="symbol":ht(r,s,$,u,o,null));return;case"dialog":Qe("beforetoggle",r),Qe("toggle",r),Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":Qe("load",r);break;case"video":case"audio":for(u=0;u<xc.length;u++)Qe(xc[u],r);break;case"image":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"embed":case"source":case"link":Qe("error",r),Qe("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in o)if(o.hasOwnProperty(se)&&(u=o[se],u!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ht(r,s,se,u,o,null)}return;default:if(ro(s)){for(pe in o)o.hasOwnProperty(pe)&&(u=o[pe],u!==void 0&&Jm(r,s,pe,u,o,void 0));return}}for(j in o)o.hasOwnProperty(j)&&(u=o[j],u!=null&&ht(r,s,j,u,o,null))}function SA(r,s,o,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,E=null,j=null,$=null,se=null,pe=null;for(fe in o){var ye=o[fe];if(o.hasOwnProperty(fe)&&ye!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":$=ye;default:u.hasOwnProperty(fe)||ht(r,s,fe,null,u,ye)}}for(var le in u){var fe=u[le];if(ye=o[le],u.hasOwnProperty(le)&&(fe!=null||ye!=null))switch(le){case"type":y=fe;break;case"name":p=fe;break;case"checked":se=fe;break;case"defaultChecked":pe=fe;break;case"value":E=fe;break;case"defaultValue":j=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,s));break;default:fe!==ye&&ht(r,s,le,fe,u,ye)}}no(r,E,j,$,se,pe,y,p);return;case"select":fe=E=j=le=null;for(y in o)if($=o[y],o.hasOwnProperty(y)&&$!=null)switch(y){case"value":break;case"multiple":fe=$;default:u.hasOwnProperty(y)||ht(r,s,y,null,u,$)}for(p in u)if(y=u[p],$=o[p],u.hasOwnProperty(p)&&(y!=null||$!=null))switch(p){case"value":le=y;break;case"defaultValue":j=y;break;case"multiple":E=y;default:y!==$&&ht(r,s,p,y,u,$)}s=j,o=E,u=fe,le!=null?ts(r,!!o,le,!1):!!u!=!!o&&(s!=null?ts(r,!!o,s,!0):ts(r,!!o,o?[]:"",!1));return;case"textarea":fe=le=null;for(j in o)if(p=o[j],o.hasOwnProperty(j)&&p!=null&&!u.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:ht(r,s,j,null,u,p)}for(E in u)if(p=u[E],y=o[E],u.hasOwnProperty(E)&&(p!=null||y!=null))switch(E){case"value":le=p;break;case"defaultValue":fe=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==y&&ht(r,s,E,p,u,y)}Mu(r,le,fe);return;case"option":for(var De in o)le=o[De],o.hasOwnProperty(De)&&le!=null&&!u.hasOwnProperty(De)&&(De==="selected"?r.selected=!1:ht(r,s,De,null,u,le));for($ in u)le=u[$],fe=o[$],u.hasOwnProperty($)&&le!==fe&&(le!=null||fe!=null)&&($==="selected"?r.selected=le&&typeof le!="function"&&typeof le!="symbol":ht(r,s,$,le,u,fe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in o)le=o[ke],o.hasOwnProperty(ke)&&le!=null&&!u.hasOwnProperty(ke)&&ht(r,s,ke,null,u,le);for(se in u)if(le=u[se],fe=o[se],u.hasOwnProperty(se)&&le!==fe&&(le!=null||fe!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,s));break;default:ht(r,s,se,le,u,fe)}return;default:if(ro(s)){for(var ft in o)le=o[ft],o.hasOwnProperty(ft)&&le!==void 0&&!u.hasOwnProperty(ft)&&Jm(r,s,ft,void 0,u,le);for(pe in u)le=u[pe],fe=o[pe],!u.hasOwnProperty(pe)||le===fe||le===void 0&&fe===void 0||Jm(r,s,pe,le,u,fe);return}}for(var Z in o)le=o[Z],o.hasOwnProperty(Z)&&le!=null&&!u.hasOwnProperty(Z)&&ht(r,s,Z,null,u,le);for(ye in u)le=u[ye],fe=o[ye],!u.hasOwnProperty(ye)||le===fe||le==null&&fe==null||ht(r,s,ye,le,u,fe)}function kv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function TA(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var p=o[u],y=p.transferSize,E=p.initiatorType,j=p.duration;if(y&&j&&kv(E)){for(E=0,j=p.responseEnd,u+=1;u<o.length;u++){var $=o[u],se=$.startTime;if(se>j)break;var pe=$.transferSize,ye=$.initiatorType;pe&&kv(ye)&&($=$.responseEnd,E+=pe*($<j?1:(j-se)/($-se)))}if(--u,s+=8*(y+E)/(p.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Zm=null,ep=null;function Pd(r){return r.nodeType===9?r:r.ownerDocument}function Nv(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Pv(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function tp(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var np=null;function AA(){var r=window.event;return r&&r.type==="popstate"?r===np?!1:(np=r,!0):(np=null,!1)}var Lv=typeof setTimeout=="function"?setTimeout:void 0,CA=typeof clearTimeout=="function"?clearTimeout:void 0,Vv=typeof Promise=="function"?Promise:void 0,RA=typeof queueMicrotask=="function"?queueMicrotask:typeof Vv<"u"?function(r){return Vv.resolve(null).then(r).catch(DA)}:Lv;function DA(r){setTimeout(function(){throw r})}function Ts(r){return r==="head"}function zv(r,s){var o=s,u=0;do{var p=o.nextSibling;if(r.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(u===0){r.removeChild(p),zo(s);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")wc(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,wc(o);for(var y=o.firstChild;y;){var E=y.nextSibling,j=y.nodeName;y[Qr]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=E}}else o==="body"&&wc(r.ownerDocument.body);o=p}while(o);zo(s)}function Uv(r,s){var o=r;r=0;do{var u=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=u}while(o)}function rp(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":rp(o),eo(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function IA(r,s,o,u){for(;r.nodeType===1;){var p=o;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[Qr])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=yr(r.nextSibling),r===null)break}return null}function jA(r,s,o){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=yr(r.nextSibling),r===null))return null;return r}function Bv(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=yr(r.nextSibling),r===null))return null;return r}function ip(r){return r.data==="$?"||r.data==="$~"}function sp(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function OA(r,s){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||o.readyState!=="loading")s();else{var u=function(){s(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function yr(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var ap=null;function Fv(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(s===0)return yr(r.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}r=r.nextSibling}return null}function qv(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return r;s--}else o!=="/$"&&o!=="/&"||s++}r=r.previousSibling}return null}function Hv(r,s,o){switch(s=Pd(o),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function wc(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);eo(r)}var _r=new Map,Gv=new Set;function Ld(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var zi=Q.d;Q.d={f:MA,r:kA,D:NA,C:PA,L:LA,m:VA,X:UA,S:zA,M:BA};function MA(){var r=zi.f(),s=Rd();return r||s}function kA(r){var s=or(r);s!==null&&s.tag===5&&s.type==="form"?l0(s):zi.r(r)}var Po=typeof document>"u"?null:document;function $v(r,s,o){var u=Po;if(u&&typeof s=="string"&&s){var p=On(s);p='link[rel="'+r+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),Gv.has(p)||(Gv.add(p),r={rel:r,crossOrigin:o,href:s},u.querySelector(p)===null&&(s=u.createElement("link"),yn(s,"link",r),Bt(s),u.head.appendChild(s)))}}function NA(r){zi.D(r),$v("dns-prefetch",r,null)}function PA(r,s){zi.C(r,s),$v("preconnect",r,s)}function LA(r,s,o){zi.L(r,s,o);var u=Po;if(u&&r&&s){var p='link[rel="preload"][as="'+On(s)+'"]';s==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+On(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+On(o.imageSizes)+'"]')):p+='[href="'+On(r)+'"]';var y=p;switch(s){case"style":y=Lo(r);break;case"script":y=Vo(r)}_r.has(y)||(r=v({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:r,as:s},o),_r.set(y,r),u.querySelector(p)!==null||s==="style"&&u.querySelector(Sc(y))||s==="script"&&u.querySelector(Tc(y))||(s=u.createElement("link"),yn(s,"link",r),Bt(s),u.head.appendChild(s)))}}function VA(r,s){zi.m(r,s);var o=Po;if(o&&r){var u=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+On(u)+'"][href="'+On(r)+'"]',y=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Vo(r)}if(!_r.has(y)&&(r=v({rel:"modulepreload",href:r},s),_r.set(y,r),o.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Tc(y)))return}u=o.createElement("link"),yn(u,"link",r),Bt(u),o.head.appendChild(u)}}}function zA(r,s,o){zi.S(r,s,o);var u=Po;if(u&&r){var p=Kr(u).hoistableStyles,y=Lo(r);s=s||"default";var E=p.get(y);if(!E){var j={loading:0,preload:null};if(E=u.querySelector(Sc(y)))j.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":s},o),(o=_r.get(y))&&op(r,o);var $=E=u.createElement("link");Bt($),yn($,"link",r),$._p=new Promise(function(se,pe){$.onload=se,$.onerror=pe}),$.addEventListener("load",function(){j.loading|=1}),$.addEventListener("error",function(){j.loading|=2}),j.loading|=4,Vd(E,s,u)}E={type:"stylesheet",instance:E,count:1,state:j},p.set(y,E)}}}function UA(r,s){zi.X(r,s);var o=Po;if(o&&r){var u=Kr(o).hoistableScripts,p=Vo(r),y=u.get(p);y||(y=o.querySelector(Tc(p)),y||(r=v({src:r,async:!0},s),(s=_r.get(p))&&lp(r,s),y=o.createElement("script"),Bt(y),yn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(p,y))}}function BA(r,s){zi.M(r,s);var o=Po;if(o&&r){var u=Kr(o).hoistableScripts,p=Vo(r),y=u.get(p);y||(y=o.querySelector(Tc(p)),y||(r=v({src:r,async:!0,type:"module"},s),(s=_r.get(p))&&lp(r,s),y=o.createElement("script"),Bt(y),yn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(p,y))}}function Qv(r,s,o,u){var p=(p=he.current)?Ld(p):null;if(!p)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Lo(o.href),o=Kr(p).hoistableStyles,u=o.get(s),u||(u={type:"style",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=Lo(o.href);var y=Kr(p).hoistableStyles,E=y.get(r);if(E||(p=p.ownerDocument||p,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,E),(y=p.querySelector(Sc(r)))&&!y._p&&(E.instance=y,E.state.loading=5),_r.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},_r.set(r,o),y||FA(p,r,o,E.state))),s&&u===null)throw Error(i(528,""));return E}if(s&&u!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Vo(o),o=Kr(p).hoistableScripts,u=o.get(s),u||(u={type:"script",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Lo(r){return'href="'+On(r)+'"'}function Sc(r){return'link[rel="stylesheet"]['+r+"]"}function Wv(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function FA(r,s,o,u){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=r.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),yn(s,"link",o),Bt(s),r.head.appendChild(s))}function Vo(r){return'[src="'+On(r)+'"]'}function Tc(r){return"script[async]"+r}function Kv(r,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var u=r.querySelector('style[data-href~="'+On(o.href)+'"]');if(u)return s.instance=u,Bt(u),u;var p=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),Bt(u),yn(u,"style",p),Vd(u,o.precedence,r),s.instance=u;case"stylesheet":p=Lo(o.href);var y=r.querySelector(Sc(p));if(y)return s.state.loading|=4,s.instance=y,Bt(y),y;u=Wv(o),(p=_r.get(p))&&op(u,p),y=(r.ownerDocument||r).createElement("link"),Bt(y);var E=y;return E._p=new Promise(function(j,$){E.onload=j,E.onerror=$}),yn(y,"link",u),s.state.loading|=4,Vd(y,o.precedence,r),s.instance=y;case"script":return y=Vo(o.src),(p=r.querySelector(Tc(y)))?(s.instance=p,Bt(p),p):(u=o,(p=_r.get(y))&&(u=v({},o),lp(u,p)),r=r.ownerDocument||r,p=r.createElement("script"),Bt(p),yn(p,"link",u),r.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(u=s.instance,s.state.loading|=4,Vd(u,o.precedence,r));return s.instance}function Vd(r,s,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,y=p,E=0;E<u.length;E++){var j=u[E];if(j.dataset.precedence===s)y=j;else if(y!==p)break}y?y.parentNode.insertBefore(r,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(r,s.firstChild))}function op(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function lp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var zd=null;function Yv(r,s,o){if(zd===null){var u=new Map,p=zd=new Map;p.set(o,u)}else p=zd,u=p.get(o),u||(u=new Map,p.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),p=0;p<o.length;p++){var y=o[p];if(!(y[Qr]||y[Ut]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var E=y.getAttribute(s)||"";E=r+E;var j=u.get(E);j?j.push(y):u.set(E,[y])}}return u}function Xv(r,s,o){r=r.ownerDocument||r,r.head.insertBefore(o,s==="title"?r.querySelector("head > title"):null)}function qA(r,s,o){if(o===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Jv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function HA(r,s,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=Lo(u.href),y=s.querySelector(Sc(p));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=Ud.bind(r),s.then(r,r)),o.state.loading|=4,o.instance=y,Bt(y);return}y=s.ownerDocument||s,u=Wv(u),(p=_r.get(p))&&op(u,p),y=y.createElement("link"),Bt(y);var E=y;E._p=new Promise(function(j,$){E.onload=j,E.onerror=$}),yn(y,"link",u),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=Ud.bind(r),s.addEventListener("load",o),s.addEventListener("error",o))}}var cp=0;function GA(r,s){return r.stylesheets&&r.count===0&&Fd(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var u=setTimeout(function(){if(r.stylesheets&&Fd(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+s);0<r.imgBytes&&cp===0&&(cp=62500*TA());var p=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Fd(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>cp?50:800)+s);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(p)}}:null}function Ud(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Fd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Bd=null;function Fd(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Bd=new Map,s.forEach($A,r),Bd=null,Ud.call(r))}function $A(r,s){if(!(s.state.loading&4)){var o=Bd.get(r);if(o)var u=o.get(null);else{o=new Map,Bd.set(r,o);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var E=p[y];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),u=E)}u&&o.set(null,u)}p=s.instance,E=p.getAttribute("data-precedence"),y=o.get(E)||u,y===u&&o.set(null,p),o.set(E,p),this.count++,u=Ud.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),y?y.parentNode.insertBefore(p,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),s.state.loading|=4}}var Ac={$$typeof:z,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function QA(r,s,o,u,p,y,E,j,$){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Gr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gr(0),this.hiddenUpdates=Gr(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=$,this.incompleteTransitions=new Map}function Zv(r,s,o,u,p,y,E,j,$,se,pe,ye){return r=new QA(r,s,o,E,$,se,pe,ye,j),s=1,y===!0&&(s|=24),y=Kn(3,null,null,s),r.current=y,y.stateNode=r,s=Ff(),s.refCount++,r.pooledCache=s,s.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:s},$f(y),r}function eb(r){return r?(r=po,r):po}function tb(r,s,o,u,p,y){p=eb(p),u.context===null?u.context=p:u.pendingContext=p,u=ms(s),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=ps(r,u,s),o!==null&&(Vn(o,r,s),ic(o,r,s))}function nb(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<s?o:s}}function up(r,s){nb(r,s),(r=r.alternate)&&nb(r,s)}function rb(r){if(r.tag===13||r.tag===31){var s=_a(r,67108864);s!==null&&Vn(s,r,67108864),up(r,67108864)}}function ib(r){if(r.tag===13||r.tag===31){var s=er();s=aa(s);var o=_a(r,s);o!==null&&Vn(o,r,s),up(r,s)}}var qd=!0;function WA(r,s,o,u){var p=V.T;V.T=null;var y=Q.p;try{Q.p=2,dp(r,s,o,u)}finally{Q.p=y,V.T=p}}function KA(r,s,o,u){var p=V.T;V.T=null;var y=Q.p;try{Q.p=8,dp(r,s,o,u)}finally{Q.p=y,V.T=p}}function dp(r,s,o,u){if(qd){var p=hp(u);if(p===null)Xm(r,s,u,Hd,o),ab(r,u);else if(XA(p,r,s,o,u))u.stopPropagation();else if(ab(r,u),s&4&&-1<YA.indexOf(r)){for(;p!==null;){var y=or(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var E=qr(y.pendingLanes);if(E!==0){var j=y;for(j.pendingLanes|=2,j.entangledLanes|=2;E;){var $=1<<31-Ot(E);j.entanglements[1]|=$,E&=~$}li(y),(st&6)===0&&(Ad=Rt()+500,bc(0))}}break;case 31:case 13:j=_a(y,2),j!==null&&Vn(j,y,2),Rd(),up(y,2)}if(y=hp(u),y===null&&Xm(r,s,u,Hd,o),y===p)break;p=y}p!==null&&u.stopPropagation()}else Xm(r,s,u,null,o)}}function hp(r){return r=lr(r),fp(r)}var Hd=null;function fp(r){if(Hd=null,r=Wr(r),r!==null){var s=l(r);if(s===null)r=null;else{var o=s.tag;if(o===13){if(r=c(s),r!==null)return r;r=null}else if(o===31){if(r=h(s),r!==null)return r;r=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return Hd=r,null}function sb(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Hn()){case Vt:return 2;case Gn:return 8;case Zi:case vf:return 32;case Eu:return 268435456;default:return 32}default:return 32}}var mp=!1,As=null,Cs=null,Rs=null,Cc=new Map,Rc=new Map,Ds=[],YA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ab(r,s){switch(r){case"focusin":case"focusout":As=null;break;case"dragenter":case"dragleave":Cs=null;break;case"mouseover":case"mouseout":Rs=null;break;case"pointerover":case"pointerout":Cc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rc.delete(s.pointerId)}}function Dc(r,s,o,u,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[p]},s!==null&&(s=or(s),s!==null&&rb(s)),r):(r.eventSystemFlags|=u,s=r.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),r)}function XA(r,s,o,u,p){switch(s){case"focusin":return As=Dc(As,r,s,o,u,p),!0;case"dragenter":return Cs=Dc(Cs,r,s,o,u,p),!0;case"mouseover":return Rs=Dc(Rs,r,s,o,u,p),!0;case"pointerover":var y=p.pointerId;return Cc.set(y,Dc(Cc.get(y)||null,r,s,o,u,p)),!0;case"gotpointercapture":return y=p.pointerId,Rc.set(y,Dc(Rc.get(y)||null,r,s,o,u,p)),!0}return!1}function ob(r){var s=Wr(r.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){r.blockedOn=s,Ar(r.priority,function(){ib(o)});return}}else if(s===31){if(s=h(o),s!==null){r.blockedOn=s,Ar(r.priority,function(){ib(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Gd(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var o=hp(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);Fl=u,o.target.dispatchEvent(u),Fl=null}else return s=or(o),s!==null&&rb(s),r.blockedOn=o,!1;s.shift()}return!0}function lb(r,s,o){Gd(r)&&o.delete(s)}function JA(){mp=!1,As!==null&&Gd(As)&&(As=null),Cs!==null&&Gd(Cs)&&(Cs=null),Rs!==null&&Gd(Rs)&&(Rs=null),Cc.forEach(lb),Rc.forEach(lb)}function $d(r,s){r.blockedOn===s&&(r.blockedOn=null,mp||(mp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,JA)))}var Qd=null;function cb(r){Qd!==r&&(Qd=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Qd===r&&(Qd=null);for(var s=0;s<r.length;s+=3){var o=r[s],u=r[s+1],p=r[s+2];if(typeof u!="function"){if(fp(u||o)===null)continue;break}var y=or(o);y!==null&&(r.splice(s,3),s-=3,hm(y,{pending:!0,data:p,method:o.method,action:u},u,p))}}))}function zo(r){function s($){return $d($,r)}As!==null&&$d(As,r),Cs!==null&&$d(Cs,r),Rs!==null&&$d(Rs,r),Cc.forEach(s),Rc.forEach(s);for(var o=0;o<Ds.length;o++){var u=Ds[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<Ds.length&&(o=Ds[0],o.blockedOn===null);)ob(o),o.blockedOn===null&&Ds.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var p=o[u],y=o[u+1],E=p[sn]||null;if(typeof y=="function")E||cb(o);else if(E){var j=null;if(y&&y.hasAttribute("formAction")){if(p=y,E=y[sn]||null)j=E.formAction;else if(fp(p)!==null)continue}else j=E.action;typeof j=="function"?o[u+1]=j:(o.splice(u,3),u-=3),cb(o)}}}function ub(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(E){return p=E})},focusReset:"manual",scroll:"manual"})}function s(){p!==null&&(p(),p=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,p=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),p!==null&&(p(),p=null)}}}function pp(r){this._internalRoot=r}Wd.prototype.render=pp.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,u=er();tb(o,u,r,s,null,null)},Wd.prototype.unmount=pp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;tb(r.current,2,null,r,null,null),Rd(),s[$r]=null}};function Wd(r){this._internalRoot=r}Wd.prototype.unstable_scheduleHydration=function(r){if(r){var s=Ru();r={blockedOn:null,target:r,priority:s};for(var o=0;o<Ds.length&&s!==0&&s<Ds[o].priority;o++);Ds.splice(o,0,r),o===0&&ob(r)}};var db=e.version;if(db!=="19.2.3")throw Error(i(527,db,"19.2.3"));Q.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=g(s),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var ZA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kd.isDisabled&&Kd.supportsFiber)try{Sr=Kd.inject(ZA),hn=Kd}catch{}}return jc.createRoot=function(r,s){if(!a(r))throw Error(i(299));var o=!1,u="",p=_0,y=v0,E=b0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(E=s.onRecoverableError)),s=Zv(r,1,!1,null,null,o,u,null,p,y,E,ub),r[$r]=s.current,Ym(r),new pp(s)},jc.hydrateRoot=function(r,s,o){if(!a(r))throw Error(i(299));var u=!1,p="",y=_0,E=v0,j=b0,$=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(j=o.onRecoverableError),o.formState!==void 0&&($=o.formState)),s=Zv(r,1,!0,s,o??null,u,p,$,y,E,j,ub),s.context=eb(null),o=s.current,u=er(),u=aa(u),p=ms(u),p.callback=null,ps(o,p,u),o=u,s.current.lanes=o,ia(s,o),li(s),r[$r]=s.current,Ym(r),new Wd(s)},jc.version="19.2.3",jc}var xb;function cC(){if(xb)return _p.exports;xb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),_p.exports=lC(),_p.exports}var uC=cC();var Eb="popstate";function dC(t={}){function e(i,a){let{pathname:l,search:c,hash:h}=i.location;return Bp("",{pathname:l,search:c,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:$c(a)}return fC(e,n,null,t)}function St(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function nr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function hC(){return Math.random().toString(36).substring(2,10)}function wb(t,e){return{usr:t.state,key:t.key,idx:e}}function Bp(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?hl(e):e,state:n,key:e&&e.key||i||hC()}}function $c({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function hl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function fC(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,h="POP",m=null,g=_();g==null&&(g=0,c.replaceState({...c.state,idx:g},""));function _(){return(c.state||{idx:null}).idx}function v(){h="POP";let M=_(),F=M==null?null:M-g;g=M,m&&m({action:h,location:S.location,delta:F})}function b(M,F){h="PUSH";let H=Bp(S.location,M,F);g=_()+1;let z=wb(H,g),ee=S.createHref(H);try{c.pushState(z,"",ee)}catch(J){if(J instanceof DOMException&&J.name==="DataCloneError")throw J;a.location.assign(ee)}l&&m&&m({action:h,location:S.location,delta:1})}function w(M,F){h="REPLACE";let H=Bp(S.location,M,F);g=_();let z=wb(H,g),ee=S.createHref(H);c.replaceState(z,"",ee),l&&m&&m({action:h,location:S.location,delta:0})}function A(M){return mC(M)}let S={get action(){return h},get location(){return t(a,c)},listen(M){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Eb,v),m=M,()=>{a.removeEventListener(Eb,v),m=null}},createHref(M){return e(a,M)},createURL:A,encodeLocation(M){let F=A(M);return{pathname:F.pathname,search:F.search,hash:F.hash}},push:b,replace:w,go(M){return c.go(M)}};return S}function mC(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),St(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:$c(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function UE(t,e,n="/"){return pC(t,e,n,!1)}function pC(t,e,n,i){let a=typeof e=="string"?hl(e):e,l=Gi(a.pathname||"/",n);if(l==null)return null;let c=BE(t);gC(c);let h=null;for(let m=0;h==null&&m<c.length;++m){let g=CC(l);h=TC(c[m],g,i)}return h}function BE(t,e=[],n=[],i="",a=!1){let l=(c,h,m=a,g)=>{let _={relativePath:g===void 0?c.path||"":g,caseSensitive:c.caseSensitive===!0,childrenIndex:h,route:c};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&m)return;St(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let v=qi([i,_.relativePath]),b=n.concat(_);c.children&&c.children.length>0&&(St(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),BE(c.children,e,b,v,m)),!(c.path==null&&!c.index)&&e.push({path:v,score:wC(v,c.index),routesMeta:b})};return t.forEach((c,h)=>{if(c.path===""||!c.path?.includes("?"))l(c,h);else for(let m of FE(c.path))l(c,h,!0,m)}),e}function FE(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=FE(i.join("/")),h=[];return h.push(...c.map(m=>m===""?l:[l,m].join("/"))),a&&h.push(...c),h.map(m=>t.startsWith("/")&&m===""?"/":m)}function gC(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:SC(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var yC=/^:[\w-]+$/,_C=3,vC=2,bC=1,xC=10,EC=-2,Sb=t=>t==="*";function wC(t,e){let n=t.split("/"),i=n.length;return n.some(Sb)&&(i+=EC),e&&(i+=vC),n.filter(a=>!Sb(a)).reduce((a,l)=>a+(yC.test(l)?_C:l===""?bC:xC),i)}function SC(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function TC(t,e,n=!1){let{routesMeta:i}=t,a={},l="/",c=[];for(let h=0;h<i.length;++h){let m=i[h],g=h===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",v=_h({path:m.relativePath,caseSensitive:m.caseSensitive,end:g},_),b=m.route;if(!v&&g&&n&&!i[i.length-1].route.index&&(v=_h({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},_)),!v)return null;Object.assign(a,v.params),c.push({params:a,pathname:qi([l,v.pathname]),pathnameBase:jC(qi([l,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(l=qi([l,v.pathnameBase]))}return c}function _h(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=AC(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:i.reduce((g,{paramName:_,isOptional:v},b)=>{if(_==="*"){let A=h[b]||"";c=l.slice(0,l.length-A.length).replace(/(.)\/+$/,"$1")}const w=h[b];return v&&!w?g[_]=void 0:g[_]=(w||"").replace(/%2F/g,"/"),g},{}),pathname:l,pathnameBase:c,pattern:t}}function AC(t,e=!1,n=!0){nr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,h,m)=>(i.push({paramName:h,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function CC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return nr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Gi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var qE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,RC=t=>qE.test(t);function DC(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?hl(t):t,l;if(n)if(RC(n))l=n;else{if(n.includes("//")){let c=n;n=n.replace(/\/\/+/g,"/"),nr(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${n}`)}n.startsWith("/")?l=Tb(n.substring(1),"/"):l=Tb(n,e)}else l=e;return{pathname:l,search:OC(i),hash:MC(a)}}function Tb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Ep(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function IC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Ig(t){let e=IC(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function jg(t,e,n,i=!1){let a;typeof t=="string"?a=hl(t):(a={...t},St(!a.pathname||!a.pathname.includes("?"),Ep("?","pathname","search",a)),St(!a.pathname||!a.pathname.includes("#"),Ep("#","pathname","hash",a)),St(!a.search||!a.search.includes("#"),Ep("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,h;if(c==null)h=n;else{let v=e.length-1;if(!i&&c.startsWith("..")){let b=c.split("/");for(;b[0]==="..";)b.shift(),v-=1;a.pathname=b.join("/")}h=v>=0?e[v]:"/"}let m=DC(a,h),g=c&&c!=="/"&&c.endsWith("/"),_=(l||c===".")&&n.endsWith("/");return!m.pathname.endsWith("/")&&(g||_)&&(m.pathname+="/"),m}var qi=t=>t.join("/").replace(/\/\/+/g,"/"),jC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),OC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,MC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,kC=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function NC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function PC(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var HE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function GE(t,e){let n=t;if(typeof n!="string"||!qE.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if(HE)try{let l=new URL(window.location.href),c=n.startsWith("//")?new URL(l.protocol+n):new URL(n),h=Gi(c.pathname,e);c.origin===l.origin&&h!=null?n=h+c.search+c.hash:a=!0}catch{nr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var $E=["POST","PUT","PATCH","DELETE"];new Set($E);var LC=["GET",...$E];new Set(LC);var fl=C.createContext(null);fl.displayName="DataRouter";var qh=C.createContext(null);qh.displayName="DataRouterState";var VC=C.createContext(!1),QE=C.createContext({isTransitioning:!1});QE.displayName="ViewTransition";var zC=C.createContext(new Map);zC.displayName="Fetchers";var UC=C.createContext(null);UC.displayName="Await";var rr=C.createContext(null);rr.displayName="Navigation";var ru=C.createContext(null);ru.displayName="Location";var Er=C.createContext({outlet:null,matches:[],isDataRoute:!1});Er.displayName="Route";var Og=C.createContext(null);Og.displayName="RouteError";var WE="REACT_ROUTER_ERROR",BC="REDIRECT",FC="ROUTE_ERROR_RESPONSE";function qC(t){if(t.startsWith(`${WE}:${BC}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function HC(t){if(t.startsWith(`${WE}:${FC}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new kC(e.status,e.statusText,e.data)}catch{}}function GC(t,{relative:e}={}){St(ml(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=C.useContext(rr),{hash:a,pathname:l,search:c}=su(t,{relative:e}),h=l;return n!=="/"&&(h=l==="/"?n:qi([n,l])),i.createHref({pathname:h,search:c,hash:a})}function ml(){return C.useContext(ru)!=null}function jn(){return St(ml(),"useLocation() may be used only in the context of a <Router> component."),C.useContext(ru).location}var KE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function YE(t){C.useContext(rr).static||C.useLayoutEffect(t)}function iu(){let{isDataRoute:t}=C.useContext(Er);return t?oR():$C()}function $C(){St(ml(),"useNavigate() may be used only in the context of a <Router> component.");let t=C.useContext(fl),{basename:e,navigator:n}=C.useContext(rr),{matches:i}=C.useContext(Er),{pathname:a}=jn(),l=JSON.stringify(Ig(i)),c=C.useRef(!1);return YE(()=>{c.current=!0}),C.useCallback((m,g={})=>{if(nr(c.current,KE),!c.current)return;if(typeof m=="number"){n.go(m);return}let _=jg(m,JSON.parse(l),a,g.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:qi([e,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[e,n,l,a,t])}var QC=C.createContext(null);function WC(t){let e=C.useContext(Er).outlet;return C.useMemo(()=>e&&C.createElement(QC.Provider,{value:t},e),[e,t])}function KC(){let{matches:t}=C.useContext(Er),e=t[t.length-1];return e?e.params:{}}function su(t,{relative:e}={}){let{matches:n}=C.useContext(Er),{pathname:i}=jn(),a=JSON.stringify(Ig(n));return C.useMemo(()=>jg(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function YC(t,e){return XE(t,e)}function XE(t,e,n,i,a){St(ml(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=C.useContext(rr),{matches:c}=C.useContext(Er),h=c[c.length-1],m=h?h.params:{},g=h?h.pathname:"/",_=h?h.pathnameBase:"/",v=h&&h.route;{let H=v&&v.path||"";ZE(g,!v||H.endsWith("*")||H.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${H}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${H}"> to <Route path="${H==="/"?"*":`${H}/*`}">.`)}let b=jn(),w;if(e){let H=typeof e=="string"?hl(e):e;St(_==="/"||H.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${H.pathname}" was given in the \`location\` prop.`),w=H}else w=b;let A=w.pathname||"/",S=A;if(_!=="/"){let H=_.replace(/^\//,"").split("/");S="/"+A.replace(/^\//,"").split("/").slice(H.length).join("/")}let M=UE(t,{pathname:S});nr(v||M!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),nr(M==null||M[M.length-1].route.element!==void 0||M[M.length-1].route.Component!==void 0||M[M.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let F=tR(M&&M.map(H=>Object.assign({},H,{params:Object.assign({},m,H.params),pathname:qi([_,l.encodeLocation?l.encodeLocation(H.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathname]),pathnameBase:H.pathnameBase==="/"?_:qi([_,l.encodeLocation?l.encodeLocation(H.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathnameBase])})),c,n,i,a);return e&&F?C.createElement(ru.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},F):F}function XC(){let t=aR(),e=NC(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=C.createElement(C.Fragment,null,C.createElement("p",null," Hey developer "),C.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",C.createElement("code",{style:l},"ErrorBoundary")," or"," ",C.createElement("code",{style:l},"errorElement")," prop on your route.")),C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),n?C.createElement("pre",{style:a},n):null,c)}var JC=C.createElement(XC,null),JE=class extends C.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=HC(t.digest);n&&(t=n)}let e=t!==void 0?C.createElement(Er.Provider,{value:this.props.routeContext},C.createElement(Og.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?C.createElement(ZC,{error:t},e):e}};JE.contextType=VC;var wp=new WeakMap;function ZC({children:t,error:e}){let{basename:n}=C.useContext(rr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=qC(e.digest);if(i){let a=wp.get(e);if(a)throw a;let l=GE(i.location,n);if(HE&&!wp.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw wp.set(e,c),c}return C.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function eR({routeContext:t,match:e,children:n}){let i=C.useContext(fl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),C.createElement(Er.Provider,{value:t},n)}function tR(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=n?.errors;if(c!=null){let _=l.findIndex(v=>v.route.id&&c?.[v.route.id]!==void 0);St(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let h=!1,m=-1;if(n)for(let _=0;_<l.length;_++){let v=l[_];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(m=_),v.route.id){let{loaderData:b,errors:w}=n,A=v.route.loader&&!b.hasOwnProperty(v.route.id)&&(!w||w[v.route.id]===void 0);if(v.route.lazy||A){h=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}let g=n&&i?(_,v)=>{i(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:PC(n.matches),errorInfo:v})}:void 0;return l.reduceRight((_,v,b)=>{let w,A=!1,S=null,M=null;n&&(w=c&&v.route.id?c[v.route.id]:void 0,S=v.route.errorElement||JC,h&&(m<0&&b===0?(ZE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,M=null):m===b&&(A=!0,M=v.route.hydrateFallbackElement||null)));let F=e.concat(l.slice(0,b+1)),H=()=>{let z;return w?z=S:A?z=M:v.route.Component?z=C.createElement(v.route.Component,null):v.route.element?z=v.route.element:z=_,C.createElement(eR,{match:v,routeContext:{outlet:_,matches:F,isDataRoute:n!=null},children:z})};return n&&(v.route.ErrorBoundary||v.route.errorElement||b===0)?C.createElement(JE,{location:n.location,revalidation:n.revalidation,component:S,error:w,children:H(),routeContext:{outlet:null,matches:F,isDataRoute:!0},onError:g}):H()},null)}function Mg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function nR(t){let e=C.useContext(fl);return St(e,Mg(t)),e}function rR(t){let e=C.useContext(qh);return St(e,Mg(t)),e}function iR(t){let e=C.useContext(Er);return St(e,Mg(t)),e}function kg(t){let e=iR(t),n=e.matches[e.matches.length-1];return St(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function sR(){return kg("useRouteId")}function aR(){let t=C.useContext(Og),e=rR("useRouteError"),n=kg("useRouteError");return t!==void 0?t:e.errors?.[n]}function oR(){let{router:t}=nR("useNavigate"),e=kg("useNavigate"),n=C.useRef(!1);return YE(()=>{n.current=!0}),C.useCallback(async(a,l={})=>{nr(n.current,KE),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var Ab={};function ZE(t,e,n){!e&&!Ab[t]&&(Ab[t]=!0,nr(!1,n))}C.memo(lR);function lR({routes:t,future:e,state:n,onError:i}){return XE(t,void 0,n,i,e)}function Hh({to:t,replace:e,state:n,relative:i}){St(ml(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=C.useContext(rr);nr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=C.useContext(Er),{pathname:c}=jn(),h=iu(),m=jg(t,Ig(l),c,i==="path"),g=JSON.stringify(m);return C.useEffect(()=>{h(JSON.parse(g),{replace:e,state:n,relative:i})},[h,g,i,e,n]),null}function Gh(t){return WC(t.context)}function Qt(t){St(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function cR({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){St(!ml(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=t.replace(/^\/*/,"/"),m=C.useMemo(()=>({basename:h,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[h,a,l,c]);typeof n=="string"&&(n=hl(n));let{pathname:g="/",search:_="",hash:v="",state:b=null,key:w="default"}=n,A=C.useMemo(()=>{let S=Gi(g,h);return S==null?null:{location:{pathname:S,search:_,hash:v,state:b,key:w},navigationType:i}},[h,g,_,v,b,w,i]);return nr(A!=null,`<Router basename="${h}"> is not able to match the URL "${g}${_}${v}" because it does not start with the basename, so the <Router> won't render anything.`),A==null?null:C.createElement(rr.Provider,{value:m},C.createElement(ru.Provider,{children:e,value:A}))}function uR({children:t,location:e}){return YC(Fp(t),e)}function Fp(t,e=[]){let n=[];return C.Children.forEach(t,(i,a)=>{if(!C.isValidElement(i))return;let l=[...e,a];if(i.type===C.Fragment){n.push.apply(n,Fp(i.props.children,l));return}St(i.type===Qt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),St(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Fp(i.props.children,l)),n.push(c)}),n}var ih="get",sh="application/x-www-form-urlencoded";function $h(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function dR(t){return $h(t)&&t.tagName.toLowerCase()==="button"}function hR(t){return $h(t)&&t.tagName.toLowerCase()==="form"}function fR(t){return $h(t)&&t.tagName.toLowerCase()==="input"}function mR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function pR(t,e){return t.button===0&&(!e||e==="_self")&&!mR(t)}function qp(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(a=>[n,a]):[[n,i]])},[]))}function gR(t,e){let n=qp(t);return e&&e.forEach((i,a)=>{n.has(a)||e.getAll(a).forEach(l=>{n.append(a,l)})}),n}var Yd=null;function yR(){if(Yd===null)try{new FormData(document.createElement("form"),0),Yd=!1}catch{Yd=!0}return Yd}var _R=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Sp(t){return t!=null&&!_R.has(t)?(nr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${sh}"`),null):t}function vR(t,e){let n,i,a,l,c;if(hR(t)){let h=t.getAttribute("action");i=h?Gi(h,e):null,n=t.getAttribute("method")||ih,a=Sp(t.getAttribute("enctype"))||sh,l=new FormData(t)}else if(dR(t)||fR(t)&&(t.type==="submit"||t.type==="image")){let h=t.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=t.getAttribute("formaction")||h.getAttribute("action");if(i=m?Gi(m,e):null,n=t.getAttribute("formmethod")||h.getAttribute("method")||ih,a=Sp(t.getAttribute("formenctype"))||Sp(h.getAttribute("enctype"))||sh,l=new FormData(h,t),!yR()){let{name:g,type:_,value:v}=t;if(_==="image"){let b=g?`${g}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else g&&l.append(g,v)}}else{if($h(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ih,i=null,a=sh,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ng(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function bR(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Gi(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function xR(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ER(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function wR(t,e,n){let i=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let c=await xR(l,n);return c.links?c.links():[]}return[]}));return CR(i.flat(1).filter(ER).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Cb(t,e,n,i,a,l){let c=(m,g)=>n[g]?m.route.id!==n[g].route.id:!0,h=(m,g)=>n[g].pathname!==m.pathname||n[g].route.path?.endsWith("*")&&n[g].params["*"]!==m.params["*"];return l==="assets"?e.filter((m,g)=>c(m,g)||h(m,g)):l==="data"?e.filter((m,g)=>{let _=i.routes[m.route.id];if(!_||!_.hasLoader)return!1;if(c(m,g)||h(m,g))return!0;if(m.route.shouldRevalidate){let v=m.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function SR(t,e,{includeHydrateFallback:n}={}){return TR(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function TR(t){return[...new Set(t)]}function AR(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function CR(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let l=JSON.stringify(AR(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function ew(){let t=C.useContext(fl);return Ng(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function RR(){let t=C.useContext(qh);return Ng(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Pg=C.createContext(void 0);Pg.displayName="FrameworkContext";function tw(){let t=C.useContext(Pg);return Ng(t,"You must render this element inside a <HydratedRouter> element"),t}function DR(t,e){let n=C.useContext(Pg),[i,a]=C.useState(!1),[l,c]=C.useState(!1),{onFocus:h,onBlur:m,onMouseEnter:g,onMouseLeave:_,onTouchStart:v}=e,b=C.useRef(null);C.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let S=F=>{F.forEach(H=>{c(H.isIntersecting)})},M=new IntersectionObserver(S,{threshold:.5});return b.current&&M.observe(b.current),()=>{M.disconnect()}}},[t]),C.useEffect(()=>{if(i){let S=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(S)}}},[i]);let w=()=>{a(!0)},A=()=>{a(!1),c(!1)};return n?t!=="intent"?[l,b,{}]:[l,b,{onFocus:Oc(h,w),onBlur:Oc(m,A),onMouseEnter:Oc(g,w),onMouseLeave:Oc(_,A),onTouchStart:Oc(v,w)}]:[!1,b,{}]}function Oc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function IR({page:t,...e}){let{router:n}=ew(),i=C.useMemo(()=>UE(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?C.createElement(OR,{page:t,matches:i,...e}):null}function jR(t){let{manifest:e,routeModules:n}=tw(),[i,a]=C.useState([]);return C.useEffect(()=>{let l=!1;return wR(t,e,n).then(c=>{l||a(c)}),()=>{l=!0}},[t,e,n]),i}function OR({page:t,matches:e,...n}){let i=jn(),{manifest:a,routeModules:l}=tw(),{basename:c}=ew(),{loaderData:h,matches:m}=RR(),g=C.useMemo(()=>Cb(t,e,m,a,i,"data"),[t,e,m,a,i]),_=C.useMemo(()=>Cb(t,e,m,a,i,"assets"),[t,e,m,a,i]),v=C.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let A=new Set,S=!1;if(e.forEach(F=>{let H=a.routes[F.route.id];!H||!H.hasLoader||(!g.some(z=>z.route.id===F.route.id)&&F.route.id in h&&l[F.route.id]?.shouldRevalidate||H.hasClientLoader?S=!0:A.add(F.route.id))}),A.size===0)return[];let M=bR(t,c,"data");return S&&A.size>0&&M.searchParams.set("_routes",e.filter(F=>A.has(F.route.id)).map(F=>F.route.id).join(",")),[M.pathname+M.search]},[c,h,i,a,g,e,t,l]),b=C.useMemo(()=>SR(_,a),[_,a]),w=jR(_);return C.createElement(C.Fragment,null,v.map(A=>C.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...n})),b.map(A=>C.createElement("link",{key:A,rel:"modulepreload",href:A,...n})),w.map(({key:A,link:S})=>C.createElement("link",{key:A,nonce:n.nonce,...S})))}function MR(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var kR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{kR&&(window.__reactRouterVersion="7.11.0")}catch{}function NR({basename:t,children:e,unstable_useTransitions:n,window:i}){let a=C.useRef();a.current==null&&(a.current=dC({window:i,v5Compat:!0}));let l=a.current,[c,h]=C.useState({action:l.action,location:l.location}),m=C.useCallback(g=>{n===!1?h(g):C.startTransition(()=>h(g))},[n]);return C.useLayoutEffect(()=>l.listen(m),[l,m]),C.createElement(cR,{basename:t,children:e,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:n})}var nw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tt=C.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,state:h,target:m,to:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...w},A){let{basename:S,unstable_useTransitions:M}=C.useContext(rr),F=typeof g=="string"&&nw.test(g),H=GE(g,S);g=H.to;let z=GC(g,{relative:a}),[ee,J,me]=DR(i,w),P=zR(g,{replace:c,state:h,target:m,preventScrollReset:_,relative:a,viewTransition:v,unstable_defaultShouldRevalidate:b,unstable_useTransitions:M});function D(N){e&&e(N),N.defaultPrevented||P(N)}let I=C.createElement("a",{...w,...me,href:H.absoluteURL||z,onClick:H.isExternal||l?e:D,ref:MR(A,J),target:m,"data-discover":!F&&n==="render"?"true":void 0});return ee&&!F?C.createElement(C.Fragment,null,I,C.createElement(IR,{page:z})):I});Tt.displayName="Link";var PR=C.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:h,children:m,...g},_){let v=su(c,{relative:g.relative}),b=jn(),w=C.useContext(qh),{navigator:A,basename:S}=C.useContext(rr),M=w!=null&&GR(v)&&h===!0,F=A.encodeLocation?A.encodeLocation(v).pathname:v.pathname,H=b.pathname,z=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||(H=H.toLowerCase(),z=z?z.toLowerCase():null,F=F.toLowerCase()),z&&S&&(z=Gi(z,S)||z);const ee=F!=="/"&&F.endsWith("/")?F.length-1:F.length;let J=H===F||!a&&H.startsWith(F)&&H.charAt(ee)==="/",me=z!=null&&(z===F||!a&&z.startsWith(F)&&z.charAt(F.length)==="/"),P={isActive:J,isPending:me,isTransitioning:M},D=J?e:void 0,I;typeof i=="function"?I=i(P):I=[i,J?"active":null,me?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let N=typeof l=="function"?l(P):l;return C.createElement(Tt,{...g,"aria-current":D,className:I,ref:_,style:N,to:c,viewTransition:h},typeof m=="function"?m(P):m)});PR.displayName="NavLink";var LR=C.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:l,method:c=ih,action:h,onSubmit:m,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...w},A)=>{let{unstable_useTransitions:S}=C.useContext(rr),M=qR(),F=HR(h,{relative:g}),H=c.toLowerCase()==="get"?"get":"post",z=typeof h=="string"&&nw.test(h),ee=J=>{if(m&&m(J),J.defaultPrevented)return;J.preventDefault();let me=J.nativeEvent.submitter,P=me?.getAttribute("formmethod")||c,D=()=>M(me||J.currentTarget,{fetcherKey:e,method:P,navigate:n,replace:a,state:l,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b});S&&n!==!1?C.startTransition(()=>D()):D()};return C.createElement("form",{ref:A,method:H,action:F,onSubmit:i?m:ee,...w,"data-discover":!z&&t==="render"?"true":void 0})});LR.displayName="Form";function VR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rw(t){let e=C.useContext(fl);return St(e,VR(t)),e}function zR(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:h,unstable_useTransitions:m}={}){let g=iu(),_=jn(),v=su(t,{relative:l});return C.useCallback(b=>{if(pR(b,e)){b.preventDefault();let w=n!==void 0?n:$c(_)===$c(v),A=()=>g(t,{replace:w,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:h});m?C.startTransition(()=>A()):A()}},[_,g,v,n,i,e,t,a,l,c,h,m])}function UR(t){nr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=C.useRef(qp(t)),n=C.useRef(!1),i=jn(),a=C.useMemo(()=>gR(i.search,n.current?null:e.current),[i.search]),l=iu(),c=C.useCallback((h,m)=>{const g=qp(typeof h=="function"?h(new URLSearchParams(a)):h);n.current=!0,l("?"+g,m)},[l,a]);return[a,c]}var BR=0,FR=()=>`__${String(++BR)}__`;function qR(){let{router:t}=rw("useSubmit"),{basename:e}=C.useContext(rr),n=sR(),i=t.fetch,a=t.navigate;return C.useCallback(async(l,c={})=>{let{action:h,method:m,encType:g,formData:_,body:v}=vR(l,e);if(c.navigate===!1){let b=c.fetcherKey||FR();await i(b,n,c.action||h,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||m,formEncType:c.encType||g,flushSync:c.flushSync})}else await a(c.action||h,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||m,formEncType:c.encType||g,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,e,n])}function HR(t,{relative:e}={}){let{basename:n}=C.useContext(rr),i=C.useContext(Er);St(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...su(t||".",{relative:e})},c=jn();if(t==null){l.search=c.search;let h=new URLSearchParams(l.search),m=h.getAll("index");if(m.some(_=>_==="")){h.delete("index"),m.filter(v=>v).forEach(v=>h.append("index",v));let _=h.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:qi([n,l.pathname])),$c(l)}function GR(t,{relative:e}={}){let n=C.useContext(QE);St(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=rw("useViewTransitionState"),a=su(t,{relative:e});if(!n.isTransitioning)return!1;let l=Gi(n.currentLocation.pathname,i)||n.currentLocation.pathname,c=Gi(n.nextLocation.pathname,i)||n.nextLocation.pathname;return _h(a.pathname,c)!=null||_h(a.pathname,l)!=null}const $R={isLoading:!1,loadingMessage:"Loading...",addLoadingHold:()=>{},removeLoadingHold:()=>{}},iw=C.createContext($R);function QR({children:t}){const[e,n]=C.useState(new Map),i=C.useCallback((m,g)=>{n(_=>new Map(_).set(m,g))},[]),a=C.useCallback(m=>{n(g=>{const _=new Map(g);return _.delete(m),_})},[]),l=e.size>0,c=e.size>0&&Array.from(e.values()).pop()||"Loading...",h={isLoading:l,loadingMessage:c,addLoadingHold:i,removeLoadingHold:a};return d.jsx(iw.Provider,{value:h,children:t})}function Bn(){const t=C.useContext(iw);if(!t)throw new Error("useApp must be used within an AppProvider");return t}const WR=function(){},KR={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:WR},au=C.createContext(KR);var pl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},YR={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},XR=class{#e=YR;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Ui=new XR;function JR(t){setTimeout(t,0)}var Na=typeof window>"u"||"Deno"in globalThis;function Zt(){}function ZR(t,e){return typeof t=="function"?t(e):t}function Hp(t){return typeof t=="number"&&t>=0&&t!==1/0}function sw(t,e){return Math.max(t+(e||0)-Date.now(),0)}function zs(t,e){return typeof t=="function"?t(e):t}function vr(t,e){return typeof t=="function"?t(e):t}function Rb(t,e){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:c,stale:h}=t;if(c){if(i){if(e.queryHash!==Lg(c,e.options))return!1}else if(!Qc(e.queryKey,c))return!1}if(n!=="all"){const m=e.isActive();if(n==="active"&&!m||n==="inactive"&&m)return!1}return!(typeof h=="boolean"&&e.isStale()!==h||a&&a!==e.state.fetchStatus||l&&!l(e))}function Db(t,e){const{exact:n,status:i,predicate:a,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(Pa(e.options.mutationKey)!==Pa(l))return!1}else if(!Qc(e.options.mutationKey,l))return!1}return!(i&&e.state.status!==i||a&&!a(e))}function Lg(t,e){return(e?.queryKeyHashFn||Pa)(t)}function Pa(t){return JSON.stringify(t,(e,n)=>Gp(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function Qc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Qc(t[n],e[n])):!1}var eD=Object.prototype.hasOwnProperty;function aw(t,e){if(t===e)return t;const n=Ib(t)&&Ib(e);if(!n&&!(Gp(t)&&Gp(e)))return e;const a=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),c=l.length,h=n?new Array(c):{};let m=0;for(let g=0;g<c;g++){const _=n?g:l[g],v=t[_],b=e[_];if(v===b){h[_]=v,(n?g<a:eD.call(t,_))&&m++;continue}if(v===null||b===null||typeof v!="object"||typeof b!="object"){h[_]=b;continue}const w=aw(v,b);h[_]=w,w===v&&m++}return a===c&&m===a?t:h}function vh(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Ib(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Gp(t){if(!jb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!jb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function jb(t){return Object.prototype.toString.call(t)==="[object Object]"}function tD(t){return new Promise(e=>{Ui.setTimeout(e,t)})}function $p(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?aw(t,e):e}function nD(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function rD(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var Vg=Symbol();function ow(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Vg?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function lw(t,e){return typeof t=="function"?t(...e):!!t}var iD=class extends pl{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!Na&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},zg=new iD;function Qp(){let t,e;const n=new Promise((a,l)=>{t=a,e=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),e(a)},n}function sD(t){let e;if(t.then(n=>(e=n,n),Zt)?.catch(Zt),e!==void 0)return{data:e}}function cw(t){return t}function aD(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function oD(t,e,n){const i=()=>{const a=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return a?.catch(Zt),a};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:i()},...t.meta&&{meta:t.meta}}}function lD(t){return t.state.isPaused}function cD(t){return t.state.status==="success"}function uD(t){return!0}function dD(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??lD,i=t.getMutationCache().getAll().flatMap(m=>n(m)?[aD(m)]:[]),a=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??cD,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??uD,c=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??cw,h=t.getQueryCache().getAll().flatMap(m=>a(m)?[oD(m,c,l)]:[]);return{mutations:i,queries:h}}function hD(t,e,n){if(typeof e!="object"||e===null)return;const i=t.getMutationCache(),a=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??cw,c=e.mutations||[],h=e.queries||[];c.forEach(({state:m,...g})=>{i.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...g},m)}),h.forEach(({queryKey:m,state:g,queryHash:_,meta:v,promise:b,dehydratedAt:w})=>{const A=b?sD(b):void 0,S=g.data===void 0?A?.data:g.data,M=S===void 0?S:l(S);let F=a.get(_);const H=F?.state.status==="pending",z=F?.state.fetchStatus==="fetching";if(F){const ee=A&&w!==void 0&&w>F.state.dataUpdatedAt;if(g.dataUpdatedAt>F.state.dataUpdatedAt||ee){const{fetchStatus:J,...me}=g;F.setState({...me,data:M})}}else F=a.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:m,queryHash:_,meta:v},{...g,data:M,fetchStatus:"idle",status:M!==void 0?"success":g.status});b&&!H&&!z&&(w===void 0||w>F.state.dataUpdatedAt)&&F.fetch(void 0,{initialPromise:Promise.resolve(b).then(l)}).catch(Zt)})}var fD=JR;function mD(){let t=[],e=0,n=h=>{h()},i=h=>{h()},a=fD;const l=h=>{e?t.push(h):a(()=>{n(h)})},c=()=>{const h=t;t=[],h.length&&a(()=>{i(()=>{h.forEach(m=>{n(m)})})})};return{batch:h=>{let m;e++;try{m=h()}finally{e--,e||c()}return m},batchCalls:h=>(...m)=>{l(()=>{h(...m)})},schedule:l,setNotifyFunction:h=>{n=h},setBatchNotifyFunction:h=>{i=h},setScheduler:h=>{a=h}}}var en=mD(),pD=class extends pl{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!Na&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},bh=new pD;function gD(t){return Math.min(1e3*2**t,3e4)}function uw(t){return(t??"online")==="online"?bh.isOnline():!0}var Wp=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function dw(t){let e=!1,n=0,i;const a=Qp(),l=()=>a.status!=="pending",c=S=>{if(!l()){const M=new Wp(S);b(M),t.onCancel?.(M)}},h=()=>{e=!0},m=()=>{e=!1},g=()=>zg.isFocused()&&(t.networkMode==="always"||bh.isOnline())&&t.canRun(),_=()=>uw(t.networkMode)&&t.canRun(),v=S=>{l()||(i?.(),a.resolve(S))},b=S=>{l()||(i?.(),a.reject(S))},w=()=>new Promise(S=>{i=M=>{(l()||g())&&S(M)},t.onPause?.()}).then(()=>{i=void 0,l()||t.onContinue?.()}),A=()=>{if(l())return;let S;const M=n===0?t.initialPromise:void 0;try{S=M??t.fn()}catch(F){S=Promise.reject(F)}Promise.resolve(S).then(v).catch(F=>{if(l())return;const H=t.retry??(Na?0:3),z=t.retryDelay??gD,ee=typeof z=="function"?z(n,F):z,J=H===!0||typeof H=="number"&&n<H||typeof H=="function"&&H(n,F);if(e||!J){b(F);return}n++,t.onFail?.(n,F),tD(ee).then(()=>g()?void 0:w()).then(()=>{e?b(F):A()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(i?.(),a),cancelRetry:h,continueRetry:m,canStart:_,start:()=>(_()?A():w().then(A),a)}}var hw=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Hp(this.gcTime)&&(this.#e=Ui.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Na?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Ui.clearTimeout(this.#e),this.#e=void 0)}},yD=class extends hw{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=Mb(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Mb(this.options);n.data!==void 0&&(this.setState(Ob(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const i=$p(this.state.data,e,this.options);return this.#s({data:i,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),i}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then(Zt).catch(Zt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>vr(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Vg||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>zs(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!sw(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const m=this.observers.find(g=>g.options.queryFn);m&&this.setOptions(m.options)}const i=new AbortController,a=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(this.#o=!0,i.signal)})},l=()=>{const m=ow(this.options,n),_=(()=>{const v={client:this.#i,queryKey:this.queryKey,meta:this.meta};return a(v),v})();return this.#o=!1,this.options.persister?this.options.persister(m,_,this):m(_)},h=(()=>{const m={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return a(m),m})();this.options.behavior?.onFetch(h,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==h.fetchOptions?.meta)&&this.#s({type:"fetch",meta:h.fetchOptions?.meta}),this.#r=dw({initialPromise:n?.initialPromise,fn:h.fetchFn,onCancel:m=>{m instanceof Wp&&m.revert&&this.setState({...this.#t,fetchStatus:"idle"}),i.abort()},onFail:(m,g)=>{this.#s({type:"failed",failureCount:m,error:g})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0});try{const m=await this.#r.start();if(m===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(m),this.#n.config.onSuccess?.(m,this),this.#n.config.onSettled?.(m,this.state.error,this),m}catch(m){if(m instanceof Wp){if(m.silent)return this.#r.promise;if(m.revert){if(this.state.data===void 0)throw m;return this.state.data}}throw this.#s({type:"error",error:m}),this.#n.config.onError?.(m,this),this.#n.config.onSettled?.(this.state.data,m,this),m}finally{this.scheduleGc()}}#s(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...fw(i.data,this.options),fetchMeta:e.meta??null};case"success":const a={...i,...Ob(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const l=e.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),en.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function fw(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:uw(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Ob(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Mb(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var _D=class extends pl{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=Qp(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),kb(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Kp(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Kp(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#x(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof vr(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#E(),this.#t.setOptions(this.options),e._defaulted&&!vh(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&Nb(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),i&&(this.#t!==n||vr(this.options.enabled,this.#t)!==vr(e.enabled,this.#t)||zs(this.options.staleTime,this.#t)!==zs(e.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||vr(this.options.enabled,this.#t)!==vr(e.enabled,this.#t)||a!==this.#l)&&this.#_(a)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return bD(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),e?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#E();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Zt)),e}#g(){this.#b();const t=zs(this.options.staleTime,this.#t);if(Na||this.#i.isStale||!Hp(t))return;const n=sw(this.#i.dataUpdatedAt,t)+1;this.#c=Ui.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#x(),this.#l=t,!(Na||vr(this.options.enabled,this.#t)===!1||!Hp(this.#l)||this.#l===0)&&(this.#u=Ui.setInterval(()=>{(this.options.refetchIntervalInBackground||zg.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#b(){this.#c&&(Ui.clearTimeout(this.#c),this.#c=void 0)}#x(){this.#u&&(Ui.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,i=this.options,a=this.#i,l=this.#r,c=this.#a,m=t!==n?t.state:this.#n,{state:g}=t;let _={...g},v=!1,b;if(e._optimisticResults){const D=this.hasListeners(),I=!D&&kb(t,e),N=D&&Nb(t,n,e,i);(I||N)&&(_={..._,...fw(g.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:w,errorUpdatedAt:A,status:S}=_;b=_.data;let M=!1;if(e.placeholderData!==void 0&&b===void 0&&S==="pending"){let D;a?.isPlaceholderData&&e.placeholderData===c?.placeholderData?(D=a.data,M=!0):D=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,D!==void 0&&(S="success",b=$p(a?.data,D,e),v=!0)}if(e.select&&b!==void 0&&!M)if(a&&b===l?.data&&e.select===this.#p)b=this.#h;else try{this.#p=e.select,b=e.select(b),b=$p(a?.data,b,e),this.#h=b,this.#s=null}catch(D){this.#s=D}this.#s&&(w=this.#s,b=this.#h,A=Date.now(),S="error");const F=_.fetchStatus==="fetching",H=S==="pending",z=S==="error",ee=H&&F,J=b!==void 0,P={status:S,fetchStatus:_.fetchStatus,isPending:H,isSuccess:S==="success",isError:z,isInitialLoading:ee,isLoading:ee,data:b,dataUpdatedAt:_.dataUpdatedAt,error:w,errorUpdatedAt:A,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>m.dataUpdateCount||_.errorUpdateCount>m.errorUpdateCount,isFetching:F,isRefetching:F&&!H,isLoadingError:z&&!J,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:z&&J,isStale:Ug(t,e),refetch:this.refetch,promise:this.#o,isEnabled:vr(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const D=O=>{P.status==="error"?O.reject(P.error):P.data!==void 0&&O.resolve(P.data)},I=()=>{const O=this.#o=P.promise=Qp();D(O)},N=this.#o;switch(N.status){case"pending":t.queryHash===n.queryHash&&D(N);break;case"fulfilled":(P.status==="error"||P.data!==N.value)&&I();break;case"rejected":(P.status!=="error"||P.error!==N.reason)&&I();break}}return P}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),vh(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(c=>{const h=c;return this.#i[h]!==t[h]&&l.has(h)})};this.#w({listeners:n()})}#E(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#w(t){en.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function vD(t,e){return vr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function kb(t,e){return vD(t,e)||t.state.data!==void 0&&Kp(t,e,e.refetchOnMount)}function Kp(t,e,n){if(vr(e.enabled,t)!==!1&&zs(e.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&Ug(t,e)}return!1}function Nb(t,e,n,i){return(t!==e||vr(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Ug(t,n)}function Ug(t,e){return vr(e.enabled,t)!==!1&&t.isStaleByTime(zs(e.staleTime,t))}function bD(t,e){return!vh(t.getCurrentResult(),e)}function Pb(t){return{onFetch:(e,n)=>{const i=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],c=e.state.data?.pageParams||[];let h={pages:[],pageParams:[]},m=0;const g=async()=>{let _=!1;const v=A=>{Object.defineProperty(A,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},b=ow(e.options,e.fetchOptions),w=async(A,S,M)=>{if(_)return Promise.reject();if(S==null&&A.pages.length)return Promise.resolve(A);const H=(()=>{const me={client:e.client,queryKey:e.queryKey,pageParam:S,direction:M?"backward":"forward",meta:e.options.meta};return v(me),me})(),z=await b(H),{maxPages:ee}=e.options,J=M?rD:nD;return{pages:J(A.pages,z,ee),pageParams:J(A.pageParams,S,ee)}};if(a&&l.length){const A=a==="backward",S=A?xD:Lb,M={pages:l,pageParams:c},F=S(i,M);h=await w(M,F,A)}else{const A=t??l.length;do{const S=m===0?c[0]??i.initialPageParam:Lb(i,h);if(m>0&&S==null)break;h=await w(h,S),m++}while(m<A)}return h};e.options.persister?e.fetchFn=()=>e.options.persister?.(g,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=g}}}function Lb(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function xD(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var ED=class extends hw{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||mw(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=dw({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(c,h)=>{this.#r({type:"failed",failureCount:c,error:h})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",l=!this.#i.canStart();try{if(a)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,i);const h=await this.options.onMutate?.(e,i);h!==this.state.context&&this.#r({type:"pending",context:h,variables:e,isPaused:l})}const c=await this.#i.start();return await this.#n.config.onSuccess?.(c,e,this.state.context,this,i),await this.options.onSuccess?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(c,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(c,null,e,this.state.context,i),this.#r({type:"success",data:c}),c}catch(c){try{throw await this.#n.config.onError?.(c,e,this.state.context,this,i),await this.options.onError?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(void 0,c,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,c,e,this.state.context,i),c}finally{this.#r({type:"error",error:c})}}finally{this.#n.runNext(this)}}#r(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),en.batch(()=>{this.#t.forEach(i=>{i.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function mw(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var wD=class extends pl{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const i=new ED({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){this.#e.add(t);const e=Xd(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Xd(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Xd(t);if(typeof e=="string"){const i=this.#t.get(e)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const e=Xd(t);return typeof e=="string"?this.#t.get(e)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){en.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Db(e,n))}findAll(t={}){return this.getAll().filter(e=>Db(t,e))}notify(t){en.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return en.batch(()=>Promise.all(t.map(e=>e.continue().catch(Zt))))}};function Xd(t){return t.options.scope?.id}var SD=class extends pl{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),vh(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&Pa(n.mutationKey)!==Pa(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??mw();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){en.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,i,a),this.#i.onSettled?.(e.data,null,n,i,a)):e?.type==="error"&&(this.#i.onError?.(e.error,n,i,a),this.#i.onSettled?.(void 0,e.error,n,i,a))}this.listeners.forEach(n=>{n(this.#t)})})}},TD=class extends pl{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const i=e.queryKey,a=e.queryHash??Lg(i,e);let l=this.get(a);return l||(l=new yD({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){en.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Rb(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>Rb(t,n)):e}notify(t){en.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){en.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){en.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},AD=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new TD,this.#t=t.mutationCache||new wD,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=zg.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=bh.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(zs(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(i.queryHash)?.state.data,c=ZR(e,l);if(c!==void 0)return this.#e.build(this,i).setData(c,{...n,manual:!0})}setQueriesData(t,e,n){return en.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;en.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return en.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=en.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then(Zt).catch(Zt)}invalidateQueries(t,e={}){return en.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=en.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(Zt)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(Zt)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(zs(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Zt).catch(Zt)}fetchInfiniteQuery(t){return t.behavior=Pb(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Zt).catch(Zt)}ensureInfiniteQueryData(t){return t.behavior=Pb(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return bh.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Pa(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(i=>{Qc(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Pa(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(i=>{Qc(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Lg(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Vg&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},pw=C.createContext(void 0),rn=t=>{const e=C.useContext(pw);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},CD=({client:t,children:e})=>(C.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),d.jsx(pw.Provider,{value:t,children:e})),gw=C.createContext(!1),RD=()=>C.useContext(gw),DD=gw.Provider;function ID(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var jD=C.createContext(ID()),OD=()=>C.useContext(jD),MD=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},kD=t=>{C.useEffect(()=>{t.clearReset()},[t])},ND=({result:t,errorResetBoundary:e,throwOnError:n,query:i,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||lw(n,[t.error,i])),PD=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},LD=(t,e)=>t.isLoading&&t.isFetching&&!e,VD=(t,e)=>t?.suspense&&e.isPending,Vb=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function zD(t,e,n){const i=RD(),a=OD(),l=rn(),c=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c),c._optimisticResults=i?"isRestoring":"optimistic",PD(c),MD(c,a),kD(a);const h=!l.getQueryCache().get(c.queryHash),[m]=C.useState(()=>new e(l,c)),g=m.getOptimisticResult(c),_=!i&&t.subscribed!==!1;if(C.useSyncExternalStore(C.useCallback(v=>{const b=_?m.subscribe(en.batchCalls(v)):Zt;return m.updateResult(),b},[m,_]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),C.useEffect(()=>{m.setOptions(c)},[c,m]),VD(c,g))throw Vb(c,m,a);if(ND({result:g,errorResetBoundary:a,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw g.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,g),c.experimental_prefetchInRender&&!Na&&LD(g,i)&&(h?Vb(c,m,a):l.getQueryCache().get(c.queryHash)?.promise)?.catch(Zt).finally(()=>{m.updateResult()}),c.notifyOnChangeProps?g:m.trackResult(g)}function gl(t,e){return zD(t,_D)}function ir(t,e){const n=rn(),[i]=C.useState(()=>new SD(n,t));C.useEffect(()=>{i.setOptions(t)},[i,t]);const a=C.useSyncExternalStore(C.useCallback(c=>i.subscribe(en.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=C.useCallback((c,h)=>{i.mutate(c,h).catch(Zt)},[i]);if(a.error&&lw(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}function Yp(){}function UD(t,{interval:e=1e3,onError:n=Yp}={}){if(typeof t!="function")throw new Error("argument is not function.");let i=0,a=null,l=!1,c=!1;return async(...h)=>{if(a=h,!c){for(c=!0;l;)await new Promise(m=>Ui.setTimeout(m,e));for(;Date.now()<i;)await new Promise(m=>Ui.setTimeout(m,i-Date.now()));c=!1,l=!0;try{await t(...a)}catch(m){try{n(m)}catch{}}i=Date.now()+e,l=!1}}}var BD=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:i=JSON.stringify,deserialize:a=JSON.parse,retry:l})=>{if(t){const c=async h=>{try{const m=await i(h);await t.setItem(e,m);return}catch(m){return m}};return{persistClient:UD(async h=>{let m=h,g=await c(m),_=0;for(;g&&m;)_++,m=await l?.({persistedClient:m,error:g,errorCount:_}),m&&(g=await c(m))},{interval:n}),restoreClient:async()=>{const h=await t.getItem(e);if(h)return await a(h)},removeClient:()=>t.removeItem(e)}}return{persistClient:Yp,restoreClient:()=>Promise.resolve(void 0),removeClient:Yp}};const yw=300*1e3,FD=1440*60*1e3,mt=new AD({defaultOptions:{queries:{staleTime:yw,gcTime:FD,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}});mt.getQueryCache().subscribe(t=>{const e=t?.query;if(e&&t.type==="updated"){const{state:n}=e;n.status==="error"&&n.error&&console.error("[RQ] Query FAILED:",e.queryKey,n.error)}});const qD=BD({storage:typeof window<"u"?{getItem:t=>Promise.resolve(localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(localStorage.removeItem(t))}:void 0,key:"BUDGET_APP_QUERY_CACHE"}),Ee={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};var HD=["added","removed","updated"];function zb(t){return HD.includes(t)}async function GD({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:i="",hydrateOptions:a}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const c=Date.now()-l.timestamp>n,h=l.buster!==i;if(c||h)return e.removeClient();hD(t,l.clientState,a)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function Ub({queryClient:t,persister:e,buster:n="",dehydrateOptions:i}){const a={buster:n,timestamp:Date.now(),clientState:dD(t,i)};await e.persistClient(a)}function $D(t){const e=t.queryClient.getQueryCache().subscribe(i=>{zb(i.type)&&Ub(t)}),n=t.queryClient.getMutationCache().subscribe(i=>{zb(i.type)&&Ub(t)});return()=>{e(),n()}}var QD=({children:t,persistOptions:e,onSuccess:n,onError:i,...a})=>{const[l,c]=C.useState(!0),h=C.useRef({persistOptions:e,onSuccess:n,onError:i}),m=C.useRef(!1);return C.useEffect(()=>{h.current={persistOptions:e,onSuccess:n,onError:i}}),C.useEffect(()=>{const g={...h.current.persistOptions,queryClient:a.client};return m.current||(m.current=!0,GD(g).then(()=>h.current.onSuccess?.()).catch(()=>h.current.onError?.()).finally(()=>{c(!1)})),l?void 0:$D(g)},[a.client,l]),d.jsx(CD,{...a,children:d.jsx(DD,{value:l,children:t})})};function WD({children:t}){return d.jsx(QD,{client:mt,persistOptions:{persister:qD,maxAge:1440*60*1e3,buster:"v1"},children:t})}const KD=()=>{};var Bb={};const _w=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},YD=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],c=t[n++],h=t[n++],m=((a&7)<<18|(l&63)<<12|(c&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(m>>10)),e[i++]=String.fromCharCode(56320+(m&1023))}else{const l=t[n++],c=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},vw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],c=a+1<t.length,h=c?t[a+1]:0,m=a+2<t.length,g=m?t[a+2]:0,_=l>>2,v=(l&3)<<4|h>>4;let b=(h&15)<<2|g>>6,w=g&63;m||(w=64,c||(b=64)),i.push(n[_],n[v],n[b],n[w])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_w(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):YD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],h=a<t.length?n[t.charAt(a)]:0;++a;const g=a<t.length?n[t.charAt(a)]:64;++a;const v=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||h==null||g==null||v==null)throw new XD;const b=l<<2|h>>4;if(i.push(b),g!==64){const w=h<<4&240|g>>2;if(i.push(w),v!==64){const A=g<<6&192|v;i.push(A)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class XD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JD=function(t){const e=_w(t);return vw.encodeByteArray(e,!0)},xh=function(t){return JD(t).replace(/\./g,"")},bw=function(t){try{return vw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ZD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const eI=()=>ZD().__FIREBASE_DEFAULTS__,tI=()=>{if(typeof process>"u"||typeof Bb>"u")return;const t=Bb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},nI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&bw(t[1]);return e&&JSON.parse(e)},Qh=()=>{try{return KD()||eI()||tI()||nI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},xw=t=>Qh()?.emulatorHosts?.[t],rI=t=>{const e=xw(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},Ew=()=>Qh()?.config,ww=t=>Qh()?.[`_${t}`];class iI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function yl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Sw(t){return(await fetch(t,{credentials:"include"})).ok}function sI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[xh(JSON.stringify(n)),xh(JSON.stringify(c)),""].join(".")}const zc={};function aI(){const t={prod:[],emulator:[]};for(const e of Object.keys(zc))zc[e]?t.emulator.push(e):t.prod.push(e);return t}function oI(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Fb=!1;function Tw(t,e){if(typeof window>"u"||typeof document>"u"||!yl(window.location.host)||zc[t]===e||zc[t]||Fb)return;zc[t]=e;function n(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=aI().prod.length>0;function c(){const b=document.getElementById(i);b&&b.remove()}function h(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function m(b,w){b.setAttribute("width","24"),b.setAttribute("id",w),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function g(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{Fb=!0,c()},b}function _(b,w){b.setAttribute("id",w),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function v(){const b=oI(i),w=n("text"),A=document.getElementById(w)||document.createElement("span"),S=n("learnmore"),M=document.getElementById(S)||document.createElement("a"),F=n("preprendIcon"),H=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const z=b.element;h(z),_(M,S);const ee=g();m(H,F),z.append(H,A,M,ee),document.body.appendChild(z)}l?(A.innerText="Preview backend disconnected.",H.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(H.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function An(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function lI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(An())}function cI(){const t=Qh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function uI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function dI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function hI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fI(){const t=An();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function mI(){return!cI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pI(){try{return typeof indexedDB=="object"}catch{return!1}}function gI(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const yI="FirebaseError";class Yi extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=yI,Object.setPrototypeOf(this,Yi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ou.prototype.create)}}class ou{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?_I(l,i):"Error",h=`${this.serviceName}: ${c} (${a}).`;return new Yi(a,h,i)}}function _I(t,e){return t.replace(vI,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const vI=/\{\$([^}]+)}/g;function bI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function $s(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],c=e[a];if(qb(l)&&qb(c)){if(!$s(l,c))return!1}else if(l!==c)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function qb(t){return t!==null&&typeof t=="object"}function lu(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Mc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function kc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function xI(t,e){const n=new EI(t,e);return n.subscribe.bind(n)}class EI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");wI(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=Tp),a.error===void 0&&(a.error=Tp),a.complete===void 0&&(a.complete=Tp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Tp(){}function cn(t){return t&&t._delegate?t._delegate:t}class La{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ja="[DEFAULT]";class SI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new iI;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AI(e))try{this.getOrInitializeService({instanceIdentifier:ja})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=ja){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ja){return this.instances.has(e)}getOptions(e=ja){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(l);i===h&&c.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:TI(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ja){return this.component?this.component.multipleInstances?e:ja:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function TI(t){return t===ja?void 0:t}function AI(t){return t.instantiationMode==="EAGER"}class CI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new SI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ye||(Ye={}));const RI={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},DI=Ye.INFO,II={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},jI=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=II[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Bg{constructor(e){this.name=e,this._logLevel=DI,this._logHandler=jI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}const OI=(t,e)=>e.some(n=>t instanceof n);let Hb,Gb;function MI(){return Hb||(Hb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function kI(){return Gb||(Gb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Aw=new WeakMap,Xp=new WeakMap,Cw=new WeakMap,Ap=new WeakMap,Fg=new WeakMap;function NI(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",c)},l=()=>{n(Us(t.result)),a()},c=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",c)});return e.then(n=>{n instanceof IDBCursor&&Aw.set(n,t)}).catch(()=>{}),Fg.set(e,t),e}function PI(t){if(Xp.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",c),t.removeEventListener("abort",c)},l=()=>{n(),a()},c=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",c),t.addEventListener("abort",c)});Xp.set(t,e)}let Jp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Xp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Cw.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Us(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function LI(t){Jp=t(Jp)}function VI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(Cp(this),e,...n);return Cw.set(i,e.sort?e.sort():[e]),Us(i)}:kI().includes(t)?function(...e){return t.apply(Cp(this),e),Us(Aw.get(this))}:function(...e){return Us(t.apply(Cp(this),e))}}function zI(t){return typeof t=="function"?VI(t):(t instanceof IDBTransaction&&PI(t),OI(t,MI())?new Proxy(t,Jp):t)}function Us(t){if(t instanceof IDBRequest)return NI(t);if(Ap.has(t))return Ap.get(t);const e=zI(t);return e!==t&&(Ap.set(t,e),Fg.set(e,t)),e}const Cp=t=>Fg.get(t);function UI(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const c=indexedDB.open(t,e),h=Us(c);return i&&c.addEventListener("upgradeneeded",m=>{i(Us(c.result),m.oldVersion,m.newVersion,Us(c.transaction),m)}),n&&c.addEventListener("blocked",m=>n(m.oldVersion,m.newVersion,m)),h.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",g=>a(g.oldVersion,g.newVersion,g))}).catch(()=>{}),h}const BI=["get","getKey","getAll","getAllKeys","count"],FI=["put","add","delete","clear"],Rp=new Map;function $b(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Rp.get(e))return Rp.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=FI.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||BI.includes(n)))return;const l=async function(c,...h){const m=this.transaction(c,a?"readwrite":"readonly");let g=m.store;return i&&(g=g.index(h.shift())),(await Promise.all([g[n](...h),a&&m.done]))[0]};return Rp.set(e,l),l}LI(t=>({...t,get:(e,n,i)=>$b(e,n)||t.get(e,n,i),has:(e,n)=>!!$b(e,n)||t.has(e,n)}));class qI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(HI(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function HI(t){return t.getComponent()?.type==="VERSION"}const Zp="@firebase/app",Qb="0.14.6";const $i=new Bg("@firebase/app"),GI="@firebase/app-compat",$I="@firebase/analytics-compat",QI="@firebase/analytics",WI="@firebase/app-check-compat",KI="@firebase/app-check",YI="@firebase/auth",XI="@firebase/auth-compat",JI="@firebase/database",ZI="@firebase/data-connect",ej="@firebase/database-compat",tj="@firebase/functions",nj="@firebase/functions-compat",rj="@firebase/installations",ij="@firebase/installations-compat",sj="@firebase/messaging",aj="@firebase/messaging-compat",oj="@firebase/performance",lj="@firebase/performance-compat",cj="@firebase/remote-config",uj="@firebase/remote-config-compat",dj="@firebase/storage",hj="@firebase/storage-compat",fj="@firebase/firestore",mj="@firebase/ai",pj="@firebase/firestore-compat",gj="firebase",yj="12.6.0";const eg="[DEFAULT]",_j={[Zp]:"fire-core",[GI]:"fire-core-compat",[QI]:"fire-analytics",[$I]:"fire-analytics-compat",[KI]:"fire-app-check",[WI]:"fire-app-check-compat",[YI]:"fire-auth",[XI]:"fire-auth-compat",[JI]:"fire-rtdb",[ZI]:"fire-data-connect",[ej]:"fire-rtdb-compat",[tj]:"fire-fn",[nj]:"fire-fn-compat",[rj]:"fire-iid",[ij]:"fire-iid-compat",[sj]:"fire-fcm",[aj]:"fire-fcm-compat",[oj]:"fire-perf",[lj]:"fire-perf-compat",[cj]:"fire-rc",[uj]:"fire-rc-compat",[dj]:"fire-gcs",[hj]:"fire-gcs-compat",[fj]:"fire-fst",[pj]:"fire-fst-compat",[mj]:"fire-vertex","fire-js":"fire-js",[gj]:"fire-js-all"};const Eh=new Map,vj=new Map,tg=new Map;function Wb(t,e){try{t.container.addComponent(e)}catch(n){$i.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function el(t){const e=t.name;if(tg.has(e))return $i.debug(`There were multiple attempts to register component ${e}.`),!1;tg.set(e,t);for(const n of Eh.values())Wb(n,t);for(const n of vj.values())Wb(n,t);return!0}function qg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Lr(t){return t==null?!1:t.settings!==void 0}const bj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Bs=new ou("app","Firebase",bj);class xj{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new La("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Bs.create("app-deleted",{appName:this._name})}}const _l=yj;function Rw(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:eg,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Bs.create("bad-app-name",{appName:String(a)});if(n||(n=Ew()),!n)throw Bs.create("no-options");const l=Eh.get(a);if(l){if($s(n,l.options)&&$s(i,l.config))return l;throw Bs.create("duplicate-app",{appName:a})}const c=new CI(a);for(const m of tg.values())c.addComponent(m);const h=new xj(n,i,c);return Eh.set(a,h),h}function Dw(t=eg){const e=Eh.get(t);if(!e&&t===eg&&Ew())return Rw();if(!e)throw Bs.create("no-app",{appName:t});return e}function Fs(t,e,n){let i=_j[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$i.warn(c.join(" "));return}el(new La(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const Ej="firebase-heartbeat-database",wj=1,Wc="firebase-heartbeat-store";let Dp=null;function Iw(){return Dp||(Dp=UI(Ej,wj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Bs.create("idb-open",{originalErrorMessage:t.message})})),Dp}async function Sj(t){try{const n=(await Iw()).transaction(Wc),i=await n.objectStore(Wc).get(jw(t));return await n.done,i}catch(e){if(e instanceof Yi)$i.warn(e.message);else{const n=Bs.create("idb-get",{originalErrorMessage:e?.message});$i.warn(n.message)}}}async function Kb(t,e){try{const i=(await Iw()).transaction(Wc,"readwrite");await i.objectStore(Wc).put(e,jw(t)),await i.done}catch(n){if(n instanceof Yi)$i.warn(n.message);else{const i=Bs.create("idb-set",{originalErrorMessage:n?.message});$i.warn(i.message)}}}function jw(t){return`${t.name}!${t.options.appId}`}const Tj=1024,Aj=30;class Cj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Dj(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Yb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>Aj){const a=Ij(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){$i.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Yb(),{heartbeatsToSend:n,unsentEntries:i}=Rj(this._heartbeatsCache.heartbeats),a=xh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return $i.warn(e),""}}}function Yb(){return new Date().toISOString().substring(0,10)}function Rj(t,e=Tj){const n=[];let i=t.slice();for(const a of t){const l=n.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),Xb(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Xb(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class Dj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pI()?gI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Sj(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Kb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Kb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Xb(t){return xh(JSON.stringify({version:2,heartbeats:t})).length}function Ij(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function jj(t){el(new La("platform-logger",e=>new qI(e),"PRIVATE")),el(new La("heartbeat",e=>new Cj(e),"PRIVATE")),Fs(Zp,Qb,t),Fs(Zp,Qb,"esm2020"),Fs("fire-js","")}jj("");var Oj="firebase",Mj="12.7.0";Fs(Oj,Mj,"app");const kj={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},Ow=Rw(kj);var Jb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var qs,Mw;(function(){var t;function e(P,D){function I(){}I.prototype=D.prototype,P.F=D.prototype,P.prototype=new I,P.prototype.constructor=P,P.D=function(N,O,k){for(var R=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)R[ae-2]=arguments[ae];return D.prototype[O].apply(N,R)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(P,D,I){I||(I=0);const N=Array(16);if(typeof D=="string")for(var O=0;O<16;++O)N[O]=D.charCodeAt(I++)|D.charCodeAt(I++)<<8|D.charCodeAt(I++)<<16|D.charCodeAt(I++)<<24;else for(O=0;O<16;++O)N[O]=D[I++]|D[I++]<<8|D[I++]<<16|D[I++]<<24;D=P.g[0],I=P.g[1],O=P.g[2];let k=P.g[3],R;R=D+(k^I&(O^k))+N[0]+3614090360&4294967295,D=I+(R<<7&4294967295|R>>>25),R=k+(O^D&(I^O))+N[1]+3905402710&4294967295,k=D+(R<<12&4294967295|R>>>20),R=O+(I^k&(D^I))+N[2]+606105819&4294967295,O=k+(R<<17&4294967295|R>>>15),R=I+(D^O&(k^D))+N[3]+3250441966&4294967295,I=O+(R<<22&4294967295|R>>>10),R=D+(k^I&(O^k))+N[4]+4118548399&4294967295,D=I+(R<<7&4294967295|R>>>25),R=k+(O^D&(I^O))+N[5]+1200080426&4294967295,k=D+(R<<12&4294967295|R>>>20),R=O+(I^k&(D^I))+N[6]+2821735955&4294967295,O=k+(R<<17&4294967295|R>>>15),R=I+(D^O&(k^D))+N[7]+4249261313&4294967295,I=O+(R<<22&4294967295|R>>>10),R=D+(k^I&(O^k))+N[8]+1770035416&4294967295,D=I+(R<<7&4294967295|R>>>25),R=k+(O^D&(I^O))+N[9]+2336552879&4294967295,k=D+(R<<12&4294967295|R>>>20),R=O+(I^k&(D^I))+N[10]+4294925233&4294967295,O=k+(R<<17&4294967295|R>>>15),R=I+(D^O&(k^D))+N[11]+2304563134&4294967295,I=O+(R<<22&4294967295|R>>>10),R=D+(k^I&(O^k))+N[12]+1804603682&4294967295,D=I+(R<<7&4294967295|R>>>25),R=k+(O^D&(I^O))+N[13]+4254626195&4294967295,k=D+(R<<12&4294967295|R>>>20),R=O+(I^k&(D^I))+N[14]+2792965006&4294967295,O=k+(R<<17&4294967295|R>>>15),R=I+(D^O&(k^D))+N[15]+1236535329&4294967295,I=O+(R<<22&4294967295|R>>>10),R=D+(O^k&(I^O))+N[1]+4129170786&4294967295,D=I+(R<<5&4294967295|R>>>27),R=k+(I^O&(D^I))+N[6]+3225465664&4294967295,k=D+(R<<9&4294967295|R>>>23),R=O+(D^I&(k^D))+N[11]+643717713&4294967295,O=k+(R<<14&4294967295|R>>>18),R=I+(k^D&(O^k))+N[0]+3921069994&4294967295,I=O+(R<<20&4294967295|R>>>12),R=D+(O^k&(I^O))+N[5]+3593408605&4294967295,D=I+(R<<5&4294967295|R>>>27),R=k+(I^O&(D^I))+N[10]+38016083&4294967295,k=D+(R<<9&4294967295|R>>>23),R=O+(D^I&(k^D))+N[15]+3634488961&4294967295,O=k+(R<<14&4294967295|R>>>18),R=I+(k^D&(O^k))+N[4]+3889429448&4294967295,I=O+(R<<20&4294967295|R>>>12),R=D+(O^k&(I^O))+N[9]+568446438&4294967295,D=I+(R<<5&4294967295|R>>>27),R=k+(I^O&(D^I))+N[14]+3275163606&4294967295,k=D+(R<<9&4294967295|R>>>23),R=O+(D^I&(k^D))+N[3]+4107603335&4294967295,O=k+(R<<14&4294967295|R>>>18),R=I+(k^D&(O^k))+N[8]+1163531501&4294967295,I=O+(R<<20&4294967295|R>>>12),R=D+(O^k&(I^O))+N[13]+2850285829&4294967295,D=I+(R<<5&4294967295|R>>>27),R=k+(I^O&(D^I))+N[2]+4243563512&4294967295,k=D+(R<<9&4294967295|R>>>23),R=O+(D^I&(k^D))+N[7]+1735328473&4294967295,O=k+(R<<14&4294967295|R>>>18),R=I+(k^D&(O^k))+N[12]+2368359562&4294967295,I=O+(R<<20&4294967295|R>>>12),R=D+(I^O^k)+N[5]+4294588738&4294967295,D=I+(R<<4&4294967295|R>>>28),R=k+(D^I^O)+N[8]+2272392833&4294967295,k=D+(R<<11&4294967295|R>>>21),R=O+(k^D^I)+N[11]+1839030562&4294967295,O=k+(R<<16&4294967295|R>>>16),R=I+(O^k^D)+N[14]+4259657740&4294967295,I=O+(R<<23&4294967295|R>>>9),R=D+(I^O^k)+N[1]+2763975236&4294967295,D=I+(R<<4&4294967295|R>>>28),R=k+(D^I^O)+N[4]+1272893353&4294967295,k=D+(R<<11&4294967295|R>>>21),R=O+(k^D^I)+N[7]+4139469664&4294967295,O=k+(R<<16&4294967295|R>>>16),R=I+(O^k^D)+N[10]+3200236656&4294967295,I=O+(R<<23&4294967295|R>>>9),R=D+(I^O^k)+N[13]+681279174&4294967295,D=I+(R<<4&4294967295|R>>>28),R=k+(D^I^O)+N[0]+3936430074&4294967295,k=D+(R<<11&4294967295|R>>>21),R=O+(k^D^I)+N[3]+3572445317&4294967295,O=k+(R<<16&4294967295|R>>>16),R=I+(O^k^D)+N[6]+76029189&4294967295,I=O+(R<<23&4294967295|R>>>9),R=D+(I^O^k)+N[9]+3654602809&4294967295,D=I+(R<<4&4294967295|R>>>28),R=k+(D^I^O)+N[12]+3873151461&4294967295,k=D+(R<<11&4294967295|R>>>21),R=O+(k^D^I)+N[15]+530742520&4294967295,O=k+(R<<16&4294967295|R>>>16),R=I+(O^k^D)+N[2]+3299628645&4294967295,I=O+(R<<23&4294967295|R>>>9),R=D+(O^(I|~k))+N[0]+4096336452&4294967295,D=I+(R<<6&4294967295|R>>>26),R=k+(I^(D|~O))+N[7]+1126891415&4294967295,k=D+(R<<10&4294967295|R>>>22),R=O+(D^(k|~I))+N[14]+2878612391&4294967295,O=k+(R<<15&4294967295|R>>>17),R=I+(k^(O|~D))+N[5]+4237533241&4294967295,I=O+(R<<21&4294967295|R>>>11),R=D+(O^(I|~k))+N[12]+1700485571&4294967295,D=I+(R<<6&4294967295|R>>>26),R=k+(I^(D|~O))+N[3]+2399980690&4294967295,k=D+(R<<10&4294967295|R>>>22),R=O+(D^(k|~I))+N[10]+4293915773&4294967295,O=k+(R<<15&4294967295|R>>>17),R=I+(k^(O|~D))+N[1]+2240044497&4294967295,I=O+(R<<21&4294967295|R>>>11),R=D+(O^(I|~k))+N[8]+1873313359&4294967295,D=I+(R<<6&4294967295|R>>>26),R=k+(I^(D|~O))+N[15]+4264355552&4294967295,k=D+(R<<10&4294967295|R>>>22),R=O+(D^(k|~I))+N[6]+2734768916&4294967295,O=k+(R<<15&4294967295|R>>>17),R=I+(k^(O|~D))+N[13]+1309151649&4294967295,I=O+(R<<21&4294967295|R>>>11),R=D+(O^(I|~k))+N[4]+4149444226&4294967295,D=I+(R<<6&4294967295|R>>>26),R=k+(I^(D|~O))+N[11]+3174756917&4294967295,k=D+(R<<10&4294967295|R>>>22),R=O+(D^(k|~I))+N[2]+718787259&4294967295,O=k+(R<<15&4294967295|R>>>17),R=I+(k^(O|~D))+N[9]+3951481745&4294967295,P.g[0]=P.g[0]+D&4294967295,P.g[1]=P.g[1]+(O+(R<<21&4294967295|R>>>11))&4294967295,P.g[2]=P.g[2]+O&4294967295,P.g[3]=P.g[3]+k&4294967295}i.prototype.v=function(P,D){D===void 0&&(D=P.length);const I=D-this.blockSize,N=this.C;let O=this.h,k=0;for(;k<D;){if(O==0)for(;k<=I;)a(this,P,k),k+=this.blockSize;if(typeof P=="string"){for(;k<D;)if(N[O++]=P.charCodeAt(k++),O==this.blockSize){a(this,N),O=0;break}}else for(;k<D;)if(N[O++]=P[k++],O==this.blockSize){a(this,N),O=0;break}}this.h=O,this.o+=D},i.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var D=1;D<P.length-8;++D)P[D]=0;D=this.o*8;for(var I=P.length-8;I<P.length;++I)P[I]=D&255,D/=256;for(this.v(P),P=Array(16),D=0,I=0;I<4;++I)for(let N=0;N<32;N+=8)P[D++]=this.g[I]>>>N&255;return P};function l(P,D){var I=h;return Object.prototype.hasOwnProperty.call(I,P)?I[P]:I[P]=D(P)}function c(P,D){this.h=D;const I=[];let N=!0;for(let O=P.length-1;O>=0;O--){const k=P[O]|0;N&&k==D||(I[O]=k,N=!1)}this.g=I}var h={};function m(P){return-128<=P&&P<128?l(P,function(D){return new c([D|0],D<0?-1:0)}):new c([P|0],P<0?-1:0)}function g(P){if(isNaN(P)||!isFinite(P))return v;if(P<0)return M(g(-P));const D=[];let I=1;for(let N=0;P>=I;N++)D[N]=P/I|0,I*=4294967296;return new c(D,0)}function _(P,D){if(P.length==0)throw Error("number format error: empty string");if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(P.charAt(0)=="-")return M(_(P.substring(1),D));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=g(Math.pow(D,8));let N=v;for(let k=0;k<P.length;k+=8){var O=Math.min(8,P.length-k);const R=parseInt(P.substring(k,k+O),D);O<8?(O=g(Math.pow(D,O)),N=N.j(O).add(g(R))):(N=N.j(I),N=N.add(g(R)))}return N}var v=m(0),b=m(1),w=m(16777216);t=c.prototype,t.m=function(){if(S(this))return-M(this).m();let P=0,D=1;for(let I=0;I<this.g.length;I++){const N=this.i(I);P+=(N>=0?N:4294967296+N)*D,D*=4294967296}return P},t.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(A(this))return"0";if(S(this))return"-"+M(this).toString(P);const D=g(Math.pow(P,6));var I=this;let N="";for(;;){const O=ee(I,D).g;I=F(I,O.j(D));let k=((I.g.length>0?I.g[0]:I.h)>>>0).toString(P);if(I=O,A(I))return k+N;for(;k.length<6;)k="0"+k;N=k+N}},t.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function A(P){if(P.h!=0)return!1;for(let D=0;D<P.g.length;D++)if(P.g[D]!=0)return!1;return!0}function S(P){return P.h==-1}t.l=function(P){return P=F(this,P),S(P)?-1:A(P)?0:1};function M(P){const D=P.g.length,I=[];for(let N=0;N<D;N++)I[N]=~P.g[N];return new c(I,~P.h).add(b)}t.abs=function(){return S(this)?M(this):this},t.add=function(P){const D=Math.max(this.g.length,P.g.length),I=[];let N=0;for(let O=0;O<=D;O++){let k=N+(this.i(O)&65535)+(P.i(O)&65535),R=(k>>>16)+(this.i(O)>>>16)+(P.i(O)>>>16);N=R>>>16,k&=65535,R&=65535,I[O]=R<<16|k}return new c(I,I[I.length-1]&-2147483648?-1:0)};function F(P,D){return P.add(M(D))}t.j=function(P){if(A(this)||A(P))return v;if(S(this))return S(P)?M(this).j(M(P)):M(M(this).j(P));if(S(P))return M(this.j(M(P)));if(this.l(w)<0&&P.l(w)<0)return g(this.m()*P.m());const D=this.g.length+P.g.length,I=[];for(var N=0;N<2*D;N++)I[N]=0;for(N=0;N<this.g.length;N++)for(let O=0;O<P.g.length;O++){const k=this.i(N)>>>16,R=this.i(N)&65535,ae=P.i(O)>>>16,q=P.i(O)&65535;I[2*N+2*O]+=R*q,H(I,2*N+2*O),I[2*N+2*O+1]+=k*q,H(I,2*N+2*O+1),I[2*N+2*O+1]+=R*ae,H(I,2*N+2*O+1),I[2*N+2*O+2]+=k*ae,H(I,2*N+2*O+2)}for(P=0;P<D;P++)I[P]=I[2*P+1]<<16|I[2*P];for(P=D;P<2*D;P++)I[P]=0;return new c(I,0)};function H(P,D){for(;(P[D]&65535)!=P[D];)P[D+1]+=P[D]>>>16,P[D]&=65535,D++}function z(P,D){this.g=P,this.h=D}function ee(P,D){if(A(D))throw Error("division by zero");if(A(P))return new z(v,v);if(S(P))return D=ee(M(P),D),new z(M(D.g),M(D.h));if(S(D))return D=ee(P,M(D)),new z(M(D.g),D.h);if(P.g.length>30){if(S(P)||S(D))throw Error("slowDivide_ only works with positive integers.");for(var I=b,N=D;N.l(P)<=0;)I=J(I),N=J(N);var O=me(I,1),k=me(N,1);for(N=me(N,2),I=me(I,2);!A(N);){var R=k.add(N);R.l(P)<=0&&(O=O.add(I),k=R),N=me(N,1),I=me(I,1)}return D=F(P,O.j(D)),new z(O,D)}for(O=v;P.l(D)>=0;){for(I=Math.max(1,Math.floor(P.m()/D.m())),N=Math.ceil(Math.log(I)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),k=g(I),R=k.j(D);S(R)||R.l(P)>0;)I-=N,k=g(I),R=k.j(D);A(k)&&(k=b),O=O.add(k),P=F(P,R)}return new z(O,P)}t.B=function(P){return ee(this,P).h},t.and=function(P){const D=Math.max(this.g.length,P.g.length),I=[];for(let N=0;N<D;N++)I[N]=this.i(N)&P.i(N);return new c(I,this.h&P.h)},t.or=function(P){const D=Math.max(this.g.length,P.g.length),I=[];for(let N=0;N<D;N++)I[N]=this.i(N)|P.i(N);return new c(I,this.h|P.h)},t.xor=function(P){const D=Math.max(this.g.length,P.g.length),I=[];for(let N=0;N<D;N++)I[N]=this.i(N)^P.i(N);return new c(I,this.h^P.h)};function J(P){const D=P.g.length+1,I=[];for(let N=0;N<D;N++)I[N]=P.i(N)<<1|P.i(N-1)>>>31;return new c(I,P.h)}function me(P,D){const I=D>>5;D%=32;const N=P.g.length-I,O=[];for(let k=0;k<N;k++)O[k]=D>0?P.i(k+I)>>>D|P.i(k+I+1)<<32-D:P.i(k+I);return new c(O,P.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Mw=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=g,c.fromString=_,qs=c}).apply(typeof Jb<"u"?Jb:typeof self<"u"?self:typeof window<"u"?window:{});var Jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var kw,Nc,Nw,ah,ng,Pw,Lw,Vw;(function(){var t,e=Object.defineProperty;function n(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jd=="object"&&Jd];for(var x=0;x<f.length;++x){var T=f[x];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var i=n(this);function a(f,x){if(x)e:{var T=i;f=f.split(".");for(var L=0;L<f.length-1;L++){var re=f[L];if(!(re in T))break e;T=T[re]}f=f[f.length-1],L=T[f],x=x(L),x!=L&&x!=null&&e(T,f,{configurable:!0,writable:!0,value:x})}}a("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(f){return f||function(x){var T=[],L;for(L in x)Object.prototype.hasOwnProperty.call(x,L)&&T.push([L,x[L]]);return T}});var l=l||{},c=this||self;function h(f){var x=typeof f;return x=="object"&&f!=null||x=="function"}function m(f,x,T){return f.call.apply(f.bind,arguments)}function g(f,x,T){return g=m,g.apply(null,arguments)}function _(f,x){var T=Array.prototype.slice.call(arguments,1);return function(){var L=T.slice();return L.push.apply(L,arguments),f.apply(this,L)}}function v(f,x){function T(){}T.prototype=x.prototype,f.Z=x.prototype,f.prototype=new T,f.prototype.constructor=f,f.Ob=function(L,re,ue){for(var we=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)we[Fe-2]=arguments[Fe];return x.prototype[re].apply(L,we)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function w(f){const x=f.length;if(x>0){const T=Array(x);for(let L=0;L<x;L++)T[L]=f[L];return T}return[]}function A(f,x){for(let L=1;L<arguments.length;L++){const re=arguments[L];var T=typeof re;if(T=T!="object"?T:re?Array.isArray(re)?"array":T:"null",T=="array"||T=="object"&&typeof re.length=="number"){T=f.length||0;const ue=re.length||0;f.length=T+ue;for(let we=0;we<ue;we++)f[T+we]=re[we]}else f.push(re)}}class S{constructor(x,T){this.i=x,this.j=T,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function M(f){c.setTimeout(()=>{throw f},0)}function F(){var f=P;let x=null;return f.g&&(x=f.g,f.g=f.g.next,f.g||(f.h=null),x.next=null),x}class H{constructor(){this.h=this.g=null}add(x,T){const L=z.get();L.set(x,T),this.h?this.h.next=L:this.g=L,this.h=L}}var z=new S(()=>new ee,f=>f.reset());class ee{constructor(){this.next=this.g=this.h=null}set(x,T){this.h=x,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let J,me=!1,P=new H,D=()=>{const f=Promise.resolve(void 0);J=()=>{f.then(I)}};function I(){for(var f;f=F();){try{f.h.call(f.g)}catch(T){M(T)}var x=z;x.j(f),x.h<100&&(x.h++,f.next=x.g,x.g=f)}me=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(f,x){this.type=f,this.g=this.target=x,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var k=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var f=!1,x=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const T=()=>{};c.addEventListener("test",T,x),c.removeEventListener("test",T,x)}catch{}return f})();function R(f){return/^[\s\xa0]*$/.test(f)}function ae(f,x){O.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,x)}v(ae,O),ae.prototype.init=function(f,x){const T=this.type=f.type,L=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=x,x=f.relatedTarget,x||(T=="mouseover"?x=f.fromElement:T=="mouseout"&&(x=f.toElement)),this.relatedTarget=x,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&ae.Z.h.call(this)},ae.prototype.h=function(){ae.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var q="closure_listenable_"+(Math.random()*1e6|0),V=0;function Q(f,x,T,L,re){this.listener=f,this.proxy=null,this.src=x,this.type=T,this.capture=!!L,this.ha=re,this.key=++V,this.da=this.fa=!1}function W(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function de(f,x,T){for(const L in f)x.call(T,f[L],L,f)}function ne(f,x){for(const T in f)x.call(void 0,f[T],T,f)}function B(f){const x={};for(const T in f)x[T]=f[T];return x}const U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function G(f,x){let T,L;for(let re=1;re<arguments.length;re++){L=arguments[re];for(T in L)f[T]=L[T];for(let ue=0;ue<U.length;ue++)T=U[ue],Object.prototype.hasOwnProperty.call(L,T)&&(f[T]=L[T])}}function K(f){this.src=f,this.g={},this.h=0}K.prototype.add=function(f,x,T,L,re){const ue=f.toString();f=this.g[ue],f||(f=this.g[ue]=[],this.h++);const we=he(f,x,L,re);return we>-1?(x=f[we],T||(x.fa=!1)):(x=new Q(x,this.src,ue,!!L,re),x.fa=T,f.push(x)),x};function te(f,x){const T=x.type;if(T in f.g){var L=f.g[T],re=Array.prototype.indexOf.call(L,x,void 0),ue;(ue=re>=0)&&Array.prototype.splice.call(L,re,1),ue&&(W(x),f.g[T].length==0&&(delete f.g[T],f.h--))}}function he(f,x,T,L){for(let re=0;re<f.length;++re){const ue=f[re];if(!ue.da&&ue.listener==x&&ue.capture==!!T&&ue.ha==L)return re}return-1}var be="closure_lm_"+(Math.random()*1e6|0),xe={};function oe(f,x,T,L,re){if(Array.isArray(x)){for(let ue=0;ue<x.length;ue++)oe(f,x[ue],T,L,re);return null}return T=sr(T),f&&f[q]?f.J(x,T,h(L)?!!L.capture:!1,re):Y(f,x,T,!1,L,re)}function Y(f,x,T,L,re,ue){if(!x)throw Error("Invalid event type");const we=h(re)?!!re.capture:!!re;let Fe=Cn(f);if(Fe||(f[be]=Fe=new K(f)),T=Fe.add(x,T,L,we,ue),T.proxy)return T;if(L=Se(),T.proxy=L,L.src=f,L.listener=T,f.addEventListener)k||(re=we),re===void 0&&(re=!1),f.addEventListener(x.toString(),L,re);else if(f.attachEvent)f.attachEvent(Be(x.toString()),L);else if(f.addListener&&f.removeListener)f.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return T}function Se(){function f(T){return x.call(f.src,f.listener,T)}const x=yt;return f}function Re(f,x,T,L,re){if(Array.isArray(x))for(var ue=0;ue<x.length;ue++)Re(f,x[ue],T,L,re);else L=h(L)?!!L.capture:!!L,T=sr(T),f&&f[q]?(f=f.i,ue=String(x).toString(),ue in f.g&&(x=f.g[ue],T=he(x,T,L,re),T>-1&&(W(x[T]),Array.prototype.splice.call(x,T,1),x.length==0&&(delete f.g[ue],f.h--)))):f&&(f=Cn(f))&&(x=f.g[x.toString()],f=-1,x&&(f=he(x,T,L,re)),(T=f>-1?x[f]:null)&&Ge(T))}function Ge(f){if(typeof f!="number"&&f&&!f.da){var x=f.src;if(x&&x[q])te(x.i,f);else{var T=f.type,L=f.proxy;x.removeEventListener?x.removeEventListener(T,L,f.capture):x.detachEvent?x.detachEvent(Be(T),L):x.addListener&&x.removeListener&&x.removeListener(L),(T=Cn(x))?(te(T,f),T.h==0&&(T.src=null,x[be]=null)):W(f)}}}function Be(f){return f in xe?xe[f]:xe[f]="on"+f}function yt(f,x){if(f.da)f=!0;else{x=new ae(x,this);const T=f.listener,L=f.ha||f.src;f.fa&&Ge(f),f=T.call(L,x)}return f}function Cn(f){return f=f[be],f instanceof K?f:null}var dn="__closure_events_fn_"+(Math.random()*1e9>>>0);function sr(f){return typeof f=="function"?f:(f[dn]||(f[dn]=function(x){return f.handleEvent(x)}),f[dn])}function Ct(){N.call(this),this.i=new K(this),this.M=this,this.G=null}v(Ct,N),Ct.prototype[q]=!0,Ct.prototype.removeEventListener=function(f,x,T,L){Re(this,f,x,T,L)};function jt(f,x){var T,L=f.G;if(L)for(T=[];L;L=L.G)T.push(L);if(f=f.M,L=x.type||x,typeof x=="string")x=new O(x,f);else if(x instanceof O)x.target=x.target||f;else{var re=x;x=new O(L,f),G(x,re)}re=!0;let ue,we;if(T)for(we=T.length-1;we>=0;we--)ue=x.g=T[we],re=rt(ue,L,!0,x)&&re;if(ue=x.g=f,re=rt(ue,L,!0,x)&&re,re=rt(ue,L,!1,x)&&re,T)for(we=0;we<T.length;we++)ue=x.g=T[we],re=rt(ue,L,!1,x)&&re}Ct.prototype.N=function(){if(Ct.Z.N.call(this),this.i){var f=this.i;for(const x in f.g){const T=f.g[x];for(let L=0;L<T.length;L++)W(T[L]);delete f.g[x],f.h--}}this.G=null},Ct.prototype.J=function(f,x,T,L){return this.i.add(String(f),x,!1,T,L)},Ct.prototype.K=function(f,x,T,L){return this.i.add(String(f),x,!0,T,L)};function rt(f,x,T,L){if(x=f.i.g[String(x)],!x)return!0;x=x.concat();let re=!0;for(let ue=0;ue<x.length;++ue){const we=x[ue];if(we&&!we.da&&we.capture==T){const Fe=we.listener,Mt=we.ha||we.src;we.fa&&te(f.i,we),re=Fe.call(Mt,L)!==!1&&re}}return re&&!L.defaultPrevented}function qn(f,x){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=g(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:c.setTimeout(f,x||0)}function wr(f){f.g=qn(()=>{f.g=null,f.i&&(f.i=!1,wr(f))},f.l);const x=f.h;f.h=null,f.m.apply(null,x)}class Rt extends N{constructor(x,T){super(),this.m=x,this.l=T,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:wr(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hn(f){N.call(this),this.h=f,this.g={}}v(Hn,N);var Vt=[];function Gn(f){de(f.g,function(x,T){this.g.hasOwnProperty(T)&&Ge(x)},f),f.g={}}Hn.prototype.N=function(){Hn.Z.N.call(this),Gn(this)},Hn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Zi=c.JSON.stringify,vf=c.JSON.parse,Eu=class{stringify(f){return c.JSON.stringify(f,void 0)}parse(f){return c.JSON.parse(f,void 0)}};function wu(){}function Su(){}var Sr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function hn(){O.call(this,"d")}v(hn,O);function ar(){O.call(this,"c")}v(ar,O);var Ot={},Tu=null;function Ja(){return Tu=Tu||new Ct}Ot.Ia="serverreachability";function Au(f){O.call(this,Ot.Ia,f)}v(Au,O);function Fr(f){const x=Ja();jt(x,new Au(x))}Ot.STAT_EVENT="statevent";function ra(f,x){O.call(this,Ot.STAT_EVENT,f),this.stat=x}v(ra,O);function zt(f){const x=Ja();jt(x,new ra(x,f))}Ot.Ja="timingevent";function qr(f,x){O.call(this,Ot.Ja,f),this.size=x}v(qr,O);function Hr(f,x){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){f()},x)}function Tr(){this.g=!0}Tr.prototype.ua=function(){this.g=!1};function bf(f,x,T,L,re,ue){f.info(function(){if(f.g)if(ue){var we="",Fe=ue.split("&");for(let it=0;it<Fe.length;it++){var Mt=Fe[it].split("=");if(Mt.length>1){const Et=Mt[0];Mt=Mt[1];const ur=Et.split("_");we=ur.length>=2&&ur[1]=="type"?we+(Et+"="+Mt+"&"):we+(Et+"=redacted&")}}}else we=null;else we=ue;return"XMLHTTP REQ ("+L+") [attempt "+re+"]: "+x+`
`+T+`
`+we})}function Cu(f,x,T,L,re,ue,we){f.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+re+"]: "+x+`
`+T+`
`+ue+" "+we})}function Gr(f,x,T,L){f.info(function(){return"XMLHTTP TEXT ("+x+"): "+xf(f,T)+(L?" "+L:"")})}function ia(f,x){f.info(function(){return"TIMEOUT: "+x})}Tr.prototype.info=function(){};function xf(f,x){if(!f.g)return x;if(!x)return null;try{const ue=JSON.parse(x);if(ue){for(f=0;f<ue.length;f++)if(Array.isArray(ue[f])){var T=ue[f];if(!(T.length<2)){var L=T[1];if(Array.isArray(L)&&!(L.length<1)){var re=L[0];if(re!="noop"&&re!="stop"&&re!="close")for(let we=1;we<L.length;we++)L[we]=""}}}}return Zi(ue)}catch{return x}}var sa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},jl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ol;function aa(){}v(aa,wu),aa.prototype.g=function(){return new XMLHttpRequest},Ol=new aa;function xi(f){return encodeURIComponent(String(f))}function Ru(f){var x=1;f=f.split(":");const T=[];for(;x>0&&f.length;)T.push(f.shift()),x--;return f.length&&T.push(f.join(":")),T}function Ar(f,x,T,L){this.j=f,this.i=x,this.l=T,this.S=L||1,this.V=new Hn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Cr}function Cr(){this.i=null,this.g="",this.h=!1}var Ut={},sn={};function $r(f,x,T){f.M=1,f.A=oa(Ft(x)),f.u=T,f.R=!0,Za(f,null)}function Za(f,x){f.F=Date.now(),Qr(f),f.B=Ft(f.A);var T=f.B,L=f.S;Array.isArray(L)||(L=[String(L)]),ro(T.i,"t",L),f.C=0,T=f.j.L,f.h=new Cr,f.g=qu(f.j,T?x:null,!f.u),f.P>0&&(f.O=new Rt(g(f.Y,f,f.g),f.P)),x=f.V,T=f.g,L=f.ba;var re="readystatechange";Array.isArray(re)||(re&&(Vt[0]=re.toString()),re=Vt);for(let ue=0;ue<re.length;ue++){const we=oe(T,re[ue],L||x.handleEvent,!1,x.h||x);if(!we)break;x.g[we.key]=we}x=f.J?B(f.J):{},f.u?(f.v||(f.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,x)):(f.v="GET",f.g.ea(f.B,f.v,null,x)),Fr(),bf(f.i,f.v,f.B,f.l,f.S,f.u)}Ar.prototype.ba=function(f){f=f.target;const x=this.O;x&&Ir(f)==3?x.j():this.Y(f)},Ar.prototype.Y=function(f){try{if(f==this.g)e:{const Fe=Ir(this.g),Mt=this.g.ya(),it=this.g.ca();if(!(Fe<3)&&(Fe!=3||this.g&&(this.h.h||this.g.la()||fn(this.g)))){this.K||Fe!=4||Mt==7||(Mt==8||it<=0?Fr(3):Fr(2)),Wr(this);var x=this.g.ca();this.X=x;var T=Ef(this);if(this.o=x==200,Cu(this.i,this.v,this.B,this.l,this.S,Fe,x),this.o){if(this.U&&!this.L){t:{if(this.g){var L,re=this.g;if((L=re.g?re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(L)){var ue=L;break t}}ue=null}if(f=ue)Gr(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Kr(this,f);else{this.o=!1,this.m=3,zt(12),$n(this),or(this);break e}}if(this.R){f=!0;let Et;for(;!this.K&&this.C<T.length;)if(Et=Iu(this,T),Et==sn){Fe==4&&(this.m=4,zt(14),f=!1),Gr(this.i,this.l,null,"[Incomplete Response]");break}else if(Et==Ut){this.m=4,zt(15),Gr(this.i,this.l,T,"[Invalid Chunk]"),f=!1;break}else Gr(this.i,this.l,Et,null),Kr(this,Et);if(Du(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fe!=4||T.length!=0||this.h.h||(this.m=1,zt(16),f=!1),this.o=this.o&&f,!f)Gr(this.i,this.l,T,"[Invalid Chunked Response]"),$n(this),or(this);else if(T.length>0&&!this.W){this.W=!0;var we=this.j;we.g==this&&we.aa&&!we.P&&(we.j.info("Great, no buffering proxy detected. Bytes received: "+T.length),Ql(we),we.P=!0,zt(11))}}else Gr(this.i,this.l,T,null),Kr(this,T);Fe==4&&$n(this),this.o&&!this.K&&(Fe==4?zu(this.j,this):(this.o=!1,Qr(this)))}else wi(this.g),x==400&&T.indexOf("Unknown SID")>0?(this.m=3,zt(12)):(this.m=0,zt(13)),$n(this),or(this)}}}catch{}};function Ef(f){if(!Du(f))return f.g.la();const x=fn(f.g);if(x==="")return"";let T="";const L=x.length,re=Ir(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return $n(f),or(f),"";f.h.i=new c.TextDecoder}for(let ue=0;ue<L;ue++)f.h.h=!0,T+=f.h.i.decode(x[ue],{stream:!(re&&ue==L-1)});return x.length=0,f.h.g+=T,f.C=0,f.h.g}function Du(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function Iu(f,x){var T=f.C,L=x.indexOf(`
`,T);return L==-1?sn:(T=Number(x.substring(T,L)),isNaN(T)?Ut:(L+=1,L+T>x.length?sn:(x=x.slice(L,L+T),f.C=L+T,x)))}Ar.prototype.cancel=function(){this.K=!0,$n(this)};function Qr(f){f.T=Date.now()+f.H,eo(f,f.H)}function eo(f,x){if(f.D!=null)throw Error("WatchDog timer not null");f.D=Hr(g(f.aa,f),x)}function Wr(f){f.D&&(c.clearTimeout(f.D),f.D=null)}Ar.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(ia(this.i,this.B),this.M!=2&&(Fr(),zt(17)),$n(this),this.m=2,or(this)):eo(this,this.T-f)};function or(f){f.j.I==0||f.K||zu(f.j,f)}function $n(f){Wr(f);var x=f.O;x&&typeof x.dispose=="function"&&x.dispose(),f.O=null,Gn(f.V),f.g&&(x=f.g,f.g=null,x.abort(),x.dispose())}function Kr(f,x){try{var T=f.j;if(T.I!=0&&(T.g==f||Xr(T.h,f))){if(!f.L&&Xr(T.h,f)&&T.I==3){try{var L=T.Ba.g.parse(x)}catch{L=null}if(Array.isArray(L)&&L.length==3){var re=L;if(re[0]==0){e:if(!T.v){if(T.g)if(T.g.F+3e3<f.F)lo(T),os(T);else break e;ma(T),zt(18)}}else T.xa=re[1],0<T.xa-T.K&&re[2]<37500&&T.F&&T.A==0&&!T.C&&(T.C=Hr(g(T.Va,T),6e3));Yr(T.h)<=1&&T.ta&&(T.ta=void 0)}else ri(T,11)}else if((f.L||T.g==f)&&lo(T),!R(x))for(re=T.Ba.g.parse(x),x=0;x<re.length;x++){let it=re[x];const Et=it[0];if(!(Et<=T.K))if(T.K=Et,it=it[1],T.I==2)if(it[0]=="c"){T.M=it[1],T.ba=it[2];const ur=it[3];ur!=null&&(T.ka=ur,T.j.info("VER="+T.ka));const ii=it[4];ii!=null&&(T.za=ii,T.j.info("SVER="+T.za));const jr=it[5];jr!=null&&typeof jr=="number"&&jr>0&&(L=1.5*jr,T.O=L,T.j.info("backChannelRequestTimeoutMs_="+L)),L=T;const Or=f.g;if(Or){const pa=Or.g?Or.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pa){var ue=L.h;ue.g||pa.indexOf("spdy")==-1&&pa.indexOf("quic")==-1&&pa.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(Nl(ue,ue.h),ue.h=null))}if(L.G){const co=Or.g?Or.g.getResponseHeader("X-HTTP-Session-Id"):null;co&&(L.wa=co,ot(L.J,L.G,co))}}T.I=3,T.l&&T.l.ra(),T.aa&&(T.T=Date.now()-f.F,T.j.info("Handshake RTT: "+T.T+"ms")),L=T;var we=f;if(L.na=Fu(L,L.L?L.ba:null,L.W),we.L){Pl(L.h,we);var Fe=we,Mt=L.O;Mt&&(Fe.H=Mt),Fe.D&&(Wr(Fe),Qr(Fe)),L.g=we}else Lu(L);T.i.length>0&&ni(T)}else it[0]!="stop"&&it[0]!="close"||ri(T,7);else T.I==3&&(it[0]=="stop"||it[0]=="close"?it[0]=="stop"?ri(T,7):Gl(T):it[0]!="noop"&&T.l&&T.l.qa(it),T.A=0)}}Fr(4)}catch{}}var Bt=class{constructor(f,x){this.g=f,this.map=x}};function Ml(f){this.l=f||10,c.PerformanceNavigationTiming?(f=c.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function kl(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Yr(f){return f.h?1:f.g?f.g.size:0}function Xr(f,x){return f.h?f.h==x:f.g?f.g.has(x):!1}function Nl(f,x){f.g?f.g.add(x):f.h=x}function Pl(f,x){f.h&&f.h==x?f.h=null:f.g&&f.g.has(x)&&f.g.delete(x)}Ml.prototype.cancel=function(){if(this.i=Ll(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Ll(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let x=f.i;for(const T of f.g.values())x=x.concat(T.G);return x}return w(f.i)}var ju=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function to(f,x){if(f){f=f.split("&");for(let T=0;T<f.length;T++){const L=f[T].indexOf("=");let re,ue=null;L>=0?(re=f[T].substring(0,L),ue=f[T].substring(L+1)):re=f[T],x(re,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function Qn(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;f instanceof Qn?(this.l=f.l,an(this,f.j),this.o=f.o,this.g=f.g,es(this,f.u),this.h=f.h,Vl(this,Nu(f.i)),this.m=f.m):f&&(x=String(f).match(ju))?(this.l=!1,an(this,x[1]||"",!0),this.o=Jr(x[2]||""),this.g=Jr(x[3]||"",!0),es(this,x[4]),this.h=Jr(x[5]||"",!0),Vl(this,x[6]||"",!0),this.m=Jr(x[7]||"")):(this.l=!1,this.i=new ns(null,this.l))}Qn.prototype.toString=function(){const f=[];var x=this.j;x&&f.push(la(x,no,!0),":");var T=this.g;return(T||x=="file")&&(f.push("//"),(x=this.o)&&f.push(la(x,no,!0),"@"),f.push(xi(T).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.u,T!=null&&f.push(":",String(T))),(T=this.h)&&(this.g&&T.charAt(0)!="/"&&f.push("/"),f.push(la(T,T.charAt(0)=="/"?zl:Ou,!0))),(T=this.i.toString())&&f.push("?",T),(T=this.m)&&f.push("#",la(T,Mu)),f.join("")},Qn.prototype.resolve=function(f){const x=Ft(this);let T=!!f.j;T?an(x,f.j):T=!!f.o,T?x.o=f.o:T=!!f.g,T?x.g=f.g:T=f.u!=null;var L=f.h;if(T)es(x,f.u);else if(T=!!f.h){if(L.charAt(0)!="/")if(this.g&&!this.h)L="/"+L;else{var re=x.h.lastIndexOf("/");re!=-1&&(L=x.h.slice(0,re+1)+L)}if(re=L,re==".."||re==".")L="";else if(re.indexOf("./")!=-1||re.indexOf("/.")!=-1){L=re.lastIndexOf("/",0)==0,re=re.split("/");const ue=[];for(let we=0;we<re.length;){const Fe=re[we++];Fe=="."?L&&we==re.length&&ue.push(""):Fe==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),L&&we==re.length&&ue.push("")):(ue.push(Fe),L=!0)}L=ue.join("/")}else L=re}return T?x.h=L:T=f.i.toString()!=="",T?Vl(x,Nu(f.i)):T=!!f.m,T&&(x.m=f.m),x};function Ft(f){return new Qn(f)}function an(f,x,T){f.j=T?Jr(x,!0):x,f.j&&(f.j=f.j.replace(/:$/,""))}function es(f,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);f.u=x}else f.u=null}function Vl(f,x,T){x instanceof ns?(f.i=x,io(f.i,f.l)):(T||(x=la(x,ts)),f.i=new ns(x,f.l))}function ot(f,x,T){f.i.set(x,T)}function oa(f){return ot(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function Jr(f,x){return f?x?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function la(f,x,T){return typeof f=="string"?(f=encodeURI(f).replace(x,On),T&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function On(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var no=/[#\/\?@]/g,Ou=/[#\?:]/g,zl=/[#\?]/g,ts=/[#\?@]/g,Mu=/#/g;function ns(f,x){this.h=this.g=null,this.i=f||null,this.j=!!x}function Mn(f){f.g||(f.g=new Map,f.h=0,f.i&&to(f.i,function(x,T){f.add(decodeURIComponent(x.replace(/\+/g," ")),T)}))}t=ns.prototype,t.add=function(f,x){Mn(this),this.i=null,f=rs(this,f);let T=this.g.get(f);return T||this.g.set(f,T=[]),T.push(x),this.h+=1,this};function ku(f,x){Mn(f),x=rs(f,x),f.g.has(x)&&(f.i=null,f.h-=f.g.get(x).length,f.g.delete(x))}function Ul(f,x){return Mn(f),x=rs(f,x),f.g.has(x)}t.forEach=function(f,x){Mn(this),this.g.forEach(function(T,L){T.forEach(function(re){f.call(x,re,L,this)},this)},this)};function Bl(f,x){Mn(f);let T=[];if(typeof x=="string")Ul(f,x)&&(T=T.concat(f.g.get(rs(f,x))));else for(f=Array.from(f.g.values()),x=0;x<f.length;x++)T=T.concat(f[x]);return T}t.set=function(f,x){return Mn(this),this.i=null,f=rs(this,f),Ul(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[x]),this.h+=1,this},t.get=function(f,x){return f?(f=Bl(this,f),f.length>0?String(f[0]):x):x};function ro(f,x,T){ku(f,x),T.length>0&&(f.i=null,f.g.set(rs(f,x),w(T)),f.h+=T.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],x=Array.from(this.g.keys());for(let L=0;L<x.length;L++){var T=x[L];const re=xi(T);T=Bl(this,T);for(let ue=0;ue<T.length;ue++){let we=re;T[ue]!==""&&(we+="="+xi(T[ue])),f.push(we)}}return this.i=f.join("&")};function Nu(f){const x=new ns;return x.i=f.i,f.g&&(x.g=new Map(f.g),x.h=f.h),x}function rs(f,x){return x=String(x),f.j&&(x=x.toLowerCase()),x}function io(f,x){x&&!f.j&&(Mn(f),f.i=null,f.g.forEach(function(T,L){const re=L.toLowerCase();L!=re&&(ku(this,L),ro(this,re,T))},f)),f.j=x}function Rr(f,x){const T=new Tr;if(c.Image){const L=new Image;L.onload=_(lr,T,"TestLoadImage: loaded",!0,x,L),L.onerror=_(lr,T,"TestLoadImage: error",!1,x,L),L.onabort=_(lr,T,"TestLoadImage: abort",!1,x,L),L.ontimeout=_(lr,T,"TestLoadImage: timeout",!1,x,L),c.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=f}else x(!1)}function Fl(f,x){const T=new Tr,L=new AbortController,re=setTimeout(()=>{L.abort(),lr(T,"TestPingServer: timeout",!1,x)},1e4);fetch(f,{signal:L.signal}).then(ue=>{clearTimeout(re),ue.ok?lr(T,"TestPingServer: ok",!0,x):lr(T,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(re),lr(T,"TestPingServer: error",!1,x)})}function lr(f,x,T,L,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),L(T)}catch{}}function is(){this.g=new Eu}function Zr(f){this.i=f.Sb||null,this.h=f.ab||!1}v(Zr,wu),Zr.prototype.g=function(){return new ca(this.i,this.h)};function ca(f,x){Ct.call(this),this.H=f,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(ca,Ct),t=ca.prototype,t.open=function(f,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=x,this.readyState=1,Dr(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(x.body=f),(this.H||c).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ss(this)),this.readyState=0},t.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Dr(this)),this.g&&(this.readyState=3,Dr(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;so(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function so(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}t.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var x=f.value?f.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!f.done}))&&(this.response=this.responseText+=x)}f.done?ss(this):Dr(this),this.readyState==3&&so(this)}},t.Oa=function(f){this.g&&(this.response=this.responseText=f,ss(this))},t.Na=function(f){this.g&&(this.response=f,ss(this))},t.ga=function(){this.g&&ss(this)};function ss(f){f.readyState=4,f.l=null,f.j=null,f.B=null,Dr(f)}t.setRequestHeader=function(f,x){this.A.append(f,x)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],x=this.h.entries();for(var T=x.next();!T.done;)T=T.value,f.push(T[0]+": "+T[1]),T=x.next();return f.join(`\r
`)};function Dr(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function cr(f){let x="";return de(f,function(T,L){x+=L,x+=":",x+=T,x+=`\r
`}),x}function ua(f,x,T){e:{for(L in T){var L=!1;break e}L=!0}L||(T=cr(T),typeof f=="string"?T!=null&&xi(T):ot(f,x,T))}function ut(f){Ct.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ut,Ct);var ei=/^https?$/i,ql=["POST","PUT"];t=ut.prototype,t.Fa=function(f){this.H=f},t.ea=function(f,x,T,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);x=x?x.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ol.g(),this.g.onreadystatechange=b(g(this.Ca,this));try{this.B=!0,this.g.open(x,String(f),!0),this.B=!1}catch(ue){da(this,ue);return}if(f=T||"",T=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var re in L)T.set(re,L[re]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const ue of L.keys())T.set(ue,L.get(ue));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(T.keys()).find(ue=>ue.toLowerCase()=="content-type"),re=c.FormData&&f instanceof c.FormData,!(Array.prototype.indexOf.call(ql,x,void 0)>=0)||L||re||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,we]of T)this.g.setRequestHeader(ue,we);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(ue){da(this,ue)}};function da(f,x){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=x,f.o=5,Hl(f),Ei(f)}function Hl(f){f.A||(f.A=!0,jt(f,"complete"),jt(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,jt(this,"complete"),jt(this,"abort"),Ei(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ei(this,!0)),ut.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ha(this):this.Xa())},t.Xa=function(){ha(this)};function ha(f){if(f.h&&typeof l<"u"){if(f.v&&Ir(f)==4)setTimeout(f.Ca.bind(f),0);else if(jt(f,"readystatechange"),Ir(f)==4){f.h=!1;try{const ue=f.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var T;if(!(T=x)){var L;if(L=ue===0){let we=String(f.D).match(ju)[1]||null;!we&&c.self&&c.self.location&&(we=c.self.location.protocol.slice(0,-1)),L=!ei.test(we?we.toLowerCase():"")}T=L}if(T)jt(f,"complete"),jt(f,"success");else{f.o=6;try{var re=Ir(f)>2?f.g.statusText:""}catch{re=""}f.l=re+" ["+f.ca()+"]",Hl(f)}}finally{Ei(f)}}}}function Ei(f,x){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const T=f.g;f.g=null,x||jt(f,"ready");try{T.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ir(f){return f.g?f.g.readyState:0}t.ca=function(){try{return Ir(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(f){if(this.g){var x=this.g.responseText;return f&&x.indexOf(f)==0&&(x=x.substring(f.length)),vf(x)}};function fn(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function wi(f){const x={};f=(f.g&&Ir(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<f.length;L++){if(R(f[L]))continue;var T=Ru(f[L]);const re=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const ue=x[re]||[];x[re]=ue,ue.push(T)}ne(x,function(L){return L.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ti(f,x,T){return T&&T.internalChannelParams&&T.internalChannelParams[f]||x}function as(f){this.za=0,this.i=[],this.j=new Tr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ti("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ti("baseRetryDelayMs",5e3,f),this.Za=ti("retryDelaySeedMs",1e4,f),this.Ta=ti("forwardChannelMaxRetries",2,f),this.va=ti("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new Ml(f&&f.concurrentRequestLimit),this.Ba=new is,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=as.prototype,t.ka=8,t.I=1,t.connect=function(f,x,T,L){zt(0),this.W=f,this.H=x||{},T&&L!==void 0&&(this.H.OSID=T,this.H.OAID=L),this.F=this.X,this.J=Fu(this,null,this.W),ni(this)};function Gl(f){if(ao(f),f.I==3){var x=f.V++,T=Ft(f.J);if(ot(T,"SID",f.M),ot(T,"RID",x),ot(T,"TYPE","terminate"),fa(f,T),x=new Ar(f,f.j,x),x.M=2,x.A=oa(Ft(T)),T=!1,c.navigator&&c.navigator.sendBeacon)try{T=c.navigator.sendBeacon(x.A.toString(),"")}catch{}!T&&c.Image&&(new Image().src=x.A,T=!0),T||(x.g=qu(x.j,null),x.g.ea(x.A)),x.F=Date.now(),Qr(x)}Bu(f)}function os(f){f.g&&(Ql(f),f.g.cancel(),f.g=null)}function ao(f){os(f),f.v&&(c.clearTimeout(f.v),f.v=null),lo(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&c.clearTimeout(f.m),f.m=null)}function ni(f){if(!kl(f.h)&&!f.m){f.m=!0;var x=f.Ea;J||D(),me||(J(),me=!0),P.add(x,f),f.D=0}}function oo(f,x){return Yr(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=x.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=Hr(g(f.Ea,f,x),Uu(f,f.D)),f.D++,!0)}t.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const re=new Ar(this,this.j,f);let ue=this.o;if(this.U&&(ue?(ue=B(ue),G(ue,this.U)):ue=this.U),this.u!==null||this.R||(re.J=ue,ue=null),this.S)e:{for(var x=0,T=0;T<this.i.length;T++){t:{var L=this.i[T];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(x+=L,x>4096){x=T;break e}if(x===4096||T===this.i.length-1){x=T+1;break e}}x=1e3}else x=1e3;x=Pu(this,re,x),T=Ft(this.J),ot(T,"RID",f),ot(T,"CVER",22),this.G&&ot(T,"X-HTTP-Session-Id",this.G),fa(this,T),ue&&(this.R?x="headers="+xi(cr(ue))+"&"+x:this.u&&ua(T,this.u,ue)),Nl(this.h,re),this.Ra&&ot(T,"TYPE","init"),this.S?(ot(T,"$req",x),ot(T,"SID","null"),re.U=!0,$r(re,T,null)):$r(re,T,x),this.I=2}}else this.I==3&&(f?$l(this,f):this.i.length==0||kl(this.h)||$l(this))};function $l(f,x){var T;x?T=x.l:T=f.V++;const L=Ft(f.J);ot(L,"SID",f.M),ot(L,"RID",T),ot(L,"AID",f.K),fa(f,L),f.u&&f.o&&ua(L,f.u,f.o),T=new Ar(f,f.j,T,f.D+1),f.u===null&&(T.J=f.o),x&&(f.i=x.G.concat(f.i)),x=Pu(f,T,1e3),T.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),Nl(f.h,T),$r(T,L,x)}function fa(f,x){f.H&&de(f.H,function(T,L){ot(x,L,T)}),f.l&&de({},function(T,L){ot(x,L,T)})}function Pu(f,x,T){T=Math.min(f.i.length,T);const L=f.l?g(f.l.Ka,f.l,f):null;e:{var re=f.i;let Fe=-1;for(;;){const Mt=["count="+T];Fe==-1?T>0?(Fe=re[0].g,Mt.push("ofs="+Fe)):Fe=0:Mt.push("ofs="+Fe);let it=!0;for(let Et=0;Et<T;Et++){var ue=re[Et].g;const ur=re[Et].map;if(ue-=Fe,ue<0)Fe=Math.max(0,re[Et].g-100),it=!1;else try{ue="req"+ue+"_"||"";try{var we=ur instanceof Map?ur:Object.entries(ur);for(const[ii,jr]of we){let Or=jr;h(jr)&&(Or=Zi(jr)),Mt.push(ue+ii+"="+encodeURIComponent(Or))}}catch(ii){throw Mt.push(ue+"type="+encodeURIComponent("_badmap")),ii}}catch{L&&L(ur)}}if(it){we=Mt.join("&");break e}}we=void 0}return f=f.i.splice(0,T),x.G=f,we}function Lu(f){if(!f.g&&!f.v){f.Y=1;var x=f.Da;J||D(),me||(J(),me=!0),P.add(x,f),f.A=0}}function ma(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=Hr(g(f.Da,f),Uu(f,f.A)),f.A++,!0)}t.Da=function(){if(this.v=null,Vu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=Hr(g(this.Wa,this),f)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,zt(10),os(this),Vu(this))};function Ql(f){f.B!=null&&(c.clearTimeout(f.B),f.B=null)}function Vu(f){f.g=new Ar(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var x=Ft(f.na);ot(x,"RID","rpc"),ot(x,"SID",f.M),ot(x,"AID",f.K),ot(x,"CI",f.F?"0":"1"),!f.F&&f.ia&&ot(x,"TO",f.ia),ot(x,"TYPE","xmlhttp"),fa(f,x),f.u&&f.o&&ua(x,f.u,f.o),f.O&&(f.g.H=f.O);var T=f.g;f=f.ba,T.M=1,T.A=oa(Ft(x)),T.u=null,T.R=!0,Za(T,f)}t.Va=function(){this.C!=null&&(this.C=null,os(this),ma(this),zt(19))};function lo(f){f.C!=null&&(c.clearTimeout(f.C),f.C=null)}function zu(f,x){var T=null;if(f.g==x){lo(f),Ql(f),f.g=null;var L=2}else if(Xr(f.h,x))T=x.G,Pl(f.h,x),L=1;else return;if(f.I!=0){if(x.o)if(L==1){T=x.u?x.u.length:0,x=Date.now()-x.F;var re=f.D;L=Ja(),jt(L,new qr(L,T)),ni(f)}else Lu(f);else if(re=x.m,re==3||re==0&&x.X>0||!(L==1&&oo(f,x)||L==2&&ma(f)))switch(T&&T.length>0&&(x=f.h,x.i=x.i.concat(T)),re){case 1:ri(f,5);break;case 4:ri(f,10);break;case 3:ri(f,6);break;default:ri(f,2)}}}function Uu(f,x){let T=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(T*=2),T*x}function ri(f,x){if(f.j.info("Error code "+x),x==2){var T=g(f.bb,f),L=f.Ua;const re=!L;L=new Qn(L||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||an(L,"https"),oa(L),re?Rr(L.toString(),T):Fl(L.toString(),T)}else zt(2);f.I=0,f.l&&f.l.pa(x),Bu(f),ao(f)}t.bb=function(f){f?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function Bu(f){if(f.I=0,f.ja=[],f.l){const x=Ll(f.h);(x.length!=0||f.i.length!=0)&&(A(f.ja,x),A(f.ja,f.i),f.h.i.length=0,w(f.i),f.i.length=0),f.l.oa()}}function Fu(f,x,T){var L=T instanceof Qn?Ft(T):new Qn(T);if(L.g!="")x&&(L.g=x+"."+L.g),es(L,L.u);else{var re=c.location;L=re.protocol,x=x?x+"."+re.hostname:re.hostname,re=+re.port;const ue=new Qn(null);L&&an(ue,L),x&&(ue.g=x),re&&es(ue,re),T&&(ue.h=T),L=ue}return T=f.G,x=f.wa,T&&x&&ot(L,T,x),ot(L,"VER",f.ka),fa(f,L),L}function qu(f,x,T){if(x&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=f.Aa&&!f.ma?new ut(new Zr({ab:T})):new ut(f.ma),x.Fa(f.L),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hu(){}t=Hu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ls(){}ls.prototype.g=function(f,x){return new Rn(f,x)};function Rn(f,x){Ct.call(this),this.g=new as(x),this.l=f,this.h=x&&x.messageUrlParams||null,f=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(f?f["X-WebChannel-Content-Type"]=x.messageContentType:f={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(f?f["X-WebChannel-Client-Profile"]=x.sa:f={"X-WebChannel-Client-Profile":x.sa}),this.g.U=f,(f=x&&x.Qb)&&!R(f)&&(this.g.u=f),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!R(x)&&(this.g.G=x,f=this.h,f!==null&&x in f&&(f=this.h,x in f&&delete f[x])),this.j=new Si(this)}v(Rn,Ct),Rn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Rn.prototype.close=function(){Gl(this.g)},Rn.prototype.o=function(f){var x=this.g;if(typeof f=="string"){var T={};T.__data__=f,f=T}else this.v&&(T={},T.__data__=Zi(f),f=T);x.i.push(new Bt(x.Ya++,f)),x.I==3&&ni(x)},Rn.prototype.N=function(){this.g.l=null,delete this.j,Gl(this.g),delete this.g,Rn.Z.N.call(this)};function Gu(f){hn.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var x=f.__sm__;if(x){e:{for(const T in x){f=T;break e}f=void 0}(this.i=f)&&(f=this.i,x=x!==null&&f in x?x[f]:void 0),this.data=x}else this.data=f}v(Gu,hn);function $u(){ar.call(this),this.status=1}v($u,ar);function Si(f){this.g=f}v(Si,Hu),Si.prototype.ra=function(){jt(this.g,"a")},Si.prototype.qa=function(f){jt(this.g,new Gu(f))},Si.prototype.pa=function(f){jt(this.g,new $u)},Si.prototype.oa=function(){jt(this.g,"b")},ls.prototype.createWebChannel=ls.prototype.g,Rn.prototype.send=Rn.prototype.o,Rn.prototype.open=Rn.prototype.m,Rn.prototype.close=Rn.prototype.close,Vw=function(){return new ls},Lw=function(){return Ja()},Pw=Ot,ng={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},sa.NO_ERROR=0,sa.TIMEOUT=8,sa.HTTP_ERROR=6,ah=sa,jl.COMPLETE="complete",Nw=jl,Su.EventType=Sr,Sr.OPEN="a",Sr.CLOSE="b",Sr.ERROR="c",Sr.MESSAGE="d",Ct.prototype.listen=Ct.prototype.J,Nc=Su,ut.prototype.listenOnce=ut.prototype.K,ut.prototype.getLastError=ut.prototype.Ha,ut.prototype.getLastErrorCode=ut.prototype.ya,ut.prototype.getStatus=ut.prototype.ca,ut.prototype.getResponseJson=ut.prototype.La,ut.prototype.getResponseText=ut.prototype.la,ut.prototype.send=ut.prototype.ea,ut.prototype.setWithCredentials=ut.prototype.Fa,kw=ut}).apply(typeof Jd<"u"?Jd:typeof self<"u"?self:typeof window<"u"?window:{});const Zb="@firebase/firestore",ex="4.9.3";class Sn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sn.UNAUTHENTICATED=new Sn(null),Sn.GOOGLE_CREDENTIALS=new Sn("google-credentials-uid"),Sn.FIRST_PARTY=new Sn("first-party-uid"),Sn.MOCK_USER=new Sn("mock-user");let vl="12.7.0";const Va=new Bg("@firebase/firestore");function qo(){return Va.logLevel}function Ae(t,...e){if(Va.logLevel<=Ye.DEBUG){const n=e.map(Hg);Va.debug(`Firestore (${vl}): ${t}`,...n)}}function Qi(t,...e){if(Va.logLevel<=Ye.ERROR){const n=e.map(Hg);Va.error(`Firestore (${vl}): ${t}`,...n)}}function tl(t,...e){if(Va.logLevel<=Ye.WARN){const n=e.map(Hg);Va.warn(`Firestore (${vl}): ${t}`,...n)}}function Hg(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Pe(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,zw(t,i,n)}function zw(t,e,n){let i=`FIRESTORE (${vl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Qi(i),new Error(i)}function at(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||zw(e,a,i)}function Ue(t,e){return t}const _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends Yi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Hi{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class Uw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Nj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Sn.UNAUTHENTICATED)))}shutdown(){}}class Pj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class Lj{constructor(e){this.t=e,this.currentUser=Sn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){at(this.o===void 0,42304);let i=this.i;const a=m=>this.i!==i?(i=this.i,n(m)):Promise.resolve();let l=new Hi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Hi,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},h=m=>{Ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((m=>h(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?h(m):(Ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Hi)}}),0),c()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(Ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(at(typeof i.accessToken=="string",31837,{l:i}),new Uw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return at(e===null||typeof e=="string",2055,{h:e}),new Sn(e)}}class Vj{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=Sn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class zj{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new Vj(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Sn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Uj{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Lr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){at(this.o===void 0,3512);const i=l=>{l.error!=null&&Ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Ae("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{Ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(at(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new tx(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Bj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class Gg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=Bj(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function Xe(t,e){return t<e?-1:t>e?1:0}function rg(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return Ip(a)===Ip(l)?Xe(a,l):Ip(a)?1:-1}return Xe(t.length,e.length)}const Fj=55296,qj=57343;function Ip(t){const e=t.charCodeAt(0);return e>=Fj&&e<=qj}function nl(t,e,n){return t.length===e.length&&t.every(((i,a)=>n(i,e[a])))}const nx="__name__";class ci{constructor(e,n,i){n===void 0?n=0:n>e.length&&Pe(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Pe(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return ci.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ci?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=ci.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return Xe(e.length,n.length)}static compareSegments(e,n){const i=ci.isNumericId(e),a=ci.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?ci.extractNumericId(e).compare(ci.extractNumericId(n)):rg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return qs.fromString(e.substring(4,e.length-2))}}class _t extends ci{construct(e,n,i){return new _t(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new Te(_e.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((a=>a.length>0)))}return new _t(n)}static emptyPath(){return new _t([])}}const Hj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vn extends ci{construct(e,n,i){return new vn(e,n,i)}static isValidIdentifier(e){return Hj.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nx}static keyField(){return new vn([nx])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new Te(_e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let c=!1;for(;a<e.length;){const h=e[a];if(h==="\\"){if(a+1===e.length)throw new Te(_e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Te(_e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=m,a+=2}else h==="`"?(c=!c,a++):h!=="."||c?(i+=h,a++):(l(),a++)}if(l(),c)throw new Te(_e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vn(n)}static emptyPath(){return new vn([])}}class Oe{constructor(e){this.path=e}static fromPath(e){return new Oe(_t.fromString(e))}static fromName(e){return new Oe(_t.fromString(e).popFirst(5))}static empty(){return new Oe(_t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&_t.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return _t.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Oe(new _t(e.slice()))}}function Bw(t,e,n){if(!n)throw new Te(_e.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Gj(t,e,n,i){if(e===!0&&i===!0)throw new Te(_e.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function rx(t){if(!Oe.isDocumentKey(t))throw new Te(_e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ix(t){if(Oe.isDocumentKey(t))throw new Te(_e.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Fw(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Wh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Pe(12329,{type:typeof t})}function vi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Te(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Wh(t);throw new Te(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Xt(t,e){const n={typeString:t};return e&&(n.value=e),n}function cu(t,e){if(!Fw(t))throw new Te(_e.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const c=t[i];if(a&&typeof c!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new Te(_e.INVALID_ARGUMENT,n);return!0}const sx=-62135596800,ax=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*ax);return new xt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Te(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Te(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<sx)throw new Te(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ax}_compareTo(e){return this.seconds===e.seconds?Xe(this.nanoseconds,e.nanoseconds):Xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(cu(e,xt._jsonSchema))return new xt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-sx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xt._jsonSchemaVersion="firestore/timestamp/1.0",xt._jsonSchema={type:Xt("string",xt._jsonSchemaVersion),seconds:Xt("number"),nanoseconds:Xt("number")};class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new xt(0,0))}static max(){return new Ve(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Kc=-1;function $j(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Ve.fromTimestamp(i===1e9?new xt(n+1,0):new xt(n,i));return new Qs(a,Oe.empty(),e)}function Qj(t){return new Qs(t.readTime,t.key,Kc)}class Qs{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Qs(Ve.min(),Oe.empty(),Kc)}static max(){return new Qs(Ve.max(),Oe.empty(),Kc)}}function Wj(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Oe.comparator(t.documentKey,e.documentKey),n!==0?n:Xe(t.largestBatchId,e.largestBatchId))}const Kj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Yj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function bl(t){if(t.code!==_e.FAILED_PRECONDITION||t.message!==Kj)throw t;Ae("LocalStore","Unexpectedly lost primary lease")}class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ve(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof ve?n:ve.resolve(n)}catch(n){return ve.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):ve.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):ve.reject(n)}static resolve(e){return new ve(((n,i)=>{n(e)}))}static reject(e){return new ve(((n,i)=>{i(e)}))}static waitFor(e){return new ve(((n,i)=>{let a=0,l=0,c=!1;e.forEach((h=>{++a,h.next((()=>{++l,c&&l===a&&n()}),(m=>i(m)))})),c=!0,l===a&&n()}))}static or(e){let n=ve.resolve(!1);for(const i of e)n=n.next((a=>a?ve.resolve(a):i()));return n}static forEach(e,n){const i=[];return e.forEach(((a,l)=>{i.push(n.call(this,a,l))})),this.waitFor(i)}static mapArray(e,n){return new ve(((i,a)=>{const l=e.length,c=new Array(l);let h=0;for(let m=0;m<l;m++){const g=m;n(e[g]).next((_=>{c[g]=_,++h,h===l&&i(c)}),(_=>a(_)))}}))}static doWhile(e,n){return new ve(((i,a)=>{const l=()=>{e()===!0?n().next((()=>{l()}),a):i()};l()}))}}function Xj(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function xl(t){return t.name==="IndexedDbTransactionError"}class Kh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Kh.ce=-1;const $g=-1;function Yh(t){return t==null}function wh(t){return t===0&&1/t==-1/0}function Jj(t){return typeof t=="number"&&Number.isInteger(t)&&!wh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const qw="";function Zj(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ox(e)),e=e2(t.get(n),e);return ox(e)}function e2(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case qw:n+="";break;default:n+=l}}return n}function ox(t){return t+qw+""}function lx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ea(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Hw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class At{constructor(e,n){this.comparator=e,this.root=n||_n.EMPTY}insert(e,n){return new At(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new At(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zd(this.root,e,this.comparator,!0)}}class Zd{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _n{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??_n.RED,this.left=a??_n.EMPTY,this.right=l??_n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new _n(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return _n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return _n.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pe(27949);return e+(this.isRed()?0:1)}}_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe(57766)}get value(){throw Pe(16141)}get color(){throw Pe(16727)}get left(){throw Pe(29726)}get right(){throw Pe(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new _n(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class tn{constructor(e){this.comparator=e,this.data=new At(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new cx(this.data.getIterator())}getIteratorFrom(e){return new cx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof tn)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new tn(this.comparator);return n.data=e,n}}class cx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class tr{constructor(e){this.fields=e,e.sort(vn.comparator)}static empty(){return new tr([])}unionWith(e){let n=new tn(vn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new tr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return nl(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class Gw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class xn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new Gw("Invalid base64 string: "+l):l}})(e);return new xn(n)}static fromUint8Array(e){const n=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new xn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xn.EMPTY_BYTE_STRING=new xn("");const t2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ws(t){if(at(!!t,39018),typeof t=="string"){let e=0;const n=t2.exec(t);if(at(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Pt(t.seconds),nanos:Pt(t.nanos)}}function Pt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ks(t){return typeof t=="string"?xn.fromBase64String(t):xn.fromUint8Array(t)}const $w="server_timestamp",Qw="__type__",Ww="__previous_value__",Kw="__local_write_time__";function Qg(t){return(t?.mapValue?.fields||{})[Qw]?.stringValue===$w}function Xh(t){const e=t.mapValue.fields[Ww];return Qg(e)?Xh(e):e}function Yc(t){const e=Ws(t.mapValue.fields[Kw].timestampValue);return new xt(e.seconds,e.nanos)}class n2{constructor(e,n,i,a,l,c,h,m,g,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=m,this.useFetchStreams=g,this.isUsingEmulator=_}}const Sh="(default)";class Xc{constructor(e,n){this.projectId=e,this.database=n||Sh}static empty(){return new Xc("","")}get isDefaultDatabase(){return this.database===Sh}isEqual(e){return e instanceof Xc&&e.projectId===this.projectId&&e.database===this.database}}const Yw="__type__",r2="__max__",eh={mapValue:{}},Xw="__vector__",Th="value";function Ys(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Qg(t)?4:s2(t)?9007199254740991:i2(t)?10:11:Pe(28295,{value:t})}function bi(t,e){if(t===e)return!0;const n=Ys(t);if(n!==Ys(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Yc(t).isEqual(Yc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=Ws(a.timestampValue),h=Ws(l.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return Ks(a.bytesValue).isEqual(Ks(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return Pt(a.geoPointValue.latitude)===Pt(l.geoPointValue.latitude)&&Pt(a.geoPointValue.longitude)===Pt(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Pt(a.integerValue)===Pt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=Pt(a.doubleValue),h=Pt(l.doubleValue);return c===h?wh(c)===wh(h):isNaN(c)&&isNaN(h)}return!1})(t,e);case 9:return nl(t.arrayValue.values||[],e.arrayValue.values||[],bi);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},h=l.mapValue.fields||{};if(lx(c)!==lx(h))return!1;for(const m in c)if(c.hasOwnProperty(m)&&(h[m]===void 0||!bi(c[m],h[m])))return!1;return!0})(t,e);default:return Pe(52216,{left:t})}}function Jc(t,e){return(t.values||[]).find((n=>bi(n,e)))!==void 0}function rl(t,e){if(t===e)return 0;const n=Ys(t),i=Ys(e);if(n!==i)return Xe(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Xe(t.booleanValue,e.booleanValue);case 2:return(function(l,c){const h=Pt(l.integerValue||l.doubleValue),m=Pt(c.integerValue||c.doubleValue);return h<m?-1:h>m?1:h===m?0:isNaN(h)?isNaN(m)?0:-1:1})(t,e);case 3:return ux(t.timestampValue,e.timestampValue);case 4:return ux(Yc(t),Yc(e));case 5:return rg(t.stringValue,e.stringValue);case 6:return(function(l,c){const h=Ks(l),m=Ks(c);return h.compareTo(m)})(t.bytesValue,e.bytesValue);case 7:return(function(l,c){const h=l.split("/"),m=c.split("/");for(let g=0;g<h.length&&g<m.length;g++){const _=Xe(h[g],m[g]);if(_!==0)return _}return Xe(h.length,m.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,c){const h=Xe(Pt(l.latitude),Pt(c.latitude));return h!==0?h:Xe(Pt(l.longitude),Pt(c.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return dx(t.arrayValue,e.arrayValue);case 10:return(function(l,c){const h=l.fields||{},m=c.fields||{},g=h[Th]?.arrayValue,_=m[Th]?.arrayValue,v=Xe(g?.values?.length||0,_?.values?.length||0);return v!==0?v:dx(g,_)})(t.mapValue,e.mapValue);case 11:return(function(l,c){if(l===eh.mapValue&&c===eh.mapValue)return 0;if(l===eh.mapValue)return 1;if(c===eh.mapValue)return-1;const h=l.fields||{},m=Object.keys(h),g=c.fields||{},_=Object.keys(g);m.sort(),_.sort();for(let v=0;v<m.length&&v<_.length;++v){const b=rg(m[v],_[v]);if(b!==0)return b;const w=rl(h[m[v]],g[_[v]]);if(w!==0)return w}return Xe(m.length,_.length)})(t.mapValue,e.mapValue);default:throw Pe(23264,{he:n})}}function ux(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Xe(t,e);const n=Ws(t),i=Ws(e),a=Xe(n.seconds,i.seconds);return a!==0?a:Xe(n.nanos,i.nanos)}function dx(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=rl(n[a],i[a]);if(l)return l}return Xe(n.length,i.length)}function il(t){return ig(t)}function ig(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=Ws(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Ks(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return Oe.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=ig(l);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const c of i)l?l=!1:a+=",",a+=`${c}:${ig(n.fields[c])}`;return a+"}"})(t.mapValue):Pe(61005,{value:t})}function oh(t){switch(Ys(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Xh(t);return e?16+oh(e):16;case 5:return 2*t.stringValue.length;case 6:return Ks(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+oh(l)),0)})(t.arrayValue);case 10:case 11:return(function(i){let a=0;return ea(i.fields,((l,c)=>{a+=l.length+oh(c)})),a})(t.mapValue);default:throw Pe(13486,{value:t})}}function hx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function sg(t){return!!t&&"integerValue"in t}function Wg(t){return!!t&&"arrayValue"in t}function fx(t){return!!t&&"nullValue"in t}function mx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function lh(t){return!!t&&"mapValue"in t}function i2(t){return(t?.mapValue?.fields||{})[Yw]?.stringValue===Xw}function Uc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ea(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=Uc(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Uc(t.arrayValue.values[n]);return e}return{...t}}function s2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===r2}class Un{constructor(e){this.value=e}static empty(){return new Un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!lh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Uc(n)}setAll(e){let n=vn.emptyPath(),i={},a=[];e.forEach(((c,h)=>{if(!n.isImmediateParentOf(h)){const m=this.getFieldsMap(n);this.applyChanges(m,i,a),i={},a=[],n=h.popLast()}c?i[h.lastSegment()]=Uc(c):a.push(h.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());lh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return bi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];lh(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){ea(n,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new Un(Uc(this.value))}}function Jw(t){const e=[];return ea(t.fields,((n,i)=>{const a=new vn([n]);if(lh(i)){const l=Jw(i.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new tr(e)}class Tn{constructor(e,n,i,a,l,c,h){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=c,this.documentState=h}static newInvalidDocument(e){return new Tn(e,0,Ve.min(),Ve.min(),Ve.min(),Un.empty(),0)}static newFoundDocument(e,n,i,a){return new Tn(e,1,n,Ve.min(),i,a,0)}static newNoDocument(e,n){return new Tn(e,2,n,Ve.min(),Ve.min(),Un.empty(),0)}static newUnknownDocument(e,n){return new Tn(e,3,n,Ve.min(),Ve.min(),Un.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ah{constructor(e,n){this.position=e,this.inclusive=n}}function px(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],c=t.position[a];if(l.field.isKeyField()?i=Oe.comparator(Oe.fromName(c.referenceValue),n.key):i=rl(c,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function gx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!bi(t.position[n],e.position[n]))return!1;return!0}class Ch{constructor(e,n="asc"){this.field=e,this.dir=n}}function a2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Zw{}class Yt extends Zw{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new l2(e,n,i):n==="array-contains"?new d2(e,i):n==="in"?new h2(e,i):n==="not-in"?new f2(e,i):n==="array-contains-any"?new m2(e,i):new Yt(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new c2(e,i):new u2(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(rl(n,this.value)):n!==null&&Ys(this.value)===Ys(n)&&this.matchesComparison(rl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ur extends Zw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ur(e,n)}matches(e){return eS(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function eS(t){return t.op==="and"}function tS(t){return o2(t)&&eS(t)}function o2(t){for(const e of t.filters)if(e instanceof Ur)return!1;return!0}function ag(t){if(t instanceof Yt)return t.field.canonicalString()+t.op.toString()+il(t.value);if(tS(t))return t.filters.map((e=>ag(e))).join(",");{const e=t.filters.map((n=>ag(n))).join(",");return`${t.op}(${e})`}}function nS(t,e){return t instanceof Yt?(function(i,a){return a instanceof Yt&&i.op===a.op&&i.field.isEqual(a.field)&&bi(i.value,a.value)})(t,e):t instanceof Ur?(function(i,a){return a instanceof Ur&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,c,h)=>l&&nS(c,a.filters[h])),!0):!1})(t,e):void Pe(19439)}function rS(t){return t instanceof Yt?(function(n){return`${n.field.canonicalString()} ${n.op} ${il(n.value)}`})(t):t instanceof Ur?(function(n){return n.op.toString()+" {"+n.getFilters().map(rS).join(" ,")+"}"})(t):"Filter"}class l2 extends Yt{constructor(e,n,i){super(e,n,i),this.key=Oe.fromName(i.referenceValue)}matches(e){const n=Oe.comparator(e.key,this.key);return this.matchesComparison(n)}}class c2 extends Yt{constructor(e,n){super(e,"in",n),this.keys=iS("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class u2 extends Yt{constructor(e,n){super(e,"not-in",n),this.keys=iS("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function iS(t,e){return(e.arrayValue?.values||[]).map((n=>Oe.fromName(n.referenceValue)))}class d2 extends Yt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Wg(n)&&Jc(n.arrayValue,this.value)}}class h2 extends Yt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Jc(this.value.arrayValue,n)}}class f2 extends Yt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Jc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Jc(this.value.arrayValue,n)}}class m2 extends Yt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Wg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>Jc(this.value.arrayValue,i)))}}class p2{constructor(e,n=null,i=[],a=[],l=null,c=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=c,this.endAt=h,this.Te=null}}function yx(t,e=null,n=[],i=[],a=null,l=null,c=null){return new p2(t,e,n,i,a,l,c)}function Kg(t){const e=Ue(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>ag(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),Yh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>il(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>il(i))).join(",")),e.Te=n}return e.Te}function Yg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!a2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!nS(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gx(t.startAt,e.startAt)&&gx(t.endAt,e.endAt)}function og(t){return Oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class uu{constructor(e,n=null,i=[],a=[],l=null,c="F",h=null,m=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=c,this.startAt=h,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function g2(t,e,n,i,a,l,c,h){return new uu(t,e,n,i,a,l,c,h)}function Xg(t){return new uu(t)}function _x(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function sS(t){return t.collectionGroup!==null}function Bc(t){const e=Ue(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new tn(vn.comparator);return c.filters.forEach((m=>{m.getFlattenedFilters().forEach((g=>{g.isInequality()&&(h=h.add(g.field))}))})),h})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Ch(l,i))})),n.has(vn.keyField().canonicalString())||e.Ie.push(new Ch(vn.keyField(),i))}return e.Ie}function ui(t){const e=Ue(t);return e.Ee||(e.Ee=y2(e,Bc(t))),e.Ee}function y2(t,e){if(t.limitType==="F")return yx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Ch(a.field,l)}));const n=t.endAt?new Ah(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Ah(t.startAt.position,t.startAt.inclusive):null;return yx(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function lg(t,e){const n=t.filters.concat([e]);return new uu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function cg(t,e,n){return new uu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Jh(t,e){return Yg(ui(t),ui(e))&&t.limitType===e.limitType}function aS(t){return`${Kg(ui(t))}|lt:${t.limitType}`}function Ho(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((a=>rS(a))).join(", ")}]`),Yh(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((a=>il(a))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((a=>il(a))).join(",")),`Target(${i})`})(ui(t))}; limitType=${t.limitType})`}function Zh(t,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Oe.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(t,e)&&(function(i,a){for(const l of Bc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(i,a){return!(i.startAt&&!(function(c,h,m){const g=px(c,h,m);return c.inclusive?g<=0:g<0})(i.startAt,Bc(i),a)||i.endAt&&!(function(c,h,m){const g=px(c,h,m);return c.inclusive?g>=0:g>0})(i.endAt,Bc(i),a))})(t,e)}function _2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function oS(t){return(e,n)=>{let i=!1;for(const a of Bc(t)){const l=v2(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function v2(t,e,n){const i=t.field.isKeyField()?Oe.comparator(e.key,n.key):(function(l,c,h){const m=c.data.field(l),g=h.data.field(l);return m!==null&&g!==null?rl(m,g):Pe(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Pe(19790,{direction:t.dir})}}class Ha{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){ea(this.inner,((n,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return Hw(this.inner)}size(){return this.innerSize}}const b2=new At(Oe.comparator);function Wi(){return b2}const lS=new At(Oe.comparator);function Pc(...t){let e=lS;for(const n of t)e=e.insert(n.key,n);return e}function cS(t){let e=lS;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function Oa(){return Fc()}function uS(){return Fc()}function Fc(){return new Ha((t=>t.toString()),((t,e)=>t.isEqual(e)))}const x2=new At(Oe.comparator),E2=new tn(Oe.comparator);function Je(...t){let e=E2;for(const n of t)e=e.add(n);return e}const w2=new tn(Xe);function S2(){return w2}function Jg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wh(e)?"-0":e}}function dS(t){return{integerValue:""+t}}function T2(t,e){return Jj(e)?dS(e):Jg(t,e)}class ef{constructor(){this._=void 0}}function A2(t,e,n){return t instanceof Rh?(function(a,l){const c={fields:{[Qw]:{stringValue:$w},[Kw]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Qg(l)&&(l=Xh(l)),l&&(c.fields[Ww]=l),{mapValue:c}})(n,e):t instanceof sl?fS(t,e):t instanceof Zc?mS(t,e):(function(a,l){const c=hS(a,l),h=vx(c)+vx(a.Ae);return sg(c)&&sg(a.Ae)?dS(h):Jg(a.serializer,h)})(t,e)}function C2(t,e,n){return t instanceof sl?fS(t,e):t instanceof Zc?mS(t,e):n}function hS(t,e){return t instanceof Dh?(function(i){return sg(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Rh extends ef{}class sl extends ef{constructor(e){super(),this.elements=e}}function fS(t,e){const n=pS(e);for(const i of t.elements)n.some((a=>bi(a,i)))||n.push(i);return{arrayValue:{values:n}}}class Zc extends ef{constructor(e){super(),this.elements=e}}function mS(t,e){let n=pS(e);for(const i of t.elements)n=n.filter((a=>!bi(a,i)));return{arrayValue:{values:n}}}class Dh extends ef{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function vx(t){return Pt(t.integerValue||t.doubleValue)}function pS(t){return Wg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class R2{constructor(e,n){this.field=e,this.transform=n}}function D2(t,e){return t.field.isEqual(e.field)&&(function(i,a){return i instanceof sl&&a instanceof sl||i instanceof Zc&&a instanceof Zc?nl(i.elements,a.elements,bi):i instanceof Dh&&a instanceof Dh?bi(i.Ae,a.Ae):i instanceof Rh&&a instanceof Rh})(t.transform,e.transform)}class I2{constructor(e,n){this.version=e,this.transformResults=n}}class zr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new zr}static exists(e){return new zr(void 0,e)}static updateTime(e){return new zr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ch(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class tf{}function gS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Zg(t.key,zr.none()):new du(t.key,t.data,zr.none());{const n=t.data,i=Un.empty();let a=new tn(vn.comparator);for(let l of e.fields)if(!a.has(l)){let c=n.field(l);c===null&&l.length>1&&(l=l.popLast(),c=n.field(l)),c===null?i.delete(l):i.set(l,c),a=a.add(l)}return new ta(t.key,i,new tr(a.toArray()),zr.none())}}function j2(t,e,n){t instanceof du?(function(a,l,c){const h=a.value.clone(),m=xx(a.fieldTransforms,l,c.transformResults);h.setAll(m),l.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(t,e,n):t instanceof ta?(function(a,l,c){if(!ch(a.precondition,l))return void l.convertToUnknownDocument(c.version);const h=xx(a.fieldTransforms,l,c.transformResults),m=l.data;m.setAll(yS(a)),m.setAll(h),l.convertToFoundDocument(c.version,m).setHasCommittedMutations()})(t,e,n):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,n)}function qc(t,e,n,i){return t instanceof du?(function(l,c,h,m){if(!ch(l.precondition,c))return h;const g=l.value.clone(),_=Ex(l.fieldTransforms,m,c);return g.setAll(_),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),null})(t,e,n,i):t instanceof ta?(function(l,c,h,m){if(!ch(l.precondition,c))return h;const g=Ex(l.fieldTransforms,m,c),_=c.data;return _.setAll(yS(l)),_.setAll(g),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),h===null?null:h.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,n,i):(function(l,c,h){return ch(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(t,e,n)}function O2(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=hS(i.transform,a||null);l!=null&&(n===null&&(n=Un.empty()),n.set(i.field,l))}return n||null}function bx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&nl(i,a,((l,c)=>D2(l,c)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class du extends tf{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ta extends tf{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function yS(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function xx(t,e,n){const i=new Map;at(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],c=l.transform,h=e.data.field(l.field);i.set(l.field,C2(c,h,n[a]))}return i}function Ex(t,e,n){const i=new Map;for(const a of t){const l=a.transform,c=n.data.field(a.field);i.set(a.field,A2(l,c,e))}return i}class Zg extends tf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class M2 extends tf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class k2{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&j2(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=qc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=qc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=uS();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let h=this.applyToLocalView(c,l.mutatedFields);h=n.has(a.key)?null:h;const m=gS(c,h);m!==null&&i.set(a.key,m),c.isValidDocument()||c.convertToNoDocument(Ve.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Je())}isEqual(e){return this.batchId===e.batchId&&nl(this.mutations,e.mutations,((n,i)=>bx(n,i)))&&nl(this.baseMutations,e.baseMutations,((n,i)=>bx(n,i)))}}class ey{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){at(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return x2})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,i[c].version);return new ey(e,n,i,a)}}class N2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class P2{constructor(e,n){this.count=e,this.unchangedNames=n}}var Wt,et;function L2(t){switch(t){case _e.OK:return Pe(64938);case _e.CANCELLED:case _e.UNKNOWN:case _e.DEADLINE_EXCEEDED:case _e.RESOURCE_EXHAUSTED:case _e.INTERNAL:case _e.UNAVAILABLE:case _e.UNAUTHENTICATED:return!1;case _e.INVALID_ARGUMENT:case _e.NOT_FOUND:case _e.ALREADY_EXISTS:case _e.PERMISSION_DENIED:case _e.FAILED_PRECONDITION:case _e.ABORTED:case _e.OUT_OF_RANGE:case _e.UNIMPLEMENTED:case _e.DATA_LOSS:return!0;default:return Pe(15467,{code:t})}}function _S(t){if(t===void 0)return Qi("GRPC error has no .code"),_e.UNKNOWN;switch(t){case Wt.OK:return _e.OK;case Wt.CANCELLED:return _e.CANCELLED;case Wt.UNKNOWN:return _e.UNKNOWN;case Wt.DEADLINE_EXCEEDED:return _e.DEADLINE_EXCEEDED;case Wt.RESOURCE_EXHAUSTED:return _e.RESOURCE_EXHAUSTED;case Wt.INTERNAL:return _e.INTERNAL;case Wt.UNAVAILABLE:return _e.UNAVAILABLE;case Wt.UNAUTHENTICATED:return _e.UNAUTHENTICATED;case Wt.INVALID_ARGUMENT:return _e.INVALID_ARGUMENT;case Wt.NOT_FOUND:return _e.NOT_FOUND;case Wt.ALREADY_EXISTS:return _e.ALREADY_EXISTS;case Wt.PERMISSION_DENIED:return _e.PERMISSION_DENIED;case Wt.FAILED_PRECONDITION:return _e.FAILED_PRECONDITION;case Wt.ABORTED:return _e.ABORTED;case Wt.OUT_OF_RANGE:return _e.OUT_OF_RANGE;case Wt.UNIMPLEMENTED:return _e.UNIMPLEMENTED;case Wt.DATA_LOSS:return _e.DATA_LOSS;default:return Pe(39323,{code:t})}}(et=Wt||(Wt={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";function V2(){return new TextEncoder}const z2=new qs([4294967295,4294967295],0);function wx(t){const e=V2().encode(t),n=new Mw;return n.update(e),new Uint8Array(n.digest())}function Sx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new qs([n,i],0),new qs([a,l],0)]}class ty{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Lc(`Invalid padding: ${n}`);if(i<0)throw new Lc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Lc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Lc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=qs.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(qs.fromNumber(i)));return a.compare(z2)===1&&(a=new qs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=wx(e),[i,a]=Sx(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);if(!this.we(c))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new ty(l,a,n);return i.forEach((h=>c.insert(h))),c}insert(e){if(this.ge===0)return;const n=wx(e),[i,a]=Sx(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);this.Se(c)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Lc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class nf{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,hu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new nf(Ve.min(),a,new At(Xe),Wi(),Je())}}class hu{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new hu(i,n,Je(),Je(),Je())}}class uh{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class vS{constructor(e,n){this.targetId=e,this.Ce=n}}class bS{constructor(e,n,i=xn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class Tx{constructor(){this.ve=0,this.Fe=Ax(),this.Me=xn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Je(),n=Je(),i=Je();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:Pe(38017,{changeType:l})}})),new hu(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=Ax()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,at(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class U2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Wi(),this.Je=th(),this.He=th(),this.Ye=new At(Xe)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Pe(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(og(l))if(i===0){const c=new Oe(l.path);this.et(n,c,Tn.newNoDocument(c,Ve.min()))}else at(i===1,20013,{expectedCount:i});else{const c=this._t(n);if(c!==i){const h=this.ut(e),m=h?this.ct(h,e,c):1;if(m!==0){this.it(n);const g=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,g)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let c,h;try{c=Ks(i).toUint8Array()}catch(m){if(m instanceof Gw)return tl("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{h=new ty(c,a,l)}catch(m){return tl(m instanceof Lc?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return h.ge===0?null:h}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach((l=>{const c=this.Ge.ht(),h=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(h)||(this.et(n,l,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((l,c)=>{const h=this.ot(c);if(h){if(l.current&&og(h.target)){const m=new Oe(h.target.path);this.It(m).has(c)||this.Et(c,m)||this.et(c,m,Tn.newNoDocument(m,e))}l.Be&&(n.set(c,l.ke()),l.qe())}}));let i=Je();this.He.forEach(((l,c)=>{let h=!0;c.forEachWhile((m=>{const g=this.ot(m);return!g||g.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new nf(e,n,this.Ye,this.je,i);return this.je=Wi(),this.Je=th(),this.He=th(),this.Ye=new At(Xe),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Tx,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new tn(Xe),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new tn(Xe),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ae("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Tx),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function th(){return new At(Oe.comparator)}function Ax(){return new At(Oe.comparator)}const B2={asc:"ASCENDING",desc:"DESCENDING"},F2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},q2={and:"AND",or:"OR"};class H2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ug(t,e){return t.useProto3Json||Yh(e)?e:{value:e}}function Ih(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function G2(t,e){return Ih(t,e.toTimestamp())}function di(t){return at(!!t,49232),Ve.fromTimestamp((function(n){const i=Ws(n);return new xt(i.seconds,i.nanos)})(t))}function ny(t,e){return dg(t,e).canonicalString()}function dg(t,e){const n=(function(a){return new _t(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function ES(t){const e=_t.fromString(t);return at(CS(e),10190,{key:e.toString()}),e}function hg(t,e){return ny(t.databaseId,e.path)}function jp(t,e){const n=ES(e);if(n.get(1)!==t.databaseId.projectId)throw new Te(_e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Te(_e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Oe(SS(n))}function wS(t,e){return ny(t.databaseId,e)}function $2(t){const e=ES(t);return e.length===4?_t.emptyPath():SS(e)}function fg(t){return new _t(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function SS(t){return at(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Cx(t,e,n){return{name:hg(t,e),fields:n.value.mapValue.fields}}function Q2(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Pe(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(g,_){return g.useProto3Json?(at(_===void 0||typeof _=="string",58123),xn.fromBase64String(_||"")):(at(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),xn.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&(function(g){const _=g.code===void 0?_e.UNKNOWN:_S(g.code);return new Te(_,g.message||"")})(c);n=new bS(i,a,l,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=jp(t,i.document.name),l=di(i.document.updateTime),c=i.document.createTime?di(i.document.createTime):Ve.min(),h=new Un({mapValue:{fields:i.document.fields}}),m=Tn.newFoundDocument(a,l,c,h),g=i.targetIds||[],_=i.removedTargetIds||[];n=new uh(g,_,m.key,m)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=jp(t,i.document),l=i.readTime?di(i.readTime):Ve.min(),c=Tn.newNoDocument(a,l),h=i.removedTargetIds||[];n=new uh([],h,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=jp(t,i.document),l=i.removedTargetIds||[];n=new uh([],l,a,null)}else{if(!("filter"in e))return Pe(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,c=new P2(a,l),h=i.targetId;n=new vS(h,c)}}return n}function W2(t,e){let n;if(e instanceof du)n={update:Cx(t,e.key,e.value)};else if(e instanceof Zg)n={delete:hg(t,e.key)};else if(e instanceof ta)n={update:Cx(t,e.key,e.data),updateMask:r5(e.fieldMask)};else{if(!(e instanceof M2))return Pe(16599,{Vt:e.type});n={verify:hg(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const h=c.transform;if(h instanceof Rh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof sl)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Zc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Dh)return{fieldPath:c.field.canonicalString(),increment:h.Ae};throw Pe(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:G2(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Pe(27497)})(t,e.precondition)),n}function K2(t,e){return t&&t.length>0?(at(e!==void 0,14353),t.map((n=>(function(a,l){let c=a.updateTime?di(a.updateTime):di(l);return c.isEqual(Ve.min())&&(c=di(l)),new I2(c,a.transformResults||[])})(n,e)))):[]}function Y2(t,e){return{documents:[wS(t,e.path)]}}function X2(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=wS(t,a);const l=(function(g){if(g.length!==0)return AS(Ur.create(g,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const c=(function(g){if(g.length!==0)return g.map((_=>(function(b){return{field:Go(b.field),direction:e5(b.dir)}})(_)))})(e.orderBy);c&&(n.structuredQuery.orderBy=c);const h=ug(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:n,parent:a}}function J2(t){let e=$2(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){at(i===1,65062);const _=n.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(v){const b=TS(v);return b instanceof Ur&&tS(b)?b.getFilters():[b]})(n.where));let c=[];n.orderBy&&(c=(function(v){return v.map((b=>(function(A){return new Ch($o(A.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(A.direction))})(b)))})(n.orderBy));let h=null;n.limit&&(h=(function(v){let b;return b=typeof v=="object"?v.value:v,Yh(b)?null:b})(n.limit));let m=null;n.startAt&&(m=(function(v){const b=!!v.before,w=v.values||[];return new Ah(w,b)})(n.startAt));let g=null;return n.endAt&&(g=(function(v){const b=!v.before,w=v.values||[];return new Ah(w,b)})(n.endAt)),g2(e,a,c,l,h,"F",m,g)}function Z2(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pe(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function TS(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=$o(n.unaryFilter.field);return Yt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=$o(n.unaryFilter.field);return Yt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=$o(n.unaryFilter.field);return Yt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=$o(n.unaryFilter.field);return Yt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pe(61313);default:return Pe(60726)}})(t):t.fieldFilter!==void 0?(function(n){return Yt.create($o(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pe(58110);default:return Pe(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Ur.create(n.compositeFilter.filters.map((i=>TS(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Pe(1026)}})(n.compositeFilter.op))})(t):Pe(30097,{filter:t})}function e5(t){return B2[t]}function t5(t){return F2[t]}function n5(t){return q2[t]}function Go(t){return{fieldPath:t.canonicalString()}}function $o(t){return vn.fromServerFormat(t.fieldPath)}function AS(t){return t instanceof Yt?(function(n){if(n.op==="=="){if(mx(n.value))return{unaryFilter:{field:Go(n.field),op:"IS_NAN"}};if(fx(n.value))return{unaryFilter:{field:Go(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(mx(n.value))return{unaryFilter:{field:Go(n.field),op:"IS_NOT_NAN"}};if(fx(n.value))return{unaryFilter:{field:Go(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Go(n.field),op:t5(n.op),value:n.value}}})(t):t instanceof Ur?(function(n){const i=n.getFilters().map((a=>AS(a)));return i.length===1?i[0]:{compositeFilter:{op:n5(n.op),filters:i}}})(t):Pe(54877,{filter:t})}function r5(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function CS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Vs{constructor(e,n,i,a,l=Ve.min(),c=Ve.min(),h=xn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=m}withSequenceNumber(e){return new Vs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Vs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class i5{constructor(e){this.yt=e}}function s5(t){const e=J2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cg(e,e.limit,"L"):e}class a5{constructor(){this.Cn=new o5}addToCollectionParentIndex(e,n){return this.Cn.add(n),ve.resolve()}getCollectionParents(e,n){return ve.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ve.resolve()}deleteFieldIndex(e,n){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,n){return ve.resolve()}getDocumentsMatchingTarget(e,n){return ve.resolve(null)}getIndexType(e,n){return ve.resolve(0)}getFieldIndexes(e,n){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,n){return ve.resolve(Qs.min())}getMinOffsetFromCollectionGroup(e,n){return ve.resolve(Qs.min())}updateCollectionGroup(e,n,i){return ve.resolve()}updateIndexEntries(e,n){return ve.resolve()}}class o5{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new tn(_t.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new tn(_t.comparator)).toArray()}}const Rx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},RS=41943040;class zn{static withCacheSize(e){return new zn(e,zn.DEFAULT_COLLECTION_PERCENTILE,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}zn.DEFAULT_COLLECTION_PERCENTILE=10,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zn.DEFAULT=new zn(RS,zn.DEFAULT_COLLECTION_PERCENTILE,zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zn.DISABLED=new zn(-1,0,0);class al{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new al(0)}static cr(){return new al(-1)}}const Dx="LruGarbageCollector",l5=1048576;function Ix([t,e],[n,i]){const a=Xe(t,n);return a===0?Xe(e,i):a}class c5{constructor(e){this.Ir=e,this.buffer=new tn(Ix),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Ix(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class u5{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ae(Dx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){xl(n)?Ae(Dx,"Ignoring IndexedDB error during garbage collection: ",n):await bl(n)}await this.Vr(3e5)}))}}class d5{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return ve.resolve(Kh.ce);const i=new c5(n);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ae("LruGarbageCollector","Garbage collection skipped; disabled"),ve.resolve(Rx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Rx):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,c,h,m,g;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,c=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(i=v,h=Date.now(),this.removeTargets(e,i,n)))).next((v=>(l=v,m=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(g=Date.now(),qo()<=Ye.DEBUG&&Ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${a} in `+(h-c)+`ms
	Removed ${l} targets in `+(m-h)+`ms
	Removed ${v} documents in `+(g-m)+`ms
Total Duration: ${g-_}ms`),ve.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:v}))))}}function h5(t,e){return new d5(t,e)}class f5{constructor(){this.changes=new Ha((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Tn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?ve.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class m5{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class p5{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(i!==null&&qc(i.mutation,a,tr.empty(),xt.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,Je()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=Je()){const a=Oa();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,i).next((l=>{let c=Pc();return l.forEach(((h,m)=>{c=c.insert(h,m.overlayedDocument)})),c}))))}getOverlayedDocuments(e,n){const i=Oa();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,Je())))}populateOverlays(e,n,i){const a=[];return i.forEach((l=>{n.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,h)=>{n.set(c,h)}))}))}computeViews(e,n,i,a){let l=Wi();const c=Fc(),h=(function(){return Fc()})();return n.forEach(((m,g)=>{const _=i.get(g.key);a.has(g.key)&&(_===void 0||_.mutation instanceof ta)?l=l.insert(g.key,g):_!==void 0?(c.set(g.key,_.mutation.getFieldMask()),qc(_.mutation,g,_.mutation.getFieldMask(),xt.now())):c.set(g.key,tr.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((g,_)=>c.set(g,_))),n.forEach(((g,_)=>h.set(g,new m5(_,c.get(g)??null)))),h)))}recalculateAndSaveOverlays(e,n){const i=Fc();let a=new At(((c,h)=>c-h)),l=Je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((c=>{for(const h of c)h.keys().forEach((m=>{const g=n.get(m);if(g===null)return;let _=i.get(m)||tr.empty();_=h.applyToLocalView(g,_),i.set(m,_);const v=(a.get(h.batchId)||Je()).add(m);a=a.insert(h.batchId,v)}))})).next((()=>{const c=[],h=a.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),g=m.key,_=m.value,v=uS();_.forEach((b=>{if(!l.has(b)){const w=gS(n.get(b),i.get(b));w!==null&&v.set(b,w),l=l.add(b)}})),c.push(this.documentOverlayCache.saveOverlays(e,g,v))}return ve.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,a){return(function(c){return Oe.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):sS(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):ve.resolve(Oa());let h=Kc,m=l;return c.next((g=>ve.forEach(g,((_,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),l.get(_)?ve.resolve():this.remoteDocumentCache.getEntry(e,_).next((b=>{m=m.insert(_,b)}))))).next((()=>this.populateOverlays(e,g,l))).next((()=>this.computeViews(e,m,g,Je()))).next((_=>({batchId:h,changes:cS(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Oe(n)).next((i=>{let a=Pc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let c=Pc();return this.indexManager.getCollectionParents(e,l).next((h=>ve.forEach(h,(m=>{const g=(function(v,b){return new uu(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,g,i,a).next((_=>{_.forEach(((v,b)=>{c=c.insert(v,b)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a)))).next((c=>{l.forEach(((m,g)=>{const _=g.getKey();c.get(_)===null&&(c=c.insert(_,Tn.newInvalidDocument(_)))}));let h=Pc();return c.forEach(((m,g)=>{const _=l.get(m);_!==void 0&&qc(_.mutation,g,tr.empty(),xt.now()),Zh(n,g)&&(h=h.insert(m,g))})),h}))}}class g5{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ve.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:di(a.createTime)}})(n)),ve.resolve()}getNamedQuery(e,n){return ve.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:s5(a.bundledQuery),readTime:di(a.readTime)}})(n)),ve.resolve()}}class y5{constructor(){this.overlays=new At(Oe.comparator),this.qr=new Map}getOverlay(e,n){return ve.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Oa();return ve.forEach(n,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((a,l)=>{this.St(e,n,l)})),ve.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),ve.resolve()}getOverlaysForCollection(e,n,i){const a=Oa(),l=n.length+1,c=new Oe(n.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const m=h.getNext().value,g=m.getKey();if(!n.isPrefixOf(g.path))break;g.path.length===l&&m.largestBatchId>i&&a.set(m.getKey(),m)}return ve.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new At(((g,_)=>g-_));const c=this.overlays.getIterator();for(;c.hasNext();){const g=c.getNext().value;if(g.getKey().getCollectionGroup()===n&&g.largestBatchId>i){let _=l.get(g.largestBatchId);_===null&&(_=Oa(),l=l.insert(g.largestBatchId,_)),_.set(g.getKey(),g)}}const h=Oa(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((g,_)=>h.set(g,_))),!(h.size()>=a)););return ve.resolve(h)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const c=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new N2(n,i));let l=this.qr.get(n);l===void 0&&(l=Je(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}class _5{constructor(){this.sessionToken=xn.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ve.resolve()}}class ry{constructor(){this.Qr=new tn(ln.$r),this.Ur=new tn(ln.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new ln(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new ln(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new Oe(new _t([])),i=new ln(n,e),a=new ln(n,e+1),l=[];return this.Ur.forEachInRange([i,a],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Oe(new _t([])),i=new ln(n,e),a=new ln(n,e+1);let l=Je();return this.Ur.forEachInRange([i,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const n=new ln(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class ln{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Oe.comparator(e.key,n.key)||Xe(e.Yr,n.Yr)}static Kr(e,n){return Xe(e.Yr,n.Yr)||Oe.comparator(e.key,n.key)}}class v5{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new tn(ln.$r)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new k2(l,n,i,a);this.mutationQueue.push(c);for(const h of a)this.Zr=this.Zr.add(new ln(h.key,l)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return ve.resolve(c)}lookupMutationBatch(e,n){return ve.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return ve.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?$g:this.tr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new ln(n,0),a=new ln(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(c=>{const h=this.Xr(c.Yr);l.push(h)})),ve.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new tn(Xe);return n.forEach((a=>{const l=new ln(a,0),c=new ln(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(h=>{i=i.add(h.Yr)}))})),ve.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;Oe.isDocumentKey(l)||(l=l.child(""));const c=new ln(new Oe(l),0);let h=new tn(Xe);return this.Zr.forEachWhile((m=>{const g=m.key.path;return!!i.isPrefixOf(g)&&(g.length===a&&(h=h.add(m.Yr)),!0)}),c),ve.resolve(this.ti(h))}ti(e){const n=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){at(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ve.forEach(n.mutations,(a=>{const l=new ln(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new ln(n,0),a=this.Zr.firstAfterOrEqual(i);return ve.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class b5{constructor(e){this.ri=e,this.docs=(function(){return new At(Oe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,c=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return ve.resolve(i?i.document.mutableCopy():Tn.newInvalidDocument(n))}getEntries(e,n){let i=Wi();return n.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():Tn.newInvalidDocument(a))})),ve.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=Wi();const c=n.path,h=new Oe(c.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(h);for(;m.hasNext();){const{key:g,value:{document:_}}=m.getNext();if(!c.isPrefixOf(g.path))break;g.path.length>c.length+1||Wj(Qj(_),i)<=0||(a.has(_.key)||Zh(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return ve.resolve(l)}getAllFromCollectionGroup(e,n,i,a){Pe(9500)}ii(e,n){return ve.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new x5(this)}getSize(e){return ve.resolve(this.size)}}class x5 extends f5{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),ve.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class E5{constructor(e){this.persistence=e,this.si=new Ha((n=>Kg(n)),Yg),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.oi=0,this._i=new ry,this.targetCount=0,this.ai=al.ur()}forEachTarget(e,n){return this.si.forEach(((i,a)=>n(a))),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),ve.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new al(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ve.resolve()}updateTargetData(e,n){return this.Pr(n),ve.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach(((c,h)=>{h.sequenceNumber<=n&&i.get(h.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,h.targetId)),a++)})),ve.waitFor(l).next((()=>a))}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return ve.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),ve.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),ve.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ve.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return ve.resolve(i)}containsKey(e,n){return ve.resolve(this._i.containsKey(n))}}class DS{constructor(e,n){this.ui={},this.overlays={},this.ci=new Kh(0),this.li=!1,this.li=!0,this.hi=new _5,this.referenceDelegate=e(this),this.Pi=new E5(this),this.indexManager=new a5,this.remoteDocumentCache=(function(a){return new b5(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new i5(n),this.Ii=new g5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new y5,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new v5(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){Ae("MemoryPersistence","Starting transaction:",e);const a=new w5(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,n){return ve.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class w5 extends Yj{constructor(e){super(),this.currentSequenceNumber=e}}class iy{constructor(e){this.persistence=e,this.Ri=new ry,this.Vi=null}static mi(e){return new iy(e)}get fi(){if(this.Vi)return this.Vi;throw Pe(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),ve.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),ve.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ve.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.fi,(i=>{const a=Oe.fromPath(i);return this.gi(e,a).next((l=>{l||n.removeEntry(a,Ve.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return ve.or([()=>ve.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class jh{constructor(e,n){this.persistence=e,this.pi=new Ha((i=>Zj(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=h5(this,n)}static mi(e,n){return new jh(e,n)}Ei(){}di(e){return ve.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((a=>i+a))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return ve.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?ve.resolve():n(a)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(c=>this.br(e,c,n).next((h=>{h||(i++,l.removeEntry(c,Ve.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ve.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ve.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ve.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ve.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=oh(e.data.value)),n}br(e,n,i){return ve.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return ve.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class sy{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=Je(),a=Je();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new sy(e,n.fromCache,i,a)}}class S5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class T5{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return mI()?8:Xj(An())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,n,a,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new S5;return this.Ss(e,n,c).next((h=>{if(l.result=h,this.Vs)return this.bs(e,n,c,h.size)}))})).next((()=>l.result))}bs(e,n,i,a){return i.documentReadCount<this.fs?(qo()<=Ye.DEBUG&&Ae("QueryEngine","SDK will not create cache indexes for query:",Ho(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ve.resolve()):(qo()<=Ye.DEBUG&&Ae("QueryEngine","Query:",Ho(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(qo()<=Ye.DEBUG&&Ae("QueryEngine","The SDK decides to create cache indexes for query:",Ho(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ui(n))):ve.resolve())}ys(e,n){if(_x(n))return ve.resolve(null);let i=ui(n);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=cg(n,null,"F"),i=ui(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=Je(...l);return this.ps.getDocuments(e,c).next((h=>this.indexManager.getMinOffset(e,i).next((m=>{const g=this.Ds(n,h);return this.Cs(n,g,c,m.readTime)?this.ys(e,cg(n,null,"F")):this.vs(e,g,n,m)}))))})))))}ws(e,n,i,a){return _x(n)||a.isEqual(Ve.min())?ve.resolve(null):this.ps.getDocuments(e,i).next((l=>{const c=this.Ds(n,l);return this.Cs(n,c,i,a)?ve.resolve(null):(qo()<=Ye.DEBUG&&Ae("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Ho(n)),this.vs(e,c,n,$j(a,Kc)).next((h=>h)))}))}Ds(e,n){let i=new tn(oS(e));return n.forEach(((a,l)=>{Zh(e,l)&&(i=i.add(l))})),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return qo()<=Ye.DEBUG&&Ae("QueryEngine","Using full collection scan to execute query:",Ho(n)),this.ps.getDocumentsMatchingQuery(e,n,Qs.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(n.forEach((c=>{l=l.insert(c.key,c)})),l)))}}const ay="LocalStore",A5=3e8;class C5{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new At(Xe),this.xs=new Ha((l=>Kg(l)),Yg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new p5(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function R5(t,e,n,i){return new C5(t,e,n,i)}async function IS(t,e){const n=Ue(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],h=[];let m=Je();for(const g of a){c.push(g.batchId);for(const _ of g.mutations)m=m.add(_.key)}for(const g of l){h.push(g.batchId);for(const _ of g.mutations)m=m.add(_.key)}return n.localDocuments.getDocuments(i,m).next((g=>({Ls:g,removedBatchIds:c,addedBatchIds:h})))}))}))}function D5(t,e){const n=Ue(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,m,g,_){const v=g.batch,b=v.keys();let w=ve.resolve();return b.forEach((A=>{w=w.next((()=>_.getEntry(m,A))).next((S=>{const M=g.docVersions.get(A);at(M!==null,48541),S.version.compareTo(M)<0&&(v.applyToRemoteDocument(S,g),S.isValidDocument()&&(S.setReadTime(g.commitVersion),_.addEntry(S)))}))})),w.next((()=>h.mutationQueue.removeMutationBatch(m,v)))})(n,i,e,l).next((()=>l.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(h){let m=Je();for(let g=0;g<h.mutationResults.length;++g)h.mutationResults[g].transformResults.length>0&&(m=m.add(h.batch.mutations[g].key));return m})(e)))).next((()=>n.localDocuments.getDocuments(i,a)))}))}function jS(t){const e=Ue(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function I5(t,e){const n=Ue(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const h=[];e.targetChanges.forEach(((_,v)=>{const b=a.get(v);if(!b)return;h.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,v))));let w=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?w=w.withResumeToken(xn.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):_.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(_.resumeToken,i)),a=a.insert(v,w),(function(S,M,F){return S.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=A5?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0})(b,w,_)&&h.push(n.Pi.updateTargetData(l,w))}));let m=Wi(),g=Je();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),h.push(j5(l,c,e.documentUpdates).next((_=>{m=_.ks,g=_.qs}))),!i.isEqual(Ve.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));h.push(_)}return ve.waitFor(h).next((()=>c.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,m,g))).next((()=>m))})).then((l=>(n.Ms=a,l)))}function j5(t,e,n){let i=Je(),a=Je();return n.forEach((l=>i=i.add(l))),e.getEntries(t,i).next((l=>{let c=Wi();return n.forEach(((h,m)=>{const g=l.get(h);m.isFoundDocument()!==g.isFoundDocument()&&(a=a.add(h)),m.isNoDocument()&&m.version.isEqual(Ve.min())?(e.removeEntry(h,m.readTime),c=c.insert(h,m)):!g.isValidDocument()||m.version.compareTo(g.version)>0||m.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(m),c=c.insert(h,m)):Ae(ay,"Ignoring outdated watch update for ",h,". Current version:",g.version," Watch version:",m.version)})),{ks:c,qs:a}}))}function O5(t,e){const n=Ue(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=$g),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function M5(t,e){const n=Ue(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return n.Pi.getTargetData(i,e).next((l=>l?(a=l,ve.resolve(a)):n.Pi.allocateTargetId(i).next((c=>(a=new Vs(e,c,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function mg(t,e,n){const i=Ue(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!xl(c))throw c;Ae(ay,`Failed to update sequence numbers for target ${e}: ${c}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function jx(t,e,n){const i=Ue(t);let a=Ve.min(),l=Je();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(m,g,_){const v=Ue(m),b=v.xs.get(_);return b!==void 0?ve.resolve(v.Ms.get(b)):v.Pi.getTargetData(g,_)})(i,c,ui(e)).next((h=>{if(h)return a=h.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(c,h.targetId).next((m=>{l=m}))})).next((()=>i.Fs.getDocumentsMatchingQuery(c,e,n?a:Ve.min(),n?l:Je()))).next((h=>(k5(i,_2(e),h),{documents:h,Qs:l})))))}function k5(t,e,n){let i=t.Os.get(e)||Ve.min();n.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),t.Os.set(e,i)}class Ox{constructor(){this.activeTargetIds=S2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class N5{constructor(){this.Mo=new Ox,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ox,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class P5{Oo(e){}shutdown(){}}const Mx="ConnectivityMonitor";class kx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ae(Mx,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ae(Mx,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let nh=null;function pg(){return nh===null?nh=(function(){return 268435456+Math.round(2147483648*Math.random())})():nh++,"0x"+nh.toString(16)}const Op="RestConnection",L5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class V5{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===Sh?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const c=pg(),h=this.zo(e,n.toUriEncodedString());Ae(Op,`Sending RPC '${e}' ${c}:`,h,i);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,a,l);const{host:g}=new URL(h),_=yl(g);return this.Jo(e,h,m,i,_).then((v=>(Ae(Op,`Received RPC '${e}' ${c}: `,v),v)),(v=>{throw tl(Op,`RPC '${e}' ${c} failed with error: `,v,"url: ",h,"request:",i),v}))}Ho(e,n,i,a,l,c){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+vl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,n){const i=L5[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class z5{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const wn="WebChannelConnection";class U5 extends V5{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const c=pg();return new Promise(((h,m)=>{const g=new kw;g.setWithCredentials(!0),g.listenOnce(Nw.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case ah.NO_ERROR:const v=g.getResponseJson();Ae(wn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(v)),h(v);break;case ah.TIMEOUT:Ae(wn,`RPC '${e}' ${c} timed out`),m(new Te(_e.DEADLINE_EXCEEDED,"Request time out"));break;case ah.HTTP_ERROR:const b=g.getStatus();if(Ae(wn,`RPC '${e}' ${c} failed with status:`,b,"response text:",g.getResponseText()),b>0){let w=g.getResponseJson();Array.isArray(w)&&(w=w[0]);const A=w?.error;if(A&&A.status&&A.message){const S=(function(F){const H=F.toLowerCase().replace(/_/g,"-");return Object.values(_e).indexOf(H)>=0?H:_e.UNKNOWN})(A.status);m(new Te(S,A.message))}else m(new Te(_e.UNKNOWN,"Server responded with status "+g.getStatus()))}else m(new Te(_e.UNAVAILABLE,"Connection failed."));break;default:Pe(9055,{l_:e,streamId:c,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Ae(wn,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(a);Ae(wn,`RPC '${e}' ${c} sending request:`,a),g.send(n,"POST",_,i,15)}))}T_(e,n,i){const a=pg(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=Vw(),h=Lw(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(m.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,n,i),m.encodeInitMessageHeaders=!0;const _=l.join("");Ae(wn,`Creating RPC '${e}' stream ${a}: ${_}`,m);const v=c.createWebChannel(_,m);this.I_(v);let b=!1,w=!1;const A=new z5({Yo:M=>{w?Ae(wn,`Not sending because RPC '${e}' stream ${a} is closed:`,M):(b||(Ae(wn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),b=!0),Ae(wn,`RPC '${e}' stream ${a} sending:`,M),v.send(M))},Zo:()=>v.close()}),S=(M,F,H)=>{M.listen(F,(z=>{try{H(z)}catch(ee){setTimeout((()=>{throw ee}),0)}}))};return S(v,Nc.EventType.OPEN,(()=>{w||(Ae(wn,`RPC '${e}' stream ${a} transport opened.`),A.o_())})),S(v,Nc.EventType.CLOSE,(()=>{w||(w=!0,Ae(wn,`RPC '${e}' stream ${a} transport closed`),A.a_(),this.E_(v))})),S(v,Nc.EventType.ERROR,(M=>{w||(w=!0,tl(wn,`RPC '${e}' stream ${a} transport errored. Name:`,M.name,"Message:",M.message),A.a_(new Te(_e.UNAVAILABLE,"The operation could not be completed")))})),S(v,Nc.EventType.MESSAGE,(M=>{if(!w){const F=M.data[0];at(!!F,16349);const H=F,z=H?.error||H[0]?.error;if(z){Ae(wn,`RPC '${e}' stream ${a} received error:`,z);const ee=z.status;let J=(function(D){const I=Wt[D];if(I!==void 0)return _S(I)})(ee),me=z.message;J===void 0&&(J=_e.INTERNAL,me="Unknown error status: "+ee+" with message "+z.message),w=!0,A.a_(new Te(J,me)),v.close()}else Ae(wn,`RPC '${e}' stream ${a} received:`,F),A.u_(F)}})),S(h,Pw.STAT_EVENT,(M=>{M.stat===ng.PROXY?Ae(wn,`RPC '${e}' stream ${a} detected buffering proxy`):M.stat===ng.NOPROXY&&Ae(wn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{A.__()}),0),A}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function Mp(){return typeof document<"u"?document:null}function rf(t){return new H2(t,!0)}class OS{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&Ae("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Nx="PersistentStream";class MS{constructor(e,n,i,a,l,c,h,m){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new OS(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===_e.RESOURCE_EXHAUSTED?(Qi(n.toString()),Qi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===_e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===n&&this.G_(i,a)}),(i=>{e((()=>{const a=new Te(_e.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ae(Nx,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Ae(Nx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class B5 extends MS{constructor(e,n,i,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=Q2(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Ve.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Ve.min():c.readTime?di(c.readTime):Ve.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=fg(this.serializer),n.addTarget=(function(l,c){let h;const m=c.target;if(h=og(m)?{documents:Y2(l,m)}:{query:X2(l,m).ft},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=xS(l,c.resumeToken);const g=ug(l,c.expectedCount);g!==null&&(h.expectedCount=g)}else if(c.snapshotVersion.compareTo(Ve.min())>0){h.readTime=Ih(l,c.snapshotVersion.toTimestamp());const g=ug(l,c.expectedCount);g!==null&&(h.expectedCount=g)}return h})(this.serializer,e);const i=Z2(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=fg(this.serializer),n.removeTarget=e,this.q_(n)}}class F5 extends MS{constructor(e,n,i,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return at(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,at(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){at(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=K2(e.writeResults,e.commitTime),i=di(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=fg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>W2(this.serializer,i)))};this.q_(n)}}class q5{}class H5 extends q5{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Te(_e.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,dg(n,i),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Te(_e.UNKNOWN,l.toString())}))}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Ho(e,dg(n,i),a,c,h,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Te(_e.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class G5{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Qi(n),this.aa=!1):Ae("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const za="RemoteStore";class $5{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{i.enqueueAndForget((async()=>{Ga(this)&&(Ae(za,"Restarting streams for network reachability change."),await(async function(m){const g=Ue(m);g.Ea.add(4),await fu(g),g.Ra.set("Unknown"),g.Ea.delete(4),await sf(g)})(this))}))})),this.Ra=new G5(i,a)}}async function sf(t){if(Ga(t))for(const e of t.da)await e(!0)}async function fu(t){for(const e of t.da)await e(!1)}function kS(t,e){const n=Ue(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),uy(n)?cy(n):El(n).O_()&&ly(n,e))}function oy(t,e){const n=Ue(t),i=El(n);n.Ia.delete(e),i.O_()&&NS(n,e),n.Ia.size===0&&(i.O_()?i.L_():Ga(n)&&n.Ra.set("Unknown"))}function ly(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}El(t).Y_(e)}function NS(t,e){t.Va.Ue(e),El(t).Z_(e)}function cy(t){t.Va=new U2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),El(t).start(),t.Ra.ua()}function uy(t){return Ga(t)&&!El(t).x_()&&t.Ia.size>0}function Ga(t){return Ue(t).Ea.size===0}function PS(t){t.Va=void 0}async function Q5(t){t.Ra.set("Online")}async function W5(t){t.Ia.forEach(((e,n)=>{ly(t,e)}))}async function K5(t,e){PS(t),uy(t)?(t.Ra.ha(e),cy(t)):t.Ra.set("Unknown")}async function Y5(t,e,n){if(t.Ra.set("Online"),e instanceof bS&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const h of l.targetIds)a.Ia.has(h)&&(await a.remoteSyncer.rejectListen(h,c),a.Ia.delete(h),a.Va.removeTarget(h))})(t,e)}catch(i){Ae(za,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Oh(t,i)}else if(e instanceof uh?t.Va.Ze(e):e instanceof vS?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ve.min()))try{const i=await jS(t.localStore);n.compareTo(i)>=0&&await(function(l,c){const h=l.Va.Tt(c);return h.targetChanges.forEach(((m,g)=>{if(m.resumeToken.approximateByteSize()>0){const _=l.Ia.get(g);_&&l.Ia.set(g,_.withResumeToken(m.resumeToken,c))}})),h.targetMismatches.forEach(((m,g)=>{const _=l.Ia.get(m);if(!_)return;l.Ia.set(m,_.withResumeToken(xn.EMPTY_BYTE_STRING,_.snapshotVersion)),NS(l,m);const v=new Vs(_.target,m,g,_.sequenceNumber);ly(l,v)})),l.remoteSyncer.applyRemoteEvent(h)})(t,n)}catch(i){Ae(za,"Failed to raise snapshot:",i),await Oh(t,i)}}async function Oh(t,e,n){if(!xl(e))throw e;t.Ea.add(1),await fu(t),t.Ra.set("Offline"),n||(n=()=>jS(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ae(za,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await sf(t)}))}function LS(t,e){return e().catch((n=>Oh(t,n,e)))}async function af(t){const e=Ue(t),n=Xs(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:$g;for(;X5(e);)try{const a=await O5(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,J5(e,a)}catch(a){await Oh(e,a)}VS(e)&&zS(e)}function X5(t){return Ga(t)&&t.Ta.length<10}function J5(t,e){t.Ta.push(e);const n=Xs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function VS(t){return Ga(t)&&!Xs(t).x_()&&t.Ta.length>0}function zS(t){Xs(t).start()}async function Z5(t){Xs(t).ra()}async function eO(t){const e=Xs(t);for(const n of t.Ta)e.ea(n.mutations)}async function tO(t,e,n){const i=t.Ta.shift(),a=ey.from(i,e,n);await LS(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await af(t)}async function nO(t,e){e&&Xs(t).X_&&await(async function(i,a){if((function(c){return L2(c)&&c!==_e.ABORTED})(a.code)){const l=i.Ta.shift();Xs(i).B_(),await LS(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await af(i)}})(t,e),VS(t)&&zS(t)}async function Px(t,e){const n=Ue(t);n.asyncQueue.verifyOperationInProgress(),Ae(za,"RemoteStore received new credentials");const i=Ga(n);n.Ea.add(3),await fu(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await sf(n)}async function rO(t,e){const n=Ue(t);e?(n.Ea.delete(2),await sf(n)):e||(n.Ea.add(2),await fu(n),n.Ra.set("Unknown"))}function El(t){return t.ma||(t.ma=(function(n,i,a){const l=Ue(n);return l.sa(),new B5(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:Q5.bind(null,t),t_:W5.bind(null,t),r_:K5.bind(null,t),H_:Y5.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),uy(t)?cy(t):t.Ra.set("Unknown")):(await t.ma.stop(),PS(t))}))),t.ma}function Xs(t){return t.fa||(t.fa=(function(n,i,a){const l=Ue(n);return l.sa(),new F5(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:Z5.bind(null,t),r_:nO.bind(null,t),ta:eO.bind(null,t),na:tO.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await af(t)):(await t.fa.stop(),t.Ta.length>0&&(Ae(za,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class dy{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Hi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const c=Date.now()+i,h=new dy(e,n,c,a,l);return h.start(i),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hy(t,e){if(Qi("AsyncQueue",`${e}: ${t}`),xl(t))return new Te(_e.UNAVAILABLE,`${e}: ${t}`);throw t}class Wo{static emptySet(e){return new Wo(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||Oe.comparator(n.key,i.key):(n,i)=>Oe.comparator(n.key,i.key),this.keyedMap=Pc(),this.sortedSet=new At(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Wo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Wo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class Lx{constructor(){this.ga=new At(Oe.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Pe(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class ol{constructor(e,n,i,a,l,c,h,m,g){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=m,this.hasCachedResults=g}static fromInitialDocuments(e,n,i,a,l){const c=[];return n.forEach((h=>{c.push({type:0,doc:h})})),new ol(e,n,Wo.emptySet(n),c,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}class iO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class sO{constructor(){this.queries=Vx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=Ue(n),l=a.queries;a.queries=Vx(),l.forEach(((c,h)=>{for(const m of h.Sa)m.onError(i)}))})(this,new Te(_e.ABORTED,"Firestore shutting down"))}}function Vx(){return new Ha((t=>aS(t)),Jh)}async function US(t,e){const n=Ue(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new iO,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(c){const h=hy(c,`Initialization of query '${Ho(e.query)}' failed`);return void e.onError(h)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&fy(n)}async function BS(t,e){const n=Ue(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function aO(t,e){const n=Ue(t);let i=!1;for(const a of e){const l=a.query,c=n.queries.get(l);if(c){for(const h of c.Sa)h.Fa(a)&&(i=!0);c.wa=a}}i&&fy(n)}function oO(t,e,n){const i=Ue(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function fy(t){t.Ca.forEach((e=>{e.next()}))}var gg,zx;(zx=gg||(gg={})).Ma="default",zx.Cache="cache";class FS{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new ol(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=ol.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gg.Cache}}class qS{constructor(e){this.key=e}}class HS{constructor(e){this.key=e}}class lO{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Je(),this.mutatedKeys=Je(),this.eu=oS(e),this.tu=new Wo(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new Lx,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,c=a,h=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,g=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,v)=>{const b=a.get(_),w=Zh(this.query,v)?v:null,A=!!b&&this.mutatedKeys.has(b.key),S=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let M=!1;b&&w?b.data.isEqual(w.data)?A!==S&&(i.track({type:3,doc:w}),M=!0):this.su(b,w)||(i.track({type:2,doc:w}),M=!0,(m&&this.eu(w,m)>0||g&&this.eu(w,g)<0)&&(h=!0)):!b&&w?(i.track({type:0,doc:w}),M=!0):b&&!w&&(i.track({type:1,doc:b}),M=!0,(m||g)&&(h=!0)),M&&(w?(c=c.add(w),l=S?l.add(_):l.delete(_)):(c=c.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:c,iu:i,Cs:h,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,v)=>(function(w,A){const S=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pe(20277,{Rt:M})}};return S(w)-S(A)})(_.type,v.type)||this.eu(_.doc,v.doc))),this.ou(i),a=a??!1;const h=n&&!a?this._u():[],m=this.Xa.size===0&&this.current&&!a?1:0,g=m!==this.Za;return this.Za=m,c.length!==0||g?{snapshot:new ol(this.query,e.tu,l,c,e.mutatedKeys,m===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Lx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Je(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new HS(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new qS(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=Je();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return ol.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const my="SyncEngine";class cO{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class uO{constructor(e){this.key=e,this.hu=!1}}class dO{constructor(e,n,i,a,l,c){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Ha((h=>aS(h)),Jh),this.Iu=new Map,this.Eu=new Set,this.du=new At(Oe.comparator),this.Au=new Map,this.Ru=new ry,this.Vu={},this.mu=new Map,this.fu=al.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function hO(t,e,n=!0){const i=YS(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await GS(i,e,n,!0),a}async function fO(t,e){const n=YS(t);await GS(n,e,!0,!1)}async function GS(t,e,n,i){const a=await M5(t.localStore,ui(e)),l=a.targetId,c=t.sharedClientState.addLocalQueryTarget(l,n);let h;return i&&(h=await mO(t,e,l,c==="current",a.resumeToken)),t.isPrimaryClient&&n&&kS(t.remoteStore,a),h}async function mO(t,e,n,i,a){t.pu=(v,b,w)=>(async function(S,M,F,H){let z=M.view.ru(F);z.Cs&&(z=await jx(S.localStore,M.query,!1).then((({documents:P})=>M.view.ru(P,z))));const ee=H&&H.targetChanges.get(M.targetId),J=H&&H.targetMismatches.get(M.targetId)!=null,me=M.view.applyChanges(z,S.isPrimaryClient,ee,J);return Bx(S,M.targetId,me.au),me.snapshot})(t,v,b,w);const l=await jx(t.localStore,e,!0),c=new lO(e,l.Qs),h=c.ru(l.documents),m=hu.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),g=c.applyChanges(h,t.isPrimaryClient,m);Bx(t,n,g.au);const _=new cO(e,n,c);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),g.snapshot}async function pO(t,e,n){const i=Ue(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((c=>!Jh(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await mg(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&oy(i.remoteStore,a.targetId),yg(i,a.targetId)})).catch(bl)):(yg(i,a.targetId),await mg(i.localStore,a.targetId,!0))}async function gO(t,e){const n=Ue(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),oy(n.remoteStore,i.targetId))}async function yO(t,e,n){const i=SO(t);try{const a=await(function(c,h){const m=Ue(c),g=xt.now(),_=h.reduce(((w,A)=>w.add(A.key)),Je());let v,b;return m.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let A=Wi(),S=Je();return m.Ns.getEntries(w,_).next((M=>{A=M,A.forEach(((F,H)=>{H.isValidDocument()||(S=S.add(F))}))})).next((()=>m.localDocuments.getOverlayedDocuments(w,A))).next((M=>{v=M;const F=[];for(const H of h){const z=O2(H,v.get(H.key).overlayedDocument);z!=null&&F.push(new ta(H.key,z,Jw(z.value.mapValue),zr.exists(!0)))}return m.mutationQueue.addMutationBatch(w,g,F,h)})).next((M=>{b=M;const F=M.applyToLocalDocumentSet(v,S);return m.documentOverlayCache.saveOverlays(w,M.batchId,F)}))})).then((()=>({batchId:b.batchId,changes:cS(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(c,h,m){let g=c.Vu[c.currentUser.toKey()];g||(g=new At(Xe)),g=g.insert(h,m),c.Vu[c.currentUser.toKey()]=g})(i,a.batchId,n),await mu(i,a.changes),await af(i.remoteStore)}catch(a){const l=hy(a,"Failed to persist write");n.reject(l)}}async function $S(t,e){const n=Ue(t);try{const i=await I5(n.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=n.Au.get(l);c&&(at(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?at(c.hu,14607):a.removedDocuments.size>0&&(at(c.hu,42227),c.hu=!1))})),await mu(n,i,e)}catch(i){await bl(i)}}function Ux(t,e,n){const i=Ue(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach(((l,c)=>{const h=c.view.va(e);h.snapshot&&a.push(h.snapshot)})),(function(c,h){const m=Ue(c);m.onlineState=h;let g=!1;m.queries.forEach(((_,v)=>{for(const b of v.Sa)b.va(h)&&(g=!0)})),g&&fy(m)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function _O(t,e,n){const i=Ue(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let c=new At(Oe.comparator);c=c.insert(l,Tn.newNoDocument(l,Ve.min()));const h=Je().add(l),m=new nf(Ve.min(),new Map,new At(Xe),c,h);await $S(i,m),i.du=i.du.remove(l),i.Au.delete(e),py(i)}else await mg(i.localStore,e,!1).then((()=>yg(i,e,n))).catch(bl)}async function vO(t,e){const n=Ue(t),i=e.batch.batchId;try{const a=await D5(n.localStore,e);WS(n,i,null),QS(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await mu(n,a)}catch(a){await bl(a)}}async function bO(t,e,n){const i=Ue(t);try{const a=await(function(c,h){const m=Ue(c);return m.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let _;return m.mutationQueue.lookupMutationBatch(g,h).next((v=>(at(v!==null,37113),_=v.keys(),m.mutationQueue.removeMutationBatch(g,v)))).next((()=>m.mutationQueue.performConsistencyCheck(g))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(g,_,h))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,_))).next((()=>m.localDocuments.getDocuments(g,_)))}))})(i.localStore,e);WS(i,e,n),QS(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await mu(i,a)}catch(a){await bl(a)}}function QS(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function WS(t,e,n){const i=Ue(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function yg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||KS(t,i)}))}function KS(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(oy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),py(t))}function Bx(t,e,n){for(const i of n)i instanceof qS?(t.Ru.addReference(i.key,e),xO(t,i)):i instanceof HS?(Ae(my,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||KS(t,i.key)):Pe(19791,{wu:i})}function xO(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(Ae(my,"New document in limbo: "+n),t.Eu.add(i),py(t))}function py(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Oe(_t.fromString(e)),i=t.fu.next();t.Au.set(i,new uO(n)),t.du=t.du.insert(n,i),kS(t.remoteStore,new Vs(ui(Xg(n.path)),i,"TargetPurposeLimboResolution",Kh.ce))}}async function mu(t,e,n){const i=Ue(t),a=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((h,m)=>{c.push(i.pu(m,e,n).then((g=>{if((g||n)&&i.isPrimaryClient){const _=g?!g.fromCache:n?.targetChanges.get(m.targetId)?.current;i.sharedClientState.updateQueryState(m.targetId,_?"current":"not-current")}if(g){a.push(g);const _=sy.As(m.targetId,g);l.push(_)}})))})),await Promise.all(c),i.Pu.H_(a),await(async function(m,g){const _=Ue(m);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ve.forEach(g,(b=>ve.forEach(b.Es,(w=>_.persistence.referenceDelegate.addReference(v,b.targetId,w))).next((()=>ve.forEach(b.ds,(w=>_.persistence.referenceDelegate.removeReference(v,b.targetId,w)))))))))}catch(v){if(!xl(v))throw v;Ae(ay,"Failed to update sequence numbers: "+v)}for(const v of g){const b=v.targetId;if(!v.fromCache){const w=_.Ms.get(b),A=w.snapshotVersion,S=w.withLastLimboFreeSnapshotVersion(A);_.Ms=_.Ms.insert(b,S)}}})(i.localStore,l))}async function EO(t,e){const n=Ue(t);if(!n.currentUser.isEqual(e)){Ae(my,"User change. New user:",e.toKey());const i=await IS(n.localStore,e);n.currentUser=e,(function(l,c){l.mu.forEach((h=>{h.forEach((m=>{m.reject(new Te(_e.CANCELLED,c))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await mu(n,i.Ls)}}function wO(t,e){const n=Ue(t),i=n.Au.get(e);if(i&&i.hu)return Je().add(i.key);{let a=Je();const l=n.Iu.get(e);if(!l)return a;for(const c of l){const h=n.Tu.get(c);a=a.unionWith(h.view.nu)}return a}}function YS(t){const e=Ue(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=$S.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=wO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_O.bind(null,e),e.Pu.H_=aO.bind(null,e.eventManager),e.Pu.yu=oO.bind(null,e.eventManager),e}function SO(t){const e=Ue(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=vO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bO.bind(null,e),e}class Mh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return R5(this.persistence,new T5,e.initialUser,this.serializer)}Cu(e){return new DS(iy.mi,this.serializer)}Du(e){return new N5}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Mh.provider={build:()=>new Mh};class TO extends Mh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){at(this.persistence.referenceDelegate instanceof jh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new u5(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?zn.withCacheSize(this.cacheSizeBytes):zn.DEFAULT;return new DS((i=>jh.mi(i,n)),this.serializer)}}class _g{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Ux(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=EO.bind(null,this.syncEngine),await rO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new sO})()}createDatastore(e){const n=rf(e.databaseInfo.databaseId),i=(function(l){return new U5(l)})(e.databaseInfo);return(function(l,c,h,m){return new H5(l,c,h,m)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,a,l,c,h){return new $5(i,a,l,c,h)})(this.localStore,this.datastore,e.asyncQueue,(n=>Ux(this.syncEngine,n,0)),(function(){return kx.v()?new kx:new P5})())}createSyncEngine(e,n){return(function(a,l,c,h,m,g,_){const v=new dO(a,l,c,h,m,g);return _&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Ue(n);Ae(za,"RemoteStore shutting down."),i.Ea.add(5),await fu(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}_g.provider={build:()=>new _g};class XS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Qi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Js="FirestoreClient";class AO{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=Sn.UNAUTHENTICATED,this.clientId=Gg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{Ae(Js,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Ae(Js,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=hy(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function kp(t,e){t.asyncQueue.verifyOperationInProgress(),Ae(Js,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async a=>{i.isEqual(a)||(await IS(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Fx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await CO(t);Ae(Js,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>Px(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,a)=>Px(e.remoteStore,a))),t._onlineComponents=e}async function CO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ae(Js,"Using user provided OfflineComponentProvider");try{await kp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===_e.FAILED_PRECONDITION||a.code===_e.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;tl("Error using user provided cache. Falling back to memory cache: "+n),await kp(t,new Mh)}}else Ae(Js,"Using default OfflineComponentProvider"),await kp(t,new TO(void 0));return t._offlineComponents}async function JS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ae(Js,"Using user provided OnlineComponentProvider"),await Fx(t,t._uninitializedComponentsProvider._online)):(Ae(Js,"Using default OnlineComponentProvider"),await Fx(t,new _g))),t._onlineComponents}function RO(t){return JS(t).then((e=>e.syncEngine))}async function ZS(t){const e=await JS(t),n=e.eventManager;return n.onListen=hO.bind(null,e.syncEngine),n.onUnlisten=pO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=fO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=gO.bind(null,e.syncEngine),n}function DO(t,e,n={}){const i=new Hi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,h,m,g){const _=new XS({next:b=>{_.Nu(),c.enqueueAndForget((()=>BS(l,v)));const w=b.docs.has(h);!w&&b.fromCache?g.reject(new Te(_e.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&b.fromCache&&m&&m.source==="server"?g.reject(new Te(_e.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(b)},error:b=>g.reject(b)}),v=new FS(Xg(h.path),_,{includeMetadataChanges:!0,qa:!0});return US(l,v)})(await ZS(t),t.asyncQueue,e,n,i))),i.promise}function IO(t,e,n={}){const i=new Hi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,h,m,g){const _=new XS({next:b=>{_.Nu(),c.enqueueAndForget((()=>BS(l,v))),b.fromCache&&m.source==="server"?g.reject(new Te(_e.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(b)},error:b=>g.reject(b)}),v=new FS(h,_,{includeMetadataChanges:!0,qa:!0});return US(l,v)})(await ZS(t),t.asyncQueue,e,n,i))),i.promise}function e1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const qx=new Map;const t1="firestore.googleapis.com",Hx=!0;class Gx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Te(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=t1,this.ssl=Hx}else this.host=e.host,this.ssl=e.ssl??Hx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=RS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<l5)throw new Te(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Gj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=e1(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Te(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Te(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Te(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class of{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Te(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Te(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Nj;switch(i.type){case"firstParty":return new zj(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Te(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=qx.get(n);i&&(Ae("ComponentProvider","Removing Datastore"),qx.delete(n),i.terminate())})(this),Promise.resolve()}}function jO(t,e,n,i={}){t=vi(t,of);const a=yl(e),l=t._getSettings(),c={...l,emulatorOptions:t._getEmulatorOptions()},h=`${e}:${n}`;a&&(Sw(`https://${h}`),Tw("Firestore",!0)),l.host!==t1&&l.host!==h&&tl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...l,host:h,ssl:a,emulatorOptions:i};if(!$s(m,c)&&(t._setSettings(m),i.mockUserToken)){let g,_;if(typeof i.mockUserToken=="string")g=i.mockUserToken,_=Sn.MOCK_USER;else{g=sI(i.mockUserToken,t._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new Te(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new Sn(v)}t._authCredentials=new Pj(new Uw(g,_))}}class wl{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new wl(this.firestore,e,this._query)}}class Lt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Lt(this.firestore,e,this._key)}toJSON(){return{type:Lt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(cu(n,Lt._jsonSchema))return new Lt(e,i||null,new Oe(_t.fromString(n.referencePath)))}}Lt._jsonSchemaVersion="firestore/documentReference/1.0",Lt._jsonSchema={type:Xt("string",Lt._jsonSchemaVersion),referencePath:Xt("string")};class Hs extends wl{constructor(e,n,i){super(e,n,Xg(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Lt(this.firestore,null,new Oe(e))}withConverter(e){return new Hs(this.firestore,e,this._path)}}function OO(t,e,...n){if(t=cn(t),Bw("collection","path",e),t instanceof of){const i=_t.fromString(e,...n);return ix(i),new Hs(t,null,i)}{if(!(t instanceof Lt||t instanceof Hs))throw new Te(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(_t.fromString(e,...n));return ix(i),new Hs(t.firestore,null,i)}}function lf(t,e,...n){if(t=cn(t),arguments.length===1&&(e=Gg.newId()),Bw("doc","path",e),t instanceof of){const i=_t.fromString(e,...n);return rx(i),new Lt(t,null,new Oe(i))}{if(!(t instanceof Lt||t instanceof Hs))throw new Te(_e.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(_t.fromString(e,...n));return rx(i),new Lt(t.firestore,t instanceof Hs?t.converter:null,new Oe(i))}}const $x="AsyncQueue";class Qx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new OS(this,"async_queue_retry"),this._c=()=>{const i=Mp();i&&Ae($x,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Mp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Mp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Hi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!xl(e))throw e;Ae($x,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Qi("INTERNAL UNHANDLED ERROR: ",Wx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=dy.createAndSchedule(this,e,n,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Pe(47125,{Pc:Wx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Wx(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Sl extends of{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new Qx,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Qx(e),this._firestoreClient=void 0,await e}}}function MO(t,e){const n=typeof t=="object"?t:Dw(),i=typeof t=="string"?t:Sh,a=qg(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=rI("firestore");l&&jO(a,...l)}return a}function gy(t){if(t._terminated)throw new Te(_e.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||kO(t),t._firestoreClient}function kO(t){const e=t._freezeSettings(),n=(function(a,l,c,h){return new n2(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,e1(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new AO(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(t._componentsProvider))}class br{constructor(e){this._byteString=e}static fromBase64String(e){try{return new br(xn.fromBase64String(e))}catch(n){throw new Te(_e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new br(xn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:br._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(cu(e,br._jsonSchema))return br.fromBase64String(e.bytes)}}br._jsonSchemaVersion="firestore/bytes/1.0",br._jsonSchema={type:Xt("string",br._jsonSchemaVersion),bytes:Xt("string")};class cf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Te(_e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class uf{constructor(e){this._methodName=e}}class hi{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Te(_e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Te(_e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Xe(this._lat,e._lat)||Xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hi._jsonSchemaVersion}}static fromJSON(e){if(cu(e,hi._jsonSchema))return new hi(e.latitude,e.longitude)}}hi._jsonSchemaVersion="firestore/geoPoint/1.0",hi._jsonSchema={type:Xt("string",hi._jsonSchemaVersion),latitude:Xt("number"),longitude:Xt("number")};class fi{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(cu(e,fi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new fi(e.vectorValues);throw new Te(_e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fi._jsonSchemaVersion="firestore/vectorValue/1.0",fi._jsonSchema={type:Xt("string",fi._jsonSchemaVersion),vectorValues:Xt("object")};const NO=/^__.*__$/;class PO{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new ta(e,this.data,this.fieldMask,n,this.fieldTransforms):new du(e,this.data,n,this.fieldTransforms)}}class n1{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new ta(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function r1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pe(40011,{Ac:t})}}class df{constructor(e,n,i,a,l,c){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new df({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return kh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(r1(this.Ac)&&NO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class LO{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||rf(e)}Cc(e,n,i,a=!1){return new df({Ac:e,methodName:n,Dc:i,path:vn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yy(t){const e=t._freezeSettings(),n=rf(t._databaseId);return new LO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function VO(t,e,n,i,a,l={}){const c=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);vy("Data must be an object, but it was:",c,i);const h=i1(i,c);let m,g;if(l.merge)m=new tr(c.fieldMask),g=c.fieldTransforms;else if(l.mergeFields){const _=[];for(const v of l.mergeFields){const b=vg(e,v,n);if(!c.contains(b))throw new Te(_e.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);a1(_,b)||_.push(b)}m=new tr(_),g=c.fieldTransforms.filter((v=>m.covers(v.field)))}else m=null,g=c.fieldTransforms;return new PO(new Un(h),m,g)}class pu extends uf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pu}}function zO(t,e,n){return new df({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class _y extends uf{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=zO(this,e,!0),i=this.vc.map((l=>Tl(l,n))),a=new sl(i);return new R2(e.path,a)}isEqual(e){return e instanceof _y&&$s(this.vc,e.vc)}}function UO(t,e,n,i){const a=t.Cc(1,e,n);vy("Data must be an object, but it was:",a,i);const l=[],c=Un.empty();ea(i,((m,g)=>{const _=by(e,m,n);g=cn(g);const v=a.yc(_);if(g instanceof pu)l.push(_);else{const b=Tl(g,v);b!=null&&(l.push(_),c.set(_,b))}}));const h=new tr(l);return new n1(c,h,a.fieldTransforms)}function BO(t,e,n,i,a,l){const c=t.Cc(1,e,n),h=[vg(e,i,n)],m=[a];if(l.length%2!=0)throw new Te(_e.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<l.length;b+=2)h.push(vg(e,l[b])),m.push(l[b+1]);const g=[],_=Un.empty();for(let b=h.length-1;b>=0;--b)if(!a1(g,h[b])){const w=h[b];let A=m[b];A=cn(A);const S=c.yc(w);if(A instanceof pu)g.push(w);else{const M=Tl(A,S);M!=null&&(g.push(w),_.set(w,M))}}const v=new tr(g);return new n1(_,v,c.fieldTransforms)}function FO(t,e,n,i=!1){return Tl(n,t.Cc(i?4:3,e))}function Tl(t,e){if(s1(t=cn(t)))return vy("Unsupported field value:",e,t),i1(t,e);if(t instanceof uf)return(function(i,a){if(!r1(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let c=0;for(const h of i){let m=Tl(h,a.wc(c));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),c++}return{arrayValue:{values:l}}})(t,e)}return(function(i,a){if((i=cn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return T2(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=xt.fromDate(i);return{timestampValue:Ih(a.serializer,l)}}if(i instanceof xt){const l=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ih(a.serializer,l)}}if(i instanceof hi)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof br)return{bytesValue:xS(a.serializer,i._byteString)};if(i instanceof Lt){const l=a.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw a.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:ny(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof fi)return(function(c,h){return{mapValue:{fields:{[Yw]:{stringValue:Xw},[Th]:{arrayValue:{values:c.toArray().map((g=>{if(typeof g!="number")throw h.Sc("VectorValues must only contain numeric values.");return Jg(h.serializer,g)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${Wh(i)}`)})(t,e)}function i1(t,e){const n={};return Hw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ea(t,((i,a)=>{const l=Tl(a,e.mc(i));l!=null&&(n[i]=l)})),{mapValue:{fields:n}}}function s1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xt||t instanceof hi||t instanceof br||t instanceof Lt||t instanceof uf||t instanceof fi)}function vy(t,e,n){if(!s1(n)||!Fw(n)){const i=Wh(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function vg(t,e,n){if((e=cn(e))instanceof cf)return e._internalPath;if(typeof e=="string")return by(t,e);throw kh("Field path arguments must be of type string or ",t,!1,void 0,n)}const qO=new RegExp("[~\\*/\\[\\]]");function by(t,e,n){if(e.search(qO)>=0)throw kh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new cf(...e.split("."))._internalPath}catch{throw kh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function kh(t,e,n,i,a){const l=i&&!i.isEmpty(),c=a!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(l||c)&&(m+=" (found",l&&(m+=` in field ${i}`),c&&(m+=` in document ${a}`),m+=")"),new Te(_e.INVALID_ARGUMENT,h+t+m)}function a1(t,e){return t.some((n=>n.isEqual(e)))}class o1{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Lt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new HO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(xy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class HO extends o1{data(){return super.data()}}function xy(t,e){return typeof e=="string"?by(t,e):e instanceof cf?e._internalPath:e._delegate._internalPath}function GO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Te(_e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ey{}class $O extends Ey{}function QO(t,e,...n){let i=[];e instanceof Ey&&i.push(e),i=i.concat(n),(function(l){const c=l.filter((m=>m instanceof wy)).length,h=l.filter((m=>m instanceof hf)).length;if(c>1||c>0&&h>0)throw new Te(_e.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)t=a._apply(t);return t}class hf extends $O{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new hf(e,n,i)}_apply(e){const n=this._parse(e);return l1(e._query,n),new wl(e.firestore,e.converter,lg(e._query,n))}_parse(e){const n=yy(e.firestore);return(function(l,c,h,m,g,_,v){let b;if(g.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new Te(_e.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){Yx(v,_);const A=[];for(const S of v)A.push(Kx(m,l,S));b={arrayValue:{values:A}}}else b=Kx(m,l,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||Yx(v,_),b=FO(h,c,v,_==="in"||_==="not-in");return Yt.create(g,_,b)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function WO(t,e,n){const i=e,a=xy("where",t);return hf._create(a,i,n)}class wy extends Ey{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new wy(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Ur.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,l){let c=a;const h=l.getFlattenedFilters();for(const m of h)l1(c,m),c=lg(c,m)})(e._query,n),new wl(e.firestore,e.converter,lg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Kx(t,e,n){if(typeof(n=cn(n))=="string"){if(n==="")throw new Te(_e.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sS(e)&&n.indexOf("/")!==-1)throw new Te(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(_t.fromString(n));if(!Oe.isDocumentKey(i))throw new Te(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return hx(t,new Oe(i))}if(n instanceof Lt)return hx(t,n._key);throw new Te(_e.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wh(n)}.`)}function Yx(t,e){if(!Array.isArray(t)||t.length===0)throw new Te(_e.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function l1(t,e){const n=(function(a,l){for(const c of a)for(const h of c.getFlattenedFilters())if(l.indexOf(h.op)>=0)return h.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Te(_e.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Te(_e.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class KO{convertValue(e,n="none"){switch(Ys(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ks(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Pe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return ea(e,((a,l)=>{i[a]=this.convertValue(l,n)})),i}convertVectorValue(e){const n=e.fields?.[Th].arrayValue?.values?.map((i=>Pt(i.doubleValue)));return new fi(n)}convertGeoPoint(e){return new hi(Pt(e.latitude),Pt(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Xh(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Yc(e));default:return null}}convertTimestamp(e){const n=Ws(e);return new xt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=_t.fromString(e);at(CS(i),9688,{name:e});const a=new Xc(i.get(1),i.get(3)),l=new Oe(i.popFirst(5));return a.isEqual(n)||Qi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function YO(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Vc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ka extends o1{constructor(e,n,i,a,l,c){super(e,n,i,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new dh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(xy("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(_e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ka._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ka._jsonSchemaVersion="firestore/documentSnapshot/1.0",ka._jsonSchema={type:Xt("string",ka._jsonSchemaVersion),bundleSource:Xt("string","DocumentSnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class dh extends ka{data(e={}){return super.data(e)}}class Ko{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Vc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new dh(this._firestore,this._userDataWriter,i.key,i,new Vc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Te(_e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((h=>{const m=new dh(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Vc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);return h.doc,{type:"added",doc:m,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((h=>l||h.type!==3)).map((h=>{const m=new dh(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Vc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);let g=-1,_=-1;return h.type!==0&&(g=c.indexOf(h.doc.key),c=c.delete(h.doc.key)),h.type!==1&&(c=c.add(h.doc),_=c.indexOf(h.doc.key)),{type:XO(h.type),doc:m,oldIndex:g,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(_e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ko._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Gg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function XO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe(61501,{type:t})}}function JO(t){t=vi(t,Lt);const e=vi(t.firestore,Sl);return DO(gy(e),t._key).then((n=>rM(e,t,n)))}Ko._jsonSchemaVersion="firestore/querySnapshot/1.0",Ko._jsonSchema={type:Xt("string",Ko._jsonSchemaVersion),bundleSource:Xt("string","QuerySnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class c1 extends KO{constructor(e){super(),this.firestore=e}convertBytes(e){return new br(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Lt(this.firestore,null,n)}}function ZO(t){t=vi(t,wl);const e=vi(t.firestore,Sl),n=gy(e),i=new c1(e);return GO(t._query),IO(n,t._query).then((a=>new Ko(e,i,t,a)))}function eM(t,e,n){t=vi(t,Lt);const i=vi(t.firestore,Sl),a=YO(t.converter,e,n);return Sy(i,[VO(yy(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,zr.none())])}function tM(t,e,n,...i){t=vi(t,Lt);const a=vi(t.firestore,Sl),l=yy(a);let c;return c=typeof(e=cn(e))=="string"||e instanceof cf?BO(l,"updateDoc",t._key,e,n,i):UO(l,"updateDoc",t._key,e),Sy(a,[c.toMutation(t._key,zr.exists(!0))])}function nM(t){return Sy(vi(t.firestore,Sl),[new Zg(t._key,zr.none())])}function Sy(t,e){return(function(i,a){const l=new Hi;return i.asyncQueue.enqueueAndForget((async()=>yO(await RO(i),a,l))),l.promise})(gy(t),e)}function rM(t,e,n){const i=n.docs.get(e._key),a=new c1(t);return new ka(t,a,e._key,i,new Vc(n.hasPendingWrites,n.fromCache),e.converter)}function iM(){return new pu("deleteField")}function sM(...t){return new _y("arrayUnion",t)}(function(e,n=!0){(function(a){vl=a})(_l),el(new La("firestore",((i,{instanceIdentifier:a,options:l})=>{const c=i.getProvider("app").getImmediate(),h=new Sl(new Lj(i.getProvider("auth-internal")),new Uj(c,i.getProvider("app-check-internal")),(function(g,_){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new Te(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xc(g.options.projectId,_)})(c,a),c);return l={useFetchStreams:n,...l},h._setSettings(l),h}),"PUBLIC").setMultipleInstances(!0)),Fs(Zb,ex,e),Fs(Zb,ex,"esm2020")})();function gu(){return MO(Ow)}function yu(t,e,n,i=1,a){{let l=e;if(e.startsWith("budgets/"))l="budgets";else if(e.startsWith("months/")){const m=e.replace("months/","").split("_");if(m.length>=2){const g=m[m.length-1];l=`months/${m[m.length-2]}/${g}`}}console.log(`[Firebase] ${t}(${i}): ${l}${a===!1?" [NOT FOUND]":""}  ${n}`)}}async function Le(t,e,n){const i=lf(gu(),t,e),a=`${t}/${e}`,l=await JO(i),c=l.exists();return yu("READ",a,n,1,c),{exists:c,data:c?l.data():null,ref:i}}async function xr(t,e,n){const i=gu(),a=OO(i,t);let l;if(n&&n.length>0){const m=n.map(g=>WO(g.field,g.op,g.value));l=QO(a,...m)}else l=a;const c=await ZO(l);let h=t;if(n&&n.length>0){const m=n.map(g=>`${g.field} ${g.op} ${JSON.stringify(g.value)}`).join(", ");h+=` WHERE ${m}`}return yu("QUERY",h,e,c.docs.length),{docs:c.docs.map(m=>({id:m.id,data:m.data()}))}}async function gt(t,e,n,i,a){const l=lf(gu(),t,e),c=`${t}/${e}`;return yu("WRITE",c,i),eM(l,n,a??{})}async function Ma(t,e,n,i){const a=lf(gu(),t,e),l=`${t}/${e}`;return yu("UPDATE",l,i),tM(a,n)}async function Ty(t,e,n){const i=lf(gu(),t,e),a=`${t}/${e}`;return yu("DELETE",a,n),nM(i)}function mi(t,e,n){const i=n.toString().padStart(2,"0");return`${t}_${e}_${i}`}function Ay(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function aM(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}function nn(t,e){return`${t}${e.toString().padStart(2,"0")}`}function u1(){const t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=[];for(let a=3;a>0;a--){let l=e,c=n-a;for(;c<1;)c+=12,l-=1;i.push(nn(l,c))}i.push(nn(e,n));for(let a=1;a<=3;a++){let l=e,c=n+a;for(;c>12;)c-=12,l+=1;i.push(nn(l,c))}return i}function d1(t){const e=new Set(u1()),n={};for(const[i,a]of Object.entries(t))e.has(i)&&(n[i]=a);return n}function oM(t,e){const n=Ee.budget(t),i=mt.getQueryData(n);if(!i?.monthMap)return!1;for(const[a,l]of Object.entries(i.monthMap))if(a>e&&!l.needs_recalculation)return!1;return!0}function lM(t,e,n){const i=Ee.budget(t),a=mt.getQueryData(i);a&&mt.setQueryData(i,{...a,isNeedsRecalculation:!0,monthMap:n,budget:{...a.budget,is_needs_recalculation:!0,month_map:n}})}async function cM(t,e,n){const i=nn(e,n);if(oM(t,i))return console.log("[markMonthsNeedRecalculation] All future months already marked in cache, skipping write"),{markedCount:0,budgetUpdated:!1};const{exists:a,data:l}=await Le("budgets",t,"reading budget for month_map update");if(!a||!l)return console.warn(`[markMonthsNeedRecalculation] Budget ${t} not found`),{markedCount:0,budgetUpdated:!1};const h={...l.month_map||{}},m=u1();for(const v of m)h[v]||(h[v]={needs_recalculation:!1});let g=0;for(const v of m)v>i&&(h[v]?.needs_recalculation||(h[v]={needs_recalculation:!0},g++));if(g===0)return console.log("[markMonthsNeedRecalculation] No new months to mark, skipping write"),{markedCount:0,budgetUpdated:!1};const _=d1(h);return lM(t,i,_),await Ma("budgets",t,{is_needs_recalculation:!0,month_map:_,updated_at:new Date().toISOString()},`marking budget and ${g} future months as needing recalculation`),{markedCount:g,budgetUpdated:!0}}async function uM(t,e,n,i=!1){const a=nn(e,n),{exists:l,data:c}=await Le("budgets",t,"reading budget for month_map update (add month)");if(!l||!c){console.warn(`[setMonthInBudgetMap] Budget ${t} not found`);return}const m={...c.month_map||{},[a]:{needs_recalculation:i}},g=d1(m),_=Ee.budget(t),v=mt.getQueryData(_);v&&mt.setQueryData(_,{...v,monthMap:g,budget:{...v.budget,month_map:g}}),await Ma("budgets",t,{month_map:g,updated_at:new Date().toISOString()},`adding month ${e}/${n} to budget month_map`)}const dM={categoryEndBalances:{},accountEndBalances:{},totalIncome:0};function hM(t,e){const n=fM(t.category_balances,e.categoryEndBalances),i=mM(t,e.accountEndBalances);return{...t,previous_month_income:e.totalIncome,category_balances:n,account_balances:i,updated_at:new Date().toISOString()}}function fM(t,e){const n=new Map;for(const a of t)n.set(a.category_id,a);const i=t.map(a=>{const l=e[a.category_id]??0;return{...a,start_balance:l,end_balance:l+a.allocated-a.spent}});for(const[a,l]of Object.entries(e))n.has(a)||i.push({category_id:a,start_balance:l,allocated:0,spent:0,end_balance:l});return i}function mM(t,e){const n=new Set;for(const a of t.income||[])n.add(a.account_id);for(const a of t.expenses||[])n.add(a.account_id);for(const a of Object.keys(e))n.add(a);for(const a of t.account_balances||[])n.add(a.account_id);const i=[];for(const a of n){const l=e[a]??0,c=(t.income||[]).filter(g=>g.account_id===a).reduce((g,_)=>g+_.amount,0),h=(t.expenses||[]).filter(g=>g.account_id===a).reduce((g,_)=>g+_.amount,0),m=c-h;i.push({account_id:a,start_balance:l,income:c,expenses:h,net_change:m,end_balance:l+m})}return i}function Xx(t){const e={},n={};for(const i of t.category_balances||[])e[i.category_id]=i.end_balance;for(const i of t.account_balances||[])n[i.account_id]=i.end_balance;return{categoryEndBalances:e,accountEndBalances:n,totalIncome:t.total_income}}async function h1(t,e,n){const i=mi(t,e.year,e.month);await gt("months",i,e,`writeMonthData: ${n}`)}async function f1(t,e,n){await cM(t,e,n)}async function m1(t){const{budgetId:e,month:n,description:i,cascadeRecalculation:a=!0}=t;await h1(e,n,i||`${n.year}/${n.month}`),mt.setQueryData(Ee.month(e,n.year,n.month),{month:n}),a&&await f1(e,n.year,n.month)}function Xi(){const t=rn();return{writeData:ir({mutationFn:async({budgetId:n,month:i,description:a,cascadeRecalculation:l=!0})=>(await h1(n,i,a||`${i.year}/${i.month}`),{budgetId:n,year:i.year,month:i.month,cascadeRecalculation:l}),onMutate:async({budgetId:n,month:i})=>{const a=Ee.month(n,i.year,i.month);await t.cancelQueries({queryKey:a});const l=t.getQueryData(a);return t.setQueryData(a,{month:i}),{oldMonthQueryData:l,monthKey:a}},onSuccess:async({budgetId:n,year:i,month:a,cascadeRecalculation:l})=>{l&&await f1(n,i,a)},onError:(n,i,a)=>{a?.oldMonthQueryData&&t.setQueryData(a.monthKey,a.oldMonthQueryData)}})}}function pM(t){const e={},n={};return t.category_balances&&t.category_balances.forEach(i=>{e[i.category_id]=i.end_balance}),t.account_balances&&t.account_balances.forEach(i=>{n[i.account_id]=i.end_balance}),{categoryEndBalances:e,accountEndBalances:n}}async function gM(t,e,n){const i=new Date,a=i.getFullYear(),l=i.getMonth()+1,c=(e-a)*12+(n-l);if(c>3){const M=`[createMonth] Refusing to create month ${e}/${n} - it's ${c} months in the future (max allowed: 3). This likely indicates a bug in month navigation.`;throw console.error(M),new Error(M)}if(c<-3){const M=`[createMonth] Refusing to create month ${e}/${n} - it's ${Math.abs(c)} months in the past (max allowed: 3). Existing months can still be viewed, but new months cannot be created this far back.`;throw console.error(M),new Error(M)}const h=i.toISOString(),m=mi(t,e,n);let g=0,_={},v={};if(n>1||e>new Date().getFullYear()-10){const{year:M,month:F}=Ay(e,n),H=mi(t,M,F),{exists:z,data:ee}=await Le("months",H,"fetching previous month to create start balances for new month");if(z&&ee){const J={year_month_ordinal:ee.year_month_ordinal??nn(M,F),year:ee.year??M,month:ee.month??F,income:ee.income||[],total_income:ee.total_income??0,previous_month_income:ee.previous_month_income??0,expenses:ee.expenses||[],total_expenses:ee.total_expenses??0,account_balances:ee.account_balances||[],category_balances:ee.category_balances||[],are_allocations_finalized:ee.are_allocations_finalized??!1,created_at:ee.created_at,updated_at:ee.updated_at};g=J.total_income;const{categoryEndBalances:me,accountEndBalances:P}=pM(J);_=me,v=P}}const b=Object.entries(_).map(([M,F])=>({category_id:M,start_balance:F,allocated:0,spent:0,end_balance:F})),w=Object.entries(v).map(([M,F])=>({account_id:M,start_balance:F,income:0,expenses:0,net_change:0,end_balance:F})),A={budget_id:t,year_month_ordinal:nn(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:g,expenses:[],total_expenses:0,account_balances:w,category_balances:b,are_allocations_finalized:!1,created_at:h,updated_at:h},S={budget_id:t,year_month_ordinal:nn(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:g,expenses:[],total_expenses:0,account_balances:w,category_balances:b,are_allocations_finalized:!1,created_at:h,updated_at:h};return await gt("months",m,S,"creating new month document (first time viewing this month)"),mt.setQueryData(Ee.month(t,e,n),{month:A}),await uM(t,e,n,!1),A}function yM(t,e,n,i){const a={};t.category_balances&&t.category_balances.forEach(c=>{a[c.category_id]=c});const l=t.expenses??[];return e.map(c=>{const m=a[c]?.start_balance??0,g=n[c]??0,_=l.filter(v=>v.category_id===c).reduce((v,b)=>v+b.amount,0);return{category_id:c,start_balance:m,allocated:g,spent:_,end_balance:m+g-_}})}function _M(){const{writeData:t}=Xi();return{saveDraftAllocations:async(n,i,a,l)=>{const c=await Ji(n,i,a,"save draft allocations"),h=c.category_balances.map(g=>({...g,allocated:l[g.category_id]??g.allocated})),m={...c,category_balances:h,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:n,month:m,cascadeRecalculation:!1}),{updatedMonth:m}},isPending:t.isPending,isError:t.isError,error:t.error}}function vM(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,category_group_id:i.category_group_id??null,sort_order:i.sort_order,balance:i.balance??0},i.description!==void 0&&(e[n].description=i.description),i.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=i.default_monthly_amount),i.default_monthly_type!==void 0&&(e[n].default_monthly_type=i.default_monthly_type)}),e}function bM(){const t=rn();return{updateCategories:ir({mutationFn:async({budgetId:n,categories:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const c=vM(i);return await gt("budgets",n,{...l,categories:c},"saving updated categories (user edited category settings)"),i},onMutate:async({budgetId:n,categories:i})=>{await t.cancelQueries({queryKey:Ee.budget(n)});const a=t.getQueryData(Ee.budget(n));return a&&t.setQueryData(Ee.budget(n),{...a,categories:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(Ee.budget(i));a&&t.setQueryData(Ee.budget(i),{...a,categories:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(Ee.budget(i),a.previousData)}})}}function xM(){const t=rn();return{updateCategoryGroups:ir({mutationFn:async({budgetId:n,categoryGroups:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await gt("budgets",n,{...l,category_groups:i},"saving updated category groups (user edited group settings)"),i},onMutate:async({budgetId:n,categoryGroups:i})=>{await t.cancelQueries({queryKey:Ee.budget(n)});const a=t.getQueryData(Ee.budget(n));return a&&t.setQueryData(Ee.budget(n),{...a,categoryGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(Ee.budget(i));a&&t.setQueryData(Ee.budget(i),{...a,categoryGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(Ee.budget(i),a.previousData)}})}}async function p1(t,e){if(e.length===0)return;const n=e.filter(g=>g.delta!==0);if(n.length===0)return;const i=mt.getQueryData(Ee.budget(t));if(!i)return;let a=0,l=0;const c={...i.categories};for(const{categoryId:g,delta:_}of n)if(c[g]){const v=c[g].balance,b=v+_;v>0&&(a+=v),b>0&&(l+=b),c[g]={...c[g],balance:b}}const h=l-a,m=i.budget?{...i.budget,total_available:i.budget.total_available-h}:i.budget;mt.setQueryData(Ee.budget(t),{...i,categories:c,budget:m})}function EM(){const{writeData:t}=Xi();return{finalizeAllocations:async n=>{const{budgetId:i,year:a,month:l,allocations:c}=n,h=await Ji(i,a,l,"finalize allocations"),m=h.category_balances?.map(w=>w.category_id)??Object.keys(c),g={};if(h.are_allocations_finalized&&h.category_balances)for(const w of h.category_balances)g[w.category_id]=w.allocated;const _=m.length>0?yM(h,m,c):h.category_balances,v={...h,category_balances:_,are_allocations_finalized:!0,updated_at:new Date().toISOString()};await t.mutateAsync({budgetId:i,month:v,description:"finalize allocations"});const b=m.map(w=>({categoryId:w,delta:(c[w]??0)-(g[w]??0)}));return await p1(i,b),{updatedMonth:v}},isPending:t.isPending,isError:t.isError,error:t.error}}function g1(){const{writeData:t}=Xi();return{deleteAllocations:async n=>{const{budgetId:i,year:a,month:l}=n,c=await Ji(i,a,l,"delete allocations"),h=[];if(c.are_allocations_finalized&&c.category_balances)for(const _ of c.category_balances)_.allocated>0&&h.push({categoryId:_.category_id,allocated:_.allocated});const m=c.category_balances.map(_=>({..._,allocated:0,end_balance:_.start_balance-_.spent})),g={...c,category_balances:m,are_allocations_finalized:!1,updated_at:new Date().toISOString()};if(await t.mutateAsync({budgetId:i,month:g,description:"delete allocations"}),h.length>0){const _=h.map(({categoryId:v,allocated:b})=>({categoryId:v,delta:-b}));await p1(i,_)}return{updatedMonth:g}},isPending:t.isPending,isError:t.isError,error:t.error}}async function ff(t,e,n){const i=e.trim();if(!i||n.includes(i))return null;const a=[...n,i].sort((l,c)=>l.toLowerCase().localeCompare(c.toLowerCase()));return await gt("payees",t,{budget_id:t,payees:a,updated_at:new Date().toISOString()},`adding new payee "${i}" to autocomplete list`),a}function Al(t){const e=t.income||[],n=t.expenses||[],i=e.reduce((h,m)=>h+m.amount,0),a=n.reduce((h,m)=>h+m.amount,0),l=wM(t),c=SM(t);return{...t,total_income:i,total_expenses:a,account_balances:l,category_balances:c}}function wM(t){const e=t.income||[],n=t.expenses||[],i=t.account_balances||[],a=new Map;for(const h of i)a.set(h.account_id,h);const l=new Set;for(const h of e)l.add(h.account_id);for(const h of n)l.add(h.account_id);for(const h of i)l.add(h.account_id);const c=[];for(const h of l){const g=a.get(h)?.start_balance??0,_=e.filter(w=>w.account_id===h).reduce((w,A)=>w+A.amount,0),v=n.filter(w=>w.account_id===h).reduce((w,A)=>w+A.amount,0),b=_-v;c.push({account_id:h,start_balance:g,income:_,expenses:v,net_change:b,end_balance:g+b})}return c}function SM(t){const e=t.expenses||[],n=t.category_balances||[],i=new Map;for(const h of n)i.set(h.category_id,h);const a=new Map;for(const h of e){const m=a.get(h.category_id)||0;a.set(h.category_id,m+h.amount)}const l=new Set;for(const h of n)l.add(h.category_id);for(const h of e)l.add(h.category_id);const c=[];for(const h of l){const m=i.get(h),g=a.get(h)??0;m?c.push({...m,spent:g,end_balance:m.start_balance+m.allocated-g}):c.push({category_id:h,start_balance:0,allocated:0,spent:g,end_balance:-g})}return c}function TM(t,e){let n=0;for(const{accountId:i,delta:a}of e){const l=t.accounts[i];if(!l)continue;const c=l.account_group_id?t.accountGroups[l.account_group_id]:void 0,h=c?.on_budget!==void 0?c.on_budget:l.on_budget!==!1,m=c?.is_active!==void 0?c.is_active:l.is_active!==!1;h&&m&&(n+=a)}return n}async function Zs(t,e){if(e.length===0)return;const n=e.filter(h=>h.delta!==0);if(n.length===0)return;const i=mt.getQueryData(Ee.budget(t));if(!i)return;const a=TM(i,n),l={...i.accounts};for(const{accountId:h,delta:m}of n)l[h]&&(l[h]={...l[h],balance:l[h].balance+m});const c=i.budget?{...i.budget,total_available:i.budget.total_available+a}:i.budget;mt.setQueryData(Ee.budget(t),{...i,accounts:l,budget:c})}function AM(){const t=rn(),{writeData:e}=Xi();return{addIncome:async(i,a,l,c,h,m,g,_)=>{const v=await Ji(i,a,l,"add income"),b={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:c,account_id:h,date:m,created_at:new Date().toISOString()};g?.trim()&&(b.payee=g.trim()),_&&(b.description=_);const w=[...v.income||[],b],A=Al({...v,income:w,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:A,description:"add income"}),await Zs(i,[{accountId:h,delta:c}]),g?.trim()){const S=t.getQueryData(Ee.payees(i))||[],M=await ff(i,g,S);M&&t.setQueryData(Ee.payees(i),M)}return{updatedMonth:A,newIncome:b}},isPending:e.isPending,isError:e.isError,error:e.error}}function CM(){const t=rn(),{writeData:e}=Xi();return{updateIncome:async(i,a,l,c,h,m,g,_,v)=>{const b=await Ji(i,a,l,"update income"),w=(b.income||[]).find(z=>z.id===c),A=w?.amount??0,S=w?.account_id??m,M={id:c,amount:h,account_id:m,date:g,created_at:(b.income||[]).find(z=>z.id===c)?.created_at||new Date().toISOString()};_?.trim()&&(M.payee=_.trim()),v&&(M.description=v);const F=(b.income||[]).map(z=>z.id===c?M:z),H=Al({...b,income:F,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:H,description:"update income"}),S===m?await Zs(i,[{accountId:m,delta:h-A}]):await Zs(i,[{accountId:S,delta:-A},{accountId:m,delta:h}]),_?.trim()){const z=t.getQueryData(Ee.payees(i))||[],ee=await ff(i,_,z);ee&&t.setQueryData(Ee.payees(i),ee)}return{updatedMonth:H}},isPending:e.isPending,isError:e.isError,error:e.error}}function RM(){const{writeData:t}=Xi();return{deleteIncome:async(n,i,a,l)=>{const c=await Ji(n,i,a,"delete income"),h=(c.income||[]).find(b=>b.id===l),m=h?.amount??0,g=h?.account_id,_=(c.income||[]).filter(b=>b.id!==l),v=Al({...c,income:_,updated_at:new Date().toISOString()});return await t.mutateAsync({budgetId:n,month:v,description:"delete income"}),g&&m>0&&await Zs(n,[{accountId:g,delta:-m}]),{updatedMonth:v}},isPending:t.isPending,isError:t.isError,error:t.error}}function DM(){const t=rn(),{writeData:e}=Xi();return{addExpense:async(i,a,l,c,h,m,g,_,v,b)=>{const w=await Ji(i,a,l,"add expense"),A={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:c,category_id:h,account_id:m,date:g,created_at:new Date().toISOString()};_?.trim()&&(A.payee=_.trim()),v&&(A.description=v),b!==void 0&&(A.cleared=b);const S=[...w.expenses||[],A],M=Al({...w,expenses:S,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:M,description:"add expense"}),await Zs(i,[{accountId:m,delta:-c}]),_?.trim()){const F=t.getQueryData(Ee.payees(i))||[],H=await ff(i,_,F);H&&t.setQueryData(Ee.payees(i),H)}return{updatedMonth:M,newExpense:A}},isPending:e.isPending,isError:e.isError,error:e.error}}function IM(){const t=rn(),{writeData:e}=Xi();return{updateExpense:async(i,a,l,c,h,m,g,_,v,b,w)=>{const A=await Ji(i,a,l,"update expense"),S=(A.expenses||[]).find(J=>J.id===c),M=S?.amount??0,F=S?.account_id??g,H={id:c,amount:h,category_id:m,account_id:g,date:_,created_at:A.expenses?.find(J=>J.id===c)?.created_at||new Date().toISOString()};v?.trim()&&(H.payee=v.trim()),b&&(H.description=b),w!==void 0&&(H.cleared=w);const z=(A.expenses||[]).map(J=>J.id===c?H:J),ee=Al({...A,expenses:z,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:ee,description:"update expense"}),F===g?await Zs(i,[{accountId:g,delta:M-h}]):await Zs(i,[{accountId:F,delta:M},{accountId:g,delta:-h}]),v?.trim()){const J=t.getQueryData(Ee.payees(i))||[],me=await ff(i,v,J);me&&t.setQueryData(Ee.payees(i),me)}return{updatedMonth:ee}},isPending:e.isPending,isError:e.isError,error:e.error}}function jM(){const{writeData:t}=Xi();return{deleteExpense:async(n,i,a,l)=>{const c=await Ji(n,i,a,"delete expense"),h=(c.expenses||[]).find(b=>b.id===l),m=h?.amount??0,g=h?.account_id,_=(c.expenses||[]).filter(b=>b.id!==l),v=Al({...c,expenses:_,updated_at:new Date().toISOString()});return await t.mutateAsync({budgetId:n,month:v,description:"delete expense"}),g&&m>0&&await Zs(n,[{accountId:g,delta:m}]),{updatedMonth:v}},isPending:t.isPending,isError:t.isError,error:t.error}}function hh(t,e){return`${t}${e.toString().padStart(2,"0")}`}function OM(t){const e=parseInt(t.slice(0,4),10),n=parseInt(t.slice(4,6),10);return{year:e,month:n}}function MM(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{const a=i;e[n]={needs_recalculation:a?.needs_recalculation??!1}}),e}function kM(t){return Object.entries(t).filter(([,e])=>e.needs_recalculation).map(([e])=>e).sort()}function NM(t){return Object.keys(t).sort()}async function PM(t,e){const{year:n,month:i}=OM(e),a=mi(t,n,i),{exists:l,data:c}=await Le("months",a,`fetching month ${n}/${i} for recalculation`);return!l||!c?null:{id:a,budget_id:t,year_month_ordinal:c.year_month_ordinal??nn(n,i),year:c.year??n,month:c.month??i,income:c.income||[],total_income:c.total_income??0,previous_month_income:c.previous_month_income??0,expenses:c.expenses||[],total_expenses:c.total_expenses??0,account_balances:c.account_balances||[],category_balances:c.category_balances||[],are_allocations_finalized:c.are_allocations_finalized??!1,created_at:c.created_at,updated_at:c.updated_at}}async function LM(t,e){const n=NM(e),i=[];for(const a of n){const l=await PM(t,a);l&&i.push(l)}return i}function VM(t,e){for(let n=0;n<t.length;n++){const i=hh(t[n].year,t[n].month);if(e[i]?.needs_recalculation)return n}return-1}async function y1(t,e={}){const n=new Date,i=hh(n.getFullYear(),n.getMonth()+1),a=e.triggeringMonthOrdinal||i;console.log(`[Recalculation] Starting for budget ${t}`,{triggeringMonth:a});const{exists:l,data:c}=await Le("budgets",t,"reading budget for recalculation (getting month_map)");if(!l||!c)return console.warn(`[Recalculation] Budget ${t} not found`),{monthsRecalculated:0,budgetUpdated:!1};const h=MM(c.month_map);if(kM(h).length===0&&!c.is_needs_recalculation)return console.log("[Recalculation] No months need recalculation"),{monthsRecalculated:0,budgetUpdated:!1};const g=await LM(t,h);if(g.length===0)return console.log("[Recalculation] No months found, nothing to recalculate"),await Jx(t,h),{monthsRecalculated:0,budgetUpdated:!0};const _=VM(g,h),v=_>0?_-1:-1,b=_>=0?_:0,w=g.length-1;let A=dM;if(v>=0&&(A=Xx(g[v])),_<0)return console.log("[Recalculation] No months marked as needing recalculation, but budget flag was set"),await Jx(t,h),{monthsRecalculated:0,budgetUpdated:!0};console.log(`[Recalculation] Recalculating months ${b} to ${w}`,{totalMonths:g.length,startingFrom:v>=0?hh(g[v].year,g[v].month):"beginning",firstStaleMonth:hh(g[_].year,g[_].month)});let S=0;for(let z=b;z<=w;z++){const ee=g[z],J=hM(ee,A);await m1({budgetId:t,month:J,description:`recalculating month ${ee.year}/${ee.month}`,cascadeRecalculation:!1}),A=Xx(J),S++,console.log(`[Recalculation] Completed ${ee.year}/${ee.month}`)}let M,F;return(S>0?w:v)>=0&&(M=A.accountEndBalances,F=A.categoryEndBalances),await zM(t,M||{},F||{},h),console.log("[Recalculation] Complete",{monthsRecalculated:S,budgetUpdated:!0}),{monthsRecalculated:S,budgetUpdated:!0,finalAccountBalances:M}}function _1(t){const e={};for(const n of Object.keys(t))e[n]={needs_recalculation:!1};return e}async function zM(t,e,n,i){const{exists:a,data:l}=await Le("budgets",t,"reading budget for balance update");if(!a||!l){console.warn(`[Recalculation] Budget ${t} not found when updating balances`);return}const c={...l.accounts};for(const[w,A]of Object.entries(e))c[w]&&(c[w]={...c[w],balance:A});const h={...l.categories};for(const[w,A]of Object.entries(n))h[w]&&(h[w]={...h[w],balance:A});const m=l.account_groups||{},g=Object.entries(c).reduce((w,[,A])=>{const S=A.account_group_id?m[A.account_group_id]:void 0,M=S?.on_budget!==void 0?S.on_budget:A.on_budget!==!1,F=S?.is_active!==void 0?S.is_active:A.is_active!==!1;return M&&F?w+(A.balance??0):w},0),_=Object.values(h).reduce((w,A)=>{const S=A.balance??0;return w+(S>0?S:0)},0),v=g-_,b=_1(i);await gt("budgets",t,{...l,accounts:c,categories:h,total_available:v,is_needs_recalculation:!1,month_map:b,updated_at:new Date().toISOString()},"saving recalculated balances and clearing month_map flags")}async function Jx(t,e){const{exists:n,data:i}=await Le("budgets",t,"reading budget to clear recalc flag");if(!n||!i)return;const a=i.accounts||{},l=i.categories||{},c=i.account_groups||{},h=Object.entries(a).reduce((v,[,b])=>{const w=b.account_group_id?c[b.account_group_id]:void 0,A=w?.on_budget!==void 0?w.on_budget:b.on_budget!==!1,S=w?.is_active!==void 0?w.is_active:b.is_active!==!1;return A&&S?v+(b.balance??0):v},0),m=Object.values(l).reduce((v,b)=>{const w=b.balance??0;return v+(w>0?w:0)},0),g=h-m,_=_1(e);await gt("budgets",t,{...i,total_available:g,is_needs_recalculation:!1,month_map:_,updated_at:new Date().toISOString()},"clearing budget recalc flag and month_map flags")}function Zx(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname??"",description:i.description??"",balance:i.balance??0,account_group_id:i.account_group_id??null,sort_order:i.sort_order??0,is_income_account:i.is_income_account??!1,is_income_default:i.is_income_default??!1,is_outgo_account:i.is_outgo_account??!1,is_outgo_default:i.is_outgo_default??!1,on_budget:i.on_budget??!0,is_active:i.is_active??!0}}),e}function UM(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order??0,expected_balance:i.expected_balance??"positive",on_budget:i.on_budget,is_active:i.is_active}}),e}function BM(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,description:i.description,category_group_id:i.category_group_id??null,sort_order:i.sort_order??0,default_monthly_amount:i.default_monthly_amount,default_monthly_type:i.default_monthly_type,balance:i.balance??0}}),e}function FM(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,i)=>n.sort_order-i.sort_order),e}function eE(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={needs_recalculation:i?.needs_recalculation??!1}}),e}async function qM(t){const{exists:e,data:n}=await Le("budgets",t,"loading budget data (cache miss or stale)");if(!e||!n)throw new Error(`Budget ${t} not found`);let i=Zx(n.accounts);const a=n.is_needs_recalculation??!1;if(a){console.log("[Budget] Balances are stale, triggering full recalculation...");const _=await y1(t),{data:v}=await Le("budgets",t,"reading budget after recalculation");v&&(i=Zx(v.accounts)),console.log("[Budget] Recalculation complete",{monthsRecalculated:_.monthsRecalculated})}const l=UM(n.account_groups),c=BM(n.categories),h=FM(n.category_groups);let m=n.total_available??0,g=eE(n.month_map);if(a){const{data:_}=await Le("budgets",t,"reading budget total_available after recalculation");_?.total_available!==void 0&&(m=_.total_available),_?.month_map&&(g=eE(_.month_map))}return{budget:{id:t,name:n.name,user_ids:n.user_ids||[],accepted_user_ids:n.accepted_user_ids||[],owner_id:n.owner_id||n.user_ids?.[0]||"",owner_email:n.owner_email||"",accounts:i,account_groups:l,categories:c,category_groups:h,total_available:m,is_needs_recalculation:!1,month_map:g},accounts:i,accountGroups:l,categories:c,categoryGroups:h,isNeedsRecalculation:!1,monthMap:g}}function HM(t,e){return gl({queryKey:t?Ee.budget(t):["budget","none"],queryFn:()=>qM(t),enabled:!!t&&e?.enabled!==!1})}function GM(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??nn(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at,updated_at:t.updated_at}}async function $M(t,e,n,i){const a=mi(t,e,n);return(await mt.fetchQuery({queryKey:Ee.month(t,e,n),queryFn:async()=>{const{exists:c,data:h}=await Le("months",a,i?.description??`reading month ${e}/${n}`);return!c||!h?null:{month:GM(h,t,e,n)}},staleTime:yw}))?.month??null}async function Ji(t,e,n,i){const a=mi(t,e,n),l=i?`PRE-EDIT-READ: ${i}`:"PRE-EDIT-READ",{exists:c,data:h}=await Le("months",a,l);if(!c||!h)throw new Error(`Month data not found for ${e}/${n}`);return h}async function QM(t,e,n){const i=nn(e,n);return(await xr("months","getFutureMonths: querying months after specified month",[{field:"budget_id",op:"==",value:t},{field:"year_month_ordinal",op:">",value:i}])).docs.map(c=>({id:c.id,...c.data})).sort((c,h)=>c.year!==h.year?c.year-h.year:c.month-h.month)}function WM(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??nn(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at,updated_at:t.updated_at}}async function KM(t,e,n){const i=mi(t,e,n),{exists:a,data:l}=await Le("months",i,`loading month ${e}/${n}`);return!a||!l?null:WM(l,t,e,n)}async function YM(t,e,n){const i=await KM(t,e,n);return i||gM(t,e,n)}function XM(t,e,n,i){return gl({queryKey:t?Ee.month(t,e,n):["month","none"],queryFn:async()=>({month:await YM(t,e,n)}),enabled:!!t&&i?.enabled!==!1})}async function JM(t){const{exists:e,data:n}=await Le("payees",t,"loading payees for autocomplete (cache miss or stale)");return e&&n?n.payees||[]:[]}function v1(t,e){return gl({queryKey:t?Ee.payees(t):["payees","none"],queryFn:()=>JM(t),enabled:!!t&&e?.enabled!==!1})}async function ZM(t,e){const{exists:n,data:i}=await Le("users",t,"loading user profile (cache miss or stale)");if(n&&i)return i;const a={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await gt("users",t,a,"creating new user document (first login)"),a}function ek(t,e,n){return gl({queryKey:t?Ee.user(t):["user","none"],queryFn:()=>ZM(t,e),enabled:!!t&&n?.enabled!==!1})}async function tk(t,e){const n=await xr("budgets","loading budgets user has access to (cache miss or stale)",[{field:"user_ids",op:"array-contains",value:t}]),i=[],a=[];for(const l of n.docs){const c=l.data;c.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(l.id)?i.push({id:l.id,name:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null,isOwner:c.owner_id===t,isPending:!1}):a.push({budgetId:l.id,budgetName:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null})}return{budgets:i,pendingInvites:a}}function nk(t,e,n){return gl({queryKey:t?Ee.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?tk(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}function rk(t){if(Array.isArray(t))return t;if(t&&typeof t=="object"&&!Array.isArray(t)){const e=t;if(e._methodName==="arrayUnion"&&Array.isArray(e.vc))return console.warn("[fetchFeedback] Found corrupted arrayUnion in feedback document - extracting items from vc"),e.vc}return[]}async function ik(){const t=await xr("feedback","admin loading all feedback (cache miss or stale)"),e=[];for(const n of t.docs){const i=rk(n.data.items),a=n.data.user_email||n.id;i.forEach(l=>{e.push({...l,doc_id:n.id,user_email:a})})}return{items:e}}function sk(t){return gl({queryKey:Ee.feedback(),queryFn:ik,enabled:t?.enabled!==!1})}async function ak(t,e){return mt.fetchQuery({queryKey:["budgetInvite",t,e],queryFn:async()=>{const{exists:n,data:i}=await Le("budgets",t,"checking if user has pending invite for budget");return!n||!i?null:{isInvited:i.user_ids?.includes(e)??!1,hasAccepted:i.accepted_user_ids?.includes(e)??!1,budgetName:i.name||"Unnamed Budget",ownerEmail:i.owner_email||null}},staleTime:60*1e3})}async function bg(t,e,n){const i=await $M(t,e,n,{description:`fetching month for balance calculation (walking ${e}/${n})`});return i?{year:i.year,month:i.month,category_balances:i.category_balances,are_allocations_finalized:i.are_allocations_finalized,expenses:i.expenses}:null}async function ok(t,e,n,i){const a={};e.forEach(b=>{a[b]=0});const l=await bg(t,n,i);if(l?.category_balances){for(const b of l.category_balances)e.includes(b.category_id)&&(a[b.category_id]=b.end_balance);return a}const c={};e.forEach(b=>{c[b]=0});const h=[];l&&h.push(l);let m=n,g=i,_=!1;const v=120;for(let b=0;b<v&&!_;b++){const w=Ay(m,g);m=w.year,g=w.month;const A=await bg(t,m,g);if(!A)_=!0;else if(A.category_balances){_=!0;for(const S of A.category_balances)e.includes(S.category_id)&&(c[S.category_id]=S.end_balance)}else h.push(A)}h.reverse(),Object.assign(a,c);for(const b of h){if(b.are_allocations_finalized&&b.category_balances)for(const w of b.category_balances)e.includes(w.category_id)&&(a[w.category_id]=(a[w.category_id]||0)+w.allocated);if(b.expenses)for(const w of b.expenses)e.includes(w.category_id)&&(a[w.category_id]=(a[w.category_id]||0)-w.amount)}return a}async function lk(t,e,n,i,a){const l={...n};let c=i,h=a;const m=24;for(let g=0;g<m;g++){const _=aM(c,h);c=_.year,h=_.month;const v=await bg(t,c,h);if(!v)break;if(v.are_allocations_finalized&&v.category_balances)for(const b of v.category_balances)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)+b.allocated);if(v.expenses)for(const b of v.expenses)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)-b.amount)}return l}async function tE(t,e,n,i){const a=await ok(t,e,n,i),l=await lk(t,e,a,n,i);return{current:a,total:l}}function b1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ck=b1,x1=new ou("auth","Firebase",b1());const Nh=new Bg("@firebase/auth");function uk(t,...e){Nh.logLevel<=Ye.WARN&&Nh.warn(`Auth (${_l}): ${t}`,...e)}function fh(t,...e){Nh.logLevel<=Ye.ERROR&&Nh.error(`Auth (${_l}): ${t}`,...e)}function Br(t,...e){throw Cy(t,...e)}function pi(t,...e){return Cy(t,...e)}function E1(t,e,n){const i={...ck(),[e]:n};return new ou("auth","Firebase",i).create(e,{appName:t.name})}function Gs(t){return E1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Cy(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return x1.create(t,...e)}function Ne(t,e,...n){if(!t)throw Cy(e,...n)}function Bi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw fh(e),new Error(e)}function Ki(t,e){t||Bi(e)}function xg(){return typeof self<"u"&&self.location?.href||""}function dk(){return nE()==="http:"||nE()==="https:"}function nE(){return typeof self<"u"&&self.location?.protocol||null}function hk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(dk()||dI()||"connection"in navigator)?navigator.onLine:!0}function fk(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class _u{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ki(n>e,"Short delay should be less than long delay!"),this.isMobile=lI()||hI()}get(){return hk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ry(t,e){Ki(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class w1{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Bi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Bi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Bi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const mk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const pk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],gk=new _u(3e4,6e4);function $a(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function na(t,e,n,i,a={}){return S1(t,a,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const h=lu({key:t.config.apiKey,...c}).slice(1),m=await t._getAdditionalHeaders();m["Content-Type"]="application/json",t.languageCode&&(m["X-Firebase-Locale"]=t.languageCode);const g={method:e,headers:m,...l};return uI()||(g.referrerPolicy="no-referrer"),t.emulatorConfig&&yl(t.emulatorConfig.host)&&(g.credentials="include"),w1.fetch()(await T1(t,t.config.apiHost,n,h),g)})}async function S1(t,e,n){t._canInitEmulator=!1;const i={...mk,...e};try{const a=new _k(t),l=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw rh(t,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const h=l.ok?c.errorMessage:c.error.message,[m,g]=h.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw rh(t,"credential-already-in-use",c);if(m==="EMAIL_EXISTS")throw rh(t,"email-already-in-use",c);if(m==="USER_DISABLED")throw rh(t,"user-disabled",c);const _=i[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw E1(t,_,g);Br(t,_)}}catch(a){if(a instanceof Yi)throw a;Br(t,"network-request-failed",{message:String(a)})}}async function mf(t,e,n,i,a={}){const l=await na(t,e,n,i,a);return"mfaPendingCredential"in l&&Br(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function T1(t,e,n,i){const a=`${e}${n}?${i}`,l=t,c=l.config.emulator?Ry(t.config,a):`${t.config.apiScheme}://${a}`;return pk.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function yk(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class _k{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(pi(this.auth,"network-request-failed")),gk.get())})}}function rh(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=pi(t,e,i);return a.customData._tokenResponse=n,a}function rE(t){return t!==void 0&&t.enterprise!==void 0}class vk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return yk(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function bk(t,e){return na(t,"GET","/v2/recaptchaConfig",$a(t,e))}async function xk(t,e){return na(t,"POST","/v1/accounts:delete",e)}async function Ph(t,e){return na(t,"POST","/v1/accounts:lookup",e)}function Hc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ek(t,e=!1){const n=cn(t),i=await n.getIdToken(e),a=Dy(i);Ne(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l?.sign_in_provider;return{claims:a,token:i,authTime:Hc(Np(a.auth_time)),issuedAtTime:Hc(Np(a.iat)),expirationTime:Hc(Np(a.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Np(t){return Number(t)*1e3}function Dy(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return fh("JWT malformed, contained fewer than 3 sections"),null;try{const a=bw(n);return a?JSON.parse(a):(fh("Failed to decode base64 JWT payload"),null)}catch(a){return fh("Caught error parsing JWT payload as JSON",a?.toString()),null}}function iE(t){const e=Dy(t);return Ne(e,"internal-error"),Ne(typeof e.exp<"u","internal-error"),Ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function eu(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Yi&&wk(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function wk({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class Sk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Eg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hc(this.lastLoginAt),this.creationTime=Hc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Lh(t){const e=t.auth,n=await t.getIdToken(),i=await eu(t,Ph(e,{idToken:n}));Ne(i?.users.length,e,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=a.providerUserInfo?.length?A1(a.providerUserInfo):[],c=Ak(t.providerData,l),h=t.isAnonymous,m=!(t.email&&a.passwordHash)&&!c?.length,g=h?m:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Eg(a.createdAt,a.lastLoginAt),isAnonymous:g};Object.assign(t,_)}async function Tk(t){const e=cn(t);await Lh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Ak(t,e){return[...t.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function A1(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function Ck(t,e){const n=await S1(t,{},async()=>{const i=lu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,c=await T1(t,a,"/v1/token",`key=${l}`),h=await t._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:h,body:i};return t.emulatorConfig&&yl(t.emulatorConfig.host)&&(m.credentials="include"),w1.fetch()(c,m)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Rk(t,e){return na(t,"POST","/v2/accounts:revokeToken",$a(t,e))}class Yo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ne(e.idToken,"internal-error"),Ne(typeof e.idToken<"u","internal-error"),Ne(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):iE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ne(e.length!==0,"internal-error");const n=iE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:a,expiresIn:l}=await Ck(e,n);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:a,expirationTime:l}=n,c=new Yo;return i&&(Ne(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),a&&(Ne(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Ne(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yo,this.toJSON())}_performRefresh(){return Bi("not implemented")}}function js(t,e){Ne(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Vr{constructor({uid:e,auth:n,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new Sk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Eg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await eu(this,this.stsTokenManager.getToken(this.auth,e));return Ne(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Ek(this,e)}reload(){return Tk(this)}_assign(e){this!==e&&(Ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Vr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Lh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Lr(this.auth.app))return Promise.reject(Gs(this.auth));const e=await this.getIdToken();return await eu(this,xk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,a=n.email??void 0,l=n.phoneNumber??void 0,c=n.photoURL??void 0,h=n.tenantId??void 0,m=n._redirectEventId??void 0,g=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:v,emailVerified:b,isAnonymous:w,providerData:A,stsTokenManager:S}=n;Ne(v&&S,e,"internal-error");const M=Yo.fromJSON(this.name,S);Ne(typeof v=="string",e,"internal-error"),js(i,e.name),js(a,e.name),Ne(typeof b=="boolean",e,"internal-error"),Ne(typeof w=="boolean",e,"internal-error"),js(l,e.name),js(c,e.name),js(h,e.name),js(m,e.name),js(g,e.name),js(_,e.name);const F=new Vr({uid:v,auth:e,email:a,emailVerified:b,displayName:i,isAnonymous:w,photoURL:c,phoneNumber:l,tenantId:h,stsTokenManager:M,createdAt:g,lastLoginAt:_});return A&&Array.isArray(A)&&(F.providerData=A.map(H=>({...H}))),m&&(F._redirectEventId=m),F}static async _fromIdTokenResponse(e,n,i=!1){const a=new Yo;a.updateFromServerResponse(n);const l=new Vr({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Lh(l),l}static async _fromGetAccountInfoResponse(e,n,i){const a=n.users[0];Ne(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?A1(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!l?.length,h=new Yo;h.updateFromIdToken(i);const m=new Vr({uid:a.localId,auth:e,stsTokenManager:h,isAnonymous:c}),g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Eg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(m,g),m}}const sE=new Map;function Fi(t){Ki(t instanceof Function,"Expected a class definition");let e=sE.get(t);return e?(Ki(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,sE.set(t,e),e)}class C1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}C1.type="NONE";const aE=C1;function mh(t,e,n){return`firebase:${t}:${e}:${n}`}class Xo{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=mh(this.userKey,a.apiKey,l),this.fullPersistenceKey=mh("persistence",a.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Ph(this.auth,{idToken:e}).catch(()=>{});return n?Vr._fromGetAccountInfoResponse(this.auth,n,e):null}return Vr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Xo(Fi(aE),e,i);const a=(await Promise.all(n.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let l=a[0]||Fi(aE);const c=mh(i,e.config.apiKey,e.name);let h=null;for(const g of n)try{const _=await g._get(c);if(_){let v;if(typeof _=="string"){const b=await Ph(e,{idToken:_}).catch(()=>{});if(!b)break;v=await Vr._fromGetAccountInfoResponse(e,b,_)}else v=Vr._fromJSON(e,_);g!==l&&(h=v),l=g;break}}catch{}const m=a.filter(g=>g._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new Xo(l,e,i):(l=m[0],h&&await l._set(c,h.toJSON()),await Promise.all(n.map(async g=>{if(g!==l)try{await g._remove(c)}catch{}})),new Xo(l,e,i))}}function oE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(j1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(R1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(M1(e))return"Blackberry";if(k1(e))return"Webos";if(D1(e))return"Safari";if((e.includes("chrome/")||I1(e))&&!e.includes("edge/"))return"Chrome";if(O1(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function R1(t=An()){return/firefox\//i.test(t)}function D1(t=An()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function I1(t=An()){return/crios\//i.test(t)}function j1(t=An()){return/iemobile/i.test(t)}function O1(t=An()){return/android/i.test(t)}function M1(t=An()){return/blackberry/i.test(t)}function k1(t=An()){return/webos/i.test(t)}function Iy(t=An()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Dk(t=An()){return Iy(t)&&!!window.navigator?.standalone}function Ik(){return fI()&&document.documentMode===10}function N1(t=An()){return Iy(t)||O1(t)||k1(t)||M1(t)||/windows phone/i.test(t)||j1(t)}function P1(t,e=[]){let n;switch(t){case"Browser":n=oE(An());break;case"Worker":n=`${oE(An())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${_l}/${i}`}class jk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=l=>new Promise((c,h)=>{try{const m=e(l);c(m)}catch(m){h(m)}});i.onAbort=n,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function Ok(t,e={}){return na(t,"GET","/v2/passwordPolicy",$a(t,e))}const Mk=6;class kk{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Mk,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class Nk{constructor(e,n,i,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lE(this),this.idTokenSubscription=new lE(this),this.beforeStateQueue=new jk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=x1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Fi(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Xo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Ph(this,{idToken:e}),i=await Vr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Lr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,c=i?._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===c)&&h?.user&&(i=h.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Lh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Lr(this.app))return Promise.reject(Gs(this));const n=e?cn(e):null;return n&&Ne(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Lr(this.app)?Promise.reject(Gs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Lr(this.app)?Promise.reject(Gs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Ok(this),n=new kk(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ou("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await Rk(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Fi(e)||this._popupRedirectResolver;Ne(n,this,"argument-error"),this.redirectPersistenceManager=await Xo.create(this,[Fi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,a){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let c=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ne(h,this,"internal-error"),h.then(()=>{c||l(this.currentUser)}),typeof n=="function"){const m=e.addObserver(n,i,a);return()=>{c=!0,m()}}else{const m=e.addObserver(n);return()=>{c=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=P1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Lr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&uk(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Cl(t){return cn(t)}class lE{constructor(e){this.auth=e,this.observer=null,this.addObserver=xI(n=>this.observer=n)}get next(){return Ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let pf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Pk(t){pf=t}function L1(t){return pf.loadJS(t)}function Lk(){return pf.recaptchaEnterpriseScript}function Vk(){return pf.gapiScript}function zk(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Uk{constructor(){this.enterprise=new Bk}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Bk{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Fk="recaptcha-enterprise",V1="NO_RECAPTCHA";class qk{constructor(e){this.type=Fk,this.auth=Cl(e)}async verify(e="verify",n=!1){async function i(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,h)=>{bk(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const g=new vk(m);return l.tenantId==null?l._agentRecaptchaConfig=g:l._tenantRecaptchaConfigs[l.tenantId]=g,c(g.siteKey)}}).catch(m=>{h(m)})})}function a(l,c,h){const m=window.grecaptcha;rE(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(g=>{c(g)}).catch(()=>{c(V1)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Uk().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(h=>{if(!n&&rE(window.grecaptcha))a(h,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let m=Lk();m.length!==0&&(m+=h),L1(m).then(()=>{a(h,l,c)}).catch(g=>{c(g)})}}).catch(h=>{c(h)})})}}async function cE(t,e,n,i=!1,a=!1){const l=new qk(t);let c;if(a)c=V1;else try{c=await l.verify(n)}catch{c=await l.verify(n,!0)}const h={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const m=h.phoneEnrollmentInfo.phoneNumber,g=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:g,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const m=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return i?Object.assign(h,{captchaResp:c}):Object.assign(h,{captchaResponse:c}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function uE(t,e,n,i,a){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await cE(t,e,n,n==="getOobCode");return i(t,l)}else return i(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await cE(t,e,n,n==="getOobCode");return i(t,c)}else return Promise.reject(l)})}function Hk(t,e){const n=qg(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),l=n.getOptions();if($s(l,e??{}))return a;Br(a,"already-initialized")}return n.initialize({options:e})}function Gk(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(Fi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function $k(t,e,n){const i=Cl(t);Ne(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=z1(e),{host:c,port:h}=Qk(e),m=h===null?"":`:${h}`,g={url:`${l}//${c}${m}/`},_=Object.freeze({host:c,port:h,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Ne(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ne($s(g,i.config.emulator)&&$s(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,yl(c)?(Sw(`${l}//${c}${m}`),Tw("Auth",!0)):Wk()}function z1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Qk(t){const e=z1(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:dE(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:dE(c)}}}function dE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Wk(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class jy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Bi("not implemented")}_getIdTokenResponse(e){return Bi("not implemented")}_linkToIdToken(e,n){return Bi("not implemented")}_getReauthenticationResolver(e){return Bi("not implemented")}}async function Kk(t,e){return na(t,"POST","/v1/accounts:signUp",e)}async function Yk(t,e){return mf(t,"POST","/v1/accounts:signInWithPassword",$a(t,e))}async function Xk(t,e){return mf(t,"POST","/v1/accounts:signInWithEmailLink",$a(t,e))}async function Jk(t,e){return mf(t,"POST","/v1/accounts:signInWithEmailLink",$a(t,e))}class tu extends jy{constructor(e,n,i,a=null){super("password",i),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new tu(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new tu(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return uE(e,n,"signInWithPassword",Yk);case"emailLink":return Xk(e,{email:this._email,oobCode:this._password});default:Br(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return uE(e,i,"signUpPassword",Kk);case"emailLink":return Jk(e,{idToken:n,email:this._email,oobCode:this._password});default:Br(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Jo(t,e){return mf(t,"POST","/v1/accounts:signInWithIdp",$a(t,e))}const Zk="http://localhost";class Ua extends jy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ua(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Br("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=n;if(!i||!a)return null;const c=new Ua(i,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const n=this.buildRequest();return Jo(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,Jo(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Jo(e,n)}buildRequest(){const e={requestUri:Zk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=lu(n)}return e}}function eN(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function tN(t){const e=Mc(kc(t)).link,n=e?Mc(kc(e)).deep_link_id:null,i=Mc(kc(t)).deep_link_id;return(i?Mc(kc(i)).link:null)||i||n||e||t}class Oy{constructor(e){const n=Mc(kc(e)),i=n.apiKey??null,a=n.oobCode??null,l=eN(n.mode??null);Ne(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=tN(e);try{return new Oy(n)}catch{return null}}}class Rl{constructor(){this.providerId=Rl.PROVIDER_ID}static credential(e,n){return tu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Oy.parseLink(n);return Ne(i,"argument-error"),tu._fromEmailAndCode(e,i.code,i.tenantId)}}Rl.PROVIDER_ID="password";Rl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Rl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class U1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class vu extends U1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ks extends vu{constructor(){super("facebook.com")}static credential(e){return Ua._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ks.credential(e.oauthAccessToken)}catch{return null}}}ks.FACEBOOK_SIGN_IN_METHOD="facebook.com";ks.PROVIDER_ID="facebook.com";class Ns extends vu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ua._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ns.credentialFromTaggedObject(e)}static credentialFromError(e){return Ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return Ns.credential(n,i)}catch{return null}}}Ns.GOOGLE_SIGN_IN_METHOD="google.com";Ns.PROVIDER_ID="google.com";class Ps extends vu{constructor(){super("github.com")}static credential(e){return Ua._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ps.credential(e.oauthAccessToken)}catch{return null}}}Ps.GITHUB_SIGN_IN_METHOD="github.com";Ps.PROVIDER_ID="github.com";class Ls extends vu{constructor(){super("twitter.com")}static credential(e,n){return Ua._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Ls.credential(n,i)}catch{return null}}}Ls.TWITTER_SIGN_IN_METHOD="twitter.com";Ls.PROVIDER_ID="twitter.com";class ll{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,a=!1){const l=await Vr._fromIdTokenResponse(e,i,a),c=hE(i);return new ll({user:l,providerId:c,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const a=hE(i);return new ll({user:e,providerId:a,_tokenResponse:i,operationType:n})}}function hE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Vh extends Yi{constructor(e,n,i,a){super(n.code,n.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Vh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,a){return new Vh(e,n,i,a)}}function B1(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Vh._fromErrorAndOperation(t,l,e,i):l})}async function nN(t,e,n=!1){const i=await eu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ll._forOperation(t,"link",i)}async function rN(t,e,n=!1){const{auth:i}=t;if(Lr(i.app))return Promise.reject(Gs(i));const a="reauthenticate";try{const l=await eu(t,B1(i,a,e,t),n);Ne(l.idToken,i,"internal-error");const c=Dy(l.idToken);Ne(c,i,"internal-error");const{sub:h}=c;return Ne(t.uid===h,i,"user-mismatch"),ll._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Br(i,"user-mismatch"),l}}async function F1(t,e,n=!1){if(Lr(t.app))return Promise.reject(Gs(t));const i="signIn",a=await B1(t,i,e),l=await ll._fromIdTokenResponse(t,i,a);return n||await t._updateCurrentUser(l.user),l}async function iN(t,e){return F1(Cl(t),e)}async function sN(t){const e=Cl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function aN(t,e,n){return Lr(t.app)?Promise.reject(Gs(t)):iN(cn(t),Rl.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&sN(t),i})}function oN(t,e,n,i){return cn(t).onIdTokenChanged(e,n,i)}function lN(t,e,n){return cn(t).beforeAuthStateChanged(e,n)}function cN(t,e,n,i){return cn(t).onAuthStateChanged(e,n,i)}function uN(t){return cn(t).signOut()}const zh="__sak";class q1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(zh,"1"),this.storage.removeItem(zh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const dN=1e3,hN=10;class H1 extends q1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=N1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),a=this.localCache[n];i!==a&&e(n,a,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((c,h,m)=>{this.notifyListeners(c,m)});return}const i=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(i);!n&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);Ik()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,hN):a()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},dN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}H1.type="LOCAL";const fN=H1;class G1 extends q1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}G1.type="SESSION";const $1=G1;function mN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class gf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const i=new gf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:a,data:l}=n.data,c=this.handlersMap[a];if(!c?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const h=Array.from(c).map(async g=>g(n.origin,l)),m=await mN(h);n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:m})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}gf.receivers=[];function My(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class pN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((h,m)=>{const g=My("",20);a.port1.start();const _=setTimeout(()=>{m(new Error("unsupported_event"))},i);c={messageChannel:a,onMessage(v){const b=v;if(b.data.eventId===g)switch(b.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),h(b.data.response);break;default:clearTimeout(_),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:g,data:n},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function gi(){return window}function gN(t){gi().location.href=t}function Q1(){return typeof gi().WorkerGlobalScope<"u"&&typeof gi().importScripts=="function"}async function yN(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _N(){return navigator?.serviceWorker?.controller||null}function vN(){return Q1()?self:null}const W1="firebaseLocalStorageDb",bN=1,Uh="firebaseLocalStorage",K1="fbase_key";class bu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function yf(t,e){return t.transaction([Uh],e?"readwrite":"readonly").objectStore(Uh)}function xN(){const t=indexedDB.deleteDatabase(W1);return new bu(t).toPromise()}function wg(){const t=indexedDB.open(W1,bN);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Uh,{keyPath:K1})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Uh)?e(i):(i.close(),await xN(),e(await wg()))})})}async function fE(t,e,n){const i=yf(t,!0).put({[K1]:e,value:n});return new bu(i).toPromise()}async function EN(t,e){const n=yf(t,!1).get(e),i=await new bu(n).toPromise();return i===void 0?null:i.value}function mE(t,e){const n=yf(t,!0).delete(e);return new bu(n).toPromise()}const wN=800,SN=3;class Y1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await wg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>SN)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Q1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=gf._getInstance(vN()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await yN(),!this.activeServiceWorker)return;this.sender=new pN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_N()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wg();return await fE(e,zh,"1"),await mE(e,zh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>fE(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>EN(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>mE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=yf(a,!1).getAll();return new bu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Y1.type="LOCAL";const TN=Y1;new _u(3e4,6e4);function AN(t,e){return e?Fi(e):(Ne(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class ky extends jy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Jo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Jo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function CN(t){return F1(t.auth,new ky(t),t.bypassAuthState)}function RN(t){const{auth:e,user:n}=t;return Ne(n,e,"internal-error"),rN(n,new ky(t),t.bypassAuthState)}async function DN(t){const{auth:e,user:n}=t;return Ne(n,e,"internal-error"),nN(n,new ky(t),t.bypassAuthState)}class X1{constructor(e,n,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:a,tenantId:l,error:c,type:h}=e;if(c){this.reject(c);return}const m={auth:this.auth,requestUri:n,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(m))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CN;case"linkViaPopup":case"linkViaRedirect":return DN;case"reauthViaPopup":case"reauthViaRedirect":return RN;default:Br(this.auth,"internal-error")}}resolve(e){Ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const IN=new _u(2e3,1e4);class Qo extends X1{constructor(e,n,i,a,l){super(e,n,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Qo.currentPopupAction&&Qo.currentPopupAction.cancel(),Qo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ne(e,this.auth,"internal-error"),e}async onExecution(){Ki(this.filter.length===1,"Popup operations only handle one event");const e=My();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(pi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(pi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(pi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,IN.get())};e()}}Qo.currentPopupAction=null;const jN="pendingRedirect",ph=new Map;class ON extends X1{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=ph.get(this.auth._key());if(!e){try{const i=await MN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}ph.set(this.auth._key(),e)}return this.bypassAuthState||ph.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function MN(t,e){const n=PN(e),i=NN(t);if(!await i._isAvailable())return!1;const a=await i._get(n)==="true";return await i._remove(n),a}function kN(t,e){ph.set(t._key(),e)}function NN(t){return Fi(t._redirectPersistence)}function PN(t){return mh(jN,t.config.apiKey,t.name)}async function LN(t,e,n=!1){if(Lr(t.app))return Promise.reject(Gs(t));const i=Cl(t),a=AN(i,e),c=await new ON(i,a,n).execute();return c&&!n&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}const VN=600*1e3;class zN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!UN(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!J1(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(pi(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=VN&&this.cachedEventUids.clear(),this.cachedEventUids.has(pE(e))}saveEventToCache(e){this.cachedEventUids.add(pE(e)),this.lastProcessedEventTime=Date.now()}}function pE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function J1({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function UN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return J1(t);default:return!1}}async function BN(t,e={}){return na(t,"GET","/v1/projects",e)}const FN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qN=/^https?/;async function HN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await BN(t);for(const n of e)try{if(GN(n))return}catch{}Br(t,"unauthorized-domain")}function GN(t){const e=xg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&c.hostname===i}if(!qN.test(n))return!1;if(FN.test(t))return i===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const $N=new _u(3e4,6e4);function gE(){const t=gi().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function QN(t){return new Promise((e,n)=>{function i(){gE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{gE(),n(pi(t,"network-request-failed"))},timeout:$N.get()})}if(gi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(gi().gapi?.load)i();else{const a=zk("iframefcb");return gi()[a]=()=>{gapi.load?i():n(pi(t,"network-request-failed"))},L1(`${Vk()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw gh=null,e})}let gh=null;function WN(t){return gh=gh||QN(t),gh}const KN=new _u(5e3,15e3),YN="__/auth/iframe",XN="emulator/auth/iframe",JN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ZN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function e6(t){const e=t.config;Ne(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ry(e,XN):`https://${t.config.authDomain}/${YN}`,i={apiKey:e.apiKey,appName:t.name,v:_l},a=ZN.get(t.config.apiHost);a&&(i.eid=a);const l=t._getFrameworks();return l.length&&(i.fw=l.join(",")),`${n}?${lu(i).slice(1)}`}async function t6(t){const e=await WN(t),n=gi().gapi;return Ne(n,t,"internal-error"),e.open({where:document.body,url:e6(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JN,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const c=pi(t,"network-request-failed"),h=gi().setTimeout(()=>{l(c)},KN.get());function m(){gi().clearTimeout(h),a(i)}i.ping(m).then(m,()=>{l(c)})}))}const n6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},r6=500,i6=600,s6="_blank",a6="http://localhost";class yE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function o6(t,e,n,i=r6,a=i6){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const m={...n6,width:i.toString(),height:a.toString(),top:l,left:c},g=An().toLowerCase();n&&(h=I1(g)?s6:n),R1(g)&&(e=e||a6,m.scrollbars="yes");const _=Object.entries(m).reduce((b,[w,A])=>`${b}${w}=${A},`,"");if(Dk(g)&&h!=="_self")return l6(e||"",h),new yE(null);const v=window.open(e||"",h,_);Ne(v,t,"popup-blocked");try{v.focus()}catch{}return new yE(v)}function l6(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const c6="__/auth/handler",u6="emulator/auth/handler",d6=encodeURIComponent("fac");async function _E(t,e,n,i,a,l){Ne(t.config.authDomain,t,"auth-domain-config-required"),Ne(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:_l,eventId:a};if(e instanceof U1){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",bI(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))c[_]=v}if(e instanceof vu){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(c.scopes=_.join(","))}t.tenantId&&(c.tid=t.tenantId);const h=c;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const m=await t._getAppCheckToken(),g=m?`#${d6}=${encodeURIComponent(m)}`:"";return`${h6(t)}?${lu(h).slice(1)}${g}`}function h6({config:t}){return t.emulator?Ry(t,u6):`https://${t.authDomain}/${c6}`}const Pp="webStorageSupport";class f6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$1,this._completeRedirectFn=LN,this._overrideRedirectResult=kN}async _openPopup(e,n,i,a){Ki(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await _E(e,n,i,xg(),a);return o6(e,l,My())}async _openRedirect(e,n,i,a){await this._originValidation(e);const l=await _E(e,n,i,xg(),a);return gN(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:l}=this.eventManagers[n];return a?Promise.resolve(a):(Ki(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await t6(e),i=new zN(e);return n.register("authEvent",a=>(Ne(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Pp,{type:Pp},a=>{const l=a?.[0]?.[Pp];l!==void 0&&n(!!l),Br(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=HN(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return N1()||D1()||Iy()}}const m6=f6;var vE="@firebase/auth",bE="1.12.0";class p6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function g6(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function y6(t){el(new La("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:h}=i.options;Ne(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const m={apiKey:c,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:P1(t)},g=new Nk(i,a,l,m);return Gk(g,n),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),el(new La("auth-internal",e=>{const n=Cl(e.getProvider("auth").getImmediate());return(i=>new p6(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fs(vE,bE,g6(t)),Fs(vE,bE,"esm2020")}const _6=300,v6=ww("authIdTokenMaxAge")||_6;let xE=null;const b6=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>v6)return;const a=n?.token;xE!==a&&(xE=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function x6(t=Dw()){const e=qg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Hk(t,{popupRedirectResolver:m6,persistence:[TN,fN,$1]}),i=ww("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=b6(l.toString());lN(n,c,()=>c(n.currentUser)),oN(n,h=>c(h))}}const a=xw("auth");return a&&$k(n,`http://${a}`),n}function E6(){return document.getElementsByTagName("head")?.[0]??document}Pk({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=a=>{const l=pi("internal-error");l.customData=a,n(l)},i.type="text/javascript",i.charset="UTF-8",E6().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});y6("Browser");function Qa(){const t=x6(Ow);async function e(){return!1}async function n(h,m){return aN(t,h,m)}function i(){return uN(t)}function a(h){cN(t,m=>{h(m)})}function l(){return t.currentUser}return{set_user_listener:a,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:i,get_current_firebase_user:l}}const w6={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,lastActiveTab:"balances",lastSettingsTab:"categories",lastAdminTab:"budget",lastBalancesView:"categories",setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},setLastActiveTab:()=>{},setLastSettingsTab:()=>{},setLastAdminTab:()=>{},setLastBalancesView:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},Z1=C.createContext(w6);function S6({children:t}){const n=Qa().get_current_firebase_user(),[i,a]=C.useState(null),[l,c]=C.useState(new Date().getFullYear()),[h,m]=C.useState(new Date().getMonth()+1),[g,_]=C.useState("balances"),[v,b]=C.useState("categories"),[w,A]=C.useState("budget"),[S,M]=C.useState("categories"),[F,H]=C.useState(!1),[z,ee]=C.useState(!1),J=ek(n?.uid||null,n?.email||null),me=J.data&&J.data.budget_ids.length===0,P=nk(n?.uid||null,J.data||null,{enabled:!!n?.uid&&!!J.data&&me}),D=J.data?.permission_flags?.is_admin===!0,I=J.data?.permission_flags?.is_test===!0,N=P.data?.pendingInvites||[],O=P.data?.budgets||[],k=N.length>0;C.useEffect(()=>{if(!n||F||J.isLoading)return;const ne=J.data;if(!(!ne&&!J.isError))if(ne&&ne.budget_ids.length>0)a(ne.budget_ids[0]),ee(!1),H(!0);else{if(P.isLoading)return;const B=P.data;B?.pendingInvites&&B.pendingInvites.length>0?ee(!1):ee(!0),H(!0)}},[n,F,J.data,J.isLoading,J.isError,P.data,P.isLoading]);const R=C.useCallback(()=>{h===1?(c(ne=>ne-1),m(12)):m(ne=>ne-1)},[h]),ae=C.useCallback(()=>{h===12?(c(ne=>ne+1),m(1)):m(ne=>ne+1)},[h]),q=C.useCallback(async()=>{await P.refetch()},[P]),V=C.useCallback(ne=>{a(ne)},[]),Q=C.useCallback(async ne=>{if(!n)return null;try{const B=await ak(ne,n.uid);return B&&B.isInvited&&!B.hasAccepted?{budgetId:ne,budgetName:B.budgetName,ownerEmail:B.ownerEmail}:null}catch(B){return console.error("[BudgetContext] Error checking budget invite:",B),null}},[n]),W=C.useCallback(()=>{localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),de={currentUserId:n?.uid||null,selectedBudgetId:i,currentYear:l,currentMonthNumber:h,lastActiveTab:g,lastSettingsTab:v,lastAdminTab:w,lastBalancesView:S,setSelectedBudgetId:a,setCurrentYear:c,setCurrentMonthNumber:m,setLastActiveTab:_,setLastSettingsTab:b,setLastAdminTab:A,setLastBalancesView:M,isInitialized:F,needsFirstBudget:z,goToPreviousMonth:R,goToNextMonth:ae,pendingInvites:N,hasPendingInvites:k,accessibleBudgets:O,isAdmin:D,isTest:I,loadAccessibleBudgets:q,switchToBudget:V,checkBudgetInvite:Q,clearCache:W};return d.jsx(Z1.Provider,{value:de,children:t})}function un(){const t=C.useContext(Z1);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}const Pr={mobile:640,tablet:768,wide:1200},T6=Pr.mobile,Zo=["January","February","March","April","May","June","July","August","September","October","November","December"],ce={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15",debt:"#fb923c",debtBg:"rgba(251, 146, 60, 0.1)",debtBorder:"rgba(251, 146, 60, 0.5)"},yi={maxWidth:"var(--page-max-width, 85rem)",margin:"0 auto",padding:"var(--page-padding, 2rem)"},xu={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},A6={...xu,padding:"0.6rem 0.875rem",gap:"0.5rem"},C6={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},R6={display:"flex",flexDirection:"column",gap:"0.5rem"},D6={fontSize:"0.9rem",fontWeight:500},Wa={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",width:"100%",boxSizing:"border-box"},I6={...Wa,cursor:"pointer"},Ny={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},eT={...Ny,background:ce.primary,color:"white",border:"none"},j6={...eT,padding:"0.75rem 1.5rem",borderRadius:"8px"},O6={...Ny,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},M6={...Ny,background:"transparent",border:`1px solid ${ce.errorBorder}`,color:ce.error},k6={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},N6={display:"flex",gap:"0.5rem"},P6={display:"flex",gap:"0.25rem"},tT={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},L6={...tT,borderColor:ce.errorBorder,color:ce.error},cl={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},Py={display:"flex",flexDirection:"column",gap:"2px"},V6={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},nT={opacity:.4,cursor:"grab"},rT={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",transition:"opacity 0.15s"},z6={position:"relative",height:"2rem",marginTop:"-0.25rem"},U6={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",transition:"opacity 0.15s"},B6={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},F6={background:ce.errorBg,border:`1px solid ${ce.errorBorder}`,color:ce.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},q6={background:"transparent",border:"none",color:ce.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},iT={opacity:.7,marginBottom:"1.5rem"},Dl={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},Ly={fontWeight:500,fontSize:"1.1rem"},ul={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function H6(){return d.jsxs("div",{style:yi,children:[d.jsx("nav",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:d.jsx(Tt,{to:"/",style:{display:"flex",alignItems:"center"},title:"Tarron Lane Home",children:d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane Home",style:{width:"2rem",height:"2rem"}})})}),d.jsx("h1",{children:"Tarron Lane Homepage"}),d.jsx("nav",{children:d.jsxs("ul",{children:[d.jsx("li",{children:d.jsx(Tt,{to:"/sql-test",children:"SQL Test"})}),d.jsx("li",{children:d.jsx(Tt,{to:"/budget",children:"Budget"})}),d.jsx("li",{children:d.jsx(Tt,{to:"/account",children:"Account"})})]})})]})}function Gc({children:t}){return d.jsx("div",{style:yi,children:t})}function Ka({message:t,children:e,onDismiss:n,style:i}){return d.jsxs("div",{style:{...F6,...i},children:[d.jsx("span",{children:e??t}),n&&d.jsx("button",{onClick:n,style:q6,children:""})]})}const G6={primary:eT,"primary-large":j6,secondary:O6,danger:M6,small:k6};function Me({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:i,disabled:a,style:l,actionName:c,onClick:h,...m}){const g=G6[t],_=a||e;function v(b){h?.(b)}return d.jsx("button",{disabled:_,style:{...g,cursor:_?"not-allowed":"pointer",opacity:_?.7:1,...l},onClick:v,...m,children:e?n:i})}function Sg(t,e){const n=t.toLowerCase(),i=e.toLowerCase();if(i.includes(n)){const h=i.indexOf(n);return{match:!0,score:h===0||/\s/.test(i[h-1])?100:90}}let a=0,l=0,c=0;for(let h=0;h<i.length&&a<n.length;h++)i[h]===n[a]?(a++,c++,l+=c*2):c=0;return a===n.length?{match:!0,score:l}:{match:!1,score:0}}function EE({id:t,value:e,onChange:n,payees:i,placeholder:a="Enter payee name"}){const[l,c]=C.useState(!1),[h,m]=C.useState(-1),g=C.useRef(null),_=C.useRef(null),v=e.trim()?i.map(A=>({payee:A,...Sg(e,A)})).filter(A=>A.match).sort((A,S)=>S.score-A.score).slice(0,8).map(A=>A.payee):[];C.useEffect(()=>{function A(S){g.current&&!g.current.contains(S.target)&&c(!1)}return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]);function b(A){!l||v.length===0||(A.key==="ArrowDown"?(A.preventDefault(),m(S=>Math.min(S+1,v.length-1))):A.key==="ArrowUp"?(A.preventDefault(),m(S=>Math.max(S-1,-1))):A.key==="Enter"&&h>=0?(A.preventDefault(),n(v[h]),c(!1),m(-1)):A.key==="Escape"&&(c(!1),m(-1)))}function w(A){n(A),c(!1),m(-1),_.current?.focus()}return d.jsxs("div",{ref:g,style:{position:"relative"},children:[d.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:A=>{n(A.target.value),c(!0),m(-1)},onFocus:()=>c(!0),onKeyDown:b,placeholder:a,autoComplete:"off",style:Wa}),l&&v.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:v.map((A,S)=>d.jsx("div",{onClick:()=>w(A),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:S===h?`color-mix(in srgb, ${ce.primary} 20%, transparent)`:"transparent",borderBottom:S<v.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>m(S),children:A},A))})]})}function $6({id:t,value:e,onChange:n,categories:i,categoryGroups:a,placeholder:l="Search categories...",required:c}){const h=Object.fromEntries(a.map(k=>[k.id,k.name])),m=Object.entries(i).map(([k,R])=>({id:k,name:R.name,groupId:R.category_group_id,groupName:R.category_group_id&&h[R.category_group_id]||null,sortOrder:R.sort_order})),_=(e?i[e]:null)?.name||"",[v,b]=C.useState(_),[w,A]=C.useState(!1),[S,M]=C.useState(-1),F=C.useRef(null),H=C.useRef(null);C.useEffect(()=>{const k=e?i[e]:null;b(k?.name||"")},[e,i]);const z=v.trim()?m.map(k=>({...k,...Sg(v,k.name),groupMatch:k.groupName?Sg(v,k.groupName):{match:!1,score:0}})).filter(k=>k.match||k.groupMatch.match).sort((k,R)=>{const ae=Math.max(k.score,k.groupMatch.score*.5),q=Math.max(R.score,R.groupMatch.score*.5);if(q!==ae)return q-ae;if(k.groupId!==R.groupId){if(!k.groupId)return 1;if(!R.groupId)return-1;const V=(k.groupName||"").localeCompare(R.groupName||"");return V!==0?V:k.groupId.localeCompare(R.groupId)}return k.sortOrder-R.sortOrder}).slice(0,10):[...m].sort((k,R)=>{if(k.groupId!==R.groupId){if(!k.groupId)return 1;if(!R.groupId)return-1;const ae=(k.groupName||"").localeCompare(R.groupName||"");return ae!==0?ae:k.groupId.localeCompare(R.groupId)}return k.sortOrder-R.sortOrder}).slice(0,10);C.useEffect(()=>{function k(R){if(F.current&&!F.current.contains(R.target)){A(!1);const ae=e?i[e]:null;b(ae?.name||"")}}return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[e,i]);function ee(k){if(k.key==="ArrowDown")k.preventDefault(),w?M(R=>Math.min(R+1,z.length-1)):(A(!0),M(0));else if(k.key==="ArrowUp")k.preventDefault(),M(R=>Math.max(R-1,0));else if(k.key==="Enter")k.preventDefault(),w&&S>=0&&z[S]&&J(z[S]);else if(k.key==="Escape"){A(!1),M(-1);const R=e?i[e]:null;b(R?.name||"")}else if(k.key==="Tab"&&w&&z.length>0){const R=S>=0?S:0;J(z[R])}}function J(k){n(k.id),b(k.name),A(!1),M(-1),H.current?.focus()}function me(k){const R=k.target.value;b(R),A(!0),M(-1),R!==_&&n("")}function P(){A(!0),z.length>0&&M(0)}const D=[];let I="__initial__";z.forEach(k=>{k.groupId!==I&&(I=k.groupId,D.push({groupId:k.groupId,groupName:k.groupName,items:[]})),D[D.length-1].items.push(k)});let N=-1;const O=()=>++N;return d.jsxs("div",{ref:F,style:{position:"relative"},children:[d.jsx("input",{ref:H,id:t,type:"text",value:v,onChange:me,onFocus:P,onKeyDown:ee,placeholder:l,autoComplete:"off",required:c,style:{...Wa,borderColor:c&&!e?ce.error:void 0}}),w&&z.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"250px",overflowY:"auto"},children:D.map((k,R)=>d.jsxs("div",{children:[k.groupName&&d.jsx("div",{style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6,background:"color-mix(in srgb, currentColor 5%, transparent)",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:k.groupName}),k.items.map(ae=>{const q=O();return d.jsx("div",{onClick:()=>J(ae),style:{padding:"0.6rem 0.8rem",paddingLeft:k.groupName?"1.2rem":"0.8rem",cursor:"pointer",background:q===S?`color-mix(in srgb, ${ce.primary} 20%, transparent)`:"transparent",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",transition:"background 0.1s"},onMouseEnter:()=>M(q),children:ae.name},ae.id)})]},`group-${R}`))}),w&&z.length===0&&v.trim()&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,padding:"0.6rem 0.8rem",opacity:.6,fontStyle:"italic"},children:"No matching categories"})]})}function Ba({children:t,onSubmit:e,actionName:n}){function i(a){e(a)}return d.jsx("form",{onSubmit:i,style:C6,children:t})}function Kt({label:t,htmlFor:e,children:n,hint:i,style:a}){return d.jsxs("div",{style:{...R6,...a},children:[d.jsx("label",{htmlFor:e,style:D6,children:t}),n,i&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:i})]})}function Fa(t){return d.jsx("input",{style:Wa,...t})}function Q6(t){if(!t)return"";try{return new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return t}}function wE({value:t,onChange:e,style:n,...i}){const a=C.useRef(null),l=Q6(t);function c(){a.current?.showPicker?.()}return d.jsxs("div",{style:{position:"relative"},children:[d.jsx("input",{ref:a,type:"date",value:t||"",onChange:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,pointerEvents:"none"},...i}),d.jsx("div",{onClick:c,style:{...Wa,cursor:"pointer",display:"flex",alignItems:"center",fontSize:"0.85rem",fontFamily:"monospace",color:t?"inherit":"color-mix(in srgb, currentColor 50%, transparent)",...n},children:l||"Select date"})]})}function nu({children:t,...e}){return d.jsx("select",{style:I6,...e,children:t})}function Vy({minHeight:t="6rem",style:e,...n}){return d.jsx("textarea",{style:{...Wa,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function Ya({children:t}){return d.jsx("div",{style:V6,children:t})}function Lp(t){const n=t.replace(/[^\d.]/g,"").split("."),i=n[0]||"",a=n[1],l=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return a!==void 0?`$${l}.${a.slice(0,2)}`:l?`$${l}`:""}function W6(t){return t.replace(/[$,]/g,"")}function Tg({id:t,value:e,onChange:n,placeholder:i="$0.00",required:a,autoFocus:l}){const[c,h]=C.useState(()=>Lp(e)),m=C.useRef(null);C.useEffect(()=>{const _=Lp(e);W6(c)!==e&&h(_)},[e]);function g(_){const v=_.target.value;if(!v||v==="$"){h(""),n("");return}const w=v.replace(/[^\d.]/g,"").split(".");let A=w[0];w.length>1&&(A+="."+w.slice(1).join("").slice(0,2));const S=Lp(A);h(S),n(A)}return d.jsx("input",{ref:m,id:t,type:"text",inputMode:"decimal",value:c,onChange:g,placeholder:i,required:a,autoFocus:l,style:Wa})}function Xa(t=T6){const[e,n]=C.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return C.useEffect(()=>{function i(){n(window.innerWidth<t)}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[t]),e}function _f({children:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:h,onEdit:m,onDelete:g,onMoveUp:_,onMoveDown:v,canMoveUp:b=!0,canMoveDown:w=!0,itemName:A}){const S=Xa(),M=_||v;return d.jsxs("div",{onDragOver:F=>{F.stopPropagation(),a(F)},onDragLeave:F=>{F.stopPropagation(),l()},onDrop:F=>{F.stopPropagation(),h(F)},style:{position:"relative"},children:[d.jsx("div",{style:{...rT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{style:{...S?A6:xu,opacity:e?.5:1},children:[d.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:S?"0.5rem":"0.75rem",minWidth:0},children:[d.jsx("span",{draggable:!0,onDragStart:F=>{i(F)},onDragEnd:()=>{c()},style:{...nT,fontSize:S?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),d.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),d.jsxs("div",{style:S?P6:N6,children:[S?d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>{m()},style:tT,title:"Edit","aria-label":"Edit",children:""}),d.jsx("button",{onClick:()=>{g()},style:L6,title:"Delete","aria-label":"Delete",children:""})]}):d.jsxs(d.Fragment,{children:[d.jsx(Me,{variant:"secondary",actionName:`Edit ${A||"Item"}`,onClick:m,children:"Edit"}),d.jsx(Me,{variant:"danger",actionName:`Delete ${A||"Item"}`,onClick:g,children:"Delete"})]}),M&&d.jsxs("div",{style:Py,children:[d.jsx("button",{onClick:F=>{F.stopPropagation(),_?.()},disabled:!b,style:{...cl,opacity:b?.6:.2,cursor:b?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:F=>{F.stopPropagation(),v?.()},disabled:!w,style:{...cl,opacity:w?.6:.2,cursor:w?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function zy({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i,label:a="Move to end"}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:z6,children:[d.jsx("div",{style:{...U6,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:B6,children:a})]})}function Ce(t){return`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function bn(t){return t>=0?ce.success:ce.danger}function qa(t){return t>=0?ce.success:ce.debt}function sT(){const t=rn();return{submitFeedback:ir({mutationFn:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:c})=>{const h=i||n,m={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`${a}

(Submitted from: ${c})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l},{exists:g}=await Le("feedback",h,"checking if user has existing feedback document");return g?await gt("feedback",h,{items:sM(m),user_email:i,updated_at:new Date().toISOString()},"adding new feedback item to existing document",{merge:!0}):await gt("feedback",h,{items:[m],user_email:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},"creating new feedback document for user"),{feedbackItem:m,docId:h}},onMutate:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:c})=>{await t.cancelQueries({queryKey:Ee.feedback()});const h=t.getQueryData(Ee.feedback()),m=i||n,g={id:`feedback_optimistic_${Date.now()}`,text:`${a}

(Submitted from: ${c})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l,doc_id:m,user_email:i};return t.setQueryData(Ee.feedback(),_=>_?{items:[..._.items,g]}:{items:[g]}),{previousData:h,optimisticItemId:g.id}},onSuccess:(n,i,a)=>{t.setQueryData(Ee.feedback(),l=>l&&{items:l.items.map(c=>c.id===a?.optimisticItemId?{...n.feedbackItem,doc_id:n.docId,user_email:i.userEmail}:c)})},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(Ee.feedback(),a.previousData)}})}}function K6(){const t=rn();return{toggleFeedback:ir({mutationFn:async({item:n})=>{const{exists:i,data:a}=await Le("feedback",n.doc_id,"PRE-EDIT-READ");if(!i||!a)throw new Error(`Feedback document not found: ${n.doc_id}`);const l=!n.is_done,c=l?new Date().toISOString():null,h=a.items||[];let m=!1;const g=h.map(_=>_.id===n.id?(m=!0,{..._,is_done:l,completed_at:c}):_);if(!m)throw console.error("[toggleFeedback] Item not found in document",{searchingFor:n.id,inDocument:n.doc_id,availableIds:h.map(_=>_.id)}),new Error(`Feedback item not found in document. Item ID: ${n.id}, Doc ID: ${n.doc_id}`);return await gt("feedback",n.doc_id,{...a,items:g,updated_at:new Date().toISOString()},`marking feedback item as ${l?"done":"not done"}`),{itemId:n.id,isDone:l,completedAt:c}},onMutate:async({item:n})=>{await t.cancelQueries({queryKey:Ee.feedback()});const i=t.getQueryData(Ee.feedback()),a=!n.is_done,l=a?new Date().toISOString():null;return t.setQueryData(Ee.feedback(),c=>c&&{items:c.items.map(h=>h.id===n.id?{...h,is_done:a,completed_at:l}:h)}),{previousData:i}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(Ee.feedback(),a.previousData)}})}}function Y6(){const t=rn();return{updateSortOrder:ir({mutationFn:async({docId:n,items:i})=>{const{exists:a,data:l}=await Le("feedback",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Feedback document not found");return await gt("feedback",n,{...l,items:i,updated_at:new Date().toISOString()},"saving reordered feedback items"),{docId:n,items:i}},onMutate:async({docId:n,items:i})=>{await t.cancelQueries({queryKey:Ee.feedback()});const a=t.getQueryData(Ee.feedback());return t.setQueryData(Ee.feedback(),l=>{if(!l)return l;const c=new Map;return i.forEach(h=>{c.set(h.id,h.sort_order)}),{items:l.items.map(h=>h.doc_id===n&&c.has(h.id)?{...h,sort_order:c.get(h.id)}:h)}}),{previousData:a}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(Ee.feedback(),a.previousData)}})}}function dl({isOpen:t,onClose:e,title:n,children:i,width:a="28rem"}){if(!t)return null;function l(){e()}return d.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:l,children:d.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:a,maxWidth:"calc(100vw - 2rem)",flexShrink:0,boxSizing:"border-box",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:c=>c.stopPropagation(),children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[d.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),i]})})}const X6=2e3,J6={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function Z6(){const[t,e]=C.useState(!1),[n,i]=C.useState(""),[a,l]=C.useState("bug"),[c,h]=C.useState(!1),m=C.useContext(au),_=Qa().get_current_firebase_user(),v=jn(),{submitFeedback:b}=sT();if(C.useEffect(()=>{if(c){const S=setTimeout(()=>h(!1),X6);return()=>clearTimeout(S)}},[c]),v.pathname.includes("/admin/feedback")||!m.is_logged_in)return null;function A(S){S.preventDefault(),!(!n.trim()||!m.username||!_)&&(b.mutate({userId:_.uid,userEmail:m.username,text:n.trim(),feedbackType:a,currentPath:v.pathname}),i(""),l("bug"),e(!1),h(!0))}return d.jsxs(d.Fragment,{children:[c&&d.jsxs("div",{style:{position:"fixed",bottom:"5rem",right:"1.5rem",background:"rgba(46, 213, 115, 0.95)",color:"white",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1001,display:"flex",alignItems:"center",gap:"0.5rem",animation:"fadeInUp 0.2s ease-out"},children:[d.jsx("span",{children:""}),d.jsx("span",{children:"Feedback submitted!"})]}),d.jsx("button",{onClick:()=>{e(!0)},style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:ce.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:S=>{S.currentTarget.style.transform="scale(1.1)",S.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:S=>{S.currentTarget.style.transform="scale(1)",S.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),d.jsx(dl,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:d.jsxs("form",{onSubmit:A,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(S=>{const M=J6[S],F=a===S;return d.jsxs("button",{type:"button",onClick:()=>{M.label,l(S)},style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${M.color}`,borderRadius:"0.5rem",background:F?M.bgColor:"transparent",color:F?M.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:F?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:F?1:.5,boxShadow:F?`0 0 12px ${M.bgColor}`:"none",position:"relative"},children:[M.label,F&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},S)})}),d.jsx(Vy,{value:n,onChange:S=>i(S.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),d.jsxs(Ya,{children:[d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Feedback",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),d.jsx(Me,{type:"submit",actionName:"Submit Feedback",disabled:!n.trim(),children:"Submit"})]})]})})]})}function Ms({children:t,labelStyle:e,...n}){return d.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[d.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:ce.primary},...n}),t]})}function e4({title:t,count:e,children:n,defaultExpanded:i=!1}){const[a,l]=C.useState(i);return d.jsxs("div",{style:{marginTop:"2rem"},children:[d.jsxs("button",{onClick:()=>l(!a),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[d.jsx("span",{style:{transition:"transform 0.2s",transform:a?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),a&&n]})}const t4=t=>{switch(t){case 2:return 220;case 3:return 320;case 4:return 420;case 5:return 520;case 6:return 620;default:return t*100+20}},n4=t=>t<=4?2:t<=6?3:Math.ceil(t/2);function Uy(t){const{tabs:e,activeTab:n}=t,i=e.filter(v=>!v.hidden),a=i.length,l=t4(a),c=n4(a),h=Math.floor(100/c),m=`tab-nav-${a}`,g=v=>({flex:"1 1 0",padding:"0.6rem 0.5rem",border:"none",borderRadius:0,background:"transparent",cursor:"pointer",fontWeight:v?600:400,fontSize:"0.9rem",color:"inherit",opacity:v?1:.5,transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem",position:"relative",boxSizing:"border-box",outline:"none"}),_=(v,b)=>d.jsxs(d.Fragment,{children:[d.jsx("span",{children:v.label}),v.checkmark&&d.jsx("span",{style:{color:ce.success,fontWeight:600},children:""}),b&&d.jsx("span",{style:{position:"absolute",bottom:"-1px",left:"15%",right:"15%",height:"3px",background:"white",borderRadius:"2px"}})]});return d.jsxs(d.Fragment,{children:[d.jsx("style",{children:`
        .${m} {
          display: flex;
          flex-wrap: wrap;
          margin-bottom: 1.5rem;
          border-bottom: 1px solid color-mix(in srgb, currentColor 15%, transparent);
        }
        .${m} > button,
        .${m} > a {
          border: none !important;
          border-radius: 0 !important;
          outline: none !important;
        }
        .${m} > button:hover,
        .${m} > button:focus,
        .${m} > a:hover,
        .${m} > a:focus {
          border: none !important;
          border-color: transparent !important;
        }
        @media (max-width: ${l}px) {
          .${m} > * {
            flex: 1 1 ${h}% !important;
            min-width: ${h}% !important;
          }
        }
      `}),d.jsx("div",{className:m,children:i.map(v=>{const b=n===v.id;return t.mode==="link"?d.jsx(Tt,{to:`${t.linkPrefix}/${v.id}`,onClick:()=>(`${v.label}`,void 0),style:g(b),children:_(v,b)},v.id):d.jsx("button",{onClick:()=>{`${v.label}`,t.onTabChange(v.id)},style:g(b),children:_(v,b)},v.id)})})]})}function By({items:t}){const[e,n]=C.useState(!1),i=C.useRef(null),l=jn().pathname;C.useEffect(()=>{function h(m){i.current&&!i.current.contains(m.target)&&n(!1)}if(e)return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[e]),C.useEffect(()=>{function h(m){m.key==="Escape"&&n(!1)}if(e)return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[e]);const c=t.filter(h=>h.hidden?!1:h.to?h.to==="/budget"?!(l==="/budget"||/^\/budget\/\d{4}\/\d{1,2}\/\w+$/.test(l)):h.to==="/account"||h.to==="/"?l!==h.to:!l.startsWith(h.to):!0);return d.jsxs("div",{ref:i,style:{position:"relative"},children:[d.jsx("button",{onClick:()=>{n(!e)},style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:e?"color-mix(in srgb, currentColor 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:"none",cursor:"pointer",fontSize:"1.25rem",color:"inherit",transition:"background 0.15s",lineHeight:1},title:"Menu","aria-expanded":e,"aria-haspopup":"true",children:""}),e&&d.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",minWidth:"180px",background:"#1a1a2e",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",zIndex:1e3,overflow:"hidden"},children:c.map((h,m)=>{if(h.divider)return d.jsx("div",{style:{height:"1px",background:"color-mix(in srgb, currentColor 15%, transparent)",margin:"0.25rem 0"}},m);const g=d.jsxs(d.Fragment,{children:[h.icon&&d.jsx("span",{style:{width:"1.5rem",textAlign:"center"},children:h.icon}),d.jsx("span",{children:h.label})]}),_={display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",fontSize:"0.95rem",color:"inherit",textDecoration:"none",cursor:"pointer",transition:"background 0.15s",background:"transparent",border:"none",width:"100%",textAlign:"left"},v={background:"color-mix(in srgb, currentColor 10%, transparent)"};return h.to?d.jsx(Tt,{to:h.to,style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",onClick:()=>{`${h.label}`,n(!1)},children:g},m):d.jsx("button",{onClick:()=>{`${h.label}`,h.onClick?.(),n(!1)},style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",children:g},m)})})]})}function _i({title:t,showBackArrow:e=!1,hideMenu:n=!1}){const{isAdmin:i}=un(),a=[{label:"Budget",icon:"",to:"/budget"},{label:"Budget Settings",icon:"",to:"/budget/settings"},{label:"Analytics",icon:"",to:"/budget/analytics"},...i?[{label:"Admin",icon:"",to:"/budget/admin"}]:[],{label:"Switch Budgets",icon:"",to:"/budget/my-budgets"},{divider:!0,label:""},{label:"Exit Budget App",icon:"",to:"/"}];return d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{children:e?d.jsx(Tt,{to:"/",onClick:()=>void 0,style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none"},title:"Back to Home",children:""}):d.jsx(Tt,{to:"/budget",onClick:()=>void 0,title:"Budget Home",children:d.jsx("img",{src:"/budget-icon.svg",alt:"Budget",style:{width:"1.5rem",height:"1.5rem"}})})}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem",textAlign:"center"},children:t}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:!n&&d.jsx(By,{items:a})})]})}function aT({children:t,style:e}){return d.jsx("div",{style:{width:"100%",maxWidth:"var(--content-max-width, 900px)",marginLeft:"auto",marginRight:"auto",...e},children:t})}function Ag(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function r4(){return d.jsxs("div",{style:yi,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(Tt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(Tt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"SQL Test"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(By,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"SQL Test"}),d.jsx("h2",{children:"Setup"}),d.jsxs("h3",{children:["1. Open up your preferred web browser to ",d.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),d.jsxs("ul",{children:[d.jsx("li",{children:"This is a basic online sql query editor"}),d.jsxs("li",{children:["It will include three tables: ",d.jsx("b",{children:'"Customer"'}),", ",d.jsx("b",{children:'"Orders"'}),", and ",d.jsx("b",{children:'"Shippings"'})]})]}),d.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),d.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:d.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),d.jsx("h2",{children:"SQL Problems"}),d.jsx("p",{children:"Write queries in the online editor to answer these questions."}),d.jsx("h3",{children:"Question #1"}),d.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),d.jsx("h3",{children:"Question #2"}),d.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function i4(){const t=C.useContext(au),e=Qa(),[n,i]=C.useState(!1),a=jn(),l=iu(),c=a.state?.from||"/";C.useEffect(()=>{t.is_logged_in&&c!=="/"&&l(c,{replace:!0})},[t.is_logged_in,c,l]);function h(){i(!0),e.logout_firebase_user().then(function(){i(!1)})}return d.jsxs("div",{style:yi,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(Tt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(Tt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"Account"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(By,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"Account"}),t.is_logged_in?n?d.jsx("p",{children:"Logging Out..."}):d.jsxs(d.Fragment,{children:[d.jsxs("p",{children:["You are logged in as ",t.username]}),d.jsx("button",{onClick:h,style:{marginTop:"1rem"},children:"Logout"})]}):d.jsx(s4,{})]})}function s4(){const t=Qa(),[e,n]=C.useState(""),[i,a]=C.useState(""),[l,c]=C.useState(!1),[h,m]=C.useState("");function g(b){n(b.target.value)}function _(b){a(b.target.value)}function v(b){b.preventDefault(),c(!0),m(""),t.login_firebase_user(e,i).then(function(){}).catch(function(){m("Incorrect login credentials")}).finally(function(){c(!1)})}return d.jsxs("form",{onSubmit:v,children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"username",children:"Email: "}),d.jsx("input",{id:"username",type:"email",value:e,onChange:g})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",children:"Password: "}),d.jsx("input",{id:"password",type:"password",value:i,onChange:_})]}),l?d.jsx("p",{children:"Logging in..."}):d.jsx("button",{children:"Login"}),h&&d.jsx("p",{style:{color:"red"},children:h})]})}function a4(){const[t,e]=C.useState(()=>typeof window>"u"?1200:window.innerWidth);return C.useEffect(()=>{function n(){e(window.innerWidth)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),{width:t,isWide:t>=Pr.wide,isMedium:t>=Pr.tablet&&t<Pr.wide,isNarrowMedium:t>=Pr.mobile&&t<Pr.tablet,isMobile:t<Pr.mobile}}function o4(){const t=rn();return{updateAccounts:ir({mutationFn:async({budgetId:n,accounts:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await gt("budgets",n,{...l,accounts:i},"saving updated accounts (user edited account settings)"),i},onMutate:async({budgetId:n,accounts:i})=>{await t.cancelQueries({queryKey:Ee.budget(n)});const a=t.getQueryData(Ee.budget(n));return a&&t.setQueryData(Ee.budget(n),{...a,accounts:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(Ee.budget(i));a&&t.setQueryData(Ee.budget(i),{...a,accounts:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(Ee.budget(i),a.previousData)}})}}function l4(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order},i.expected_balance!==void 0&&(e[n].expected_balance=i.expected_balance),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function c4(){const t=rn();return{updateAccountGroups:ir({mutationFn:async({budgetId:n,accountGroups:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const c=l4(i);return await gt("budgets",n,{...l,account_groups:c},"saving updated account groups (user edited group settings)"),i},onMutate:async({budgetId:n,accountGroups:i})=>{await t.cancelQueries({queryKey:Ee.budget(n)});const a=t.getQueryData(Ee.budget(n));return a&&t.setQueryData(Ee.budget(n),{...a,accountGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(Ee.budget(i));a&&t.setQueryData(Ee.budget(i),{...a,accountGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(Ee.budget(i),a.previousData)}})}}function u4(){const t=rn();return{renameBudget:ir({mutationFn:async({budgetId:n,newName:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await gt("budgets",n,{...l,name:i.trim()},`renaming budget to "${i.trim()}"`),i.trim()},onMutate:async({budgetId:n,newName:i})=>{await t.cancelQueries({queryKey:Ee.budget(n)});const a=t.getQueryData(Ee.budget(n));return a&&t.setQueryData(Ee.budget(n),{...a,budget:{...a.budget,name:i.trim()}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(Ee.budget(i));a&&t.setQueryData(Ee.budget(i),{...a,budget:{...a.budget,name:n}})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(Ee.budget(i),a.previousData)}})}}function d4(){const t=rn();return{createBudget:ir({mutationFn:async({name:n,userId:i,userEmail:a})=>{const l=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,c=new Date().toISOString(),h={name:n.trim()||"My Budget",user_ids:[i],accepted_user_ids:[i],owner_id:i,owner_email:a,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:c,updated_at:c};await gt("budgets",l,h,"creating new budget document");const{exists:m,data:g}=await Le("users",i,"reading user document to add new budget to their list");return m&&g?await gt("users",i,{...g,budget_ids:[l,...g.budget_ids],updated_at:c},"adding new budget to user's budget list"):await gt("users",i,{uid:i,email:a,budget_ids:[l],created_at:c,updated_at:c},"creating new user document with first budget"),{budgetId:l,budget:{id:l,...h}}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:Ee.user(i)}),t.invalidateQueries({queryKey:Ee.accessibleBudgets(i)})}})}}function h4(){const t=rn();return{acceptInvite:ir({mutationFn:async({budgetId:n,userId:i})=>{const a=new Date().toISOString(),{exists:l,data:c}=await Le("budgets",n,"verifying user was invited to this budget");if(!l||!c)throw new Error("Budget not found");if(!c.user_ids?.includes(i))throw new Error("You have not been invited to this budget");const{data:h}=await Le("users",i,"PRE-EDIT-READ");if(h?.budget_ids?.includes(n))throw new Error("You have already accepted this invite");return await gt("users",i,{...h||{uid:i,email:null},budget_ids:[n,...h?.budget_ids||[]],updated_at:a},"adding accepted budget to user's budget list"),await gt("budgets",n,{...c,accepted_user_ids:[...c.accepted_user_ids||[],i]},"marking user as accepted in budget's accepted_user_ids"),{budgetId:n}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:Ee.user(i)}),t.invalidateQueries({queryKey:Ee.accessibleBudgets(i)}),t.invalidateQueries({queryKey:Ee.budget(n.budgetId)})}})}}function f4(){const t=rn();return{inviteUser:ir({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");if(l.user_ids?.includes(i))throw new Error("User is already invited");return await gt("budgets",n,{...l,user_ids:[...l.user_ids||[],i]},"adding user to budget's invited users list"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:Ee.budget(n)});const a=t.getQueryData(Ee.budget(n));return a&&t.setQueryData(Ee.budget(n),{...a,budget:{...a.budget,user_ids:[...a.budget.user_ids,i]}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(Ee.budget(i));a&&t.setQueryData(Ee.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(Ee.budget(i),a.previousData)}})}}function m4(){const t=rn();return{revokeUser:ir({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await gt("budgets",n,{...l,user_ids:(l.user_ids||[]).filter(c=>c!==i),accepted_user_ids:(l.accepted_user_ids||[]).filter(c=>c!==i)},"removing user from budget's access lists"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:Ee.budget(n)});const a=t.getQueryData(Ee.budget(n));return a&&t.setQueryData(Ee.budget(n),{...a,budget:{...a.budget,user_ids:a.budget.user_ids.filter(l=>l!==i),accepted_user_ids:a.budget.accepted_user_ids.filter(l=>l!==i)}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(Ee.budget(i));a&&t.setQueryData(Ee.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(Ee.budget(i),a.previousData)}})}}function Fn(t,e){const n=HM(t),{updateAccounts:i}=o4(),{updateAccountGroups:a}=c4(),{updateCategories:l}=bM(),{updateCategoryGroups:c}=xM(),{renameBudget:h}=u4(),{createBudget:m}=d4(),{acceptInvite:g}=h4(),{inviteUser:_}=f4(),{revokeUser:v}=m4(),b=n.data,w=b?.budget||null,A=C.useMemo(()=>b?.accounts||{},[b?.accounts]),S=C.useMemo(()=>b?.accountGroups||{},[b?.accountGroups]),M=C.useMemo(()=>b?.categories||{},[b?.categories]),F=C.useMemo(()=>b?.categoryGroups||[],[b?.categoryGroups]),H=w?.owner_id===e,z=C.useMemo(()=>w?.user_ids||[],[w?.user_ids]),ee=C.useMemo(()=>w?.accepted_user_ids||[],[w?.accepted_user_ids]),J=w?.total_available??0,me=C.useMemo(()=>b?.monthMap||{},[b?.monthMap]),P=C.useCallback(async K=>{if(!t)throw new Error("No budget selected");await i.mutateAsync({budgetId:t,accounts:K})},[t,i]),D=C.useCallback(async K=>{if(!t)throw new Error("No budget selected");await a.mutateAsync({budgetId:t,accountGroups:K})},[t,a]),I=C.useCallback(async K=>{if(!t)throw new Error("No budget selected");await l.mutateAsync({budgetId:t,categories:K})},[t,l]),N=C.useCallback(async K=>{if(!t)throw new Error("No budget selected");await c.mutateAsync({budgetId:t,categoryGroups:K})},[t,c]),O=C.useCallback(async(K,te)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.mutateAsync({budgetId:t,accounts:K}),a.mutateAsync({budgetId:t,accountGroups:te})])},[t,i,a]),k=C.useCallback(async(K,te)=>{if(!t)throw new Error("No budget selected");await Promise.all([l.mutateAsync({budgetId:t,categories:K}),c.mutateAsync({budgetId:t,categoryGroups:te})])},[t,l,c]),R=C.useCallback(async K=>{if(!t)throw new Error("No budget selected");await h.mutateAsync({budgetId:t,newName:K})},[t,h]),ae=C.useCallback(async K=>{if(!e)throw new Error("Not authenticated");return await m.mutateAsync({name:K.trim()||"My Budget",userId:e,userEmail:null})},[e,m]),q=C.useCallback(async K=>{if(!t)throw new Error("No budget selected");await _.mutateAsync({budgetId:t,userId:K})},[t,_]),V=C.useCallback(async K=>{if(!t)throw new Error("No budget selected");await v.mutateAsync({budgetId:t,userId:K})},[t,v]),Q=C.useCallback(async K=>{if(!e)throw new Error("Not authenticated");await g.mutateAsync({budgetId:K,userId:e})},[e,g]),W=C.useCallback(K=>{if(!t)return;const te=mt.getQueryData(Ee.budget(t));te&&mt.setQueryData(Ee.budget(t),{...te,accounts:K})},[t]),de=C.useCallback(K=>{if(!t)return;const te=mt.getQueryData(Ee.budget(t));te&&mt.setQueryData(Ee.budget(t),{...te,accountGroups:K})},[t]),ne=C.useCallback(K=>{if(!t)return;const te=mt.getQueryData(Ee.budget(t));te&&mt.setQueryData(Ee.budget(t),{...te,categories:K})},[t]),B=C.useCallback(K=>{if(!t)return;const te=mt.getQueryData(Ee.budget(t));te&&mt.setQueryData(Ee.budget(t),{...te,categoryGroups:K})},[t]),U=C.useCallback(async()=>{t&&await mt.invalidateQueries({queryKey:Ee.budget(t)})},[t]),G=C.useCallback(()=>Object.entries(A).filter(([,K])=>{const te=K.account_group_id?S[K.account_group_id]:void 0,he=te?.on_budget!==void 0?te.on_budget:K.on_budget!==!1,be=te?.is_active!==void 0?te.is_active:K.is_active!==!1;return he&&be}).reduce((K,[,te])=>K+te.balance,0),[A,S]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:w,accounts:A,accountGroups:S,categories:M,categoryGroups:F,isOwner:H,budgetUserIds:z,acceptedUserIds:ee,totalAvailable:J,monthMap:me,saveAccounts:P,saveAccountGroups:D,saveCategories:I,saveCategoryGroups:N,saveAccountsAndGroups:O,saveCategoriesAndGroups:k,renameBudget:R,createBudget:ae,inviteUser:q,revokeUser:V,acceptInvite:Q,setAccountsOptimistic:W,setAccountGroupsOptimistic:de,setCategoriesOptimistic:ne,setCategoryGroupsOptimistic:B,refreshBudget:U,getOnBudgetTotal:G}}function Il(t,e,n){const{addLoadingHold:i,removeLoadingHold:a}=Bn(),l=XM(t,e,n,{enabled:!!t});C.useEffect(()=>(l.isLoading?i("month-query","Loading month data..."):a("month-query"),()=>a("month-query")),[l.isLoading,i,a]);const{addIncome:c}=AM(),{updateIncome:h}=CM(),{deleteIncome:m}=RM(),{addExpense:g}=DM(),{updateExpense:_}=IM(),{deleteExpense:v}=jM(),b=l.data?.month||null,w=b?.income||[],A=b?.expenses||[],S=b?.category_balances||[],M=b?.total_income||0,F=b?.total_expenses||0,H=b?.are_allocations_finalized||!1,z=b?.previous_month_income??0,ee=C.useCallback(async(O,k,R,ae,q)=>{if(!t)throw new Error("No budget selected");const[V,Q]=R.split("-").map(Number);await c(t,V,Q,O,k,R,ae,q)},[t,c]),J=C.useCallback(async(O,k,R,ae,q,V)=>{if(!t)throw new Error("No budget selected");await h(t,e,n,O,k,R,ae,q,V)},[t,e,n,h]),me=C.useCallback(async O=>{if(!t)throw new Error("No budget selected");await m(t,e,n,O)},[t,e,n,m]),P=C.useCallback(async(O,k,R,ae,q,V,Q)=>{if(!t)throw new Error("No budget selected");const[W,de]=ae.split("-").map(Number);await g(t,W,de,O,k,R,ae,q,V,Q)},[t,g]),D=C.useCallback(async(O,k,R,ae,q,V,Q,W)=>{if(!t)throw new Error("No budget selected");await _(t,e,n,O,k,R,ae,q,V,Q,W)},[t,e,n,_]),I=C.useCallback(async O=>{if(!t)throw new Error("No budget selected");await v(t,e,n,O)},[t,e,n,v]),N=C.useCallback(async()=>{t&&await mt.invalidateQueries({queryKey:Ee.month(t,e,n)})},[t,e,n]);return{isLoading:l.isLoading,isFetching:l.isFetching,error:l.error,month:b,income:w,expenses:A,categoryBalances:S,totalIncome:M,totalExpenses:F,areAllocationsFinalized:H,previousMonthIncome:z,addIncome:ee,updateIncome:J,deleteIncome:me,addExpense:P,updateExpense:D,deleteExpense:I,refreshMonth:N}}function p4(){const{selectedBudgetId:t,currentUserId:e}=un(),{budget:n,accounts:i,accountGroups:a,saveAccounts:l,saveAccountGroups:c,saveAccountsAndGroups:h,setAccountsOptimistic:m,setAccountGroupsOptimistic:g}=Fn(t,e),[_,v]=C.useState(null),b=C.useMemo(()=>Object.entries(i).reduce((D,[I,N])=>{const O=N.account_group_id||"ungrouped";return D[O]||(D[O]=[]),D[O].push({...N,id:I}),D},{}),[i]),w=C.useMemo(()=>Object.entries(a).sort(([,D],[,I])=>D.sort_order-I.sort_order).map(([D,I])=>({...I,id:D})),[a]),A=C.useCallback((D,I)=>{if(!n)return;const N=Object.values(i).filter(q=>I==="ungrouped"?!q.account_group_id:q.account_group_id===I),O=N.length>0?Math.max(...N.map(q=>q.sort_order)):-1,k=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,R={nickname:D.nickname,description:"",balance:0,account_group_id:I==="ungrouped"?null:I,sort_order:O+1,is_income_account:D.is_income_account??!1,is_income_default:D.is_income_default??!1,is_outgo_account:D.is_outgo_account??!1,is_outgo_default:D.is_outgo_default??!1,on_budget:D.on_budget!==!1,is_active:D.is_active!==!1},ae={...i};D.is_income_default&&Object.keys(ae).forEach(q=>{ae[q]={...ae[q],is_income_default:!1}}),D.is_outgo_default&&Object.keys(ae).forEach(q=>{ae[q]={...ae[q],is_outgo_default:!1}}),ae[k]=R,m(ae),l(ae).catch(q=>{console.error("[useAccountHandlers] Error creating account:",q),v(q instanceof Error?q.message:"Failed to create account.")})},[n,i,m,l]),S=C.useCallback((D,I)=>{if(!n)return;const N=i[D];if(!N)return;const O=N.account_group_id||"ungrouped",k=I.account_group_id;let R=N.sort_order;if(O!==(k||"ungrouped")){const q=Object.values(i).filter(V=>(V.account_group_id||"ungrouped")===(k||"ungrouped"));R=q.length>0?Math.max(...q.map(V=>V.sort_order))+1:0}const ae={};Object.entries(i).forEach(([q,V])=>{q===D?ae[q]={...V,nickname:I.nickname,account_group_id:k,sort_order:R,is_income_account:I.is_income_account??!1,is_income_default:I.is_income_default??!1,is_outgo_account:I.is_outgo_account??!1,is_outgo_default:I.is_outgo_default??!1,on_budget:I.on_budget!==!1,is_active:I.is_active!==!1}:(ae[q]={...V},I.is_income_default&&!N.is_income_default&&(ae[q].is_income_default=!1),I.is_outgo_default&&!N.is_outgo_default&&(ae[q].is_outgo_default=!1))}),m(ae),l(ae).catch(q=>{console.error("[useAccountHandlers] Error saving account:",q),v(q instanceof Error?q.message:"Failed to save account.")})},[n,i,m,l]),M=C.useCallback(D=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[D]:I,...N}=i;m(N),l(N).catch(O=>{console.error("[useAccountHandlers] Error deleting account:",O),v(O instanceof Error?O.message:"Failed to delete account.")})},[n,i,m,l]),F=C.useCallback(async(D,I)=>{const N=i[D];if(!N)return;const O=N.account_group_id||"ungrouped",k=Object.entries(i).filter(([,W])=>(W.account_group_id||"ungrouped")===O).sort(([,W],[,de])=>W.sort_order-de.sort_order),R=k.findIndex(([W])=>W===D),ae=I==="up"?R-1:R+1;if(ae<0||ae>=k.length)return;const[q,V]=k[ae],Q={};if(Object.entries(i).forEach(([W,de])=>{W===D?Q[W]={...de,sort_order:V.sort_order}:W===q?Q[W]={...de,sort_order:N.sort_order}:Q[W]={...de}}),m(Q),!!n)try{await l(Q)}catch(W){m(i),v(W instanceof Error?W.message:"Failed to move account")}},[n,i,m,l]),H=C.useCallback(D=>{if(!n)return;const I=Object.values(a).map(ae=>ae.sort_order),N=I.length>0?Math.max(...I):-1,O=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,k={name:D.name,sort_order:N+1,expected_balance:D.expected_balance,on_budget:D.on_budget,is_active:D.is_active},R={...a,[O]:k};g(R),c(R).catch(ae=>{console.error("[useAccountHandlers] Error creating group:",ae),v(ae instanceof Error?ae.message:"Failed to create account type.")})},[n,a,g,c]),z=C.useCallback((D,I)=>{if(!n)return;const N={...a,[D]:{...a[D],name:I.name,expected_balance:I.expected_balance,on_budget:I.on_budget,is_active:I.is_active}};g(N),c(N).catch(O=>{console.error("[useAccountHandlers] Error updating group:",O),v(O instanceof Error?O.message:"Failed to update account type.")})},[n,a,g,c]),ee=C.useCallback(D=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const I={};Object.entries(i).forEach(([k,R])=>{I[k]=R.account_group_id===D?{...R,account_group_id:null}:R});const{[D]:N,...O}=a;m(I),g(O),h(I,O).catch(k=>{console.error("[useAccountHandlers] Error deleting group:",k),v(k instanceof Error?k.message:"Failed to delete account type.")})},[n,i,a,m,g,h]),J=C.useCallback(async(D,I)=>{const N=Object.entries(a).sort(([,q],[,V])=>q.sort_order-V.sort_order),O=N.findIndex(([q])=>q===D),k=I==="up"?O-1:O+1;if(k<0||k>=N.length)return;const[R]=N.splice(O,1);N.splice(k,0,R);const ae={};if(N.forEach(([q,V],Q)=>{ae[q]={...V,sort_order:Q}}),g(ae),!!n)try{await c(ae)}catch(q){g(a),v(q instanceof Error?q.message:"Failed to move account type")}},[n,a,g,c]),me=C.useCallback(async(D,I,N)=>{const O=i[D];if(!O)return;const k=N==="ungrouped"?null:N,R=Object.entries(i).filter(([,V])=>(V.account_group_id||"ungrouped")===N),ae={};Object.entries(i).forEach(([V,Q])=>{V!==D&&(ae[V]={...Q})});let q;if(I==="__group_end__"||R.length===0||!R.find(([V])=>V===I))q=(R.length>0?Math.max(...R.filter(([Q])=>Q!==D).map(([,Q])=>Q.sort_order)):-1)+1;else{const V=R.find(([Q])=>Q===I);if(V){const[,Q]=V;q=Q.sort_order,Object.entries(ae).forEach(([W,de])=>{(de.account_group_id||"ungrouped")===N&&de.sort_order>=q&&(ae[W]={...de,sort_order:de.sort_order+1})})}else q=0}if(ae[D]={...O,account_group_id:k,sort_order:q},m(ae),!!n)try{await l(ae)}catch(V){v(V instanceof Error?V.message:"Failed to save changes")}},[n,i,m,l]),P=C.useCallback(async(D,I)=>{if(D===I)return;const N=Object.entries(a).sort(([,q],[,V])=>q.sort_order-V.sort_order),O=N.findIndex(([q])=>q===D),k=[...N],[R]=k.splice(O,1);if(I==="__end__")k.push(R);else{const q=k.findIndex(([V])=>V===I);k.splice(q,0,R)}const ae={};if(k.forEach(([q,V],Q)=>{ae[q]={...V,sort_order:Q}}),g(ae),!!n)try{await c(ae)}catch(q){v(q instanceof Error?q.message:"Failed to save new order")}},[n,a,g,c]);return{accounts:i,accountGroups:a,accountsByGroup:b,sortedGroups:w,currentBudget:n,error:_,setError:v,handleCreateAccount:A,handleUpdateAccount:S,handleDeleteAccount:M,handleMoveAccount:F,handleCreateGroup:H,handleUpdateGroup:z,handleDeleteGroup:ee,handleMoveGroup:J,reorderAccountsInGroup:me,reorderGroups:P}}function SE(t,e){if(!t)return{};const n={};return Object.entries(e).forEach(([i,a])=>{if(a.default_monthly_type==="percentage")return;const l=t.category_balances?.find(c=>c.category_id===i);l&&l.allocated>0?n[i]=l.allocated.toString():a.default_monthly_amount!==void 0&&a.default_monthly_amount>0?n[i]=a.default_monthly_amount.toString():n[i]=""}),n}function g4(){const{addLoadingHold:t,removeLoadingHold:e}=Bn(),{selectedBudgetId:n,currentUserId:i,currentYear:a,currentMonthNumber:l}=un(),{categories:c,getOnBudgetTotal:h,totalAvailable:m}=Fn(n,i),{month:g,isLoading:_,previousMonthIncome:v,areAllocationsFinalized:b}=Il(n,a,l),w=C.useMemo(()=>g?.income?g.income.reduce((U,G)=>U+G.amount,0):0,[g]),{saveDraftAllocations:A}=_M(),{finalizeAllocations:S}=EM(),{deleteAllocations:M}=g1(),F=C.useMemo(()=>SE(g,c),[g,c]),[H,z]=C.useState(F),[ee,J]=C.useState(!1),[me,P]=C.useState(null),D=C.useRef(null);C.useMemo(()=>Object.values(c).reduce((U,G)=>U+(G.balance??0),0),[c]),C.useEffect(()=>{if(!g)return;const U=`${g.year}-${g.month}`;D.current!==U&&(J(!1),z(SE(g,c)),D.current=U)},[g,c]);const I=C.useCallback((U,G)=>{if(G.default_monthly_type==="percentage"&&G.default_monthly_amount!==void 0)return G.default_monthly_amount/100*v;const K=H[U],te=parseFloat(K||"0");return isNaN(te)?0:te},[H,v]),N=C.useMemo(()=>Object.entries(c).reduce((U,[G,K])=>{const te=I(G,K),he=K.balance??0;if(he<0){const be=Math.abs(he),xe=Math.max(0,te-be);return U+xe}return U+te},0),[c,I]),O=h(),k=b?(g?.category_balances||[]).reduce((U,G)=>{const K=c[G.category_id]?.balance??0,te=G.allocated,he=K-te;if(he<0){const be=Math.abs(he);return U+Math.max(0,te-be)}return U+te},0):0,R=m,ae=C.useMemo(()=>R-N+k,[R,N,k]),q=C.useCallback((U,G)=>{z(K=>({...K,[U]:G}))},[]),V=C.useCallback(()=>{if(!g)return;const U={};Object.entries(c).forEach(([G,K])=>{if(K.default_monthly_type==="percentage")return;const te=g.category_balances?.find(he=>he.category_id===G);te&&te.allocated>0?U[G]=te.allocated.toString():K.default_monthly_amount!==void 0&&K.default_monthly_amount>0?U[G]=K.default_monthly_amount.toString():U[G]=""}),z(U),J(!1)},[g,c]),Q=C.useCallback(()=>{const U={};return Object.entries(c).forEach(([G,K])=>{const te=I(G,K);te>0&&(U[G]=te)}),U},[c,I]),W=C.useCallback(async()=>{if(n){P(null),t("allocations-save","Saving allocations...");try{await A(n,a,l,Q()),J(!1)}catch(U){P(U instanceof Error?U.message:"Failed to save allocations")}finally{e("allocations-save")}}},[n,a,l,A,Q,t,e]),de=C.useCallback(async()=>{if(n){P(null),t("allocations-finalize","Applying allocations...");try{await S({budgetId:n,year:a,month:l,allocations:Q()}),J(!1)}catch(U){P(U instanceof Error?U.message:"Failed to finalize allocations")}finally{e("allocations-finalize")}}},[n,a,l,S,Q,t,e]),ne=C.useCallback(async()=>{if(n){P(null),t("allocations-delete","Deleting allocations...");try{await M({budgetId:n,year:a,month:l});const U={};Object.entries(c).forEach(([G,K])=>{K.default_monthly_type!=="percentage"&&(K.default_monthly_amount!==void 0&&K.default_monthly_amount>0?U[G]=K.default_monthly_amount.toString():U[G]="")}),z(U),J(!1)}catch(U){P(U instanceof Error?U.message:"Failed to delete allocations")}finally{e("allocations-delete")}}},[n,a,l,M,c,t,e]),B=N-k;return{localAllocations:H,isEditingAppliedAllocations:ee,error:me,monthLoading:_,onBudgetTotal:O,availableNow:R,currentDraftTotal:N,draftChangeAmount:B,availableAfterApply:ae,previousMonthIncome:v,currentMonthIncome:w,allocationsFinalized:b,getAllocationAmount:I,handleAllocationChange:q,resetAllocationsToSaved:V,handleSaveAllocations:W,handleFinalizeAllocations:de,handleDeleteAllocations:ne,setIsEditingAppliedAllocations:J,setError:P}}function y4({budgetId:t,categories:e,currentYear:n,currentMonth:i,updateCategoriesWithBalances:a}){const l=C.useMemo(()=>{const b={};return Object.entries(e).forEach(([w,A])=>{b[w]={current:A.balance??0,total:A.balance??0}}),b},[e]),[c,h]=C.useState(!1),[m,g]=C.useState(null),_=C.useCallback(async()=>{if(!t||Object.keys(e).length===0)return null;const b=Object.keys(e),{total:w}=await tE(t,b,n,i),A={};Object.entries(e).forEach(([M,F])=>{const H=F.balance,z=w[M]??0;Math.abs(H-z)>.01&&(A[M]={stored:H,calculated:z})});const S=Object.keys(A).length>0?A:null;return g(S),S},[t,e,n,i]),v=C.useCallback(async()=>{if(!(!t||Object.keys(e).length===0)){h(!0);try{const b=Object.keys(e),{total:w}=await tE(t,b,n,i),A={};Object.entries(e).forEach(([S,M])=>{A[S]={...M,balance:w[S]??0}}),await a(A),g(null)}finally{h(!1)}}},[t,e,a,n,i]);return{categoryBalances:l,loadingBalances:c,categoryBalanceMismatch:m,checkCategoryBalanceMismatch:_,recalculateAndSaveCategoryBalances:v}}function _4({categories:t,categoryGroups:e,currentBudget:n,setCategoriesOptimistic:i,setCategoryGroupsOptimistic:a,saveCategories:l,saveCategoryGroups:c,setError:h}){const[m,g]=C.useState(null),[_,v]=C.useState(null),[b,w]=C.useState(null),[A,S]=C.useState(null);function M(N,O){g("category"),v(O),N.dataTransfer.effectAllowed="move"}function F(N,O,k){N.preventDefault(),m==="category"&&(O!==_&&w(O),S(k))}function H(N,O){N.preventDefault(),m==="category"?(S(O),w(null)):m==="group"&&O!==_&&w(O)}function z(){w(null)}function ee(){S(null)}function J(){g(null),v(null),w(null),S(null)}async function me(N,O,k){if(N.preventDefault(),N.stopPropagation(),!_||m!=="category"){J();return}const R=t[_];if(!R)return;const ae=k==="ungrouped"?null:k,q=Object.entries(t).filter(([,W])=>(W.category_group_id||"ungrouped")===k),V={};Object.entries(t).forEach(([W,de])=>{W!==_&&(V[W]=de)});let Q;if(O==="__group_end__"||q.length===0||!q.find(([W])=>W===O))Q=(q.length>0?Math.max(...q.filter(([de])=>de!==_).map(([,de])=>de.sort_order)):-1)+1;else{const W=q.find(([de])=>de===O);W?(Q=W[1].sort_order,Object.entries(V).forEach(([de,ne])=>{(ne.category_group_id||"ungrouped")===k&&ne.sort_order>=Q&&(V[de]={...ne,sort_order:ne.sort_order+1})})):Q=0}if(V[_]={...R,category_group_id:ae,sort_order:Q},i(V),J(),!!n)try{await l(V)}catch(W){h(W instanceof Error?W.message:"Failed to save changes")}}async function P(N,O){N.preventDefault(),m==="category"?await me(N,"__group_end__",O):m==="group"&&await I(N,O)}function D(N,O){N.stopPropagation(),g("group"),v(O),N.dataTransfer.effectAllowed="move"}async function I(N,O){if(N.preventDefault(),!_||m!=="group"||_===O){J();return}const k=e.findIndex(V=>V.id===_),R=[...e],[ae]=R.splice(k,1);if(O==="__end__")R.push(ae);else{const V=R.findIndex(Q=>Q.id===O);R.splice(V,0,ae)}const q=R.map((V,Q)=>({...V,sort_order:Q}));if(a(q),J(),!!n)try{await c(q)}catch(V){h(V instanceof Error?V.message:"Failed to save new order")}}return{dragType:m,draggedId:_,dragOverId:b,dragOverGroupId:A,setDragOverId:w,setDragOverGroupId:S,handleCategoryDragStart:M,handleCategoryDragOver:F,handleDragOverGroup:H,handleDragLeave:z,handleDragLeaveGroup:ee,handleDragEnd:J,handleCategoryDrop:me,handleDropOnGroup:P,handleGroupDragStart:D,handleGroupDrop:I}}function v4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=un(),{budget:a,categories:l,categoryGroups:c,isLoading:h,saveCategories:m,saveCategoryGroups:g,saveCategoriesAndGroups:_,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:b,getOnBudgetTotal:w}=Fn(t,e),[A,S]=C.useState(null),{categoryBalances:M,loadingBalances:F,categoryBalanceMismatch:H,checkCategoryBalanceMismatch:z,recalculateAndSaveCategoryBalances:ee}=y4({budgetId:t,categories:l,currentYear:n,currentMonth:i,updateCategoriesWithBalances:m}),J=_4({categories:l,categoryGroups:c,currentBudget:a,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:b,saveCategories:m,saveCategoryGroups:g,setError:S});async function me(V,Q){if(!a)return;const W=Q==="ungrouped"?null:Q,de=Object.values(l).filter(K=>Q==="ungrouped"?!K.category_group_id:K.category_group_id===Q),ne=de.length>0?Math.max(...de.map(K=>K.sort_order)):-1,B=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,U={name:V.name,description:V.description??"",category_group_id:W,sort_order:ne+1,default_monthly_amount:V.default_monthly_amount??0,default_monthly_type:V.default_monthly_type??"fixed",balance:0},G={...l,[B]:U};v(G);try{await m(G)}catch(K){v(l),S(K instanceof Error?K.message:"Failed to create category")}}async function P(V,Q){if(a)try{const W=l[V];if(!W)return;const de=W.category_group_id||"ungrouped",ne=Q.category_group_id;let B=W.sort_order;if(de!==(ne||"ungrouped")){const G=Object.values(l).filter(K=>(K.category_group_id||"ungrouped")===(ne||"ungrouped")).filter((K,te,he)=>l[V]!==he[te]);B=G.length>0?Math.max(...G.map(K=>K.sort_order))+1:0}const U={...l,[V]:{...W,name:Q.name,description:Q.description??"",category_group_id:ne,sort_order:B,default_monthly_amount:Q.default_monthly_amount??0,default_monthly_type:Q.default_monthly_type??"fixed"}};v(U),await m(U)}catch(W){S(W instanceof Error?W.message:"Failed to update category")}}async function D(V){if(confirm("Are you sure you want to delete this category?")&&a)try{const{[V]:Q,...W}=l;v(W),await m(W)}catch(Q){S(Q instanceof Error?Q.message:"Failed to delete category")}}async function I(V,Q){const W=l[V];if(!W)return;const de=W.category_group_id||"ungrouped",ne=Object.entries(l).filter(([,he])=>(he.category_group_id||"ungrouped")===de).sort((he,be)=>he[1].sort_order-be[1].sort_order),B=ne.findIndex(([he])=>he===V),U=Q==="up"?B-1:B+1;if(U<0||U>=ne.length)return;const[G,K]=ne[U],te={};if(Object.entries(l).forEach(([he,be])=>{he===V?te[he]={...be,sort_order:K.sort_order}:he===G?te[he]={...be,sort_order:W.sort_order}:te[he]=be}),v(te),!!a)try{await m(te)}catch(he){v(l),S(he instanceof Error?he.message:"Failed to move category")}}async function N(V){if(a)try{const Q=c.length>0?Math.max(...c.map(ne=>ne.sort_order)):-1,W={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:V.name,sort_order:Q+1},de=[...c,W];b(de),await g(de)}catch(Q){S(Q instanceof Error?Q.message:"Failed to create group")}}async function O(V,Q){if(a)try{const W=c.map(de=>de.id===V?{...de,name:Q.name}:de);b(W),await g(W)}catch(W){S(W instanceof Error?W.message:"Failed to update group")}}async function k(V){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&a)try{const Q={};Object.entries(l).forEach(([de,ne])=>{Q[de]=ne.category_group_id===V?{...ne,category_group_id:null}:ne});const W=c.filter(de=>de.id!==V);v(Q),b(W),await _(Q,W)}catch(Q){S(Q instanceof Error?Q.message:"Failed to delete group")}}async function R(V,Q){const W=[...c].sort((G,K)=>G.sort_order-K.sort_order),de=W.findIndex(G=>G.id===V),ne=Q==="up"?de-1:de+1;if(ne<0||ne>=W.length)return;const[B]=W.splice(de,1);W.splice(ne,0,B);const U=W.map((G,K)=>({...G,sort_order:K}));if(b(U),!!a)try{await g(U)}catch(G){b(c),S(G instanceof Error?G.message:"Failed to move group")}}const ae=Object.entries(l).reduce((V,[Q,W])=>{const de=W.category_group_id||"ungrouped";return V[de]||(V[de]=[]),V[de].push([Q,W]),V},{}),q=[...c].sort((V,Q)=>V.sort_order-Q.sort_order);return{currentBudget:a,categories:l,categoryGroups:c,categoriesByGroup:ae,sortedGroups:q,categoryBalances:M,isLoading:h,loadingBalances:F,error:A,setError:S,getOnBudgetTotal:w,categoryBalanceMismatch:H,checkCategoryBalanceMismatch:z,recalculateAndSaveCategoryBalances:ee,handleCreateCategory:me,handleUpdateCategory:P,handleDeleteCategory:D,handleMoveCategory:I,handleCreateGroup:N,handleUpdateGroup:O,handleDeleteGroup:k,handleMoveGroup:R,dragType:J.dragType,draggedId:J.draggedId,dragOverId:J.dragOverId,dragOverGroupId:J.dragOverGroupId,setDragOverId:J.setDragOverId,setDragOverGroupId:J.setDragOverGroupId,handleCategoryDragStart:J.handleCategoryDragStart,handleCategoryDragOver:J.handleCategoryDragOver,handleDragOverGroup:J.handleDragOverGroup,handleDragLeave:J.handleDragLeave,handleDragLeaveGroup:J.handleDragLeaveGroup,handleDragEnd:J.handleDragEnd,handleCategoryDrop:J.handleCategoryDrop,handleDropOnGroup:J.handleDropOnGroup,handleGroupDragStart:J.handleGroupDragStart,handleGroupDrop:J.handleGroupDrop}}function oT(t){return t.nickname===void 0||t.description===void 0||t.balance===void 0||t.sort_order===void 0||t.is_income_account===void 0||t.is_income_default===void 0||t.is_outgo_account===void 0||t.is_outgo_default===void 0||t.on_budget===void 0||t.is_active===void 0}function lT(t){return t.name===void 0||t.description===void 0||t.sort_order===void 0||t.default_monthly_amount===void 0||t.default_monthly_type===void 0||t.balance===void 0}function cT(t){return t.name===void 0||t.sort_order===void 0}function uT(t){return t.budget_id===void 0||t.year_month_ordinal===void 0||t.year===void 0||t.month===void 0||!Array.isArray(t.income)||t.total_income===void 0||t.previous_month_income===void 0||!Array.isArray(t.expenses)||t.total_expenses===void 0||!Array.isArray(t.account_balances)||!Array.isArray(t.category_balances)||t.are_allocations_finalized===void 0||t.created_at===void 0||t.updated_at===void 0}function dT(){const t=new Date,e=t.getFullYear();let i=t.getMonth()+1+2,a=e;return i>12&&(i-=12,a+=1),{year:a,month:i}}function hT(t,e,n){return t>n.year||t===n.year&&e>n.month}async function b4(){const t=await xr("budgets","database cleanup: scanning all budgets");let e=0,n=0,i=0,a=0,l=0,c=0,h=0,m=0;for(const A of t.docs){const S=A.data;if(Array.isArray(S.accounts)||Array.isArray(S.categories)||Array.isArray(S.account_groups)){e++;continue}S.month_map===void 0&&m++;const M=S.accounts;if(M&&typeof M=="object"){let z=!1;for(const ee of Object.values(M))oT(ee)&&(l++,z=!0);z&&n++}const F=S.categories;if(F&&typeof F=="object"){let z=!1;for(const ee of Object.values(F))lT(ee)&&(c++,z=!0);z&&i++}const H=S.account_groups;if(H&&typeof H=="object"){let z=!1;for(const ee of Object.values(H))cT(ee)&&(h++,z=!0);z&&a++}}const g=await xr("months","database cleanup: scanning all months"),_=dT(),v=[];let b=0,w=0;for(const A of g.docs){const S=A.data,M=S.year,F=S.month;M&&F&&hT(M,F,_)&&v.push({docId:A.id,budgetId:S.budget_id,year:M,month:F}),uT(S)&&b++,S.is_needs_recalculation!==void 0&&w++}return v.sort((A,S)=>A.year!==S.year?A.year-S.year:A.month-S.month),{totalBudgets:t.docs.length,budgetsWithArrays:e,budgetsWithMissingAccountDefaults:n,budgetsWithMissingCategoryDefaults:i,budgetsWithMissingGroupDefaults:a,accountsNeedingDefaults:l,categoriesNeedingDefaults:c,groupsNeedingDefaults:h,budgetsNeedingMonthMap:m,totalMonths:g.docs.length,futureMonthsToDelete:v,monthsWithSchemaIssues:b,monthsWithOldRecalcField:w}}function TE(t){return{nickname:t.nickname??"",description:t.description??"",balance:t.balance??0,account_group_id:t.account_group_id??null,sort_order:t.sort_order??0,is_income_account:t.is_income_account??!1,is_income_default:t.is_income_default??!1,is_outgo_account:t.is_outgo_account??!1,is_outgo_default:t.is_outgo_default??!1,on_budget:t.on_budget??!0,is_active:t.is_active??!0}}function AE(t){return{name:t.name??"",description:t.description??"",category_group_id:t.category_group_id??null,sort_order:t.sort_order??0,default_monthly_amount:t.default_monthly_amount??0,default_monthly_type:t.default_monthly_type??"fixed",balance:t.balance??0}}function CE(t){return{name:t.name??"",sort_order:t.sort_order??0,...t.expected_balance!==void 0&&{expected_balance:t.expected_balance},...t.on_budget!==void 0&&{on_budget:t.on_budget},...t.is_active!==void 0&&{is_active:t.is_active}}}function x4(t,e){const n=e.match(/_(\d{4})(\d{2})$/),i=n?parseInt(n[1]):new Date().getFullYear(),a=n?parseInt(n[2]):new Date().getMonth()+1,l=`${i}${String(a).padStart(2,"0")}`;return{budget_id:t.budget_id??"",year_month_ordinal:t.year_month_ordinal??l,year:t.year??i,month:t.month??a,income:Array.isArray(t.income)?t.income:[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:Array.isArray(t.expenses)?t.expenses:[],total_expenses:t.total_expenses??0,account_balances:Array.isArray(t.account_balances)?t.account_balances:[],category_balances:Array.isArray(t.category_balances)?t.category_balances:[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at??new Date().toISOString(),updated_at:t.updated_at??new Date().toISOString()}}function E4(){const t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=[];for(let a=3;a>0;a--){let l=e,c=n-a;for(;c<1;)c+=12,l-=1;i.push(nn(l,c))}i.push(nn(e,n));for(let a=1;a<=3;a++){let l=e,c=n+a;for(;c>12;)c-=12,l+=1;i.push(nn(l,c))}return i}async function w4(t){const e={},n=E4(),i=await xr("months",`database cleanup: querying months for budget ${t}`,[{field:"budget_id",op:"==",value:t}]),a=new Set;for(const l of i.docs){const c=l.data;if(c.year&&c.month){const h=nn(c.year,c.month);a.add(h)}}for(const l of n)a.has(l)&&(e[l]={needs_recalculation:!1});return e}async function S4(){const t=[];let e=0,n=0,i=0,a=0,l=0,c=0,h=0,m=0,g=0;const _=await xr("budgets","database cleanup: reading all budgets to fix");for(const w of _.docs)try{const{exists:A,data:S}=await Le("budgets",w.id,"database cleanup: reading budget for update");if(!A||!S)continue;let M=!1;const F={...S};if(Array.isArray(S.accounts)){const H=S.accounts,z={};for(const ee of H){const J=ee.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;z[J]=TE(ee),n++}F.accounts=z,M=!0,l++}if(Array.isArray(S.categories)){const H=S.categories,z={};for(const ee of H){const J=ee.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;z[J]=AE(ee),i++}F.categories=z,M=!0,l++}if(Array.isArray(S.account_groups)){const H=S.account_groups,z={};for(const ee of H){const J=ee.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;z[J]=CE(ee),a++}F.account_groups=z,M=!0,l++}if(!Array.isArray(S.accounts)&&S.accounts&&typeof S.accounts=="object"){const H=S.accounts,z={};for(const[ee,J]of Object.entries(H))oT(J)?(z[ee]=TE(J),n++,M=!0):z[ee]=J;M&&(F.accounts=z)}if(!Array.isArray(S.categories)&&S.categories&&typeof S.categories=="object"){const H=S.categories,z={};let ee=!1;for(const[J,me]of Object.entries(H))lT(me)?(z[J]=AE(me),i++,ee=!0):z[J]=me;ee&&(F.categories=z,M=!0)}if(!Array.isArray(S.account_groups)&&S.account_groups&&typeof S.account_groups=="object"){const H=S.account_groups,z={};let ee=!1;for(const[J,me]of Object.entries(H))cT(me)?(z[J]=CE(me),a++,ee=!0):z[J]=me;ee&&(F.account_groups=z,M=!0)}if(S.month_map===void 0){const H=await w4(w.id);F.month_map=H,M=!0,c++,console.log(`[DatabaseCleanup] Added month_map to budget ${w.id} with ${Object.keys(H).length} months`)}delete F.category_balances,delete F.allocations,delete F.allocations_finalized,delete F.is_needs_recalculation,M&&(await gt("budgets",w.id,F,"database cleanup: saving fixed budget"),e++)}catch(A){t.push(`Budget ${w.id}: ${A instanceof Error?A.message:"Unknown error"}`)}const v=await xr("months","database cleanup: reading all months"),b=dT();for(const w of v.docs)try{const A=w.data,S=A.year,M=A.month;if(S&&M&&hT(S,M,b)){await Ty("months",w.id,`database cleanup: deleting future month ${S}-${M}`),h++;continue}if(uT(A)){const F=x4(A,w.id);await gt("months",w.id,F,"database cleanup: saving fixed month"),m++}A.is_needs_recalculation!==void 0&&(await Ma("months",w.id,{is_needs_recalculation:iM(),updated_at:new Date().toISOString()},`database cleanup: removing is_needs_recalculation from month ${S}/${M}`),g++,console.log(`[DatabaseCleanup] Removed is_needs_recalculation from month ${S}/${M}`))}catch(A){t.push(`Month ${w.id}: ${A instanceof Error?A.message:"Unknown error"}`)}return{budgetsProcessed:e,accountsFixed:n,categoriesFixed:i,groupsFixed:a,arraysConverted:l,monthMapsAdded:c,futureMonthsDeleted:h,monthsFixed:m,oldRecalcFieldsRemoved:g,errors:t}}function T4({currentUser:t,onComplete:e}){const[n,i]=C.useState(!1),[a,l]=C.useState(!1),[c,h]=C.useState(null),[m,g]=C.useState(null);async function _(){if(t){i(!0);try{const A=await b4();h(A)}catch(A){console.error("Failed to scan database:",A)}finally{i(!1)}}}async function v(){if(t){l(!0),g(null);try{const A=await S4();g(A),e?.()}catch(A){g({budgetsProcessed:0,accountsFixed:0,categoriesFixed:0,groupsFixed:0,arraysConverted:0,monthMapsAdded:0,futureMonthsDeleted:0,monthsFixed:0,oldRecalcFieldsRemoved:0,errors:[A instanceof Error?A.message:"Unknown error"]})}finally{l(!1)}}}const b=c!==null&&(c.budgetsWithArrays>0||c.accountsNeedingDefaults>0||c.categoriesNeedingDefaults>0||c.groupsNeedingDefaults>0||c.budgetsNeedingMonthMap>0||c.futureMonthsToDelete.length>0||c.monthsWithSchemaIssues>0||c.monthsWithOldRecalcField>0),w=c!==null?c.budgetsWithArrays+c.accountsNeedingDefaults+c.categoriesNeedingDefaults+c.groupsNeedingDefaults+c.budgetsNeedingMonthMap+c.futureMonthsToDelete.length+c.monthsWithSchemaIssues+c.monthsWithOldRecalcField:0;return{status:c,isScanning:n,scanStatus:_,hasIssues:b,totalIssues:w,isRunning:a,result:m,runCleanup:v}}function Vp(t){return t.includes("@")?!1:!!(/_[a-z0-9]+_(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=2||/_[a-z0-9]+\.(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=1)}function A4(t){let e=t;const n=/^(.+)_(gmail|yahoo|hotmail|outlook|icloud|aol|proton|protonmail)\.(.+)$/i,i=e.match(n);return i?`${i[1]}@${i[2]}.${i[3]}`:(e=e.replace(/_com$/,".com").replace(/_net$/,".net").replace(/_org$/,".org").replace(/_edu$/,".edu").replace(/_io$/,".io"),e=e.replace(/_gmail_/,"@gmail.").replace(/_yahoo_/,"@yahoo.").replace(/_hotmail_/,"@hotmail.").replace(/_outlook_/,"@outlook.").replace(/_icloud_/,"@icloud."),e)}function yh(t){if(t===null||typeof t!="object"||Array.isArray(t))return!1;const e=t;return e._methodName==="arrayUnion"&&Array.isArray(e.vc)}function fT(t){return t.vc||[]}function RE(t){return Array.isArray(t.items)?t.items:yh(t.items)?fT(t.items):[]}function C4({currentUser:t}){const[e,n]=C.useState(!1),[i,a]=C.useState(!1),[l,c]=C.useState(null),[h,m]=C.useState(null);async function g(){if(!t)return;n(!0);const v={documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],isHealthy:!0};try{const b=await xr("feedback","feedback migration: scanning for issues");v.documentsFound=b.docs.length;for(const w of b.docs)Vp(w.id)&&v.sanitizedDocuments.push(w.id),yh(w.data.items)&&v.corruptedDocuments.push(w.id);v.isHealthy=v.sanitizedDocuments.length===0&&v.corruptedDocuments.length===0,c(v)}catch(b){console.error("Failed to scan feedback:",b)}finally{n(!1)}}async function _(){if(!t)return;a(!0);const v=h?{...h,mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]}:{documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]};try{const b=await xr("feedback","feedback migration: listing all documents");v.documentsFound=b.docs.length,v.sanitizedDocuments=[],v.corruptedDocuments=[];for(const w of b.docs){const A=Vp(w.id);if(yh(w.data.items)&&!A){v.corruptedDocuments.push(w.id);const M=fT(w.data.items);try{await gt("feedback",w.id,{items:M,user_email:w.data.user_email||w.id,created_at:w.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: fixing corrupted arrayUnion in ${w.id}`),v.fixedDocuments++}catch(F){v.errors.push(`Failed to fix ${w.id}: ${F instanceof Error?F.message:"Unknown error"}`)}}}for(const w of b.docs)if(Vp(w.id)){v.sanitizedDocuments.push(w.id);const A=w.id,S=A4(A),M=RE(w.data),{exists:F,data:H}=await Le("feedback",S,`feedback migration: checking if ${S} exists`);if(F&&H){const z=RE(H),ee=new Set(z.map(me=>me.id)),J=M.filter(me=>!ee.has(me.id));if(J.length>0||yh(H.items)){const me=[...z,...J];await gt("feedback",S,{...H,items:me,updated_at:new Date().toISOString()},`feedback migration: merging ${J.length} items from ${A}`),v.mergedItems+=J.length}}else M.length>0&&(await gt("feedback",S,{items:M,user_email:S,created_at:w.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: creating ${S} from ${A}`),v.mergedItems+=M.length);try{await Ty("feedback",A,`feedback migration: deleting sanitized document ${A}`),v.deletedDocuments++}catch(z){v.errors.push(`Failed to delete ${A}: ${z instanceof Error?z.message:"Unknown error"}`)}}m(v)}catch(b){v.errors.push(b instanceof Error?b.message:"Migration failed"),m(v)}finally{a(!1)}}return{status:l,isScanning:e,scanStatus:g,isMigratingFeedback:i,feedbackMigrationResult:h,migrateFeedbackDocuments:_}}function R4({currentUser:t,onComplete:e}){const[n,i]=C.useState(!1),[a,l]=C.useState(!1),[c,h]=C.useState(null),[m,g]=C.useState(null);async function _(){if(t){i(!0);try{const b=await xr("months","delete all months: scanning for all months"),w=[],A=new Set;for(const S of b.docs){const{budget_id:M,year:F,month:H}=S.data;A.add(M),w.push({docId:S.id,budgetId:M,year:F,month:H})}w.sort((S,M)=>S.budgetId!==M.budgetId?S.budgetId.localeCompare(M.budgetId):S.year!==M.year?S.year-M.year:S.month-M.month),h({monthsToDelete:w,monthsCount:w.length,budgetCount:A.size})}catch(b){console.error("Failed to scan months:",b)}finally{i(!1)}}}async function v(){if(!t||!c||c.monthsToDelete.length===0)return;l(!0),g(null);let b=0;const w=[];for(const A of c.monthsToDelete)try{await Ty("months",A.docId,`delete all months: deleting month ${A.year}-${A.month} for budget ${A.budgetId}`),b++}catch(S){w.push(`Failed to delete ${A.docId}: ${S instanceof Error?S.message:"Unknown error"}`)}g({deleted:b,errors:w}),l(!1),w.length===0&&(h({monthsToDelete:[],monthsCount:0,budgetCount:0}),e?.())}return{status:c,isScanning:n,scanStatus:_,isDeleting:a,deleteResult:m,deleteAllMonths:v}}function D4({onCreateNew:t}){const[e,n]=C.useState(""),[i,a]=C.useState(!1),[l,c]=C.useState(null);async function h(m){m.preventDefault(),a(!0),c(null);try{await t(e.trim()||void 0)}catch(g){c(g instanceof Error?g.message:"Failed to create budget"),a(!1)}}return d.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:l}),d.jsx("button",{onClick:()=>c(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Create Your Budget"]}),d.jsxs("form",{onSubmit:h,children:[d.jsxs("div",{style:{marginBottom:"1.5rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:e,onChange:m=>n(m.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),d.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),d.jsx("button",{type:"submit",disabled:i,style:{width:"100%",background:ce.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontWeight:600,opacity:i?.7:1,fontSize:"1rem"},children:i?"Creating...":"Create Budget"})]})]}),d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function I4({invites:t,onAccept:e,onCreateNew:n}){const[i,a]=C.useState(null),[l,c]=C.useState(!1),[h,m]=C.useState(""),[g,_]=C.useState(!1),[v,b]=C.useState(null);async function w(S){a(S),b(null);try{await e(S)}catch(M){b(M instanceof Error?M.message:"Failed to accept invitation"),a(null)}}async function A(S){S.preventDefault(),_(!0),b(null);try{await n(h.trim()||void 0)}catch(M){b(M instanceof Error?M.message:"Failed to create new budget"),_(!1)}}return d.jsxs("div",{children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Budget Invitations"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(S=>d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:S.budgetName}),S.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",S.ownerEmail]})]}),d.jsx("button",{onClick:()=>w(S.budgetId),disabled:i!==null||g,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null||g?"not-allowed":"pointer",fontWeight:500,opacity:i!==null||g?.7:1,fontSize:"0.9rem"},children:i===S.budgetId?"Joining...":"Accept & Join"})]},S.budgetId))})]}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?d.jsxs("form",{onSubmit:A,children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),d.jsxs("div",{style:{marginBottom:"1rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:h,onChange:S=>m(S.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{type:"submit",disabled:g||i!==null,style:{background:ce.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||i!==null?"not-allowed":"pointer",fontWeight:500,opacity:g||i!==null?.7:1,fontSize:"0.9rem"},children:g?"Creating...":"Create Budget"}),d.jsx("button",{type:"button",onClick:()=>{c(!1),m("")},disabled:g,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g?"not-allowed":"pointer",fontWeight:500,opacity:g?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),d.jsx("button",{onClick:()=>c(!0),disabled:i!==null,style:{background:ce.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null?"not-allowed":"pointer",fontWeight:500,opacity:i!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function j4({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const i=C.useMemo(()=>[{id:"income",label:"Income"},{id:"balances",label:"Balances",checkmark:n},{id:"spend",label:"Spend"}],[n]);return d.jsx(Uy,{mode:"button",tabs:i,activeTab:t,onTabChange:a=>e(a)})}function O4({isOpen:t,onClose:e,onProceed:n,results:i}){const a=!i||i.status==="confirming",l=i&&!["confirming","done","error"].includes(i.status),c=a||i?.status==="done"||i?.status==="error";function h(){c&&e()}return d.jsx(dl,{isOpen:t,onClose:h,title:"Recalculate Balances",width:"540px",children:d.jsxs("div",{style:{padding:"0.5rem 0"},children:[a&&d.jsxs(d.Fragment,{children:[d.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",lineHeight:1.5},children:["This will recalculate category balances and account balances from the ",d.jsx("strong",{children:"current month forward"}),"."]}),d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Use this if your data seems out of sync or after fixing bugs. Past months will not be modified."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginBottom:"1.5rem"},children:[d.jsx(Uo,{status:"waiting",label:"Find all months to process"}),d.jsx(Uo,{status:"waiting",label:"Process months"}),d.jsx(Uo,{status:"waiting",label:"Update budget totals"})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Me,{variant:"secondary",actionName:"Cancel Recalculation",onClick:e,children:"Cancel"}),d.jsx(Me,{actionName:"Proceed with Recalculation",onClick:n,children:"Proceed"})]})]}),!a&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Recalculating category balances and account balances..."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx(Uo,{status:i?.status==="pending"?"waiting":"complete",label:"Find all months to process",detail:i&&i.status!=="pending"?`Found ${i.monthsFound||0} month${i.monthsFound!==1?"s":""}`:void 0}),d.jsx(Uo,{status:DE(i?.status,["pending","finding_months"],"processing_months"),label:"Process months",detail:i?.status==="processing_months"?`Processing: ${i.currentMonthLabel} (${(i.currentMonthIndex||0)+1}/${i.monthsFound||0})`:i?.monthsProcessed!==void 0?`Processed ${i.monthsProcessed} month${i.monthsProcessed!==1?"s":""}`:void 0}),d.jsx(Uo,{status:i?.status==="error"?"error":DE(i?.status,["pending","finding_months","processing_months"],"updating_budget"),label:"Update budget totals",detail:i?.status==="error"?i.error:void 0,isError:i?.status==="error"})]}),i?.status==="done"&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${ce.success} 10%, transparent)`,border:`1px solid ${ce.success}`,borderRadius:"8px",textAlign:"center"},children:[d.jsx("p",{style:{margin:0,fontWeight:600,color:ce.success},children:" Recalculation complete!"}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:[i.monthsProcessed," month",i.monthsProcessed!==1?"s":""," processed",d.jsx("br",{}),"Total Income: ",Ce(i.totalIncomeRecalculated||0),d.jsx("br",{}),"Total Expenses: ",Ce(i.totalExpensesRecalculated||0)]})]}),(i?.status==="done"||i?.status==="error")&&d.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"center"},children:d.jsx(Me,{actionName:"Close Recalculation Modal",onClick:e,children:"Done"})}),l&&d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"Please wait, do not close this window..."})]})]})})}function DE(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function Uo({status:t,label:e,detail:n,isError:i}){const a=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:a}),d.jsxs("div",{style:{flex:1},children:[d.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:i?1:.6,color:i?ce.error:"inherit"},children:n})]})]})}function Fy({isDisabled:t,onCloseMenu:e}){const{selectedBudgetId:n,currentUserId:i,currentYear:a,currentMonthNumber:l}=un(),{categories:c,accounts:h,saveCategories:m,saveAccounts:g}=Fn(n,i),[_,v]=C.useState(!1),[b,w]=C.useState(!1),[A,S]=C.useState(null);function M(){w(!0),S({status:"confirming"})}async function F(){if(n){v(!0),S({status:"pending"});try{S({status:"finding_months"});const z=new Date,ee=a||z.getFullYear(),J=l||z.getMonth()+1,{year:me,month:P}=Ay(ee,J),D={year:me,month:P},I=await QM(n,me,P),N=Object.keys(c);S({status:"finding_months",monthsFound:I.length}),await new Promise(G=>setTimeout(G,100));const O={};let k=null;const R=mi(n,D.year,D.month),{exists:ae,data:q}=await Le("months",R,"recalculate: reading previous month for starting balances");if(ae&&q&&(k=q,q.category_balances))for(const G of q.category_balances)O[G.category_id]=G.end_balance??0;N.forEach(G=>{O[G]===void 0&&(O[G]=0)});let V=0,Q=0;for(let G=0;G<I.length;G++){const K=I[G],te=`${Zo[K.month-1]} ${K.year}`;S({status:"processing_months",monthsFound:I.length,currentMonthIndex:G,currentMonthLabel:te});const he=mi(n,K.year,K.month),{exists:be,data:xe}=await Le("months",he,`recalculate: reading full month data for ${te}`);if(!be||!xe){console.warn(`Month ${te} not found, skipping`);continue}const oe=xe.income||[],Y=xe.expenses||[],Se=xe.are_allocations_finalized||!1,Re=oe.reduce((rt,qn)=>rt+qn.amount,0),Ge=Y.reduce((rt,qn)=>rt+qn.amount,0);V+=Re,Q+=Ge;const Be={};if(xe.category_balances)for(const rt of xe.category_balances)Be[rt.category_id]={allocated:rt.allocated??0};const yt=N.map(rt=>{const qn=O[rt]??0;let wr=0;Se&&Be[rt]&&(wr=Be[rt].allocated);let Rt=0;Y.length>0&&(Rt=Y.filter(Vt=>Vt.category_id===rt).reduce((Vt,Gn)=>Vt+Gn.amount,0));const Hn=qn+wr-Rt;return{category_id:rt,start_balance:qn,allocated:wr,spent:Rt,end_balance:Hn}});yt.forEach(rt=>{O[rt.category_id]=rt.end_balance});const dn=(G===0?k:I[G-1])?.total_income??0,Ct=Object.keys(h).map(rt=>{const qn=oe.filter(Vt=>Vt.account_id===rt).reduce((Vt,Gn)=>Vt+Gn.amount,0),wr=Y.filter(Vt=>Vt.account_id===rt).reduce((Vt,Gn)=>Vt+Gn.amount,0),Rt=qn-wr;let Hn=0;if(xe.account_balances){const Vt=xe.account_balances.find(Gn=>Gn.account_id===rt);Vt&&(Hn=Vt.start_balance??0)}return{account_id:rt,start_balance:Hn,income:qn,expenses:wr,net_change:Rt,end_balance:Hn+Rt}}),jt={budget_id:n,year_month_ordinal:nn(K.year,K.month),year:K.year,month:K.month,income:oe,total_income:Re,previous_month_income:dn,expenses:Y,total_expenses:Ge,account_balances:Ct,category_balances:yt,are_allocations_finalized:Se,created_at:xe.created_at||new Date().toISOString(),updated_at:new Date().toISOString()};await m1({budgetId:n,month:jt,description:"recalculate all months"}),await new Promise(rt=>setTimeout(rt,50))}const W={};Object.keys(h).forEach(G=>{W[G]=0});const de=await xr("months","recalculate: querying all months for account balances",[{field:"budget_id",op:"==",value:n}]);for(const G of de.docs){const K=mi(n,G.data.year,G.data.month),{exists:te,data:he}=await Le("months",K,`recalculate: reading month ${G.data.year}/${G.data.month} for account balances`);if(!te||!he)continue;const be=he.income||[],xe=he.expenses||[];for(const oe of be)oe.account_id&&W[oe.account_id]!==void 0&&(W[oe.account_id]+=oe.amount);for(const oe of xe)oe.account_id&&W[oe.account_id]!==void 0&&(W[oe.account_id]-=oe.amount)}const ne={};Object.entries(h).forEach(([G,K])=>{ne[G]={...K,balance:W[G]??0}}),await g(ne),S({status:"updating_budget",monthsFound:I.length,monthsProcessed:I.length,totalIncomeRecalculated:V,totalExpensesRecalculated:Q});const B={...O},U={};Object.entries(c).forEach(([G,K])=>{U[G]={...K,balance:B[G]??0}}),await m(U);for(const G of I)mt.invalidateQueries({queryKey:Ee.month(n,G.year,G.month)});S({status:"done",monthsFound:I.length,monthsProcessed:I.length,totalIncomeRecalculated:V,totalExpensesRecalculated:Q})}catch(z){console.error("Recalculate error:",z),S({status:"error",error:z instanceof Error?z.message:"Failed to recalculate"})}finally{v(!1)}}}function H(){w(!1),S(null),e?.()}return d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:M,disabled:t||_,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:t||_?"not-allowed":"pointer",opacity:t||_?.5:1,fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},title:"Recalculate balances from this month forward",children:[_?"":""," Recalculate"]}),d.jsx(O4,{isOpen:b,onClose:H,onProceed:F,results:A})]})}function IE({direction:t,isDisabled:e,isLoading:n,disabledReason:i,onNavigate:a}){const[l,c]=C.useState(!1),h=n||e,m=t==="prev"?"":"",g=t==="prev"?"Previous month":"Next month",_=()=>{n||(e?(c(!0),setTimeout(()=>c(!1),2e3)):a())};return d.jsxs("div",{style:{position:"relative"},children:[d.jsx("button",{onClick:_,onMouseEnter:()=>e&&c(!0),onMouseLeave:()=>c(!1),style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:h?"not-allowed":"pointer",fontSize:"1.25rem",opacity:h?.5:1,transition:"opacity 0.15s, background 0.15s"},title:e?void 0:g,children:m}),l&&e&&d.jsx("div",{style:{position:"absolute",top:"100%",...t==="prev"?{left:0}:{right:0},marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:ce.warning,color:"#000",borderRadius:"6px",fontSize:"0.75rem",fontWeight:500,width:"max-content",maxWidth:"min(300px, 50vw)",textAlign:"center",zIndex:20,boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:i})]})}function Cg(){const t=new Date;let e=t.getFullYear(),n=t.getMonth()+1+3;for(;n>12;)n-=12,e+=1;return{year:e,month:n}}function mT(){const t=new Date;let e=t.getFullYear(),n=t.getMonth()+1-3;for(;n<1;)n+=12,e-=1;return{year:e,month:n}}function jE(t,e){const n=mT();return t<n.year||t===n.year&&e<n.month}function M4(t,e){const n=Cg();return t>n.year||t===n.year&&e>n.month}function zp(t,e,n){return nn(t,e)in n}function k4(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function N4(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}function P4({onPreviousMonth:t,onNextMonth:e}){const{isLoading:n}=Bn(),{currentYear:i,currentMonthNumber:a,isAdmin:l,selectedBudgetId:c,currentUserId:h,setCurrentYear:m,setCurrentMonthNumber:g}=un(),{budget:_,monthMap:v}=Fn(c,h),{month:b}=Il(c,i,a),w=k4(i,a),A=N4(i,a),S=jE(w.year,w.month)&&!zp(w.year,w.month,v),M=M4(A.year,A.month),[F,H]=C.useState(!1),[z,ee]=C.useState(!1),[J,me]=C.useState(i),[P,D]=C.useState(a),I=C.useRef(null);C.useEffect(()=>{if(!F)return;function R(ae){I.current&&!I.current.contains(ae.target)&&(H(!1),ee(!1))}return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[F]);function N(){z||(me(i),D(a)),ee(!z)}function O(){const R=Cg(),ae=mT();let q=J,V=P;const Q=(q-new Date().getFullYear())*12+(V-(new Date().getMonth()+1)),W=3;Q>W&&(q=R.year,V=R.month,console.log(`[MonthNavigation] Clamping to max allowed month: ${q}/${V}`)),Q<-W&&!zp(q,V,v)&&(q=ae.year,V=ae.month,console.log(`[MonthNavigation] Clamping to min allowed month: ${q}/${V}`)),m(q),g(V),ee(!1),H(!1)}function k(){if(!b||!_)return;const R={...b,_meta:{downloaded_at:new Date().toISOString(),budget_id:_.id,budget_name:_.name}},ae=new Blob([JSON.stringify(R,null,2)],{type:"application/json"}),q=URL.createObjectURL(ae),V=document.createElement("a");V.href=q,V.download=`month_${i}_${String(a).padStart(2,"0")}.json`,document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(q),H(!1)}return d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[d.jsx(IE,{direction:"prev",isDisabled:S,isLoading:n,disabledReason:"Cannot create months more than 3 months in the past",onNavigate:t}),d.jsxs("div",{ref:I,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[d.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[Zo[a-1]," ",i]}),d.jsx("button",{onClick:()=>H(!F),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:F?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),n&&d.jsxs(d.Fragment,{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:ce.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),F&&d.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[d.jsx(Fy,{isDisabled:n,onCloseMenu:()=>H(!1)}),d.jsx("button",{onClick:N,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Jump to a specific month",children:" Go to Month"}),z&&d.jsxs("div",{style:{padding:"0.75rem",borderTop:"1px solid color-mix(in srgb, currentColor 15%, transparent)",marginTop:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[d.jsx("button",{onClick:()=>me(R=>R-1),style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"4px",padding:"0.25rem 0.5rem",cursor:"pointer",fontSize:"0.8rem"},children:""}),d.jsx("span",{style:{flex:1,textAlign:"center",fontSize:"0.9rem",fontWeight:500},children:J}),d.jsx("button",{onClick:()=>me(R=>R+1),style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"4px",padding:"0.25rem 0.5rem",cursor:"pointer",fontSize:"0.8rem"},children:""})]}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.25rem",marginBottom:"0.5rem"},children:Zo.map((R,ae)=>{const q=ae+1,V=q===P,Q=J===i&&q===a,W=Cg(),de=J>W.year||J===W.year&&q>W.month,ne=jE(J,q)&&!zp(J,q,v),B=de||ne;let U=R;return de?U="Cannot create months more than 3 months in the future":ne&&(U="Cannot create months more than 3 months in the past"),d.jsx("button",{onClick:()=>D(q),disabled:B,style:{background:V?ce.primary:"color-mix(in srgb, currentColor 8%, transparent)",border:Q?`1px solid ${ce.primary}`:"1px solid transparent",borderRadius:"4px",padding:"0.35rem 0.25rem",cursor:B?"not-allowed":"pointer",fontSize:"0.7rem",color:V?"#fff":"inherit",opacity:B?.3:1,transition:"background 0.15s"},title:U,children:R.slice(0,3)},q)})}),d.jsxs("button",{onClick:O,style:{width:"100%",background:ce.primary,border:"none",borderRadius:"6px",padding:"0.5rem",cursor:"pointer",fontSize:"0.85rem",color:"#fff",fontWeight:500},children:["Go to ",Zo[P-1]," ",J]})]}),l&&b&&d.jsx("button",{onClick:()=>{k()},style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),d.jsx(IE,{direction:"next",isDisabled:M,isLoading:n,disabledReason:"Cannot create months more than 3 months in the future",onNavigate:e})]})}const L4={background:ce.primary,border:"none",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px",color:"white"},V4={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"},z4={background:"transparent",border:`1px solid ${ce.errorBorder}`,color:ce.error,cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"};function pT({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:c,defaultDate:h,config:m,onSubmit:g,onCancel:_,onDelete:v,extraContent:b}){const{isWide:w}=a4(),{showCategory:A=!1,showCleared:S=!1,accountLabel:M="Account",payeePlaceholder:F="Payee name",descriptionPlaceholder:H="Optional note",submitLabel:z}=m,ee=new Date().toISOString().split("T")[0],[J,me]=C.useState(l?.date||h||ee),[P,D]=C.useState(l?.payee||""),[I,N]=C.useState(l?.categoryId||""),[O,k]=C.useState(l?.accountId||c||(t[0]?t[0][0]:"")),[R,ae]=C.useState(l?.amount?.toString()||""),[q,V]=C.useState(l?.description||""),[Q,W]=C.useState(l?.cleared||!1),de={},ne=[];t.forEach(([Y,Se])=>{Se.account_group_id?(de[Se.account_group_id]||(de[Se.account_group_id]=[]),de[Se.account_group_id].push([Y,Se])):ne.push([Y,Se])});function B(Y){Y.preventDefault();const Se=parseFloat(R);isNaN(Se)||Se<=0||A&&!I||!O||!J||g({date:J,payee:P.trim()||void 0,categoryId:A?I:void 0,accountId:O,amount:Se,description:q.trim()||void 0,cleared:S?Q:void 0})}const U=d.jsxs(nu,{id:"txn-account",value:O,onChange:Y=>k(Y.target.value),required:!0,style:{fontSize:"0.85rem",padding:"0.5rem"},children:[Object.entries(e).map(([Y,Se])=>{const Re=de[Y];return Re?.length?d.jsx("optgroup",{label:Se.name,children:Re.map(([Ge,Be])=>d.jsx("option",{value:Ge,children:Be.nickname},Ge))},Y):null}),ne.length>0&&d.jsx("optgroup",{label:"Other",children:ne.map(([Y,Se])=>d.jsx("option",{value:Y,children:Se.nickname},Y))})]}),G=A&&n&&i?d.jsx(Kt,{label:"Category",htmlFor:"txn-category",children:d.jsx($6,{id:"txn-category",value:I,onChange:N,categories:n,categoryGroups:i,placeholder:"Search...",required:!0})}):null,K=S?d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.35rem"},children:[d.jsx("label",{htmlFor:"txn-cleared",style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:"Clr"}),d.jsx(Ms,{id:"txn-cleared",checked:Q,onChange:Y=>W(Y.target.checked)})]}):null,te=d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.1rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[d.jsx("button",{type:"submit",title:z,style:L4,children:""}),d.jsx("button",{type:"button",onClick:()=>{_()},title:"Cancel",style:V4,children:""}),v&&d.jsx("button",{type:"button",onClick:()=>{v()},title:"Delete",style:z4,children:""})]})]}),he=d.jsxs(Ya,{children:[d.jsx(Me,{type:"submit",actionName:z,children:z}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Transaction Form",onClick:_,children:"Cancel"}),v&&d.jsx(Me,{type:"button",variant:"danger",actionName:"Delete Transaction",onClick:v,children:" Delete"})]}),be=A&&n&&i,xe={fontSize:"0.85rem",padding:"0.5rem"};if(!w)return d.jsxs(Ba,{actionName:z,onSubmit:B,children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[d.jsx(Kt,{label:"Date",htmlFor:"txn-date",children:d.jsx(wE,{id:"txn-date",value:J,onChange:Y=>me(Y.target.value),required:!0})}),d.jsx(Kt,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(Tg,{id:"txn-amount",value:R,onChange:ae,placeholder:"$0.00",required:!0,autoFocus:!0})})]}),d.jsx(Kt,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(EE,{id:"txn-payee",value:P,onChange:D,payees:a,placeholder:F})}),G,d.jsx(Kt,{label:M,htmlFor:"txn-account",children:U}),d.jsx(Kt,{label:"Description (optional)",htmlFor:"txn-description",children:d.jsx(Fa,{id:"txn-description",value:q,onChange:Y=>V(Y.target.value),placeholder:H})}),S&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx(Ms,{id:"txn-cleared-stacked",checked:Q,onChange:Y=>W(Y.target.checked)}),d.jsx("label",{htmlFor:"txn-cleared-stacked",style:{fontSize:"0.9rem",cursor:"pointer"},children:"Cleared (appeared in bank account)"})]}),b]}),he]});const oe=be?S?"6rem minmax(8rem, 1fr) minmax(8rem, 1fr) minmax(8rem, 1fr) 6rem minmax(10rem, 2fr) auto auto":"6rem minmax(8rem, 1fr) minmax(8rem, 1fr) minmax(8rem, 1fr) 6rem minmax(10rem, 2fr) auto":S?"6rem minmax(10rem, 1fr) minmax(10rem, 1fr) 6rem minmax(12rem, 2fr) auto auto":"6rem minmax(10rem, 1fr) minmax(10rem, 1fr) 6rem minmax(12rem, 2fr) auto";return d.jsxs(Ba,{actionName:z,onSubmit:B,children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:oe,gap:"1rem",alignItems:"end"},children:[d.jsx(Kt,{label:"Date",htmlFor:"txn-date",children:d.jsx(wE,{id:"txn-date",value:J,onChange:Y=>me(Y.target.value),required:!0,style:xe})}),d.jsx(Kt,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(EE,{id:"txn-payee",value:P,onChange:D,payees:a,placeholder:F})}),G,d.jsx(Kt,{label:M,htmlFor:"txn-account",children:U}),d.jsx(Kt,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(Tg,{id:"txn-amount",value:R,onChange:ae,placeholder:"$0.00",required:!0,autoFocus:!0})}),d.jsx(Kt,{label:"Description",htmlFor:"txn-description",children:d.jsx(Fa,{id:"txn-description",value:q,onChange:Y=>V(Y.target.value),placeholder:H,style:xe})}),K,te]}),b]})}function OE({accounts:t,accountGroups:e,payees:n,initialData:i,defaultAccountId:a,defaultDate:l,onSubmit:c,onCancel:h,onDelete:m,submitLabel:g}){function _(v){c(v.amount,v.accountId,v.date,v.payee,v.description)}return d.jsx(pT,{accounts:t,accountGroups:e,payees:n,initialData:i?{date:i.date,payee:i.payee,accountId:i.account_id,amount:i.amount,description:i.description}:void 0,defaultAccountId:a,defaultDate:l,config:{showCategory:!1,showCleared:!1,accountLabel:"Deposit To",payeePlaceholder:"e.g., Employer, Client name",descriptionPlaceholder:"e.g., January paycheck",submitLabel:g},onSubmit:_,onCancel:h,onDelete:m})}function gT(){const[t,e]=C.useState(()=>typeof window>"u"?!0:window.innerWidth>=Pr.wide);return C.useEffect(()=>{function n(){e(window.innerWidth>=Pr.wide)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}function U4({income:t,accountName:e,accountGroupName:n,onEdit:i,onDelete:a,isMobile:l}){const c=gT(),h=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",m=n?`${n} / ${e}`:e;return l?d.jsxs("div",{onClick:i,style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:h}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""})]}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",m]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:ce.success,fontFamily:"monospace"},children:["+",Ce(t.amount)]})})]}):c?d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"0.6rem 0",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:g=>g.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[d.jsx("div",{style:{width:"5rem",fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:h}),d.jsx("div",{style:{flex:1.5,minWidth:0,fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),d.jsx("div",{style:{flex:2,minWidth:0,fontSize:"0.85rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m}),d.jsxs("div",{style:{width:"7rem",fontWeight:600,color:ce.success,fontFamily:"monospace",textAlign:"right"},children:["+",Ce(t.amount)]}),d.jsx("div",{style:{flex:1.5,minWidth:0,paddingLeft:"1rem",fontSize:"0.8rem",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description||""}),d.jsxs("div",{style:{width:"3rem",display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]}):d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"0.6rem 0",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:g=>g.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[d.jsx("div",{style:{width:"5rem",fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:h}),d.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column"},children:[d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),t.description&&d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]}),d.jsx("div",{style:{width:"7rem",fontSize:"0.8rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e}),d.jsxs("div",{style:{width:"6rem",fontWeight:600,color:ce.success,fontFamily:"monospace",textAlign:"right",fontSize:"0.9rem"},children:["+",Ce(t.amount)]}),d.jsxs("div",{style:{width:"4rem",display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function B4(){const t=gT(),e={display:"flex",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"};return t?d.jsxs("div",{style:e,children:[d.jsx("div",{style:{width:"5rem"},children:"Date"}),d.jsx("div",{style:{flex:1.5,minWidth:0},children:"Payee"}),d.jsx("div",{style:{flex:2,minWidth:0},children:"Account"}),d.jsx("div",{style:{width:"7rem",textAlign:"right"},children:"Amount"}),d.jsx("div",{style:{flex:1.5,minWidth:0,paddingLeft:"1rem"},children:"Description"}),d.jsx("div",{style:{width:"3rem"}})]}):d.jsxs("div",{style:e,children:[d.jsx("div",{style:{width:"5rem"},children:"Date"}),d.jsx("div",{style:{flex:1,minWidth:0},children:"Payee"}),d.jsx("div",{style:{width:"7rem"},children:"Account"}),d.jsx("div",{style:{width:"6rem",textAlign:"right"},children:"Amount"}),d.jsx("div",{style:{width:"4rem"}})]})}function F4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,setCurrentYear:a,setCurrentMonthNumber:l}=un(),{accounts:c,accountGroups:h}=Fn(t,e),{month:m,isLoading:g,addIncome:_,updateIncome:v,deleteIncome:b}=Il(t,n,i),w=Xa(),[A,S]=C.useState(null),[M,F]=C.useState(!1),[H,z]=C.useState(null),me=v1(t,{enabled:M||H!==null}).data||[];function P(W){const de=W.account_group_id?h[W.account_group_id]:void 0;return de?.is_active!==void 0?de.is_active:W.is_active!==!1}function D(W){const de=W.account_group_id?h[W.account_group_id]:void 0;return de?.on_budget!==void 0?de.on_budget:W.on_budget!==!1}const I=Object.entries(c).filter(([,W])=>P(W)&&D(W)),N=I.filter(([,W])=>W.is_income_account),O=N.length>0?N:I,k=I.find(([,W])=>W.is_income_default),R=k?k[0]:void 0,ae=m?.income.reduce((W,de)=>W+de.amount,0)||0;function q(W,de,ne,B,U){S(null),F(!1);const[G,K]=ne.split("-").map(Number);_(W,de,ne,B,U).then(()=>{(G!==n||K!==i)&&(a(G),l(K))}).catch(te=>{S(te instanceof Error?te.message:"Failed to add income")})}function V(W,de,ne,B,U,G){S(null),z(null),v(W,de,ne,B,U,G).catch(K=>{S(K instanceof Error?K.message:"Failed to update income")})}function Q(W){confirm("Are you sure you want to delete this income entry?")&&(S(null),b(W).catch(de=>{S(de instanceof Error?de.message:"Failed to delete income")}))}return d.jsxs("div",{style:{paddingBottom:"2rem",opacity:g?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:g?"none":"auto"},children:[A&&d.jsx("div",{style:{background:`color-mix(in srgb, ${ce.error} 15%, transparent)`,border:`1px solid ${ce.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ce.error},children:A}),d.jsxs("div",{style:{position:"sticky",top:0,zIndex:50,backgroundColor:"#242424",marginLeft:"calc(-1 * var(--page-padding, 2rem))",marginRight:"calc(-1 * var(--page-padding, 2rem))",paddingLeft:"var(--page-padding, 2rem)",paddingRight:"var(--page-padding, 2rem)",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"1px solid rgba(255,255,255,0.15)"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[d.jsx("span",{style:{fontWeight:600},children:"Income:"}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Total: "}),d.jsx("span",{style:{color:bn(ae),fontWeight:600},children:Ce(ae)})]})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:!M&&d.jsx(Me,{actionName:"Open Add Income Form",onClick:()=>F(!0),disabled:O.length===0,style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:"+ Add Income"})})]}),!w&&d.jsx("div",{style:{marginTop:"0.5rem",borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:"0.5rem"},children:d.jsx(B4,{})})]}),O.length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(c).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",d.jsx(Tt,{to:"/budget/accounts",style:{color:ce.primaryLight},children:"Manage accounts "})]}),M&&d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx(OE,{accounts:O,accountGroups:h,payees:me,defaultAccountId:R,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:q,onCancel:()=>F(!1),submitLabel:"Add Income",isMobile:w})}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem"},children:[m?.income.slice().sort((W,de)=>(W.date||"").localeCompare(de.date||"")).map(W=>H===W.id?d.jsx("div",{style:{padding:"0.5rem"},children:d.jsx(OE,{accounts:O,accountGroups:h,payees:me,initialData:W,onSubmit:(de,ne,B,U,G)=>V(W.id,de,ne,B,U,G),onCancel:()=>z(null),onDelete:()=>Q(W.id),submitLabel:"Save",isMobile:w})},W.id):d.jsx(U4,{income:W,accountName:c[W.account_id]?.nickname||"Unknown Account",accountGroupName:c[W.account_id]?.account_group_id?h[c[W.account_id].account_group_id]?.name:void 0,onEdit:()=>{W.payee||`${W.amount}`,z(W.id)},onDelete:()=>Q(W.id),isMobile:w},W.id)),(!m?.income||m.income.length===0)&&!M&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No income recorded for this month"})]})]})}function ME({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:c,defaultDate:h,onSubmit:m,onCancel:g,onDelete:_,submitLabel:v}){function b(w){m(w.amount,w.categoryId,w.accountId,w.date,w.payee,w.description,w.cleared)}return d.jsx(pT,{accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l?{date:l.date,payee:l.payee,categoryId:l.category_id,accountId:l.account_id,amount:l.amount,description:l.description,cleared:l.cleared}:void 0,defaultAccountId:c,defaultDate:h,config:{showCategory:!0,showCleared:!0,accountLabel:"Pay From",payeePlaceholder:"e.g., Grocery Store",descriptionPlaceholder:"e.g., Weekly groceries",submitLabel:v},onSubmit:b,onCancel:g,onDelete:_})}function yT(){const[t,e]=C.useState(()=>typeof window>"u"?!0:window.innerWidth>=Pr.wide);return C.useEffect(()=>{function n(){e(window.innerWidth>=Pr.wide)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}function q4({expense:t,categoryName:e,accountName:n,accountGroupName:i,onEdit:a,onDelete:l,isMobile:c}){const h=yT(),m=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",g=i?`${i} / ${n}`:n;return c?d.jsxs("div",{onClick:a,style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:m}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""}),t.cleared&&d.jsx("span",{style:{fontSize:"0.7rem",color:ce.success},title:"Cleared",children:""})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:{fontSize:"0.7rem",background:`color-mix(in srgb, ${ce.primary} 20%, transparent)`,color:ce.primaryLight,padding:"0.1rem 0.4rem",borderRadius:"3px"},children:e}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",g]})]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:ce.error,fontFamily:"monospace"},children:["-",Ce(t.amount)]})})]}):h?d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"0.6rem 0",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:_=>_.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:[d.jsx("div",{style:{width:"5rem",fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:m}),d.jsx("div",{style:{flex:1.5,minWidth:0,fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),d.jsx("div",{style:{width:"7rem",fontSize:"0.8rem",background:`color-mix(in srgb, ${ce.primary} 15%, transparent)`,color:ce.primaryLight,padding:"0.2rem 0.5rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e}),d.jsx("div",{style:{flex:1,minWidth:0,fontSize:"0.85rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:g}),d.jsxs("div",{style:{width:"6rem",fontWeight:600,color:ce.error,fontFamily:"monospace",textAlign:"right"},children:["-",Ce(t.amount)]}),d.jsx("div",{style:{flex:1,minWidth:0,paddingLeft:"1rem",fontSize:"0.8rem",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description||""}),d.jsx("div",{style:{width:"3rem",textAlign:"center",color:t.cleared?ce.success:"inherit",opacity:t.cleared?1:.3,fontSize:"1rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{width:"4rem",display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]}):d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"0.6rem 0",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:_=>_.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:[d.jsx("div",{style:{width:"5rem",fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:m}),d.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column"},children:[d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),t.description&&d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]}),d.jsx("div",{style:{width:"7rem",fontSize:"0.75rem",background:`color-mix(in srgb, ${ce.primary} 15%, transparent)`,color:ce.primaryLight,padding:"0.15rem 0.4rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e}),d.jsx("div",{style:{width:"7rem",fontSize:"0.8rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n}),d.jsxs("div",{style:{width:"6rem",fontWeight:600,color:ce.error,fontFamily:"monospace",textAlign:"right",fontSize:"0.9rem"},children:["-",Ce(t.amount)]}),d.jsx("div",{style:{width:"3rem",textAlign:"center",color:t.cleared?ce.success:"inherit",opacity:t.cleared?1:.3,fontSize:"0.9rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{width:"4rem",display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function H4(){const t=yT(),e={display:"flex",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"};return t?d.jsxs("div",{style:e,children:[d.jsx("div",{style:{width:"5rem"},children:"Date"}),d.jsx("div",{style:{flex:1.5,minWidth:0},children:"Payee"}),d.jsx("div",{style:{width:"7rem",textAlign:"center"},children:"Category"}),d.jsx("div",{style:{flex:1,minWidth:0},children:"Account"}),d.jsx("div",{style:{width:"6rem",textAlign:"right"},children:"Amount"}),d.jsx("div",{style:{flex:1,minWidth:0,paddingLeft:"1rem"},children:"Description"}),d.jsx("div",{style:{width:"3rem",textAlign:"center"},children:"Clr"}),d.jsx("div",{style:{width:"4rem"}})]}):d.jsxs("div",{style:e,children:[d.jsx("div",{style:{width:"5rem"},children:"Date"}),d.jsx("div",{style:{flex:1,minWidth:0},children:"Payee"}),d.jsx("div",{style:{width:"7rem",textAlign:"center"},children:"Category"}),d.jsx("div",{style:{width:"7rem"},children:"Account"}),d.jsx("div",{style:{width:"6rem",textAlign:"right"},children:"Amount"}),d.jsx("div",{style:{width:"3rem",textAlign:"center"},children:"Clr"}),d.jsx("div",{style:{width:"4rem"}})]})}function G4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,setCurrentYear:a,setCurrentMonthNumber:l}=un(),{accounts:c,accountGroups:h,categories:m,categoryGroups:g}=Fn(t,e),{month:_,isLoading:v,addExpense:b,updateExpense:w,deleteExpense:A}=Il(t,n,i),S=Xa(),[M,F]=C.useState(null),[H,z]=C.useState(!1),[ee,J]=C.useState(null),D=v1(t,{enabled:H||ee!==null}).data||[];function I(ne){const B=ne.account_group_id?h[ne.account_group_id]:void 0;return B?.is_active!==void 0?B.is_active:ne.is_active!==!1}function N(ne){const B=ne.account_group_id?h[ne.account_group_id]:void 0;return B?.on_budget!==void 0?B.on_budget:ne.on_budget!==!1}const O=Object.entries(c).filter(([,ne])=>I(ne)&&N(ne)),k=O.filter(([,ne])=>ne.is_outgo_account),R=k.length>0?k:O,ae=O.find(([,ne])=>ne.is_outgo_default),q=ae?ae[0]:void 0,V=_?.expenses?.reduce((ne,B)=>ne+B.amount,0)||0;function Q(ne,B,U,G,K,te,he){F(null),z(!1);const[be,xe]=G.split("-").map(Number);b(ne,B,U,G,K,te,he).then(()=>{(be!==n||xe!==i)&&(a(be),l(xe))}).catch(oe=>{F(oe instanceof Error?oe.message:"Failed to add expense")})}function W(ne,B,U,G,K,te,he,be){F(null),J(null),w(ne,B,U,G,K,te,he,be).catch(xe=>{F(xe instanceof Error?xe.message:"Failed to update expense")})}function de(ne){confirm("Are you sure you want to delete this expense?")&&(F(null),A(ne).catch(B=>{F(B instanceof Error?B.message:"Failed to delete expense")}))}return d.jsxs("div",{style:{paddingBottom:"2rem",opacity:v?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:v?"none":"auto"},children:[M&&d.jsx("div",{style:{background:`color-mix(in srgb, ${ce.error} 15%, transparent)`,border:`1px solid ${ce.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ce.error},children:M}),d.jsxs("div",{style:{position:"sticky",top:0,zIndex:50,backgroundColor:"#242424",marginLeft:"calc(-1 * var(--page-padding, 2rem))",marginRight:"calc(-1 * var(--page-padding, 2rem))",paddingLeft:"var(--page-padding, 2rem)",paddingRight:"var(--page-padding, 2rem)",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"1px solid rgba(255,255,255,0.15)"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[d.jsx("span",{style:{fontWeight:600},children:"Expenses:"}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Total: "}),d.jsxs("span",{style:{color:V>0?ce.error:"inherit",fontWeight:600},children:[V>0?"-":"",Ce(V)]})]})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:!H&&d.jsx(Me,{actionName:"Open Add Expense Form",onClick:()=>z(!0),disabled:R.length===0||Object.keys(m).length===0,style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:"+ Add Expense"})})]}),!S&&d.jsx("div",{style:{marginTop:"0.5rem",borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:"0.5rem"},children:d.jsx(H4,{})})]}),R.length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(c).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",d.jsx(Tt,{to:"/budget/accounts",style:{color:ce.primaryLight},children:"Manage accounts "})]}),Object.keys(m).length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:["You need to create at least one category before adding expenses."," ",d.jsx(Tt,{to:"/budget/settings/categories",style:{color:ce.primaryLight},children:"Create categories "})]}),H&&d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx(ME,{accounts:R,accountGroups:h,categories:m,categoryGroups:g,payees:D,defaultAccountId:q,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:Q,onCancel:()=>z(!1),submitLabel:"Add Expense",isMobile:S})}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem"},children:[_?.expenses?.slice().sort((ne,B)=>(ne.date||"").localeCompare(B.date||"")).map(ne=>ee===ne.id?d.jsx("div",{style:{padding:"0.5rem"},children:d.jsx(ME,{accounts:R,accountGroups:h,categories:m,categoryGroups:g,payees:D,initialData:ne,onSubmit:(B,U,G,K,te,he,be)=>W(ne.id,B,U,G,K,te,he,be),onCancel:()=>J(null),onDelete:()=>de(ne.id),submitLabel:"Save",isMobile:S})},ne.id):d.jsx(q4,{expense:ne,categoryName:m[ne.category_id]?.name||"Unknown Category",accountName:c[ne.account_id]?.nickname||"Unknown Account",accountGroupName:c[ne.account_id]?.account_group_id?h[c[ne.account_id].account_group_id]?.name:void 0,onEdit:()=>{ne.payee||`${ne.amount}`,J(ne.id)},onDelete:()=>de(ne.id),isMobile:S},ne.id)),(!_?.expenses||_.expenses.length===0)&&!H&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No expenses recorded for this month"})]})]})}function $4({accounts:t,accountGroups:e,accountBalances:n,isMobile:i}){const a=C.useMemo(()=>Object.entries(e).map(([c,h])=>({id:c,...h})).sort((c,h)=>c.sort_order-h.sort_order),[e]),l=C.useMemo(()=>{const c={};return Object.entries(t).forEach(([h,m])=>{const g=m.account_group_id||"ungrouped";c[g]||(c[g]=[]),c[g].push([h,m])}),Object.keys(c).forEach(h=>{c[h].sort((m,g)=>m[1].sort_order-g[1].sort_order)}),c},[t]);return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(t).length===0&&d.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No accounts yet."," ",d.jsx(Tt,{to:"/budget/settings/accounts",style:{color:ce.primaryLight},children:"Add accounts "})]}),a.map(c=>{const h=l[c.id]||[];if(h.length===0)return null;const m=h.reduce((g,[_])=>{const v=n[_];return v?{start:g.start+v.start_balance,income:g.income+v.income,expenses:g.expenses+v.expenses,netChange:g.netChange+v.net_change,end:g.end+v.end_balance}:g},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(kE,{name:c.name,accounts:h,groupTotals:m,accountBalances:n,isMobile:i},c.id)}),l.ungrouped?.length>0&&(()=>{const c=l.ungrouped,h=c.reduce((m,[g])=>{const _=n[g];return _?{start:m.start+_.start_balance,income:m.income+_.income,expenses:m.expenses+_.expenses,netChange:m.netChange+_.net_change,end:m.end+_.end_balance}:m},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(kE,{name:"Ungrouped",accounts:c,groupTotals:h,accountBalances:n,isMobile:i,isUngrouped:!0},"ungrouped")})()]})}function kE({name:t,accounts:e,groupTotals:n,accountBalances:i,isMobile:a,isUngrouped:l}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Dl,margin:0,opacity:l?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"0.8rem",color:n.netChange>=0?ce.success:ce.error},children:[n.netChange>=0?"+":"",Ce(n.netChange)]}),d.jsx("span",{style:{fontWeight:600,color:bn(n.end)},children:Ce(n.end)})]})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:e.map(([c,h])=>{const m=i[c];return m?a?d.jsx(Q4,{account:h,balance:m},c):d.jsx(W4,{account:h,balance:m},c):null})})]})}function Q4({account:t,balance:e}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.nickname})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:Ce(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Net Change"}),d.jsxs("span",{style:{color:e.net_change>=0?ce.success:ce.error},children:[e.net_change>=0?"+":"",Ce(e.net_change)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:bn(e.end_balance)},children:Ce(e.end_balance)})]})]}),(e.income>0||e.expenses>0)&&d.jsxs("div",{style:{marginTop:"0.5rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)",display:"flex",gap:"1rem",fontSize:"0.7rem",opacity:.7},children:[e.income>0&&d.jsxs("span",{children:["+",Ce(e.income)," income"]}),e.expenses>0&&d.jsxs("span",{children:["-",Ce(e.expenses)," expenses"]})]})]})}function W4({account:t,balance:e}){return d.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px"},children:[d.jsxs("div",{style:{flex:2,minWidth:0,overflow:"hidden"},children:[d.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.nickname}),(e.income>0||e.expenses>0)&&d.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5},children:[e.income>0&&`+${Ce(e.income)}`,e.income>0&&e.expenses>0&&" / ",e.expenses>0&&`-${Ce(e.expenses)}`]})]}),d.jsx("span",{style:{flex:1,textAlign:"right",fontSize:"0.9rem"},children:Ce(e.start_balance)}),d.jsxs("span",{style:{flex:1,textAlign:"right",fontSize:"0.9rem",color:e.net_change>=0?ce.success:ce.error},children:[e.net_change>=0?"+":"",Ce(e.net_change)]}),d.jsx("span",{style:{flex:1,textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:bn(e.end_balance)},children:Ce(e.end_balance)}),d.jsx("span",{style:{flex:1}})]})}const Os={alignSelf:"stretch",display:"flex",alignItems:"center"};function K4({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l,projectedAllTime:c}){const h=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,m=h?t.default_monthly_amount/100*i:0,g=h?m.toFixed(2):n,_=a&&!h,v=a?c:t.balance??0,b=t.balance??0,w=b<0,A=w?Math.abs(b):0,S=h?m:parseFloat(n)||0,M=w?Math.min(S,A):0,F=w?Math.max(0,S-A):0,H=w&&S>0&&F>0;return d.jsxs("div",{style:{background:w?ce.debtBg:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem",boxShadow:w?`inset 0 0 0 2px ${ce.debtBorder}`:"none"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.name})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:Ce(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),_?d.jsxs(d.Fragment,{children:[d.jsx("input",{type:"text",inputMode:"decimal",value:g?`$${g}`:"",onChange:z=>{const ee=z.target.value.replace(/[^\d.]/g,"");l(ee)},placeholder:"$0",style:{width:"100%",maxWidth:"80px",padding:"0.25rem 0.35rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 8%, transparent)",fontSize:"0.8rem",color:"inherit",boxSizing:"border-box"}}),w&&S>0&&d.jsxs("div",{style:{fontSize:"0.65rem",marginTop:"0.15rem",lineHeight:1.3},children:[d.jsxs("span",{style:{color:ce.debt,display:"block"},children:[Ce(M),"  debt"]}),H&&d.jsxs("span",{style:{color:ce.success,display:"block"},children:[Ce(F),"  balance"]})]})]}):d.jsxs("span",{style:{color:e.allocated>0?ce.success:"inherit"},children:[e.allocated>0?"+":"",Ce(e.allocated)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),d.jsxs("span",{style:{color:e.spent>0?ce.error:"inherit"},children:[e.spent>0?"-":"",Ce(e.spent)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:qa(e.end_balance)},children:Ce(e.end_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:a?"Proj. All-Time":"All-Time"}),d.jsx("span",{style:{color:a?v<0?ce.debt:ce.primary:qa(v)},children:Ce(v)})]})]}),a&&h&&d.jsx("div",{style:{marginTop:"0.5rem"},children:d.jsxs("span",{style:{fontSize:"0.8rem"},children:[d.jsxs("span",{style:{opacity:.6},children:[Ce(i),"  "]}),d.jsxs("span",{style:{color:ce.primary},children:[t.default_monthly_amount,"%"]}),d.jsx("span",{style:{opacity:.6},children:" = "}),d.jsx("span",{style:{color:ce.primary},children:Ce(m)})]})})]})}function Y4({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l,allTimeBalance:c,isEvenRow:h}){const m=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,g=m?t.default_monthly_amount/100*i:0,_=m?g.toFixed(2):n,v=t.balance??0,b=v<0,w=b?Math.abs(v):0,A=m?g:parseFloat(n)||0,S=b?Math.min(A,w):0,M=b?Math.max(0,A-w):0,F=b&&A>0&&M>0;return d.jsxs("div",{style:{display:"flex",alignItems:"stretch",padding:"0.6rem 0.75rem",background:b?ce.debtBg:h?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 6%, transparent)",boxShadow:b?`inset 0 0 0 2px ${ce.debtBorder}`:"none",borderRadius:b?"8px":"0"},children:[d.jsx("div",{style:{...Os,flex:2,minWidth:0,overflow:"hidden"},children:d.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name})}),a?d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{...Os,width:"200px",justifyContent:"center",flexDirection:"column",gap:"0.15rem"},children:m?d.jsxs("span",{style:{fontSize:"0.8rem"},children:[d.jsxs("span",{style:{color:ce.primary},children:[t.default_monthly_amount,"%"]}),d.jsx("span",{style:{opacity:.5},children:" = "}),d.jsx("span",{style:{color:ce.primary},children:Ce(g)})]}):d.jsxs(d.Fragment,{children:[d.jsx("input",{type:"text",inputMode:"decimal",value:_?`$${_}`:"",onChange:H=>{const z=H.target.value.replace(/[^\d.]/g,"");l(z)},placeholder:"$0.00",style:{width:"90px",padding:"0.3rem 0.5rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box"}}),b&&A>0&&d.jsxs("div",{style:{fontSize:"0.65rem",whiteSpace:"nowrap",textAlign:"center",lineHeight:1.2},children:[d.jsxs("span",{style:{color:ce.debt},children:[Ce(S),"  debt"]}),F&&d.jsxs("span",{style:{color:ce.success,marginLeft:"0.5rem"},children:[Ce(M),"  bal"]})]})]})}),d.jsx("div",{style:{...Os,flex:1,justifyContent:"flex-end",fontSize:"0.9rem"},children:Ce(e.start_balance)})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{...Os,flex:1,justifyContent:"flex-end",fontSize:"0.9rem"},children:Ce(e.start_balance)}),d.jsxs("div",{style:{...Os,flex:1,justifyContent:"flex-end",fontSize:"0.9rem",color:e.allocated>0?ce.success:"inherit"},children:[e.allocated>0?"+":"",Ce(e.allocated)]})]}),d.jsxs("div",{style:{...Os,flex:1,justifyContent:"flex-end",fontSize:"0.9rem",color:e.spent>0?ce.error:"inherit"},children:[e.spent>0?"-":"",Ce(e.spent)]}),d.jsx("div",{style:{...Os,flex:1,justifyContent:"flex-end",fontSize:"0.9rem",fontWeight:600,color:qa(e.end_balance),paddingRight:"1rem",marginTop:"-0.6rem",marginBottom:"-0.6rem",paddingTop:"0.6rem",paddingBottom:"0.6rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:Ce(e.end_balance)}),d.jsx("div",{style:{...Os,width:"120px",justifyContent:"flex-end",fontSize:"0.9rem",color:a?c<0?ce.debt:ce.primary:qa(c)},children:Ce(c)})]})}function NE({name:t,categories:e,groupEndBalance:n,groupAllocated:i,getCategoryBalance:a,localAllocations:l,previousMonthIncome:c,isDraftMode:h,onAllocationChange:m,isMobile:g,isUngrouped:_,hideHeader:v}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Dl,margin:0,opacity:_?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"0.8rem",opacity:.6},children:["+",Ce(i)]}),d.jsx("span",{style:{fontWeight:600,color:qa(n)},children:Ce(n)})]})]}),!g&&d.jsxs(d.Fragment,{children:[!v&&d.jsxs("div",{style:{display:"flex",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[d.jsx("div",{style:{flex:2,minWidth:0},children:"Category"}),h?d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{width:"200px",textAlign:"center"},children:"Allocated"}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Start"})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Start"}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Allocated"})]}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Spent"}),d.jsx("div",{style:{flex:1,textAlign:"right",paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:"End"}),d.jsx("div",{style:{width:"120px",textAlign:"right"},children:h?"Proj. All-Time":"All-Time"})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column"},children:e.map(([b,w],A)=>{const S=a(b);if(!S)return null;const M=w.balance??0,F=S.end_balance-S.start_balance,H=M+F;return d.jsx(Y4,{category:w,balance:S,localAllocation:l[b]||"",previousMonthIncome:c,isDraftMode:h,onAllocationChange:z=>m(b,z),allTimeBalance:h?H:M,isEvenRow:A%2===0},b)})})]}),g&&d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:h?"0.5rem":"0.25rem"},children:e.map(([b,w])=>{const A=a(b);if(!A)return null;const S=w.balance??0,M=A.end_balance-A.start_balance,F=S+M;return d.jsx(K4,{category:w,balance:A,localAllocation:l[b]||"",previousMonthIncome:c,isDraftMode:h,onAllocationChange:H=>m(b,H),projectedAllTime:F},b)})})]})}function X4({isOpen:t,onClose:e,onDeleted:n}){const{addLoadingHold:i,removeLoadingHold:a}=Bn(),{selectedBudgetId:l,currentYear:c,currentMonthNumber:h}=un(),{deleteAllocations:m}=g1(),[g,_]=C.useState(null),v=async()=>{if(l){_(null),i("allocations-delete","Deleting allocations...");try{await m({budgetId:l,year:c,month:h}),e(),n?.()}catch(b){_(b instanceof Error?b.message:"Failed to delete allocations")}finally{a("allocations-delete")}}};return d.jsxs(dl,{isOpen:t,onClose:e,title:"Delete Allocations",children:[g&&d.jsx(Ka,{message:g,onDismiss:()=>_(null)}),d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to delete all allocations for this month? This will remove all allocated amounts and reset the month to unfinalized."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Me,{actionName:"Cancel Delete Allocations",variant:"secondary",onClick:e,children:"Cancel"}),d.jsx(Me,{actionName:"Confirm Delete Allocations",variant:"danger",onClick:v,children:"Delete Allocations"})]})]})}function J4({isDraftMode:t,isEditingAppliedAllocations:e,availableNow:n,currentMonthIncome:i,balanceTotals:a,draftChangeAmount:l,availableAfterApply:c}){return d.jsxs(d.Fragment,{children:[d.jsx("span",{style:{fontWeight:600,color:t||e?ce.primary:"inherit",marginRight:"0.25rem"},children:t||e?"Allocations Worksheet:":"Month Summary:"}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:t?"Avail: ":"Inc: "}),t?d.jsx("span",{style:{color:bn(n),fontWeight:600},children:Ce(n)}):d.jsxs("span",{style:{color:ce.success,fontWeight:600},children:["+",Ce(i)]})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:t?"Draft: ":"Alloc: "}),d.jsxs("span",{style:{color:t?ce.primary:ce.success,fontWeight:600},children:["+",Ce(a.allocated)]}),e&&l!==0&&d.jsxs("span",{style:{fontSize:"0.85em",color:l>0?ce.warning:ce.success,marginLeft:"0.25rem"},children:["(",l>0?"+":"",Ce(Math.abs(l)),")"]})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Spent: "}),d.jsxs("span",{style:{color:ce.error,fontWeight:600},children:["-",Ce(a.spent)]})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:t?"After: ":"Net: "}),t?d.jsx("span",{style:{color:bn(c),fontWeight:600},children:Ce(c)}):d.jsx("span",{style:{color:bn(a.allocated-a.spent),fontWeight:600},children:Ce(a.allocated-a.spent)})]})]})}function Z4({totals:t}){return d.jsxs(d.Fragment,{children:[d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Start: "}),d.jsx("span",{style:{color:bn(t.start),fontWeight:600},children:Ce(t.start)})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Inc: "}),d.jsxs("span",{style:{color:ce.success,fontWeight:600},children:["+",Ce(t.income)]})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Exp: "}),d.jsxs("span",{style:{color:ce.error,fontWeight:600},children:["-",Ce(t.expenses)]})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"End: "}),d.jsx("span",{style:{color:bn(t.end),fontWeight:600},children:Ce(t.end)})]})]})}function eP({currentView:t,onViewChange:e,isDraftMode:n,isEditingAppliedAllocations:i,allocationsFinalized:a,onSave:l,onApply:c,onEdit:h,onCancel:m,onDelete:g}){return d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:[d.jsx(Me,{actionName:t==="categories"?"Switch to Account Balances":"Switch to Category Balances",onClick:()=>e(t==="categories"?"accounts":"categories"),variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:t==="categories"?" Accounts":" Categories"}),t==="categories"&&n&&!i&&d.jsxs(d.Fragment,{children:[d.jsx(Me,{actionName:"Save Draft Allocations",onClick:l,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Save"}),d.jsx(Me,{actionName:"Apply Allocations",onClick:c,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Apply"})]}),t==="categories"&&!n&&a&&d.jsx(Me,{actionName:"Edit Allocations",onClick:h,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Edit"}),t==="categories"&&i&&d.jsxs(d.Fragment,{children:[d.jsx(Me,{actionName:"Apply Allocations",onClick:c,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Apply"}),d.jsx(Me,{actionName:"Cancel Edit Allocations",onClick:m,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:""}),d.jsx(Me,{actionName:"Open Delete Allocations Modal",onClick:g,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em",color:ce.error},children:""})]})]})}function tP({isDraftMode:t}){return d.jsxs("div",{style:{display:"flex",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em",paddingTop:"0.5rem",marginTop:"0.5rem",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[d.jsx("div",{style:{flex:2,minWidth:0},children:"Category"}),t?d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{width:"200px",textAlign:"center"},children:"Allocated"}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Start"})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Start"}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Allocated"})]}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Spent"}),d.jsx("div",{style:{flex:1,textAlign:"right",paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:"End"}),d.jsx("div",{style:{width:"120px",textAlign:"right"},children:t?"Proj. All-Time":"All-Time"})]})}function nP(){return d.jsxs("div",{style:{display:"flex",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em",paddingTop:"0.5rem",marginTop:"0.5rem",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[d.jsx("div",{style:{flex:2,minWidth:0},children:"Account"}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Start"}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Net Change"}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"End"}),d.jsx("div",{style:{flex:1}})]})}function rP({currentView:t,onViewChange:e}){const{addLoadingHold:n,removeLoadingHold:i}=Bn(),{selectedBudgetId:a,currentUserId:l,currentYear:c,currentMonthNumber:h}=un(),{categories:m,categoryGroups:g,accounts:_,accountGroups:v,monthMap:b}=Fn(a,l),{month:w}=Il(a,c,h),A=Xa(),S=nn(c,h),M=b[S]?.needs_recalculation===!0,F=C.useRef(!1);C.useEffect(()=>{if(!a||!w||!M||F.current)return;F.current=!0,n("balances-recalc","Recalculating balances...");const xe=`${c}${String(h).padStart(2,"0")}`;console.log(`[BalancesSection] Month needs recalculation, triggering from ${xe}...`),y1(a,{triggeringMonthOrdinal:xe}).then(()=>{mt.invalidateQueries({queryKey:Ee.month(a,c,h)}),mt.invalidateQueries({queryKey:Ee.budget(a)})}).catch(oe=>{console.error("[BalancesSection] Recalculation failed:",oe)}).finally(()=>{F.current=!1,i("balances-recalc")})},[a,M,w,c,h,n,i]);const[H,z]=C.useState(!1),{localAllocations:ee,isEditingAppliedAllocations:J,error:me,availableNow:P,draftChangeAmount:D,availableAfterApply:I,previousMonthIncome:N,currentMonthIncome:O,allocationsFinalized:k,getAllocationAmount:R,handleAllocationChange:ae,resetAllocationsToSaved:q,handleSaveAllocations:V,handleFinalizeAllocations:Q,setIsEditingAppliedAllocations:W,setError:de}=g4(),ne=[...g].sort((xe,oe)=>xe.sort_order-oe.sort_order),B=C.useMemo(()=>{const xe=Object.entries(m).reduce((oe,[Y,Se])=>{const Re=Se.category_group_id||"ungrouped";return oe[Re]||(oe[Re]=[]),oe[Re].push([Y,Se]),oe},{});return Object.keys(xe).forEach(oe=>{xe[oe].sort((Y,Se)=>Y[1].sort_order-Se[1].sort_order)}),xe},[m]),U=!k||J,G=C.useMemo(()=>{const xe={};w?.category_balances&&w.category_balances.forEach(Y=>{xe[Y.category_id]=Y});const oe={};return Object.entries(m).forEach(([Y,Se])=>{const Re=xe[Y],Ge=Re?.start_balance??0,Be=Re?.spent??0;let yt=0;U?yt=R(Y,Se):k&&Re&&(yt=Re.allocated),oe[Y]={category_id:Y,start_balance:Ge,allocated:yt,spent:Be,end_balance:Ge+yt-Be}}),oe},[w,m,U,k,R]),K=xe=>G[xe],te=C.useMemo(()=>{const xe={};w?.account_balances&&w.account_balances.forEach(Y=>{xe[Y.account_id]=Y});const oe={};return Object.entries(_).forEach(([Y,Se])=>{const Ge=xe[Y]?.start_balance??Se.balance;let Be=0;w?.income&&(Be=w.income.filter(dn=>dn.account_id===Y).reduce((dn,sr)=>dn+sr.amount,0));let yt=0;w?.expenses&&(yt=w.expenses.filter(dn=>dn.account_id===Y).reduce((dn,sr)=>dn+sr.amount,0));const Cn=Be-yt;oe[Y]={account_id:Y,start_balance:Ge,income:Be,expenses:yt,net_change:Cn,end_balance:Ge+Cn}}),oe},[w,_]),he=C.useMemo(()=>Object.values(te).reduce((xe,oe)=>({start:xe.start+oe.start_balance,income:xe.income+oe.income,expenses:xe.expenses+oe.expenses,netChange:xe.netChange+oe.net_change,end:xe.end+oe.end_balance}),{start:0,income:0,expenses:0,netChange:0,end:0}),[te]),be=C.useMemo(()=>Object.values(G).reduce((xe,oe)=>({start:xe.start+oe.start_balance,allocated:xe.allocated+oe.allocated,spent:xe.spent+oe.spent,end:xe.end+oe.end_balance}),{start:0,allocated:0,spent:0,end:0}),[G]);return d.jsxs(d.Fragment,{children:[me&&d.jsx(Ka,{message:me,onDismiss:()=>de(null)}),d.jsxs("div",{style:{position:"sticky",top:0,zIndex:50,backgroundColor:"#242424",marginLeft:"calc(-1 * var(--page-padding, 2rem))",marginRight:"calc(-1 * var(--page-padding, 2rem))",paddingLeft:"var(--page-padding, 2rem)",paddingRight:"var(--page-padding, 2rem)",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"1px solid rgba(255,255,255,0.15)"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem"},children:[d.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:t==="categories"?d.jsx(J4,{isDraftMode:U,isEditingAppliedAllocations:J,availableNow:P,currentMonthIncome:O,balanceTotals:be,draftChangeAmount:D,availableAfterApply:I}):d.jsx(Z4,{totals:he})}),d.jsx(eP,{currentView:t,onViewChange:e,isDraftMode:U,isEditingAppliedAllocations:J,allocationsFinalized:k,onSave:V,onApply:Q,onEdit:()=>W(!0),onCancel:q,onDelete:()=>z(!0)})]}),!A&&t==="categories"&&d.jsx(tP,{isDraftMode:U}),!A&&t==="accounts"&&d.jsx(nP,{})]}),t==="accounts"&&d.jsx($4,{accounts:_,accountGroups:v,accountBalances:te,isMobile:A}),t==="categories"&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",paddingBottom:"2rem"},children:[Object.keys(m).length===0&&d.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",d.jsx(Tt,{to:"/budget/settings/categories",style:{color:ce.primaryLight},children:"Create categories "})]}),ne.map(xe=>{const oe=B[xe.id]||[];if(oe.length===0)return null;const Y=oe.reduce((Se,[Re])=>{const Ge=K(Re);return Ge?{start:Se.start+Ge.start_balance,allocated:Se.allocated+Ge.allocated,spent:Se.spent+Ge.spent,end:Se.end+Ge.end_balance}:Se},{start:0,allocated:0,spent:0,end:0});return d.jsx(NE,{name:xe.name,categories:oe,groupEndBalance:Y.end,groupAllocated:Y.allocated,getCategoryBalance:K,localAllocations:ee,previousMonthIncome:N,isDraftMode:U,onAllocationChange:ae,isMobile:A,hideHeader:!A},xe.id)}),B.ungrouped?.length>0&&(()=>{const xe=B.ungrouped,oe=xe.reduce((Y,[Se])=>{const Re=K(Se);return Re?{start:Y.start+Re.start_balance,allocated:Y.allocated+Re.allocated,spent:Y.spent+Re.spent,end:Y.end+Re.end_balance}:Y},{start:0,allocated:0,spent:0,end:0});return d.jsx(NE,{name:"Uncategorized",categories:xe,groupEndBalance:oe.end,groupAllocated:oe.allocated,getCategoryBalance:K,localAllocations:ee,previousMonthIncome:N,isDraftMode:U,onAllocationChange:ae,isMobile:A,isUngrouped:!0,hideHeader:!A},"ungrouped")})()]}),d.jsx(X4,{isOpen:H,onClose:()=>z(!1),onDeleted:()=>W(!1)})]})}const iP=["income","balances","spend"],sP=["categories","accounts"];function Up(t){const e=t.year?parseInt(t.year,10):null,n=t.month?parseInt(t.month,10):null,i=t.tab&&iP.includes(t.tab)?t.tab:null,a=t.view&&sP.includes(t.view)?t.view:null;return{year:e&&!isNaN(e)&&e>=2e3&&e<=2100?e:null,month:n&&!isNaN(n)&&n>=1&&n<=12?n:null,tab:i,view:a}}function PE(){const t=KC(),e=iu(),[n,i]=UR(),{currentUserId:a,selectedBudgetId:l,currentYear:c,currentMonthNumber:h,lastActiveTab:m,lastBalancesView:g,setCurrentYear:_,setCurrentMonthNumber:v,setLastActiveTab:b,setLastBalancesView:w,goToPreviousMonth:A,goToNextMonth:S,hasPendingInvites:M,pendingInvites:F,needsFirstBudget:H}=un(),{budget:z,createBudget:ee,acceptInvite:J}=Fn(l,a),{month:me,error:P}=Il(l,c,h),D=n.get("error"),[I,N]=C.useState(D),O=C.useRef(!1);C.useEffect(()=>{D&&(n.delete("error"),i(n,{replace:!0}))},[D,n,i]),C.useEffect(()=>{if(!P)return;const U=P.message||"";if(U.includes("months in the future")||U.includes("Refusing to create month")){const G=new Date;let K=G.getFullYear(),te=G.getMonth()+1+3;for(;te>12;)te-=12,K+=1;const he=`Cannot navigate to ${c}/${h} - redirected to ${K}/${te}`;e(`/budget/${K}/${te}/${m}?error=${encodeURIComponent(he)}`,{replace:!0});return}if(U.includes("months in the past")){const G=new Date;let K=G.getFullYear(),te=G.getMonth()+1-3;for(;te<1;)te+=12,K-=1;const he=`Cannot create month ${c}/${h} - redirected to ${K}/${te}`;e(`/budget/${K}/${te}/${m}?error=${encodeURIComponent(he)}`,{replace:!0})}},[P,c,h,m,e]);const[k,R]=C.useState(()=>{const{tab:U}=Up(t);return U??m}),[ae,q]=C.useState(()=>{const{view:U}=Up(t);return U??g}),V=U=>{R(U),b(U)},Q=U=>{q(U),w(U)};C.useEffect(()=>{if(O.current)return;const{year:U,month:G}=Up(t);U&&_(U),G&&v(G),O.current=!0},[t,_,v]),C.useEffect(()=>{if(!O.current)return;const U=k==="balances"?`/${ae}`:"",G=`/budget/${c}/${h}/${k}${U}`,K=`/budget/${t.year}/${t.month}/${t.tab}${t.view?`/${t.view}`:""}`;G!==K&&e(G,{replace:!0})},[c,h,k,ae,e,t]);async function W(U){try{await J(U)}catch(G){N(G instanceof Error?G.message:"Failed to accept invite")}}async function de(U){try{await ee(U||"My Budget")}catch(G){N(G instanceof Error?G.message:"Failed to create budget")}}if(!z&&M)return d.jsxs(Gc,{children:[d.jsx(_i,{title:"Budget",showBackArrow:!0,hideMenu:!0}),d.jsx(I4,{invites:F,onAccept:W,onCreateNew:de})]});if(!z&&H)return d.jsxs(Gc,{children:[d.jsx(_i,{title:"Budget",showBackArrow:!0,hideMenu:!0}),d.jsx(D4,{onCreateNew:de})]});function ne(){N(null),A()}function B(){N(null),S()}return d.jsxs(Gc,{children:[d.jsx(_i,{title:z?.name||"Budget"}),d.jsxs(aT,{children:[I&&d.jsx(Ka,{message:I,onDismiss:()=>N(null)}),d.jsx(P4,{onPreviousMonth:ne,onNextMonth:B}),d.jsx(j4,{activeTab:k,setActiveTab:V,allocationsFinalized:me?.are_allocations_finalized}),k==="income"&&d.jsx(F4,{},`${c}-${h}`),k==="balances"&&d.jsx(rP,{currentView:ae,onViewChange:Q},`${c}-${h}`),k==="spend"&&d.jsx(G4,{},`${c}-${h}`)]})]})}function aP(){return d.jsxs(Gc,{children:[d.jsx(_i,{title:"Analytics"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[d.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),d.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),d.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),d.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),d.jsx(Tt,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:ce.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})]})}function Bh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,accountGroups:a,showGroupSelector:l=!1,showIncomeSettings:c=!1,hasExistingIncomeDefault:h=!1,hasExistingOutgoDefault:m=!1,currentGroupId:g}){const[_,v]=C.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),b=_.account_group_id||g,w=b?a.find(z=>z.id===b):null,A=w?.is_active!==void 0,S=w?.on_budget!==void 0;function M(z){z.preventDefault(),_.nickname.trim()&&e(_)}function F(z){v({..._,is_income_account:z,is_income_default:z?_.is_income_default:!1})}function H(z){v({..._,is_outgo_account:z,is_outgo_default:z?_.is_outgo_default:!1})}return d.jsxs(Ba,{actionName:i==="Create Account"?"Create Account":"Update Account",onSubmit:M,children:[d.jsx(Kt,{label:"Account Nickname",htmlFor:"account-nickname",children:d.jsx(Fa,{id:"account-nickname",type:"text",value:_.nickname,onChange:z=>v({..._,nickname:z.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&d.jsx(Kt,{label:"Account Type",htmlFor:"account-group",children:d.jsxs(nu,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:z=>v({..._,account_group_id:z.target.value==="ungrouped"?null:z.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Ungrouped"}),a.map(z=>d.jsx("option",{value:z.id,children:z.name},z.id))]})}),c&&d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(Ms,{id:"is-active",checked:A?w.is_active:_.is_active!==!1,onChange:z=>v({..._,is_active:z.target.checked}),disabled:A,children:d.jsx("span",{style:{opacity:A?.5:1},children:"Active account"})}),A&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ce.warning},children:['Set by account type "',w.name,'"']})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(Ms,{id:"on-budget",checked:S?w.on_budget:_.on_budget!==!1,onChange:z=>v({..._,on_budget:z.target.checked}),disabled:S,children:d.jsx("span",{style:{opacity:S?.5:1},children:"On budget (affects budget totals)"})}),S&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ce.warning},children:['Set by account type "',w.name,'"']})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),d.jsx(Ms,{id:"is-income-account",checked:_.is_income_account||!1,onChange:z=>F(z.target.checked),children:"Show in income deposit list"}),_.is_income_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(Ms,{id:"is-income-default",checked:_.is_income_default||!1,onChange:z=>v({..._,is_income_default:z.target.checked}),disabled:h&&!t?.is_income_default,children:"Default account for new income"}),h&&!t?.is_income_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),d.jsx(Ms,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:z=>H(z.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(Ms,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:z=>v({..._,is_outgo_default:z.target.checked}),disabled:m&&!t?.is_outgo_default,children:"Default account for new expenses"}),m&&!t?.is_outgo_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),d.jsxs(Ya,{children:[d.jsx(Me,{type:"submit",actionName:i,children:i}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Account Form",onClick:n,children:"Cancel"})]})]})}function LE({label:t,value:e,onChange:n,trueLabel:i,falseLabel:a,undefinedLabel:l}){function c(){n(e===void 0?!0:e===!0?!1:void 0)}const h=e===!0?i:e===!1?a:l,m=e===!0?ce.success:e===!1?ce.warning:"inherit",g=e===!0?"":e===!1?"":"";return d.jsxs("button",{type:"button",onClick:c,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${m} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${m} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[d.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?m:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:g}),d.jsxs("span",{style:{flex:1},children:[d.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",d.jsx("span",{style:{fontWeight:500,color:m},children:h})]}),d.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function _T({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=C.useState(t||{name:"",expected_balance:"positive"});function c(h){h.preventDefault(),a.name.trim()&&e(a)}return d.jsxs(Ba,{actionName:i==="Create Account Type"?"Create Account Type":"Update Account Type",onSubmit:c,children:[d.jsx(Kt,{label:"Account Type Name",htmlFor:"group-name",children:d.jsx(Fa,{id:"group-name",type:"text",value:a.name,onChange:h=>l({...a,name:h.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),d.jsx(Kt,{label:"Expected Balance",htmlFor:"expected-balance",children:d.jsxs(nu,{id:"expected-balance",value:a.expected_balance,onChange:h=>l({...a,expected_balance:h.target.value}),children:[d.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),d.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),d.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",d.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),d.jsx(LE,{label:"Active status",value:a.is_active,onChange:h=>l({...a,is_active:h}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),d.jsx(LE,{label:"Budget status",value:a.on_budget,onChange:h=>l({...a,on_budget:h}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),d.jsxs(Ya,{children:[d.jsx(Me,{type:"submit",actionName:i,children:i}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Account Type Form",onClick:n,children:"Cancel"})]})]})}function Bo({icon:t,label:e,variant:n,title:i}){const l={success:{background:`color-mix(in srgb, ${ce.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.success} 40%, transparent)`,color:ce.success,opacity:1},warning:{background:`color-mix(in srgb, ${ce.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.warning} 35%, transparent)`,color:ce.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${ce.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.success} 25%, transparent)`,color:ce.success,opacity:.7},expense:{background:`color-mix(in srgb, ${ce.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.warning} 25%, transparent)`,color:ce.warning,opacity:.7}}[n];return d.jsxs("span",{title:i||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[d.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function vT({account:t,accountGroups:e}){const n=[],i=t.account_group_id?e.find(c=>c.id===t.account_group_id):null,a=i?.is_active!==void 0?i.is_active:t.is_active!==!1,l=i?.on_budget!==void 0?i.on_budget:t.on_budget!==!1;if(!a){const c=i?.is_active!==void 0;n.push(d.jsx(Bo,{icon:"",label:c?"Inactive (type)":"Inactive",variant:"warning",title:c?`Set by "${i.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const c=i?.on_budget!==void 0;n.push(d.jsx(Bo,{icon:"",label:c?"Off Budget (type)":"Off Budget",variant:"warning",title:c?`Set by "${i.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(d.jsx(Bo,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(d.jsx(Bo,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(d.jsx(Bo,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(d.jsx(Bo,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:d.jsx(d.Fragment,{children:n})}function oP({group:t}){const e=[];return t.is_active===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.warning} 20%, transparent)`,color:ce.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.success} 20%, transparent)`,color:ce.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.warning} 20%, transparent)`,color:ce.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.success} 20%, transparent)`,color:ce.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:d.jsx(d.Fragment,{children:e})}function bT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function lP(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function cP(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function uP({group:t,groupIndex:e,totalGroups:n,accounts:i,allGroups:a,allAccounts:l,editingAccountId:c,editingGroupId:h,createForGroupId:m,setEditingAccountId:g,setEditingGroupId:_,setCreateForGroupId:v,dragType:b,draggedId:w,dragOverId:A,dragOverGroupId:S,setDragOverId:M,setDragOverGroupId:F,onAccountDragStart:H,onAccountDragOver:z,onAccountDrop:ee,onGroupDragStart:J,onGroupDragOver:me,onGroupDrop:P,onDragLeave:D,onDragLeaveGroup:I,onDragEnd:N,onDropOnGroup:O,onCreateAccount:k,onUpdateAccount:R,onDeleteAccount:ae,onMoveAccount:q,onUpdateGroup:V,onDeleteGroup:Q,onMoveGroup:W}){const de=Xa(),ne=[...i].sort((Y,Se)=>Y.sort_order-Se.sort_order),B=b==="group"&&w===t.id,U=b==="group"&&A===t.id,G=b==="account"&&S===t.id,te=(w&&b==="account"?l[w]:null)&&Object.entries(l).find(([Y])=>Y===w)?.[1]&&Object.entries(l).find(([Y])=>Y===w)?.[1]?.account_group_id!==t.id,he=b==="group"&&U&&w!==t.id,be=e>0,xe=e<n-1,oe=ne.reduce((Y,Se)=>Y+Se.balance,0);return d.jsxs("div",{children:[b==="group"&&!B&&d.jsxs("div",{onDragOver:Y=>{Y.preventDefault(),M(t.id)},onDragLeave:D,onDrop:Y=>P(Y,t.id),style:{position:"relative",height:he?"2.5rem":"0.5rem",marginBottom:he?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:he?1:0,transition:"opacity 0.15s",boxShadow:he?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),he&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{draggable:h!==t.id,onDragStart:Y=>J(Y,t.id),onDragOver:Y=>me(Y,t.id),onDragLeave:I,onDragEnd:N,onDrop:Y=>O(Y,t.id),style:{background:B?"color-mix(in srgb, currentColor 3%, transparent)":G&&te?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:B?.5:1,border:G&&te?`2px dashed ${ce.primary}`:"2px solid transparent",cursor:h===t.id?"default":"grab",transition:"all 0.15s"},children:h===t.id?d.jsx(_T,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:Y=>V(t.id,Y),onCancel:()=>_(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsx(dP,{group:t,accountCount:ne.length,groupTotal:oe,canMoveUp:be,canMoveDown:xe,isMobile:de,createForGroupId:m,onEdit:()=>_(t.id),onDelete:()=>Q(t.id),onMoveUp:()=>W(t.id,"up"),onMoveDown:()=>W(t.id,"down"),onAddAccount:()=>v(t.id)}),de&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Me,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:()=>v(t.id),disabled:m!==null,children:"+ Account"})}),d.jsxs("div",{style:ul,children:[ne.map((Y,Se)=>c===Y.id?d.jsx(Bh,{initialData:{nickname:Y.nickname,account_group_id:Y.account_group_id,is_income_account:Y.is_income_account,is_income_default:Y.is_income_default,is_outgo_account:Y.is_outgo_account,is_outgo_default:Y.is_outgo_default,on_budget:Y.on_budget,is_active:Y.is_active},onSubmit:Re=>R(Y.id,Re),onCancel:()=>g(null),submitLabel:"Save",accountGroups:a,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:Y.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([Re,Ge])=>Ge.is_income_default&&Re!==Y.id),hasExistingOutgoDefault:Object.entries(l).some(([Re,Ge])=>Ge.is_outgo_default&&Re!==Y.id)},Y.id):d.jsx(_f,{isDragging:b==="account"&&w===Y.id,isDragOver:A===Y.id,onDragStart:Re=>{Re.stopPropagation(),H(Re,Y.id)},onDragOver:Re=>z(Re,Y.id,t.id),onDragLeave:D,onDragEnd:N,onDrop:Re=>ee(Re,Y.id,t.id),onEdit:()=>{Y.nickname,g(Y.id)},onDelete:()=>{Y.nickname,ae(Y.id)},onMoveUp:()=>q(Y.id,"up"),onMoveDown:()=>q(Y.id,"down"),canMoveUp:Se>0,canMoveDown:Se<ne.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Ly,children:Y.nickname}),d.jsx(vT,{account:Y,accountGroups:a})]}),d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:bn(Y.balance)},children:[Ce(Y.balance),lP(Y.balance,t.expected_balance)&&d.jsx("span",{title:cP(Y.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},Y.id)),ne.length===0&&!m&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),b==="account"&&ne.length>0&&d.jsx(bT,{groupId:t.id,isActive:A===`__end__${t.id}`,onDragOver:Y=>{Y.preventDefault(),Y.stopPropagation(),M(`__end__${t.id}`),F(t.id)},onDragLeave:Y=>{Y.stopPropagation(),M(null)},onDrop:Y=>{Y.stopPropagation(),ee(Y,"__group_end__",t.id)}}),m===t.id&&d.jsx(Bh,{initialData:{nickname:"",account_group_id:t.id},onSubmit:Y=>k(Y,t.id),onCancel:()=>v(null),submitLabel:"Create",accountGroups:a,showIncomeSettings:!0,currentGroupId:t.id})]}),m!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Me,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:()=>v(t.id),disabled:m!==null,children:"+ Add Account"})})]})})]})}function dP({group:t,accountCount:e,groupTotal:n,canMoveUp:i,canMoveDown:a,isMobile:l,createForGroupId:c,onEdit:h,onDelete:m,onMoveUp:g,onMoveDown:_,onAddAccount:v}){return d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{...Dl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&d.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:bn(n),flexShrink:0},children:Ce(n)}),d.jsx(oP,{group:t})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&d.jsx(Me,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:v,disabled:c!==null,children:"+ Account"}),d.jsx("button",{onClick:()=>{t.name,h()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),d.jsx("button",{onClick:()=>{t.name,m()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),d.jsxs("div",{style:Py,children:[d.jsx("button",{onClick:g,disabled:!i,style:{...cl,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:_,disabled:!a,style:{...cl,opacity:a?.6:.2,cursor:a?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function hP({accounts:t,allGroups:e,allAccounts:n,hasGroups:i,editingAccountId:a,createForGroupId:l,setEditingAccountId:c,setCreateForGroupId:h,dragType:m,draggedId:g,dragOverId:_,dragOverGroupId:v,setDragOverId:b,setDragOverGroupId:w,onAccountDragStart:A,onAccountDragOver:S,onAccountDrop:M,onDragOverGroup:F,onDropOnGroup:H,onDragLeave:z,onDragLeaveGroup:ee,onDragEnd:J,onCreateAccount:me,onUpdateAccount:P,onDeleteAccount:D,onMoveAccount:I}){const N=[...t].sort((q,V)=>q.sort_order-V.sort_order),O=m==="account"&&v==="ungrouped",R=(g&&m==="account"?n[g]:null)&&Object.entries(n).find(([q])=>q===g)?.[1]&&Object.entries(n).find(([q])=>q===g)?.[1]?.account_group_id!==null;if(N.length===0&&!l&&i&&m!=="account")return null;const ae=N.reduce((q,V)=>q+V.balance,0);return d.jsxs("div",{onDragOver:q=>F(q,"ungrouped"),onDragLeave:ee,onDrop:q=>H(q,"ungrouped"),style:{background:O&&R?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:O&&R?`2px dashed ${ce.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Dl,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",N.length,")"]}),N.length>0&&d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:bn(ae)},children:Ce(ae)})]}),d.jsx(Me,{variant:"small",actionName:"Open Add Account Form (Ungrouped)",onClick:()=>h("ungrouped"),disabled:l!==null,children:"+ Account"})]}),d.jsxs("div",{style:ul,children:[N.map((q,V)=>a===q.id?d.jsx(Bh,{initialData:{nickname:q.nickname,account_group_id:q.account_group_id,is_income_account:q.is_income_account,is_income_default:q.is_income_default,is_outgo_account:q.is_outgo_account,is_outgo_default:q.is_outgo_default,on_budget:q.on_budget,is_active:q.is_active},onSubmit:Q=>P(q.id,Q),onCancel:()=>c(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([Q,W])=>W.is_income_default&&Q!==q.id),hasExistingOutgoDefault:Object.entries(n).some(([Q,W])=>W.is_outgo_default&&Q!==q.id)},q.id):d.jsx(_f,{isDragging:m==="account"&&g===q.id,isDragOver:_===q.id,onDragStart:Q=>A(Q,q.id),onDragOver:Q=>S(Q,q.id,"ungrouped"),onDragLeave:z,onDragEnd:J,onDrop:Q=>M(Q,q.id,"ungrouped"),onEdit:()=>{q.nickname,c(q.id)},onDelete:()=>{q.nickname,D(q.id)},onMoveUp:()=>I(q.id,"up"),onMoveDown:()=>I(q.id,"down"),canMoveUp:V>0,canMoveDown:V<N.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Ly,children:q.nickname}),d.jsx(vT,{account:q,accountGroups:e})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:bn(q.balance)},children:Ce(q.balance)})]})},q.id)),N.length===0&&m==="account"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),m==="account"&&N.length>0&&d.jsx(bT,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:q=>{q.preventDefault(),q.stopPropagation(),b("__end__ungrouped"),w("ungrouped")},onDragLeave:q=>{q.stopPropagation(),b(null)},onDrop:q=>{q.stopPropagation(),M(q,"__group_end__","ungrouped")}}),l==="ungrouped"&&d.jsx(Bh,{initialData:{nickname:"",account_group_id:null},onSubmit:q=>me(q,"ungrouped"),onCancel:()=>h(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Me,{variant:"small",actionName:"Open Add Account Form (Ungrouped)",onClick:()=>h("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function fP(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:i,error:a,setError:l,handleCreateAccount:c,handleUpdateAccount:h,handleDeleteAccount:m,handleMoveAccount:g,handleCreateGroup:_,handleUpdateGroup:v,handleDeleteGroup:b,handleMoveGroup:w,reorderAccountsInGroup:A,reorderGroups:S}=p4(),M=Xa(),[F,H]=C.useState(null),[z,ee]=C.useState(null),[J,me]=C.useState(null),[P,D]=C.useState(!1),[I,N]=C.useState(null),[O,k]=C.useState(null),[R,ae]=C.useState(null),[q,V]=C.useState(null);function Q(oe,Y){N("account"),k(Y),oe.dataTransfer.effectAllowed="move"}function W(oe,Y,Se){oe.preventDefault(),I==="account"&&(Y!==O&&ae(Y),V(Se))}function de(oe,Y){oe.preventDefault(),I==="account"?(V(Y),ae(null)):I==="group"&&Y!==O&&ae(Y)}function ne(){ae(null)}function B(){V(null)}function U(){N(null),k(null),ae(null),V(null)}async function G(oe,Y,Se){if(oe.preventDefault(),oe.stopPropagation(),!O||I!=="account"){U();return}await A(O,Y,Se),U()}async function K(oe,Y){oe.preventDefault(),I==="account"?await G(oe,"__group_end__",Y):I==="group"&&await he(oe,Y)}function te(oe,Y){oe.stopPropagation(),N("group"),k(Y),oe.dataTransfer.effectAllowed="move"}async function he(oe,Y){if(oe.preventDefault(),!O||I!=="group"||O===Y){U();return}await S(O,Y),U()}const be=C.useMemo(()=>{const oe=Object.values(t),Y=oe.reduce((Ge,Be)=>Ge+(Be.balance??0),0);let Se=0,Re=0;for(const Ge of oe){const Be=n.find(Cn=>Cn.id===Ge.account_group_id);Ge.on_budget===!0||Ge.on_budget===void 0&&Be?.on_budget!==!1?Se+=Ge.balance??0:Re+=Ge.balance??0}return{count:oe.length,groupCount:n.length,totalBalance:Y,onBudgetTotal:Se,offBudgetTotal:Re}},[t,n]);if(!i)return d.jsx("p",{children:"No budget found. Please log in."});const xe=e.ungrouped||[];return d.jsxs("div",{children:[a&&d.jsx(Ka,{message:a,onDismiss:()=>l(null)}),d.jsx("div",{style:{position:"sticky",top:0,zIndex:50,backgroundColor:"#242424",marginLeft:"calc(-1 * var(--page-padding, 2rem))",marginRight:"calc(-1 * var(--page-padding, 2rem))",paddingLeft:"var(--page-padding, 2rem)",paddingRight:"var(--page-padding, 2rem)",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"1px solid rgba(255,255,255,0.15)"},children:d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[d.jsx("span",{style:{fontWeight:600},children:"Accounts:"}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"On-Budget: "}),d.jsx("span",{style:{color:bn(be.onBudgetTotal),fontWeight:600},children:Ce(be.onBudgetTotal)})]}),be.offBudgetTotal!==0&&d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Off-Budget: "}),d.jsx("span",{style:{fontWeight:600,opacity:.7},children:Ce(be.offBudgetTotal)})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Total: "}),d.jsx("span",{style:{color:bn(be.totalBalance),fontWeight:600},children:Ce(be.totalBalance)})]}),d.jsx("span",{style:{opacity:.5,fontSize:"0.8rem"},children:M?"Drag to move.":"Drag between types or use  to reorder."})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:d.jsx(Fy,{})})]})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem",paddingTop:"1rem"},children:[Object.keys(t).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((oe,Y)=>d.jsx(uP,{group:oe,groupIndex:Y,totalGroups:n.length,accounts:e[oe.id]||[],allGroups:n,allAccounts:t,editingAccountId:F,editingGroupId:J,createForGroupId:z,setEditingAccountId:H,setEditingGroupId:me,setCreateForGroupId:ee,dragType:I,draggedId:O,dragOverId:R,dragOverGroupId:q,setDragOverId:ae,setDragOverGroupId:V,onAccountDragStart:Q,onAccountDragOver:W,onAccountDrop:G,onGroupDragStart:te,onGroupDragOver:de,onGroupDrop:he,onDragLeave:ne,onDragLeaveGroup:B,onDragEnd:U,onDropOnGroup:K,onCreateAccount:c,onUpdateAccount:(Se,Re)=>{h(Se,Re),H(null)},onDeleteAccount:m,onMoveAccount:g,onUpdateGroup:(Se,Re)=>{v(Se,Re),me(null)},onDeleteGroup:b,onMoveGroup:w},oe.id)),I==="group"&&n.length>0&&d.jsx(zy,{isActive:R==="__end__",onDragOver:oe=>{oe.preventDefault(),ae("__end__")},onDragLeave:ne,onDrop:oe=>he(oe,"__end__"),label:"Move account type to end"}),d.jsx(hP,{accounts:xe,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:F,createForGroupId:z,setEditingAccountId:H,setCreateForGroupId:ee,dragType:I,draggedId:O,dragOverId:R,dragOverGroupId:q,setDragOverId:ae,setDragOverGroupId:V,onAccountDragStart:Q,onAccountDragOver:W,onAccountDrop:G,onDragOverGroup:de,onDropOnGroup:K,onDragLeave:ne,onDragLeaveGroup:B,onDragEnd:U,onCreateAccount:c,onUpdateAccount:(oe,Y)=>{h(oe,Y),H(null)},onDeleteAccount:m,onMoveAccount:g})]}),P?d.jsx(_T,{onSubmit:oe=>{_(oe),D(!1)},onCancel:()=>D(!1),submitLabel:"Create Account Type"}):d.jsx(Me,{variant:"primary-large",actionName:"Open Add Account Type Form",onClick:()=>D(!0),children:"+ Add Account Type"})]})}function Fh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,categoryGroups:a=[],showGroupSelector:l=!1}){const[c,h]=C.useState(t||{name:"",category_group_id:null}),[m,g]=C.useState(t?.default_monthly_amount?.toString()||""),[_,v]=C.useState(t?.default_monthly_type||"fixed"),[b,w]=C.useState(!1);function A(S){if(S.preventDefault(),!c.name.trim())return;w(!0);const M=parseFloat(m),F=!isNaN(M)&&M>0;e({...c,description:c.description?.trim()||void 0,default_monthly_amount:F?M:void 0,default_monthly_type:F?_:void 0})}return d.jsxs(Ba,{actionName:i==="Create"?"Create Category":"Update Category",onSubmit:A,children:[d.jsx(Kt,{label:"Category Name",htmlFor:"category-name",children:d.jsx(Fa,{id:"category-name",type:"text",value:c.name,onChange:S=>h({...c,name:S.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),d.jsx(Kt,{label:"Description (optional)",htmlFor:"category-description",children:d.jsx(Vy,{id:"category-description",value:c.description||"",onChange:S=>h({...c,description:S.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&d.jsx(Kt,{label:"Category Group",htmlFor:"category-group",children:d.jsxs(nu,{id:"category-group",value:c.category_group_id||"ungrouped",onChange:S=>h({...c,category_group_id:S.target.value==="ungrouped"?null:S.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Uncategorized"}),a.map(S=>d.jsx("option",{value:S.id,children:S.name},S.id))]})}),d.jsxs(Kt,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[d.jsxs(nu,{id:"default-type",value:_,onChange:S=>v(S.target.value),style:{width:"auto",flex:"0 0 auto"},children:[d.jsx("option",{value:"fixed",children:"Fixed $"}),d.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?d.jsx(Tg,{id:"default-amount",value:m,onChange:g,placeholder:"$0.00"}):d.jsx(Fa,{id:"default-amount",type:"number",value:m,onChange:S=>g(S.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&d.jsx("span",{style:{opacity:.6},children:"%"})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),d.jsxs(Ya,{children:[d.jsx(Me,{type:"submit",actionName:i==="Create"?"Create Category":"Save Category",isLoading:b,children:i}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Category Form",onClick:n,children:"Cancel"})]})]})}function xT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=C.useState(t||{name:""}),[c,h]=C.useState(!1);function m(g){g.preventDefault(),a.name.trim()&&(h(!0),e(a))}return d.jsxs(Ba,{actionName:i==="Create Group"?"Create Category Group":"Update Category Group",onSubmit:m,children:[d.jsx(Kt,{label:"Group Name",htmlFor:"group-name",children:d.jsx(Fa,{id:"group-name",type:"text",value:a.name,onChange:g=>l({...a,name:g.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),d.jsxs(Ya,{children:[d.jsx(Me,{type:"submit",actionName:i==="Create Group"?"Create Category Group":"Save Category Group",isLoading:c,children:i}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Category Group Form",onClick:n,children:"Cancel"})]})]})}function ET({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function mP({group:t,groupIndex:e,groupCategories:n,sortedGroups:i,categoryGroups:a,categoryBalances:l,loadingBalances:c,dragType:h,draggedId:m,dragOverId:g,dragOverGroupId:_,editingCategoryId:v,setEditingCategoryId:b,createForGroupId:w,setCreateForGroupId:A,editingGroupId:S,setEditingGroupId:M,handleCreateCategory:F,handleUpdateCategory:H,handleDeleteCategory:z,handleMoveCategory:ee,handleUpdateGroup:J,handleDeleteGroup:me,handleMoveGroup:P,handleCategoryDragStart:D,handleCategoryDragOver:I,handleDragOverGroup:N,handleDragLeave:O,handleDragLeaveGroup:k,handleDragEnd:R,handleCategoryDrop:ae,handleDropOnGroup:q,handleGroupDragStart:V,handleGroupDrop:Q,setDragOverId:W,setDragOverGroupId:de,isMobile:ne,categories:B}){const U=h==="group"&&m===t.id,G=h==="group"&&g===t.id,K=h==="category"&&_===t.id,te=m&&h==="category"?B[m]:null,he=te&&(te.category_group_id||"ungrouped")!==t.id,be=h==="group"&&G&&m!==t.id,xe=e>0,oe=e<i.length-1;return d.jsxs("div",{children:[h==="group"&&!U&&d.jsxs("div",{onDragOver:Y=>{Y.preventDefault(),W(t.id)},onDragLeave:O,onDrop:Y=>Q(Y,t.id),style:{position:"relative",height:be?"2.5rem":"0.5rem",marginBottom:be?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:be?1:0,transition:"opacity 0.15s",boxShadow:be?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),be&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{onDragOver:Y=>N(Y,t.id),onDragLeave:k,onDrop:Y=>q(Y,t.id),style:{background:U?"color-mix(in srgb, currentColor 3%, transparent)":K&&he?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:U?.5:1,border:K&&he?`2px dashed ${ce.primary}`:"2px solid transparent",transition:"all 0.15s"},children:S===t.id?d.jsx(xT,{initialData:{name:t.name},onSubmit:Y=>J(t.id,Y),onCancel:()=>M(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:ne?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:ne?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{...Dl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!ne&&d.jsx("span",{draggable:!0,onDragStart:Y=>V(Y,t.id),onDragEnd:R,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",n.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!ne&&d.jsx(Me,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>A(t.id),disabled:w!==null,children:"+ Category"}),d.jsx("button",{onClick:()=>{t.name,M(t.id)},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),d.jsx("button",{onClick:()=>{t.name,me(t.id)},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),d.jsxs("div",{style:Py,children:[d.jsx("button",{onClick:()=>P(t.id,"up"),disabled:!xe,style:{...cl,opacity:xe?.6:.2,cursor:xe?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),d.jsx("button",{onClick:()=>P(t.id,"down"),disabled:!oe,style:{...cl,opacity:oe?.6:.2,cursor:oe?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),ne&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Me,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>A(t.id),disabled:w!==null,children:"+ Category"})}),d.jsxs("div",{style:ul,children:[n.map(([Y,Se])=>v===Y?d.jsx(Fh,{initialData:{name:Se.name,description:Se.description,category_group_id:Se.category_group_id,default_monthly_amount:Se.default_monthly_amount,default_monthly_type:Se.default_monthly_type},onSubmit:Re=>H(Y,Re),onCancel:()=>b(null),submitLabel:"Save",categoryGroups:a,showGroupSelector:!0},Y):d.jsx(_f,{isDragging:h==="category"&&m===Y,isDragOver:g===Y,onDragStart:Re=>{Re.stopPropagation(),D(Re,Y)},onDragOver:Re=>I(Re,Y,t.id),onDragLeave:O,onDragEnd:R,onDrop:Re=>ae(Re,Y,t.id),onEdit:()=>{Se.name,b(Y)},onDelete:()=>{Se.name,z(Y)},onMoveUp:()=>ee(Y,"up"),onMoveDown:()=>ee(Y,"down"),canMoveUp:n.findIndex(([Re])=>Re===Y)>0,canMoveDown:n.findIndex(([Re])=>Re===Y)<n.length-1,children:d.jsx(wT,{category:Se,catId:Y,categoryBalances:l,loadingBalances:c})},Y)),n.length===0&&!w&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),h==="category"&&n.length>0&&d.jsx(ET,{groupId:t.id,isActive:g===`__end__${t.id}`,onDragOver:Y=>{Y.preventDefault(),Y.stopPropagation(),W(`__end__${t.id}`),de(t.id)},onDragLeave:Y=>{Y.stopPropagation(),W(null)},onDrop:Y=>{Y.stopPropagation(),ae(Y,"__group_end__",t.id)}}),w===t.id&&d.jsx(Fh,{initialData:{name:"",category_group_id:t.id},onSubmit:Y=>F(Y,t.id),onCancel:()=>A(null),submitLabel:"Create",categoryGroups:a})]}),w!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Me,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>A(t.id),disabled:w!==null,children:"+ Add Category"})})]})})]})}function wT({category:t,catId:e,categoryBalances:n,loadingBalances:i}){const a=n[e]||{current:0,total:0};return d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Ly,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?d.jsxs(d.Fragment,{children:[d.jsxs("span",{style:{color:ce.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{style:{color:ce.success,fontWeight:500},children:Ce(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),d.jsxs("div",{style:{marginTop:"0.25rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:qa(a.current)},children:[i?"...":Ce(a.current),d.jsx("span",{style:{fontSize:"0.75rem",fontWeight:400,opacity:.6,marginLeft:"0.35rem"},children:"available now"})]}),d.jsxs("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.85rem",fontWeight:500,color:qa(a.total),opacity:.75},children:[i?"...":Ce(a.total),d.jsx("span",{style:{fontSize:"0.7rem",fontWeight:400,opacity:.7,marginLeft:"0.35rem"},children:"total allocated"})]})]})]})}function pP({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:i,dragType:a,draggedId:l,dragOverId:c,dragOverGroupId:h,editingCategoryId:m,setEditingCategoryId:g,createForGroupId:_,setCreateForGroupId:v,handleCreateCategory:b,handleUpdateCategory:w,handleDeleteCategory:A,handleMoveCategory:S,handleCategoryDragStart:M,handleCategoryDragOver:F,handleDragOverGroup:H,handleDragLeaveGroup:z,handleDragLeave:ee,handleDragEnd:J,handleCategoryDrop:me,handleDropOnGroup:P,setDragOverId:D,setDragOverGroupId:I,categories:N,hasGroups:O}){const k=a==="category"&&h==="ungrouped",R=l&&a==="category"?N[l]:null,ae=R&&R.category_group_id!==null;return t.length===0&&!_&&O&&a!=="category"?null:d.jsxs("div",{onDragOver:q=>H(q,"ungrouped"),onDragLeave:z,onDrop:q=>P(q,"ungrouped"),style:{background:k&&ae?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:k&&ae?`2px dashed ${ce.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Dl,margin:0,opacity:.7},children:["Uncategorized",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),d.jsx(Me,{variant:"small",actionName:"Open Add Category Form (Uncategorized)",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Category"})]}),d.jsxs("div",{style:ul,children:[t.map(([q,V])=>m===q?d.jsx(Fh,{initialData:{name:V.name,description:V.description,category_group_id:V.category_group_id,default_monthly_amount:V.default_monthly_amount,default_monthly_type:V.default_monthly_type},onSubmit:Q=>w(q,Q),onCancel:()=>g(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},q):d.jsx(_f,{isDragging:a==="category"&&l===q,isDragOver:c===q,onDragStart:Q=>M(Q,q),onDragOver:Q=>F(Q,q,"ungrouped"),onDragLeave:ee,onDragEnd:J,onDrop:Q=>me(Q,q,"ungrouped"),onEdit:()=>{V.name,g(q)},onDelete:()=>{V.name,A(q)},onMoveUp:()=>S(q,"up"),onMoveDown:()=>S(q,"down"),canMoveUp:t.findIndex(([Q])=>Q===q)>0,canMoveDown:t.findIndex(([Q])=>Q===q)<t.length-1,children:d.jsx(wT,{category:V,catId:q,categoryBalances:n,loadingBalances:i})},q)),t.length===0&&a==="category"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),a==="category"&&t.length>0&&d.jsx(ET,{groupId:"ungrouped",isActive:c==="__end__ungrouped",onDragOver:q=>{q.preventDefault(),q.stopPropagation(),D("__end__ungrouped"),I("ungrouped")},onDragLeave:q=>{q.stopPropagation(),D(null)},onDrop:q=>{q.stopPropagation(),me(q,"__group_end__","ungrouped")}}),_==="ungrouped"&&d.jsx(Fh,{initialData:{name:"",category_group_id:null},onSubmit:q=>b(q,"ungrouped"),onCancel:()=>v(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Me,{variant:"small",actionName:"Open Add Category Form (Uncategorized)",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function gP(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:i,sortedGroups:a,categoryBalances:l,isLoading:c,loadingBalances:h,error:m,setError:g,getOnBudgetTotal:_,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:w,handleMoveCategory:A,handleCreateGroup:S,handleUpdateGroup:M,handleDeleteGroup:F,handleMoveGroup:H,dragType:z,draggedId:ee,dragOverId:J,dragOverGroupId:me,setDragOverId:P,setDragOverGroupId:D,handleCategoryDragStart:I,handleCategoryDragOver:N,handleDragOverGroup:O,handleDragLeave:k,handleDragLeaveGroup:R,handleDragEnd:ae,handleCategoryDrop:q,handleDropOnGroup:V,handleGroupDragStart:Q,handleGroupDrop:W}=v4(),de=Xa(),{addLoadingHold:ne,removeLoadingHold:B}=Bn();C.useEffect(()=>(c?ne("categories","Loading categories..."):B("categories"),()=>B("categories")),[c,ne,B]);const[U,G]=C.useState(null),[K,te]=C.useState(null),[he,be]=C.useState(null),[xe,oe]=C.useState(!1);if(!t)return d.jsx("p",{children:"No budget found. Please log in."});const Y=Object.values(l).reduce((Be,yt)=>Be+yt.current,0),Se=Object.values(l).reduce((Be,yt)=>Be+yt.total,0),Re=_()-Y,Ge=Math.abs(Se-Y)>.01;return c?null:d.jsxs("div",{children:[m&&d.jsx(Ka,{message:m,onDismiss:()=>g(null)}),d.jsx("div",{style:{position:"sticky",top:0,zIndex:50,backgroundColor:"#242424",marginLeft:"calc(-1 * var(--page-padding, 2rem))",marginRight:"calc(-1 * var(--page-padding, 2rem))",paddingLeft:"var(--page-padding, 2rem)",paddingRight:"var(--page-padding, 2rem)",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"1px solid rgba(255,255,255,0.15)"},children:d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[d.jsx("span",{style:{fontWeight:600},children:"Categories:"}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"On-Budget: "}),d.jsx("span",{style:{color:bn(_()),fontWeight:600},children:Ce(_())})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Allocated: "}),d.jsx("span",{style:{color:ce.primary,fontWeight:600},children:h?"...":Ce(Y)}),Ge&&d.jsxs("span",{style:{opacity:.5,fontSize:"0.8rem"},children:[" (",Ce(Se)," total)"]})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Available: "}),d.jsx("span",{style:{color:bn(Re),fontWeight:600},children:h?"...":Ce(Re)})]}),d.jsx("span",{style:{opacity:.6},children:de?"Drag to move between groups.":"Drag categories between groups, or use  to reorder."})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:d.jsx(Fy,{})})]})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem",paddingTop:"1rem"},children:[Object.keys(e).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),a.map((Be,yt)=>{const Cn=(i[Be.id]||[]).sort((dn,sr)=>dn[1].sort_order-sr[1].sort_order);return d.jsx(mP,{group:Be,groupIndex:yt,groupCategories:Cn,sortedGroups:a,categoryGroups:n,categoryBalances:l,loadingBalances:h,dragType:z,draggedId:ee,dragOverId:J,dragOverGroupId:me,editingCategoryId:U,setEditingCategoryId:G,createForGroupId:K,setCreateForGroupId:te,editingGroupId:he,setEditingGroupId:be,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:w,handleMoveCategory:A,handleUpdateGroup:M,handleDeleteGroup:F,handleMoveGroup:H,handleCategoryDragStart:I,handleCategoryDragOver:N,handleDragOverGroup:O,handleDragLeave:k,handleDragLeaveGroup:R,handleDragEnd:ae,handleCategoryDrop:q,handleDropOnGroup:V,handleGroupDragStart:Q,handleGroupDrop:W,setDragOverId:P,setDragOverGroupId:D,isMobile:de,categories:e},Be.id)}),z==="group"&&a.length>0&&d.jsx(zy,{isActive:J==="__end__",onDragOver:Be=>{Be.preventDefault(),P("__end__")},onDragLeave:k,onDrop:Be=>W(Be,"__end__"),label:"Move group to end"}),d.jsx(pP,{ungroupedCategories:(i.ungrouped||[]).sort((Be,yt)=>Be[1].sort_order-yt[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:h,dragType:z,draggedId:ee,dragOverId:J,dragOverGroupId:me,editingCategoryId:U,setEditingCategoryId:G,createForGroupId:K,setCreateForGroupId:te,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:w,handleMoveCategory:A,handleCategoryDragStart:I,handleCategoryDragOver:N,handleDragOverGroup:O,handleDragLeaveGroup:R,handleDragLeave:k,handleDragEnd:ae,handleCategoryDrop:q,handleDropOnGroup:V,setDragOverId:P,setDragOverGroupId:D,categories:e,hasGroups:n.length>0})]}),xe?d.jsx(xT,{onSubmit:Be=>{S(Be),oe(!1)},onCancel:()=>oe(!1),submitLabel:"Create Group"}):d.jsx(Me,{variant:"primary-large",actionName:"Open Add Category Group Form",onClick:()=>oe(!0),children:"+ Add Category Group"})]})}const yP=["accounts","categories","users"];function _P(){const{addLoadingHold:t,removeLoadingHold:e}=Bn(),{selectedBudgetId:n,currentUserId:i,lastSettingsTab:a,setLastSettingsTab:l}=un(),{isOwner:c,isLoading:h}=Fn(n,i);C.useEffect(()=>(h?t("settings","Loading settings..."):e("settings"),()=>e("settings")),[h,t,e]);const m=jn(),g=m.pathname==="/budget/settings",_=C.useMemo(()=>{const S=m.pathname;return S.includes("/settings/accounts")?"accounts":S.includes("/settings/categories")?"categories":S.includes("/settings/users")?"users":"categories"},[m.pathname]),v=_==="users";C.useEffect(()=>{g||l(_)},[_,g,l]);function b(){return!yP.includes(a)||a==="users"&&!c?"categories":a}const w=C.useMemo(()=>[{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!c}],[c]);return h?null:!c&&v?d.jsxs("div",{style:yi,children:[d.jsx(_i,{title:"Budget Settings"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only the budget owner can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(Tt,{to:"/budget/settings/categories",style:{color:"#646cff"},children:"Go to Categories "})})]}):d.jsxs("div",{style:yi,children:[d.jsx(_i,{title:"Budget Settings"}),d.jsx(Uy,{mode:"link",linkPrefix:"/budget/settings",tabs:w,activeTab:g?b():_}),g?d.jsx(Hh,{to:`/budget/settings/${b()}`,replace:!0}):d.jsx(aT,{children:d.jsx(Gh,{})})]})}function vP(){const{selectedBudgetId:t,currentUserId:e}=un(),{budget:n,budgetUserIds:i,acceptedUserIds:a,inviteUser:l,revokeUser:c}=Fn(t,e),[h,m]=C.useState(""),[g,_]=C.useState(!1),[v,b]=C.useState(null),[w,A]=C.useState(null);if(!n)return d.jsx("p",{children:"No budget found."});async function S(z){if(z.preventDefault(),!(!h.trim()||!n)){_(!0),b(null),A(null);try{await l(h.trim()),m(""),A("Invite sent! The user can now accept the invitation from their account.")}catch(ee){b(ee instanceof Error?ee.message:"Failed to invite user")}finally{_(!1)}}}async function M(z){if(!n)return;if(z===n.owner_id){b("Cannot revoke the budget owner");return}if(z===e){b("Cannot revoke yourself from the budget");return}const ee=a.includes(z);if(confirm(ee?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){b(null),A(null);try{await c(z),A(ee?"User access revoked.":"Invitation cancelled.")}catch(me){b(me instanceof Error?me.message:"Failed to revoke user")}}}const F=i.filter(z=>a.includes(z)),H=i.filter(z=>!a.includes(z));return d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),w&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:w}),d.jsx("button",{onClick:()=>A(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",F.length,")"]}),F.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:F.map(z=>{const ee=z===n.owner_id,J=z===e;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:z}),ee&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),J&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!ee&&!J&&d.jsx("button",{onClick:()=>M(z),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},z)})})]}),H.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",H.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:H.map(z=>d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:z}),d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),d.jsx("button",{onClick:()=>M(z),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},z))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),d.jsxs("form",{onSubmit:S,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:h,onChange:z=>m(z.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:g||!h.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||!h.trim()?"not-allowed":"pointer",fontWeight:500,opacity:g||!h.trim()?.7:1,whiteSpace:"nowrap"},children:g?"Inviting...":"Send Invite"})]}),d.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),d.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}const bP=["budget","feedback","migration","tests"];function xP(){const{isAdmin:t,isTest:e,lastAdminTab:n,setLastAdminTab:i}=un(),a=jn(),l=a.pathname==="/budget/admin",c=C.useMemo(()=>{const _=a.pathname;return _.includes("/admin/budget")?"budget":_.includes("/admin/feedback")?"feedback":_.includes("/admin/migration")?"migration":_.includes("/admin/tests")?"tests":"budget"},[a.pathname]),h=c==="tests";C.useEffect(()=>{l||i(c)},[c,l,i]);function m(){return!bP.includes(n)||n==="tests"&&!e?"budget":n}const g=C.useMemo(()=>[{id:"budget",label:"Budget",icon:""},{id:"feedback",label:"Feedback",icon:""},{id:"migration",label:"Migration",icon:""},{id:"tests",label:"Tests",icon:"",hidden:!e}],[e]);return t?!e&&h?d.jsxs("div",{style:yi,children:[d.jsx(_i,{title:"Budget Admin"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only test users can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(Tt,{to:"/budget/admin/budget",style:{color:"#646cff"},children:"Go to Admin "})})]}):d.jsxs("div",{style:yi,children:[d.jsx(_i,{title:"Budget Admin"}),d.jsx(Uy,{mode:"link",linkPrefix:"/budget/admin",tabs:g,activeTab:c}),l?d.jsx(Hh,{to:`/budget/admin/${m()}`,replace:!0}):d.jsx(Gh,{})]}):d.jsxs("div",{style:yi,children:[d.jsx(_i,{title:"Budget Admin"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only administrators can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(Tt,{to:"/budget",style:{color:"#646cff"},children:"Go to Budget "})})]})}function EP(){const{addLoadingHold:t,removeLoadingHold:e}=Bn(),{selectedBudgetId:n,currentUserId:i,isAdmin:a}=un(),{budget:l,accounts:c,accountGroups:h,categories:m,categoryGroups:g,isOwner:_,isLoading:v}=Fn(n,i);return C.useEffect(()=>(v?t("settings-budget","Loading budget info..."):e("settings-budget"),()=>e("settings-budget")),[v,t,e]),v?null:l?d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Summary"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Information about the currently selected budget."}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",fontSize:"0.95rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Name:"}),d.jsx("strong",{children:l.name})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"ID:"}),d.jsx("code",{style:{background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:l.id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Owner:"}),d.jsx("strong",{children:l.owner_email||l.owner_id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Users:"}),d.jsxs("span",{children:[l.user_ids.length," user",l.user_ids.length!==1?"s":"",d.jsxs("span",{style:{opacity:.7},children:["  ",_?"You are the owner":"Shared with you"]})]})]})]})}),a&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem"},children:"Admin Tools"}),d.jsx("button",{onClick:()=>{const b={...l,accounts:c,account_groups:h,categories:m,category_groups:g,_meta:{downloaded_at:new Date().toISOString()}},w=new Blob([JSON.stringify(b,null,2)],{type:"application/json"}),A=URL.createObjectURL(w),S=document.createElement("a");S.href=A,S.download=`budget_${l.id}.json`,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(A)},style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",transition:"background 0.15s"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]})]}):d.jsx("p",{style:{opacity:.7},children:"No budget selected."})}function VE({budget:t,isCurrent:e,isAccepting:n,isSwitching:i,isEditing:a,editName:l,isRenaming:c,onAccept:h,onSwitch:m,onStartEdit:g,onCancelEdit:_,onEditNameChange:v,onSaveEdit:b}){const w=e&&t.isOwner;return d.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:a?d.jsxs("form",{onSubmit:b,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:d.jsx("input",{type:"text",value:l,onChange:A=>v(A.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[d.jsx("button",{type:"submit",disabled:c||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:c||!l.trim()?.7:1,fontSize:"0.8rem"},children:c?"Saving...":"Save"}),d.jsx("button",{type:"button",onClick:_,disabled:c,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c?"not-allowed":"pointer",fontWeight:500,opacity:c?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[d.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),w&&d.jsx("button",{onClick:g,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),d.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?d.jsx("button",{onClick:h,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:d.jsx("button",{onClick:m,disabled:i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,fontSize:"0.85rem"},children:i?"Switching...":"Switch"})})]})})}const Rg={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function ST({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,i=n&&n in Rg?n:"bug",a=Rg[i];return d.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:a.bgColor,color:a.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:a.label})}function wP({item:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:h,onToggleDone:m,onTypeClick:g}){return d.jsxs("div",{onDragOver:_=>{_.stopPropagation(),a(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),h(_)},style:{position:"relative"},children:[d.jsx("div",{style:{...rT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:c,style:{...xu,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{...nT},children:""}),d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:m,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ce.primary,flexShrink:0}}),d.jsx(ST,{type:t.feedback_type,onClick:g})]}),d.jsxs("div",{style:{marginLeft:"3.25rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",Ag(t.created_at)]})]})]})]})}function SP({item:t,onToggleDone:e,onTypeClick:n}){return d.jsxs("div",{style:{...xu,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ce.primary,flexShrink:0}}),d.jsx(ST,{type:t.feedback_type,onClick:n})]}),d.jsxs("div",{style:{marginLeft:"2rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",Ag(t.created_at)]}),t.completed_at&&d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:ce.success},children:[" Completed: ",Ag(t.completed_at)]})]})]})}function qy({noMargin:t}={}){return d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:t?0:"0.5rem",verticalAlign:"middle"}})}function Hy({title:t,description:e,status:n,statusText:i,onRefresh:a,isRefreshing:l,isBusy:c=!1,children:h,cardName:m}){const _=(()=>{switch(n){case"unknown":return{color:"#9ca3af",text:i??"Unknown"};case"clean":case"complete":return{color:"#22c55e",text:i??" Clean"};case"needs-action":return{color:"#f59e0b",text:i??"Action Needed"}}})(),v=l||c;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:t}),d.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.9rem"},children:e})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexShrink:0},children:[n!=="unknown"&&d.jsx("span",{style:{color:_.color,fontWeight:600,fontSize:"0.9rem"},children:_.text}),d.jsxs("button",{onClick:()=>{a()},disabled:v,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem 0.65rem",borderRadius:"6px",cursor:v?"not-allowed":"pointer",fontWeight:500,fontSize:"0.85rem",opacity:v?.6:1,display:"flex",alignItems:"center",gap:"0.3rem"},title:"Refresh status",children:[l?d.jsx(qy,{noMargin:!0}):""," Refresh"]})]})]}),h]})}const TP={unknown:{bg:"rgba(100, 100, 100, 0.1)",border:"rgba(100, 100, 100, 0.3)",color:"#9ca3af"},clean:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"},warning:{bg:"rgba(245, 158, 11, 0.1)",border:"rgba(245, 158, 11, 0.3)",color:"#fbbf24"},running:{bg:"rgba(100, 108, 255, 0.1)",border:"rgba(100, 108, 255, 0.3)",color:"#a5b4fc"},success:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"}};function In({type:t,children:e}){const n=TP[t];return d.jsx("div",{style:{background:n.bg,border:`1px solid ${n.border}`,color:n.color,padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:e})}function Gy({onClick:t,disabled:e,isBusy:n,busyText:i,children:a,actionName:l}){const c=e||n;return d.jsx("button",{onClick:()=>{t()},disabled:c,style:{marginTop:"1rem",background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:c?"not-allowed":"pointer",fontWeight:500,opacity:c?.7:1,display:"flex",alignItems:"center",gap:"0.4rem"},children:n?d.jsxs(d.Fragment,{children:[d.jsx(qy,{noMargin:!0})," ",i??"Running..."]}):a})}function AP({hasData:t,status:e,hasIssues:n,totalIssues:i,isRunning:a,result:l,onRunCleanup:c,onRefresh:h,isRefreshing:m,disabled:g}){const _=()=>t?l&&l.errors.length===0&&(l.accountsFixed>0||l.categoriesFixed>0||l.groupsFixed>0||l.monthMapsAdded>0||l.futureMonthsDeleted>0||l.monthsFixed>0||l.oldRecalcFieldsRemoved>0)?"complete":n?"needs-action":"clean":"unknown",v=l?l.accountsFixed+l.categoriesFixed+l.groupsFixed+l.monthMapsAdded+l.futureMonthsDeleted+l.monthsFixed+l.oldRecalcFieldsRemoved:0;return d.jsx(Hy,{title:" Database Cleanup",description:"Validates and fixes all budget and month documents to match the expected schema. Converts legacy formats, adds missing default values, and removes invalid future months.",status:_(),onRefresh:h,isRefreshing:m,isBusy:a,children:a?d.jsx(In,{type:"running",children:"Running database cleanup..."}):l?d.jsx(In,{type:l.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[l.errors.length>0?"":""," Cleanup complete",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.9rem"},children:[l.budgetsProcessed>0&&d.jsxs("li",{children:[l.budgetsProcessed," budget",l.budgetsProcessed!==1?"s":""," updated"]}),l.arraysConverted>0&&d.jsxs("li",{children:[l.arraysConverted," array",l.arraysConverted!==1?"s":""," converted to maps"]}),l.accountsFixed>0&&d.jsxs("li",{children:[l.accountsFixed," account",l.accountsFixed!==1?"s":""," fixed"]}),l.categoriesFixed>0&&d.jsxs("li",{children:[l.categoriesFixed," categor",l.categoriesFixed!==1?"ies":"y"," fixed"]}),l.groupsFixed>0&&d.jsxs("li",{children:[l.groupsFixed," group",l.groupsFixed!==1?"s":""," fixed"]}),l.monthMapsAdded>0&&d.jsxs("li",{children:[l.monthMapsAdded," budget",l.monthMapsAdded!==1?"s":""," got month_map added"]}),l.futureMonthsDeleted>0&&d.jsxs("li",{children:[l.futureMonthsDeleted," future month",l.futureMonthsDeleted!==1?"s":""," deleted"]}),l.monthsFixed>0&&d.jsxs("li",{children:[l.monthsFixed," month",l.monthsFixed!==1?"s":""," schema fixed"]}),l.oldRecalcFieldsRemoved>0&&d.jsxs("li",{children:[l.oldRecalcFieldsRemoved," month",l.oldRecalcFieldsRemoved!==1?"s":""," had old recalc field removed"]}),v===0&&d.jsx("li",{children:"No changes needed"})]}),l.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0.75rem 0 0.25rem 0",fontWeight:500,color:"#ef4444"},children:"Errors:"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.85rem",color:"#ef4444"},children:[l.errors.slice(0,5).map((b,w)=>d.jsx("li",{children:b},w)),l.errors.length>5&&d.jsxs("li",{style:{opacity:.7},children:["...and ",l.errors.length-5," more errors"]})]})]})]})}):t?n?d.jsxs(d.Fragment,{children:[d.jsx(In,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",i," issue",i!==1?"s":""," to fix:"]}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[e.budgetsWithArrays>0&&d.jsxs("li",{children:[e.budgetsWithArrays," budget",e.budgetsWithArrays!==1?"s":""," using legacy array format"]}),e.accountsNeedingDefaults>0&&d.jsxs("li",{children:[e.accountsNeedingDefaults," account",e.accountsNeedingDefaults!==1?"s":""," missing default values"]}),e.categoriesNeedingDefaults>0&&d.jsxs("li",{children:[e.categoriesNeedingDefaults," categor",e.categoriesNeedingDefaults!==1?"ies":"y"," missing default values"]}),e.groupsNeedingDefaults>0&&d.jsxs("li",{children:[e.groupsNeedingDefaults," account group",e.groupsNeedingDefaults!==1?"s":""," missing default values"]}),e.budgetsNeedingMonthMap>0&&d.jsxs("li",{children:[e.budgetsNeedingMonthMap," budget",e.budgetsNeedingMonthMap!==1?"s":""," missing month_map"]}),e.futureMonthsToDelete.length>0&&d.jsxs("li",{children:[e.futureMonthsToDelete.length," future month",e.futureMonthsToDelete.length!==1?"s":""," to delete",d.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.85rem",opacity:.8},children:[e.futureMonthsToDelete.slice(0,3).map(b=>d.jsxs("li",{children:[Zo[b.month-1]," ",b.year]},b.docId)),e.futureMonthsToDelete.length>3&&d.jsxs("li",{style:{opacity:.7},children:["...and ",e.futureMonthsToDelete.length-3," more"]})]})]}),e.monthsWithSchemaIssues>0&&d.jsxs("li",{children:[e.monthsWithSchemaIssues," month",e.monthsWithSchemaIssues!==1?"s":""," with schema issues"]}),e.monthsWithOldRecalcField>0&&d.jsxs("li",{children:[e.monthsWithOldRecalcField," month",e.monthsWithOldRecalcField!==1?"s":""," with deprecated is_needs_recalculation field"]})]}),d.jsxs("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["Scanned ",e.totalBudgets," budgets and ",e.totalMonths," months."]})]})}),d.jsxs(Gy,{onClick:c,disabled:g,isBusy:a,busyText:"Running...",actionName:"Run Database Cleanup",children:[" Fix ",i," Issue",i!==1?"s":""]})]}):d.jsx(In,{type:"clean",children:d.jsxs("div",{children:[" Database is clean",d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["All ",e.totalBudgets," budgets and ",e.totalMonths," months match expected schema."]})]})}):d.jsx(In,{type:"unknown",children:" Status unknown  click Refresh to scan the database"})})}function CP({hasData:t,status:e,isMigrating:n,onMigrate:i,onRefresh:a,isRefreshing:l,disabled:c,migrationResult:h}){const m=e&&(e.sanitizedDocuments.length>0||e.corruptedDocuments.length>0),g=h&&(h.deletedDocuments>0||h.fixedDocuments>0),_=()=>t?g?"complete":m?"needs-action":"clean":"unknown";return d.jsx(Hy,{title:" Consolidate Feedback Documents",description:"Fixes corrupted feedback data and merges documents with sanitized IDs into proper email format.",status:_(),onRefresh:a,isRefreshing:l,isBusy:n,children:n?d.jsx(In,{type:"running",children:"Migrating feedback documents..."}):t?g?d.jsx(In,{type:"success",children:d.jsxs("div",{children:[" Migration complete:",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[h.fixedDocuments>0&&d.jsxs("li",{children:["Fixed ",h.fixedDocuments," corrupted document(s)"]}),h.deletedDocuments>0&&d.jsxs("li",{children:["Merged & deleted ",h.deletedDocuments," sanitized document(s)"]}),h.mergedItems>0&&d.jsxs("li",{children:["Merged ",h.mergedItems," feedback item(s)"]})]}),h.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{marginTop:"0.5rem"},children:" Errors:"}),d.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:h.errors.map((v,b)=>d.jsx("li",{children:v},b))})]})]})}):m?d.jsxs(d.Fragment,{children:[d.jsx(In,{type:"warning",children:d.jsxs("div",{children:[e?.corruptedDocuments&&e.corruptedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.corruptedDocuments.length," corrupted document(s):"]}),d.jsx("ul",{style:{margin:"0 0 0.75rem 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.corruptedDocuments.map(v=>d.jsxs("li",{children:[v," ",d.jsx("span",{style:{opacity:.6},children:"(broken arrayUnion)"})]},v))})]}),e?.sanitizedDocuments&&e.sanitizedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.sanitizedDocuments.length," sanitized document(s) to merge:"]}),d.jsx("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.sanitizedDocuments.map(v=>d.jsx("li",{children:v},v))})]})]})}),d.jsx(Gy,{onClick:i,disabled:c,isBusy:n,busyText:"Migrating...",actionName:"Run Feedback Migration",children:"Run Migration"})]}):d.jsxs(In,{type:"clean",children:[" No issues found. All feedback documents are healthy.",d.jsxs("span",{style:{display:"block",fontSize:"0.85rem",opacity:.7,marginTop:"0.25rem"},children:["Found ",e?.documentsFound??0," document(s) total."]})]}):d.jsx(In,{type:"unknown",children:" Status unknown  click Refresh to scan for issues"})})}function RP({hasData:t,monthsCount:e,budgetCount:n,monthsToDelete:i,isDeleting:a,onDelete:l,onRefresh:c,isRefreshing:h,disabled:m,deleteResult:g}){const _=()=>t?g&&g.deleted>0&&g.errors.length===0?"complete":e===0?"clean":"needs-action":"unknown",v=i.reduce((b,w)=>{const A=w.budgetId;return b[A]||(b[A]=[]),b[A].push(w),b},{});return d.jsx(Hy,{title:" Delete ALL Months",description:"DESTRUCTIVE: Deletes ALL month documents from Firebase for ALL budgets. This will reset all income, expenses, and allocations. Use with extreme caution!",status:_(),onRefresh:c,isRefreshing:h,isBusy:a,children:a?d.jsx(In,{type:"running",children:"Deleting all months..."}):g?d.jsx(In,{type:g.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[g.errors.length>0?"":""," Deleted ",g.deleted," month",g.deleted!==1?"s":"",g.errors.length>0&&d.jsx("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem"},children:g.errors.map((b,w)=>d.jsx("li",{children:b},w))})]})}):t?e>0?d.jsxs(d.Fragment,{children:[d.jsx(In,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",d.jsx("strong",{children:e})," month",e!==1?"s":""," across ",d.jsx("strong",{children:n})," budget",n!==1?"s":"",":"]}),d.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto"},children:[Object.entries(v).slice(0,5).map(([b,w])=>d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[d.jsxs("div",{style:{fontWeight:500,fontSize:"0.85rem"},children:["Budget: ",b.slice(0,12),"..."]}),d.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.85rem"},children:[w.slice(0,3).map(A=>d.jsxs("li",{children:[Zo[A.month-1]," ",A.year]},A.docId)),w.length>3&&d.jsxs("li",{style:{opacity:.7},children:["...and ",w.length-3," more"]})]})]},b)),Object.keys(v).length>5&&d.jsxs("div",{style:{opacity:.7,fontSize:"0.85rem",marginTop:"0.5rem"},children:["...and ",Object.keys(v).length-5," more budgets"]})]})]})}),d.jsxs(Gy,{onClick:l,disabled:m,isBusy:a,busyText:"Deleting...",actionName:"Delete All Months",children:[" Delete ALL ",e," Month",e!==1?"s":""]}),d.jsx("p",{style:{fontSize:"0.8rem",color:"#ef4444",marginTop:"0.5rem",fontWeight:500},children:" This action cannot be undone!"})]}):d.jsx(In,{type:"clean",children:" No month documents found in Firebase."}):d.jsx(In,{type:"unknown",children:" Status unknown  click Refresh to scan for months"})})}function DP(){try{localStorage.removeItem("BUDGET_APP_QUERY_CACHE"),console.log("[Cache] Cleared React Query cache from localStorage")}catch(t){console.warn("Failed to clear localStorage cache:",t)}window.location.reload()}function IP(){const e=Qa().get_current_firebase_user(),[n,i]=C.useState(!1),a=T4({currentUser:e}),l=C4({currentUser:e}),c=R4({currentUser:e,onComplete:()=>i(!0)}),h=a.isScanning||l.isScanning||c.isScanning,m=a.isRunning||l.isMigratingFeedback||c.isDeleting,g=async()=>{await Promise.all([a.scanStatus(),l.scanStatus(),c.scanStatus()])};return d.jsxs("div",{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[d.jsx("h2",{style:{margin:0},children:"Data Migrations"}),d.jsxs("button",{onClick:g,disabled:h||m,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:h||m?"not-allowed":"pointer",fontWeight:500,opacity:h||m?.7:1,display:"flex",alignItems:"center",gap:"0.4rem",minWidth:"130px",minHeight:"36px"},children:[d.jsx("span",{style:{width:"18px",height:"18px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:h?d.jsx(qy,{noMargin:!0}):""}),"Refresh All"]})]}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:'Run migrations to validate and fix your database. Click "Refresh All" to scan Firestore directly.'}),d.jsx(AP,{hasData:!!a.status,status:a.status,hasIssues:a.hasIssues,totalIssues:a.totalIssues,isRunning:a.isRunning,result:a.result,onRunCleanup:a.runCleanup,onRefresh:a.scanStatus,isRefreshing:a.isScanning,disabled:!e}),d.jsx(CP,{hasData:!!l.status,status:l.status,isMigrating:l.isMigratingFeedback,onMigrate:l.migrateFeedbackDocuments,onRefresh:l.scanStatus,isRefreshing:l.isScanning,disabled:!e,migrationResult:l.feedbackMigrationResult}),d.jsx(RP,{hasData:!!c.status,monthsCount:c.status?.monthsCount??0,budgetCount:c.status?.budgetCount??0,monthsToDelete:c.status?.monthsToDelete??[],isDeleting:c.isDeleting,onDelete:c.deleteAllMonths,onRefresh:c.scanStatus,isRefreshing:c.isScanning,disabled:!e,deleteResult:c.deleteResult}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:d.jsxs("p",{style:{margin:0,opacity:.7},children:[d.jsx("strong",{children:"Note:"})," These migrations will process ",d.jsx("strong",{children:"all budgets and months"})," in the system, not just the ones you own or are invited to."]})}),d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, #ff6b6b 10%, transparent)",borderRadius:"8px",border:"1px solid color-mix(in srgb, #ff6b6b 30%, transparent)"},children:[d.jsxs("p",{style:{margin:"0 0 0.75rem 0",fontSize:"0.9rem"},children:[d.jsx("strong",{children:" Clear All Caches"}),d.jsx("span",{style:{opacity:.7,display:"block",marginTop:"0.25rem"},children:"If you're seeing stale data after running migrations, clear all cached data and reload to fetch fresh data from Firestore."})]}),d.jsx(Me,{variant:"danger",actionName:"Open Clear Caches Modal",onClick:()=>i(!0),style:{display:"flex",alignItems:"center",gap:"0.4rem"},children:" Clear All Caches & Reload"})]}),d.jsxs(dl,{isOpen:n,onClose:()=>i(!1),title:"Clear Caches & Reload?",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.8},children:"This will clear all cached data from localStorage and reload the page. The app will fetch fresh data from Firestore for everything."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Me,{variant:"secondary",actionName:"Cancel Clear Caches",onClick:()=>i(!1),children:"Cancel"}),d.jsx(Me,{variant:"danger",actionName:"Confirm Clear Caches & Reload",onClick:DP,children:"Clear & Reload"})]})]})]})}function jP(){const[t,e]=C.useState(null),[n,i]=C.useState(null),[a,l]=C.useState(null),[c,h]=C.useState(!1),[m,g]=C.useState(""),[_,v]=C.useState("bug"),[b,w]=C.useState(null),[A,S]=C.useState(null),M=C.useContext(au),H=Qa().get_current_firebase_user(),z=sk(),{submitFeedback:ee}=sT(),{toggleFeedback:J}=K6(),{updateSortOrder:me}=Y6(),P=z.data?.items||[],{addLoadingHold:D,removeLoadingHold:I}=Bn();C.useEffect(()=>(z.isLoading?D("settings-feedback","Loading feedback..."):I("settings-feedback"),()=>I("settings-feedback")),[z.isLoading,D,I]);function N(U){U.preventDefault(),!(!m.trim()||!M.username||!H)&&(ee.mutate({userId:H.uid,userEmail:M.username,text:m.trim(),feedbackType:_,currentPath:"/settings/feedback"}),g(""),v("bug"),h(!1))}function O(U){U.is_done?k(U):w(U)}async function k(U){try{await J.mutateAsync({item:U})}catch(G){e(G instanceof Error?G.message:"Failed to update feedback")}}function R(){b&&(k(b),w(null))}async function ae(U){if(A){try{const K=P.filter(te=>te.doc_id===A.doc_id).map(te=>te.id===A.id?{id:te.id,text:te.text,created_at:te.created_at,is_done:te.is_done,completed_at:te.completed_at,sort_order:te.sort_order,feedback_type:U}:{id:te.id,text:te.text,created_at:te.created_at,is_done:te.is_done,completed_at:te.completed_at,sort_order:te.sort_order,feedback_type:te.feedback_type});await me.mutateAsync({docId:A.doc_id,items:K})}catch(G){e(G instanceof Error?G.message:"Failed to update feedback type")}S(null)}}const q=P.filter(U=>!U.is_done).sort((U,G)=>U.sort_order-G.sort_order),V=P.filter(U=>U.is_done).sort((U,G)=>{const K=U.completed_at?new Date(U.completed_at).getTime():0;return(G.completed_at?new Date(G.completed_at).getTime():0)-K});function Q(U,G){i(G),U.dataTransfer.effectAllowed="move"}function W(U,G){U.preventDefault(),G!==n&&l(G)}function de(){l(null)}function ne(){i(null),l(null)}async function B(U,G){if(U.preventDefault(),!n||n===G){ne();return}const K=q.findIndex(oe=>oe.id===n),te=[...q],[he]=te.splice(K,1);if(G==="__end__")te.push(he);else{const oe=te.findIndex(Y=>Y.id===G);te.splice(oe,0,he)}const be=te.map((oe,Y)=>({...oe,sort_order:Y}));ne();const xe=new Map;for(const oe of be)xe.has(oe.doc_id)||xe.set(oe.doc_id,[]),xe.get(oe.doc_id).push({id:oe.id,text:oe.text,created_at:oe.created_at,is_done:oe.is_done,completed_at:oe.completed_at,sort_order:oe.sort_order,feedback_type:oe.feedback_type});for(const oe of V)xe.has(oe.doc_id)||xe.set(oe.doc_id,[]),xe.get(oe.doc_id).push({id:oe.id,text:oe.text,created_at:oe.created_at,is_done:oe.is_done,completed_at:oe.completed_at,sort_order:oe.sort_order,feedback_type:oe.feedback_type});try{for(const[oe,Y]of xe)await me.mutateAsync({docId:oe,items:Y})}catch(oe){e(oe instanceof Error?oe.message:"Failed to save order")}}return z.isLoading?null:d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Feedback"}),d.jsx("p",{style:{...iT,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&d.jsx(Ka,{message:t,onDismiss:()=>e(null)}),d.jsxs("div",{style:ul,children:[q.length===0&&!c&&d.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),q.map(U=>d.jsx(wP,{item:U,isDragging:n===U.id,isDragOver:a===U.id,onDragStart:G=>Q(G,U.id),onDragOver:G=>W(G,U.id),onDragLeave:de,onDragEnd:ne,onDrop:G=>B(G,U.id),onToggleDone:()=>O(U),onTypeClick:()=>S(U)},U.id)),n&&q.length>0&&d.jsx(zy,{isActive:a==="__end__",onDragOver:U=>W(U,"__end__"),onDragLeave:de,onDrop:U=>B(U,"__end__")})]}),c?d.jsxs(Ba,{actionName:"Add Feedback",onSubmit:N,children:[d.jsx(zE,{selectedType:_,onSelect:v}),d.jsx(Vy,{value:m,onChange:U=>g(U.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),d.jsxs(Ya,{children:[d.jsx(Me,{type:"submit",actionName:"Add Feedback",disabled:!m.trim(),children:"Add Feedback"}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Add Feedback",onClick:()=>{h(!1),g(""),v("bug")},children:"Cancel"})]})]}):d.jsx(Me,{variant:"primary-large",actionName:"Open Add Feedback Form",onClick:()=>h(!0),children:"+ Add Feedback"}),V.length>0&&d.jsx(e4,{title:"Completed",count:V.length,children:d.jsx("div",{style:{...ul,marginTop:"0.5rem"},children:V.map(U=>d.jsx(SP,{item:U,onToggleDone:()=>O(U),onTypeClick:()=>S(U)},U.id))})}),d.jsxs(dl,{isOpen:b!==null,onClose:()=>w(null),title:"Mark as Complete",children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),b&&d.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',b.text,'"']}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Me,{variant:"secondary",actionName:"Cancel Mark Complete",onClick:()=>w(null),children:"Cancel"}),d.jsx(Me,{variant:"primary",actionName:"Confirm Mark Complete",onClick:R,children:"Mark Complete"})]})]}),d.jsxs(dl,{isOpen:A!==null,onClose:()=>S(null),title:"Change Feedback Type",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),d.jsx(zE,{selectedType:A?.feedback_type||"bug",onSelect:ae}),d.jsx(Me,{variant:"secondary",actionName:"Cancel Change Feedback Type",onClick:()=>S(null),style:{width:"100%"},children:"Cancel"})]})]})}function zE({selectedType:t,onSelect:e}){return d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const i=Rg[n],a=t==="feature"?"new_feature":t,l=a===n||!a&&n==="bug";return d.jsxs("button",{type:"button",onClick:()=>{i.label,e(n)},style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${i.color}`,borderRadius:"0.5rem",background:l?i.bgColor:"transparent",color:l?i.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${i.bgColor}`:"none",position:"relative"},children:[i.label,l&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function OP(){const{currentUserId:t}=un(),[e,n]=C.useState([]),[i,a]=C.useState(!1);function l(b,w){n(A=>A.map(S=>S.name===b?{...S,...w}:S))}async function c(){a(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await h("Read unauthorized budget",async()=>(await Le("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0),await h("Read another user's document",async()=>(await Le("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0),await h("Read unauthorized budget month",async()=>(await Le("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0),await h("Toggle is_admin in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Le("users",t,"security test: reading own user to get current is_admin value"),A=w?.permission_flags?.is_admin??!1;return await Ma("users",t,{"permission_flags.is_admin":!A},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${A} to ${!A} (SECURITY ISSUE!)`},!0),await h("Toggle is_test in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Le("users",t,"security test: reading own user to get current is_test value"),A=w?.permission_flags?.is_test??!1;return await Ma("users",t,{"permission_flags.is_test":!A},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${A} to ${!A} (SECURITY ISSUE!)`},!0),await h("Read own user document",async()=>{if(!t)throw new Error("Not authenticated");const{exists:w}=await Le("users",t,"security test: reading own user document (should succeed)");if(w)return"Successfully read own document";throw new Error("Document does not exist")},!1),a(!1)}async function h(b,w,A){l(b,{status:"running",message:"Running..."});try{const S=await w();A?l(b,{status:"failed",message:` ${S}`}):l(b,{status:"passed",message:` ${S}`})}catch(S){const M=S instanceof Error?S.message:"Unknown error";A?l(b,{status:"passed",message:` Blocked as expected: ${M}`}):l(b,{status:"failed",message:` ${M}`})}}async function m(b){switch(e.find(A=>A.name===b)||n(A=>[...A,{name:b,status:"pending",message:"",expectedToFail:!0}]),a(!0),b){case"Read unauthorized budget":await h(b,async()=>(await Le("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0);break;case"Read another user's document":await h(b,async()=>(await Le("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0);break;case"Read unauthorized budget month":await h(b,async()=>(await Le("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0);break;case"Toggle is_admin in own permission_flags":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:A}=await Le("users",t,"security test: reading own user to get current is_admin value"),S=A?.permission_flags?.is_admin??!1;return await Ma("users",t,{"permission_flags.is_admin":!S},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${S} to ${!S} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:A}=await Le("users",t,"security test: reading own user to get current is_test value"),S=A?.permission_flags?.is_test??!1;return await Ma("users",t,{"permission_flags.is_test":!S},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${S} to ${!S} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{exists:A}=await Le("users",t,"security test: reading own user document (should succeed)");if(A)return"Successfully read own document";throw new Error("Document does not exist")},!1);break}a(!1)}const g=e.filter(b=>b.status==="passed").length,_=e.filter(b=>b.status==="failed").length,v=e.length;return d.jsxs("div",{children:[d.jsx("p",{style:iT,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsx(Me,{onClick:c,disabled:i,variant:"primary",children:i?"Running Tests...":"Run All Tests"})}),e.length>0&&d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[d.jsxs("span",{children:["Total: ",d.jsx("strong",{children:v})]}),d.jsxs("span",{style:{color:ce.success},children:["Passed: ",d.jsx("strong",{children:g})]}),d.jsxs("span",{style:{color:ce.danger},children:["Failed: ",d.jsx("strong",{children:_})]})]})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),d.jsx(Fo,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read unauthorized budget"),onRun:()=>m("Read unauthorized budget"),disabled:i}),d.jsx(Fo,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read another user's document"),onRun:()=>m("Read another user's document"),disabled:i}),d.jsx(Fo,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(b=>b.name==="Read unauthorized budget month"),onRun:()=>m("Read unauthorized budget month"),disabled:i}),d.jsx(Fo,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_admin in own permission_flags"),onRun:()=>m("Toggle is_admin in own permission_flags"),disabled:i}),d.jsx(Fo,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_test in own permission_flags"),onRun:()=>m("Toggle is_test in own permission_flags"),disabled:i}),d.jsx(Fo,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(b=>b.name==="Read own user document"),onRun:()=>m("Read own user document"),disabled:i,expectedToSucceed:!0})]}),_>0&&d.jsxs(Ka,{style:{marginTop:"1.5rem"},children:[" ",_," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function Fo({name:t,description:e,expectedBehavior:n,result:i,onRun:a,disabled:l,expectedToSucceed:c}){const h=i?.status==="passed"?ce.success:i?.status==="failed"?ce.danger:i?.status==="running"?ce.warning:"inherit";return d.jsxs("div",{style:{...xu,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),d.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),d.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:c?ce.success:ce.warning},children:["Expected: ",n]})]}),d.jsx(Me,{onClick:a,disabled:l,variant:"secondary",style:{flexShrink:0},children:i?.status==="running"?"":"Run"})]}),i&&i.status!=="pending"&&d.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${h} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${h} 30%, transparent)`,fontSize:"0.85rem",color:h},children:i.message})]})}function MP(){const{addLoadingHold:t,removeLoadingHold:e}=Bn(),{selectedBudgetId:n,currentUserId:i,accessibleBudgets:a,loadAccessibleBudgets:l,switchToBudget:c,checkBudgetInvite:h,isInitialized:m}=un();C.useEffect(()=>{m&&l()},[m,l]);const{budget:g,renameBudget:_,acceptInvite:v,isLoading:b}=Fn(n,i),[w,A]=C.useState(null),[S,M]=C.useState(null),[F,H]=C.useState(null),[z,ee]=C.useState(null),[J,me]=C.useState(null),[P,D]=C.useState(""),[I,N]=C.useState(!1),[O,k]=C.useState(""),[R,ae]=C.useState(!1),[q,V]=C.useState(null);async function Q(he){if(he!==g?.id){A(he),H(null),ee(null);try{await c(he),ee("Switched to budget successfully!"),await l()}catch(be){H(be instanceof Error?be.message:"Failed to switch budget")}finally{A(null)}}}async function W(he){M(he),H(null),ee(null);try{await v(he),ee("Invitation accepted! You now have access to this budget."),await l()}catch(be){H(be instanceof Error?be.message:"Failed to accept invitation")}finally{M(null)}}async function de(he){if(he.preventDefault(),!!O.trim()){ae(!0),H(null),V(null);try{const be=await h(O.trim());be?V(be):H("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(be){H(be instanceof Error?be.message:"Failed to check invitation")}finally{ae(!1)}}}async function ne(){if(q){q.budgetName,M(q.budgetId),H(null);try{await v(q.budgetId),ee(`Successfully joined "${q.budgetName}"!`),V(null),k(""),await l()}catch(he){H(he instanceof Error?he.message:"Failed to accept invitation")}finally{M(null)}}}function B(he,be){D(be),me(he)}function U(){me(null),D("")}async function G(he){if(he.preventDefault(),!(!P.trim()||!J)){P.trim(),N(!0),H(null),ee(null);try{await _(P.trim()),ee("Budget renamed successfully!"),me(null),await l()}catch(be){H(be instanceof Error?be.message:"Failed to rename budget")}finally{N(!1)}}}const K=a.filter(he=>!he.isPending),te=a.filter(he=>he.isPending);return C.useEffect(()=>(b||!m?t("my-budgets","Loading your budgets..."):e("my-budgets"),()=>e("my-budgets")),[b,m,t,e]),b||!m?null:d.jsxs(Gc,{children:[d.jsx(_i,{title:"My Budgets"}),d.jsx("h1",{children:"My Budgets"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Switch between budgets, accept invitations, or join a budget by ID."}),F&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:F}),d.jsx("button",{onClick:()=>H(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),z&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:z}),d.jsx("button",{onClick:()=>ee(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),te.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Pending Invitations (",te.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:te.map(he=>d.jsx(VE,{budget:he,isCurrent:!1,isAccepting:S===he.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>W(he.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},he.id))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Your Budgets (",K.length,")"]}),K.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:K.map(he=>{const be=he.id===g?.id,xe=J===he.id;return d.jsx(VE,{budget:he,isCurrent:be,isAccepting:!1,isSwitching:w===he.id,isEditing:xe,editName:xe?P:"",isRenaming:I,onAccept:()=>{},onSwitch:()=>Q(he.id),onStartEdit:()=>B(he.id,he.name),onCancelEdit:U,onEditNameChange:D,onSaveEdit:G},he.id)})})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Join Budget by ID"]}),d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),q?d.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[d.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:q.budgetName}),q.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",q.ownerEmail]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{onClick:ne,disabled:S===q.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:S===q.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:S===q.budgetId?.7:1},children:S===q.budgetId?"Accepting...":"Accept Invitation"}),d.jsx("button",{onClick:()=>{V(null),k("")},disabled:S===q.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:S===q.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:S===q.budgetId?.7:.8},children:"Cancel"})]})]}):d.jsxs("form",{onSubmit:de,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:O,onChange:he=>k(he.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:R||!O.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:R||!O.trim()?"not-allowed":"pointer",fontWeight:500,opacity:R||!O.trim()?.7:1,whiteSpace:"nowrap"},children:R?"Checking...":"Check Invite"})]})]}),i&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[d.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),d.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:i})]})]})}function kP({children:t}){const{addLoadingHold:e,removeLoadingHold:n}=Bn(),i=C.useContext(au),a=jn();return C.useEffect(()=>(i.is_auth_checked?n("protected-route"):e("protected-route","Checking authentication..."),()=>n("protected-route")),[i.is_auth_checked,e,n]),i.is_auth_checked?i.is_logged_in?t?d.jsx(d.Fragment,{children:t}):d.jsx(Gh,{}):d.jsx(Hh,{to:"/account",state:{from:a.pathname},replace:!0}):null}function NP(){const{addLoadingHold:t,removeLoadingHold:e}=Bn(),{selectedBudgetId:n,currentUserId:i,isInitialized:a}=un(),{isLoading:l,error:c}=Fn(n,i);return C.useEffect(()=>{a?e("budget-init"):t("budget-init",l?"Fetching data from server...":"Loading budget...")},[a,l,t,e]),C.useEffect(()=>()=>e("budget-init"),[e]),c?(console.error("[BudgetLayout] Error:",c),d.jsx("div",{style:yi,children:d.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",c.message]})})):d.jsx("div",{style:{paddingBottom:"5rem"},children:a&&d.jsx(Gh,{})})}function PP({message:t="Loading..."}){return d.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(15, 15, 20, 0.92)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999,gap:"1.25rem",backdropFilter:"blur(4px)"},children:[d.jsx("div",{style:{width:"3.5rem",height:"3.5rem",border:"3px solid rgba(255, 255, 255, 0.15)",borderTopColor:ce.primary,borderRadius:"50%",animation:"loadingOverlaySpin 0.8s linear infinite"}}),d.jsx("p",{style:{color:"rgba(255, 255, 255, 0.9)",fontSize:"1.1rem",fontWeight:500,letterSpacing:"0.02em"},children:t}),d.jsx("style",{children:`
        @keyframes loadingOverlaySpin {
          to { transform: rotate(360deg); }
        }
      `})]})}const LP={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function VP(){const{isLoading:t,loadingMessage:e}=Bn();return t?d.jsx(PP,{message:e}):null}function zP(){const[t,e]=C.useState(LP),n=Qa(),i=C.useRef(!1),{addLoadingHold:a,removeLoadingHold:l}=Bn();return C.useEffect(function(){i.current||(i.current=!0,n.set_user_listener(c=>{e({is_logged_in:c!=null,is_auth_checked:!0,username:c?.email??"",set_user_context:e})}))},[n]),C.useEffect(()=>{t.is_auth_checked?l("auth"):a("auth","Authenticating...")},[t.is_auth_checked,a,l]),t.is_auth_checked?d.jsx(au.Provider,{value:t,children:d.jsx(WD,{children:d.jsx(S6,{children:d.jsxs(NR,{children:[d.jsxs(uR,{children:[d.jsx(Qt,{path:"/",element:d.jsx(H6,{})}),d.jsx(Qt,{path:"/account",element:d.jsx(i4,{})}),d.jsx(Qt,{path:"/sql-test",element:d.jsx(r4,{})}),d.jsx(Qt,{path:"/budget",element:d.jsx(kP,{}),children:d.jsxs(Qt,{element:d.jsx(NP,{}),children:[d.jsx(Qt,{index:!0,element:d.jsx(PE,{})}),d.jsx(Qt,{path:":year/:month/:tab/:view?",element:d.jsx(PE,{})}),d.jsx(Qt,{path:"analytics",element:d.jsx(aP,{})}),d.jsx(Qt,{path:"my-budgets",element:d.jsx(MP,{})}),d.jsxs(Qt,{path:"settings",element:d.jsx(_P,{}),children:[d.jsx(Qt,{index:!0,element:d.jsx(Hh,{to:"categories",replace:!0})}),d.jsx(Qt,{path:"accounts",element:d.jsx(fP,{})}),d.jsx(Qt,{path:"categories",element:d.jsx(gP,{})}),d.jsx(Qt,{path:"users",element:d.jsx(vP,{})})]}),d.jsxs(Qt,{path:"admin",element:d.jsx(xP,{}),children:[d.jsx(Qt,{path:"budget",element:d.jsx(EP,{})}),d.jsx(Qt,{path:"feedback",element:d.jsx(jP,{})}),d.jsx(Qt,{path:"migration",element:d.jsx(IP,{})}),d.jsx(Qt,{path:"tests",element:d.jsx(OP,{})})]})]})})]}),d.jsx(Z6,{})]})})})}):null}function UP(){return d.jsxs(QR,{children:[d.jsx(VP,{}),d.jsx(zP,{})]})}uC.createRoot(document.getElementById("root")).render(d.jsx(C.StrictMode,{children:d.jsx(UP,{})}));
