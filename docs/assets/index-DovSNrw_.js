(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var _p={exports:{}},Oc={};var gb;function cC(){if(gb)return Oc;gb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var h in a)h!=="key"&&(l[h]=a[h])}else l=a;return a=l.ref,{$$typeof:t,type:i,key:c,ref:a!==void 0?a:null,props:l}}return Oc.Fragment=e,Oc.jsx=n,Oc.jsxs=n,Oc}var yb;function uC(){return yb||(yb=1,_p.exports=cC()),_p.exports}var d=uC(),vp={exports:{}},ze={};var _b;function dC(){if(_b)return ze;_b=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),b=Symbol.iterator;function w(U){return U===null||typeof U!="object"?null:(U=b&&U[b]||U["@@iterator"],typeof U=="function"?U:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,j={};function B(U,F,W){this.props=U,this.context=F,this.refs=j,this.updater=W||C}B.prototype.isReactComponent={},B.prototype.setState=function(U,F){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,F,"setState")},B.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function H(){}H.prototype=B.prototype;function z(U,F,W){this.props=U,this.context=F,this.refs=j,this.updater=W||C}var J=z.prototype=new H;J.constructor=z,T(J,B.prototype),J.isPureReactComponent=!0;var $=Array.isArray;function re(){}var P={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function D(U,F,W){var X=W.ref;return{$$typeof:t,type:U,key:F,ref:X!==void 0?X:null,props:W}}function N(U,F){return D(U.type,F,U.props)}function M(U){return typeof U=="object"&&U!==null&&U.$$typeof===t}function k(U){var F={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(W){return F[W]})}var I=/\/+/g;function ae(U,F){return typeof U=="object"&&U!==null&&U.key!=null?k(""+U.key):F.toString(36)}function q(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(re,re):(U.status="pending",U.then(function(F){U.status==="pending"&&(U.status="fulfilled",U.value=F)},function(F){U.status==="pending"&&(U.status="rejected",U.reason=F)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function L(U,F,W,X,ee){var ge=typeof U;(ge==="undefined"||ge==="boolean")&&(U=null);var me=!1;if(U===null)me=!0;else switch(ge){case"bigint":case"string":case"number":me=!0;break;case"object":switch(U.$$typeof){case t:case e:me=!0;break;case _:return me=U._init,L(me(U._payload),F,W,X,ee)}}if(me)return ee=ee(U),me=X===""?"."+ae(U,0):X,$(ee)?(W="",me!=null&&(W=me.replace(I,"$&/")+"/"),L(ee,F,W,"",function(Z){return Z})):ee!=null&&(M(ee)&&(ee=N(ee,W+(ee.key==null||U&&U.key===ee.key?"":(""+ee.key).replace(I,"$&/")+"/")+me)),F.push(ee)),1;me=0;var Ee=X===""?".":X+":";if($(U))for(var fe=0;fe<U.length;fe++)X=U[fe],ge=Ee+ae(X,fe),me+=L(X,F,W,ge,ee);else if(fe=w(U),typeof fe=="function")for(U=fe.call(U),fe=0;!(X=U.next()).done;)X=X.value,ge=Ee+ae(X,fe++),me+=L(X,F,W,ge,ee);else if(ge==="object"){if(typeof U.then=="function")return L(q(U),F,W,X,ee);throw F=String(U),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return me}function Q(U,F,W){if(U==null)return U;var X=[],ee=0;return L(U,X,"","",function(ge){return F.call(W,ge,ee++)}),X}function K(U){if(U._status===-1){var F=U._result;F=F(),F.then(function(W){(U._status===0||U._status===-1)&&(U._status=1,U._result=W)},function(W){(U._status===0||U._status===-1)&&(U._status=2,U._result=W)}),U._status===-1&&(U._status=0,U._result=F)}if(U._status===1)return U._result.default;throw U._result}var oe=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},ue={map:Q,forEach:function(U,F,W){Q(U,function(){F.apply(this,arguments)},W)},count:function(U){var F=0;return Q(U,function(){F++}),F},toArray:function(U){return Q(U,function(F){return F})||[]},only:function(U){if(!M(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return ze.Activity=v,ze.Children=ue,ze.Component=B,ze.Fragment=n,ze.Profiler=a,ze.PureComponent=z,ze.StrictMode=i,ze.Suspense=m,ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,ze.__COMPILER_RUNTIME={__proto__:null,c:function(U){return P.H.useMemoCache(U)}},ze.cache=function(U){return function(){return U.apply(null,arguments)}},ze.cacheSignal=function(){return null},ze.cloneElement=function(U,F,W){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var X=T({},U.props),ee=U.key;if(F!=null)for(ge in F.key!==void 0&&(ee=""+F.key),F)!R.call(F,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&F.ref===void 0||(X[ge]=F[ge]);var ge=arguments.length-2;if(ge===1)X.children=W;else if(1<ge){for(var me=Array(ge),Ee=0;Ee<ge;Ee++)me[Ee]=arguments[Ee+2];X.children=me}return D(U.type,ee,X)},ze.createContext=function(U){return U={$$typeof:c,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},ze.createElement=function(U,F,W){var X,ee={},ge=null;if(F!=null)for(X in F.key!==void 0&&(ge=""+F.key),F)R.call(F,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(ee[X]=F[X]);var me=arguments.length-2;if(me===1)ee.children=W;else if(1<me){for(var Ee=Array(me),fe=0;fe<me;fe++)Ee[fe]=arguments[fe+2];ee.children=Ee}if(U&&U.defaultProps)for(X in me=U.defaultProps,me)ee[X]===void 0&&(ee[X]=me[X]);return D(U,ge,ee)},ze.createRef=function(){return{current:null}},ze.forwardRef=function(U){return{$$typeof:h,render:U}},ze.isValidElement=M,ze.lazy=function(U){return{$$typeof:_,_payload:{_status:-1,_result:U},_init:K}},ze.memo=function(U,F){return{$$typeof:g,type:U,compare:F===void 0?null:F}},ze.startTransition=function(U){var F=P.T,W={};P.T=W;try{var X=U(),ee=P.S;ee!==null&&ee(W,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(re,oe)}catch(ge){oe(ge)}finally{F!==null&&W.types!==null&&(F.types=W.types),P.T=F}},ze.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},ze.use=function(U){return P.H.use(U)},ze.useActionState=function(U,F,W){return P.H.useActionState(U,F,W)},ze.useCallback=function(U,F){return P.H.useCallback(U,F)},ze.useContext=function(U){return P.H.useContext(U)},ze.useDebugValue=function(){},ze.useDeferredValue=function(U,F){return P.H.useDeferredValue(U,F)},ze.useEffect=function(U,F){return P.H.useEffect(U,F)},ze.useEffectEvent=function(U){return P.H.useEffectEvent(U)},ze.useId=function(){return P.H.useId()},ze.useImperativeHandle=function(U,F,W){return P.H.useImperativeHandle(U,F,W)},ze.useInsertionEffect=function(U,F){return P.H.useInsertionEffect(U,F)},ze.useLayoutEffect=function(U,F){return P.H.useLayoutEffect(U,F)},ze.useMemo=function(U,F){return P.H.useMemo(U,F)},ze.useOptimistic=function(U,F){return P.H.useOptimistic(U,F)},ze.useReducer=function(U,F,W){return P.H.useReducer(U,F,W)},ze.useRef=function(U){return P.H.useRef(U)},ze.useState=function(U){return P.H.useState(U)},ze.useSyncExternalStore=function(U,F,W){return P.H.useSyncExternalStore(U,F,W)},ze.useTransition=function(){return P.H.useTransition()},ze.version="19.2.3",ze}var vb;function Og(){return vb||(vb=1,vp.exports=dC()),vp.exports}var A=Og(),bp={exports:{}},Mc={},xp={exports:{}},Ep={};var bb;function hC(){return bb||(bb=1,(function(t){function e(L,Q){var K=L.length;L.push(Q);e:for(;0<K;){var oe=K-1>>>1,ue=L[oe];if(0<a(ue,Q))L[oe]=Q,L[K]=ue,K=oe;else break e}}function n(L){return L.length===0?null:L[0]}function i(L){if(L.length===0)return null;var Q=L[0],K=L.pop();if(K!==Q){L[0]=K;e:for(var oe=0,ue=L.length,U=ue>>>1;oe<U;){var F=2*(oe+1)-1,W=L[F],X=F+1,ee=L[X];if(0>a(W,K))X<ue&&0>a(ee,W)?(L[oe]=ee,L[X]=K,oe=X):(L[oe]=W,L[F]=K,oe=F);else if(X<ue&&0>a(ee,K))L[oe]=ee,L[X]=K,oe=X;else break e}}return Q}function a(L,Q){var K=L.sortIndex-Q.sortIndex;return K!==0?K:L.id-Q.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,h=c.now();t.unstable_now=function(){return c.now()-h}}var m=[],g=[],_=1,v=null,b=3,w=!1,C=!1,T=!1,j=!1,B=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;function J(L){for(var Q=n(g);Q!==null;){if(Q.callback===null)i(g);else if(Q.startTime<=L)i(g),Q.sortIndex=Q.expirationTime,e(m,Q);else break;Q=n(g)}}function $(L){if(T=!1,J(L),!C)if(n(m)!==null)C=!0,re||(re=!0,k());else{var Q=n(g);Q!==null&&q($,Q.startTime-L)}}var re=!1,P=-1,R=5,D=-1;function N(){return j?!0:!(t.unstable_now()-D<R)}function M(){if(j=!1,re){var L=t.unstable_now();D=L;var Q=!0;try{e:{C=!1,T&&(T=!1,H(P),P=-1),w=!0;var K=b;try{t:{for(J(L),v=n(m);v!==null&&!(v.expirationTime>L&&N());){var oe=v.callback;if(typeof oe=="function"){v.callback=null,b=v.priorityLevel;var ue=oe(v.expirationTime<=L);if(L=t.unstable_now(),typeof ue=="function"){v.callback=ue,J(L),Q=!0;break t}v===n(m)&&i(m),J(L)}else i(m);v=n(m)}if(v!==null)Q=!0;else{var U=n(g);U!==null&&q($,U.startTime-L),Q=!1}}break e}finally{v=null,b=K,w=!1}Q=void 0}}finally{Q?k():re=!1}}}var k;if(typeof z=="function")k=function(){z(M)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,ae=I.port2;I.port1.onmessage=M,k=function(){ae.postMessage(null)}}else k=function(){B(M,0)};function q(L,Q){P=B(function(){L(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_next=function(L){switch(b){case 1:case 2:case 3:var Q=3;break;default:Q=b}var K=b;b=Q;try{return L()}finally{b=K}},t.unstable_requestPaint=function(){j=!0},t.unstable_runWithPriority=function(L,Q){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var K=b;b=L;try{return Q()}finally{b=K}},t.unstable_scheduleCallback=function(L,Q,K){var oe=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?oe+K:oe):K=oe,L){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=K+ue,L={id:_++,callback:Q,priorityLevel:L,startTime:K,expirationTime:ue,sortIndex:-1},K>oe?(L.sortIndex=K,e(g,L),n(m)===null&&L===n(g)&&(T?(H(P),P=-1):T=!0,q($,K-oe))):(L.sortIndex=ue,e(m,L),C||w||(C=!0,re||(re=!0,k()))),L},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(L){var Q=b;return function(){var K=b;b=Q;try{return L.apply(this,arguments)}finally{b=K}}}})(Ep)),Ep}var xb;function fC(){return xb||(xb=1,xp.exports=hC()),xp.exports}var Sp={exports:{}},xn={};var Eb;function mC(){if(Eb)return xn;Eb=1;var t=Og();function e(m){var g="https://react.dev/errors/"+m;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(m,g,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:m,containerInfo:g,implementation:_}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(m,g){if(m==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return xn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,xn.createPortal=function(m,g){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return l(m,g,null,_)},xn.flushSync=function(m){var g=c.T,_=i.p;try{if(c.T=null,i.p=2,m)return m()}finally{c.T=g,i.p=_,i.d.f()}},xn.preconnect=function(m,g){typeof m=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(m,g))},xn.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},xn.preinit=function(m,g){if(typeof m=="string"&&g&&typeof g.as=="string"){var _=g.as,v=h(_,g.crossOrigin),b=typeof g.integrity=="string"?g.integrity:void 0,w=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;_==="style"?i.d.S(m,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:w}):_==="script"&&i.d.X(m,{crossOrigin:v,integrity:b,fetchPriority:w,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},xn.preinitModule=function(m,g){if(typeof m=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var _=h(g.as,g.crossOrigin);i.d.M(m,{crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(m)},xn.preload=function(m,g){if(typeof m=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var _=g.as,v=h(_,g.crossOrigin);i.d.L(m,_,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},xn.preloadModule=function(m,g){if(typeof m=="string")if(g){var _=h(g.as,g.crossOrigin);i.d.m(m,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(m)},xn.requestFormReset=function(m){i.d.r(m)},xn.unstable_batchedUpdates=function(m,g){return m(g)},xn.useFormState=function(m,g,_){return c.H.useFormState(m,g,_)},xn.useFormStatus=function(){return c.H.useHostTransitionStatus()},xn.version="19.2.3",xn}var Sb;function pC(){if(Sb)return Sp.exports;Sb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Sp.exports=mC(),Sp.exports}var wb;function gC(){if(wb)return Mc;wb=1;var t=fC(),e=Og(),n=pC();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var s=r,o=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(o=s.return),r=s.return;while(r)}return s.tag===3?o:null}function c(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function h(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function m(r){if(l(r)!==r)throw Error(i(188))}function g(r){var s=r.alternate;if(!s){if(s=l(r),s===null)throw Error(i(188));return s!==r?null:r}for(var o=r,u=s;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(u=p.return,u!==null){o=u;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return m(p),r;if(y===u)return m(p),s;y=y.sibling}throw Error(i(188))}if(o.return!==u.return)o=p,u=y;else{for(var E=!1,O=p.child;O;){if(O===o){E=!0,o=p,u=y;break}if(O===u){E=!0,u=p,o=y;break}O=O.sibling}if(!E){for(O=y.child;O;){if(O===o){E=!0,o=y,u=p;break}if(O===u){E=!0,u=y,o=p;break}O=O.sibling}if(!E)throw Error(i(189))}}if(o.alternate!==u)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?r:s}function _(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=_(r),s!==null)return s;r=r.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),z=Symbol.for("react.context"),J=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),N=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function k(r){return r===null||typeof r!="object"?null:(r=M&&r[M]||r["@@iterator"],typeof r=="function"?r:null)}var I=Symbol.for("react.client.reference");function ae(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===I?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case T:return"Fragment";case B:return"Profiler";case j:return"StrictMode";case $:return"Suspense";case re:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case C:return"Portal";case z:return r.displayName||"Context";case H:return(r._context.displayName||"Context")+".Consumer";case J:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case P:return s=r.displayName||null,s!==null?s:ae(r.type)||"Memo";case R:s=r._payload,r=r._init;try{return ae(r(s))}catch{}}return null}var q=Array.isArray,L=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},oe=[],ue=-1;function U(r){return{current:r}}function F(r){0>ue||(r.current=oe[ue],oe[ue]=null,ue--)}function W(r,s){ue++,oe[ue]=r.current,r.current=s}var X=U(null),ee=U(null),ge=U(null),me=U(null);function Ee(r,s){switch(W(ge,s),W(ee,r),W(X,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?zv(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=zv(s),r=Uv(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}F(X),W(X,r)}function fe(){F(X),F(ee),F(ge)}function Z(r){r.memoizedState!==null&&W(me,r);var s=X.current,o=Uv(s,r.type);s!==o&&(W(ee,r),W(X,o))}function De(r){ee.current===r&&(F(X),F(ee)),me.current===r&&(F(me),Rc._currentValue=K)}var Pe,gt;function Qe(r){if(Pe===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Pe=s&&s[1]||"",gt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Pe+r+gt}var dn=!1;function ir(r,s){if(!r||dn)return"";dn=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(he){var le=he}Reflect.construct(r,[],_e)}else{try{_e.call()}catch(he){le=he}r.call(_e.prototype)}}else{try{throw Error()}catch(he){le=he}(_e=r())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(he){if(he&&le&&typeof he.stack=="string")return[he.stack,le.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),E=y[0],O=y[1];if(E&&O){var G=E.split(`
`),se=O.split(`
`);for(p=u=0;u<G.length&&!G[u].includes("DetermineComponentFrameRoot");)u++;for(;p<se.length&&!se[p].includes("DetermineComponentFrameRoot");)p++;if(u===G.length||p===se.length)for(u=G.length-1,p=se.length-1;1<=u&&0<=p&&G[u]!==se[p];)p--;for(;1<=u&&0<=p;u--,p--)if(G[u]!==se[p]){if(u!==1||p!==1)do if(u--,p--,0>p||G[u]!==se[p]){var pe=`
`+G[u].replace(" at new "," at ");return r.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",r.displayName)),pe}while(1<=u&&0<=p);break}}}finally{dn=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?Qe(o):""}function yi(r,s){switch(r.tag){case 26:case 27:case 5:return Qe(r.type);case 16:return Qe("Lazy");case 13:return r.child!==s&&s!==null?Qe("Suspense Fallback"):Qe("Suspense");case 19:return Qe("SuspenseList");case 0:case 15:return ir(r.type,!1);case 11:return ir(r.type.render,!1);case 1:return ir(r.type,!0);case 31:return Qe("Activity");default:return""}}function Xi(r){try{var s="",o=null;do s+=yi(r,o),o=r,r=r.return;while(r);return s}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var At=Object.prototype.hasOwnProperty,jt=t.unstable_scheduleCallback,nt=t.unstable_cancelCallback,Fn=t.unstable_shouldYield,Er=t.unstable_requestPaint,Ct=t.unstable_now,qn=t.unstable_getCurrentPriorityLevel,Vt=t.unstable_ImmediatePriority,Hn=t.unstable_UserBlockingPriority,Ji=t.unstable_NormalPriority,xf=t.unstable_LowPriority,Su=t.unstable_IdlePriority,wu=t.log,Tu=t.unstable_setDisableYieldValue,Sr=null,hn=null;function sr(r){if(typeof wu=="function"&&Tu(r),hn&&typeof hn.setStrictMode=="function")try{hn.setStrictMode(Sr,r)}catch{}}var Ot=Math.clz32?Math.clz32:Cu,Au=Math.log,Za=Math.LN2;function Cu(r){return r>>>=0,r===0?32:31-(Au(r)/Za|0)|0}var Ur=256,ra=262144,zt=4194304;function Br(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Fr(r,s,o){var u=r.pendingLanes;if(u===0)return 0;var p=0,y=r.suspendedLanes,E=r.pingedLanes;r=r.warmLanes;var O=u&134217727;return O!==0?(u=O&~y,u!==0?p=Br(u):(E&=O,E!==0?p=Br(E):o||(o=O&~r,o!==0&&(p=Br(o))))):(O=u&~y,O!==0?p=Br(O):E!==0?p=Br(E):o||(o=u&~r,o!==0&&(p=Br(o)))),p===0?0:s!==0&&s!==p&&(s&y)===0&&(y=p&-p,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:p}function wr(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function Ef(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ru(){var r=zt;return zt<<=1,(zt&62914560)===0&&(zt=4194304),r}function qr(r){for(var s=[],o=0;31>o;o++)s.push(r);return s}function ia(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Sf(r,s,o,u,p,y){var E=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var O=r.entanglements,G=r.expirationTimes,se=r.hiddenUpdates;for(o=E&~o;0<o;){var pe=31-Ot(o),_e=1<<pe;O[pe]=0,G[pe]=-1;var le=se[pe];if(le!==null)for(se[pe]=null,pe=0;pe<le.length;pe++){var he=le[pe];he!==null&&(he.lane&=-536870913)}o&=~_e}u!==0&&sa(r,u,0),y!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=y&~(E&~s))}function sa(r,s,o){r.pendingLanes|=s,r.suspendedLanes&=~s;var u=31-Ot(s);r.entangledLanes|=s,r.entanglements[u]=r.entanglements[u]|1073741824|o&261930}function Ml(r,s){var o=r.entangledLanes|=s;for(r=r.entanglements;o;){var u=31-Ot(o),p=1<<u;p&s|r[u]&s&&(r[u]|=s),o&=~p}}function kl(r,s){var o=s&-s;return o=(o&42)!==0?1:aa(o),(o&(r.suspendedLanes|s))!==0?0:o}function aa(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function _i(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Du(){var r=Q.p;return r!==0?r:(r=window.event,r===void 0?32:cb(r.type))}function Tr(r,s){var o=Q.p;try{return Q.p=r,s()}finally{Q.p=o}}var Ar=Math.random().toString(36).slice(2),Ut="__reactFiber$"+Ar,an="__reactProps$"+Ar,Hr="__reactContainer$"+Ar,eo="__reactEvents$"+Ar,wf="__reactListeners$"+Ar,Iu="__reactHandles$"+Ar,ju="__reactResources$"+Ar,Gr="__reactMarker$"+Ar;function to(r){delete r[Ut],delete r[an],delete r[eo],delete r[wf],delete r[Iu]}function Qr(r){var s=r[Ut];if(s)return s;for(var o=r.parentNode;o;){if(s=o[Hr]||o[Ut]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(r=$v(r);r!==null;){if(o=r[Ut])return o;r=$v(r)}return s}r=o,o=r.parentNode}return null}function ar(r){if(r=r[Ut]||r[Hr]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function Gn(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function $r(r){var s=r[ju];return s||(s=r[ju]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Bt(r){r[Gr]=!0}var Nl=new Set,Pl={};function Kr(r,s){Wr(r,s),Wr(r+"Capture",s)}function Wr(r,s){for(Pl[r]=s,r=0;r<s.length;r++)Nl.add(s[r])}var Ll=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vl={},zl={};function Ou(r){return At.call(zl,r)?!0:At.call(Vl,r)?!1:Ll.test(r)?zl[r]=!0:(Vl[r]=!0,!1)}function no(r,s,o){if(Ou(s))if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+o)}}function Qn(r,s,o){if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+o)}}function Ft(r,s,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(s,o,""+u)}}function on(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Zi(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ul(r,s,o){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,y=u.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return p.call(this)},set:function(E){o=""+E,y.call(this,E)}}),Object.defineProperty(r,s,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function ot(r){if(!r._valueTracker){var s=Zi(r)?"checked":"value";r._valueTracker=Ul(r,s,""+r[s])}}function oa(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var o=s.getValue(),u="";return r&&(u=Zi(r)?r.checked?"true":"false":r.value),r=u,r!==o?(s.setValue(r),!0):!1}function Yr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var la=/[\n"\\]/g;function Mn(r){return r.replace(la,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function ro(r,s,o,u,p,y,E,O){r.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?r.type=E:r.removeAttribute("type"),s!=null?E==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+on(s)):r.value!==""+on(s)&&(r.value=""+on(s)):E!=="submit"&&E!=="reset"||r.removeAttribute("value"),s!=null?Bl(r,E,on(s)):o!=null?Bl(r,E,on(o)):u!=null&&r.removeAttribute("value"),p==null&&y!=null&&(r.defaultChecked=!!y),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?r.name=""+on(O):r.removeAttribute("name")}function Mu(r,s,o,u,p,y,E,O){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ot(r);return}o=o!=null?""+on(o):"",s=s!=null?""+on(s):o,O||s===r.value||(r.value=s),r.defaultValue=s}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=O?r.checked:!!u,r.defaultChecked=!!u,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.name=E),ot(r)}function Bl(r,s,o){s==="number"&&Yr(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function es(r,s,o,u){if(r=r.options,s){s={};for(var p=0;p<o.length;p++)s["$"+o[p]]=!0;for(o=0;o<r.length;o++)p=s.hasOwnProperty("$"+r[o].value),r[o].selected!==p&&(r[o].selected=p),p&&u&&(r[o].defaultSelected=!0)}else{for(o=""+on(o),s=null,p=0;p<r.length;p++){if(r[p].value===o){r[p].selected=!0,u&&(r[p].defaultSelected=!0);return}s!==null||r[p].disabled||(s=r[p])}s!==null&&(s.selected=!0)}}function ku(r,s,o){if(s!=null&&(s=""+on(s),s!==r.value&&(r.value=s),o==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=o!=null?""+on(o):""}function ts(r,s,o,u){if(s==null){if(u!=null){if(o!=null)throw Error(i(92));if(q(u)){if(1<u.length)throw Error(i(93));u=u[0]}o=u}o==null&&(o=""),s=o}o=on(s),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u),ot(r)}function kn(r,s){if(s){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=s;return}}r.textContent=s}var Nu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Fl(r,s,o){var u=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":u?r.setProperty(s,o):typeof o!="number"||o===0||Nu.has(s)?s==="float"?r.cssFloat=o:r[s]=(""+o).trim():r[s]=o+"px"}function ql(r,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var p in s)u=s[p],s.hasOwnProperty(p)&&o[p]!==u&&Fl(r,p,u)}else for(var y in s)s.hasOwnProperty(y)&&Fl(r,y,s[y])}function io(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ns=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function so(r){return ns.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Cr(){}var Hl=null;function or(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var rs=null,Xr=null;function ca(r){var s=ar(r);if(s&&(r=s.stateNode)){var o=r[an]||null;e:switch(r=s.stateNode,s.type){case"input":if(ro(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Mn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var u=o[s];if(u!==r&&u.form===r.form){var p=u[an]||null;if(!p)throw Error(i(90));ro(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<o.length;s++)u=o[s],u.form===r.form&&oa(u)}break e;case"textarea":ku(r,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&es(r,!!o.multiple,s,!1)}}}var ao=!1;function is(r,s,o){if(ao)return r(s,o);ao=!0;try{var u=r(s);return u}finally{if(ao=!1,(rs!==null||Xr!==null)&&(Dd(),rs&&(s=rs,r=Xr,Xr=rs=null,ca(s),r)))for(s=0;s<r.length;s++)ca(r[s])}}function Rr(r,s){var o=r.stateNode;if(o===null)return null;var u=o[an]||null;if(u===null)return null;o=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var lr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ua=!1;if(lr)try{var ut={};Object.defineProperty(ut,"passive",{get:function(){ua=!0}}),window.addEventListener("test",ut,ut),window.removeEventListener("test",ut,ut)}catch{ua=!1}var Jr=null,Gl=null,da=null;function Ql(){if(da)return da;var r,s=Gl,o=s.length,u,p="value"in Jr?Jr.value:Jr.textContent,y=p.length;for(r=0;r<o&&s[r]===p[r];r++);var E=o-r;for(u=1;u<=E&&s[o-u]===p[y-u];u++);return da=p.slice(r,1<u?1-u:void 0)}function ha(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function vi(){return!0}function Dr(){return!1}function fn(r){function s(o,u,p,y,E){this._reactName=o,this._targetInst=p,this.type=u,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var O in r)r.hasOwnProperty(O)&&(o=r[O],this[O]=o?o(y):y[O]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?vi:Dr,this.isPropagationStopped=Dr,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=vi)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=vi)},persist:function(){},isPersistent:vi}),s}var bi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zr=fn(bi),ss=v({},bi,{view:0,detail:0}),$l=fn(ss),as,oo,ei,lo=v({},ss,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:os,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ei&&(ei&&r.type==="mousemove"?(as=r.screenX-ei.screenX,oo=r.screenY-ei.screenY):oo=as=0,ei=r),as)},movementY:function(r){return"movementY"in r?r.movementY:oo}}),Kl=fn(lo),fa=v({},lo,{dataTransfer:0}),Lu=fn(fa),Vu=v({},ss,{relatedTarget:0}),ma=fn(Vu),Wl=v({},bi,{animationName:0,elapsedTime:0,pseudoElement:0}),zu=fn(Wl),co=v({},bi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Uu=fn(co),Bu=v({},bi,{data:0}),ti=fn(Bu),Fu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gu(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=Hu[r])?!!s[r]:!1}function os(){return Gu}var Cn=v({},ss,{key:function(r){if(r.key){var s=Fu[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=ha(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?qu[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:os,charCode:function(r){return r.type==="keypress"?ha(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ha(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Qu=fn(Cn),$u=v({},lo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xi=fn($u),f=v({},ss,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:os}),x=fn(f),S=v({},bi,{propertyName:0,elapsedTime:0,pseudoElement:0}),V=fn(S),ne=v({},lo,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),de=fn(ne),we=v({},bi,{newState:0,oldState:0}),Be=fn(we),Mt=[9,13,27,32],rt=lr&&"CompositionEvent"in window,xt=null;lr&&"documentMode"in document&&(xt=document.documentMode);var cr=lr&&"TextEvent"in window&&!xt,ni=lr&&(!rt||xt&&8<xt&&11>=xt),Ir=" ",jr=!1;function pa(r,s){switch(r){case"keyup":return Mt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uo(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ho=!1;function MT(r,s){switch(r){case"compositionend":return uo(s);case"keypress":return s.which!==32?null:(jr=!0,Ir);case"textInput":return r=s.data,r===Ir&&jr?null:r;default:return null}}function kT(r,s){if(ho)return r==="compositionend"||!rt&&pa(r,s)?(r=Ql(),da=Gl=Jr=null,ho=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ni&&s.locale!=="ko"?null:s.data;default:return null}}var NT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yy(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!NT[r.type]:s==="textarea"}function Xy(r,s,o,u){rs?Xr?Xr.push(u):Xr=[u]:rs=u,s=Pd(s,"onChange"),0<s.length&&(o=new Zr("onChange","change",null,o,u),r.push({event:o,listeners:s}))}var Yl=null,Xl=null;function PT(r){Mv(r,0)}function Ku(r){var s=Gn(r);if(oa(s))return r}function Jy(r,s){if(r==="change")return s}var Zy=!1;if(lr){var Tf;if(lr){var Af="oninput"in document;if(!Af){var e_=document.createElement("div");e_.setAttribute("oninput","return;"),Af=typeof e_.oninput=="function"}Tf=Af}else Tf=!1;Zy=Tf&&(!document.documentMode||9<document.documentMode)}function t_(){Yl&&(Yl.detachEvent("onpropertychange",n_),Xl=Yl=null)}function n_(r){if(r.propertyName==="value"&&Ku(Xl)){var s=[];Xy(s,Xl,r,or(r)),is(PT,s)}}function LT(r,s,o){r==="focusin"?(t_(),Yl=s,Xl=o,Yl.attachEvent("onpropertychange",n_)):r==="focusout"&&t_()}function VT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Ku(Xl)}function zT(r,s){if(r==="click")return Ku(s)}function UT(r,s){if(r==="input"||r==="change")return Ku(s)}function BT(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var $n=typeof Object.is=="function"?Object.is:BT;function Jl(r,s){if($n(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var o=Object.keys(r),u=Object.keys(s);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var p=o[u];if(!At.call(s,p)||!$n(r[p],s[p]))return!1}return!0}function r_(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function i_(r,s){var o=r_(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=s&&u>=s)return{node:o,offset:s-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=r_(o)}}function s_(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?s_(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function a_(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=Yr(r.document);s instanceof r.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)r=s.contentWindow;else break;s=Yr(r.document)}return s}function Cf(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var FT=lr&&"documentMode"in document&&11>=document.documentMode,fo=null,Rf=null,Zl=null,Df=!1;function o_(r,s,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Df||fo==null||fo!==Yr(u)||(u=fo,"selectionStart"in u&&Cf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Zl&&Jl(Zl,u)||(Zl=u,u=Pd(Rf,"onSelect"),0<u.length&&(s=new Zr("onSelect","select",null,s,o),r.push({event:s,listeners:u}),s.target=fo)))}function ga(r,s){var o={};return o[r.toLowerCase()]=s.toLowerCase(),o["Webkit"+r]="webkit"+s,o["Moz"+r]="moz"+s,o}var mo={animationend:ga("Animation","AnimationEnd"),animationiteration:ga("Animation","AnimationIteration"),animationstart:ga("Animation","AnimationStart"),transitionrun:ga("Transition","TransitionRun"),transitionstart:ga("Transition","TransitionStart"),transitioncancel:ga("Transition","TransitionCancel"),transitionend:ga("Transition","TransitionEnd")},If={},l_={};lr&&(l_=document.createElement("div").style,"AnimationEvent"in window||(delete mo.animationend.animation,delete mo.animationiteration.animation,delete mo.animationstart.animation),"TransitionEvent"in window||delete mo.transitionend.transition);function ya(r){if(If[r])return If[r];if(!mo[r])return r;var s=mo[r],o;for(o in s)if(s.hasOwnProperty(o)&&o in l_)return If[r]=s[o];return r}var c_=ya("animationend"),u_=ya("animationiteration"),d_=ya("animationstart"),qT=ya("transitionrun"),HT=ya("transitionstart"),GT=ya("transitioncancel"),h_=ya("transitionend"),f_=new Map,jf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jf.push("scrollEnd");function Or(r,s){f_.set(r,s),Kr(s,[r])}var Wu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},ur=[],po=0,Of=0;function Yu(){for(var r=po,s=Of=po=0;s<r;){var o=ur[s];ur[s++]=null;var u=ur[s];ur[s++]=null;var p=ur[s];ur[s++]=null;var y=ur[s];if(ur[s++]=null,u!==null&&p!==null){var E=u.pending;E===null?p.next=p:(p.next=E.next,E.next=p),u.pending=p}y!==0&&m_(o,p,y)}}function Xu(r,s,o,u){ur[po++]=r,ur[po++]=s,ur[po++]=o,ur[po++]=u,Of|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function Mf(r,s,o,u){return Xu(r,s,o,u),Ju(r)}function _a(r,s){return Xu(r,null,null,s),Ju(r)}function m_(r,s,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var p=!1,y=r.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(p=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,p&&s!==null&&(p=31-Ot(o),r=y.hiddenUpdates,u=r[p],u===null?r[p]=[s]:u.push(s),s.lane=o|536870912),y):null}function Ju(r){if(50<xc)throw xc=0,Fm=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var go={};function QT(r,s,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kn(r,s,o,u){return new QT(r,s,o,u)}function kf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ei(r,s){var o=r.alternate;return o===null?(o=Kn(r.tag,s,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=s,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,s=r.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function p_(r,s){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,s=o.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function Zu(r,s,o,u,p,y){var E=0;if(u=r,typeof r=="function")kf(r)&&(E=1);else if(typeof r=="string")E=XA(r,o,X.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case D:return r=Kn(31,o,s,p),r.elementType=D,r.lanes=y,r;case T:return va(o.children,p,y,s);case j:E=8,p|=24;break;case B:return r=Kn(12,o,s,p|2),r.elementType=B,r.lanes=y,r;case $:return r=Kn(13,o,s,p),r.elementType=$,r.lanes=y,r;case re:return r=Kn(19,o,s,p),r.elementType=re,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case z:E=10;break e;case H:E=9;break e;case J:E=11;break e;case P:E=14;break e;case R:E=16,u=null;break e}E=29,o=Error(i(130,r===null?"null":typeof r,"")),u=null}return s=Kn(E,o,s,p),s.elementType=r,s.type=u,s.lanes=y,s}function va(r,s,o,u){return r=Kn(7,r,u,s),r.lanes=o,r}function Nf(r,s,o){return r=Kn(6,r,null,s),r.lanes=o,r}function g_(r){var s=Kn(18,null,null,0);return s.stateNode=r,s}function Pf(r,s,o){return s=Kn(4,r.children!==null?r.children:[],r.key,s),s.lanes=o,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var y_=new WeakMap;function dr(r,s){if(typeof r=="object"&&r!==null){var o=y_.get(r);return o!==void 0?o:(s={value:r,source:s,stack:Xi(s)},y_.set(r,s),s)}return{value:r,source:s,stack:Xi(s)}}var yo=[],_o=0,ed=null,ec=0,hr=[],fr=0,ls=null,ri=1,ii="";function Si(r,s){yo[_o++]=ec,yo[_o++]=ed,ed=r,ec=s}function __(r,s,o){hr[fr++]=ri,hr[fr++]=ii,hr[fr++]=ls,ls=r;var u=ri;r=ii;var p=32-Ot(u)-1;u&=~(1<<p),o+=1;var y=32-Ot(s)+p;if(30<y){var E=p-p%5;y=(u&(1<<E)-1).toString(32),u>>=E,p-=E,ri=1<<32-Ot(s)+p|o<<p|u,ii=y+r}else ri=1<<y|o<<p|u,ii=r}function Lf(r){r.return!==null&&(Si(r,1),__(r,1,0))}function Vf(r){for(;r===ed;)ed=yo[--_o],yo[_o]=null,ec=yo[--_o],yo[_o]=null;for(;r===ls;)ls=hr[--fr],hr[fr]=null,ii=hr[--fr],hr[fr]=null,ri=hr[--fr],hr[fr]=null}function v_(r,s){hr[fr++]=ri,hr[fr++]=ii,hr[fr++]=ls,ri=s.id,ii=s.overflow,ls=r}var mn=null,_t=null,Je=!1,cs=null,mr=!1,zf=Error(i(519));function us(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw tc(dr(s,r)),zf}function b_(r){var s=r.stateNode,o=r.type,u=r.memoizedProps;switch(s[Ut]=r,s[an]=u,o){case"dialog":Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":case"embed":Ge("load",s);break;case"video":case"audio":for(o=0;o<Sc.length;o++)Ge(Sc[o],s);break;case"source":Ge("error",s);break;case"img":case"image":case"link":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"input":Ge("invalid",s),Mu(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ge("invalid",s);break;case"textarea":Ge("invalid",s),ts(s,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||u.suppressHydrationWarning===!0||Lv(s.textContent,o)?(u.popover!=null&&(Ge("beforetoggle",s),Ge("toggle",s)),u.onScroll!=null&&Ge("scroll",s),u.onScrollEnd!=null&&Ge("scrollend",s),u.onClick!=null&&(s.onclick=Cr),s=!0):s=!1,s||us(r,!0)}function x_(r){for(mn=r.return;mn;)switch(mn.tag){case 5:case 31:case 13:mr=!1;return;case 27:case 3:mr=!0;return;default:mn=mn.return}}function vo(r){if(r!==mn)return!1;if(!Je)return x_(r),Je=!0,!1;var s=r.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||rp(r.type,r.memoizedProps)),o=!o),o&&_t&&us(r),x_(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));_t=Qv(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));_t=Qv(r)}else s===27?(s=_t,ws(r.type)?(r=lp,lp=null,_t=r):_t=s):_t=mn?gr(r.stateNode.nextSibling):null;return!0}function ba(){_t=mn=null,Je=!1}function Uf(){var r=cs;return r!==null&&(Vn===null?Vn=r:Vn.push.apply(Vn,r),cs=null),r}function tc(r){cs===null?cs=[r]:cs.push(r)}var Bf=U(null),xa=null,wi=null;function ds(r,s,o){W(Bf,s._currentValue),s._currentValue=o}function Ti(r){r._currentValue=Bf.current,F(Bf)}function Ff(r,s,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),r===o)break;r=r.return}}function qf(r,s,o,u){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var y=p.dependencies;if(y!==null){var E=p.child;y=y.firstContext;e:for(;y!==null;){var O=y;y=p;for(var G=0;G<s.length;G++)if(O.context===s[G]){y.lanes|=o,O=y.alternate,O!==null&&(O.lanes|=o),Ff(y.return,o,r),u||(E=null);break e}y=O.next}}else if(p.tag===18){if(E=p.return,E===null)throw Error(i(341));E.lanes|=o,y=E.alternate,y!==null&&(y.lanes|=o),Ff(E,o,r),E=null}else E=p.child;if(E!==null)E.return=p;else for(E=p;E!==null;){if(E===r){E=null;break}if(p=E.sibling,p!==null){p.return=E.return,E=p;break}E=E.return}p=E}}function bo(r,s,o,u){r=null;for(var p=s,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var E=p.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var O=p.type;$n(p.pendingProps.value,E.value)||(r!==null?r.push(O):r=[O])}}else if(p===me.current){if(E=p.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(Rc):r=[Rc])}p=p.return}r!==null&&qf(s,r,o,u),s.flags|=262144}function td(r){for(r=r.firstContext;r!==null;){if(!$n(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ea(r){xa=r,wi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function pn(r){return E_(xa,r)}function nd(r,s){return xa===null&&Ea(r),E_(r,s)}function E_(r,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},wi===null){if(r===null)throw Error(i(308));wi=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else wi=wi.next=s;return o}var $T=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){s.aborted=!0,r.forEach(function(o){return o()})}},KT=t.unstable_scheduleCallback,WT=t.unstable_NormalPriority,qt={$$typeof:z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Hf(){return{controller:new $T,data:new Map,refCount:0}}function nc(r){r.refCount--,r.refCount===0&&KT(WT,function(){r.controller.abort()})}var rc=null,Gf=0,xo=0,Eo=null;function YT(r,s){if(rc===null){var o=rc=[];Gf=0,xo=Km(),Eo={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Gf++,s.then(S_,S_),s}function S_(){if(--Gf===0&&rc!==null){Eo!==null&&(Eo.status="fulfilled");var r=rc;rc=null,xo=0,Eo=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function XT(r,s){var o=[],u={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return r.then(function(){u.status="fulfilled",u.value=s;for(var p=0;p<o.length;p++)(0,o[p])(s)},function(p){for(u.status="rejected",u.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),u}var w_=L.S;L.S=function(r,s){ov=Ct(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&YT(r,s),w_!==null&&w_(r,s)};var Sa=U(null);function Qf(){var r=Sa.current;return r!==null?r:mt.pooledCache}function rd(r,s){s===null?W(Sa,Sa.current):W(Sa,s.pool)}function T_(){var r=Qf();return r===null?null:{parent:qt._currentValue,pool:r}}var So=Error(i(460)),$f=Error(i(474)),id=Error(i(542)),sd={then:function(){}};function A_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function C_(r,s,o){switch(o=r[o],o===void 0?r.push(s):o!==s&&(s.then(Cr,Cr),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,D_(r),r;default:if(typeof s.status=="string")s.then(Cr,Cr);else{if(r=mt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(u){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=u}},function(u){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,D_(r),r}throw Ta=s,So}}function wa(r){try{var s=r._init;return s(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ta=o,So):o}}var Ta=null;function R_(){if(Ta===null)throw Error(i(459));var r=Ta;return Ta=null,r}function D_(r){if(r===So||r===id)throw Error(i(483))}var wo=null,ic=0;function ad(r){var s=ic;return ic+=1,wo===null&&(wo=[]),C_(wo,r,s)}function sc(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function od(r,s){throw s.$$typeof===b?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function I_(r){function s(te,Y){if(r){var ie=te.deletions;ie===null?(te.deletions=[Y],te.flags|=16):ie.push(Y)}}function o(te,Y){if(!r)return null;for(;Y!==null;)s(te,Y),Y=Y.sibling;return null}function u(te){for(var Y=new Map;te!==null;)te.key!==null?Y.set(te.key,te):Y.set(te.index,te),te=te.sibling;return Y}function p(te,Y){return te=Ei(te,Y),te.index=0,te.sibling=null,te}function y(te,Y,ie){return te.index=ie,r?(ie=te.alternate,ie!==null?(ie=ie.index,ie<Y?(te.flags|=67108866,Y):ie):(te.flags|=67108866,Y)):(te.flags|=1048576,Y)}function E(te){return r&&te.alternate===null&&(te.flags|=67108866),te}function O(te,Y,ie,ye){return Y===null||Y.tag!==6?(Y=Nf(ie,te.mode,ye),Y.return=te,Y):(Y=p(Y,ie),Y.return=te,Y)}function G(te,Y,ie,ye){var Ie=ie.type;return Ie===T?pe(te,Y,ie.props.children,ye,ie.key):Y!==null&&(Y.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===R&&wa(Ie)===Y.type)?(Y=p(Y,ie.props),sc(Y,ie),Y.return=te,Y):(Y=Zu(ie.type,ie.key,ie.props,null,te.mode,ye),sc(Y,ie),Y.return=te,Y)}function se(te,Y,ie,ye){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==ie.containerInfo||Y.stateNode.implementation!==ie.implementation?(Y=Pf(ie,te.mode,ye),Y.return=te,Y):(Y=p(Y,ie.children||[]),Y.return=te,Y)}function pe(te,Y,ie,ye,Ie){return Y===null||Y.tag!==7?(Y=va(ie,te.mode,ye,Ie),Y.return=te,Y):(Y=p(Y,ie),Y.return=te,Y)}function _e(te,Y,ie){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=Nf(""+Y,te.mode,ie),Y.return=te,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case w:return ie=Zu(Y.type,Y.key,Y.props,null,te.mode,ie),sc(ie,Y),ie.return=te,ie;case C:return Y=Pf(Y,te.mode,ie),Y.return=te,Y;case R:return Y=wa(Y),_e(te,Y,ie)}if(q(Y)||k(Y))return Y=va(Y,te.mode,ie,null),Y.return=te,Y;if(typeof Y.then=="function")return _e(te,ad(Y),ie);if(Y.$$typeof===z)return _e(te,nd(te,Y),ie);od(te,Y)}return null}function le(te,Y,ie,ye){var Ie=Y!==null?Y.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Ie!==null?null:O(te,Y,""+ie,ye);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case w:return ie.key===Ie?G(te,Y,ie,ye):null;case C:return ie.key===Ie?se(te,Y,ie,ye):null;case R:return ie=wa(ie),le(te,Y,ie,ye)}if(q(ie)||k(ie))return Ie!==null?null:pe(te,Y,ie,ye,null);if(typeof ie.then=="function")return le(te,Y,ad(ie),ye);if(ie.$$typeof===z)return le(te,Y,nd(te,ie),ye);od(te,ie)}return null}function he(te,Y,ie,ye,Ie){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return te=te.get(ie)||null,O(Y,te,""+ye,Ie);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case w:return te=te.get(ye.key===null?ie:ye.key)||null,G(Y,te,ye,Ie);case C:return te=te.get(ye.key===null?ie:ye.key)||null,se(Y,te,ye,Ie);case R:return ye=wa(ye),he(te,Y,ie,ye,Ie)}if(q(ye)||k(ye))return te=te.get(ie)||null,pe(Y,te,ye,Ie,null);if(typeof ye.then=="function")return he(te,Y,ie,ad(ye),Ie);if(ye.$$typeof===z)return he(te,Y,ie,nd(Y,ye),Ie);od(Y,ye)}return null}function Ce(te,Y,ie,ye){for(var Ie=null,et=null,Re=Y,qe=Y=0,Ke=null;Re!==null&&qe<ie.length;qe++){Re.index>qe?(Ke=Re,Re=null):Ke=Re.sibling;var tt=le(te,Re,ie[qe],ye);if(tt===null){Re===null&&(Re=Ke);break}r&&Re&&tt.alternate===null&&s(te,Re),Y=y(tt,Y,qe),et===null?Ie=tt:et.sibling=tt,et=tt,Re=Ke}if(qe===ie.length)return o(te,Re),Je&&Si(te,qe),Ie;if(Re===null){for(;qe<ie.length;qe++)Re=_e(te,ie[qe],ye),Re!==null&&(Y=y(Re,Y,qe),et===null?Ie=Re:et.sibling=Re,et=Re);return Je&&Si(te,qe),Ie}for(Re=u(Re);qe<ie.length;qe++)Ke=he(Re,te,qe,ie[qe],ye),Ke!==null&&(r&&Ke.alternate!==null&&Re.delete(Ke.key===null?qe:Ke.key),Y=y(Ke,Y,qe),et===null?Ie=Ke:et.sibling=Ke,et=Ke);return r&&Re.forEach(function(Ds){return s(te,Ds)}),Je&&Si(te,qe),Ie}function Oe(te,Y,ie,ye){if(ie==null)throw Error(i(151));for(var Ie=null,et=null,Re=Y,qe=Y=0,Ke=null,tt=ie.next();Re!==null&&!tt.done;qe++,tt=ie.next()){Re.index>qe?(Ke=Re,Re=null):Ke=Re.sibling;var Ds=le(te,Re,tt.value,ye);if(Ds===null){Re===null&&(Re=Ke);break}r&&Re&&Ds.alternate===null&&s(te,Re),Y=y(Ds,Y,qe),et===null?Ie=Ds:et.sibling=Ds,et=Ds,Re=Ke}if(tt.done)return o(te,Re),Je&&Si(te,qe),Ie;if(Re===null){for(;!tt.done;qe++,tt=ie.next())tt=_e(te,tt.value,ye),tt!==null&&(Y=y(tt,Y,qe),et===null?Ie=tt:et.sibling=tt,et=tt);return Je&&Si(te,qe),Ie}for(Re=u(Re);!tt.done;qe++,tt=ie.next())tt=he(Re,te,qe,tt.value,ye),tt!==null&&(r&&tt.alternate!==null&&Re.delete(tt.key===null?qe:tt.key),Y=y(tt,Y,qe),et===null?Ie=tt:et.sibling=tt,et=tt);return r&&Re.forEach(function(lC){return s(te,lC)}),Je&&Si(te,qe),Ie}function ft(te,Y,ie,ye){if(typeof ie=="object"&&ie!==null&&ie.type===T&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case w:e:{for(var Ie=ie.key;Y!==null;){if(Y.key===Ie){if(Ie=ie.type,Ie===T){if(Y.tag===7){o(te,Y.sibling),ye=p(Y,ie.props.children),ye.return=te,te=ye;break e}}else if(Y.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===R&&wa(Ie)===Y.type){o(te,Y.sibling),ye=p(Y,ie.props),sc(ye,ie),ye.return=te,te=ye;break e}o(te,Y);break}else s(te,Y);Y=Y.sibling}ie.type===T?(ye=va(ie.props.children,te.mode,ye,ie.key),ye.return=te,te=ye):(ye=Zu(ie.type,ie.key,ie.props,null,te.mode,ye),sc(ye,ie),ye.return=te,te=ye)}return E(te);case C:e:{for(Ie=ie.key;Y!==null;){if(Y.key===Ie)if(Y.tag===4&&Y.stateNode.containerInfo===ie.containerInfo&&Y.stateNode.implementation===ie.implementation){o(te,Y.sibling),ye=p(Y,ie.children||[]),ye.return=te,te=ye;break e}else{o(te,Y);break}else s(te,Y);Y=Y.sibling}ye=Pf(ie,te.mode,ye),ye.return=te,te=ye}return E(te);case R:return ie=wa(ie),ft(te,Y,ie,ye)}if(q(ie))return Ce(te,Y,ie,ye);if(k(ie)){if(Ie=k(ie),typeof Ie!="function")throw Error(i(150));return ie=Ie.call(ie),Oe(te,Y,ie,ye)}if(typeof ie.then=="function")return ft(te,Y,ad(ie),ye);if(ie.$$typeof===z)return ft(te,Y,nd(te,ie),ye);od(te,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,Y!==null&&Y.tag===6?(o(te,Y.sibling),ye=p(Y,ie),ye.return=te,te=ye):(o(te,Y),ye=Nf(ie,te.mode,ye),ye.return=te,te=ye),E(te)):o(te,Y)}return function(te,Y,ie,ye){try{ic=0;var Ie=ft(te,Y,ie,ye);return wo=null,Ie}catch(Re){if(Re===So||Re===id)throw Re;var et=Kn(29,Re,null,te.mode);return et.lanes=ye,et.return=te,et}}}var Aa=I_(!0),j_=I_(!1),hs=!1;function Kf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wf(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function fs(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ms(r,s,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(it&2)!==0){var p=u.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),u.pending=s,s=Ju(r),m_(r,null,o),s}return Xu(r,u,s,o),Ju(r)}function ac(r,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var u=s.lanes;u&=r.pendingLanes,o|=u,s.lanes=o,Ml(r,o)}}function Yf(r,s){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?p=y=E:y=y.next=E,o=o.next}while(o!==null);y===null?p=y=s:y=y.next=s}else p=y=s;o={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=s:r.next=s,o.lastBaseUpdate=s}var Xf=!1;function oc(){if(Xf){var r=Eo;if(r!==null)throw r}}function lc(r,s,o,u){Xf=!1;var p=r.updateQueue;hs=!1;var y=p.firstBaseUpdate,E=p.lastBaseUpdate,O=p.shared.pending;if(O!==null){p.shared.pending=null;var G=O,se=G.next;G.next=null,E===null?y=se:E.next=se,E=G;var pe=r.alternate;pe!==null&&(pe=pe.updateQueue,O=pe.lastBaseUpdate,O!==E&&(O===null?pe.firstBaseUpdate=se:O.next=se,pe.lastBaseUpdate=G))}if(y!==null){var _e=p.baseState;E=0,pe=se=G=null,O=y;do{var le=O.lane&-536870913,he=le!==O.lane;if(he?($e&le)===le:(u&le)===le){le!==0&&le===xo&&(Xf=!0),pe!==null&&(pe=pe.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Ce=r,Oe=O;le=s;var ft=o;switch(Oe.tag){case 1:if(Ce=Oe.payload,typeof Ce=="function"){_e=Ce.call(ft,_e,le);break e}_e=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=Oe.payload,le=typeof Ce=="function"?Ce.call(ft,_e,le):Ce,le==null)break e;_e=v({},_e,le);break e;case 2:hs=!0}}le=O.callback,le!==null&&(r.flags|=64,he&&(r.flags|=8192),he=p.callbacks,he===null?p.callbacks=[le]:he.push(le))}else he={lane:le,tag:O.tag,payload:O.payload,callback:O.callback,next:null},pe===null?(se=pe=he,G=_e):pe=pe.next=he,E|=le;if(O=O.next,O===null){if(O=p.shared.pending,O===null)break;he=O,O=he.next,he.next=null,p.lastBaseUpdate=he,p.shared.pending=null}}while(!0);pe===null&&(G=_e),p.baseState=G,p.firstBaseUpdate=se,p.lastBaseUpdate=pe,y===null&&(p.shared.lanes=0),vs|=E,r.lanes=E,r.memoizedState=_e}}function O_(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function M_(r,s){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)O_(o[r],s)}var To=U(null),ld=U(0);function k_(r,s){r=ki,W(ld,r),W(To,s),ki=r|s.baseLanes}function Jf(){W(ld,ki),W(To,To.current)}function Zf(){ki=ld.current,F(To),F(ld)}var Wn=U(null),pr=null;function ps(r){var s=r.alternate;W(kt,kt.current&1),W(Wn,r),pr===null&&(s===null||To.current!==null||s.memoizedState!==null)&&(pr=r)}function em(r){W(kt,kt.current),W(Wn,r),pr===null&&(pr=r)}function N_(r){r.tag===22?(W(kt,kt.current),W(Wn,r),pr===null&&(pr=r)):gs()}function gs(){W(kt,kt.current),W(Wn,Wn.current)}function Yn(r){F(Wn),pr===r&&(pr=null),F(kt)}var kt=U(0);function cd(r){for(var s=r;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ap(o)||op(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ai=0,Fe=null,dt=null,Ht=null,ud=!1,Ao=!1,Ca=!1,dd=0,cc=0,Co=null,JT=0;function Rt(){throw Error(i(321))}function tm(r,s){if(s===null)return!1;for(var o=0;o<s.length&&o<r.length;o++)if(!$n(r[o],s[o]))return!1;return!0}function nm(r,s,o,u,p,y){return Ai=y,Fe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,L.H=r===null||r.memoizedState===null?_0:ym,Ca=!1,y=o(u,p),Ca=!1,Ao&&(y=L_(s,o,u,p)),P_(r),y}function P_(r){L.H=hc;var s=dt!==null&&dt.next!==null;if(Ai=0,Ht=dt=Fe=null,ud=!1,cc=0,Co=null,s)throw Error(i(300));r===null||Gt||(r=r.dependencies,r!==null&&td(r)&&(Gt=!0))}function L_(r,s,o,u){Fe=r;var p=0;do{if(Ao&&(Co=null),cc=0,Ao=!1,25<=p)throw Error(i(301));if(p+=1,Ht=dt=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}L.H=v0,y=s(o,u)}while(Ao);return y}function ZT(){var r=L.H,s=r.useState()[0];return s=typeof s.then=="function"?uc(s):s,r=r.useState()[0],(dt!==null?dt.memoizedState:null)!==r&&(Fe.flags|=1024),s}function rm(){var r=dd!==0;return dd=0,r}function im(r,s,o){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~o}function sm(r){if(ud){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ud=!1}Ai=0,Ht=dt=Fe=null,Ao=!1,cc=dd=0,Co=null}function Rn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?Fe.memoizedState=Ht=r:Ht=Ht.next=r,Ht}function Nt(){if(dt===null){var r=Fe.alternate;r=r!==null?r.memoizedState:null}else r=dt.next;var s=Ht===null?Fe.memoizedState:Ht.next;if(s!==null)Ht=s,dt=r;else{if(r===null)throw Fe.alternate===null?Error(i(467)):Error(i(310));dt=r,r={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},Ht===null?Fe.memoizedState=Ht=r:Ht=Ht.next=r}return Ht}function hd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function uc(r){var s=cc;return cc+=1,Co===null&&(Co=[]),r=C_(Co,r,s),s=Fe,(Ht===null?s.memoizedState:Ht.next)===null&&(s=s.alternate,L.H=s===null||s.memoizedState===null?_0:ym),r}function fd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return uc(r);if(r.$$typeof===z)return pn(r)}throw Error(i(438,String(r)))}function am(r){var s=null,o=Fe.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var u=Fe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=hd(),Fe.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(r),u=0;u<r;u++)o[u]=N;return s.index++,o}function Ci(r,s){return typeof s=="function"?s(r):s}function md(r){var s=Nt();return om(s,dt,r)}function om(r,s,o){var u=r.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=o;var p=r.baseQueue,y=u.pending;if(y!==null){if(p!==null){var E=p.next;p.next=y.next,y.next=E}s.baseQueue=p=y,u.pending=null}if(y=r.baseState,p===null)r.memoizedState=y;else{s=p.next;var O=E=null,G=null,se=s,pe=!1;do{var _e=se.lane&-536870913;if(_e!==se.lane?($e&_e)===_e:(Ai&_e)===_e){var le=se.revertLane;if(le===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),_e===xo&&(pe=!0);else if((Ai&le)===le){se=se.next,le===xo&&(pe=!0);continue}else _e={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},G===null?(O=G=_e,E=y):G=G.next=_e,Fe.lanes|=le,vs|=le;_e=se.action,Ca&&o(y,_e),y=se.hasEagerState?se.eagerState:o(y,_e)}else le={lane:_e,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},G===null?(O=G=le,E=y):G=G.next=le,Fe.lanes|=_e,vs|=_e;se=se.next}while(se!==null&&se!==s);if(G===null?E=y:G.next=O,!$n(y,r.memoizedState)&&(Gt=!0,pe&&(o=Eo,o!==null)))throw o;r.memoizedState=y,r.baseState=E,r.baseQueue=G,u.lastRenderedState=y}return p===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function lm(r){var s=Nt(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var u=o.dispatch,p=o.pending,y=s.memoizedState;if(p!==null){o.pending=null;var E=p=p.next;do y=r(y,E.action),E=E.next;while(E!==p);$n(y,s.memoizedState)||(Gt=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,u]}function V_(r,s,o){var u=Fe,p=Nt(),y=Je;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var E=!$n((dt||p).memoizedState,o);if(E&&(p.memoizedState=o,Gt=!0),p=p.queue,dm(B_.bind(null,u,p,r),[r]),p.getSnapshot!==s||E||Ht!==null&&Ht.memoizedState.tag&1){if(u.flags|=2048,Ro(9,{destroy:void 0},U_.bind(null,u,p,o,s),null),mt===null)throw Error(i(349));y||(Ai&127)!==0||z_(u,s,o)}return o}function z_(r,s,o){r.flags|=16384,r={getSnapshot:s,value:o},s=Fe.updateQueue,s===null?(s=hd(),Fe.updateQueue=s,s.stores=[r]):(o=s.stores,o===null?s.stores=[r]:o.push(r))}function U_(r,s,o,u){s.value=o,s.getSnapshot=u,F_(s)&&q_(r)}function B_(r,s,o){return o(function(){F_(s)&&q_(r)})}function F_(r){var s=r.getSnapshot;r=r.value;try{var o=s();return!$n(r,o)}catch{return!0}}function q_(r){var s=_a(r,2);s!==null&&zn(s,r,2)}function cm(r){var s=Rn();if(typeof r=="function"){var o=r;if(r=o(),Ca){sr(!0);try{o()}finally{sr(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ci,lastRenderedState:r},s}function H_(r,s,o,u){return r.baseState=o,om(r,dt,typeof u=="function"?u:Ci)}function eA(r,s,o,u,p){if(yd(r))throw Error(i(485));if(r=s.action,r!==null){var y={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){y.listeners.push(E)}};L.T!==null?o(!0):y.isTransition=!1,u(y),o=s.pending,o===null?(y.next=s.pending=y,G_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function G_(r,s){var o=s.action,u=s.payload,p=r.state;if(s.isTransition){var y=L.T,E={};L.T=E;try{var O=o(p,u),G=L.S;G!==null&&G(E,O),Q_(r,s,O)}catch(se){um(r,s,se)}finally{y!==null&&E.types!==null&&(y.types=E.types),L.T=y}}else try{y=o(p,u),Q_(r,s,y)}catch(se){um(r,s,se)}}function Q_(r,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){$_(r,s,u)},function(u){return um(r,s,u)}):$_(r,s,o)}function $_(r,s,o){s.status="fulfilled",s.value=o,K_(s),r.state=o,s=r.pending,s!==null&&(o=s.next,o===s?r.pending=null:(o=o.next,s.next=o,G_(r,o)))}function um(r,s,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=o,K_(s),s=s.next;while(s!==u)}r.action=null}function K_(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function W_(r,s){return s}function Y_(r,s){if(Je){var o=mt.formState;if(o!==null){e:{var u=Fe;if(Je){if(_t){t:{for(var p=_t,y=mr;p.nodeType!==8;){if(!y){p=null;break t}if(p=gr(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){_t=gr(p.nextSibling),u=p.data==="F!";break e}}us(u)}u=!1}u&&(s=o[0])}}return o=Rn(),o.memoizedState=o.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:W_,lastRenderedState:s},o.queue=u,o=p0.bind(null,Fe,u),u.dispatch=o,u=cm(!1),y=gm.bind(null,Fe,!1,u.queue),u=Rn(),p={state:s,dispatch:null,action:r,pending:null},u.queue=p,o=eA.bind(null,Fe,p,y,o),p.dispatch=o,u.memoizedState=r,[s,o,!1]}function X_(r){var s=Nt();return J_(s,dt,r)}function J_(r,s,o){if(s=om(r,s,W_)[0],r=md(Ci)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var u=uc(s)}catch(E){throw E===So?id:E}else u=s;s=Nt();var p=s.queue,y=p.dispatch;return o!==s.memoizedState&&(Fe.flags|=2048,Ro(9,{destroy:void 0},tA.bind(null,p,o),null)),[u,y,r]}function tA(r,s){r.action=s}function Z_(r){var s=Nt(),o=dt;if(o!==null)return J_(s,o,r);Nt(),s=s.memoizedState,o=Nt();var u=o.queue.dispatch;return o.memoizedState=r,[s,u,!1]}function Ro(r,s,o,u){return r={tag:r,create:o,deps:u,inst:s,next:null},s=Fe.updateQueue,s===null&&(s=hd(),Fe.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,s.lastEffect=r),r}function e0(){return Nt().memoizedState}function pd(r,s,o,u){var p=Rn();Fe.flags|=r,p.memoizedState=Ro(1|s,{destroy:void 0},o,u===void 0?null:u)}function gd(r,s,o,u){var p=Nt();u=u===void 0?null:u;var y=p.memoizedState.inst;dt!==null&&u!==null&&tm(u,dt.memoizedState.deps)?p.memoizedState=Ro(s,y,o,u):(Fe.flags|=r,p.memoizedState=Ro(1|s,y,o,u))}function t0(r,s){pd(8390656,8,r,s)}function dm(r,s){gd(2048,8,r,s)}function nA(r){Fe.flags|=4;var s=Fe.updateQueue;if(s===null)s=hd(),Fe.updateQueue=s,s.events=[r];else{var o=s.events;o===null?s.events=[r]:o.push(r)}}function n0(r){var s=Nt().memoizedState;return nA({ref:s,nextImpl:r}),function(){if((it&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function r0(r,s){return gd(4,2,r,s)}function i0(r,s){return gd(4,4,r,s)}function s0(r,s){if(typeof s=="function"){r=r();var o=s(r);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function a0(r,s,o){o=o!=null?o.concat([r]):null,gd(4,4,s0.bind(null,s,r),o)}function hm(){}function o0(r,s){var o=Nt();s=s===void 0?null:s;var u=o.memoizedState;return s!==null&&tm(s,u[1])?u[0]:(o.memoizedState=[r,s],r)}function l0(r,s){var o=Nt();s=s===void 0?null:s;var u=o.memoizedState;if(s!==null&&tm(s,u[1]))return u[0];if(u=r(),Ca){sr(!0);try{r()}finally{sr(!1)}}return o.memoizedState=[u,s],u}function fm(r,s,o){return o===void 0||(Ai&1073741824)!==0&&($e&261930)===0?r.memoizedState=s:(r.memoizedState=o,r=cv(),Fe.lanes|=r,vs|=r,o)}function c0(r,s,o,u){return $n(o,s)?o:To.current!==null?(r=fm(r,o,u),$n(r,s)||(Gt=!0),r):(Ai&42)===0||(Ai&1073741824)!==0&&($e&261930)===0?(Gt=!0,r.memoizedState=o):(r=cv(),Fe.lanes|=r,vs|=r,s)}function u0(r,s,o,u,p){var y=Q.p;Q.p=y!==0&&8>y?y:8;var E=L.T,O={};L.T=O,gm(r,!1,s,o);try{var G=p(),se=L.S;if(se!==null&&se(O,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var pe=XT(G,u);dc(r,s,pe,Zn(r))}else dc(r,s,u,Zn(r))}catch(_e){dc(r,s,{then:function(){},status:"rejected",reason:_e},Zn())}finally{Q.p=y,E!==null&&O.types!==null&&(E.types=O.types),L.T=E}}function rA(){}function mm(r,s,o,u){if(r.tag!==5)throw Error(i(476));var p=d0(r).queue;u0(r,p,s,K,o===null?rA:function(){return h0(r),o(u)})}function d0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ci,lastRenderedState:K},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ci,lastRenderedState:o},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function h0(r){var s=d0(r);s.next===null&&(s=r.alternate.memoizedState),dc(r,s.next.queue,{},Zn())}function pm(){return pn(Rc)}function f0(){return Nt().memoizedState}function m0(){return Nt().memoizedState}function iA(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var o=Zn();r=fs(o);var u=ms(s,r,o);u!==null&&(zn(u,s,o),ac(u,s,o)),s={cache:Hf()},r.payload=s;return}s=s.return}}function sA(r,s,o){var u=Zn();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},yd(r)?g0(s,o):(o=Mf(r,s,o,u),o!==null&&(zn(o,r,u),y0(o,s,u)))}function p0(r,s,o){var u=Zn();dc(r,s,o,u)}function dc(r,s,o,u){var p={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(yd(r))g0(s,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var E=s.lastRenderedState,O=y(E,o);if(p.hasEagerState=!0,p.eagerState=O,$n(O,E))return Xu(r,s,p,0),mt===null&&Yu(),!1}catch{}if(o=Mf(r,s,p,u),o!==null)return zn(o,r,u),y0(o,s,u),!0}return!1}function gm(r,s,o,u){if(u={lane:2,revertLane:Km(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},yd(r)){if(s)throw Error(i(479))}else s=Mf(r,o,u,2),s!==null&&zn(s,r,2)}function yd(r){var s=r.alternate;return r===Fe||s!==null&&s===Fe}function g0(r,s){Ao=ud=!0;var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}function y0(r,s,o){if((o&4194048)!==0){var u=s.lanes;u&=r.pendingLanes,o|=u,s.lanes=o,Ml(r,o)}}var hc={readContext:pn,use:fd,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useLayoutEffect:Rt,useInsertionEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useSyncExternalStore:Rt,useId:Rt,useHostTransitionStatus:Rt,useFormState:Rt,useActionState:Rt,useOptimistic:Rt,useMemoCache:Rt,useCacheRefresh:Rt};hc.useEffectEvent=Rt;var _0={readContext:pn,use:fd,useCallback:function(r,s){return Rn().memoizedState=[r,s===void 0?null:s],r},useContext:pn,useEffect:t0,useImperativeHandle:function(r,s,o){o=o!=null?o.concat([r]):null,pd(4194308,4,s0.bind(null,s,r),o)},useLayoutEffect:function(r,s){return pd(4194308,4,r,s)},useInsertionEffect:function(r,s){pd(4,2,r,s)},useMemo:function(r,s){var o=Rn();s=s===void 0?null:s;var u=r();if(Ca){sr(!0);try{r()}finally{sr(!1)}}return o.memoizedState=[u,s],u},useReducer:function(r,s,o){var u=Rn();if(o!==void 0){var p=o(s);if(Ca){sr(!0);try{o(s)}finally{sr(!1)}}}else p=s;return u.memoizedState=u.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},u.queue=r,r=r.dispatch=sA.bind(null,Fe,r),[u.memoizedState,r]},useRef:function(r){var s=Rn();return r={current:r},s.memoizedState=r},useState:function(r){r=cm(r);var s=r.queue,o=p0.bind(null,Fe,s);return s.dispatch=o,[r.memoizedState,o]},useDebugValue:hm,useDeferredValue:function(r,s){var o=Rn();return fm(o,r,s)},useTransition:function(){var r=cm(!1);return r=u0.bind(null,Fe,r.queue,!0,!1),Rn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,o){var u=Fe,p=Rn();if(Je){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),mt===null)throw Error(i(349));($e&127)!==0||z_(u,s,o)}p.memoizedState=o;var y={value:o,getSnapshot:s};return p.queue=y,t0(B_.bind(null,u,y,r),[r]),u.flags|=2048,Ro(9,{destroy:void 0},U_.bind(null,u,y,o,s),null),o},useId:function(){var r=Rn(),s=mt.identifierPrefix;if(Je){var o=ii,u=ri;o=(u&~(1<<32-Ot(u)-1)).toString(32)+o,s="_"+s+"R_"+o,o=dd++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=JT++,s="_"+s+"r_"+o.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:pm,useFormState:Y_,useActionState:Y_,useOptimistic:function(r){var s=Rn();s.memoizedState=s.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=gm.bind(null,Fe,!0,o),o.dispatch=s,[r,s]},useMemoCache:am,useCacheRefresh:function(){return Rn().memoizedState=iA.bind(null,Fe)},useEffectEvent:function(r){var s=Rn(),o={impl:r};return s.memoizedState=o,function(){if((it&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},ym={readContext:pn,use:fd,useCallback:o0,useContext:pn,useEffect:dm,useImperativeHandle:a0,useInsertionEffect:r0,useLayoutEffect:i0,useMemo:l0,useReducer:md,useRef:e0,useState:function(){return md(Ci)},useDebugValue:hm,useDeferredValue:function(r,s){var o=Nt();return c0(o,dt.memoizedState,r,s)},useTransition:function(){var r=md(Ci)[0],s=Nt().memoizedState;return[typeof r=="boolean"?r:uc(r),s]},useSyncExternalStore:V_,useId:f0,useHostTransitionStatus:pm,useFormState:X_,useActionState:X_,useOptimistic:function(r,s){var o=Nt();return H_(o,dt,r,s)},useMemoCache:am,useCacheRefresh:m0};ym.useEffectEvent=n0;var v0={readContext:pn,use:fd,useCallback:o0,useContext:pn,useEffect:dm,useImperativeHandle:a0,useInsertionEffect:r0,useLayoutEffect:i0,useMemo:l0,useReducer:lm,useRef:e0,useState:function(){return lm(Ci)},useDebugValue:hm,useDeferredValue:function(r,s){var o=Nt();return dt===null?fm(o,r,s):c0(o,dt.memoizedState,r,s)},useTransition:function(){var r=lm(Ci)[0],s=Nt().memoizedState;return[typeof r=="boolean"?r:uc(r),s]},useSyncExternalStore:V_,useId:f0,useHostTransitionStatus:pm,useFormState:Z_,useActionState:Z_,useOptimistic:function(r,s){var o=Nt();return dt!==null?H_(o,dt,r,s):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:am,useCacheRefresh:m0};v0.useEffectEvent=n0;function _m(r,s,o,u){s=r.memoizedState,o=o(u,s),o=o==null?s:v({},s,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var vm={enqueueSetState:function(r,s,o){r=r._reactInternals;var u=Zn(),p=fs(u);p.payload=s,o!=null&&(p.callback=o),s=ms(r,p,u),s!==null&&(zn(s,r,u),ac(s,r,u))},enqueueReplaceState:function(r,s,o){r=r._reactInternals;var u=Zn(),p=fs(u);p.tag=1,p.payload=s,o!=null&&(p.callback=o),s=ms(r,p,u),s!==null&&(zn(s,r,u),ac(s,r,u))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var o=Zn(),u=fs(o);u.tag=2,s!=null&&(u.callback=s),s=ms(r,u,o),s!==null&&(zn(s,r,o),ac(s,r,o))}};function b0(r,s,o,u,p,y,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,y,E):s.prototype&&s.prototype.isPureReactComponent?!Jl(o,u)||!Jl(p,y):!0}function x0(r,s,o,u){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,u),s.state!==r&&vm.enqueueReplaceState(s,s.state,null)}function Ra(r,s){var o=s;if("ref"in s){o={};for(var u in s)u!=="ref"&&(o[u]=s[u])}if(r=r.defaultProps){o===s&&(o=v({},o));for(var p in r)o[p]===void 0&&(o[p]=r[p])}return o}function E0(r){Wu(r)}function S0(r){console.error(r)}function w0(r){Wu(r)}function _d(r,s){try{var o=r.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function T0(r,s,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function bm(r,s,o){return o=fs(o),o.tag=3,o.payload={element:null},o.callback=function(){_d(r,s)},o}function A0(r){return r=fs(r),r.tag=3,r}function C0(r,s,o,u){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var y=u.value;r.payload=function(){return p(y)},r.callback=function(){T0(s,o,u)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(r.callback=function(){T0(s,o,u),typeof p!="function"&&(bs===null?bs=new Set([this]):bs.add(this));var O=u.stack;this.componentDidCatch(u.value,{componentStack:O!==null?O:""})})}function aA(r,s,o,u,p){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=o.alternate,s!==null&&bo(s,o,p,!0),o=Wn.current,o!==null){switch(o.tag){case 31:case 13:return pr===null?Id():o.alternate===null&&Dt===0&&(Dt=3),o.flags&=-257,o.flags|=65536,o.lanes=p,u===sd?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([u]):s.add(u),Gm(r,u,p)),!1;case 22:return o.flags|=65536,u===sd?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([u]):o.add(u)),Gm(r,u,p)),!1}throw Error(i(435,o.tag))}return Gm(r,u,p),Id(),!1}if(Je)return s=Wn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,u!==zf&&(r=Error(i(422),{cause:u}),tc(dr(r,o)))):(u!==zf&&(s=Error(i(423),{cause:u}),tc(dr(s,o))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,u=dr(u,o),p=bm(r.stateNode,u,p),Yf(r,p),Dt!==4&&(Dt=2)),!1;var y=Error(i(520),{cause:u});if(y=dr(y,o),bc===null?bc=[y]:bc.push(y),Dt!==4&&(Dt=2),s===null)return!0;u=dr(u,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,r=p&-p,o.lanes|=r,r=bm(o.stateNode,u,r),Yf(o,r),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(bs===null||!bs.has(y))))return o.flags|=65536,p&=-p,o.lanes|=p,p=A0(p),C0(p,r,o,u),Yf(o,p),!1}o=o.return}while(o!==null);return!1}var xm=Error(i(461)),Gt=!1;function gn(r,s,o,u){s.child=r===null?j_(s,null,o,u):Aa(s,r.child,o,u)}function R0(r,s,o,u,p){o=o.render;var y=s.ref;if("ref"in u){var E={};for(var O in u)O!=="ref"&&(E[O]=u[O])}else E=u;return Ea(s),u=nm(r,s,o,E,y,p),O=rm(),r!==null&&!Gt?(im(r,s,p),Ri(r,s,p)):(Je&&O&&Lf(s),s.flags|=1,gn(r,s,u,p),s.child)}function D0(r,s,o,u,p){if(r===null){var y=o.type;return typeof y=="function"&&!kf(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,I0(r,s,y,u,p)):(r=Zu(o.type,null,u,s,s.mode,p),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,!Dm(r,p)){var E=y.memoizedProps;if(o=o.compare,o=o!==null?o:Jl,o(E,u)&&r.ref===s.ref)return Ri(r,s,p)}return s.flags|=1,r=Ei(y,u),r.ref=s.ref,r.return=s,s.child=r}function I0(r,s,o,u,p){if(r!==null){var y=r.memoizedProps;if(Jl(y,u)&&r.ref===s.ref)if(Gt=!1,s.pendingProps=u=y,Dm(r,p))(r.flags&131072)!==0&&(Gt=!0);else return s.lanes=r.lanes,Ri(r,s,p)}return Em(r,s,o,u,p)}function j0(r,s,o,u){var p=u.children,y=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(u=s.child=r.child,p=0;u!==null;)p=p|u.lanes|u.childLanes,u=u.sibling;u=p&~y}else u=0,s.child=null;return O0(r,s,y,o,u)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&rd(s,y!==null?y.cachePool:null),y!==null?k_(s,y):Jf(),N_(s);else return u=s.lanes=536870912,O0(r,s,y!==null?y.baseLanes|o:o,o,u)}else y!==null?(rd(s,y.cachePool),k_(s,y),gs(),s.memoizedState=null):(r!==null&&rd(s,null),Jf(),gs());return gn(r,s,p,o),s.child}function fc(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function O0(r,s,o,u,p){var y=Qf();return y=y===null?null:{parent:qt._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},r!==null&&rd(s,null),Jf(),N_(s),r!==null&&bo(r,s,u,!0),s.childLanes=p,null}function vd(r,s){return s=xd({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function M0(r,s,o){return Aa(s,r.child,null,o),r=vd(s,s.pendingProps),r.flags|=2,Yn(s),s.memoizedState=null,r}function oA(r,s,o){var u=s.pendingProps,p=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(Je){if(u.mode==="hidden")return r=vd(s,u),s.lanes=536870912,fc(null,r);if(em(s),(r=_t)?(r=Gv(r,mr),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:ls!==null?{id:ri,overflow:ii}:null,retryLane:536870912,hydrationErrors:null},o=g_(r),o.return=s,s.child=o,mn=s,_t=null)):r=null,r===null)throw us(s);return s.lanes=536870912,null}return vd(s,u)}var y=r.memoizedState;if(y!==null){var E=y.dehydrated;if(em(s),p)if(s.flags&256)s.flags&=-257,s=M0(r,s,o);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(Gt||bo(r,s,o,!1),p=(o&r.childLanes)!==0,Gt||p){if(u=mt,u!==null&&(E=kl(u,o),E!==0&&E!==y.retryLane))throw y.retryLane=E,_a(r,E),zn(u,r,E),xm;Id(),s=M0(r,s,o)}else r=y.treeContext,_t=gr(E.nextSibling),mn=s,Je=!0,cs=null,mr=!1,r!==null&&v_(s,r),s=vd(s,u),s.flags|=4096;return s}return r=Ei(r.child,{mode:u.mode,children:u.children}),r.ref=s.ref,s.child=r,r.return=s,r}function bd(r,s){var o=s.ref;if(o===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(r===null||r.ref!==o)&&(s.flags|=4194816)}}function Em(r,s,o,u,p){return Ea(s),o=nm(r,s,o,u,void 0,p),u=rm(),r!==null&&!Gt?(im(r,s,p),Ri(r,s,p)):(Je&&u&&Lf(s),s.flags|=1,gn(r,s,o,p),s.child)}function k0(r,s,o,u,p,y){return Ea(s),s.updateQueue=null,o=L_(s,u,o,p),P_(r),u=rm(),r!==null&&!Gt?(im(r,s,y),Ri(r,s,y)):(Je&&u&&Lf(s),s.flags|=1,gn(r,s,o,y),s.child)}function N0(r,s,o,u,p){if(Ea(s),s.stateNode===null){var y=go,E=o.contextType;typeof E=="object"&&E!==null&&(y=pn(E)),y=new o(u,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=vm,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=u,y.state=s.memoizedState,y.refs={},Kf(s),E=o.contextType,y.context=typeof E=="object"&&E!==null?pn(E):go,y.state=s.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(_m(s,o,E,u),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(E=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),E!==y.state&&vm.enqueueReplaceState(y,y.state,null),lc(s,u,y,p),oc(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(r===null){y=s.stateNode;var O=s.memoizedProps,G=Ra(o,O);y.props=G;var se=y.context,pe=o.contextType;E=go,typeof pe=="object"&&pe!==null&&(E=pn(pe));var _e=o.getDerivedStateFromProps;pe=typeof _e=="function"||typeof y.getSnapshotBeforeUpdate=="function",O=s.pendingProps!==O,pe||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(O||se!==E)&&x0(s,y,u,E),hs=!1;var le=s.memoizedState;y.state=le,lc(s,u,y,p),oc(),se=s.memoizedState,O||le!==se||hs?(typeof _e=="function"&&(_m(s,o,_e,u),se=s.memoizedState),(G=hs||b0(s,o,G,u,le,se,E))?(pe||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=se),y.props=u,y.state=se,y.context=E,u=G):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{y=s.stateNode,Wf(r,s),E=s.memoizedProps,pe=Ra(o,E),y.props=pe,_e=s.pendingProps,le=y.context,se=o.contextType,G=go,typeof se=="object"&&se!==null&&(G=pn(se)),O=o.getDerivedStateFromProps,(se=typeof O=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(E!==_e||le!==G)&&x0(s,y,u,G),hs=!1,le=s.memoizedState,y.state=le,lc(s,u,y,p),oc();var he=s.memoizedState;E!==_e||le!==he||hs||r!==null&&r.dependencies!==null&&td(r.dependencies)?(typeof O=="function"&&(_m(s,o,O,u),he=s.memoizedState),(pe=hs||b0(s,o,pe,u,le,he,G)||r!==null&&r.dependencies!==null&&td(r.dependencies))?(se||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,he,G),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,he,G)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&le===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&le===r.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=he),y.props=u,y.state=he,y.context=G,u=pe):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&le===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&le===r.memoizedState||(s.flags|=1024),u=!1)}return y=u,bd(r,s),u=(s.flags&128)!==0,y||u?(y=s.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,r!==null&&u?(s.child=Aa(s,r.child,null,p),s.child=Aa(s,null,o,p)):gn(r,s,o,p),s.memoizedState=y.state,r=s.child):r=Ri(r,s,p),r}function P0(r,s,o,u){return ba(),s.flags|=256,gn(r,s,o,u),s.child}var Sm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function wm(r){return{baseLanes:r,cachePool:T_()}}function Tm(r,s,o){return r=r!==null?r.childLanes&~o:0,s&&(r|=Jn),r}function L0(r,s,o){var u=s.pendingProps,p=!1,y=(s.flags&128)!==0,E;if((E=y)||(E=r!==null&&r.memoizedState===null?!1:(kt.current&2)!==0),E&&(p=!0,s.flags&=-129),E=(s.flags&32)!==0,s.flags&=-33,r===null){if(Je){if(p?ps(s):gs(),(r=_t)?(r=Gv(r,mr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:ls!==null?{id:ri,overflow:ii}:null,retryLane:536870912,hydrationErrors:null},o=g_(r),o.return=s,s.child=o,mn=s,_t=null)):r=null,r===null)throw us(s);return op(r)?s.lanes=32:s.lanes=536870912,null}var O=u.children;return u=u.fallback,p?(gs(),p=s.mode,O=xd({mode:"hidden",children:O},p),u=va(u,p,o,null),O.return=s,u.return=s,O.sibling=u,s.child=O,u=s.child,u.memoizedState=wm(o),u.childLanes=Tm(r,E,o),s.memoizedState=Sm,fc(null,u)):(ps(s),Am(s,O))}var G=r.memoizedState;if(G!==null&&(O=G.dehydrated,O!==null)){if(y)s.flags&256?(ps(s),s.flags&=-257,s=Cm(r,s,o)):s.memoizedState!==null?(gs(),s.child=r.child,s.flags|=128,s=null):(gs(),O=u.fallback,p=s.mode,u=xd({mode:"visible",children:u.children},p),O=va(O,p,o,null),O.flags|=2,u.return=s,O.return=s,u.sibling=O,s.child=u,Aa(s,r.child,null,o),u=s.child,u.memoizedState=wm(o),u.childLanes=Tm(r,E,o),s.memoizedState=Sm,s=fc(null,u));else if(ps(s),op(O)){if(E=O.nextSibling&&O.nextSibling.dataset,E)var se=E.dgst;E=se,u=Error(i(419)),u.stack="",u.digest=E,tc({value:u,source:null,stack:null}),s=Cm(r,s,o)}else if(Gt||bo(r,s,o,!1),E=(o&r.childLanes)!==0,Gt||E){if(E=mt,E!==null&&(u=kl(E,o),u!==0&&u!==G.retryLane))throw G.retryLane=u,_a(r,u),zn(E,r,u),xm;ap(O)||Id(),s=Cm(r,s,o)}else ap(O)?(s.flags|=192,s.child=r.child,s=null):(r=G.treeContext,_t=gr(O.nextSibling),mn=s,Je=!0,cs=null,mr=!1,r!==null&&v_(s,r),s=Am(s,u.children),s.flags|=4096);return s}return p?(gs(),O=u.fallback,p=s.mode,G=r.child,se=G.sibling,u=Ei(G,{mode:"hidden",children:u.children}),u.subtreeFlags=G.subtreeFlags&65011712,se!==null?O=Ei(se,O):(O=va(O,p,o,null),O.flags|=2),O.return=s,u.return=s,u.sibling=O,s.child=u,fc(null,u),u=s.child,O=r.child.memoizedState,O===null?O=wm(o):(p=O.cachePool,p!==null?(G=qt._currentValue,p=p.parent!==G?{parent:G,pool:G}:p):p=T_(),O={baseLanes:O.baseLanes|o,cachePool:p}),u.memoizedState=O,u.childLanes=Tm(r,E,o),s.memoizedState=Sm,fc(r.child,u)):(ps(s),o=r.child,r=o.sibling,o=Ei(o,{mode:"visible",children:u.children}),o.return=s,o.sibling=null,r!==null&&(E=s.deletions,E===null?(s.deletions=[r],s.flags|=16):E.push(r)),s.child=o,s.memoizedState=null,o)}function Am(r,s){return s=xd({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function xd(r,s){return r=Kn(22,r,null,s),r.lanes=0,r}function Cm(r,s,o){return Aa(s,r.child,null,o),r=Am(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function V0(r,s,o){r.lanes|=s;var u=r.alternate;u!==null&&(u.lanes|=s),Ff(r.return,s,o)}function Rm(r,s,o,u,p,y){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:p,treeForkCount:y}:(E.isBackwards=s,E.rendering=null,E.renderingStartTime=0,E.last=u,E.tail=o,E.tailMode=p,E.treeForkCount=y)}function z0(r,s,o){var u=s.pendingProps,p=u.revealOrder,y=u.tail;u=u.children;var E=kt.current,O=(E&2)!==0;if(O?(E=E&1|2,s.flags|=128):E&=1,W(kt,E),gn(r,s,u,o),u=Je?ec:0,!O&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&V0(r,o,s);else if(r.tag===19)V0(r,o,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(p){case"forwards":for(o=s.child,p=null;o!==null;)r=o.alternate,r!==null&&cd(r)===null&&(p=o),o=o.sibling;o=p,o===null?(p=s.child,s.child=null):(p=o.sibling,o.sibling=null),Rm(s,!1,p,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=s.child,s.child=null;p!==null;){if(r=p.alternate,r!==null&&cd(r)===null){s.child=p;break}r=p.sibling,p.sibling=o,o=p,p=r}Rm(s,!0,o,null,y,u);break;case"together":Rm(s,!1,null,null,void 0,u);break;default:s.memoizedState=null}return s.child}function Ri(r,s,o){if(r!==null&&(s.dependencies=r.dependencies),vs|=s.lanes,(o&s.childLanes)===0)if(r!==null){if(bo(r,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,o=Ei(r,r.pendingProps),s.child=o,o.return=s;r.sibling!==null;)r=r.sibling,o=o.sibling=Ei(r,r.pendingProps),o.return=s;o.sibling=null}return s.child}function Dm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&td(r)))}function lA(r,s,o){switch(s.tag){case 3:Ee(s,s.stateNode.containerInfo),ds(s,qt,r.memoizedState.cache),ba();break;case 27:case 5:Z(s);break;case 4:Ee(s,s.stateNode.containerInfo);break;case 10:ds(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,em(s),null;break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(ps(s),s.flags|=128,null):(o&s.child.childLanes)!==0?L0(r,s,o):(ps(s),r=Ri(r,s,o),r!==null?r.sibling:null);ps(s);break;case 19:var p=(r.flags&128)!==0;if(u=(o&s.childLanes)!==0,u||(bo(r,s,o,!1),u=(o&s.childLanes)!==0),p){if(u)return z0(r,s,o);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),W(kt,kt.current),u)break;return null;case 22:return s.lanes=0,j0(r,s,o,s.pendingProps);case 24:ds(s,qt,r.memoizedState.cache)}return Ri(r,s,o)}function U0(r,s,o){if(r!==null)if(r.memoizedProps!==s.pendingProps)Gt=!0;else{if(!Dm(r,o)&&(s.flags&128)===0)return Gt=!1,lA(r,s,o);Gt=(r.flags&131072)!==0}else Gt=!1,Je&&(s.flags&1048576)!==0&&__(s,ec,s.index);switch(s.lanes=0,s.tag){case 16:e:{var u=s.pendingProps;if(r=wa(s.elementType),s.type=r,typeof r=="function")kf(r)?(u=Ra(r,u),s.tag=1,s=N0(null,s,r,u,o)):(s.tag=0,s=Em(null,s,r,u,o));else{if(r!=null){var p=r.$$typeof;if(p===J){s.tag=11,s=R0(null,s,r,u,o);break e}else if(p===P){s.tag=14,s=D0(null,s,r,u,o);break e}}throw s=ae(r)||r,Error(i(306,s,""))}}return s;case 0:return Em(r,s,s.type,s.pendingProps,o);case 1:return u=s.type,p=Ra(u,s.pendingProps),N0(r,s,u,p,o);case 3:e:{if(Ee(s,s.stateNode.containerInfo),r===null)throw Error(i(387));u=s.pendingProps;var y=s.memoizedState;p=y.element,Wf(r,s),lc(s,u,null,o);var E=s.memoizedState;if(u=E.cache,ds(s,qt,u),u!==y.cache&&qf(s,[qt],o,!0),oc(),u=E.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:E.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=P0(r,s,u,o);break e}else if(u!==p){p=dr(Error(i(424)),s),tc(p),s=P0(r,s,u,o);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,_t=gr(r.firstChild),mn=s,Je=!0,cs=null,mr=!0,o=j_(s,null,u,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ba(),u===p){s=Ri(r,s,o);break e}gn(r,s,u,o)}s=s.child}return s;case 26:return bd(r,s),r===null?(o=Xv(s.type,null,s.pendingProps,null))?s.memoizedState=o:Je||(o=s.type,r=s.pendingProps,u=Ld(ge.current).createElement(o),u[Ut]=s,u[an]=r,yn(u,o,r),Bt(u),s.stateNode=u):s.memoizedState=Xv(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return Z(s),r===null&&Je&&(u=s.stateNode=Kv(s.type,s.pendingProps,ge.current),mn=s,mr=!0,p=_t,ws(s.type)?(lp=p,_t=gr(u.firstChild)):_t=p),gn(r,s,s.pendingProps.children,o),bd(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&Je&&((p=u=_t)&&(u=VA(u,s.type,s.pendingProps,mr),u!==null?(s.stateNode=u,mn=s,_t=gr(u.firstChild),mr=!1,p=!0):p=!1),p||us(s)),Z(s),p=s.type,y=s.pendingProps,E=r!==null?r.memoizedProps:null,u=y.children,rp(p,y)?u=null:E!==null&&rp(p,E)&&(s.flags|=32),s.memoizedState!==null&&(p=nm(r,s,ZT,null,null,o),Rc._currentValue=p),bd(r,s),gn(r,s,u,o),s.child;case 6:return r===null&&Je&&((r=o=_t)&&(o=zA(o,s.pendingProps,mr),o!==null?(s.stateNode=o,mn=s,_t=null,r=!0):r=!1),r||us(s)),null;case 13:return L0(r,s,o);case 4:return Ee(s,s.stateNode.containerInfo),u=s.pendingProps,r===null?s.child=Aa(s,null,u,o):gn(r,s,u,o),s.child;case 11:return R0(r,s,s.type,s.pendingProps,o);case 7:return gn(r,s,s.pendingProps,o),s.child;case 8:return gn(r,s,s.pendingProps.children,o),s.child;case 12:return gn(r,s,s.pendingProps.children,o),s.child;case 10:return u=s.pendingProps,ds(s,s.type,u.value),gn(r,s,u.children,o),s.child;case 9:return p=s.type._context,u=s.pendingProps.children,Ea(s),p=pn(p),u=u(p),s.flags|=1,gn(r,s,u,o),s.child;case 14:return D0(r,s,s.type,s.pendingProps,o);case 15:return I0(r,s,s.type,s.pendingProps,o);case 19:return z0(r,s,o);case 31:return oA(r,s,o);case 22:return j0(r,s,o,s.pendingProps);case 24:return Ea(s),u=pn(qt),r===null?(p=Qf(),p===null&&(p=mt,y=Hf(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=o),p=y),s.memoizedState={parent:u,cache:p},Kf(s),ds(s,qt,p)):((r.lanes&o)!==0&&(Wf(r,s),lc(s,null,null,o),oc()),p=r.memoizedState,y=s.memoizedState,p.parent!==u?(p={parent:u,cache:u},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),ds(s,qt,u)):(u=y.cache,ds(s,qt,u),u!==p.cache&&qf(s,[qt],o,!0))),gn(r,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Di(r){r.flags|=4}function Im(r,s,o,u,p){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(p&335544128)===p)if(r.stateNode.complete)r.flags|=8192;else if(fv())r.flags|=8192;else throw Ta=sd,$f}else r.flags&=-16777217}function B0(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!nb(s))if(fv())r.flags|=8192;else throw Ta=sd,$f}function Ed(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?Ru():536870912,r.lanes|=s,Oo|=s)}function mc(r,s){if(!Je)switch(r.tailMode){case"hidden":s=r.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function vt(r){var s=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(s)for(var p=r.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)o|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=u,r.childLanes=o,s}function cA(r,s,o){var u=s.pendingProps;switch(Vf(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vt(s),null;case 1:return vt(s),null;case 3:return o=s.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),Ti(qt),fe(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(vo(s)?Di(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Uf())),vt(s),null;case 26:var p=s.type,y=s.memoizedState;return r===null?(Di(s),y!==null?(vt(s),B0(s,y)):(vt(s),Im(s,p,null,u,o))):y?y!==r.memoizedState?(Di(s),vt(s),B0(s,y)):(vt(s),s.flags&=-16777217):(r=r.memoizedProps,r!==u&&Di(s),vt(s),Im(s,p,r,u,o)),null;case 27:if(De(s),o=ge.current,p=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==u&&Di(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return vt(s),null}r=X.current,vo(s)?b_(s):(r=Kv(p,u,o),s.stateNode=r,Di(s))}return vt(s),null;case 5:if(De(s),p=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==u&&Di(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return vt(s),null}if(y=X.current,vo(s))b_(s);else{var E=Ld(ge.current);switch(y){case 1:y=E.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=E.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=E.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?E.createElement("select",{is:u.is}):E.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?E.createElement(p,{is:u.is}):E.createElement(p)}}y[Ut]=s,y[an]=u;e:for(E=s.child;E!==null;){if(E.tag===5||E.tag===6)y.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===s)break e;for(;E.sibling===null;){if(E.return===null||E.return===s)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}s.stateNode=y;e:switch(yn(y,p,u),p){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Di(s)}}return vt(s),Im(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,o),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==u&&Di(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(i(166));if(r=ge.current,vo(s)){if(r=s.stateNode,o=s.memoizedProps,u=null,p=mn,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}r[Ut]=s,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Lv(r.nodeValue,o)),r||us(s,!0)}else r=Ld(r).createTextNode(u),r[Ut]=s,s.stateNode=r}return vt(s),null;case 31:if(o=s.memoizedState,r===null||r.memoizedState!==null){if(u=vo(s),o!==null){if(r===null){if(!u)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Ut]=s}else ba(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;vt(s),r=!1}else o=Uf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return s.flags&256?(Yn(s),s):(Yn(s),null);if((s.flags&128)!==0)throw Error(i(558))}return vt(s),null;case 13:if(u=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=vo(s),u!==null&&u.dehydrated!==null){if(r===null){if(!p)throw Error(i(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Ut]=s}else ba(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;vt(s),p=!1}else p=Uf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(Yn(s),s):(Yn(s),null)}return Yn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=u!==null,r=r!==null&&r.memoizedState!==null,o&&(u=s.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==p&&(u.flags|=2048)),o!==r&&o&&(s.child.flags|=8192),Ed(s,s.updateQueue),vt(s),null);case 4:return fe(),r===null&&Jm(s.stateNode.containerInfo),vt(s),null;case 10:return Ti(s.type),vt(s),null;case 19:if(F(kt),u=s.memoizedState,u===null)return vt(s),null;if(p=(s.flags&128)!==0,y=u.rendering,y===null)if(p)mc(u,!1);else{if(Dt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(y=cd(r),y!==null){for(s.flags|=128,mc(u,!1),r=y.updateQueue,s.updateQueue=r,Ed(s,r),s.subtreeFlags=0,r=o,o=s.child;o!==null;)p_(o,r),o=o.sibling;return W(kt,kt.current&1|2),Je&&Si(s,u.treeForkCount),s.child}r=r.sibling}u.tail!==null&&Ct()>Cd&&(s.flags|=128,p=!0,mc(u,!1),s.lanes=4194304)}else{if(!p)if(r=cd(y),r!==null){if(s.flags|=128,p=!0,r=r.updateQueue,s.updateQueue=r,Ed(s,r),mc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!Je)return vt(s),null}else 2*Ct()-u.renderingStartTime>Cd&&o!==536870912&&(s.flags|=128,p=!0,mc(u,!1),s.lanes=4194304);u.isBackwards?(y.sibling=s.child,s.child=y):(r=u.last,r!==null?r.sibling=y:s.child=y,u.last=y)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=Ct(),r.sibling=null,o=kt.current,W(kt,p?o&1|2:o&1),Je&&Si(s,u.treeForkCount),r):(vt(s),null);case 22:case 23:return Yn(s),Zf(),u=s.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?(o&536870912)!==0&&(s.flags&128)===0&&(vt(s),s.subtreeFlags&6&&(s.flags|=8192)):vt(s),o=s.updateQueue,o!==null&&Ed(s,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==o&&(s.flags|=2048),r!==null&&F(Sa),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Ti(qt),vt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function uA(r,s){switch(Vf(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Ti(qt),fe(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return De(s),null;case 31:if(s.memoizedState!==null){if(Yn(s),s.alternate===null)throw Error(i(340));ba()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(Yn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));ba()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return F(kt),null;case 4:return fe(),null;case 10:return Ti(s.type),null;case 22:case 23:return Yn(s),Zf(),r!==null&&F(Sa),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return Ti(qt),null;case 25:return null;default:return null}}function F0(r,s){switch(Vf(s),s.tag){case 3:Ti(qt),fe();break;case 26:case 27:case 5:De(s);break;case 4:fe();break;case 31:s.memoizedState!==null&&Yn(s);break;case 13:Yn(s);break;case 19:F(kt);break;case 10:Ti(s.type);break;case 22:case 23:Yn(s),Zf(),r!==null&&F(Sa);break;case 24:Ti(qt)}}function pc(r,s){try{var o=s.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var p=u.next;o=p;do{if((o.tag&r)===r){u=void 0;var y=o.create,E=o.inst;u=y(),E.destroy=u}o=o.next}while(o!==p)}}catch(O){ct(s,s.return,O)}}function ys(r,s,o){try{var u=s.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var y=p.next;u=y;do{if((u.tag&r)===r){var E=u.inst,O=E.destroy;if(O!==void 0){E.destroy=void 0,p=s;var G=o,se=O;try{se()}catch(pe){ct(p,G,pe)}}}u=u.next}while(u!==y)}}catch(pe){ct(s,s.return,pe)}}function q0(r){var s=r.updateQueue;if(s!==null){var o=r.stateNode;try{M_(s,o)}catch(u){ct(r,r.return,u)}}}function H0(r,s,o){o.props=Ra(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){ct(r,s,u)}}function gc(r,s){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(p){ct(r,s,p)}}function si(r,s){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(p){ct(r,s,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){ct(r,s,p)}else o.current=null}function G0(r){var s=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(p){ct(r,r.return,p)}}function jm(r,s,o){try{var u=r.stateNode;OA(u,r.type,o,s),u[an]=s}catch(p){ct(r,r.return,p)}}function Q0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&ws(r.type)||r.tag===4}function Om(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Q0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&ws(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Mm(r,s,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(r),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=Cr));else if(u!==4&&(u===27&&ws(r.type)&&(o=r.stateNode,s=null),r=r.child,r!==null))for(Mm(r,s,o),r=r.sibling;r!==null;)Mm(r,s,o),r=r.sibling}function Sd(r,s,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,s?o.insertBefore(r,s):o.appendChild(r);else if(u!==4&&(u===27&&ws(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(Sd(r,s,o),r=r.sibling;r!==null;)Sd(r,s,o),r=r.sibling}function $0(r){var s=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);yn(s,u,o),s[Ut]=r,s[an]=o}catch(y){ct(r,r.return,y)}}var Ii=!1,Qt=!1,km=!1,K0=typeof WeakSet=="function"?WeakSet:Set,ln=null;function dA(r,s){if(r=r.containerInfo,tp=Hd,r=a_(r),Cf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var p=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var E=0,O=-1,G=-1,se=0,pe=0,_e=r,le=null;t:for(;;){for(var he;_e!==o||p!==0&&_e.nodeType!==3||(O=E+p),_e!==y||u!==0&&_e.nodeType!==3||(G=E+u),_e.nodeType===3&&(E+=_e.nodeValue.length),(he=_e.firstChild)!==null;)le=_e,_e=he;for(;;){if(_e===r)break t;if(le===o&&++se===p&&(O=E),le===y&&++pe===u&&(G=E),(he=_e.nextSibling)!==null)break;_e=le,le=_e.parentNode}_e=he}o=O===-1||G===-1?null:{start:O,end:G}}else o=null}o=o||{start:0,end:0}}else o=null;for(np={focusedElem:r,selectionRange:o},Hd=!1,ln=s;ln!==null;)if(s=ln,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,ln=r;else for(;ln!==null;){switch(s=ln,y=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)p=r[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=s,p=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var Ce=Ra(o.type,p);r=u.getSnapshotBeforeUpdate(Ce,y),u.__reactInternalSnapshotBeforeUpdate=r}catch(Oe){ct(o,o.return,Oe)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,o=r.nodeType,o===9)sp(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":sp(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,ln=r;break}ln=s.return}}function W0(r,s,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:Oi(r,o),u&4&&pc(5,o);break;case 1:if(Oi(r,o),u&4)if(r=o.stateNode,s===null)try{r.componentDidMount()}catch(E){ct(o,o.return,E)}else{var p=Ra(o.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(p,s,r.__reactInternalSnapshotBeforeUpdate)}catch(E){ct(o,o.return,E)}}u&64&&q0(o),u&512&&gc(o,o.return);break;case 3:if(Oi(r,o),u&64&&(r=o.updateQueue,r!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{M_(r,s)}catch(E){ct(o,o.return,E)}}break;case 27:s===null&&u&4&&$0(o);case 26:case 5:Oi(r,o),s===null&&u&4&&G0(o),u&512&&gc(o,o.return);break;case 12:Oi(r,o);break;case 31:Oi(r,o),u&4&&J0(r,o);break;case 13:Oi(r,o),u&4&&Z0(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=bA.bind(null,o),UA(r,o))));break;case 22:if(u=o.memoizedState!==null||Ii,!u){s=s!==null&&s.memoizedState!==null||Qt,p=Ii;var y=Qt;Ii=u,(Qt=s)&&!y?Mi(r,o,(o.subtreeFlags&8772)!==0):Oi(r,o),Ii=p,Qt=y}break;case 30:break;default:Oi(r,o)}}function Y0(r){var s=r.alternate;s!==null&&(r.alternate=null,Y0(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&to(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Et=null,Nn=!1;function ji(r,s,o){for(o=o.child;o!==null;)X0(r,s,o),o=o.sibling}function X0(r,s,o){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(Sr,o)}catch{}switch(o.tag){case 26:Qt||si(o,s),ji(r,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Qt||si(o,s);var u=Et,p=Nn;ws(o.type)&&(Et=o.stateNode,Nn=!1),ji(r,s,o),Tc(o.stateNode),Et=u,Nn=p;break;case 5:Qt||si(o,s);case 6:if(u=Et,p=Nn,Et=null,ji(r,s,o),Et=u,Nn=p,Et!==null)if(Nn)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(o.stateNode)}catch(y){ct(o,s,y)}else try{Et.removeChild(o.stateNode)}catch(y){ct(o,s,y)}break;case 18:Et!==null&&(Nn?(r=Et,qv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),Uo(r)):qv(Et,o.stateNode));break;case 4:u=Et,p=Nn,Et=o.stateNode.containerInfo,Nn=!0,ji(r,s,o),Et=u,Nn=p;break;case 0:case 11:case 14:case 15:ys(2,o,s),Qt||ys(4,o,s),ji(r,s,o);break;case 1:Qt||(si(o,s),u=o.stateNode,typeof u.componentWillUnmount=="function"&&H0(o,s,u)),ji(r,s,o);break;case 21:ji(r,s,o);break;case 22:Qt=(u=Qt)||o.memoizedState!==null,ji(r,s,o),Qt=u;break;default:ji(r,s,o)}}function J0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Uo(r)}catch(o){ct(s,s.return,o)}}}function Z0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Uo(r)}catch(o){ct(s,s.return,o)}}function hA(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new K0),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new K0),s;default:throw Error(i(435,r.tag))}}function wd(r,s){var o=hA(r);s.forEach(function(u){if(!o.has(u)){o.add(u);var p=xA.bind(null,r,u);u.then(p,p)}})}function Pn(r,s){var o=s.deletions;if(o!==null)for(var u=0;u<o.length;u++){var p=o[u],y=r,E=s,O=E;e:for(;O!==null;){switch(O.tag){case 27:if(ws(O.type)){Et=O.stateNode,Nn=!1;break e}break;case 5:Et=O.stateNode,Nn=!1;break e;case 3:case 4:Et=O.stateNode.containerInfo,Nn=!0;break e}O=O.return}if(Et===null)throw Error(i(160));X0(y,E,p),Et=null,Nn=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)ev(s,r),s=s.sibling}var Mr=null;function ev(r,s){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Pn(s,r),Ln(r),u&4&&(ys(3,r,r.return),pc(3,r),ys(5,r,r.return));break;case 1:Pn(s,r),Ln(r),u&512&&(Qt||o===null||si(o,o.return)),u&64&&Ii&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var p=Mr;if(Pn(s,r),Ln(r),u&512&&(Qt||o===null||si(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,p=p.ownerDocument||p;t:switch(u){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Gr]||y[Ut]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(u),p.head.insertBefore(y,p.querySelector("head > title"))),yn(y,u,o),y[Ut]=r,Bt(y),u=y;break e;case"link":var E=eb("link","href",p).get(u+(o.href||""));if(E){for(var O=0;O<E.length;O++)if(y=E[O],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(O,1);break t}}y=p.createElement(u),yn(y,u,o),p.head.appendChild(y);break;case"meta":if(E=eb("meta","content",p).get(u+(o.content||""))){for(O=0;O<E.length;O++)if(y=E[O],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(O,1);break t}}y=p.createElement(u),yn(y,u,o),p.head.appendChild(y);break;default:throw Error(i(468,u))}y[Ut]=r,Bt(y),u=y}r.stateNode=u}else tb(p,r.type,r.stateNode);else r.stateNode=Zv(p,u,r.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?tb(p,r.type,r.stateNode):Zv(p,u,r.memoizedProps)):u===null&&r.stateNode!==null&&jm(r,r.memoizedProps,o.memoizedProps)}break;case 27:Pn(s,r),Ln(r),u&512&&(Qt||o===null||si(o,o.return)),o!==null&&u&4&&jm(r,r.memoizedProps,o.memoizedProps);break;case 5:if(Pn(s,r),Ln(r),u&512&&(Qt||o===null||si(o,o.return)),r.flags&32){p=r.stateNode;try{kn(p,"")}catch(Ce){ct(r,r.return,Ce)}}u&4&&r.stateNode!=null&&(p=r.memoizedProps,jm(r,p,o!==null?o.memoizedProps:p)),u&1024&&(km=!0);break;case 6:if(Pn(s,r),Ln(r),u&4){if(r.stateNode===null)throw Error(i(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(Ce){ct(r,r.return,Ce)}}break;case 3:if(Ud=null,p=Mr,Mr=Vd(s.containerInfo),Pn(s,r),Mr=p,Ln(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Uo(s.containerInfo)}catch(Ce){ct(r,r.return,Ce)}km&&(km=!1,tv(r));break;case 4:u=Mr,Mr=Vd(r.stateNode.containerInfo),Pn(s,r),Ln(r),Mr=u;break;case 12:Pn(s,r),Ln(r);break;case 31:Pn(s,r),Ln(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,wd(r,u)));break;case 13:Pn(s,r),Ln(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Ad=Ct()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,wd(r,u)));break;case 22:p=r.memoizedState!==null;var G=o!==null&&o.memoizedState!==null,se=Ii,pe=Qt;if(Ii=se||p,Qt=pe||G,Pn(s,r),Qt=pe,Ii=se,Ln(r),u&8192)e:for(s=r.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(o===null||G||Ii||Qt||Da(r)),o=null,s=r;;){if(s.tag===5||s.tag===26){if(o===null){G=o=s;try{if(y=G.stateNode,p)E=y.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{O=G.stateNode;var _e=G.memoizedProps.style,le=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;O.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(Ce){ct(G,G.return,Ce)}}}else if(s.tag===6){if(o===null){G=s;try{G.stateNode.nodeValue=p?"":G.memoizedProps}catch(Ce){ct(G,G.return,Ce)}}}else if(s.tag===18){if(o===null){G=s;try{var he=G.stateNode;p?Hv(he,!0):Hv(G.stateNode,!1)}catch(Ce){ct(G,G.return,Ce)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,wd(r,o))));break;case 19:Pn(s,r),Ln(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,wd(r,u)));break;case 30:break;case 21:break;default:Pn(s,r),Ln(r)}}function Ln(r){var s=r.flags;if(s&2){try{for(var o,u=r.return;u!==null;){if(Q0(u)){o=u;break}u=u.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var p=o.stateNode,y=Om(r);Sd(r,y,p);break;case 5:var E=o.stateNode;o.flags&32&&(kn(E,""),o.flags&=-33);var O=Om(r);Sd(r,O,E);break;case 3:case 4:var G=o.stateNode.containerInfo,se=Om(r);Mm(r,se,G);break;default:throw Error(i(161))}}catch(pe){ct(r,r.return,pe)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function tv(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;tv(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Oi(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)W0(r,s.alternate,s),s=s.sibling}function Da(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:ys(4,s,s.return),Da(s);break;case 1:si(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&H0(s,s.return,o),Da(s);break;case 27:Tc(s.stateNode);case 26:case 5:si(s,s.return),Da(s);break;case 22:s.memoizedState===null&&Da(s);break;case 30:Da(s);break;default:Da(s)}r=r.sibling}}function Mi(r,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,p=r,y=s,E=y.flags;switch(y.tag){case 0:case 11:case 15:Mi(p,y,o),pc(4,y);break;case 1:if(Mi(p,y,o),u=y,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(se){ct(u,u.return,se)}if(u=y,p=u.updateQueue,p!==null){var O=u.stateNode;try{var G=p.shared.hiddenCallbacks;if(G!==null)for(p.shared.hiddenCallbacks=null,p=0;p<G.length;p++)O_(G[p],O)}catch(se){ct(u,u.return,se)}}o&&E&64&&q0(y),gc(y,y.return);break;case 27:$0(y);case 26:case 5:Mi(p,y,o),o&&u===null&&E&4&&G0(y),gc(y,y.return);break;case 12:Mi(p,y,o);break;case 31:Mi(p,y,o),o&&E&4&&J0(p,y);break;case 13:Mi(p,y,o),o&&E&4&&Z0(p,y);break;case 22:y.memoizedState===null&&Mi(p,y,o),gc(y,y.return);break;case 30:break;default:Mi(p,y,o)}s=s.sibling}}function Nm(r,s){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&nc(o))}function Pm(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&nc(r))}function kr(r,s,o,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)nv(r,s,o,u),s=s.sibling}function nv(r,s,o,u){var p=s.flags;switch(s.tag){case 0:case 11:case 15:kr(r,s,o,u),p&2048&&pc(9,s);break;case 1:kr(r,s,o,u);break;case 3:kr(r,s,o,u),p&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&nc(r)));break;case 12:if(p&2048){kr(r,s,o,u),r=s.stateNode;try{var y=s.memoizedProps,E=y.id,O=y.onPostCommit;typeof O=="function"&&O(E,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(G){ct(s,s.return,G)}}else kr(r,s,o,u);break;case 31:kr(r,s,o,u);break;case 13:kr(r,s,o,u);break;case 23:break;case 22:y=s.stateNode,E=s.alternate,s.memoizedState!==null?y._visibility&2?kr(r,s,o,u):yc(r,s):y._visibility&2?kr(r,s,o,u):(y._visibility|=2,Do(r,s,o,u,(s.subtreeFlags&10256)!==0||!1)),p&2048&&Nm(E,s);break;case 24:kr(r,s,o,u),p&2048&&Pm(s.alternate,s);break;default:kr(r,s,o,u)}}function Do(r,s,o,u,p){for(p=p&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=r,E=s,O=o,G=u,se=E.flags;switch(E.tag){case 0:case 11:case 15:Do(y,E,O,G,p),pc(8,E);break;case 23:break;case 22:var pe=E.stateNode;E.memoizedState!==null?pe._visibility&2?Do(y,E,O,G,p):yc(y,E):(pe._visibility|=2,Do(y,E,O,G,p)),p&&se&2048&&Nm(E.alternate,E);break;case 24:Do(y,E,O,G,p),p&&se&2048&&Pm(E.alternate,E);break;default:Do(y,E,O,G,p)}s=s.sibling}}function yc(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=r,u=s,p=u.flags;switch(u.tag){case 22:yc(o,u),p&2048&&Nm(u.alternate,u);break;case 24:yc(o,u),p&2048&&Pm(u.alternate,u);break;default:yc(o,u)}s=s.sibling}}var _c=8192;function Io(r,s,o){if(r.subtreeFlags&_c)for(r=r.child;r!==null;)rv(r,s,o),r=r.sibling}function rv(r,s,o){switch(r.tag){case 26:Io(r,s,o),r.flags&_c&&r.memoizedState!==null&&JA(o,Mr,r.memoizedState,r.memoizedProps);break;case 5:Io(r,s,o);break;case 3:case 4:var u=Mr;Mr=Vd(r.stateNode.containerInfo),Io(r,s,o),Mr=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=_c,_c=16777216,Io(r,s,o),_c=u):Io(r,s,o));break;default:Io(r,s,o)}}function iv(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function vc(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];ln=u,av(u,r)}iv(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)sv(r),r=r.sibling}function sv(r){switch(r.tag){case 0:case 11:case 15:vc(r),r.flags&2048&&ys(9,r,r.return);break;case 3:vc(r);break;case 12:vc(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,Td(r)):vc(r);break;default:vc(r)}}function Td(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];ln=u,av(u,r)}iv(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:ys(8,s,s.return),Td(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,Td(s));break;default:Td(s)}r=r.sibling}}function av(r,s){for(;ln!==null;){var o=ln;switch(o.tag){case 0:case 11:case 15:ys(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:nc(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,ln=u;else e:for(o=r;ln!==null;){u=ln;var p=u.sibling,y=u.return;if(Y0(u),u===o){ln=null;break e}if(p!==null){p.return=y,ln=p;break e}ln=y}}}var fA={getCacheForType:function(r){var s=pn(qt),o=s.data.get(r);return o===void 0&&(o=r(),s.data.set(r,o)),o},cacheSignal:function(){return pn(qt).controller.signal}},mA=typeof WeakMap=="function"?WeakMap:Map,it=0,mt=null,He=null,$e=0,lt=0,Xn=null,_s=!1,jo=!1,Lm=!1,ki=0,Dt=0,vs=0,Ia=0,Vm=0,Jn=0,Oo=0,bc=null,Vn=null,zm=!1,Ad=0,ov=0,Cd=1/0,Rd=null,bs=null,en=0,xs=null,Mo=null,Ni=0,Um=0,Bm=null,lv=null,xc=0,Fm=null;function Zn(){return(it&2)!==0&&$e!==0?$e&-$e:L.T!==null?Km():Du()}function cv(){if(Jn===0)if(($e&536870912)===0||Je){var r=ra;ra<<=1,(ra&3932160)===0&&(ra=262144),Jn=r}else Jn=536870912;return r=Wn.current,r!==null&&(r.flags|=32),Jn}function zn(r,s,o){(r===mt&&(lt===2||lt===9)||r.cancelPendingCommit!==null)&&(ko(r,0),Es(r,$e,Jn,!1)),ia(r,o),((it&2)===0||r!==mt)&&(r===mt&&((it&2)===0&&(Ia|=o),Dt===4&&Es(r,$e,Jn,!1)),ai(r))}function uv(r,s,o){if((it&6)!==0)throw Error(i(327));var u=!o&&(s&127)===0&&(s&r.expiredLanes)===0||wr(r,s),p=u?yA(r,s):Hm(r,s,!0),y=u;do{if(p===0){jo&&!u&&Es(r,s,0,!1);break}else{if(o=r.current.alternate,y&&!pA(o)){p=Hm(r,s,!1),y=!1;continue}if(p===2){if(y=s,r.errorRecoveryDisabledLanes&y)var E=0;else E=r.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){s=E;e:{var O=r;p=bc;var G=O.current.memoizedState.isDehydrated;if(G&&(ko(O,E).flags|=256),E=Hm(O,E,!1),E!==2){if(Lm&&!G){O.errorRecoveryDisabledLanes|=y,Ia|=y,p=4;break e}y=Vn,Vn=p,y!==null&&(Vn===null?Vn=y:Vn.push.apply(Vn,y))}p=E}if(y=!1,p!==2)continue}}if(p===1){ko(r,0),Es(r,s,0,!0);break}e:{switch(u=r,y=p,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Es(u,s,Jn,!_s);break e;case 2:Vn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(p=Ad+300-Ct(),10<p)){if(Es(u,s,Jn,!_s),Fr(u,0,!0)!==0)break e;Ni=s,u.timeoutHandle=Bv(dv.bind(null,u,o,Vn,Rd,zm,s,Jn,Ia,Oo,_s,y,"Throttled",-0,0),p);break e}dv(u,o,Vn,Rd,zm,s,Jn,Ia,Oo,_s,y,null,-0,0)}}break}while(!0);ai(r)}function dv(r,s,o,u,p,y,E,O,G,se,pe,_e,le,he){if(r.timeoutHandle=-1,_e=s.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Cr},rv(s,y,_e);var Ce=(y&62914560)===y?Ad-Ct():(y&4194048)===y?ov-Ct():0;if(Ce=ZA(_e,Ce),Ce!==null){Ni=y,r.cancelPendingCommit=Ce(vv.bind(null,r,s,y,o,u,p,E,O,G,pe,_e,null,le,he)),Es(r,y,E,!se);return}}vv(r,s,y,o,u,p,E,O,G)}function pA(r){for(var s=r;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var p=o[u],y=p.getSnapshot;p=p.value;try{if(!$n(y(),p))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Es(r,s,o,u){s&=~Vm,s&=~Ia,r.suspendedLanes|=s,r.pingedLanes&=~s,u&&(r.warmLanes|=s),u=r.expirationTimes;for(var p=s;0<p;){var y=31-Ot(p),E=1<<y;u[y]=-1,p&=~E}o!==0&&sa(r,o,s)}function Dd(){return(it&6)===0?(Ec(0),!1):!0}function qm(){if(He!==null){if(lt===0)var r=He.return;else r=He,wi=xa=null,sm(r),wo=null,ic=0,r=He;for(;r!==null;)F0(r.alternate,r),r=r.return;He=null}}function ko(r,s){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,NA(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),Ni=0,qm(),mt=r,He=o=Ei(r.current,null),$e=s,lt=0,Xn=null,_s=!1,jo=wr(r,s),Lm=!1,Oo=Jn=Vm=Ia=vs=Dt=0,Vn=bc=null,zm=!1,(s&8)!==0&&(s|=s&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=s;0<u;){var p=31-Ot(u),y=1<<p;s|=r[p],u&=~y}return ki=s,Yu(),o}function hv(r,s){Fe=null,L.H=hc,s===So||s===id?(s=R_(),lt=3):s===$f?(s=R_(),lt=4):lt=s===xm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Xn=s,He===null&&(Dt=1,_d(r,dr(s,r.current)))}function fv(){var r=Wn.current;return r===null?!0:($e&4194048)===$e?pr===null:($e&62914560)===$e||($e&536870912)!==0?r===pr:!1}function mv(){var r=L.H;return L.H=hc,r===null?hc:r}function pv(){var r=L.A;return L.A=fA,r}function Id(){Dt=4,_s||($e&4194048)!==$e&&Wn.current!==null||(jo=!0),(vs&134217727)===0&&(Ia&134217727)===0||mt===null||Es(mt,$e,Jn,!1)}function Hm(r,s,o){var u=it;it|=2;var p=mv(),y=pv();(mt!==r||$e!==s)&&(Rd=null,ko(r,s)),s=!1;var E=Dt;e:do try{if(lt!==0&&He!==null){var O=He,G=Xn;switch(lt){case 8:qm(),E=6;break e;case 3:case 2:case 9:case 6:Wn.current===null&&(s=!0);var se=lt;if(lt=0,Xn=null,No(r,O,G,se),o&&jo){E=0;break e}break;default:se=lt,lt=0,Xn=null,No(r,O,G,se)}}gA(),E=Dt;break}catch(pe){hv(r,pe)}while(!0);return s&&r.shellSuspendCounter++,wi=xa=null,it=u,L.H=p,L.A=y,He===null&&(mt=null,$e=0,Yu()),E}function gA(){for(;He!==null;)gv(He)}function yA(r,s){var o=it;it|=2;var u=mv(),p=pv();mt!==r||$e!==s?(Rd=null,Cd=Ct()+500,ko(r,s)):jo=wr(r,s);e:do try{if(lt!==0&&He!==null){s=He;var y=Xn;t:switch(lt){case 1:lt=0,Xn=null,No(r,s,y,1);break;case 2:case 9:if(A_(y)){lt=0,Xn=null,yv(s);break}s=function(){lt!==2&&lt!==9||mt!==r||(lt=7),ai(r)},y.then(s,s);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:A_(y)?(lt=0,Xn=null,yv(s)):(lt=0,Xn=null,No(r,s,y,7));break;case 5:var E=null;switch(He.tag){case 26:E=He.memoizedState;case 5:case 27:var O=He;if(E?nb(E):O.stateNode.complete){lt=0,Xn=null;var G=O.sibling;if(G!==null)He=G;else{var se=O.return;se!==null?(He=se,jd(se)):He=null}break t}}lt=0,Xn=null,No(r,s,y,5);break;case 6:lt=0,Xn=null,No(r,s,y,6);break;case 8:qm(),Dt=6;break e;default:throw Error(i(462))}}_A();break}catch(pe){hv(r,pe)}while(!0);return wi=xa=null,L.H=u,L.A=p,it=o,He!==null?0:(mt=null,$e=0,Yu(),Dt)}function _A(){for(;He!==null&&!Fn();)gv(He)}function gv(r){var s=U0(r.alternate,r,ki);r.memoizedProps=r.pendingProps,s===null?jd(r):He=s}function yv(r){var s=r,o=s.alternate;switch(s.tag){case 15:case 0:s=k0(o,s,s.pendingProps,s.type,void 0,$e);break;case 11:s=k0(o,s,s.pendingProps,s.type.render,s.ref,$e);break;case 5:sm(s);default:F0(o,s),s=He=p_(s,ki),s=U0(o,s,ki)}r.memoizedProps=r.pendingProps,s===null?jd(r):He=s}function No(r,s,o,u){wi=xa=null,sm(s),wo=null,ic=0;var p=s.return;try{if(aA(r,p,s,o,$e)){Dt=1,_d(r,dr(o,r.current)),He=null;return}}catch(y){if(p!==null)throw He=p,y;Dt=1,_d(r,dr(o,r.current)),He=null;return}s.flags&32768?(Je||u===1?r=!0:jo||($e&536870912)!==0?r=!1:(_s=r=!0,(u===2||u===9||u===3||u===6)&&(u=Wn.current,u!==null&&u.tag===13&&(u.flags|=16384))),_v(s,r)):jd(s)}function jd(r){var s=r;do{if((s.flags&32768)!==0){_v(s,_s);return}r=s.return;var o=cA(s.alternate,s,ki);if(o!==null){He=o;return}if(s=s.sibling,s!==null){He=s;return}He=s=r}while(s!==null);Dt===0&&(Dt=5)}function _v(r,s){do{var o=uA(r.alternate,r);if(o!==null){o.flags&=32767,He=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(r=r.sibling,r!==null)){He=r;return}He=r=o}while(r!==null);Dt=6,He=null}function vv(r,s,o,u,p,y,E,O,G){r.cancelPendingCommit=null;do Od();while(en!==0);if((it&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=Of,Sf(r,o,y,E,O,G),r===mt&&(He=mt=null,$e=0),Mo=s,xs=r,Ni=o,Um=y,Bm=p,lv=u,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,EA(Ji,function(){return wv(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||u){u=L.T,L.T=null,p=Q.p,Q.p=2,E=it,it|=4;try{dA(r,s,o)}finally{it=E,Q.p=p,L.T=u}}en=1,bv(),xv(),Ev()}}function bv(){if(en===1){en=0;var r=xs,s=Mo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=L.T,L.T=null;var u=Q.p;Q.p=2;var p=it;it|=4;try{ev(s,r);var y=np,E=a_(r.containerInfo),O=y.focusedElem,G=y.selectionRange;if(E!==O&&O&&O.ownerDocument&&s_(O.ownerDocument.documentElement,O)){if(G!==null&&Cf(O)){var se=G.start,pe=G.end;if(pe===void 0&&(pe=se),"selectionStart"in O)O.selectionStart=se,O.selectionEnd=Math.min(pe,O.value.length);else{var _e=O.ownerDocument||document,le=_e&&_e.defaultView||window;if(le.getSelection){var he=le.getSelection(),Ce=O.textContent.length,Oe=Math.min(G.start,Ce),ft=G.end===void 0?Oe:Math.min(G.end,Ce);!he.extend&&Oe>ft&&(E=ft,ft=Oe,Oe=E);var te=i_(O,Oe),Y=i_(O,ft);if(te&&Y&&(he.rangeCount!==1||he.anchorNode!==te.node||he.anchorOffset!==te.offset||he.focusNode!==Y.node||he.focusOffset!==Y.offset)){var ie=_e.createRange();ie.setStart(te.node,te.offset),he.removeAllRanges(),Oe>ft?(he.addRange(ie),he.extend(Y.node,Y.offset)):(ie.setEnd(Y.node,Y.offset),he.addRange(ie))}}}}for(_e=[],he=O;he=he.parentNode;)he.nodeType===1&&_e.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<_e.length;O++){var ye=_e[O];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}Hd=!!tp,np=tp=null}finally{it=p,Q.p=u,L.T=o}}r.current=s,en=2}}function xv(){if(en===2){en=0;var r=xs,s=Mo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=L.T,L.T=null;var u=Q.p;Q.p=2;var p=it;it|=4;try{W0(r,s.alternate,s)}finally{it=p,Q.p=u,L.T=o}}en=3}}function Ev(){if(en===4||en===3){en=0,Er();var r=xs,s=Mo,o=Ni,u=lv;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?en=5:(en=0,Mo=xs=null,Sv(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&(bs=null),_i(o),s=s.stateNode,hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(Sr,s,void 0,(s.current.flags&128)===128)}catch{}if(u!==null){s=L.T,p=Q.p,Q.p=2,L.T=null;try{for(var y=r.onRecoverableError,E=0;E<u.length;E++){var O=u[E];y(O.value,{componentStack:O.stack})}}finally{L.T=s,Q.p=p}}(Ni&3)!==0&&Od(),ai(r),p=r.pendingLanes,(o&261930)!==0&&(p&42)!==0?r===Fm?xc++:(xc=0,Fm=r):xc=0,Ec(0)}}function Sv(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,nc(s)))}function Od(){return bv(),xv(),Ev(),wv()}function wv(){if(en!==5)return!1;var r=xs,s=Um;Um=0;var o=_i(Ni),u=L.T,p=Q.p;try{Q.p=32>o?32:o,L.T=null,o=Bm,Bm=null;var y=xs,E=Ni;if(en=0,Mo=xs=null,Ni=0,(it&6)!==0)throw Error(i(331));var O=it;if(it|=4,sv(y.current),nv(y,y.current,E,o),it=O,Ec(0,!1),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(Sr,y)}catch{}return!0}finally{Q.p=p,L.T=u,Sv(r,s)}}function Tv(r,s,o){s=dr(o,s),s=bm(r.stateNode,s,2),r=ms(r,s,2),r!==null&&(ia(r,2),ai(r))}function ct(r,s,o){if(r.tag===3)Tv(r,r,o);else for(;s!==null;){if(s.tag===3){Tv(s,r,o);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(bs===null||!bs.has(u))){r=dr(o,r),o=A0(2),u=ms(s,o,2),u!==null&&(C0(o,u,s,r),ia(u,2),ai(u));break}}s=s.return}}function Gm(r,s,o){var u=r.pingCache;if(u===null){u=r.pingCache=new mA;var p=new Set;u.set(s,p)}else p=u.get(s),p===void 0&&(p=new Set,u.set(s,p));p.has(o)||(Lm=!0,p.add(o),r=vA.bind(null,r,s,o),s.then(r,r))}function vA(r,s,o){var u=r.pingCache;u!==null&&u.delete(s),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,mt===r&&($e&o)===o&&(Dt===4||Dt===3&&($e&62914560)===$e&&300>Ct()-Ad?(it&2)===0&&ko(r,0):Vm|=o,Oo===$e&&(Oo=0)),ai(r)}function Av(r,s){s===0&&(s=Ru()),r=_a(r,s),r!==null&&(ia(r,s),ai(r))}function bA(r){var s=r.memoizedState,o=0;s!==null&&(o=s.retryLane),Av(r,o)}function xA(r,s){var o=0;switch(r.tag){case 31:case 13:var u=r.stateNode,p=r.memoizedState;p!==null&&(o=p.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(s),Av(r,o)}function EA(r,s){return jt(r,s)}var Md=null,Po=null,Qm=!1,kd=!1,$m=!1,Ss=0;function ai(r){r!==Po&&r.next===null&&(Po===null?Md=Po=r:Po=Po.next=r),kd=!0,Qm||(Qm=!0,wA())}function Ec(r,s){if(!$m&&kd){$m=!0;do for(var o=!1,u=Md;u!==null;){if(r!==0){var p=u.pendingLanes;if(p===0)var y=0;else{var E=u.suspendedLanes,O=u.pingedLanes;y=(1<<31-Ot(42|r)+1)-1,y&=p&~(E&~O),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,Iv(u,y))}else y=$e,y=Fr(u,u===mt?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||wr(u,y)||(o=!0,Iv(u,y));u=u.next}while(o);$m=!1}}function SA(){Cv()}function Cv(){kd=Qm=!1;var r=0;Ss!==0&&kA()&&(r=Ss);for(var s=Ct(),o=null,u=Md;u!==null;){var p=u.next,y=Rv(u,s);y===0?(u.next=null,o===null?Md=p:o.next=p,p===null&&(Po=o)):(o=u,(r!==0||(y&3)!==0)&&(kd=!0)),u=p}en!==0&&en!==5||Ec(r),Ss!==0&&(Ss=0)}function Rv(r,s){for(var o=r.suspendedLanes,u=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var E=31-Ot(y),O=1<<E,G=p[E];G===-1?((O&o)===0||(O&u)!==0)&&(p[E]=Ef(O,s)):G<=s&&(r.expiredLanes|=O),y&=~O}if(s=mt,o=$e,o=Fr(r,r===s?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===s&&(lt===2||lt===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&nt(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||wr(r,o)){if(s=o&-o,s===r.callbackPriority)return s;switch(u!==null&&nt(u),_i(o)){case 2:case 8:o=Hn;break;case 32:o=Ji;break;case 268435456:o=Su;break;default:o=Ji}return u=Dv.bind(null,r),o=jt(o,u),r.callbackPriority=s,r.callbackNode=o,s}return u!==null&&u!==null&&nt(u),r.callbackPriority=2,r.callbackNode=null,2}function Dv(r,s){if(en!==0&&en!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(Od()&&r.callbackNode!==o)return null;var u=$e;return u=Fr(r,r===mt?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(uv(r,u,s),Rv(r,Ct()),r.callbackNode!=null&&r.callbackNode===o?Dv.bind(null,r):null)}function Iv(r,s){if(Od())return null;uv(r,s,!0)}function wA(){PA(function(){(it&6)!==0?jt(Vt,SA):Cv()})}function Km(){if(Ss===0){var r=xo;r===0&&(r=Ur,Ur<<=1,(Ur&261888)===0&&(Ur=256)),Ss=r}return Ss}function jv(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:so(""+r)}function Ov(r,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,r.id&&o.setAttribute("form",r.id),s.parentNode.insertBefore(o,s),r=new FormData(r),o.parentNode.removeChild(o),r}function TA(r,s,o,u,p){if(s==="submit"&&o&&o.stateNode===p){var y=jv((p[an]||null).action),E=u.submitter;E&&(s=(s=E[an]||null)?jv(s.formAction):E.getAttribute("formAction"),s!==null&&(y=s,E=null));var O=new Zr("action","action",null,u,p);r.push({event:O,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Ss!==0){var G=E?Ov(p,E):new FormData(p);mm(o,{pending:!0,data:G,method:p.method,action:y},null,G)}}else typeof y=="function"&&(O.preventDefault(),G=E?Ov(p,E):new FormData(p),mm(o,{pending:!0,data:G,method:p.method,action:y},y,G))},currentTarget:p}]})}}for(var Wm=0;Wm<jf.length;Wm++){var Ym=jf[Wm],AA=Ym.toLowerCase(),CA=Ym[0].toUpperCase()+Ym.slice(1);Or(AA,"on"+CA)}Or(c_,"onAnimationEnd"),Or(u_,"onAnimationIteration"),Or(d_,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(qT,"onTransitionRun"),Or(HT,"onTransitionStart"),Or(GT,"onTransitionCancel"),Or(h_,"onTransitionEnd"),Wr("onMouseEnter",["mouseout","mouseover"]),Wr("onMouseLeave",["mouseout","mouseover"]),Wr("onPointerEnter",["pointerout","pointerover"]),Wr("onPointerLeave",["pointerout","pointerover"]),Kr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Kr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Kr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Kr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Kr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Kr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),RA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sc));function Mv(r,s){s=(s&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],p=u.event;u=u.listeners;e:{var y=void 0;if(s)for(var E=u.length-1;0<=E;E--){var O=u[E],G=O.instance,se=O.currentTarget;if(O=O.listener,G!==y&&p.isPropagationStopped())break e;y=O,p.currentTarget=se;try{y(p)}catch(pe){Wu(pe)}p.currentTarget=null,y=G}else for(E=0;E<u.length;E++){if(O=u[E],G=O.instance,se=O.currentTarget,O=O.listener,G!==y&&p.isPropagationStopped())break e;y=O,p.currentTarget=se;try{y(p)}catch(pe){Wu(pe)}p.currentTarget=null,y=G}}}}function Ge(r,s){var o=s[eo];o===void 0&&(o=s[eo]=new Set);var u=r+"__bubble";o.has(u)||(kv(s,r,2,!1),o.add(u))}function Xm(r,s,o){var u=0;s&&(u|=4),kv(o,r,u,s)}var Nd="_reactListening"+Math.random().toString(36).slice(2);function Jm(r){if(!r[Nd]){r[Nd]=!0,Nl.forEach(function(o){o!=="selectionchange"&&(RA.has(o)||Xm(o,!1,r),Xm(o,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Nd]||(s[Nd]=!0,Xm("selectionchange",!1,s))}}function kv(r,s,o,u){switch(cb(s)){case 2:var p=nC;break;case 8:p=rC;break;default:p=fp}o=p.bind(null,s,o,r),p=void 0,!ua||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),u?p!==void 0?r.addEventListener(s,o,{capture:!0,passive:p}):r.addEventListener(s,o,!0):p!==void 0?r.addEventListener(s,o,{passive:p}):r.addEventListener(s,o,!1)}function Zm(r,s,o,u,p){var y=u;if((s&1)===0&&(s&2)===0&&u!==null)e:for(;;){if(u===null)return;var E=u.tag;if(E===3||E===4){var O=u.stateNode.containerInfo;if(O===p)break;if(E===4)for(E=u.return;E!==null;){var G=E.tag;if((G===3||G===4)&&E.stateNode.containerInfo===p)return;E=E.return}for(;O!==null;){if(E=Qr(O),E===null)return;if(G=E.tag,G===5||G===6||G===26||G===27){u=y=E;continue e}O=O.parentNode}}u=u.return}is(function(){var se=y,pe=or(o),_e=[];e:{var le=f_.get(r);if(le!==void 0){var he=Zr,Ce=r;switch(r){case"keypress":if(ha(o)===0)break e;case"keydown":case"keyup":he=Qu;break;case"focusin":Ce="focus",he=ma;break;case"focusout":Ce="blur",he=ma;break;case"beforeblur":case"afterblur":he=ma;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=Kl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=Lu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=x;break;case c_:case u_:case d_:he=zu;break;case h_:he=V;break;case"scroll":case"scrollend":he=$l;break;case"wheel":he=de;break;case"copy":case"cut":case"paste":he=Uu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=xi;break;case"toggle":case"beforetoggle":he=Be}var Oe=(s&4)!==0,ft=!Oe&&(r==="scroll"||r==="scrollend"),te=Oe?le!==null?le+"Capture":null:le;Oe=[];for(var Y=se,ie;Y!==null;){var ye=Y;if(ie=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||ie===null||te===null||(ye=Rr(Y,te),ye!=null&&Oe.push(wc(Y,ye,ie))),ft)break;Y=Y.return}0<Oe.length&&(le=new he(le,Ce,null,o,pe),_e.push({event:le,listeners:Oe}))}}if((s&7)===0){e:{if(le=r==="mouseover"||r==="pointerover",he=r==="mouseout"||r==="pointerout",le&&o!==Hl&&(Ce=o.relatedTarget||o.fromElement)&&(Qr(Ce)||Ce[Hr]))break e;if((he||le)&&(le=pe.window===pe?pe:(le=pe.ownerDocument)?le.defaultView||le.parentWindow:window,he?(Ce=o.relatedTarget||o.toElement,he=se,Ce=Ce?Qr(Ce):null,Ce!==null&&(ft=l(Ce),Oe=Ce.tag,Ce!==ft||Oe!==5&&Oe!==27&&Oe!==6)&&(Ce=null)):(he=null,Ce=se),he!==Ce)){if(Oe=Kl,ye="onMouseLeave",te="onMouseEnter",Y="mouse",(r==="pointerout"||r==="pointerover")&&(Oe=xi,ye="onPointerLeave",te="onPointerEnter",Y="pointer"),ft=he==null?le:Gn(he),ie=Ce==null?le:Gn(Ce),le=new Oe(ye,Y+"leave",he,o,pe),le.target=ft,le.relatedTarget=ie,ye=null,Qr(pe)===se&&(Oe=new Oe(te,Y+"enter",Ce,o,pe),Oe.target=ie,Oe.relatedTarget=ft,ye=Oe),ft=ye,he&&Ce)t:{for(Oe=DA,te=he,Y=Ce,ie=0,ye=te;ye;ye=Oe(ye))ie++;ye=0;for(var Ie=Y;Ie;Ie=Oe(Ie))ye++;for(;0<ie-ye;)te=Oe(te),ie--;for(;0<ye-ie;)Y=Oe(Y),ye--;for(;ie--;){if(te===Y||Y!==null&&te===Y.alternate){Oe=te;break t}te=Oe(te),Y=Oe(Y)}Oe=null}else Oe=null;he!==null&&Nv(_e,le,he,Oe,!1),Ce!==null&&ft!==null&&Nv(_e,ft,Ce,Oe,!0)}}e:{if(le=se?Gn(se):window,he=le.nodeName&&le.nodeName.toLowerCase(),he==="select"||he==="input"&&le.type==="file")var et=Jy;else if(Yy(le))if(Zy)et=UT;else{et=VT;var Re=LT}else he=le.nodeName,!he||he.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?se&&io(se.elementType)&&(et=Jy):et=zT;if(et&&(et=et(r,se))){Xy(_e,et,o,pe);break e}Re&&Re(r,le,se),r==="focusout"&&se&&le.type==="number"&&se.memoizedProps.value!=null&&Bl(le,"number",le.value)}switch(Re=se?Gn(se):window,r){case"focusin":(Yy(Re)||Re.contentEditable==="true")&&(fo=Re,Rf=se,Zl=null);break;case"focusout":Zl=Rf=fo=null;break;case"mousedown":Df=!0;break;case"contextmenu":case"mouseup":case"dragend":Df=!1,o_(_e,o,pe);break;case"selectionchange":if(FT)break;case"keydown":case"keyup":o_(_e,o,pe)}var qe;if(rt)e:{switch(r){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else ho?pa(r,o)&&(Ke="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ke="onCompositionStart");Ke&&(ni&&o.locale!=="ko"&&(ho||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&ho&&(qe=Ql()):(Jr=pe,Gl="value"in Jr?Jr.value:Jr.textContent,ho=!0)),Re=Pd(se,Ke),0<Re.length&&(Ke=new ti(Ke,r,null,o,pe),_e.push({event:Ke,listeners:Re}),qe?Ke.data=qe:(qe=uo(o),qe!==null&&(Ke.data=qe)))),(qe=cr?MT(r,o):kT(r,o))&&(Ke=Pd(se,"onBeforeInput"),0<Ke.length&&(Re=new ti("onBeforeInput","beforeinput",null,o,pe),_e.push({event:Re,listeners:Ke}),Re.data=qe)),TA(_e,r,se,o,pe)}Mv(_e,s)})}function wc(r,s,o){return{instance:r,listener:s,currentTarget:o}}function Pd(r,s){for(var o=s+"Capture",u=[];r!==null;){var p=r,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Rr(r,o),p!=null&&u.unshift(wc(r,p,y)),p=Rr(r,s),p!=null&&u.push(wc(r,p,y))),r.tag===3)return u;r=r.return}return[]}function DA(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Nv(r,s,o,u,p){for(var y=s._reactName,E=[];o!==null&&o!==u;){var O=o,G=O.alternate,se=O.stateNode;if(O=O.tag,G!==null&&G===u)break;O!==5&&O!==26&&O!==27||se===null||(G=se,p?(se=Rr(o,y),se!=null&&E.unshift(wc(o,se,G))):p||(se=Rr(o,y),se!=null&&E.push(wc(o,se,G)))),o=o.return}E.length!==0&&r.push({event:s,listeners:E})}var IA=/\r\n?/g,jA=/\u0000|\uFFFD/g;function Pv(r){return(typeof r=="string"?r:""+r).replace(IA,`
`).replace(jA,"")}function Lv(r,s){return s=Pv(s),Pv(r)===s}function ht(r,s,o,u,p,y){switch(o){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||kn(r,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&kn(r,""+u);break;case"className":Qn(r,"class",u);break;case"tabIndex":Qn(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Qn(r,o,u);break;case"style":ql(r,u,y);break;case"data":if(s!=="object"){Qn(r,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=so(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&ht(r,s,"name",p.name,p,null),ht(r,s,"formEncType",p.formEncType,p,null),ht(r,s,"formMethod",p.formMethod,p,null),ht(r,s,"formTarget",p.formTarget,p,null)):(ht(r,s,"encType",p.encType,p,null),ht(r,s,"method",p.method,p,null),ht(r,s,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=so(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=Cr);break;case"onScroll":u!=null&&Ge("scroll",r);break;case"onScrollEnd":u!=null&&Ge("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=so(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":Ge("beforetoggle",r),Ge("toggle",r),no(r,"popover",u);break;case"xlinkActuate":Ft(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ft(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ft(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ft(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ft(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ft(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":no(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Pu.get(o)||o,no(r,o,u))}}function ep(r,s,o,u,p,y){switch(o){case"style":ql(r,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"children":typeof u=="string"?kn(r,u):(typeof u=="number"||typeof u=="bigint")&&kn(r,""+u);break;case"onScroll":u!=null&&Ge("scroll",r);break;case"onScrollEnd":u!=null&&Ge("scrollend",r);break;case"onClick":u!=null&&(r.onclick=Cr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Pl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),s=o.slice(2,p?o.length-7:void 0),y=r[an]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(s,y,p),typeof u=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(s,u,p);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):no(r,o,u)}}}function yn(r,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",r),Ge("load",r);var u=!1,p=!1,y;for(y in o)if(o.hasOwnProperty(y)){var E=o[y];if(E!=null)switch(y){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ht(r,s,y,E,o,null)}}p&&ht(r,s,"srcSet",o.srcSet,o,null),u&&ht(r,s,"src",o.src,o,null);return;case"input":Ge("invalid",r);var O=y=E=p=null,G=null,se=null;for(u in o)if(o.hasOwnProperty(u)){var pe=o[u];if(pe!=null)switch(u){case"name":p=pe;break;case"type":E=pe;break;case"checked":G=pe;break;case"defaultChecked":se=pe;break;case"value":y=pe;break;case"defaultValue":O=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(i(137,s));break;default:ht(r,s,u,pe,o,null)}}Mu(r,y,O,G,se,E,p,!1);return;case"select":Ge("invalid",r),u=E=y=null;for(p in o)if(o.hasOwnProperty(p)&&(O=o[p],O!=null))switch(p){case"value":y=O;break;case"defaultValue":E=O;break;case"multiple":u=O;default:ht(r,s,p,O,o,null)}s=y,o=E,r.multiple=!!u,s!=null?es(r,!!u,s,!1):o!=null&&es(r,!!u,o,!0);return;case"textarea":Ge("invalid",r),y=p=u=null;for(E in o)if(o.hasOwnProperty(E)&&(O=o[E],O!=null))switch(E){case"value":u=O;break;case"defaultValue":p=O;break;case"children":y=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(i(91));break;default:ht(r,s,E,O,o,null)}ts(r,u,p,y);return;case"option":for(G in o)o.hasOwnProperty(G)&&(u=o[G],u!=null)&&(G==="selected"?r.selected=u&&typeof u!="function"&&typeof u!="symbol":ht(r,s,G,u,o,null));return;case"dialog":Ge("beforetoggle",r),Ge("toggle",r),Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":Ge("load",r);break;case"video":case"audio":for(u=0;u<Sc.length;u++)Ge(Sc[u],r);break;case"image":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"embed":case"source":case"link":Ge("error",r),Ge("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in o)if(o.hasOwnProperty(se)&&(u=o[se],u!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ht(r,s,se,u,o,null)}return;default:if(io(s)){for(pe in o)o.hasOwnProperty(pe)&&(u=o[pe],u!==void 0&&ep(r,s,pe,u,o,void 0));return}}for(O in o)o.hasOwnProperty(O)&&(u=o[O],u!=null&&ht(r,s,O,u,o,null))}function OA(r,s,o,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,E=null,O=null,G=null,se=null,pe=null;for(he in o){var _e=o[he];if(o.hasOwnProperty(he)&&_e!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":G=_e;default:u.hasOwnProperty(he)||ht(r,s,he,null,u,_e)}}for(var le in u){var he=u[le];if(_e=o[le],u.hasOwnProperty(le)&&(he!=null||_e!=null))switch(le){case"type":y=he;break;case"name":p=he;break;case"checked":se=he;break;case"defaultChecked":pe=he;break;case"value":E=he;break;case"defaultValue":O=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,s));break;default:he!==_e&&ht(r,s,le,he,u,_e)}}ro(r,E,O,G,se,pe,y,p);return;case"select":he=E=O=le=null;for(y in o)if(G=o[y],o.hasOwnProperty(y)&&G!=null)switch(y){case"value":break;case"multiple":he=G;default:u.hasOwnProperty(y)||ht(r,s,y,null,u,G)}for(p in u)if(y=u[p],G=o[p],u.hasOwnProperty(p)&&(y!=null||G!=null))switch(p){case"value":le=y;break;case"defaultValue":O=y;break;case"multiple":E=y;default:y!==G&&ht(r,s,p,y,u,G)}s=O,o=E,u=he,le!=null?es(r,!!o,le,!1):!!u!=!!o&&(s!=null?es(r,!!o,s,!0):es(r,!!o,o?[]:"",!1));return;case"textarea":he=le=null;for(O in o)if(p=o[O],o.hasOwnProperty(O)&&p!=null&&!u.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:ht(r,s,O,null,u,p)}for(E in u)if(p=u[E],y=o[E],u.hasOwnProperty(E)&&(p!=null||y!=null))switch(E){case"value":le=p;break;case"defaultValue":he=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==y&&ht(r,s,E,p,u,y)}ku(r,le,he);return;case"option":for(var Ce in o)le=o[Ce],o.hasOwnProperty(Ce)&&le!=null&&!u.hasOwnProperty(Ce)&&(Ce==="selected"?r.selected=!1:ht(r,s,Ce,null,u,le));for(G in u)le=u[G],he=o[G],u.hasOwnProperty(G)&&le!==he&&(le!=null||he!=null)&&(G==="selected"?r.selected=le&&typeof le!="function"&&typeof le!="symbol":ht(r,s,G,le,u,he));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Oe in o)le=o[Oe],o.hasOwnProperty(Oe)&&le!=null&&!u.hasOwnProperty(Oe)&&ht(r,s,Oe,null,u,le);for(se in u)if(le=u[se],he=o[se],u.hasOwnProperty(se)&&le!==he&&(le!=null||he!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,s));break;default:ht(r,s,se,le,u,he)}return;default:if(io(s)){for(var ft in o)le=o[ft],o.hasOwnProperty(ft)&&le!==void 0&&!u.hasOwnProperty(ft)&&ep(r,s,ft,void 0,u,le);for(pe in u)le=u[pe],he=o[pe],!u.hasOwnProperty(pe)||le===he||le===void 0&&he===void 0||ep(r,s,pe,le,u,he);return}}for(var te in o)le=o[te],o.hasOwnProperty(te)&&le!=null&&!u.hasOwnProperty(te)&&ht(r,s,te,null,u,le);for(_e in u)le=u[_e],he=o[_e],!u.hasOwnProperty(_e)||le===he||le==null&&he==null||ht(r,s,_e,le,u,he)}function Vv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function MA(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var p=o[u],y=p.transferSize,E=p.initiatorType,O=p.duration;if(y&&O&&Vv(E)){for(E=0,O=p.responseEnd,u+=1;u<o.length;u++){var G=o[u],se=G.startTime;if(se>O)break;var pe=G.transferSize,_e=G.initiatorType;pe&&Vv(_e)&&(G=G.responseEnd,E+=pe*(G<O?1:(O-se)/(G-se)))}if(--u,s+=8*(y+E)/(p.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var tp=null,np=null;function Ld(r){return r.nodeType===9?r:r.ownerDocument}function zv(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Uv(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function rp(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ip=null;function kA(){var r=window.event;return r&&r.type==="popstate"?r===ip?!1:(ip=r,!0):(ip=null,!1)}var Bv=typeof setTimeout=="function"?setTimeout:void 0,NA=typeof clearTimeout=="function"?clearTimeout:void 0,Fv=typeof Promise=="function"?Promise:void 0,PA=typeof queueMicrotask=="function"?queueMicrotask:typeof Fv<"u"?function(r){return Fv.resolve(null).then(r).catch(LA)}:Bv;function LA(r){setTimeout(function(){throw r})}function ws(r){return r==="head"}function qv(r,s){var o=s,u=0;do{var p=o.nextSibling;if(r.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(u===0){r.removeChild(p),Uo(s);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")Tc(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,Tc(o);for(var y=o.firstChild;y;){var E=y.nextSibling,O=y.nodeName;y[Gr]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=E}}else o==="body"&&Tc(r.ownerDocument.body);o=p}while(o);Uo(s)}function Hv(r,s){var o=r;r=0;do{var u=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=u}while(o)}function sp(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":sp(o),to(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function VA(r,s,o,u){for(;r.nodeType===1;){var p=o;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[Gr])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=gr(r.nextSibling),r===null)break}return null}function zA(r,s,o){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=gr(r.nextSibling),r===null))return null;return r}function Gv(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=gr(r.nextSibling),r===null))return null;return r}function ap(r){return r.data==="$?"||r.data==="$~"}function op(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function UA(r,s){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||o.readyState!=="loading")s();else{var u=function(){s(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function gr(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var lp=null;function Qv(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(s===0)return gr(r.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}r=r.nextSibling}return null}function $v(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return r;s--}else o!=="/$"&&o!=="/&"||s++}r=r.previousSibling}return null}function Kv(r,s,o){switch(s=Ld(o),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Tc(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);to(r)}var yr=new Map,Wv=new Set;function Vd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Pi=Q.d;Q.d={f:BA,r:FA,D:qA,C:HA,L:GA,m:QA,X:KA,S:$A,M:WA};function BA(){var r=Pi.f(),s=Dd();return r||s}function FA(r){var s=ar(r);s!==null&&s.tag===5&&s.type==="form"?h0(s):Pi.r(r)}var Lo=typeof document>"u"?null:document;function Yv(r,s,o){var u=Lo;if(u&&typeof s=="string"&&s){var p=Mn(s);p='link[rel="'+r+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),Wv.has(p)||(Wv.add(p),r={rel:r,crossOrigin:o,href:s},u.querySelector(p)===null&&(s=u.createElement("link"),yn(s,"link",r),Bt(s),u.head.appendChild(s)))}}function qA(r){Pi.D(r),Yv("dns-prefetch",r,null)}function HA(r,s){Pi.C(r,s),Yv("preconnect",r,s)}function GA(r,s,o){Pi.L(r,s,o);var u=Lo;if(u&&r&&s){var p='link[rel="preload"][as="'+Mn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+Mn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+Mn(o.imageSizes)+'"]')):p+='[href="'+Mn(r)+'"]';var y=p;switch(s){case"style":y=Vo(r);break;case"script":y=zo(r)}yr.has(y)||(r=v({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:r,as:s},o),yr.set(y,r),u.querySelector(p)!==null||s==="style"&&u.querySelector(Ac(y))||s==="script"&&u.querySelector(Cc(y))||(s=u.createElement("link"),yn(s,"link",r),Bt(s),u.head.appendChild(s)))}}function QA(r,s){Pi.m(r,s);var o=Lo;if(o&&r){var u=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+Mn(u)+'"][href="'+Mn(r)+'"]',y=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=zo(r)}if(!yr.has(y)&&(r=v({rel:"modulepreload",href:r},s),yr.set(y,r),o.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Cc(y)))return}u=o.createElement("link"),yn(u,"link",r),Bt(u),o.head.appendChild(u)}}}function $A(r,s,o){Pi.S(r,s,o);var u=Lo;if(u&&r){var p=$r(u).hoistableStyles,y=Vo(r);s=s||"default";var E=p.get(y);if(!E){var O={loading:0,preload:null};if(E=u.querySelector(Ac(y)))O.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":s},o),(o=yr.get(y))&&cp(r,o);var G=E=u.createElement("link");Bt(G),yn(G,"link",r),G._p=new Promise(function(se,pe){G.onload=se,G.onerror=pe}),G.addEventListener("load",function(){O.loading|=1}),G.addEventListener("error",function(){O.loading|=2}),O.loading|=4,zd(E,s,u)}E={type:"stylesheet",instance:E,count:1,state:O},p.set(y,E)}}}function KA(r,s){Pi.X(r,s);var o=Lo;if(o&&r){var u=$r(o).hoistableScripts,p=zo(r),y=u.get(p);y||(y=o.querySelector(Cc(p)),y||(r=v({src:r,async:!0},s),(s=yr.get(p))&&up(r,s),y=o.createElement("script"),Bt(y),yn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(p,y))}}function WA(r,s){Pi.M(r,s);var o=Lo;if(o&&r){var u=$r(o).hoistableScripts,p=zo(r),y=u.get(p);y||(y=o.querySelector(Cc(p)),y||(r=v({src:r,async:!0,type:"module"},s),(s=yr.get(p))&&up(r,s),y=o.createElement("script"),Bt(y),yn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(p,y))}}function Xv(r,s,o,u){var p=(p=ge.current)?Vd(p):null;if(!p)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Vo(o.href),o=$r(p).hoistableStyles,u=o.get(s),u||(u={type:"style",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=Vo(o.href);var y=$r(p).hoistableStyles,E=y.get(r);if(E||(p=p.ownerDocument||p,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,E),(y=p.querySelector(Ac(r)))&&!y._p&&(E.instance=y,E.state.loading=5),yr.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},yr.set(r,o),y||YA(p,r,o,E.state))),s&&u===null)throw Error(i(528,""));return E}if(s&&u!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=zo(o),o=$r(p).hoistableScripts,u=o.get(s),u||(u={type:"script",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Vo(r){return'href="'+Mn(r)+'"'}function Ac(r){return'link[rel="stylesheet"]['+r+"]"}function Jv(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function YA(r,s,o,u){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=r.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),yn(s,"link",o),Bt(s),r.head.appendChild(s))}function zo(r){return'[src="'+Mn(r)+'"]'}function Cc(r){return"script[async]"+r}function Zv(r,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var u=r.querySelector('style[data-href~="'+Mn(o.href)+'"]');if(u)return s.instance=u,Bt(u),u;var p=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),Bt(u),yn(u,"style",p),zd(u,o.precedence,r),s.instance=u;case"stylesheet":p=Vo(o.href);var y=r.querySelector(Ac(p));if(y)return s.state.loading|=4,s.instance=y,Bt(y),y;u=Jv(o),(p=yr.get(p))&&cp(u,p),y=(r.ownerDocument||r).createElement("link"),Bt(y);var E=y;return E._p=new Promise(function(O,G){E.onload=O,E.onerror=G}),yn(y,"link",u),s.state.loading|=4,zd(y,o.precedence,r),s.instance=y;case"script":return y=zo(o.src),(p=r.querySelector(Cc(y)))?(s.instance=p,Bt(p),p):(u=o,(p=yr.get(y))&&(u=v({},o),up(u,p)),r=r.ownerDocument||r,p=r.createElement("script"),Bt(p),yn(p,"link",u),r.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(u=s.instance,s.state.loading|=4,zd(u,o.precedence,r));return s.instance}function zd(r,s,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,y=p,E=0;E<u.length;E++){var O=u[E];if(O.dataset.precedence===s)y=O;else if(y!==p)break}y?y.parentNode.insertBefore(r,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(r,s.firstChild))}function cp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function up(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var Ud=null;function eb(r,s,o){if(Ud===null){var u=new Map,p=Ud=new Map;p.set(o,u)}else p=Ud,u=p.get(o),u||(u=new Map,p.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),p=0;p<o.length;p++){var y=o[p];if(!(y[Gr]||y[Ut]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var E=y.getAttribute(s)||"";E=r+E;var O=u.get(E);O?O.push(y):u.set(E,[y])}}return u}function tb(r,s,o){r=r.ownerDocument||r,r.head.insertBefore(o,s==="title"?r.querySelector("head > title"):null)}function XA(r,s,o){if(o===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function nb(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function JA(r,s,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=Vo(u.href),y=s.querySelector(Ac(p));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=Bd.bind(r),s.then(r,r)),o.state.loading|=4,o.instance=y,Bt(y);return}y=s.ownerDocument||s,u=Jv(u),(p=yr.get(p))&&cp(u,p),y=y.createElement("link"),Bt(y);var E=y;E._p=new Promise(function(O,G){E.onload=O,E.onerror=G}),yn(y,"link",u),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=Bd.bind(r),s.addEventListener("load",o),s.addEventListener("error",o))}}var dp=0;function ZA(r,s){return r.stylesheets&&r.count===0&&qd(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var u=setTimeout(function(){if(r.stylesheets&&qd(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+s);0<r.imgBytes&&dp===0&&(dp=62500*MA());var p=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&qd(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>dp?50:800)+s);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(p)}}:null}function Bd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)qd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Fd=null;function qd(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Fd=new Map,s.forEach(eC,r),Fd=null,Bd.call(r))}function eC(r,s){if(!(s.state.loading&4)){var o=Fd.get(r);if(o)var u=o.get(null);else{o=new Map,Fd.set(r,o);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var E=p[y];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),u=E)}u&&o.set(null,u)}p=s.instance,E=p.getAttribute("data-precedence"),y=o.get(E)||u,y===u&&o.set(null,p),o.set(E,p),this.count++,u=Bd.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),y?y.parentNode.insertBefore(p,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),s.state.loading|=4}}var Rc={$$typeof:z,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function tC(r,s,o,u,p,y,E,O,G){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qr(0),this.hiddenUpdates=qr(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function rb(r,s,o,u,p,y,E,O,G,se,pe,_e){return r=new tC(r,s,o,E,G,se,pe,_e,O),s=1,y===!0&&(s|=24),y=Kn(3,null,null,s),r.current=y,y.stateNode=r,s=Hf(),s.refCount++,r.pooledCache=s,s.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:s},Kf(y),r}function ib(r){return r?(r=go,r):go}function sb(r,s,o,u,p,y){p=ib(p),u.context===null?u.context=p:u.pendingContext=p,u=fs(s),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=ms(r,u,s),o!==null&&(zn(o,r,s),ac(o,r,s))}function ab(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<s?o:s}}function hp(r,s){ab(r,s),(r=r.alternate)&&ab(r,s)}function ob(r){if(r.tag===13||r.tag===31){var s=_a(r,67108864);s!==null&&zn(s,r,67108864),hp(r,67108864)}}function lb(r){if(r.tag===13||r.tag===31){var s=Zn();s=aa(s);var o=_a(r,s);o!==null&&zn(o,r,s),hp(r,s)}}var Hd=!0;function nC(r,s,o,u){var p=L.T;L.T=null;var y=Q.p;try{Q.p=2,fp(r,s,o,u)}finally{Q.p=y,L.T=p}}function rC(r,s,o,u){var p=L.T;L.T=null;var y=Q.p;try{Q.p=8,fp(r,s,o,u)}finally{Q.p=y,L.T=p}}function fp(r,s,o,u){if(Hd){var p=mp(u);if(p===null)Zm(r,s,u,Gd,o),ub(r,u);else if(sC(p,r,s,o,u))u.stopPropagation();else if(ub(r,u),s&4&&-1<iC.indexOf(r)){for(;p!==null;){var y=ar(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var E=Br(y.pendingLanes);if(E!==0){var O=y;for(O.pendingLanes|=2,O.entangledLanes|=2;E;){var G=1<<31-Ot(E);O.entanglements[1]|=G,E&=~G}ai(y),(it&6)===0&&(Cd=Ct()+500,Ec(0))}}break;case 31:case 13:O=_a(y,2),O!==null&&zn(O,y,2),Dd(),hp(y,2)}if(y=mp(u),y===null&&Zm(r,s,u,Gd,o),y===p)break;p=y}p!==null&&u.stopPropagation()}else Zm(r,s,u,null,o)}}function mp(r){return r=or(r),pp(r)}var Gd=null;function pp(r){if(Gd=null,r=Qr(r),r!==null){var s=l(r);if(s===null)r=null;else{var o=s.tag;if(o===13){if(r=c(s),r!==null)return r;r=null}else if(o===31){if(r=h(s),r!==null)return r;r=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return Gd=r,null}function cb(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(qn()){case Vt:return 2;case Hn:return 8;case Ji:case xf:return 32;case Su:return 268435456;default:return 32}default:return 32}}var gp=!1,Ts=null,As=null,Cs=null,Dc=new Map,Ic=new Map,Rs=[],iC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ub(r,s){switch(r){case"focusin":case"focusout":Ts=null;break;case"dragenter":case"dragleave":As=null;break;case"mouseover":case"mouseout":Cs=null;break;case"pointerover":case"pointerout":Dc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ic.delete(s.pointerId)}}function jc(r,s,o,u,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[p]},s!==null&&(s=ar(s),s!==null&&ob(s)),r):(r.eventSystemFlags|=u,s=r.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),r)}function sC(r,s,o,u,p){switch(s){case"focusin":return Ts=jc(Ts,r,s,o,u,p),!0;case"dragenter":return As=jc(As,r,s,o,u,p),!0;case"mouseover":return Cs=jc(Cs,r,s,o,u,p),!0;case"pointerover":var y=p.pointerId;return Dc.set(y,jc(Dc.get(y)||null,r,s,o,u,p)),!0;case"gotpointercapture":return y=p.pointerId,Ic.set(y,jc(Ic.get(y)||null,r,s,o,u,p)),!0}return!1}function db(r){var s=Qr(r.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){r.blockedOn=s,Tr(r.priority,function(){lb(o)});return}}else if(s===31){if(s=h(o),s!==null){r.blockedOn=s,Tr(r.priority,function(){lb(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Qd(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var o=mp(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);Hl=u,o.target.dispatchEvent(u),Hl=null}else return s=ar(o),s!==null&&ob(s),r.blockedOn=o,!1;s.shift()}return!0}function hb(r,s,o){Qd(r)&&o.delete(s)}function aC(){gp=!1,Ts!==null&&Qd(Ts)&&(Ts=null),As!==null&&Qd(As)&&(As=null),Cs!==null&&Qd(Cs)&&(Cs=null),Dc.forEach(hb),Ic.forEach(hb)}function $d(r,s){r.blockedOn===s&&(r.blockedOn=null,gp||(gp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,aC)))}var Kd=null;function fb(r){Kd!==r&&(Kd=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Kd===r&&(Kd=null);for(var s=0;s<r.length;s+=3){var o=r[s],u=r[s+1],p=r[s+2];if(typeof u!="function"){if(pp(u||o)===null)continue;break}var y=ar(o);y!==null&&(r.splice(s,3),s-=3,mm(y,{pending:!0,data:p,method:o.method,action:u},u,p))}}))}function Uo(r){function s(G){return $d(G,r)}Ts!==null&&$d(Ts,r),As!==null&&$d(As,r),Cs!==null&&$d(Cs,r),Dc.forEach(s),Ic.forEach(s);for(var o=0;o<Rs.length;o++){var u=Rs[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<Rs.length&&(o=Rs[0],o.blockedOn===null);)db(o),o.blockedOn===null&&Rs.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var p=o[u],y=o[u+1],E=p[an]||null;if(typeof y=="function")E||fb(o);else if(E){var O=null;if(y&&y.hasAttribute("formAction")){if(p=y,E=y[an]||null)O=E.formAction;else if(pp(p)!==null)continue}else O=E.action;typeof O=="function"?o[u+1]=O:(o.splice(u,3),u-=3),fb(o)}}}function mb(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(E){return p=E})},focusReset:"manual",scroll:"manual"})}function s(){p!==null&&(p(),p=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,p=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),p!==null&&(p(),p=null)}}}function yp(r){this._internalRoot=r}Wd.prototype.render=yp.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,u=Zn();sb(o,u,r,s,null,null)},Wd.prototype.unmount=yp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;sb(r.current,2,null,r,null,null),Dd(),s[Hr]=null}};function Wd(r){this._internalRoot=r}Wd.prototype.unstable_scheduleHydration=function(r){if(r){var s=Du();r={blockedOn:null,target:r,priority:s};for(var o=0;o<Rs.length&&s!==0&&s<Rs[o].priority;o++);Rs.splice(o,0,r),o===0&&db(r)}};var pb=e.version;if(pb!=="19.2.3")throw Error(i(527,pb,"19.2.3"));Q.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=g(s),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var oC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yd.isDisabled&&Yd.supportsFiber)try{Sr=Yd.inject(oC),hn=Yd}catch{}}return Mc.createRoot=function(r,s){if(!a(r))throw Error(i(299));var o=!1,u="",p=E0,y=S0,E=w0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(E=s.onRecoverableError)),s=rb(r,1,!1,null,null,o,u,null,p,y,E,mb),r[Hr]=s.current,Jm(r),new yp(s)},Mc.hydrateRoot=function(r,s,o){if(!a(r))throw Error(i(299));var u=!1,p="",y=E0,E=S0,O=w0,G=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(O=o.onRecoverableError),o.formState!==void 0&&(G=o.formState)),s=rb(r,1,!0,s,o??null,u,p,G,y,E,O,mb),s.context=ib(null),o=s.current,u=Zn(),u=aa(u),p=fs(u),p.callback=null,ms(o,p,u),o=u,s.current.lanes=o,ia(s,o),ai(s),r[Hr]=s.current,Jm(r),new Wd(s)},Mc.version="19.2.3",Mc}var Tb;function yC(){if(Tb)return bp.exports;Tb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),bp.exports=gC(),bp.exports}var _C=yC();var Ab="popstate";function vC(t={}){function e(i,a){let{pathname:l,search:c,hash:h}=i.location;return Hp("",{pathname:l,search:c,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:$c(a)}return xC(e,n,null,t)}function St(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function tr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bC(){return Math.random().toString(36).substring(2,10)}function Cb(t,e){return{usr:t.state,key:t.key,idx:e}}function Hp(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?pl(e):e,state:n,key:e&&e.key||i||bC()}}function $c({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function pl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function xC(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,h="POP",m=null,g=_();g==null&&(g=0,c.replaceState({...c.state,idx:g},""));function _(){return(c.state||{idx:null}).idx}function v(){h="POP";let j=_(),B=j==null?null:j-g;g=j,m&&m({action:h,location:T.location,delta:B})}function b(j,B){h="PUSH";let H=Hp(T.location,j,B);g=_()+1;let z=Cb(H,g),J=T.createHref(H);try{c.pushState(z,"",J)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;a.location.assign(J)}l&&m&&m({action:h,location:T.location,delta:1})}function w(j,B){h="REPLACE";let H=Hp(T.location,j,B);g=_();let z=Cb(H,g),J=T.createHref(H);c.replaceState(z,"",J),l&&m&&m({action:h,location:T.location,delta:0})}function C(j){return EC(j)}let T={get action(){return h},get location(){return t(a,c)},listen(j){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Ab,v),m=j,()=>{a.removeEventListener(Ab,v),m=null}},createHref(j){return e(a,j)},createURL:C,encodeLocation(j){let B=C(j);return{pathname:B.pathname,search:B.search,hash:B.hash}},push:b,replace:w,go(j){return c.go(j)}};return T}function EC(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),St(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:$c(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function QE(t,e,n="/"){return SC(t,e,n,!1)}function SC(t,e,n,i){let a=typeof e=="string"?pl(e):e,l=Fi(a.pathname||"/",n);if(l==null)return null;let c=$E(t);wC(c);let h=null;for(let m=0;h==null&&m<c.length;++m){let g=NC(l);h=MC(c[m],g,i)}return h}function $E(t,e=[],n=[],i="",a=!1){let l=(c,h,m=a,g)=>{let _={relativePath:g===void 0?c.path||"":g,caseSensitive:c.caseSensitive===!0,childrenIndex:h,route:c};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&m)return;St(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let v=Ui([i,_.relativePath]),b=n.concat(_);c.children&&c.children.length>0&&(St(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),$E(c.children,e,b,v,m)),!(c.path==null&&!c.index)&&e.push({path:v,score:jC(v,c.index),routesMeta:b})};return t.forEach((c,h)=>{if(c.path===""||!c.path?.includes("?"))l(c,h);else for(let m of KE(c.path))l(c,h,!0,m)}),e}function KE(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=KE(i.join("/")),h=[];return h.push(...c.map(m=>m===""?l:[l,m].join("/"))),a&&h.push(...c),h.map(m=>t.startsWith("/")&&m===""?"/":m)}function wC(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:OC(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var TC=/^:[\w-]+$/,AC=3,CC=2,RC=1,DC=10,IC=-2,Rb=t=>t==="*";function jC(t,e){let n=t.split("/"),i=n.length;return n.some(Rb)&&(i+=IC),e&&(i+=CC),n.filter(a=>!Rb(a)).reduce((a,l)=>a+(TC.test(l)?AC:l===""?RC:DC),i)}function OC(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function MC(t,e,n=!1){let{routesMeta:i}=t,a={},l="/",c=[];for(let h=0;h<i.length;++h){let m=i[h],g=h===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",v=_h({path:m.relativePath,caseSensitive:m.caseSensitive,end:g},_),b=m.route;if(!v&&g&&n&&!i[i.length-1].route.index&&(v=_h({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},_)),!v)return null;Object.assign(a,v.params),c.push({params:a,pathname:Ui([l,v.pathname]),pathnameBase:zC(Ui([l,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(l=Ui([l,v.pathnameBase]))}return c}function _h(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=kC(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:i.reduce((g,{paramName:_,isOptional:v},b)=>{if(_==="*"){let C=h[b]||"";c=l.slice(0,l.length-C.length).replace(/(.)\/+$/,"$1")}const w=h[b];return v&&!w?g[_]=void 0:g[_]=(w||"").replace(/%2F/g,"/"),g},{}),pathname:l,pathnameBase:c,pattern:t}}function kC(t,e=!1,n=!0){tr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,h,m)=>(i.push({paramName:h,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function NC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return tr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Fi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var WE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,PC=t=>WE.test(t);function LC(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?pl(t):t,l;if(n)if(PC(n))l=n;else{if(n.includes("//")){let c=n;n=n.replace(/\/\/+/g,"/"),tr(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${n}`)}n.startsWith("/")?l=Db(n.substring(1),"/"):l=Db(n,e)}else l=e;return{pathname:l,search:UC(i),hash:BC(a)}}function Db(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function wp(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function VC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Mg(t){let e=VC(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function kg(t,e,n,i=!1){let a;typeof t=="string"?a=pl(t):(a={...t},St(!a.pathname||!a.pathname.includes("?"),wp("?","pathname","search",a)),St(!a.pathname||!a.pathname.includes("#"),wp("#","pathname","hash",a)),St(!a.search||!a.search.includes("#"),wp("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,h;if(c==null)h=n;else{let v=e.length-1;if(!i&&c.startsWith("..")){let b=c.split("/");for(;b[0]==="..";)b.shift(),v-=1;a.pathname=b.join("/")}h=v>=0?e[v]:"/"}let m=LC(a,h),g=c&&c!=="/"&&c.endsWith("/"),_=(l||c===".")&&n.endsWith("/");return!m.pathname.endsWith("/")&&(g||_)&&(m.pathname+="/"),m}var Ui=t=>t.join("/").replace(/\/\/+/g,"/"),zC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),UC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,BC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,FC=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function qC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function HC(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var YE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function XE(t,e){let n=t;if(typeof n!="string"||!WE.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if(YE)try{let l=new URL(window.location.href),c=n.startsWith("//")?new URL(l.protocol+n):new URL(n),h=Fi(c.pathname,e);c.origin===l.origin&&h!=null?n=h+c.search+c.hash:a=!0}catch{tr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var JE=["POST","PUT","PATCH","DELETE"];new Set(JE);var GC=["GET",...JE];new Set(GC);var gl=A.createContext(null);gl.displayName="DataRouter";var qh=A.createContext(null);qh.displayName="DataRouterState";var QC=A.createContext(!1),ZE=A.createContext({isTransitioning:!1});ZE.displayName="ViewTransition";var $C=A.createContext(new Map);$C.displayName="Fetchers";var KC=A.createContext(null);KC.displayName="Await";var nr=A.createContext(null);nr.displayName="Navigation";var su=A.createContext(null);su.displayName="Location";var xr=A.createContext({outlet:null,matches:[],isDataRoute:!1});xr.displayName="Route";var Ng=A.createContext(null);Ng.displayName="RouteError";var eS="REACT_ROUTER_ERROR",WC="REDIRECT",YC="ROUTE_ERROR_RESPONSE";function XC(t){if(t.startsWith(`${eS}:${WC}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function JC(t){if(t.startsWith(`${eS}:${YC}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new FC(e.status,e.statusText,e.data)}catch{}}function ZC(t,{relative:e}={}){St(yl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=A.useContext(nr),{hash:a,pathname:l,search:c}=au(t,{relative:e}),h=l;return n!=="/"&&(h=l==="/"?n:Ui([n,l])),i.createHref({pathname:h,search:c,hash:a})}function yl(){return A.useContext(su)!=null}function An(){return St(yl(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(su).location}var tS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function nS(t){A.useContext(nr).static||A.useLayoutEffect(t)}function _l(){let{isDataRoute:t}=A.useContext(xr);return t?pR():eR()}function eR(){St(yl(),"useNavigate() may be used only in the context of a <Router> component.");let t=A.useContext(gl),{basename:e,navigator:n}=A.useContext(nr),{matches:i}=A.useContext(xr),{pathname:a}=An(),l=JSON.stringify(Mg(i)),c=A.useRef(!1);return nS(()=>{c.current=!0}),A.useCallback((m,g={})=>{if(tr(c.current,tS),!c.current)return;if(typeof m=="number"){n.go(m);return}let _=kg(m,JSON.parse(l),a,g.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:Ui([e,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[e,n,l,a,t])}var tR=A.createContext(null);function nR(t){let e=A.useContext(xr).outlet;return A.useMemo(()=>e&&A.createElement(tR.Provider,{value:t},e),[e,t])}function rR(){let{matches:t}=A.useContext(xr),e=t[t.length-1];return e?e.params:{}}function au(t,{relative:e}={}){let{matches:n}=A.useContext(xr),{pathname:i}=An(),a=JSON.stringify(Mg(n));return A.useMemo(()=>kg(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function iR(t,e){return rS(t,e)}function rS(t,e,n,i,a){St(yl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=A.useContext(nr),{matches:c}=A.useContext(xr),h=c[c.length-1],m=h?h.params:{},g=h?h.pathname:"/",_=h?h.pathnameBase:"/",v=h&&h.route;{let H=v&&v.path||"";sS(g,!v||H.endsWith("*")||H.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${H}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${H}"> to <Route path="${H==="/"?"*":`${H}/*`}">.`)}let b=An(),w;if(e){let H=typeof e=="string"?pl(e):e;St(_==="/"||H.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${H.pathname}" was given in the \`location\` prop.`),w=H}else w=b;let C=w.pathname||"/",T=C;if(_!=="/"){let H=_.replace(/^\//,"").split("/");T="/"+C.replace(/^\//,"").split("/").slice(H.length).join("/")}let j=QE(t,{pathname:T});tr(v||j!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),tr(j==null||j[j.length-1].route.element!==void 0||j[j.length-1].route.Component!==void 0||j[j.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let B=cR(j&&j.map(H=>Object.assign({},H,{params:Object.assign({},m,H.params),pathname:Ui([_,l.encodeLocation?l.encodeLocation(H.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathname]),pathnameBase:H.pathnameBase==="/"?_:Ui([_,l.encodeLocation?l.encodeLocation(H.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathnameBase])})),c,n,i,a);return e&&B?A.createElement(su.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},B):B}function sR(){let t=mR(),e=qC(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:l},"ErrorBoundary")," or"," ",A.createElement("code",{style:l},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:a},n):null,c)}var aR=A.createElement(sR,null),iS=class extends A.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=JC(t.digest);n&&(t=n)}let e=t!==void 0?A.createElement(xr.Provider,{value:this.props.routeContext},A.createElement(Ng.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?A.createElement(oR,{error:t},e):e}};iS.contextType=QC;var Tp=new WeakMap;function oR({children:t,error:e}){let{basename:n}=A.useContext(nr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=XC(e.digest);if(i){let a=Tp.get(e);if(a)throw a;let l=XE(i.location,n);if(YE&&!Tp.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw Tp.set(e,c),c}return A.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function lR({routeContext:t,match:e,children:n}){let i=A.useContext(gl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),A.createElement(xr.Provider,{value:t},n)}function cR(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=n?.errors;if(c!=null){let _=l.findIndex(v=>v.route.id&&c?.[v.route.id]!==void 0);St(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let h=!1,m=-1;if(n)for(let _=0;_<l.length;_++){let v=l[_];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(m=_),v.route.id){let{loaderData:b,errors:w}=n,C=v.route.loader&&!b.hasOwnProperty(v.route.id)&&(!w||w[v.route.id]===void 0);if(v.route.lazy||C){h=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}let g=n&&i?(_,v)=>{i(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:HC(n.matches),errorInfo:v})}:void 0;return l.reduceRight((_,v,b)=>{let w,C=!1,T=null,j=null;n&&(w=c&&v.route.id?c[v.route.id]:void 0,T=v.route.errorElement||aR,h&&(m<0&&b===0?(sS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),C=!0,j=null):m===b&&(C=!0,j=v.route.hydrateFallbackElement||null)));let B=e.concat(l.slice(0,b+1)),H=()=>{let z;return w?z=T:C?z=j:v.route.Component?z=A.createElement(v.route.Component,null):v.route.element?z=v.route.element:z=_,A.createElement(lR,{match:v,routeContext:{outlet:_,matches:B,isDataRoute:n!=null},children:z})};return n&&(v.route.ErrorBoundary||v.route.errorElement||b===0)?A.createElement(iS,{location:n.location,revalidation:n.revalidation,component:T,error:w,children:H(),routeContext:{outlet:null,matches:B,isDataRoute:!0},onError:g}):H()},null)}function Pg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function uR(t){let e=A.useContext(gl);return St(e,Pg(t)),e}function dR(t){let e=A.useContext(qh);return St(e,Pg(t)),e}function hR(t){let e=A.useContext(xr);return St(e,Pg(t)),e}function Lg(t){let e=hR(t),n=e.matches[e.matches.length-1];return St(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function fR(){return Lg("useRouteId")}function mR(){let t=A.useContext(Ng),e=dR("useRouteError"),n=Lg("useRouteError");return t!==void 0?t:e.errors?.[n]}function pR(){let{router:t}=uR("useNavigate"),e=Lg("useNavigate"),n=A.useRef(!1);return nS(()=>{n.current=!0}),A.useCallback(async(a,l={})=>{tr(n.current,tS),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var Ib={};function sS(t,e,n){!e&&!Ib[t]&&(Ib[t]=!0,tr(!1,n))}A.memo(gR);function gR({routes:t,future:e,state:n,onError:i}){return rS(t,void 0,n,i,e)}function Hh({to:t,replace:e,state:n,relative:i}){St(yl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=A.useContext(nr);tr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=A.useContext(xr),{pathname:c}=An(),h=_l(),m=kg(t,Mg(l),c,i==="path"),g=JSON.stringify(m);return A.useEffect(()=>{h(JSON.parse(g),{replace:e,state:n,relative:i})},[h,g,i,e,n]),null}function Gh(t){return nR(t.context)}function $t(t){St(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function yR({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){St(!yl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=t.replace(/^\/*/,"/"),m=A.useMemo(()=>({basename:h,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[h,a,l,c]);typeof n=="string"&&(n=pl(n));let{pathname:g="/",search:_="",hash:v="",state:b=null,key:w="default"}=n,C=A.useMemo(()=>{let T=Fi(g,h);return T==null?null:{location:{pathname:T,search:_,hash:v,state:b,key:w},navigationType:i}},[h,g,_,v,b,w,i]);return tr(C!=null,`<Router basename="${h}"> is not able to match the URL "${g}${_}${v}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:A.createElement(nr.Provider,{value:m},A.createElement(su.Provider,{children:e,value:C}))}function _R({children:t,location:e}){return iR(Gp(t),e)}function Gp(t,e=[]){let n=[];return A.Children.forEach(t,(i,a)=>{if(!A.isValidElement(i))return;let l=[...e,a];if(i.type===A.Fragment){n.push.apply(n,Gp(i.props.children,l));return}St(i.type===$t,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),St(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Gp(i.props.children,l)),n.push(c)}),n}var sh="get",ah="application/x-www-form-urlencoded";function Qh(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function vR(t){return Qh(t)&&t.tagName.toLowerCase()==="button"}function bR(t){return Qh(t)&&t.tagName.toLowerCase()==="form"}function xR(t){return Qh(t)&&t.tagName.toLowerCase()==="input"}function ER(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function SR(t,e){return t.button===0&&(!e||e==="_self")&&!ER(t)}function Qp(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(a=>[n,a]):[[n,i]])},[]))}function wR(t,e){let n=Qp(t);return e&&e.forEach((i,a)=>{n.has(a)||e.getAll(a).forEach(l=>{n.append(a,l)})}),n}var Xd=null;function TR(){if(Xd===null)try{new FormData(document.createElement("form"),0),Xd=!1}catch{Xd=!0}return Xd}var AR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ap(t){return t!=null&&!AR.has(t)?(tr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ah}"`),null):t}function CR(t,e){let n,i,a,l,c;if(bR(t)){let h=t.getAttribute("action");i=h?Fi(h,e):null,n=t.getAttribute("method")||sh,a=Ap(t.getAttribute("enctype"))||ah,l=new FormData(t)}else if(vR(t)||xR(t)&&(t.type==="submit"||t.type==="image")){let h=t.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=t.getAttribute("formaction")||h.getAttribute("action");if(i=m?Fi(m,e):null,n=t.getAttribute("formmethod")||h.getAttribute("method")||sh,a=Ap(t.getAttribute("formenctype"))||Ap(h.getAttribute("enctype"))||ah,l=new FormData(h,t),!TR()){let{name:g,type:_,value:v}=t;if(_==="image"){let b=g?`${g}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else g&&l.append(g,v)}}else{if(Qh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=sh,i=null,a=ah,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Vg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function RR(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Fi(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function DR(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function IR(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function jR(t,e,n){let i=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let c=await DR(l,n);return c.links?c.links():[]}return[]}));return NR(i.flat(1).filter(IR).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function jb(t,e,n,i,a,l){let c=(m,g)=>n[g]?m.route.id!==n[g].route.id:!0,h=(m,g)=>n[g].pathname!==m.pathname||n[g].route.path?.endsWith("*")&&n[g].params["*"]!==m.params["*"];return l==="assets"?e.filter((m,g)=>c(m,g)||h(m,g)):l==="data"?e.filter((m,g)=>{let _=i.routes[m.route.id];if(!_||!_.hasLoader)return!1;if(c(m,g)||h(m,g))return!0;if(m.route.shouldRevalidate){let v=m.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function OR(t,e,{includeHydrateFallback:n}={}){return MR(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function MR(t){return[...new Set(t)]}function kR(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function NR(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let l=JSON.stringify(kR(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function aS(){let t=A.useContext(gl);return Vg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function PR(){let t=A.useContext(qh);return Vg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var zg=A.createContext(void 0);zg.displayName="FrameworkContext";function oS(){let t=A.useContext(zg);return Vg(t,"You must render this element inside a <HydratedRouter> element"),t}function LR(t,e){let n=A.useContext(zg),[i,a]=A.useState(!1),[l,c]=A.useState(!1),{onFocus:h,onBlur:m,onMouseEnter:g,onMouseLeave:_,onTouchStart:v}=e,b=A.useRef(null);A.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let T=B=>{B.forEach(H=>{c(H.isIntersecting)})},j=new IntersectionObserver(T,{threshold:.5});return b.current&&j.observe(b.current),()=>{j.disconnect()}}},[t]),A.useEffect(()=>{if(i){let T=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(T)}}},[i]);let w=()=>{a(!0)},C=()=>{a(!1),c(!1)};return n?t!=="intent"?[l,b,{}]:[l,b,{onFocus:kc(h,w),onBlur:kc(m,C),onMouseEnter:kc(g,w),onMouseLeave:kc(_,C),onTouchStart:kc(v,w)}]:[!1,b,{}]}function kc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function VR({page:t,...e}){let{router:n}=aS(),i=A.useMemo(()=>QE(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?A.createElement(UR,{page:t,matches:i,...e}):null}function zR(t){let{manifest:e,routeModules:n}=oS(),[i,a]=A.useState([]);return A.useEffect(()=>{let l=!1;return jR(t,e,n).then(c=>{l||a(c)}),()=>{l=!0}},[t,e,n]),i}function UR({page:t,matches:e,...n}){let i=An(),{manifest:a,routeModules:l}=oS(),{basename:c}=aS(),{loaderData:h,matches:m}=PR(),g=A.useMemo(()=>jb(t,e,m,a,i,"data"),[t,e,m,a,i]),_=A.useMemo(()=>jb(t,e,m,a,i,"assets"),[t,e,m,a,i]),v=A.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let C=new Set,T=!1;if(e.forEach(B=>{let H=a.routes[B.route.id];!H||!H.hasLoader||(!g.some(z=>z.route.id===B.route.id)&&B.route.id in h&&l[B.route.id]?.shouldRevalidate||H.hasClientLoader?T=!0:C.add(B.route.id))}),C.size===0)return[];let j=RR(t,c,"data");return T&&C.size>0&&j.searchParams.set("_routes",e.filter(B=>C.has(B.route.id)).map(B=>B.route.id).join(",")),[j.pathname+j.search]},[c,h,i,a,g,e,t,l]),b=A.useMemo(()=>OR(_,a),[_,a]),w=zR(_);return A.createElement(A.Fragment,null,v.map(C=>A.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...n})),b.map(C=>A.createElement("link",{key:C,rel:"modulepreload",href:C,...n})),w.map(({key:C,link:T})=>A.createElement("link",{key:C,nonce:n.nonce,...T})))}function BR(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var FR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{FR&&(window.__reactRouterVersion="7.11.0")}catch{}function qR({basename:t,children:e,unstable_useTransitions:n,window:i}){let a=A.useRef();a.current==null&&(a.current=vC({window:i,v5Compat:!0}));let l=a.current,[c,h]=A.useState({action:l.action,location:l.location}),m=A.useCallback(g=>{n===!1?h(g):A.startTransition(()=>h(g))},[n]);return A.useLayoutEffect(()=>l.listen(m),[l,m]),A.createElement(yR,{basename:t,children:e,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:n})}var lS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wt=A.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,state:h,target:m,to:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...w},C){let{basename:T,unstable_useTransitions:j}=A.useContext(nr),B=typeof g=="string"&&lS.test(g),H=XE(g,T);g=H.to;let z=ZC(g,{relative:a}),[J,$,re]=LR(i,w),P=$R(g,{replace:c,state:h,target:m,preventScrollReset:_,relative:a,viewTransition:v,unstable_defaultShouldRevalidate:b,unstable_useTransitions:j});function R(N){e&&e(N),N.defaultPrevented||P(N)}let D=A.createElement("a",{...w,...re,href:H.absoluteURL||z,onClick:H.isExternal||l?e:R,ref:BR(C,$),target:m,"data-discover":!B&&n==="render"?"true":void 0});return J&&!B?A.createElement(A.Fragment,null,D,A.createElement(VR,{page:z})):D});wt.displayName="Link";var HR=A.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:h,children:m,...g},_){let v=au(c,{relative:g.relative}),b=An(),w=A.useContext(qh),{navigator:C,basename:T}=A.useContext(nr),j=w!=null&&ZR(v)&&h===!0,B=C.encodeLocation?C.encodeLocation(v).pathname:v.pathname,H=b.pathname,z=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||(H=H.toLowerCase(),z=z?z.toLowerCase():null,B=B.toLowerCase()),z&&T&&(z=Fi(z,T)||z);const J=B!=="/"&&B.endsWith("/")?B.length-1:B.length;let $=H===B||!a&&H.startsWith(B)&&H.charAt(J)==="/",re=z!=null&&(z===B||!a&&z.startsWith(B)&&z.charAt(B.length)==="/"),P={isActive:$,isPending:re,isTransitioning:j},R=$?e:void 0,D;typeof i=="function"?D=i(P):D=[i,$?"active":null,re?"pending":null,j?"transitioning":null].filter(Boolean).join(" ");let N=typeof l=="function"?l(P):l;return A.createElement(wt,{...g,"aria-current":R,className:D,ref:_,style:N,to:c,viewTransition:h},typeof m=="function"?m(P):m)});HR.displayName="NavLink";var GR=A.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:l,method:c=sh,action:h,onSubmit:m,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...w},C)=>{let{unstable_useTransitions:T}=A.useContext(nr),j=XR(),B=JR(h,{relative:g}),H=c.toLowerCase()==="get"?"get":"post",z=typeof h=="string"&&lS.test(h),J=$=>{if(m&&m($),$.defaultPrevented)return;$.preventDefault();let re=$.nativeEvent.submitter,P=re?.getAttribute("formmethod")||c,R=()=>j(re||$.currentTarget,{fetcherKey:e,method:P,navigate:n,replace:a,state:l,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b});T&&n!==!1?A.startTransition(()=>R()):R()};return A.createElement("form",{ref:C,method:H,action:B,onSubmit:i?m:J,...w,"data-discover":!z&&t==="render"?"true":void 0})});GR.displayName="Form";function QR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cS(t){let e=A.useContext(gl);return St(e,QR(t)),e}function $R(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:h,unstable_useTransitions:m}={}){let g=_l(),_=An(),v=au(t,{relative:l});return A.useCallback(b=>{if(SR(b,e)){b.preventDefault();let w=n!==void 0?n:$c(_)===$c(v),C=()=>g(t,{replace:w,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:h});m?A.startTransition(()=>C()):C()}},[_,g,v,n,i,e,t,a,l,c,h,m])}function KR(t){tr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=A.useRef(Qp(t)),n=A.useRef(!1),i=An(),a=A.useMemo(()=>wR(i.search,n.current?null:e.current),[i.search]),l=_l(),c=A.useCallback((h,m)=>{const g=Qp(typeof h=="function"?h(new URLSearchParams(a)):h);n.current=!0,l("?"+g,m)},[l,a]);return[a,c]}var WR=0,YR=()=>`__${String(++WR)}__`;function XR(){let{router:t}=cS("useSubmit"),{basename:e}=A.useContext(nr),n=fR(),i=t.fetch,a=t.navigate;return A.useCallback(async(l,c={})=>{let{action:h,method:m,encType:g,formData:_,body:v}=CR(l,e);if(c.navigate===!1){let b=c.fetcherKey||YR();await i(b,n,c.action||h,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||m,formEncType:c.encType||g,flushSync:c.flushSync})}else await a(c.action||h,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||m,formEncType:c.encType||g,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,e,n])}function JR(t,{relative:e}={}){let{basename:n}=A.useContext(nr),i=A.useContext(xr);St(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...au(t||".",{relative:e})},c=An();if(t==null){l.search=c.search;let h=new URLSearchParams(l.search),m=h.getAll("index");if(m.some(_=>_==="")){h.delete("index"),m.filter(v=>v).forEach(v=>h.append("index",v));let _=h.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Ui([n,l.pathname])),$c(l)}function ZR(t,{relative:e}={}){let n=A.useContext(ZE);St(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=cS("useViewTransitionState"),a=au(t,{relative:e});if(!n.isTransitioning)return!1;let l=Fi(n.currentLocation.pathname,i)||n.currentLocation.pathname,c=Fi(n.nextLocation.pathname,i)||n.nextLocation.pathname;return _h(a.pathname,c)!=null||_h(a.pathname,l)!=null}const eD={isLoading:!1,loadingMessage:"Loading...",addLoadingHold:()=>{},removeLoadingHold:()=>{}},uS=A.createContext(eD);function tD({children:t}){const[e,n]=A.useState(new Map),i=A.useCallback((m,g)=>{n(_=>new Map(_).set(m,g))},[]),a=A.useCallback(m=>{n(g=>{const _=new Map(g);return _.delete(m),_})},[]),l=e.size>0,c=e.size>0&&Array.from(e.values()).pop()||"Loading...",h={isLoading:l,loadingMessage:c,addLoadingHold:i,removeLoadingHold:a};return d.jsx(uS.Provider,{value:h,children:t})}function jn(){const t=A.useContext(uS);if(!t)throw new Error("useApp must be used within an AppProvider");return t}const nD=function(){},rD={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:nD},ou=A.createContext(rD);var vl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},iD={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},sD=class{#e=iD;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Li=new sD;function aD(t){setTimeout(t,0)}var La=typeof window>"u"||"Deno"in globalThis;function tn(){}function oD(t,e){return typeof t=="function"?t(e):t}function $p(t){return typeof t=="number"&&t>=0&&t!==1/0}function dS(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Vs(t,e){return typeof t=="function"?t(e):t}function _r(t,e){return typeof t=="function"?t(e):t}function Ob(t,e){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:c,stale:h}=t;if(c){if(i){if(e.queryHash!==Ug(c,e.options))return!1}else if(!Kc(e.queryKey,c))return!1}if(n!=="all"){const m=e.isActive();if(n==="active"&&!m||n==="inactive"&&m)return!1}return!(typeof h=="boolean"&&e.isStale()!==h||a&&a!==e.state.fetchStatus||l&&!l(e))}function Mb(t,e){const{exact:n,status:i,predicate:a,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(Va(e.options.mutationKey)!==Va(l))return!1}else if(!Kc(e.options.mutationKey,l))return!1}return!(i&&e.state.status!==i||a&&!a(e))}function Ug(t,e){return(e?.queryKeyHashFn||Va)(t)}function Va(t){return JSON.stringify(t,(e,n)=>Kp(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function Kc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Kc(t[n],e[n])):!1}var lD=Object.prototype.hasOwnProperty;function hS(t,e){if(t===e)return t;const n=kb(t)&&kb(e);if(!n&&!(Kp(t)&&Kp(e)))return e;const a=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),c=l.length,h=n?new Array(c):{};let m=0;for(let g=0;g<c;g++){const _=n?g:l[g],v=t[_],b=e[_];if(v===b){h[_]=v,(n?g<a:lD.call(t,_))&&m++;continue}if(v===null||b===null||typeof v!="object"||typeof b!="object"){h[_]=b;continue}const w=hS(v,b);h[_]=w,w===v&&m++}return a===c&&m===a?t:h}function vh(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function kb(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Kp(t){if(!Nb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Nb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Nb(t){return Object.prototype.toString.call(t)==="[object Object]"}function cD(t){return new Promise(e=>{Li.setTimeout(e,t)})}function Wp(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?hS(t,e):e}function uD(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function dD(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var Bg=Symbol();function fS(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Bg?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function mS(t,e){return typeof t=="function"?t(...e):!!t}var hD=class extends vl{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!La&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Fg=new hD;function Yp(){let t,e;const n=new Promise((a,l)=>{t=a,e=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),e(a)},n}function fD(t){let e;if(t.then(n=>(e=n,n),tn)?.catch(tn),e!==void 0)return{data:e}}function pS(t){return t}function mD(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function pD(t,e,n){const i=()=>{const a=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return a?.catch(tn),a};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:i()},...t.meta&&{meta:t.meta}}}function gD(t){return t.state.isPaused}function yD(t){return t.state.status==="success"}function _D(t){return!0}function vD(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??gD,i=t.getMutationCache().getAll().flatMap(m=>n(m)?[mD(m)]:[]),a=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??yD,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??_D,c=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??pS,h=t.getQueryCache().getAll().flatMap(m=>a(m)?[pD(m,c,l)]:[]);return{mutations:i,queries:h}}function bD(t,e,n){if(typeof e!="object"||e===null)return;const i=t.getMutationCache(),a=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??pS,c=e.mutations||[],h=e.queries||[];c.forEach(({state:m,...g})=>{i.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...g},m)}),h.forEach(({queryKey:m,state:g,queryHash:_,meta:v,promise:b,dehydratedAt:w})=>{const C=b?fD(b):void 0,T=g.data===void 0?C?.data:g.data,j=T===void 0?T:l(T);let B=a.get(_);const H=B?.state.status==="pending",z=B?.state.fetchStatus==="fetching";if(B){const J=C&&w!==void 0&&w>B.state.dataUpdatedAt;if(g.dataUpdatedAt>B.state.dataUpdatedAt||J){const{fetchStatus:$,...re}=g;B.setState({...re,data:j})}}else B=a.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:m,queryHash:_,meta:v},{...g,data:j,fetchStatus:"idle",status:j!==void 0?"success":g.status});b&&!H&&!z&&(w===void 0||w>B.state.dataUpdatedAt)&&B.fetch(void 0,{initialPromise:Promise.resolve(b).then(l)}).catch(tn)})}var xD=aD;function ED(){let t=[],e=0,n=h=>{h()},i=h=>{h()},a=xD;const l=h=>{e?t.push(h):a(()=>{n(h)})},c=()=>{const h=t;t=[],h.length&&a(()=>{i(()=>{h.forEach(m=>{n(m)})})})};return{batch:h=>{let m;e++;try{m=h()}finally{e--,e||c()}return m},batchCalls:h=>(...m)=>{l(()=>{h(...m)})},schedule:l,setNotifyFunction:h=>{n=h},setBatchNotifyFunction:h=>{i=h},setScheduler:h=>{a=h}}}var nn=ED(),SD=class extends vl{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!La&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},bh=new SD;function wD(t){return Math.min(1e3*2**t,3e4)}function gS(t){return(t??"online")==="online"?bh.isOnline():!0}var Xp=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function yS(t){let e=!1,n=0,i;const a=Yp(),l=()=>a.status!=="pending",c=T=>{if(!l()){const j=new Xp(T);b(j),t.onCancel?.(j)}},h=()=>{e=!0},m=()=>{e=!1},g=()=>Fg.isFocused()&&(t.networkMode==="always"||bh.isOnline())&&t.canRun(),_=()=>gS(t.networkMode)&&t.canRun(),v=T=>{l()||(i?.(),a.resolve(T))},b=T=>{l()||(i?.(),a.reject(T))},w=()=>new Promise(T=>{i=j=>{(l()||g())&&T(j)},t.onPause?.()}).then(()=>{i=void 0,l()||t.onContinue?.()}),C=()=>{if(l())return;let T;const j=n===0?t.initialPromise:void 0;try{T=j??t.fn()}catch(B){T=Promise.reject(B)}Promise.resolve(T).then(v).catch(B=>{if(l())return;const H=t.retry??(La?0:3),z=t.retryDelay??wD,J=typeof z=="function"?z(n,B):z,$=H===!0||typeof H=="number"&&n<H||typeof H=="function"&&H(n,B);if(e||!$){b(B);return}n++,t.onFail?.(n,B),cD(J).then(()=>g()?void 0:w()).then(()=>{e?b(B):C()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(i?.(),a),cancelRetry:h,continueRetry:m,canStart:_,start:()=>(_()?C():w().then(C),a)}}var _S=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),$p(this.gcTime)&&(this.#e=Li.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(La?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Li.clearTimeout(this.#e),this.#e=void 0)}},TD=class extends _S{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=Lb(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Lb(this.options);n.data!==void 0&&(this.setState(Pb(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const i=Wp(this.state.data,e,this.options);return this.#s({data:i,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),i}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then(tn).catch(tn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>_r(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Bg||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Vs(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!dS(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const m=this.observers.find(g=>g.options.queryFn);m&&this.setOptions(m.options)}const i=new AbortController,a=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(this.#o=!0,i.signal)})},l=()=>{const m=fS(this.options,n),_=(()=>{const v={client:this.#i,queryKey:this.queryKey,meta:this.meta};return a(v),v})();return this.#o=!1,this.options.persister?this.options.persister(m,_,this):m(_)},h=(()=>{const m={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return a(m),m})();this.options.behavior?.onFetch(h,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==h.fetchOptions?.meta)&&this.#s({type:"fetch",meta:h.fetchOptions?.meta}),this.#r=yS({initialPromise:n?.initialPromise,fn:h.fetchFn,onCancel:m=>{m instanceof Xp&&m.revert&&this.setState({...this.#t,fetchStatus:"idle"}),i.abort()},onFail:(m,g)=>{this.#s({type:"failed",failureCount:m,error:g})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0});try{const m=await this.#r.start();if(m===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(m),this.#n.config.onSuccess?.(m,this),this.#n.config.onSettled?.(m,this.state.error,this),m}catch(m){if(m instanceof Xp){if(m.silent)return this.#r.promise;if(m.revert){if(this.state.data===void 0)throw m;return this.state.data}}throw this.#s({type:"error",error:m}),this.#n.config.onError?.(m,this),this.#n.config.onSettled?.(this.state.data,m,this),m}finally{this.scheduleGc()}}#s(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...vS(i.data,this.options),fetchMeta:e.meta??null};case"success":const a={...i,...Pb(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const l=e.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),nn.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function vS(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:gS(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Pb(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Lb(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var AD=class extends vl{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=Yp(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Vb(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Jp(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Jp(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#x(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof _r(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#E(),this.#t.setOptions(this.options),e._defaulted&&!vh(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&zb(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),i&&(this.#t!==n||_r(this.options.enabled,this.#t)!==_r(e.enabled,this.#t)||Vs(this.options.staleTime,this.#t)!==Vs(e.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||_r(this.options.enabled,this.#t)!==_r(e.enabled,this.#t)||a!==this.#l)&&this.#_(a)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return RD(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),e?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#E();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(tn)),e}#g(){this.#b();const t=Vs(this.options.staleTime,this.#t);if(La||this.#i.isStale||!$p(t))return;const n=dS(this.#i.dataUpdatedAt,t)+1;this.#c=Li.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#x(),this.#l=t,!(La||_r(this.options.enabled,this.#t)===!1||!$p(this.#l)||this.#l===0)&&(this.#u=Li.setInterval(()=>{(this.options.refetchIntervalInBackground||Fg.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#b(){this.#c&&(Li.clearTimeout(this.#c),this.#c=void 0)}#x(){this.#u&&(Li.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,i=this.options,a=this.#i,l=this.#r,c=this.#a,m=t!==n?t.state:this.#n,{state:g}=t;let _={...g},v=!1,b;if(e._optimisticResults){const R=this.hasListeners(),D=!R&&Vb(t,e),N=R&&zb(t,n,e,i);(D||N)&&(_={..._,...vS(g.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:w,errorUpdatedAt:C,status:T}=_;b=_.data;let j=!1;if(e.placeholderData!==void 0&&b===void 0&&T==="pending"){let R;a?.isPlaceholderData&&e.placeholderData===c?.placeholderData?(R=a.data,j=!0):R=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,R!==void 0&&(T="success",b=Wp(a?.data,R,e),v=!0)}if(e.select&&b!==void 0&&!j)if(a&&b===l?.data&&e.select===this.#p)b=this.#h;else try{this.#p=e.select,b=e.select(b),b=Wp(a?.data,b,e),this.#h=b,this.#s=null}catch(R){this.#s=R}this.#s&&(w=this.#s,b=this.#h,C=Date.now(),T="error");const B=_.fetchStatus==="fetching",H=T==="pending",z=T==="error",J=H&&B,$=b!==void 0,P={status:T,fetchStatus:_.fetchStatus,isPending:H,isSuccess:T==="success",isError:z,isInitialLoading:J,isLoading:J,data:b,dataUpdatedAt:_.dataUpdatedAt,error:w,errorUpdatedAt:C,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>m.dataUpdateCount||_.errorUpdateCount>m.errorUpdateCount,isFetching:B,isRefetching:B&&!H,isLoadingError:z&&!$,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:z&&$,isStale:qg(t,e),refetch:this.refetch,promise:this.#o,isEnabled:_r(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const R=M=>{P.status==="error"?M.reject(P.error):P.data!==void 0&&M.resolve(P.data)},D=()=>{const M=this.#o=P.promise=Yp();R(M)},N=this.#o;switch(N.status){case"pending":t.queryHash===n.queryHash&&R(N);break;case"fulfilled":(P.status==="error"||P.data!==N.value)&&D();break;case"rejected":(P.status!=="error"||P.error!==N.reason)&&D();break}}return P}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),vh(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(c=>{const h=c;return this.#i[h]!==t[h]&&l.has(h)})};this.#S({listeners:n()})}#E(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#S(t){nn.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function CD(t,e){return _r(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Vb(t,e){return CD(t,e)||t.state.data!==void 0&&Jp(t,e,e.refetchOnMount)}function Jp(t,e,n){if(_r(e.enabled,t)!==!1&&Vs(e.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&qg(t,e)}return!1}function zb(t,e,n,i){return(t!==e||_r(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&qg(t,n)}function qg(t,e){return _r(e.enabled,t)!==!1&&t.isStaleByTime(Vs(e.staleTime,t))}function RD(t,e){return!vh(t.getCurrentResult(),e)}function Ub(t){return{onFetch:(e,n)=>{const i=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],c=e.state.data?.pageParams||[];let h={pages:[],pageParams:[]},m=0;const g=async()=>{let _=!1;const v=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},b=fS(e.options,e.fetchOptions),w=async(C,T,j)=>{if(_)return Promise.reject();if(T==null&&C.pages.length)return Promise.resolve(C);const H=(()=>{const re={client:e.client,queryKey:e.queryKey,pageParam:T,direction:j?"backward":"forward",meta:e.options.meta};return v(re),re})(),z=await b(H),{maxPages:J}=e.options,$=j?dD:uD;return{pages:$(C.pages,z,J),pageParams:$(C.pageParams,T,J)}};if(a&&l.length){const C=a==="backward",T=C?DD:Bb,j={pages:l,pageParams:c},B=T(i,j);h=await w(j,B,C)}else{const C=t??l.length;do{const T=m===0?c[0]??i.initialPageParam:Bb(i,h);if(m>0&&T==null)break;h=await w(h,T),m++}while(m<C)}return h};e.options.persister?e.fetchFn=()=>e.options.persister?.(g,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=g}}}function Bb(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function DD(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var ID=class extends _S{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||bS(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=yS({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(c,h)=>{this.#r({type:"failed",failureCount:c,error:h})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",l=!this.#i.canStart();try{if(a)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,i);const h=await this.options.onMutate?.(e,i);h!==this.state.context&&this.#r({type:"pending",context:h,variables:e,isPaused:l})}const c=await this.#i.start();return await this.#n.config.onSuccess?.(c,e,this.state.context,this,i),await this.options.onSuccess?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(c,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(c,null,e,this.state.context,i),this.#r({type:"success",data:c}),c}catch(c){try{throw await this.#n.config.onError?.(c,e,this.state.context,this,i),await this.options.onError?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(void 0,c,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,c,e,this.state.context,i),c}finally{this.#r({type:"error",error:c})}}finally{this.#n.runNext(this)}}#r(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),nn.batch(()=>{this.#t.forEach(i=>{i.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function bS(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var jD=class extends vl{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const i=new ID({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){this.#e.add(t);const e=Jd(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Jd(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Jd(t);if(typeof e=="string"){const i=this.#t.get(e)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const e=Jd(t);return typeof e=="string"?this.#t.get(e)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){nn.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Mb(e,n))}findAll(t={}){return this.getAll().filter(e=>Mb(t,e))}notify(t){nn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return nn.batch(()=>Promise.all(t.map(e=>e.continue().catch(tn))))}};function Jd(t){return t.options.scope?.id}var OD=class extends vl{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),vh(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&Va(n.mutationKey)!==Va(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??bS();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){nn.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,i,a),this.#i.onSettled?.(e.data,null,n,i,a)):e?.type==="error"&&(this.#i.onError?.(e.error,n,i,a),this.#i.onSettled?.(void 0,e.error,n,i,a))}this.listeners.forEach(n=>{n(this.#t)})})}},MD=class extends vl{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const i=e.queryKey,a=e.queryHash??Ug(i,e);let l=this.get(a);return l||(l=new TD({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){nn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Ob(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>Ob(t,n)):e}notify(t){nn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){nn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){nn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},kD=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new MD,this.#t=t.mutationCache||new jD,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=Fg.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=bh.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Vs(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(i.queryHash)?.state.data,c=oD(e,l);if(c!==void 0)return this.#e.build(this,i).setData(c,{...n,manual:!0})}setQueriesData(t,e,n){return nn.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;nn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return nn.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=nn.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then(tn).catch(tn)}invalidateQueries(t,e={}){return nn.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=nn.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(tn)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(tn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Vs(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(tn).catch(tn)}fetchInfiniteQuery(t){return t.behavior=Ub(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(tn).catch(tn)}ensureInfiniteQueryData(t){return t.behavior=Ub(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return bh.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Va(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(i=>{Kc(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Va(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(i=>{Kc(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Ug(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Bg&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},xS=A.createContext(void 0),sn=t=>{const e=A.useContext(xS);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},ND=({client:t,children:e})=>(A.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),d.jsx(xS.Provider,{value:t,children:e})),ES=A.createContext(!1),PD=()=>A.useContext(ES),LD=ES.Provider;function VD(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var zD=A.createContext(VD()),UD=()=>A.useContext(zD),BD=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},FD=t=>{A.useEffect(()=>{t.clearReset()},[t])},qD=({result:t,errorResetBoundary:e,throwOnError:n,query:i,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||mS(n,[t.error,i])),HD=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},GD=(t,e)=>t.isLoading&&t.isFetching&&!e,QD=(t,e)=>t?.suspense&&e.isPending,Fb=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function $D(t,e,n){const i=PD(),a=UD(),l=sn(),c=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c),c._optimisticResults=i?"isRestoring":"optimistic",HD(c),BD(c,a),FD(a);const h=!l.getQueryCache().get(c.queryHash),[m]=A.useState(()=>new e(l,c)),g=m.getOptimisticResult(c),_=!i&&t.subscribed!==!1;if(A.useSyncExternalStore(A.useCallback(v=>{const b=_?m.subscribe(nn.batchCalls(v)):tn;return m.updateResult(),b},[m,_]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),A.useEffect(()=>{m.setOptions(c)},[c,m]),QD(c,g))throw Fb(c,m,a);if(qD({result:g,errorResetBoundary:a,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw g.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,g),c.experimental_prefetchInRender&&!La&&GD(g,i)&&(h?Fb(c,m,a):l.getQueryCache().get(c.queryHash)?.promise)?.catch(tn).finally(()=>{m.updateResult()}),c.notifyOnChangeProps?g:m.trackResult(g)}function bl(t,e){return $D(t,AD)}function rr(t,e){const n=sn(),[i]=A.useState(()=>new OD(n,t));A.useEffect(()=>{i.setOptions(t)},[i,t]);const a=A.useSyncExternalStore(A.useCallback(c=>i.subscribe(nn.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=A.useCallback((c,h)=>{i.mutate(c,h).catch(tn)},[i]);if(a.error&&mS(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}function Zp(){}function KD(t,{interval:e=1e3,onError:n=Zp}={}){if(typeof t!="function")throw new Error("argument is not function.");let i=0,a=null,l=!1,c=!1;return async(...h)=>{if(a=h,!c){for(c=!0;l;)await new Promise(m=>Li.setTimeout(m,e));for(;Date.now()<i;)await new Promise(m=>Li.setTimeout(m,i-Date.now()));c=!1,l=!0;try{await t(...a)}catch(m){try{n(m)}catch{}}i=Date.now()+e,l=!1}}}var WD=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:i=JSON.stringify,deserialize:a=JSON.parse,retry:l})=>{if(t){const c=async h=>{try{const m=await i(h);await t.setItem(e,m);return}catch(m){return m}};return{persistClient:KD(async h=>{let m=h,g=await c(m),_=0;for(;g&&m;)_++,m=await l?.({persistedClient:m,error:g,errorCount:_}),m&&(g=await c(m))},{interval:n}),restoreClient:async()=>{const h=await t.getItem(e);if(h)return await a(h)},removeClient:()=>t.removeItem(e)}}return{persistClient:Zp,restoreClient:()=>Promise.resolve(void 0),removeClient:Zp}};const SS=300*1e3,YD=1440*60*1e3,st=new kD({defaultOptions:{queries:{staleTime:SS,gcTime:YD,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}});st.getQueryCache().subscribe(t=>{const e=t?.query;if(e&&t.type==="updated"){const{state:n}=e;n.status==="error"&&n.error&&console.error("[RQ] Query FAILED:",e.queryKey,n.error)}});const XD=WD({storage:typeof window<"u"?{getItem:t=>Promise.resolve(localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(localStorage.removeItem(t))}:void 0,key:"BUDGET_APP_QUERY_CACHE"}),xe={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};var JD=["added","removed","updated"];function qb(t){return JD.includes(t)}async function ZD({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:i="",hydrateOptions:a}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const c=Date.now()-l.timestamp>n,h=l.buster!==i;if(c||h)return e.removeClient();bD(t,l.clientState,a)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function Hb({queryClient:t,persister:e,buster:n="",dehydrateOptions:i}){const a={buster:n,timestamp:Date.now(),clientState:vD(t,i)};await e.persistClient(a)}function eI(t){const e=t.queryClient.getQueryCache().subscribe(i=>{qb(i.type)&&Hb(t)}),n=t.queryClient.getMutationCache().subscribe(i=>{qb(i.type)&&Hb(t)});return()=>{e(),n()}}var tI=({children:t,persistOptions:e,onSuccess:n,onError:i,...a})=>{const[l,c]=A.useState(!0),h=A.useRef({persistOptions:e,onSuccess:n,onError:i}),m=A.useRef(!1);return A.useEffect(()=>{h.current={persistOptions:e,onSuccess:n,onError:i}}),A.useEffect(()=>{const g={...h.current.persistOptions,queryClient:a.client};return m.current||(m.current=!0,ZD(g).then(()=>h.current.onSuccess?.()).catch(()=>h.current.onError?.()).finally(()=>{c(!1)})),l?void 0:eI(g)},[a.client,l]),d.jsx(ND,{...a,children:d.jsx(LD,{value:l,children:t})})};function nI({children:t}){return d.jsx(tI,{client:st,persistOptions:{persister:XD,maxAge:1440*60*1e3,buster:"v1"},children:t})}const rI=()=>{};var Gb={};const wS=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},iI=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],c=t[n++],h=t[n++],m=((a&7)<<18|(l&63)<<12|(c&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(m>>10)),e[i++]=String.fromCharCode(56320+(m&1023))}else{const l=t[n++],c=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},TS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],c=a+1<t.length,h=c?t[a+1]:0,m=a+2<t.length,g=m?t[a+2]:0,_=l>>2,v=(l&3)<<4|h>>4;let b=(h&15)<<2|g>>6,w=g&63;m||(w=64,c||(b=64)),i.push(n[_],n[v],n[b],n[w])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(wS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):iI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],h=a<t.length?n[t.charAt(a)]:0;++a;const g=a<t.length?n[t.charAt(a)]:64;++a;const v=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||h==null||g==null||v==null)throw new sI;const b=l<<2|h>>4;if(i.push(b),g!==64){const w=h<<4&240|g>>2;if(i.push(w),v!==64){const C=g<<6&192|v;i.push(C)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class sI extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aI=function(t){const e=wS(t);return TS.encodeByteArray(e,!0)},xh=function(t){return aI(t).replace(/\./g,"")},AS=function(t){try{return TS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function oI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const lI=()=>oI().__FIREBASE_DEFAULTS__,cI=()=>{if(typeof process>"u"||typeof Gb>"u")return;const t=Gb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},uI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&AS(t[1]);return e&&JSON.parse(e)},$h=()=>{try{return rI()||lI()||cI()||uI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},CS=t=>$h()?.emulatorHosts?.[t],dI=t=>{const e=CS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},RS=()=>$h()?.config,DS=t=>$h()?.[`_${t}`];class hI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function xl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function IS(t){return(await fetch(t,{credentials:"include"})).ok}function fI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[xh(JSON.stringify(n)),xh(JSON.stringify(c)),""].join(".")}const Bc={};function mI(){const t={prod:[],emulator:[]};for(const e of Object.keys(Bc))Bc[e]?t.emulator.push(e):t.prod.push(e);return t}function pI(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Qb=!1;function jS(t,e){if(typeof window>"u"||typeof document>"u"||!xl(window.location.host)||Bc[t]===e||Bc[t]||Qb)return;Bc[t]=e;function n(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=mI().prod.length>0;function c(){const b=document.getElementById(i);b&&b.remove()}function h(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function m(b,w){b.setAttribute("width","24"),b.setAttribute("id",w),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function g(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{Qb=!0,c()},b}function _(b,w){b.setAttribute("id",w),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function v(){const b=pI(i),w=n("text"),C=document.getElementById(w)||document.createElement("span"),T=n("learnmore"),j=document.getElementById(T)||document.createElement("a"),B=n("preprendIcon"),H=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const z=b.element;h(z),_(j,T);const J=g();m(H,B),z.append(H,C,j,J),document.body.appendChild(z)}l?(C.innerText="Preview backend disconnected.",H.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(H.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function Tn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tn())}function yI(){const t=$h()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _I(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function bI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function xI(){const t=Tn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function EI(){return!yI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SI(){try{return typeof indexedDB=="object"}catch{return!1}}function wI(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const TI="FirebaseError";class Ki extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=TI,Object.setPrototypeOf(this,Ki.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lu.prototype.create)}}class lu{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?AI(l,i):"Error",h=`${this.serviceName}: ${c} (${a}).`;return new Ki(a,h,i)}}function AI(t,e){return t.replace(CI,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const CI=/\{\$([^}]+)}/g;function RI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Gs(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],c=e[a];if($b(l)&&$b(c)){if(!Gs(l,c))return!1}else if(l!==c)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function $b(t){return t!==null&&typeof t=="object"}function cu(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Nc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Pc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function DI(t,e){const n=new II(t,e);return n.subscribe.bind(n)}class II{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");jI(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=Cp),a.error===void 0&&(a.error=Cp),a.complete===void 0&&(a.complete=Cp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Cp(){}function un(t){return t&&t._delegate?t._delegate:t}class za{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Oa="[DEFAULT]";class OI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new hI;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kI(e))try{this.getOrInitializeService({instanceIdentifier:Oa})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=Oa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Oa){return this.instances.has(e)}getOptions(e=Oa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(l);i===h&&c.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:MI(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Oa){return this.component?this.component.multipleInstances?e:Oa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function MI(t){return t===Oa?void 0:t}function kI(t){return t.instantiationMode==="EAGER"}class NI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new OI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var We;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(We||(We={}));const PI={debug:We.DEBUG,verbose:We.VERBOSE,info:We.INFO,warn:We.WARN,error:We.ERROR,silent:We.SILENT},LI=We.INFO,VI={[We.DEBUG]:"log",[We.VERBOSE]:"log",[We.INFO]:"info",[We.WARN]:"warn",[We.ERROR]:"error"},zI=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=VI[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Hg{constructor(e){this.name=e,this._logLevel=LI,this._logHandler=zI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in We))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,We.DEBUG,...e),this._logHandler(this,We.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,We.VERBOSE,...e),this._logHandler(this,We.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,We.INFO,...e),this._logHandler(this,We.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,We.WARN,...e),this._logHandler(this,We.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,We.ERROR,...e),this._logHandler(this,We.ERROR,...e)}}const UI=(t,e)=>e.some(n=>t instanceof n);let Kb,Wb;function BI(){return Kb||(Kb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function FI(){return Wb||(Wb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const OS=new WeakMap,eg=new WeakMap,MS=new WeakMap,Rp=new WeakMap,Gg=new WeakMap;function qI(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",c)},l=()=>{n(zs(t.result)),a()},c=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",c)});return e.then(n=>{n instanceof IDBCursor&&OS.set(n,t)}).catch(()=>{}),Gg.set(e,t),e}function HI(t){if(eg.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",c),t.removeEventListener("abort",c)},l=()=>{n(),a()},c=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",c),t.addEventListener("abort",c)});eg.set(t,e)}let tg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return eg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||MS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return zs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function GI(t){tg=t(tg)}function QI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(Dp(this),e,...n);return MS.set(i,e.sort?e.sort():[e]),zs(i)}:FI().includes(t)?function(...e){return t.apply(Dp(this),e),zs(OS.get(this))}:function(...e){return zs(t.apply(Dp(this),e))}}function $I(t){return typeof t=="function"?QI(t):(t instanceof IDBTransaction&&HI(t),UI(t,BI())?new Proxy(t,tg):t)}function zs(t){if(t instanceof IDBRequest)return qI(t);if(Rp.has(t))return Rp.get(t);const e=$I(t);return e!==t&&(Rp.set(t,e),Gg.set(e,t)),e}const Dp=t=>Gg.get(t);function KI(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const c=indexedDB.open(t,e),h=zs(c);return i&&c.addEventListener("upgradeneeded",m=>{i(zs(c.result),m.oldVersion,m.newVersion,zs(c.transaction),m)}),n&&c.addEventListener("blocked",m=>n(m.oldVersion,m.newVersion,m)),h.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",g=>a(g.oldVersion,g.newVersion,g))}).catch(()=>{}),h}const WI=["get","getKey","getAll","getAllKeys","count"],YI=["put","add","delete","clear"],Ip=new Map;function Yb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ip.get(e))return Ip.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=YI.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||WI.includes(n)))return;const l=async function(c,...h){const m=this.transaction(c,a?"readwrite":"readonly");let g=m.store;return i&&(g=g.index(h.shift())),(await Promise.all([g[n](...h),a&&m.done]))[0]};return Ip.set(e,l),l}GI(t=>({...t,get:(e,n,i)=>Yb(e,n)||t.get(e,n,i),has:(e,n)=>!!Yb(e,n)||t.has(e,n)}));class XI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(JI(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function JI(t){return t.getComponent()?.type==="VERSION"}const ng="@firebase/app",Xb="0.14.6";const qi=new Hg("@firebase/app"),ZI="@firebase/app-compat",e2="@firebase/analytics-compat",t2="@firebase/analytics",n2="@firebase/app-check-compat",r2="@firebase/app-check",i2="@firebase/auth",s2="@firebase/auth-compat",a2="@firebase/database",o2="@firebase/data-connect",l2="@firebase/database-compat",c2="@firebase/functions",u2="@firebase/functions-compat",d2="@firebase/installations",h2="@firebase/installations-compat",f2="@firebase/messaging",m2="@firebase/messaging-compat",p2="@firebase/performance",g2="@firebase/performance-compat",y2="@firebase/remote-config",_2="@firebase/remote-config-compat",v2="@firebase/storage",b2="@firebase/storage-compat",x2="@firebase/firestore",E2="@firebase/ai",S2="@firebase/firestore-compat",w2="firebase",T2="12.6.0";const rg="[DEFAULT]",A2={[ng]:"fire-core",[ZI]:"fire-core-compat",[t2]:"fire-analytics",[e2]:"fire-analytics-compat",[r2]:"fire-app-check",[n2]:"fire-app-check-compat",[i2]:"fire-auth",[s2]:"fire-auth-compat",[a2]:"fire-rtdb",[o2]:"fire-data-connect",[l2]:"fire-rtdb-compat",[c2]:"fire-fn",[u2]:"fire-fn-compat",[d2]:"fire-iid",[h2]:"fire-iid-compat",[f2]:"fire-fcm",[m2]:"fire-fcm-compat",[p2]:"fire-perf",[g2]:"fire-perf-compat",[y2]:"fire-rc",[_2]:"fire-rc-compat",[v2]:"fire-gcs",[b2]:"fire-gcs-compat",[x2]:"fire-fst",[S2]:"fire-fst-compat",[E2]:"fire-vertex","fire-js":"fire-js",[w2]:"fire-js-all"};const Eh=new Map,C2=new Map,ig=new Map;function Jb(t,e){try{t.container.addComponent(e)}catch(n){qi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function rl(t){const e=t.name;if(ig.has(e))return qi.debug(`There were multiple attempts to register component ${e}.`),!1;ig.set(e,t);for(const n of Eh.values())Jb(n,t);for(const n of C2.values())Jb(n,t);return!0}function Qg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Nr(t){return t==null?!1:t.settings!==void 0}const R2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Us=new lu("app","Firebase",R2);class D2{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new za("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Us.create("app-deleted",{appName:this._name})}}const El=T2;function kS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:rg,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Us.create("bad-app-name",{appName:String(a)});if(n||(n=RS()),!n)throw Us.create("no-options");const l=Eh.get(a);if(l){if(Gs(n,l.options)&&Gs(i,l.config))return l;throw Us.create("duplicate-app",{appName:a})}const c=new NI(a);for(const m of ig.values())c.addComponent(m);const h=new D2(n,i,c);return Eh.set(a,h),h}function NS(t=rg){const e=Eh.get(t);if(!e&&t===rg&&RS())return kS();if(!e)throw Us.create("no-app",{appName:t});return e}function Bs(t,e,n){let i=A2[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qi.warn(c.join(" "));return}rl(new za(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const I2="firebase-heartbeat-database",j2=1,Wc="firebase-heartbeat-store";let jp=null;function PS(){return jp||(jp=KI(I2,j2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Wc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Us.create("idb-open",{originalErrorMessage:t.message})})),jp}async function O2(t){try{const n=(await PS()).transaction(Wc),i=await n.objectStore(Wc).get(LS(t));return await n.done,i}catch(e){if(e instanceof Ki)qi.warn(e.message);else{const n=Us.create("idb-get",{originalErrorMessage:e?.message});qi.warn(n.message)}}}async function Zb(t,e){try{const i=(await PS()).transaction(Wc,"readwrite");await i.objectStore(Wc).put(e,LS(t)),await i.done}catch(n){if(n instanceof Ki)qi.warn(n.message);else{const i=Us.create("idb-set",{originalErrorMessage:n?.message});qi.warn(i.message)}}}function LS(t){return`${t.name}!${t.options.appId}`}const M2=1024,k2=30;class N2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new L2(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=ex();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>k2){const a=V2(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){qi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ex(),{heartbeatsToSend:n,unsentEntries:i}=P2(this._heartbeatsCache.heartbeats),a=xh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return qi.warn(e),""}}}function ex(){return new Date().toISOString().substring(0,10)}function P2(t,e=M2){const n=[];let i=t.slice();for(const a of t){const l=n.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),tx(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),tx(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class L2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return SI()?wI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await O2(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Zb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Zb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function tx(t){return xh(JSON.stringify({version:2,heartbeats:t})).length}function V2(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function z2(t){rl(new za("platform-logger",e=>new XI(e),"PRIVATE")),rl(new za("heartbeat",e=>new N2(e),"PRIVATE")),Bs(ng,Xb,t),Bs(ng,Xb,"esm2020"),Bs("fire-js","")}z2("");var U2="firebase",B2="12.7.0";Bs(U2,B2,"app");const F2={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},VS=kS(F2);var nx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Fs,zS;(function(){var t;function e(P,R){function D(){}D.prototype=R.prototype,P.F=R.prototype,P.prototype=new D,P.prototype.constructor=P,P.D=function(N,M,k){for(var I=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)I[ae-2]=arguments[ae];return R.prototype[M].apply(N,I)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(P,R,D){D||(D=0);const N=Array(16);if(typeof R=="string")for(var M=0;M<16;++M)N[M]=R.charCodeAt(D++)|R.charCodeAt(D++)<<8|R.charCodeAt(D++)<<16|R.charCodeAt(D++)<<24;else for(M=0;M<16;++M)N[M]=R[D++]|R[D++]<<8|R[D++]<<16|R[D++]<<24;R=P.g[0],D=P.g[1],M=P.g[2];let k=P.g[3],I;I=R+(k^D&(M^k))+N[0]+3614090360&4294967295,R=D+(I<<7&4294967295|I>>>25),I=k+(M^R&(D^M))+N[1]+3905402710&4294967295,k=R+(I<<12&4294967295|I>>>20),I=M+(D^k&(R^D))+N[2]+606105819&4294967295,M=k+(I<<17&4294967295|I>>>15),I=D+(R^M&(k^R))+N[3]+3250441966&4294967295,D=M+(I<<22&4294967295|I>>>10),I=R+(k^D&(M^k))+N[4]+4118548399&4294967295,R=D+(I<<7&4294967295|I>>>25),I=k+(M^R&(D^M))+N[5]+1200080426&4294967295,k=R+(I<<12&4294967295|I>>>20),I=M+(D^k&(R^D))+N[6]+2821735955&4294967295,M=k+(I<<17&4294967295|I>>>15),I=D+(R^M&(k^R))+N[7]+4249261313&4294967295,D=M+(I<<22&4294967295|I>>>10),I=R+(k^D&(M^k))+N[8]+1770035416&4294967295,R=D+(I<<7&4294967295|I>>>25),I=k+(M^R&(D^M))+N[9]+2336552879&4294967295,k=R+(I<<12&4294967295|I>>>20),I=M+(D^k&(R^D))+N[10]+4294925233&4294967295,M=k+(I<<17&4294967295|I>>>15),I=D+(R^M&(k^R))+N[11]+2304563134&4294967295,D=M+(I<<22&4294967295|I>>>10),I=R+(k^D&(M^k))+N[12]+1804603682&4294967295,R=D+(I<<7&4294967295|I>>>25),I=k+(M^R&(D^M))+N[13]+4254626195&4294967295,k=R+(I<<12&4294967295|I>>>20),I=M+(D^k&(R^D))+N[14]+2792965006&4294967295,M=k+(I<<17&4294967295|I>>>15),I=D+(R^M&(k^R))+N[15]+1236535329&4294967295,D=M+(I<<22&4294967295|I>>>10),I=R+(M^k&(D^M))+N[1]+4129170786&4294967295,R=D+(I<<5&4294967295|I>>>27),I=k+(D^M&(R^D))+N[6]+3225465664&4294967295,k=R+(I<<9&4294967295|I>>>23),I=M+(R^D&(k^R))+N[11]+643717713&4294967295,M=k+(I<<14&4294967295|I>>>18),I=D+(k^R&(M^k))+N[0]+3921069994&4294967295,D=M+(I<<20&4294967295|I>>>12),I=R+(M^k&(D^M))+N[5]+3593408605&4294967295,R=D+(I<<5&4294967295|I>>>27),I=k+(D^M&(R^D))+N[10]+38016083&4294967295,k=R+(I<<9&4294967295|I>>>23),I=M+(R^D&(k^R))+N[15]+3634488961&4294967295,M=k+(I<<14&4294967295|I>>>18),I=D+(k^R&(M^k))+N[4]+3889429448&4294967295,D=M+(I<<20&4294967295|I>>>12),I=R+(M^k&(D^M))+N[9]+568446438&4294967295,R=D+(I<<5&4294967295|I>>>27),I=k+(D^M&(R^D))+N[14]+3275163606&4294967295,k=R+(I<<9&4294967295|I>>>23),I=M+(R^D&(k^R))+N[3]+4107603335&4294967295,M=k+(I<<14&4294967295|I>>>18),I=D+(k^R&(M^k))+N[8]+1163531501&4294967295,D=M+(I<<20&4294967295|I>>>12),I=R+(M^k&(D^M))+N[13]+2850285829&4294967295,R=D+(I<<5&4294967295|I>>>27),I=k+(D^M&(R^D))+N[2]+4243563512&4294967295,k=R+(I<<9&4294967295|I>>>23),I=M+(R^D&(k^R))+N[7]+1735328473&4294967295,M=k+(I<<14&4294967295|I>>>18),I=D+(k^R&(M^k))+N[12]+2368359562&4294967295,D=M+(I<<20&4294967295|I>>>12),I=R+(D^M^k)+N[5]+4294588738&4294967295,R=D+(I<<4&4294967295|I>>>28),I=k+(R^D^M)+N[8]+2272392833&4294967295,k=R+(I<<11&4294967295|I>>>21),I=M+(k^R^D)+N[11]+1839030562&4294967295,M=k+(I<<16&4294967295|I>>>16),I=D+(M^k^R)+N[14]+4259657740&4294967295,D=M+(I<<23&4294967295|I>>>9),I=R+(D^M^k)+N[1]+2763975236&4294967295,R=D+(I<<4&4294967295|I>>>28),I=k+(R^D^M)+N[4]+1272893353&4294967295,k=R+(I<<11&4294967295|I>>>21),I=M+(k^R^D)+N[7]+4139469664&4294967295,M=k+(I<<16&4294967295|I>>>16),I=D+(M^k^R)+N[10]+3200236656&4294967295,D=M+(I<<23&4294967295|I>>>9),I=R+(D^M^k)+N[13]+681279174&4294967295,R=D+(I<<4&4294967295|I>>>28),I=k+(R^D^M)+N[0]+3936430074&4294967295,k=R+(I<<11&4294967295|I>>>21),I=M+(k^R^D)+N[3]+3572445317&4294967295,M=k+(I<<16&4294967295|I>>>16),I=D+(M^k^R)+N[6]+76029189&4294967295,D=M+(I<<23&4294967295|I>>>9),I=R+(D^M^k)+N[9]+3654602809&4294967295,R=D+(I<<4&4294967295|I>>>28),I=k+(R^D^M)+N[12]+3873151461&4294967295,k=R+(I<<11&4294967295|I>>>21),I=M+(k^R^D)+N[15]+530742520&4294967295,M=k+(I<<16&4294967295|I>>>16),I=D+(M^k^R)+N[2]+3299628645&4294967295,D=M+(I<<23&4294967295|I>>>9),I=R+(M^(D|~k))+N[0]+4096336452&4294967295,R=D+(I<<6&4294967295|I>>>26),I=k+(D^(R|~M))+N[7]+1126891415&4294967295,k=R+(I<<10&4294967295|I>>>22),I=M+(R^(k|~D))+N[14]+2878612391&4294967295,M=k+(I<<15&4294967295|I>>>17),I=D+(k^(M|~R))+N[5]+4237533241&4294967295,D=M+(I<<21&4294967295|I>>>11),I=R+(M^(D|~k))+N[12]+1700485571&4294967295,R=D+(I<<6&4294967295|I>>>26),I=k+(D^(R|~M))+N[3]+2399980690&4294967295,k=R+(I<<10&4294967295|I>>>22),I=M+(R^(k|~D))+N[10]+4293915773&4294967295,M=k+(I<<15&4294967295|I>>>17),I=D+(k^(M|~R))+N[1]+2240044497&4294967295,D=M+(I<<21&4294967295|I>>>11),I=R+(M^(D|~k))+N[8]+1873313359&4294967295,R=D+(I<<6&4294967295|I>>>26),I=k+(D^(R|~M))+N[15]+4264355552&4294967295,k=R+(I<<10&4294967295|I>>>22),I=M+(R^(k|~D))+N[6]+2734768916&4294967295,M=k+(I<<15&4294967295|I>>>17),I=D+(k^(M|~R))+N[13]+1309151649&4294967295,D=M+(I<<21&4294967295|I>>>11),I=R+(M^(D|~k))+N[4]+4149444226&4294967295,R=D+(I<<6&4294967295|I>>>26),I=k+(D^(R|~M))+N[11]+3174756917&4294967295,k=R+(I<<10&4294967295|I>>>22),I=M+(R^(k|~D))+N[2]+718787259&4294967295,M=k+(I<<15&4294967295|I>>>17),I=D+(k^(M|~R))+N[9]+3951481745&4294967295,P.g[0]=P.g[0]+R&4294967295,P.g[1]=P.g[1]+(M+(I<<21&4294967295|I>>>11))&4294967295,P.g[2]=P.g[2]+M&4294967295,P.g[3]=P.g[3]+k&4294967295}i.prototype.v=function(P,R){R===void 0&&(R=P.length);const D=R-this.blockSize,N=this.C;let M=this.h,k=0;for(;k<R;){if(M==0)for(;k<=D;)a(this,P,k),k+=this.blockSize;if(typeof P=="string"){for(;k<R;)if(N[M++]=P.charCodeAt(k++),M==this.blockSize){a(this,N),M=0;break}}else for(;k<R;)if(N[M++]=P[k++],M==this.blockSize){a(this,N),M=0;break}}this.h=M,this.o+=R},i.prototype.A=function(){var P=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);P[0]=128;for(var R=1;R<P.length-8;++R)P[R]=0;R=this.o*8;for(var D=P.length-8;D<P.length;++D)P[D]=R&255,R/=256;for(this.v(P),P=Array(16),R=0,D=0;D<4;++D)for(let N=0;N<32;N+=8)P[R++]=this.g[D]>>>N&255;return P};function l(P,R){var D=h;return Object.prototype.hasOwnProperty.call(D,P)?D[P]:D[P]=R(P)}function c(P,R){this.h=R;const D=[];let N=!0;for(let M=P.length-1;M>=0;M--){const k=P[M]|0;N&&k==R||(D[M]=k,N=!1)}this.g=D}var h={};function m(P){return-128<=P&&P<128?l(P,function(R){return new c([R|0],R<0?-1:0)}):new c([P|0],P<0?-1:0)}function g(P){if(isNaN(P)||!isFinite(P))return v;if(P<0)return j(g(-P));const R=[];let D=1;for(let N=0;P>=D;N++)R[N]=P/D|0,D*=4294967296;return new c(R,0)}function _(P,R){if(P.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(P.charAt(0)=="-")return j(_(P.substring(1),R));if(P.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=g(Math.pow(R,8));let N=v;for(let k=0;k<P.length;k+=8){var M=Math.min(8,P.length-k);const I=parseInt(P.substring(k,k+M),R);M<8?(M=g(Math.pow(R,M)),N=N.j(M).add(g(I))):(N=N.j(D),N=N.add(g(I)))}return N}var v=m(0),b=m(1),w=m(16777216);t=c.prototype,t.m=function(){if(T(this))return-j(this).m();let P=0,R=1;for(let D=0;D<this.g.length;D++){const N=this.i(D);P+=(N>=0?N:4294967296+N)*R,R*=4294967296}return P},t.toString=function(P){if(P=P||10,P<2||36<P)throw Error("radix out of range: "+P);if(C(this))return"0";if(T(this))return"-"+j(this).toString(P);const R=g(Math.pow(P,6));var D=this;let N="";for(;;){const M=J(D,R).g;D=B(D,M.j(R));let k=((D.g.length>0?D.g[0]:D.h)>>>0).toString(P);if(D=M,C(D))return k+N;for(;k.length<6;)k="0"+k;N=k+N}},t.i=function(P){return P<0?0:P<this.g.length?this.g[P]:this.h};function C(P){if(P.h!=0)return!1;for(let R=0;R<P.g.length;R++)if(P.g[R]!=0)return!1;return!0}function T(P){return P.h==-1}t.l=function(P){return P=B(this,P),T(P)?-1:C(P)?0:1};function j(P){const R=P.g.length,D=[];for(let N=0;N<R;N++)D[N]=~P.g[N];return new c(D,~P.h).add(b)}t.abs=function(){return T(this)?j(this):this},t.add=function(P){const R=Math.max(this.g.length,P.g.length),D=[];let N=0;for(let M=0;M<=R;M++){let k=N+(this.i(M)&65535)+(P.i(M)&65535),I=(k>>>16)+(this.i(M)>>>16)+(P.i(M)>>>16);N=I>>>16,k&=65535,I&=65535,D[M]=I<<16|k}return new c(D,D[D.length-1]&-2147483648?-1:0)};function B(P,R){return P.add(j(R))}t.j=function(P){if(C(this)||C(P))return v;if(T(this))return T(P)?j(this).j(j(P)):j(j(this).j(P));if(T(P))return j(this.j(j(P)));if(this.l(w)<0&&P.l(w)<0)return g(this.m()*P.m());const R=this.g.length+P.g.length,D=[];for(var N=0;N<2*R;N++)D[N]=0;for(N=0;N<this.g.length;N++)for(let M=0;M<P.g.length;M++){const k=this.i(N)>>>16,I=this.i(N)&65535,ae=P.i(M)>>>16,q=P.i(M)&65535;D[2*N+2*M]+=I*q,H(D,2*N+2*M),D[2*N+2*M+1]+=k*q,H(D,2*N+2*M+1),D[2*N+2*M+1]+=I*ae,H(D,2*N+2*M+1),D[2*N+2*M+2]+=k*ae,H(D,2*N+2*M+2)}for(P=0;P<R;P++)D[P]=D[2*P+1]<<16|D[2*P];for(P=R;P<2*R;P++)D[P]=0;return new c(D,0)};function H(P,R){for(;(P[R]&65535)!=P[R];)P[R+1]+=P[R]>>>16,P[R]&=65535,R++}function z(P,R){this.g=P,this.h=R}function J(P,R){if(C(R))throw Error("division by zero");if(C(P))return new z(v,v);if(T(P))return R=J(j(P),R),new z(j(R.g),j(R.h));if(T(R))return R=J(P,j(R)),new z(j(R.g),R.h);if(P.g.length>30){if(T(P)||T(R))throw Error("slowDivide_ only works with positive integers.");for(var D=b,N=R;N.l(P)<=0;)D=$(D),N=$(N);var M=re(D,1),k=re(N,1);for(N=re(N,2),D=re(D,2);!C(N);){var I=k.add(N);I.l(P)<=0&&(M=M.add(D),k=I),N=re(N,1),D=re(D,1)}return R=B(P,M.j(R)),new z(M,R)}for(M=v;P.l(R)>=0;){for(D=Math.max(1,Math.floor(P.m()/R.m())),N=Math.ceil(Math.log(D)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),k=g(D),I=k.j(R);T(I)||I.l(P)>0;)D-=N,k=g(D),I=k.j(R);C(k)&&(k=b),M=M.add(k),P=B(P,I)}return new z(M,P)}t.B=function(P){return J(this,P).h},t.and=function(P){const R=Math.max(this.g.length,P.g.length),D=[];for(let N=0;N<R;N++)D[N]=this.i(N)&P.i(N);return new c(D,this.h&P.h)},t.or=function(P){const R=Math.max(this.g.length,P.g.length),D=[];for(let N=0;N<R;N++)D[N]=this.i(N)|P.i(N);return new c(D,this.h|P.h)},t.xor=function(P){const R=Math.max(this.g.length,P.g.length),D=[];for(let N=0;N<R;N++)D[N]=this.i(N)^P.i(N);return new c(D,this.h^P.h)};function $(P){const R=P.g.length+1,D=[];for(let N=0;N<R;N++)D[N]=P.i(N)<<1|P.i(N-1)>>>31;return new c(D,P.h)}function re(P,R){const D=R>>5;R%=32;const N=P.g.length-D,M=[];for(let k=0;k<N;k++)M[k]=R>0?P.i(k+D)>>>R|P.i(k+D+1)<<32-R:P.i(k+D);return new c(M,P.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,zS=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=g,c.fromString=_,Fs=c}).apply(typeof nx<"u"?nx:typeof self<"u"?self:typeof window<"u"?window:{});var Zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var US,Lc,BS,oh,sg,FS,qS,HS;(function(){var t,e=Object.defineProperty;function n(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zd=="object"&&Zd];for(var x=0;x<f.length;++x){var S=f[x];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=n(this);function a(f,x){if(x)e:{var S=i;f=f.split(".");for(var V=0;V<f.length-1;V++){var ne=f[V];if(!(ne in S))break e;S=S[ne]}f=f[f.length-1],V=S[f],x=x(V),x!=V&&x!=null&&e(S,f,{configurable:!0,writable:!0,value:x})}}a("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(f){return f||function(x){var S=[],V;for(V in x)Object.prototype.hasOwnProperty.call(x,V)&&S.push([V,x[V]]);return S}});var l=l||{},c=this||self;function h(f){var x=typeof f;return x=="object"&&f!=null||x=="function"}function m(f,x,S){return f.call.apply(f.bind,arguments)}function g(f,x,S){return g=m,g.apply(null,arguments)}function _(f,x){var S=Array.prototype.slice.call(arguments,1);return function(){var V=S.slice();return V.push.apply(V,arguments),f.apply(this,V)}}function v(f,x){function S(){}S.prototype=x.prototype,f.Z=x.prototype,f.prototype=new S,f.prototype.constructor=f,f.Ob=function(V,ne,de){for(var we=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)we[Be-2]=arguments[Be];return x.prototype[ne].apply(V,we)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function w(f){const x=f.length;if(x>0){const S=Array(x);for(let V=0;V<x;V++)S[V]=f[V];return S}return[]}function C(f,x){for(let V=1;V<arguments.length;V++){const ne=arguments[V];var S=typeof ne;if(S=S!="object"?S:ne?Array.isArray(ne)?"array":S:"null",S=="array"||S=="object"&&typeof ne.length=="number"){S=f.length||0;const de=ne.length||0;f.length=S+de;for(let we=0;we<de;we++)f[S+we]=ne[we]}else f.push(ne)}}class T{constructor(x,S){this.i=x,this.j=S,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function j(f){c.setTimeout(()=>{throw f},0)}function B(){var f=P;let x=null;return f.g&&(x=f.g,f.g=f.g.next,f.g||(f.h=null),x.next=null),x}class H{constructor(){this.h=this.g=null}add(x,S){const V=z.get();V.set(x,S),this.h?this.h.next=V:this.g=V,this.h=V}}var z=new T(()=>new J,f=>f.reset());class J{constructor(){this.next=this.g=this.h=null}set(x,S){this.h=x,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let $,re=!1,P=new H,R=()=>{const f=Promise.resolve(void 0);$=()=>{f.then(D)}};function D(){for(var f;f=B();){try{f.h.call(f.g)}catch(S){j(S)}var x=z;x.j(f),x.h<100&&(x.h++,f.next=x.g,x.g=f)}re=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(f,x){this.type=f,this.g=this.target=x,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var k=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var f=!1,x=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const S=()=>{};c.addEventListener("test",S,x),c.removeEventListener("test",S,x)}catch{}return f})();function I(f){return/^[\s\xa0]*$/.test(f)}function ae(f,x){M.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,x)}v(ae,M),ae.prototype.init=function(f,x){const S=this.type=f.type,V=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=x,x=f.relatedTarget,x||(S=="mouseover"?x=f.fromElement:S=="mouseout"&&(x=f.toElement)),this.relatedTarget=x,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&ae.Z.h.call(this)},ae.prototype.h=function(){ae.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var q="closure_listenable_"+(Math.random()*1e6|0),L=0;function Q(f,x,S,V,ne){this.listener=f,this.proxy=null,this.src=x,this.type=S,this.capture=!!V,this.ha=ne,this.key=++L,this.da=this.fa=!1}function K(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function oe(f,x,S){for(const V in f)x.call(S,f[V],V,f)}function ue(f,x){for(const S in f)x.call(void 0,f[S],S,f)}function U(f){const x={};for(const S in f)x[S]=f[S];return x}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(f,x){let S,V;for(let ne=1;ne<arguments.length;ne++){V=arguments[ne];for(S in V)f[S]=V[S];for(let de=0;de<F.length;de++)S=F[de],Object.prototype.hasOwnProperty.call(V,S)&&(f[S]=V[S])}}function X(f){this.src=f,this.g={},this.h=0}X.prototype.add=function(f,x,S,V,ne){const de=f.toString();f=this.g[de],f||(f=this.g[de]=[],this.h++);const we=ge(f,x,V,ne);return we>-1?(x=f[we],S||(x.fa=!1)):(x=new Q(x,this.src,de,!!V,ne),x.fa=S,f.push(x)),x};function ee(f,x){const S=x.type;if(S in f.g){var V=f.g[S],ne=Array.prototype.indexOf.call(V,x,void 0),de;(de=ne>=0)&&Array.prototype.splice.call(V,ne,1),de&&(K(x),f.g[S].length==0&&(delete f.g[S],f.h--))}}function ge(f,x,S,V){for(let ne=0;ne<f.length;++ne){const de=f[ne];if(!de.da&&de.listener==x&&de.capture==!!S&&de.ha==V)return ne}return-1}var me="closure_lm_"+(Math.random()*1e6|0),Ee={};function fe(f,x,S,V,ne){if(Array.isArray(x)){for(let de=0;de<x.length;de++)fe(f,x[de],S,V,ne);return null}return S=Xi(S),f&&f[q]?f.J(x,S,h(V)?!!V.capture:!1,ne):Z(f,x,S,!1,V,ne)}function Z(f,x,S,V,ne,de){if(!x)throw Error("Invalid event type");const we=h(ne)?!!ne.capture:!!ne;let Be=ir(f);if(Be||(f[me]=Be=new X(f)),S=Be.add(x,S,V,we,de),S.proxy)return S;if(V=De(),S.proxy=V,V.src=f,V.listener=S,f.addEventListener)k||(ne=we),ne===void 0&&(ne=!1),f.addEventListener(x.toString(),V,ne);else if(f.attachEvent)f.attachEvent(Qe(x.toString()),V);else if(f.addListener&&f.removeListener)f.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return S}function De(){function f(S){return x.call(f.src,f.listener,S)}const x=dn;return f}function Pe(f,x,S,V,ne){if(Array.isArray(x))for(var de=0;de<x.length;de++)Pe(f,x[de],S,V,ne);else V=h(V)?!!V.capture:!!V,S=Xi(S),f&&f[q]?(f=f.i,de=String(x).toString(),de in f.g&&(x=f.g[de],S=ge(x,S,V,ne),S>-1&&(K(x[S]),Array.prototype.splice.call(x,S,1),x.length==0&&(delete f.g[de],f.h--)))):f&&(f=ir(f))&&(x=f.g[x.toString()],f=-1,x&&(f=ge(x,S,V,ne)),(S=f>-1?x[f]:null)&&gt(S))}function gt(f){if(typeof f!="number"&&f&&!f.da){var x=f.src;if(x&&x[q])ee(x.i,f);else{var S=f.type,V=f.proxy;x.removeEventListener?x.removeEventListener(S,V,f.capture):x.detachEvent?x.detachEvent(Qe(S),V):x.addListener&&x.removeListener&&x.removeListener(V),(S=ir(x))?(ee(S,f),S.h==0&&(S.src=null,x[me]=null)):K(f)}}}function Qe(f){return f in Ee?Ee[f]:Ee[f]="on"+f}function dn(f,x){if(f.da)f=!0;else{x=new ae(x,this);const S=f.listener,V=f.ha||f.src;f.fa&&gt(f),f=S.call(V,x)}return f}function ir(f){return f=f[me],f instanceof X?f:null}var yi="__closure_events_fn_"+(Math.random()*1e9>>>0);function Xi(f){return typeof f=="function"?f:(f[yi]||(f[yi]=function(x){return f.handleEvent(x)}),f[yi])}function At(){N.call(this),this.i=new X(this),this.M=this,this.G=null}v(At,N),At.prototype[q]=!0,At.prototype.removeEventListener=function(f,x,S,V){Pe(this,f,x,S,V)};function jt(f,x){var S,V=f.G;if(V)for(S=[];V;V=V.G)S.push(V);if(f=f.M,V=x.type||x,typeof x=="string")x=new M(x,f);else if(x instanceof M)x.target=x.target||f;else{var ne=x;x=new M(V,f),W(x,ne)}ne=!0;let de,we;if(S)for(we=S.length-1;we>=0;we--)de=x.g=S[we],ne=nt(de,V,!0,x)&&ne;if(de=x.g=f,ne=nt(de,V,!0,x)&&ne,ne=nt(de,V,!1,x)&&ne,S)for(we=0;we<S.length;we++)de=x.g=S[we],ne=nt(de,V,!1,x)&&ne}At.prototype.N=function(){if(At.Z.N.call(this),this.i){var f=this.i;for(const x in f.g){const S=f.g[x];for(let V=0;V<S.length;V++)K(S[V]);delete f.g[x],f.h--}}this.G=null},At.prototype.J=function(f,x,S,V){return this.i.add(String(f),x,!1,S,V)},At.prototype.K=function(f,x,S,V){return this.i.add(String(f),x,!0,S,V)};function nt(f,x,S,V){if(x=f.i.g[String(x)],!x)return!0;x=x.concat();let ne=!0;for(let de=0;de<x.length;++de){const we=x[de];if(we&&!we.da&&we.capture==S){const Be=we.listener,Mt=we.ha||we.src;we.fa&&ee(f.i,we),ne=Be.call(Mt,V)!==!1&&ne}}return ne&&!V.defaultPrevented}function Fn(f,x){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=g(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:c.setTimeout(f,x||0)}function Er(f){f.g=Fn(()=>{f.g=null,f.i&&(f.i=!1,Er(f))},f.l);const x=f.h;f.h=null,f.m.apply(null,x)}class Ct extends N{constructor(x,S){super(),this.m=x,this.l=S,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Er(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function qn(f){N.call(this),this.h=f,this.g={}}v(qn,N);var Vt=[];function Hn(f){oe(f.g,function(x,S){this.g.hasOwnProperty(S)&&gt(x)},f),f.g={}}qn.prototype.N=function(){qn.Z.N.call(this),Hn(this)},qn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ji=c.JSON.stringify,xf=c.JSON.parse,Su=class{stringify(f){return c.JSON.stringify(f,void 0)}parse(f){return c.JSON.parse(f,void 0)}};function wu(){}function Tu(){}var Sr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function hn(){M.call(this,"d")}v(hn,M);function sr(){M.call(this,"c")}v(sr,M);var Ot={},Au=null;function Za(){return Au=Au||new At}Ot.Ia="serverreachability";function Cu(f){M.call(this,Ot.Ia,f)}v(Cu,M);function Ur(f){const x=Za();jt(x,new Cu(x))}Ot.STAT_EVENT="statevent";function ra(f,x){M.call(this,Ot.STAT_EVENT,f),this.stat=x}v(ra,M);function zt(f){const x=Za();jt(x,new ra(x,f))}Ot.Ja="timingevent";function Br(f,x){M.call(this,Ot.Ja,f),this.size=x}v(Br,M);function Fr(f,x){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){f()},x)}function wr(){this.g=!0}wr.prototype.ua=function(){this.g=!1};function Ef(f,x,S,V,ne,de){f.info(function(){if(f.g)if(de){var we="",Be=de.split("&");for(let rt=0;rt<Be.length;rt++){var Mt=Be[rt].split("=");if(Mt.length>1){const xt=Mt[0];Mt=Mt[1];const cr=xt.split("_");we=cr.length>=2&&cr[1]=="type"?we+(xt+"="+Mt+"&"):we+(xt+"=redacted&")}}}else we=null;else we=de;return"XMLHTTP REQ ("+V+") [attempt "+ne+"]: "+x+`
`+S+`
`+we})}function Ru(f,x,S,V,ne,de,we){f.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+ne+"]: "+x+`
`+S+`
`+de+" "+we})}function qr(f,x,S,V){f.info(function(){return"XMLHTTP TEXT ("+x+"): "+Sf(f,S)+(V?" "+V:"")})}function ia(f,x){f.info(function(){return"TIMEOUT: "+x})}wr.prototype.info=function(){};function Sf(f,x){if(!f.g)return x;if(!x)return null;try{const de=JSON.parse(x);if(de){for(f=0;f<de.length;f++)if(Array.isArray(de[f])){var S=de[f];if(!(S.length<2)){var V=S[1];if(Array.isArray(V)&&!(V.length<1)){var ne=V[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(let we=1;we<V.length;we++)V[we]=""}}}}return Ji(de)}catch{return x}}var sa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ml={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},kl;function aa(){}v(aa,wu),aa.prototype.g=function(){return new XMLHttpRequest},kl=new aa;function _i(f){return encodeURIComponent(String(f))}function Du(f){var x=1;f=f.split(":");const S=[];for(;x>0&&f.length;)S.push(f.shift()),x--;return f.length&&S.push(f.join(":")),S}function Tr(f,x,S,V){this.j=f,this.i=x,this.l=S,this.S=V||1,this.V=new qn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ar}function Ar(){this.i=null,this.g="",this.h=!1}var Ut={},an={};function Hr(f,x,S){f.M=1,f.A=oa(Ft(x)),f.u=S,f.R=!0,eo(f,null)}function eo(f,x){f.F=Date.now(),Gr(f),f.B=Ft(f.A);var S=f.B,V=f.S;Array.isArray(V)||(V=[String(V)]),io(S.i,"t",V),f.C=0,S=f.j.L,f.h=new Ar,f.g=Hu(f.j,S?x:null,!f.u),f.P>0&&(f.O=new Ct(g(f.Y,f,f.g),f.P)),x=f.V,S=f.g,V=f.ba;var ne="readystatechange";Array.isArray(ne)||(ne&&(Vt[0]=ne.toString()),ne=Vt);for(let de=0;de<ne.length;de++){const we=fe(S,ne[de],V||x.handleEvent,!1,x.h||x);if(!we)break;x.g[we.key]=we}x=f.J?U(f.J):{},f.u?(f.v||(f.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,x)):(f.v="GET",f.g.ea(f.B,f.v,null,x)),Ur(),Ef(f.i,f.v,f.B,f.l,f.S,f.u)}Tr.prototype.ba=function(f){f=f.target;const x=this.O;x&&Dr(f)==3?x.j():this.Y(f)},Tr.prototype.Y=function(f){try{if(f==this.g)e:{const Be=Dr(this.g),Mt=this.g.ya(),rt=this.g.ca();if(!(Be<3)&&(Be!=3||this.g&&(this.h.h||this.g.la()||fn(this.g)))){this.K||Be!=4||Mt==7||(Mt==8||rt<=0?Ur(3):Ur(2)),Qr(this);var x=this.g.ca();this.X=x;var S=wf(this);if(this.o=x==200,Ru(this.i,this.v,this.B,this.l,this.S,Be,x),this.o){if(this.U&&!this.L){t:{if(this.g){var V,ne=this.g;if((V=ne.g?ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(V)){var de=V;break t}}de=null}if(f=de)qr(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,$r(this,f);else{this.o=!1,this.m=3,zt(12),Gn(this),ar(this);break e}}if(this.R){f=!0;let xt;for(;!this.K&&this.C<S.length;)if(xt=ju(this,S),xt==an){Be==4&&(this.m=4,zt(14),f=!1),qr(this.i,this.l,null,"[Incomplete Response]");break}else if(xt==Ut){this.m=4,zt(15),qr(this.i,this.l,S,"[Invalid Chunk]"),f=!1;break}else qr(this.i,this.l,xt,null),$r(this,xt);if(Iu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Be!=4||S.length!=0||this.h.h||(this.m=1,zt(16),f=!1),this.o=this.o&&f,!f)qr(this.i,this.l,S,"[Invalid Chunked Response]"),Gn(this),ar(this);else if(S.length>0&&!this.W){this.W=!0;var we=this.j;we.g==this&&we.aa&&!we.P&&(we.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),Wl(we),we.P=!0,zt(11))}}else qr(this.i,this.l,S,null),$r(this,S);Be==4&&Gn(this),this.o&&!this.K&&(Be==4?Uu(this.j,this):(this.o=!1,Gr(this)))}else bi(this.g),x==400&&S.indexOf("Unknown SID")>0?(this.m=3,zt(12)):(this.m=0,zt(13)),Gn(this),ar(this)}}}catch{}};function wf(f){if(!Iu(f))return f.g.la();const x=fn(f.g);if(x==="")return"";let S="";const V=x.length,ne=Dr(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return Gn(f),ar(f),"";f.h.i=new c.TextDecoder}for(let de=0;de<V;de++)f.h.h=!0,S+=f.h.i.decode(x[de],{stream:!(ne&&de==V-1)});return x.length=0,f.h.g+=S,f.C=0,f.h.g}function Iu(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function ju(f,x){var S=f.C,V=x.indexOf(`
`,S);return V==-1?an:(S=Number(x.substring(S,V)),isNaN(S)?Ut:(V+=1,V+S>x.length?an:(x=x.slice(V,V+S),f.C=V+S,x)))}Tr.prototype.cancel=function(){this.K=!0,Gn(this)};function Gr(f){f.T=Date.now()+f.H,to(f,f.H)}function to(f,x){if(f.D!=null)throw Error("WatchDog timer not null");f.D=Fr(g(f.aa,f),x)}function Qr(f){f.D&&(c.clearTimeout(f.D),f.D=null)}Tr.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(ia(this.i,this.B),this.M!=2&&(Ur(),zt(17)),Gn(this),this.m=2,ar(this)):to(this,this.T-f)};function ar(f){f.j.I==0||f.K||Uu(f.j,f)}function Gn(f){Qr(f);var x=f.O;x&&typeof x.dispose=="function"&&x.dispose(),f.O=null,Hn(f.V),f.g&&(x=f.g,f.g=null,x.abort(),x.dispose())}function $r(f,x){try{var S=f.j;if(S.I!=0&&(S.g==f||Wr(S.h,f))){if(!f.L&&Wr(S.h,f)&&S.I==3){try{var V=S.Ba.g.parse(x)}catch{V=null}if(Array.isArray(V)&&V.length==3){var ne=V;if(ne[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<f.F)co(S),as(S);else break e;ma(S),zt(18)}}else S.xa=ne[1],0<S.xa-S.K&&ne[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=Fr(g(S.Va,S),6e3));Kr(S.h)<=1&&S.ta&&(S.ta=void 0)}else ti(S,11)}else if((f.L||S.g==f)&&co(S),!I(x))for(ne=S.Ba.g.parse(x),x=0;x<ne.length;x++){let rt=ne[x];const xt=rt[0];if(!(xt<=S.K))if(S.K=xt,rt=rt[1],S.I==2)if(rt[0]=="c"){S.M=rt[1],S.ba=rt[2];const cr=rt[3];cr!=null&&(S.ka=cr,S.j.info("VER="+S.ka));const ni=rt[4];ni!=null&&(S.za=ni,S.j.info("SVER="+S.za));const Ir=rt[5];Ir!=null&&typeof Ir=="number"&&Ir>0&&(V=1.5*Ir,S.O=V,S.j.info("backChannelRequestTimeoutMs_="+V)),V=S;const jr=f.g;if(jr){const pa=jr.g?jr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pa){var de=V.h;de.g||pa.indexOf("spdy")==-1&&pa.indexOf("quic")==-1&&pa.indexOf("h2")==-1||(de.j=de.l,de.g=new Set,de.h&&(Ll(de,de.h),de.h=null))}if(V.G){const uo=jr.g?jr.g.getResponseHeader("X-HTTP-Session-Id"):null;uo&&(V.wa=uo,ot(V.J,V.G,uo))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-f.F,S.j.info("Handshake RTT: "+S.T+"ms")),V=S;var we=f;if(V.na=qu(V,V.L?V.ba:null,V.W),we.L){Vl(V.h,we);var Be=we,Mt=V.O;Mt&&(Be.H=Mt),Be.D&&(Qr(Be),Gr(Be)),V.g=we}else Vu(V);S.i.length>0&&ei(S)}else rt[0]!="stop"&&rt[0]!="close"||ti(S,7);else S.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?ti(S,7):$l(S):rt[0]!="noop"&&S.l&&S.l.qa(rt),S.A=0)}}Ur(4)}catch{}}var Bt=class{constructor(f,x){this.g=f,this.map=x}};function Nl(f){this.l=f||10,c.PerformanceNavigationTiming?(f=c.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Pl(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Kr(f){return f.h?1:f.g?f.g.size:0}function Wr(f,x){return f.h?f.h==x:f.g?f.g.has(x):!1}function Ll(f,x){f.g?f.g.add(x):f.h=x}function Vl(f,x){f.h&&f.h==x?f.h=null:f.g&&f.g.has(x)&&f.g.delete(x)}Nl.prototype.cancel=function(){if(this.i=zl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function zl(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let x=f.i;for(const S of f.g.values())x=x.concat(S.G);return x}return w(f.i)}var Ou=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function no(f,x){if(f){f=f.split("&");for(let S=0;S<f.length;S++){const V=f[S].indexOf("=");let ne,de=null;V>=0?(ne=f[S].substring(0,V),de=f[S].substring(V+1)):ne=f[S],x(ne,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function Qn(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;f instanceof Qn?(this.l=f.l,on(this,f.j),this.o=f.o,this.g=f.g,Zi(this,f.u),this.h=f.h,Ul(this,Pu(f.i)),this.m=f.m):f&&(x=String(f).match(Ou))?(this.l=!1,on(this,x[1]||"",!0),this.o=Yr(x[2]||""),this.g=Yr(x[3]||"",!0),Zi(this,x[4]),this.h=Yr(x[5]||"",!0),Ul(this,x[6]||"",!0),this.m=Yr(x[7]||"")):(this.l=!1,this.i=new ts(null,this.l))}Qn.prototype.toString=function(){const f=[];var x=this.j;x&&f.push(la(x,ro,!0),":");var S=this.g;return(S||x=="file")&&(f.push("//"),(x=this.o)&&f.push(la(x,ro,!0),"@"),f.push(_i(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&f.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&f.push("/"),f.push(la(S,S.charAt(0)=="/"?Bl:Mu,!0))),(S=this.i.toString())&&f.push("?",S),(S=this.m)&&f.push("#",la(S,ku)),f.join("")},Qn.prototype.resolve=function(f){const x=Ft(this);let S=!!f.j;S?on(x,f.j):S=!!f.o,S?x.o=f.o:S=!!f.g,S?x.g=f.g:S=f.u!=null;var V=f.h;if(S)Zi(x,f.u);else if(S=!!f.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var ne=x.h.lastIndexOf("/");ne!=-1&&(V=x.h.slice(0,ne+1)+V)}if(ne=V,ne==".."||ne==".")V="";else if(ne.indexOf("./")!=-1||ne.indexOf("/.")!=-1){V=ne.lastIndexOf("/",0)==0,ne=ne.split("/");const de=[];for(let we=0;we<ne.length;){const Be=ne[we++];Be=="."?V&&we==ne.length&&de.push(""):Be==".."?((de.length>1||de.length==1&&de[0]!="")&&de.pop(),V&&we==ne.length&&de.push("")):(de.push(Be),V=!0)}V=de.join("/")}else V=ne}return S?x.h=V:S=f.i.toString()!=="",S?Ul(x,Pu(f.i)):S=!!f.m,S&&(x.m=f.m),x};function Ft(f){return new Qn(f)}function on(f,x,S){f.j=S?Yr(x,!0):x,f.j&&(f.j=f.j.replace(/:$/,""))}function Zi(f,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);f.u=x}else f.u=null}function Ul(f,x,S){x instanceof ts?(f.i=x,so(f.i,f.l)):(S||(x=la(x,es)),f.i=new ts(x,f.l))}function ot(f,x,S){f.i.set(x,S)}function oa(f){return ot(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function Yr(f,x){return f?x?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function la(f,x,S){return typeof f=="string"?(f=encodeURI(f).replace(x,Mn),S&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Mn(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var ro=/[#\/\?@]/g,Mu=/[#\?:]/g,Bl=/[#\?]/g,es=/[#\?@]/g,ku=/#/g;function ts(f,x){this.h=this.g=null,this.i=f||null,this.j=!!x}function kn(f){f.g||(f.g=new Map,f.h=0,f.i&&no(f.i,function(x,S){f.add(decodeURIComponent(x.replace(/\+/g," ")),S)}))}t=ts.prototype,t.add=function(f,x){kn(this),this.i=null,f=ns(this,f);let S=this.g.get(f);return S||this.g.set(f,S=[]),S.push(x),this.h+=1,this};function Nu(f,x){kn(f),x=ns(f,x),f.g.has(x)&&(f.i=null,f.h-=f.g.get(x).length,f.g.delete(x))}function Fl(f,x){return kn(f),x=ns(f,x),f.g.has(x)}t.forEach=function(f,x){kn(this),this.g.forEach(function(S,V){S.forEach(function(ne){f.call(x,ne,V,this)},this)},this)};function ql(f,x){kn(f);let S=[];if(typeof x=="string")Fl(f,x)&&(S=S.concat(f.g.get(ns(f,x))));else for(f=Array.from(f.g.values()),x=0;x<f.length;x++)S=S.concat(f[x]);return S}t.set=function(f,x){return kn(this),this.i=null,f=ns(this,f),Fl(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[x]),this.h+=1,this},t.get=function(f,x){return f?(f=ql(this,f),f.length>0?String(f[0]):x):x};function io(f,x,S){Nu(f,x),S.length>0&&(f.i=null,f.g.set(ns(f,x),w(S)),f.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],x=Array.from(this.g.keys());for(let V=0;V<x.length;V++){var S=x[V];const ne=_i(S);S=ql(this,S);for(let de=0;de<S.length;de++){let we=ne;S[de]!==""&&(we+="="+_i(S[de])),f.push(we)}}return this.i=f.join("&")};function Pu(f){const x=new ts;return x.i=f.i,f.g&&(x.g=new Map(f.g),x.h=f.h),x}function ns(f,x){return x=String(x),f.j&&(x=x.toLowerCase()),x}function so(f,x){x&&!f.j&&(kn(f),f.i=null,f.g.forEach(function(S,V){const ne=V.toLowerCase();V!=ne&&(Nu(this,V),io(this,ne,S))},f)),f.j=x}function Cr(f,x){const S=new wr;if(c.Image){const V=new Image;V.onload=_(or,S,"TestLoadImage: loaded",!0,x,V),V.onerror=_(or,S,"TestLoadImage: error",!1,x,V),V.onabort=_(or,S,"TestLoadImage: abort",!1,x,V),V.ontimeout=_(or,S,"TestLoadImage: timeout",!1,x,V),c.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=f}else x(!1)}function Hl(f,x){const S=new wr,V=new AbortController,ne=setTimeout(()=>{V.abort(),or(S,"TestPingServer: timeout",!1,x)},1e4);fetch(f,{signal:V.signal}).then(de=>{clearTimeout(ne),de.ok?or(S,"TestPingServer: ok",!0,x):or(S,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(ne),or(S,"TestPingServer: error",!1,x)})}function or(f,x,S,V,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),V(S)}catch{}}function rs(){this.g=new Su}function Xr(f){this.i=f.Sb||null,this.h=f.ab||!1}v(Xr,wu),Xr.prototype.g=function(){return new ca(this.i,this.h)};function ca(f,x){At.call(this),this.H=f,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(ca,At),t=ca.prototype,t.open=function(f,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=x,this.readyState=1,Rr(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(x.body=f),(this.H||c).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,is(this)),this.readyState=0},t.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Rr(this)),this.g&&(this.readyState=3,Rr(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ao(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function ao(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}t.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var x=f.value?f.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!f.done}))&&(this.response=this.responseText+=x)}f.done?is(this):Rr(this),this.readyState==3&&ao(this)}},t.Oa=function(f){this.g&&(this.response=this.responseText=f,is(this))},t.Na=function(f){this.g&&(this.response=f,is(this))},t.ga=function(){this.g&&is(this)};function is(f){f.readyState=4,f.l=null,f.j=null,f.B=null,Rr(f)}t.setRequestHeader=function(f,x){this.A.append(f,x)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],x=this.h.entries();for(var S=x.next();!S.done;)S=S.value,f.push(S[0]+": "+S[1]),S=x.next();return f.join(`\r
`)};function Rr(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function lr(f){let x="";return oe(f,function(S,V){x+=V,x+=":",x+=S,x+=`\r
`}),x}function ua(f,x,S){e:{for(V in S){var V=!1;break e}V=!0}V||(S=lr(S),typeof f=="string"?S!=null&&_i(S):ot(f,x,S))}function ut(f){At.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ut,At);var Jr=/^https?$/i,Gl=["POST","PUT"];t=ut.prototype,t.Fa=function(f){this.H=f},t.ea=function(f,x,S,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);x=x?x.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():kl.g(),this.g.onreadystatechange=b(g(this.Ca,this));try{this.B=!0,this.g.open(x,String(f),!0),this.B=!1}catch(de){da(this,de);return}if(f=S||"",S=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var ne in V)S.set(ne,V[ne]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const de of V.keys())S.set(de,V.get(de));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(S.keys()).find(de=>de.toLowerCase()=="content-type"),ne=c.FormData&&f instanceof c.FormData,!(Array.prototype.indexOf.call(Gl,x,void 0)>=0)||V||ne||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[de,we]of S)this.g.setRequestHeader(de,we);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(de){da(this,de)}};function da(f,x){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=x,f.o=5,Ql(f),vi(f)}function Ql(f){f.A||(f.A=!0,jt(f,"complete"),jt(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,jt(this,"complete"),jt(this,"abort"),vi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vi(this,!0)),ut.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ha(this):this.Xa())},t.Xa=function(){ha(this)};function ha(f){if(f.h&&typeof l<"u"){if(f.v&&Dr(f)==4)setTimeout(f.Ca.bind(f),0);else if(jt(f,"readystatechange"),Dr(f)==4){f.h=!1;try{const de=f.ca();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var S;if(!(S=x)){var V;if(V=de===0){let we=String(f.D).match(Ou)[1]||null;!we&&c.self&&c.self.location&&(we=c.self.location.protocol.slice(0,-1)),V=!Jr.test(we?we.toLowerCase():"")}S=V}if(S)jt(f,"complete"),jt(f,"success");else{f.o=6;try{var ne=Dr(f)>2?f.g.statusText:""}catch{ne=""}f.l=ne+" ["+f.ca()+"]",Ql(f)}}finally{vi(f)}}}}function vi(f,x){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const S=f.g;f.g=null,x||jt(f,"ready");try{S.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Dr(f){return f.g?f.g.readyState:0}t.ca=function(){try{return Dr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(f){if(this.g){var x=this.g.responseText;return f&&x.indexOf(f)==0&&(x=x.substring(f.length)),xf(x)}};function fn(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function bi(f){const x={};f=(f.g&&Dr(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<f.length;V++){if(I(f[V]))continue;var S=Du(f[V]);const ne=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const de=x[ne]||[];x[ne]=de,de.push(S)}ue(x,function(V){return V.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zr(f,x,S){return S&&S.internalChannelParams&&S.internalChannelParams[f]||x}function ss(f){this.za=0,this.i=[],this.j=new wr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Zr("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Zr("baseRetryDelayMs",5e3,f),this.Za=Zr("retryDelaySeedMs",1e4,f),this.Ta=Zr("forwardChannelMaxRetries",2,f),this.va=Zr("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new Nl(f&&f.concurrentRequestLimit),this.Ba=new rs,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ss.prototype,t.ka=8,t.I=1,t.connect=function(f,x,S,V){zt(0),this.W=f,this.H=x||{},S&&V!==void 0&&(this.H.OSID=S,this.H.OAID=V),this.F=this.X,this.J=qu(this,null,this.W),ei(this)};function $l(f){if(oo(f),f.I==3){var x=f.V++,S=Ft(f.J);if(ot(S,"SID",f.M),ot(S,"RID",x),ot(S,"TYPE","terminate"),fa(f,S),x=new Tr(f,f.j,x),x.M=2,x.A=oa(Ft(S)),S=!1,c.navigator&&c.navigator.sendBeacon)try{S=c.navigator.sendBeacon(x.A.toString(),"")}catch{}!S&&c.Image&&(new Image().src=x.A,S=!0),S||(x.g=Hu(x.j,null),x.g.ea(x.A)),x.F=Date.now(),Gr(x)}Fu(f)}function as(f){f.g&&(Wl(f),f.g.cancel(),f.g=null)}function oo(f){as(f),f.v&&(c.clearTimeout(f.v),f.v=null),co(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&c.clearTimeout(f.m),f.m=null)}function ei(f){if(!Pl(f.h)&&!f.m){f.m=!0;var x=f.Ea;$||R(),re||($(),re=!0),P.add(x,f),f.D=0}}function lo(f,x){return Kr(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=x.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=Fr(g(f.Ea,f,x),Bu(f,f.D)),f.D++,!0)}t.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const ne=new Tr(this,this.j,f);let de=this.o;if(this.U&&(de?(de=U(de),W(de,this.U)):de=this.U),this.u!==null||this.R||(ne.J=de,de=null),this.S)e:{for(var x=0,S=0;S<this.i.length;S++){t:{var V=this.i[S];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(x+=V,x>4096){x=S;break e}if(x===4096||S===this.i.length-1){x=S+1;break e}}x=1e3}else x=1e3;x=Lu(this,ne,x),S=Ft(this.J),ot(S,"RID",f),ot(S,"CVER",22),this.G&&ot(S,"X-HTTP-Session-Id",this.G),fa(this,S),de&&(this.R?x="headers="+_i(lr(de))+"&"+x:this.u&&ua(S,this.u,de)),Ll(this.h,ne),this.Ra&&ot(S,"TYPE","init"),this.S?(ot(S,"$req",x),ot(S,"SID","null"),ne.U=!0,Hr(ne,S,null)):Hr(ne,S,x),this.I=2}}else this.I==3&&(f?Kl(this,f):this.i.length==0||Pl(this.h)||Kl(this))};function Kl(f,x){var S;x?S=x.l:S=f.V++;const V=Ft(f.J);ot(V,"SID",f.M),ot(V,"RID",S),ot(V,"AID",f.K),fa(f,V),f.u&&f.o&&ua(V,f.u,f.o),S=new Tr(f,f.j,S,f.D+1),f.u===null&&(S.J=f.o),x&&(f.i=x.G.concat(f.i)),x=Lu(f,S,1e3),S.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),Ll(f.h,S),Hr(S,V,x)}function fa(f,x){f.H&&oe(f.H,function(S,V){ot(x,V,S)}),f.l&&oe({},function(S,V){ot(x,V,S)})}function Lu(f,x,S){S=Math.min(f.i.length,S);const V=f.l?g(f.l.Ka,f.l,f):null;e:{var ne=f.i;let Be=-1;for(;;){const Mt=["count="+S];Be==-1?S>0?(Be=ne[0].g,Mt.push("ofs="+Be)):Be=0:Mt.push("ofs="+Be);let rt=!0;for(let xt=0;xt<S;xt++){var de=ne[xt].g;const cr=ne[xt].map;if(de-=Be,de<0)Be=Math.max(0,ne[xt].g-100),rt=!1;else try{de="req"+de+"_"||"";try{var we=cr instanceof Map?cr:Object.entries(cr);for(const[ni,Ir]of we){let jr=Ir;h(Ir)&&(jr=Ji(Ir)),Mt.push(de+ni+"="+encodeURIComponent(jr))}}catch(ni){throw Mt.push(de+"type="+encodeURIComponent("_badmap")),ni}}catch{V&&V(cr)}}if(rt){we=Mt.join("&");break e}}we=void 0}return f=f.i.splice(0,S),x.G=f,we}function Vu(f){if(!f.g&&!f.v){f.Y=1;var x=f.Da;$||R(),re||($(),re=!0),P.add(x,f),f.A=0}}function ma(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=Fr(g(f.Da,f),Bu(f,f.A)),f.A++,!0)}t.Da=function(){if(this.v=null,zu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=Fr(g(this.Wa,this),f)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,zt(10),as(this),zu(this))};function Wl(f){f.B!=null&&(c.clearTimeout(f.B),f.B=null)}function zu(f){f.g=new Tr(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var x=Ft(f.na);ot(x,"RID","rpc"),ot(x,"SID",f.M),ot(x,"AID",f.K),ot(x,"CI",f.F?"0":"1"),!f.F&&f.ia&&ot(x,"TO",f.ia),ot(x,"TYPE","xmlhttp"),fa(f,x),f.u&&f.o&&ua(x,f.u,f.o),f.O&&(f.g.H=f.O);var S=f.g;f=f.ba,S.M=1,S.A=oa(Ft(x)),S.u=null,S.R=!0,eo(S,f)}t.Va=function(){this.C!=null&&(this.C=null,as(this),ma(this),zt(19))};function co(f){f.C!=null&&(c.clearTimeout(f.C),f.C=null)}function Uu(f,x){var S=null;if(f.g==x){co(f),Wl(f),f.g=null;var V=2}else if(Wr(f.h,x))S=x.G,Vl(f.h,x),V=1;else return;if(f.I!=0){if(x.o)if(V==1){S=x.u?x.u.length:0,x=Date.now()-x.F;var ne=f.D;V=Za(),jt(V,new Br(V,S)),ei(f)}else Vu(f);else if(ne=x.m,ne==3||ne==0&&x.X>0||!(V==1&&lo(f,x)||V==2&&ma(f)))switch(S&&S.length>0&&(x=f.h,x.i=x.i.concat(S)),ne){case 1:ti(f,5);break;case 4:ti(f,10);break;case 3:ti(f,6);break;default:ti(f,2)}}}function Bu(f,x){let S=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(S*=2),S*x}function ti(f,x){if(f.j.info("Error code "+x),x==2){var S=g(f.bb,f),V=f.Ua;const ne=!V;V=new Qn(V||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||on(V,"https"),oa(V),ne?Cr(V.toString(),S):Hl(V.toString(),S)}else zt(2);f.I=0,f.l&&f.l.pa(x),Fu(f),oo(f)}t.bb=function(f){f?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function Fu(f){if(f.I=0,f.ja=[],f.l){const x=zl(f.h);(x.length!=0||f.i.length!=0)&&(C(f.ja,x),C(f.ja,f.i),f.h.i.length=0,w(f.i),f.i.length=0),f.l.oa()}}function qu(f,x,S){var V=S instanceof Qn?Ft(S):new Qn(S);if(V.g!="")x&&(V.g=x+"."+V.g),Zi(V,V.u);else{var ne=c.location;V=ne.protocol,x=x?x+"."+ne.hostname:ne.hostname,ne=+ne.port;const de=new Qn(null);V&&on(de,V),x&&(de.g=x),ne&&Zi(de,ne),S&&(de.h=S),V=de}return S=f.G,x=f.wa,S&&x&&ot(V,S,x),ot(V,"VER",f.ka),fa(f,V),V}function Hu(f,x,S){if(x&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=f.Aa&&!f.ma?new ut(new Xr({ab:S})):new ut(f.ma),x.Fa(f.L),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gu(){}t=Gu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function os(){}os.prototype.g=function(f,x){return new Cn(f,x)};function Cn(f,x){At.call(this),this.g=new ss(x),this.l=f,this.h=x&&x.messageUrlParams||null,f=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(f?f["X-WebChannel-Content-Type"]=x.messageContentType:f={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(f?f["X-WebChannel-Client-Profile"]=x.sa:f={"X-WebChannel-Client-Profile":x.sa}),this.g.U=f,(f=x&&x.Qb)&&!I(f)&&(this.g.u=f),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!I(x)&&(this.g.G=x,f=this.h,f!==null&&x in f&&(f=this.h,x in f&&delete f[x])),this.j=new xi(this)}v(Cn,At),Cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){$l(this.g)},Cn.prototype.o=function(f){var x=this.g;if(typeof f=="string"){var S={};S.__data__=f,f=S}else this.v&&(S={},S.__data__=Ji(f),f=S);x.i.push(new Bt(x.Ya++,f)),x.I==3&&ei(x)},Cn.prototype.N=function(){this.g.l=null,delete this.j,$l(this.g),delete this.g,Cn.Z.N.call(this)};function Qu(f){hn.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var x=f.__sm__;if(x){e:{for(const S in x){f=S;break e}f=void 0}(this.i=f)&&(f=this.i,x=x!==null&&f in x?x[f]:void 0),this.data=x}else this.data=f}v(Qu,hn);function $u(){sr.call(this),this.status=1}v($u,sr);function xi(f){this.g=f}v(xi,Gu),xi.prototype.ra=function(){jt(this.g,"a")},xi.prototype.qa=function(f){jt(this.g,new Qu(f))},xi.prototype.pa=function(f){jt(this.g,new $u)},xi.prototype.oa=function(){jt(this.g,"b")},os.prototype.createWebChannel=os.prototype.g,Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,HS=function(){return new os},qS=function(){return Za()},FS=Ot,sg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},sa.NO_ERROR=0,sa.TIMEOUT=8,sa.HTTP_ERROR=6,oh=sa,Ml.COMPLETE="complete",BS=Ml,Tu.EventType=Sr,Sr.OPEN="a",Sr.CLOSE="b",Sr.ERROR="c",Sr.MESSAGE="d",At.prototype.listen=At.prototype.J,Lc=Tu,ut.prototype.listenOnce=ut.prototype.K,ut.prototype.getLastError=ut.prototype.Ha,ut.prototype.getLastErrorCode=ut.prototype.ya,ut.prototype.getStatus=ut.prototype.ca,ut.prototype.getResponseJson=ut.prototype.La,ut.prototype.getResponseText=ut.prototype.la,ut.prototype.send=ut.prototype.ea,ut.prototype.setWithCredentials=ut.prototype.Fa,US=ut}).apply(typeof Zd<"u"?Zd:typeof self<"u"?self:typeof window<"u"?window:{});const rx="@firebase/firestore",ix="4.9.3";class Sn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sn.UNAUTHENTICATED=new Sn(null),Sn.GOOGLE_CREDENTIALS=new Sn("google-credentials-uid"),Sn.FIRST_PARTY=new Sn("first-party-uid"),Sn.MOCK_USER=new Sn("mock-user");let Sl="12.7.0";const Ua=new Hg("@firebase/firestore");function Qo(){return Ua.logLevel}function Ae(t,...e){if(Ua.logLevel<=We.DEBUG){const n=e.map($g);Ua.debug(`Firestore (${Sl}): ${t}`,...n)}}function Hi(t,...e){if(Ua.logLevel<=We.ERROR){const n=e.map($g);Ua.error(`Firestore (${Sl}): ${t}`,...n)}}function il(t,...e){if(Ua.logLevel<=We.WARN){const n=e.map($g);Ua.warn(`Firestore (${Sl}): ${t}`,...n)}}function $g(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Ne(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,GS(t,i,n)}function GS(t,e,n){let i=`FIRESTORE (${Sl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Hi(i),new Error(i)}function at(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||GS(e,a,i)}function Ue(t,e){return t}const ve={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends Ki{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Bi{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class QS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class q2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Sn.UNAUTHENTICATED)))}shutdown(){}}class H2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class G2{constructor(e){this.t=e,this.currentUser=Sn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){at(this.o===void 0,42304);let i=this.i;const a=m=>this.i!==i?(i=this.i,n(m)):Promise.resolve();let l=new Bi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Bi,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},h=m=>{Ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((m=>h(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?h(m):(Ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Bi)}}),0),c()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(Ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(at(typeof i.accessToken=="string",31837,{l:i}),new QS(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return at(e===null||typeof e=="string",2055,{h:e}),new Sn(e)}}class Q2{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=Sn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class $2{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new Q2(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Sn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class sx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class K2{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){at(this.o===void 0,3512);const i=l=>{l.error!=null&&Ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Ae("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{Ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new sx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(at(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new sx(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function W2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class Kg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=W2(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function Ye(t,e){return t<e?-1:t>e?1:0}function ag(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return Op(a)===Op(l)?Ye(a,l):Op(a)?1:-1}return Ye(t.length,e.length)}const Y2=55296,X2=57343;function Op(t){const e=t.charCodeAt(0);return e>=Y2&&e<=X2}function sl(t,e,n){return t.length===e.length&&t.every(((i,a)=>n(i,e[a])))}const ax="__name__";class oi{constructor(e,n,i){n===void 0?n=0:n>e.length&&Ne(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Ne(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return oi.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof oi?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=oi.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return Ye(e.length,n.length)}static compareSegments(e,n){const i=oi.isNumericId(e),a=oi.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?oi.extractNumericId(e).compare(oi.extractNumericId(n)):ag(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fs.fromString(e.substring(4,e.length-2))}}class yt extends oi{construct(e,n,i){return new yt(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new Te(ve.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((a=>a.length>0)))}return new yt(n)}static emptyPath(){return new yt([])}}const J2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class vn extends oi{construct(e,n,i){return new vn(e,n,i)}static isValidIdentifier(e){return J2.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),vn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ax}static keyField(){return new vn([ax])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new Te(ve.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let c=!1;for(;a<e.length;){const h=e[a];if(h==="\\"){if(a+1===e.length)throw new Te(ve.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Te(ve.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=m,a+=2}else h==="`"?(c=!c,a++):h!=="."||c?(i+=h,a++):(l(),a++)}if(l(),c)throw new Te(ve.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new vn(n)}static emptyPath(){return new vn([])}}class je{constructor(e){this.path=e}static fromPath(e){return new je(yt.fromString(e))}static fromName(e){return new je(yt.fromString(e).popFirst(5))}static empty(){return new je(yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return yt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new je(new yt(e.slice()))}}function $S(t,e,n){if(!n)throw new Te(ve.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Z2(t,e,n,i){if(e===!0&&i===!0)throw new Te(ve.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ox(t){if(!je.isDocumentKey(t))throw new Te(ve.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function lx(t){if(je.isDocumentKey(t))throw new Te(ve.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function KS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Kh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ne(12329,{type:typeof t})}function pi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Te(ve.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Kh(t);throw new Te(ve.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Xt(t,e){const n={typeString:t};return e&&(n.value=e),n}function uu(t,e){if(!KS(t))throw new Te(ve.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const c=t[i];if(a&&typeof c!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new Te(ve.INVALID_ARGUMENT,n);return!0}const cx=-62135596800,ux=1e6;class bt{static now(){return bt.fromMillis(Date.now())}static fromDate(e){return bt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*ux);return new bt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Te(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Te(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<cx)throw new Te(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ux}_compareTo(e){return this.seconds===e.seconds?Ye(this.nanoseconds,e.nanoseconds):Ye(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(uu(e,bt._jsonSchema))return new bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-cx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}bt._jsonSchemaVersion="firestore/timestamp/1.0",bt._jsonSchema={type:Xt("string",bt._jsonSchemaVersion),seconds:Xt("number"),nanoseconds:Xt("number")};class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new bt(0,0))}static max(){return new Ve(new bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Yc=-1;function e5(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Ve.fromTimestamp(i===1e9?new bt(n+1,0):new bt(n,i));return new Qs(a,je.empty(),e)}function t5(t){return new Qs(t.readTime,t.key,Yc)}class Qs{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Qs(Ve.min(),je.empty(),Yc)}static max(){return new Qs(Ve.max(),je.empty(),Yc)}}function n5(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=je.comparator(t.documentKey,e.documentKey),n!==0?n:Ye(t.largestBatchId,e.largestBatchId))}const r5="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class i5{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function wl(t){if(t.code!==ve.FAILED_PRECONDITION||t.message!==r5)throw t;Ae("LocalStore","Unexpectedly lost primary lease")}class be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new be(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof be?n:be.resolve(n)}catch(n){return be.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):be.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):be.reject(n)}static resolve(e){return new be(((n,i)=>{n(e)}))}static reject(e){return new be(((n,i)=>{i(e)}))}static waitFor(e){return new be(((n,i)=>{let a=0,l=0,c=!1;e.forEach((h=>{++a,h.next((()=>{++l,c&&l===a&&n()}),(m=>i(m)))})),c=!0,l===a&&n()}))}static or(e){let n=be.resolve(!1);for(const i of e)n=n.next((a=>a?be.resolve(a):i()));return n}static forEach(e,n){const i=[];return e.forEach(((a,l)=>{i.push(n.call(this,a,l))})),this.waitFor(i)}static mapArray(e,n){return new be(((i,a)=>{const l=e.length,c=new Array(l);let h=0;for(let m=0;m<l;m++){const g=m;n(e[g]).next((_=>{c[g]=_,++h,h===l&&i(c)}),(_=>a(_)))}}))}static doWhile(e,n){return new be(((i,a)=>{const l=()=>{e()===!0?n().next((()=>{l()}),a):i()};l()}))}}function s5(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Tl(t){return t.name==="IndexedDbTransactionError"}class Wh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Wh.ce=-1;const Wg=-1;function Yh(t){return t==null}function Sh(t){return t===0&&1/t==-1/0}function a5(t){return typeof t=="number"&&Number.isInteger(t)&&!Sh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const WS="";function o5(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=dx(e)),e=l5(t.get(n),e);return dx(e)}function l5(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case WS:n+="";break;default:n+=l}}return n}function dx(t){return t+WS+""}function hx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function YS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Tt{constructor(e,n){this.comparator=e,this.root=n||_n.EMPTY}insert(e,n){return new Tt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new Tt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new eh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new eh(this.root,e,this.comparator,!1)}getReverseIterator(){return new eh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new eh(this.root,e,this.comparator,!0)}}class eh{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _n{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??_n.RED,this.left=a??_n.EMPTY,this.right=l??_n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new _n(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return _n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return _n.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ne(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ne(27949);return e+(this.isRed()?0:1)}}_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw Ne(57766)}get value(){throw Ne(16141)}get color(){throw Ne(16727)}get left(){throw Ne(29726)}get right(){throw Ne(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new _n(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class rn{constructor(e){this.comparator=e,this.data=new Tt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new fx(this.data.getIterator())}getIteratorFrom(e){return new fx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof rn)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new rn(this.comparator);return n.data=e,n}}class fx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class er{constructor(e){this.fields=e,e.sort(vn.comparator)}static empty(){return new er([])}unionWith(e){let n=new rn(vn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new er(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return sl(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class XS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class bn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new XS("Invalid base64 string: "+l):l}})(e);return new bn(n)}static fromUint8Array(e){const n=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new bn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ye(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}bn.EMPTY_BYTE_STRING=new bn("");const c5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $s(t){if(at(!!t,39018),typeof t=="string"){let e=0;const n=c5.exec(t);if(at(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Pt(t.seconds),nanos:Pt(t.nanos)}}function Pt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ks(t){return typeof t=="string"?bn.fromBase64String(t):bn.fromUint8Array(t)}const JS="server_timestamp",ZS="__type__",ew="__previous_value__",tw="__local_write_time__";function Yg(t){return(t?.mapValue?.fields||{})[ZS]?.stringValue===JS}function Xh(t){const e=t.mapValue.fields[ew];return Yg(e)?Xh(e):e}function Xc(t){const e=$s(t.mapValue.fields[tw].timestampValue);return new bt(e.seconds,e.nanos)}class u5{constructor(e,n,i,a,l,c,h,m,g,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=m,this.useFetchStreams=g,this.isUsingEmulator=_}}const wh="(default)";class Jc{constructor(e,n){this.projectId=e,this.database=n||wh}static empty(){return new Jc("","")}get isDefaultDatabase(){return this.database===wh}isEqual(e){return e instanceof Jc&&e.projectId===this.projectId&&e.database===this.database}}const nw="__type__",d5="__max__",th={mapValue:{}},rw="__vector__",Th="value";function Ws(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Yg(t)?4:f5(t)?9007199254740991:h5(t)?10:11:Ne(28295,{value:t})}function gi(t,e){if(t===e)return!0;const n=Ws(t);if(n!==Ws(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xc(t).isEqual(Xc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=$s(a.timestampValue),h=$s(l.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return Ks(a.bytesValue).isEqual(Ks(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return Pt(a.geoPointValue.latitude)===Pt(l.geoPointValue.latitude)&&Pt(a.geoPointValue.longitude)===Pt(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Pt(a.integerValue)===Pt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=Pt(a.doubleValue),h=Pt(l.doubleValue);return c===h?Sh(c)===Sh(h):isNaN(c)&&isNaN(h)}return!1})(t,e);case 9:return sl(t.arrayValue.values||[],e.arrayValue.values||[],gi);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},h=l.mapValue.fields||{};if(hx(c)!==hx(h))return!1;for(const m in c)if(c.hasOwnProperty(m)&&(h[m]===void 0||!gi(c[m],h[m])))return!1;return!0})(t,e);default:return Ne(52216,{left:t})}}function Zc(t,e){return(t.values||[]).find((n=>gi(n,e)))!==void 0}function al(t,e){if(t===e)return 0;const n=Ws(t),i=Ws(e);if(n!==i)return Ye(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ye(t.booleanValue,e.booleanValue);case 2:return(function(l,c){const h=Pt(l.integerValue||l.doubleValue),m=Pt(c.integerValue||c.doubleValue);return h<m?-1:h>m?1:h===m?0:isNaN(h)?isNaN(m)?0:-1:1})(t,e);case 3:return mx(t.timestampValue,e.timestampValue);case 4:return mx(Xc(t),Xc(e));case 5:return ag(t.stringValue,e.stringValue);case 6:return(function(l,c){const h=Ks(l),m=Ks(c);return h.compareTo(m)})(t.bytesValue,e.bytesValue);case 7:return(function(l,c){const h=l.split("/"),m=c.split("/");for(let g=0;g<h.length&&g<m.length;g++){const _=Ye(h[g],m[g]);if(_!==0)return _}return Ye(h.length,m.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,c){const h=Ye(Pt(l.latitude),Pt(c.latitude));return h!==0?h:Ye(Pt(l.longitude),Pt(c.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return px(t.arrayValue,e.arrayValue);case 10:return(function(l,c){const h=l.fields||{},m=c.fields||{},g=h[Th]?.arrayValue,_=m[Th]?.arrayValue,v=Ye(g?.values?.length||0,_?.values?.length||0);return v!==0?v:px(g,_)})(t.mapValue,e.mapValue);case 11:return(function(l,c){if(l===th.mapValue&&c===th.mapValue)return 0;if(l===th.mapValue)return 1;if(c===th.mapValue)return-1;const h=l.fields||{},m=Object.keys(h),g=c.fields||{},_=Object.keys(g);m.sort(),_.sort();for(let v=0;v<m.length&&v<_.length;++v){const b=ag(m[v],_[v]);if(b!==0)return b;const w=al(h[m[v]],g[_[v]]);if(w!==0)return w}return Ye(m.length,_.length)})(t.mapValue,e.mapValue);default:throw Ne(23264,{he:n})}}function mx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ye(t,e);const n=$s(t),i=$s(e),a=Ye(n.seconds,i.seconds);return a!==0?a:Ye(n.nanos,i.nanos)}function px(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=al(n[a],i[a]);if(l)return l}return Ye(n.length,i.length)}function ol(t){return og(t)}function og(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=$s(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Ks(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return je.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=og(l);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const c of i)l?l=!1:a+=",",a+=`${c}:${og(n.fields[c])}`;return a+"}"})(t.mapValue):Ne(61005,{value:t})}function lh(t){switch(Ws(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Xh(t);return e?16+lh(e):16;case 5:return 2*t.stringValue.length;case 6:return Ks(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+lh(l)),0)})(t.arrayValue);case 10:case 11:return(function(i){let a=0;return Zs(i.fields,((l,c)=>{a+=l.length+lh(c)})),a})(t.mapValue);default:throw Ne(13486,{value:t})}}function gx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function lg(t){return!!t&&"integerValue"in t}function Xg(t){return!!t&&"arrayValue"in t}function yx(t){return!!t&&"nullValue"in t}function _x(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ch(t){return!!t&&"mapValue"in t}function h5(t){return(t?.mapValue?.fields||{})[nw]?.stringValue===rw}function Fc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Zs(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=Fc(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Fc(t.arrayValue.values[n]);return e}return{...t}}function f5(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===d5}class Bn{constructor(e){this.value=e}static empty(){return new Bn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!ch(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fc(n)}setAll(e){let n=vn.emptyPath(),i={},a=[];e.forEach(((c,h)=>{if(!n.isImmediateParentOf(h)){const m=this.getFieldsMap(n);this.applyChanges(m,i,a),i={},a=[],n=h.popLast()}c?i[h.lastSegment()]=Fc(c):a.push(h.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());ch(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return gi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];ch(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){Zs(n,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new Bn(Fc(this.value))}}function iw(t){const e=[];return Zs(t.fields,((n,i)=>{const a=new vn([n]);if(ch(i)){const l=iw(i.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new er(e)}class wn{constructor(e,n,i,a,l,c,h){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=c,this.documentState=h}static newInvalidDocument(e){return new wn(e,0,Ve.min(),Ve.min(),Ve.min(),Bn.empty(),0)}static newFoundDocument(e,n,i,a){return new wn(e,1,n,Ve.min(),i,a,0)}static newNoDocument(e,n){return new wn(e,2,n,Ve.min(),Ve.min(),Bn.empty(),0)}static newUnknownDocument(e,n){return new wn(e,3,n,Ve.min(),Ve.min(),Bn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Bn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Bn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ah{constructor(e,n){this.position=e,this.inclusive=n}}function vx(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],c=t.position[a];if(l.field.isKeyField()?i=je.comparator(je.fromName(c.referenceValue),n.key):i=al(c,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function bx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!gi(t.position[n],e.position[n]))return!1;return!0}class Ch{constructor(e,n="asc"){this.field=e,this.dir=n}}function m5(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class sw{}class Yt extends sw{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new g5(e,n,i):n==="array-contains"?new v5(e,i):n==="in"?new b5(e,i):n==="not-in"?new x5(e,i):n==="array-contains-any"?new E5(e,i):new Yt(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new y5(e,i):new _5(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(al(n,this.value)):n!==null&&Ws(this.value)===Ws(n)&&this.matchesComparison(al(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vr extends sw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Vr(e,n)}matches(e){return aw(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function aw(t){return t.op==="and"}function ow(t){return p5(t)&&aw(t)}function p5(t){for(const e of t.filters)if(e instanceof Vr)return!1;return!0}function cg(t){if(t instanceof Yt)return t.field.canonicalString()+t.op.toString()+ol(t.value);if(ow(t))return t.filters.map((e=>cg(e))).join(",");{const e=t.filters.map((n=>cg(n))).join(",");return`${t.op}(${e})`}}function lw(t,e){return t instanceof Yt?(function(i,a){return a instanceof Yt&&i.op===a.op&&i.field.isEqual(a.field)&&gi(i.value,a.value)})(t,e):t instanceof Vr?(function(i,a){return a instanceof Vr&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,c,h)=>l&&lw(c,a.filters[h])),!0):!1})(t,e):void Ne(19439)}function cw(t){return t instanceof Yt?(function(n){return`${n.field.canonicalString()} ${n.op} ${ol(n.value)}`})(t):t instanceof Vr?(function(n){return n.op.toString()+" {"+n.getFilters().map(cw).join(" ,")+"}"})(t):"Filter"}class g5 extends Yt{constructor(e,n,i){super(e,n,i),this.key=je.fromName(i.referenceValue)}matches(e){const n=je.comparator(e.key,this.key);return this.matchesComparison(n)}}class y5 extends Yt{constructor(e,n){super(e,"in",n),this.keys=uw("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class _5 extends Yt{constructor(e,n){super(e,"not-in",n),this.keys=uw("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function uw(t,e){return(e.arrayValue?.values||[]).map((n=>je.fromName(n.referenceValue)))}class v5 extends Yt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Xg(n)&&Zc(n.arrayValue,this.value)}}class b5 extends Yt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Zc(this.value.arrayValue,n)}}class x5 extends Yt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Zc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Zc(this.value.arrayValue,n)}}class E5 extends Yt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Xg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>Zc(this.value.arrayValue,i)))}}class S5{constructor(e,n=null,i=[],a=[],l=null,c=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=c,this.endAt=h,this.Te=null}}function xx(t,e=null,n=[],i=[],a=null,l=null,c=null){return new S5(t,e,n,i,a,l,c)}function Jg(t){const e=Ue(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>cg(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),Yh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>ol(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>ol(i))).join(",")),e.Te=n}return e.Te}function Zg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!m5(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!lw(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!bx(t.startAt,e.startAt)&&bx(t.endAt,e.endAt)}function ug(t){return je.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class du{constructor(e,n=null,i=[],a=[],l=null,c="F",h=null,m=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=c,this.startAt=h,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function w5(t,e,n,i,a,l,c,h){return new du(t,e,n,i,a,l,c,h)}function ey(t){return new du(t)}function Ex(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function dw(t){return t.collectionGroup!==null}function qc(t){const e=Ue(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new rn(vn.comparator);return c.filters.forEach((m=>{m.getFlattenedFilters().forEach((g=>{g.isInequality()&&(h=h.add(g.field))}))})),h})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Ch(l,i))})),n.has(vn.keyField().canonicalString())||e.Ie.push(new Ch(vn.keyField(),i))}return e.Ie}function li(t){const e=Ue(t);return e.Ee||(e.Ee=T5(e,qc(t))),e.Ee}function T5(t,e){if(t.limitType==="F")return xx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Ch(a.field,l)}));const n=t.endAt?new Ah(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Ah(t.startAt.position,t.startAt.inclusive):null;return xx(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function dg(t,e){const n=t.filters.concat([e]);return new du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function hg(t,e,n){return new du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Jh(t,e){return Zg(li(t),li(e))&&t.limitType===e.limitType}function hw(t){return`${Jg(li(t))}|lt:${t.limitType}`}function $o(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((a=>cw(a))).join(", ")}]`),Yh(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((a=>ol(a))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((a=>ol(a))).join(",")),`Target(${i})`})(li(t))}; limitType=${t.limitType})`}function Zh(t,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):je.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(t,e)&&(function(i,a){for(const l of qc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(i,a){return!(i.startAt&&!(function(c,h,m){const g=vx(c,h,m);return c.inclusive?g<=0:g<0})(i.startAt,qc(i),a)||i.endAt&&!(function(c,h,m){const g=vx(c,h,m);return c.inclusive?g>=0:g>0})(i.endAt,qc(i),a))})(t,e)}function A5(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function fw(t){return(e,n)=>{let i=!1;for(const a of qc(t)){const l=C5(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function C5(t,e,n){const i=t.field.isKeyField()?je.comparator(e.key,n.key):(function(l,c,h){const m=c.data.field(l),g=h.data.field(l);return m!==null&&g!==null?al(m,g):Ne(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Ne(19790,{direction:t.dir})}}class Ga{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Zs(this.inner,((n,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return YS(this.inner)}size(){return this.innerSize}}const R5=new Tt(je.comparator);function Gi(){return R5}const mw=new Tt(je.comparator);function Vc(...t){let e=mw;for(const n of t)e=e.insert(n.key,n);return e}function pw(t){let e=mw;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function ka(){return Hc()}function gw(){return Hc()}function Hc(){return new Ga((t=>t.toString()),((t,e)=>t.isEqual(e)))}const D5=new Tt(je.comparator),I5=new rn(je.comparator);function Xe(...t){let e=I5;for(const n of t)e=e.add(n);return e}const j5=new rn(Ye);function O5(){return j5}function ty(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sh(e)?"-0":e}}function yw(t){return{integerValue:""+t}}function M5(t,e){return a5(e)?yw(e):ty(t,e)}class ef{constructor(){this._=void 0}}function k5(t,e,n){return t instanceof Rh?(function(a,l){const c={fields:{[ZS]:{stringValue:JS},[tw]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Yg(l)&&(l=Xh(l)),l&&(c.fields[ew]=l),{mapValue:c}})(n,e):t instanceof ll?vw(t,e):t instanceof eu?bw(t,e):(function(a,l){const c=_w(a,l),h=Sx(c)+Sx(a.Ae);return lg(c)&&lg(a.Ae)?yw(h):ty(a.serializer,h)})(t,e)}function N5(t,e,n){return t instanceof ll?vw(t,e):t instanceof eu?bw(t,e):n}function _w(t,e){return t instanceof Dh?(function(i){return lg(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Rh extends ef{}class ll extends ef{constructor(e){super(),this.elements=e}}function vw(t,e){const n=xw(e);for(const i of t.elements)n.some((a=>gi(a,i)))||n.push(i);return{arrayValue:{values:n}}}class eu extends ef{constructor(e){super(),this.elements=e}}function bw(t,e){let n=xw(e);for(const i of t.elements)n=n.filter((a=>!gi(a,i)));return{arrayValue:{values:n}}}class Dh extends ef{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Sx(t){return Pt(t.integerValue||t.doubleValue)}function xw(t){return Xg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class P5{constructor(e,n){this.field=e,this.transform=n}}function L5(t,e){return t.field.isEqual(e.field)&&(function(i,a){return i instanceof ll&&a instanceof ll||i instanceof eu&&a instanceof eu?sl(i.elements,a.elements,gi):i instanceof Dh&&a instanceof Dh?gi(i.Ae,a.Ae):i instanceof Rh&&a instanceof Rh})(t.transform,e.transform)}class V5{constructor(e,n){this.version=e,this.transformResults=n}}class Lr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Lr}static exists(e){return new Lr(void 0,e)}static updateTime(e){return new Lr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function uh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class tf{}function Ew(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ny(t.key,Lr.none()):new hu(t.key,t.data,Lr.none());{const n=t.data,i=Bn.empty();let a=new rn(vn.comparator);for(let l of e.fields)if(!a.has(l)){let c=n.field(l);c===null&&l.length>1&&(l=l.popLast(),c=n.field(l)),c===null?i.delete(l):i.set(l,c),a=a.add(l)}return new ea(t.key,i,new er(a.toArray()),Lr.none())}}function z5(t,e,n){t instanceof hu?(function(a,l,c){const h=a.value.clone(),m=Tx(a.fieldTransforms,l,c.transformResults);h.setAll(m),l.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(t,e,n):t instanceof ea?(function(a,l,c){if(!uh(a.precondition,l))return void l.convertToUnknownDocument(c.version);const h=Tx(a.fieldTransforms,l,c.transformResults),m=l.data;m.setAll(Sw(a)),m.setAll(h),l.convertToFoundDocument(c.version,m).setHasCommittedMutations()})(t,e,n):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,n)}function Gc(t,e,n,i){return t instanceof hu?(function(l,c,h,m){if(!uh(l.precondition,c))return h;const g=l.value.clone(),_=Ax(l.fieldTransforms,m,c);return g.setAll(_),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),null})(t,e,n,i):t instanceof ea?(function(l,c,h,m){if(!uh(l.precondition,c))return h;const g=Ax(l.fieldTransforms,m,c),_=c.data;return _.setAll(Sw(l)),_.setAll(g),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),h===null?null:h.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,n,i):(function(l,c,h){return uh(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(t,e,n)}function U5(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=_w(i.transform,a||null);l!=null&&(n===null&&(n=Bn.empty()),n.set(i.field,l))}return n||null}function wx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&sl(i,a,((l,c)=>L5(l,c)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class hu extends tf{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ea extends tf{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function Sw(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Tx(t,e,n){const i=new Map;at(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],c=l.transform,h=e.data.field(l.field);i.set(l.field,N5(c,h,n[a]))}return i}function Ax(t,e,n){const i=new Map;for(const a of t){const l=a.transform,c=n.data.field(a.field);i.set(a.field,k5(l,c,e))}return i}class ny extends tf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class B5 extends tf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class F5{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&z5(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=Gc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=Gc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=gw();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let h=this.applyToLocalView(c,l.mutatedFields);h=n.has(a.key)?null:h;const m=Ew(c,h);m!==null&&i.set(a.key,m),c.isValidDocument()||c.convertToNoDocument(Ve.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Xe())}isEqual(e){return this.batchId===e.batchId&&sl(this.mutations,e.mutations,((n,i)=>wx(n,i)))&&sl(this.baseMutations,e.baseMutations,((n,i)=>wx(n,i)))}}class ry{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){at(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return D5})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,i[c].version);return new ry(e,n,i,a)}}class q5{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class H5{constructor(e,n){this.count=e,this.unchangedNames=n}}var Kt,Ze;function G5(t){switch(t){case ve.OK:return Ne(64938);case ve.CANCELLED:case ve.UNKNOWN:case ve.DEADLINE_EXCEEDED:case ve.RESOURCE_EXHAUSTED:case ve.INTERNAL:case ve.UNAVAILABLE:case ve.UNAUTHENTICATED:return!1;case ve.INVALID_ARGUMENT:case ve.NOT_FOUND:case ve.ALREADY_EXISTS:case ve.PERMISSION_DENIED:case ve.FAILED_PRECONDITION:case ve.ABORTED:case ve.OUT_OF_RANGE:case ve.UNIMPLEMENTED:case ve.DATA_LOSS:return!0;default:return Ne(15467,{code:t})}}function ww(t){if(t===void 0)return Hi("GRPC error has no .code"),ve.UNKNOWN;switch(t){case Kt.OK:return ve.OK;case Kt.CANCELLED:return ve.CANCELLED;case Kt.UNKNOWN:return ve.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return ve.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return ve.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return ve.INTERNAL;case Kt.UNAVAILABLE:return ve.UNAVAILABLE;case Kt.UNAUTHENTICATED:return ve.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return ve.INVALID_ARGUMENT;case Kt.NOT_FOUND:return ve.NOT_FOUND;case Kt.ALREADY_EXISTS:return ve.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return ve.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return ve.FAILED_PRECONDITION;case Kt.ABORTED:return ve.ABORTED;case Kt.OUT_OF_RANGE:return ve.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return ve.UNIMPLEMENTED;case Kt.DATA_LOSS:return ve.DATA_LOSS;default:return Ne(39323,{code:t})}}(Ze=Kt||(Kt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";function Q5(){return new TextEncoder}const $5=new Fs([4294967295,4294967295],0);function Cx(t){const e=Q5().encode(t),n=new zS;return n.update(e),new Uint8Array(n.digest())}function Rx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Fs([n,i],0),new Fs([a,l],0)]}class iy{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new zc(`Invalid padding: ${n}`);if(i<0)throw new zc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new zc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new zc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Fs.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(Fs.fromNumber(i)));return a.compare($5)===1&&(a=new Fs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Cx(e),[i,a]=Rx(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);if(!this.we(c))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new iy(l,a,n);return i.forEach((h=>c.insert(h))),c}insert(e){if(this.ge===0)return;const n=Cx(e),[i,a]=Rx(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);this.Se(c)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class zc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class nf{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,fu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new nf(Ve.min(),a,new Tt(Ye),Gi(),Xe())}}class fu{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new fu(i,n,Xe(),Xe(),Xe())}}class dh{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class Tw{constructor(e,n){this.targetId=e,this.Ce=n}}class Aw{constructor(e,n,i=bn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class Dx{constructor(){this.ve=0,this.Fe=Ix(),this.Me=bn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Xe(),n=Xe(),i=Xe();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:Ne(38017,{changeType:l})}})),new fu(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=Ix()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,at(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class K5{constructor(e){this.Ge=e,this.ze=new Map,this.je=Gi(),this.Je=nh(),this.He=nh(),this.Ye=new Tt(Ye)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Ne(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(ug(l))if(i===0){const c=new je(l.path);this.et(n,c,wn.newNoDocument(c,Ve.min()))}else at(i===1,20013,{expectedCount:i});else{const c=this._t(n);if(c!==i){const h=this.ut(e),m=h?this.ct(h,e,c):1;if(m!==0){this.it(n);const g=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,g)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let c,h;try{c=Ks(i).toUint8Array()}catch(m){if(m instanceof XS)return il("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{h=new iy(c,a,l)}catch(m){return il(m instanceof zc?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return h.ge===0?null:h}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach((l=>{const c=this.Ge.ht(),h=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(h)||(this.et(n,l,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((l,c)=>{const h=this.ot(c);if(h){if(l.current&&ug(h.target)){const m=new je(h.target.path);this.It(m).has(c)||this.Et(c,m)||this.et(c,m,wn.newNoDocument(m,e))}l.Be&&(n.set(c,l.ke()),l.qe())}}));let i=Xe();this.He.forEach(((l,c)=>{let h=!0;c.forEachWhile((m=>{const g=this.ot(m);return!g||g.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new nf(e,n,this.Ye,this.je,i);return this.je=Gi(),this.Je=nh(),this.He=nh(),this.Ye=new Tt(Ye),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Dx,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new rn(Ye),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new rn(Ye),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ae("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Dx),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function nh(){return new Tt(je.comparator)}function Ix(){return new Tt(je.comparator)}const W5={asc:"ASCENDING",desc:"DESCENDING"},Y5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},X5={and:"AND",or:"OR"};class J5{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function fg(t,e){return t.useProto3Json||Yh(e)?e:{value:e}}function Ih(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Cw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Z5(t,e){return Ih(t,e.toTimestamp())}function ci(t){return at(!!t,49232),Ve.fromTimestamp((function(n){const i=$s(n);return new bt(i.seconds,i.nanos)})(t))}function sy(t,e){return mg(t,e).canonicalString()}function mg(t,e){const n=(function(a){return new yt(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function Rw(t){const e=yt.fromString(t);return at(Mw(e),10190,{key:e.toString()}),e}function pg(t,e){return sy(t.databaseId,e.path)}function Mp(t,e){const n=Rw(e);if(n.get(1)!==t.databaseId.projectId)throw new Te(ve.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Te(ve.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new je(Iw(n))}function Dw(t,e){return sy(t.databaseId,e)}function ej(t){const e=Rw(t);return e.length===4?yt.emptyPath():Iw(e)}function gg(t){return new yt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Iw(t){return at(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function jx(t,e,n){return{name:pg(t,e),fields:n.value.mapValue.fields}}function tj(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Ne(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(g,_){return g.useProto3Json?(at(_===void 0||typeof _=="string",58123),bn.fromBase64String(_||"")):(at(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),bn.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&(function(g){const _=g.code===void 0?ve.UNKNOWN:ww(g.code);return new Te(_,g.message||"")})(c);n=new Aw(i,a,l,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Mp(t,i.document.name),l=ci(i.document.updateTime),c=i.document.createTime?ci(i.document.createTime):Ve.min(),h=new Bn({mapValue:{fields:i.document.fields}}),m=wn.newFoundDocument(a,l,c,h),g=i.targetIds||[],_=i.removedTargetIds||[];n=new dh(g,_,m.key,m)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Mp(t,i.document),l=i.readTime?ci(i.readTime):Ve.min(),c=wn.newNoDocument(a,l),h=i.removedTargetIds||[];n=new dh([],h,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Mp(t,i.document),l=i.removedTargetIds||[];n=new dh([],l,a,null)}else{if(!("filter"in e))return Ne(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,c=new H5(a,l),h=i.targetId;n=new Tw(h,c)}}return n}function nj(t,e){let n;if(e instanceof hu)n={update:jx(t,e.key,e.value)};else if(e instanceof ny)n={delete:pg(t,e.key)};else if(e instanceof ea)n={update:jx(t,e.key,e.data),updateMask:dj(e.fieldMask)};else{if(!(e instanceof B5))return Ne(16599,{Vt:e.type});n={verify:pg(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const h=c.transform;if(h instanceof Rh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof ll)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof eu)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Dh)return{fieldPath:c.field.canonicalString(),increment:h.Ae};throw Ne(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:Z5(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ne(27497)})(t,e.precondition)),n}function rj(t,e){return t&&t.length>0?(at(e!==void 0,14353),t.map((n=>(function(a,l){let c=a.updateTime?ci(a.updateTime):ci(l);return c.isEqual(Ve.min())&&(c=ci(l)),new V5(c,a.transformResults||[])})(n,e)))):[]}function ij(t,e){return{documents:[Dw(t,e.path)]}}function sj(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Dw(t,a);const l=(function(g){if(g.length!==0)return Ow(Vr.create(g,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const c=(function(g){if(g.length!==0)return g.map((_=>(function(b){return{field:Ko(b.field),direction:lj(b.dir)}})(_)))})(e.orderBy);c&&(n.structuredQuery.orderBy=c);const h=fg(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:n,parent:a}}function aj(t){let e=ej(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){at(i===1,65062);const _=n.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(v){const b=jw(v);return b instanceof Vr&&ow(b)?b.getFilters():[b]})(n.where));let c=[];n.orderBy&&(c=(function(v){return v.map((b=>(function(C){return new Ch(Wo(C.field),(function(j){switch(j){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(C.direction))})(b)))})(n.orderBy));let h=null;n.limit&&(h=(function(v){let b;return b=typeof v=="object"?v.value:v,Yh(b)?null:b})(n.limit));let m=null;n.startAt&&(m=(function(v){const b=!!v.before,w=v.values||[];return new Ah(w,b)})(n.startAt));let g=null;return n.endAt&&(g=(function(v){const b=!v.before,w=v.values||[];return new Ah(w,b)})(n.endAt)),w5(e,a,c,l,h,"F",m,g)}function oj(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ne(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function jw(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Wo(n.unaryFilter.field);return Yt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=Wo(n.unaryFilter.field);return Yt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Wo(n.unaryFilter.field);return Yt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Wo(n.unaryFilter.field);return Yt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ne(61313);default:return Ne(60726)}})(t):t.fieldFilter!==void 0?(function(n){return Yt.create(Wo(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ne(58110);default:return Ne(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Vr.create(n.compositeFilter.filters.map((i=>jw(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ne(1026)}})(n.compositeFilter.op))})(t):Ne(30097,{filter:t})}function lj(t){return W5[t]}function cj(t){return Y5[t]}function uj(t){return X5[t]}function Ko(t){return{fieldPath:t.canonicalString()}}function Wo(t){return vn.fromServerFormat(t.fieldPath)}function Ow(t){return t instanceof Yt?(function(n){if(n.op==="=="){if(_x(n.value))return{unaryFilter:{field:Ko(n.field),op:"IS_NAN"}};if(yx(n.value))return{unaryFilter:{field:Ko(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(_x(n.value))return{unaryFilter:{field:Ko(n.field),op:"IS_NOT_NAN"}};if(yx(n.value))return{unaryFilter:{field:Ko(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ko(n.field),op:cj(n.op),value:n.value}}})(t):t instanceof Vr?(function(n){const i=n.getFilters().map((a=>Ow(a)));return i.length===1?i[0]:{compositeFilter:{op:uj(n.op),filters:i}}})(t):Ne(54877,{filter:t})}function dj(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function Mw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Ls{constructor(e,n,i,a,l=Ve.min(),c=Ve.min(),h=bn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=m}withSequenceNumber(e){return new Ls(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ls(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ls(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ls(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class hj{constructor(e){this.yt=e}}function fj(t){const e=aj({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?hg(e,e.limit,"L"):e}class mj{constructor(){this.Cn=new pj}addToCollectionParentIndex(e,n){return this.Cn.add(n),be.resolve()}getCollectionParents(e,n){return be.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return be.resolve()}deleteFieldIndex(e,n){return be.resolve()}deleteAllFieldIndexes(e){return be.resolve()}createTargetIndexes(e,n){return be.resolve()}getDocumentsMatchingTarget(e,n){return be.resolve(null)}getIndexType(e,n){return be.resolve(0)}getFieldIndexes(e,n){return be.resolve([])}getNextCollectionGroupToUpdate(e){return be.resolve(null)}getMinOffset(e,n){return be.resolve(Qs.min())}getMinOffsetFromCollectionGroup(e,n){return be.resolve(Qs.min())}updateCollectionGroup(e,n,i){return be.resolve()}updateIndexEntries(e,n){return be.resolve()}}class pj{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new rn(yt.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new rn(yt.comparator)).toArray()}}const Ox={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kw=41943040;class Un{static withCacheSize(e){return new Un(e,Un.DEFAULT_COLLECTION_PERCENTILE,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}Un.DEFAULT_COLLECTION_PERCENTILE=10,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Un.DEFAULT=new Un(kw,Un.DEFAULT_COLLECTION_PERCENTILE,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Un.DISABLED=new Un(-1,0,0);class cl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new cl(0)}static cr(){return new cl(-1)}}const Mx="LruGarbageCollector",gj=1048576;function kx([t,e],[n,i]){const a=Ye(t,n);return a===0?Ye(e,i):a}class yj{constructor(e){this.Ir=e,this.buffer=new rn(kx),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();kx(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class _j{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ae(Mx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Tl(n)?Ae(Mx,"Ignoring IndexedDB error during garbage collection: ",n):await wl(n)}await this.Vr(3e5)}))}}class vj{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return be.resolve(Wh.ce);const i=new yj(n);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ae("LruGarbageCollector","Garbage collection skipped; disabled"),be.resolve(Ox)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ox):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,c,h,m,g;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,c=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(i=v,h=Date.now(),this.removeTargets(e,i,n)))).next((v=>(l=v,m=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(g=Date.now(),Qo()<=We.DEBUG&&Ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${a} in `+(h-c)+`ms
	Removed ${l} targets in `+(m-h)+`ms
	Removed ${v} documents in `+(g-m)+`ms
Total Duration: ${g-_}ms`),be.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:v}))))}}function bj(t,e){return new vj(t,e)}class xj{constructor(){this.changes=new Ga((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,wn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?be.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ej{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class Sj{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(i!==null&&Gc(i.mutation,a,er.empty(),bt.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,Xe()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=Xe()){const a=ka();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,i).next((l=>{let c=Vc();return l.forEach(((h,m)=>{c=c.insert(h,m.overlayedDocument)})),c}))))}getOverlayedDocuments(e,n){const i=ka();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,Xe())))}populateOverlays(e,n,i){const a=[];return i.forEach((l=>{n.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,h)=>{n.set(c,h)}))}))}computeViews(e,n,i,a){let l=Gi();const c=Hc(),h=(function(){return Hc()})();return n.forEach(((m,g)=>{const _=i.get(g.key);a.has(g.key)&&(_===void 0||_.mutation instanceof ea)?l=l.insert(g.key,g):_!==void 0?(c.set(g.key,_.mutation.getFieldMask()),Gc(_.mutation,g,_.mutation.getFieldMask(),bt.now())):c.set(g.key,er.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((g,_)=>c.set(g,_))),n.forEach(((g,_)=>h.set(g,new Ej(_,c.get(g)??null)))),h)))}recalculateAndSaveOverlays(e,n){const i=Hc();let a=new Tt(((c,h)=>c-h)),l=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((c=>{for(const h of c)h.keys().forEach((m=>{const g=n.get(m);if(g===null)return;let _=i.get(m)||er.empty();_=h.applyToLocalView(g,_),i.set(m,_);const v=(a.get(h.batchId)||Xe()).add(m);a=a.insert(h.batchId,v)}))})).next((()=>{const c=[],h=a.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),g=m.key,_=m.value,v=gw();_.forEach((b=>{if(!l.has(b)){const w=Ew(n.get(b),i.get(b));w!==null&&v.set(b,w),l=l.add(b)}})),c.push(this.documentOverlayCache.saveOverlays(e,g,v))}return be.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,a){return(function(c){return je.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):dw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):be.resolve(ka());let h=Yc,m=l;return c.next((g=>be.forEach(g,((_,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),l.get(_)?be.resolve():this.remoteDocumentCache.getEntry(e,_).next((b=>{m=m.insert(_,b)}))))).next((()=>this.populateOverlays(e,g,l))).next((()=>this.computeViews(e,m,g,Xe()))).next((_=>({batchId:h,changes:pw(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new je(n)).next((i=>{let a=Vc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let c=Vc();return this.indexManager.getCollectionParents(e,l).next((h=>be.forEach(h,(m=>{const g=(function(v,b){return new du(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,g,i,a).next((_=>{_.forEach(((v,b)=>{c=c.insert(v,b)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a)))).next((c=>{l.forEach(((m,g)=>{const _=g.getKey();c.get(_)===null&&(c=c.insert(_,wn.newInvalidDocument(_)))}));let h=Vc();return c.forEach(((m,g)=>{const _=l.get(m);_!==void 0&&Gc(_.mutation,g,er.empty(),bt.now()),Zh(n,g)&&(h=h.insert(m,g))})),h}))}}class wj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return be.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:ci(a.createTime)}})(n)),be.resolve()}getNamedQuery(e,n){return be.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:fj(a.bundledQuery),readTime:ci(a.readTime)}})(n)),be.resolve()}}class Tj{constructor(){this.overlays=new Tt(je.comparator),this.qr=new Map}getOverlay(e,n){return be.resolve(this.overlays.get(n))}getOverlays(e,n){const i=ka();return be.forEach(n,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((a,l)=>{this.St(e,n,l)})),be.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),be.resolve()}getOverlaysForCollection(e,n,i){const a=ka(),l=n.length+1,c=new je(n.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const m=h.getNext().value,g=m.getKey();if(!n.isPrefixOf(g.path))break;g.path.length===l&&m.largestBatchId>i&&a.set(m.getKey(),m)}return be.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new Tt(((g,_)=>g-_));const c=this.overlays.getIterator();for(;c.hasNext();){const g=c.getNext().value;if(g.getKey().getCollectionGroup()===n&&g.largestBatchId>i){let _=l.get(g.largestBatchId);_===null&&(_=ka(),l=l.insert(g.largestBatchId,_)),_.set(g.getKey(),g)}}const h=ka(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((g,_)=>h.set(g,_))),!(h.size()>=a)););return be.resolve(h)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const c=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new q5(n,i));let l=this.qr.get(n);l===void 0&&(l=Xe(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}class Aj{constructor(){this.sessionToken=bn.EMPTY_BYTE_STRING}getSessionToken(e){return be.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,be.resolve()}}class ay{constructor(){this.Qr=new rn(cn.$r),this.Ur=new rn(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new cn(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new cn(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new je(new yt([])),i=new cn(n,e),a=new cn(n,e+1),l=[];return this.Ur.forEachInRange([i,a],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new je(new yt([])),i=new cn(n,e),a=new cn(n,e+1);let l=Xe();return this.Ur.forEachInRange([i,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const n=new cn(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class cn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return je.comparator(e.key,n.key)||Ye(e.Yr,n.Yr)}static Kr(e,n){return Ye(e.Yr,n.Yr)||je.comparator(e.key,n.key)}}class Cj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new rn(cn.$r)}checkEmpty(e){return be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new F5(l,n,i,a);this.mutationQueue.push(c);for(const h of a)this.Zr=this.Zr.add(new cn(h.key,l)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return be.resolve(c)}lookupMutationBatch(e,n){return be.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return be.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return be.resolve(this.mutationQueue.length===0?Wg:this.tr-1)}getAllMutationBatches(e){return be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new cn(n,0),a=new cn(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(c=>{const h=this.Xr(c.Yr);l.push(h)})),be.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new rn(Ye);return n.forEach((a=>{const l=new cn(a,0),c=new cn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(h=>{i=i.add(h.Yr)}))})),be.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;je.isDocumentKey(l)||(l=l.child(""));const c=new cn(new je(l),0);let h=new rn(Ye);return this.Zr.forEachWhile((m=>{const g=m.key.path;return!!i.isPrefixOf(g)&&(g.length===a&&(h=h.add(m.Yr)),!0)}),c),be.resolve(this.ti(h))}ti(e){const n=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){at(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return be.forEach(n.mutations,(a=>{const l=new cn(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new cn(n,0),a=this.Zr.firstAfterOrEqual(i);return be.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,be.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class Rj{constructor(e){this.ri=e,this.docs=(function(){return new Tt(je.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,c=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return be.resolve(i?i.document.mutableCopy():wn.newInvalidDocument(n))}getEntries(e,n){let i=Gi();return n.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():wn.newInvalidDocument(a))})),be.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=Gi();const c=n.path,h=new je(c.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(h);for(;m.hasNext();){const{key:g,value:{document:_}}=m.getNext();if(!c.isPrefixOf(g.path))break;g.path.length>c.length+1||n5(t5(_),i)<=0||(a.has(_.key)||Zh(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return be.resolve(l)}getAllFromCollectionGroup(e,n,i,a){Ne(9500)}ii(e,n){return be.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new Dj(this)}getSize(e){return be.resolve(this.size)}}class Dj extends xj{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),be.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class Ij{constructor(e){this.persistence=e,this.si=new Ga((n=>Jg(n)),Zg),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.oi=0,this._i=new ay,this.targetCount=0,this.ai=cl.ur()}forEachTarget(e,n){return this.si.forEach(((i,a)=>n(a))),be.resolve()}getLastRemoteSnapshotVersion(e){return be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return be.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),be.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),be.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new cl(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,be.resolve()}updateTargetData(e,n){return this.Pr(n),be.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,be.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach(((c,h)=>{h.sequenceNumber<=n&&i.get(h.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,h.targetId)),a++)})),be.waitFor(l).next((()=>a))}getTargetCount(e){return be.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return be.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),be.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),be.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),be.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return be.resolve(i)}containsKey(e,n){return be.resolve(this._i.containsKey(n))}}class Nw{constructor(e,n){this.ui={},this.overlays={},this.ci=new Wh(0),this.li=!1,this.li=!0,this.hi=new Aj,this.referenceDelegate=e(this),this.Pi=new Ij(this),this.indexManager=new mj,this.remoteDocumentCache=(function(a){return new Rj(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new hj(n),this.Ii=new wj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Tj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new Cj(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){Ae("MemoryPersistence","Starting transaction:",e);const a=new jj(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,n){return be.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class jj extends i5{constructor(e){super(),this.currentSequenceNumber=e}}class oy{constructor(e){this.persistence=e,this.Ri=new ay,this.Vi=null}static mi(e){return new oy(e)}get fi(){if(this.Vi)return this.Vi;throw Ne(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),be.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),be.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),be.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return be.forEach(this.fi,(i=>{const a=je.fromPath(i);return this.gi(e,a).next((l=>{l||n.removeEntry(a,Ve.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return be.or([()=>be.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class jh{constructor(e,n){this.persistence=e,this.pi=new Ga((i=>o5(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=bj(this,n)}static mi(e,n){return new jh(e,n)}Ei(){}di(e){return be.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((a=>i+a))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return be.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?be.resolve():n(a)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(c=>this.br(e,c,n).next((h=>{h||(i++,l.removeEntry(c,Ve.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),be.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),be.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),be.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),be.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=lh(e.data.value)),n}br(e,n,i){return be.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return be.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ly{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=Xe(),a=Xe();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new ly(e,n.fromCache,i,a)}}class Oj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Mj{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return EI()?8:s5(Tn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,n,a,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new Oj;return this.Ss(e,n,c).next((h=>{if(l.result=h,this.Vs)return this.bs(e,n,c,h.size)}))})).next((()=>l.result))}bs(e,n,i,a){return i.documentReadCount<this.fs?(Qo()<=We.DEBUG&&Ae("QueryEngine","SDK will not create cache indexes for query:",$o(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),be.resolve()):(Qo()<=We.DEBUG&&Ae("QueryEngine","Query:",$o(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(Qo()<=We.DEBUG&&Ae("QueryEngine","The SDK decides to create cache indexes for query:",$o(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,li(n))):be.resolve())}ys(e,n){if(Ex(n))return be.resolve(null);let i=li(n);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=hg(n,null,"F"),i=li(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=Xe(...l);return this.ps.getDocuments(e,c).next((h=>this.indexManager.getMinOffset(e,i).next((m=>{const g=this.Ds(n,h);return this.Cs(n,g,c,m.readTime)?this.ys(e,hg(n,null,"F")):this.vs(e,g,n,m)}))))})))))}ws(e,n,i,a){return Ex(n)||a.isEqual(Ve.min())?be.resolve(null):this.ps.getDocuments(e,i).next((l=>{const c=this.Ds(n,l);return this.Cs(n,c,i,a)?be.resolve(null):(Qo()<=We.DEBUG&&Ae("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),$o(n)),this.vs(e,c,n,e5(a,Yc)).next((h=>h)))}))}Ds(e,n){let i=new rn(fw(e));return n.forEach(((a,l)=>{Zh(e,l)&&(i=i.add(l))})),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return Qo()<=We.DEBUG&&Ae("QueryEngine","Using full collection scan to execute query:",$o(n)),this.ps.getDocumentsMatchingQuery(e,n,Qs.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(n.forEach((c=>{l=l.insert(c.key,c)})),l)))}}const cy="LocalStore",kj=3e8;class Nj{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new Tt(Ye),this.xs=new Ga((l=>Jg(l)),Zg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Sj(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function Pj(t,e,n,i){return new Nj(t,e,n,i)}async function Pw(t,e){const n=Ue(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],h=[];let m=Xe();for(const g of a){c.push(g.batchId);for(const _ of g.mutations)m=m.add(_.key)}for(const g of l){h.push(g.batchId);for(const _ of g.mutations)m=m.add(_.key)}return n.localDocuments.getDocuments(i,m).next((g=>({Ls:g,removedBatchIds:c,addedBatchIds:h})))}))}))}function Lj(t,e){const n=Ue(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,m,g,_){const v=g.batch,b=v.keys();let w=be.resolve();return b.forEach((C=>{w=w.next((()=>_.getEntry(m,C))).next((T=>{const j=g.docVersions.get(C);at(j!==null,48541),T.version.compareTo(j)<0&&(v.applyToRemoteDocument(T,g),T.isValidDocument()&&(T.setReadTime(g.commitVersion),_.addEntry(T)))}))})),w.next((()=>h.mutationQueue.removeMutationBatch(m,v)))})(n,i,e,l).next((()=>l.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(h){let m=Xe();for(let g=0;g<h.mutationResults.length;++g)h.mutationResults[g].transformResults.length>0&&(m=m.add(h.batch.mutations[g].key));return m})(e)))).next((()=>n.localDocuments.getDocuments(i,a)))}))}function Lw(t){const e=Ue(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function Vj(t,e){const n=Ue(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const h=[];e.targetChanges.forEach(((_,v)=>{const b=a.get(v);if(!b)return;h.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,v))));let w=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?w=w.withResumeToken(bn.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):_.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(_.resumeToken,i)),a=a.insert(v,w),(function(T,j,B){return T.resumeToken.approximateByteSize()===0||j.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=kj?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0})(b,w,_)&&h.push(n.Pi.updateTargetData(l,w))}));let m=Gi(),g=Xe();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),h.push(zj(l,c,e.documentUpdates).next((_=>{m=_.ks,g=_.qs}))),!i.isEqual(Ve.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));h.push(_)}return be.waitFor(h).next((()=>c.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,m,g))).next((()=>m))})).then((l=>(n.Ms=a,l)))}function zj(t,e,n){let i=Xe(),a=Xe();return n.forEach((l=>i=i.add(l))),e.getEntries(t,i).next((l=>{let c=Gi();return n.forEach(((h,m)=>{const g=l.get(h);m.isFoundDocument()!==g.isFoundDocument()&&(a=a.add(h)),m.isNoDocument()&&m.version.isEqual(Ve.min())?(e.removeEntry(h,m.readTime),c=c.insert(h,m)):!g.isValidDocument()||m.version.compareTo(g.version)>0||m.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(m),c=c.insert(h,m)):Ae(cy,"Ignoring outdated watch update for ",h,". Current version:",g.version," Watch version:",m.version)})),{ks:c,qs:a}}))}function Uj(t,e){const n=Ue(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Wg),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Bj(t,e){const n=Ue(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return n.Pi.getTargetData(i,e).next((l=>l?(a=l,be.resolve(a)):n.Pi.allocateTargetId(i).next((c=>(a=new Ls(e,c,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function yg(t,e,n){const i=Ue(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!Tl(c))throw c;Ae(cy,`Failed to update sequence numbers for target ${e}: ${c}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function Nx(t,e,n){const i=Ue(t);let a=Ve.min(),l=Xe();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(m,g,_){const v=Ue(m),b=v.xs.get(_);return b!==void 0?be.resolve(v.Ms.get(b)):v.Pi.getTargetData(g,_)})(i,c,li(e)).next((h=>{if(h)return a=h.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(c,h.targetId).next((m=>{l=m}))})).next((()=>i.Fs.getDocumentsMatchingQuery(c,e,n?a:Ve.min(),n?l:Xe()))).next((h=>(Fj(i,A5(e),h),{documents:h,Qs:l})))))}function Fj(t,e,n){let i=t.Os.get(e)||Ve.min();n.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),t.Os.set(e,i)}class Px{constructor(){this.activeTargetIds=O5()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qj{constructor(){this.Mo=new Px,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Px,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Hj{Oo(e){}shutdown(){}}const Lx="ConnectivityMonitor";class Vx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ae(Lx,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ae(Lx,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let rh=null;function _g(){return rh===null?rh=(function(){return 268435456+Math.round(2147483648*Math.random())})():rh++,"0x"+rh.toString(16)}const kp="RestConnection",Gj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Qj{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===wh?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const c=_g(),h=this.zo(e,n.toUriEncodedString());Ae(kp,`Sending RPC '${e}' ${c}:`,h,i);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,a,l);const{host:g}=new URL(h),_=xl(g);return this.Jo(e,h,m,i,_).then((v=>(Ae(kp,`Received RPC '${e}' ${c}: `,v),v)),(v=>{throw il(kp,`RPC '${e}' ${c} failed with error: `,v,"url: ",h,"request:",i),v}))}Ho(e,n,i,a,l,c){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Sl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,n){const i=Gj[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class $j{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const En="WebChannelConnection";class Kj extends Qj{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const c=_g();return new Promise(((h,m)=>{const g=new US;g.setWithCredentials(!0),g.listenOnce(BS.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case oh.NO_ERROR:const v=g.getResponseJson();Ae(En,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(v)),h(v);break;case oh.TIMEOUT:Ae(En,`RPC '${e}' ${c} timed out`),m(new Te(ve.DEADLINE_EXCEEDED,"Request time out"));break;case oh.HTTP_ERROR:const b=g.getStatus();if(Ae(En,`RPC '${e}' ${c} failed with status:`,b,"response text:",g.getResponseText()),b>0){let w=g.getResponseJson();Array.isArray(w)&&(w=w[0]);const C=w?.error;if(C&&C.status&&C.message){const T=(function(B){const H=B.toLowerCase().replace(/_/g,"-");return Object.values(ve).indexOf(H)>=0?H:ve.UNKNOWN})(C.status);m(new Te(T,C.message))}else m(new Te(ve.UNKNOWN,"Server responded with status "+g.getStatus()))}else m(new Te(ve.UNAVAILABLE,"Connection failed."));break;default:Ne(9055,{l_:e,streamId:c,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Ae(En,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(a);Ae(En,`RPC '${e}' ${c} sending request:`,a),g.send(n,"POST",_,i,15)}))}T_(e,n,i){const a=_g(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=HS(),h=qS(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(m.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,n,i),m.encodeInitMessageHeaders=!0;const _=l.join("");Ae(En,`Creating RPC '${e}' stream ${a}: ${_}`,m);const v=c.createWebChannel(_,m);this.I_(v);let b=!1,w=!1;const C=new $j({Yo:j=>{w?Ae(En,`Not sending because RPC '${e}' stream ${a} is closed:`,j):(b||(Ae(En,`Opening RPC '${e}' stream ${a} transport.`),v.open(),b=!0),Ae(En,`RPC '${e}' stream ${a} sending:`,j),v.send(j))},Zo:()=>v.close()}),T=(j,B,H)=>{j.listen(B,(z=>{try{H(z)}catch(J){setTimeout((()=>{throw J}),0)}}))};return T(v,Lc.EventType.OPEN,(()=>{w||(Ae(En,`RPC '${e}' stream ${a} transport opened.`),C.o_())})),T(v,Lc.EventType.CLOSE,(()=>{w||(w=!0,Ae(En,`RPC '${e}' stream ${a} transport closed`),C.a_(),this.E_(v))})),T(v,Lc.EventType.ERROR,(j=>{w||(w=!0,il(En,`RPC '${e}' stream ${a} transport errored. Name:`,j.name,"Message:",j.message),C.a_(new Te(ve.UNAVAILABLE,"The operation could not be completed")))})),T(v,Lc.EventType.MESSAGE,(j=>{if(!w){const B=j.data[0];at(!!B,16349);const H=B,z=H?.error||H[0]?.error;if(z){Ae(En,`RPC '${e}' stream ${a} received error:`,z);const J=z.status;let $=(function(R){const D=Kt[R];if(D!==void 0)return ww(D)})(J),re=z.message;$===void 0&&($=ve.INTERNAL,re="Unknown error status: "+J+" with message "+z.message),w=!0,C.a_(new Te($,re)),v.close()}else Ae(En,`RPC '${e}' stream ${a} received:`,B),C.u_(B)}})),T(h,FS.STAT_EVENT,(j=>{j.stat===sg.PROXY?Ae(En,`RPC '${e}' stream ${a} detected buffering proxy`):j.stat===sg.NOPROXY&&Ae(En,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{C.__()}),0),C}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function Np(){return typeof document<"u"?document:null}function rf(t){return new J5(t,!0)}class Vw{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&Ae("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const zx="PersistentStream";class zw{constructor(e,n,i,a,l,c,h,m){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Vw(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===ve.RESOURCE_EXHAUSTED?(Hi(n.toString()),Hi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===ve.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===n&&this.G_(i,a)}),(i=>{e((()=>{const a=new Te(ve.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ae(zx,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Ae(zx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Wj extends zw{constructor(e,n,i,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=tj(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Ve.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Ve.min():c.readTime?ci(c.readTime):Ve.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=gg(this.serializer),n.addTarget=(function(l,c){let h;const m=c.target;if(h=ug(m)?{documents:ij(l,m)}:{query:sj(l,m).ft},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=Cw(l,c.resumeToken);const g=fg(l,c.expectedCount);g!==null&&(h.expectedCount=g)}else if(c.snapshotVersion.compareTo(Ve.min())>0){h.readTime=Ih(l,c.snapshotVersion.toTimestamp());const g=fg(l,c.expectedCount);g!==null&&(h.expectedCount=g)}return h})(this.serializer,e);const i=oj(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=gg(this.serializer),n.removeTarget=e,this.q_(n)}}class Yj extends zw{constructor(e,n,i,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return at(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,at(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){at(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=rj(e.writeResults,e.commitTime),i=ci(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=gg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>nj(this.serializer,i)))};this.q_(n)}}class Xj{}class Jj extends Xj{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Te(ve.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,mg(n,i),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Te(ve.UNKNOWN,l.toString())}))}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Ho(e,mg(n,i),a,c,h,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Te(ve.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Zj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Hi(n),this.aa=!1):Ae("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ba="RemoteStore";class eO{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{i.enqueueAndForget((async()=>{Qa(this)&&(Ae(Ba,"Restarting streams for network reachability change."),await(async function(m){const g=Ue(m);g.Ea.add(4),await mu(g),g.Ra.set("Unknown"),g.Ea.delete(4),await sf(g)})(this))}))})),this.Ra=new Zj(i,a)}}async function sf(t){if(Qa(t))for(const e of t.da)await e(!0)}async function mu(t){for(const e of t.da)await e(!1)}function Uw(t,e){const n=Ue(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),fy(n)?hy(n):Al(n).O_()&&dy(n,e))}function uy(t,e){const n=Ue(t),i=Al(n);n.Ia.delete(e),i.O_()&&Bw(n,e),n.Ia.size===0&&(i.O_()?i.L_():Qa(n)&&n.Ra.set("Unknown"))}function dy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Al(t).Y_(e)}function Bw(t,e){t.Va.Ue(e),Al(t).Z_(e)}function hy(t){t.Va=new K5({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Al(t).start(),t.Ra.ua()}function fy(t){return Qa(t)&&!Al(t).x_()&&t.Ia.size>0}function Qa(t){return Ue(t).Ea.size===0}function Fw(t){t.Va=void 0}async function tO(t){t.Ra.set("Online")}async function nO(t){t.Ia.forEach(((e,n)=>{dy(t,e)}))}async function rO(t,e){Fw(t),fy(t)?(t.Ra.ha(e),hy(t)):t.Ra.set("Unknown")}async function iO(t,e,n){if(t.Ra.set("Online"),e instanceof Aw&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const h of l.targetIds)a.Ia.has(h)&&(await a.remoteSyncer.rejectListen(h,c),a.Ia.delete(h),a.Va.removeTarget(h))})(t,e)}catch(i){Ae(Ba,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Oh(t,i)}else if(e instanceof dh?t.Va.Ze(e):e instanceof Tw?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ve.min()))try{const i=await Lw(t.localStore);n.compareTo(i)>=0&&await(function(l,c){const h=l.Va.Tt(c);return h.targetChanges.forEach(((m,g)=>{if(m.resumeToken.approximateByteSize()>0){const _=l.Ia.get(g);_&&l.Ia.set(g,_.withResumeToken(m.resumeToken,c))}})),h.targetMismatches.forEach(((m,g)=>{const _=l.Ia.get(m);if(!_)return;l.Ia.set(m,_.withResumeToken(bn.EMPTY_BYTE_STRING,_.snapshotVersion)),Bw(l,m);const v=new Ls(_.target,m,g,_.sequenceNumber);dy(l,v)})),l.remoteSyncer.applyRemoteEvent(h)})(t,n)}catch(i){Ae(Ba,"Failed to raise snapshot:",i),await Oh(t,i)}}async function Oh(t,e,n){if(!Tl(e))throw e;t.Ea.add(1),await mu(t),t.Ra.set("Offline"),n||(n=()=>Lw(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ae(Ba,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await sf(t)}))}function qw(t,e){return e().catch((n=>Oh(t,n,e)))}async function af(t){const e=Ue(t),n=Ys(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Wg;for(;sO(e);)try{const a=await Uj(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,aO(e,a)}catch(a){await Oh(e,a)}Hw(e)&&Gw(e)}function sO(t){return Qa(t)&&t.Ta.length<10}function aO(t,e){t.Ta.push(e);const n=Ys(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Hw(t){return Qa(t)&&!Ys(t).x_()&&t.Ta.length>0}function Gw(t){Ys(t).start()}async function oO(t){Ys(t).ra()}async function lO(t){const e=Ys(t);for(const n of t.Ta)e.ea(n.mutations)}async function cO(t,e,n){const i=t.Ta.shift(),a=ry.from(i,e,n);await qw(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await af(t)}async function uO(t,e){e&&Ys(t).X_&&await(async function(i,a){if((function(c){return G5(c)&&c!==ve.ABORTED})(a.code)){const l=i.Ta.shift();Ys(i).B_(),await qw(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await af(i)}})(t,e),Hw(t)&&Gw(t)}async function Ux(t,e){const n=Ue(t);n.asyncQueue.verifyOperationInProgress(),Ae(Ba,"RemoteStore received new credentials");const i=Qa(n);n.Ea.add(3),await mu(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await sf(n)}async function dO(t,e){const n=Ue(t);e?(n.Ea.delete(2),await sf(n)):e||(n.Ea.add(2),await mu(n),n.Ra.set("Unknown"))}function Al(t){return t.ma||(t.ma=(function(n,i,a){const l=Ue(n);return l.sa(),new Wj(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:tO.bind(null,t),t_:nO.bind(null,t),r_:rO.bind(null,t),H_:iO.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),fy(t)?hy(t):t.Ra.set("Unknown")):(await t.ma.stop(),Fw(t))}))),t.ma}function Ys(t){return t.fa||(t.fa=(function(n,i,a){const l=Ue(n);return l.sa(),new Yj(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:oO.bind(null,t),r_:uO.bind(null,t),ta:lO.bind(null,t),na:cO.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await af(t)):(await t.fa.stop(),t.Ta.length>0&&(Ae(Ba,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class my{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Bi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const c=Date.now()+i,h=new my(e,n,c,a,l);return h.start(i),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(ve.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function py(t,e){if(Hi("AsyncQueue",`${e}: ${t}`),Tl(t))return new Te(ve.UNAVAILABLE,`${e}: ${t}`);throw t}class Xo{static emptySet(e){return new Xo(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||je.comparator(n.key,i.key):(n,i)=>je.comparator(n.key,i.key),this.keyedMap=Vc(),this.sortedSet=new Tt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Xo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Xo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class Bx{constructor(){this.ga=new Tt(je.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ne(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class ul{constructor(e,n,i,a,l,c,h,m,g){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=m,this.hasCachedResults=g}static fromInitialDocuments(e,n,i,a,l){const c=[];return n.forEach((h=>{c.push({type:0,doc:h})})),new ul(e,n,Xo.emptySet(n),c,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}class hO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class fO{constructor(){this.queries=Fx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=Ue(n),l=a.queries;a.queries=Fx(),l.forEach(((c,h)=>{for(const m of h.Sa)m.onError(i)}))})(this,new Te(ve.ABORTED,"Firestore shutting down"))}}function Fx(){return new Ga((t=>hw(t)),Jh)}async function Qw(t,e){const n=Ue(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new hO,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(c){const h=py(c,`Initialization of query '${$o(e.query)}' failed`);return void e.onError(h)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&gy(n)}async function $w(t,e){const n=Ue(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function mO(t,e){const n=Ue(t);let i=!1;for(const a of e){const l=a.query,c=n.queries.get(l);if(c){for(const h of c.Sa)h.Fa(a)&&(i=!0);c.wa=a}}i&&gy(n)}function pO(t,e,n){const i=Ue(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function gy(t){t.Ca.forEach((e=>{e.next()}))}var vg,qx;(qx=vg||(vg={})).Ma="default",qx.Cache="cache";class Kw{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new ul(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=ul.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vg.Cache}}class Ww{constructor(e){this.key=e}}class Yw{constructor(e){this.key=e}}class gO{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Xe(),this.mutatedKeys=Xe(),this.eu=fw(e),this.tu=new Xo(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new Bx,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,c=a,h=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,g=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,v)=>{const b=a.get(_),w=Zh(this.query,v)?v:null,C=!!b&&this.mutatedKeys.has(b.key),T=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let j=!1;b&&w?b.data.isEqual(w.data)?C!==T&&(i.track({type:3,doc:w}),j=!0):this.su(b,w)||(i.track({type:2,doc:w}),j=!0,(m&&this.eu(w,m)>0||g&&this.eu(w,g)<0)&&(h=!0)):!b&&w?(i.track({type:0,doc:w}),j=!0):b&&!w&&(i.track({type:1,doc:b}),j=!0,(m||g)&&(h=!0)),j&&(w?(c=c.add(w),l=T?l.add(_):l.delete(_)):(c=c.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:c,iu:i,Cs:h,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,v)=>(function(w,C){const T=j=>{switch(j){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ne(20277,{Rt:j})}};return T(w)-T(C)})(_.type,v.type)||this.eu(_.doc,v.doc))),this.ou(i),a=a??!1;const h=n&&!a?this._u():[],m=this.Xa.size===0&&this.current&&!a?1:0,g=m!==this.Za;return this.Za=m,c.length!==0||g?{snapshot:new ul(this.query,e.tu,l,c,e.mutatedKeys,m===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Bx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Xe(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new Yw(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new Ww(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=Xe();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return ul.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const yy="SyncEngine";class yO{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class _O{constructor(e){this.key=e,this.hu=!1}}class vO{constructor(e,n,i,a,l,c){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Ga((h=>hw(h)),Jh),this.Iu=new Map,this.Eu=new Set,this.du=new Tt(je.comparator),this.Au=new Map,this.Ru=new ay,this.Vu={},this.mu=new Map,this.fu=cl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function bO(t,e,n=!0){const i=n1(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await Xw(i,e,n,!0),a}async function xO(t,e){const n=n1(t);await Xw(n,e,!0,!1)}async function Xw(t,e,n,i){const a=await Bj(t.localStore,li(e)),l=a.targetId,c=t.sharedClientState.addLocalQueryTarget(l,n);let h;return i&&(h=await EO(t,e,l,c==="current",a.resumeToken)),t.isPrimaryClient&&n&&Uw(t.remoteStore,a),h}async function EO(t,e,n,i,a){t.pu=(v,b,w)=>(async function(T,j,B,H){let z=j.view.ru(B);z.Cs&&(z=await Nx(T.localStore,j.query,!1).then((({documents:P})=>j.view.ru(P,z))));const J=H&&H.targetChanges.get(j.targetId),$=H&&H.targetMismatches.get(j.targetId)!=null,re=j.view.applyChanges(z,T.isPrimaryClient,J,$);return Gx(T,j.targetId,re.au),re.snapshot})(t,v,b,w);const l=await Nx(t.localStore,e,!0),c=new gO(e,l.Qs),h=c.ru(l.documents),m=fu.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),g=c.applyChanges(h,t.isPrimaryClient,m);Gx(t,n,g.au);const _=new yO(e,n,c);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),g.snapshot}async function SO(t,e,n){const i=Ue(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((c=>!Jh(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await yg(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&uy(i.remoteStore,a.targetId),bg(i,a.targetId)})).catch(wl)):(bg(i,a.targetId),await yg(i.localStore,a.targetId,!0))}async function wO(t,e){const n=Ue(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),uy(n.remoteStore,i.targetId))}async function TO(t,e,n){const i=OO(t);try{const a=await(function(c,h){const m=Ue(c),g=bt.now(),_=h.reduce(((w,C)=>w.add(C.key)),Xe());let v,b;return m.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let C=Gi(),T=Xe();return m.Ns.getEntries(w,_).next((j=>{C=j,C.forEach(((B,H)=>{H.isValidDocument()||(T=T.add(B))}))})).next((()=>m.localDocuments.getOverlayedDocuments(w,C))).next((j=>{v=j;const B=[];for(const H of h){const z=U5(H,v.get(H.key).overlayedDocument);z!=null&&B.push(new ea(H.key,z,iw(z.value.mapValue),Lr.exists(!0)))}return m.mutationQueue.addMutationBatch(w,g,B,h)})).next((j=>{b=j;const B=j.applyToLocalDocumentSet(v,T);return m.documentOverlayCache.saveOverlays(w,j.batchId,B)}))})).then((()=>({batchId:b.batchId,changes:pw(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(c,h,m){let g=c.Vu[c.currentUser.toKey()];g||(g=new Tt(Ye)),g=g.insert(h,m),c.Vu[c.currentUser.toKey()]=g})(i,a.batchId,n),await pu(i,a.changes),await af(i.remoteStore)}catch(a){const l=py(a,"Failed to persist write");n.reject(l)}}async function Jw(t,e){const n=Ue(t);try{const i=await Vj(n.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=n.Au.get(l);c&&(at(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?at(c.hu,14607):a.removedDocuments.size>0&&(at(c.hu,42227),c.hu=!1))})),await pu(n,i,e)}catch(i){await wl(i)}}function Hx(t,e,n){const i=Ue(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach(((l,c)=>{const h=c.view.va(e);h.snapshot&&a.push(h.snapshot)})),(function(c,h){const m=Ue(c);m.onlineState=h;let g=!1;m.queries.forEach(((_,v)=>{for(const b of v.Sa)b.va(h)&&(g=!0)})),g&&gy(m)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function AO(t,e,n){const i=Ue(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let c=new Tt(je.comparator);c=c.insert(l,wn.newNoDocument(l,Ve.min()));const h=Xe().add(l),m=new nf(Ve.min(),new Map,new Tt(Ye),c,h);await Jw(i,m),i.du=i.du.remove(l),i.Au.delete(e),_y(i)}else await yg(i.localStore,e,!1).then((()=>bg(i,e,n))).catch(wl)}async function CO(t,e){const n=Ue(t),i=e.batch.batchId;try{const a=await Lj(n.localStore,e);e1(n,i,null),Zw(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await pu(n,a)}catch(a){await wl(a)}}async function RO(t,e,n){const i=Ue(t);try{const a=await(function(c,h){const m=Ue(c);return m.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let _;return m.mutationQueue.lookupMutationBatch(g,h).next((v=>(at(v!==null,37113),_=v.keys(),m.mutationQueue.removeMutationBatch(g,v)))).next((()=>m.mutationQueue.performConsistencyCheck(g))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(g,_,h))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,_))).next((()=>m.localDocuments.getDocuments(g,_)))}))})(i.localStore,e);e1(i,e,n),Zw(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await pu(i,a)}catch(a){await wl(a)}}function Zw(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function e1(t,e,n){const i=Ue(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function bg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||t1(t,i)}))}function t1(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(uy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),_y(t))}function Gx(t,e,n){for(const i of n)i instanceof Ww?(t.Ru.addReference(i.key,e),DO(t,i)):i instanceof Yw?(Ae(yy,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||t1(t,i.key)):Ne(19791,{wu:i})}function DO(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(Ae(yy,"New document in limbo: "+n),t.Eu.add(i),_y(t))}function _y(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new je(yt.fromString(e)),i=t.fu.next();t.Au.set(i,new _O(n)),t.du=t.du.insert(n,i),Uw(t.remoteStore,new Ls(li(ey(n.path)),i,"TargetPurposeLimboResolution",Wh.ce))}}async function pu(t,e,n){const i=Ue(t),a=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((h,m)=>{c.push(i.pu(m,e,n).then((g=>{if((g||n)&&i.isPrimaryClient){const _=g?!g.fromCache:n?.targetChanges.get(m.targetId)?.current;i.sharedClientState.updateQueryState(m.targetId,_?"current":"not-current")}if(g){a.push(g);const _=ly.As(m.targetId,g);l.push(_)}})))})),await Promise.all(c),i.Pu.H_(a),await(async function(m,g){const _=Ue(m);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>be.forEach(g,(b=>be.forEach(b.Es,(w=>_.persistence.referenceDelegate.addReference(v,b.targetId,w))).next((()=>be.forEach(b.ds,(w=>_.persistence.referenceDelegate.removeReference(v,b.targetId,w)))))))))}catch(v){if(!Tl(v))throw v;Ae(cy,"Failed to update sequence numbers: "+v)}for(const v of g){const b=v.targetId;if(!v.fromCache){const w=_.Ms.get(b),C=w.snapshotVersion,T=w.withLastLimboFreeSnapshotVersion(C);_.Ms=_.Ms.insert(b,T)}}})(i.localStore,l))}async function IO(t,e){const n=Ue(t);if(!n.currentUser.isEqual(e)){Ae(yy,"User change. New user:",e.toKey());const i=await Pw(n.localStore,e);n.currentUser=e,(function(l,c){l.mu.forEach((h=>{h.forEach((m=>{m.reject(new Te(ve.CANCELLED,c))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await pu(n,i.Ls)}}function jO(t,e){const n=Ue(t),i=n.Au.get(e);if(i&&i.hu)return Xe().add(i.key);{let a=Xe();const l=n.Iu.get(e);if(!l)return a;for(const c of l){const h=n.Tu.get(c);a=a.unionWith(h.view.nu)}return a}}function n1(t){const e=Ue(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Jw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=jO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=AO.bind(null,e),e.Pu.H_=mO.bind(null,e.eventManager),e.Pu.yu=pO.bind(null,e.eventManager),e}function OO(t){const e=Ue(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=RO.bind(null,e),e}class Mh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return Pj(this.persistence,new Mj,e.initialUser,this.serializer)}Cu(e){return new Nw(oy.mi,this.serializer)}Du(e){return new qj}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Mh.provider={build:()=>new Mh};class MO extends Mh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){at(this.persistence.referenceDelegate instanceof jh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new _j(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Un.withCacheSize(this.cacheSizeBytes):Un.DEFAULT;return new Nw((i=>jh.mi(i,n)),this.serializer)}}class xg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Hx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=IO.bind(null,this.syncEngine),await dO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new fO})()}createDatastore(e){const n=rf(e.databaseInfo.databaseId),i=(function(l){return new Kj(l)})(e.databaseInfo);return(function(l,c,h,m){return new Jj(l,c,h,m)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,a,l,c,h){return new eO(i,a,l,c,h)})(this.localStore,this.datastore,e.asyncQueue,(n=>Hx(this.syncEngine,n,0)),(function(){return Vx.v()?new Vx:new Hj})())}createSyncEngine(e,n){return(function(a,l,c,h,m,g,_){const v=new vO(a,l,c,h,m,g);return _&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Ue(n);Ae(Ba,"RemoteStore shutting down."),i.Ea.add(5),await mu(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}xg.provider={build:()=>new xg};class r1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Hi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Xs="FirestoreClient";class kO{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=Sn.UNAUTHENTICATED,this.clientId=Kg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{Ae(Xs,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Ae(Xs,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Bi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=py(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Pp(t,e){t.asyncQueue.verifyOperationInProgress(),Ae(Xs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async a=>{i.isEqual(a)||(await Pw(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Qx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await NO(t);Ae(Xs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>Ux(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,a)=>Ux(e.remoteStore,a))),t._onlineComponents=e}async function NO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ae(Xs,"Using user provided OfflineComponentProvider");try{await Pp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ve.FAILED_PRECONDITION||a.code===ve.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;il("Error using user provided cache. Falling back to memory cache: "+n),await Pp(t,new Mh)}}else Ae(Xs,"Using default OfflineComponentProvider"),await Pp(t,new MO(void 0));return t._offlineComponents}async function i1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ae(Xs,"Using user provided OnlineComponentProvider"),await Qx(t,t._uninitializedComponentsProvider._online)):(Ae(Xs,"Using default OnlineComponentProvider"),await Qx(t,new xg))),t._onlineComponents}function PO(t){return i1(t).then((e=>e.syncEngine))}async function s1(t){const e=await i1(t),n=e.eventManager;return n.onListen=bO.bind(null,e.syncEngine),n.onUnlisten=SO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=xO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=wO.bind(null,e.syncEngine),n}function LO(t,e,n={}){const i=new Bi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,h,m,g){const _=new r1({next:b=>{_.Nu(),c.enqueueAndForget((()=>$w(l,v)));const w=b.docs.has(h);!w&&b.fromCache?g.reject(new Te(ve.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&b.fromCache&&m&&m.source==="server"?g.reject(new Te(ve.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(b)},error:b=>g.reject(b)}),v=new Kw(ey(h.path),_,{includeMetadataChanges:!0,qa:!0});return Qw(l,v)})(await s1(t),t.asyncQueue,e,n,i))),i.promise}function VO(t,e,n={}){const i=new Bi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,h,m,g){const _=new r1({next:b=>{_.Nu(),c.enqueueAndForget((()=>$w(l,v))),b.fromCache&&m.source==="server"?g.reject(new Te(ve.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(b)},error:b=>g.reject(b)}),v=new Kw(h,_,{includeMetadataChanges:!0,qa:!0});return Qw(l,v)})(await s1(t),t.asyncQueue,e,n,i))),i.promise}function a1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const $x=new Map;const o1="firestore.googleapis.com",Kx=!0;class Wx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Te(ve.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=o1,this.ssl=Kx}else this.host=e.host,this.ssl=e.ssl??Kx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=kw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<gj)throw new Te(ve.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Z2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=a1(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Te(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Te(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Te(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class of{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Wx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Te(ve.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Te(ve.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Wx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new q2;switch(i.type){case"firstParty":return new $2(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Te(ve.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=$x.get(n);i&&(Ae("ComponentProvider","Removing Datastore"),$x.delete(n),i.terminate())})(this),Promise.resolve()}}function zO(t,e,n,i={}){t=pi(t,of);const a=xl(e),l=t._getSettings(),c={...l,emulatorOptions:t._getEmulatorOptions()},h=`${e}:${n}`;a&&(IS(`https://${h}`),jS("Firestore",!0)),l.host!==o1&&l.host!==h&&il("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...l,host:h,ssl:a,emulatorOptions:i};if(!Gs(m,c)&&(t._setSettings(m),i.mockUserToken)){let g,_;if(typeof i.mockUserToken=="string")g=i.mockUserToken,_=Sn.MOCK_USER;else{g=fI(i.mockUserToken,t._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new Te(ve.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new Sn(v)}t._authCredentials=new H2(new QS(g,_))}}class Cl{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Cl(this.firestore,e,this._query)}}class Lt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Lt(this.firestore,e,this._key)}toJSON(){return{type:Lt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(uu(n,Lt._jsonSchema))return new Lt(e,i||null,new je(yt.fromString(n.referencePath)))}}Lt._jsonSchemaVersion="firestore/documentReference/1.0",Lt._jsonSchema={type:Xt("string",Lt._jsonSchemaVersion),referencePath:Xt("string")};class qs extends Cl{constructor(e,n,i){super(e,n,ey(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Lt(this.firestore,null,new je(e))}withConverter(e){return new qs(this.firestore,e,this._path)}}function UO(t,e,...n){if(t=un(t),$S("collection","path",e),t instanceof of){const i=yt.fromString(e,...n);return lx(i),new qs(t,null,i)}{if(!(t instanceof Lt||t instanceof qs))throw new Te(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(yt.fromString(e,...n));return lx(i),new qs(t.firestore,null,i)}}function lf(t,e,...n){if(t=un(t),arguments.length===1&&(e=Kg.newId()),$S("doc","path",e),t instanceof of){const i=yt.fromString(e,...n);return ox(i),new Lt(t,null,new je(i))}{if(!(t instanceof Lt||t instanceof qs))throw new Te(ve.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(yt.fromString(e,...n));return ox(i),new Lt(t.firestore,t instanceof qs?t.converter:null,new je(i))}}const Yx="AsyncQueue";class Xx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Vw(this,"async_queue_retry"),this._c=()=>{const i=Np();i&&Ae(Yx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Np();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Np();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Bi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Tl(e))throw e;Ae(Yx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Hi("INTERNAL UNHANDLED ERROR: ",Jx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=my.createAndSchedule(this,e,n,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Ne(47125,{Pc:Jx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Jx(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Rl extends of{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new Xx,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Xx(e),this._firestoreClient=void 0,await e}}}function BO(t,e){const n=typeof t=="object"?t:NS(),i=typeof t=="string"?t:wh,a=Qg(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=dI("firestore");l&&zO(a,...l)}return a}function vy(t){if(t._terminated)throw new Te(ve.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||FO(t),t._firestoreClient}function FO(t){const e=t._freezeSettings(),n=(function(a,l,c,h){return new u5(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,a1(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new kO(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(t._componentsProvider))}class vr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vr(bn.fromBase64String(e))}catch(n){throw new Te(ve.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new vr(bn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:vr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(uu(e,vr._jsonSchema))return vr.fromBase64String(e.bytes)}}vr._jsonSchemaVersion="firestore/bytes/1.0",vr._jsonSchema={type:Xt("string",vr._jsonSchemaVersion),bytes:Xt("string")};class cf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Te(ve.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new vn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class uf{constructor(e){this._methodName=e}}class ui{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Te(ve.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Te(ve.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ye(this._lat,e._lat)||Ye(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ui._jsonSchemaVersion}}static fromJSON(e){if(uu(e,ui._jsonSchema))return new ui(e.latitude,e.longitude)}}ui._jsonSchemaVersion="firestore/geoPoint/1.0",ui._jsonSchema={type:Xt("string",ui._jsonSchemaVersion),latitude:Xt("number"),longitude:Xt("number")};class di{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:di._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(uu(e,di._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new di(e.vectorValues);throw new Te(ve.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}di._jsonSchemaVersion="firestore/vectorValue/1.0",di._jsonSchema={type:Xt("string",di._jsonSchemaVersion),vectorValues:Xt("object")};const qO=/^__.*__$/;class HO{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new ea(e,this.data,this.fieldMask,n,this.fieldTransforms):new hu(e,this.data,n,this.fieldTransforms)}}class l1{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new ea(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function c1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ne(40011,{Ac:t})}}class df{constructor(e,n,i,a,l,c){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new df({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return kh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(c1(this.Ac)&&qO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class GO{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||rf(e)}Cc(e,n,i,a=!1){return new df({Ac:e,methodName:n,Dc:i,path:vn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function by(t){const e=t._freezeSettings(),n=rf(t._databaseId);return new GO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function QO(t,e,n,i,a,l={}){const c=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);Ey("Data must be an object, but it was:",c,i);const h=u1(i,c);let m,g;if(l.merge)m=new er(c.fieldMask),g=c.fieldTransforms;else if(l.mergeFields){const _=[];for(const v of l.mergeFields){const b=Eg(e,v,n);if(!c.contains(b))throw new Te(ve.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);h1(_,b)||_.push(b)}m=new er(_),g=c.fieldTransforms.filter((v=>m.covers(v.field)))}else m=null,g=c.fieldTransforms;return new HO(new Bn(h),m,g)}class gu extends uf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gu}}function $O(t,e,n){return new df({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class xy extends uf{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=$O(this,e,!0),i=this.vc.map((l=>Dl(l,n))),a=new ll(i);return new P5(e.path,a)}isEqual(e){return e instanceof xy&&Gs(this.vc,e.vc)}}function KO(t,e,n,i){const a=t.Cc(1,e,n);Ey("Data must be an object, but it was:",a,i);const l=[],c=Bn.empty();Zs(i,((m,g)=>{const _=Sy(e,m,n);g=un(g);const v=a.yc(_);if(g instanceof gu)l.push(_);else{const b=Dl(g,v);b!=null&&(l.push(_),c.set(_,b))}}));const h=new er(l);return new l1(c,h,a.fieldTransforms)}function WO(t,e,n,i,a,l){const c=t.Cc(1,e,n),h=[Eg(e,i,n)],m=[a];if(l.length%2!=0)throw new Te(ve.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<l.length;b+=2)h.push(Eg(e,l[b])),m.push(l[b+1]);const g=[],_=Bn.empty();for(let b=h.length-1;b>=0;--b)if(!h1(g,h[b])){const w=h[b];let C=m[b];C=un(C);const T=c.yc(w);if(C instanceof gu)g.push(w);else{const j=Dl(C,T);j!=null&&(g.push(w),_.set(w,j))}}const v=new er(g);return new l1(_,v,c.fieldTransforms)}function YO(t,e,n,i=!1){return Dl(n,t.Cc(i?4:3,e))}function Dl(t,e){if(d1(t=un(t)))return Ey("Unsupported field value:",e,t),u1(t,e);if(t instanceof uf)return(function(i,a){if(!c1(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let c=0;for(const h of i){let m=Dl(h,a.wc(c));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),c++}return{arrayValue:{values:l}}})(t,e)}return(function(i,a){if((i=un(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return M5(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=bt.fromDate(i);return{timestampValue:Ih(a.serializer,l)}}if(i instanceof bt){const l=new bt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ih(a.serializer,l)}}if(i instanceof ui)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof vr)return{bytesValue:Cw(a.serializer,i._byteString)};if(i instanceof Lt){const l=a.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw a.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:sy(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof di)return(function(c,h){return{mapValue:{fields:{[nw]:{stringValue:rw},[Th]:{arrayValue:{values:c.toArray().map((g=>{if(typeof g!="number")throw h.Sc("VectorValues must only contain numeric values.");return ty(h.serializer,g)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${Kh(i)}`)})(t,e)}function u1(t,e){const n={};return YS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zs(t,((i,a)=>{const l=Dl(a,e.mc(i));l!=null&&(n[i]=l)})),{mapValue:{fields:n}}}function d1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof bt||t instanceof ui||t instanceof vr||t instanceof Lt||t instanceof uf||t instanceof di)}function Ey(t,e,n){if(!d1(n)||!KS(n)){const i=Kh(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function Eg(t,e,n){if((e=un(e))instanceof cf)return e._internalPath;if(typeof e=="string")return Sy(t,e);throw kh("Field path arguments must be of type string or ",t,!1,void 0,n)}const XO=new RegExp("[~\\*/\\[\\]]");function Sy(t,e,n){if(e.search(XO)>=0)throw kh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new cf(...e.split("."))._internalPath}catch{throw kh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function kh(t,e,n,i,a){const l=i&&!i.isEmpty(),c=a!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(l||c)&&(m+=" (found",l&&(m+=` in field ${i}`),c&&(m+=` in document ${a}`),m+=")"),new Te(ve.INVALID_ARGUMENT,h+t+m)}function h1(t,e){return t.some((n=>n.isEqual(e)))}class f1{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Lt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(wy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class JO extends f1{data(){return super.data()}}function wy(t,e){return typeof e=="string"?Sy(t,e):e instanceof cf?e._internalPath:e._delegate._internalPath}function ZO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Te(ve.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ty{}class eM extends Ty{}function tM(t,e,...n){let i=[];e instanceof Ty&&i.push(e),i=i.concat(n),(function(l){const c=l.filter((m=>m instanceof Ay)).length,h=l.filter((m=>m instanceof hf)).length;if(c>1||c>0&&h>0)throw new Te(ve.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)t=a._apply(t);return t}class hf extends eM{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new hf(e,n,i)}_apply(e){const n=this._parse(e);return m1(e._query,n),new Cl(e.firestore,e.converter,dg(e._query,n))}_parse(e){const n=by(e.firestore);return(function(l,c,h,m,g,_,v){let b;if(g.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new Te(ve.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){eE(v,_);const C=[];for(const T of v)C.push(Zx(m,l,T));b={arrayValue:{values:C}}}else b=Zx(m,l,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||eE(v,_),b=YO(h,c,v,_==="in"||_==="not-in");return Yt.create(g,_,b)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function nM(t,e,n){const i=e,a=wy("where",t);return hf._create(a,i,n)}class Ay extends Ty{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Ay(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Vr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,l){let c=a;const h=l.getFlattenedFilters();for(const m of h)m1(c,m),c=dg(c,m)})(e._query,n),new Cl(e.firestore,e.converter,dg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Zx(t,e,n){if(typeof(n=un(n))=="string"){if(n==="")throw new Te(ve.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dw(e)&&n.indexOf("/")!==-1)throw new Te(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(yt.fromString(n));if(!je.isDocumentKey(i))throw new Te(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return gx(t,new je(i))}if(n instanceof Lt)return gx(t,n._key);throw new Te(ve.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Kh(n)}.`)}function eE(t,e){if(!Array.isArray(t)||t.length===0)throw new Te(ve.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function m1(t,e){const n=(function(a,l){for(const c of a)for(const h of c.getFlattenedFilters())if(l.indexOf(h.op)>=0)return h.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Te(ve.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Te(ve.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class rM{convertValue(e,n="none"){switch(Ws(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ks(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ne(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return Zs(e,((a,l)=>{i[a]=this.convertValue(l,n)})),i}convertVectorValue(e){const n=e.fields?.[Th].arrayValue?.values?.map((i=>Pt(i.doubleValue)));return new di(n)}convertGeoPoint(e){return new ui(Pt(e.latitude),Pt(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Xh(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Xc(e));default:return null}}convertTimestamp(e){const n=$s(e);return new bt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=yt.fromString(e);at(Mw(i),9688,{name:e});const a=new Jc(i.get(1),i.get(3)),l=new je(i.popFirst(5));return a.isEqual(n)||Hi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function iM(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Uc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Pa extends f1{constructor(e,n,i,a,l,c){super(e,n,i,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new hh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(wy("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(ve.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Pa._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Pa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pa._jsonSchema={type:Xt("string",Pa._jsonSchemaVersion),bundleSource:Xt("string","DocumentSnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class hh extends Pa{data(e={}){return super.data(e)}}class Jo{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Uc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new hh(this._firestore,this._userDataWriter,i.key,i,new Uc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Te(ve.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((h=>{const m=new hh(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Uc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);return h.doc,{type:"added",doc:m,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((h=>l||h.type!==3)).map((h=>{const m=new hh(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Uc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);let g=-1,_=-1;return h.type!==0&&(g=c.indexOf(h.doc.key),c=c.delete(h.doc.key)),h.type!==1&&(c=c.add(h.doc),_=c.indexOf(h.doc.key)),{type:sM(h.type),doc:m,oldIndex:g,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(ve.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Jo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Kg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function sM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ne(61501,{type:t})}}function aM(t){t=pi(t,Lt);const e=pi(t.firestore,Rl);return LO(vy(e),t._key).then((n=>dM(e,t,n)))}Jo._jsonSchemaVersion="firestore/querySnapshot/1.0",Jo._jsonSchema={type:Xt("string",Jo._jsonSchemaVersion),bundleSource:Xt("string","QuerySnapshot"),bundleName:Xt("string"),bundle:Xt("string")};class p1 extends rM{constructor(e){super(),this.firestore=e}convertBytes(e){return new vr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Lt(this.firestore,null,n)}}function oM(t){t=pi(t,Cl);const e=pi(t.firestore,Rl),n=vy(e),i=new p1(e);return ZO(t._query),VO(n,t._query).then((a=>new Jo(e,i,t,a)))}function lM(t,e,n){t=pi(t,Lt);const i=pi(t.firestore,Rl),a=iM(t.converter,e,n);return Cy(i,[QO(by(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,Lr.none())])}function cM(t,e,n,...i){t=pi(t,Lt);const a=pi(t.firestore,Rl),l=by(a);let c;return c=typeof(e=un(e))=="string"||e instanceof cf?WO(l,"updateDoc",t._key,e,n,i):KO(l,"updateDoc",t._key,e),Cy(a,[c.toMutation(t._key,Lr.exists(!0))])}function uM(t){return Cy(pi(t.firestore,Rl),[new ny(t._key,Lr.none())])}function Cy(t,e){return(function(i,a){const l=new Bi;return i.asyncQueue.enqueueAndForget((async()=>TO(await PO(i),a,l))),l.promise})(vy(t),e)}function dM(t,e,n){const i=n.docs.get(e._key),a=new p1(t);return new Pa(t,a,e._key,i,new Uc(n.hasPendingWrites,n.fromCache),e.converter)}function hM(){return new gu("deleteField")}function fM(...t){return new xy("arrayUnion",t)}(function(e,n=!0){(function(a){Sl=a})(El),rl(new za("firestore",((i,{instanceIdentifier:a,options:l})=>{const c=i.getProvider("app").getImmediate(),h=new Rl(new G2(i.getProvider("auth-internal")),new K2(c,i.getProvider("app-check-internal")),(function(g,_){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new Te(ve.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jc(g.options.projectId,_)})(c,a),c);return l={useFetchStreams:n,...l},h._setSettings(l),h}),"PUBLIC").setMultipleInstances(!0)),Bs(rx,ix,e),Bs(rx,ix,"esm2020")})();function yu(){return BO(VS)}function _u(t,e,n,i=1,a){{let l=e;if(e.startsWith("budgets/"))l="budgets";else if(e.startsWith("months/")){const m=e.replace("months/","").split("_");if(m.length>=2){const g=m[m.length-1];l=`months/${m[m.length-2]}/${g}`}}console.log(`[Firebase] ${t}(${i}): ${l}${a===!1?" [NOT FOUND]":""}  ${n}`)}}async function Le(t,e,n){const i=lf(yu(),t,e),a=`${t}/${e}`,l=await aM(i),c=l.exists();return _u("READ",a,n,1,c),{exists:c,data:c?l.data():null,ref:i}}async function br(t,e,n){const i=yu(),a=UO(i,t);let l;if(n&&n.length>0){const m=n.map(g=>nM(g.field,g.op,g.value));l=tM(a,...m)}else l=a;const c=await oM(l);let h=t;if(n&&n.length>0){const m=n.map(g=>`${g.field} ${g.op} ${JSON.stringify(g.value)}`).join(", ");h+=` WHERE ${m}`}return _u("QUERY",h,e,c.docs.length),{docs:c.docs.map(m=>({id:m.id,data:m.data()}))}}async function pt(t,e,n,i,a){const l=lf(yu(),t,e),c=`${t}/${e}`;return _u("WRITE",c,i),lM(l,n,a??{})}async function Na(t,e,n,i){const a=lf(yu(),t,e),l=`${t}/${e}`;return _u("UPDATE",l,i),cM(a,n)}async function Ry(t,e,n){const i=lf(yu(),t,e),a=`${t}/${e}`;return _u("DELETE",a,n),uM(i)}function hi(t,e,n){const i=n.toString().padStart(2,"0");return`${t}_${e}_${i}`}function Dy(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function mM(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}function Jt(t,e){return`${t}${e.toString().padStart(2,"0")}`}function g1(){const t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=[];for(let a=3;a>0;a--){let l=e,c=n-a;for(;c<1;)c+=12,l-=1;i.push(Jt(l,c))}i.push(Jt(e,n));for(let a=1;a<=3;a++){let l=e,c=n+a;for(;c>12;)c-=12,l+=1;i.push(Jt(l,c))}return i}function y1(t){const e=new Set(g1()),n={};for(const[i,a]of Object.entries(t))e.has(i)&&(n[i]=a);return n}function pM(t,e){const n=xe.budget(t),i=st.getQueryData(n);if(!i?.monthMap)return!1;for(const[a,l]of Object.entries(i.monthMap))if(a>e&&!l.needs_recalculation)return!1;return!0}function gM(t,e,n){const i=xe.budget(t),a=st.getQueryData(i);a&&st.setQueryData(i,{...a,isNeedsRecalculation:!0,monthMap:n,budget:{...a.budget,is_needs_recalculation:!0,month_map:n}})}async function yM(t,e,n){const i=Jt(e,n);if(pM(t,i))return console.log("[markMonthsNeedRecalculation] All future months already marked in cache, skipping write"),{markedCount:0,budgetUpdated:!1};const{exists:a,data:l}=await Le("budgets",t,"reading budget for month_map update");if(!a||!l)return console.warn(`[markMonthsNeedRecalculation] Budget ${t} not found`),{markedCount:0,budgetUpdated:!1};const h={...l.month_map||{}},m=g1();for(const v of m)h[v]||(h[v]={needs_recalculation:!1});let g=0;for(const v of m)v>i&&(h[v]?.needs_recalculation||(h[v]={needs_recalculation:!0},g++));if(g===0)return console.log("[markMonthsNeedRecalculation] No new months to mark, skipping write"),{markedCount:0,budgetUpdated:!1};const _=y1(h);return gM(t,i,_),await Na("budgets",t,{is_needs_recalculation:!0,month_map:_,updated_at:new Date().toISOString()},`marking budget and ${g} future months as needing recalculation`),{markedCount:g,budgetUpdated:!0}}async function _M(t,e,n,i=!1){const a=Jt(e,n),{exists:l,data:c}=await Le("budgets",t,"reading budget for month_map update (add month)");if(!l||!c){console.warn(`[setMonthInBudgetMap] Budget ${t} not found`);return}const m={...c.month_map||{},[a]:{needs_recalculation:i}},g=y1(m),_=xe.budget(t),v=st.getQueryData(_);v&&st.setQueryData(_,{...v,monthMap:g,budget:{...v.budget,month_map:g}}),await Na("budgets",t,{month_map:g,updated_at:new Date().toISOString()},`adding month ${e}/${n} to budget month_map`)}const vM={categoryEndBalances:{},accountEndBalances:{},totalIncome:0};function bM(t,e){const n=xM(t.category_balances,e.categoryEndBalances),i=EM(t,e.accountEndBalances);return{...t,previous_month_income:e.totalIncome,category_balances:n,account_balances:i,updated_at:new Date().toISOString()}}function xM(t,e){const n=new Map;for(const a of t)n.set(a.category_id,a);const i=t.map(a=>{const l=e[a.category_id]??0;return{...a,start_balance:l,end_balance:l+a.allocated-a.spent}});for(const[a,l]of Object.entries(e))n.has(a)||i.push({category_id:a,start_balance:l,allocated:0,spent:0,end_balance:l});return i}function EM(t,e){const n=new Set;for(const a of t.income||[])n.add(a.account_id);for(const a of t.expenses||[])n.add(a.account_id);for(const a of Object.keys(e))n.add(a);for(const a of t.account_balances||[])n.add(a.account_id);const i=[];for(const a of n){const l=e[a]??0,c=(t.income||[]).filter(g=>g.account_id===a).reduce((g,_)=>g+_.amount,0),h=(t.expenses||[]).filter(g=>g.account_id===a).reduce((g,_)=>g+_.amount,0),m=c-h;i.push({account_id:a,start_balance:l,income:c,expenses:h,net_change:m,end_balance:l+m})}return i}function tE(t){const e={},n={};for(const i of t.category_balances||[])e[i.category_id]=i.end_balance;for(const i of t.account_balances||[])n[i.account_id]=i.end_balance;return{categoryEndBalances:e,accountEndBalances:n,totalIncome:t.total_income}}async function _1(t,e,n){const i=hi(t,e.year,e.month);await pt("months",i,e,`writeMonthData: ${n}`)}async function v1(t,e,n){await yM(t,e,n)}async function b1(t){const{budgetId:e,month:n,description:i,cascadeRecalculation:a=!0}=t;await _1(e,n,i||`${n.year}/${n.month}`),st.setQueryData(xe.month(e,n.year,n.month),{month:n}),a&&await v1(e,n.year,n.month)}function Wi(){const t=sn();return{writeData:rr({mutationFn:async({budgetId:n,month:i,description:a,cascadeRecalculation:l=!0})=>(await _1(n,i,a||`${i.year}/${i.month}`),{budgetId:n,year:i.year,month:i.month,cascadeRecalculation:l}),onMutate:async({budgetId:n,month:i})=>{const a=xe.month(n,i.year,i.month);await t.cancelQueries({queryKey:a});const l=t.getQueryData(a);return t.setQueryData(a,{month:i}),{oldMonthQueryData:l,monthKey:a}},onSuccess:async({budgetId:n,year:i,month:a,cascadeRecalculation:l})=>{l&&await v1(n,i,a)},onError:(n,i,a)=>{a?.oldMonthQueryData&&t.setQueryData(a.monthKey,a.oldMonthQueryData)}})}}function SM(t){const e={},n={};return t.category_balances&&t.category_balances.forEach(i=>{e[i.category_id]=i.end_balance}),t.account_balances&&t.account_balances.forEach(i=>{n[i.account_id]=i.end_balance}),{categoryEndBalances:e,accountEndBalances:n}}async function wM(t,e,n){const i=new Date,a=i.getFullYear(),l=i.getMonth()+1,c=(e-a)*12+(n-l);if(c>3){const j=`[createMonth] Refusing to create month ${e}/${n} - it's ${c} months in the future (max allowed: 3). This likely indicates a bug in month navigation.`;throw console.error(j),new Error(j)}if(c<-3){const j=`[createMonth] Refusing to create month ${e}/${n} - it's ${Math.abs(c)} months in the past (max allowed: 3). Existing months can still be viewed, but new months cannot be created this far back.`;throw console.error(j),new Error(j)}const h=i.toISOString(),m=hi(t,e,n);let g=0,_={},v={};if(n>1||e>new Date().getFullYear()-10){const{year:j,month:B}=Dy(e,n),H=hi(t,j,B),{exists:z,data:J}=await Le("months",H,"fetching previous month to create start balances for new month");if(z&&J){const $={year_month_ordinal:J.year_month_ordinal??Jt(j,B),year:J.year??j,month:J.month??B,income:J.income||[],total_income:J.total_income??0,previous_month_income:J.previous_month_income??0,expenses:J.expenses||[],total_expenses:J.total_expenses??0,account_balances:J.account_balances||[],category_balances:J.category_balances||[],are_allocations_finalized:J.are_allocations_finalized??!1,created_at:J.created_at,updated_at:J.updated_at};g=$.total_income;const{categoryEndBalances:re,accountEndBalances:P}=SM($);_=re,v=P}}const b=Object.entries(_).map(([j,B])=>({category_id:j,start_balance:B,allocated:0,spent:0,end_balance:B})),w=Object.entries(v).map(([j,B])=>({account_id:j,start_balance:B,income:0,expenses:0,net_change:0,end_balance:B})),C={budget_id:t,year_month_ordinal:Jt(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:g,expenses:[],total_expenses:0,account_balances:w,category_balances:b,are_allocations_finalized:!1,created_at:h,updated_at:h},T={budget_id:t,year_month_ordinal:Jt(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:g,expenses:[],total_expenses:0,account_balances:w,category_balances:b,are_allocations_finalized:!1,created_at:h,updated_at:h};return await pt("months",m,T,"creating new month document (first time viewing this month)"),st.setQueryData(xe.month(t,e,n),{month:C}),await _M(t,e,n,!1),C}function TM(t,e,n,i){const a={};t.category_balances&&t.category_balances.forEach(c=>{a[c.category_id]=c});const l=t.expenses??[];return e.map(c=>{const m=a[c]?.start_balance??0,g=n[c]??0,_=l.filter(v=>v.category_id===c).reduce((v,b)=>v+b.amount,0);return{category_id:c,start_balance:m,allocated:g,spent:_,end_balance:m+g-_}})}function AM(){const{writeData:t}=Wi();return{saveDraftAllocations:async(n,i,a,l)=>{const c=await Yi(n,i,a,"save draft allocations"),h=c.category_balances.map(g=>({...g,allocated:l[g.category_id]??g.allocated})),m={...c,category_balances:h,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:n,month:m,cascadeRecalculation:!1}),{updatedMonth:m}},isPending:t.isPending,isError:t.isError,error:t.error}}function CM(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,category_group_id:i.category_group_id??null,sort_order:i.sort_order,balance:i.balance??0},i.description!==void 0&&(e[n].description=i.description),i.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=i.default_monthly_amount),i.default_monthly_type!==void 0&&(e[n].default_monthly_type=i.default_monthly_type)}),e}function RM(){const t=sn();return{updateCategories:rr({mutationFn:async({budgetId:n,categories:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const c=CM(i);return await pt("budgets",n,{...l,categories:c},"saving updated categories (user edited category settings)"),i},onMutate:async({budgetId:n,categories:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,categories:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,categories:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function DM(){const t=sn();return{updateCategoryGroups:rr({mutationFn:async({budgetId:n,categoryGroups:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await pt("budgets",n,{...l,category_groups:i},"saving updated category groups (user edited group settings)"),i},onMutate:async({budgetId:n,categoryGroups:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,categoryGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,categoryGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}async function x1(t,e){if(e.length===0)return;const n=e.filter(g=>g.delta!==0);if(n.length===0)return;const i=st.getQueryData(xe.budget(t));if(!i)return;let a=0,l=0;const c={...i.categories};for(const{categoryId:g,delta:_}of n)if(c[g]){const v=c[g].balance,b=v+_;v>0&&(a+=v),b>0&&(l+=b),c[g]={...c[g],balance:b}}const h=l-a,m=i.budget?{...i.budget,total_available:i.budget.total_available-h}:i.budget;st.setQueryData(xe.budget(t),{...i,categories:c,budget:m})}function IM(){const{writeData:t}=Wi();return{finalizeAllocations:async n=>{const{budgetId:i,year:a,month:l,allocations:c}=n,h=await Yi(i,a,l,"finalize allocations"),m=h.category_balances?.map(w=>w.category_id)??Object.keys(c),g={};if(h.are_allocations_finalized&&h.category_balances)for(const w of h.category_balances)g[w.category_id]=w.allocated;const _=m.length>0?TM(h,m,c):h.category_balances,v={...h,category_balances:_,are_allocations_finalized:!0,updated_at:new Date().toISOString()};await t.mutateAsync({budgetId:i,month:v,description:"finalize allocations"});const b=m.map(w=>({categoryId:w,delta:(c[w]??0)-(g[w]??0)}));return await x1(i,b),{updatedMonth:v}},isPending:t.isPending,isError:t.isError,error:t.error}}function E1(){const{writeData:t}=Wi();return{deleteAllocations:async n=>{const{budgetId:i,year:a,month:l}=n,c=await Yi(i,a,l,"delete allocations"),h=[];if(c.are_allocations_finalized&&c.category_balances)for(const _ of c.category_balances)_.allocated>0&&h.push({categoryId:_.category_id,allocated:_.allocated});const m=c.category_balances.map(_=>({..._,allocated:0,end_balance:_.start_balance-_.spent})),g={...c,category_balances:m,are_allocations_finalized:!1,updated_at:new Date().toISOString()};if(await t.mutateAsync({budgetId:i,month:g,description:"delete allocations"}),h.length>0){const _=h.map(({categoryId:v,allocated:b})=>({categoryId:v,delta:-b}));await x1(i,_)}return{updatedMonth:g}},isPending:t.isPending,isError:t.isError,error:t.error}}async function ff(t,e,n){const i=e.trim();if(!i||n.includes(i))return null;const a=[...n,i].sort((l,c)=>l.toLowerCase().localeCompare(c.toLowerCase()));return await pt("payees",t,{budget_id:t,payees:a,updated_at:new Date().toISOString()},`adding new payee "${i}" to autocomplete list`),a}function Il(t){const e=t.income||[],n=t.expenses||[],i=e.reduce((h,m)=>h+m.amount,0),a=n.reduce((h,m)=>h+m.amount,0),l=jM(t),c=OM(t);return{...t,total_income:i,total_expenses:a,account_balances:l,category_balances:c}}function jM(t){const e=t.income||[],n=t.expenses||[],i=t.account_balances||[],a=new Map;for(const h of i)a.set(h.account_id,h);const l=new Set;for(const h of e)l.add(h.account_id);for(const h of n)l.add(h.account_id);for(const h of i)l.add(h.account_id);const c=[];for(const h of l){const g=a.get(h)?.start_balance??0,_=e.filter(w=>w.account_id===h).reduce((w,C)=>w+C.amount,0),v=n.filter(w=>w.account_id===h).reduce((w,C)=>w+C.amount,0),b=_-v;c.push({account_id:h,start_balance:g,income:_,expenses:v,net_change:b,end_balance:g+b})}return c}function OM(t){const e=t.expenses||[],n=t.category_balances||[],i=new Map;for(const h of n)i.set(h.category_id,h);const a=new Map;for(const h of e){const m=a.get(h.category_id)||0;a.set(h.category_id,m+h.amount)}const l=new Set;for(const h of n)l.add(h.category_id);for(const h of e)l.add(h.category_id);const c=[];for(const h of l){const m=i.get(h),g=a.get(h)??0;m?c.push({...m,spent:g,end_balance:m.start_balance+m.allocated-g}):c.push({category_id:h,start_balance:0,allocated:0,spent:g,end_balance:-g})}return c}function MM(t,e){let n=0;for(const{accountId:i,delta:a}of e){const l=t.accounts[i];if(!l)continue;const c=l.account_group_id?t.accountGroups[l.account_group_id]:void 0,h=c?.on_budget!==void 0?c.on_budget:l.on_budget!==!1,m=c?.is_active!==void 0?c.is_active:l.is_active!==!1;h&&m&&(n+=a)}return n}async function Js(t,e){if(e.length===0)return;const n=e.filter(h=>h.delta!==0);if(n.length===0)return;const i=st.getQueryData(xe.budget(t));if(!i)return;const a=MM(i,n),l={...i.accounts};for(const{accountId:h,delta:m}of n)l[h]&&(l[h]={...l[h],balance:l[h].balance+m});const c=i.budget?{...i.budget,total_available:i.budget.total_available+a}:i.budget;st.setQueryData(xe.budget(t),{...i,accounts:l,budget:c})}function kM(){const t=sn(),{writeData:e}=Wi();return{addIncome:async(i,a,l,c,h,m,g,_)=>{const v=await Yi(i,a,l,"add income"),b={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:c,account_id:h,date:m,created_at:new Date().toISOString()};g?.trim()&&(b.payee=g.trim()),_&&(b.description=_);const w=[...v.income||[],b],C=Il({...v,income:w,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:C,description:"add income"}),await Js(i,[{accountId:h,delta:c}]),g?.trim()){const T=t.getQueryData(xe.payees(i))||[],j=await ff(i,g,T);j&&t.setQueryData(xe.payees(i),j)}return{updatedMonth:C,newIncome:b}},isPending:e.isPending,isError:e.isError,error:e.error}}function NM(){const t=sn(),{writeData:e}=Wi();return{updateIncome:async(i,a,l,c,h,m,g,_,v)=>{const b=await Yi(i,a,l,"update income"),w=(b.income||[]).find(z=>z.id===c),C=w?.amount??0,T=w?.account_id??m,j={id:c,amount:h,account_id:m,date:g,created_at:(b.income||[]).find(z=>z.id===c)?.created_at||new Date().toISOString()};_?.trim()&&(j.payee=_.trim()),v&&(j.description=v);const B=(b.income||[]).map(z=>z.id===c?j:z),H=Il({...b,income:B,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:H,description:"update income"}),T===m?await Js(i,[{accountId:m,delta:h-C}]):await Js(i,[{accountId:T,delta:-C},{accountId:m,delta:h}]),_?.trim()){const z=t.getQueryData(xe.payees(i))||[],J=await ff(i,_,z);J&&t.setQueryData(xe.payees(i),J)}return{updatedMonth:H}},isPending:e.isPending,isError:e.isError,error:e.error}}function PM(){const{writeData:t}=Wi();return{deleteIncome:async(n,i,a,l)=>{const c=await Yi(n,i,a,"delete income"),h=(c.income||[]).find(b=>b.id===l),m=h?.amount??0,g=h?.account_id,_=(c.income||[]).filter(b=>b.id!==l),v=Il({...c,income:_,updated_at:new Date().toISOString()});return await t.mutateAsync({budgetId:n,month:v,description:"delete income"}),g&&m>0&&await Js(n,[{accountId:g,delta:-m}]),{updatedMonth:v}},isPending:t.isPending,isError:t.isError,error:t.error}}function LM(){const t=sn(),{writeData:e}=Wi();return{addExpense:async(i,a,l,c,h,m,g,_,v,b)=>{const w=await Yi(i,a,l,"add expense"),C={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:c,category_id:h,account_id:m,date:g,created_at:new Date().toISOString()};_?.trim()&&(C.payee=_.trim()),v&&(C.description=v),b!==void 0&&(C.cleared=b);const T=[...w.expenses||[],C],j=Il({...w,expenses:T,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:j,description:"add expense"}),await Js(i,[{accountId:m,delta:-c}]),_?.trim()){const B=t.getQueryData(xe.payees(i))||[],H=await ff(i,_,B);H&&t.setQueryData(xe.payees(i),H)}return{updatedMonth:j,newExpense:C}},isPending:e.isPending,isError:e.isError,error:e.error}}function VM(){const t=sn(),{writeData:e}=Wi();return{updateExpense:async(i,a,l,c,h,m,g,_,v,b,w)=>{const C=await Yi(i,a,l,"update expense"),T=(C.expenses||[]).find($=>$.id===c),j=T?.amount??0,B=T?.account_id??g,H={id:c,amount:h,category_id:m,account_id:g,date:_,created_at:C.expenses?.find($=>$.id===c)?.created_at||new Date().toISOString()};v?.trim()&&(H.payee=v.trim()),b&&(H.description=b),w!==void 0&&(H.cleared=w);const z=(C.expenses||[]).map($=>$.id===c?H:$),J=Il({...C,expenses:z,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:J,description:"update expense"}),B===g?await Js(i,[{accountId:g,delta:j-h}]):await Js(i,[{accountId:B,delta:j},{accountId:g,delta:-h}]),v?.trim()){const $=t.getQueryData(xe.payees(i))||[],re=await ff(i,v,$);re&&t.setQueryData(xe.payees(i),re)}return{updatedMonth:J}},isPending:e.isPending,isError:e.isError,error:e.error}}function zM(){const{writeData:t}=Wi();return{deleteExpense:async(n,i,a,l)=>{const c=await Yi(n,i,a,"delete expense"),h=(c.expenses||[]).find(b=>b.id===l),m=h?.amount??0,g=h?.account_id,_=(c.expenses||[]).filter(b=>b.id!==l),v=Il({...c,expenses:_,updated_at:new Date().toISOString()});return await t.mutateAsync({budgetId:n,month:v,description:"delete expense"}),g&&m>0&&await Js(n,[{accountId:g,delta:m}]),{updatedMonth:v}},isPending:t.isPending,isError:t.isError,error:t.error}}const Lp=new Map;function UM(t){const e=parseInt(t.slice(0,4),10),n=parseInt(t.slice(4,6),10);return{year:e,month:n}}function BM(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{const a=i;e[n]={needs_recalculation:a?.needs_recalculation??!1}}),e}function FM(t){return Object.entries(t).filter(([,e])=>e.needs_recalculation).map(([e])=>e).sort()}function qM(t){return Object.keys(t).sort()}async function HM(t,e){const{year:n,month:i}=UM(e),a=hi(t,n,i),{exists:l,data:c}=await Le("months",a,`[recalc] fetching month ${n}/${i}`);return!l||!c?null:{id:a,budget_id:t,year_month_ordinal:c.year_month_ordinal??Jt(n,i),year:c.year??n,month:c.month??i,income:c.income||[],total_income:c.total_income??0,previous_month_income:c.previous_month_income??0,expenses:c.expenses||[],total_expenses:c.total_expenses??0,account_balances:c.account_balances||[],category_balances:c.category_balances||[],are_allocations_finalized:c.are_allocations_finalized??!1,created_at:c.created_at,updated_at:c.updated_at}}async function GM(t,e){const n=[];for(const i of e){const a=await HM(t,i);a&&n.push(a)}return n}async function Iy(t,e={}){const n=Lp.get(t);if(n)return n;const i=QM(t,e);Lp.set(t,i);try{return await i}finally{Lp.delete(t)}}async function QM(t,e={}){const{exists:n,data:i}=await Le("budgets",t,"[recalc] reading budget for month_map");if(!n||!i)return{monthsRecalculated:0,budgetUpdated:!1};const a=BM(i.month_map),l=FM(a);if(l.length===0&&!i.is_needs_recalculation)return{monthsRecalculated:0,budgetUpdated:!1};const c=qM(a),h=l.length>0?l[0]:null;if(!h)return await nE(t,a),{monthsRecalculated:0,budgetUpdated:!0};const m=c.indexOf(h),g=m>0,_=g?c.slice(m-1):c.slice(m),v=await GM(t,_);if(v.length===0)return await nE(t,a),{monthsRecalculated:0,budgetUpdated:!0};const b=g?1:0,w=v.length-1;let C=vM;g&&v.length>0&&(C=tE(v[0]));let T=0;for(let H=b;H<=w;H++){const z=v[H],J=bM(z,C);await b1({budgetId:t,month:J,description:`[recalc] month ${z.year}/${z.month}`,cascadeRecalculation:!1}),C=tE(J),T++}const j=C.accountEndBalances,B=C.categoryEndBalances;return await $M(t,j,B,a),{monthsRecalculated:T,budgetUpdated:!0,finalAccountBalances:j}}function S1(t){const e={};for(const n of Object.keys(t))e[n]={needs_recalculation:!1};return e}function w1(t,e,n){const i=Object.entries(t).reduce((l,[,c])=>{const h=c.account_group_id?n[c.account_group_id]:void 0,m=h?.on_budget!==void 0?h.on_budget:c.on_budget!==!1,g=h?.is_active!==void 0?h.is_active:c.is_active!==!1;return m&&g?l+(c.balance??0):l},0),a=Object.values(e).reduce((l,c)=>{const h=c.balance??0;return l+(h>0?h:0)},0);return i-a}async function $M(t,e,n,i){const{exists:a,data:l}=await Le("budgets",t,"[recalc] reading budget for balance update");if(!a||!l)return;const c={...l.accounts};for(const[_,v]of Object.entries(e))c[_]&&(c[_]={...c[_],balance:v});const h={...l.categories};for(const[_,v]of Object.entries(n))h[_]&&(h[_]={...h[_],balance:v});const m=w1(c,h,l.account_groups||{}),g=S1(i);await pt("budgets",t,{...l,accounts:c,categories:h,total_available:m,is_needs_recalculation:!1,month_map:g,updated_at:new Date().toISOString()},"[recalc] saving balances and clearing flags"),T1(t,g)}function T1(t,e){const n=xe.budget(t),i=st.getQueryData(n);i&&st.setQueryData(n,{...i,isNeedsRecalculation:!1,monthMap:e,budget:{...i.budget,is_needs_recalculation:!1,month_map:e}})}async function nE(t,e){const{exists:n,data:i}=await Le("budgets",t,"[recalc] reading budget to clear flags");if(!n||!i)return;const a=w1(i.accounts||{},i.categories||{},i.account_groups||{}),l=S1(e);await pt("budgets",t,{...i,total_available:a,is_needs_recalculation:!1,month_map:l,updated_at:new Date().toISOString()},"[recalc] clearing flags"),T1(t,l)}function rE(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname??"",description:i.description??"",balance:i.balance??0,account_group_id:i.account_group_id??null,sort_order:i.sort_order??0,is_income_account:i.is_income_account??!1,is_income_default:i.is_income_default??!1,is_outgo_account:i.is_outgo_account??!1,is_outgo_default:i.is_outgo_default??!1,on_budget:i.on_budget??!0,is_active:i.is_active??!0}}),e}function KM(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order??0,expected_balance:i.expected_balance??"positive",on_budget:i.on_budget,is_active:i.is_active}}),e}function WM(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,description:i.description,category_group_id:i.category_group_id??null,sort_order:i.sort_order??0,default_monthly_amount:i.default_monthly_amount,default_monthly_type:i.default_monthly_type,balance:i.balance??0}}),e}function YM(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,i)=>n.sort_order-i.sort_order),e}function iE(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={needs_recalculation:i?.needs_recalculation??!1}}),e}async function XM(t){const{exists:e,data:n}=await Le("budgets",t,"loading budget data (cache miss or stale)");if(!e||!n)throw new Error(`Budget ${t} not found`);let i=rE(n.accounts);const a=n.is_needs_recalculation??!1;if(a){console.log("[Budget] Balances are stale, triggering full recalculation...");const _=await Iy(t),{data:v}=await Le("budgets",t,"reading budget after recalculation");v&&(i=rE(v.accounts)),console.log("[Budget] Recalculation complete",{monthsRecalculated:_.monthsRecalculated})}const l=KM(n.account_groups),c=WM(n.categories),h=YM(n.category_groups);let m=n.total_available??0,g=iE(n.month_map);if(a){const{data:_}=await Le("budgets",t,"reading budget total_available after recalculation");_?.total_available!==void 0&&(m=_.total_available),_?.month_map&&(g=iE(_.month_map))}return{budget:{id:t,name:n.name,user_ids:n.user_ids||[],accepted_user_ids:n.accepted_user_ids||[],owner_id:n.owner_id||n.user_ids?.[0]||"",owner_email:n.owner_email||"",accounts:i,account_groups:l,categories:c,category_groups:h,total_available:m,is_needs_recalculation:!1,month_map:g},accounts:i,accountGroups:l,categories:c,categoryGroups:h,isNeedsRecalculation:!1,monthMap:g}}function JM(t,e){return bl({queryKey:t?xe.budget(t):["budget","none"],queryFn:()=>XM(t),enabled:!!t&&e?.enabled!==!1})}function ZM(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??Jt(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at,updated_at:t.updated_at}}async function ek(t,e,n,i){const a=hi(t,e,n);return(await st.fetchQuery({queryKey:xe.month(t,e,n),queryFn:async()=>{const{exists:c,data:h}=await Le("months",a,i?.description??`reading month ${e}/${n}`);return!c||!h?null:{month:ZM(h,t,e,n)}},staleTime:SS}))?.month??null}async function Yi(t,e,n,i){const a=hi(t,e,n),l=i?`PRE-EDIT-READ: ${i}`:"PRE-EDIT-READ",{exists:c,data:h}=await Le("months",a,l);if(!c||!h)throw new Error(`Month data not found for ${e}/${n}`);return h}async function tk(t,e,n){const i=Jt(e,n);return(await br("months","getFutureMonths: querying months after specified month",[{field:"budget_id",op:"==",value:t},{field:"year_month_ordinal",op:">",value:i}])).docs.map(c=>({id:c.id,...c.data})).sort((c,h)=>c.year!==h.year?c.year-h.year:c.month-h.month)}function nk(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??Jt(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at,updated_at:t.updated_at}}async function rk(t,e,n){const i=hi(t,e,n),{exists:a,data:l}=await Le("months",i,`loading month ${e}/${n}`);return!a||!l?null:nk(l,t,e,n)}async function ik(t,e,n){const i=await rk(t,e,n);return i||wM(t,e,n)}function sk(t,e,n,i){return bl({queryKey:t?xe.month(t,e,n):["month","none"],queryFn:async()=>({month:await ik(t,e,n)}),enabled:!!t&&i?.enabled!==!1})}async function ak(t){const{exists:e,data:n}=await Le("payees",t,"loading payees for autocomplete (cache miss or stale)");return e&&n?n.payees||[]:[]}function A1(t,e){return bl({queryKey:t?xe.payees(t):["payees","none"],queryFn:()=>ak(t),enabled:!!t&&e?.enabled!==!1})}async function ok(t,e){const{exists:n,data:i}=await Le("users",t,"loading user profile (cache miss or stale)");if(n&&i)return i;const a={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await pt("users",t,a,"creating new user document (first login)"),a}function lk(t,e,n){return bl({queryKey:t?xe.user(t):["user","none"],queryFn:()=>ok(t,e),enabled:!!t&&n?.enabled!==!1})}async function ck(t,e){const n=await br("budgets","loading budgets user has access to (cache miss or stale)",[{field:"user_ids",op:"array-contains",value:t}]),i=[],a=[];for(const l of n.docs){const c=l.data;c.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(l.id)?i.push({id:l.id,name:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null,isOwner:c.owner_id===t,isPending:!1}):a.push({budgetId:l.id,budgetName:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null})}return{budgets:i,pendingInvites:a}}function uk(t,e,n){return bl({queryKey:t?xe.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?ck(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}function dk(t){if(Array.isArray(t))return t;if(t&&typeof t=="object"&&!Array.isArray(t)){const e=t;if(e._methodName==="arrayUnion"&&Array.isArray(e.vc))return console.warn("[fetchFeedback] Found corrupted arrayUnion in feedback document - extracting items from vc"),e.vc}return[]}async function hk(){const t=await br("feedback","admin loading all feedback (cache miss or stale)"),e=[];for(const n of t.docs){const i=dk(n.data.items),a=n.data.user_email||n.id;i.forEach(l=>{e.push({...l,doc_id:n.id,user_email:a})})}return{items:e}}function fk(t){return bl({queryKey:xe.feedback(),queryFn:hk,enabled:t?.enabled!==!1})}async function mk(t,e){return st.fetchQuery({queryKey:["budgetInvite",t,e],queryFn:async()=>{const{exists:n,data:i}=await Le("budgets",t,"checking if user has pending invite for budget");return!n||!i?null:{isInvited:i.user_ids?.includes(e)??!1,hasAccepted:i.accepted_user_ids?.includes(e)??!1,budgetName:i.name||"Unnamed Budget",ownerEmail:i.owner_email||null}},staleTime:60*1e3})}async function Sg(t,e,n){const i=await ek(t,e,n,{description:`fetching month for balance calculation (walking ${e}/${n})`});return i?{year:i.year,month:i.month,category_balances:i.category_balances,are_allocations_finalized:i.are_allocations_finalized,expenses:i.expenses}:null}async function pk(t,e,n,i){const a={};e.forEach(b=>{a[b]=0});const l=await Sg(t,n,i);if(l?.category_balances){for(const b of l.category_balances)e.includes(b.category_id)&&(a[b.category_id]=b.end_balance);return a}const c={};e.forEach(b=>{c[b]=0});const h=[];l&&h.push(l);let m=n,g=i,_=!1;const v=120;for(let b=0;b<v&&!_;b++){const w=Dy(m,g);m=w.year,g=w.month;const C=await Sg(t,m,g);if(!C)_=!0;else if(C.category_balances){_=!0;for(const T of C.category_balances)e.includes(T.category_id)&&(c[T.category_id]=T.end_balance)}else h.push(C)}h.reverse(),Object.assign(a,c);for(const b of h){if(b.are_allocations_finalized&&b.category_balances)for(const w of b.category_balances)e.includes(w.category_id)&&(a[w.category_id]=(a[w.category_id]||0)+w.allocated);if(b.expenses)for(const w of b.expenses)e.includes(w.category_id)&&(a[w.category_id]=(a[w.category_id]||0)-w.amount)}return a}async function gk(t,e,n,i,a){const l={...n};let c=i,h=a;const m=24;for(let g=0;g<m;g++){const _=mM(c,h);c=_.year,h=_.month;const v=await Sg(t,c,h);if(!v)break;if(v.are_allocations_finalized&&v.category_balances)for(const b of v.category_balances)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)+b.allocated);if(v.expenses)for(const b of v.expenses)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)-b.amount)}return l}async function sE(t,e,n,i){const a=await pk(t,e,n,i),l=await gk(t,e,a,n,i);return{current:a,total:l}}function C1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yk=C1,R1=new lu("auth","Firebase",C1());const Nh=new Hg("@firebase/auth");function _k(t,...e){Nh.logLevel<=We.WARN&&Nh.warn(`Auth (${El}): ${t}`,...e)}function fh(t,...e){Nh.logLevel<=We.ERROR&&Nh.error(`Auth (${El}): ${t}`,...e)}function zr(t,...e){throw jy(t,...e)}function fi(t,...e){return jy(t,...e)}function D1(t,e,n){const i={...yk(),[e]:n};return new lu("auth","Firebase",i).create(e,{appName:t.name})}function Hs(t){return D1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jy(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return R1.create(t,...e)}function ke(t,e,...n){if(!t)throw jy(e,...n)}function Vi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw fh(e),new Error(e)}function Qi(t,e){t||Vi(e)}function wg(){return typeof self<"u"&&self.location?.href||""}function vk(){return aE()==="http:"||aE()==="https:"}function aE(){return typeof self<"u"&&self.location?.protocol||null}function bk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vk()||vI()||"connection"in navigator)?navigator.onLine:!0}function xk(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class vu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Qi(n>e,"Short delay should be less than long delay!"),this.isMobile=gI()||bI()}get(){return bk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Oy(t,e){Qi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class I1{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ek={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Sk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],wk=new vu(3e4,6e4);function $a(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ta(t,e,n,i,a={}){return j1(t,a,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const h=cu({key:t.config.apiKey,...c}).slice(1),m=await t._getAdditionalHeaders();m["Content-Type"]="application/json",t.languageCode&&(m["X-Firebase-Locale"]=t.languageCode);const g={method:e,headers:m,...l};return _I()||(g.referrerPolicy="no-referrer"),t.emulatorConfig&&xl(t.emulatorConfig.host)&&(g.credentials="include"),I1.fetch()(await O1(t,t.config.apiHost,n,h),g)})}async function j1(t,e,n){t._canInitEmulator=!1;const i={...Ek,...e};try{const a=new Ak(t),l=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw ih(t,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const h=l.ok?c.errorMessage:c.error.message,[m,g]=h.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw ih(t,"credential-already-in-use",c);if(m==="EMAIL_EXISTS")throw ih(t,"email-already-in-use",c);if(m==="USER_DISABLED")throw ih(t,"user-disabled",c);const _=i[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw D1(t,_,g);zr(t,_)}}catch(a){if(a instanceof Ki)throw a;zr(t,"network-request-failed",{message:String(a)})}}async function mf(t,e,n,i,a={}){const l=await ta(t,e,n,i,a);return"mfaPendingCredential"in l&&zr(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function O1(t,e,n,i){const a=`${e}${n}?${i}`,l=t,c=l.config.emulator?Oy(t.config,a):`${t.config.apiScheme}://${a}`;return Sk.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function Tk(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ak{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(fi(this.auth,"network-request-failed")),wk.get())})}}function ih(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=fi(t,e,i);return a.customData._tokenResponse=n,a}function oE(t){return t!==void 0&&t.enterprise!==void 0}class Ck{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Tk(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Rk(t,e){return ta(t,"GET","/v2/recaptchaConfig",$a(t,e))}async function Dk(t,e){return ta(t,"POST","/v1/accounts:delete",e)}async function Ph(t,e){return ta(t,"POST","/v1/accounts:lookup",e)}function Qc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ik(t,e=!1){const n=un(t),i=await n.getIdToken(e),a=My(i);ke(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l?.sign_in_provider;return{claims:a,token:i,authTime:Qc(Vp(a.auth_time)),issuedAtTime:Qc(Vp(a.iat)),expirationTime:Qc(Vp(a.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Vp(t){return Number(t)*1e3}function My(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return fh("JWT malformed, contained fewer than 3 sections"),null;try{const a=AS(n);return a?JSON.parse(a):(fh("Failed to decode base64 JWT payload"),null)}catch(a){return fh("Caught error parsing JWT payload as JSON",a?.toString()),null}}function lE(t){const e=My(t);return ke(e,"internal-error"),ke(typeof e.exp<"u","internal-error"),ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function tu(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Ki&&jk(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function jk({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class Ok{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Tg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qc(this.lastLoginAt),this.creationTime=Qc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Lh(t){const e=t.auth,n=await t.getIdToken(),i=await tu(t,Ph(e,{idToken:n}));ke(i?.users.length,e,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=a.providerUserInfo?.length?M1(a.providerUserInfo):[],c=kk(t.providerData,l),h=t.isAnonymous,m=!(t.email&&a.passwordHash)&&!c?.length,g=h?m:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Tg(a.createdAt,a.lastLoginAt),isAnonymous:g};Object.assign(t,_)}async function Mk(t){const e=un(t);await Lh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function kk(t,e){return[...t.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function M1(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function Nk(t,e){const n=await j1(t,{},async()=>{const i=cu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,c=await O1(t,a,"/v1/token",`key=${l}`),h=await t._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:h,body:i};return t.emulatorConfig&&xl(t.emulatorConfig.host)&&(m.credentials="include"),I1.fetch()(c,m)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Pk(t,e){return ta(t,"POST","/v2/accounts:revokeToken",$a(t,e))}class Zo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ke(e.idToken,"internal-error"),ke(typeof e.idToken<"u","internal-error"),ke(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):lE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ke(e.length!==0,"internal-error");const n=lE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:a,expiresIn:l}=await Nk(e,n);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:a,expirationTime:l}=n,c=new Zo;return i&&(ke(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),a&&(ke(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(ke(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Zo,this.toJSON())}_performRefresh(){return Vi("not implemented")}}function Is(t,e){ke(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Pr{constructor({uid:e,auth:n,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new Ok(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Tg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await tu(this,this.stsTokenManager.getToken(this.auth,e));return ke(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Ik(this,e)}reload(){return Mk(this)}_assign(e){this!==e&&(ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Pr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Lh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Nr(this.auth.app))return Promise.reject(Hs(this.auth));const e=await this.getIdToken();return await tu(this,Dk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,a=n.email??void 0,l=n.phoneNumber??void 0,c=n.photoURL??void 0,h=n.tenantId??void 0,m=n._redirectEventId??void 0,g=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:v,emailVerified:b,isAnonymous:w,providerData:C,stsTokenManager:T}=n;ke(v&&T,e,"internal-error");const j=Zo.fromJSON(this.name,T);ke(typeof v=="string",e,"internal-error"),Is(i,e.name),Is(a,e.name),ke(typeof b=="boolean",e,"internal-error"),ke(typeof w=="boolean",e,"internal-error"),Is(l,e.name),Is(c,e.name),Is(h,e.name),Is(m,e.name),Is(g,e.name),Is(_,e.name);const B=new Pr({uid:v,auth:e,email:a,emailVerified:b,displayName:i,isAnonymous:w,photoURL:c,phoneNumber:l,tenantId:h,stsTokenManager:j,createdAt:g,lastLoginAt:_});return C&&Array.isArray(C)&&(B.providerData=C.map(H=>({...H}))),m&&(B._redirectEventId=m),B}static async _fromIdTokenResponse(e,n,i=!1){const a=new Zo;a.updateFromServerResponse(n);const l=new Pr({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Lh(l),l}static async _fromGetAccountInfoResponse(e,n,i){const a=n.users[0];ke(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?M1(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!l?.length,h=new Zo;h.updateFromIdToken(i);const m=new Pr({uid:a.localId,auth:e,stsTokenManager:h,isAnonymous:c}),g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Tg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(m,g),m}}const cE=new Map;function zi(t){Qi(t instanceof Function,"Expected a class definition");let e=cE.get(t);return e?(Qi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,cE.set(t,e),e)}class k1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}k1.type="NONE";const uE=k1;function mh(t,e,n){return`firebase:${t}:${e}:${n}`}class el{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=mh(this.userKey,a.apiKey,l),this.fullPersistenceKey=mh("persistence",a.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Ph(this.auth,{idToken:e}).catch(()=>{});return n?Pr._fromGetAccountInfoResponse(this.auth,n,e):null}return Pr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new el(zi(uE),e,i);const a=(await Promise.all(n.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let l=a[0]||zi(uE);const c=mh(i,e.config.apiKey,e.name);let h=null;for(const g of n)try{const _=await g._get(c);if(_){let v;if(typeof _=="string"){const b=await Ph(e,{idToken:_}).catch(()=>{});if(!b)break;v=await Pr._fromGetAccountInfoResponse(e,b,_)}else v=Pr._fromJSON(e,_);g!==l&&(h=v),l=g;break}}catch{}const m=a.filter(g=>g._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new el(l,e,i):(l=m[0],h&&await l._set(c,h.toJSON()),await Promise.all(n.map(async g=>{if(g!==l)try{await g._remove(c)}catch{}})),new el(l,e,i))}}function dE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(V1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(N1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(U1(e))return"Blackberry";if(B1(e))return"Webos";if(P1(e))return"Safari";if((e.includes("chrome/")||L1(e))&&!e.includes("edge/"))return"Chrome";if(z1(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function N1(t=Tn()){return/firefox\//i.test(t)}function P1(t=Tn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function L1(t=Tn()){return/crios\//i.test(t)}function V1(t=Tn()){return/iemobile/i.test(t)}function z1(t=Tn()){return/android/i.test(t)}function U1(t=Tn()){return/blackberry/i.test(t)}function B1(t=Tn()){return/webos/i.test(t)}function ky(t=Tn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Lk(t=Tn()){return ky(t)&&!!window.navigator?.standalone}function Vk(){return xI()&&document.documentMode===10}function F1(t=Tn()){return ky(t)||z1(t)||B1(t)||U1(t)||/windows phone/i.test(t)||V1(t)}function q1(t,e=[]){let n;switch(t){case"Browser":n=dE(Tn());break;case"Worker":n=`${dE(Tn())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${El}/${i}`}class zk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=l=>new Promise((c,h)=>{try{const m=e(l);c(m)}catch(m){h(m)}});i.onAbort=n,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function Uk(t,e={}){return ta(t,"GET","/v2/passwordPolicy",$a(t,e))}const Bk=6;class Fk{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Bk,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class qk{constructor(e,n,i,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hE(this),this.idTokenSubscription=new hE(this),this.beforeStateQueue=new zk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=R1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=zi(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await el.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Ph(this,{idToken:e}),i=await Pr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Nr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,c=i?._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===c)&&h?.user&&(i=h.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Lh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=xk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Nr(this.app))return Promise.reject(Hs(this));const n=e?un(e):null;return n&&ke(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Nr(this.app)?Promise.reject(Hs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Nr(this.app)?Promise.reject(Hs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(zi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Uk(this),n=new Fk(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lu("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await Pk(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&zi(e)||this._popupRedirectResolver;ke(n,this,"argument-error"),this.redirectPersistenceManager=await el.create(this,[zi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,a){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let c=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(h,this,"internal-error"),h.then(()=>{c||l(this.currentUser)}),typeof n=="function"){const m=e.addObserver(n,i,a);return()=>{c=!0,m()}}else{const m=e.addObserver(n);return()=>{c=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=q1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Nr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&_k(`Error while retrieving App Check token: ${e.error}`),e?.token}}function jl(t){return un(t)}class hE{constructor(e){this.auth=e,this.observer=null,this.addObserver=DI(n=>this.observer=n)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let pf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Hk(t){pf=t}function H1(t){return pf.loadJS(t)}function Gk(){return pf.recaptchaEnterpriseScript}function Qk(){return pf.gapiScript}function $k(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Kk{constructor(){this.enterprise=new Wk}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Wk{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Yk="recaptcha-enterprise",G1="NO_RECAPTCHA";class Xk{constructor(e){this.type=Yk,this.auth=jl(e)}async verify(e="verify",n=!1){async function i(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,h)=>{Rk(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const g=new Ck(m);return l.tenantId==null?l._agentRecaptchaConfig=g:l._tenantRecaptchaConfigs[l.tenantId]=g,c(g.siteKey)}}).catch(m=>{h(m)})})}function a(l,c,h){const m=window.grecaptcha;oE(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(g=>{c(g)}).catch(()=>{c(G1)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Kk().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(h=>{if(!n&&oE(window.grecaptcha))a(h,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let m=Gk();m.length!==0&&(m+=h),H1(m).then(()=>{a(h,l,c)}).catch(g=>{c(g)})}}).catch(h=>{c(h)})})}}async function fE(t,e,n,i=!1,a=!1){const l=new Xk(t);let c;if(a)c=G1;else try{c=await l.verify(n)}catch{c=await l.verify(n,!0)}const h={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const m=h.phoneEnrollmentInfo.phoneNumber,g=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:g,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const m=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return i?Object.assign(h,{captchaResp:c}):Object.assign(h,{captchaResponse:c}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function mE(t,e,n,i,a){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await fE(t,e,n,n==="getOobCode");return i(t,l)}else return i(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await fE(t,e,n,n==="getOobCode");return i(t,c)}else return Promise.reject(l)})}function Jk(t,e){const n=Qg(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),l=n.getOptions();if(Gs(l,e??{}))return a;zr(a,"already-initialized")}return n.initialize({options:e})}function Zk(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(zi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function eN(t,e,n){const i=jl(t);ke(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=Q1(e),{host:c,port:h}=tN(e),m=h===null?"":`:${h}`,g={url:`${l}//${c}${m}/`},_=Object.freeze({host:c,port:h,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){ke(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),ke(Gs(g,i.config.emulator)&&Gs(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,xl(c)?(IS(`${l}//${c}${m}`),jS("Auth",!0)):nN()}function Q1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function tN(t){const e=Q1(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:pE(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:pE(c)}}}function pE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function nN(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Ny{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Vi("not implemented")}_getIdTokenResponse(e){return Vi("not implemented")}_linkToIdToken(e,n){return Vi("not implemented")}_getReauthenticationResolver(e){return Vi("not implemented")}}async function rN(t,e){return ta(t,"POST","/v1/accounts:signUp",e)}async function iN(t,e){return mf(t,"POST","/v1/accounts:signInWithPassword",$a(t,e))}async function sN(t,e){return mf(t,"POST","/v1/accounts:signInWithEmailLink",$a(t,e))}async function aN(t,e){return mf(t,"POST","/v1/accounts:signInWithEmailLink",$a(t,e))}class nu extends Ny{constructor(e,n,i,a=null){super("password",i),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new nu(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new nu(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return mE(e,n,"signInWithPassword",iN);case"emailLink":return sN(e,{email:this._email,oobCode:this._password});default:zr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return mE(e,i,"signUpPassword",rN);case"emailLink":return aN(e,{idToken:n,email:this._email,oobCode:this._password});default:zr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function tl(t,e){return mf(t,"POST","/v1/accounts:signInWithIdp",$a(t,e))}const oN="http://localhost";class Fa extends Ny{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Fa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):zr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=n;if(!i||!a)return null;const c=new Fa(i,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const n=this.buildRequest();return tl(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,tl(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,tl(e,n)}buildRequest(){const e={requestUri:oN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=cu(n)}return e}}function lN(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function cN(t){const e=Nc(Pc(t)).link,n=e?Nc(Pc(e)).deep_link_id:null,i=Nc(Pc(t)).deep_link_id;return(i?Nc(Pc(i)).link:null)||i||n||e||t}class Py{constructor(e){const n=Nc(Pc(e)),i=n.apiKey??null,a=n.oobCode??null,l=lN(n.mode??null);ke(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=cN(e);try{return new Py(n)}catch{return null}}}class Ol{constructor(){this.providerId=Ol.PROVIDER_ID}static credential(e,n){return nu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Py.parseLink(n);return ke(i,"argument-error"),nu._fromEmailAndCode(e,i.code,i.tenantId)}}Ol.PROVIDER_ID="password";Ol.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ol.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class $1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class bu extends $1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ms extends bu{constructor(){super("facebook.com")}static credential(e){return Fa._fromParams({providerId:Ms.PROVIDER_ID,signInMethod:Ms.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ms.credentialFromTaggedObject(e)}static credentialFromError(e){return Ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ms.credential(e.oauthAccessToken)}catch{return null}}}Ms.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ms.PROVIDER_ID="facebook.com";class ks extends bu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Fa._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return ks.credential(n,i)}catch{return null}}}ks.GOOGLE_SIGN_IN_METHOD="google.com";ks.PROVIDER_ID="google.com";class Ns extends bu{constructor(){super("github.com")}static credential(e){return Fa._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ns.credentialFromTaggedObject(e)}static credentialFromError(e){return Ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ns.credential(e.oauthAccessToken)}catch{return null}}}Ns.GITHUB_SIGN_IN_METHOD="github.com";Ns.PROVIDER_ID="github.com";class Ps extends bu{constructor(){super("twitter.com")}static credential(e,n){return Fa._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Ps.credential(n,i)}catch{return null}}}Ps.TWITTER_SIGN_IN_METHOD="twitter.com";Ps.PROVIDER_ID="twitter.com";class dl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,a=!1){const l=await Pr._fromIdTokenResponse(e,i,a),c=gE(i);return new dl({user:l,providerId:c,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const a=gE(i);return new dl({user:e,providerId:a,_tokenResponse:i,operationType:n})}}function gE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Vh extends Ki{constructor(e,n,i,a){super(n.code,n.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Vh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,a){return new Vh(e,n,i,a)}}function K1(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Vh._fromErrorAndOperation(t,l,e,i):l})}async function uN(t,e,n=!1){const i=await tu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return dl._forOperation(t,"link",i)}async function dN(t,e,n=!1){const{auth:i}=t;if(Nr(i.app))return Promise.reject(Hs(i));const a="reauthenticate";try{const l=await tu(t,K1(i,a,e,t),n);ke(l.idToken,i,"internal-error");const c=My(l.idToken);ke(c,i,"internal-error");const{sub:h}=c;return ke(t.uid===h,i,"user-mismatch"),dl._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&zr(i,"user-mismatch"),l}}async function W1(t,e,n=!1){if(Nr(t.app))return Promise.reject(Hs(t));const i="signIn",a=await K1(t,i,e),l=await dl._fromIdTokenResponse(t,i,a);return n||await t._updateCurrentUser(l.user),l}async function hN(t,e){return W1(jl(t),e)}async function fN(t){const e=jl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function mN(t,e,n){return Nr(t.app)?Promise.reject(Hs(t)):hN(un(t),Ol.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&fN(t),i})}function pN(t,e,n,i){return un(t).onIdTokenChanged(e,n,i)}function gN(t,e,n){return un(t).beforeAuthStateChanged(e,n)}function yN(t,e,n,i){return un(t).onAuthStateChanged(e,n,i)}function _N(t){return un(t).signOut()}const zh="__sak";class Y1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(zh,"1"),this.storage.removeItem(zh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const vN=1e3,bN=10;class X1 extends Y1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=F1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),a=this.localCache[n];i!==a&&e(n,a,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((c,h,m)=>{this.notifyListeners(c,m)});return}const i=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(i);!n&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);Vk()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,bN):a()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},vN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}X1.type="LOCAL";const xN=X1;class J1 extends Y1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}J1.type="SESSION";const Z1=J1;function EN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class gf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const i=new gf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:a,data:l}=n.data,c=this.handlersMap[a];if(!c?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const h=Array.from(c).map(async g=>g(n.origin,l)),m=await EN(h);n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:m})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}gf.receivers=[];function Ly(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class SN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((h,m)=>{const g=Ly("",20);a.port1.start();const _=setTimeout(()=>{m(new Error("unsupported_event"))},i);c={messageChannel:a,onMessage(v){const b=v;if(b.data.eventId===g)switch(b.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),h(b.data.response);break;default:clearTimeout(_),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:g,data:n},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function mi(){return window}function wN(t){mi().location.href=t}function eT(){return typeof mi().WorkerGlobalScope<"u"&&typeof mi().importScripts=="function"}async function TN(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function AN(){return navigator?.serviceWorker?.controller||null}function CN(){return eT()?self:null}const tT="firebaseLocalStorageDb",RN=1,Uh="firebaseLocalStorage",nT="fbase_key";class xu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function yf(t,e){return t.transaction([Uh],e?"readwrite":"readonly").objectStore(Uh)}function DN(){const t=indexedDB.deleteDatabase(tT);return new xu(t).toPromise()}function Ag(){const t=indexedDB.open(tT,RN);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Uh,{keyPath:nT})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Uh)?e(i):(i.close(),await DN(),e(await Ag()))})})}async function yE(t,e,n){const i=yf(t,!0).put({[nT]:e,value:n});return new xu(i).toPromise()}async function IN(t,e){const n=yf(t,!1).get(e),i=await new xu(n).toPromise();return i===void 0?null:i.value}function _E(t,e){const n=yf(t,!0).delete(e);return new xu(n).toPromise()}const jN=800,ON=3;class rT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ag(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>ON)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return eT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=gf._getInstance(CN()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await TN(),!this.activeServiceWorker)return;this.sender=new SN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||AN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ag();return await yE(e,zh,"1"),await _E(e,zh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>yE(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>IN(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>_E(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=yf(a,!1).getAll();return new xu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}rT.type="LOCAL";const MN=rT;new vu(3e4,6e4);function kN(t,e){return e?zi(e):(ke(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Vy extends Ny{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return tl(e,this._buildIdpRequest())}_linkToIdToken(e,n){return tl(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return tl(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function NN(t){return W1(t.auth,new Vy(t),t.bypassAuthState)}function PN(t){const{auth:e,user:n}=t;return ke(n,e,"internal-error"),dN(n,new Vy(t),t.bypassAuthState)}async function LN(t){const{auth:e,user:n}=t;return ke(n,e,"internal-error"),uN(n,new Vy(t),t.bypassAuthState)}class iT{constructor(e,n,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:a,tenantId:l,error:c,type:h}=e;if(c){this.reject(c);return}const m={auth:this.auth,requestUri:n,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(m))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return NN;case"linkViaPopup":case"linkViaRedirect":return LN;case"reauthViaPopup":case"reauthViaRedirect":return PN;default:zr(this.auth,"internal-error")}}resolve(e){Qi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const VN=new vu(2e3,1e4);class Yo extends iT{constructor(e,n,i,a,l){super(e,n,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Yo.currentPopupAction&&Yo.currentPopupAction.cancel(),Yo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ke(e,this.auth,"internal-error"),e}async onExecution(){Qi(this.filter.length===1,"Popup operations only handle one event");const e=Ly();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(fi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(fi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Yo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,VN.get())};e()}}Yo.currentPopupAction=null;const zN="pendingRedirect",ph=new Map;class UN extends iT{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=ph.get(this.auth._key());if(!e){try{const i=await BN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}ph.set(this.auth._key(),e)}return this.bypassAuthState||ph.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function BN(t,e){const n=HN(e),i=qN(t);if(!await i._isAvailable())return!1;const a=await i._get(n)==="true";return await i._remove(n),a}function FN(t,e){ph.set(t._key(),e)}function qN(t){return zi(t._redirectPersistence)}function HN(t){return mh(zN,t.config.apiKey,t.name)}async function GN(t,e,n=!1){if(Nr(t.app))return Promise.reject(Hs(t));const i=jl(t),a=kN(i,e),c=await new UN(i,a,n).execute();return c&&!n&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}const QN=600*1e3;class $N{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KN(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!sT(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(fi(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=QN&&this.cachedEventUids.clear(),this.cachedEventUids.has(vE(e))}saveEventToCache(e){this.cachedEventUids.add(vE(e)),this.lastProcessedEventTime=Date.now()}}function vE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function sT({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function KN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return sT(t);default:return!1}}async function WN(t,e={}){return ta(t,"GET","/v1/projects",e)}const YN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,XN=/^https?/;async function JN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await WN(t);for(const n of e)try{if(ZN(n))return}catch{}zr(t,"unauthorized-domain")}function ZN(t){const e=wg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&c.hostname===i}if(!XN.test(n))return!1;if(YN.test(t))return i===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const e4=new vu(3e4,6e4);function bE(){const t=mi().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function t4(t){return new Promise((e,n)=>{function i(){bE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{bE(),n(fi(t,"network-request-failed"))},timeout:e4.get()})}if(mi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(mi().gapi?.load)i();else{const a=$k("iframefcb");return mi()[a]=()=>{gapi.load?i():n(fi(t,"network-request-failed"))},H1(`${Qk()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw gh=null,e})}let gh=null;function n4(t){return gh=gh||t4(t),gh}const r4=new vu(5e3,15e3),i4="__/auth/iframe",s4="emulator/auth/iframe",a4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},o4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function l4(t){const e=t.config;ke(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Oy(e,s4):`https://${t.config.authDomain}/${i4}`,i={apiKey:e.apiKey,appName:t.name,v:El},a=o4.get(t.config.apiHost);a&&(i.eid=a);const l=t._getFrameworks();return l.length&&(i.fw=l.join(",")),`${n}?${cu(i).slice(1)}`}async function c4(t){const e=await n4(t),n=mi().gapi;return ke(n,t,"internal-error"),e.open({where:document.body,url:l4(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:a4,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const c=fi(t,"network-request-failed"),h=mi().setTimeout(()=>{l(c)},r4.get());function m(){mi().clearTimeout(h),a(i)}i.ping(m).then(m,()=>{l(c)})}))}const u4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},d4=500,h4=600,f4="_blank",m4="http://localhost";class xE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function p4(t,e,n,i=d4,a=h4){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const m={...u4,width:i.toString(),height:a.toString(),top:l,left:c},g=Tn().toLowerCase();n&&(h=L1(g)?f4:n),N1(g)&&(e=e||m4,m.scrollbars="yes");const _=Object.entries(m).reduce((b,[w,C])=>`${b}${w}=${C},`,"");if(Lk(g)&&h!=="_self")return g4(e||"",h),new xE(null);const v=window.open(e||"",h,_);ke(v,t,"popup-blocked");try{v.focus()}catch{}return new xE(v)}function g4(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const y4="__/auth/handler",_4="emulator/auth/handler",v4=encodeURIComponent("fac");async function EE(t,e,n,i,a,l){ke(t.config.authDomain,t,"auth-domain-config-required"),ke(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:El,eventId:a};if(e instanceof $1){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",RI(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))c[_]=v}if(e instanceof bu){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(c.scopes=_.join(","))}t.tenantId&&(c.tid=t.tenantId);const h=c;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const m=await t._getAppCheckToken(),g=m?`#${v4}=${encodeURIComponent(m)}`:"";return`${b4(t)}?${cu(h).slice(1)}${g}`}function b4({config:t}){return t.emulator?Oy(t,_4):`https://${t.authDomain}/${y4}`}const zp="webStorageSupport";class x4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Z1,this._completeRedirectFn=GN,this._overrideRedirectResult=FN}async _openPopup(e,n,i,a){Qi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await EE(e,n,i,wg(),a);return p4(e,l,Ly())}async _openRedirect(e,n,i,a){await this._originValidation(e);const l=await EE(e,n,i,wg(),a);return wN(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:l}=this.eventManagers[n];return a?Promise.resolve(a):(Qi(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await c4(e),i=new $N(e);return n.register("authEvent",a=>(ke(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(zp,{type:zp},a=>{const l=a?.[0]?.[zp];l!==void 0&&n(!!l),zr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=JN(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return F1()||P1()||ky()}}const E4=x4;var SE="@firebase/auth",wE="1.12.0";class S4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function w4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function T4(t){rl(new za("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:h}=i.options;ke(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const m={apiKey:c,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:q1(t)},g=new qk(i,a,l,m);return Zk(g,n),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),rl(new za("auth-internal",e=>{const n=jl(e.getProvider("auth").getImmediate());return(i=>new S4(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Bs(SE,wE,w4(t)),Bs(SE,wE,"esm2020")}const A4=300,C4=DS("authIdTokenMaxAge")||A4;let TE=null;const R4=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>C4)return;const a=n?.token;TE!==a&&(TE=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function D4(t=NS()){const e=Qg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Jk(t,{popupRedirectResolver:E4,persistence:[MN,xN,Z1]}),i=DS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=R4(l.toString());gN(n,c,()=>c(n.currentUser)),pN(n,h=>c(h))}}const a=CS("auth");return a&&eN(n,`http://${a}`),n}function I4(){return document.getElementsByTagName("head")?.[0]??document}Hk({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=a=>{const l=fi("internal-error");l.customData=a,n(l)},i.type="text/javascript",i.charset="UTF-8",I4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});T4("Browser");function Ka(){const t=D4(VS);async function e(){return!1}async function n(h,m){return mN(t,h,m)}function i(){return _N(t)}function a(h){yN(t,m=>{h(m)})}function l(){return t.currentUser}return{set_user_listener:a,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:i,get_current_firebase_user:l}}const j4={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,lastActiveTab:"categories",lastSettingsTab:"categories",lastAdminTab:"budget",setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},setLastActiveTab:()=>{},setLastSettingsTab:()=>{},setLastAdminTab:()=>{},pageTitle:"Budget",setPageTitle:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},aT=A.createContext(j4);function O4({children:t}){const n=Ka().get_current_firebase_user(),[i,a]=A.useState(null),[l,c]=A.useState(new Date().getFullYear()),[h,m]=A.useState(new Date().getMonth()+1),[g,_]=A.useState("categories"),[v,b]=A.useState("categories"),[w,C]=A.useState("budget"),[T,j]=A.useState("Budget"),B=A.useCallback(U=>{j(F=>F===U?F:U)},[]),[H,z]=A.useState(!1),[J,$]=A.useState(!1),re=lk(n?.uid||null,n?.email||null),P=re.data&&re.data.budget_ids.length===0,R=uk(n?.uid||null,re.data||null,{enabled:!!n?.uid&&!!re.data&&P}),D=re.data?.permission_flags?.is_admin===!0,N=re.data?.permission_flags?.is_test===!0,M=R.data?.pendingInvites||[],k=R.data?.budgets||[],I=M.length>0;A.useEffect(()=>{if(!n||H||re.isLoading)return;const U=re.data;if(!(!U&&!re.isError))if(U&&U.budget_ids.length>0)a(U.budget_ids[0]),$(!1),z(!0);else{if(R.isLoading)return;const F=R.data;F?.pendingInvites&&F.pendingInvites.length>0?$(!1):$(!0),z(!0)}},[n,H,re.data,re.isLoading,re.isError,R.data,R.isLoading]);const ae=A.useCallback(()=>{h===1?(c(U=>U-1),m(12)):m(U=>U-1)},[h]),q=A.useCallback(()=>{h===12?(c(U=>U+1),m(1)):m(U=>U+1)},[h]),L=A.useCallback(async()=>{await R.refetch()},[R]),Q=A.useCallback(U=>{a(U)},[]),K=A.useCallback(async U=>{if(!n)return null;try{const F=await mk(U,n.uid);return F&&F.isInvited&&!F.hasAccepted?{budgetId:U,budgetName:F.budgetName,ownerEmail:F.ownerEmail}:null}catch(F){return console.error("[BudgetContext] Error checking budget invite:",F),null}},[n]),oe=A.useCallback(()=>{localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),ue={currentUserId:n?.uid||null,selectedBudgetId:i,currentYear:l,currentMonthNumber:h,lastActiveTab:g,lastSettingsTab:v,lastAdminTab:w,setSelectedBudgetId:a,setCurrentYear:c,setCurrentMonthNumber:m,setLastActiveTab:_,setLastSettingsTab:b,setLastAdminTab:C,pageTitle:T,setPageTitle:B,isInitialized:H,needsFirstBudget:J,goToPreviousMonth:ae,goToNextMonth:q,pendingInvites:M,hasPendingInvites:I,accessibleBudgets:k,isAdmin:D,isTest:N,loadAccessibleBudgets:L,switchToBudget:Q,checkBudgetInvite:K,clearCache:oe};return d.jsx(aT.Provider,{value:ue,children:t})}function Zt(){const t=A.useContext(aT);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}const Ma={mobile:640,tablet:768,wide:1200},M4=Ma.mobile,nl=["January","February","March","April","May","June","July","August","September","October","November","December"],ce={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15",debt:"#fb923c",debtBg:"rgba(251, 146, 60, 0.1)",debtBorder:"rgba(251, 146, 60, 0.5)",zero:"rgba(255, 255, 255, 0.4)"},ru={maxWidth:"var(--page-max-width, 85rem)",margin:"0 auto",padding:"var(--page-padding, 2rem)"},Eu={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},k4={...Eu,padding:"0.6rem 0.875rem",gap:"0.5rem"},N4={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},P4={display:"flex",flexDirection:"column",gap:"0.5rem"},L4={fontSize:"0.9rem",fontWeight:500},Wa={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",width:"100%",boxSizing:"border-box"},V4={...Wa,cursor:"pointer"},zy={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},oT={...zy,background:ce.primary,color:"white",border:"none"},z4={...oT,padding:"0.75rem 1.5rem",borderRadius:"8px"},U4={...zy,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},B4={...zy,background:"transparent",border:`1px solid ${ce.errorBorder}`,color:ce.error},F4={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},q4={display:"flex",gap:"0.5rem"},H4={display:"flex",gap:"0.25rem"},lT={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},G4={...lT,borderColor:ce.errorBorder,color:ce.error},hl={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},Uy={display:"flex",flexDirection:"column",gap:"2px"},Q4={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},cT={opacity:.4,cursor:"grab"},uT={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",transition:"opacity 0.15s"},$4={position:"relative",height:"2rem",marginTop:"-0.25rem"},K4={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",transition:"opacity 0.15s"},W4={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},Y4={background:ce.errorBg,border:`1px solid ${ce.errorBorder}`,color:ce.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},X4={background:"transparent",border:"none",color:ce.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},dT={opacity:.7,marginBottom:"1.5rem"},_f={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},By={fontWeight:500,fontSize:"1.1rem"},fl={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function J4(){return d.jsxs("div",{style:ru,children:[d.jsx("nav",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:d.jsx(wt,{to:"/",style:{display:"flex",alignItems:"center"},title:"Tarron Lane Home",children:d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane Home",style:{width:"2rem",height:"2rem"}})})}),d.jsx("h1",{children:"Tarron Lane Homepage"}),d.jsx("nav",{children:d.jsxs("ul",{children:[d.jsx("li",{children:d.jsx(wt,{to:"/sql-test",children:"SQL Test"})}),d.jsx("li",{children:d.jsx(wt,{to:"/budget",children:"Budget"})}),d.jsx("li",{children:d.jsx(wt,{to:"/account",children:"Account"})})]})})]})}function Ya({message:t,children:e,onDismiss:n,style:i}){return d.jsxs("div",{style:{...Y4,...i},children:[d.jsx("span",{children:e??t}),n&&d.jsx("button",{onClick:n,style:X4,children:""})]})}const Z4={primary:oT,"primary-large":z4,secondary:U4,danger:B4,small:F4};function Me({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:i,disabled:a,style:l,actionName:c,onClick:h,...m}){const g=Z4[t],_=a||e;function v(b){h?.(b)}return d.jsx("button",{disabled:_,style:{...g,cursor:_?"not-allowed":"pointer",opacity:_?.7:1,...l},onClick:v,...m,children:e?n:i})}function Cg(t,e){const n=t.toLowerCase(),i=e.toLowerCase();if(i.includes(n)){const h=i.indexOf(n);return{match:!0,score:h===0||/\s/.test(i[h-1])?100:90}}let a=0,l=0,c=0;for(let h=0;h<i.length&&a<n.length;h++)i[h]===n[a]?(a++,c++,l+=c*2):c=0;return a===n.length?{match:!0,score:l}:{match:!1,score:0}}function AE({id:t,value:e,onChange:n,payees:i,placeholder:a="Enter payee name"}){const[l,c]=A.useState(!1),[h,m]=A.useState(-1),g=A.useRef(null),_=A.useRef(null),v=e.trim()?i.map(C=>({payee:C,...Cg(e,C)})).filter(C=>C.match).sort((C,T)=>T.score-C.score).slice(0,8).map(C=>C.payee):[];A.useEffect(()=>{function C(T){g.current&&!g.current.contains(T.target)&&c(!1)}return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);function b(C){!l||v.length===0||(C.key==="ArrowDown"?(C.preventDefault(),m(T=>Math.min(T+1,v.length-1))):C.key==="ArrowUp"?(C.preventDefault(),m(T=>Math.max(T-1,-1))):C.key==="Enter"&&h>=0?(C.preventDefault(),n(v[h]),c(!1),m(-1)):C.key==="Escape"&&(c(!1),m(-1)))}function w(C){n(C),c(!1),m(-1),_.current?.focus()}return d.jsxs("div",{ref:g,style:{position:"relative"},children:[d.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:C=>{n(C.target.value),c(!0),m(-1)},onFocus:()=>c(!0),onKeyDown:b,placeholder:a,autoComplete:"off",style:Wa}),l&&v.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:v.map((C,T)=>d.jsx("div",{onClick:()=>w(C),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:T===h?`color-mix(in srgb, ${ce.primary} 20%, transparent)`:"transparent",borderBottom:T<v.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>m(T),children:C},C))})]})}function e6({id:t,value:e,onChange:n,categories:i,categoryGroups:a,placeholder:l="Search categories...",required:c}){const h=Object.fromEntries(a.map(k=>[k.id,k.name])),m=Object.entries(i).map(([k,I])=>({id:k,name:I.name,groupId:I.category_group_id,groupName:I.category_group_id&&h[I.category_group_id]||null,sortOrder:I.sort_order})),_=(e?i[e]:null)?.name||"",[v,b]=A.useState(_),[w,C]=A.useState(!1),[T,j]=A.useState(-1),B=A.useRef(null),H=A.useRef(null);A.useEffect(()=>{const k=e?i[e]:null;b(k?.name||"")},[e,i]);const z=v.trim()?m.map(k=>({...k,...Cg(v,k.name),groupMatch:k.groupName?Cg(v,k.groupName):{match:!1,score:0}})).filter(k=>k.match||k.groupMatch.match).sort((k,I)=>{const ae=Math.max(k.score,k.groupMatch.score*.5),q=Math.max(I.score,I.groupMatch.score*.5);if(q!==ae)return q-ae;if(k.groupId!==I.groupId){if(!k.groupId)return 1;if(!I.groupId)return-1;const L=(k.groupName||"").localeCompare(I.groupName||"");return L!==0?L:k.groupId.localeCompare(I.groupId)}return k.sortOrder-I.sortOrder}).slice(0,10):[...m].sort((k,I)=>{if(k.groupId!==I.groupId){if(!k.groupId)return 1;if(!I.groupId)return-1;const ae=(k.groupName||"").localeCompare(I.groupName||"");return ae!==0?ae:k.groupId.localeCompare(I.groupId)}return k.sortOrder-I.sortOrder}).slice(0,10);A.useEffect(()=>{function k(I){if(B.current&&!B.current.contains(I.target)){C(!1);const ae=e?i[e]:null;b(ae?.name||"")}}return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[e,i]);function J(k){if(k.key==="ArrowDown")k.preventDefault(),w?j(I=>Math.min(I+1,z.length-1)):(C(!0),j(0));else if(k.key==="ArrowUp")k.preventDefault(),j(I=>Math.max(I-1,0));else if(k.key==="Enter")k.preventDefault(),w&&T>=0&&z[T]&&$(z[T]);else if(k.key==="Escape"){C(!1),j(-1);const I=e?i[e]:null;b(I?.name||"")}else if(k.key==="Tab"&&w&&z.length>0){const I=T>=0?T:0;$(z[I])}}function $(k){n(k.id),b(k.name),C(!1),j(-1),H.current?.focus()}function re(k){const I=k.target.value;b(I),C(!0),j(-1),I!==_&&n("")}function P(){C(!0),z.length>0&&j(0)}const R=[];let D="__initial__";z.forEach(k=>{k.groupId!==D&&(D=k.groupId,R.push({groupId:k.groupId,groupName:k.groupName,items:[]})),R[R.length-1].items.push(k)});let N=-1;const M=()=>++N;return d.jsxs("div",{ref:B,style:{position:"relative"},children:[d.jsx("input",{ref:H,id:t,type:"text",value:v,onChange:re,onFocus:P,onKeyDown:J,placeholder:l,autoComplete:"off",required:c,style:{...Wa,borderColor:c&&!e?ce.error:void 0}}),w&&z.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"250px",overflowY:"auto"},children:R.map((k,I)=>d.jsxs("div",{children:[k.groupName&&d.jsx("div",{style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6,background:"color-mix(in srgb, currentColor 5%, transparent)",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:k.groupName}),k.items.map(ae=>{const q=M();return d.jsx("div",{onClick:()=>$(ae),style:{padding:"0.6rem 0.8rem",paddingLeft:k.groupName?"1.2rem":"0.8rem",cursor:"pointer",background:q===T?`color-mix(in srgb, ${ce.primary} 20%, transparent)`:"transparent",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",transition:"background 0.1s"},onMouseEnter:()=>j(q),children:ae.name},ae.id)})]},`group-${I}`))}),w&&z.length===0&&v.trim()&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,padding:"0.6rem 0.8rem",opacity:.6,fontStyle:"italic"},children:"No matching categories"})]})}function qa({children:t,onSubmit:e,actionName:n}){function i(a){e(a)}return d.jsx("form",{onSubmit:i,style:N4,children:t})}function Wt({label:t,htmlFor:e,children:n,hint:i,style:a}){return d.jsxs("div",{style:{...P4,...a},children:[d.jsx("label",{htmlFor:e,style:L4,children:t}),n,i&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:i})]})}function Ha(t){return d.jsx("input",{style:Wa,...t})}function t6(t){if(!t)return"";try{return new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return t}}function CE({value:t,onChange:e,style:n,...i}){const a=A.useRef(null),l=t6(t);function c(){a.current?.showPicker?.()}return d.jsxs("div",{style:{position:"relative"},children:[d.jsx("input",{ref:a,type:"date",value:t||"",onChange:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,pointerEvents:"none"},...i}),d.jsx("div",{onClick:c,style:{...Wa,cursor:"pointer",display:"flex",alignItems:"center",fontSize:"0.85rem",fontFamily:"monospace",color:t?"inherit":"color-mix(in srgb, currentColor 50%, transparent)",...n},children:l||"Select date"})]})}function iu({children:t,...e}){return d.jsx("select",{style:V4,...e,children:t})}function Fy({minHeight:t="6rem",style:e,...n}){return d.jsx("textarea",{style:{...Wa,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function Xa({children:t}){return d.jsx("div",{style:Q4,children:t})}function Up(t){const n=t.replace(/[^\d.]/g,"").split("."),i=n[0]||"",a=n[1],l=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return a!==void 0?`$${l}.${a.slice(0,2)}`:l?`$${l}`:""}function n6(t){return t.replace(/[$,]/g,"")}function Rg({id:t,value:e,onChange:n,placeholder:i="$0.00",required:a,autoFocus:l}){const[c,h]=A.useState(()=>Up(e)),m=A.useRef(null);A.useEffect(()=>{const _=Up(e);n6(c)!==e&&h(_)},[e]);function g(_){const v=_.target.value;if(!v||v==="$"){h(""),n("");return}const w=v.replace(/[^\d.]/g,"").split(".");let C=w[0];w.length>1&&(C+="."+w.slice(1).join("").slice(0,2));const T=Up(C);h(T),n(C)}return d.jsx("input",{ref:m,id:t,type:"text",inputMode:"decimal",value:c,onChange:g,placeholder:i,required:a,autoFocus:l,style:Wa})}function na(t=M4){const[e,n]=A.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return A.useEffect(()=>{const i=window.matchMedia(`(max-width: ${t-1}px)`);function a(c){n(c.matches)}a(i),i.addEventListener("change",a);function l(){n(window.innerWidth<t)}return window.addEventListener("resize",l),()=>{i.removeEventListener("change",a),window.removeEventListener("resize",l)}},[t]),e}function vf({children:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:h,onEdit:m,onDelete:g,onMoveUp:_,onMoveDown:v,canMoveUp:b=!0,canMoveDown:w=!0,itemName:C}){const T=na(),j=_||v;return d.jsxs("div",{onDragOver:B=>{B.stopPropagation(),a(B)},onDragLeave:B=>{B.stopPropagation(),l()},onDrop:B=>{B.stopPropagation(),h(B)},style:{position:"relative"},children:[d.jsx("div",{style:{...uT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{style:{...T?k4:Eu,opacity:e?.5:1},children:[d.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:T?"0.5rem":"0.75rem",minWidth:0},children:[d.jsx("span",{draggable:!0,onDragStart:B=>{i(B)},onDragEnd:()=>{c()},style:{...cT,fontSize:T?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),d.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),d.jsxs("div",{style:T?H4:q4,children:[T?d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>{m()},style:lT,title:"Edit","aria-label":"Edit",children:""}),d.jsx("button",{onClick:()=>{g()},style:G4,title:"Delete","aria-label":"Delete",children:""})]}):d.jsxs(d.Fragment,{children:[d.jsx(Me,{variant:"secondary",actionName:`Edit ${C||"Item"}`,onClick:m,children:"Edit"}),d.jsx(Me,{variant:"danger",actionName:`Delete ${C||"Item"}`,onClick:g,children:"Delete"})]}),j&&d.jsxs("div",{style:Uy,children:[d.jsx("button",{onClick:B=>{B.stopPropagation(),_?.()},disabled:!b,style:{...hl,opacity:b?.6:.2,cursor:b?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:B=>{B.stopPropagation(),v?.()},disabled:!w,style:{...hl,opacity:w?.6:.2,cursor:w?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function qy({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i,label:a="Move to end"}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:$4,children:[d.jsx("div",{style:{...K4,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:W4,children:a})]})}function Se(t){return`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function It(t){return t===0?ce.zero:t>0?ce.success:ce.danger}function In(t){return t===0?ce.zero:t>0?ce.success:ce.debt}function $i(t){return t===0?ce.zero:t>0?ce.error:ce.success}function bf(t){return t>0?ce.success:ce.zero}function hT(){const t=sn();return{submitFeedback:rr({mutationFn:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:c})=>{const h=i||n,m={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`${a}

(Submitted from: ${c})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l},{exists:g}=await Le("feedback",h,"checking if user has existing feedback document");return g?await pt("feedback",h,{items:fM(m),user_email:i,updated_at:new Date().toISOString()},"adding new feedback item to existing document",{merge:!0}):await pt("feedback",h,{items:[m],user_email:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},"creating new feedback document for user"),{feedbackItem:m,docId:h}},onMutate:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:c})=>{await t.cancelQueries({queryKey:xe.feedback()});const h=t.getQueryData(xe.feedback()),m=i||n,g={id:`feedback_optimistic_${Date.now()}`,text:`${a}

(Submitted from: ${c})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l,doc_id:m,user_email:i};return t.setQueryData(xe.feedback(),_=>_?{items:[..._.items,g]}:{items:[g]}),{previousData:h,optimisticItemId:g.id}},onSuccess:(n,i,a)=>{t.setQueryData(xe.feedback(),l=>l&&{items:l.items.map(c=>c.id===a?.optimisticItemId?{...n.feedbackItem,doc_id:n.docId,user_email:i.userEmail}:c)})},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function r6(){const t=sn();return{toggleFeedback:rr({mutationFn:async({item:n})=>{const{exists:i,data:a}=await Le("feedback",n.doc_id,"PRE-EDIT-READ");if(!i||!a)throw new Error(`Feedback document not found: ${n.doc_id}`);const l=!n.is_done,c=l?new Date().toISOString():null,h=a.items||[];let m=!1;const g=h.map(_=>_.id===n.id?(m=!0,{..._,is_done:l,completed_at:c}):_);if(!m)throw console.error("[toggleFeedback] Item not found in document",{searchingFor:n.id,inDocument:n.doc_id,availableIds:h.map(_=>_.id)}),new Error(`Feedback item not found in document. Item ID: ${n.id}, Doc ID: ${n.doc_id}`);return await pt("feedback",n.doc_id,{...a,items:g,updated_at:new Date().toISOString()},`marking feedback item as ${l?"done":"not done"}`),{itemId:n.id,isDone:l,completedAt:c}},onMutate:async({item:n})=>{await t.cancelQueries({queryKey:xe.feedback()});const i=t.getQueryData(xe.feedback()),a=!n.is_done,l=a?new Date().toISOString():null;return t.setQueryData(xe.feedback(),c=>c&&{items:c.items.map(h=>h.id===n.id?{...h,is_done:a,completed_at:l}:h)}),{previousData:i}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function i6(){const t=sn();return{updateSortOrder:rr({mutationFn:async({docId:n,items:i})=>{const{exists:a,data:l}=await Le("feedback",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Feedback document not found");return await pt("feedback",n,{...l,items:i,updated_at:new Date().toISOString()},"saving reordered feedback items"),{docId:n,items:i}},onMutate:async({docId:n,items:i})=>{await t.cancelQueries({queryKey:xe.feedback()});const a=t.getQueryData(xe.feedback());return t.setQueryData(xe.feedback(),l=>{if(!l)return l;const c=new Map;return i.forEach(h=>{c.set(h.id,h.sort_order)}),{items:l.items.map(h=>h.doc_id===n&&c.has(h.id)?{...h,sort_order:c.get(h.id)}:h)}}),{previousData:a}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function ml({isOpen:t,onClose:e,title:n,children:i,width:a="28rem"}){if(!t)return null;function l(){e()}return d.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:l,children:d.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:a,maxWidth:"calc(100vw - 2rem)",flexShrink:0,boxSizing:"border-box",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:c=>c.stopPropagation(),children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[d.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),i]})})}const s6=2e3,a6={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function o6(){const[t,e]=A.useState(!1),[n,i]=A.useState(""),[a,l]=A.useState("bug"),[c,h]=A.useState(!1),m=A.useContext(ou),_=Ka().get_current_firebase_user(),v=An(),{submitFeedback:b}=hT();if(A.useEffect(()=>{if(c){const T=setTimeout(()=>h(!1),s6);return()=>clearTimeout(T)}},[c]),v.pathname.includes("/admin/feedback")||!m.is_logged_in)return null;function C(T){T.preventDefault(),!(!n.trim()||!m.username||!_)&&(b.mutate({userId:_.uid,userEmail:m.username,text:n.trim(),feedbackType:a,currentPath:v.pathname}),i(""),l("bug"),e(!1),h(!0))}return d.jsxs(d.Fragment,{children:[c&&d.jsxs("div",{style:{position:"fixed",bottom:"5rem",right:"1.5rem",background:"rgba(46, 213, 115, 0.95)",color:"white",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1001,display:"flex",alignItems:"center",gap:"0.5rem",animation:"fadeInUp 0.2s ease-out"},children:[d.jsx("span",{children:""}),d.jsx("span",{children:"Feedback submitted!"})]}),d.jsx("button",{onClick:()=>{e(!0)},style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:ce.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:T=>{T.currentTarget.style.transform="scale(1.1)",T.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:T=>{T.currentTarget.style.transform="scale(1)",T.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),d.jsx(ml,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:d.jsxs("form",{onSubmit:C,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(T=>{const j=a6[T],B=a===T;return d.jsxs("button",{type:"button",onClick:()=>{j.label,l(T)},style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${j.color}`,borderRadius:"0.5rem",background:B?j.bgColor:"transparent",color:B?j.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:B?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:B?1:.5,boxShadow:B?`0 0 12px ${j.bgColor}`:"none",position:"relative"},children:[j.label,B&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},T)})}),d.jsx(Fy,{value:n,onChange:T=>i(T.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),d.jsxs(Xa,{children:[d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Feedback",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),d.jsx(Me,{type:"submit",actionName:"Submit Feedback",disabled:!n.trim(),children:"Submit"})]})]})})]})}function Os({children:t,labelStyle:e,...n}){return d.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[d.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:ce.primary},...n}),t]})}function l6({title:t,count:e,children:n,defaultExpanded:i=!1}){const[a,l]=A.useState(i);return d.jsxs("div",{style:{marginTop:"2rem"},children:[d.jsxs("button",{onClick:()=>l(!a),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[d.jsx("span",{style:{transition:"transform 0.2s",transform:a?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),a&&n]})}const c6=t=>{switch(t){case 2:return 220;case 3:return 320;case 4:return 420;case 5:return 520;case 6:return 620;default:return t*100+20}},u6=t=>t<=4?2:t<=6?3:Math.ceil(t/2);function Hy(t){const{tabs:e,activeTab:n}=t,i=e.filter(v=>!v.hidden),a=i.length,l=c6(a),c=u6(a),h=Math.floor(100/c),m=`tab-nav-${a}`,g=v=>({flex:"1 1 0",padding:"0.6rem 0.5rem",border:"none",borderRadius:0,background:"transparent",cursor:"pointer",fontWeight:v?600:400,fontSize:"0.9rem",color:"inherit",opacity:v?1:.5,transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem",position:"relative",boxSizing:"border-box",outline:"none"}),_=(v,b)=>d.jsxs(d.Fragment,{children:[d.jsx("span",{children:v.label}),v.checkmark&&d.jsx("span",{style:{color:ce.success,fontWeight:600},children:""}),b&&d.jsx("span",{style:{position:"absolute",bottom:"-1px",left:"15%",right:"15%",height:"3px",background:"white",borderRadius:"2px"}})]});return d.jsxs(d.Fragment,{children:[d.jsx("style",{children:`
        .${m} {
          display: flex;
          flex-wrap: wrap;
          margin-bottom: 1.5rem;
          border-bottom: 1px solid color-mix(in srgb, currentColor 15%, transparent);
        }
        .${m} > button,
        .${m} > a {
          border: none !important;
          border-radius: 0 !important;
          outline: none !important;
        }
        .${m} > button:hover,
        .${m} > button:focus,
        .${m} > a:hover,
        .${m} > a:focus {
          border: none !important;
          border-color: transparent !important;
        }
        @media (max-width: ${l}px) {
          .${m} > * {
            flex: 1 1 ${h}% !important;
            min-width: ${h}% !important;
          }
        }
      `}),d.jsx("div",{className:m,children:i.map(v=>{const b=n===v.id;return t.mode==="link"?d.jsx(wt,{to:`${t.linkPrefix}/${v.id}`,onClick:()=>(`${v.label}`,void 0),style:g(b),children:_(v,b)},v.id):d.jsx("button",{onClick:()=>{`${v.label}`,t.onTabChange(v.id)},style:g(b),children:_(v,b)},v.id)})})]})}function Gy({items:t}){const[e,n]=A.useState(!1),i=A.useRef(null),l=An().pathname;A.useEffect(()=>{function h(m){i.current&&!i.current.contains(m.target)&&n(!1)}if(e)return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[e]),A.useEffect(()=>{function h(m){m.key==="Escape"&&n(!1)}if(e)return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[e]);const c=t.filter(h=>h.hidden?!1:h.to?h.to==="/budget"?!(l==="/budget"||/^\/budget\/\d{4}\/\d{1,2}\/\w+$/.test(l)):h.to==="/account"||h.to==="/"?l!==h.to:!l.startsWith(h.to):!0);return d.jsxs("div",{ref:i,style:{position:"relative"},children:[d.jsx("button",{onClick:()=>{n(!e)},style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:e?"color-mix(in srgb, currentColor 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:"none",cursor:"pointer",fontSize:"1.25rem",color:"inherit",transition:"background 0.15s",lineHeight:1},title:"Menu","aria-expanded":e,"aria-haspopup":"true",children:""}),e&&d.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",minWidth:"180px",background:"#1a1a2e",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",zIndex:1e3,overflow:"hidden"},children:c.map((h,m)=>{if(h.divider)return d.jsx("div",{style:{height:"1px",background:"color-mix(in srgb, currentColor 15%, transparent)",margin:"0.25rem 0"}},m);const g=d.jsxs(d.Fragment,{children:[h.icon&&d.jsx("span",{style:{width:"1.5rem",textAlign:"center"},children:h.icon}),d.jsx("span",{children:h.label})]}),_={display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",fontSize:"0.95rem",color:"inherit",textDecoration:"none",cursor:"pointer",transition:"background 0.15s",background:"transparent",border:"none",width:"100%",textAlign:"left"},v={background:"color-mix(in srgb, currentColor 10%, transparent)"};return h.to?d.jsx(wt,{to:h.to,style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",onClick:()=>{`${h.label}`,n(!1)},children:g},m):d.jsx("button",{onClick:()=>{`${h.label}`,h.onClick?.(),n(!1)},style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",children:g},m)})})]})}function d6({title:t,showBackArrow:e=!1,hideMenu:n=!1}){const{isAdmin:i}=Zt(),a=An(),c=[...a.pathname==="/budget"||a.pathname.startsWith("/budget/")&&!a.pathname.startsWith("/budget/settings")&&!a.pathname.startsWith("/budget/admin")&&!a.pathname.startsWith("/budget/analytics")&&!a.pathname.startsWith("/budget/my-budgets")?[]:[{label:"Budget",icon:"",to:"/budget"}],{label:"Budget Settings",icon:"",to:"/budget/settings"},{label:"Analytics",icon:"",to:"/budget/analytics"},...i?[{label:"Admin",icon:"",to:"/budget/admin"}]:[],{label:"Switch Budgets",icon:"",to:"/budget/my-budgets"},{divider:!0,label:""},{label:"Exit Budget App",icon:"",to:"/"}];return d.jsxs("nav",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[d.jsx("div",{style:{flex:"0 0 auto"},children:e?d.jsx(wt,{to:"/",onClick:()=>void 0,style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none"},title:"Back to Home",children:""}):d.jsx(wt,{to:"/budget",onClick:()=>void 0,title:"Budget Home",children:d.jsx("img",{src:"/budget-icon.svg",alt:"Budget",style:{width:"1.5rem",height:"1.5rem"}})})}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem",textAlign:"center",flex:"1 1 auto"},children:t}),d.jsx("div",{style:{flex:"0 0 auto"},children:n?d.jsx("div",{style:{width:"1.5rem"}}):d.jsx(Gy,{items:c})})]})}function fT({children:t,style:e}){return d.jsx("div",{style:{width:"100%",maxWidth:"var(--content-max-width, 900px)",marginLeft:"auto",marginRight:"auto",...e},children:t})}function Dg(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function h6(){return d.jsxs("div",{style:ru,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(wt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(wt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"SQL Test"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(Gy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"SQL Test"}),d.jsx("h2",{children:"Setup"}),d.jsxs("h3",{children:["1. Open up your preferred web browser to ",d.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),d.jsxs("ul",{children:[d.jsx("li",{children:"This is a basic online sql query editor"}),d.jsxs("li",{children:["It will include three tables: ",d.jsx("b",{children:'"Customer"'}),", ",d.jsx("b",{children:'"Orders"'}),", and ",d.jsx("b",{children:'"Shippings"'})]})]}),d.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),d.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:d.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),d.jsx("h2",{children:"SQL Problems"}),d.jsx("p",{children:"Write queries in the online editor to answer these questions."}),d.jsx("h3",{children:"Question #1"}),d.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),d.jsx("h3",{children:"Question #2"}),d.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function f6(){const t=A.useContext(ou),e=Ka(),[n,i]=A.useState(!1),a=An(),l=_l(),c=a.state?.from||"/";A.useEffect(()=>{t.is_logged_in&&c!=="/"&&l(c,{replace:!0})},[t.is_logged_in,c,l]);function h(){i(!0),e.logout_firebase_user().then(function(){i(!1)})}return d.jsxs("div",{style:ru,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(wt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(wt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"Account"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(Gy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"Account"}),t.is_logged_in?n?d.jsx("p",{children:"Logging Out..."}):d.jsxs(d.Fragment,{children:[d.jsxs("p",{children:["You are logged in as ",t.username]}),d.jsx("button",{onClick:h,style:{marginTop:"1rem"},children:"Logout"})]}):d.jsx(m6,{})]})}function m6(){const t=Ka(),[e,n]=A.useState(""),[i,a]=A.useState(""),[l,c]=A.useState(!1),[h,m]=A.useState("");function g(b){n(b.target.value)}function _(b){a(b.target.value)}function v(b){b.preventDefault(),c(!0),m(""),t.login_firebase_user(e,i).then(function(){}).catch(function(){m("Incorrect login credentials")}).finally(function(){c(!1)})}return d.jsxs("form",{onSubmit:v,children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"username",children:"Email: "}),d.jsx("input",{id:"username",type:"email",value:e,onChange:g})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",children:"Password: "}),d.jsx("input",{id:"password",type:"password",value:i,onChange:_})]}),l?d.jsx("p",{children:"Logging in..."}):d.jsx("button",{children:"Login"}),h&&d.jsx("p",{style:{color:"red"},children:h})]})}function p6(){const[t,e]=A.useState(()=>typeof window>"u"?1200:window.innerWidth);return A.useEffect(()=>{function n(){e(window.innerWidth)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),{width:t,isWide:t>=Ma.wide,isMedium:t>=Ma.tablet&&t<Ma.wide,isNarrowMedium:t>=Ma.mobile&&t<Ma.tablet,isMobile:t<Ma.mobile}}function g6(){const t=sn();return{updateAccounts:rr({mutationFn:async({budgetId:n,accounts:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await pt("budgets",n,{...l,accounts:i},"saving updated accounts (user edited account settings)"),i},onMutate:async({budgetId:n,accounts:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,accounts:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,accounts:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function y6(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order},i.expected_balance!==void 0&&(e[n].expected_balance=i.expected_balance),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function _6(){const t=sn();return{updateAccountGroups:rr({mutationFn:async({budgetId:n,accountGroups:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const c=y6(i);return await pt("budgets",n,{...l,account_groups:c},"saving updated account groups (user edited group settings)"),i},onMutate:async({budgetId:n,accountGroups:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,accountGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,accountGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function v6(){const t=sn();return{renameBudget:rr({mutationFn:async({budgetId:n,newName:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await pt("budgets",n,{...l,name:i.trim()},`renaming budget to "${i.trim()}"`),i.trim()},onMutate:async({budgetId:n,newName:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,name:i.trim()}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,budget:{...a.budget,name:n}})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function b6(){const t=sn();return{createBudget:rr({mutationFn:async({name:n,userId:i,userEmail:a})=>{const l=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,c=new Date().toISOString(),h={name:n.trim()||"My Budget",user_ids:[i],accepted_user_ids:[i],owner_id:i,owner_email:a,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:c,updated_at:c};await pt("budgets",l,h,"creating new budget document");const{exists:m,data:g}=await Le("users",i,"reading user document to add new budget to their list");return m&&g?await pt("users",i,{...g,budget_ids:[l,...g.budget_ids],updated_at:c},"adding new budget to user's budget list"):await pt("users",i,{uid:i,email:a,budget_ids:[l],created_at:c,updated_at:c},"creating new user document with first budget"),{budgetId:l,budget:{id:l,...h}}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:xe.user(i)}),t.invalidateQueries({queryKey:xe.accessibleBudgets(i)})}})}}function x6(){const t=sn();return{acceptInvite:rr({mutationFn:async({budgetId:n,userId:i})=>{const a=new Date().toISOString(),{exists:l,data:c}=await Le("budgets",n,"verifying user was invited to this budget");if(!l||!c)throw new Error("Budget not found");if(!c.user_ids?.includes(i))throw new Error("You have not been invited to this budget");const{data:h}=await Le("users",i,"PRE-EDIT-READ");if(h?.budget_ids?.includes(n))throw new Error("You have already accepted this invite");return await pt("users",i,{...h||{uid:i,email:null},budget_ids:[n,...h?.budget_ids||[]],updated_at:a},"adding accepted budget to user's budget list"),await pt("budgets",n,{...c,accepted_user_ids:[...c.accepted_user_ids||[],i]},"marking user as accepted in budget's accepted_user_ids"),{budgetId:n}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:xe.user(i)}),t.invalidateQueries({queryKey:xe.accessibleBudgets(i)}),t.invalidateQueries({queryKey:xe.budget(n.budgetId)})}})}}function E6(){const t=sn();return{inviteUser:rr({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");if(l.user_ids?.includes(i))throw new Error("User is already invited");return await pt("budgets",n,{...l,user_ids:[...l.user_ids||[],i]},"adding user to budget's invited users list"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,user_ids:[...a.budget.user_ids,i]}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function S6(){const t=sn();return{revokeUser:rr({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await Le("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await pt("budgets",n,{...l,user_ids:(l.user_ids||[]).filter(c=>c!==i),accepted_user_ids:(l.accepted_user_ids||[]).filter(c=>c!==i)},"removing user from budget's access lists"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,user_ids:a.budget.user_ids.filter(l=>l!==i),accepted_user_ids:a.budget.accepted_user_ids.filter(l=>l!==i)}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function On(t,e){const n=JM(t),{updateAccounts:i}=g6(),{updateAccountGroups:a}=_6(),{updateCategories:l}=RM(),{updateCategoryGroups:c}=DM(),{renameBudget:h}=v6(),{createBudget:m}=b6(),{acceptInvite:g}=x6(),{inviteUser:_}=E6(),{revokeUser:v}=S6(),b=n.data,w=b?.budget||null,C=A.useMemo(()=>b?.accounts||{},[b?.accounts]),T=A.useMemo(()=>b?.accountGroups||{},[b?.accountGroups]),j=A.useMemo(()=>b?.categories||{},[b?.categories]),B=A.useMemo(()=>b?.categoryGroups||[],[b?.categoryGroups]),H=w?.owner_id===e,z=A.useMemo(()=>w?.user_ids||[],[w?.user_ids]),J=A.useMemo(()=>w?.accepted_user_ids||[],[w?.accepted_user_ids]),$=w?.total_available??0,re=A.useMemo(()=>b?.monthMap||{},[b?.monthMap]),P=A.useCallback(async X=>{if(!t)throw new Error("No budget selected");await i.mutateAsync({budgetId:t,accounts:X})},[t,i]),R=A.useCallback(async X=>{if(!t)throw new Error("No budget selected");await a.mutateAsync({budgetId:t,accountGroups:X})},[t,a]),D=A.useCallback(async X=>{if(!t)throw new Error("No budget selected");await l.mutateAsync({budgetId:t,categories:X})},[t,l]),N=A.useCallback(async X=>{if(!t)throw new Error("No budget selected");await c.mutateAsync({budgetId:t,categoryGroups:X})},[t,c]),M=A.useCallback(async(X,ee)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.mutateAsync({budgetId:t,accounts:X}),a.mutateAsync({budgetId:t,accountGroups:ee})])},[t,i,a]),k=A.useCallback(async(X,ee)=>{if(!t)throw new Error("No budget selected");await Promise.all([l.mutateAsync({budgetId:t,categories:X}),c.mutateAsync({budgetId:t,categoryGroups:ee})])},[t,l,c]),I=A.useCallback(async X=>{if(!t)throw new Error("No budget selected");await h.mutateAsync({budgetId:t,newName:X})},[t,h]),ae=A.useCallback(async X=>{if(!e)throw new Error("Not authenticated");return await m.mutateAsync({name:X.trim()||"My Budget",userId:e,userEmail:null})},[e,m]),q=A.useCallback(async X=>{if(!t)throw new Error("No budget selected");await _.mutateAsync({budgetId:t,userId:X})},[t,_]),L=A.useCallback(async X=>{if(!t)throw new Error("No budget selected");await v.mutateAsync({budgetId:t,userId:X})},[t,v]),Q=A.useCallback(async X=>{if(!e)throw new Error("Not authenticated");await g.mutateAsync({budgetId:X,userId:e})},[e,g]),K=A.useCallback(X=>{if(!t)return;const ee=st.getQueryData(xe.budget(t));ee&&st.setQueryData(xe.budget(t),{...ee,accounts:X})},[t]),oe=A.useCallback(X=>{if(!t)return;const ee=st.getQueryData(xe.budget(t));ee&&st.setQueryData(xe.budget(t),{...ee,accountGroups:X})},[t]),ue=A.useCallback(X=>{if(!t)return;const ee=st.getQueryData(xe.budget(t));ee&&st.setQueryData(xe.budget(t),{...ee,categories:X})},[t]),U=A.useCallback(X=>{if(!t)return;const ee=st.getQueryData(xe.budget(t));ee&&st.setQueryData(xe.budget(t),{...ee,categoryGroups:X})},[t]),F=A.useCallback(async()=>{t&&await st.invalidateQueries({queryKey:xe.budget(t)})},[t]),W=A.useCallback(()=>Object.entries(C).filter(([,X])=>{const ee=X.account_group_id?T[X.account_group_id]:void 0,ge=ee?.on_budget!==void 0?ee.on_budget:X.on_budget!==!1,me=ee?.is_active!==void 0?ee.is_active:X.is_active!==!1;return ge&&me}).reduce((X,[,ee])=>X+ee.balance,0),[C,T]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:w,accounts:C,accountGroups:T,categories:j,categoryGroups:B,isOwner:H,budgetUserIds:z,acceptedUserIds:J,totalAvailable:$,monthMap:re,saveAccounts:P,saveAccountGroups:R,saveCategories:D,saveCategoryGroups:N,saveAccountsAndGroups:M,saveCategoriesAndGroups:k,renameBudget:I,createBudget:ae,inviteUser:q,revokeUser:L,acceptInvite:Q,setAccountsOptimistic:K,setAccountGroupsOptimistic:oe,setCategoriesOptimistic:ue,setCategoryGroupsOptimistic:U,refreshBudget:F,getOnBudgetTotal:W}}function Ja(t,e,n){const{addLoadingHold:i,removeLoadingHold:a}=jn(),l=sk(t,e,n,{enabled:!!t});A.useEffect(()=>(l.isLoading?i("month-query","Loading month data..."):a("month-query"),()=>a("month-query")),[l.isLoading,i,a]);const{addIncome:c}=kM(),{updateIncome:h}=NM(),{deleteIncome:m}=PM(),{addExpense:g}=LM(),{updateExpense:_}=VM(),{deleteExpense:v}=zM(),b=l.data?.month||null,w=b?.income||[],C=b?.expenses||[],T=b?.category_balances||[],j=b?.total_income||0,B=b?.total_expenses||0,H=b?.are_allocations_finalized||!1,z=b?.previous_month_income??0,J=A.useCallback(async(M,k,I,ae,q)=>{if(!t)throw new Error("No budget selected");const[L,Q]=I.split("-").map(Number);await c(t,L,Q,M,k,I,ae,q)},[t,c]),$=A.useCallback(async(M,k,I,ae,q,L)=>{if(!t)throw new Error("No budget selected");await h(t,e,n,M,k,I,ae,q,L)},[t,e,n,h]),re=A.useCallback(async M=>{if(!t)throw new Error("No budget selected");await m(t,e,n,M)},[t,e,n,m]),P=A.useCallback(async(M,k,I,ae,q,L,Q)=>{if(!t)throw new Error("No budget selected");const[K,oe]=ae.split("-").map(Number);await g(t,K,oe,M,k,I,ae,q,L,Q)},[t,g]),R=A.useCallback(async(M,k,I,ae,q,L,Q,K)=>{if(!t)throw new Error("No budget selected");await _(t,e,n,M,k,I,ae,q,L,Q,K)},[t,e,n,_]),D=A.useCallback(async M=>{if(!t)throw new Error("No budget selected");await v(t,e,n,M)},[t,e,n,v]),N=A.useCallback(async()=>{t&&await st.invalidateQueries({queryKey:xe.month(t,e,n)})},[t,e,n]);return{isLoading:l.isLoading,isFetching:l.isFetching,error:l.error,month:b,income:w,expenses:C,categoryBalances:T,totalIncome:j,totalExpenses:B,areAllocationsFinalized:H,previousMonthIncome:z,addIncome:J,updateIncome:$,deleteIncome:re,addExpense:P,updateExpense:R,deleteExpense:D,refreshMonth:N}}function w6(){const{selectedBudgetId:t,currentUserId:e}=Zt(),{budget:n,accounts:i,accountGroups:a,saveAccounts:l,saveAccountGroups:c,saveAccountsAndGroups:h,setAccountsOptimistic:m,setAccountGroupsOptimistic:g}=On(t,e),[_,v]=A.useState(null),b=A.useMemo(()=>Object.entries(i).reduce((R,[D,N])=>{const M=N.account_group_id||"ungrouped";return R[M]||(R[M]=[]),R[M].push({...N,id:D}),R},{}),[i]),w=A.useMemo(()=>Object.entries(a).sort(([,R],[,D])=>R.sort_order-D.sort_order).map(([R,D])=>({...D,id:R})),[a]),C=A.useCallback((R,D)=>{if(!n)return;const N=Object.values(i).filter(q=>D==="ungrouped"?!q.account_group_id:q.account_group_id===D),M=N.length>0?Math.max(...N.map(q=>q.sort_order)):-1,k=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,I={nickname:R.nickname,description:"",balance:0,account_group_id:D==="ungrouped"?null:D,sort_order:M+1,is_income_account:R.is_income_account??!1,is_income_default:R.is_income_default??!1,is_outgo_account:R.is_outgo_account??!1,is_outgo_default:R.is_outgo_default??!1,on_budget:R.on_budget!==!1,is_active:R.is_active!==!1},ae={...i};R.is_income_default&&Object.keys(ae).forEach(q=>{ae[q]={...ae[q],is_income_default:!1}}),R.is_outgo_default&&Object.keys(ae).forEach(q=>{ae[q]={...ae[q],is_outgo_default:!1}}),ae[k]=I,m(ae),l(ae).catch(q=>{console.error("[useAccountHandlers] Error creating account:",q),v(q instanceof Error?q.message:"Failed to create account.")})},[n,i,m,l]),T=A.useCallback((R,D)=>{if(!n)return;const N=i[R];if(!N)return;const M=N.account_group_id||"ungrouped",k=D.account_group_id;let I=N.sort_order;if(M!==(k||"ungrouped")){const q=Object.values(i).filter(L=>(L.account_group_id||"ungrouped")===(k||"ungrouped"));I=q.length>0?Math.max(...q.map(L=>L.sort_order))+1:0}const ae={};Object.entries(i).forEach(([q,L])=>{q===R?ae[q]={...L,nickname:D.nickname,account_group_id:k,sort_order:I,is_income_account:D.is_income_account??!1,is_income_default:D.is_income_default??!1,is_outgo_account:D.is_outgo_account??!1,is_outgo_default:D.is_outgo_default??!1,on_budget:D.on_budget!==!1,is_active:D.is_active!==!1}:(ae[q]={...L},D.is_income_default&&!N.is_income_default&&(ae[q].is_income_default=!1),D.is_outgo_default&&!N.is_outgo_default&&(ae[q].is_outgo_default=!1))}),m(ae),l(ae).catch(q=>{console.error("[useAccountHandlers] Error saving account:",q),v(q instanceof Error?q.message:"Failed to save account.")})},[n,i,m,l]),j=A.useCallback(R=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[R]:D,...N}=i;m(N),l(N).catch(M=>{console.error("[useAccountHandlers] Error deleting account:",M),v(M instanceof Error?M.message:"Failed to delete account.")})},[n,i,m,l]),B=A.useCallback(async(R,D)=>{const N=i[R];if(!N)return;const M=N.account_group_id||"ungrouped",k=Object.entries(i).filter(([,K])=>(K.account_group_id||"ungrouped")===M).sort(([,K],[,oe])=>K.sort_order-oe.sort_order),I=k.findIndex(([K])=>K===R),ae=D==="up"?I-1:I+1;if(ae<0||ae>=k.length)return;const[q,L]=k[ae],Q={};if(Object.entries(i).forEach(([K,oe])=>{K===R?Q[K]={...oe,sort_order:L.sort_order}:K===q?Q[K]={...oe,sort_order:N.sort_order}:Q[K]={...oe}}),m(Q),!!n)try{await l(Q)}catch(K){m(i),v(K instanceof Error?K.message:"Failed to move account")}},[n,i,m,l]),H=A.useCallback(R=>{if(!n)return;const D=Object.values(a).map(ae=>ae.sort_order),N=D.length>0?Math.max(...D):-1,M=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,k={name:R.name,sort_order:N+1,expected_balance:R.expected_balance,on_budget:R.on_budget,is_active:R.is_active},I={...a,[M]:k};g(I),c(I).catch(ae=>{console.error("[useAccountHandlers] Error creating group:",ae),v(ae instanceof Error?ae.message:"Failed to create account type.")})},[n,a,g,c]),z=A.useCallback((R,D)=>{if(!n)return;const N={...a,[R]:{...a[R],name:D.name,expected_balance:D.expected_balance,on_budget:D.on_budget,is_active:D.is_active}};g(N),c(N).catch(M=>{console.error("[useAccountHandlers] Error updating group:",M),v(M instanceof Error?M.message:"Failed to update account type.")})},[n,a,g,c]),J=A.useCallback(R=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const D={};Object.entries(i).forEach(([k,I])=>{D[k]=I.account_group_id===R?{...I,account_group_id:null}:I});const{[R]:N,...M}=a;m(D),g(M),h(D,M).catch(k=>{console.error("[useAccountHandlers] Error deleting group:",k),v(k instanceof Error?k.message:"Failed to delete account type.")})},[n,i,a,m,g,h]),$=A.useCallback(async(R,D)=>{const N=Object.entries(a).sort(([,q],[,L])=>q.sort_order-L.sort_order),M=N.findIndex(([q])=>q===R),k=D==="up"?M-1:M+1;if(k<0||k>=N.length)return;const[I]=N.splice(M,1);N.splice(k,0,I);const ae={};if(N.forEach(([q,L],Q)=>{ae[q]={...L,sort_order:Q}}),g(ae),!!n)try{await c(ae)}catch(q){g(a),v(q instanceof Error?q.message:"Failed to move account type")}},[n,a,g,c]),re=A.useCallback(async(R,D,N)=>{const M=i[R];if(!M)return;const k=N==="ungrouped"?null:N,I=Object.entries(i).filter(([,L])=>(L.account_group_id||"ungrouped")===N),ae={};Object.entries(i).forEach(([L,Q])=>{L!==R&&(ae[L]={...Q})});let q;if(D==="__group_end__"||I.length===0||!I.find(([L])=>L===D))q=(I.length>0?Math.max(...I.filter(([Q])=>Q!==R).map(([,Q])=>Q.sort_order)):-1)+1;else{const L=I.find(([Q])=>Q===D);if(L){const[,Q]=L;q=Q.sort_order,Object.entries(ae).forEach(([K,oe])=>{(oe.account_group_id||"ungrouped")===N&&oe.sort_order>=q&&(ae[K]={...oe,sort_order:oe.sort_order+1})})}else q=0}if(ae[R]={...M,account_group_id:k,sort_order:q},m(ae),!!n)try{await l(ae)}catch(L){v(L instanceof Error?L.message:"Failed to save changes")}},[n,i,m,l]),P=A.useCallback(async(R,D)=>{if(R===D)return;const N=Object.entries(a).sort(([,q],[,L])=>q.sort_order-L.sort_order),M=N.findIndex(([q])=>q===R),k=[...N],[I]=k.splice(M,1);if(D==="__end__")k.push(I);else{const q=k.findIndex(([L])=>L===D);k.splice(q,0,I)}const ae={};if(k.forEach(([q,L],Q)=>{ae[q]={...L,sort_order:Q}}),g(ae),!!n)try{await c(ae)}catch(q){v(q instanceof Error?q.message:"Failed to save new order")}},[n,a,g,c]);return{accounts:i,accountGroups:a,accountsByGroup:b,sortedGroups:w,currentBudget:n,error:_,setError:v,handleCreateAccount:C,handleUpdateAccount:T,handleDeleteAccount:j,handleMoveAccount:B,handleCreateGroup:H,handleUpdateGroup:z,handleDeleteGroup:J,handleMoveGroup:$,reorderAccountsInGroup:re,reorderGroups:P}}function RE(t,e){if(!t)return{};const n={};return Object.entries(e).forEach(([i,a])=>{if(a.default_monthly_type==="percentage")return;const l=t.category_balances?.find(c=>c.category_id===i);l&&l.allocated>0?n[i]=l.allocated.toString():a.default_monthly_amount!==void 0&&a.default_monthly_amount>0?n[i]=a.default_monthly_amount.toString():n[i]=""}),n}function T6(){const{addLoadingHold:t,removeLoadingHold:e}=jn(),{selectedBudgetId:n,currentUserId:i,currentYear:a,currentMonthNumber:l}=Zt(),{categories:c,getOnBudgetTotal:h,totalAvailable:m}=On(n,i),{month:g,isLoading:_,previousMonthIncome:v,areAllocationsFinalized:b}=Ja(n,a,l),w=A.useMemo(()=>g?.income?g.income.reduce((F,W)=>F+W.amount,0):0,[g]),{saveDraftAllocations:C}=AM(),{finalizeAllocations:T}=IM(),{deleteAllocations:j}=E1(),B=A.useMemo(()=>RE(g,c),[g,c]),[H,z]=A.useState(B),[J,$]=A.useState(!1),[re,P]=A.useState(null),R=A.useRef(null);A.useMemo(()=>Object.values(c).reduce((F,W)=>F+(W.balance??0),0),[c]),A.useEffect(()=>{if(!g)return;const F=`${g.year}-${g.month}`;R.current!==F&&($(!1),z(RE(g,c)),R.current=F)},[g,c]);const D=A.useCallback((F,W)=>{if(W.default_monthly_type==="percentage"&&W.default_monthly_amount!==void 0)return W.default_monthly_amount/100*v;const X=H[F],ee=parseFloat(X||"0");return isNaN(ee)?0:ee},[H,v]),N=A.useMemo(()=>Object.entries(c).reduce((F,[W,X])=>{const ee=D(W,X),ge=X.balance??0;if(ge<0){const me=Math.abs(ge),Ee=Math.max(0,ee-me);return F+Ee}return F+ee},0),[c,D]),M=h(),k=b?(g?.category_balances||[]).reduce((F,W)=>{const X=c[W.category_id]?.balance??0,ee=W.allocated,ge=X-ee;if(ge<0){const me=Math.abs(ge);return F+Math.max(0,ee-me)}return F+ee},0):0,I=J?m+k:m,ae=A.useMemo(()=>J?I-N:I-N+k,[I,N,k,J]),q=A.useCallback((F,W)=>{z(X=>({...X,[F]:W}))},[]),L=A.useCallback(()=>{if(!g)return;const F={};Object.entries(c).forEach(([W,X])=>{if(X.default_monthly_type==="percentage")return;const ee=g.category_balances?.find(ge=>ge.category_id===W);ee&&ee.allocated>0?F[W]=ee.allocated.toString():X.default_monthly_amount!==void 0&&X.default_monthly_amount>0?F[W]=X.default_monthly_amount.toString():F[W]=""}),z(F),$(!1)},[g,c]),Q=A.useCallback(()=>{const F={};return Object.entries(c).forEach(([W,X])=>{const ee=D(W,X);ee>0&&(F[W]=ee)}),F},[c,D]),K=A.useCallback(async()=>{if(n){P(null),t("allocations-save","Saving allocations...");try{await C(n,a,l,Q()),$(!1)}catch(F){P(F instanceof Error?F.message:"Failed to save allocations")}finally{e("allocations-save")}}},[n,a,l,C,Q,t,e]),oe=A.useCallback(async()=>{if(n){P(null),t("allocations-finalize","Applying allocations...");try{await T({budgetId:n,year:a,month:l,allocations:Q()}),$(!1)}catch(F){P(F instanceof Error?F.message:"Failed to finalize allocations")}finally{e("allocations-finalize")}}},[n,a,l,T,Q,t,e]),ue=A.useCallback(async()=>{if(n){P(null),t("allocations-delete","Deleting allocations...");try{await j({budgetId:n,year:a,month:l});const F={};Object.entries(c).forEach(([W,X])=>{X.default_monthly_type!=="percentage"&&(X.default_monthly_amount!==void 0&&X.default_monthly_amount>0?F[W]=X.default_monthly_amount.toString():F[W]="")}),z(F),$(!1)}catch(F){P(F instanceof Error?F.message:"Failed to delete allocations")}finally{e("allocations-delete")}}},[n,a,l,j,c,t,e]),U=N-k;return{localAllocations:H,isEditingAppliedAllocations:J,error:re,monthLoading:_,onBudgetTotal:M,availableNow:I,currentDraftTotal:N,draftChangeAmount:U,availableAfterApply:ae,previousMonthIncome:v,currentMonthIncome:w,allocationsFinalized:b,getAllocationAmount:D,handleAllocationChange:q,resetAllocationsToSaved:L,handleSaveAllocations:K,handleFinalizeAllocations:oe,handleDeleteAllocations:ue,setIsEditingAppliedAllocations:$,setError:P}}function A6({budgetId:t,categories:e,currentYear:n,currentMonth:i,updateCategoriesWithBalances:a}){const l=A.useMemo(()=>{const b={};return Object.entries(e).forEach(([w,C])=>{b[w]={current:C.balance??0,total:C.balance??0}}),b},[e]),[c,h]=A.useState(!1),[m,g]=A.useState(null),_=A.useCallback(async()=>{if(!t||Object.keys(e).length===0)return null;const b=Object.keys(e),{total:w}=await sE(t,b,n,i),C={};Object.entries(e).forEach(([j,B])=>{const H=B.balance,z=w[j]??0;Math.abs(H-z)>.01&&(C[j]={stored:H,calculated:z})});const T=Object.keys(C).length>0?C:null;return g(T),T},[t,e,n,i]),v=A.useCallback(async()=>{if(!(!t||Object.keys(e).length===0)){h(!0);try{const b=Object.keys(e),{total:w}=await sE(t,b,n,i),C={};Object.entries(e).forEach(([T,j])=>{C[T]={...j,balance:w[T]??0}}),await a(C),g(null)}finally{h(!1)}}},[t,e,a,n,i]);return{categoryBalances:l,loadingBalances:c,categoryBalanceMismatch:m,checkCategoryBalanceMismatch:_,recalculateAndSaveCategoryBalances:v}}function C6({categories:t,categoryGroups:e,currentBudget:n,setCategoriesOptimistic:i,setCategoryGroupsOptimistic:a,saveCategories:l,saveCategoryGroups:c,setError:h}){const[m,g]=A.useState(null),[_,v]=A.useState(null),[b,w]=A.useState(null),[C,T]=A.useState(null);function j(N,M){g("category"),v(M),N.dataTransfer.effectAllowed="move"}function B(N,M,k){N.preventDefault(),m==="category"&&(M!==_&&w(M),T(k))}function H(N,M){N.preventDefault(),m==="category"?(T(M),w(null)):m==="group"&&M!==_&&w(M)}function z(){w(null)}function J(){T(null)}function $(){g(null),v(null),w(null),T(null)}async function re(N,M,k){if(N.preventDefault(),N.stopPropagation(),!_||m!=="category"){$();return}const I=t[_];if(!I)return;const ae=k==="ungrouped"?null:k,q=Object.entries(t).filter(([,K])=>(K.category_group_id||"ungrouped")===k),L={};Object.entries(t).forEach(([K,oe])=>{K!==_&&(L[K]=oe)});let Q;if(M==="__group_end__"||q.length===0||!q.find(([K])=>K===M))Q=(q.length>0?Math.max(...q.filter(([oe])=>oe!==_).map(([,oe])=>oe.sort_order)):-1)+1;else{const K=q.find(([oe])=>oe===M);K?(Q=K[1].sort_order,Object.entries(L).forEach(([oe,ue])=>{(ue.category_group_id||"ungrouped")===k&&ue.sort_order>=Q&&(L[oe]={...ue,sort_order:ue.sort_order+1})})):Q=0}if(L[_]={...I,category_group_id:ae,sort_order:Q},i(L),$(),!!n)try{await l(L)}catch(K){h(K instanceof Error?K.message:"Failed to save changes")}}async function P(N,M){N.preventDefault(),m==="category"?await re(N,"__group_end__",M):m==="group"&&await D(N,M)}function R(N,M){N.stopPropagation(),g("group"),v(M),N.dataTransfer.effectAllowed="move"}async function D(N,M){if(N.preventDefault(),!_||m!=="group"||_===M){$();return}const k=e.findIndex(L=>L.id===_),I=[...e],[ae]=I.splice(k,1);if(M==="__end__")I.push(ae);else{const L=I.findIndex(Q=>Q.id===M);I.splice(L,0,ae)}const q=I.map((L,Q)=>({...L,sort_order:Q}));if(a(q),$(),!!n)try{await c(q)}catch(L){h(L instanceof Error?L.message:"Failed to save new order")}}return{dragType:m,draggedId:_,dragOverId:b,dragOverGroupId:C,setDragOverId:w,setDragOverGroupId:T,handleCategoryDragStart:j,handleCategoryDragOver:B,handleDragOverGroup:H,handleDragLeave:z,handleDragLeaveGroup:J,handleDragEnd:$,handleCategoryDrop:re,handleDropOnGroup:P,handleGroupDragStart:R,handleGroupDrop:D}}function R6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Zt(),{budget:a,categories:l,categoryGroups:c,isLoading:h,saveCategories:m,saveCategoryGroups:g,saveCategoriesAndGroups:_,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:b,getOnBudgetTotal:w}=On(t,e),[C,T]=A.useState(null),{categoryBalances:j,loadingBalances:B,categoryBalanceMismatch:H,checkCategoryBalanceMismatch:z,recalculateAndSaveCategoryBalances:J}=A6({budgetId:t,categories:l,currentYear:n,currentMonth:i,updateCategoriesWithBalances:m}),$=C6({categories:l,categoryGroups:c,currentBudget:a,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:b,saveCategories:m,saveCategoryGroups:g,setError:T});async function re(L,Q){if(!a)return;const K=Q==="ungrouped"?null:Q,oe=Object.values(l).filter(X=>Q==="ungrouped"?!X.category_group_id:X.category_group_id===Q),ue=oe.length>0?Math.max(...oe.map(X=>X.sort_order)):-1,U=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,F={name:L.name,description:L.description??"",category_group_id:K,sort_order:ue+1,default_monthly_amount:L.default_monthly_amount??0,default_monthly_type:L.default_monthly_type??"fixed",balance:0},W={...l,[U]:F};v(W);try{await m(W)}catch(X){v(l),T(X instanceof Error?X.message:"Failed to create category")}}async function P(L,Q){if(a)try{const K=l[L];if(!K)return;const oe=K.category_group_id||"ungrouped",ue=Q.category_group_id;let U=K.sort_order;if(oe!==(ue||"ungrouped")){const W=Object.values(l).filter(X=>(X.category_group_id||"ungrouped")===(ue||"ungrouped")).filter((X,ee,ge)=>l[L]!==ge[ee]);U=W.length>0?Math.max(...W.map(X=>X.sort_order))+1:0}const F={...l,[L]:{...K,name:Q.name,description:Q.description??"",category_group_id:ue,sort_order:U,default_monthly_amount:Q.default_monthly_amount??0,default_monthly_type:Q.default_monthly_type??"fixed"}};v(F),await m(F)}catch(K){T(K instanceof Error?K.message:"Failed to update category")}}async function R(L){if(confirm("Are you sure you want to delete this category?")&&a)try{const{[L]:Q,...K}=l;v(K),await m(K)}catch(Q){T(Q instanceof Error?Q.message:"Failed to delete category")}}async function D(L,Q){const K=l[L];if(!K)return;const oe=K.category_group_id||"ungrouped",ue=Object.entries(l).filter(([,ge])=>(ge.category_group_id||"ungrouped")===oe).sort((ge,me)=>ge[1].sort_order-me[1].sort_order),U=ue.findIndex(([ge])=>ge===L),F=Q==="up"?U-1:U+1;if(F<0||F>=ue.length)return;const[W,X]=ue[F],ee={};if(Object.entries(l).forEach(([ge,me])=>{ge===L?ee[ge]={...me,sort_order:X.sort_order}:ge===W?ee[ge]={...me,sort_order:K.sort_order}:ee[ge]=me}),v(ee),!!a)try{await m(ee)}catch(ge){v(l),T(ge instanceof Error?ge.message:"Failed to move category")}}async function N(L){if(a)try{const Q=c.length>0?Math.max(...c.map(ue=>ue.sort_order)):-1,K={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:L.name,sort_order:Q+1},oe=[...c,K];b(oe),await g(oe)}catch(Q){T(Q instanceof Error?Q.message:"Failed to create group")}}async function M(L,Q){if(a)try{const K=c.map(oe=>oe.id===L?{...oe,name:Q.name}:oe);b(K),await g(K)}catch(K){T(K instanceof Error?K.message:"Failed to update group")}}async function k(L){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&a)try{const Q={};Object.entries(l).forEach(([oe,ue])=>{Q[oe]=ue.category_group_id===L?{...ue,category_group_id:null}:ue});const K=c.filter(oe=>oe.id!==L);v(Q),b(K),await _(Q,K)}catch(Q){T(Q instanceof Error?Q.message:"Failed to delete group")}}async function I(L,Q){const K=[...c].sort((W,X)=>W.sort_order-X.sort_order),oe=K.findIndex(W=>W.id===L),ue=Q==="up"?oe-1:oe+1;if(ue<0||ue>=K.length)return;const[U]=K.splice(oe,1);K.splice(ue,0,U);const F=K.map((W,X)=>({...W,sort_order:X}));if(b(F),!!a)try{await g(F)}catch(W){b(c),T(W instanceof Error?W.message:"Failed to move group")}}const ae=Object.entries(l).reduce((L,[Q,K])=>{const oe=K.category_group_id||"ungrouped";return L[oe]||(L[oe]=[]),L[oe].push([Q,K]),L},{}),q=[...c].sort((L,Q)=>L.sort_order-Q.sort_order);return{currentBudget:a,categories:l,categoryGroups:c,categoriesByGroup:ae,sortedGroups:q,categoryBalances:j,isLoading:h,loadingBalances:B,error:C,setError:T,getOnBudgetTotal:w,categoryBalanceMismatch:H,checkCategoryBalanceMismatch:z,recalculateAndSaveCategoryBalances:J,handleCreateCategory:re,handleUpdateCategory:P,handleDeleteCategory:R,handleMoveCategory:D,handleCreateGroup:N,handleUpdateGroup:M,handleDeleteGroup:k,handleMoveGroup:I,dragType:$.dragType,draggedId:$.draggedId,dragOverId:$.dragOverId,dragOverGroupId:$.dragOverGroupId,setDragOverId:$.setDragOverId,setDragOverGroupId:$.setDragOverGroupId,handleCategoryDragStart:$.handleCategoryDragStart,handleCategoryDragOver:$.handleCategoryDragOver,handleDragOverGroup:$.handleDragOverGroup,handleDragLeave:$.handleDragLeave,handleDragLeaveGroup:$.handleDragLeaveGroup,handleDragEnd:$.handleDragEnd,handleCategoryDrop:$.handleCategoryDrop,handleDropOnGroup:$.handleDropOnGroup,handleGroupDragStart:$.handleGroupDragStart,handleGroupDrop:$.handleGroupDrop}}function D6(){const t=new Date;let e=t.getFullYear(),n=t.getMonth()+1+3;for(;n>12;)n-=12,e+=1;return{year:e,month:n}}function I6(){const t=new Date;let e=t.getFullYear(),n=t.getMonth()+1-3;for(;n<1;)n+=12,e-=1;return{year:e,month:n}}function j6({monthError:t,currentYear:e,currentMonthNumber:n,lastActiveTab:i}){const a=_l(),[l,c]=KR(),h=l.get("error"),[m,g]=A.useState(h);return A.useEffect(()=>{h&&(l.delete("error"),c(l,{replace:!0}))},[h,l,c]),A.useEffect(()=>{if(!t)return;const _=t.message||"";if(_.includes("months in the future")||_.includes("Refusing to create month")){const{year:v,month:b}=D6(),w=`Cannot navigate to ${e}/${n} - redirected to ${v}/${b}`;a(`/budget/${v}/${b}/${i}?error=${encodeURIComponent(w)}`,{replace:!0});return}if(_.includes("months in the past")){const{year:v,month:b}=I6(),w=`Cannot create month ${e}/${n} - redirected to ${v}/${b}`;a(`/budget/${v}/${b}/${i}?error=${encodeURIComponent(w)}`,{replace:!0})}},[t,e,n,i,a]),{error:m,setError:g}}function mT(t){return t.nickname===void 0||t.description===void 0||t.balance===void 0||t.sort_order===void 0||t.is_income_account===void 0||t.is_income_default===void 0||t.is_outgo_account===void 0||t.is_outgo_default===void 0||t.on_budget===void 0||t.is_active===void 0}function pT(t){return t.name===void 0||t.description===void 0||t.sort_order===void 0||t.default_monthly_amount===void 0||t.default_monthly_type===void 0||t.balance===void 0}function gT(t){return t.name===void 0||t.sort_order===void 0}function yT(t){return t.budget_id===void 0||t.year_month_ordinal===void 0||t.year===void 0||t.month===void 0||!Array.isArray(t.income)||t.total_income===void 0||t.previous_month_income===void 0||!Array.isArray(t.expenses)||t.total_expenses===void 0||!Array.isArray(t.account_balances)||!Array.isArray(t.category_balances)||t.are_allocations_finalized===void 0||t.created_at===void 0||t.updated_at===void 0}function _T(){const t=new Date,e=t.getFullYear();let i=t.getMonth()+1+2,a=e;return i>12&&(i-=12,a+=1),{year:a,month:i}}function vT(t,e,n){return t>n.year||t===n.year&&e>n.month}async function O6(){const t=await br("budgets","database cleanup: scanning all budgets");let e=0,n=0,i=0,a=0,l=0,c=0,h=0,m=0;for(const C of t.docs){const T=C.data;if(Array.isArray(T.accounts)||Array.isArray(T.categories)||Array.isArray(T.account_groups)){e++;continue}T.month_map===void 0&&m++;const j=T.accounts;if(j&&typeof j=="object"){let z=!1;for(const J of Object.values(j))mT(J)&&(l++,z=!0);z&&n++}const B=T.categories;if(B&&typeof B=="object"){let z=!1;for(const J of Object.values(B))pT(J)&&(c++,z=!0);z&&i++}const H=T.account_groups;if(H&&typeof H=="object"){let z=!1;for(const J of Object.values(H))gT(J)&&(h++,z=!0);z&&a++}}const g=await br("months","database cleanup: scanning all months"),_=_T(),v=[];let b=0,w=0;for(const C of g.docs){const T=C.data,j=T.year,B=T.month;j&&B&&vT(j,B,_)&&v.push({docId:C.id,budgetId:T.budget_id,year:j,month:B}),yT(T)&&b++,T.is_needs_recalculation!==void 0&&w++}return v.sort((C,T)=>C.year!==T.year?C.year-T.year:C.month-T.month),{totalBudgets:t.docs.length,budgetsWithArrays:e,budgetsWithMissingAccountDefaults:n,budgetsWithMissingCategoryDefaults:i,budgetsWithMissingGroupDefaults:a,accountsNeedingDefaults:l,categoriesNeedingDefaults:c,groupsNeedingDefaults:h,budgetsNeedingMonthMap:m,totalMonths:g.docs.length,futureMonthsToDelete:v,monthsWithSchemaIssues:b,monthsWithOldRecalcField:w}}function DE(t){return{nickname:t.nickname??"",description:t.description??"",balance:t.balance??0,account_group_id:t.account_group_id??null,sort_order:t.sort_order??0,is_income_account:t.is_income_account??!1,is_income_default:t.is_income_default??!1,is_outgo_account:t.is_outgo_account??!1,is_outgo_default:t.is_outgo_default??!1,on_budget:t.on_budget??!0,is_active:t.is_active??!0}}function IE(t){return{name:t.name??"",description:t.description??"",category_group_id:t.category_group_id??null,sort_order:t.sort_order??0,default_monthly_amount:t.default_monthly_amount??0,default_monthly_type:t.default_monthly_type??"fixed",balance:t.balance??0}}function jE(t){return{name:t.name??"",sort_order:t.sort_order??0,...t.expected_balance!==void 0&&{expected_balance:t.expected_balance},...t.on_budget!==void 0&&{on_budget:t.on_budget},...t.is_active!==void 0&&{is_active:t.is_active}}}function M6(t,e){const n=e.match(/_(\d{4})(\d{2})$/),i=n?parseInt(n[1]):new Date().getFullYear(),a=n?parseInt(n[2]):new Date().getMonth()+1,l=`${i}${String(a).padStart(2,"0")}`;return{budget_id:t.budget_id??"",year_month_ordinal:t.year_month_ordinal??l,year:t.year??i,month:t.month??a,income:Array.isArray(t.income)?t.income:[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:Array.isArray(t.expenses)?t.expenses:[],total_expenses:t.total_expenses??0,account_balances:Array.isArray(t.account_balances)?t.account_balances:[],category_balances:Array.isArray(t.category_balances)?t.category_balances:[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at??new Date().toISOString(),updated_at:t.updated_at??new Date().toISOString()}}function k6(){const t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=[];for(let a=3;a>0;a--){let l=e,c=n-a;for(;c<1;)c+=12,l-=1;i.push(Jt(l,c))}i.push(Jt(e,n));for(let a=1;a<=3;a++){let l=e,c=n+a;for(;c>12;)c-=12,l+=1;i.push(Jt(l,c))}return i}async function N6(t){const e={},n=k6(),i=await br("months",`database cleanup: querying months for budget ${t}`,[{field:"budget_id",op:"==",value:t}]),a=new Set;for(const l of i.docs){const c=l.data;if(c.year&&c.month){const h=Jt(c.year,c.month);a.add(h)}}for(const l of n)a.has(l)&&(e[l]={needs_recalculation:!1});return e}async function P6(){const t=[];let e=0,n=0,i=0,a=0,l=0,c=0,h=0,m=0,g=0;const _=await br("budgets","database cleanup: reading all budgets to fix");for(const w of _.docs)try{const{exists:C,data:T}=await Le("budgets",w.id,"database cleanup: reading budget for update");if(!C||!T)continue;let j=!1;const B={...T};if(Array.isArray(T.accounts)){const H=T.accounts,z={};for(const J of H){const $=J.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;z[$]=DE(J),n++}B.accounts=z,j=!0,l++}if(Array.isArray(T.categories)){const H=T.categories,z={};for(const J of H){const $=J.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;z[$]=IE(J),i++}B.categories=z,j=!0,l++}if(Array.isArray(T.account_groups)){const H=T.account_groups,z={};for(const J of H){const $=J.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;z[$]=jE(J),a++}B.account_groups=z,j=!0,l++}if(!Array.isArray(T.accounts)&&T.accounts&&typeof T.accounts=="object"){const H=T.accounts,z={};for(const[J,$]of Object.entries(H))mT($)?(z[J]=DE($),n++,j=!0):z[J]=$;j&&(B.accounts=z)}if(!Array.isArray(T.categories)&&T.categories&&typeof T.categories=="object"){const H=T.categories,z={};let J=!1;for(const[$,re]of Object.entries(H))pT(re)?(z[$]=IE(re),i++,J=!0):z[$]=re;J&&(B.categories=z,j=!0)}if(!Array.isArray(T.account_groups)&&T.account_groups&&typeof T.account_groups=="object"){const H=T.account_groups,z={};let J=!1;for(const[$,re]of Object.entries(H))gT(re)?(z[$]=jE(re),a++,J=!0):z[$]=re;J&&(B.account_groups=z,j=!0)}if(T.month_map===void 0){const H=await N6(w.id);B.month_map=H,j=!0,c++,console.log(`[DatabaseCleanup] Added month_map to budget ${w.id} with ${Object.keys(H).length} months`)}delete B.category_balances,delete B.allocations,delete B.allocations_finalized,delete B.is_needs_recalculation,j&&(await pt("budgets",w.id,B,"database cleanup: saving fixed budget"),e++)}catch(C){t.push(`Budget ${w.id}: ${C instanceof Error?C.message:"Unknown error"}`)}const v=await br("months","database cleanup: reading all months"),b=_T();for(const w of v.docs)try{const C=w.data,T=C.year,j=C.month;if(T&&j&&vT(T,j,b)){await Ry("months",w.id,`database cleanup: deleting future month ${T}-${j}`),h++;continue}if(yT(C)){const B=M6(C,w.id);await pt("months",w.id,B,"database cleanup: saving fixed month"),m++}C.is_needs_recalculation!==void 0&&(await Na("months",w.id,{is_needs_recalculation:hM(),updated_at:new Date().toISOString()},`database cleanup: removing is_needs_recalculation from month ${T}/${j}`),g++,console.log(`[DatabaseCleanup] Removed is_needs_recalculation from month ${T}/${j}`))}catch(C){t.push(`Month ${w.id}: ${C instanceof Error?C.message:"Unknown error"}`)}return{budgetsProcessed:e,accountsFixed:n,categoriesFixed:i,groupsFixed:a,arraysConverted:l,monthMapsAdded:c,futureMonthsDeleted:h,monthsFixed:m,oldRecalcFieldsRemoved:g,errors:t}}function L6({currentUser:t,onComplete:e}){const[n,i]=A.useState(!1),[a,l]=A.useState(!1),[c,h]=A.useState(null),[m,g]=A.useState(null);async function _(){if(t){i(!0);try{const C=await O6();h(C)}catch(C){console.error("Failed to scan database:",C)}finally{i(!1)}}}async function v(){if(t){l(!0),g(null);try{const C=await P6();g(C),e?.()}catch(C){g({budgetsProcessed:0,accountsFixed:0,categoriesFixed:0,groupsFixed:0,arraysConverted:0,monthMapsAdded:0,futureMonthsDeleted:0,monthsFixed:0,oldRecalcFieldsRemoved:0,errors:[C instanceof Error?C.message:"Unknown error"]})}finally{l(!1)}}}const b=c!==null&&(c.budgetsWithArrays>0||c.accountsNeedingDefaults>0||c.categoriesNeedingDefaults>0||c.groupsNeedingDefaults>0||c.budgetsNeedingMonthMap>0||c.futureMonthsToDelete.length>0||c.monthsWithSchemaIssues>0||c.monthsWithOldRecalcField>0),w=c!==null?c.budgetsWithArrays+c.accountsNeedingDefaults+c.categoriesNeedingDefaults+c.groupsNeedingDefaults+c.budgetsNeedingMonthMap+c.futureMonthsToDelete.length+c.monthsWithSchemaIssues+c.monthsWithOldRecalcField:0;return{status:c,isScanning:n,scanStatus:_,hasIssues:b,totalIssues:w,isRunning:a,result:m,runCleanup:v}}function Bp(t){return t.includes("@")?!1:!!(/_[a-z0-9]+_(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=2||/_[a-z0-9]+\.(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=1)}function V6(t){let e=t;const n=/^(.+)_(gmail|yahoo|hotmail|outlook|icloud|aol|proton|protonmail)\.(.+)$/i,i=e.match(n);return i?`${i[1]}@${i[2]}.${i[3]}`:(e=e.replace(/_com$/,".com").replace(/_net$/,".net").replace(/_org$/,".org").replace(/_edu$/,".edu").replace(/_io$/,".io"),e=e.replace(/_gmail_/,"@gmail.").replace(/_yahoo_/,"@yahoo.").replace(/_hotmail_/,"@hotmail.").replace(/_outlook_/,"@outlook.").replace(/_icloud_/,"@icloud."),e)}function yh(t){if(t===null||typeof t!="object"||Array.isArray(t))return!1;const e=t;return e._methodName==="arrayUnion"&&Array.isArray(e.vc)}function bT(t){return t.vc||[]}function OE(t){return Array.isArray(t.items)?t.items:yh(t.items)?bT(t.items):[]}function z6({currentUser:t}){const[e,n]=A.useState(!1),[i,a]=A.useState(!1),[l,c]=A.useState(null),[h,m]=A.useState(null);async function g(){if(!t)return;n(!0);const v={documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],isHealthy:!0};try{const b=await br("feedback","feedback migration: scanning for issues");v.documentsFound=b.docs.length;for(const w of b.docs)Bp(w.id)&&v.sanitizedDocuments.push(w.id),yh(w.data.items)&&v.corruptedDocuments.push(w.id);v.isHealthy=v.sanitizedDocuments.length===0&&v.corruptedDocuments.length===0,c(v)}catch(b){console.error("Failed to scan feedback:",b)}finally{n(!1)}}async function _(){if(!t)return;a(!0);const v=h?{...h,mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]}:{documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]};try{const b=await br("feedback","feedback migration: listing all documents");v.documentsFound=b.docs.length,v.sanitizedDocuments=[],v.corruptedDocuments=[];for(const w of b.docs){const C=Bp(w.id);if(yh(w.data.items)&&!C){v.corruptedDocuments.push(w.id);const j=bT(w.data.items);try{await pt("feedback",w.id,{items:j,user_email:w.data.user_email||w.id,created_at:w.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: fixing corrupted arrayUnion in ${w.id}`),v.fixedDocuments++}catch(B){v.errors.push(`Failed to fix ${w.id}: ${B instanceof Error?B.message:"Unknown error"}`)}}}for(const w of b.docs)if(Bp(w.id)){v.sanitizedDocuments.push(w.id);const C=w.id,T=V6(C),j=OE(w.data),{exists:B,data:H}=await Le("feedback",T,`feedback migration: checking if ${T} exists`);if(B&&H){const z=OE(H),J=new Set(z.map(re=>re.id)),$=j.filter(re=>!J.has(re.id));if($.length>0||yh(H.items)){const re=[...z,...$];await pt("feedback",T,{...H,items:re,updated_at:new Date().toISOString()},`feedback migration: merging ${$.length} items from ${C}`),v.mergedItems+=$.length}}else j.length>0&&(await pt("feedback",T,{items:j,user_email:T,created_at:w.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: creating ${T} from ${C}`),v.mergedItems+=j.length);try{await Ry("feedback",C,`feedback migration: deleting sanitized document ${C}`),v.deletedDocuments++}catch(z){v.errors.push(`Failed to delete ${C}: ${z instanceof Error?z.message:"Unknown error"}`)}}m(v)}catch(b){v.errors.push(b instanceof Error?b.message:"Migration failed"),m(v)}finally{a(!1)}}return{status:l,isScanning:e,scanStatus:g,isMigratingFeedback:i,feedbackMigrationResult:h,migrateFeedbackDocuments:_}}function U6({currentUser:t,onComplete:e}){const[n,i]=A.useState(!1),[a,l]=A.useState(!1),[c,h]=A.useState(null),[m,g]=A.useState(null);async function _(){if(t){i(!0);try{const b=await br("months","delete all months: scanning for all months"),w=[],C=new Set;for(const T of b.docs){const{budget_id:j,year:B,month:H}=T.data;C.add(j),w.push({docId:T.id,budgetId:j,year:B,month:H})}w.sort((T,j)=>T.budgetId!==j.budgetId?T.budgetId.localeCompare(j.budgetId):T.year!==j.year?T.year-j.year:T.month-j.month),h({monthsToDelete:w,monthsCount:w.length,budgetCount:C.size})}catch(b){console.error("Failed to scan months:",b)}finally{i(!1)}}}async function v(){if(!t||!c||c.monthsToDelete.length===0)return;l(!0),g(null);let b=0;const w=[];for(const C of c.monthsToDelete)try{await Ry("months",C.docId,`delete all months: deleting month ${C.year}-${C.month} for budget ${C.budgetId}`),b++}catch(T){w.push(`Failed to delete ${C.docId}: ${T instanceof Error?T.message:"Unknown error"}`)}g({deleted:b,errors:w}),l(!1),w.length===0&&(h({monthsToDelete:[],monthsCount:0,budgetCount:0}),e?.())}return{status:c,isScanning:n,scanStatus:_,isDeleting:a,deleteResult:m,deleteAllMonths:v}}function B6({onCreateNew:t}){const[e,n]=A.useState(""),[i,a]=A.useState(!1),[l,c]=A.useState(null);async function h(m){m.preventDefault(),a(!0),c(null);try{await t(e.trim()||void 0)}catch(g){c(g instanceof Error?g.message:"Failed to create budget"),a(!1)}}return d.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:l}),d.jsx("button",{onClick:()=>c(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Create Your Budget"]}),d.jsxs("form",{onSubmit:h,children:[d.jsxs("div",{style:{marginBottom:"1.5rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:e,onChange:m=>n(m.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),d.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),d.jsx("button",{type:"submit",disabled:i,style:{width:"100%",background:ce.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontWeight:600,opacity:i?.7:1,fontSize:"1rem"},children:i?"Creating...":"Create Budget"})]})]}),d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function F6({invites:t,onAccept:e,onCreateNew:n}){const[i,a]=A.useState(null),[l,c]=A.useState(!1),[h,m]=A.useState(""),[g,_]=A.useState(!1),[v,b]=A.useState(null);async function w(T){a(T),b(null);try{await e(T)}catch(j){b(j instanceof Error?j.message:"Failed to accept invitation"),a(null)}}async function C(T){T.preventDefault(),_(!0),b(null);try{await n(h.trim()||void 0)}catch(j){b(j instanceof Error?j.message:"Failed to create new budget"),_(!1)}}return d.jsxs("div",{children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Budget Invitations"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(T=>d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:T.budgetName}),T.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",T.ownerEmail]})]}),d.jsx("button",{onClick:()=>w(T.budgetId),disabled:i!==null||g,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null||g?"not-allowed":"pointer",fontWeight:500,opacity:i!==null||g?.7:1,fontSize:"0.9rem"},children:i===T.budgetId?"Joining...":"Accept & Join"})]},T.budgetId))})]}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?d.jsxs("form",{onSubmit:C,children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),d.jsxs("div",{style:{marginBottom:"1rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:h,onChange:T=>m(T.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{type:"submit",disabled:g||i!==null,style:{background:ce.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||i!==null?"not-allowed":"pointer",fontWeight:500,opacity:g||i!==null?.7:1,fontSize:"0.9rem"},children:g?"Creating...":"Create Budget"}),d.jsx("button",{type:"button",onClick:()=>{c(!1),m("")},disabled:g,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g?"not-allowed":"pointer",fontWeight:500,opacity:g?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),d.jsx("button",{onClick:()=>c(!0),disabled:i!==null,style:{background:ce.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null?"not-allowed":"pointer",fontWeight:500,opacity:i!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function q6({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const i=A.useMemo(()=>[{id:"categories",label:"Categories",checkmark:n},{id:"accounts",label:"Accounts"},{id:"income",label:"Income"},{id:"spend",label:"Spend"}],[n]);return d.jsx(Hy,{mode:"button",tabs:i,activeTab:t,onTabChange:a=>e(a)})}function H6({isOpen:t,onClose:e,onProceed:n,results:i}){const a=!i||i.status==="confirming",l=i&&!["confirming","done","error"].includes(i.status),c=a||i?.status==="done"||i?.status==="error";function h(){c&&e()}return d.jsx(ml,{isOpen:t,onClose:h,title:"Recalculate Balances",width:"540px",children:d.jsxs("div",{style:{padding:"0.5rem 0"},children:[a&&d.jsxs(d.Fragment,{children:[d.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",lineHeight:1.5},children:["This will recalculate category balances and account balances from the ",d.jsx("strong",{children:"current month forward"}),"."]}),d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Use this if your data seems out of sync or after fixing bugs. Past months will not be modified."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginBottom:"1.5rem"},children:[d.jsx(Bo,{status:"waiting",label:"Find all months to process"}),d.jsx(Bo,{status:"waiting",label:"Process months"}),d.jsx(Bo,{status:"waiting",label:"Update budget totals"})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Me,{variant:"secondary",actionName:"Cancel Recalculation",onClick:e,children:"Cancel"}),d.jsx(Me,{actionName:"Proceed with Recalculation",onClick:n,children:"Proceed"})]})]}),!a&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Recalculating category balances and account balances..."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx(Bo,{status:i?.status==="pending"?"waiting":"complete",label:"Find all months to process",detail:i&&i.status!=="pending"?`Found ${i.monthsFound||0} month${i.monthsFound!==1?"s":""}`:void 0}),d.jsx(Bo,{status:ME(i?.status,["pending","finding_months"],"processing_months"),label:"Process months",detail:i?.status==="processing_months"?`Processing: ${i.currentMonthLabel} (${(i.currentMonthIndex||0)+1}/${i.monthsFound||0})`:i?.monthsProcessed!==void 0?`Processed ${i.monthsProcessed} month${i.monthsProcessed!==1?"s":""}`:void 0}),d.jsx(Bo,{status:i?.status==="error"?"error":ME(i?.status,["pending","finding_months","processing_months"],"updating_budget"),label:"Update budget totals",detail:i?.status==="error"?i.error:void 0,isError:i?.status==="error"})]}),i?.status==="done"&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${ce.success} 10%, transparent)`,border:`1px solid ${ce.success}`,borderRadius:"8px",textAlign:"center"},children:[d.jsx("p",{style:{margin:0,fontWeight:600,color:ce.success},children:" Recalculation complete!"}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:[i.monthsProcessed," month",i.monthsProcessed!==1?"s":""," processed",d.jsx("br",{}),"Total Income: ",Se(i.totalIncomeRecalculated||0),d.jsx("br",{}),"Total Expenses: ",Se(i.totalExpensesRecalculated||0)]})]}),(i?.status==="done"||i?.status==="error")&&d.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"center"},children:d.jsx(Me,{actionName:"Close Recalculation Modal",onClick:e,children:"Done"})}),l&&d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"Please wait, do not close this window..."})]})]})})}function ME(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function Bo({status:t,label:e,detail:n,isError:i}){const a=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:a}),d.jsxs("div",{style:{flex:1},children:[d.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:i?1:.6,color:i?ce.error:"inherit"},children:n})]})]})}function Qy({isDisabled:t,onCloseMenu:e}){const{selectedBudgetId:n,currentUserId:i,currentYear:a,currentMonthNumber:l}=Zt(),{categories:c,accounts:h,saveCategories:m,saveAccounts:g}=On(n,i),[_,v]=A.useState(!1),[b,w]=A.useState(!1),[C,T]=A.useState(null);function j(){w(!0),T({status:"confirming"})}async function B(){if(n){v(!0),T({status:"pending"});try{T({status:"finding_months"});const z=new Date,J=a||z.getFullYear(),$=l||z.getMonth()+1,{year:re,month:P}=Dy(J,$),R={year:re,month:P},D=await tk(n,re,P),N=Object.keys(c);T({status:"finding_months",monthsFound:D.length}),await new Promise(W=>setTimeout(W,100));const M={};let k=null;const I=hi(n,R.year,R.month),{exists:ae,data:q}=await Le("months",I,"recalculate: reading previous month for starting balances");if(ae&&q&&(k=q,q.category_balances))for(const W of q.category_balances)M[W.category_id]=W.end_balance??0;N.forEach(W=>{M[W]===void 0&&(M[W]=0)});let L=0,Q=0;for(let W=0;W<D.length;W++){const X=D[W],ee=`${nl[X.month-1]} ${X.year}`;T({status:"processing_months",monthsFound:D.length,currentMonthIndex:W,currentMonthLabel:ee});const ge=hi(n,X.year,X.month),{exists:me,data:Ee}=await Le("months",ge,`recalculate: reading full month data for ${ee}`);if(!me||!Ee){console.warn(`Month ${ee} not found, skipping`);continue}const fe=Ee.income||[],Z=Ee.expenses||[],De=Ee.are_allocations_finalized||!1,Pe=fe.reduce((nt,Fn)=>nt+Fn.amount,0),gt=Z.reduce((nt,Fn)=>nt+Fn.amount,0);L+=Pe,Q+=gt;const Qe={};if(Ee.category_balances)for(const nt of Ee.category_balances)Qe[nt.category_id]={allocated:nt.allocated??0};const dn=N.map(nt=>{const Fn=M[nt]??0;let Er=0;De&&Qe[nt]&&(Er=Qe[nt].allocated);let Ct=0;Z.length>0&&(Ct=Z.filter(Vt=>Vt.category_id===nt).reduce((Vt,Hn)=>Vt+Hn.amount,0));const qn=Fn+Er-Ct;return{category_id:nt,start_balance:Fn,allocated:Er,spent:Ct,end_balance:qn}});dn.forEach(nt=>{M[nt.category_id]=nt.end_balance});const yi=(W===0?k:D[W-1])?.total_income??0,At=Object.keys(h).map(nt=>{const Fn=fe.filter(Vt=>Vt.account_id===nt).reduce((Vt,Hn)=>Vt+Hn.amount,0),Er=Z.filter(Vt=>Vt.account_id===nt).reduce((Vt,Hn)=>Vt+Hn.amount,0),Ct=Fn-Er;let qn=0;if(Ee.account_balances){const Vt=Ee.account_balances.find(Hn=>Hn.account_id===nt);Vt&&(qn=Vt.start_balance??0)}return{account_id:nt,start_balance:qn,income:Fn,expenses:Er,net_change:Ct,end_balance:qn+Ct}}),jt={budget_id:n,year_month_ordinal:Jt(X.year,X.month),year:X.year,month:X.month,income:fe,total_income:Pe,previous_month_income:yi,expenses:Z,total_expenses:gt,account_balances:At,category_balances:dn,are_allocations_finalized:De,created_at:Ee.created_at||new Date().toISOString(),updated_at:new Date().toISOString()};await b1({budgetId:n,month:jt,description:"recalculate all months"}),await new Promise(nt=>setTimeout(nt,50))}const K={};Object.keys(h).forEach(W=>{K[W]=0});const oe=await br("months","recalculate: querying all months for account balances",[{field:"budget_id",op:"==",value:n}]);for(const W of oe.docs){const X=hi(n,W.data.year,W.data.month),{exists:ee,data:ge}=await Le("months",X,`recalculate: reading month ${W.data.year}/${W.data.month} for account balances`);if(!ee||!ge)continue;const me=ge.income||[],Ee=ge.expenses||[];for(const fe of me)fe.account_id&&K[fe.account_id]!==void 0&&(K[fe.account_id]+=fe.amount);for(const fe of Ee)fe.account_id&&K[fe.account_id]!==void 0&&(K[fe.account_id]-=fe.amount)}const ue={};Object.entries(h).forEach(([W,X])=>{ue[W]={...X,balance:K[W]??0}}),await g(ue),T({status:"updating_budget",monthsFound:D.length,monthsProcessed:D.length,totalIncomeRecalculated:L,totalExpensesRecalculated:Q});const U={...M},F={};Object.entries(c).forEach(([W,X])=>{F[W]={...X,balance:U[W]??0}}),await m(F);for(const W of D)st.invalidateQueries({queryKey:xe.month(n,W.year,W.month)});T({status:"done",monthsFound:D.length,monthsProcessed:D.length,totalIncomeRecalculated:L,totalExpensesRecalculated:Q})}catch(z){console.error("Recalculate error:",z),T({status:"error",error:z instanceof Error?z.message:"Failed to recalculate"})}finally{v(!1)}}}function H(){w(!1),T(null),e?.()}return d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:j,disabled:t||_,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:t||_?"not-allowed":"pointer",opacity:t||_?.5:1,fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},title:"Recalculate balances from this month forward",children:[_?"":""," Recalculate"]}),d.jsx(H6,{isOpen:b,onClose:H,onProceed:B,results:C})]})}function kE({direction:t,isDisabled:e,isLoading:n,disabledReason:i,onNavigate:a}){const[l,c]=A.useState(!1),h=n||e,m=t==="prev"?"":"",g=t==="prev"?"Previous month":"Next month",_=()=>{n||(e?(c(!0),setTimeout(()=>c(!1),2e3)):a())};return d.jsxs("div",{style:{position:"relative"},children:[d.jsx("button",{onClick:_,onMouseEnter:()=>e&&c(!0),onMouseLeave:()=>c(!1),style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:h?"not-allowed":"pointer",fontSize:"1.25rem",opacity:h?.5:1,transition:"opacity 0.15s, background 0.15s"},title:e?void 0:g,children:m}),l&&e&&d.jsx("div",{style:{position:"absolute",top:"100%",...t==="prev"?{left:0}:{right:0},marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:ce.warning,color:"#000",borderRadius:"6px",fontSize:"0.75rem",fontWeight:500,width:"max-content",maxWidth:"min(300px, 50vw)",textAlign:"center",zIndex:20,boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:i})]})}function Ig(){const t=new Date;let e=t.getFullYear(),n=t.getMonth()+1+3;for(;n>12;)n-=12,e+=1;return{year:e,month:n}}function xT(){const t=new Date;let e=t.getFullYear(),n=t.getMonth()+1-3;for(;n<1;)n+=12,e-=1;return{year:e,month:n}}function NE(t,e){const n=xT();return t<n.year||t===n.year&&e<n.month}function G6(t,e){const n=Ig();return t>n.year||t===n.year&&e>n.month}function Fp(t,e,n){return Jt(t,e)in n}function Q6(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function $6(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}function K6({onPreviousMonth:t,onNextMonth:e}){const{isLoading:n}=jn(),{currentYear:i,currentMonthNumber:a,isAdmin:l,selectedBudgetId:c,currentUserId:h,setCurrentYear:m,setCurrentMonthNumber:g}=Zt(),{budget:_,monthMap:v}=On(c,h),{month:b}=Ja(c,i,a),w=Q6(i,a),C=$6(i,a),T=NE(w.year,w.month)&&!Fp(w.year,w.month,v),j=G6(C.year,C.month),[B,H]=A.useState(!1),[z,J]=A.useState(!1),[$,re]=A.useState(i),[P,R]=A.useState(a),D=A.useRef(null);A.useEffect(()=>{if(!B)return;function I(ae){D.current&&!D.current.contains(ae.target)&&(H(!1),J(!1))}return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[B]);function N(){z||(re(i),R(a)),J(!z)}function M(){const I=Ig(),ae=xT();let q=$,L=P;const Q=(q-new Date().getFullYear())*12+(L-(new Date().getMonth()+1)),K=3;Q>K&&(q=I.year,L=I.month,console.log(`[MonthNavigation] Clamping to max allowed month: ${q}/${L}`)),Q<-K&&!Fp(q,L,v)&&(q=ae.year,L=ae.month,console.log(`[MonthNavigation] Clamping to min allowed month: ${q}/${L}`)),m(q),g(L),J(!1),H(!1)}function k(){if(!b||!_)return;const I={...b,_meta:{downloaded_at:new Date().toISOString(),budget_id:_.id,budget_name:_.name}},ae=new Blob([JSON.stringify(I,null,2)],{type:"application/json"}),q=URL.createObjectURL(ae),L=document.createElement("a");L.href=q,L.download=`month_${i}_${String(a).padStart(2,"0")}.json`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(q),H(!1)}return d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[d.jsx(kE,{direction:"prev",isDisabled:T,isLoading:n,disabledReason:"Cannot create months more than 3 months in the past",onNavigate:t}),d.jsxs("div",{ref:D,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[d.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[nl[a-1]," ",i]}),d.jsx("button",{onClick:()=>H(!B),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:B?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),n&&d.jsxs(d.Fragment,{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:ce.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),B&&d.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[d.jsx(Qy,{isDisabled:n,onCloseMenu:()=>H(!1)}),d.jsx("button",{onClick:N,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Jump to a specific month",children:" Go to Month"}),z&&d.jsxs("div",{style:{padding:"0.75rem",borderTop:"1px solid color-mix(in srgb, currentColor 15%, transparent)",marginTop:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[d.jsx("button",{onClick:()=>re(I=>I-1),style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"4px",padding:"0.25rem 0.5rem",cursor:"pointer",fontSize:"0.8rem"},children:""}),d.jsx("span",{style:{flex:1,textAlign:"center",fontSize:"0.9rem",fontWeight:500},children:$}),d.jsx("button",{onClick:()=>re(I=>I+1),style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"4px",padding:"0.25rem 0.5rem",cursor:"pointer",fontSize:"0.8rem"},children:""})]}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.25rem",marginBottom:"0.5rem"},children:nl.map((I,ae)=>{const q=ae+1,L=q===P,Q=$===i&&q===a,K=Ig(),oe=$>K.year||$===K.year&&q>K.month,ue=NE($,q)&&!Fp($,q,v),U=oe||ue;let F=I;return oe?F="Cannot create months more than 3 months in the future":ue&&(F="Cannot create months more than 3 months in the past"),d.jsx("button",{onClick:()=>R(q),disabled:U,style:{background:L?ce.primary:"color-mix(in srgb, currentColor 8%, transparent)",border:Q?`1px solid ${ce.primary}`:"1px solid transparent",borderRadius:"4px",padding:"0.35rem 0.25rem",cursor:U?"not-allowed":"pointer",fontSize:"0.7rem",color:L?"#fff":"inherit",opacity:U?.3:1,transition:"background 0.15s"},title:F,children:I.slice(0,3)},q)})}),d.jsxs("button",{onClick:M,style:{width:"100%",background:ce.primary,border:"none",borderRadius:"6px",padding:"0.5rem",cursor:"pointer",fontSize:"0.85rem",color:"#fff",fontWeight:500},children:["Go to ",nl[P-1]," ",$]})]}),l&&b&&d.jsx("button",{onClick:()=>{k()},style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),d.jsx(kE,{direction:"next",isDisabled:j,isLoading:n,disabledReason:"Cannot create months more than 3 months in the future",onNavigate:e})]})}const W6={background:ce.primary,border:"none",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px",color:"white"},Y6={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"},X6={background:"transparent",border:`1px solid ${ce.errorBorder}`,color:ce.error,cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"};function ET({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:c,defaultDate:h,config:m,onSubmit:g,onCancel:_,onDelete:v,extraContent:b}){const{isWide:w}=p6(),{showCategory:C=!1,showCleared:T=!1,accountLabel:j="Account",payeePlaceholder:B="Payee name",descriptionPlaceholder:H="Optional note",submitLabel:z}=m,J=new Date().toISOString().split("T")[0],[$,re]=A.useState(l?.date||h||J),[P,R]=A.useState(l?.payee||""),[D,N]=A.useState(l?.categoryId||""),[M,k]=A.useState(l?.accountId||c||(t[0]?t[0][0]:"")),[I,ae]=A.useState(l?.amount?.toString()||""),[q,L]=A.useState(l?.description||""),[Q,K]=A.useState(l?.cleared||!1),oe={},ue=[];t.forEach(([Z,De])=>{De.account_group_id?(oe[De.account_group_id]||(oe[De.account_group_id]=[]),oe[De.account_group_id].push([Z,De])):ue.push([Z,De])});function U(Z){Z.preventDefault();const De=parseFloat(I);isNaN(De)||De<=0||C&&!D||!M||!$||g({date:$,payee:P.trim()||void 0,categoryId:C?D:void 0,accountId:M,amount:De,description:q.trim()||void 0,cleared:T?Q:void 0})}const F=d.jsxs(iu,{id:"txn-account",value:M,onChange:Z=>k(Z.target.value),required:!0,style:{fontSize:"0.85rem",padding:"0.5rem"},children:[Object.entries(e).map(([Z,De])=>{const Pe=oe[Z];return Pe?.length?d.jsx("optgroup",{label:De.name,children:Pe.map(([gt,Qe])=>d.jsx("option",{value:gt,children:Qe.nickname},gt))},Z):null}),ue.length>0&&d.jsx("optgroup",{label:"Other",children:ue.map(([Z,De])=>d.jsx("option",{value:Z,children:De.nickname},Z))})]}),W=C&&n&&i?d.jsx(Wt,{label:"Category",htmlFor:"txn-category",children:d.jsx(e6,{id:"txn-category",value:D,onChange:N,categories:n,categoryGroups:i,placeholder:"Search...",required:!0})}):null,X=T?d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.35rem"},children:[d.jsx("label",{htmlFor:"txn-cleared",style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:"Clr"}),d.jsx(Os,{id:"txn-cleared",checked:Q,onChange:Z=>K(Z.target.checked)})]}):null,ee=d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.1rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[d.jsx("button",{type:"submit",title:z,style:W6,children:""}),d.jsx("button",{type:"button",onClick:()=>{_()},title:"Cancel",style:Y6,children:""}),v&&d.jsx("button",{type:"button",onClick:()=>{v()},title:"Delete",style:X6,children:""})]})]}),ge=d.jsxs(Xa,{children:[d.jsx(Me,{type:"submit",actionName:z,children:z}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Transaction Form",onClick:_,children:"Cancel"}),v&&d.jsx(Me,{type:"button",variant:"danger",actionName:"Delete Transaction",onClick:v,children:" Delete"})]}),me=C&&n&&i,Ee={fontSize:"0.85rem",padding:"0.5rem"};if(!w)return d.jsxs(qa,{actionName:z,onSubmit:U,children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[d.jsx(Wt,{label:"Date",htmlFor:"txn-date",children:d.jsx(CE,{id:"txn-date",value:$,onChange:Z=>re(Z.target.value),required:!0})}),d.jsx(Wt,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(Rg,{id:"txn-amount",value:I,onChange:ae,placeholder:"$0.00",required:!0,autoFocus:!0})})]}),d.jsx(Wt,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(AE,{id:"txn-payee",value:P,onChange:R,payees:a,placeholder:B})}),W,d.jsx(Wt,{label:j,htmlFor:"txn-account",children:F}),d.jsx(Wt,{label:"Description (optional)",htmlFor:"txn-description",children:d.jsx(Ha,{id:"txn-description",value:q,onChange:Z=>L(Z.target.value),placeholder:H})}),T&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx(Os,{id:"txn-cleared-stacked",checked:Q,onChange:Z=>K(Z.target.checked)}),d.jsx("label",{htmlFor:"txn-cleared-stacked",style:{fontSize:"0.9rem",cursor:"pointer"},children:"Cleared (appeared in bank account)"})]}),b]}),ge]});const fe=me?T?"6rem minmax(8rem, 1fr) minmax(8rem, 1fr) minmax(8rem, 1fr) 6rem minmax(10rem, 2fr) auto auto":"6rem minmax(8rem, 1fr) minmax(8rem, 1fr) minmax(8rem, 1fr) 6rem minmax(10rem, 2fr) auto":T?"6rem minmax(10rem, 1fr) minmax(10rem, 1fr) 6rem minmax(12rem, 2fr) auto auto":"6rem minmax(10rem, 1fr) minmax(10rem, 1fr) 6rem minmax(12rem, 2fr) auto";return d.jsxs(qa,{actionName:z,onSubmit:U,children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:fe,gap:"1rem",alignItems:"end"},children:[d.jsx(Wt,{label:"Date",htmlFor:"txn-date",children:d.jsx(CE,{id:"txn-date",value:$,onChange:Z=>re(Z.target.value),required:!0,style:Ee})}),d.jsx(Wt,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(AE,{id:"txn-payee",value:P,onChange:R,payees:a,placeholder:B})}),W,d.jsx(Wt,{label:j,htmlFor:"txn-account",children:F}),d.jsx(Wt,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(Rg,{id:"txn-amount",value:I,onChange:ae,placeholder:"$0.00",required:!0,autoFocus:!0})}),d.jsx(Wt,{label:"Description",htmlFor:"txn-description",children:d.jsx(Ha,{id:"txn-description",value:q,onChange:Z=>L(Z.target.value),placeholder:H,style:Ee})}),X,ee]}),b]})}function PE({accounts:t,accountGroups:e,payees:n,initialData:i,defaultAccountId:a,defaultDate:l,onSubmit:c,onCancel:h,onDelete:m,submitLabel:g}){function _(v){c(v.amount,v.accountId,v.date,v.payee,v.description)}return d.jsx(ET,{accounts:t,accountGroups:e,payees:n,initialData:i?{date:i.date,payee:i.payee,accountId:i.account_id,amount:i.amount,description:i.description}:void 0,defaultAccountId:a,defaultDate:l,config:{showCategory:!1,showCleared:!1,accountLabel:"Deposit To",payeePlaceholder:"e.g., Employer, Client name",descriptionPlaceholder:"e.g., January paycheck",submitLabel:g},onSubmit:_,onCancel:h,onDelete:m})}const Fo={fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderTop:"1px solid rgba(255,255,255,0.1)"};function J6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,setCurrentYear:a,setCurrentMonthNumber:l}=Zt(),{accounts:c,accountGroups:h}=On(t,e),{month:m,isLoading:g,addIncome:_,updateIncome:v,deleteIncome:b}=Ja(t,n,i),w=na(),[C,T]=A.useState(null),[j,B]=A.useState(!1),[H,z]=A.useState(null),re=A1(t,{enabled:j||H!==null}).data||[];function P(K){const oe=K.account_group_id?h[K.account_group_id]:void 0;return oe?.is_active!==void 0?oe.is_active:K.is_active!==!1}function R(K){const oe=K.account_group_id?h[K.account_group_id]:void 0;return oe?.on_budget!==void 0?oe.on_budget:K.on_budget!==!1}const D=Object.entries(c).filter(([,K])=>P(K)&&R(K)),N=D.filter(([,K])=>K.is_income_account),M=N.length>0?N:D,k=D.find(([,K])=>K.is_income_default),I=k?k[0]:void 0,ae=m?.income.reduce((K,oe)=>K+oe.amount,0)||0;function q(K,oe,ue,U,F){T(null),B(!1);const[W,X]=ue.split("-").map(Number);_(K,oe,ue,U,F).then(()=>{(W!==n||X!==i)&&(a(W),l(X))}).catch(ee=>{T(ee instanceof Error?ee.message:"Failed to add income")})}function L(K,oe,ue,U,F,W){T(null),z(null),v(K,oe,ue,U,F,W).catch(X=>{T(X instanceof Error?X.message:"Failed to update income")})}function Q(K){confirm("Are you sure you want to delete this income entry?")&&(T(null),b(K).catch(oe=>{T(oe instanceof Error?oe.message:"Failed to delete income")}))}return d.jsxs("div",{style:{opacity:g?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:g?"none":"auto"},children:[C&&d.jsx("div",{style:{background:`color-mix(in srgb, ${ce.error} 15%, transparent)`,border:`1px solid ${ce.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ce.error},children:C}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:w?"1fr":"5rem 1.5fr 2fr 7rem 1.5fr 3rem"},children:[d.jsxs("div",{style:{gridColumn:"1 / -1",position:"sticky",top:0,zIndex:49,backgroundColor:"#242424",borderBottom:"1px solid rgba(255,255,255,0.15)",display:"grid",gridTemplateColumns:"subgrid"},children:[d.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem",paddingTop:"0.5rem",paddingBottom:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[d.jsx("span",{style:{fontWeight:600},children:"Income:"}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Total: "}),d.jsx("span",{style:{color:It(ae),fontWeight:600},children:Se(ae)})]})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:!j&&d.jsx(Me,{actionName:"Open Add Income Form",onClick:()=>B(!0),disabled:M.length===0,style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:"+ Add Income"})})]}),!w&&d.jsxs(d.Fragment,{children:[d.jsx("div",{style:Fo,children:"Date"}),d.jsx("div",{style:Fo,children:"Payee"}),d.jsx("div",{style:Fo,children:"Account"}),d.jsx("div",{style:{...Fo,textAlign:"right"},children:"Amount"}),d.jsx("div",{style:Fo,children:"Description"}),d.jsx("div",{style:Fo})]})]}),d.jsx("div",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",opacity:.55,fontStyle:"italic",padding:"0.5rem 0"},children:" All income entries on this page count towards the tithing owed calculation."}),M.length===0&&d.jsxs("p",{style:{gridColumn:"1 / -1",opacity:.6,fontSize:"0.9rem",padding:"1rem 0"},children:[Object.keys(c).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",d.jsx(wt,{to:"/budget/accounts",style:{color:ce.primaryLight},children:"Manage accounts "})]}),j&&d.jsx("div",{style:{gridColumn:"1 / -1",marginBottom:"1rem"},children:d.jsx(PE,{accounts:M,accountGroups:h,payees:re,defaultAccountId:I,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:q,onCancel:()=>B(!1),submitLabel:"Add Income",isMobile:w})}),m?.income.slice().sort((K,oe)=>(K.date||"").localeCompare(oe.date||"")).map((K,oe)=>H===K.id?d.jsx("div",{style:{gridColumn:"1 / -1",padding:"0.5rem"},children:d.jsx(PE,{accounts:M,accountGroups:h,payees:re,initialData:K,onSubmit:(ue,U,F,W,X)=>L(K.id,ue,U,F,W,X),onCancel:()=>z(null),onDelete:()=>Q(K.id),submitLabel:"Save",isMobile:w})},K.id):d.jsx(Z6,{income:K,accountName:c[K.account_id]?.nickname||"Unknown Account",accountGroupName:c[K.account_id]?.account_group_id?h[c[K.account_id].account_group_id]?.name:void 0,onEdit:()=>{K.payee||`${K.amount}`,z(K.id)},onDelete:()=>Q(K.id),isMobile:w,isEvenRow:oe%2===0},K.id)),(!m?.income||m.income.length===0)&&!j&&d.jsx("p",{style:{gridColumn:"1 / -1",opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No income recorded for this month"}),d.jsx("div",{style:{gridColumn:"1 / -1",height:"2rem"}})]})]})}function Z6({income:t,accountName:e,accountGroupName:n,onEdit:i,onDelete:a,isMobile:l,isEvenRow:c}){const h=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",m=n?`${n} / ${e}`:e,g=c?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 6%, transparent)";if(l)return d.jsxs("div",{onClick:i,style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",background:g,cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:h}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""})]}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",m]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:ce.success,fontFamily:"monospace"},children:["+",Se(t.amount)]})})]});const _={padding:"0.6rem 0.25rem",background:g,display:"flex",alignItems:"center",fontSize:"0.9rem"};return d.jsxs("div",{style:{display:"contents"},children:[d.jsx("div",{style:{..._,fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:h}),d.jsx("div",{style:{..._,fontWeight:500,overflow:"hidden"},children:d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),d.jsx("div",{style:{..._,opacity:.7,overflow:"hidden"},children:d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.85rem"},children:m})}),d.jsxs("div",{style:{..._,justifyContent:"flex-end",fontWeight:600,color:ce.success,fontFamily:"monospace"},children:["+",Se(t.amount)]}),d.jsx("div",{style:{..._,paddingLeft:"0.5rem",opacity:.6,overflow:"hidden"},children:d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.8rem"},children:t.description||""})}),d.jsxs("div",{style:{..._,justifyContent:"flex-end",gap:"0.25rem"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:v=>v.currentTarget.style.opacity="1",onMouseLeave:v=>v.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:v=>v.currentTarget.style.opacity="1",onMouseLeave:v=>v.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function LE({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:c,defaultDate:h,onSubmit:m,onCancel:g,onDelete:_,submitLabel:v}){function b(w){m(w.amount,w.categoryId,w.accountId,w.date,w.payee,w.description,w.cleared)}return d.jsx(ET,{accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l?{date:l.date,payee:l.payee,categoryId:l.category_id,accountId:l.account_id,amount:l.amount,description:l.description,cleared:l.cleared}:void 0,defaultAccountId:c,defaultDate:h,config:{showCategory:!0,showCleared:!0,accountLabel:"Pay From",payeePlaceholder:"e.g., Grocery Store",descriptionPlaceholder:"e.g., Weekly groceries",submitLabel:v},onSubmit:b,onCancel:g,onDelete:_})}const js={fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderTop:"1px solid rgba(255,255,255,0.1)"};function eP(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,setCurrentYear:a,setCurrentMonthNumber:l}=Zt(),{accounts:c,accountGroups:h,categories:m,categoryGroups:g}=On(t,e),{month:_,isLoading:v,addExpense:b,updateExpense:w,deleteExpense:C}=Ja(t,n,i),T=na(),[j,B]=A.useState(null),[H,z]=A.useState(!1),[J,$]=A.useState(null),R=A1(t,{enabled:H||J!==null}).data||[];function D(ue){const U=ue.account_group_id?h[ue.account_group_id]:void 0;return U?.is_active!==void 0?U.is_active:ue.is_active!==!1}function N(ue){const U=ue.account_group_id?h[ue.account_group_id]:void 0;return U?.on_budget!==void 0?U.on_budget:ue.on_budget!==!1}const M=Object.entries(c).filter(([,ue])=>D(ue)&&N(ue)),k=M.filter(([,ue])=>ue.is_outgo_account),I=k.length>0?k:M,ae=M.find(([,ue])=>ue.is_outgo_default),q=ae?ae[0]:void 0,L=_?.expenses?.reduce((ue,U)=>ue+U.amount,0)||0;function Q(ue,U,F,W,X,ee,ge){B(null),z(!1);const[me,Ee]=W.split("-").map(Number);b(ue,U,F,W,X,ee,ge).then(()=>{(me!==n||Ee!==i)&&(a(me),l(Ee))}).catch(fe=>{B(fe instanceof Error?fe.message:"Failed to add expense")})}function K(ue,U,F,W,X,ee,ge,me){B(null),$(null),w(ue,U,F,W,X,ee,ge,me).catch(Ee=>{B(Ee instanceof Error?Ee.message:"Failed to update expense")})}function oe(ue){confirm("Are you sure you want to delete this expense?")&&(B(null),C(ue).catch(U=>{B(U instanceof Error?U.message:"Failed to delete expense")}))}return d.jsxs("div",{style:{opacity:v?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:v?"none":"auto"},children:[j&&d.jsx("div",{style:{background:`color-mix(in srgb, ${ce.error} 15%, transparent)`,border:`1px solid ${ce.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ce.error},children:j}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:T?"1fr":"5rem 1.5fr 7rem 1fr 6rem 1fr 3rem 4rem"},children:[d.jsxs("div",{style:{gridColumn:"1 / -1",position:"sticky",top:0,zIndex:49,backgroundColor:"#242424",borderBottom:"1px solid rgba(255,255,255,0.15)",display:"grid",gridTemplateColumns:"subgrid"},children:[d.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem",paddingTop:"0.5rem",paddingBottom:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[d.jsx("span",{style:{fontWeight:600},children:"Expenses:"}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Total: "}),d.jsxs("span",{style:{color:$i(L),fontWeight:600},children:[L>0?"-":"",Se(L)]})]})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:!H&&d.jsx(Me,{actionName:"Open Add Expense Form",onClick:()=>z(!0),disabled:I.length===0||Object.keys(m).length===0,style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:"+ Add Expense"})})]}),!T&&d.jsxs(d.Fragment,{children:[d.jsx("div",{style:js,children:"Date"}),d.jsx("div",{style:js,children:"Payee"}),d.jsx("div",{style:{...js,textAlign:"center"},children:"Category"}),d.jsx("div",{style:js,children:"Account"}),d.jsx("div",{style:{...js,textAlign:"right"},children:"Amount"}),d.jsx("div",{style:js,children:"Description"}),d.jsx("div",{style:{...js,textAlign:"center"},children:"Clr"}),d.jsx("div",{style:js})]})]}),I.length===0&&d.jsxs("p",{style:{gridColumn:"1 / -1",opacity:.6,fontSize:"0.9rem",padding:"1rem 0"},children:[Object.keys(c).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",d.jsx(wt,{to:"/budget/accounts",style:{color:ce.primaryLight},children:"Manage accounts "})]}),Object.keys(m).length===0&&d.jsxs("p",{style:{gridColumn:"1 / -1",opacity:.6,fontSize:"0.9rem",padding:"1rem 0"},children:["You need to create at least one category before adding expenses."," ",d.jsx(wt,{to:"/budget/settings/categories",style:{color:ce.primaryLight},children:"Create categories "})]}),H&&d.jsx("div",{style:{gridColumn:"1 / -1",marginBottom:"1rem"},children:d.jsx(LE,{accounts:I,accountGroups:h,categories:m,categoryGroups:g,payees:R,defaultAccountId:q,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:Q,onCancel:()=>z(!1),submitLabel:"Add Expense",isMobile:T})}),_?.expenses?.slice().sort((ue,U)=>(ue.date||"").localeCompare(U.date||"")).map((ue,U)=>J===ue.id?d.jsx("div",{style:{gridColumn:"1 / -1",padding:"0.5rem"},children:d.jsx(LE,{accounts:I,accountGroups:h,categories:m,categoryGroups:g,payees:R,initialData:ue,onSubmit:(F,W,X,ee,ge,me,Ee)=>K(ue.id,F,W,X,ee,ge,me,Ee),onCancel:()=>$(null),onDelete:()=>oe(ue.id),submitLabel:"Save",isMobile:T})},ue.id):d.jsx(tP,{expense:ue,categoryName:m[ue.category_id]?.name||"Unknown Category",accountName:c[ue.account_id]?.nickname||"Unknown Account",accountGroupName:c[ue.account_id]?.account_group_id?h[c[ue.account_id].account_group_id]?.name:void 0,onEdit:()=>{ue.payee||`${ue.amount}`,$(ue.id)},onDelete:()=>oe(ue.id),isMobile:T,isEvenRow:U%2===0},ue.id)),(!_?.expenses||_.expenses.length===0)&&!H&&d.jsx("p",{style:{gridColumn:"1 / -1",opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No expenses recorded for this month"}),d.jsx("div",{style:{gridColumn:"1 / -1",height:"2rem"}})]})]})}function tP({expense:t,categoryName:e,accountName:n,accountGroupName:i,onEdit:a,onDelete:l,isMobile:c,isEvenRow:h}){const m=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",g=i?`${i} / ${n}`:n,_=h?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 6%, transparent)";if(c)return d.jsxs("div",{onClick:a,style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",background:_,cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:m}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""}),t.cleared&&d.jsx("span",{style:{fontSize:"0.7rem",color:ce.success},title:"Cleared",children:""})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:{fontSize:"0.7rem",background:`color-mix(in srgb, ${ce.primary} 20%, transparent)`,color:ce.primaryLight,padding:"0.1rem 0.4rem",borderRadius:"3px"},children:e}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",g]})]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:$i(t.amount),fontFamily:"monospace"},children:["-",Se(t.amount)]})})]});const v={padding:"0.6rem 0.25rem",background:_,display:"flex",alignItems:"center",fontSize:"0.9rem"};return d.jsxs("div",{style:{display:"contents"},children:[d.jsx("div",{style:{...v,fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:m}),d.jsx("div",{style:{...v,fontWeight:500,overflow:"hidden"},children:d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),d.jsx("div",{style:{...v,justifyContent:"center"},children:d.jsx("span",{style:{fontSize:"0.8rem",background:`color-mix(in srgb, ${ce.primary} 15%, transparent)`,color:ce.primaryLight,padding:"0.2rem 0.5rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e})}),d.jsx("div",{style:{...v,opacity:.7,overflow:"hidden"},children:d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.85rem"},children:g})}),d.jsxs("div",{style:{...v,justifyContent:"flex-end",fontWeight:600,color:$i(t.amount),fontFamily:"monospace"},children:["-",Se(t.amount)]}),d.jsx("div",{style:{...v,paddingLeft:"0.5rem",opacity:.6,overflow:"hidden"},children:d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.8rem"},children:t.description||""})}),d.jsx("div",{style:{...v,justifyContent:"center",color:t.cleared?ce.success:"inherit",opacity:t.cleared?1:.3,fontSize:"1rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{...v,justifyContent:"flex-end",gap:"0.25rem"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:b=>b.currentTarget.style.opacity="1",onMouseLeave:b=>b.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:b=>b.currentTarget.style.opacity="1",onMouseLeave:b=>b.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function nP({isOpen:t,onClose:e,onDeleted:n}){const{addLoadingHold:i,removeLoadingHold:a}=jn(),{selectedBudgetId:l,currentYear:c,currentMonthNumber:h}=Zt(),{deleteAllocations:m}=E1(),[g,_]=A.useState(null),v=async()=>{if(l){_(null),i("allocations-delete","Deleting allocations...");try{await m({budgetId:l,year:c,month:h}),e(),n?.()}catch(b){_(b instanceof Error?b.message:"Failed to delete allocations")}finally{a("allocations-delete")}}};return d.jsxs(ml,{isOpen:t,onClose:e,title:"Delete Allocations",children:[g&&d.jsx(Ya,{message:g,onDismiss:()=>_(null)}),d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to delete all allocations for this month? This will remove all allocated amounts and reset the month to unfinalized."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Me,{actionName:"Cancel Delete Allocations",variant:"secondary",onClick:e,children:"Cancel"}),d.jsx(Me,{actionName:"Confirm Delete Allocations",variant:"danger",onClick:v,children:"Delete Allocations"})]})]})}function VE({isDraftMode:t,isEditingAppliedAllocations:e,availableNow:n,currentMonthIncome:i,balanceTotals:a,draftChangeAmount:l,availableAfterApply:c,currentDraftTotal:h}){const m=t&&h!==void 0?h:a.allocated;return d.jsxs(d.Fragment,{children:[d.jsx("span",{style:{fontWeight:600,color:t||e?ce.primary:"inherit",marginRight:"0.25rem"},children:t||e?"Allocations Worksheet:":"Month Summary:"}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:t?"Avail: ":"Inc: "}),t?d.jsx("span",{style:{color:It(n),fontWeight:600},children:Se(n)}):d.jsxs("span",{style:{color:ce.success,fontWeight:600},children:["+",Se(i)]})]}),d.jsxs("span",{children:[t&&d.jsx("span",{style:{opacity:.6},children:" "}),d.jsx("span",{style:{opacity:.6},children:t?"Draft: ":"Alloc: "}),d.jsxs("span",{style:{color:t?ce.primary:ce.success,fontWeight:600},children:[t?"":"+",Se(t?m:a.allocated)]}),e&&l!==0&&d.jsxs("span",{style:{fontSize:"0.85em",color:l>0?ce.warning:ce.success,marginLeft:"0.25rem"},children:["(",l>0?"+":"",Se(Math.abs(l)),")"]})]}),!t&&d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Spent: "}),d.jsxs("span",{style:{color:$i(a.spent),fontWeight:600},children:["-",Se(a.spent)]})]}),d.jsxs("span",{children:[t&&d.jsx("span",{style:{opacity:.6},children:"= "}),d.jsx("span",{style:{opacity:.6},children:t?"Remaining: ":"Net: "}),t?d.jsx("span",{style:{color:It(c),fontWeight:600},children:Se(c)}):d.jsx("span",{style:{color:It(a.allocated-a.spent),fontWeight:600},children:Se(a.allocated-a.spent)})]})]})}function rP({totals:t}){return d.jsxs(d.Fragment,{children:[d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Start: "}),d.jsx("span",{style:{color:It(t.start),fontWeight:600},children:Se(t.start)})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Inc: "}),d.jsxs("span",{style:{color:ce.success,fontWeight:600},children:["+",Se(t.income)]})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Exp: "}),d.jsxs("span",{style:{color:$i(t.expenses),fontWeight:600},children:["-",Se(t.expenses)]})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"End: "}),d.jsx("span",{style:{color:It(t.end),fontWeight:600},children:Se(t.end)})]})]})}function qp({isDraftMode:t,isEditingAppliedAllocations:e,allocationsFinalized:n,onSave:i,onApply:a,onEdit:l,onCancel:c,onDelete:h}){return d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:[t&&!e&&d.jsxs(d.Fragment,{children:[d.jsx(Me,{actionName:"Save Draft Allocations",onClick:i,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Save"}),d.jsx(Me,{actionName:"Apply Allocations",onClick:a,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Apply"})]}),!t&&n&&d.jsx(Me,{actionName:"Edit Allocations",onClick:l,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Edit Allocations"}),e&&d.jsxs(d.Fragment,{children:[d.jsx(Me,{actionName:"Apply Allocations",onClick:a,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Apply"}),d.jsx(Me,{actionName:"Cancel Edit Allocations",onClick:c,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:""}),d.jsx(Me,{actionName:"Open Delete Allocations Modal",onClick:h,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em",color:ce.error},children:""})]})]})}function iP({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l,projectedAllTime:c}){const h=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,m=h?t.default_monthly_amount/100*i:0,g=h?m.toFixed(2):n,_=a&&!h,v=a?c:t.balance??0,b=t.balance??0,w=b<0,C=w?Math.abs(b):0,T=h?m:parseFloat(n)||0,j=w?Math.min(T,C):0,B=w?Math.max(0,T-C):0,H=w&&T>0&&B>0;return d.jsxs("div",{style:{background:w?ce.debtBg:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem",boxShadow:w?`inset 0 0 0 2px ${ce.debtBorder}`:"none"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.name})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{style:{color:In(e.start_balance)},children:Se(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),_?d.jsxs(d.Fragment,{children:[d.jsx("input",{type:"text",inputMode:"decimal",value:g?`$${g}`:"",onChange:z=>{const J=z.target.value.replace(/[^\d.]/g,"");l(J)},placeholder:"$0",style:{width:"100%",maxWidth:"80px",padding:"0.25rem 0.35rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 8%, transparent)",fontSize:"0.8rem",color:"inherit",boxSizing:"border-box"}}),w&&T>0&&d.jsxs("div",{style:{fontSize:"0.65rem",marginTop:"0.15rem",lineHeight:1.3},children:[d.jsxs("span",{style:{color:ce.debt,display:"block"},children:[Se(j),"  debt"]}),H&&d.jsxs("span",{style:{color:ce.success,display:"block"},children:[Se(B),"  balance"]})]})]}):d.jsxs("span",{style:{color:bf(e.allocated)},children:[e.allocated>0?"+":"",Se(e.allocated)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),d.jsxs("span",{style:{color:$i(e.spent)},children:[e.spent>0?"-":"",Se(e.spent)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:In(e.end_balance)},children:Se(e.end_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:a?"Proj. All-Time":"All-Time"}),d.jsx("span",{style:{color:a?v<0?ce.debt:ce.primary:In(v)},children:Se(v)})]})]}),a&&h&&d.jsx("div",{style:{marginTop:"0.5rem"},children:d.jsxs("span",{style:{fontSize:"0.8rem"},children:[d.jsxs("span",{style:{opacity:.6},children:[Se(i),"  "]}),d.jsxs("span",{style:{color:ce.primary},children:[t.default_monthly_amount,"%"]}),d.jsx("span",{style:{opacity:.6},children:" = "}),d.jsx("span",{style:{color:ce.primary},children:Se(m)})]})})]})}function zE({name:t,categories:e,groupTotals:n,getCategoryBalance:i,localAllocations:a,savedAllocations:l,previousMonthIncome:c,isDraftMode:h,onAllocationChange:m,isMobile:g,isUngrouped:_,getAllocationAmount:v}){const b={paddingTop:"0.6rem",paddingBottom:"0.6rem",paddingLeft:"0.5rem",paddingRight:"0.5rem",marginTop:"1.25rem",borderTop:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.04)",display:"flex",alignItems:"center",fontSize:"0.9rem",fontWeight:600},w=n.allocated-n.spent,C=e.reduce((T,[j,B])=>{const H=B.balance??0;if(h){const z=v(j,B),J=l[j]??0,$=z-J;return T+H+$}return T+H},0);return d.jsxs("div",{style:{display:"contents"},children:[!g&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{...b,paddingLeft:"0.5rem",opacity:_?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400},children:["(",e.length,")"]})]}),!h&&d.jsx("div",{style:{...b,justifyContent:"flex-end",color:In(n.start)},children:Se(n.start)}),d.jsxs("div",{style:{...b,justifyContent:h?"center":"flex-end",color:bf(n.allocated)},children:["+",Se(n.allocated)]}),!h&&d.jsxs("div",{style:{...b,justifyContent:"flex-end",color:$i(n.spent)},children:["-",Se(n.spent)]}),!h&&d.jsxs("div",{style:{...b,justifyContent:"flex-end",color:In(w)},children:[w>=0?"+":"",Se(w)]}),!h&&d.jsx("div",{style:{...b,justifyContent:"flex-end",color:In(n.end),paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:Se(n.end)}),d.jsx("div",{style:{...b,justifyContent:"flex-end",color:C<0?ce.debt:ce.primary},children:Se(C)})]}),!h&&g&&d.jsxs("div",{style:{gridColumn:"1 / -1",paddingTop:"0.6rem",paddingBottom:"0.6rem",paddingLeft:"0.5rem",paddingRight:"0.5rem",marginTop:"1.25rem",borderTop:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.04)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("span",{style:{fontWeight:600,opacity:_?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400},children:["(",e.length,")"]})]}),d.jsx("span",{style:{fontWeight:600,color:In(n.end)},children:Se(n.end)})]}),e.map(([T,j],B)=>{const H=i(T);if(!H)return null;const z=j.balance??0;let J=z;if(h){const $=v(T,j),re=l[T]??0,P=$-re;J=z+P}return g?d.jsx("div",{style:{gridColumn:"1 / -1"},children:d.jsx(iP,{category:j,balance:H,localAllocation:a[T]||"",previousMonthIncome:c,isDraftMode:h,onAllocationChange:$=>m(T,$),projectedAllTime:J})},T):d.jsx(sP,{category:j,balance:H,localAllocation:a[T]||"",previousMonthIncome:c,isDraftMode:h,onAllocationChange:$=>m(T,$),allTimeBalance:J,isEvenRow:B%2===0},T)})]})}function sP({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l,allTimeBalance:c,isEvenRow:h}){const m=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,g=m?t.default_monthly_amount/100*i:0,_=m?g.toFixed(2):n,v=t.balance??0,b=v<0,w=b?Math.abs(v):0,C=m?g:parseFloat(n)||0,T=b?Math.min(C,w):0,j=b?Math.max(0,C-w):0,B=b&&C>0&&j>0,H=b?ce.debtBg:h?"rgba(255,255,255,0.02)":"transparent",z={paddingTop:"0.6rem",paddingBottom:"0.6rem",paddingLeft:"0.5rem",paddingRight:"0.5rem",background:H,display:"flex",alignItems:"center",fontSize:"0.9rem",minHeight:"2.4rem",boxSizing:"border-box"},J=e.allocated-e.spent;return d.jsxs("div",{style:{display:"contents"},children:[d.jsx("div",{style:{paddingTop:"0.6rem",paddingBottom:"0.6rem",paddingRight:"0.5rem",paddingLeft:"1.5rem",background:H,display:"flex",alignItems:"center",fontSize:"0.9rem",fontWeight:500,overflow:"hidden",borderLeft:"2px solid rgba(255,255,255,0.1)",minHeight:"2.4rem",boxSizing:"border-box"},children:d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name})}),!a&&d.jsx("div",{style:{...z,justifyContent:"flex-end",color:In(e.start_balance)},children:Se(e.start_balance)}),a?d.jsx("div",{style:{...z,justifyContent:"center",flexDirection:"column",gap:"0.1rem",paddingTop:"0.35rem",paddingBottom:"0.35rem"},children:m?d.jsxs("span",{style:{fontSize:"0.85rem"},children:[d.jsxs("span",{style:{color:ce.primary},children:[t.default_monthly_amount,"%"]}),d.jsx("span",{style:{opacity:.5},children:" = "}),d.jsx("span",{style:{color:ce.primary},children:Se(g)})]}):d.jsxs(d.Fragment,{children:[d.jsx("input",{type:"text",inputMode:"decimal",value:_?`$${_}`:"",onChange:$=>{const re=$.target.value.replace(/[^\d.]/g,"");l(re)},placeholder:"$0.00",style:{width:"100px",padding:"0.2rem 0.5rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",lineHeight:1,color:"inherit",boxSizing:"border-box"}}),b&&C>0&&d.jsxs("div",{style:{fontSize:"0.6rem",whiteSpace:"nowrap",textAlign:"center",lineHeight:1},children:[d.jsxs("span",{style:{color:ce.debt},children:[Se(T),"  debt"]}),B&&d.jsxs("span",{style:{color:ce.success,marginLeft:"0.35rem"},children:[Se(j),"  bal"]})]})]})}):(()=>{const $=e.start_balance<0,re=$?Math.abs(e.start_balance):0,P=$?Math.min(e.allocated,re):0,R=$?Math.max(0,e.allocated-re):0,D=$&&e.allocated>0;return d.jsxs("div",{style:{...z,justifyContent:"flex-end",flexDirection:"column",alignItems:"flex-end",gap:"0.1rem",color:bf(e.allocated)},children:[d.jsxs("span",{children:["+",Se(e.allocated)]}),D&&d.jsxs("div",{style:{fontSize:"0.6rem",whiteSpace:"nowrap",textAlign:"right",lineHeight:1},children:[d.jsxs("span",{style:{color:ce.debt},children:[Se(P),"  debt"]}),R>0&&d.jsxs("span",{style:{color:ce.success,marginLeft:"0.35rem"},children:[Se(R),"  bal"]})]})]})})(),!a&&d.jsxs("div",{style:{...z,justifyContent:"flex-end",color:$i(e.spent)},children:["-",Se(e.spent)]}),!a&&d.jsxs("div",{style:{...z,justifyContent:"flex-end",color:In(J)},children:[J>=0?"+":"",Se(J)]}),!a&&d.jsx("div",{style:{...z,justifyContent:"flex-end",fontWeight:600,color:In(e.end_balance),paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:Se(e.end_balance)}),d.jsx("div",{style:{...z,justifyContent:"flex-end",color:c<0?ce.debt:ce.primary},children:Se(c)})]})}function aP(t){const e=Object.entries(t).reduce((n,[i,a])=>{const l=a.category_group_id||"ungrouped";return n[l]||(n[l]=[]),n[l].push([i,a]),n},{});return Object.keys(e).forEach(n=>{e[n].sort((i,a)=>i[1].sort_order-a[1].sort_order)}),e}function oP(t,e,n,i,a){const l={};t?.category_balances&&t.category_balances.forEach(h=>{l[h.category_id]=h});const c={};return Object.entries(e).forEach(([h,m])=>{const g=l[h],_=g?.start_balance??0,v=g?.spent??0;let b=0;n?b=a(h,m):i&&g&&(b=g.allocated),c[h]={category_id:h,start_balance:_,allocated:b,spent:v,end_balance:_+b-v}}),c}function lP(t,e){const n={};t?.account_balances&&t.account_balances.forEach(a=>{n[a.account_id]=a});const i={};return Object.entries(e).forEach(([a,l])=>{const h=n[a]?.start_balance??l.balance;let m=0;t?.income&&(m=t.income.filter(v=>v.account_id===a).reduce((v,b)=>v+b.amount,0));let g=0;t?.expenses&&(g=t.expenses.filter(v=>v.account_id===a).reduce((v,b)=>v+b.amount,0));const _=m-g;i[a]={account_id:a,start_balance:h,income:m,expenses:g,net_change:_,end_balance:h+_}}),i}function cP(t){return Object.values(t).reduce((e,n)=>({start:e.start+n.start_balance,income:e.income+n.income,expenses:e.expenses+n.expenses,netChange:e.netChange+n.net_change,end:e.end+n.end_balance}),{start:0,income:0,expenses:0,netChange:0,end:0})}function uP(t){return Object.values(t).reduce((e,n)=>({start:e.start+n.start_balance,allocated:e.allocated+n.allocated,spent:e.spent+n.spent,end:e.end+n.end_balance}),{start:0,allocated:0,spent:0,end:0})}const ja={fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"2px solid rgba(255,255,255,0.2)"};function dP(){const{addLoadingHold:t,removeLoadingHold:e}=jn(),{selectedBudgetId:n,currentUserId:i,currentYear:a,currentMonthNumber:l}=Zt(),{categories:c,categoryGroups:h,monthMap:m}=On(n,i),{month:g}=Ja(n,a,l),_=na(),v=Jt(a,l),b=m[v]?.needs_recalculation===!0,w=A.useRef(!1);A.useEffect(()=>{!n||!g||!b||w.current||(w.current=!0,t("balances-recalc","Recalculating balances..."),`${a}${String(l).padStart(2,"0")}`,Iy(n,{}).then(()=>{st.invalidateQueries({queryKey:xe.month(n,a,l)})}).catch(ee=>{console.error("[MonthCategories] Recalculation failed:",ee)}).finally(()=>{w.current=!1,e("balances-recalc")}))},[n,b,g,a,l,t,e]);const[C,T]=A.useState(!1),{localAllocations:j,isEditingAppliedAllocations:B,error:H,availableNow:z,currentDraftTotal:J,draftChangeAmount:$,availableAfterApply:re,previousMonthIncome:P,currentMonthIncome:R,allocationsFinalized:D,getAllocationAmount:N,handleAllocationChange:M,resetAllocationsToSaved:k,handleSaveAllocations:I,handleFinalizeAllocations:ae,setIsEditingAppliedAllocations:q,setError:L}=T6(),Q=[...h].sort((ee,ge)=>ee.sort_order-ge.sort_order),K=A.useMemo(()=>aP(c),[c]),oe=!D||B,ue=A.useMemo(()=>oP(g,c,oe,D,N),[g,c,oe,D,N]),U=ee=>ue[ee],F=A.useMemo(()=>uP(ue),[ue]),W=A.useMemo(()=>{const ee={};if(g?.category_balances)for(const ge of g.category_balances)ee[ge.category_id]=ge.allocated;return ee},[g]),X=A.useMemo(()=>Object.entries(c).reduce((ee,[ge,me])=>{const Ee=me.balance??0;if(oe){const fe=N(ge,me),Z=W[ge]??0,De=fe-Z;return ee+Ee+De}return ee+Ee},0),[c,oe,N,W]);return d.jsxs(d.Fragment,{children:[H&&d.jsx(Ya,{message:H,onDismiss:()=>L(null)}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:_?"1fr":oe?"2fr 200px 120px":"2fr 1fr 1fr 1fr 1fr 1fr 120px"},children:[d.jsxs("div",{style:{gridColumn:"1 / -1",position:"sticky",top:0,zIndex:49,backgroundColor:"#242424",display:_?"block":"grid",gridTemplateColumns:_?void 0:"subgrid"},children:[oe&&d.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem",paddingTop:"0.5rem",paddingBottom:_?"0.5rem":"0.25rem"},children:[d.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:d.jsx(VE,{isDraftMode:oe,isEditingAppliedAllocations:B,availableNow:z,currentMonthIncome:R,balanceTotals:F,draftChangeAmount:$,availableAfterApply:re,currentDraftTotal:J})}),d.jsx(qp,{isDraftMode:oe,isEditingAppliedAllocations:B,allocationsFinalized:D,onSave:I,onApply:ae,onEdit:()=>q(!0),onCancel:k,onDelete:()=>T(!0)})]}),!_&&d.jsxs(d.Fragment,{children:[d.jsx("div",{style:ja,children:"Category"}),!oe&&d.jsx("div",{style:{...ja,textAlign:"right"},children:"Start"}),d.jsx("div",{style:{...ja,textAlign:oe?"center":"right"},children:"Allocated"}),!oe&&d.jsx("div",{style:{...ja,textAlign:"right"},children:"Spent"}),!oe&&d.jsx("div",{style:{...ja,textAlign:"right"},children:"Net Change"}),!oe&&d.jsx("div",{style:{...ja,textAlign:"right",paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:"End"}),d.jsx("div",{style:{...ja,textAlign:"right"},children:"All-Time"})]}),!oe&&!_&&(()=>{const ee={paddingTop:"0.6rem",paddingBottom:"0.6rem",paddingLeft:"0.5rem",paddingRight:"0.5rem",borderTop:"2px solid rgba(255,255,255,0.3)",borderBottom:"2px solid rgba(255,255,255,0.3)",fontWeight:600,display:"flex",alignItems:"center",fontSize:"0.9rem"},ge=F.allocated-F.spent;return d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{...ee,gap:"0.75rem"},children:["Grand Totals",d.jsx(qp,{isDraftMode:!1,isEditingAppliedAllocations:!1,allocationsFinalized:D,onSave:I,onApply:ae,onEdit:()=>q(!0),onCancel:k,onDelete:()=>T(!0)})]}),d.jsx("div",{style:{...ee,justifyContent:"flex-end",color:In(F.start)},children:Se(F.start)}),d.jsxs("div",{style:{...ee,justifyContent:"flex-end",color:bf(F.allocated)},children:["+",Se(F.allocated)]}),d.jsxs("div",{style:{...ee,justifyContent:"flex-end",color:$i(F.spent)},children:["-",Se(F.spent)]}),d.jsxs("div",{style:{...ee,justifyContent:"flex-end",color:In(ge)},children:[ge>=0?"+":"",Se(ge)]}),d.jsx("div",{style:{...ee,justifyContent:"flex-end",color:In(F.end),paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:Se(F.end)}),d.jsx("div",{style:{...ee,justifyContent:"flex-end",color:X<0?ce.debt:ce.primary},children:Se(X)})]})})(),!oe&&_&&d.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderTop:"2px solid rgba(255,255,255,0.3)",borderBottom:"2px solid rgba(255,255,255,0.3)"},children:[d.jsx("span",{style:{fontWeight:600},children:"Grand Totals:"}),d.jsx(VE,{isDraftMode:!1,isEditingAppliedAllocations:!1,availableNow:z,currentMonthIncome:R,balanceTotals:F,draftChangeAmount:$,availableAfterApply:re,currentDraftTotal:J}),d.jsx(qp,{isDraftMode:!1,isEditingAppliedAllocations:!1,allocationsFinalized:D,onSave:I,onApply:ae,onEdit:()=>q(!0),onCancel:k,onDelete:()=>T(!0)})]})]}),Object.keys(c).length===0&&d.jsxs("p",{style:{gridColumn:"1 / -1",opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",d.jsx(wt,{to:"/budget/settings/categories",style:{color:ce.primaryLight},children:"Create categories "})]}),Q.map(ee=>{const ge=K[ee.id]||[];if(ge.length===0)return null;const me=ge.reduce((Ee,[fe])=>{const Z=U(fe);return Z?{start:Ee.start+Z.start_balance,allocated:Ee.allocated+Z.allocated,spent:Ee.spent+Z.spent,end:Ee.end+Z.end_balance}:Ee},{start:0,allocated:0,spent:0,end:0});return d.jsx(zE,{name:ee.name,categories:ge,groupTotals:me,getCategoryBalance:U,localAllocations:j,savedAllocations:W,previousMonthIncome:P,isDraftMode:oe,onAllocationChange:M,isMobile:_,getAllocationAmount:N},ee.id)}),K.ungrouped?.length>0&&(()=>{const ee=K.ungrouped,ge=ee.reduce((me,[Ee])=>{const fe=U(Ee);return fe?{start:me.start+fe.start_balance,allocated:me.allocated+fe.allocated,spent:me.spent+fe.spent,end:me.end+fe.end_balance}:me},{start:0,allocated:0,spent:0,end:0});return d.jsx(zE,{name:"Uncategorized",categories:ee,groupTotals:ge,getCategoryBalance:U,localAllocations:j,savedAllocations:W,previousMonthIncome:P,isDraftMode:oe,onAllocationChange:M,isMobile:_,isUngrouped:!0,getAllocationAmount:N},"ungrouped")})(),d.jsx("div",{style:{gridColumn:"1 / -1",height:"2rem"}})]}),d.jsx(nP,{isOpen:C,onClose:()=>T(!1),onDeleted:()=>q(!1)})]})}function ST(t){return t>0?ce.success:"rgba(255,255,255,0.4)"}function wT(t){return t>0?ce.error:"rgba(255,255,255,0.4)"}function TT(t){return t>0?ce.success:t<0?ce.error:"rgba(255,255,255,0.4)"}function UE({name:t,accounts:e,groupTotals:n,accountBalances:i,isMobile:a,isUngrouped:l}){const c={padding:"0.6rem 0.5rem",marginTop:"1.25rem",borderTop:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.04)",display:"flex",alignItems:"center",fontSize:"0.9rem",fontWeight:600};return d.jsxs("div",{style:{display:"contents"},children:[d.jsxs("div",{style:{...c,opacity:l?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400},children:["(",e.length,")"]})]}),d.jsx("div",{style:{...c,justifyContent:"flex-end",color:It(n.start)},children:Se(n.start)}),d.jsxs("div",{style:{...c,justifyContent:"flex-end",color:ST(n.income)},children:["+",Se(n.income)]}),d.jsxs("div",{style:{...c,justifyContent:"flex-end",color:wT(n.expenses)},children:["-",Se(n.expenses)]}),d.jsxs("div",{style:{...c,justifyContent:"flex-end",color:TT(n.netChange)},children:[n.netChange>=0?"+":"",Se(n.netChange)]}),d.jsx("div",{style:{...c,justifyContent:"flex-end",color:It(n.end)},children:Se(n.end)}),e.map(([h,m],g)=>{const _=i[h];return _?a?d.jsx("div",{style:{gridColumn:"1 / -1"},children:d.jsx(fP,{account:m,balance:_})},h):d.jsx(hP,{account:m,balance:_,isEvenRow:g%2===0},h):null})]})}function hP({account:t,balance:e,isEvenRow:n}){const a={padding:"0.5rem 0.5rem",background:n?"rgba(255,255,255,0.02)":"transparent",display:"flex",alignItems:"center",fontSize:"0.9rem"};return d.jsxs("div",{style:{display:"contents"},children:[d.jsx("div",{style:{...a,fontWeight:500,overflow:"hidden",paddingLeft:"1.5rem",borderLeft:"2px solid rgba(255,255,255,0.1)"},children:d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.nickname})}),d.jsx("div",{style:{...a,justifyContent:"flex-end",color:It(e.start_balance)},children:Se(e.start_balance)}),d.jsxs("div",{style:{...a,justifyContent:"flex-end",color:ST(e.income)},children:["+",Se(e.income)]}),d.jsxs("div",{style:{...a,justifyContent:"flex-end",color:wT(e.expenses)},children:["-",Se(e.expenses)]}),d.jsxs("div",{style:{...a,justifyContent:"flex-end",color:TT(e.net_change)},children:[e.net_change>=0?"+":"",Se(e.net_change)]}),d.jsx("div",{style:{...a,justifyContent:"flex-end",fontWeight:600,color:It(e.end_balance)},children:Se(e.end_balance)})]})}function fP({account:t,balance:e}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem",marginBottom:"0.25rem"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.nickname})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:Se(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Net Change"}),d.jsxs("span",{style:{color:It(e.net_change)},children:[e.net_change>=0?"+":"",Se(e.net_change)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:It(e.end_balance)},children:Se(e.end_balance)})]})]}),(e.income>0||e.expenses>0)&&d.jsxs("div",{style:{marginTop:"0.5rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)",display:"flex",gap:"1rem",fontSize:"0.7rem",opacity:.7},children:[e.income>0&&d.jsxs("span",{children:["+",Se(e.income)," income"]}),e.expenses>0&&d.jsxs("span",{children:["-",Se(e.expenses)," expenses"]})]})]})}const qo={fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"2px solid rgba(255,255,255,0.2)"};function mP(t){return t>0?ce.success:"rgba(255,255,255,0.4)"}function pP(t){return t>0?ce.error:"rgba(255,255,255,0.4)"}function gP(t){return t>0?ce.success:t<0?ce.error:"rgba(255,255,255,0.4)"}function yP(){const{addLoadingHold:t,removeLoadingHold:e}=jn(),{selectedBudgetId:n,currentUserId:i,currentYear:a,currentMonthNumber:l}=Zt(),{accounts:c,accountGroups:h,monthMap:m}=On(n,i),{month:g}=Ja(n,a,l),_=na(),v=Jt(a,l),b=m[v]?.needs_recalculation===!0,w=A.useRef(!1);A.useEffect(()=>{!n||!g||!b||w.current||(w.current=!0,t("balances-recalc","Recalculating balances..."),`${a}${String(l).padStart(2,"0")}`,Iy(n,{}).then(()=>{st.invalidateQueries({queryKey:xe.month(n,a,l)})}).catch($=>{console.error("[MonthAccounts] Recalculation failed:",$)}).finally(()=>{w.current=!1,e("balances-recalc")}))},[n,b,g,a,l,t,e]);const C=A.useMemo(()=>Object.entries(h).map(([$,re])=>({id:$,...re})).sort(($,re)=>$.sort_order-re.sort_order),[h]),T=A.useMemo(()=>{const $={};return Object.entries(c).forEach(([re,P])=>{const R=P.account_group_id||"ungrouped";$[R]||($[R]=[]),$[R].push([re,P])}),Object.keys($).forEach(re=>{$[re].sort((P,R)=>P[1].sort_order-R[1].sort_order)}),$},[c]),j=A.useMemo(()=>lP(g,c),[g,c]),B=A.useMemo(()=>cP(j),[j]),H=B.income-B.expenses,J={...{padding:"0.6rem 0.5rem",display:"flex",alignItems:"center",fontSize:"0.9rem"},borderTop:"2px solid rgba(255,255,255,0.3)",borderBottom:"2px solid rgba(255,255,255,0.3)",fontWeight:600};return d.jsx(d.Fragment,{children:d.jsxs("div",{style:{display:"grid",gridTemplateColumns:_?"1fr":"2fr 1fr 1fr 1fr 1fr 1fr"},children:[d.jsxs("div",{style:{gridColumn:"1 / -1",position:"sticky",top:0,zIndex:49,backgroundColor:"#242424",display:"grid",gridTemplateColumns:"subgrid"},children:[!_&&d.jsxs(d.Fragment,{children:[d.jsx("div",{style:qo,children:"Account"}),d.jsx("div",{style:{...qo,textAlign:"right"},children:"Start"}),d.jsx("div",{style:{...qo,textAlign:"right"},children:"Income"}),d.jsx("div",{style:{...qo,textAlign:"right"},children:"Expenses"}),d.jsx("div",{style:{...qo,textAlign:"right"},children:"Net Change"}),d.jsx("div",{style:{...qo,textAlign:"right"},children:"End"})]}),_?d.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderTop:"2px solid rgba(255,255,255,0.3)",borderBottom:"2px solid rgba(255,255,255,0.3)"},children:[d.jsx("span",{style:{fontWeight:600},children:"Grand Totals:"}),d.jsx(rP,{totals:B})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{...J},children:"Grand Totals"}),d.jsx("div",{style:{...J,justifyContent:"flex-end",color:It(B.start)},children:Se(B.start)}),d.jsxs("div",{style:{...J,justifyContent:"flex-end",color:mP(B.income)},children:["+",Se(B.income)]}),d.jsxs("div",{style:{...J,justifyContent:"flex-end",color:pP(B.expenses)},children:["-",Se(B.expenses)]}),d.jsxs("div",{style:{...J,justifyContent:"flex-end",color:gP(H)},children:[H>=0?"+":"",Se(H)]}),d.jsx("div",{style:{...J,justifyContent:"flex-end",color:It(B.end)},children:Se(B.end)})]})]}),Object.keys(c).length===0&&d.jsxs("p",{style:{gridColumn:"1 / -1",opacity:.6,textAlign:"center",padding:"2rem"},children:["No accounts yet."," ",d.jsx(wt,{to:"/budget/settings/accounts",style:{color:ce.primaryLight},children:"Add accounts "})]}),C.map($=>{const re=T[$.id]||[];if(re.length===0)return null;const P=re.reduce((R,[D])=>{const N=j[D];return N?{start:R.start+N.start_balance,income:R.income+N.income,expenses:R.expenses+N.expenses,netChange:R.netChange+N.net_change,end:R.end+N.end_balance}:R},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(UE,{name:$.name,accounts:re,groupTotals:P,accountBalances:j,isMobile:_},$.id)}),T.ungrouped?.length>0&&(()=>{const $=T.ungrouped,re=$.reduce((P,[R])=>{const D=j[R];return D?{start:P.start+D.start_balance,income:P.income+D.income,expenses:P.expenses+D.expenses,netChange:P.netChange+D.net_change,end:P.end+D.end_balance}:P},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(UE,{name:"Ungrouped",accounts:$,groupTotals:re,accountBalances:j,isMobile:_,isUngrouped:!0},"ungrouped")})(),d.jsx("div",{style:{gridColumn:"1 / -1",height:"2rem"}})]})})}const _P=["income","categories","accounts","spend"];function BE(t){const e=t.year?parseInt(t.year,10):null,n=t.month?parseInt(t.month,10):null,i=t.tab&&_P.includes(t.tab)?t.tab:null;return{year:e&&!isNaN(e)&&e>=2e3&&e<=2100?e:null,month:n&&!isNaN(n)&&n>=1&&n<=12?n:null,tab:i}}function FE(){const t=rR(),e=_l(),{currentUserId:n,selectedBudgetId:i,currentYear:a,currentMonthNumber:l,lastActiveTab:c,setCurrentYear:h,setCurrentMonthNumber:m,setLastActiveTab:g,setPageTitle:_,goToPreviousMonth:v,goToNextMonth:b,hasPendingInvites:w,pendingInvites:C,needsFirstBudget:T}=Zt(),{budget:j,createBudget:B,acceptInvite:H}=On(i,n),{month:z,error:J}=Ja(i,a,l),$=A.useRef(!1),{error:re,setError:P}=j6({monthError:J,currentYear:a,currentMonthNumber:l,lastActiveTab:c}),[R,D]=A.useState(()=>{const{tab:q}=BE(t);return q??c}),N=q=>{D(q),g(q)};A.useEffect(()=>{if($.current)return;const{year:q,month:L}=BE(t);q&&h(q),L&&m(L),$.current=!0},[t,h,m]),A.useEffect(()=>{if(!$.current)return;const q=`/budget/${a}/${l}/${R}`,L=`/budget/${t.year}/${t.month}/${t.tab}`;q!==L&&e(q,{replace:!0})},[a,l,R,e,t]),A.useLayoutEffect(()=>{_(j?.name||"Budget")},[j?.name,_]);async function M(q){try{await H(q)}catch(L){P(L instanceof Error?L.message:"Failed to accept invite")}}async function k(q){try{await B(q||"My Budget")}catch(L){P(L instanceof Error?L.message:"Failed to create budget")}}if(!j&&w)return d.jsx(F6,{invites:C,onAccept:M,onCreateNew:k});if(!j&&T)return d.jsx(B6,{onCreateNew:k});function I(){P(null),v()}function ae(){P(null),b()}return d.jsxs(fT,{children:[re&&d.jsx(Ya,{message:re,onDismiss:()=>P(null)}),d.jsx(K6,{onPreviousMonth:I,onNextMonth:ae}),d.jsx(q6,{activeTab:R,setActiveTab:N,allocationsFinalized:z?.are_allocations_finalized}),R==="income"&&d.jsx(J6,{},`${a}-${l}`),R==="categories"&&d.jsx(dP,{},`${a}-${l}`),R==="accounts"&&d.jsx(yP,{},`${a}-${l}`),R==="spend"&&d.jsx(eP,{},`${a}-${l}`)]})}function vP(){const{setPageTitle:t}=Zt();return A.useLayoutEffect(()=>{t("Analytics")},[t]),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[d.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),d.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),d.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),d.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),d.jsx(wt,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:ce.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})}function Bh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,accountGroups:a,showGroupSelector:l=!1,showIncomeSettings:c=!1,hasExistingIncomeDefault:h=!1,hasExistingOutgoDefault:m=!1,currentGroupId:g}){const[_,v]=A.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),b=_.account_group_id||g,w=b?a.find(z=>z.id===b):null,C=w?.is_active!==void 0,T=w?.on_budget!==void 0;function j(z){z.preventDefault(),_.nickname.trim()&&e(_)}function B(z){v({..._,is_income_account:z,is_income_default:z?_.is_income_default:!1})}function H(z){v({..._,is_outgo_account:z,is_outgo_default:z?_.is_outgo_default:!1})}return d.jsxs(qa,{actionName:i==="Create Account"?"Create Account":"Update Account",onSubmit:j,children:[d.jsx(Wt,{label:"Account Nickname",htmlFor:"account-nickname",children:d.jsx(Ha,{id:"account-nickname",type:"text",value:_.nickname,onChange:z=>v({..._,nickname:z.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&d.jsx(Wt,{label:"Account Type",htmlFor:"account-group",children:d.jsxs(iu,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:z=>v({..._,account_group_id:z.target.value==="ungrouped"?null:z.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Ungrouped"}),a.map(z=>d.jsx("option",{value:z.id,children:z.name},z.id))]})}),c&&d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(Os,{id:"is-active",checked:C?w.is_active:_.is_active!==!1,onChange:z=>v({..._,is_active:z.target.checked}),disabled:C,children:d.jsx("span",{style:{opacity:C?.5:1},children:"Active account"})}),C&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ce.warning},children:['Set by account type "',w.name,'"']})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(Os,{id:"on-budget",checked:T?w.on_budget:_.on_budget!==!1,onChange:z=>v({..._,on_budget:z.target.checked}),disabled:T,children:d.jsx("span",{style:{opacity:T?.5:1},children:"On budget (affects budget totals)"})}),T&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ce.warning},children:['Set by account type "',w.name,'"']})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),d.jsx(Os,{id:"is-income-account",checked:_.is_income_account||!1,onChange:z=>B(z.target.checked),children:"Show in income deposit list"}),_.is_income_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(Os,{id:"is-income-default",checked:_.is_income_default||!1,onChange:z=>v({..._,is_income_default:z.target.checked}),disabled:h&&!t?.is_income_default,children:"Default account for new income"}),h&&!t?.is_income_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),d.jsx(Os,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:z=>H(z.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(Os,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:z=>v({..._,is_outgo_default:z.target.checked}),disabled:m&&!t?.is_outgo_default,children:"Default account for new expenses"}),m&&!t?.is_outgo_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),d.jsxs(Xa,{children:[d.jsx(Me,{type:"submit",actionName:i,children:i}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Account Form",onClick:n,children:"Cancel"})]})]})}function qE({label:t,value:e,onChange:n,trueLabel:i,falseLabel:a,undefinedLabel:l}){function c(){n(e===void 0?!0:e===!0?!1:void 0)}const h=e===!0?i:e===!1?a:l,m=e===!0?ce.success:e===!1?ce.warning:"inherit",g=e===!0?"":e===!1?"":"";return d.jsxs("button",{type:"button",onClick:c,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${m} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${m} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[d.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?m:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:g}),d.jsxs("span",{style:{flex:1},children:[d.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",d.jsx("span",{style:{fontWeight:500,color:m},children:h})]}),d.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function AT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=A.useState(t||{name:"",expected_balance:"positive"});function c(h){h.preventDefault(),a.name.trim()&&e(a)}return d.jsxs(qa,{actionName:i==="Create Account Type"?"Create Account Type":"Update Account Type",onSubmit:c,children:[d.jsx(Wt,{label:"Account Type Name",htmlFor:"group-name",children:d.jsx(Ha,{id:"group-name",type:"text",value:a.name,onChange:h=>l({...a,name:h.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),d.jsx(Wt,{label:"Expected Balance",htmlFor:"expected-balance",children:d.jsxs(iu,{id:"expected-balance",value:a.expected_balance,onChange:h=>l({...a,expected_balance:h.target.value}),children:[d.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),d.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),d.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",d.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),d.jsx(qE,{label:"Active status",value:a.is_active,onChange:h=>l({...a,is_active:h}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),d.jsx(qE,{label:"Budget status",value:a.on_budget,onChange:h=>l({...a,on_budget:h}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),d.jsxs(Xa,{children:[d.jsx(Me,{type:"submit",actionName:i,children:i}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Account Type Form",onClick:n,children:"Cancel"})]})]})}function Ho({icon:t,label:e,variant:n,title:i}){const l={success:{background:`color-mix(in srgb, ${ce.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.success} 40%, transparent)`,color:ce.success,opacity:1},warning:{background:`color-mix(in srgb, ${ce.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.warning} 35%, transparent)`,color:ce.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${ce.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.success} 25%, transparent)`,color:ce.success,opacity:.7},expense:{background:`color-mix(in srgb, ${ce.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.warning} 25%, transparent)`,color:ce.warning,opacity:.7}}[n];return d.jsxs("span",{title:i||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[d.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function CT({account:t,accountGroups:e}){const n=[],i=t.account_group_id?e.find(c=>c.id===t.account_group_id):null,a=i?.is_active!==void 0?i.is_active:t.is_active!==!1,l=i?.on_budget!==void 0?i.on_budget:t.on_budget!==!1;if(!a){const c=i?.is_active!==void 0;n.push(d.jsx(Ho,{icon:"",label:c?"Inactive (type)":"Inactive",variant:"warning",title:c?`Set by "${i.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const c=i?.on_budget!==void 0;n.push(d.jsx(Ho,{icon:"",label:c?"Off Budget (type)":"Off Budget",variant:"warning",title:c?`Set by "${i.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(d.jsx(Ho,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(d.jsx(Ho,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(d.jsx(Ho,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(d.jsx(Ho,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:d.jsx(d.Fragment,{children:n})}function bP({group:t}){const e=[];return t.is_active===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.warning} 20%, transparent)`,color:ce.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.success} 20%, transparent)`,color:ce.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.warning} 20%, transparent)`,color:ce.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.success} 20%, transparent)`,color:ce.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:d.jsx(d.Fragment,{children:e})}function RT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function xP(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function EP(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function SP({group:t,groupIndex:e,totalGroups:n,accounts:i,allGroups:a,allAccounts:l,editingAccountId:c,editingGroupId:h,createForGroupId:m,setEditingAccountId:g,setEditingGroupId:_,setCreateForGroupId:v,dragType:b,draggedId:w,dragOverId:C,dragOverGroupId:T,setDragOverId:j,setDragOverGroupId:B,onAccountDragStart:H,onAccountDragOver:z,onAccountDrop:J,onGroupDragStart:$,onGroupDragOver:re,onGroupDrop:P,onDragLeave:R,onDragLeaveGroup:D,onDragEnd:N,onDropOnGroup:M,onCreateAccount:k,onUpdateAccount:I,onDeleteAccount:ae,onMoveAccount:q,onUpdateGroup:L,onDeleteGroup:Q,onMoveGroup:K}){const oe=na(),ue=[...i].sort((Z,De)=>Z.sort_order-De.sort_order),U=b==="group"&&w===t.id,F=b==="group"&&C===t.id,W=b==="account"&&T===t.id,ee=(w&&b==="account"?l[w]:null)&&Object.entries(l).find(([Z])=>Z===w)?.[1]&&Object.entries(l).find(([Z])=>Z===w)?.[1]?.account_group_id!==t.id,ge=b==="group"&&F&&w!==t.id,me=e>0,Ee=e<n-1,fe=ue.reduce((Z,De)=>Z+De.balance,0);return d.jsxs("div",{children:[b==="group"&&!U&&d.jsxs("div",{onDragOver:Z=>{Z.preventDefault(),j(t.id)},onDragLeave:R,onDrop:Z=>P(Z,t.id),style:{position:"relative",height:ge?"2.5rem":"0.5rem",marginBottom:ge?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:ge?1:0,transition:"opacity 0.15s",boxShadow:ge?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),ge&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{draggable:h!==t.id,onDragStart:Z=>$(Z,t.id),onDragOver:Z=>re(Z,t.id),onDragLeave:D,onDragEnd:N,onDrop:Z=>M(Z,t.id),style:{background:U?"color-mix(in srgb, currentColor 3%, transparent)":W&&ee?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:U?.5:1,border:W&&ee?`2px dashed ${ce.primary}`:"2px solid transparent",cursor:h===t.id?"default":"grab",transition:"all 0.15s"},children:h===t.id?d.jsx(AT,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:Z=>L(t.id,Z),onCancel:()=>_(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsx(wP,{group:t,accountCount:ue.length,groupTotal:fe,canMoveUp:me,canMoveDown:Ee,isMobile:oe,createForGroupId:m,onEdit:()=>_(t.id),onDelete:()=>Q(t.id),onMoveUp:()=>K(t.id,"up"),onMoveDown:()=>K(t.id,"down"),onAddAccount:()=>v(t.id)}),oe&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Me,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:()=>v(t.id),disabled:m!==null,children:"+ Account"})}),d.jsxs("div",{style:fl,children:[ue.map((Z,De)=>c===Z.id?d.jsx(Bh,{initialData:{nickname:Z.nickname,account_group_id:Z.account_group_id,is_income_account:Z.is_income_account,is_income_default:Z.is_income_default,is_outgo_account:Z.is_outgo_account,is_outgo_default:Z.is_outgo_default,on_budget:Z.on_budget,is_active:Z.is_active},onSubmit:Pe=>I(Z.id,Pe),onCancel:()=>g(null),submitLabel:"Save",accountGroups:a,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:Z.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([Pe,gt])=>gt.is_income_default&&Pe!==Z.id),hasExistingOutgoDefault:Object.entries(l).some(([Pe,gt])=>gt.is_outgo_default&&Pe!==Z.id)},Z.id):d.jsx(vf,{isDragging:b==="account"&&w===Z.id,isDragOver:C===Z.id,onDragStart:Pe=>{Pe.stopPropagation(),H(Pe,Z.id)},onDragOver:Pe=>z(Pe,Z.id,t.id),onDragLeave:R,onDragEnd:N,onDrop:Pe=>J(Pe,Z.id,t.id),onEdit:()=>{Z.nickname,g(Z.id)},onDelete:()=>{Z.nickname,ae(Z.id)},onMoveUp:()=>q(Z.id,"up"),onMoveDown:()=>q(Z.id,"down"),canMoveUp:De>0,canMoveDown:De<ue.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:By,children:Z.nickname}),d.jsx(CT,{account:Z,accountGroups:a})]}),d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:It(Z.balance)},children:[Se(Z.balance),xP(Z.balance,t.expected_balance)&&d.jsx("span",{title:EP(Z.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},Z.id)),ue.length===0&&!m&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),b==="account"&&ue.length>0&&d.jsx(RT,{groupId:t.id,isActive:C===`__end__${t.id}`,onDragOver:Z=>{Z.preventDefault(),Z.stopPropagation(),j(`__end__${t.id}`),B(t.id)},onDragLeave:Z=>{Z.stopPropagation(),j(null)},onDrop:Z=>{Z.stopPropagation(),J(Z,"__group_end__",t.id)}}),m===t.id&&d.jsx(Bh,{initialData:{nickname:"",account_group_id:t.id},onSubmit:Z=>k(Z,t.id),onCancel:()=>v(null),submitLabel:"Create",accountGroups:a,showIncomeSettings:!0,currentGroupId:t.id})]}),m!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Me,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:()=>v(t.id),disabled:m!==null,children:"+ Add Account"})})]})})]})}function wP({group:t,accountCount:e,groupTotal:n,canMoveUp:i,canMoveDown:a,isMobile:l,createForGroupId:c,onEdit:h,onDelete:m,onMoveUp:g,onMoveDown:_,onAddAccount:v}){return d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{..._f,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&d.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:It(n),flexShrink:0},children:Se(n)}),d.jsx(bP,{group:t})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&d.jsx(Me,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:v,disabled:c!==null,children:"+ Account"}),d.jsx("button",{onClick:()=>{t.name,h()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),d.jsx("button",{onClick:()=>{t.name,m()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),d.jsxs("div",{style:Uy,children:[d.jsx("button",{onClick:g,disabled:!i,style:{...hl,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:_,disabled:!a,style:{...hl,opacity:a?.6:.2,cursor:a?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function TP({accounts:t,allGroups:e,allAccounts:n,hasGroups:i,editingAccountId:a,createForGroupId:l,setEditingAccountId:c,setCreateForGroupId:h,dragType:m,draggedId:g,dragOverId:_,dragOverGroupId:v,setDragOverId:b,setDragOverGroupId:w,onAccountDragStart:C,onAccountDragOver:T,onAccountDrop:j,onDragOverGroup:B,onDropOnGroup:H,onDragLeave:z,onDragLeaveGroup:J,onDragEnd:$,onCreateAccount:re,onUpdateAccount:P,onDeleteAccount:R,onMoveAccount:D}){const N=[...t].sort((q,L)=>q.sort_order-L.sort_order),M=m==="account"&&v==="ungrouped",I=(g&&m==="account"?n[g]:null)&&Object.entries(n).find(([q])=>q===g)?.[1]&&Object.entries(n).find(([q])=>q===g)?.[1]?.account_group_id!==null;if(N.length===0&&!l&&i&&m!=="account")return null;const ae=N.reduce((q,L)=>q+L.balance,0);return d.jsxs("div",{onDragOver:q=>B(q,"ungrouped"),onDragLeave:J,onDrop:q=>H(q,"ungrouped"),style:{background:M&&I?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:M&&I?`2px dashed ${ce.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{..._f,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",N.length,")"]}),N.length>0&&d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:It(ae)},children:Se(ae)})]}),d.jsx(Me,{variant:"small",actionName:"Open Add Account Form (Ungrouped)",onClick:()=>h("ungrouped"),disabled:l!==null,children:"+ Account"})]}),d.jsxs("div",{style:fl,children:[N.map((q,L)=>a===q.id?d.jsx(Bh,{initialData:{nickname:q.nickname,account_group_id:q.account_group_id,is_income_account:q.is_income_account,is_income_default:q.is_income_default,is_outgo_account:q.is_outgo_account,is_outgo_default:q.is_outgo_default,on_budget:q.on_budget,is_active:q.is_active},onSubmit:Q=>P(q.id,Q),onCancel:()=>c(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([Q,K])=>K.is_income_default&&Q!==q.id),hasExistingOutgoDefault:Object.entries(n).some(([Q,K])=>K.is_outgo_default&&Q!==q.id)},q.id):d.jsx(vf,{isDragging:m==="account"&&g===q.id,isDragOver:_===q.id,onDragStart:Q=>C(Q,q.id),onDragOver:Q=>T(Q,q.id,"ungrouped"),onDragLeave:z,onDragEnd:$,onDrop:Q=>j(Q,q.id,"ungrouped"),onEdit:()=>{q.nickname,c(q.id)},onDelete:()=>{q.nickname,R(q.id)},onMoveUp:()=>D(q.id,"up"),onMoveDown:()=>D(q.id,"down"),canMoveUp:L>0,canMoveDown:L<N.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:By,children:q.nickname}),d.jsx(CT,{account:q,accountGroups:e})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:It(q.balance)},children:Se(q.balance)})]})},q.id)),N.length===0&&m==="account"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),m==="account"&&N.length>0&&d.jsx(RT,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:q=>{q.preventDefault(),q.stopPropagation(),b("__end__ungrouped"),w("ungrouped")},onDragLeave:q=>{q.stopPropagation(),b(null)},onDrop:q=>{q.stopPropagation(),j(q,"__group_end__","ungrouped")}}),l==="ungrouped"&&d.jsx(Bh,{initialData:{nickname:"",account_group_id:null},onSubmit:q=>re(q,"ungrouped"),onCancel:()=>h(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Me,{variant:"small",actionName:"Open Add Account Form (Ungrouped)",onClick:()=>h("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function AP(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:i,error:a,setError:l,handleCreateAccount:c,handleUpdateAccount:h,handleDeleteAccount:m,handleMoveAccount:g,handleCreateGroup:_,handleUpdateGroup:v,handleDeleteGroup:b,handleMoveGroup:w,reorderAccountsInGroup:C,reorderGroups:T}=w6(),j=na(),[B,H]=A.useState(null),[z,J]=A.useState(null),[$,re]=A.useState(null),[P,R]=A.useState(!1),[D,N]=A.useState(null),[M,k]=A.useState(null),[I,ae]=A.useState(null),[q,L]=A.useState(null);function Q(fe,Z){N("account"),k(Z),fe.dataTransfer.effectAllowed="move"}function K(fe,Z,De){fe.preventDefault(),D==="account"&&(Z!==M&&ae(Z),L(De))}function oe(fe,Z){fe.preventDefault(),D==="account"?(L(Z),ae(null)):D==="group"&&Z!==M&&ae(Z)}function ue(){ae(null)}function U(){L(null)}function F(){N(null),k(null),ae(null),L(null)}async function W(fe,Z,De){if(fe.preventDefault(),fe.stopPropagation(),!M||D!=="account"){F();return}await C(M,Z,De),F()}async function X(fe,Z){fe.preventDefault(),D==="account"?await W(fe,"__group_end__",Z):D==="group"&&await ge(fe,Z)}function ee(fe,Z){fe.stopPropagation(),N("group"),k(Z),fe.dataTransfer.effectAllowed="move"}async function ge(fe,Z){if(fe.preventDefault(),!M||D!=="group"||M===Z){F();return}await T(M,Z),F()}const me=A.useMemo(()=>{const fe=Object.values(t),Z=fe.reduce((gt,Qe)=>gt+(Qe.balance??0),0);let De=0,Pe=0;for(const gt of fe){const Qe=n.find(ir=>ir.id===gt.account_group_id);gt.on_budget===!0||gt.on_budget===void 0&&Qe?.on_budget!==!1?De+=gt.balance??0:Pe+=gt.balance??0}return{count:fe.length,groupCount:n.length,totalBalance:Z,onBudgetTotal:De,offBudgetTotal:Pe}},[t,n]);if(!i)return d.jsx("p",{children:"No budget found. Please log in."});const Ee=e.ungrouped||[];return d.jsxs("div",{children:[a&&d.jsx(Ya,{message:a,onDismiss:()=>l(null)}),d.jsx("div",{style:{position:"sticky",top:0,zIndex:50,backgroundColor:"#242424",marginLeft:"calc(-1 * var(--page-padding, 2rem))",marginRight:"calc(-1 * var(--page-padding, 2rem))",paddingLeft:"var(--page-padding, 2rem)",paddingRight:"var(--page-padding, 2rem)",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"1px solid rgba(255,255,255,0.15)"},children:d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[d.jsx("span",{style:{fontWeight:600},children:"Accounts:"}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"On-Budget: "}),d.jsx("span",{style:{color:It(me.onBudgetTotal),fontWeight:600},children:Se(me.onBudgetTotal)})]}),me.offBudgetTotal!==0&&d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Off-Budget: "}),d.jsx("span",{style:{fontWeight:600,opacity:.7},children:Se(me.offBudgetTotal)})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Total: "}),d.jsx("span",{style:{color:It(me.totalBalance),fontWeight:600},children:Se(me.totalBalance)})]}),d.jsx("span",{style:{opacity:.5,fontSize:"0.8rem"},children:j?"Drag to move.":"Drag between types or use  to reorder."})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:d.jsx(Qy,{})})]})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem",paddingTop:"1rem"},children:[Object.keys(t).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((fe,Z)=>d.jsx(SP,{group:fe,groupIndex:Z,totalGroups:n.length,accounts:e[fe.id]||[],allGroups:n,allAccounts:t,editingAccountId:B,editingGroupId:$,createForGroupId:z,setEditingAccountId:H,setEditingGroupId:re,setCreateForGroupId:J,dragType:D,draggedId:M,dragOverId:I,dragOverGroupId:q,setDragOverId:ae,setDragOverGroupId:L,onAccountDragStart:Q,onAccountDragOver:K,onAccountDrop:W,onGroupDragStart:ee,onGroupDragOver:oe,onGroupDrop:ge,onDragLeave:ue,onDragLeaveGroup:U,onDragEnd:F,onDropOnGroup:X,onCreateAccount:c,onUpdateAccount:(De,Pe)=>{h(De,Pe),H(null)},onDeleteAccount:m,onMoveAccount:g,onUpdateGroup:(De,Pe)=>{v(De,Pe),re(null)},onDeleteGroup:b,onMoveGroup:w},fe.id)),D==="group"&&n.length>0&&d.jsx(qy,{isActive:I==="__end__",onDragOver:fe=>{fe.preventDefault(),ae("__end__")},onDragLeave:ue,onDrop:fe=>ge(fe,"__end__"),label:"Move account type to end"}),d.jsx(TP,{accounts:Ee,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:B,createForGroupId:z,setEditingAccountId:H,setCreateForGroupId:J,dragType:D,draggedId:M,dragOverId:I,dragOverGroupId:q,setDragOverId:ae,setDragOverGroupId:L,onAccountDragStart:Q,onAccountDragOver:K,onAccountDrop:W,onDragOverGroup:oe,onDropOnGroup:X,onDragLeave:ue,onDragLeaveGroup:U,onDragEnd:F,onCreateAccount:c,onUpdateAccount:(fe,Z)=>{h(fe,Z),H(null)},onDeleteAccount:m,onMoveAccount:g})]}),P?d.jsx(AT,{onSubmit:fe=>{_(fe),R(!1)},onCancel:()=>R(!1),submitLabel:"Create Account Type"}):d.jsx(Me,{variant:"primary-large",actionName:"Open Add Account Type Form",onClick:()=>R(!0),children:"+ Add Account Type"})]})}function Fh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,categoryGroups:a=[],showGroupSelector:l=!1}){const[c,h]=A.useState(t||{name:"",category_group_id:null}),[m,g]=A.useState(t?.default_monthly_amount?.toString()||""),[_,v]=A.useState(t?.default_monthly_type||"fixed"),[b,w]=A.useState(!1);function C(T){if(T.preventDefault(),!c.name.trim())return;w(!0);const j=parseFloat(m),B=!isNaN(j)&&j>0;e({...c,description:c.description?.trim()||void 0,default_monthly_amount:B?j:void 0,default_monthly_type:B?_:void 0})}return d.jsxs(qa,{actionName:i==="Create"?"Create Category":"Update Category",onSubmit:C,children:[d.jsx(Wt,{label:"Category Name",htmlFor:"category-name",children:d.jsx(Ha,{id:"category-name",type:"text",value:c.name,onChange:T=>h({...c,name:T.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),d.jsx(Wt,{label:"Description (optional)",htmlFor:"category-description",children:d.jsx(Fy,{id:"category-description",value:c.description||"",onChange:T=>h({...c,description:T.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&d.jsx(Wt,{label:"Category Group",htmlFor:"category-group",children:d.jsxs(iu,{id:"category-group",value:c.category_group_id||"ungrouped",onChange:T=>h({...c,category_group_id:T.target.value==="ungrouped"?null:T.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Uncategorized"}),a.map(T=>d.jsx("option",{value:T.id,children:T.name},T.id))]})}),d.jsxs(Wt,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[d.jsxs(iu,{id:"default-type",value:_,onChange:T=>v(T.target.value),style:{width:"auto",flex:"0 0 auto"},children:[d.jsx("option",{value:"fixed",children:"Fixed $"}),d.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?d.jsx(Rg,{id:"default-amount",value:m,onChange:g,placeholder:"$0.00"}):d.jsx(Ha,{id:"default-amount",type:"number",value:m,onChange:T=>g(T.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&d.jsx("span",{style:{opacity:.6},children:"%"})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),d.jsxs(Xa,{children:[d.jsx(Me,{type:"submit",actionName:i==="Create"?"Create Category":"Save Category",isLoading:b,children:i}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Category Form",onClick:n,children:"Cancel"})]})]})}function DT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=A.useState(t||{name:""}),[c,h]=A.useState(!1);function m(g){g.preventDefault(),a.name.trim()&&(h(!0),e(a))}return d.jsxs(qa,{actionName:i==="Create Group"?"Create Category Group":"Update Category Group",onSubmit:m,children:[d.jsx(Wt,{label:"Group Name",htmlFor:"group-name",children:d.jsx(Ha,{id:"group-name",type:"text",value:a.name,onChange:g=>l({...a,name:g.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),d.jsxs(Xa,{children:[d.jsx(Me,{type:"submit",actionName:i==="Create Group"?"Create Category Group":"Save Category Group",isLoading:c,children:i}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Category Group Form",onClick:n,children:"Cancel"})]})]})}function IT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function CP({group:t,groupIndex:e,groupCategories:n,sortedGroups:i,categoryGroups:a,categoryBalances:l,loadingBalances:c,dragType:h,draggedId:m,dragOverId:g,dragOverGroupId:_,editingCategoryId:v,setEditingCategoryId:b,createForGroupId:w,setCreateForGroupId:C,editingGroupId:T,setEditingGroupId:j,handleCreateCategory:B,handleUpdateCategory:H,handleDeleteCategory:z,handleMoveCategory:J,handleUpdateGroup:$,handleDeleteGroup:re,handleMoveGroup:P,handleCategoryDragStart:R,handleCategoryDragOver:D,handleDragOverGroup:N,handleDragLeave:M,handleDragLeaveGroup:k,handleDragEnd:I,handleCategoryDrop:ae,handleDropOnGroup:q,handleGroupDragStart:L,handleGroupDrop:Q,setDragOverId:K,setDragOverGroupId:oe,isMobile:ue,categories:U}){const F=h==="group"&&m===t.id,W=h==="group"&&g===t.id,X=h==="category"&&_===t.id,ee=m&&h==="category"?U[m]:null,ge=ee&&(ee.category_group_id||"ungrouped")!==t.id,me=h==="group"&&W&&m!==t.id,Ee=e>0,fe=e<i.length-1;return d.jsxs("div",{children:[h==="group"&&!F&&d.jsxs("div",{onDragOver:Z=>{Z.preventDefault(),K(t.id)},onDragLeave:M,onDrop:Z=>Q(Z,t.id),style:{position:"relative",height:me?"2.5rem":"0.5rem",marginBottom:me?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:me?1:0,transition:"opacity 0.15s",boxShadow:me?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),me&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{onDragOver:Z=>N(Z,t.id),onDragLeave:k,onDrop:Z=>q(Z,t.id),style:{background:F?"color-mix(in srgb, currentColor 3%, transparent)":X&&ge?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:F?.5:1,border:X&&ge?`2px dashed ${ce.primary}`:"2px solid transparent",transition:"all 0.15s"},children:T===t.id?d.jsx(DT,{initialData:{name:t.name},onSubmit:Z=>$(t.id,Z),onCancel:()=>j(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:ue?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:ue?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{..._f,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!ue&&d.jsx("span",{draggable:!0,onDragStart:Z=>L(Z,t.id),onDragEnd:I,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",n.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!ue&&d.jsx(Me,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>C(t.id),disabled:w!==null,children:"+ Category"}),d.jsx("button",{onClick:()=>{t.name,j(t.id)},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),d.jsx("button",{onClick:()=>{t.name,re(t.id)},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),d.jsxs("div",{style:Uy,children:[d.jsx("button",{onClick:()=>P(t.id,"up"),disabled:!Ee,style:{...hl,opacity:Ee?.6:.2,cursor:Ee?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),d.jsx("button",{onClick:()=>P(t.id,"down"),disabled:!fe,style:{...hl,opacity:fe?.6:.2,cursor:fe?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),ue&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Me,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>C(t.id),disabled:w!==null,children:"+ Category"})}),d.jsxs("div",{style:fl,children:[n.map(([Z,De])=>v===Z?d.jsx(Fh,{initialData:{name:De.name,description:De.description,category_group_id:De.category_group_id,default_monthly_amount:De.default_monthly_amount,default_monthly_type:De.default_monthly_type},onSubmit:Pe=>H(Z,Pe),onCancel:()=>b(null),submitLabel:"Save",categoryGroups:a,showGroupSelector:!0},Z):d.jsx(vf,{isDragging:h==="category"&&m===Z,isDragOver:g===Z,onDragStart:Pe=>{Pe.stopPropagation(),R(Pe,Z)},onDragOver:Pe=>D(Pe,Z,t.id),onDragLeave:M,onDragEnd:I,onDrop:Pe=>ae(Pe,Z,t.id),onEdit:()=>{De.name,b(Z)},onDelete:()=>{De.name,z(Z)},onMoveUp:()=>J(Z,"up"),onMoveDown:()=>J(Z,"down"),canMoveUp:n.findIndex(([Pe])=>Pe===Z)>0,canMoveDown:n.findIndex(([Pe])=>Pe===Z)<n.length-1,children:d.jsx(jT,{category:De,catId:Z,categoryBalances:l,loadingBalances:c})},Z)),n.length===0&&!w&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),h==="category"&&n.length>0&&d.jsx(IT,{groupId:t.id,isActive:g===`__end__${t.id}`,onDragOver:Z=>{Z.preventDefault(),Z.stopPropagation(),K(`__end__${t.id}`),oe(t.id)},onDragLeave:Z=>{Z.stopPropagation(),K(null)},onDrop:Z=>{Z.stopPropagation(),ae(Z,"__group_end__",t.id)}}),w===t.id&&d.jsx(Fh,{initialData:{name:"",category_group_id:t.id},onSubmit:Z=>B(Z,t.id),onCancel:()=>C(null),submitLabel:"Create",categoryGroups:a})]}),w!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Me,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>C(t.id),disabled:w!==null,children:"+ Add Category"})})]})})]})}function jT({category:t,catId:e,categoryBalances:n,loadingBalances:i}){const a=n[e]||{current:0,total:0};return d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[d.jsx("span",{style:By,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?d.jsxs(d.Fragment,{children:[d.jsxs("span",{style:{color:ce.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{style:{color:ce.success,fontWeight:500},children:Se(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),d.jsxs("div",{style:{marginTop:"0.25rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:In(a.current)},children:[i?"...":Se(a.current),d.jsx("span",{style:{fontSize:"0.75rem",fontWeight:400,opacity:.6,marginLeft:"0.35rem"},children:"available now"})]}),d.jsxs("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.85rem",fontWeight:500,color:In(a.total),opacity:.75},children:[i?"...":Se(a.total),d.jsx("span",{style:{fontSize:"0.7rem",fontWeight:400,opacity:.7,marginLeft:"0.35rem"},children:"total allocated"})]})]})]})}function RP({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:i,dragType:a,draggedId:l,dragOverId:c,dragOverGroupId:h,editingCategoryId:m,setEditingCategoryId:g,createForGroupId:_,setCreateForGroupId:v,handleCreateCategory:b,handleUpdateCategory:w,handleDeleteCategory:C,handleMoveCategory:T,handleCategoryDragStart:j,handleCategoryDragOver:B,handleDragOverGroup:H,handleDragLeaveGroup:z,handleDragLeave:J,handleDragEnd:$,handleCategoryDrop:re,handleDropOnGroup:P,setDragOverId:R,setDragOverGroupId:D,categories:N,hasGroups:M}){const k=a==="category"&&h==="ungrouped",I=l&&a==="category"?N[l]:null,ae=I&&I.category_group_id!==null;return t.length===0&&!_&&M&&a!=="category"?null:d.jsxs("div",{onDragOver:q=>H(q,"ungrouped"),onDragLeave:z,onDrop:q=>P(q,"ungrouped"),style:{background:k&&ae?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:k&&ae?`2px dashed ${ce.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{..._f,margin:0,opacity:.7},children:["Uncategorized",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),d.jsx(Me,{variant:"small",actionName:"Open Add Category Form (Uncategorized)",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Category"})]}),d.jsxs("div",{style:fl,children:[t.map(([q,L])=>m===q?d.jsx(Fh,{initialData:{name:L.name,description:L.description,category_group_id:L.category_group_id,default_monthly_amount:L.default_monthly_amount,default_monthly_type:L.default_monthly_type},onSubmit:Q=>w(q,Q),onCancel:()=>g(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},q):d.jsx(vf,{isDragging:a==="category"&&l===q,isDragOver:c===q,onDragStart:Q=>j(Q,q),onDragOver:Q=>B(Q,q,"ungrouped"),onDragLeave:J,onDragEnd:$,onDrop:Q=>re(Q,q,"ungrouped"),onEdit:()=>{L.name,g(q)},onDelete:()=>{L.name,C(q)},onMoveUp:()=>T(q,"up"),onMoveDown:()=>T(q,"down"),canMoveUp:t.findIndex(([Q])=>Q===q)>0,canMoveDown:t.findIndex(([Q])=>Q===q)<t.length-1,children:d.jsx(jT,{category:L,catId:q,categoryBalances:n,loadingBalances:i})},q)),t.length===0&&a==="category"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),a==="category"&&t.length>0&&d.jsx(IT,{groupId:"ungrouped",isActive:c==="__end__ungrouped",onDragOver:q=>{q.preventDefault(),q.stopPropagation(),R("__end__ungrouped"),D("ungrouped")},onDragLeave:q=>{q.stopPropagation(),R(null)},onDrop:q=>{q.stopPropagation(),re(q,"__group_end__","ungrouped")}}),_==="ungrouped"&&d.jsx(Fh,{initialData:{name:"",category_group_id:null},onSubmit:q=>b(q,"ungrouped"),onCancel:()=>v(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Me,{variant:"small",actionName:"Open Add Category Form (Uncategorized)",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function DP(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:i,sortedGroups:a,categoryBalances:l,isLoading:c,loadingBalances:h,error:m,setError:g,getOnBudgetTotal:_,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:w,handleMoveCategory:C,handleCreateGroup:T,handleUpdateGroup:j,handleDeleteGroup:B,handleMoveGroup:H,dragType:z,draggedId:J,dragOverId:$,dragOverGroupId:re,setDragOverId:P,setDragOverGroupId:R,handleCategoryDragStart:D,handleCategoryDragOver:N,handleDragOverGroup:M,handleDragLeave:k,handleDragLeaveGroup:I,handleDragEnd:ae,handleCategoryDrop:q,handleDropOnGroup:L,handleGroupDragStart:Q,handleGroupDrop:K}=R6(),oe=na(),{addLoadingHold:ue,removeLoadingHold:U}=jn();A.useEffect(()=>(c?ue("categories","Loading categories..."):U("categories"),()=>U("categories")),[c,ue,U]);const[F,W]=A.useState(null),[X,ee]=A.useState(null),[ge,me]=A.useState(null),[Ee,fe]=A.useState(!1);if(!t)return d.jsx("p",{children:"No budget found. Please log in."});const Z=Object.values(l).reduce((Qe,dn)=>Qe+dn.current,0),De=Object.values(l).reduce((Qe,dn)=>Qe+dn.total,0),Pe=_()-Z,gt=Math.abs(De-Z)>.01;return c?null:d.jsxs("div",{children:[m&&d.jsx(Ya,{message:m,onDismiss:()=>g(null)}),d.jsx("div",{style:{position:"sticky",top:0,zIndex:50,backgroundColor:"#242424",marginLeft:"calc(-1 * var(--page-padding, 2rem))",marginRight:"calc(-1 * var(--page-padding, 2rem))",paddingLeft:"var(--page-padding, 2rem)",paddingRight:"var(--page-padding, 2rem)",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"1px solid rgba(255,255,255,0.15)"},children:d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem"},children:[d.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[d.jsx("span",{style:{fontWeight:600},children:"Categories:"}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"On-Budget: "}),d.jsx("span",{style:{color:It(_()),fontWeight:600},children:Se(_())})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Allocated: "}),d.jsx("span",{style:{color:ce.primary,fontWeight:600},children:h?"...":Se(Z)}),gt&&d.jsxs("span",{style:{opacity:.5,fontSize:"0.8rem"},children:[" (",Se(De)," total)"]})]}),d.jsxs("span",{children:[d.jsx("span",{style:{opacity:.6},children:"Available: "}),d.jsx("span",{style:{color:It(Pe),fontWeight:600},children:h?"...":Se(Pe)})]}),d.jsx("span",{style:{opacity:.6},children:oe?"Drag to move between groups.":"Drag categories between groups, or use  to reorder."})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:d.jsx(Qy,{})})]})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem",paddingTop:"1rem"},children:[Object.keys(e).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),a.map((Qe,dn)=>{const ir=(i[Qe.id]||[]).sort((yi,Xi)=>yi[1].sort_order-Xi[1].sort_order);return d.jsx(CP,{group:Qe,groupIndex:dn,groupCategories:ir,sortedGroups:a,categoryGroups:n,categoryBalances:l,loadingBalances:h,dragType:z,draggedId:J,dragOverId:$,dragOverGroupId:re,editingCategoryId:F,setEditingCategoryId:W,createForGroupId:X,setCreateForGroupId:ee,editingGroupId:ge,setEditingGroupId:me,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:w,handleMoveCategory:C,handleUpdateGroup:j,handleDeleteGroup:B,handleMoveGroup:H,handleCategoryDragStart:D,handleCategoryDragOver:N,handleDragOverGroup:M,handleDragLeave:k,handleDragLeaveGroup:I,handleDragEnd:ae,handleCategoryDrop:q,handleDropOnGroup:L,handleGroupDragStart:Q,handleGroupDrop:K,setDragOverId:P,setDragOverGroupId:R,isMobile:oe,categories:e},Qe.id)}),z==="group"&&a.length>0&&d.jsx(qy,{isActive:$==="__end__",onDragOver:Qe=>{Qe.preventDefault(),P("__end__")},onDragLeave:k,onDrop:Qe=>K(Qe,"__end__"),label:"Move group to end"}),d.jsx(RP,{ungroupedCategories:(i.ungrouped||[]).sort((Qe,dn)=>Qe[1].sort_order-dn[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:h,dragType:z,draggedId:J,dragOverId:$,dragOverGroupId:re,editingCategoryId:F,setEditingCategoryId:W,createForGroupId:X,setCreateForGroupId:ee,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:w,handleMoveCategory:C,handleCategoryDragStart:D,handleCategoryDragOver:N,handleDragOverGroup:M,handleDragLeaveGroup:I,handleDragLeave:k,handleDragEnd:ae,handleCategoryDrop:q,handleDropOnGroup:L,setDragOverId:P,setDragOverGroupId:R,categories:e,hasGroups:n.length>0})]}),Ee?d.jsx(DT,{onSubmit:Qe=>{T(Qe),fe(!1)},onCancel:()=>fe(!1),submitLabel:"Create Group"}):d.jsx(Me,{variant:"primary-large",actionName:"Open Add Category Group Form",onClick:()=>fe(!0),children:"+ Add Category Group"})]})}const IP=["accounts","categories","users"];function jP(){const{addLoadingHold:t,removeLoadingHold:e}=jn(),{selectedBudgetId:n,currentUserId:i,lastSettingsTab:a,setLastSettingsTab:l,setPageTitle:c}=Zt();A.useLayoutEffect(()=>{c("Budget Settings")},[c]);const{isOwner:h,isLoading:m}=On(n,i);A.useEffect(()=>(m?t("settings","Loading settings..."):e("settings"),()=>e("settings")),[m,t,e]);const g=An(),_=g.pathname==="/budget/settings",v=A.useMemo(()=>{const j=g.pathname;return j.includes("/settings/accounts")?"accounts":j.includes("/settings/categories")?"categories":j.includes("/settings/users")?"users":"categories"},[g.pathname]),b=v==="users";A.useEffect(()=>{_||l(v)},[v,_,l]);function w(){return!IP.includes(a)||a==="users"&&!h?"categories":a}const C=A.useMemo(()=>[{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!h}],[h]);return m?null:!h&&b?d.jsxs("div",{children:[d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only the budget owner can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(wt,{to:"/budget/settings/categories",style:{color:"#646cff"},children:"Go to Categories "})})]}):d.jsxs("div",{children:[d.jsx(Hy,{mode:"link",linkPrefix:"/budget/settings",tabs:C,activeTab:_?w():v}),_?d.jsx(Hh,{to:`/budget/settings/${w()}`,replace:!0}):d.jsx(fT,{children:d.jsx(Gh,{})})]})}function OP(){const{selectedBudgetId:t,currentUserId:e}=Zt(),{budget:n,budgetUserIds:i,acceptedUserIds:a,inviteUser:l,revokeUser:c}=On(t,e),[h,m]=A.useState(""),[g,_]=A.useState(!1),[v,b]=A.useState(null),[w,C]=A.useState(null);if(!n)return d.jsx("p",{children:"No budget found."});async function T(z){if(z.preventDefault(),!(!h.trim()||!n)){_(!0),b(null),C(null);try{await l(h.trim()),m(""),C("Invite sent! The user can now accept the invitation from their account.")}catch(J){b(J instanceof Error?J.message:"Failed to invite user")}finally{_(!1)}}}async function j(z){if(!n)return;if(z===n.owner_id){b("Cannot revoke the budget owner");return}if(z===e){b("Cannot revoke yourself from the budget");return}const J=a.includes(z);if(confirm(J?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){b(null),C(null);try{await c(z),C(J?"User access revoked.":"Invitation cancelled.")}catch(re){b(re instanceof Error?re.message:"Failed to revoke user")}}}const B=i.filter(z=>a.includes(z)),H=i.filter(z=>!a.includes(z));return d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),w&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:w}),d.jsx("button",{onClick:()=>C(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",B.length,")"]}),B.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:B.map(z=>{const J=z===n.owner_id,$=z===e;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:z}),J&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),$&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!J&&!$&&d.jsx("button",{onClick:()=>j(z),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},z)})})]}),H.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",H.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:H.map(z=>d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:z}),d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),d.jsx("button",{onClick:()=>j(z),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},z))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),d.jsxs("form",{onSubmit:T,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:h,onChange:z=>m(z.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:g||!h.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||!h.trim()?"not-allowed":"pointer",fontWeight:500,opacity:g||!h.trim()?.7:1,whiteSpace:"nowrap"},children:g?"Inviting...":"Send Invite"})]}),d.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),d.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}const MP=["budget","feedback","migration","tests"];function kP(){const{isAdmin:t,isTest:e,lastAdminTab:n,setLastAdminTab:i,setPageTitle:a}=Zt();A.useLayoutEffect(()=>{a("Budget Admin")},[a]);const l=An(),c=l.pathname==="/budget/admin",h=A.useMemo(()=>{const v=l.pathname;return v.includes("/admin/budget")?"budget":v.includes("/admin/feedback")?"feedback":v.includes("/admin/migration")?"migration":v.includes("/admin/tests")?"tests":"budget"},[l.pathname]),m=h==="tests";A.useEffect(()=>{c||i(h)},[h,c,i]);function g(){return!MP.includes(n)||n==="tests"&&!e?"budget":n}const _=A.useMemo(()=>[{id:"budget",label:"Budget",icon:""},{id:"feedback",label:"Feedback",icon:""},{id:"migration",label:"Migration",icon:""},{id:"tests",label:"Tests",icon:"",hidden:!e}],[e]);return t?!e&&m?d.jsxs("div",{children:[d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only test users can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(wt,{to:"/budget/admin/budget",style:{color:"#646cff"},children:"Go to Admin "})})]}):d.jsxs("div",{children:[d.jsx(Hy,{mode:"link",linkPrefix:"/budget/admin",tabs:_,activeTab:h}),c?d.jsx(Hh,{to:`/budget/admin/${g()}`,replace:!0}):d.jsx(Gh,{})]}):d.jsxs("div",{children:[d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only administrators can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(wt,{to:"/budget",style:{color:"#646cff"},children:"Go to Budget "})})]})}function NP(){const{addLoadingHold:t,removeLoadingHold:e}=jn(),{selectedBudgetId:n,currentUserId:i,isAdmin:a}=Zt(),{budget:l,accounts:c,accountGroups:h,categories:m,categoryGroups:g,isOwner:_,isLoading:v}=On(n,i);return A.useEffect(()=>(v?t("settings-budget","Loading budget info..."):e("settings-budget"),()=>e("settings-budget")),[v,t,e]),v?null:l?d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Summary"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Information about the currently selected budget."}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",fontSize:"0.95rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Name:"}),d.jsx("strong",{children:l.name})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"ID:"}),d.jsx("code",{style:{background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:l.id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Owner:"}),d.jsx("strong",{children:l.owner_email||l.owner_id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Users:"}),d.jsxs("span",{children:[l.user_ids.length," user",l.user_ids.length!==1?"s":"",d.jsxs("span",{style:{opacity:.7},children:["  ",_?"You are the owner":"Shared with you"]})]})]})]})}),a&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem"},children:"Admin Tools"}),d.jsx("button",{onClick:()=>{const b={...l,accounts:c,account_groups:h,categories:m,category_groups:g,_meta:{downloaded_at:new Date().toISOString()}},w=new Blob([JSON.stringify(b,null,2)],{type:"application/json"}),C=URL.createObjectURL(w),T=document.createElement("a");T.href=C,T.download=`budget_${l.id}.json`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(C)},style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",transition:"background 0.15s"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]})]}):d.jsx("p",{style:{opacity:.7},children:"No budget selected."})}function HE({budget:t,isCurrent:e,isAccepting:n,isSwitching:i,isEditing:a,editName:l,isRenaming:c,onAccept:h,onSwitch:m,onStartEdit:g,onCancelEdit:_,onEditNameChange:v,onSaveEdit:b}){const w=e&&t.isOwner;return d.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:a?d.jsxs("form",{onSubmit:b,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:d.jsx("input",{type:"text",value:l,onChange:C=>v(C.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[d.jsx("button",{type:"submit",disabled:c||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:c||!l.trim()?.7:1,fontSize:"0.8rem"},children:c?"Saving...":"Save"}),d.jsx("button",{type:"button",onClick:_,disabled:c,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c?"not-allowed":"pointer",fontWeight:500,opacity:c?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[d.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),w&&d.jsx("button",{onClick:g,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),d.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?d.jsx("button",{onClick:h,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:d.jsx("button",{onClick:m,disabled:i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,fontSize:"0.85rem"},children:i?"Switching...":"Switch"})})]})})}const jg={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function OT({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,i=n&&n in jg?n:"bug",a=jg[i];return d.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:a.bgColor,color:a.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:a.label})}function PP({item:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:h,onToggleDone:m,onTypeClick:g}){return d.jsxs("div",{onDragOver:_=>{_.stopPropagation(),a(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),h(_)},style:{position:"relative"},children:[d.jsx("div",{style:{...uT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:c,style:{...Eu,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{...cT},children:""}),d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:m,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ce.primary,flexShrink:0}}),d.jsx(OT,{type:t.feedback_type,onClick:g})]}),d.jsxs("div",{style:{marginLeft:"3.25rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",Dg(t.created_at)]})]})]})]})}function LP({item:t,onToggleDone:e,onTypeClick:n}){return d.jsxs("div",{style:{...Eu,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ce.primary,flexShrink:0}}),d.jsx(OT,{type:t.feedback_type,onClick:n})]}),d.jsxs("div",{style:{marginLeft:"2rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",Dg(t.created_at)]}),t.completed_at&&d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:ce.success},children:[" Completed: ",Dg(t.completed_at)]})]})]})}function $y({noMargin:t}={}){return d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:t?0:"0.5rem",verticalAlign:"middle"}})}function Ky({title:t,description:e,status:n,statusText:i,onRefresh:a,isRefreshing:l,isBusy:c=!1,children:h,cardName:m}){const _=(()=>{switch(n){case"unknown":return{color:"#9ca3af",text:i??"Unknown"};case"clean":case"complete":return{color:"#22c55e",text:i??" Clean"};case"needs-action":return{color:"#f59e0b",text:i??"Action Needed"}}})(),v=l||c;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:t}),d.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.9rem"},children:e})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexShrink:0},children:[n!=="unknown"&&d.jsx("span",{style:{color:_.color,fontWeight:600,fontSize:"0.9rem"},children:_.text}),d.jsxs("button",{onClick:()=>{a()},disabled:v,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem 0.65rem",borderRadius:"6px",cursor:v?"not-allowed":"pointer",fontWeight:500,fontSize:"0.85rem",opacity:v?.6:1,display:"flex",alignItems:"center",gap:"0.3rem"},title:"Refresh status",children:[l?d.jsx($y,{noMargin:!0}):""," Refresh"]})]})]}),h]})}const VP={unknown:{bg:"rgba(100, 100, 100, 0.1)",border:"rgba(100, 100, 100, 0.3)",color:"#9ca3af"},clean:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"},warning:{bg:"rgba(245, 158, 11, 0.1)",border:"rgba(245, 158, 11, 0.3)",color:"#fbbf24"},running:{bg:"rgba(100, 108, 255, 0.1)",border:"rgba(100, 108, 255, 0.3)",color:"#a5b4fc"},success:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"}};function Dn({type:t,children:e}){const n=VP[t];return d.jsx("div",{style:{background:n.bg,border:`1px solid ${n.border}`,color:n.color,padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:e})}function Wy({onClick:t,disabled:e,isBusy:n,busyText:i,children:a,actionName:l}){const c=e||n;return d.jsx("button",{onClick:()=>{t()},disabled:c,style:{marginTop:"1rem",background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:c?"not-allowed":"pointer",fontWeight:500,opacity:c?.7:1,display:"flex",alignItems:"center",gap:"0.4rem"},children:n?d.jsxs(d.Fragment,{children:[d.jsx($y,{noMargin:!0})," ",i??"Running..."]}):a})}function zP({hasData:t,status:e,hasIssues:n,totalIssues:i,isRunning:a,result:l,onRunCleanup:c,onRefresh:h,isRefreshing:m,disabled:g}){const _=()=>t?l&&l.errors.length===0&&(l.accountsFixed>0||l.categoriesFixed>0||l.groupsFixed>0||l.monthMapsAdded>0||l.futureMonthsDeleted>0||l.monthsFixed>0||l.oldRecalcFieldsRemoved>0)?"complete":n?"needs-action":"clean":"unknown",v=l?l.accountsFixed+l.categoriesFixed+l.groupsFixed+l.monthMapsAdded+l.futureMonthsDeleted+l.monthsFixed+l.oldRecalcFieldsRemoved:0;return d.jsx(Ky,{title:" Database Cleanup",description:"Validates and fixes all budget and month documents to match the expected schema. Converts legacy formats, adds missing default values, and removes invalid future months.",status:_(),onRefresh:h,isRefreshing:m,isBusy:a,children:a?d.jsx(Dn,{type:"running",children:"Running database cleanup..."}):l?d.jsx(Dn,{type:l.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[l.errors.length>0?"":""," Cleanup complete",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.9rem"},children:[l.budgetsProcessed>0&&d.jsxs("li",{children:[l.budgetsProcessed," budget",l.budgetsProcessed!==1?"s":""," updated"]}),l.arraysConverted>0&&d.jsxs("li",{children:[l.arraysConverted," array",l.arraysConverted!==1?"s":""," converted to maps"]}),l.accountsFixed>0&&d.jsxs("li",{children:[l.accountsFixed," account",l.accountsFixed!==1?"s":""," fixed"]}),l.categoriesFixed>0&&d.jsxs("li",{children:[l.categoriesFixed," categor",l.categoriesFixed!==1?"ies":"y"," fixed"]}),l.groupsFixed>0&&d.jsxs("li",{children:[l.groupsFixed," group",l.groupsFixed!==1?"s":""," fixed"]}),l.monthMapsAdded>0&&d.jsxs("li",{children:[l.monthMapsAdded," budget",l.monthMapsAdded!==1?"s":""," got month_map added"]}),l.futureMonthsDeleted>0&&d.jsxs("li",{children:[l.futureMonthsDeleted," future month",l.futureMonthsDeleted!==1?"s":""," deleted"]}),l.monthsFixed>0&&d.jsxs("li",{children:[l.monthsFixed," month",l.monthsFixed!==1?"s":""," schema fixed"]}),l.oldRecalcFieldsRemoved>0&&d.jsxs("li",{children:[l.oldRecalcFieldsRemoved," month",l.oldRecalcFieldsRemoved!==1?"s":""," had old recalc field removed"]}),v===0&&d.jsx("li",{children:"No changes needed"})]}),l.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0.75rem 0 0.25rem 0",fontWeight:500,color:"#ef4444"},children:"Errors:"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.85rem",color:"#ef4444"},children:[l.errors.slice(0,5).map((b,w)=>d.jsx("li",{children:b},w)),l.errors.length>5&&d.jsxs("li",{style:{opacity:.7},children:["...and ",l.errors.length-5," more errors"]})]})]})]})}):t?n?d.jsxs(d.Fragment,{children:[d.jsx(Dn,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",i," issue",i!==1?"s":""," to fix:"]}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[e.budgetsWithArrays>0&&d.jsxs("li",{children:[e.budgetsWithArrays," budget",e.budgetsWithArrays!==1?"s":""," using legacy array format"]}),e.accountsNeedingDefaults>0&&d.jsxs("li",{children:[e.accountsNeedingDefaults," account",e.accountsNeedingDefaults!==1?"s":""," missing default values"]}),e.categoriesNeedingDefaults>0&&d.jsxs("li",{children:[e.categoriesNeedingDefaults," categor",e.categoriesNeedingDefaults!==1?"ies":"y"," missing default values"]}),e.groupsNeedingDefaults>0&&d.jsxs("li",{children:[e.groupsNeedingDefaults," account group",e.groupsNeedingDefaults!==1?"s":""," missing default values"]}),e.budgetsNeedingMonthMap>0&&d.jsxs("li",{children:[e.budgetsNeedingMonthMap," budget",e.budgetsNeedingMonthMap!==1?"s":""," missing month_map"]}),e.futureMonthsToDelete.length>0&&d.jsxs("li",{children:[e.futureMonthsToDelete.length," future month",e.futureMonthsToDelete.length!==1?"s":""," to delete",d.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.85rem",opacity:.8},children:[e.futureMonthsToDelete.slice(0,3).map(b=>d.jsxs("li",{children:[nl[b.month-1]," ",b.year]},b.docId)),e.futureMonthsToDelete.length>3&&d.jsxs("li",{style:{opacity:.7},children:["...and ",e.futureMonthsToDelete.length-3," more"]})]})]}),e.monthsWithSchemaIssues>0&&d.jsxs("li",{children:[e.monthsWithSchemaIssues," month",e.monthsWithSchemaIssues!==1?"s":""," with schema issues"]}),e.monthsWithOldRecalcField>0&&d.jsxs("li",{children:[e.monthsWithOldRecalcField," month",e.monthsWithOldRecalcField!==1?"s":""," with deprecated is_needs_recalculation field"]})]}),d.jsxs("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["Scanned ",e.totalBudgets," budgets and ",e.totalMonths," months."]})]})}),d.jsxs(Wy,{onClick:c,disabled:g,isBusy:a,busyText:"Running...",actionName:"Run Database Cleanup",children:[" Fix ",i," Issue",i!==1?"s":""]})]}):d.jsx(Dn,{type:"clean",children:d.jsxs("div",{children:[" Database is clean",d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["All ",e.totalBudgets," budgets and ",e.totalMonths," months match expected schema."]})]})}):d.jsx(Dn,{type:"unknown",children:" Status unknown  click Refresh to scan the database"})})}function UP({hasData:t,status:e,isMigrating:n,onMigrate:i,onRefresh:a,isRefreshing:l,disabled:c,migrationResult:h}){const m=e&&(e.sanitizedDocuments.length>0||e.corruptedDocuments.length>0),g=h&&(h.deletedDocuments>0||h.fixedDocuments>0),_=()=>t?g?"complete":m?"needs-action":"clean":"unknown";return d.jsx(Ky,{title:" Consolidate Feedback Documents",description:"Fixes corrupted feedback data and merges documents with sanitized IDs into proper email format.",status:_(),onRefresh:a,isRefreshing:l,isBusy:n,children:n?d.jsx(Dn,{type:"running",children:"Migrating feedback documents..."}):t?g?d.jsx(Dn,{type:"success",children:d.jsxs("div",{children:[" Migration complete:",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[h.fixedDocuments>0&&d.jsxs("li",{children:["Fixed ",h.fixedDocuments," corrupted document(s)"]}),h.deletedDocuments>0&&d.jsxs("li",{children:["Merged & deleted ",h.deletedDocuments," sanitized document(s)"]}),h.mergedItems>0&&d.jsxs("li",{children:["Merged ",h.mergedItems," feedback item(s)"]})]}),h.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{marginTop:"0.5rem"},children:" Errors:"}),d.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:h.errors.map((v,b)=>d.jsx("li",{children:v},b))})]})]})}):m?d.jsxs(d.Fragment,{children:[d.jsx(Dn,{type:"warning",children:d.jsxs("div",{children:[e?.corruptedDocuments&&e.corruptedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.corruptedDocuments.length," corrupted document(s):"]}),d.jsx("ul",{style:{margin:"0 0 0.75rem 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.corruptedDocuments.map(v=>d.jsxs("li",{children:[v," ",d.jsx("span",{style:{opacity:.6},children:"(broken arrayUnion)"})]},v))})]}),e?.sanitizedDocuments&&e.sanitizedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.sanitizedDocuments.length," sanitized document(s) to merge:"]}),d.jsx("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.sanitizedDocuments.map(v=>d.jsx("li",{children:v},v))})]})]})}),d.jsx(Wy,{onClick:i,disabled:c,isBusy:n,busyText:"Migrating...",actionName:"Run Feedback Migration",children:"Run Migration"})]}):d.jsxs(Dn,{type:"clean",children:[" No issues found. All feedback documents are healthy.",d.jsxs("span",{style:{display:"block",fontSize:"0.85rem",opacity:.7,marginTop:"0.25rem"},children:["Found ",e?.documentsFound??0," document(s) total."]})]}):d.jsx(Dn,{type:"unknown",children:" Status unknown  click Refresh to scan for issues"})})}function BP({hasData:t,monthsCount:e,budgetCount:n,monthsToDelete:i,isDeleting:a,onDelete:l,onRefresh:c,isRefreshing:h,disabled:m,deleteResult:g}){const _=()=>t?g&&g.deleted>0&&g.errors.length===0?"complete":e===0?"clean":"needs-action":"unknown",v=i.reduce((b,w)=>{const C=w.budgetId;return b[C]||(b[C]=[]),b[C].push(w),b},{});return d.jsx(Ky,{title:" Delete ALL Months",description:"DESTRUCTIVE: Deletes ALL month documents from Firebase for ALL budgets. This will reset all income, expenses, and allocations. Use with extreme caution!",status:_(),onRefresh:c,isRefreshing:h,isBusy:a,children:a?d.jsx(Dn,{type:"running",children:"Deleting all months..."}):g?d.jsx(Dn,{type:g.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[g.errors.length>0?"":""," Deleted ",g.deleted," month",g.deleted!==1?"s":"",g.errors.length>0&&d.jsx("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem"},children:g.errors.map((b,w)=>d.jsx("li",{children:b},w))})]})}):t?e>0?d.jsxs(d.Fragment,{children:[d.jsx(Dn,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",d.jsx("strong",{children:e})," month",e!==1?"s":""," across ",d.jsx("strong",{children:n})," budget",n!==1?"s":"",":"]}),d.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto"},children:[Object.entries(v).slice(0,5).map(([b,w])=>d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[d.jsxs("div",{style:{fontWeight:500,fontSize:"0.85rem"},children:["Budget: ",b.slice(0,12),"..."]}),d.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.85rem"},children:[w.slice(0,3).map(C=>d.jsxs("li",{children:[nl[C.month-1]," ",C.year]},C.docId)),w.length>3&&d.jsxs("li",{style:{opacity:.7},children:["...and ",w.length-3," more"]})]})]},b)),Object.keys(v).length>5&&d.jsxs("div",{style:{opacity:.7,fontSize:"0.85rem",marginTop:"0.5rem"},children:["...and ",Object.keys(v).length-5," more budgets"]})]})]})}),d.jsxs(Wy,{onClick:l,disabled:m,isBusy:a,busyText:"Deleting...",actionName:"Delete All Months",children:[" Delete ALL ",e," Month",e!==1?"s":""]}),d.jsx("p",{style:{fontSize:"0.8rem",color:"#ef4444",marginTop:"0.5rem",fontWeight:500},children:" This action cannot be undone!"})]}):d.jsx(Dn,{type:"clean",children:" No month documents found in Firebase."}):d.jsx(Dn,{type:"unknown",children:" Status unknown  click Refresh to scan for months"})})}function FP(){try{localStorage.removeItem("BUDGET_APP_QUERY_CACHE"),console.log("[Cache] Cleared React Query cache from localStorage")}catch(t){console.warn("Failed to clear localStorage cache:",t)}window.location.reload()}function qP(){const e=Ka().get_current_firebase_user(),[n,i]=A.useState(!1),a=L6({currentUser:e}),l=z6({currentUser:e}),c=U6({currentUser:e,onComplete:()=>i(!0)}),h=a.isScanning||l.isScanning||c.isScanning,m=a.isRunning||l.isMigratingFeedback||c.isDeleting,g=async()=>{await Promise.all([a.scanStatus(),l.scanStatus(),c.scanStatus()])};return d.jsxs("div",{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[d.jsx("h2",{style:{margin:0},children:"Data Migrations"}),d.jsxs("button",{onClick:g,disabled:h||m,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:h||m?"not-allowed":"pointer",fontWeight:500,opacity:h||m?.7:1,display:"flex",alignItems:"center",gap:"0.4rem",minWidth:"130px",minHeight:"36px"},children:[d.jsx("span",{style:{width:"18px",height:"18px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:h?d.jsx($y,{noMargin:!0}):""}),"Refresh All"]})]}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:'Run migrations to validate and fix your database. Click "Refresh All" to scan Firestore directly.'}),d.jsx(zP,{hasData:!!a.status,status:a.status,hasIssues:a.hasIssues,totalIssues:a.totalIssues,isRunning:a.isRunning,result:a.result,onRunCleanup:a.runCleanup,onRefresh:a.scanStatus,isRefreshing:a.isScanning,disabled:!e}),d.jsx(UP,{hasData:!!l.status,status:l.status,isMigrating:l.isMigratingFeedback,onMigrate:l.migrateFeedbackDocuments,onRefresh:l.scanStatus,isRefreshing:l.isScanning,disabled:!e,migrationResult:l.feedbackMigrationResult}),d.jsx(BP,{hasData:!!c.status,monthsCount:c.status?.monthsCount??0,budgetCount:c.status?.budgetCount??0,monthsToDelete:c.status?.monthsToDelete??[],isDeleting:c.isDeleting,onDelete:c.deleteAllMonths,onRefresh:c.scanStatus,isRefreshing:c.isScanning,disabled:!e,deleteResult:c.deleteResult}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:d.jsxs("p",{style:{margin:0,opacity:.7},children:[d.jsx("strong",{children:"Note:"})," These migrations will process ",d.jsx("strong",{children:"all budgets and months"})," in the system, not just the ones you own or are invited to."]})}),d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, #ff6b6b 10%, transparent)",borderRadius:"8px",border:"1px solid color-mix(in srgb, #ff6b6b 30%, transparent)"},children:[d.jsxs("p",{style:{margin:"0 0 0.75rem 0",fontSize:"0.9rem"},children:[d.jsx("strong",{children:" Clear All Caches"}),d.jsx("span",{style:{opacity:.7,display:"block",marginTop:"0.25rem"},children:"If you're seeing stale data after running migrations, clear all cached data and reload to fetch fresh data from Firestore."})]}),d.jsx(Me,{variant:"danger",actionName:"Open Clear Caches Modal",onClick:()=>i(!0),style:{display:"flex",alignItems:"center",gap:"0.4rem"},children:" Clear All Caches & Reload"})]}),d.jsxs(ml,{isOpen:n,onClose:()=>i(!1),title:"Clear Caches & Reload?",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.8},children:"This will clear all cached data from localStorage and reload the page. The app will fetch fresh data from Firestore for everything."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Me,{variant:"secondary",actionName:"Cancel Clear Caches",onClick:()=>i(!1),children:"Cancel"}),d.jsx(Me,{variant:"danger",actionName:"Confirm Clear Caches & Reload",onClick:FP,children:"Clear & Reload"})]})]})]})}function HP(){const[t,e]=A.useState(null),[n,i]=A.useState(null),[a,l]=A.useState(null),[c,h]=A.useState(!1),[m,g]=A.useState(""),[_,v]=A.useState("bug"),[b,w]=A.useState(null),[C,T]=A.useState(null),j=A.useContext(ou),H=Ka().get_current_firebase_user(),z=fk(),{submitFeedback:J}=hT(),{toggleFeedback:$}=r6(),{updateSortOrder:re}=i6(),P=z.data?.items||[],{addLoadingHold:R,removeLoadingHold:D}=jn();A.useEffect(()=>(z.isLoading?R("settings-feedback","Loading feedback..."):D("settings-feedback"),()=>D("settings-feedback")),[z.isLoading,R,D]);function N(F){F.preventDefault(),!(!m.trim()||!j.username||!H)&&(J.mutate({userId:H.uid,userEmail:j.username,text:m.trim(),feedbackType:_,currentPath:"/settings/feedback"}),g(""),v("bug"),h(!1))}function M(F){F.is_done?k(F):w(F)}async function k(F){try{await $.mutateAsync({item:F})}catch(W){e(W instanceof Error?W.message:"Failed to update feedback")}}function I(){b&&(k(b),w(null))}async function ae(F){if(C){try{const X=P.filter(ee=>ee.doc_id===C.doc_id).map(ee=>ee.id===C.id?{id:ee.id,text:ee.text,created_at:ee.created_at,is_done:ee.is_done,completed_at:ee.completed_at,sort_order:ee.sort_order,feedback_type:F}:{id:ee.id,text:ee.text,created_at:ee.created_at,is_done:ee.is_done,completed_at:ee.completed_at,sort_order:ee.sort_order,feedback_type:ee.feedback_type});await re.mutateAsync({docId:C.doc_id,items:X})}catch(W){e(W instanceof Error?W.message:"Failed to update feedback type")}T(null)}}const q=P.filter(F=>!F.is_done).sort((F,W)=>F.sort_order-W.sort_order),L=P.filter(F=>F.is_done).sort((F,W)=>{const X=F.completed_at?new Date(F.completed_at).getTime():0;return(W.completed_at?new Date(W.completed_at).getTime():0)-X});function Q(F,W){i(W),F.dataTransfer.effectAllowed="move"}function K(F,W){F.preventDefault(),W!==n&&l(W)}function oe(){l(null)}function ue(){i(null),l(null)}async function U(F,W){if(F.preventDefault(),!n||n===W){ue();return}const X=q.findIndex(fe=>fe.id===n),ee=[...q],[ge]=ee.splice(X,1);if(W==="__end__")ee.push(ge);else{const fe=ee.findIndex(Z=>Z.id===W);ee.splice(fe,0,ge)}const me=ee.map((fe,Z)=>({...fe,sort_order:Z}));ue();const Ee=new Map;for(const fe of me)Ee.has(fe.doc_id)||Ee.set(fe.doc_id,[]),Ee.get(fe.doc_id).push({id:fe.id,text:fe.text,created_at:fe.created_at,is_done:fe.is_done,completed_at:fe.completed_at,sort_order:fe.sort_order,feedback_type:fe.feedback_type});for(const fe of L)Ee.has(fe.doc_id)||Ee.set(fe.doc_id,[]),Ee.get(fe.doc_id).push({id:fe.id,text:fe.text,created_at:fe.created_at,is_done:fe.is_done,completed_at:fe.completed_at,sort_order:fe.sort_order,feedback_type:fe.feedback_type});try{for(const[fe,Z]of Ee)await re.mutateAsync({docId:fe,items:Z})}catch(fe){e(fe instanceof Error?fe.message:"Failed to save order")}}return z.isLoading?null:d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Feedback"}),d.jsx("p",{style:{...dT,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&d.jsx(Ya,{message:t,onDismiss:()=>e(null)}),d.jsxs("div",{style:fl,children:[q.length===0&&!c&&d.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),q.map(F=>d.jsx(PP,{item:F,isDragging:n===F.id,isDragOver:a===F.id,onDragStart:W=>Q(W,F.id),onDragOver:W=>K(W,F.id),onDragLeave:oe,onDragEnd:ue,onDrop:W=>U(W,F.id),onToggleDone:()=>M(F),onTypeClick:()=>T(F)},F.id)),n&&q.length>0&&d.jsx(qy,{isActive:a==="__end__",onDragOver:F=>K(F,"__end__"),onDragLeave:oe,onDrop:F=>U(F,"__end__")})]}),c?d.jsxs(qa,{actionName:"Add Feedback",onSubmit:N,children:[d.jsx(GE,{selectedType:_,onSelect:v}),d.jsx(Fy,{value:m,onChange:F=>g(F.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),d.jsxs(Xa,{children:[d.jsx(Me,{type:"submit",actionName:"Add Feedback",disabled:!m.trim(),children:"Add Feedback"}),d.jsx(Me,{type:"button",variant:"secondary",actionName:"Cancel Add Feedback",onClick:()=>{h(!1),g(""),v("bug")},children:"Cancel"})]})]}):d.jsx(Me,{variant:"primary-large",actionName:"Open Add Feedback Form",onClick:()=>h(!0),children:"+ Add Feedback"}),L.length>0&&d.jsx(l6,{title:"Completed",count:L.length,children:d.jsx("div",{style:{...fl,marginTop:"0.5rem"},children:L.map(F=>d.jsx(LP,{item:F,onToggleDone:()=>M(F),onTypeClick:()=>T(F)},F.id))})}),d.jsxs(ml,{isOpen:b!==null,onClose:()=>w(null),title:"Mark as Complete",children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),b&&d.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',b.text,'"']}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Me,{variant:"secondary",actionName:"Cancel Mark Complete",onClick:()=>w(null),children:"Cancel"}),d.jsx(Me,{variant:"primary",actionName:"Confirm Mark Complete",onClick:I,children:"Mark Complete"})]})]}),d.jsxs(ml,{isOpen:C!==null,onClose:()=>T(null),title:"Change Feedback Type",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),d.jsx(GE,{selectedType:C?.feedback_type||"bug",onSelect:ae}),d.jsx(Me,{variant:"secondary",actionName:"Cancel Change Feedback Type",onClick:()=>T(null),style:{width:"100%"},children:"Cancel"})]})]})}function GE({selectedType:t,onSelect:e}){return d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const i=jg[n],a=t==="feature"?"new_feature":t,l=a===n||!a&&n==="bug";return d.jsxs("button",{type:"button",onClick:()=>{i.label,e(n)},style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${i.color}`,borderRadius:"0.5rem",background:l?i.bgColor:"transparent",color:l?i.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${i.bgColor}`:"none",position:"relative"},children:[i.label,l&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function GP(){const{currentUserId:t}=Zt(),[e,n]=A.useState([]),[i,a]=A.useState(!1);function l(b,w){n(C=>C.map(T=>T.name===b?{...T,...w}:T))}async function c(){a(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await h("Read unauthorized budget",async()=>(await Le("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0),await h("Read another user's document",async()=>(await Le("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0),await h("Read unauthorized budget month",async()=>(await Le("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0),await h("Toggle is_admin in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Le("users",t,"security test: reading own user to get current is_admin value"),C=w?.permission_flags?.is_admin??!1;return await Na("users",t,{"permission_flags.is_admin":!C},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${C} to ${!C} (SECURITY ISSUE!)`},!0),await h("Toggle is_test in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Le("users",t,"security test: reading own user to get current is_test value"),C=w?.permission_flags?.is_test??!1;return await Na("users",t,{"permission_flags.is_test":!C},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${C} to ${!C} (SECURITY ISSUE!)`},!0),await h("Read own user document",async()=>{if(!t)throw new Error("Not authenticated");const{exists:w}=await Le("users",t,"security test: reading own user document (should succeed)");if(w)return"Successfully read own document";throw new Error("Document does not exist")},!1),a(!1)}async function h(b,w,C){l(b,{status:"running",message:"Running..."});try{const T=await w();C?l(b,{status:"failed",message:` ${T}`}):l(b,{status:"passed",message:` ${T}`})}catch(T){const j=T instanceof Error?T.message:"Unknown error";C?l(b,{status:"passed",message:` Blocked as expected: ${j}`}):l(b,{status:"failed",message:` ${j}`})}}async function m(b){switch(e.find(C=>C.name===b)||n(C=>[...C,{name:b,status:"pending",message:"",expectedToFail:!0}]),a(!0),b){case"Read unauthorized budget":await h(b,async()=>(await Le("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0);break;case"Read another user's document":await h(b,async()=>(await Le("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0);break;case"Read unauthorized budget month":await h(b,async()=>(await Le("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0);break;case"Toggle is_admin in own permission_flags":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:C}=await Le("users",t,"security test: reading own user to get current is_admin value"),T=C?.permission_flags?.is_admin??!1;return await Na("users",t,{"permission_flags.is_admin":!T},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${T} to ${!T} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:C}=await Le("users",t,"security test: reading own user to get current is_test value"),T=C?.permission_flags?.is_test??!1;return await Na("users",t,{"permission_flags.is_test":!T},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${T} to ${!T} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{exists:C}=await Le("users",t,"security test: reading own user document (should succeed)");if(C)return"Successfully read own document";throw new Error("Document does not exist")},!1);break}a(!1)}const g=e.filter(b=>b.status==="passed").length,_=e.filter(b=>b.status==="failed").length,v=e.length;return d.jsxs("div",{children:[d.jsx("p",{style:dT,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsx(Me,{onClick:c,disabled:i,variant:"primary",children:i?"Running Tests...":"Run All Tests"})}),e.length>0&&d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[d.jsxs("span",{children:["Total: ",d.jsx("strong",{children:v})]}),d.jsxs("span",{style:{color:ce.success},children:["Passed: ",d.jsx("strong",{children:g})]}),d.jsxs("span",{style:{color:ce.danger},children:["Failed: ",d.jsx("strong",{children:_})]})]})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),d.jsx(Go,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read unauthorized budget"),onRun:()=>m("Read unauthorized budget"),disabled:i}),d.jsx(Go,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read another user's document"),onRun:()=>m("Read another user's document"),disabled:i}),d.jsx(Go,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(b=>b.name==="Read unauthorized budget month"),onRun:()=>m("Read unauthorized budget month"),disabled:i}),d.jsx(Go,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_admin in own permission_flags"),onRun:()=>m("Toggle is_admin in own permission_flags"),disabled:i}),d.jsx(Go,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_test in own permission_flags"),onRun:()=>m("Toggle is_test in own permission_flags"),disabled:i}),d.jsx(Go,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(b=>b.name==="Read own user document"),onRun:()=>m("Read own user document"),disabled:i,expectedToSucceed:!0})]}),_>0&&d.jsxs(Ya,{style:{marginTop:"1.5rem"},children:[" ",_," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function Go({name:t,description:e,expectedBehavior:n,result:i,onRun:a,disabled:l,expectedToSucceed:c}){const h=i?.status==="passed"?ce.success:i?.status==="failed"?ce.danger:i?.status==="running"?ce.warning:"inherit";return d.jsxs("div",{style:{...Eu,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),d.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),d.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:c?ce.success:ce.warning},children:["Expected: ",n]})]}),d.jsx(Me,{onClick:a,disabled:l,variant:"secondary",style:{flexShrink:0},children:i?.status==="running"?"":"Run"})]}),i&&i.status!=="pending"&&d.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${h} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${h} 30%, transparent)`,fontSize:"0.85rem",color:h},children:i.message})]})}function QP(){const{addLoadingHold:t,removeLoadingHold:e}=jn(),{selectedBudgetId:n,currentUserId:i,accessibleBudgets:a,loadAccessibleBudgets:l,switchToBudget:c,checkBudgetInvite:h,isInitialized:m,setPageTitle:g}=Zt();A.useLayoutEffect(()=>{g("My Budgets")},[g]),A.useEffect(()=>{m&&l()},[m,l]);const{budget:_,renameBudget:v,acceptInvite:b,isLoading:w}=On(n,i),[C,T]=A.useState(null),[j,B]=A.useState(null),[H,z]=A.useState(null),[J,$]=A.useState(null),[re,P]=A.useState(null),[R,D]=A.useState(""),[N,M]=A.useState(!1),[k,I]=A.useState(""),[ae,q]=A.useState(!1),[L,Q]=A.useState(null);async function K(me){if(me!==_?.id){T(me),z(null),$(null);try{await c(me),$("Switched to budget successfully!"),await l()}catch(Ee){z(Ee instanceof Error?Ee.message:"Failed to switch budget")}finally{T(null)}}}async function oe(me){B(me),z(null),$(null);try{await b(me),$("Invitation accepted! You now have access to this budget."),await l()}catch(Ee){z(Ee instanceof Error?Ee.message:"Failed to accept invitation")}finally{B(null)}}async function ue(me){if(me.preventDefault(),!!k.trim()){q(!0),z(null),Q(null);try{const Ee=await h(k.trim());Ee?Q(Ee):z("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(Ee){z(Ee instanceof Error?Ee.message:"Failed to check invitation")}finally{q(!1)}}}async function U(){if(L){L.budgetName,B(L.budgetId),z(null);try{await b(L.budgetId),$(`Successfully joined "${L.budgetName}"!`),Q(null),I(""),await l()}catch(me){z(me instanceof Error?me.message:"Failed to accept invitation")}finally{B(null)}}}function F(me,Ee){D(Ee),P(me)}function W(){P(null),D("")}async function X(me){if(me.preventDefault(),!(!R.trim()||!re)){R.trim(),M(!0),z(null),$(null);try{await v(R.trim()),$("Budget renamed successfully!"),P(null),await l()}catch(Ee){z(Ee instanceof Error?Ee.message:"Failed to rename budget")}finally{M(!1)}}}const ee=a.filter(me=>!me.isPending),ge=a.filter(me=>me.isPending);return A.useEffect(()=>(w||!m?t("my-budgets","Loading your budgets..."):e("my-budgets"),()=>e("my-budgets")),[w,m,t,e]),w||!m?null:d.jsxs("div",{children:[d.jsx("h1",{children:"My Budgets"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Switch between budgets, accept invitations, or join a budget by ID."}),H&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:H}),d.jsx("button",{onClick:()=>z(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),J&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:J}),d.jsx("button",{onClick:()=>$(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),ge.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Pending Invitations (",ge.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:ge.map(me=>d.jsx(HE,{budget:me,isCurrent:!1,isAccepting:j===me.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>oe(me.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},me.id))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Your Budgets (",ee.length,")"]}),ee.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:ee.map(me=>{const Ee=me.id===_?.id,fe=re===me.id;return d.jsx(HE,{budget:me,isCurrent:Ee,isAccepting:!1,isSwitching:C===me.id,isEditing:fe,editName:fe?R:"",isRenaming:N,onAccept:()=>{},onSwitch:()=>K(me.id),onStartEdit:()=>F(me.id,me.name),onCancelEdit:W,onEditNameChange:D,onSaveEdit:X},me.id)})})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Join Budget by ID"]}),d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),L?d.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[d.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:L.budgetName}),L.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",L.ownerEmail]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{onClick:U,disabled:j===L.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:j===L.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:j===L.budgetId?.7:1},children:j===L.budgetId?"Accepting...":"Accept Invitation"}),d.jsx("button",{onClick:()=>{Q(null),I("")},disabled:j===L.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:j===L.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:j===L.budgetId?.7:.8},children:"Cancel"})]})]}):d.jsxs("form",{onSubmit:ue,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:k,onChange:me=>I(me.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:ae||!k.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:ae||!k.trim()?"not-allowed":"pointer",fontWeight:500,opacity:ae||!k.trim()?.7:1,whiteSpace:"nowrap"},children:ae?"Checking...":"Check Invite"})]})]}),i&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[d.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),d.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:i})]})]})}function $P({children:t}){const{addLoadingHold:e,removeLoadingHold:n}=jn(),i=A.useContext(ou),a=An();return A.useEffect(()=>(i.is_auth_checked?n("protected-route"):e("protected-route","Checking authentication..."),()=>n("protected-route")),[i.is_auth_checked,e,n]),i.is_auth_checked?i.is_logged_in?t?d.jsx(d.Fragment,{children:t}):d.jsx(Gh,{}):d.jsx(Hh,{to:"/account",state:{from:a.pathname},replace:!0}):null}function KP(){const{addLoadingHold:t,removeLoadingHold:e}=jn(),{selectedBudgetId:n,currentUserId:i,isInitialized:a,pageTitle:l}=Zt(),{isLoading:c,error:h}=On(n,i);return A.useEffect(()=>{a?e("budget-init"):t("budget-init",c?"Fetching data from server...":"Loading budget...")},[a,c,t,e]),A.useEffect(()=>()=>e("budget-init"),[e]),h?(console.error("[BudgetLayout] Error:",h),d.jsx("div",{style:ru,children:d.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",h.message]})})):d.jsxs("div",{style:{...ru,paddingBottom:"5rem"},children:[d.jsx(d6,{title:l}),a&&d.jsx(Gh,{})]})}function WP({message:t="Loading..."}){return d.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(15, 15, 20, 0.92)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999,gap:"1.25rem",backdropFilter:"blur(4px)"},children:[d.jsx("div",{style:{width:"3.5rem",height:"3.5rem",border:"3px solid rgba(255, 255, 255, 0.15)",borderTopColor:ce.primary,borderRadius:"50%",animation:"loadingOverlaySpin 0.8s linear infinite"}}),d.jsx("p",{style:{color:"rgba(255, 255, 255, 0.9)",fontSize:"1.1rem",fontWeight:500,letterSpacing:"0.02em"},children:t}),d.jsx("style",{children:`
        @keyframes loadingOverlaySpin {
          to { transform: rotate(360deg); }
        }
      `})]})}const YP={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function XP(){const{isLoading:t,loadingMessage:e}=jn();return t?d.jsx(WP,{message:e}):null}function JP(){const[t,e]=A.useState(YP),n=Ka(),i=A.useRef(!1),{addLoadingHold:a,removeLoadingHold:l}=jn();return A.useEffect(function(){i.current||(i.current=!0,n.set_user_listener(c=>{e({is_logged_in:c!=null,is_auth_checked:!0,username:c?.email??"",set_user_context:e})}))},[n]),A.useEffect(()=>{t.is_auth_checked?l("auth"):a("auth","Authenticating...")},[t.is_auth_checked,a,l]),t.is_auth_checked?d.jsx(ou.Provider,{value:t,children:d.jsx(nI,{children:d.jsx(O4,{children:d.jsxs(qR,{children:[d.jsxs(_R,{children:[d.jsx($t,{path:"/",element:d.jsx(J4,{})}),d.jsx($t,{path:"/account",element:d.jsx(f6,{})}),d.jsx($t,{path:"/sql-test",element:d.jsx(h6,{})}),d.jsx($t,{path:"/budget",element:d.jsx($P,{}),children:d.jsxs($t,{element:d.jsx(KP,{}),children:[d.jsx($t,{index:!0,element:d.jsx(FE,{})}),d.jsx($t,{path:":year/:month/:tab/:view?",element:d.jsx(FE,{})}),d.jsx($t,{path:"analytics",element:d.jsx(vP,{})}),d.jsx($t,{path:"my-budgets",element:d.jsx(QP,{})}),d.jsxs($t,{path:"settings",element:d.jsx(jP,{}),children:[d.jsx($t,{index:!0,element:d.jsx(Hh,{to:"categories",replace:!0})}),d.jsx($t,{path:"accounts",element:d.jsx(AP,{})}),d.jsx($t,{path:"categories",element:d.jsx(DP,{})}),d.jsx($t,{path:"users",element:d.jsx(OP,{})})]}),d.jsxs($t,{path:"admin",element:d.jsx(kP,{}),children:[d.jsx($t,{path:"budget",element:d.jsx(NP,{})}),d.jsx($t,{path:"feedback",element:d.jsx(HP,{})}),d.jsx($t,{path:"migration",element:d.jsx(qP,{})}),d.jsx($t,{path:"tests",element:d.jsx(GP,{})})]})]})})]}),d.jsx(o6,{})]})})})}):null}function ZP(){return d.jsxs(tD,{children:[d.jsx(XP,{}),d.jsx(JP,{})]})}_C.createRoot(document.getElementById("root")).render(d.jsx(A.StrictMode,{children:d.jsx(ZP,{})}));
