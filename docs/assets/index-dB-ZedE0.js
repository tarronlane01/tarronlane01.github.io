(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();var ap={exports:{}},yu={};var Qv;function tA(){if(Qv)return yu;Qv=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(s,o,l){var c=null;if(l!==void 0&&(c=""+l),o.key!==void 0&&(c=""+o.key),"key"in o){l={};for(var p in o)p!=="key"&&(l[p]=o[p])}else l=o;return o=l.ref,{$$typeof:t,type:s,key:c,ref:o!==void 0?o:null,props:l}}return yu.Fragment=e,yu.jsx=n,yu.jsxs=n,yu}var Kv;function nA(){return Kv||(Kv=1,ap.exports=tA()),ap.exports}var f=nA(),op={exports:{}},Le={};var $v;function rA(){if($v)return Le;$v=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),E=Symbol.iterator;function w(U){return U===null||typeof U!="object"?null:(U=E&&U[E]||U["@@iterator"],typeof U=="function"?U:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,O={};function F(U,te,be){this.props=U,this.context=te,this.refs=O,this.updater=be||A}F.prototype.isReactComponent={},F.prototype.setState=function(U,te){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,te,"setState")},F.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function q(){}q.prototype=F.prototype;function B(U,te,be){this.props=U,this.context=te,this.refs=O,this.updater=be||A}var $=B.prototype=new q;$.constructor=B,R($,F.prototype),$.isPureReactComponent=!0;var Y=Array.isArray;function X(){}var C={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function I(U,te,be){var _e=be.ref;return{$$typeof:t,type:U,key:te,ref:_e!==void 0?_e:null,props:be}}function k(U,te){return I(U.type,te,U.props)}function D(U){return typeof U=="object"&&U!==null&&U.$$typeof===t}function V(U){var te={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(be){return te[be]})}var N=/\/+/g;function W(U,te){return typeof U=="object"&&U!==null&&U.key!=null?V(""+U.key):te.toString(36)}function z(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(X,X):(U.status="pending",U.then(function(te){U.status==="pending"&&(U.status="fulfilled",U.value=te)},function(te){U.status==="pending"&&(U.status="rejected",U.reason=te)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function L(U,te,be,_e,fe){var Ee=typeof U;(Ee==="undefined"||Ee==="boolean")&&(U=null);var we=!1;if(U===null)we=!0;else switch(Ee){case"bigint":case"string":case"number":we=!0;break;case"object":switch(U.$$typeof){case t:case e:we=!0;break;case _:return we=U._init,L(we(U._payload),te,be,_e,fe)}}if(we)return fe=fe(U),we=_e===""?"."+W(U,0):_e,Y(fe)?(be="",we!=null&&(be=we.replace(N,"$&/")+"/"),L(fe,te,be,"",function(Z){return Z})):fe!=null&&(D(fe)&&(fe=k(fe,be+(fe.key==null||U&&U.key===fe.key?"":(""+fe.key).replace(N,"$&/")+"/")+we)),te.push(fe)),1;we=0;var ge=_e===""?".":_e+":";if(Y(U))for(var de=0;de<U.length;de++)_e=U[de],Ee=ge+W(_e,de),we+=L(_e,te,be,Ee,fe);else if(de=w(U),typeof de=="function")for(U=de.call(U),de=0;!(_e=U.next()).done;)_e=_e.value,Ee=ge+W(_e,de++),we+=L(_e,te,be,Ee,fe);else if(Ee==="object"){if(typeof U.then=="function")return L(z(U),te,be,_e,fe);throw te=String(U),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return we}function H(U,te,be){if(U==null)return U;var _e=[],fe=0;return L(U,_e,"","",function(Ee){return te.call(be,Ee,fe++)}),_e}function Q(U){if(U._status===-1){var te=U._result;te=te(),te.then(function(be){(U._status===0||U._status===-1)&&(U._status=1,U._result=be)},function(be){(U._status===0||U._status===-1)&&(U._status=2,U._result=be)}),U._status===-1&&(U._status=0,U._result=te)}if(U._status===1)return U._result.default;throw U._result}var ae=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},ce={map:H,forEach:function(U,te,be){H(U,function(){te.apply(this,arguments)},be)},count:function(U){var te=0;return H(U,function(){te++}),te},toArray:function(U){return H(U,function(te){return te})||[]},only:function(U){if(!D(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return Le.Activity=v,Le.Children=ce,Le.Component=F,Le.Fragment=n,Le.Profiler=o,Le.PureComponent=B,Le.StrictMode=s,Le.Suspense=h,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Le.__COMPILER_RUNTIME={__proto__:null,c:function(U){return C.H.useMemoCache(U)}},Le.cache=function(U){return function(){return U.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(U,te,be){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var _e=R({},U.props),fe=U.key;if(te!=null)for(Ee in te.key!==void 0&&(fe=""+te.key),te)!T.call(te,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&te.ref===void 0||(_e[Ee]=te[Ee]);var Ee=arguments.length-2;if(Ee===1)_e.children=be;else if(1<Ee){for(var we=Array(Ee),ge=0;ge<Ee;ge++)we[ge]=arguments[ge+2];_e.children=we}return I(U.type,fe,_e)},Le.createContext=function(U){return U={$$typeof:c,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},Le.createElement=function(U,te,be){var _e,fe={},Ee=null;if(te!=null)for(_e in te.key!==void 0&&(Ee=""+te.key),te)T.call(te,_e)&&_e!=="key"&&_e!=="__self"&&_e!=="__source"&&(fe[_e]=te[_e]);var we=arguments.length-2;if(we===1)fe.children=be;else if(1<we){for(var ge=Array(we),de=0;de<we;de++)ge[de]=arguments[de+2];fe.children=ge}if(U&&U.defaultProps)for(_e in we=U.defaultProps,we)fe[_e]===void 0&&(fe[_e]=we[_e]);return I(U,Ee,fe)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(U){return{$$typeof:p,render:U}},Le.isValidElement=D,Le.lazy=function(U){return{$$typeof:_,_payload:{_status:-1,_result:U},_init:Q}},Le.memo=function(U,te){return{$$typeof:m,type:U,compare:te===void 0?null:te}},Le.startTransition=function(U){var te=C.T,be={};C.T=be;try{var _e=U(),fe=C.S;fe!==null&&fe(be,_e),typeof _e=="object"&&_e!==null&&typeof _e.then=="function"&&_e.then(X,ae)}catch(Ee){ae(Ee)}finally{te!==null&&be.types!==null&&(te.types=be.types),C.T=te}},Le.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Le.use=function(U){return C.H.use(U)},Le.useActionState=function(U,te,be){return C.H.useActionState(U,te,be)},Le.useCallback=function(U,te){return C.H.useCallback(U,te)},Le.useContext=function(U){return C.H.useContext(U)},Le.useDebugValue=function(){},Le.useDeferredValue=function(U,te){return C.H.useDeferredValue(U,te)},Le.useEffect=function(U,te){return C.H.useEffect(U,te)},Le.useEffectEvent=function(U){return C.H.useEffectEvent(U)},Le.useId=function(){return C.H.useId()},Le.useImperativeHandle=function(U,te,be){return C.H.useImperativeHandle(U,te,be)},Le.useInsertionEffect=function(U,te){return C.H.useInsertionEffect(U,te)},Le.useLayoutEffect=function(U,te){return C.H.useLayoutEffect(U,te)},Le.useMemo=function(U,te){return C.H.useMemo(U,te)},Le.useOptimistic=function(U,te){return C.H.useOptimistic(U,te)},Le.useReducer=function(U,te,be){return C.H.useReducer(U,te,be)},Le.useRef=function(U){return C.H.useRef(U)},Le.useState=function(U){return C.H.useState(U)},Le.useSyncExternalStore=function(U,te,be){return C.H.useSyncExternalStore(U,te,be)},Le.useTransition=function(){return C.H.useTransition()},Le.version="19.2.3",Le}var Yv;function fg(){return Yv||(Yv=1,op.exports=rA()),op.exports}var j=fg(),lp={exports:{}},_u={},up={exports:{}},cp={};var Wv;function iA(){return Wv||(Wv=1,(function(t){function e(L,H){var Q=L.length;L.push(H);e:for(;0<Q;){var ae=Q-1>>>1,ce=L[ae];if(0<o(ce,H))L[ae]=H,L[Q]=ce,Q=ae;else break e}}function n(L){return L.length===0?null:L[0]}function s(L){if(L.length===0)return null;var H=L[0],Q=L.pop();if(Q!==H){L[0]=Q;e:for(var ae=0,ce=L.length,U=ce>>>1;ae<U;){var te=2*(ae+1)-1,be=L[te],_e=te+1,fe=L[_e];if(0>o(be,Q))_e<ce&&0>o(fe,be)?(L[ae]=fe,L[_e]=Q,ae=_e):(L[ae]=be,L[te]=Q,ae=te);else if(_e<ce&&0>o(fe,Q))L[ae]=fe,L[_e]=Q,ae=_e;else break e}}return H}function o(L,H){var Q=L.sortIndex-H.sortIndex;return Q!==0?Q:L.id-H.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,p=c.now();t.unstable_now=function(){return c.now()-p}}var h=[],m=[],_=1,v=null,E=3,w=!1,A=!1,R=!1,O=!1,F=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function $(L){for(var H=n(m);H!==null;){if(H.callback===null)s(m);else if(H.startTime<=L)s(m),H.sortIndex=H.expirationTime,e(h,H);else break;H=n(m)}}function Y(L){if(R=!1,$(L),!A)if(n(h)!==null)A=!0,X||(X=!0,V());else{var H=n(m);H!==null&&z(Y,H.startTime-L)}}var X=!1,C=-1,T=5,I=-1;function k(){return O?!0:!(t.unstable_now()-I<T)}function D(){if(O=!1,X){var L=t.unstable_now();I=L;var H=!0;try{e:{A=!1,R&&(R=!1,q(C),C=-1),w=!0;var Q=E;try{t:{for($(L),v=n(h);v!==null&&!(v.expirationTime>L&&k());){var ae=v.callback;if(typeof ae=="function"){v.callback=null,E=v.priorityLevel;var ce=ae(v.expirationTime<=L);if(L=t.unstable_now(),typeof ce=="function"){v.callback=ce,$(L),H=!0;break t}v===n(h)&&s(h),$(L)}else s(h);v=n(h)}if(v!==null)H=!0;else{var U=n(m);U!==null&&z(Y,U.startTime-L),H=!1}}break e}finally{v=null,E=Q,w=!1}H=void 0}}finally{H?V():X=!1}}}var V;if(typeof B=="function")V=function(){B(D)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,W=N.port2;N.port1.onmessage=D,V=function(){W.postMessage(null)}}else V=function(){F(D,0)};function z(L,H){C=F(function(){L(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return E},t.unstable_next=function(L){switch(E){case 1:case 2:case 3:var H=3;break;default:H=E}var Q=E;E=H;try{return L()}finally{E=Q}},t.unstable_requestPaint=function(){O=!0},t.unstable_runWithPriority=function(L,H){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var Q=E;E=L;try{return H()}finally{E=Q}},t.unstable_scheduleCallback=function(L,H,Q){var ae=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ae+Q:ae):Q=ae,L){case 1:var ce=-1;break;case 2:ce=250;break;case 5:ce=1073741823;break;case 4:ce=1e4;break;default:ce=5e3}return ce=Q+ce,L={id:_++,callback:H,priorityLevel:L,startTime:Q,expirationTime:ce,sortIndex:-1},Q>ae?(L.sortIndex=Q,e(m,L),n(h)===null&&L===n(m)&&(R?(q(C),C=-1):R=!0,z(Y,Q-ae))):(L.sortIndex=ce,e(h,L),A||w||(A=!0,X||(X=!0,V()))),L},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(L){var H=E;return function(){var Q=E;E=H;try{return L.apply(this,arguments)}finally{E=Q}}}})(cp)),cp}var Xv;function sA(){return Xv||(Xv=1,up.exports=iA()),up.exports}var dp={exports:{}},_n={};var Jv;function aA(){if(Jv)return _n;Jv=1;var t=fg();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(h,m,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:h,containerInfo:m,implementation:_}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return _n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,_n.createPortal=function(h,m){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(h,m,null,_)},_n.flushSync=function(h){var m=c.T,_=s.p;try{if(c.T=null,s.p=2,h)return h()}finally{c.T=m,s.p=_,s.d.f()}},_n.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,s.d.C(h,m))},_n.prefetchDNS=function(h){typeof h=="string"&&s.d.D(h)},_n.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var _=m.as,v=p(_,m.crossOrigin),E=typeof m.integrity=="string"?m.integrity:void 0,w=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;_==="style"?s.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:v,integrity:E,fetchPriority:w}):_==="script"&&s.d.X(h,{crossOrigin:v,integrity:E,fetchPriority:w,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},_n.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var _=p(m.as,m.crossOrigin);s.d.M(h,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&s.d.M(h)},_n.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var _=m.as,v=p(_,m.crossOrigin);s.d.L(h,_,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},_n.preloadModule=function(h,m){if(typeof h=="string")if(m){var _=p(m.as,m.crossOrigin);s.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else s.d.m(h)},_n.requestFormReset=function(h){s.d.r(h)},_n.unstable_batchedUpdates=function(h,m){return h(m)},_n.useFormState=function(h,m,_){return c.H.useFormState(h,m,_)},_n.useFormStatus=function(){return c.H.useHostTransitionStatus()},_n.version="19.2.3",_n}var Zv;function oA(){if(Zv)return dp.exports;Zv=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),dp.exports=aA(),dp.exports}var eb;function lA(){if(eb)return _u;eb=1;var t=sA(),e=fg(),n=oA();function s(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var i=r,a=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(a=i.return),r=i.return;while(r)}return i.tag===3?a:null}function c(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function p(r){if(r.tag===31){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function h(r){if(l(r)!==r)throw Error(s(188))}function m(r){var i=r.alternate;if(!i){if(i=l(r),i===null)throw Error(s(188));return i!==r?null:r}for(var a=r,u=i;;){var g=a.return;if(g===null)break;var y=g.alternate;if(y===null){if(u=g.return,u!==null){a=u;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===a)return h(g),r;if(y===u)return h(g),i;y=y.sibling}throw Error(s(188))}if(a.return!==u.return)a=g,u=y;else{for(var S=!1,M=g.child;M;){if(M===a){S=!0,a=g,u=y;break}if(M===u){S=!0,u=g,a=y;break}M=M.sibling}if(!S){for(M=y.child;M;){if(M===a){S=!0,a=y,u=g;break}if(M===u){S=!0,u=y,a=g;break}M=M.sibling}if(!S)throw Error(s(189))}}if(a.alternate!==u)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?r:i}function _(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=_(r),i!==null)return i;r=r.sibling}return null}var v=Object.assign,E=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),q=Symbol.for("react.consumer"),B=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),k=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function V(r){return r===null||typeof r!="object"?null:(r=D&&r[D]||r["@@iterator"],typeof r=="function"?r:null)}var N=Symbol.for("react.client.reference");function W(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===N?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case R:return"Fragment";case F:return"Profiler";case O:return"StrictMode";case Y:return"Suspense";case X:return"SuspenseList";case I:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case A:return"Portal";case B:return r.displayName||"Context";case q:return(r._context.displayName||"Context")+".Consumer";case $:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case C:return i=r.displayName||null,i!==null?i:W(r.type)||"Memo";case T:i=r._payload,r=r._init;try{return W(r(i))}catch{}}return null}var z=Array.isArray,L=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},ae=[],ce=-1;function U(r){return{current:r}}function te(r){0>ce||(r.current=ae[ce],ae[ce]=null,ce--)}function be(r,i){ce++,ae[ce]=r.current,r.current=i}var _e=U(null),fe=U(null),Ee=U(null),we=U(null);function ge(r,i){switch(be(Ee,i),be(fe,r),be(_e,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?pv(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=pv(i),r=gv(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}te(_e),be(_e,r)}function de(){te(_e),te(fe),te(Ee)}function Z(r){r.memoizedState!==null&&be(we,r);var i=_e.current,a=gv(i,r.type);i!==a&&(be(fe,r),be(_e,a))}function Re(r){fe.current===r&&(te(_e),te(fe)),we.current===r&&(te(we),fu._currentValue=Q)}var xe,Qe;function Ge(r){if(xe===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);xe=i&&i[1]||"",Qe=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xe+r+Qe}var nt=!1;function ze(r,i){if(!r||nt)return"";nt=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var me=function(){throw Error()};if(Object.defineProperty(me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(me,[])}catch(le){var ie=le}Reflect.construct(r,[],me)}else{try{me.call()}catch(le){ie=le}r.call(me.prototype)}}else{try{throw Error()}catch(le){ie=le}(me=r())&&typeof me.catch=="function"&&me.catch(function(){})}}catch(le){if(le&&ie&&typeof le.stack=="string")return[le.stack,ie.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),S=y[0],M=y[1];if(S&&M){var G=S.split(`
`),re=M.split(`
`);for(g=u=0;u<G.length&&!G[u].includes("DetermineComponentFrameRoot");)u++;for(;g<re.length&&!re[g].includes("DetermineComponentFrameRoot");)g++;if(u===G.length||g===re.length)for(u=G.length-1,g=re.length-1;1<=u&&0<=g&&G[u]!==re[g];)g--;for(;1<=u&&0<=g;u--,g--)if(G[u]!==re[g]){if(u!==1||g!==1)do if(u--,g--,0>g||G[u]!==re[g]){var ue=`
`+G[u].replace(" at new "," at ");return r.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",r.displayName)),ue}while(1<=u&&0<=g);break}}}finally{nt=!1,Error.prepareStackTrace=a}return(a=r?r.displayName||r.name:"")?Ge(a):""}function Et(r,i){switch(r.tag){case 26:case 27:case 5:return Ge(r.type);case 16:return Ge("Lazy");case 13:return r.child!==i&&i!==null?Ge("Suspense Fallback"):Ge("Suspense");case 19:return Ge("SuspenseList");case 0:case 15:return ze(r.type,!1);case 11:return ze(r.type.render,!1);case 1:return ze(r.type,!0);case 31:return Ge("Activity");default:return""}}function yt(r){try{var i="",a=null;do i+=Et(r,a),a=r,r=r.return;while(r);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var ht=Object.prototype.hasOwnProperty,Xt=t.unstable_scheduleCallback,Hi=t.unstable_cancelCallback,lf=t.unstable_shouldYield,oc=t.unstable_requestPaint,Cn=t.unstable_now,Ws=t.unstable_getCurrentPriorityLevel,gl=t.unstable_ImmediatePriority,yl=t.unstable_UserBlockingPriority,Gi=t.unstable_NormalPriority,uf=t.unstable_LowPriority,lc=t.unstable_IdlePriority,uc=t.log,cc=t.unstable_setDisableYieldValue,gr=null,ln=null;function Zn(r){if(typeof uc=="function"&&cc(r),ln&&typeof ln.setStrictMode=="function")try{ln.setStrictMode(gr,r)}catch{}}var Mt=Math.clz32?Math.clz32:hc,dc=Math.log,za=Math.LN2;function hc(r){return r>>>=0,r===0?32:31-(dc(r)/za|0)|0}var Mr=256,Xs=262144,Ut=4194304;function kr(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Nr(r,i,a){var u=r.pendingLanes;if(u===0)return 0;var g=0,y=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var M=u&134217727;return M!==0?(u=M&~y,u!==0?g=kr(u):(S&=M,S!==0?g=kr(S):a||(a=M&~r,a!==0&&(g=kr(a))))):(M=u&~y,M!==0?g=kr(M):S!==0?g=kr(S):a||(a=u&~r,a!==0&&(g=kr(a)))),g===0?0:i!==0&&i!==g&&(i&y)===0&&(y=g&-g,a=i&-i,y>=a||y===32&&(a&4194048)!==0)?i:g}function yr(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function cf(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fc(){var r=Ut;return Ut<<=1,(Ut&62914560)===0&&(Ut=4194304),r}function Pr(r){for(var i=[],a=0;31>a;a++)i.push(r);return i}function Js(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function df(r,i,a,u,g,y){var S=r.pendingLanes;r.pendingLanes=a,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=a,r.entangledLanes&=a,r.errorRecoveryDisabledLanes&=a,r.shellSuspendCounter=0;var M=r.entanglements,G=r.expirationTimes,re=r.hiddenUpdates;for(a=S&~a;0<a;){var ue=31-Mt(a),me=1<<ue;M[ue]=0,G[ue]=-1;var ie=re[ue];if(ie!==null)for(re[ue]=null,ue=0;ue<ie.length;ue++){var le=ie[ue];le!==null&&(le.lane&=-536870913)}a&=~me}u!==0&&Zs(r,u,0),y!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=y&~(S&~i))}function Zs(r,i,a){r.pendingLanes|=i,r.suspendedLanes&=~i;var u=31-Mt(i);r.entangledLanes|=i,r.entanglements[u]=r.entanglements[u]|1073741824|a&261930}function _l(r,i){var a=r.entangledLanes|=i;for(r=r.entanglements;a;){var u=31-Mt(a),g=1<<u;g&i|r[u]&i&&(r[u]|=i),a&=~g}}function vl(r,i){var a=i&-i;return a=(a&42)!==0?1:ea(a),(a&(r.suspendedLanes|i))!==0?0:a}function ea(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ci(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function mc(){var r=H.p;return r!==0?r:(r=window.event,r===void 0?32:Uv(r.type))}function _r(r,i){var a=H.p;try{return H.p=r,i()}finally{H.p=a}}var vr=Math.random().toString(36).slice(2),zt="__reactFiber$"+vr,nn="__reactProps$"+vr,Vr="__reactContainer$"+vr,Ba="__reactEvents$"+vr,hf="__reactListeners$"+vr,pc="__reactHandles$"+vr,gc="__reactResources$"+vr,Lr="__reactMarker$"+vr;function Fa(r){delete r[zt],delete r[nn],delete r[Ba],delete r[hf],delete r[pc]}function Ur(r){var i=r[zt];if(i)return i;for(var a=r.parentNode;a;){if(i=a[Vr]||a[zt]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(r=xv(r);r!==null;){if(a=r[zt])return a;r=xv(r)}return i}r=a,a=r.parentNode}return null}function er(r){if(r=r[zt]||r[Vr]){var i=r.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return r}return null}function Bn(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(s(33))}function zr(r){var i=r[gc];return i||(i=r[gc]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Bt(r){r[Lr]=!0}var bl=new Set,El={};function Br(r,i){Fr(r,i),Fr(r+"Capture",i)}function Fr(r,i){for(El[r]=i,r=0;r<i.length;r++)bl.add(i[r])}var Sl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xl={},wl={};function yc(r){return ht.call(wl,r)?!0:ht.call(xl,r)?!1:Sl.test(r)?wl[r]=!0:(xl[r]=!0,!1)}function qa(r,i,a){if(yc(i))if(a===null)r.removeAttribute(i);else{switch(typeof a){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+a)}}function Fn(r,i,a){if(a===null)r.removeAttribute(i);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+a)}}function Ft(r,i,a,u){if(u===null)r.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttributeNS(i,a,""+u)}}function rn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Qi(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Tl(r,i,a){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,i);if(!r.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,y=u.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return g.call(this)},set:function(S){a=""+S,y.call(this,S)}}),Object.defineProperty(r,i,{enumerable:u.enumerable}),{getValue:function(){return a},setValue:function(S){a=""+S},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function ut(r){if(!r._valueTracker){var i=Qi(r)?"checked":"value";r._valueTracker=Tl(r,i,""+r[i])}}function ta(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var a=i.getValue(),u="";return r&&(u=Qi(r)?r.checked?"true":"false":r.value),r=u,r!==a?(i.setValue(r),!0):!1}function qr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var na=/[\n"\\]/g;function In(r){return r.replace(na,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Ha(r,i,a,u,g,y,S,M){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),i!=null?S==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+rn(i)):r.value!==""+rn(i)&&(r.value=""+rn(i)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),i!=null?Al(r,S,rn(i)):a!=null?Al(r,S,rn(a)):u!=null&&r.removeAttribute("value"),g==null&&y!=null&&(r.defaultChecked=!!y),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?r.name=""+rn(M):r.removeAttribute("name")}function _c(r,i,a,u,g,y,S,M){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),i!=null||a!=null){if(!(y!=="submit"&&y!=="reset"||i!=null)){ut(r);return}a=a!=null?""+rn(a):"",i=i!=null?""+rn(i):a,M||i===r.value||(r.value=i),r.defaultValue=i}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=M?r.checked:!!u,r.defaultChecked=!!u,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S),ut(r)}function Al(r,i,a){i==="number"&&qr(r.ownerDocument)===r||r.defaultValue===""+a||(r.defaultValue=""+a)}function Ki(r,i,a,u){if(r=r.options,i){i={};for(var g=0;g<a.length;g++)i["$"+a[g]]=!0;for(a=0;a<r.length;a++)g=i.hasOwnProperty("$"+r[a].value),r[a].selected!==g&&(r[a].selected=g),g&&u&&(r[a].defaultSelected=!0)}else{for(a=""+rn(a),i=null,g=0;g<r.length;g++){if(r[g].value===a){r[g].selected=!0,u&&(r[g].defaultSelected=!0);return}i!==null||r[g].disabled||(i=r[g])}i!==null&&(i.selected=!0)}}function vc(r,i,a){if(i!=null&&(i=""+rn(i),i!==r.value&&(r.value=i),a==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=a!=null?""+rn(a):""}function $i(r,i,a,u){if(i==null){if(u!=null){if(a!=null)throw Error(s(92));if(z(u)){if(1<u.length)throw Error(s(93));u=u[0]}a=u}a==null&&(a=""),i=a}a=rn(i),r.defaultValue=a,u=r.textContent,u===a&&u!==""&&u!==null&&(r.value=u),ut(r)}function On(r,i){if(i){var a=r.firstChild;if(a&&a===r.lastChild&&a.nodeType===3){a.nodeValue=i;return}}r.textContent=i}var bc=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Cl(r,i,a){var u=i.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?u?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":u?r.setProperty(i,a):typeof a!="number"||a===0||bc.has(i)?i==="float"?r.cssFloat=a:r[i]=(""+a).trim():r[i]=a+"px"}function Rl(r,i,a){if(i!=null&&typeof i!="object")throw Error(s(62));if(r=r.style,a!=null){for(var u in a)!a.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var g in i)u=i[g],i.hasOwnProperty(g)&&a[g]!==u&&Cl(r,g,u)}else for(var y in i)i.hasOwnProperty(y)&&Cl(r,y,i[y])}function Ga(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ec=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qa(r){return Yi.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function br(){}var Dl=null;function tr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Wi=null,Hr=null;function ra(r){var i=er(r);if(i&&(r=i.stateNode)){var a=r[nn]||null;e:switch(r=i.stateNode,i.type){case"input":if(Ha(r,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),i=a.name,a.type==="radio"&&i!=null){for(a=r;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+In(""+i)+'"][type="radio"]'),i=0;i<a.length;i++){var u=a[i];if(u!==r&&u.form===r.form){var g=u[nn]||null;if(!g)throw Error(s(90));Ha(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(i=0;i<a.length;i++)u=a[i],u.form===r.form&&ta(u)}break e;case"textarea":vc(r,a.value,a.defaultValue);break e;case"select":i=a.value,i!=null&&Ki(r,!!a.multiple,i,!1)}}}var Ka=!1;function Xi(r,i,a){if(Ka)return r(i,a);Ka=!0;try{var u=r(i);return u}finally{if(Ka=!1,(Wi!==null||Hr!==null)&&(md(),Wi&&(i=Wi,r=Hr,Hr=Wi=null,ra(i),r)))for(i=0;i<r.length;i++)ra(r[i])}}function Er(r,i){var a=r.stateNode;if(a===null)return null;var u=a[nn]||null;if(u===null)return null;a=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(a&&typeof a!="function")throw Error(s(231,i,typeof a));return a}var nr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ia=!1;if(nr)try{var ft={};Object.defineProperty(ft,"passive",{get:function(){ia=!0}}),window.addEventListener("test",ft,ft),window.removeEventListener("test",ft,ft)}catch{ia=!1}var Gr=null,Il=null,sa=null;function Ol(){if(sa)return sa;var r,i=Il,a=i.length,u,g="value"in Gr?Gr.value:Gr.textContent,y=g.length;for(r=0;r<a&&i[r]===g[r];r++);var S=a-r;for(u=1;u<=S&&i[a-u]===g[y-u];u++);return sa=g.slice(r,1<u?1-u:void 0)}function aa(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function di(){return!0}function Sr(){return!1}function un(r){function i(a,u,g,y,S){this._reactName=a,this._targetInst=g,this.type=u,this.nativeEvent=y,this.target=S,this.currentTarget=null;for(var M in r)r.hasOwnProperty(M)&&(a=r[M],this[M]=a?a(y):y[M]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?di:Sr,this.isPropagationStopped=Sr,this}return v(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=di)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=di)},persist:function(){},isPersistent:di}),i}var hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qr=un(hi),Ji=v({},hi,{view:0,detail:0}),jl=un(Ji),Zi,$a,Kr,Ya=v({},Ji,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:es,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Kr&&(Kr&&r.type==="mousemove"?(Zi=r.screenX-Kr.screenX,$a=r.screenY-Kr.screenY):$a=Zi=0,Kr=r),Zi)},movementY:function(r){return"movementY"in r?r.movementY:$a}}),Ml=un(Ya),oa=v({},Ya,{dataTransfer:0}),Sc=un(oa),xc=v({},Ji,{relatedTarget:0}),la=un(xc),kl=v({},hi,{animationName:0,elapsedTime:0,pseudoElement:0}),wc=un(kl),Wa=v({},hi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Tc=un(Wa),Ac=v({},hi,{data:0}),$r=un(Ac),Cc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ic(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=Dc[r])?!!i[r]:!1}function es(){return Ic}var Rn=v({},Ji,{key:function(r){if(r.key){var i=Cc[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=aa(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Rc[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:es,charCode:function(r){return r.type==="keypress"?aa(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?aa(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Oc=un(Rn),jc=v({},Ya,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fi=un(jc),d=v({},Ji,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:es}),b=un(d),x=v({},hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),P=un(x),ee=v({},Ya,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),oe=un(ee),Se=v({},hi,{newState:0,oldState:0}),Be=un(Se),kt=[9,13,27,32],at=nr&&"CompositionEvent"in window,Tt=null;nr&&"documentMode"in document&&(Tt=document.documentMode);var rr=nr&&"TextEvent"in window&&!Tt,Yr=nr&&(!at||Tt&&8<Tt&&11>=Tt),xr=" ",wr=!1;function ua(r,i){switch(r){case"keyup":return kt.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xa(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ja=!1;function TT(r,i){switch(r){case"compositionend":return Xa(i);case"keypress":return i.which!==32?null:(wr=!0,xr);case"textInput":return r=i.data,r===xr&&wr?null:r;default:return null}}function AT(r,i){if(Ja)return r==="compositionend"||!at&&ua(r,i)?(r=Ol(),sa=Il=Gr=null,Ja=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Yr&&i.locale!=="ko"?null:i.data;default:return null}}var CT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ay(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!CT[r.type]:i==="textarea"}function Cy(r,i,a,u){Wi?Hr?Hr.push(u):Hr=[u]:Wi=u,i=Ed(i,"onChange"),0<i.length&&(a=new Qr("onChange","change",null,a,u),r.push({event:a,listeners:i}))}var Nl=null,Pl=null;function RT(r){uv(r,0)}function Mc(r){var i=Bn(r);if(ta(i))return r}function Ry(r,i){if(r==="change")return i}var Dy=!1;if(nr){var ff;if(nr){var mf="oninput"in document;if(!mf){var Iy=document.createElement("div");Iy.setAttribute("oninput","return;"),mf=typeof Iy.oninput=="function"}ff=mf}else ff=!1;Dy=ff&&(!document.documentMode||9<document.documentMode)}function Oy(){Nl&&(Nl.detachEvent("onpropertychange",jy),Pl=Nl=null)}function jy(r){if(r.propertyName==="value"&&Mc(Pl)){var i=[];Cy(i,Pl,r,tr(r)),Xi(RT,i)}}function DT(r,i,a){r==="focusin"?(Oy(),Nl=i,Pl=a,Nl.attachEvent("onpropertychange",jy)):r==="focusout"&&Oy()}function IT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Mc(Pl)}function OT(r,i){if(r==="click")return Mc(i)}function jT(r,i){if(r==="input"||r==="change")return Mc(i)}function MT(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var qn=typeof Object.is=="function"?Object.is:MT;function Vl(r,i){if(qn(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var a=Object.keys(r),u=Object.keys(i);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++){var g=a[u];if(!ht.call(i,g)||!qn(r[g],i[g]))return!1}return!0}function My(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function ky(r,i){var a=My(r);r=0;for(var u;a;){if(a.nodeType===3){if(u=r+a.textContent.length,r<=i&&u>=i)return{node:a,offset:i-r};r=u}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=My(a)}}function Ny(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Ny(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function Py(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=qr(r.document);i instanceof r.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)r=i.contentWindow;else break;i=qr(r.document)}return i}function pf(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var kT=nr&&"documentMode"in document&&11>=document.documentMode,Za=null,gf=null,Ll=null,yf=!1;function Vy(r,i,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;yf||Za==null||Za!==qr(u)||(u=Za,"selectionStart"in u&&pf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ll&&Vl(Ll,u)||(Ll=u,u=Ed(gf,"onSelect"),0<u.length&&(i=new Qr("onSelect","select",null,i,a),r.push({event:i,listeners:u}),i.target=Za)))}function ca(r,i){var a={};return a[r.toLowerCase()]=i.toLowerCase(),a["Webkit"+r]="webkit"+i,a["Moz"+r]="moz"+i,a}var eo={animationend:ca("Animation","AnimationEnd"),animationiteration:ca("Animation","AnimationIteration"),animationstart:ca("Animation","AnimationStart"),transitionrun:ca("Transition","TransitionRun"),transitionstart:ca("Transition","TransitionStart"),transitioncancel:ca("Transition","TransitionCancel"),transitionend:ca("Transition","TransitionEnd")},_f={},Ly={};nr&&(Ly=document.createElement("div").style,"AnimationEvent"in window||(delete eo.animationend.animation,delete eo.animationiteration.animation,delete eo.animationstart.animation),"TransitionEvent"in window||delete eo.transitionend.transition);function da(r){if(_f[r])return _f[r];if(!eo[r])return r;var i=eo[r],a;for(a in i)if(i.hasOwnProperty(a)&&a in Ly)return _f[r]=i[a];return r}var Uy=da("animationend"),zy=da("animationiteration"),By=da("animationstart"),NT=da("transitionrun"),PT=da("transitionstart"),VT=da("transitioncancel"),Fy=da("transitionend"),qy=new Map,vf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");vf.push("scrollEnd");function Tr(r,i){qy.set(r,i),Br(i,[r])}var kc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},ir=[],to=0,bf=0;function Nc(){for(var r=to,i=bf=to=0;i<r;){var a=ir[i];ir[i++]=null;var u=ir[i];ir[i++]=null;var g=ir[i];ir[i++]=null;var y=ir[i];if(ir[i++]=null,u!==null&&g!==null){var S=u.pending;S===null?g.next=g:(g.next=S.next,S.next=g),u.pending=g}y!==0&&Hy(a,g,y)}}function Pc(r,i,a,u){ir[to++]=r,ir[to++]=i,ir[to++]=a,ir[to++]=u,bf|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function Ef(r,i,a,u){return Pc(r,i,a,u),Vc(r)}function ha(r,i){return Pc(r,null,null,i),Vc(r)}function Hy(r,i,a){r.lanes|=a;var u=r.alternate;u!==null&&(u.lanes|=a);for(var g=!1,y=r.return;y!==null;)y.childLanes|=a,u=y.alternate,u!==null&&(u.childLanes|=a),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(g=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,g&&i!==null&&(g=31-Mt(a),r=y.hiddenUpdates,u=r[g],u===null?r[g]=[i]:u.push(i),i.lane=a|536870912),y):null}function Vc(r){if(50<au)throw au=0,Im=null,Error(s(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var no={};function LT(r,i,a,u){this.tag=r,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hn(r,i,a,u){return new LT(r,i,a,u)}function Sf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function mi(r,i){var a=r.alternate;return a===null?(a=Hn(r.tag,i,r.key,r.mode),a.elementType=r.elementType,a.type=r.type,a.stateNode=r.stateNode,a.alternate=r,r.alternate=a):(a.pendingProps=i,a.type=r.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=r.flags&65011712,a.childLanes=r.childLanes,a.lanes=r.lanes,a.child=r.child,a.memoizedProps=r.memoizedProps,a.memoizedState=r.memoizedState,a.updateQueue=r.updateQueue,i=r.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=r.sibling,a.index=r.index,a.ref=r.ref,a.refCleanup=r.refCleanup,a}function Gy(r,i){r.flags&=65011714;var a=r.alternate;return a===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=a.childLanes,r.lanes=a.lanes,r.child=a.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=a.memoizedProps,r.memoizedState=a.memoizedState,r.updateQueue=a.updateQueue,r.type=a.type,i=a.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function Lc(r,i,a,u,g,y){var S=0;if(u=r,typeof r=="function")Sf(r)&&(S=1);else if(typeof r=="string")S=q1(r,a,_e.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case I:return r=Hn(31,a,i,g),r.elementType=I,r.lanes=y,r;case R:return fa(a.children,g,y,i);case O:S=8,g|=24;break;case F:return r=Hn(12,a,i,g|2),r.elementType=F,r.lanes=y,r;case Y:return r=Hn(13,a,i,g),r.elementType=Y,r.lanes=y,r;case X:return r=Hn(19,a,i,g),r.elementType=X,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case B:S=10;break e;case q:S=9;break e;case $:S=11;break e;case C:S=14;break e;case T:S=16,u=null;break e}S=29,a=Error(s(130,r===null?"null":typeof r,"")),u=null}return i=Hn(S,a,i,g),i.elementType=r,i.type=u,i.lanes=y,i}function fa(r,i,a,u){return r=Hn(7,r,u,i),r.lanes=a,r}function xf(r,i,a){return r=Hn(6,r,null,i),r.lanes=a,r}function Qy(r){var i=Hn(18,null,null,0);return i.stateNode=r,i}function wf(r,i,a){return i=Hn(4,r.children!==null?r.children:[],r.key,i),i.lanes=a,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var Ky=new WeakMap;function sr(r,i){if(typeof r=="object"&&r!==null){var a=Ky.get(r);return a!==void 0?a:(i={value:r,source:i,stack:yt(i)},Ky.set(r,i),i)}return{value:r,source:i,stack:yt(i)}}var ro=[],io=0,Uc=null,Ul=0,ar=[],or=0,ts=null,Wr=1,Xr="";function pi(r,i){ro[io++]=Ul,ro[io++]=Uc,Uc=r,Ul=i}function $y(r,i,a){ar[or++]=Wr,ar[or++]=Xr,ar[or++]=ts,ts=r;var u=Wr;r=Xr;var g=32-Mt(u)-1;u&=~(1<<g),a+=1;var y=32-Mt(i)+g;if(30<y){var S=g-g%5;y=(u&(1<<S)-1).toString(32),u>>=S,g-=S,Wr=1<<32-Mt(i)+g|a<<g|u,Xr=y+r}else Wr=1<<y|a<<g|u,Xr=r}function Tf(r){r.return!==null&&(pi(r,1),$y(r,1,0))}function Af(r){for(;r===Uc;)Uc=ro[--io],ro[io]=null,Ul=ro[--io],ro[io]=null;for(;r===ts;)ts=ar[--or],ar[or]=null,Xr=ar[--or],ar[or]=null,Wr=ar[--or],ar[or]=null}function Yy(r,i){ar[or++]=Wr,ar[or++]=Xr,ar[or++]=ts,Wr=i.id,Xr=i.overflow,ts=r}var cn=null,St=null,tt=!1,ns=null,lr=!1,Cf=Error(s(519));function rs(r){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw zl(sr(i,r)),Cf}function Wy(r){var i=r.stateNode,a=r.type,u=r.memoizedProps;switch(i[zt]=r,i[nn]=u,a){case"dialog":Ye("cancel",i),Ye("close",i);break;case"iframe":case"object":case"embed":Ye("load",i);break;case"video":case"audio":for(a=0;a<lu.length;a++)Ye(lu[a],i);break;case"source":Ye("error",i);break;case"img":case"image":case"link":Ye("error",i),Ye("load",i);break;case"details":Ye("toggle",i);break;case"input":Ye("invalid",i),_c(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ye("invalid",i);break;case"textarea":Ye("invalid",i),$i(i,u.value,u.defaultValue,u.children)}a=u.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||i.textContent===""+a||u.suppressHydrationWarning===!0||fv(i.textContent,a)?(u.popover!=null&&(Ye("beforetoggle",i),Ye("toggle",i)),u.onScroll!=null&&Ye("scroll",i),u.onScrollEnd!=null&&Ye("scrollend",i),u.onClick!=null&&(i.onclick=br),i=!0):i=!1,i||rs(r,!0)}function Xy(r){for(cn=r.return;cn;)switch(cn.tag){case 5:case 31:case 13:lr=!1;return;case 27:case 3:lr=!0;return;default:cn=cn.return}}function so(r){if(r!==cn)return!1;if(!tt)return Xy(r),tt=!0,!1;var i=r.tag,a;if((a=i!==3&&i!==27)&&((a=i===5)&&(a=r.type,a=!(a!=="form"&&a!=="button")||Gm(r.type,r.memoizedProps)),a=!a),a&&St&&rs(r),Xy(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));St=Sv(r)}else if(i===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));St=Sv(r)}else i===27?(i=St,ys(r.type)?(r=Wm,Wm=null,St=r):St=i):St=cn?cr(r.stateNode.nextSibling):null;return!0}function ma(){St=cn=null,tt=!1}function Rf(){var r=ns;return r!==null&&(Nn===null?Nn=r:Nn.push.apply(Nn,r),ns=null),r}function zl(r){ns===null?ns=[r]:ns.push(r)}var Df=U(null),pa=null,gi=null;function is(r,i,a){be(Df,i._currentValue),i._currentValue=a}function yi(r){r._currentValue=Df.current,te(Df)}function If(r,i,a){for(;r!==null;){var u=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),r===a)break;r=r.return}}function Of(r,i,a,u){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var y=g.dependencies;if(y!==null){var S=g.child;y=y.firstContext;e:for(;y!==null;){var M=y;y=g;for(var G=0;G<i.length;G++)if(M.context===i[G]){y.lanes|=a,M=y.alternate,M!==null&&(M.lanes|=a),If(y.return,a,r),u||(S=null);break e}y=M.next}}else if(g.tag===18){if(S=g.return,S===null)throw Error(s(341));S.lanes|=a,y=S.alternate,y!==null&&(y.lanes|=a),If(S,a,r),S=null}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===r){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}}function ao(r,i,a,u){r=null;for(var g=i,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var S=g.alternate;if(S===null)throw Error(s(387));if(S=S.memoizedProps,S!==null){var M=g.type;qn(g.pendingProps.value,S.value)||(r!==null?r.push(M):r=[M])}}else if(g===we.current){if(S=g.alternate,S===null)throw Error(s(387));S.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(fu):r=[fu])}g=g.return}r!==null&&Of(i,r,a,u),i.flags|=262144}function zc(r){for(r=r.firstContext;r!==null;){if(!qn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ga(r){pa=r,gi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function dn(r){return Jy(pa,r)}function Bc(r,i){return pa===null&&ga(r),Jy(r,i)}function Jy(r,i){var a=i._currentValue;if(i={context:i,memoizedValue:a,next:null},gi===null){if(r===null)throw Error(s(308));gi=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else gi=gi.next=i;return a}var UT=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(a,u){r.push(u)}};this.abort=function(){i.aborted=!0,r.forEach(function(a){return a()})}},zT=t.unstable_scheduleCallback,BT=t.unstable_NormalPriority,qt={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jf(){return{controller:new UT,data:new Map,refCount:0}}function Bl(r){r.refCount--,r.refCount===0&&zT(BT,function(){r.controller.abort()})}var Fl=null,Mf=0,oo=0,lo=null;function FT(r,i){if(Fl===null){var a=Fl=[];Mf=0,oo=Pm(),lo={status:"pending",value:void 0,then:function(u){a.push(u)}}}return Mf++,i.then(Zy,Zy),i}function Zy(){if(--Mf===0&&Fl!==null){lo!==null&&(lo.status="fulfilled");var r=Fl;Fl=null,oo=0,lo=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function qT(r,i){var a=[],u={status:"pending",value:null,reason:null,then:function(g){a.push(g)}};return r.then(function(){u.status="fulfilled",u.value=i;for(var g=0;g<a.length;g++)(0,a[g])(i)},function(g){for(u.status="rejected",u.reason=g,g=0;g<a.length;g++)(0,a[g])(void 0)}),u}var e_=L.S;L.S=function(r,i){V0=Cn(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&FT(r,i),e_!==null&&e_(r,i)};var ya=U(null);function kf(){var r=ya.current;return r!==null?r:_t.pooledCache}function Fc(r,i){i===null?be(ya,ya.current):be(ya,i.pool)}function t_(){var r=kf();return r===null?null:{parent:qt._currentValue,pool:r}}var uo=Error(s(460)),Nf=Error(s(474)),qc=Error(s(542)),Hc={then:function(){}};function n_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function r_(r,i,a){switch(a=r[a],a===void 0?r.push(i):a!==i&&(i.then(br,br),i=a),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,s_(r),r;default:if(typeof i.status=="string")i.then(br,br);else{if(r=_t,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=i,r.status="pending",r.then(function(u){if(i.status==="pending"){var g=i;g.status="fulfilled",g.value=u}},function(u){if(i.status==="pending"){var g=i;g.status="rejected",g.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,s_(r),r}throw va=i,uo}}function _a(r){try{var i=r._init;return i(r._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(va=a,uo):a}}var va=null;function i_(){if(va===null)throw Error(s(459));var r=va;return va=null,r}function s_(r){if(r===uo||r===qc)throw Error(s(483))}var co=null,ql=0;function Gc(r){var i=ql;return ql+=1,co===null&&(co=[]),r_(co,r,i)}function Hl(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function Qc(r,i){throw i.$$typeof===E?Error(s(525)):(r=Object.prototype.toString.call(i),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function a_(r){function i(J,K){if(r){var ne=J.deletions;ne===null?(J.deletions=[K],J.flags|=16):ne.push(K)}}function a(J,K){if(!r)return null;for(;K!==null;)i(J,K),K=K.sibling;return null}function u(J){for(var K=new Map;J!==null;)J.key!==null?K.set(J.key,J):K.set(J.index,J),J=J.sibling;return K}function g(J,K){return J=mi(J,K),J.index=0,J.sibling=null,J}function y(J,K,ne){return J.index=ne,r?(ne=J.alternate,ne!==null?(ne=ne.index,ne<K?(J.flags|=67108866,K):ne):(J.flags|=67108866,K)):(J.flags|=1048576,K)}function S(J){return r&&J.alternate===null&&(J.flags|=67108866),J}function M(J,K,ne,he){return K===null||K.tag!==6?(K=xf(ne,J.mode,he),K.return=J,K):(K=g(K,ne),K.return=J,K)}function G(J,K,ne,he){var Ie=ne.type;return Ie===R?ue(J,K,ne.props.children,he,ne.key):K!==null&&(K.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===T&&_a(Ie)===K.type)?(K=g(K,ne.props),Hl(K,ne),K.return=J,K):(K=Lc(ne.type,ne.key,ne.props,null,J.mode,he),Hl(K,ne),K.return=J,K)}function re(J,K,ne,he){return K===null||K.tag!==4||K.stateNode.containerInfo!==ne.containerInfo||K.stateNode.implementation!==ne.implementation?(K=wf(ne,J.mode,he),K.return=J,K):(K=g(K,ne.children||[]),K.return=J,K)}function ue(J,K,ne,he,Ie){return K===null||K.tag!==7?(K=fa(ne,J.mode,he,Ie),K.return=J,K):(K=g(K,ne),K.return=J,K)}function me(J,K,ne){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=xf(""+K,J.mode,ne),K.return=J,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case w:return ne=Lc(K.type,K.key,K.props,null,J.mode,ne),Hl(ne,K),ne.return=J,ne;case A:return K=wf(K,J.mode,ne),K.return=J,K;case T:return K=_a(K),me(J,K,ne)}if(z(K)||V(K))return K=fa(K,J.mode,ne,null),K.return=J,K;if(typeof K.then=="function")return me(J,Gc(K),ne);if(K.$$typeof===B)return me(J,Bc(J,K),ne);Qc(J,K)}return null}function ie(J,K,ne,he){var Ie=K!==null?K.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Ie!==null?null:M(J,K,""+ne,he);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case w:return ne.key===Ie?G(J,K,ne,he):null;case A:return ne.key===Ie?re(J,K,ne,he):null;case T:return ne=_a(ne),ie(J,K,ne,he)}if(z(ne)||V(ne))return Ie!==null?null:ue(J,K,ne,he,null);if(typeof ne.then=="function")return ie(J,K,Gc(ne),he);if(ne.$$typeof===B)return ie(J,K,Bc(J,ne),he);Qc(J,ne)}return null}function le(J,K,ne,he,Ie){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return J=J.get(ne)||null,M(K,J,""+he,Ie);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case w:return J=J.get(he.key===null?ne:he.key)||null,G(K,J,he,Ie);case A:return J=J.get(he.key===null?ne:he.key)||null,re(K,J,he,Ie);case T:return he=_a(he),le(J,K,ne,he,Ie)}if(z(he)||V(he))return J=J.get(ne)||null,ue(K,J,he,Ie,null);if(typeof he.then=="function")return le(J,K,ne,Gc(he),Ie);if(he.$$typeof===B)return le(J,K,ne,Bc(K,he),Ie);Qc(K,he)}return null}function Ce(J,K,ne,he){for(var Ie=null,it=null,De=K,He=K=0,Xe=null;De!==null&&He<ne.length;He++){De.index>He?(Xe=De,De=null):Xe=De.sibling;var st=ie(J,De,ne[He],he);if(st===null){De===null&&(De=Xe);break}r&&De&&st.alternate===null&&i(J,De),K=y(st,K,He),it===null?Ie=st:it.sibling=st,it=st,De=Xe}if(He===ne.length)return a(J,De),tt&&pi(J,He),Ie;if(De===null){for(;He<ne.length;He++)De=me(J,ne[He],he),De!==null&&(K=y(De,K,He),it===null?Ie=De:it.sibling=De,it=De);return tt&&pi(J,He),Ie}for(De=u(De);He<ne.length;He++)Xe=le(De,J,He,ne[He],he),Xe!==null&&(r&&Xe.alternate!==null&&De.delete(Xe.key===null?He:Xe.key),K=y(Xe,K,He),it===null?Ie=Xe:it.sibling=Xe,it=Xe);return r&&De.forEach(function(Ss){return i(J,Ss)}),tt&&pi(J,He),Ie}function je(J,K,ne,he){if(ne==null)throw Error(s(151));for(var Ie=null,it=null,De=K,He=K=0,Xe=null,st=ne.next();De!==null&&!st.done;He++,st=ne.next()){De.index>He?(Xe=De,De=null):Xe=De.sibling;var Ss=ie(J,De,st.value,he);if(Ss===null){De===null&&(De=Xe);break}r&&De&&Ss.alternate===null&&i(J,De),K=y(Ss,K,He),it===null?Ie=Ss:it.sibling=Ss,it=Ss,De=Xe}if(st.done)return a(J,De),tt&&pi(J,He),Ie;if(De===null){for(;!st.done;He++,st=ne.next())st=me(J,st.value,he),st!==null&&(K=y(st,K,He),it===null?Ie=st:it.sibling=st,it=st);return tt&&pi(J,He),Ie}for(De=u(De);!st.done;He++,st=ne.next())st=le(De,J,He,st.value,he),st!==null&&(r&&st.alternate!==null&&De.delete(st.key===null?He:st.key),K=y(st,K,He),it===null?Ie=st:it.sibling=st,it=st);return r&&De.forEach(function(eA){return i(J,eA)}),tt&&pi(J,He),Ie}function gt(J,K,ne,he){if(typeof ne=="object"&&ne!==null&&ne.type===R&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case w:e:{for(var Ie=ne.key;K!==null;){if(K.key===Ie){if(Ie=ne.type,Ie===R){if(K.tag===7){a(J,K.sibling),he=g(K,ne.props.children),he.return=J,J=he;break e}}else if(K.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===T&&_a(Ie)===K.type){a(J,K.sibling),he=g(K,ne.props),Hl(he,ne),he.return=J,J=he;break e}a(J,K);break}else i(J,K);K=K.sibling}ne.type===R?(he=fa(ne.props.children,J.mode,he,ne.key),he.return=J,J=he):(he=Lc(ne.type,ne.key,ne.props,null,J.mode,he),Hl(he,ne),he.return=J,J=he)}return S(J);case A:e:{for(Ie=ne.key;K!==null;){if(K.key===Ie)if(K.tag===4&&K.stateNode.containerInfo===ne.containerInfo&&K.stateNode.implementation===ne.implementation){a(J,K.sibling),he=g(K,ne.children||[]),he.return=J,J=he;break e}else{a(J,K);break}else i(J,K);K=K.sibling}he=wf(ne,J.mode,he),he.return=J,J=he}return S(J);case T:return ne=_a(ne),gt(J,K,ne,he)}if(z(ne))return Ce(J,K,ne,he);if(V(ne)){if(Ie=V(ne),typeof Ie!="function")throw Error(s(150));return ne=Ie.call(ne),je(J,K,ne,he)}if(typeof ne.then=="function")return gt(J,K,Gc(ne),he);if(ne.$$typeof===B)return gt(J,K,Bc(J,ne),he);Qc(J,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,K!==null&&K.tag===6?(a(J,K.sibling),he=g(K,ne),he.return=J,J=he):(a(J,K),he=xf(ne,J.mode,he),he.return=J,J=he),S(J)):a(J,K)}return function(J,K,ne,he){try{ql=0;var Ie=gt(J,K,ne,he);return co=null,Ie}catch(De){if(De===uo||De===qc)throw De;var it=Hn(29,De,null,J.mode);return it.lanes=he,it.return=J,it}}}var ba=a_(!0),o_=a_(!1),ss=!1;function Pf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Vf(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function as(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function os(r,i,a){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(ot&2)!==0){var g=u.pending;return g===null?i.next=i:(i.next=g.next,g.next=i),u.pending=i,i=Vc(r),Hy(r,null,a),i}return Pc(r,u,i,a),Vc(r)}function Gl(r,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194048)!==0)){var u=i.lanes;u&=r.pendingLanes,a|=u,i.lanes=a,_l(r,a)}}function Lf(r,i){var a=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var g=null,y=null;if(a=a.firstBaseUpdate,a!==null){do{var S={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};y===null?g=y=S:y=y.next=S,a=a.next}while(a!==null);y===null?g=y=i:y=y.next=i}else g=y=i;a={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},r.updateQueue=a;return}r=a.lastBaseUpdate,r===null?a.firstBaseUpdate=i:r.next=i,a.lastBaseUpdate=i}var Uf=!1;function Ql(){if(Uf){var r=lo;if(r!==null)throw r}}function Kl(r,i,a,u){Uf=!1;var g=r.updateQueue;ss=!1;var y=g.firstBaseUpdate,S=g.lastBaseUpdate,M=g.shared.pending;if(M!==null){g.shared.pending=null;var G=M,re=G.next;G.next=null,S===null?y=re:S.next=re,S=G;var ue=r.alternate;ue!==null&&(ue=ue.updateQueue,M=ue.lastBaseUpdate,M!==S&&(M===null?ue.firstBaseUpdate=re:M.next=re,ue.lastBaseUpdate=G))}if(y!==null){var me=g.baseState;S=0,ue=re=G=null,M=y;do{var ie=M.lane&-536870913,le=ie!==M.lane;if(le?(We&ie)===ie:(u&ie)===ie){ie!==0&&ie===oo&&(Uf=!0),ue!==null&&(ue=ue.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var Ce=r,je=M;ie=i;var gt=a;switch(je.tag){case 1:if(Ce=je.payload,typeof Ce=="function"){me=Ce.call(gt,me,ie);break e}me=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=je.payload,ie=typeof Ce=="function"?Ce.call(gt,me,ie):Ce,ie==null)break e;me=v({},me,ie);break e;case 2:ss=!0}}ie=M.callback,ie!==null&&(r.flags|=64,le&&(r.flags|=8192),le=g.callbacks,le===null?g.callbacks=[ie]:le.push(ie))}else le={lane:ie,tag:M.tag,payload:M.payload,callback:M.callback,next:null},ue===null?(re=ue=le,G=me):ue=ue.next=le,S|=ie;if(M=M.next,M===null){if(M=g.shared.pending,M===null)break;le=M,M=le.next,le.next=null,g.lastBaseUpdate=le,g.shared.pending=null}}while(!0);ue===null&&(G=me),g.baseState=G,g.firstBaseUpdate=re,g.lastBaseUpdate=ue,y===null&&(g.shared.lanes=0),hs|=S,r.lanes=S,r.memoizedState=me}}function l_(r,i){if(typeof r!="function")throw Error(s(191,r));r.call(i)}function u_(r,i){var a=r.callbacks;if(a!==null)for(r.callbacks=null,r=0;r<a.length;r++)l_(a[r],i)}var ho=U(null),Kc=U(0);function c_(r,i){r=Ai,be(Kc,r),be(ho,i),Ai=r|i.baseLanes}function zf(){be(Kc,Ai),be(ho,ho.current)}function Bf(){Ai=Kc.current,te(ho),te(Kc)}var Gn=U(null),ur=null;function ls(r){var i=r.alternate;be(Nt,Nt.current&1),be(Gn,r),ur===null&&(i===null||ho.current!==null||i.memoizedState!==null)&&(ur=r)}function Ff(r){be(Nt,Nt.current),be(Gn,r),ur===null&&(ur=r)}function d_(r){r.tag===22?(be(Nt,Nt.current),be(Gn,r),ur===null&&(ur=r)):us()}function us(){be(Nt,Nt.current),be(Gn,Gn.current)}function Qn(r){te(Gn),ur===r&&(ur=null),te(Nt)}var Nt=U(0);function $c(r){for(var i=r;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||$m(a)||Ym(a)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var _i=0,Fe=null,mt=null,Ht=null,Yc=!1,fo=!1,Ea=!1,Wc=0,$l=0,mo=null,HT=0;function Ot(){throw Error(s(321))}function qf(r,i){if(i===null)return!1;for(var a=0;a<i.length&&a<r.length;a++)if(!qn(r[a],i[a]))return!1;return!0}function Hf(r,i,a,u,g,y){return _i=y,Fe=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,L.H=r===null||r.memoizedState===null?$_:sm,Ea=!1,y=a(u,g),Ea=!1,fo&&(y=f_(i,a,u,g)),h_(r),y}function h_(r){L.H=Xl;var i=mt!==null&&mt.next!==null;if(_i=0,Ht=mt=Fe=null,Yc=!1,$l=0,mo=null,i)throw Error(s(300));r===null||Gt||(r=r.dependencies,r!==null&&zc(r)&&(Gt=!0))}function f_(r,i,a,u){Fe=r;var g=0;do{if(fo&&(mo=null),$l=0,fo=!1,25<=g)throw Error(s(301));if(g+=1,Ht=mt=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}L.H=Y_,y=i(a,u)}while(fo);return y}function GT(){var r=L.H,i=r.useState()[0];return i=typeof i.then=="function"?Yl(i):i,r=r.useState()[0],(mt!==null?mt.memoizedState:null)!==r&&(Fe.flags|=1024),i}function Gf(){var r=Wc!==0;return Wc=0,r}function Qf(r,i,a){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~a}function Kf(r){if(Yc){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Yc=!1}_i=0,Ht=mt=Fe=null,fo=!1,$l=Wc=0,mo=null}function Dn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?Fe.memoizedState=Ht=r:Ht=Ht.next=r,Ht}function Pt(){if(mt===null){var r=Fe.alternate;r=r!==null?r.memoizedState:null}else r=mt.next;var i=Ht===null?Fe.memoizedState:Ht.next;if(i!==null)Ht=i,mt=r;else{if(r===null)throw Fe.alternate===null?Error(s(467)):Error(s(310));mt=r,r={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},Ht===null?Fe.memoizedState=Ht=r:Ht=Ht.next=r}return Ht}function Xc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yl(r){var i=$l;return $l+=1,mo===null&&(mo=[]),r=r_(mo,r,i),i=Fe,(Ht===null?i.memoizedState:Ht.next)===null&&(i=i.alternate,L.H=i===null||i.memoizedState===null?$_:sm),r}function Jc(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Yl(r);if(r.$$typeof===B)return dn(r)}throw Error(s(438,String(r)))}function $f(r){var i=null,a=Fe.updateQueue;if(a!==null&&(i=a.memoCache),i==null){var u=Fe.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(g){return g.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),a===null&&(a=Xc(),Fe.updateQueue=a),a.memoCache=i,a=i.data[i.index],a===void 0)for(a=i.data[i.index]=Array(r),u=0;u<r;u++)a[u]=k;return i.index++,a}function vi(r,i){return typeof i=="function"?i(r):i}function Zc(r){var i=Pt();return Yf(i,mt,r)}function Yf(r,i,a){var u=r.queue;if(u===null)throw Error(s(311));u.lastRenderedReducer=a;var g=r.baseQueue,y=u.pending;if(y!==null){if(g!==null){var S=g.next;g.next=y.next,y.next=S}i.baseQueue=g=y,u.pending=null}if(y=r.baseState,g===null)r.memoizedState=y;else{i=g.next;var M=S=null,G=null,re=i,ue=!1;do{var me=re.lane&-536870913;if(me!==re.lane?(We&me)===me:(_i&me)===me){var ie=re.revertLane;if(ie===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),me===oo&&(ue=!0);else if((_i&ie)===ie){re=re.next,ie===oo&&(ue=!0);continue}else me={lane:0,revertLane:re.revertLane,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},G===null?(M=G=me,S=y):G=G.next=me,Fe.lanes|=ie,hs|=ie;me=re.action,Ea&&a(y,me),y=re.hasEagerState?re.eagerState:a(y,me)}else ie={lane:me,revertLane:re.revertLane,gesture:re.gesture,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},G===null?(M=G=ie,S=y):G=G.next=ie,Fe.lanes|=me,hs|=me;re=re.next}while(re!==null&&re!==i);if(G===null?S=y:G.next=M,!qn(y,r.memoizedState)&&(Gt=!0,ue&&(a=lo,a!==null)))throw a;r.memoizedState=y,r.baseState=S,r.baseQueue=G,u.lastRenderedState=y}return g===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function Wf(r){var i=Pt(),a=i.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=r;var u=a.dispatch,g=a.pending,y=i.memoizedState;if(g!==null){a.pending=null;var S=g=g.next;do y=r(y,S.action),S=S.next;while(S!==g);qn(y,i.memoizedState)||(Gt=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),a.lastRenderedState=y}return[y,u]}function m_(r,i,a){var u=Fe,g=Pt(),y=tt;if(y){if(a===void 0)throw Error(s(407));a=a()}else a=i();var S=!qn((mt||g).memoizedState,a);if(S&&(g.memoizedState=a,Gt=!0),g=g.queue,Zf(y_.bind(null,u,g,r),[r]),g.getSnapshot!==i||S||Ht!==null&&Ht.memoizedState.tag&1){if(u.flags|=2048,po(9,{destroy:void 0},g_.bind(null,u,g,a,i),null),_t===null)throw Error(s(349));y||(_i&127)!==0||p_(u,i,a)}return a}function p_(r,i,a){r.flags|=16384,r={getSnapshot:i,value:a},i=Fe.updateQueue,i===null?(i=Xc(),Fe.updateQueue=i,i.stores=[r]):(a=i.stores,a===null?i.stores=[r]:a.push(r))}function g_(r,i,a,u){i.value=a,i.getSnapshot=u,__(i)&&v_(r)}function y_(r,i,a){return a(function(){__(i)&&v_(r)})}function __(r){var i=r.getSnapshot;r=r.value;try{var a=i();return!qn(r,a)}catch{return!0}}function v_(r){var i=ha(r,2);i!==null&&Pn(i,r,2)}function Xf(r){var i=Dn();if(typeof r=="function"){var a=r;if(r=a(),Ea){Zn(!0);try{a()}finally{Zn(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vi,lastRenderedState:r},i}function b_(r,i,a,u){return r.baseState=a,Yf(r,mt,typeof u=="function"?u:vi)}function QT(r,i,a,u,g){if(nd(r))throw Error(s(485));if(r=i.action,r!==null){var y={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){y.listeners.push(S)}};L.T!==null?a(!0):y.isTransition=!1,u(y),a=i.pending,a===null?(y.next=i.pending=y,E_(i,y)):(y.next=a.next,i.pending=a.next=y)}}function E_(r,i){var a=i.action,u=i.payload,g=r.state;if(i.isTransition){var y=L.T,S={};L.T=S;try{var M=a(g,u),G=L.S;G!==null&&G(S,M),S_(r,i,M)}catch(re){Jf(r,i,re)}finally{y!==null&&S.types!==null&&(y.types=S.types),L.T=y}}else try{y=a(g,u),S_(r,i,y)}catch(re){Jf(r,i,re)}}function S_(r,i,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(u){x_(r,i,u)},function(u){return Jf(r,i,u)}):x_(r,i,a)}function x_(r,i,a){i.status="fulfilled",i.value=a,w_(i),r.state=a,i=r.pending,i!==null&&(a=i.next,a===i?r.pending=null:(a=a.next,i.next=a,E_(r,a)))}function Jf(r,i,a){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=a,w_(i),i=i.next;while(i!==u)}r.action=null}function w_(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function T_(r,i){return i}function A_(r,i){if(tt){var a=_t.formState;if(a!==null){e:{var u=Fe;if(tt){if(St){t:{for(var g=St,y=lr;g.nodeType!==8;){if(!y){g=null;break t}if(g=cr(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){St=cr(g.nextSibling),u=g.data==="F!";break e}}rs(u)}u=!1}u&&(i=a[0])}}return a=Dn(),a.memoizedState=a.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:T_,lastRenderedState:i},a.queue=u,a=G_.bind(null,Fe,u),u.dispatch=a,u=Xf(!1),y=im.bind(null,Fe,!1,u.queue),u=Dn(),g={state:i,dispatch:null,action:r,pending:null},u.queue=g,a=QT.bind(null,Fe,g,y,a),g.dispatch=a,u.memoizedState=r,[i,a,!1]}function C_(r){var i=Pt();return R_(i,mt,r)}function R_(r,i,a){if(i=Yf(r,i,T_)[0],r=Zc(vi)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Yl(i)}catch(S){throw S===uo?qc:S}else u=i;i=Pt();var g=i.queue,y=g.dispatch;return a!==i.memoizedState&&(Fe.flags|=2048,po(9,{destroy:void 0},KT.bind(null,g,a),null)),[u,y,r]}function KT(r,i){r.action=i}function D_(r){var i=Pt(),a=mt;if(a!==null)return R_(i,a,r);Pt(),i=i.memoizedState,a=Pt();var u=a.queue.dispatch;return a.memoizedState=r,[i,u,!1]}function po(r,i,a,u){return r={tag:r,create:a,deps:u,inst:i,next:null},i=Fe.updateQueue,i===null&&(i=Xc(),Fe.updateQueue=i),a=i.lastEffect,a===null?i.lastEffect=r.next=r:(u=a.next,a.next=r,r.next=u,i.lastEffect=r),r}function I_(){return Pt().memoizedState}function ed(r,i,a,u){var g=Dn();Fe.flags|=r,g.memoizedState=po(1|i,{destroy:void 0},a,u===void 0?null:u)}function td(r,i,a,u){var g=Pt();u=u===void 0?null:u;var y=g.memoizedState.inst;mt!==null&&u!==null&&qf(u,mt.memoizedState.deps)?g.memoizedState=po(i,y,a,u):(Fe.flags|=r,g.memoizedState=po(1|i,y,a,u))}function O_(r,i){ed(8390656,8,r,i)}function Zf(r,i){td(2048,8,r,i)}function $T(r){Fe.flags|=4;var i=Fe.updateQueue;if(i===null)i=Xc(),Fe.updateQueue=i,i.events=[r];else{var a=i.events;a===null?i.events=[r]:a.push(r)}}function j_(r){var i=Pt().memoizedState;return $T({ref:i,nextImpl:r}),function(){if((ot&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function M_(r,i){return td(4,2,r,i)}function k_(r,i){return td(4,4,r,i)}function N_(r,i){if(typeof i=="function"){r=r();var a=i(r);return function(){typeof a=="function"?a():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function P_(r,i,a){a=a!=null?a.concat([r]):null,td(4,4,N_.bind(null,i,r),a)}function em(){}function V_(r,i){var a=Pt();i=i===void 0?null:i;var u=a.memoizedState;return i!==null&&qf(i,u[1])?u[0]:(a.memoizedState=[r,i],r)}function L_(r,i){var a=Pt();i=i===void 0?null:i;var u=a.memoizedState;if(i!==null&&qf(i,u[1]))return u[0];if(u=r(),Ea){Zn(!0);try{r()}finally{Zn(!1)}}return a.memoizedState=[u,i],u}function tm(r,i,a){return a===void 0||(_i&1073741824)!==0&&(We&261930)===0?r.memoizedState=i:(r.memoizedState=a,r=U0(),Fe.lanes|=r,hs|=r,a)}function U_(r,i,a,u){return qn(a,i)?a:ho.current!==null?(r=tm(r,a,u),qn(r,i)||(Gt=!0),r):(_i&42)===0||(_i&1073741824)!==0&&(We&261930)===0?(Gt=!0,r.memoizedState=a):(r=U0(),Fe.lanes|=r,hs|=r,i)}function z_(r,i,a,u,g){var y=H.p;H.p=y!==0&&8>y?y:8;var S=L.T,M={};L.T=M,im(r,!1,i,a);try{var G=g(),re=L.S;if(re!==null&&re(M,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var ue=qT(G,u);Wl(r,i,ue,Yn(r))}else Wl(r,i,u,Yn(r))}catch(me){Wl(r,i,{then:function(){},status:"rejected",reason:me},Yn())}finally{H.p=y,S!==null&&M.types!==null&&(S.types=M.types),L.T=S}}function YT(){}function nm(r,i,a,u){if(r.tag!==5)throw Error(s(476));var g=B_(r).queue;z_(r,g,i,Q,a===null?YT:function(){return F_(r),a(u)})}function B_(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vi,lastRenderedState:Q},next:null};var a={};return i.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vi,lastRenderedState:a},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function F_(r){var i=B_(r);i.next===null&&(i=r.alternate.memoizedState),Wl(r,i.next.queue,{},Yn())}function rm(){return dn(fu)}function q_(){return Pt().memoizedState}function H_(){return Pt().memoizedState}function WT(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var a=Yn();r=as(a);var u=os(i,r,a);u!==null&&(Pn(u,i,a),Gl(u,i,a)),i={cache:jf()},r.payload=i;return}i=i.return}}function XT(r,i,a){var u=Yn();a={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},nd(r)?Q_(i,a):(a=Ef(r,i,a,u),a!==null&&(Pn(a,r,u),K_(a,i,u)))}function G_(r,i,a){var u=Yn();Wl(r,i,a,u)}function Wl(r,i,a,u){var g={lane:u,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(nd(r))Q_(i,g);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var S=i.lastRenderedState,M=y(S,a);if(g.hasEagerState=!0,g.eagerState=M,qn(M,S))return Pc(r,i,g,0),_t===null&&Nc(),!1}catch{}if(a=Ef(r,i,g,u),a!==null)return Pn(a,r,u),K_(a,i,u),!0}return!1}function im(r,i,a,u){if(u={lane:2,revertLane:Pm(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},nd(r)){if(i)throw Error(s(479))}else i=Ef(r,a,u,2),i!==null&&Pn(i,r,2)}function nd(r){var i=r.alternate;return r===Fe||i!==null&&i===Fe}function Q_(r,i){fo=Yc=!0;var a=r.pending;a===null?i.next=i:(i.next=a.next,a.next=i),r.pending=i}function K_(r,i,a){if((a&4194048)!==0){var u=i.lanes;u&=r.pendingLanes,a|=u,i.lanes=a,_l(r,a)}}var Xl={readContext:dn,use:Jc,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useLayoutEffect:Ot,useInsertionEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useSyncExternalStore:Ot,useId:Ot,useHostTransitionStatus:Ot,useFormState:Ot,useActionState:Ot,useOptimistic:Ot,useMemoCache:Ot,useCacheRefresh:Ot};Xl.useEffectEvent=Ot;var $_={readContext:dn,use:Jc,useCallback:function(r,i){return Dn().memoizedState=[r,i===void 0?null:i],r},useContext:dn,useEffect:O_,useImperativeHandle:function(r,i,a){a=a!=null?a.concat([r]):null,ed(4194308,4,N_.bind(null,i,r),a)},useLayoutEffect:function(r,i){return ed(4194308,4,r,i)},useInsertionEffect:function(r,i){ed(4,2,r,i)},useMemo:function(r,i){var a=Dn();i=i===void 0?null:i;var u=r();if(Ea){Zn(!0);try{r()}finally{Zn(!1)}}return a.memoizedState=[u,i],u},useReducer:function(r,i,a){var u=Dn();if(a!==void 0){var g=a(i);if(Ea){Zn(!0);try{a(i)}finally{Zn(!1)}}}else g=i;return u.memoizedState=u.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},u.queue=r,r=r.dispatch=XT.bind(null,Fe,r),[u.memoizedState,r]},useRef:function(r){var i=Dn();return r={current:r},i.memoizedState=r},useState:function(r){r=Xf(r);var i=r.queue,a=G_.bind(null,Fe,i);return i.dispatch=a,[r.memoizedState,a]},useDebugValue:em,useDeferredValue:function(r,i){var a=Dn();return tm(a,r,i)},useTransition:function(){var r=Xf(!1);return r=z_.bind(null,Fe,r.queue,!0,!1),Dn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,a){var u=Fe,g=Dn();if(tt){if(a===void 0)throw Error(s(407));a=a()}else{if(a=i(),_t===null)throw Error(s(349));(We&127)!==0||p_(u,i,a)}g.memoizedState=a;var y={value:a,getSnapshot:i};return g.queue=y,O_(y_.bind(null,u,y,r),[r]),u.flags|=2048,po(9,{destroy:void 0},g_.bind(null,u,y,a,i),null),a},useId:function(){var r=Dn(),i=_t.identifierPrefix;if(tt){var a=Xr,u=Wr;a=(u&~(1<<32-Mt(u)-1)).toString(32)+a,i="_"+i+"R_"+a,a=Wc++,0<a&&(i+="H"+a.toString(32)),i+="_"}else a=HT++,i="_"+i+"r_"+a.toString(32)+"_";return r.memoizedState=i},useHostTransitionStatus:rm,useFormState:A_,useActionState:A_,useOptimistic:function(r){var i=Dn();i.memoizedState=i.baseState=r;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=a,i=im.bind(null,Fe,!0,a),a.dispatch=i,[r,i]},useMemoCache:$f,useCacheRefresh:function(){return Dn().memoizedState=WT.bind(null,Fe)},useEffectEvent:function(r){var i=Dn(),a={impl:r};return i.memoizedState=a,function(){if((ot&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},sm={readContext:dn,use:Jc,useCallback:V_,useContext:dn,useEffect:Zf,useImperativeHandle:P_,useInsertionEffect:M_,useLayoutEffect:k_,useMemo:L_,useReducer:Zc,useRef:I_,useState:function(){return Zc(vi)},useDebugValue:em,useDeferredValue:function(r,i){var a=Pt();return U_(a,mt.memoizedState,r,i)},useTransition:function(){var r=Zc(vi)[0],i=Pt().memoizedState;return[typeof r=="boolean"?r:Yl(r),i]},useSyncExternalStore:m_,useId:q_,useHostTransitionStatus:rm,useFormState:C_,useActionState:C_,useOptimistic:function(r,i){var a=Pt();return b_(a,mt,r,i)},useMemoCache:$f,useCacheRefresh:H_};sm.useEffectEvent=j_;var Y_={readContext:dn,use:Jc,useCallback:V_,useContext:dn,useEffect:Zf,useImperativeHandle:P_,useInsertionEffect:M_,useLayoutEffect:k_,useMemo:L_,useReducer:Wf,useRef:I_,useState:function(){return Wf(vi)},useDebugValue:em,useDeferredValue:function(r,i){var a=Pt();return mt===null?tm(a,r,i):U_(a,mt.memoizedState,r,i)},useTransition:function(){var r=Wf(vi)[0],i=Pt().memoizedState;return[typeof r=="boolean"?r:Yl(r),i]},useSyncExternalStore:m_,useId:q_,useHostTransitionStatus:rm,useFormState:D_,useActionState:D_,useOptimistic:function(r,i){var a=Pt();return mt!==null?b_(a,mt,r,i):(a.baseState=r,[r,a.queue.dispatch])},useMemoCache:$f,useCacheRefresh:H_};Y_.useEffectEvent=j_;function am(r,i,a,u){i=r.memoizedState,a=a(u,i),a=a==null?i:v({},i,a),r.memoizedState=a,r.lanes===0&&(r.updateQueue.baseState=a)}var om={enqueueSetState:function(r,i,a){r=r._reactInternals;var u=Yn(),g=as(u);g.payload=i,a!=null&&(g.callback=a),i=os(r,g,u),i!==null&&(Pn(i,r,u),Gl(i,r,u))},enqueueReplaceState:function(r,i,a){r=r._reactInternals;var u=Yn(),g=as(u);g.tag=1,g.payload=i,a!=null&&(g.callback=a),i=os(r,g,u),i!==null&&(Pn(i,r,u),Gl(i,r,u))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var a=Yn(),u=as(a);u.tag=2,i!=null&&(u.callback=i),i=os(r,u,a),i!==null&&(Pn(i,r,a),Gl(i,r,a))}};function W_(r,i,a,u,g,y,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,y,S):i.prototype&&i.prototype.isPureReactComponent?!Vl(a,u)||!Vl(g,y):!0}function X_(r,i,a,u){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,u),i.state!==r&&om.enqueueReplaceState(i,i.state,null)}function Sa(r,i){var a=i;if("ref"in i){a={};for(var u in i)u!=="ref"&&(a[u]=i[u])}if(r=r.defaultProps){a===i&&(a=v({},a));for(var g in r)a[g]===void 0&&(a[g]=r[g])}return a}function J_(r){kc(r)}function Z_(r){console.error(r)}function e0(r){kc(r)}function rd(r,i){try{var a=r.onUncaughtError;a(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function t0(r,i,a){try{var u=r.onCaughtError;u(a.value,{componentStack:a.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function lm(r,i,a){return a=as(a),a.tag=3,a.payload={element:null},a.callback=function(){rd(r,i)},a}function n0(r){return r=as(r),r.tag=3,r}function r0(r,i,a,u){var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;r.payload=function(){return g(y)},r.callback=function(){t0(i,a,u)}}var S=a.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){t0(i,a,u),typeof g!="function"&&(fs===null?fs=new Set([this]):fs.add(this));var M=u.stack;this.componentDidCatch(u.value,{componentStack:M!==null?M:""})})}function JT(r,i,a,u,g){if(a.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=a.alternate,i!==null&&ao(i,a,g,!0),a=Gn.current,a!==null){switch(a.tag){case 31:case 13:return ur===null?pd():a.alternate===null&&jt===0&&(jt=3),a.flags&=-257,a.flags|=65536,a.lanes=g,u===Hc?a.flags|=16384:(i=a.updateQueue,i===null?a.updateQueue=new Set([u]):i.add(u),Mm(r,u,g)),!1;case 22:return a.flags|=65536,u===Hc?a.flags|=16384:(i=a.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},a.updateQueue=i):(a=i.retryQueue,a===null?i.retryQueue=new Set([u]):a.add(u)),Mm(r,u,g)),!1}throw Error(s(435,a.tag))}return Mm(r,u,g),pd(),!1}if(tt)return i=Gn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=g,u!==Cf&&(r=Error(s(422),{cause:u}),zl(sr(r,a)))):(u!==Cf&&(i=Error(s(423),{cause:u}),zl(sr(i,a))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,u=sr(u,a),g=lm(r.stateNode,u,g),Lf(r,g),jt!==4&&(jt=2)),!1;var y=Error(s(520),{cause:u});if(y=sr(y,a),su===null?su=[y]:su.push(y),jt!==4&&(jt=2),i===null)return!0;u=sr(u,a),a=i;do{switch(a.tag){case 3:return a.flags|=65536,r=g&-g,a.lanes|=r,r=lm(a.stateNode,u,r),Lf(a,r),!1;case 1:if(i=a.type,y=a.stateNode,(a.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(fs===null||!fs.has(y))))return a.flags|=65536,g&=-g,a.lanes|=g,g=n0(g),r0(g,r,a,u),Lf(a,g),!1}a=a.return}while(a!==null);return!1}var um=Error(s(461)),Gt=!1;function hn(r,i,a,u){i.child=r===null?o_(i,null,a,u):ba(i,r.child,a,u)}function i0(r,i,a,u,g){a=a.render;var y=i.ref;if("ref"in u){var S={};for(var M in u)M!=="ref"&&(S[M]=u[M])}else S=u;return ga(i),u=Hf(r,i,a,S,y,g),M=Gf(),r!==null&&!Gt?(Qf(r,i,g),bi(r,i,g)):(tt&&M&&Tf(i),i.flags|=1,hn(r,i,u,g),i.child)}function s0(r,i,a,u,g){if(r===null){var y=a.type;return typeof y=="function"&&!Sf(y)&&y.defaultProps===void 0&&a.compare===null?(i.tag=15,i.type=y,a0(r,i,y,u,g)):(r=Lc(a.type,null,u,i,i.mode,g),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,!ym(r,g)){var S=y.memoizedProps;if(a=a.compare,a=a!==null?a:Vl,a(S,u)&&r.ref===i.ref)return bi(r,i,g)}return i.flags|=1,r=mi(y,u),r.ref=i.ref,r.return=i,i.child=r}function a0(r,i,a,u,g){if(r!==null){var y=r.memoizedProps;if(Vl(y,u)&&r.ref===i.ref)if(Gt=!1,i.pendingProps=u=y,ym(r,g))(r.flags&131072)!==0&&(Gt=!0);else return i.lanes=r.lanes,bi(r,i,g)}return cm(r,i,a,u,g)}function o0(r,i,a,u){var g=u.children,y=r!==null?r.memoizedState:null;if(r===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((i.flags&128)!==0){if(y=y!==null?y.baseLanes|a:a,r!==null){for(u=i.child=r.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~y}else u=0,i.child=null;return l0(r,i,y,a,u)}if((a&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&Fc(i,y!==null?y.cachePool:null),y!==null?c_(i,y):zf(),d_(i);else return u=i.lanes=536870912,l0(r,i,y!==null?y.baseLanes|a:a,a,u)}else y!==null?(Fc(i,y.cachePool),c_(i,y),us(),i.memoizedState=null):(r!==null&&Fc(i,null),zf(),us());return hn(r,i,g,a),i.child}function Jl(r,i){return r!==null&&r.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function l0(r,i,a,u,g){var y=kf();return y=y===null?null:{parent:qt._currentValue,pool:y},i.memoizedState={baseLanes:a,cachePool:y},r!==null&&Fc(i,null),zf(),d_(i),r!==null&&ao(r,i,u,!0),i.childLanes=g,null}function id(r,i){return i=ad({mode:i.mode,children:i.children},r.mode),i.ref=r.ref,r.child=i,i.return=r,i}function u0(r,i,a){return ba(i,r.child,null,a),r=id(i,i.pendingProps),r.flags|=2,Qn(i),i.memoizedState=null,r}function ZT(r,i,a){var u=i.pendingProps,g=(i.flags&128)!==0;if(i.flags&=-129,r===null){if(tt){if(u.mode==="hidden")return r=id(i,u),i.lanes=536870912,Jl(null,r);if(Ff(i),(r=St)?(r=Ev(r,lr),r=r!==null&&r.data==="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:ts!==null?{id:Wr,overflow:Xr}:null,retryLane:536870912,hydrationErrors:null},a=Qy(r),a.return=i,i.child=a,cn=i,St=null)):r=null,r===null)throw rs(i);return i.lanes=536870912,null}return id(i,u)}var y=r.memoizedState;if(y!==null){var S=y.dehydrated;if(Ff(i),g)if(i.flags&256)i.flags&=-257,i=u0(r,i,a);else if(i.memoizedState!==null)i.child=r.child,i.flags|=128,i=null;else throw Error(s(558));else if(Gt||ao(r,i,a,!1),g=(a&r.childLanes)!==0,Gt||g){if(u=_t,u!==null&&(S=vl(u,a),S!==0&&S!==y.retryLane))throw y.retryLane=S,ha(r,S),Pn(u,r,S),um;pd(),i=u0(r,i,a)}else r=y.treeContext,St=cr(S.nextSibling),cn=i,tt=!0,ns=null,lr=!1,r!==null&&Yy(i,r),i=id(i,u),i.flags|=4096;return i}return r=mi(r.child,{mode:u.mode,children:u.children}),r.ref=i.ref,i.child=r,r.return=i,r}function sd(r,i){var a=i.ref;if(a===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(r===null||r.ref!==a)&&(i.flags|=4194816)}}function cm(r,i,a,u,g){return ga(i),a=Hf(r,i,a,u,void 0,g),u=Gf(),r!==null&&!Gt?(Qf(r,i,g),bi(r,i,g)):(tt&&u&&Tf(i),i.flags|=1,hn(r,i,a,g),i.child)}function c0(r,i,a,u,g,y){return ga(i),i.updateQueue=null,a=f_(i,u,a,g),h_(r),u=Gf(),r!==null&&!Gt?(Qf(r,i,y),bi(r,i,y)):(tt&&u&&Tf(i),i.flags|=1,hn(r,i,a,y),i.child)}function d0(r,i,a,u,g){if(ga(i),i.stateNode===null){var y=no,S=a.contextType;typeof S=="object"&&S!==null&&(y=dn(S)),y=new a(u,y),i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=om,i.stateNode=y,y._reactInternals=i,y=i.stateNode,y.props=u,y.state=i.memoizedState,y.refs={},Pf(i),S=a.contextType,y.context=typeof S=="object"&&S!==null?dn(S):no,y.state=i.memoizedState,S=a.getDerivedStateFromProps,typeof S=="function"&&(am(i,a,S,u),y.state=i.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(S=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),S!==y.state&&om.enqueueReplaceState(y,y.state,null),Kl(i,u,y,g),Ql(),y.state=i.memoizedState),typeof y.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(r===null){y=i.stateNode;var M=i.memoizedProps,G=Sa(a,M);y.props=G;var re=y.context,ue=a.contextType;S=no,typeof ue=="object"&&ue!==null&&(S=dn(ue));var me=a.getDerivedStateFromProps;ue=typeof me=="function"||typeof y.getSnapshotBeforeUpdate=="function",M=i.pendingProps!==M,ue||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(M||re!==S)&&X_(i,y,u,S),ss=!1;var ie=i.memoizedState;y.state=ie,Kl(i,u,y,g),Ql(),re=i.memoizedState,M||ie!==re||ss?(typeof me=="function"&&(am(i,a,me,u),re=i.memoizedState),(G=ss||W_(i,a,G,u,ie,re,S))?(ue||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(i.flags|=4194308)):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=re),y.props=u,y.state=re,y.context=S,u=G):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{y=i.stateNode,Vf(r,i),S=i.memoizedProps,ue=Sa(a,S),y.props=ue,me=i.pendingProps,ie=y.context,re=a.contextType,G=no,typeof re=="object"&&re!==null&&(G=dn(re)),M=a.getDerivedStateFromProps,(re=typeof M=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S!==me||ie!==G)&&X_(i,y,u,G),ss=!1,ie=i.memoizedState,y.state=ie,Kl(i,u,y,g),Ql();var le=i.memoizedState;S!==me||ie!==le||ss||r!==null&&r.dependencies!==null&&zc(r.dependencies)?(typeof M=="function"&&(am(i,a,M,u),le=i.memoizedState),(ue=ss||W_(i,a,ue,u,ie,le,G)||r!==null&&r.dependencies!==null&&zc(r.dependencies))?(re||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,le,G),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,le,G)),typeof y.componentDidUpdate=="function"&&(i.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof y.componentDidUpdate!="function"||S===r.memoizedProps&&ie===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&ie===r.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=le),y.props=u,y.state=le,y.context=G,u=ue):(typeof y.componentDidUpdate!="function"||S===r.memoizedProps&&ie===r.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&ie===r.memoizedState||(i.flags|=1024),u=!1)}return y=u,sd(r,i),u=(i.flags&128)!==0,y||u?(y=i.stateNode,a=u&&typeof a.getDerivedStateFromError!="function"?null:y.render(),i.flags|=1,r!==null&&u?(i.child=ba(i,r.child,null,g),i.child=ba(i,null,a,g)):hn(r,i,a,g),i.memoizedState=y.state,r=i.child):r=bi(r,i,g),r}function h0(r,i,a,u){return ma(),i.flags|=256,hn(r,i,a,u),i.child}var dm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hm(r){return{baseLanes:r,cachePool:t_()}}function fm(r,i,a){return r=r!==null?r.childLanes&~a:0,i&&(r|=$n),r}function f0(r,i,a){var u=i.pendingProps,g=!1,y=(i.flags&128)!==0,S;if((S=y)||(S=r!==null&&r.memoizedState===null?!1:(Nt.current&2)!==0),S&&(g=!0,i.flags&=-129),S=(i.flags&32)!==0,i.flags&=-33,r===null){if(tt){if(g?ls(i):us(),(r=St)?(r=Ev(r,lr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:ts!==null?{id:Wr,overflow:Xr}:null,retryLane:536870912,hydrationErrors:null},a=Qy(r),a.return=i,i.child=a,cn=i,St=null)):r=null,r===null)throw rs(i);return Ym(r)?i.lanes=32:i.lanes=536870912,null}var M=u.children;return u=u.fallback,g?(us(),g=i.mode,M=ad({mode:"hidden",children:M},g),u=fa(u,g,a,null),M.return=i,u.return=i,M.sibling=u,i.child=M,u=i.child,u.memoizedState=hm(a),u.childLanes=fm(r,S,a),i.memoizedState=dm,Jl(null,u)):(ls(i),mm(i,M))}var G=r.memoizedState;if(G!==null&&(M=G.dehydrated,M!==null)){if(y)i.flags&256?(ls(i),i.flags&=-257,i=pm(r,i,a)):i.memoizedState!==null?(us(),i.child=r.child,i.flags|=128,i=null):(us(),M=u.fallback,g=i.mode,u=ad({mode:"visible",children:u.children},g),M=fa(M,g,a,null),M.flags|=2,u.return=i,M.return=i,u.sibling=M,i.child=u,ba(i,r.child,null,a),u=i.child,u.memoizedState=hm(a),u.childLanes=fm(r,S,a),i.memoizedState=dm,i=Jl(null,u));else if(ls(i),Ym(M)){if(S=M.nextSibling&&M.nextSibling.dataset,S)var re=S.dgst;S=re,u=Error(s(419)),u.stack="",u.digest=S,zl({value:u,source:null,stack:null}),i=pm(r,i,a)}else if(Gt||ao(r,i,a,!1),S=(a&r.childLanes)!==0,Gt||S){if(S=_t,S!==null&&(u=vl(S,a),u!==0&&u!==G.retryLane))throw G.retryLane=u,ha(r,u),Pn(S,r,u),um;$m(M)||pd(),i=pm(r,i,a)}else $m(M)?(i.flags|=192,i.child=r.child,i=null):(r=G.treeContext,St=cr(M.nextSibling),cn=i,tt=!0,ns=null,lr=!1,r!==null&&Yy(i,r),i=mm(i,u.children),i.flags|=4096);return i}return g?(us(),M=u.fallback,g=i.mode,G=r.child,re=G.sibling,u=mi(G,{mode:"hidden",children:u.children}),u.subtreeFlags=G.subtreeFlags&65011712,re!==null?M=mi(re,M):(M=fa(M,g,a,null),M.flags|=2),M.return=i,u.return=i,u.sibling=M,i.child=u,Jl(null,u),u=i.child,M=r.child.memoizedState,M===null?M=hm(a):(g=M.cachePool,g!==null?(G=qt._currentValue,g=g.parent!==G?{parent:G,pool:G}:g):g=t_(),M={baseLanes:M.baseLanes|a,cachePool:g}),u.memoizedState=M,u.childLanes=fm(r,S,a),i.memoizedState=dm,Jl(r.child,u)):(ls(i),a=r.child,r=a.sibling,a=mi(a,{mode:"visible",children:u.children}),a.return=i,a.sibling=null,r!==null&&(S=i.deletions,S===null?(i.deletions=[r],i.flags|=16):S.push(r)),i.child=a,i.memoizedState=null,a)}function mm(r,i){return i=ad({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function ad(r,i){return r=Hn(22,r,null,i),r.lanes=0,r}function pm(r,i,a){return ba(i,r.child,null,a),r=mm(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function m0(r,i,a){r.lanes|=i;var u=r.alternate;u!==null&&(u.lanes|=i),If(r.return,i,a)}function gm(r,i,a,u,g,y){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:g,treeForkCount:y}:(S.isBackwards=i,S.rendering=null,S.renderingStartTime=0,S.last=u,S.tail=a,S.tailMode=g,S.treeForkCount=y)}function p0(r,i,a){var u=i.pendingProps,g=u.revealOrder,y=u.tail;u=u.children;var S=Nt.current,M=(S&2)!==0;if(M?(S=S&1|2,i.flags|=128):S&=1,be(Nt,S),hn(r,i,u,a),u=tt?Ul:0,!M&&r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&m0(r,a,i);else if(r.tag===19)m0(r,a,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(g){case"forwards":for(a=i.child,g=null;a!==null;)r=a.alternate,r!==null&&$c(r)===null&&(g=a),a=a.sibling;a=g,a===null?(g=i.child,i.child=null):(g=a.sibling,a.sibling=null),gm(i,!1,g,a,y,u);break;case"backwards":case"unstable_legacy-backwards":for(a=null,g=i.child,i.child=null;g!==null;){if(r=g.alternate,r!==null&&$c(r)===null){i.child=g;break}r=g.sibling,g.sibling=a,a=g,g=r}gm(i,!0,a,null,y,u);break;case"together":gm(i,!1,null,null,void 0,u);break;default:i.memoizedState=null}return i.child}function bi(r,i,a){if(r!==null&&(i.dependencies=r.dependencies),hs|=i.lanes,(a&i.childLanes)===0)if(r!==null){if(ao(r,i,a,!1),(a&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(s(153));if(i.child!==null){for(r=i.child,a=mi(r,r.pendingProps),i.child=a,a.return=i;r.sibling!==null;)r=r.sibling,a=a.sibling=mi(r,r.pendingProps),a.return=i;a.sibling=null}return i.child}function ym(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&zc(r)))}function e1(r,i,a){switch(i.tag){case 3:ge(i,i.stateNode.containerInfo),is(i,qt,r.memoizedState.cache),ma();break;case 27:case 5:Z(i);break;case 4:ge(i,i.stateNode.containerInfo);break;case 10:is(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Ff(i),null;break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(ls(i),i.flags|=128,null):(a&i.child.childLanes)!==0?f0(r,i,a):(ls(i),r=bi(r,i,a),r!==null?r.sibling:null);ls(i);break;case 19:var g=(r.flags&128)!==0;if(u=(a&i.childLanes)!==0,u||(ao(r,i,a,!1),u=(a&i.childLanes)!==0),g){if(u)return p0(r,i,a);i.flags|=128}if(g=i.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),be(Nt,Nt.current),u)break;return null;case 22:return i.lanes=0,o0(r,i,a,i.pendingProps);case 24:is(i,qt,r.memoizedState.cache)}return bi(r,i,a)}function g0(r,i,a){if(r!==null)if(r.memoizedProps!==i.pendingProps)Gt=!0;else{if(!ym(r,a)&&(i.flags&128)===0)return Gt=!1,e1(r,i,a);Gt=(r.flags&131072)!==0}else Gt=!1,tt&&(i.flags&1048576)!==0&&$y(i,Ul,i.index);switch(i.lanes=0,i.tag){case 16:e:{var u=i.pendingProps;if(r=_a(i.elementType),i.type=r,typeof r=="function")Sf(r)?(u=Sa(r,u),i.tag=1,i=d0(null,i,r,u,a)):(i.tag=0,i=cm(null,i,r,u,a));else{if(r!=null){var g=r.$$typeof;if(g===$){i.tag=11,i=i0(null,i,r,u,a);break e}else if(g===C){i.tag=14,i=s0(null,i,r,u,a);break e}}throw i=W(r)||r,Error(s(306,i,""))}}return i;case 0:return cm(r,i,i.type,i.pendingProps,a);case 1:return u=i.type,g=Sa(u,i.pendingProps),d0(r,i,u,g,a);case 3:e:{if(ge(i,i.stateNode.containerInfo),r===null)throw Error(s(387));u=i.pendingProps;var y=i.memoizedState;g=y.element,Vf(r,i),Kl(i,u,null,a);var S=i.memoizedState;if(u=S.cache,is(i,qt,u),u!==y.cache&&Of(i,[qt],a,!0),Ql(),u=S.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:S.cache},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){i=h0(r,i,u,a);break e}else if(u!==g){g=sr(Error(s(424)),i),zl(g),i=h0(r,i,u,a);break e}else for(r=i.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,St=cr(r.firstChild),cn=i,tt=!0,ns=null,lr=!0,a=o_(i,null,u,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(ma(),u===g){i=bi(r,i,a);break e}hn(r,i,u,a)}i=i.child}return i;case 26:return sd(r,i),r===null?(a=Cv(i.type,null,i.pendingProps,null))?i.memoizedState=a:tt||(a=i.type,r=i.pendingProps,u=Sd(Ee.current).createElement(a),u[zt]=i,u[nn]=r,fn(u,a,r),Bt(u),i.stateNode=u):i.memoizedState=Cv(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return Z(i),r===null&&tt&&(u=i.stateNode=wv(i.type,i.pendingProps,Ee.current),cn=i,lr=!0,g=St,ys(i.type)?(Wm=g,St=cr(u.firstChild)):St=g),hn(r,i,i.pendingProps.children,a),sd(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&tt&&((g=u=St)&&(u=I1(u,i.type,i.pendingProps,lr),u!==null?(i.stateNode=u,cn=i,St=cr(u.firstChild),lr=!1,g=!0):g=!1),g||rs(i)),Z(i),g=i.type,y=i.pendingProps,S=r!==null?r.memoizedProps:null,u=y.children,Gm(g,y)?u=null:S!==null&&Gm(g,S)&&(i.flags|=32),i.memoizedState!==null&&(g=Hf(r,i,GT,null,null,a),fu._currentValue=g),sd(r,i),hn(r,i,u,a),i.child;case 6:return r===null&&tt&&((r=a=St)&&(a=O1(a,i.pendingProps,lr),a!==null?(i.stateNode=a,cn=i,St=null,r=!0):r=!1),r||rs(i)),null;case 13:return f0(r,i,a);case 4:return ge(i,i.stateNode.containerInfo),u=i.pendingProps,r===null?i.child=ba(i,null,u,a):hn(r,i,u,a),i.child;case 11:return i0(r,i,i.type,i.pendingProps,a);case 7:return hn(r,i,i.pendingProps,a),i.child;case 8:return hn(r,i,i.pendingProps.children,a),i.child;case 12:return hn(r,i,i.pendingProps.children,a),i.child;case 10:return u=i.pendingProps,is(i,i.type,u.value),hn(r,i,u.children,a),i.child;case 9:return g=i.type._context,u=i.pendingProps.children,ga(i),g=dn(g),u=u(g),i.flags|=1,hn(r,i,u,a),i.child;case 14:return s0(r,i,i.type,i.pendingProps,a);case 15:return a0(r,i,i.type,i.pendingProps,a);case 19:return p0(r,i,a);case 31:return ZT(r,i,a);case 22:return o0(r,i,a,i.pendingProps);case 24:return ga(i),u=dn(qt),r===null?(g=kf(),g===null&&(g=_t,y=jf(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=a),g=y),i.memoizedState={parent:u,cache:g},Pf(i),is(i,qt,g)):((r.lanes&a)!==0&&(Vf(r,i),Kl(i,null,null,a),Ql()),g=r.memoizedState,y=i.memoizedState,g.parent!==u?(g={parent:u,cache:u},i.memoizedState=g,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=g),is(i,qt,u)):(u=y.cache,is(i,qt,u),u!==g.cache&&Of(i,[qt],a,!0))),hn(r,i,i.pendingProps.children,a),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function Ei(r){r.flags|=4}function _m(r,i,a,u,g){if((i=(r.mode&32)!==0)&&(i=!1),i){if(r.flags|=16777216,(g&335544128)===g)if(r.stateNode.complete)r.flags|=8192;else if(q0())r.flags|=8192;else throw va=Hc,Nf}else r.flags&=-16777217}function y0(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!jv(i))if(q0())r.flags|=8192;else throw va=Hc,Nf}function od(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?fc():536870912,r.lanes|=i,vo|=i)}function Zl(r,i){if(!tt)switch(r.tailMode){case"hidden":i=r.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?r.tail=null:a.sibling=null;break;case"collapsed":a=r.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function xt(r){var i=r.alternate!==null&&r.alternate.child===r.child,a=0,u=0;if(i)for(var g=r.child;g!==null;)a|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)a|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=u,r.childLanes=a,i}function t1(r,i,a){var u=i.pendingProps;switch(Af(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(i),null;case 1:return xt(i),null;case 3:return a=i.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),yi(qt),de(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(r===null||r.child===null)&&(so(i)?Ei(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Rf())),xt(i),null;case 26:var g=i.type,y=i.memoizedState;return r===null?(Ei(i),y!==null?(xt(i),y0(i,y)):(xt(i),_m(i,g,null,u,a))):y?y!==r.memoizedState?(Ei(i),xt(i),y0(i,y)):(xt(i),i.flags&=-16777217):(r=r.memoizedProps,r!==u&&Ei(i),xt(i),_m(i,g,r,u,a)),null;case 27:if(Re(i),a=Ee.current,g=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&Ei(i);else{if(!u){if(i.stateNode===null)throw Error(s(166));return xt(i),null}r=_e.current,so(i)?Wy(i):(r=wv(g,u,a),i.stateNode=r,Ei(i))}return xt(i),null;case 5:if(Re(i),g=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&Ei(i);else{if(!u){if(i.stateNode===null)throw Error(s(166));return xt(i),null}if(y=_e.current,so(i))Wy(i);else{var S=Sd(Ee.current);switch(y){case 1:y=S.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=S.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=S.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?S.createElement("select",{is:u.is}):S.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?S.createElement(g,{is:u.is}):S.createElement(g)}}y[zt]=i,y[nn]=u;e:for(S=i.child;S!==null;){if(S.tag===5||S.tag===6)y.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===i)break e;for(;S.sibling===null;){if(S.return===null||S.return===i)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}i.stateNode=y;e:switch(fn(y,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Ei(i)}}return xt(i),_m(i,i.type,r===null?null:r.memoizedProps,i.pendingProps,a),null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==u&&Ei(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(s(166));if(r=Ee.current,so(i)){if(r=i.stateNode,a=i.memoizedProps,u=null,g=cn,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}r[zt]=i,r=!!(r.nodeValue===a||u!==null&&u.suppressHydrationWarning===!0||fv(r.nodeValue,a)),r||rs(i,!0)}else r=Sd(r).createTextNode(u),r[zt]=i,i.stateNode=r}return xt(i),null;case 31:if(a=i.memoizedState,r===null||r.memoizedState!==null){if(u=so(i),a!==null){if(r===null){if(!u)throw Error(s(318));if(r=i.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(557));r[zt]=i}else ma(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;xt(i),r=!1}else a=Rf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=a),r=!0;if(!r)return i.flags&256?(Qn(i),i):(Qn(i),null);if((i.flags&128)!==0)throw Error(s(558))}return xt(i),null;case 13:if(u=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=so(i),u!==null&&u.dehydrated!==null){if(r===null){if(!g)throw Error(s(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[zt]=i}else ma(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;xt(i),g=!1}else g=Rf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return i.flags&256?(Qn(i),i):(Qn(i),null)}return Qn(i),(i.flags&128)!==0?(i.lanes=a,i):(a=u!==null,r=r!==null&&r.memoizedState!==null,a&&(u=i.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==g&&(u.flags|=2048)),a!==r&&a&&(i.child.flags|=8192),od(i,i.updateQueue),xt(i),null);case 4:return de(),r===null&&zm(i.stateNode.containerInfo),xt(i),null;case 10:return yi(i.type),xt(i),null;case 19:if(te(Nt),u=i.memoizedState,u===null)return xt(i),null;if(g=(i.flags&128)!==0,y=u.rendering,y===null)if(g)Zl(u,!1);else{if(jt!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(y=$c(r),y!==null){for(i.flags|=128,Zl(u,!1),r=y.updateQueue,i.updateQueue=r,od(i,r),i.subtreeFlags=0,r=a,a=i.child;a!==null;)Gy(a,r),a=a.sibling;return be(Nt,Nt.current&1|2),tt&&pi(i,u.treeForkCount),i.child}r=r.sibling}u.tail!==null&&Cn()>hd&&(i.flags|=128,g=!0,Zl(u,!1),i.lanes=4194304)}else{if(!g)if(r=$c(y),r!==null){if(i.flags|=128,g=!0,r=r.updateQueue,i.updateQueue=r,od(i,r),Zl(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!tt)return xt(i),null}else 2*Cn()-u.renderingStartTime>hd&&a!==536870912&&(i.flags|=128,g=!0,Zl(u,!1),i.lanes=4194304);u.isBackwards?(y.sibling=i.child,i.child=y):(r=u.last,r!==null?r.sibling=y:i.child=y,u.last=y)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=Cn(),r.sibling=null,a=Nt.current,be(Nt,g?a&1|2:a&1),tt&&pi(i,u.treeForkCount),r):(xt(i),null);case 22:case 23:return Qn(i),Bf(),u=i.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(a&536870912)!==0&&(i.flags&128)===0&&(xt(i),i.subtreeFlags&6&&(i.flags|=8192)):xt(i),a=i.updateQueue,a!==null&&od(i,a.retryQueue),a=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(a=r.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==a&&(i.flags|=2048),r!==null&&te(ya),null;case 24:return a=null,r!==null&&(a=r.memoizedState.cache),i.memoizedState.cache!==a&&(i.flags|=2048),yi(qt),xt(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function n1(r,i){switch(Af(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return yi(qt),de(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return Re(i),null;case 31:if(i.memoizedState!==null){if(Qn(i),i.alternate===null)throw Error(s(340));ma()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 13:if(Qn(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(s(340));ma()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return te(Nt),null;case 4:return de(),null;case 10:return yi(i.type),null;case 22:case 23:return Qn(i),Bf(),r!==null&&te(ya),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return yi(qt),null;case 25:return null;default:return null}}function _0(r,i){switch(Af(i),i.tag){case 3:yi(qt),de();break;case 26:case 27:case 5:Re(i);break;case 4:de();break;case 31:i.memoizedState!==null&&Qn(i);break;case 13:Qn(i);break;case 19:te(Nt);break;case 10:yi(i.type);break;case 22:case 23:Qn(i),Bf(),r!==null&&te(ya);break;case 24:yi(qt)}}function eu(r,i){try{var a=i.updateQueue,u=a!==null?a.lastEffect:null;if(u!==null){var g=u.next;a=g;do{if((a.tag&r)===r){u=void 0;var y=a.create,S=a.inst;u=y(),S.destroy=u}a=a.next}while(a!==g)}}catch(M){dt(i,i.return,M)}}function cs(r,i,a){try{var u=i.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var y=g.next;u=y;do{if((u.tag&r)===r){var S=u.inst,M=S.destroy;if(M!==void 0){S.destroy=void 0,g=i;var G=a,re=M;try{re()}catch(ue){dt(g,G,ue)}}}u=u.next}while(u!==y)}}catch(ue){dt(i,i.return,ue)}}function v0(r){var i=r.updateQueue;if(i!==null){var a=r.stateNode;try{u_(i,a)}catch(u){dt(r,r.return,u)}}}function b0(r,i,a){a.props=Sa(r.type,r.memoizedProps),a.state=r.memoizedState;try{a.componentWillUnmount()}catch(u){dt(r,i,u)}}function tu(r,i){try{var a=r.ref;if(a!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof a=="function"?r.refCleanup=a(u):a.current=u}}catch(g){dt(r,i,g)}}function Jr(r,i){var a=r.ref,u=r.refCleanup;if(a!==null)if(typeof u=="function")try{u()}catch(g){dt(r,i,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(g){dt(r,i,g)}else a.current=null}function E0(r){var i=r.type,a=r.memoizedProps,u=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":a.autoFocus&&u.focus();break e;case"img":a.src?u.src=a.src:a.srcSet&&(u.srcset=a.srcSet)}}catch(g){dt(r,r.return,g)}}function vm(r,i,a){try{var u=r.stateNode;w1(u,r.type,a,i),u[nn]=i}catch(g){dt(r,r.return,g)}}function S0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&ys(r.type)||r.tag===4}function bm(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||S0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&ys(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Em(r,i,a){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(r,i):(i=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,i.appendChild(r),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=br));else if(u!==4&&(u===27&&ys(r.type)&&(a=r.stateNode,i=null),r=r.child,r!==null))for(Em(r,i,a),r=r.sibling;r!==null;)Em(r,i,a),r=r.sibling}function ld(r,i,a){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?a.insertBefore(r,i):a.appendChild(r);else if(u!==4&&(u===27&&ys(r.type)&&(a=r.stateNode),r=r.child,r!==null))for(ld(r,i,a),r=r.sibling;r!==null;)ld(r,i,a),r=r.sibling}function x0(r){var i=r.stateNode,a=r.memoizedProps;try{for(var u=r.type,g=i.attributes;g.length;)i.removeAttributeNode(g[0]);fn(i,u,a),i[zt]=r,i[nn]=a}catch(y){dt(r,r.return,y)}}var Si=!1,Qt=!1,Sm=!1,w0=typeof WeakSet=="function"?WeakSet:Set,sn=null;function r1(r,i){if(r=r.containerInfo,qm=Dd,r=Py(r),pf(r)){if("selectionStart"in r)var a={start:r.selectionStart,end:r.selectionEnd};else e:{a=(a=r.ownerDocument)&&a.defaultView||window;var u=a.getSelection&&a.getSelection();if(u&&u.rangeCount!==0){a=u.anchorNode;var g=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{a.nodeType,y.nodeType}catch{a=null;break e}var S=0,M=-1,G=-1,re=0,ue=0,me=r,ie=null;t:for(;;){for(var le;me!==a||g!==0&&me.nodeType!==3||(M=S+g),me!==y||u!==0&&me.nodeType!==3||(G=S+u),me.nodeType===3&&(S+=me.nodeValue.length),(le=me.firstChild)!==null;)ie=me,me=le;for(;;){if(me===r)break t;if(ie===a&&++re===g&&(M=S),ie===y&&++ue===u&&(G=S),(le=me.nextSibling)!==null)break;me=ie,ie=me.parentNode}me=le}a=M===-1||G===-1?null:{start:M,end:G}}else a=null}a=a||{start:0,end:0}}else a=null;for(Hm={focusedElem:r,selectionRange:a},Dd=!1,sn=i;sn!==null;)if(i=sn,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,sn=r;else for(;sn!==null;){switch(i=sn,y=i.alternate,r=i.flags,i.tag){case 0:if((r&4)!==0&&(r=i.updateQueue,r=r!==null?r.events:null,r!==null))for(a=0;a<r.length;a++)g=r[a],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,a=i,g=y.memoizedProps,y=y.memoizedState,u=a.stateNode;try{var Ce=Sa(a.type,g);r=u.getSnapshotBeforeUpdate(Ce,y),u.__reactInternalSnapshotBeforeUpdate=r}catch(je){dt(a,a.return,je)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,a=r.nodeType,a===9)Km(r);else if(a===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Km(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=i.sibling,r!==null){r.return=i.return,sn=r;break}sn=i.return}}function T0(r,i,a){var u=a.flags;switch(a.tag){case 0:case 11:case 15:wi(r,a),u&4&&eu(5,a);break;case 1:if(wi(r,a),u&4)if(r=a.stateNode,i===null)try{r.componentDidMount()}catch(S){dt(a,a.return,S)}else{var g=Sa(a.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(g,i,r.__reactInternalSnapshotBeforeUpdate)}catch(S){dt(a,a.return,S)}}u&64&&v0(a),u&512&&tu(a,a.return);break;case 3:if(wi(r,a),u&64&&(r=a.updateQueue,r!==null)){if(i=null,a.child!==null)switch(a.child.tag){case 27:case 5:i=a.child.stateNode;break;case 1:i=a.child.stateNode}try{u_(r,i)}catch(S){dt(a,a.return,S)}}break;case 27:i===null&&u&4&&x0(a);case 26:case 5:wi(r,a),i===null&&u&4&&E0(a),u&512&&tu(a,a.return);break;case 12:wi(r,a);break;case 31:wi(r,a),u&4&&R0(r,a);break;case 13:wi(r,a),u&4&&D0(r,a),u&64&&(r=a.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(a=h1.bind(null,a),j1(r,a))));break;case 22:if(u=a.memoizedState!==null||Si,!u){i=i!==null&&i.memoizedState!==null||Qt,g=Si;var y=Qt;Si=u,(Qt=i)&&!y?Ti(r,a,(a.subtreeFlags&8772)!==0):wi(r,a),Si=g,Qt=y}break;case 30:break;default:wi(r,a)}}function A0(r){var i=r.alternate;i!==null&&(r.alternate=null,A0(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&Fa(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var At=null,jn=!1;function xi(r,i,a){for(a=a.child;a!==null;)C0(r,i,a),a=a.sibling}function C0(r,i,a){if(ln&&typeof ln.onCommitFiberUnmount=="function")try{ln.onCommitFiberUnmount(gr,a)}catch{}switch(a.tag){case 26:Qt||Jr(a,i),xi(r,i,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:Qt||Jr(a,i);var u=At,g=jn;ys(a.type)&&(At=a.stateNode,jn=!1),xi(r,i,a),cu(a.stateNode),At=u,jn=g;break;case 5:Qt||Jr(a,i);case 6:if(u=At,g=jn,At=null,xi(r,i,a),At=u,jn=g,At!==null)if(jn)try{(At.nodeType===9?At.body:At.nodeName==="HTML"?At.ownerDocument.body:At).removeChild(a.stateNode)}catch(y){dt(a,i,y)}else try{At.removeChild(a.stateNode)}catch(y){dt(a,i,y)}break;case 18:At!==null&&(jn?(r=At,vv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,a.stateNode),Co(r)):vv(At,a.stateNode));break;case 4:u=At,g=jn,At=a.stateNode.containerInfo,jn=!0,xi(r,i,a),At=u,jn=g;break;case 0:case 11:case 14:case 15:cs(2,a,i),Qt||cs(4,a,i),xi(r,i,a);break;case 1:Qt||(Jr(a,i),u=a.stateNode,typeof u.componentWillUnmount=="function"&&b0(a,i,u)),xi(r,i,a);break;case 21:xi(r,i,a);break;case 22:Qt=(u=Qt)||a.memoizedState!==null,xi(r,i,a),Qt=u;break;default:xi(r,i,a)}}function R0(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Co(r)}catch(a){dt(i,i.return,a)}}}function D0(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Co(r)}catch(a){dt(i,i.return,a)}}function i1(r){switch(r.tag){case 31:case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new w0),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new w0),i;default:throw Error(s(435,r.tag))}}function ud(r,i){var a=i1(r);i.forEach(function(u){if(!a.has(u)){a.add(u);var g=f1.bind(null,r,u);u.then(g,g)}})}function Mn(r,i){var a=i.deletions;if(a!==null)for(var u=0;u<a.length;u++){var g=a[u],y=r,S=i,M=S;e:for(;M!==null;){switch(M.tag){case 27:if(ys(M.type)){At=M.stateNode,jn=!1;break e}break;case 5:At=M.stateNode,jn=!1;break e;case 3:case 4:At=M.stateNode.containerInfo,jn=!0;break e}M=M.return}if(At===null)throw Error(s(160));C0(y,S,g),At=null,jn=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)I0(i,r),i=i.sibling}var Ar=null;function I0(r,i){var a=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Mn(i,r),kn(r),u&4&&(cs(3,r,r.return),eu(3,r),cs(5,r,r.return));break;case 1:Mn(i,r),kn(r),u&512&&(Qt||a===null||Jr(a,a.return)),u&64&&Si&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(a=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=a===null?u:a.concat(u))));break;case 26:var g=Ar;if(Mn(i,r),kn(r),u&512&&(Qt||a===null||Jr(a,a.return)),u&4){var y=a!==null?a.memoizedState:null;if(u=r.memoizedState,a===null)if(u===null)if(r.stateNode===null){e:{u=r.type,a=r.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":y=g.getElementsByTagName("title")[0],(!y||y[Lr]||y[zt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(u),g.head.insertBefore(y,g.querySelector("head > title"))),fn(y,u,a),y[zt]=r,Bt(y),u=y;break e;case"link":var S=Iv("link","href",g).get(u+(a.href||""));if(S){for(var M=0;M<S.length;M++)if(y=S[M],y.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&y.getAttribute("rel")===(a.rel==null?null:a.rel)&&y.getAttribute("title")===(a.title==null?null:a.title)&&y.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){S.splice(M,1);break t}}y=g.createElement(u),fn(y,u,a),g.head.appendChild(y);break;case"meta":if(S=Iv("meta","content",g).get(u+(a.content||""))){for(M=0;M<S.length;M++)if(y=S[M],y.getAttribute("content")===(a.content==null?null:""+a.content)&&y.getAttribute("name")===(a.name==null?null:a.name)&&y.getAttribute("property")===(a.property==null?null:a.property)&&y.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&y.getAttribute("charset")===(a.charSet==null?null:a.charSet)){S.splice(M,1);break t}}y=g.createElement(u),fn(y,u,a),g.head.appendChild(y);break;default:throw Error(s(468,u))}y[zt]=r,Bt(y),u=y}r.stateNode=u}else Ov(g,r.type,r.stateNode);else r.stateNode=Dv(g,u,r.memoizedProps);else y!==u?(y===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):y.count--,u===null?Ov(g,r.type,r.stateNode):Dv(g,u,r.memoizedProps)):u===null&&r.stateNode!==null&&vm(r,r.memoizedProps,a.memoizedProps)}break;case 27:Mn(i,r),kn(r),u&512&&(Qt||a===null||Jr(a,a.return)),a!==null&&u&4&&vm(r,r.memoizedProps,a.memoizedProps);break;case 5:if(Mn(i,r),kn(r),u&512&&(Qt||a===null||Jr(a,a.return)),r.flags&32){g=r.stateNode;try{On(g,"")}catch(Ce){dt(r,r.return,Ce)}}u&4&&r.stateNode!=null&&(g=r.memoizedProps,vm(r,g,a!==null?a.memoizedProps:g)),u&1024&&(Sm=!0);break;case 6:if(Mn(i,r),kn(r),u&4){if(r.stateNode===null)throw Error(s(162));u=r.memoizedProps,a=r.stateNode;try{a.nodeValue=u}catch(Ce){dt(r,r.return,Ce)}}break;case 3:if(Td=null,g=Ar,Ar=xd(i.containerInfo),Mn(i,r),Ar=g,kn(r),u&4&&a!==null&&a.memoizedState.isDehydrated)try{Co(i.containerInfo)}catch(Ce){dt(r,r.return,Ce)}Sm&&(Sm=!1,O0(r));break;case 4:u=Ar,Ar=xd(r.stateNode.containerInfo),Mn(i,r),kn(r),Ar=u;break;case 12:Mn(i,r),kn(r);break;case 31:Mn(i,r),kn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,ud(r,u)));break;case 13:Mn(i,r),kn(r),r.child.flags&8192&&r.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(dd=Cn()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,ud(r,u)));break;case 22:g=r.memoizedState!==null;var G=a!==null&&a.memoizedState!==null,re=Si,ue=Qt;if(Si=re||g,Qt=ue||G,Mn(i,r),Qt=ue,Si=re,kn(r),u&8192)e:for(i=r.stateNode,i._visibility=g?i._visibility&-2:i._visibility|1,g&&(a===null||G||Si||Qt||xa(r)),a=null,i=r;;){if(i.tag===5||i.tag===26){if(a===null){G=a=i;try{if(y=G.stateNode,g)S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{M=G.stateNode;var me=G.memoizedProps.style,ie=me!=null&&me.hasOwnProperty("display")?me.display:null;M.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(Ce){dt(G,G.return,Ce)}}}else if(i.tag===6){if(a===null){G=i;try{G.stateNode.nodeValue=g?"":G.memoizedProps}catch(Ce){dt(G,G.return,Ce)}}}else if(i.tag===18){if(a===null){G=i;try{var le=G.stateNode;g?bv(le,!0):bv(G.stateNode,!1)}catch(Ce){dt(G,G.return,Ce)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;a===i&&(a=null),i=i.return}a===i&&(a=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=r.updateQueue,u!==null&&(a=u.retryQueue,a!==null&&(u.retryQueue=null,ud(r,a))));break;case 19:Mn(i,r),kn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,ud(r,u)));break;case 30:break;case 21:break;default:Mn(i,r),kn(r)}}function kn(r){var i=r.flags;if(i&2){try{for(var a,u=r.return;u!==null;){if(S0(u)){a=u;break}u=u.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var g=a.stateNode,y=bm(r);ld(r,y,g);break;case 5:var S=a.stateNode;a.flags&32&&(On(S,""),a.flags&=-33);var M=bm(r);ld(r,M,S);break;case 3:case 4:var G=a.stateNode.containerInfo,re=bm(r);Em(r,re,G);break;default:throw Error(s(161))}}catch(ue){dt(r,r.return,ue)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function O0(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;O0(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function wi(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)T0(r,i.alternate,i),i=i.sibling}function xa(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:cs(4,i,i.return),xa(i);break;case 1:Jr(i,i.return);var a=i.stateNode;typeof a.componentWillUnmount=="function"&&b0(i,i.return,a),xa(i);break;case 27:cu(i.stateNode);case 26:case 5:Jr(i,i.return),xa(i);break;case 22:i.memoizedState===null&&xa(i);break;case 30:xa(i);break;default:xa(i)}r=r.sibling}}function Ti(r,i,a){for(a=a&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,g=r,y=i,S=y.flags;switch(y.tag){case 0:case 11:case 15:Ti(g,y,a),eu(4,y);break;case 1:if(Ti(g,y,a),u=y,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(re){dt(u,u.return,re)}if(u=y,g=u.updateQueue,g!==null){var M=u.stateNode;try{var G=g.shared.hiddenCallbacks;if(G!==null)for(g.shared.hiddenCallbacks=null,g=0;g<G.length;g++)l_(G[g],M)}catch(re){dt(u,u.return,re)}}a&&S&64&&v0(y),tu(y,y.return);break;case 27:x0(y);case 26:case 5:Ti(g,y,a),a&&u===null&&S&4&&E0(y),tu(y,y.return);break;case 12:Ti(g,y,a);break;case 31:Ti(g,y,a),a&&S&4&&R0(g,y);break;case 13:Ti(g,y,a),a&&S&4&&D0(g,y);break;case 22:y.memoizedState===null&&Ti(g,y,a),tu(y,y.return);break;case 30:break;default:Ti(g,y,a)}i=i.sibling}}function xm(r,i){var a=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(a=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==a&&(r!=null&&r.refCount++,a!=null&&Bl(a))}function wm(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&Bl(r))}function Cr(r,i,a,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)j0(r,i,a,u),i=i.sibling}function j0(r,i,a,u){var g=i.flags;switch(i.tag){case 0:case 11:case 15:Cr(r,i,a,u),g&2048&&eu(9,i);break;case 1:Cr(r,i,a,u);break;case 3:Cr(r,i,a,u),g&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&Bl(r)));break;case 12:if(g&2048){Cr(r,i,a,u),r=i.stateNode;try{var y=i.memoizedProps,S=y.id,M=y.onPostCommit;typeof M=="function"&&M(S,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(G){dt(i,i.return,G)}}else Cr(r,i,a,u);break;case 31:Cr(r,i,a,u);break;case 13:Cr(r,i,a,u);break;case 23:break;case 22:y=i.stateNode,S=i.alternate,i.memoizedState!==null?y._visibility&2?Cr(r,i,a,u):nu(r,i):y._visibility&2?Cr(r,i,a,u):(y._visibility|=2,go(r,i,a,u,(i.subtreeFlags&10256)!==0||!1)),g&2048&&xm(S,i);break;case 24:Cr(r,i,a,u),g&2048&&wm(i.alternate,i);break;default:Cr(r,i,a,u)}}function go(r,i,a,u,g){for(g=g&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var y=r,S=i,M=a,G=u,re=S.flags;switch(S.tag){case 0:case 11:case 15:go(y,S,M,G,g),eu(8,S);break;case 23:break;case 22:var ue=S.stateNode;S.memoizedState!==null?ue._visibility&2?go(y,S,M,G,g):nu(y,S):(ue._visibility|=2,go(y,S,M,G,g)),g&&re&2048&&xm(S.alternate,S);break;case 24:go(y,S,M,G,g),g&&re&2048&&wm(S.alternate,S);break;default:go(y,S,M,G,g)}i=i.sibling}}function nu(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var a=r,u=i,g=u.flags;switch(u.tag){case 22:nu(a,u),g&2048&&xm(u.alternate,u);break;case 24:nu(a,u),g&2048&&wm(u.alternate,u);break;default:nu(a,u)}i=i.sibling}}var ru=8192;function yo(r,i,a){if(r.subtreeFlags&ru)for(r=r.child;r!==null;)M0(r,i,a),r=r.sibling}function M0(r,i,a){switch(r.tag){case 26:yo(r,i,a),r.flags&ru&&r.memoizedState!==null&&H1(a,Ar,r.memoizedState,r.memoizedProps);break;case 5:yo(r,i,a);break;case 3:case 4:var u=Ar;Ar=xd(r.stateNode.containerInfo),yo(r,i,a),Ar=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=ru,ru=16777216,yo(r,i,a),ru=u):yo(r,i,a));break;default:yo(r,i,a)}}function k0(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function iu(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var a=0;a<i.length;a++){var u=i[a];sn=u,P0(u,r)}k0(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)N0(r),r=r.sibling}function N0(r){switch(r.tag){case 0:case 11:case 15:iu(r),r.flags&2048&&cs(9,r,r.return);break;case 3:iu(r);break;case 12:iu(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,cd(r)):iu(r);break;default:iu(r)}}function cd(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var a=0;a<i.length;a++){var u=i[a];sn=u,P0(u,r)}k0(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:cs(8,i,i.return),cd(i);break;case 22:a=i.stateNode,a._visibility&2&&(a._visibility&=-3,cd(i));break;default:cd(i)}r=r.sibling}}function P0(r,i){for(;sn!==null;){var a=sn;switch(a.tag){case 0:case 11:case 15:cs(8,a,i);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var u=a.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Bl(a.memoizedState.cache)}if(u=a.child,u!==null)u.return=a,sn=u;else e:for(a=r;sn!==null;){u=sn;var g=u.sibling,y=u.return;if(A0(u),u===a){sn=null;break e}if(g!==null){g.return=y,sn=g;break e}sn=y}}}var s1={getCacheForType:function(r){var i=dn(qt),a=i.data.get(r);return a===void 0&&(a=r(),i.data.set(r,a)),a},cacheSignal:function(){return dn(qt).controller.signal}},a1=typeof WeakMap=="function"?WeakMap:Map,ot=0,_t=null,$e=null,We=0,ct=0,Kn=null,ds=!1,_o=!1,Tm=!1,Ai=0,jt=0,hs=0,wa=0,Am=0,$n=0,vo=0,su=null,Nn=null,Cm=!1,dd=0,V0=0,hd=1/0,fd=null,fs=null,Jt=0,ms=null,bo=null,Ci=0,Rm=0,Dm=null,L0=null,au=0,Im=null;function Yn(){return(ot&2)!==0&&We!==0?We&-We:L.T!==null?Pm():mc()}function U0(){if($n===0)if((We&536870912)===0||tt){var r=Xs;Xs<<=1,(Xs&3932160)===0&&(Xs=262144),$n=r}else $n=536870912;return r=Gn.current,r!==null&&(r.flags|=32),$n}function Pn(r,i,a){(r===_t&&(ct===2||ct===9)||r.cancelPendingCommit!==null)&&(Eo(r,0),ps(r,We,$n,!1)),Js(r,a),((ot&2)===0||r!==_t)&&(r===_t&&((ot&2)===0&&(wa|=a),jt===4&&ps(r,We,$n,!1)),Zr(r))}function z0(r,i,a){if((ot&6)!==0)throw Error(s(327));var u=!a&&(i&127)===0&&(i&r.expiredLanes)===0||yr(r,i),g=u?u1(r,i):jm(r,i,!0),y=u;do{if(g===0){_o&&!u&&ps(r,i,0,!1);break}else{if(a=r.current.alternate,y&&!o1(a)){g=jm(r,i,!1),y=!1;continue}if(g===2){if(y=i,r.errorRecoveryDisabledLanes&y)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){i=S;e:{var M=r;g=su;var G=M.current.memoizedState.isDehydrated;if(G&&(Eo(M,S).flags|=256),S=jm(M,S,!1),S!==2){if(Tm&&!G){M.errorRecoveryDisabledLanes|=y,wa|=y,g=4;break e}y=Nn,Nn=g,y!==null&&(Nn===null?Nn=y:Nn.push.apply(Nn,y))}g=S}if(y=!1,g!==2)continue}}if(g===1){Eo(r,0),ps(r,i,0,!0);break}e:{switch(u=r,y=g,y){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:ps(u,i,$n,!ds);break e;case 2:Nn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(g=dd+300-Cn(),10<g)){if(ps(u,i,$n,!ds),Nr(u,0,!0)!==0)break e;Ci=i,u.timeoutHandle=yv(B0.bind(null,u,a,Nn,fd,Cm,i,$n,wa,vo,ds,y,"Throttled",-0,0),g);break e}B0(u,a,Nn,fd,Cm,i,$n,wa,vo,ds,y,null,-0,0)}}break}while(!0);Zr(r)}function B0(r,i,a,u,g,y,S,M,G,re,ue,me,ie,le){if(r.timeoutHandle=-1,me=i.subtreeFlags,me&8192||(me&16785408)===16785408){me={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:br},M0(i,y,me);var Ce=(y&62914560)===y?dd-Cn():(y&4194048)===y?V0-Cn():0;if(Ce=G1(me,Ce),Ce!==null){Ci=y,r.cancelPendingCommit=Ce(Y0.bind(null,r,i,y,a,u,g,S,M,G,ue,me,null,ie,le)),ps(r,y,S,!re);return}}Y0(r,i,y,a,u,g,S,M,G)}function o1(r){for(var i=r;;){var a=i.tag;if((a===0||a===11||a===15)&&i.flags&16384&&(a=i.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var u=0;u<a.length;u++){var g=a[u],y=g.getSnapshot;g=g.value;try{if(!qn(y(),g))return!1}catch{return!1}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ps(r,i,a,u){i&=~Am,i&=~wa,r.suspendedLanes|=i,r.pingedLanes&=~i,u&&(r.warmLanes|=i),u=r.expirationTimes;for(var g=i;0<g;){var y=31-Mt(g),S=1<<y;u[y]=-1,g&=~S}a!==0&&Zs(r,a,i)}function md(){return(ot&6)===0?(ou(0),!1):!0}function Om(){if($e!==null){if(ct===0)var r=$e.return;else r=$e,gi=pa=null,Kf(r),co=null,ql=0,r=$e;for(;r!==null;)_0(r.alternate,r),r=r.return;$e=null}}function Eo(r,i){var a=r.timeoutHandle;a!==-1&&(r.timeoutHandle=-1,C1(a)),a=r.cancelPendingCommit,a!==null&&(r.cancelPendingCommit=null,a()),Ci=0,Om(),_t=r,$e=a=mi(r.current,null),We=i,ct=0,Kn=null,ds=!1,_o=yr(r,i),Tm=!1,vo=$n=Am=wa=hs=jt=0,Nn=su=null,Cm=!1,(i&8)!==0&&(i|=i&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=i;0<u;){var g=31-Mt(u),y=1<<g;i|=r[g],u&=~y}return Ai=i,Nc(),a}function F0(r,i){Fe=null,L.H=Xl,i===uo||i===qc?(i=i_(),ct=3):i===Nf?(i=i_(),ct=4):ct=i===um?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Kn=i,$e===null&&(jt=1,rd(r,sr(i,r.current)))}function q0(){var r=Gn.current;return r===null?!0:(We&4194048)===We?ur===null:(We&62914560)===We||(We&536870912)!==0?r===ur:!1}function H0(){var r=L.H;return L.H=Xl,r===null?Xl:r}function G0(){var r=L.A;return L.A=s1,r}function pd(){jt=4,ds||(We&4194048)!==We&&Gn.current!==null||(_o=!0),(hs&134217727)===0&&(wa&134217727)===0||_t===null||ps(_t,We,$n,!1)}function jm(r,i,a){var u=ot;ot|=2;var g=H0(),y=G0();(_t!==r||We!==i)&&(fd=null,Eo(r,i)),i=!1;var S=jt;e:do try{if(ct!==0&&$e!==null){var M=$e,G=Kn;switch(ct){case 8:Om(),S=6;break e;case 3:case 2:case 9:case 6:Gn.current===null&&(i=!0);var re=ct;if(ct=0,Kn=null,So(r,M,G,re),a&&_o){S=0;break e}break;default:re=ct,ct=0,Kn=null,So(r,M,G,re)}}l1(),S=jt;break}catch(ue){F0(r,ue)}while(!0);return i&&r.shellSuspendCounter++,gi=pa=null,ot=u,L.H=g,L.A=y,$e===null&&(_t=null,We=0,Nc()),S}function l1(){for(;$e!==null;)Q0($e)}function u1(r,i){var a=ot;ot|=2;var u=H0(),g=G0();_t!==r||We!==i?(fd=null,hd=Cn()+500,Eo(r,i)):_o=yr(r,i);e:do try{if(ct!==0&&$e!==null){i=$e;var y=Kn;t:switch(ct){case 1:ct=0,Kn=null,So(r,i,y,1);break;case 2:case 9:if(n_(y)){ct=0,Kn=null,K0(i);break}i=function(){ct!==2&&ct!==9||_t!==r||(ct=7),Zr(r)},y.then(i,i);break e;case 3:ct=7;break e;case 4:ct=5;break e;case 7:n_(y)?(ct=0,Kn=null,K0(i)):(ct=0,Kn=null,So(r,i,y,7));break;case 5:var S=null;switch($e.tag){case 26:S=$e.memoizedState;case 5:case 27:var M=$e;if(S?jv(S):M.stateNode.complete){ct=0,Kn=null;var G=M.sibling;if(G!==null)$e=G;else{var re=M.return;re!==null?($e=re,gd(re)):$e=null}break t}}ct=0,Kn=null,So(r,i,y,5);break;case 6:ct=0,Kn=null,So(r,i,y,6);break;case 8:Om(),jt=6;break e;default:throw Error(s(462))}}c1();break}catch(ue){F0(r,ue)}while(!0);return gi=pa=null,L.H=u,L.A=g,ot=a,$e!==null?0:(_t=null,We=0,Nc(),jt)}function c1(){for(;$e!==null&&!lf();)Q0($e)}function Q0(r){var i=g0(r.alternate,r,Ai);r.memoizedProps=r.pendingProps,i===null?gd(r):$e=i}function K0(r){var i=r,a=i.alternate;switch(i.tag){case 15:case 0:i=c0(a,i,i.pendingProps,i.type,void 0,We);break;case 11:i=c0(a,i,i.pendingProps,i.type.render,i.ref,We);break;case 5:Kf(i);default:_0(a,i),i=$e=Gy(i,Ai),i=g0(a,i,Ai)}r.memoizedProps=r.pendingProps,i===null?gd(r):$e=i}function So(r,i,a,u){gi=pa=null,Kf(i),co=null,ql=0;var g=i.return;try{if(JT(r,g,i,a,We)){jt=1,rd(r,sr(a,r.current)),$e=null;return}}catch(y){if(g!==null)throw $e=g,y;jt=1,rd(r,sr(a,r.current)),$e=null;return}i.flags&32768?(tt||u===1?r=!0:_o||(We&536870912)!==0?r=!1:(ds=r=!0,(u===2||u===9||u===3||u===6)&&(u=Gn.current,u!==null&&u.tag===13&&(u.flags|=16384))),$0(i,r)):gd(i)}function gd(r){var i=r;do{if((i.flags&32768)!==0){$0(i,ds);return}r=i.return;var a=t1(i.alternate,i,Ai);if(a!==null){$e=a;return}if(i=i.sibling,i!==null){$e=i;return}$e=i=r}while(i!==null);jt===0&&(jt=5)}function $0(r,i){do{var a=n1(r.alternate,r);if(a!==null){a.flags&=32767,$e=a;return}if(a=r.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!i&&(r=r.sibling,r!==null)){$e=r;return}$e=r=a}while(r!==null);jt=6,$e=null}function Y0(r,i,a,u,g,y,S,M,G){r.cancelPendingCommit=null;do yd();while(Jt!==0);if((ot&6)!==0)throw Error(s(327));if(i!==null){if(i===r.current)throw Error(s(177));if(y=i.lanes|i.childLanes,y|=bf,df(r,a,y,S,M,G),r===_t&&($e=_t=null,We=0),bo=i,ms=r,Ci=a,Rm=y,Dm=g,L0=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,m1(Gi,function(){return ev(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=L.T,L.T=null,g=H.p,H.p=2,S=ot,ot|=4;try{r1(r,i,a)}finally{ot=S,H.p=g,L.T=u}}Jt=1,W0(),X0(),J0()}}function W0(){if(Jt===1){Jt=0;var r=ms,i=bo,a=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||a){a=L.T,L.T=null;var u=H.p;H.p=2;var g=ot;ot|=4;try{I0(i,r);var y=Hm,S=Py(r.containerInfo),M=y.focusedElem,G=y.selectionRange;if(S!==M&&M&&M.ownerDocument&&Ny(M.ownerDocument.documentElement,M)){if(G!==null&&pf(M)){var re=G.start,ue=G.end;if(ue===void 0&&(ue=re),"selectionStart"in M)M.selectionStart=re,M.selectionEnd=Math.min(ue,M.value.length);else{var me=M.ownerDocument||document,ie=me&&me.defaultView||window;if(ie.getSelection){var le=ie.getSelection(),Ce=M.textContent.length,je=Math.min(G.start,Ce),gt=G.end===void 0?je:Math.min(G.end,Ce);!le.extend&&je>gt&&(S=gt,gt=je,je=S);var J=ky(M,je),K=ky(M,gt);if(J&&K&&(le.rangeCount!==1||le.anchorNode!==J.node||le.anchorOffset!==J.offset||le.focusNode!==K.node||le.focusOffset!==K.offset)){var ne=me.createRange();ne.setStart(J.node,J.offset),le.removeAllRanges(),je>gt?(le.addRange(ne),le.extend(K.node,K.offset)):(ne.setEnd(K.node,K.offset),le.addRange(ne))}}}}for(me=[],le=M;le=le.parentNode;)le.nodeType===1&&me.push({element:le,left:le.scrollLeft,top:le.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<me.length;M++){var he=me[M];he.element.scrollLeft=he.left,he.element.scrollTop=he.top}}Dd=!!qm,Hm=qm=null}finally{ot=g,H.p=u,L.T=a}}r.current=i,Jt=2}}function X0(){if(Jt===2){Jt=0;var r=ms,i=bo,a=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||a){a=L.T,L.T=null;var u=H.p;H.p=2;var g=ot;ot|=4;try{T0(r,i.alternate,i)}finally{ot=g,H.p=u,L.T=a}}Jt=3}}function J0(){if(Jt===4||Jt===3){Jt=0,oc();var r=ms,i=bo,a=Ci,u=L0;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Jt=5:(Jt=0,bo=ms=null,Z0(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(fs=null),ci(a),i=i.stateNode,ln&&typeof ln.onCommitFiberRoot=="function")try{ln.onCommitFiberRoot(gr,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=L.T,g=H.p,H.p=2,L.T=null;try{for(var y=r.onRecoverableError,S=0;S<u.length;S++){var M=u[S];y(M.value,{componentStack:M.stack})}}finally{L.T=i,H.p=g}}(Ci&3)!==0&&yd(),Zr(r),g=r.pendingLanes,(a&261930)!==0&&(g&42)!==0?r===Im?au++:(au=0,Im=r):au=0,ou(0)}}function Z0(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,Bl(i)))}function yd(){return W0(),X0(),J0(),ev()}function ev(){if(Jt!==5)return!1;var r=ms,i=Rm;Rm=0;var a=ci(Ci),u=L.T,g=H.p;try{H.p=32>a?32:a,L.T=null,a=Dm,Dm=null;var y=ms,S=Ci;if(Jt=0,bo=ms=null,Ci=0,(ot&6)!==0)throw Error(s(331));var M=ot;if(ot|=4,N0(y.current),j0(y,y.current,S,a),ot=M,ou(0,!1),ln&&typeof ln.onPostCommitFiberRoot=="function")try{ln.onPostCommitFiberRoot(gr,y)}catch{}return!0}finally{H.p=g,L.T=u,Z0(r,i)}}function tv(r,i,a){i=sr(a,i),i=lm(r.stateNode,i,2),r=os(r,i,2),r!==null&&(Js(r,2),Zr(r))}function dt(r,i,a){if(r.tag===3)tv(r,r,a);else for(;i!==null;){if(i.tag===3){tv(i,r,a);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(fs===null||!fs.has(u))){r=sr(a,r),a=n0(2),u=os(i,a,2),u!==null&&(r0(a,u,i,r),Js(u,2),Zr(u));break}}i=i.return}}function Mm(r,i,a){var u=r.pingCache;if(u===null){u=r.pingCache=new a1;var g=new Set;u.set(i,g)}else g=u.get(i),g===void 0&&(g=new Set,u.set(i,g));g.has(a)||(Tm=!0,g.add(a),r=d1.bind(null,r,i,a),i.then(r,r))}function d1(r,i,a){var u=r.pingCache;u!==null&&u.delete(i),r.pingedLanes|=r.suspendedLanes&a,r.warmLanes&=~a,_t===r&&(We&a)===a&&(jt===4||jt===3&&(We&62914560)===We&&300>Cn()-dd?(ot&2)===0&&Eo(r,0):Am|=a,vo===We&&(vo=0)),Zr(r)}function nv(r,i){i===0&&(i=fc()),r=ha(r,i),r!==null&&(Js(r,i),Zr(r))}function h1(r){var i=r.memoizedState,a=0;i!==null&&(a=i.retryLane),nv(r,a)}function f1(r,i){var a=0;switch(r.tag){case 31:case 13:var u=r.stateNode,g=r.memoizedState;g!==null&&(a=g.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(s(314))}u!==null&&u.delete(i),nv(r,a)}function m1(r,i){return Xt(r,i)}var _d=null,xo=null,km=!1,vd=!1,Nm=!1,gs=0;function Zr(r){r!==xo&&r.next===null&&(xo===null?_d=xo=r:xo=xo.next=r),vd=!0,km||(km=!0,g1())}function ou(r,i){if(!Nm&&vd){Nm=!0;do for(var a=!1,u=_d;u!==null;){if(r!==0){var g=u.pendingLanes;if(g===0)var y=0;else{var S=u.suspendedLanes,M=u.pingedLanes;y=(1<<31-Mt(42|r)+1)-1,y&=g&~(S&~M),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(a=!0,av(u,y))}else y=We,y=Nr(u,u===_t?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||yr(u,y)||(a=!0,av(u,y));u=u.next}while(a);Nm=!1}}function p1(){rv()}function rv(){vd=km=!1;var r=0;gs!==0&&A1()&&(r=gs);for(var i=Cn(),a=null,u=_d;u!==null;){var g=u.next,y=iv(u,i);y===0?(u.next=null,a===null?_d=g:a.next=g,g===null&&(xo=a)):(a=u,(r!==0||(y&3)!==0)&&(vd=!0)),u=g}Jt!==0&&Jt!==5||ou(r),gs!==0&&(gs=0)}function iv(r,i){for(var a=r.suspendedLanes,u=r.pingedLanes,g=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var S=31-Mt(y),M=1<<S,G=g[S];G===-1?((M&a)===0||(M&u)!==0)&&(g[S]=cf(M,i)):G<=i&&(r.expiredLanes|=M),y&=~M}if(i=_t,a=We,a=Nr(r,r===i?a:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,a===0||r===i&&(ct===2||ct===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&Hi(u),r.callbackNode=null,r.callbackPriority=0;if((a&3)===0||yr(r,a)){if(i=a&-a,i===r.callbackPriority)return i;switch(u!==null&&Hi(u),ci(a)){case 2:case 8:a=yl;break;case 32:a=Gi;break;case 268435456:a=lc;break;default:a=Gi}return u=sv.bind(null,r),a=Xt(a,u),r.callbackPriority=i,r.callbackNode=a,i}return u!==null&&u!==null&&Hi(u),r.callbackPriority=2,r.callbackNode=null,2}function sv(r,i){if(Jt!==0&&Jt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var a=r.callbackNode;if(yd()&&r.callbackNode!==a)return null;var u=We;return u=Nr(r,r===_t?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(z0(r,u,i),iv(r,Cn()),r.callbackNode!=null&&r.callbackNode===a?sv.bind(null,r):null)}function av(r,i){if(yd())return null;z0(r,i,!0)}function g1(){R1(function(){(ot&6)!==0?Xt(gl,p1):rv()})}function Pm(){if(gs===0){var r=oo;r===0&&(r=Mr,Mr<<=1,(Mr&261888)===0&&(Mr=256)),gs=r}return gs}function ov(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Qa(""+r)}function lv(r,i){var a=i.ownerDocument.createElement("input");return a.name=i.name,a.value=i.value,r.id&&a.setAttribute("form",r.id),i.parentNode.insertBefore(a,i),r=new FormData(r),a.parentNode.removeChild(a),r}function y1(r,i,a,u,g){if(i==="submit"&&a&&a.stateNode===g){var y=ov((g[nn]||null).action),S=u.submitter;S&&(i=(i=S[nn]||null)?ov(i.formAction):S.getAttribute("formAction"),i!==null&&(y=i,S=null));var M=new Qr("action","action",null,u,g);r.push({event:M,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(gs!==0){var G=S?lv(g,S):new FormData(g);nm(a,{pending:!0,data:G,method:g.method,action:y},null,G)}}else typeof y=="function"&&(M.preventDefault(),G=S?lv(g,S):new FormData(g),nm(a,{pending:!0,data:G,method:g.method,action:y},y,G))},currentTarget:g}]})}}for(var Vm=0;Vm<vf.length;Vm++){var Lm=vf[Vm],_1=Lm.toLowerCase(),v1=Lm[0].toUpperCase()+Lm.slice(1);Tr(_1,"on"+v1)}Tr(Uy,"onAnimationEnd"),Tr(zy,"onAnimationIteration"),Tr(By,"onAnimationStart"),Tr("dblclick","onDoubleClick"),Tr("focusin","onFocus"),Tr("focusout","onBlur"),Tr(NT,"onTransitionRun"),Tr(PT,"onTransitionStart"),Tr(VT,"onTransitionCancel"),Tr(Fy,"onTransitionEnd"),Fr("onMouseEnter",["mouseout","mouseover"]),Fr("onMouseLeave",["mouseout","mouseover"]),Fr("onPointerEnter",["pointerout","pointerover"]),Fr("onPointerLeave",["pointerout","pointerover"]),Br("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Br("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Br("onBeforeInput",["compositionend","keypress","textInput","paste"]),Br("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Br("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Br("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),b1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lu));function uv(r,i){i=(i&4)!==0;for(var a=0;a<r.length;a++){var u=r[a],g=u.event;u=u.listeners;e:{var y=void 0;if(i)for(var S=u.length-1;0<=S;S--){var M=u[S],G=M.instance,re=M.currentTarget;if(M=M.listener,G!==y&&g.isPropagationStopped())break e;y=M,g.currentTarget=re;try{y(g)}catch(ue){kc(ue)}g.currentTarget=null,y=G}else for(S=0;S<u.length;S++){if(M=u[S],G=M.instance,re=M.currentTarget,M=M.listener,G!==y&&g.isPropagationStopped())break e;y=M,g.currentTarget=re;try{y(g)}catch(ue){kc(ue)}g.currentTarget=null,y=G}}}}function Ye(r,i){var a=i[Ba];a===void 0&&(a=i[Ba]=new Set);var u=r+"__bubble";a.has(u)||(cv(i,r,2,!1),a.add(u))}function Um(r,i,a){var u=0;i&&(u|=4),cv(a,r,u,i)}var bd="_reactListening"+Math.random().toString(36).slice(2);function zm(r){if(!r[bd]){r[bd]=!0,bl.forEach(function(a){a!=="selectionchange"&&(b1.has(a)||Um(a,!1,r),Um(a,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[bd]||(i[bd]=!0,Um("selectionchange",!1,i))}}function cv(r,i,a,u){switch(Uv(i)){case 2:var g=$1;break;case 8:g=Y1;break;default:g=tp}a=g.bind(null,i,a,r),g=void 0,!ia||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(g=!0),u?g!==void 0?r.addEventListener(i,a,{capture:!0,passive:g}):r.addEventListener(i,a,!0):g!==void 0?r.addEventListener(i,a,{passive:g}):r.addEventListener(i,a,!1)}function Bm(r,i,a,u,g){var y=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var S=u.tag;if(S===3||S===4){var M=u.stateNode.containerInfo;if(M===g)break;if(S===4)for(S=u.return;S!==null;){var G=S.tag;if((G===3||G===4)&&S.stateNode.containerInfo===g)return;S=S.return}for(;M!==null;){if(S=Ur(M),S===null)return;if(G=S.tag,G===5||G===6||G===26||G===27){u=y=S;continue e}M=M.parentNode}}u=u.return}Xi(function(){var re=y,ue=tr(a),me=[];e:{var ie=qy.get(r);if(ie!==void 0){var le=Qr,Ce=r;switch(r){case"keypress":if(aa(a)===0)break e;case"keydown":case"keyup":le=Oc;break;case"focusin":Ce="focus",le=la;break;case"focusout":Ce="blur",le=la;break;case"beforeblur":case"afterblur":le=la;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":le=Ml;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":le=Sc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":le=b;break;case Uy:case zy:case By:le=wc;break;case Fy:le=P;break;case"scroll":case"scrollend":le=jl;break;case"wheel":le=oe;break;case"copy":case"cut":case"paste":le=Tc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":le=fi;break;case"toggle":case"beforetoggle":le=Be}var je=(i&4)!==0,gt=!je&&(r==="scroll"||r==="scrollend"),J=je?ie!==null?ie+"Capture":null:ie;je=[];for(var K=re,ne;K!==null;){var he=K;if(ne=he.stateNode,he=he.tag,he!==5&&he!==26&&he!==27||ne===null||J===null||(he=Er(K,J),he!=null&&je.push(uu(K,he,ne))),gt)break;K=K.return}0<je.length&&(ie=new le(ie,Ce,null,a,ue),me.push({event:ie,listeners:je}))}}if((i&7)===0){e:{if(ie=r==="mouseover"||r==="pointerover",le=r==="mouseout"||r==="pointerout",ie&&a!==Dl&&(Ce=a.relatedTarget||a.fromElement)&&(Ur(Ce)||Ce[Vr]))break e;if((le||ie)&&(ie=ue.window===ue?ue:(ie=ue.ownerDocument)?ie.defaultView||ie.parentWindow:window,le?(Ce=a.relatedTarget||a.toElement,le=re,Ce=Ce?Ur(Ce):null,Ce!==null&&(gt=l(Ce),je=Ce.tag,Ce!==gt||je!==5&&je!==27&&je!==6)&&(Ce=null)):(le=null,Ce=re),le!==Ce)){if(je=Ml,he="onMouseLeave",J="onMouseEnter",K="mouse",(r==="pointerout"||r==="pointerover")&&(je=fi,he="onPointerLeave",J="onPointerEnter",K="pointer"),gt=le==null?ie:Bn(le),ne=Ce==null?ie:Bn(Ce),ie=new je(he,K+"leave",le,a,ue),ie.target=gt,ie.relatedTarget=ne,he=null,Ur(ue)===re&&(je=new je(J,K+"enter",Ce,a,ue),je.target=ne,je.relatedTarget=gt,he=je),gt=he,le&&Ce)t:{for(je=E1,J=le,K=Ce,ne=0,he=J;he;he=je(he))ne++;he=0;for(var Ie=K;Ie;Ie=je(Ie))he++;for(;0<ne-he;)J=je(J),ne--;for(;0<he-ne;)K=je(K),he--;for(;ne--;){if(J===K||K!==null&&J===K.alternate){je=J;break t}J=je(J),K=je(K)}je=null}else je=null;le!==null&&dv(me,ie,le,je,!1),Ce!==null&&gt!==null&&dv(me,gt,Ce,je,!0)}}e:{if(ie=re?Bn(re):window,le=ie.nodeName&&ie.nodeName.toLowerCase(),le==="select"||le==="input"&&ie.type==="file")var it=Ry;else if(Ay(ie))if(Dy)it=jT;else{it=IT;var De=DT}else le=ie.nodeName,!le||le.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?re&&Ga(re.elementType)&&(it=Ry):it=OT;if(it&&(it=it(r,re))){Cy(me,it,a,ue);break e}De&&De(r,ie,re),r==="focusout"&&re&&ie.type==="number"&&re.memoizedProps.value!=null&&Al(ie,"number",ie.value)}switch(De=re?Bn(re):window,r){case"focusin":(Ay(De)||De.contentEditable==="true")&&(Za=De,gf=re,Ll=null);break;case"focusout":Ll=gf=Za=null;break;case"mousedown":yf=!0;break;case"contextmenu":case"mouseup":case"dragend":yf=!1,Vy(me,a,ue);break;case"selectionchange":if(kT)break;case"keydown":case"keyup":Vy(me,a,ue)}var He;if(at)e:{switch(r){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else Ja?ua(r,a)&&(Xe="onCompositionEnd"):r==="keydown"&&a.keyCode===229&&(Xe="onCompositionStart");Xe&&(Yr&&a.locale!=="ko"&&(Ja||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&Ja&&(He=Ol()):(Gr=ue,Il="value"in Gr?Gr.value:Gr.textContent,Ja=!0)),De=Ed(re,Xe),0<De.length&&(Xe=new $r(Xe,r,null,a,ue),me.push({event:Xe,listeners:De}),He?Xe.data=He:(He=Xa(a),He!==null&&(Xe.data=He)))),(He=rr?TT(r,a):AT(r,a))&&(Xe=Ed(re,"onBeforeInput"),0<Xe.length&&(De=new $r("onBeforeInput","beforeinput",null,a,ue),me.push({event:De,listeners:Xe}),De.data=He)),y1(me,r,re,a,ue)}uv(me,i)})}function uu(r,i,a){return{instance:r,listener:i,currentTarget:a}}function Ed(r,i){for(var a=i+"Capture",u=[];r!==null;){var g=r,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=Er(r,a),g!=null&&u.unshift(uu(r,g,y)),g=Er(r,i),g!=null&&u.push(uu(r,g,y))),r.tag===3)return u;r=r.return}return[]}function E1(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function dv(r,i,a,u,g){for(var y=i._reactName,S=[];a!==null&&a!==u;){var M=a,G=M.alternate,re=M.stateNode;if(M=M.tag,G!==null&&G===u)break;M!==5&&M!==26&&M!==27||re===null||(G=re,g?(re=Er(a,y),re!=null&&S.unshift(uu(a,re,G))):g||(re=Er(a,y),re!=null&&S.push(uu(a,re,G)))),a=a.return}S.length!==0&&r.push({event:i,listeners:S})}var S1=/\r\n?/g,x1=/\u0000|\uFFFD/g;function hv(r){return(typeof r=="string"?r:""+r).replace(S1,`
`).replace(x1,"")}function fv(r,i){return i=hv(i),hv(r)===i}function pt(r,i,a,u,g,y){switch(a){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||On(r,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&On(r,""+u);break;case"className":Fn(r,"class",u);break;case"tabIndex":Fn(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Fn(r,a,u);break;case"style":Rl(r,u,y);break;case"data":if(i!=="object"){Fn(r,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||a!=="href")){r.removeAttribute(a);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(a);break}u=Qa(""+u),r.setAttribute(a,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(a==="formAction"?(i!=="input"&&pt(r,i,"name",g.name,g,null),pt(r,i,"formEncType",g.formEncType,g,null),pt(r,i,"formMethod",g.formMethod,g,null),pt(r,i,"formTarget",g.formTarget,g,null)):(pt(r,i,"encType",g.encType,g,null),pt(r,i,"method",g.method,g,null),pt(r,i,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(a);break}u=Qa(""+u),r.setAttribute(a,u);break;case"onClick":u!=null&&(r.onclick=br);break;case"onScroll":u!=null&&Ye("scroll",r);break;case"onScrollEnd":u!=null&&Ye("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(g.children!=null)throw Error(s(60));r.innerHTML=a}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}a=Qa(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(a,""+u):r.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(a,""):r.removeAttribute(a);break;case"capture":case"download":u===!0?r.setAttribute(a,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(a,u):r.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(a,u):r.removeAttribute(a);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(a):r.setAttribute(a,u);break;case"popover":Ye("beforetoggle",r),Ye("toggle",r),qa(r,"popover",u);break;case"xlinkActuate":Ft(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ft(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ft(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ft(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ft(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ft(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":qa(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=Ec.get(a)||a,qa(r,a,u))}}function Fm(r,i,a,u,g,y){switch(a){case"style":Rl(r,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(s(61));if(a=u.__html,a!=null){if(g.children!=null)throw Error(s(60));r.innerHTML=a}}break;case"children":typeof u=="string"?On(r,u):(typeof u=="number"||typeof u=="bigint")&&On(r,""+u);break;case"onScroll":u!=null&&Ye("scroll",r);break;case"onScrollEnd":u!=null&&Ye("scrollend",r);break;case"onClick":u!=null&&(r.onclick=br);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!El.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(g=a.endsWith("Capture"),i=a.slice(2,g?a.length-7:void 0),y=r[nn]||null,y=y!=null?y[a]:null,typeof y=="function"&&r.removeEventListener(i,y,g),typeof u=="function")){typeof y!="function"&&y!==null&&(a in r?r[a]=null:r.hasAttribute(a)&&r.removeAttribute(a)),r.addEventListener(i,u,g);break e}a in r?r[a]=u:u===!0?r.setAttribute(a,""):qa(r,a,u)}}}function fn(r,i,a){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ye("error",r),Ye("load",r);var u=!1,g=!1,y;for(y in a)if(a.hasOwnProperty(y)){var S=a[y];if(S!=null)switch(y){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:pt(r,i,y,S,a,null)}}g&&pt(r,i,"srcSet",a.srcSet,a,null),u&&pt(r,i,"src",a.src,a,null);return;case"input":Ye("invalid",r);var M=y=S=g=null,G=null,re=null;for(u in a)if(a.hasOwnProperty(u)){var ue=a[u];if(ue!=null)switch(u){case"name":g=ue;break;case"type":S=ue;break;case"checked":G=ue;break;case"defaultChecked":re=ue;break;case"value":y=ue;break;case"defaultValue":M=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(s(137,i));break;default:pt(r,i,u,ue,a,null)}}_c(r,y,M,G,re,S,g,!1);return;case"select":Ye("invalid",r),u=S=y=null;for(g in a)if(a.hasOwnProperty(g)&&(M=a[g],M!=null))switch(g){case"value":y=M;break;case"defaultValue":S=M;break;case"multiple":u=M;default:pt(r,i,g,M,a,null)}i=y,a=S,r.multiple=!!u,i!=null?Ki(r,!!u,i,!1):a!=null&&Ki(r,!!u,a,!0);return;case"textarea":Ye("invalid",r),y=g=u=null;for(S in a)if(a.hasOwnProperty(S)&&(M=a[S],M!=null))switch(S){case"value":u=M;break;case"defaultValue":g=M;break;case"children":y=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(s(91));break;default:pt(r,i,S,M,a,null)}$i(r,u,g,y);return;case"option":for(G in a)a.hasOwnProperty(G)&&(u=a[G],u!=null)&&(G==="selected"?r.selected=u&&typeof u!="function"&&typeof u!="symbol":pt(r,i,G,u,a,null));return;case"dialog":Ye("beforetoggle",r),Ye("toggle",r),Ye("cancel",r),Ye("close",r);break;case"iframe":case"object":Ye("load",r);break;case"video":case"audio":for(u=0;u<lu.length;u++)Ye(lu[u],r);break;case"image":Ye("error",r),Ye("load",r);break;case"details":Ye("toggle",r);break;case"embed":case"source":case"link":Ye("error",r),Ye("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(re in a)if(a.hasOwnProperty(re)&&(u=a[re],u!=null))switch(re){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:pt(r,i,re,u,a,null)}return;default:if(Ga(i)){for(ue in a)a.hasOwnProperty(ue)&&(u=a[ue],u!==void 0&&Fm(r,i,ue,u,a,void 0));return}}for(M in a)a.hasOwnProperty(M)&&(u=a[M],u!=null&&pt(r,i,M,u,a,null))}function w1(r,i,a,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,S=null,M=null,G=null,re=null,ue=null;for(le in a){var me=a[le];if(a.hasOwnProperty(le)&&me!=null)switch(le){case"checked":break;case"value":break;case"defaultValue":G=me;default:u.hasOwnProperty(le)||pt(r,i,le,null,u,me)}}for(var ie in u){var le=u[ie];if(me=a[ie],u.hasOwnProperty(ie)&&(le!=null||me!=null))switch(ie){case"type":y=le;break;case"name":g=le;break;case"checked":re=le;break;case"defaultChecked":ue=le;break;case"value":S=le;break;case"defaultValue":M=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(s(137,i));break;default:le!==me&&pt(r,i,ie,le,u,me)}}Ha(r,S,M,G,re,ue,y,g);return;case"select":le=S=M=ie=null;for(y in a)if(G=a[y],a.hasOwnProperty(y)&&G!=null)switch(y){case"value":break;case"multiple":le=G;default:u.hasOwnProperty(y)||pt(r,i,y,null,u,G)}for(g in u)if(y=u[g],G=a[g],u.hasOwnProperty(g)&&(y!=null||G!=null))switch(g){case"value":ie=y;break;case"defaultValue":M=y;break;case"multiple":S=y;default:y!==G&&pt(r,i,g,y,u,G)}i=M,a=S,u=le,ie!=null?Ki(r,!!a,ie,!1):!!u!=!!a&&(i!=null?Ki(r,!!a,i,!0):Ki(r,!!a,a?[]:"",!1));return;case"textarea":le=ie=null;for(M in a)if(g=a[M],a.hasOwnProperty(M)&&g!=null&&!u.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:pt(r,i,M,null,u,g)}for(S in u)if(g=u[S],y=a[S],u.hasOwnProperty(S)&&(g!=null||y!=null))switch(S){case"value":ie=g;break;case"defaultValue":le=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==y&&pt(r,i,S,g,u,y)}vc(r,ie,le);return;case"option":for(var Ce in a)ie=a[Ce],a.hasOwnProperty(Ce)&&ie!=null&&!u.hasOwnProperty(Ce)&&(Ce==="selected"?r.selected=!1:pt(r,i,Ce,null,u,ie));for(G in u)ie=u[G],le=a[G],u.hasOwnProperty(G)&&ie!==le&&(ie!=null||le!=null)&&(G==="selected"?r.selected=ie&&typeof ie!="function"&&typeof ie!="symbol":pt(r,i,G,ie,u,le));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var je in a)ie=a[je],a.hasOwnProperty(je)&&ie!=null&&!u.hasOwnProperty(je)&&pt(r,i,je,null,u,ie);for(re in u)if(ie=u[re],le=a[re],u.hasOwnProperty(re)&&ie!==le&&(ie!=null||le!=null))switch(re){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(s(137,i));break;default:pt(r,i,re,ie,u,le)}return;default:if(Ga(i)){for(var gt in a)ie=a[gt],a.hasOwnProperty(gt)&&ie!==void 0&&!u.hasOwnProperty(gt)&&Fm(r,i,gt,void 0,u,ie);for(ue in u)ie=u[ue],le=a[ue],!u.hasOwnProperty(ue)||ie===le||ie===void 0&&le===void 0||Fm(r,i,ue,ie,u,le);return}}for(var J in a)ie=a[J],a.hasOwnProperty(J)&&ie!=null&&!u.hasOwnProperty(J)&&pt(r,i,J,null,u,ie);for(me in u)ie=u[me],le=a[me],!u.hasOwnProperty(me)||ie===le||ie==null&&le==null||pt(r,i,me,ie,u,le)}function mv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function T1(){if(typeof performance.getEntriesByType=="function"){for(var r=0,i=0,a=performance.getEntriesByType("resource"),u=0;u<a.length;u++){var g=a[u],y=g.transferSize,S=g.initiatorType,M=g.duration;if(y&&M&&mv(S)){for(S=0,M=g.responseEnd,u+=1;u<a.length;u++){var G=a[u],re=G.startTime;if(re>M)break;var ue=G.transferSize,me=G.initiatorType;ue&&mv(me)&&(G=G.responseEnd,S+=ue*(G<M?1:(M-re)/(G-re)))}if(--u,i+=8*(y+S)/(g.duration/1e3),r++,10<r)break}}if(0<r)return i/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var qm=null,Hm=null;function Sd(r){return r.nodeType===9?r:r.ownerDocument}function pv(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function gv(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function Gm(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Qm=null;function A1(){var r=window.event;return r&&r.type==="popstate"?r===Qm?!1:(Qm=r,!0):(Qm=null,!1)}var yv=typeof setTimeout=="function"?setTimeout:void 0,C1=typeof clearTimeout=="function"?clearTimeout:void 0,_v=typeof Promise=="function"?Promise:void 0,R1=typeof queueMicrotask=="function"?queueMicrotask:typeof _v<"u"?function(r){return _v.resolve(null).then(r).catch(D1)}:yv;function D1(r){setTimeout(function(){throw r})}function ys(r){return r==="head"}function vv(r,i){var a=i,u=0;do{var g=a.nextSibling;if(r.removeChild(a),g&&g.nodeType===8)if(a=g.data,a==="/$"||a==="/&"){if(u===0){r.removeChild(g),Co(i);return}u--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")u++;else if(a==="html")cu(r.ownerDocument.documentElement);else if(a==="head"){a=r.ownerDocument.head,cu(a);for(var y=a.firstChild;y;){var S=y.nextSibling,M=y.nodeName;y[Lr]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&y.rel.toLowerCase()==="stylesheet"||a.removeChild(y),y=S}}else a==="body"&&cu(r.ownerDocument.body);a=g}while(a);Co(i)}function bv(r,i){var a=r;r=0;do{var u=a.nextSibling;if(a.nodeType===1?i?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(i?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),u&&u.nodeType===8)if(a=u.data,a==="/$"){if(r===0)break;r--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||r++;a=u}while(a)}function Km(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var a=i;switch(i=i.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Km(a),Fa(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}r.removeChild(a)}}function I1(r,i,a,u){for(;r.nodeType===1;){var g=a;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[Lr])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=cr(r.nextSibling),r===null)break}return null}function O1(r,i,a){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!a||(r=cr(r.nextSibling),r===null))return null;return r}function Ev(r,i){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!i||(r=cr(r.nextSibling),r===null))return null;return r}function $m(r){return r.data==="$?"||r.data==="$~"}function Ym(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function j1(r,i){var a=r.ownerDocument;if(r.data==="$~")r._reactRetry=i;else if(r.data!=="$?"||a.readyState!=="loading")i();else{var u=function(){i(),a.removeEventListener("DOMContentLoaded",u)};a.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function cr(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return r}var Wm=null;function Sv(r){r=r.nextSibling;for(var i=0;r;){if(r.nodeType===8){var a=r.data;if(a==="/$"||a==="/&"){if(i===0)return cr(r.nextSibling);i--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||i++}r=r.nextSibling}return null}function xv(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var a=r.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(i===0)return r;i--}else a!=="/$"&&a!=="/&"||i++}r=r.previousSibling}return null}function wv(r,i,a){switch(i=Sd(a),r){case"html":if(r=i.documentElement,!r)throw Error(s(452));return r;case"head":if(r=i.head,!r)throw Error(s(453));return r;case"body":if(r=i.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function cu(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);Fa(r)}var dr=new Map,Tv=new Set;function xd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ri=H.d;H.d={f:M1,r:k1,D:N1,C:P1,L:V1,m:L1,X:z1,S:U1,M:B1};function M1(){var r=Ri.f(),i=md();return r||i}function k1(r){var i=er(r);i!==null&&i.tag===5&&i.type==="form"?F_(i):Ri.r(r)}var wo=typeof document>"u"?null:document;function Av(r,i,a){var u=wo;if(u&&typeof i=="string"&&i){var g=In(i);g='link[rel="'+r+'"][href="'+g+'"]',typeof a=="string"&&(g+='[crossorigin="'+a+'"]'),Tv.has(g)||(Tv.add(g),r={rel:r,crossOrigin:a,href:i},u.querySelector(g)===null&&(i=u.createElement("link"),fn(i,"link",r),Bt(i),u.head.appendChild(i)))}}function N1(r){Ri.D(r),Av("dns-prefetch",r,null)}function P1(r,i){Ri.C(r,i),Av("preconnect",r,i)}function V1(r,i,a){Ri.L(r,i,a);var u=wo;if(u&&r&&i){var g='link[rel="preload"][as="'+In(i)+'"]';i==="image"&&a&&a.imageSrcSet?(g+='[imagesrcset="'+In(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(g+='[imagesizes="'+In(a.imageSizes)+'"]')):g+='[href="'+In(r)+'"]';var y=g;switch(i){case"style":y=To(r);break;case"script":y=Ao(r)}dr.has(y)||(r=v({rel:"preload",href:i==="image"&&a&&a.imageSrcSet?void 0:r,as:i},a),dr.set(y,r),u.querySelector(g)!==null||i==="style"&&u.querySelector(du(y))||i==="script"&&u.querySelector(hu(y))||(i=u.createElement("link"),fn(i,"link",r),Bt(i),u.head.appendChild(i)))}}function L1(r,i){Ri.m(r,i);var a=wo;if(a&&r){var u=i&&typeof i.as=="string"?i.as:"script",g='link[rel="modulepreload"][as="'+In(u)+'"][href="'+In(r)+'"]',y=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Ao(r)}if(!dr.has(y)&&(r=v({rel:"modulepreload",href:r},i),dr.set(y,r),a.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(hu(y)))return}u=a.createElement("link"),fn(u,"link",r),Bt(u),a.head.appendChild(u)}}}function U1(r,i,a){Ri.S(r,i,a);var u=wo;if(u&&r){var g=zr(u).hoistableStyles,y=To(r);i=i||"default";var S=g.get(y);if(!S){var M={loading:0,preload:null};if(S=u.querySelector(du(y)))M.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":i},a),(a=dr.get(y))&&Xm(r,a);var G=S=u.createElement("link");Bt(G),fn(G,"link",r),G._p=new Promise(function(re,ue){G.onload=re,G.onerror=ue}),G.addEventListener("load",function(){M.loading|=1}),G.addEventListener("error",function(){M.loading|=2}),M.loading|=4,wd(S,i,u)}S={type:"stylesheet",instance:S,count:1,state:M},g.set(y,S)}}}function z1(r,i){Ri.X(r,i);var a=wo;if(a&&r){var u=zr(a).hoistableScripts,g=Ao(r),y=u.get(g);y||(y=a.querySelector(hu(g)),y||(r=v({src:r,async:!0},i),(i=dr.get(g))&&Jm(r,i),y=a.createElement("script"),Bt(y),fn(y,"link",r),a.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function B1(r,i){Ri.M(r,i);var a=wo;if(a&&r){var u=zr(a).hoistableScripts,g=Ao(r),y=u.get(g);y||(y=a.querySelector(hu(g)),y||(r=v({src:r,async:!0,type:"module"},i),(i=dr.get(g))&&Jm(r,i),y=a.createElement("script"),Bt(y),fn(y,"link",r),a.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function Cv(r,i,a,u){var g=(g=Ee.current)?xd(g):null;if(!g)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(i=To(a.href),a=zr(g).hoistableStyles,u=a.get(i),u||(u={type:"style",instance:null,count:0,state:null},a.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){r=To(a.href);var y=zr(g).hoistableStyles,S=y.get(r);if(S||(g=g.ownerDocument||g,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,S),(y=g.querySelector(du(r)))&&!y._p&&(S.instance=y,S.state.loading=5),dr.has(r)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},dr.set(r,a),y||F1(g,r,a,S.state))),i&&u===null)throw Error(s(528,""));return S}if(i&&u!==null)throw Error(s(529,""));return null;case"script":return i=a.async,a=a.src,typeof a=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Ao(a),a=zr(g).hoistableScripts,u=a.get(i),u||(u={type:"script",instance:null,count:0,state:null},a.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function To(r){return'href="'+In(r)+'"'}function du(r){return'link[rel="stylesheet"]['+r+"]"}function Rv(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function F1(r,i,a,u){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=r.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),fn(i,"link",a),Bt(i),r.head.appendChild(i))}function Ao(r){return'[src="'+In(r)+'"]'}function hu(r){return"script[async]"+r}function Dv(r,i,a){if(i.count++,i.instance===null)switch(i.type){case"style":var u=r.querySelector('style[data-href~="'+In(a.href)+'"]');if(u)return i.instance=u,Bt(u),u;var g=v({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),Bt(u),fn(u,"style",g),wd(u,a.precedence,r),i.instance=u;case"stylesheet":g=To(a.href);var y=r.querySelector(du(g));if(y)return i.state.loading|=4,i.instance=y,Bt(y),y;u=Rv(a),(g=dr.get(g))&&Xm(u,g),y=(r.ownerDocument||r).createElement("link"),Bt(y);var S=y;return S._p=new Promise(function(M,G){S.onload=M,S.onerror=G}),fn(y,"link",u),i.state.loading|=4,wd(y,a.precedence,r),i.instance=y;case"script":return y=Ao(a.src),(g=r.querySelector(hu(y)))?(i.instance=g,Bt(g),g):(u=a,(g=dr.get(y))&&(u=v({},a),Jm(u,g)),r=r.ownerDocument||r,g=r.createElement("script"),Bt(g),fn(g,"link",u),r.head.appendChild(g),i.instance=g);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,wd(u,a.precedence,r));return i.instance}function wd(r,i,a){for(var u=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,y=g,S=0;S<u.length;S++){var M=u[S];if(M.dataset.precedence===i)y=M;else if(y!==g)break}y?y.parentNode.insertBefore(r,y.nextSibling):(i=a.nodeType===9?a.head:a,i.insertBefore(r,i.firstChild))}function Xm(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function Jm(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var Td=null;function Iv(r,i,a){if(Td===null){var u=new Map,g=Td=new Map;g.set(a,u)}else g=Td,u=g.get(a),u||(u=new Map,g.set(a,u));if(u.has(r))return u;for(u.set(r,null),a=a.getElementsByTagName(r),g=0;g<a.length;g++){var y=a[g];if(!(y[Lr]||y[zt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var S=y.getAttribute(i)||"";S=r+S;var M=u.get(S);M?M.push(y):u.set(S,[y])}}return u}function Ov(r,i,a){r=r.ownerDocument||r,r.head.insertBefore(a,i==="title"?r.querySelector("head > title"):null)}function q1(r,i,a){if(a===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(r=i.disabled,typeof i.precedence=="string"&&r==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function jv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function H1(r,i,a,u){if(a.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var g=To(u.href),y=i.querySelector(du(g));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(r.count++,r=Ad.bind(r),i.then(r,r)),a.state.loading|=4,a.instance=y,Bt(y);return}y=i.ownerDocument||i,u=Rv(u),(g=dr.get(g))&&Xm(u,g),y=y.createElement("link"),Bt(y);var S=y;S._p=new Promise(function(M,G){S.onload=M,S.onerror=G}),fn(y,"link",u),a.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(a,i),(i=a.state.preload)&&(a.state.loading&3)===0&&(r.count++,a=Ad.bind(r),i.addEventListener("load",a),i.addEventListener("error",a))}}var Zm=0;function G1(r,i){return r.stylesheets&&r.count===0&&Rd(r,r.stylesheets),0<r.count||0<r.imgCount?function(a){var u=setTimeout(function(){if(r.stylesheets&&Rd(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+i);0<r.imgBytes&&Zm===0&&(Zm=62500*T1());var g=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Rd(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>Zm?50:800)+i);return r.unsuspend=a,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function Ad(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Rd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Cd=null;function Rd(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Cd=new Map,i.forEach(Q1,r),Cd=null,Ad.call(r))}function Q1(r,i){if(!(i.state.loading&4)){var a=Cd.get(r);if(a)var u=a.get(null);else{a=new Map,Cd.set(r,a);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var S=g[y];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(a.set(S.dataset.precedence,S),u=S)}u&&a.set(null,u)}g=i.instance,S=g.getAttribute("data-precedence"),y=a.get(S)||u,y===u&&a.set(null,g),a.set(S,g),this.count++,u=Ad.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),y?y.parentNode.insertBefore(g,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),i.state.loading|=4}}var fu={$$typeof:B,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function K1(r,i,a,u,g,y,S,M,G){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pr(0),this.hiddenUpdates=Pr(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function Mv(r,i,a,u,g,y,S,M,G,re,ue,me){return r=new K1(r,i,a,S,G,re,ue,me,M),i=1,y===!0&&(i|=24),y=Hn(3,null,null,i),r.current=y,y.stateNode=r,i=jf(),i.refCount++,r.pooledCache=i,i.refCount++,y.memoizedState={element:u,isDehydrated:a,cache:i},Pf(y),r}function kv(r){return r?(r=no,r):no}function Nv(r,i,a,u,g,y){g=kv(g),u.context===null?u.context=g:u.pendingContext=g,u=as(i),u.payload={element:a},y=y===void 0?null:y,y!==null&&(u.callback=y),a=os(r,u,i),a!==null&&(Pn(a,r,i),Gl(a,r,i))}function Pv(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var a=r.retryLane;r.retryLane=a!==0&&a<i?a:i}}function ep(r,i){Pv(r,i),(r=r.alternate)&&Pv(r,i)}function Vv(r){if(r.tag===13||r.tag===31){var i=ha(r,67108864);i!==null&&Pn(i,r,67108864),ep(r,67108864)}}function Lv(r){if(r.tag===13||r.tag===31){var i=Yn();i=ea(i);var a=ha(r,i);a!==null&&Pn(a,r,i),ep(r,i)}}var Dd=!0;function $1(r,i,a,u){var g=L.T;L.T=null;var y=H.p;try{H.p=2,tp(r,i,a,u)}finally{H.p=y,L.T=g}}function Y1(r,i,a,u){var g=L.T;L.T=null;var y=H.p;try{H.p=8,tp(r,i,a,u)}finally{H.p=y,L.T=g}}function tp(r,i,a,u){if(Dd){var g=np(u);if(g===null)Bm(r,i,u,Id,a),zv(r,u);else if(X1(g,r,i,a,u))u.stopPropagation();else if(zv(r,u),i&4&&-1<W1.indexOf(r)){for(;g!==null;){var y=er(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var S=kr(y.pendingLanes);if(S!==0){var M=y;for(M.pendingLanes|=2,M.entangledLanes|=2;S;){var G=1<<31-Mt(S);M.entanglements[1]|=G,S&=~G}Zr(y),(ot&6)===0&&(hd=Cn()+500,ou(0))}}break;case 31:case 13:M=ha(y,2),M!==null&&Pn(M,y,2),md(),ep(y,2)}if(y=np(u),y===null&&Bm(r,i,u,Id,a),y===g)break;g=y}g!==null&&u.stopPropagation()}else Bm(r,i,u,null,a)}}function np(r){return r=tr(r),rp(r)}var Id=null;function rp(r){if(Id=null,r=Ur(r),r!==null){var i=l(r);if(i===null)r=null;else{var a=i.tag;if(a===13){if(r=c(i),r!==null)return r;r=null}else if(a===31){if(r=p(i),r!==null)return r;r=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return Id=r,null}function Uv(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ws()){case gl:return 2;case yl:return 8;case Gi:case uf:return 32;case lc:return 268435456;default:return 32}default:return 32}}var ip=!1,_s=null,vs=null,bs=null,mu=new Map,pu=new Map,Es=[],W1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function zv(r,i){switch(r){case"focusin":case"focusout":_s=null;break;case"dragenter":case"dragleave":vs=null;break;case"mouseover":case"mouseout":bs=null;break;case"pointerover":case"pointerout":mu.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":pu.delete(i.pointerId)}}function gu(r,i,a,u,g,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:a,eventSystemFlags:u,nativeEvent:y,targetContainers:[g]},i!==null&&(i=er(i),i!==null&&Vv(i)),r):(r.eventSystemFlags|=u,i=r.targetContainers,g!==null&&i.indexOf(g)===-1&&i.push(g),r)}function X1(r,i,a,u,g){switch(i){case"focusin":return _s=gu(_s,r,i,a,u,g),!0;case"dragenter":return vs=gu(vs,r,i,a,u,g),!0;case"mouseover":return bs=gu(bs,r,i,a,u,g),!0;case"pointerover":var y=g.pointerId;return mu.set(y,gu(mu.get(y)||null,r,i,a,u,g)),!0;case"gotpointercapture":return y=g.pointerId,pu.set(y,gu(pu.get(y)||null,r,i,a,u,g)),!0}return!1}function Bv(r){var i=Ur(r.target);if(i!==null){var a=l(i);if(a!==null){if(i=a.tag,i===13){if(i=c(a),i!==null){r.blockedOn=i,_r(r.priority,function(){Lv(a)});return}}else if(i===31){if(i=p(a),i!==null){r.blockedOn=i,_r(r.priority,function(){Lv(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){r.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Od(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var a=np(r.nativeEvent);if(a===null){a=r.nativeEvent;var u=new a.constructor(a.type,a);Dl=u,a.target.dispatchEvent(u),Dl=null}else return i=er(a),i!==null&&Vv(i),r.blockedOn=a,!1;i.shift()}return!0}function Fv(r,i,a){Od(r)&&a.delete(i)}function J1(){ip=!1,_s!==null&&Od(_s)&&(_s=null),vs!==null&&Od(vs)&&(vs=null),bs!==null&&Od(bs)&&(bs=null),mu.forEach(Fv),pu.forEach(Fv)}function jd(r,i){r.blockedOn===i&&(r.blockedOn=null,ip||(ip=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,J1)))}var Md=null;function qv(r){Md!==r&&(Md=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Md===r&&(Md=null);for(var i=0;i<r.length;i+=3){var a=r[i],u=r[i+1],g=r[i+2];if(typeof u!="function"){if(rp(u||a)===null)continue;break}var y=er(a);y!==null&&(r.splice(i,3),i-=3,nm(y,{pending:!0,data:g,method:a.method,action:u},u,g))}}))}function Co(r){function i(G){return jd(G,r)}_s!==null&&jd(_s,r),vs!==null&&jd(vs,r),bs!==null&&jd(bs,r),mu.forEach(i),pu.forEach(i);for(var a=0;a<Es.length;a++){var u=Es[a];u.blockedOn===r&&(u.blockedOn=null)}for(;0<Es.length&&(a=Es[0],a.blockedOn===null);)Bv(a),a.blockedOn===null&&Es.shift();if(a=(r.ownerDocument||r).$$reactFormReplay,a!=null)for(u=0;u<a.length;u+=3){var g=a[u],y=a[u+1],S=g[nn]||null;if(typeof y=="function")S||qv(a);else if(S){var M=null;if(y&&y.hasAttribute("formAction")){if(g=y,S=y[nn]||null)M=S.formAction;else if(rp(g)!==null)continue}else M=S.action;typeof M=="function"?a[u+1]=M:(a.splice(u,3),u-=3),qv(a)}}}function Hv(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(S){return g=S})},focusReset:"manual",scroll:"manual"})}function i(){g!==null&&(g(),g=null),u||setTimeout(a,20)}function a(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(a,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),g!==null&&(g(),g=null)}}}function sp(r){this._internalRoot=r}kd.prototype.render=sp.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(s(409));var a=i.current,u=Yn();Nv(a,u,r,i,null,null)},kd.prototype.unmount=sp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Nv(r.current,2,null,r,null,null),md(),i[Vr]=null}};function kd(r){this._internalRoot=r}kd.prototype.unstable_scheduleHydration=function(r){if(r){var i=mc();r={blockedOn:null,target:r,priority:i};for(var a=0;a<Es.length&&i!==0&&i<Es[a].priority;a++);Es.splice(a,0,r),a===0&&Bv(r)}};var Gv=e.version;if(Gv!=="19.2.3")throw Error(s(527,Gv,"19.2.3"));H.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=m(i),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var Z1={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nd.isDisabled&&Nd.supportsFiber)try{gr=Nd.inject(Z1),ln=Nd}catch{}}return _u.createRoot=function(r,i){if(!o(r))throw Error(s(299));var a=!1,u="",g=J_,y=Z_,S=e0;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(y=i.onCaughtError),i.onRecoverableError!==void 0&&(S=i.onRecoverableError)),i=Mv(r,1,!1,null,null,a,u,null,g,y,S,Hv),r[Vr]=i.current,zm(r),new sp(i)},_u.hydrateRoot=function(r,i,a){if(!o(r))throw Error(s(299));var u=!1,g="",y=J_,S=Z_,M=e0,G=null;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(g=a.identifierPrefix),a.onUncaughtError!==void 0&&(y=a.onUncaughtError),a.onCaughtError!==void 0&&(S=a.onCaughtError),a.onRecoverableError!==void 0&&(M=a.onRecoverableError),a.formState!==void 0&&(G=a.formState)),i=Mv(r,1,!0,i,a??null,u,g,G,y,S,M,Hv),i.context=kv(null),a=i.current,u=Yn(),u=ea(u),g=as(u),g.callback=null,os(a,g,u),a=u,i.current.lanes=a,Js(i,a),Zr(i),r[Vr]=i.current,zm(r),new kd(i)},_u.version="19.2.3",_u}var tb;function uA(){if(tb)return lp.exports;tb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),lp.exports=lA(),lp.exports}var cA=uA();var nb="popstate";function dA(t={}){function e(s,o){let{pathname:l,search:c,hash:p}=s.location;return Dp("",{pathname:l,search:c,hash:p},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(s,o){return typeof o=="string"?o:Mu(o)}return fA(e,n,null,t)}function Rt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function mr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function hA(){return Math.random().toString(36).substring(2,10)}function rb(t,e){return{usr:t.state,key:t.key,idx:e}}function Dp(t,e,n=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Jo(e):e,state:n,key:e&&e.key||s||hA()}}function Mu({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Jo(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function fA(t,e,n,s={}){let{window:o=document.defaultView,v5Compat:l=!1}=s,c=o.history,p="POP",h=null,m=_();m==null&&(m=0,c.replaceState({...c.state,idx:m},""));function _(){return(c.state||{idx:null}).idx}function v(){p="POP";let O=_(),F=O==null?null:O-m;m=O,h&&h({action:p,location:R.location,delta:F})}function E(O,F){p="PUSH";let q=Dp(R.location,O,F);m=_()+1;let B=rb(q,m),$=R.createHref(q);try{c.pushState(B,"",$)}catch(Y){if(Y instanceof DOMException&&Y.name==="DataCloneError")throw Y;o.location.assign($)}l&&h&&h({action:p,location:R.location,delta:1})}function w(O,F){p="REPLACE";let q=Dp(R.location,O,F);m=_();let B=rb(q,m),$=R.createHref(q);c.replaceState(B,"",$),l&&h&&h({action:p,location:R.location,delta:0})}function A(O){return mA(O)}let R={get action(){return p},get location(){return t(o,c)},listen(O){if(h)throw new Error("A history only accepts one active listener");return o.addEventListener(nb,v),h=O,()=>{o.removeEventListener(nb,v),h=null}},createHref(O){return e(o,O)},createURL:A,encodeLocation(O){let F=A(O);return{pathname:F.pathname,search:F.search,hash:F.hash}},push:E,replace:w,go(O){return c.go(O)}};return R}function mA(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Rt(n,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:Mu(t);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=n+s),new URL(s,n)}function sS(t,e,n="/"){return pA(t,e,n,!1)}function pA(t,e,n,s){let o=typeof e=="string"?Jo(e):e,l=Ni(o.pathname||"/",n);if(l==null)return null;let c=aS(t);gA(c);let p=null;for(let h=0;p==null&&h<c.length;++h){let m=CA(l);p=TA(c[h],m,s)}return p}function aS(t,e=[],n=[],s="",o=!1){let l=(c,p,h=o,m)=>{let _={relativePath:m===void 0?c.path||"":m,caseSensitive:c.caseSensitive===!0,childrenIndex:p,route:c};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(s)&&h)return;Rt(_.relativePath.startsWith(s),`Absolute route path "${_.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(s.length)}let v=Oi([s,_.relativePath]),E=n.concat(_);c.children&&c.children.length>0&&(Rt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),aS(c.children,e,E,v,h)),!(c.path==null&&!c.index)&&e.push({path:v,score:xA(v,c.index),routesMeta:E})};return t.forEach((c,p)=>{if(c.path===""||!c.path?.includes("?"))l(c,p);else for(let h of oS(c.path))l(c,p,!0,h)}),e}function oS(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,o=n.endsWith("?"),l=n.replace(/\?$/,"");if(s.length===0)return o?[l,""]:[l];let c=oS(s.join("/")),p=[];return p.push(...c.map(h=>h===""?l:[l,h].join("/"))),o&&p.push(...c),p.map(h=>t.startsWith("/")&&h===""?"/":h)}function gA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:wA(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var yA=/^:[\w-]+$/,_A=3,vA=2,bA=1,EA=10,SA=-2,ib=t=>t==="*";function xA(t,e){let n=t.split("/"),s=n.length;return n.some(ib)&&(s+=SA),e&&(s+=vA),n.filter(o=>!ib(o)).reduce((o,l)=>o+(yA.test(l)?_A:l===""?bA:EA),s)}function wA(t,e){return t.length===e.length&&t.slice(0,-1).every((s,o)=>s===e[o])?t[t.length-1]-e[e.length-1]:0}function TA(t,e,n=!1){let{routesMeta:s}=t,o={},l="/",c=[];for(let p=0;p<s.length;++p){let h=s[p],m=p===s.length-1,_=l==="/"?e:e.slice(l.length)||"/",v=sh({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},_),E=h.route;if(!v&&m&&n&&!s[s.length-1].route.index&&(v=sh({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},_)),!v)return null;Object.assign(o,v.params),c.push({params:o,pathname:Oi([l,v.pathname]),pathnameBase:OA(Oi([l,v.pathnameBase])),route:E}),v.pathnameBase!=="/"&&(l=Oi([l,v.pathnameBase]))}return c}function sh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=AA(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let l=o[0],c=l.replace(/(.)\/+$/,"$1"),p=o.slice(1);return{params:s.reduce((m,{paramName:_,isOptional:v},E)=>{if(_==="*"){let A=p[E]||"";c=l.slice(0,l.length-A.length).replace(/(.)\/+$/,"$1")}const w=p[E];return v&&!w?m[_]=void 0:m[_]=(w||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:c,pattern:t}}function AA(t,e=!1,n=!0){mr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,p,h)=>(s.push({paramName:p,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(s.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function CA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return mr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ni(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}var lS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,RA=t=>lS.test(t);function DA(t,e="/"){let{pathname:n,search:s="",hash:o=""}=typeof t=="string"?Jo(t):t,l;if(n)if(RA(n))l=n;else{if(n.includes("//")){let c=n;n=n.replace(/\/\/+/g,"/"),mr(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${n}`)}n.startsWith("/")?l=sb(n.substring(1),"/"):l=sb(n,e)}else l=e;return{pathname:l,search:jA(s),hash:MA(o)}}function sb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function hp(t,e,n,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function IA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function mg(t){let e=IA(t);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function pg(t,e,n,s=!1){let o;typeof t=="string"?o=Jo(t):(o={...t},Rt(!o.pathname||!o.pathname.includes("?"),hp("?","pathname","search",o)),Rt(!o.pathname||!o.pathname.includes("#"),hp("#","pathname","hash",o)),Rt(!o.search||!o.search.includes("#"),hp("#","search","hash",o)));let l=t===""||o.pathname==="",c=l?"/":o.pathname,p;if(c==null)p=n;else{let v=e.length-1;if(!s&&c.startsWith("..")){let E=c.split("/");for(;E[0]==="..";)E.shift(),v-=1;o.pathname=E.join("/")}p=v>=0?e[v]:"/"}let h=DA(o,p),m=c&&c!=="/"&&c.endsWith("/"),_=(l||c===".")&&n.endsWith("/");return!h.pathname.endsWith("/")&&(m||_)&&(h.pathname+="/"),h}var Oi=t=>t.join("/").replace(/\/\/+/g,"/"),OA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),jA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,MA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,kA=class{constructor(t,e,n,s=!1){this.status=t,this.statusText=e||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function NA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function PA(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var uS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function cS(t,e){let n=t;if(typeof n!="string"||!lS.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let s=n,o=!1;if(uS)try{let l=new URL(window.location.href),c=n.startsWith("//")?new URL(l.protocol+n):new URL(n),p=Ni(c.pathname,e);c.origin===l.origin&&p!=null?n=p+c.search+c.hash:o=!0}catch{mr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:o,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var dS=["POST","PUT","PATCH","DELETE"];new Set(dS);var VA=["GET",...dS];new Set(VA);var Zo=j.createContext(null);Zo.displayName="DataRouter";var jh=j.createContext(null);jh.displayName="DataRouterState";var LA=j.createContext(!1),hS=j.createContext({isTransitioning:!1});hS.displayName="ViewTransition";var UA=j.createContext(new Map);UA.displayName="Fetchers";var zA=j.createContext(null);zA.displayName="Await";var Jn=j.createContext(null);Jn.displayName="Navigation";var qu=j.createContext(null);qu.displayName="Location";var jr=j.createContext({outlet:null,matches:[],isDataRoute:!1});jr.displayName="Route";var gg=j.createContext(null);gg.displayName="RouteError";var fS="REACT_ROUTER_ERROR",BA="REDIRECT",FA="ROUTE_ERROR_RESPONSE";function qA(t){if(t.startsWith(`${fS}:${BA}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function HA(t){if(t.startsWith(`${fS}:${FA}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new kA(e.status,e.statusText,e.data)}catch{}}function GA(t,{relative:e}={}){Rt(el(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=j.useContext(Jn),{hash:o,pathname:l,search:c}=Hu(t,{relative:e}),p=l;return n!=="/"&&(p=l==="/"?n:Oi([n,l])),s.createHref({pathname:p,search:c,hash:o})}function el(){return j.useContext(qu)!=null}function pr(){return Rt(el(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(qu).location}var mS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pS(t){j.useContext(Jn).static||j.useLayoutEffect(t)}function yg(){let{isDataRoute:t}=j.useContext(jr);return t?aC():QA()}function QA(){Rt(el(),"useNavigate() may be used only in the context of a <Router> component.");let t=j.useContext(Zo),{basename:e,navigator:n}=j.useContext(Jn),{matches:s}=j.useContext(jr),{pathname:o}=pr(),l=JSON.stringify(mg(s)),c=j.useRef(!1);return pS(()=>{c.current=!0}),j.useCallback((h,m={})=>{if(mr(c.current,mS),!c.current)return;if(typeof h=="number"){n.go(h);return}let _=pg(h,JSON.parse(l),o,m.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:Oi([e,_.pathname])),(m.replace?n.replace:n.push)(_,m.state,m)},[e,n,l,o,t])}var KA=j.createContext(null);function $A(t){let e=j.useContext(jr).outlet;return j.useMemo(()=>e&&j.createElement(KA.Provider,{value:t},e),[e,t])}function Hu(t,{relative:e}={}){let{matches:n}=j.useContext(jr),{pathname:s}=pr(),o=JSON.stringify(mg(n));return j.useMemo(()=>pg(t,JSON.parse(o),s,e==="path"),[t,o,s,e])}function YA(t,e){return gS(t,e)}function gS(t,e,n,s,o){Rt(el(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=j.useContext(Jn),{matches:c}=j.useContext(jr),p=c[c.length-1],h=p?p.params:{},m=p?p.pathname:"/",_=p?p.pathnameBase:"/",v=p&&p.route;{let q=v&&v.path||"";_S(m,!v||q.endsWith("*")||q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${q}"> to <Route path="${q==="/"?"*":`${q}/*`}">.`)}let E=pr(),w;if(e){let q=typeof e=="string"?Jo(e):e;Rt(_==="/"||q.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${q.pathname}" was given in the \`location\` prop.`),w=q}else w=E;let A=w.pathname||"/",R=A;if(_!=="/"){let q=_.replace(/^\//,"").split("/");R="/"+A.replace(/^\//,"").split("/").slice(q.length).join("/")}let O=sS(t,{pathname:R});mr(v||O!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),mr(O==null||O[O.length-1].route.element!==void 0||O[O.length-1].route.Component!==void 0||O[O.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let F=eC(O&&O.map(q=>Object.assign({},q,{params:Object.assign({},h,q.params),pathname:Oi([_,l.encodeLocation?l.encodeLocation(q.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:q.pathname]),pathnameBase:q.pathnameBase==="/"?_:Oi([_,l.encodeLocation?l.encodeLocation(q.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:q.pathnameBase])})),c,n,s,o);return e&&F?j.createElement(qu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},F):F}function WA(){let t=sC(),e=NA(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},l={padding:"2px 4px",backgroundColor:s},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:l},"ErrorBoundary")," or"," ",j.createElement("code",{style:l},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),n?j.createElement("pre",{style:o},n):null,c)}var XA=j.createElement(WA,null),yS=class extends j.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=HA(t.digest);n&&(t=n)}let e=t!==void 0?j.createElement(jr.Provider,{value:this.props.routeContext},j.createElement(gg.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?j.createElement(JA,{error:t},e):e}};yS.contextType=LA;var fp=new WeakMap;function JA({children:t,error:e}){let{basename:n}=j.useContext(Jn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let s=qA(e.digest);if(s){let o=fp.get(e);if(o)throw o;let l=cS(s.location,n);if(uS&&!fp.get(e))if(l.isExternal||s.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:s.replace}));throw fp.set(e,c),c}return j.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function ZA({routeContext:t,match:e,children:n}){let s=j.useContext(Zo);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),j.createElement(jr.Provider,{value:t},n)}function eC(t,e=[],n=null,s=null,o=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=n?.errors;if(c!=null){let _=l.findIndex(v=>v.route.id&&c?.[v.route.id]!==void 0);Rt(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let p=!1,h=-1;if(n)for(let _=0;_<l.length;_++){let v=l[_];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(h=_),v.route.id){let{loaderData:E,errors:w}=n,A=v.route.loader&&!E.hasOwnProperty(v.route.id)&&(!w||w[v.route.id]===void 0);if(v.route.lazy||A){p=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}let m=n&&s?(_,v)=>{s(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:PA(n.matches),errorInfo:v})}:void 0;return l.reduceRight((_,v,E)=>{let w,A=!1,R=null,O=null;n&&(w=c&&v.route.id?c[v.route.id]:void 0,R=v.route.errorElement||XA,p&&(h<0&&E===0?(_S("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,O=null):h===E&&(A=!0,O=v.route.hydrateFallbackElement||null)));let F=e.concat(l.slice(0,E+1)),q=()=>{let B;return w?B=R:A?B=O:v.route.Component?B=j.createElement(v.route.Component,null):v.route.element?B=v.route.element:B=_,j.createElement(ZA,{match:v,routeContext:{outlet:_,matches:F,isDataRoute:n!=null},children:B})};return n&&(v.route.ErrorBoundary||v.route.errorElement||E===0)?j.createElement(yS,{location:n.location,revalidation:n.revalidation,component:R,error:w,children:q(),routeContext:{outlet:null,matches:F,isDataRoute:!0},onError:m}):q()},null)}function _g(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function tC(t){let e=j.useContext(Zo);return Rt(e,_g(t)),e}function nC(t){let e=j.useContext(jh);return Rt(e,_g(t)),e}function rC(t){let e=j.useContext(jr);return Rt(e,_g(t)),e}function vg(t){let e=rC(t),n=e.matches[e.matches.length-1];return Rt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function iC(){return vg("useRouteId")}function sC(){let t=j.useContext(gg),e=nC("useRouteError"),n=vg("useRouteError");return t!==void 0?t:e.errors?.[n]}function aC(){let{router:t}=tC("useNavigate"),e=vg("useNavigate"),n=j.useRef(!1);return pS(()=>{n.current=!0}),j.useCallback(async(o,l={})=>{mr(n.current,mS),n.current&&(typeof o=="number"?await t.navigate(o):await t.navigate(o,{fromRouteId:e,...l}))},[t,e])}var ab={};function _S(t,e,n){!e&&!ab[t]&&(ab[t]=!0,mr(!1,n))}j.memo(oC);function oC({routes:t,future:e,state:n,onError:s}){return gS(t,void 0,n,s,e)}function vS({to:t,replace:e,state:n,relative:s}){Rt(el(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=j.useContext(Jn);mr(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=j.useContext(jr),{pathname:c}=pr(),p=yg(),h=pg(t,mg(l),c,s==="path"),m=JSON.stringify(h);return j.useEffect(()=>{p(JSON.parse(m),{replace:e,state:n,relative:s})},[p,m,s,e,n]),null}function bg(t){return $A(t.context)}function bn(t){Rt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function lC({basename:t="/",children:e=null,location:n,navigationType:s="POP",navigator:o,static:l=!1,unstable_useTransitions:c}){Rt(!el(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=t.replace(/^\/*/,"/"),h=j.useMemo(()=>({basename:p,navigator:o,static:l,unstable_useTransitions:c,future:{}}),[p,o,l,c]);typeof n=="string"&&(n=Jo(n));let{pathname:m="/",search:_="",hash:v="",state:E=null,key:w="default"}=n,A=j.useMemo(()=>{let R=Ni(m,p);return R==null?null:{location:{pathname:R,search:_,hash:v,state:E,key:w},navigationType:s}},[p,m,_,v,E,w,s]);return mr(A!=null,`<Router basename="${p}"> is not able to match the URL "${m}${_}${v}" because it does not start with the basename, so the <Router> won't render anything.`),A==null?null:j.createElement(Jn.Provider,{value:h},j.createElement(qu.Provider,{children:e,value:A}))}function uC({children:t,location:e}){return YA(Ip(t),e)}function Ip(t,e=[]){let n=[];return j.Children.forEach(t,(s,o)=>{if(!j.isValidElement(s))return;let l=[...e,o];if(s.type===j.Fragment){n.push.apply(n,Ip(s.props.children,l));return}Rt(s.type===bn,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Rt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let c={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=Ip(s.props.children,l)),n.push(c)}),n}var Gd="get",Qd="application/x-www-form-urlencoded";function Mh(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function cC(t){return Mh(t)&&t.tagName.toLowerCase()==="button"}function dC(t){return Mh(t)&&t.tagName.toLowerCase()==="form"}function hC(t){return Mh(t)&&t.tagName.toLowerCase()==="input"}function fC(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function mC(t,e){return t.button===0&&(!e||e==="_self")&&!fC(t)}var Pd=null;function pC(){if(Pd===null)try{new FormData(document.createElement("form"),0),Pd=!1}catch{Pd=!0}return Pd}var gC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function mp(t){return t!=null&&!gC.has(t)?(mr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Qd}"`),null):t}function yC(t,e){let n,s,o,l,c;if(dC(t)){let p=t.getAttribute("action");s=p?Ni(p,e):null,n=t.getAttribute("method")||Gd,o=mp(t.getAttribute("enctype"))||Qd,l=new FormData(t)}else if(cC(t)||hC(t)&&(t.type==="submit"||t.type==="image")){let p=t.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=t.getAttribute("formaction")||p.getAttribute("action");if(s=h?Ni(h,e):null,n=t.getAttribute("formmethod")||p.getAttribute("method")||Gd,o=mp(t.getAttribute("formenctype"))||mp(p.getAttribute("enctype"))||Qd,l=new FormData(p,t),!pC()){let{name:m,type:_,value:v}=t;if(_==="image"){let E=m?`${m}.`:"";l.append(`${E}x`,"0"),l.append(`${E}y`,"0")}else m&&l.append(m,v)}}else{if(Mh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Gd,s=null,o=Qd,c=t}return l&&o==="text/plain"&&(c=l,l=void 0),{action:s,method:n.toLowerCase(),encType:o,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Eg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function _C(t,e,n){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s.pathname==="/"?s.pathname=`_root.${n}`:e&&Ni(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function vC(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function bC(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function EC(t,e,n){let s=await Promise.all(t.map(async o=>{let l=e.routes[o.route.id];if(l){let c=await vC(l,n);return c.links?c.links():[]}return[]}));return TC(s.flat(1).filter(bC).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function ob(t,e,n,s,o,l){let c=(h,m)=>n[m]?h.route.id!==n[m].route.id:!0,p=(h,m)=>n[m].pathname!==h.pathname||n[m].route.path?.endsWith("*")&&n[m].params["*"]!==h.params["*"];return l==="assets"?e.filter((h,m)=>c(h,m)||p(h,m)):l==="data"?e.filter((h,m)=>{let _=s.routes[h.route.id];if(!_||!_.hasLoader)return!1;if(c(h,m)||p(h,m))return!0;if(h.route.shouldRevalidate){let v=h.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function SC(t,e,{includeHydrateFallback:n}={}){return xC(t.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function xC(t){return[...new Set(t)]}function wC(t){let e={},n=Object.keys(t).sort();for(let s of n)e[s]=t[s];return e}function TC(t,e){let n=new Set;return new Set(e),t.reduce((s,o)=>{let l=JSON.stringify(wC(o));return n.has(l)||(n.add(l),s.push({key:l,link:o})),s},[])}function bS(){let t=j.useContext(Zo);return Eg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function AC(){let t=j.useContext(jh);return Eg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Sg=j.createContext(void 0);Sg.displayName="FrameworkContext";function ES(){let t=j.useContext(Sg);return Eg(t,"You must render this element inside a <HydratedRouter> element"),t}function CC(t,e){let n=j.useContext(Sg),[s,o]=j.useState(!1),[l,c]=j.useState(!1),{onFocus:p,onBlur:h,onMouseEnter:m,onMouseLeave:_,onTouchStart:v}=e,E=j.useRef(null);j.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let R=F=>{F.forEach(q=>{c(q.isIntersecting)})},O=new IntersectionObserver(R,{threshold:.5});return E.current&&O.observe(E.current),()=>{O.disconnect()}}},[t]),j.useEffect(()=>{if(s){let R=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(R)}}},[s]);let w=()=>{o(!0)},A=()=>{o(!1),c(!1)};return n?t!=="intent"?[l,E,{}]:[l,E,{onFocus:vu(p,w),onBlur:vu(h,A),onMouseEnter:vu(m,w),onMouseLeave:vu(_,A),onTouchStart:vu(v,w)}]:[!1,E,{}]}function vu(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function RC({page:t,...e}){let{router:n}=bS(),s=j.useMemo(()=>sS(n.routes,t,n.basename),[n.routes,t,n.basename]);return s?j.createElement(IC,{page:t,matches:s,...e}):null}function DC(t){let{manifest:e,routeModules:n}=ES(),[s,o]=j.useState([]);return j.useEffect(()=>{let l=!1;return EC(t,e,n).then(c=>{l||o(c)}),()=>{l=!0}},[t,e,n]),s}function IC({page:t,matches:e,...n}){let s=pr(),{manifest:o,routeModules:l}=ES(),{basename:c}=bS(),{loaderData:p,matches:h}=AC(),m=j.useMemo(()=>ob(t,e,h,o,s,"data"),[t,e,h,o,s]),_=j.useMemo(()=>ob(t,e,h,o,s,"assets"),[t,e,h,o,s]),v=j.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let A=new Set,R=!1;if(e.forEach(F=>{let q=o.routes[F.route.id];!q||!q.hasLoader||(!m.some(B=>B.route.id===F.route.id)&&F.route.id in p&&l[F.route.id]?.shouldRevalidate||q.hasClientLoader?R=!0:A.add(F.route.id))}),A.size===0)return[];let O=_C(t,c,"data");return R&&A.size>0&&O.searchParams.set("_routes",e.filter(F=>A.has(F.route.id)).map(F=>F.route.id).join(",")),[O.pathname+O.search]},[c,p,s,o,m,e,t,l]),E=j.useMemo(()=>SC(_,o),[_,o]),w=DC(_);return j.createElement(j.Fragment,null,v.map(A=>j.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...n})),E.map(A=>j.createElement("link",{key:A,rel:"modulepreload",href:A,...n})),w.map(({key:A,link:R})=>j.createElement("link",{key:A,nonce:n.nonce,...R})))}function OC(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var jC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{jC&&(window.__reactRouterVersion="7.11.0")}catch{}function MC({basename:t,children:e,unstable_useTransitions:n,window:s}){let o=j.useRef();o.current==null&&(o.current=dA({window:s,v5Compat:!0}));let l=o.current,[c,p]=j.useState({action:l.action,location:l.location}),h=j.useCallback(m=>{n===!1?p(m):j.startTransition(()=>p(m))},[n]);return j.useLayoutEffect(()=>l.listen(h),[l,h]),j.createElement(lC,{basename:t,children:e,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:n})}var SS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Dt=j.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:o,reloadDocument:l,replace:c,state:p,target:h,to:m,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:E,...w},A){let{basename:R,unstable_useTransitions:O}=j.useContext(Jn),F=typeof m=="string"&&SS.test(m),q=cS(m,R);m=q.to;let B=GA(m,{relative:o}),[$,Y,X]=CC(s,w),C=VC(m,{replace:c,state:p,target:h,preventScrollReset:_,relative:o,viewTransition:v,unstable_defaultShouldRevalidate:E,unstable_useTransitions:O});function T(k){e&&e(k),k.defaultPrevented||C(k)}let I=j.createElement("a",{...w,...X,href:q.absoluteURL||B,onClick:q.isExternal||l?e:T,ref:OC(A,Y),target:h,"data-discover":!F&&n==="render"?"true":void 0});return $&&!F?j.createElement(j.Fragment,null,I,j.createElement(RC,{page:B})):I});Dt.displayName="Link";var kC=j.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:o=!1,style:l,to:c,viewTransition:p,children:h,...m},_){let v=Hu(c,{relative:m.relative}),E=pr(),w=j.useContext(jh),{navigator:A,basename:R}=j.useContext(Jn),O=w!=null&&FC(v)&&p===!0,F=A.encodeLocation?A.encodeLocation(v).pathname:v.pathname,q=E.pathname,B=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||(q=q.toLowerCase(),B=B?B.toLowerCase():null,F=F.toLowerCase()),B&&R&&(B=Ni(B,R)||B);const $=F!=="/"&&F.endsWith("/")?F.length-1:F.length;let Y=q===F||!o&&q.startsWith(F)&&q.charAt($)==="/",X=B!=null&&(B===F||!o&&B.startsWith(F)&&B.charAt(F.length)==="/"),C={isActive:Y,isPending:X,isTransitioning:O},T=Y?e:void 0,I;typeof s=="function"?I=s(C):I=[s,Y?"active":null,X?"pending":null,O?"transitioning":null].filter(Boolean).join(" ");let k=typeof l=="function"?l(C):l;return j.createElement(Dt,{...m,"aria-current":T,className:I,ref:_,style:k,to:c,viewTransition:p},typeof h=="function"?h(C):h)});kC.displayName="NavLink";var NC=j.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:o,state:l,method:c=Gd,action:p,onSubmit:h,relative:m,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:E,...w},A)=>{let{unstable_useTransitions:R}=j.useContext(Jn),O=zC(),F=BC(p,{relative:m}),q=c.toLowerCase()==="get"?"get":"post",B=typeof p=="string"&&SS.test(p),$=Y=>{if(h&&h(Y),Y.defaultPrevented)return;Y.preventDefault();let X=Y.nativeEvent.submitter,C=X?.getAttribute("formmethod")||c,T=()=>O(X||Y.currentTarget,{fetcherKey:e,method:C,navigate:n,replace:o,state:l,relative:m,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:E});R&&n!==!1?j.startTransition(()=>T()):T()};return j.createElement("form",{ref:A,method:q,action:F,onSubmit:s?h:$,...w,"data-discover":!B&&t==="render"?"true":void 0})});NC.displayName="Form";function PC(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xS(t){let e=j.useContext(Zo);return Rt(e,PC(t)),e}function VC(t,{target:e,replace:n,state:s,preventScrollReset:o,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:p,unstable_useTransitions:h}={}){let m=yg(),_=pr(),v=Hu(t,{relative:l});return j.useCallback(E=>{if(mC(E,e)){E.preventDefault();let w=n!==void 0?n:Mu(_)===Mu(v),A=()=>m(t,{replace:w,state:s,preventScrollReset:o,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:p});h?j.startTransition(()=>A()):A()}},[_,m,v,n,s,e,t,o,l,c,p,h])}var LC=0,UC=()=>`__${String(++LC)}__`;function zC(){let{router:t}=xS("useSubmit"),{basename:e}=j.useContext(Jn),n=iC(),s=t.fetch,o=t.navigate;return j.useCallback(async(l,c={})=>{let{action:p,method:h,encType:m,formData:_,body:v}=yC(l,e);if(c.navigate===!1){let E=c.fetcherKey||UC();await s(E,n,c.action||p,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||h,formEncType:c.encType||m,flushSync:c.flushSync})}else await o(c.action||p,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||h,formEncType:c.encType||m,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[s,o,e,n])}function BC(t,{relative:e}={}){let{basename:n}=j.useContext(Jn),s=j.useContext(jr);Rt(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),l={...Hu(t||".",{relative:e})},c=pr();if(t==null){l.search=c.search;let p=new URLSearchParams(l.search),h=p.getAll("index");if(h.some(_=>_==="")){p.delete("index"),h.filter(v=>v).forEach(v=>p.append("index",v));let _=p.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Oi([n,l.pathname])),Mu(l)}function FC(t,{relative:e}={}){let n=j.useContext(hS);Rt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=xS("useViewTransitionState"),o=Hu(t,{relative:e});if(!n.isTransitioning)return!1;let l=Ni(n.currentLocation.pathname,s)||n.currentLocation.pathname,c=Ni(n.nextLocation.pathname,s)||n.nextLocation.pathname;return sh(o.pathname,c)!=null||sh(o.pathname,l)!=null}const qC=function(){},HC={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:qC},Gu=j.createContext(HC);var tl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},GC={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},QC=class{#e=GC;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Rs=new QC;function KC(t){setTimeout(t,0)}var Ra=typeof window>"u"||"Deno"in globalThis;function Zt(){}function $C(t,e){return typeof t=="function"?t(e):t}function Op(t){return typeof t=="number"&&t>=0&&t!==1/0}function wS(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Is(t,e){return typeof t=="function"?t(e):t}function hr(t,e){return typeof t=="function"?t(e):t}function lb(t,e){const{type:n="all",exact:s,fetchStatus:o,predicate:l,queryKey:c,stale:p}=t;if(c){if(s){if(e.queryHash!==xg(c,e.options))return!1}else if(!ku(e.queryKey,c))return!1}if(n!=="all"){const h=e.isActive();if(n==="active"&&!h||n==="inactive"&&h)return!1}return!(typeof p=="boolean"&&e.isStale()!==p||o&&o!==e.state.fetchStatus||l&&!l(e))}function ub(t,e){const{exact:n,status:s,predicate:o,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(Da(e.options.mutationKey)!==Da(l))return!1}else if(!ku(e.options.mutationKey,l))return!1}return!(s&&e.state.status!==s||o&&!o(e))}function xg(t,e){return(e?.queryKeyHashFn||Da)(t)}function Da(t){return JSON.stringify(t,(e,n)=>jp(n)?Object.keys(n).sort().reduce((s,o)=>(s[o]=n[o],s),{}):n)}function ku(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>ku(t[n],e[n])):!1}var YC=Object.prototype.hasOwnProperty;function TS(t,e){if(t===e)return t;const n=cb(t)&&cb(e);if(!n&&!(jp(t)&&jp(e)))return e;const o=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),c=l.length,p=n?new Array(c):{};let h=0;for(let m=0;m<c;m++){const _=n?m:l[m],v=t[_],E=e[_];if(v===E){p[_]=v,(n?m<o:YC.call(t,_))&&h++;continue}if(v===null||E===null||typeof v!="object"||typeof E!="object"){p[_]=E;continue}const w=TS(v,E);p[_]=w,w===v&&h++}return o===c&&h===o?t:p}function ah(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function cb(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function jp(t){if(!db(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!db(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function db(t){return Object.prototype.toString.call(t)==="[object Object]"}function WC(t){return new Promise(e=>{Rs.setTimeout(e,t)})}function Mp(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?TS(t,e):e}function XC(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function JC(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var wg=Symbol();function AS(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===wg?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function CS(t,e){return typeof t=="function"?t(...e):!!t}var ZC=class extends tl{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!Ra&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Tg=new ZC;function kp(){let t,e;const n=new Promise((o,l)=>{t=o,e=l});n.status="pending",n.catch(()=>{});function s(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{s({status:"fulfilled",value:o}),t(o)},n.reject=o=>{s({status:"rejected",reason:o}),e(o)},n}function eR(t){let e;if(t.then(n=>(e=n,n),Zt)?.catch(Zt),e!==void 0)return{data:e}}function RS(t){return t}function tR(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function nR(t,e,n){const s=()=>{const o=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return o?.catch(Zt),o};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:s()},...t.meta&&{meta:t.meta}}}function rR(t){return t.state.isPaused}function iR(t){return t.state.status==="success"}function sR(t){return!0}function aR(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??rR,s=t.getMutationCache().getAll().flatMap(h=>n(h)?[tR(h)]:[]),o=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??iR,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??sR,c=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??RS,p=t.getQueryCache().getAll().flatMap(h=>o(h)?[nR(h,c,l)]:[]);return{mutations:s,queries:p}}function oR(t,e,n){if(typeof e!="object"||e===null)return;const s=t.getMutationCache(),o=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??RS,c=e.mutations||[],p=e.queries||[];c.forEach(({state:h,...m})=>{s.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...m},h)}),p.forEach(({queryKey:h,state:m,queryHash:_,meta:v,promise:E,dehydratedAt:w})=>{const A=E?eR(E):void 0,R=m.data===void 0?A?.data:m.data,O=R===void 0?R:l(R);let F=o.get(_);const q=F?.state.status==="pending",B=F?.state.fetchStatus==="fetching";if(F){const $=A&&w!==void 0&&w>F.state.dataUpdatedAt;if(m.dataUpdatedAt>F.state.dataUpdatedAt||$){const{fetchStatus:Y,...X}=m;F.setState({...X,data:O})}}else F=o.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:h,queryHash:_,meta:v},{...m,data:O,fetchStatus:"idle",status:O!==void 0?"success":m.status});E&&!q&&!B&&(w===void 0||w>F.state.dataUpdatedAt)&&F.fetch(void 0,{initialPromise:Promise.resolve(E).then(l)}).catch(Zt)})}var lR=KC;function uR(){let t=[],e=0,n=p=>{p()},s=p=>{p()},o=lR;const l=p=>{e?t.push(p):o(()=>{n(p)})},c=()=>{const p=t;t=[],p.length&&o(()=>{s(()=>{p.forEach(h=>{n(h)})})})};return{batch:p=>{let h;e++;try{h=p()}finally{e--,e||c()}return h},batchCalls:p=>(...h)=>{l(()=>{p(...h)})},schedule:l,setNotifyFunction:p=>{n=p},setBatchNotifyFunction:p=>{s=p},setScheduler:p=>{o=p}}}var en=uR(),cR=class extends tl{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!Ra&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},oh=new cR;function dR(t){return Math.min(1e3*2**t,3e4)}function DS(t){return(t??"online")==="online"?oh.isOnline():!0}var Np=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function IS(t){let e=!1,n=0,s;const o=kp(),l=()=>o.status!=="pending",c=R=>{if(!l()){const O=new Np(R);E(O),t.onCancel?.(O)}},p=()=>{e=!0},h=()=>{e=!1},m=()=>Tg.isFocused()&&(t.networkMode==="always"||oh.isOnline())&&t.canRun(),_=()=>DS(t.networkMode)&&t.canRun(),v=R=>{l()||(s?.(),o.resolve(R))},E=R=>{l()||(s?.(),o.reject(R))},w=()=>new Promise(R=>{s=O=>{(l()||m())&&R(O)},t.onPause?.()}).then(()=>{s=void 0,l()||t.onContinue?.()}),A=()=>{if(l())return;let R;const O=n===0?t.initialPromise:void 0;try{R=O??t.fn()}catch(F){R=Promise.reject(F)}Promise.resolve(R).then(v).catch(F=>{if(l())return;const q=t.retry??(Ra?0:3),B=t.retryDelay??dR,$=typeof B=="function"?B(n,F):B,Y=q===!0||typeof q=="number"&&n<q||typeof q=="function"&&q(n,F);if(e||!Y){E(F);return}n++,t.onFail?.(n,F),WC($).then(()=>m()?void 0:w()).then(()=>{e?E(F):A()})})};return{promise:o,status:()=>o.status,cancel:c,continue:()=>(s?.(),o),cancelRetry:p,continueRetry:h,canStart:_,start:()=>(_()?A():w().then(A),o)}}var OS=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Op(this.gcTime)&&(this.#e=Rs.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Ra?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Rs.clearTimeout(this.#e),this.#e=void 0)}},hR=class extends OS{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=fb(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=fb(this.options);n.data!==void 0&&(this.setState(hb(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const s=Mp(this.state.data,e,this.options);return this.#s({data:s,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),s}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then(Zt).catch(Zt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>hr(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===wg||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Is(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!wS(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const h=this.observers.find(m=>m.options.queryFn);h&&this.setOptions(h.options)}const s=new AbortController,o=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(this.#o=!0,s.signal)})},l=()=>{const h=AS(this.options,n),_=(()=>{const v={client:this.#i,queryKey:this.queryKey,meta:this.meta};return o(v),v})();return this.#o=!1,this.options.persister?this.options.persister(h,_,this):h(_)},p=(()=>{const h={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return o(h),h})();this.options.behavior?.onFetch(p,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==p.fetchOptions?.meta)&&this.#s({type:"fetch",meta:p.fetchOptions?.meta}),this.#r=IS({initialPromise:n?.initialPromise,fn:p.fetchFn,onCancel:h=>{h instanceof Np&&h.revert&&this.setState({...this.#t,fetchStatus:"idle"}),s.abort()},onFail:(h,m)=>{this.#s({type:"failed",failureCount:h,error:m})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:p.options.retry,retryDelay:p.options.retryDelay,networkMode:p.options.networkMode,canRun:()=>!0});try{const h=await this.#r.start();if(h===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(h),this.#n.config.onSuccess?.(h,this),this.#n.config.onSettled?.(h,this.state.error,this),h}catch(h){if(h instanceof Np){if(h.silent)return this.#r.promise;if(h.revert){if(this.state.data===void 0)throw h;return this.state.data}}throw this.#s({type:"error",error:h}),this.#n.config.onError?.(h,this),this.#n.config.onSettled?.(this.state.data,h,this),h}finally{this.scheduleGc()}}#s(e){const n=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...jS(s.data,this.options),fetchMeta:e.meta??null};case"success":const o={...s,...hb(e.data,e.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?o:void 0,o;case"error":const l=e.error;return{...s,error:l,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=n(this.state),en.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function jS(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:DS(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function hb(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function fb(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var fR=class extends tl{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=kp(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#u;#c;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),mb(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Pp(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Pp(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#E(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof hr(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#S(),this.#t.setOptions(this.options),e._defaulted&&!ah(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const s=this.hasListeners();s&&pb(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),s&&(this.#t!==n||hr(this.options.enabled,this.#t)!==hr(e.enabled,this.#t)||Is(this.options.staleTime,this.#t)!==Is(e.staleTime,this.#t))&&this.#g();const o=this.#y();s&&(this.#t!==n||hr(this.options.enabled,this.#t)!==hr(e.enabled,this.#t)||o!==this.#l)&&this.#_(o)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return pR(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,s)=>(this.trackProp(s),e?.(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,s))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#S();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Zt)),e}#g(){this.#b();const t=Is(this.options.staleTime,this.#t);if(Ra||this.#i.isStale||!Op(t))return;const n=wS(this.#i.dataUpdatedAt,t)+1;this.#u=Rs.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#E(),this.#l=t,!(Ra||hr(this.options.enabled,this.#t)===!1||!Op(this.#l)||this.#l===0)&&(this.#c=Rs.setInterval(()=>{(this.options.refetchIntervalInBackground||Tg.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#b(){this.#u&&(Rs.clearTimeout(this.#u),this.#u=void 0)}#E(){this.#c&&(Rs.clearInterval(this.#c),this.#c=void 0)}createResult(t,e){const n=this.#t,s=this.options,o=this.#i,l=this.#r,c=this.#a,h=t!==n?t.state:this.#n,{state:m}=t;let _={...m},v=!1,E;if(e._optimisticResults){const T=this.hasListeners(),I=!T&&mb(t,e),k=T&&pb(t,n,e,s);(I||k)&&(_={..._,...jS(m.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:w,errorUpdatedAt:A,status:R}=_;E=_.data;let O=!1;if(e.placeholderData!==void 0&&E===void 0&&R==="pending"){let T;o?.isPlaceholderData&&e.placeholderData===c?.placeholderData?(T=o.data,O=!0):T=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,T!==void 0&&(R="success",E=Mp(o?.data,T,e),v=!0)}if(e.select&&E!==void 0&&!O)if(o&&E===l?.data&&e.select===this.#p)E=this.#h;else try{this.#p=e.select,E=e.select(E),E=Mp(o?.data,E,e),this.#h=E,this.#s=null}catch(T){this.#s=T}this.#s&&(w=this.#s,E=this.#h,A=Date.now(),R="error");const F=_.fetchStatus==="fetching",q=R==="pending",B=R==="error",$=q&&F,Y=E!==void 0,C={status:R,fetchStatus:_.fetchStatus,isPending:q,isSuccess:R==="success",isError:B,isInitialLoading:$,isLoading:$,data:E,dataUpdatedAt:_.dataUpdatedAt,error:w,errorUpdatedAt:A,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>h.dataUpdateCount||_.errorUpdateCount>h.errorUpdateCount,isFetching:F,isRefetching:F&&!q,isLoadingError:B&&!Y,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:B&&Y,isStale:Ag(t,e),refetch:this.refetch,promise:this.#o,isEnabled:hr(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const T=D=>{C.status==="error"?D.reject(C.error):C.data!==void 0&&D.resolve(C.data)},I=()=>{const D=this.#o=C.promise=kp();T(D)},k=this.#o;switch(k.status){case"pending":t.queryHash===n.queryHash&&T(k);break;case"fulfilled":(C.status==="error"||C.data!==k.value)&&I();break;case"rejected":(C.status!=="error"||C.error!==k.reason)&&I();break}}return C}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),ah(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,o=typeof s=="function"?s():s;if(o==="all"||!o&&!this.#m.size)return!0;const l=new Set(o??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(c=>{const p=c;return this.#i[p]!==t[p]&&l.has(p)})};this.#x({listeners:n()})}#S(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#x(t){en.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function mR(t,e){return hr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function mb(t,e){return mR(t,e)||t.state.data!==void 0&&Pp(t,e,e.refetchOnMount)}function Pp(t,e,n){if(hr(e.enabled,t)!==!1&&Is(e.staleTime,t)!=="static"){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&Ag(t,e)}return!1}function pb(t,e,n,s){return(t!==e||hr(s.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Ag(t,n)}function Ag(t,e){return hr(e.enabled,t)!==!1&&t.isStaleByTime(Is(e.staleTime,t))}function pR(t,e){return!ah(t.getCurrentResult(),e)}function gb(t){return{onFetch:(e,n)=>{const s=e.options,o=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],c=e.state.data?.pageParams||[];let p={pages:[],pageParams:[]},h=0;const m=async()=>{let _=!1;const v=A=>{Object.defineProperty(A,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},E=AS(e.options,e.fetchOptions),w=async(A,R,O)=>{if(_)return Promise.reject();if(R==null&&A.pages.length)return Promise.resolve(A);const q=(()=>{const X={client:e.client,queryKey:e.queryKey,pageParam:R,direction:O?"backward":"forward",meta:e.options.meta};return v(X),X})(),B=await E(q),{maxPages:$}=e.options,Y=O?JC:XC;return{pages:Y(A.pages,B,$),pageParams:Y(A.pageParams,R,$)}};if(o&&l.length){const A=o==="backward",R=A?gR:yb,O={pages:l,pageParams:c},F=R(s,O);p=await w(O,F,A)}else{const A=t??l.length;do{const R=h===0?c[0]??s.initialPageParam:yb(s,p);if(h>0&&R==null)break;p=await w(p,R),h++}while(h<A)}return p};e.options.persister?e.fetchFn=()=>e.options.persister?.(m,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=m}}}function yb(t,{pages:e,pageParams:n}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,n[s],n):void 0}function gR(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var yR=class extends OS{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||MS(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},s={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=IS({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(c,p)=>{this.#r({type:"failed",failureCount:c,error:p})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const o=this.state.status==="pending",l=!this.#i.canStart();try{if(o)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,s);const p=await this.options.onMutate?.(e,s);p!==this.state.context&&this.#r({type:"pending",context:p,variables:e,isPaused:l})}const c=await this.#i.start();return await this.#n.config.onSuccess?.(c,e,this.state.context,this,s),await this.options.onSuccess?.(c,e,this.state.context,s),await this.#n.config.onSettled?.(c,null,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(c,null,e,this.state.context,s),this.#r({type:"success",data:c}),c}catch(c){try{throw await this.#n.config.onError?.(c,e,this.state.context,this,s),await this.options.onError?.(c,e,this.state.context,s),await this.#n.config.onSettled?.(void 0,c,this.state.variables,this.state.context,this,s),await this.options.onSettled?.(void 0,c,e,this.state.context,s),c}finally{this.#r({type:"error",error:c})}}finally{this.#n.runNext(this)}}#r(e){const n=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),en.batch(()=>{this.#t.forEach(s=>{s.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function MS(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var _R=class extends tl{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const s=new yR({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(s),s}add(t){this.#e.add(t);const e=Vd(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Vd(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Vd(t);if(typeof e=="string"){const s=this.#t.get(e)?.find(o=>o.state.status==="pending");return!s||s===t}else return!0}runNext(t){const e=Vd(t);return typeof e=="string"?this.#t.get(e)?.find(s=>s!==t&&s.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){en.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>ub(e,n))}findAll(t={}){return this.getAll().filter(e=>ub(t,e))}notify(t){en.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return en.batch(()=>Promise.all(t.map(e=>e.continue().catch(Zt))))}};function Vd(t){return t.options.scope?.id}var vR=class extends tl{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),ah(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&Da(n.mutationKey)!==Da(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??MS();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){en.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,s=this.#t.context,o={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,s,o),this.#i.onSettled?.(e.data,null,n,s,o)):e?.type==="error"&&(this.#i.onError?.(e.error,n,s,o),this.#i.onSettled?.(void 0,e.error,n,s,o))}this.listeners.forEach(n=>{n(this.#t)})})}},bR=class extends tl{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const s=e.queryKey,o=e.queryHash??xg(s,e);let l=this.get(o);return l||(l=new hR({client:t,queryKey:s,queryHash:o,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){en.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>lb(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>lb(t,n)):e}notify(t){en.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){en.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){en.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ER=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new bR,this.#t=t.mutationCache||new _R,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=Tg.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=oh.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),s=n.state.data;return s===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Is(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(s))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(s.queryHash)?.state.data,c=$C(e,l);if(c!==void 0)return this.#e.build(this,s).setData(c,{...n,manual:!0})}setQueriesData(t,e,n){return en.batch(()=>this.#e.findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;en.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return en.batch(()=>(n.findAll(t).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},s=en.batch(()=>this.#e.findAll(t).map(o=>o.cancel(n)));return Promise.all(s).then(Zt).catch(Zt)}invalidateQueries(t,e={}){return en.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},s=en.batch(()=>this.#e.findAll(t).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let l=o.fetch(void 0,n);return n.throwOnError||(l=l.catch(Zt)),o.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(s).then(Zt)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Is(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Zt).catch(Zt)}fetchInfiniteQuery(t){return t.behavior=gb(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Zt).catch(Zt)}ensureInfiniteQueryData(t){return t.behavior=gb(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return oh.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Da(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(s=>{ku(t,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Da(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(s=>{ku(t,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=xg(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===wg&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},kS=j.createContext(void 0),Fi=t=>{const e=j.useContext(kS);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},SR=({client:t,children:e})=>(j.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),f.jsx(kS.Provider,{value:t,children:e})),NS=j.createContext(!1),xR=()=>j.useContext(NS);NS.Provider;function wR(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var TR=j.createContext(wR()),AR=()=>j.useContext(TR),CR=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},RR=t=>{j.useEffect(()=>{t.clearReset()},[t])},DR=({result:t,errorResetBoundary:e,throwOnError:n,query:s,suspense:o})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&(o&&t.data===void 0||CS(n,[t.error,s])),IR=t=>{if(t.suspense){const n=o=>o==="static"?o:Math.max(o??1e3,1e3),s=t.staleTime;t.staleTime=typeof s=="function"?(...o)=>n(s(...o)):n(s),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},OR=(t,e)=>t.isLoading&&t.isFetching&&!e,jR=(t,e)=>t?.suspense&&e.isPending,_b=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function MR(t,e,n){const s=xR(),o=AR(),l=Fi(),c=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c),c._optimisticResults=s?"isRestoring":"optimistic",IR(c),CR(c,o),RR(o);const p=!l.getQueryCache().get(c.queryHash),[h]=j.useState(()=>new e(l,c)),m=h.getOptimisticResult(c),_=!s&&t.subscribed!==!1;if(j.useSyncExternalStore(j.useCallback(v=>{const E=_?h.subscribe(en.batchCalls(v)):Zt;return h.updateResult(),E},[h,_]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),j.useEffect(()=>{h.setOptions(c)},[c,h]),jR(c,m))throw _b(c,h,o);if(DR({result:m,errorResetBoundary:o,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw m.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,m),c.experimental_prefetchInRender&&!Ra&&OR(m,s)&&(p?_b(c,h,o):l.getQueryCache().get(c.queryHash)?.promise)?.catch(Zt).finally(()=>{h.updateResult()}),c.notifyOnChangeProps?m:h.trackResult(m)}function nl(t,e){return MR(t,fR)}function Ct(t,e){const n=Fi(),[s]=j.useState(()=>new vR(n,t));j.useEffect(()=>{s.setOptions(t)},[s,t]);const o=j.useSyncExternalStore(j.useCallback(c=>s.subscribe(en.batchCalls(c)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),l=j.useCallback((c,p)=>{s.mutate(c,p).catch(Zt)},[s]);if(o.error&&CS(s.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:l,mutateAsync:o.mutate}}var kR=["added","removed","updated"];function vb(t){return kR.includes(t)}async function NR({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:s="",hydrateOptions:o}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const c=Date.now()-l.timestamp>n,p=l.buster!==s;if(c||p)return e.removeClient();oR(t,l.clientState,o)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function bb({queryClient:t,persister:e,buster:n="",dehydrateOptions:s}){const o={buster:n,timestamp:Date.now(),clientState:aR(t,s)};await e.persistClient(o)}function PR(t){const e=t.queryClient.getQueryCache().subscribe(s=>{vb(s.type)&&bb(t)}),n=t.queryClient.getMutationCache().subscribe(s=>{vb(s.type)&&bb(t)});return()=>{e(),n()}}function VR(t){let e=!1,n;const s=()=>{e=!0,n?.()},o=NR(t).then(()=>{e||(n=PR(t))});return[s,o]}function pp(){}function LR({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:s=JSON.stringify,deserialize:o=JSON.parse,retry:l}){if(t){const c=p=>{try{t.setItem(e,s(p));return}catch(h){return h}};return{persistClient:UR(p=>{let h=p,m=c(h),_=0;for(;m&&h;)_++,h=l?.({persistedClient:h,error:m,errorCount:_}),h&&(m=c(h))},n),restoreClient:()=>{const p=t.getItem(e);if(p)return o(p)},removeClient:()=>{t.removeItem(e)}}}return{persistClient:pp,restoreClient:pp,removeClient:pp}}function UR(t,e=100){let n=null,s;return function(...o){s=o,n===null&&(n=Rs.setTimeout(()=>{t(...s),n=null},e))}}const Vn=new ER({defaultOptions:{queries:{staleTime:300*1e3,gcTime:1440*60*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}}),zR=LR({storage:typeof window<"u"?window.localStorage:void 0,key:"BUDGET_APP_QUERY_CACHE"});function BR(){typeof window>"u"||VR({queryClient:Vn,persister:zR,maxAge:1440*60*1e3,buster:"v1"})}const se={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};function FR({children:t}){const[e,n]=j.useState(!1);return j.useEffect(()=>{BR();const s=setTimeout(()=>{n(!0)},50);return()=>clearTimeout(s)},[]),e?f.jsx(SR,{client:Vn,children:t}):null}const qR=()=>{};var Eb={};const PS=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let o=t.charCodeAt(s);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},HR=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const o=t[n++];if(o<128)e[s++]=String.fromCharCode(o);else if(o>191&&o<224){const l=t[n++];e[s++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=t[n++],c=t[n++],p=t[n++],h=((o&7)<<18|(l&63)<<12|(c&63)<<6|p&63)-65536;e[s++]=String.fromCharCode(55296+(h>>10)),e[s++]=String.fromCharCode(56320+(h&1023))}else{const l=t[n++],c=t[n++];e[s++]=String.fromCharCode((o&15)<<12|(l&63)<<6|c&63)}}return e.join("")},VS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let o=0;o<t.length;o+=3){const l=t[o],c=o+1<t.length,p=c?t[o+1]:0,h=o+2<t.length,m=h?t[o+2]:0,_=l>>2,v=(l&3)<<4|p>>4;let E=(p&15)<<2|m>>6,w=m&63;h||(w=64,c||(E=64)),s.push(n[_],n[v],n[E],n[w])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(PS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let o=0;o<t.length;){const l=n[t.charAt(o++)],p=o<t.length?n[t.charAt(o)]:0;++o;const m=o<t.length?n[t.charAt(o)]:64;++o;const v=o<t.length?n[t.charAt(o)]:64;if(++o,l==null||p==null||m==null||v==null)throw new GR;const E=l<<2|p>>4;if(s.push(E),m!==64){const w=p<<4&240|m>>2;if(s.push(w),v!==64){const A=m<<6&192|v;s.push(A)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class GR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const QR=function(t){const e=PS(t);return VS.encodeByteArray(e,!0)},lh=function(t){return QR(t).replace(/\./g,"")},LS=function(t){try{return VS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function KR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const $R=()=>KR().__FIREBASE_DEFAULTS__,YR=()=>{if(typeof process>"u"||typeof Eb>"u")return;const t=Eb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},WR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&LS(t[1]);return e&&JSON.parse(e)},kh=()=>{try{return qR()||$R()||YR()||WR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},US=t=>kh()?.emulatorHosts?.[t],XR=t=>{const e=US(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},zS=()=>kh()?.config,BS=t=>kh()?.[`_${t}`];class JR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}function rl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function FS(t){return(await fetch(t,{credentials:"include"})).ok}function ZR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",o=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${s}`,aud:s,iat:o,exp:o+3600,auth_time:o,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[lh(JSON.stringify(n)),lh(JSON.stringify(c)),""].join(".")}const Cu={};function eD(){const t={prod:[],emulator:[]};for(const e of Object.keys(Cu))Cu[e]?t.emulator.push(e):t.prod.push(e);return t}function tD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Sb=!1;function qS(t,e){if(typeof window>"u"||typeof document>"u"||!rl(window.location.host)||Cu[t]===e||Cu[t]||Sb)return;Cu[t]=e;function n(E){return`__firebase__banner__${E}`}const s="__firebase__banner",l=eD().prod.length>0;function c(){const E=document.getElementById(s);E&&E.remove()}function p(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function h(E,w){E.setAttribute("width","24"),E.setAttribute("id",w),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function m(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Sb=!0,c()},E}function _(E,w){E.setAttribute("id",w),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function v(){const E=tD(s),w=n("text"),A=document.getElementById(w)||document.createElement("span"),R=n("learnmore"),O=document.getElementById(R)||document.createElement("a"),F=n("preprendIcon"),q=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const B=E.element;p(B),_(O,R);const $=m();h(q,F),B.append(q,A,O,$),document.body.appendChild(B)}l?(A.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function wn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wn())}function rD(){const t=kh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function aD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oD(){const t=wn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function lD(){return!rD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function uD(){try{return typeof indexedDB=="object"}catch{return!1}}function cD(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(s);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(n){e(n)}})}const dD="FirebaseError";class qi extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=dD,Object.setPrototypeOf(this,qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qu.prototype.create)}}class Qu{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},o=`${this.service}/${e}`,l=this.errors[e],c=l?hD(l,s):"Error",p=`${this.serviceName}: ${c} (${o}).`;return new qi(o,p,s)}}function hD(t,e){return t.replace(fD,(n,s)=>{const o=e[s];return o!=null?String(o):`<${s}?>`})}const fD=/\{\$([^}]+)}/g;function mD(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Vs(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const o of n){if(!s.includes(o))return!1;const l=t[o],c=e[o];if(xb(l)&&xb(c)){if(!Vs(l,c))return!1}else if(l!==c)return!1}for(const o of s)if(!n.includes(o))return!1;return!0}function xb(t){return t!==null&&typeof t=="object"}function Ku(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(o=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Eu(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[o,l]=s.split("=");e[decodeURIComponent(o)]=decodeURIComponent(l)}}),e}function Su(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function pD(t,e){const n=new gD(t,e);return n.subscribe.bind(n)}class gD{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let o;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");yD(e,["next","error","complete"])?o=e:o={next:e,error:n,complete:s},o.next===void 0&&(o.next=gp),o.error===void 0&&(o.error=gp),o.complete===void 0&&(o.complete=gp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function yD(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function gp(){}function on(t){return t&&t._delegate?t._delegate:t}class Ia{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ta="[DEFAULT]";class _D{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new JR;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:n});o&&s.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(bD(e))try{this.getOrInitializeService({instanceIdentifier:Ta})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:o});s.resolve(l)}catch{}}}}clearInstance(e=Ta){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ta){return this.instances.has(e)}getOptions(e=Ta){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[l,c]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(l);s===p&&c.resolve(o)}return o}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),o=this.onInitCallbacks.get(s)??new Set;o.add(e),this.onInitCallbacks.set(s,o);const l=this.instances.get(s);return l&&e(l,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const o of s)try{o(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:vD(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Ta){return this.component?this.component.multipleInstances?e:Ta:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vD(t){return t===Ta?void 0:t}function bD(t){return t.instantiationMode==="EAGER"}class ED{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new _D(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Je||(Je={}));const SD={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},xD=Je.INFO,wD={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},TD=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),o=wD[e];if(o)console[o](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Cg{constructor(e){this.name=e,this._logLevel=xD,this._logHandler=TD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?SD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}const AD=(t,e)=>e.some(n=>t instanceof n);let wb,Tb;function CD(){return wb||(wb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function RD(){return Tb||(Tb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const HS=new WeakMap,Vp=new WeakMap,GS=new WeakMap,yp=new WeakMap,Rg=new WeakMap;function DD(t){const e=new Promise((n,s)=>{const o=()=>{t.removeEventListener("success",l),t.removeEventListener("error",c)},l=()=>{n(Os(t.result)),o()},c=()=>{s(t.error),o()};t.addEventListener("success",l),t.addEventListener("error",c)});return e.then(n=>{n instanceof IDBCursor&&HS.set(n,t)}).catch(()=>{}),Rg.set(e,t),e}function ID(t){if(Vp.has(t))return;const e=new Promise((n,s)=>{const o=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",c),t.removeEventListener("abort",c)},l=()=>{n(),o()},c=()=>{s(t.error||new DOMException("AbortError","AbortError")),o()};t.addEventListener("complete",l),t.addEventListener("error",c),t.addEventListener("abort",c)});Vp.set(t,e)}let Lp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Vp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||GS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Os(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function OD(t){Lp=t(Lp)}function jD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(_p(this),e,...n);return GS.set(s,e.sort?e.sort():[e]),Os(s)}:RD().includes(t)?function(...e){return t.apply(_p(this),e),Os(HS.get(this))}:function(...e){return Os(t.apply(_p(this),e))}}function MD(t){return typeof t=="function"?jD(t):(t instanceof IDBTransaction&&ID(t),AD(t,CD())?new Proxy(t,Lp):t)}function Os(t){if(t instanceof IDBRequest)return DD(t);if(yp.has(t))return yp.get(t);const e=MD(t);return e!==t&&(yp.set(t,e),Rg.set(e,t)),e}const _p=t=>Rg.get(t);function kD(t,e,{blocked:n,upgrade:s,blocking:o,terminated:l}={}){const c=indexedDB.open(t,e),p=Os(c);return s&&c.addEventListener("upgradeneeded",h=>{s(Os(c.result),h.oldVersion,h.newVersion,Os(c.transaction),h)}),n&&c.addEventListener("blocked",h=>n(h.oldVersion,h.newVersion,h)),p.then(h=>{l&&h.addEventListener("close",()=>l()),o&&h.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),p}const ND=["get","getKey","getAll","getAllKeys","count"],PD=["put","add","delete","clear"],vp=new Map;function Ab(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(vp.get(e))return vp.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,o=PD.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(o||ND.includes(n)))return;const l=async function(c,...p){const h=this.transaction(c,o?"readwrite":"readonly");let m=h.store;return s&&(m=m.index(p.shift())),(await Promise.all([m[n](...p),o&&h.done]))[0]};return vp.set(e,l),l}OD(t=>({...t,get:(e,n,s)=>Ab(e,n)||t.get(e,n,s),has:(e,n)=>!!Ab(e,n)||t.has(e,n)}));class VD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(LD(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function LD(t){return t.getComponent()?.type==="VERSION"}const Up="@firebase/app",Cb="0.14.6";const Pi=new Cg("@firebase/app"),UD="@firebase/app-compat",zD="@firebase/analytics-compat",BD="@firebase/analytics",FD="@firebase/app-check-compat",qD="@firebase/app-check",HD="@firebase/auth",GD="@firebase/auth-compat",QD="@firebase/database",KD="@firebase/data-connect",$D="@firebase/database-compat",YD="@firebase/functions",WD="@firebase/functions-compat",XD="@firebase/installations",JD="@firebase/installations-compat",ZD="@firebase/messaging",eI="@firebase/messaging-compat",tI="@firebase/performance",nI="@firebase/performance-compat",rI="@firebase/remote-config",iI="@firebase/remote-config-compat",sI="@firebase/storage",aI="@firebase/storage-compat",oI="@firebase/firestore",lI="@firebase/ai",uI="@firebase/firestore-compat",cI="firebase",dI="12.6.0";const zp="[DEFAULT]",hI={[Up]:"fire-core",[UD]:"fire-core-compat",[BD]:"fire-analytics",[zD]:"fire-analytics-compat",[qD]:"fire-app-check",[FD]:"fire-app-check-compat",[HD]:"fire-auth",[GD]:"fire-auth-compat",[QD]:"fire-rtdb",[KD]:"fire-data-connect",[$D]:"fire-rtdb-compat",[YD]:"fire-fn",[WD]:"fire-fn-compat",[XD]:"fire-iid",[JD]:"fire-iid-compat",[ZD]:"fire-fcm",[eI]:"fire-fcm-compat",[tI]:"fire-perf",[nI]:"fire-perf-compat",[rI]:"fire-rc",[iI]:"fire-rc-compat",[sI]:"fire-gcs",[aI]:"fire-gcs-compat",[oI]:"fire-fst",[uI]:"fire-fst-compat",[lI]:"fire-vertex","fire-js":"fire-js",[cI]:"fire-js-all"};const uh=new Map,fI=new Map,Bp=new Map;function Rb(t,e){try{t.container.addComponent(e)}catch(n){Pi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Fo(t){const e=t.name;if(Bp.has(e))return Pi.debug(`There were multiple attempts to register component ${e}.`),!1;Bp.set(e,t);for(const n of uh.values())Rb(n,t);for(const n of fI.values())Rb(n,t);return!0}function Dg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Rr(t){return t==null?!1:t.settings!==void 0}const mI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},js=new Qu("app","Firebase",mI);class pI{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Ia("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw js.create("app-deleted",{appName:this._name})}}const il=dI;function QS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:zp,automaticDataCollectionEnabled:!0,...e},o=s.name;if(typeof o!="string"||!o)throw js.create("bad-app-name",{appName:String(o)});if(n||(n=zS()),!n)throw js.create("no-options");const l=uh.get(o);if(l){if(Vs(n,l.options)&&Vs(s,l.config))return l;throw js.create("duplicate-app",{appName:o})}const c=new ED(o);for(const h of Bp.values())c.addComponent(h);const p=new pI(n,s,c);return uh.set(o,p),p}function KS(t=zp){const e=uh.get(t);if(!e&&t===zp&&zS())return QS();if(!e)throw js.create("no-app",{appName:t});return e}function Ms(t,e,n){let s=hI[t]??t;n&&(s+=`-${n}`);const o=s.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const c=[`Unable to register library "${s}" with version "${e}":`];o&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pi.warn(c.join(" "));return}Fo(new Ia(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const gI="firebase-heartbeat-database",yI=1,Nu="firebase-heartbeat-store";let bp=null;function $S(){return bp||(bp=kD(gI,yI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Nu)}catch(n){console.warn(n)}}}}).catch(t=>{throw js.create("idb-open",{originalErrorMessage:t.message})})),bp}async function _I(t){try{const n=(await $S()).transaction(Nu),s=await n.objectStore(Nu).get(YS(t));return await n.done,s}catch(e){if(e instanceof qi)Pi.warn(e.message);else{const n=js.create("idb-get",{originalErrorMessage:e?.message});Pi.warn(n.message)}}}async function Db(t,e){try{const s=(await $S()).transaction(Nu,"readwrite");await s.objectStore(Nu).put(e,YS(t)),await s.done}catch(n){if(n instanceof qi)Pi.warn(n.message);else{const s=js.create("idb-set",{originalErrorMessage:n?.message});Pi.warn(s.message)}}}function YS(t){return`${t.name}!${t.options.appId}`}const vI=1024,bI=30;class EI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new xI(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Ib();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats.length>bI){const o=wI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Pi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ib(),{heartbeatsToSend:n,unsentEntries:s}=SI(this._heartbeatsCache.heartbeats),o=lh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Pi.warn(e),""}}}function Ib(){return new Date().toISOString().substring(0,10)}function SI(t,e=vI){const n=[];let s=t.slice();for(const o of t){const l=n.find(c=>c.agent===o.agent);if(l){if(l.dates.push(o.date),Ob(n)>e){l.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),Ob(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class xI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uD()?cD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await _I(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Db(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Db(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ob(t){return lh(JSON.stringify({version:2,heartbeats:t})).length}function wI(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}function TI(t){Fo(new Ia("platform-logger",e=>new VD(e),"PRIVATE")),Fo(new Ia("heartbeat",e=>new EI(e),"PRIVATE")),Ms(Up,Cb,t),Ms(Up,Cb,"esm2020"),Ms("fire-js","")}TI("");var jb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ks,WS;(function(){var t;function e(C,T){function I(){}I.prototype=T.prototype,C.F=T.prototype,C.prototype=new I,C.prototype.constructor=C,C.D=function(k,D,V){for(var N=Array(arguments.length-2),W=2;W<arguments.length;W++)N[W-2]=arguments[W];return T.prototype[D].apply(k,N)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,n),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(C,T,I){I||(I=0);const k=Array(16);if(typeof T=="string")for(var D=0;D<16;++D)k[D]=T.charCodeAt(I++)|T.charCodeAt(I++)<<8|T.charCodeAt(I++)<<16|T.charCodeAt(I++)<<24;else for(D=0;D<16;++D)k[D]=T[I++]|T[I++]<<8|T[I++]<<16|T[I++]<<24;T=C.g[0],I=C.g[1],D=C.g[2];let V=C.g[3],N;N=T+(V^I&(D^V))+k[0]+3614090360&4294967295,T=I+(N<<7&4294967295|N>>>25),N=V+(D^T&(I^D))+k[1]+3905402710&4294967295,V=T+(N<<12&4294967295|N>>>20),N=D+(I^V&(T^I))+k[2]+606105819&4294967295,D=V+(N<<17&4294967295|N>>>15),N=I+(T^D&(V^T))+k[3]+3250441966&4294967295,I=D+(N<<22&4294967295|N>>>10),N=T+(V^I&(D^V))+k[4]+4118548399&4294967295,T=I+(N<<7&4294967295|N>>>25),N=V+(D^T&(I^D))+k[5]+1200080426&4294967295,V=T+(N<<12&4294967295|N>>>20),N=D+(I^V&(T^I))+k[6]+2821735955&4294967295,D=V+(N<<17&4294967295|N>>>15),N=I+(T^D&(V^T))+k[7]+4249261313&4294967295,I=D+(N<<22&4294967295|N>>>10),N=T+(V^I&(D^V))+k[8]+1770035416&4294967295,T=I+(N<<7&4294967295|N>>>25),N=V+(D^T&(I^D))+k[9]+2336552879&4294967295,V=T+(N<<12&4294967295|N>>>20),N=D+(I^V&(T^I))+k[10]+4294925233&4294967295,D=V+(N<<17&4294967295|N>>>15),N=I+(T^D&(V^T))+k[11]+2304563134&4294967295,I=D+(N<<22&4294967295|N>>>10),N=T+(V^I&(D^V))+k[12]+1804603682&4294967295,T=I+(N<<7&4294967295|N>>>25),N=V+(D^T&(I^D))+k[13]+4254626195&4294967295,V=T+(N<<12&4294967295|N>>>20),N=D+(I^V&(T^I))+k[14]+2792965006&4294967295,D=V+(N<<17&4294967295|N>>>15),N=I+(T^D&(V^T))+k[15]+1236535329&4294967295,I=D+(N<<22&4294967295|N>>>10),N=T+(D^V&(I^D))+k[1]+4129170786&4294967295,T=I+(N<<5&4294967295|N>>>27),N=V+(I^D&(T^I))+k[6]+3225465664&4294967295,V=T+(N<<9&4294967295|N>>>23),N=D+(T^I&(V^T))+k[11]+643717713&4294967295,D=V+(N<<14&4294967295|N>>>18),N=I+(V^T&(D^V))+k[0]+3921069994&4294967295,I=D+(N<<20&4294967295|N>>>12),N=T+(D^V&(I^D))+k[5]+3593408605&4294967295,T=I+(N<<5&4294967295|N>>>27),N=V+(I^D&(T^I))+k[10]+38016083&4294967295,V=T+(N<<9&4294967295|N>>>23),N=D+(T^I&(V^T))+k[15]+3634488961&4294967295,D=V+(N<<14&4294967295|N>>>18),N=I+(V^T&(D^V))+k[4]+3889429448&4294967295,I=D+(N<<20&4294967295|N>>>12),N=T+(D^V&(I^D))+k[9]+568446438&4294967295,T=I+(N<<5&4294967295|N>>>27),N=V+(I^D&(T^I))+k[14]+3275163606&4294967295,V=T+(N<<9&4294967295|N>>>23),N=D+(T^I&(V^T))+k[3]+4107603335&4294967295,D=V+(N<<14&4294967295|N>>>18),N=I+(V^T&(D^V))+k[8]+1163531501&4294967295,I=D+(N<<20&4294967295|N>>>12),N=T+(D^V&(I^D))+k[13]+2850285829&4294967295,T=I+(N<<5&4294967295|N>>>27),N=V+(I^D&(T^I))+k[2]+4243563512&4294967295,V=T+(N<<9&4294967295|N>>>23),N=D+(T^I&(V^T))+k[7]+1735328473&4294967295,D=V+(N<<14&4294967295|N>>>18),N=I+(V^T&(D^V))+k[12]+2368359562&4294967295,I=D+(N<<20&4294967295|N>>>12),N=T+(I^D^V)+k[5]+4294588738&4294967295,T=I+(N<<4&4294967295|N>>>28),N=V+(T^I^D)+k[8]+2272392833&4294967295,V=T+(N<<11&4294967295|N>>>21),N=D+(V^T^I)+k[11]+1839030562&4294967295,D=V+(N<<16&4294967295|N>>>16),N=I+(D^V^T)+k[14]+4259657740&4294967295,I=D+(N<<23&4294967295|N>>>9),N=T+(I^D^V)+k[1]+2763975236&4294967295,T=I+(N<<4&4294967295|N>>>28),N=V+(T^I^D)+k[4]+1272893353&4294967295,V=T+(N<<11&4294967295|N>>>21),N=D+(V^T^I)+k[7]+4139469664&4294967295,D=V+(N<<16&4294967295|N>>>16),N=I+(D^V^T)+k[10]+3200236656&4294967295,I=D+(N<<23&4294967295|N>>>9),N=T+(I^D^V)+k[13]+681279174&4294967295,T=I+(N<<4&4294967295|N>>>28),N=V+(T^I^D)+k[0]+3936430074&4294967295,V=T+(N<<11&4294967295|N>>>21),N=D+(V^T^I)+k[3]+3572445317&4294967295,D=V+(N<<16&4294967295|N>>>16),N=I+(D^V^T)+k[6]+76029189&4294967295,I=D+(N<<23&4294967295|N>>>9),N=T+(I^D^V)+k[9]+3654602809&4294967295,T=I+(N<<4&4294967295|N>>>28),N=V+(T^I^D)+k[12]+3873151461&4294967295,V=T+(N<<11&4294967295|N>>>21),N=D+(V^T^I)+k[15]+530742520&4294967295,D=V+(N<<16&4294967295|N>>>16),N=I+(D^V^T)+k[2]+3299628645&4294967295,I=D+(N<<23&4294967295|N>>>9),N=T+(D^(I|~V))+k[0]+4096336452&4294967295,T=I+(N<<6&4294967295|N>>>26),N=V+(I^(T|~D))+k[7]+1126891415&4294967295,V=T+(N<<10&4294967295|N>>>22),N=D+(T^(V|~I))+k[14]+2878612391&4294967295,D=V+(N<<15&4294967295|N>>>17),N=I+(V^(D|~T))+k[5]+4237533241&4294967295,I=D+(N<<21&4294967295|N>>>11),N=T+(D^(I|~V))+k[12]+1700485571&4294967295,T=I+(N<<6&4294967295|N>>>26),N=V+(I^(T|~D))+k[3]+2399980690&4294967295,V=T+(N<<10&4294967295|N>>>22),N=D+(T^(V|~I))+k[10]+4293915773&4294967295,D=V+(N<<15&4294967295|N>>>17),N=I+(V^(D|~T))+k[1]+2240044497&4294967295,I=D+(N<<21&4294967295|N>>>11),N=T+(D^(I|~V))+k[8]+1873313359&4294967295,T=I+(N<<6&4294967295|N>>>26),N=V+(I^(T|~D))+k[15]+4264355552&4294967295,V=T+(N<<10&4294967295|N>>>22),N=D+(T^(V|~I))+k[6]+2734768916&4294967295,D=V+(N<<15&4294967295|N>>>17),N=I+(V^(D|~T))+k[13]+1309151649&4294967295,I=D+(N<<21&4294967295|N>>>11),N=T+(D^(I|~V))+k[4]+4149444226&4294967295,T=I+(N<<6&4294967295|N>>>26),N=V+(I^(T|~D))+k[11]+3174756917&4294967295,V=T+(N<<10&4294967295|N>>>22),N=D+(T^(V|~I))+k[2]+718787259&4294967295,D=V+(N<<15&4294967295|N>>>17),N=I+(V^(D|~T))+k[9]+3951481745&4294967295,C.g[0]=C.g[0]+T&4294967295,C.g[1]=C.g[1]+(D+(N<<21&4294967295|N>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+V&4294967295}s.prototype.v=function(C,T){T===void 0&&(T=C.length);const I=T-this.blockSize,k=this.C;let D=this.h,V=0;for(;V<T;){if(D==0)for(;V<=I;)o(this,C,V),V+=this.blockSize;if(typeof C=="string"){for(;V<T;)if(k[D++]=C.charCodeAt(V++),D==this.blockSize){o(this,k),D=0;break}}else for(;V<T;)if(k[D++]=C[V++],D==this.blockSize){o(this,k),D=0;break}}this.h=D,this.o+=T},s.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var T=1;T<C.length-8;++T)C[T]=0;T=this.o*8;for(var I=C.length-8;I<C.length;++I)C[I]=T&255,T/=256;for(this.v(C),C=Array(16),T=0,I=0;I<4;++I)for(let k=0;k<32;k+=8)C[T++]=this.g[I]>>>k&255;return C};function l(C,T){var I=p;return Object.prototype.hasOwnProperty.call(I,C)?I[C]:I[C]=T(C)}function c(C,T){this.h=T;const I=[];let k=!0;for(let D=C.length-1;D>=0;D--){const V=C[D]|0;k&&V==T||(I[D]=V,k=!1)}this.g=I}var p={};function h(C){return-128<=C&&C<128?l(C,function(T){return new c([T|0],T<0?-1:0)}):new c([C|0],C<0?-1:0)}function m(C){if(isNaN(C)||!isFinite(C))return v;if(C<0)return O(m(-C));const T=[];let I=1;for(let k=0;C>=I;k++)T[k]=C/I|0,I*=4294967296;return new c(T,0)}function _(C,T){if(C.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(C.charAt(0)=="-")return O(_(C.substring(1),T));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=m(Math.pow(T,8));let k=v;for(let V=0;V<C.length;V+=8){var D=Math.min(8,C.length-V);const N=parseInt(C.substring(V,V+D),T);D<8?(D=m(Math.pow(T,D)),k=k.j(D).add(m(N))):(k=k.j(I),k=k.add(m(N)))}return k}var v=h(0),E=h(1),w=h(16777216);t=c.prototype,t.m=function(){if(R(this))return-O(this).m();let C=0,T=1;for(let I=0;I<this.g.length;I++){const k=this.i(I);C+=(k>=0?k:4294967296+k)*T,T*=4294967296}return C},t.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(A(this))return"0";if(R(this))return"-"+O(this).toString(C);const T=m(Math.pow(C,6));var I=this;let k="";for(;;){const D=$(I,T).g;I=F(I,D.j(T));let V=((I.g.length>0?I.g[0]:I.h)>>>0).toString(C);if(I=D,A(I))return V+k;for(;V.length<6;)V="0"+V;k=V+k}},t.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function A(C){if(C.h!=0)return!1;for(let T=0;T<C.g.length;T++)if(C.g[T]!=0)return!1;return!0}function R(C){return C.h==-1}t.l=function(C){return C=F(this,C),R(C)?-1:A(C)?0:1};function O(C){const T=C.g.length,I=[];for(let k=0;k<T;k++)I[k]=~C.g[k];return new c(I,~C.h).add(E)}t.abs=function(){return R(this)?O(this):this},t.add=function(C){const T=Math.max(this.g.length,C.g.length),I=[];let k=0;for(let D=0;D<=T;D++){let V=k+(this.i(D)&65535)+(C.i(D)&65535),N=(V>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);k=N>>>16,V&=65535,N&=65535,I[D]=N<<16|V}return new c(I,I[I.length-1]&-2147483648?-1:0)};function F(C,T){return C.add(O(T))}t.j=function(C){if(A(this)||A(C))return v;if(R(this))return R(C)?O(this).j(O(C)):O(O(this).j(C));if(R(C))return O(this.j(O(C)));if(this.l(w)<0&&C.l(w)<0)return m(this.m()*C.m());const T=this.g.length+C.g.length,I=[];for(var k=0;k<2*T;k++)I[k]=0;for(k=0;k<this.g.length;k++)for(let D=0;D<C.g.length;D++){const V=this.i(k)>>>16,N=this.i(k)&65535,W=C.i(D)>>>16,z=C.i(D)&65535;I[2*k+2*D]+=N*z,q(I,2*k+2*D),I[2*k+2*D+1]+=V*z,q(I,2*k+2*D+1),I[2*k+2*D+1]+=N*W,q(I,2*k+2*D+1),I[2*k+2*D+2]+=V*W,q(I,2*k+2*D+2)}for(C=0;C<T;C++)I[C]=I[2*C+1]<<16|I[2*C];for(C=T;C<2*T;C++)I[C]=0;return new c(I,0)};function q(C,T){for(;(C[T]&65535)!=C[T];)C[T+1]+=C[T]>>>16,C[T]&=65535,T++}function B(C,T){this.g=C,this.h=T}function $(C,T){if(A(T))throw Error("division by zero");if(A(C))return new B(v,v);if(R(C))return T=$(O(C),T),new B(O(T.g),O(T.h));if(R(T))return T=$(C,O(T)),new B(O(T.g),T.h);if(C.g.length>30){if(R(C)||R(T))throw Error("slowDivide_ only works with positive integers.");for(var I=E,k=T;k.l(C)<=0;)I=Y(I),k=Y(k);var D=X(I,1),V=X(k,1);for(k=X(k,2),I=X(I,2);!A(k);){var N=V.add(k);N.l(C)<=0&&(D=D.add(I),V=N),k=X(k,1),I=X(I,1)}return T=F(C,D.j(T)),new B(D,T)}for(D=v;C.l(T)>=0;){for(I=Math.max(1,Math.floor(C.m()/T.m())),k=Math.ceil(Math.log(I)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),V=m(I),N=V.j(T);R(N)||N.l(C)>0;)I-=k,V=m(I),N=V.j(T);A(V)&&(V=E),D=D.add(V),C=F(C,N)}return new B(D,C)}t.B=function(C){return $(this,C).h},t.and=function(C){const T=Math.max(this.g.length,C.g.length),I=[];for(let k=0;k<T;k++)I[k]=this.i(k)&C.i(k);return new c(I,this.h&C.h)},t.or=function(C){const T=Math.max(this.g.length,C.g.length),I=[];for(let k=0;k<T;k++)I[k]=this.i(k)|C.i(k);return new c(I,this.h|C.h)},t.xor=function(C){const T=Math.max(this.g.length,C.g.length),I=[];for(let k=0;k<T;k++)I[k]=this.i(k)^C.i(k);return new c(I,this.h^C.h)};function Y(C){const T=C.g.length+1,I=[];for(let k=0;k<T;k++)I[k]=C.i(k)<<1|C.i(k-1)>>>31;return new c(I,C.h)}function X(C,T){const I=T>>5;T%=32;const k=C.g.length-I,D=[];for(let V=0;V<k;V++)D[V]=T>0?C.i(V+I)>>>T|C.i(V+I+1)<<32-T:C.i(V+I);return new c(D,C.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,WS=s,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=_,ks=c}).apply(typeof jb<"u"?jb:typeof self<"u"?self:typeof window<"u"?window:{});var Ld=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var XS,xu,JS,Kd,Fp,ZS,ex,tx;(function(){var t,e=Object.defineProperty;function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ld=="object"&&Ld];for(var b=0;b<d.length;++b){var x=d[b];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var s=n(this);function o(d,b){if(b)e:{var x=s;d=d.split(".");for(var P=0;P<d.length-1;P++){var ee=d[P];if(!(ee in x))break e;x=x[ee]}d=d[d.length-1],P=x[d],b=b(P),b!=P&&b!=null&&e(x,d,{configurable:!0,writable:!0,value:b})}}o("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(d){return d||function(b){var x=[],P;for(P in b)Object.prototype.hasOwnProperty.call(b,P)&&x.push([P,b[P]]);return x}});var l=l||{},c=this||self;function p(d){var b=typeof d;return b=="object"&&d!=null||b=="function"}function h(d,b,x){return d.call.apply(d.bind,arguments)}function m(d,b,x){return m=h,m.apply(null,arguments)}function _(d,b){var x=Array.prototype.slice.call(arguments,1);return function(){var P=x.slice();return P.push.apply(P,arguments),d.apply(this,P)}}function v(d,b){function x(){}x.prototype=b.prototype,d.Z=b.prototype,d.prototype=new x,d.prototype.constructor=d,d.Ob=function(P,ee,oe){for(var Se=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)Se[Be-2]=arguments[Be];return b.prototype[ee].apply(P,Se)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function w(d){const b=d.length;if(b>0){const x=Array(b);for(let P=0;P<b;P++)x[P]=d[P];return x}return[]}function A(d,b){for(let P=1;P<arguments.length;P++){const ee=arguments[P];var x=typeof ee;if(x=x!="object"?x:ee?Array.isArray(ee)?"array":x:"null",x=="array"||x=="object"&&typeof ee.length=="number"){x=d.length||0;const oe=ee.length||0;d.length=x+oe;for(let Se=0;Se<oe;Se++)d[x+Se]=ee[Se]}else d.push(ee)}}class R{constructor(b,x){this.i=b,this.j=x,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function O(d){c.setTimeout(()=>{throw d},0)}function F(){var d=C;let b=null;return d.g&&(b=d.g,d.g=d.g.next,d.g||(d.h=null),b.next=null),b}class q{constructor(){this.h=this.g=null}add(b,x){const P=B.get();P.set(b,x),this.h?this.h.next=P:this.g=P,this.h=P}}var B=new R(()=>new $,d=>d.reset());class ${constructor(){this.next=this.g=this.h=null}set(b,x){this.h=b,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,X=!1,C=new q,T=()=>{const d=Promise.resolve(void 0);Y=()=>{d.then(I)}};function I(){for(var d;d=F();){try{d.h.call(d.g)}catch(x){O(x)}var b=B;b.j(d),b.h<100&&(b.h++,d.next=b.g,b.g=d)}X=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(d,b){this.type=d,this.g=this.target=b,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var V=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var d=!1,b=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};c.addEventListener("test",x,b),c.removeEventListener("test",x,b)}catch{}return d})();function N(d){return/^[\s\xa0]*$/.test(d)}function W(d,b){D.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,b)}v(W,D),W.prototype.init=function(d,b){const x=this.type=d.type,P=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=b,b=d.relatedTarget,b||(x=="mouseover"?b=d.fromElement:x=="mouseout"&&(b=d.toElement)),this.relatedTarget=b,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&W.Z.h.call(this)},W.prototype.h=function(){W.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var z="closure_listenable_"+(Math.random()*1e6|0),L=0;function H(d,b,x,P,ee){this.listener=d,this.proxy=null,this.src=b,this.type=x,this.capture=!!P,this.ha=ee,this.key=++L,this.da=this.fa=!1}function Q(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ae(d,b,x){for(const P in d)b.call(x,d[P],P,d)}function ce(d,b){for(const x in d)b.call(void 0,d[x],x,d)}function U(d){const b={};for(const x in d)b[x]=d[x];return b}const te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function be(d,b){let x,P;for(let ee=1;ee<arguments.length;ee++){P=arguments[ee];for(x in P)d[x]=P[x];for(let oe=0;oe<te.length;oe++)x=te[oe],Object.prototype.hasOwnProperty.call(P,x)&&(d[x]=P[x])}}function _e(d){this.src=d,this.g={},this.h=0}_e.prototype.add=function(d,b,x,P,ee){const oe=d.toString();d=this.g[oe],d||(d=this.g[oe]=[],this.h++);const Se=Ee(d,b,P,ee);return Se>-1?(b=d[Se],x||(b.fa=!1)):(b=new H(b,this.src,oe,!!P,ee),b.fa=x,d.push(b)),b};function fe(d,b){const x=b.type;if(x in d.g){var P=d.g[x],ee=Array.prototype.indexOf.call(P,b,void 0),oe;(oe=ee>=0)&&Array.prototype.splice.call(P,ee,1),oe&&(Q(b),d.g[x].length==0&&(delete d.g[x],d.h--))}}function Ee(d,b,x,P){for(let ee=0;ee<d.length;++ee){const oe=d[ee];if(!oe.da&&oe.listener==b&&oe.capture==!!x&&oe.ha==P)return ee}return-1}var we="closure_lm_"+(Math.random()*1e6|0),ge={};function de(d,b,x,P,ee){if(Array.isArray(b)){for(let oe=0;oe<b.length;oe++)de(d,b[oe],x,P,ee);return null}return x=yt(x),d&&d[z]?d.J(b,x,p(P)?!!P.capture:!1,ee):Z(d,b,x,!1,P,ee)}function Z(d,b,x,P,ee,oe){if(!b)throw Error("Invalid event type");const Se=p(ee)?!!ee.capture:!!ee;let Be=ze(d);if(Be||(d[we]=Be=new _e(d)),x=Be.add(b,x,P,Se,oe),x.proxy)return x;if(P=Re(),x.proxy=P,P.src=d,P.listener=x,d.addEventListener)V||(ee=Se),ee===void 0&&(ee=!1),d.addEventListener(b.toString(),P,ee);else if(d.attachEvent)d.attachEvent(Ge(b.toString()),P);else if(d.addListener&&d.removeListener)d.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return x}function Re(){function d(x){return b.call(d.src,d.listener,x)}const b=nt;return d}function xe(d,b,x,P,ee){if(Array.isArray(b))for(var oe=0;oe<b.length;oe++)xe(d,b[oe],x,P,ee);else P=p(P)?!!P.capture:!!P,x=yt(x),d&&d[z]?(d=d.i,oe=String(b).toString(),oe in d.g&&(b=d.g[oe],x=Ee(b,x,P,ee),x>-1&&(Q(b[x]),Array.prototype.splice.call(b,x,1),b.length==0&&(delete d.g[oe],d.h--)))):d&&(d=ze(d))&&(b=d.g[b.toString()],d=-1,b&&(d=Ee(b,x,P,ee)),(x=d>-1?b[d]:null)&&Qe(x))}function Qe(d){if(typeof d!="number"&&d&&!d.da){var b=d.src;if(b&&b[z])fe(b.i,d);else{var x=d.type,P=d.proxy;b.removeEventListener?b.removeEventListener(x,P,d.capture):b.detachEvent?b.detachEvent(Ge(x),P):b.addListener&&b.removeListener&&b.removeListener(P),(x=ze(b))?(fe(x,d),x.h==0&&(x.src=null,b[we]=null)):Q(d)}}}function Ge(d){return d in ge?ge[d]:ge[d]="on"+d}function nt(d,b){if(d.da)d=!0;else{b=new W(b,this);const x=d.listener,P=d.ha||d.src;d.fa&&Qe(d),d=x.call(P,b)}return d}function ze(d){return d=d[we],d instanceof _e?d:null}var Et="__closure_events_fn_"+(Math.random()*1e9>>>0);function yt(d){return typeof d=="function"?d:(d[Et]||(d[Et]=function(b){return d.handleEvent(b)}),d[Et])}function ht(){k.call(this),this.i=new _e(this),this.M=this,this.G=null}v(ht,k),ht.prototype[z]=!0,ht.prototype.removeEventListener=function(d,b,x,P){xe(this,d,b,x,P)};function Xt(d,b){var x,P=d.G;if(P)for(x=[];P;P=P.G)x.push(P);if(d=d.M,P=b.type||b,typeof b=="string")b=new D(b,d);else if(b instanceof D)b.target=b.target||d;else{var ee=b;b=new D(P,d),be(b,ee)}ee=!0;let oe,Se;if(x)for(Se=x.length-1;Se>=0;Se--)oe=b.g=x[Se],ee=Hi(oe,P,!0,b)&&ee;if(oe=b.g=d,ee=Hi(oe,P,!0,b)&&ee,ee=Hi(oe,P,!1,b)&&ee,x)for(Se=0;Se<x.length;Se++)oe=b.g=x[Se],ee=Hi(oe,P,!1,b)&&ee}ht.prototype.N=function(){if(ht.Z.N.call(this),this.i){var d=this.i;for(const b in d.g){const x=d.g[b];for(let P=0;P<x.length;P++)Q(x[P]);delete d.g[b],d.h--}}this.G=null},ht.prototype.J=function(d,b,x,P){return this.i.add(String(d),b,!1,x,P)},ht.prototype.K=function(d,b,x,P){return this.i.add(String(d),b,!0,x,P)};function Hi(d,b,x,P){if(b=d.i.g[String(b)],!b)return!0;b=b.concat();let ee=!0;for(let oe=0;oe<b.length;++oe){const Se=b[oe];if(Se&&!Se.da&&Se.capture==x){const Be=Se.listener,kt=Se.ha||Se.src;Se.fa&&fe(d.i,Se),ee=Be.call(kt,P)!==!1&&ee}}return ee&&!P.defaultPrevented}function lf(d,b){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=m(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:c.setTimeout(d,b||0)}function oc(d){d.g=lf(()=>{d.g=null,d.i&&(d.i=!1,oc(d))},d.l);const b=d.h;d.h=null,d.m.apply(null,b)}class Cn extends k{constructor(b,x){super(),this.m=b,this.l=x,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:oc(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ws(d){k.call(this),this.h=d,this.g={}}v(Ws,k);var gl=[];function yl(d){ae(d.g,function(b,x){this.g.hasOwnProperty(x)&&Qe(b)},d),d.g={}}Ws.prototype.N=function(){Ws.Z.N.call(this),yl(this)},Ws.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Gi=c.JSON.stringify,uf=c.JSON.parse,lc=class{stringify(d){return c.JSON.stringify(d,void 0)}parse(d){return c.JSON.parse(d,void 0)}};function uc(){}function cc(){}var gr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ln(){D.call(this,"d")}v(ln,D);function Zn(){D.call(this,"c")}v(Zn,D);var Mt={},dc=null;function za(){return dc=dc||new ht}Mt.Ia="serverreachability";function hc(d){D.call(this,Mt.Ia,d)}v(hc,D);function Mr(d){const b=za();Xt(b,new hc(b))}Mt.STAT_EVENT="statevent";function Xs(d,b){D.call(this,Mt.STAT_EVENT,d),this.stat=b}v(Xs,D);function Ut(d){const b=za();Xt(b,new Xs(b,d))}Mt.Ja="timingevent";function kr(d,b){D.call(this,Mt.Ja,d),this.size=b}v(kr,D);function Nr(d,b){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){d()},b)}function yr(){this.g=!0}yr.prototype.ua=function(){this.g=!1};function cf(d,b,x,P,ee,oe){d.info(function(){if(d.g)if(oe){var Se="",Be=oe.split("&");for(let at=0;at<Be.length;at++){var kt=Be[at].split("=");if(kt.length>1){const Tt=kt[0];kt=kt[1];const rr=Tt.split("_");Se=rr.length>=2&&rr[1]=="type"?Se+(Tt+"="+kt+"&"):Se+(Tt+"=redacted&")}}}else Se=null;else Se=oe;return"XMLHTTP REQ ("+P+") [attempt "+ee+"]: "+b+`
`+x+`
`+Se})}function fc(d,b,x,P,ee,oe,Se){d.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+ee+"]: "+b+`
`+x+`
`+oe+" "+Se})}function Pr(d,b,x,P){d.info(function(){return"XMLHTTP TEXT ("+b+"): "+df(d,x)+(P?" "+P:"")})}function Js(d,b){d.info(function(){return"TIMEOUT: "+b})}yr.prototype.info=function(){};function df(d,b){if(!d.g)return b;if(!b)return null;try{const oe=JSON.parse(b);if(oe){for(d=0;d<oe.length;d++)if(Array.isArray(oe[d])){var x=oe[d];if(!(x.length<2)){var P=x[1];if(Array.isArray(P)&&!(P.length<1)){var ee=P[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(let Se=1;Se<P.length;Se++)P[Se]=""}}}}return Gi(oe)}catch{return b}}var Zs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},_l={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},vl;function ea(){}v(ea,uc),ea.prototype.g=function(){return new XMLHttpRequest},vl=new ea;function ci(d){return encodeURIComponent(String(d))}function mc(d){var b=1;d=d.split(":");const x=[];for(;b>0&&d.length;)x.push(d.shift()),b--;return d.length&&x.push(d.join(":")),x}function _r(d,b,x,P){this.j=d,this.i=b,this.l=x,this.S=P||1,this.V=new Ws(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new vr}function vr(){this.i=null,this.g="",this.h=!1}var zt={},nn={};function Vr(d,b,x){d.M=1,d.A=ta(Ft(b)),d.u=x,d.R=!0,Ba(d,null)}function Ba(d,b){d.F=Date.now(),Lr(d),d.B=Ft(d.A);var x=d.B,P=d.S;Array.isArray(P)||(P=[String(P)]),Ga(x.i,"t",P),d.C=0,x=d.j.L,d.h=new vr,d.g=Dc(d.j,x?b:null,!d.u),d.P>0&&(d.O=new Cn(m(d.Y,d,d.g),d.P)),b=d.V,x=d.g,P=d.ba;var ee="readystatechange";Array.isArray(ee)||(ee&&(gl[0]=ee.toString()),ee=gl);for(let oe=0;oe<ee.length;oe++){const Se=de(x,ee[oe],P||b.handleEvent,!1,b.h||b);if(!Se)break;b.g[Se.key]=Se}b=d.J?U(d.J):{},d.u?(d.v||(d.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,b)):(d.v="GET",d.g.ea(d.B,d.v,null,b)),Mr(),cf(d.i,d.v,d.B,d.l,d.S,d.u)}_r.prototype.ba=function(d){d=d.target;const b=this.O;b&&Sr(d)==3?b.j():this.Y(d)},_r.prototype.Y=function(d){try{if(d==this.g)e:{const Be=Sr(this.g),kt=this.g.ya(),at=this.g.ca();if(!(Be<3)&&(Be!=3||this.g&&(this.h.h||this.g.la()||un(this.g)))){this.K||Be!=4||kt==7||(kt==8||at<=0?Mr(3):Mr(2)),Ur(this);var b=this.g.ca();this.X=b;var x=hf(this);if(this.o=b==200,fc(this.i,this.v,this.B,this.l,this.S,Be,b),this.o){if(this.U&&!this.L){t:{if(this.g){var P,ee=this.g;if((P=ee.g?ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(P)){var oe=P;break t}}oe=null}if(d=oe)Pr(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,zr(this,d);else{this.o=!1,this.m=3,Ut(12),Bn(this),er(this);break e}}if(this.R){d=!0;let Tt;for(;!this.K&&this.C<x.length;)if(Tt=gc(this,x),Tt==nn){Be==4&&(this.m=4,Ut(14),d=!1),Pr(this.i,this.l,null,"[Incomplete Response]");break}else if(Tt==zt){this.m=4,Ut(15),Pr(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else Pr(this.i,this.l,Tt,null),zr(this,Tt);if(pc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Be!=4||x.length!=0||this.h.h||(this.m=1,Ut(16),d=!1),this.o=this.o&&d,!d)Pr(this.i,this.l,x,"[Invalid Chunked Response]"),Bn(this),er(this);else if(x.length>0&&!this.W){this.W=!0;var Se=this.j;Se.g==this&&Se.aa&&!Se.P&&(Se.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),kl(Se),Se.P=!0,Ut(11))}}else Pr(this.i,this.l,x,null),zr(this,x);Be==4&&Bn(this),this.o&&!this.K&&(Be==4?Tc(this.j,this):(this.o=!1,Lr(this)))}else hi(this.g),b==400&&x.indexOf("Unknown SID")>0?(this.m=3,Ut(12)):(this.m=0,Ut(13)),Bn(this),er(this)}}}catch{}};function hf(d){if(!pc(d))return d.g.la();const b=un(d.g);if(b==="")return"";let x="";const P=b.length,ee=Sr(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Bn(d),er(d),"";d.h.i=new c.TextDecoder}for(let oe=0;oe<P;oe++)d.h.h=!0,x+=d.h.i.decode(b[oe],{stream:!(ee&&oe==P-1)});return b.length=0,d.h.g+=x,d.C=0,d.h.g}function pc(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function gc(d,b){var x=d.C,P=b.indexOf(`
`,x);return P==-1?nn:(x=Number(b.substring(x,P)),isNaN(x)?zt:(P+=1,P+x>b.length?nn:(b=b.slice(P,P+x),d.C=P+x,b)))}_r.prototype.cancel=function(){this.K=!0,Bn(this)};function Lr(d){d.T=Date.now()+d.H,Fa(d,d.H)}function Fa(d,b){if(d.D!=null)throw Error("WatchDog timer not null");d.D=Nr(m(d.aa,d),b)}function Ur(d){d.D&&(c.clearTimeout(d.D),d.D=null)}_r.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(Js(this.i,this.B),this.M!=2&&(Mr(),Ut(17)),Bn(this),this.m=2,er(this)):Fa(this,this.T-d)};function er(d){d.j.I==0||d.K||Tc(d.j,d)}function Bn(d){Ur(d);var b=d.O;b&&typeof b.dispose=="function"&&b.dispose(),d.O=null,yl(d.V),d.g&&(b=d.g,d.g=null,b.abort(),b.dispose())}function zr(d,b){try{var x=d.j;if(x.I!=0&&(x.g==d||Fr(x.h,d))){if(!d.L&&Fr(x.h,d)&&x.I==3){try{var P=x.Ba.g.parse(b)}catch{P=null}if(Array.isArray(P)&&P.length==3){var ee=P;if(ee[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<d.F)Wa(x),Zi(x);else break e;la(x),Ut(18)}}else x.xa=ee[1],0<x.xa-x.K&&ee[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=Nr(m(x.Va,x),6e3));Br(x.h)<=1&&x.ta&&(x.ta=void 0)}else $r(x,11)}else if((d.L||x.g==d)&&Wa(x),!N(b))for(ee=x.Ba.g.parse(b),b=0;b<ee.length;b++){let at=ee[b];const Tt=at[0];if(!(Tt<=x.K))if(x.K=Tt,at=at[1],x.I==2)if(at[0]=="c"){x.M=at[1],x.ba=at[2];const rr=at[3];rr!=null&&(x.ka=rr,x.j.info("VER="+x.ka));const Yr=at[4];Yr!=null&&(x.za=Yr,x.j.info("SVER="+x.za));const xr=at[5];xr!=null&&typeof xr=="number"&&xr>0&&(P=1.5*xr,x.O=P,x.j.info("backChannelRequestTimeoutMs_="+P)),P=x;const wr=d.g;if(wr){const ua=wr.g?wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ua){var oe=P.h;oe.g||ua.indexOf("spdy")==-1&&ua.indexOf("quic")==-1&&ua.indexOf("h2")==-1||(oe.j=oe.l,oe.g=new Set,oe.h&&(Sl(oe,oe.h),oe.h=null))}if(P.G){const Xa=wr.g?wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Xa&&(P.wa=Xa,ut(P.J,P.G,Xa))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-d.F,x.j.info("Handshake RTT: "+x.T+"ms")),P=x;var Se=d;if(P.na=Rc(P,P.L?P.ba:null,P.W),Se.L){xl(P.h,Se);var Be=Se,kt=P.O;kt&&(Be.H=kt),Be.D&&(Ur(Be),Lr(Be)),P.g=Se}else xc(P);x.i.length>0&&Kr(x)}else at[0]!="stop"&&at[0]!="close"||$r(x,7);else x.I==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?$r(x,7):jl(x):at[0]!="noop"&&x.l&&x.l.qa(at),x.A=0)}}Mr(4)}catch{}}var Bt=class{constructor(d,b){this.g=d,this.map=b}};function bl(d){this.l=d||10,c.PerformanceNavigationTiming?(d=c.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function El(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Br(d){return d.h?1:d.g?d.g.size:0}function Fr(d,b){return d.h?d.h==b:d.g?d.g.has(b):!1}function Sl(d,b){d.g?d.g.add(b):d.h=b}function xl(d,b){d.h&&d.h==b?d.h=null:d.g&&d.g.has(b)&&d.g.delete(b)}bl.prototype.cancel=function(){if(this.i=wl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function wl(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let b=d.i;for(const x of d.g.values())b=b.concat(x.G);return b}return w(d.i)}var yc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qa(d,b){if(d){d=d.split("&");for(let x=0;x<d.length;x++){const P=d[x].indexOf("=");let ee,oe=null;P>=0?(ee=d[x].substring(0,P),oe=d[x].substring(P+1)):ee=d[x],b(ee,oe?decodeURIComponent(oe.replace(/\+/g," ")):"")}}}function Fn(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;d instanceof Fn?(this.l=d.l,rn(this,d.j),this.o=d.o,this.g=d.g,Qi(this,d.u),this.h=d.h,Tl(this,Ec(d.i)),this.m=d.m):d&&(b=String(d).match(yc))?(this.l=!1,rn(this,b[1]||"",!0),this.o=qr(b[2]||""),this.g=qr(b[3]||"",!0),Qi(this,b[4]),this.h=qr(b[5]||"",!0),Tl(this,b[6]||"",!0),this.m=qr(b[7]||"")):(this.l=!1,this.i=new $i(null,this.l))}Fn.prototype.toString=function(){const d=[];var b=this.j;b&&d.push(na(b,Ha,!0),":");var x=this.g;return(x||b=="file")&&(d.push("//"),(b=this.o)&&d.push(na(b,Ha,!0),"@"),d.push(ci(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&d.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(na(x,x.charAt(0)=="/"?Al:_c,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",na(x,vc)),d.join("")},Fn.prototype.resolve=function(d){const b=Ft(this);let x=!!d.j;x?rn(b,d.j):x=!!d.o,x?b.o=d.o:x=!!d.g,x?b.g=d.g:x=d.u!=null;var P=d.h;if(x)Qi(b,d.u);else if(x=!!d.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var ee=b.h.lastIndexOf("/");ee!=-1&&(P=b.h.slice(0,ee+1)+P)}if(ee=P,ee==".."||ee==".")P="";else if(ee.indexOf("./")!=-1||ee.indexOf("/.")!=-1){P=ee.lastIndexOf("/",0)==0,ee=ee.split("/");const oe=[];for(let Se=0;Se<ee.length;){const Be=ee[Se++];Be=="."?P&&Se==ee.length&&oe.push(""):Be==".."?((oe.length>1||oe.length==1&&oe[0]!="")&&oe.pop(),P&&Se==ee.length&&oe.push("")):(oe.push(Be),P=!0)}P=oe.join("/")}else P=ee}return x?b.h=P:x=d.i.toString()!=="",x?Tl(b,Ec(d.i)):x=!!d.m,x&&(b.m=d.m),b};function Ft(d){return new Fn(d)}function rn(d,b,x){d.j=x?qr(b,!0):b,d.j&&(d.j=d.j.replace(/:$/,""))}function Qi(d,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);d.u=b}else d.u=null}function Tl(d,b,x){b instanceof $i?(d.i=b,Qa(d.i,d.l)):(x||(b=na(b,Ki)),d.i=new $i(b,d.l))}function ut(d,b,x){d.i.set(b,x)}function ta(d){return ut(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function qr(d,b){return d?b?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function na(d,b,x){return typeof d=="string"?(d=encodeURI(d).replace(b,In),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function In(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Ha=/[#\/\?@]/g,_c=/[#\?:]/g,Al=/[#\?]/g,Ki=/[#\?@]/g,vc=/#/g;function $i(d,b){this.h=this.g=null,this.i=d||null,this.j=!!b}function On(d){d.g||(d.g=new Map,d.h=0,d.i&&qa(d.i,function(b,x){d.add(decodeURIComponent(b.replace(/\+/g," ")),x)}))}t=$i.prototype,t.add=function(d,b){On(this),this.i=null,d=Yi(this,d);let x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(b),this.h+=1,this};function bc(d,b){On(d),b=Yi(d,b),d.g.has(b)&&(d.i=null,d.h-=d.g.get(b).length,d.g.delete(b))}function Cl(d,b){return On(d),b=Yi(d,b),d.g.has(b)}t.forEach=function(d,b){On(this),this.g.forEach(function(x,P){x.forEach(function(ee){d.call(b,ee,P,this)},this)},this)};function Rl(d,b){On(d);let x=[];if(typeof b=="string")Cl(d,b)&&(x=x.concat(d.g.get(Yi(d,b))));else for(d=Array.from(d.g.values()),b=0;b<d.length;b++)x=x.concat(d[b]);return x}t.set=function(d,b){return On(this),this.i=null,d=Yi(this,d),Cl(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[b]),this.h+=1,this},t.get=function(d,b){return d?(d=Rl(this,d),d.length>0?String(d[0]):b):b};function Ga(d,b,x){bc(d,b),x.length>0&&(d.i=null,d.g.set(Yi(d,b),w(x)),d.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],b=Array.from(this.g.keys());for(let P=0;P<b.length;P++){var x=b[P];const ee=ci(x);x=Rl(this,x);for(let oe=0;oe<x.length;oe++){let Se=ee;x[oe]!==""&&(Se+="="+ci(x[oe])),d.push(Se)}}return this.i=d.join("&")};function Ec(d){const b=new $i;return b.i=d.i,d.g&&(b.g=new Map(d.g),b.h=d.h),b}function Yi(d,b){return b=String(b),d.j&&(b=b.toLowerCase()),b}function Qa(d,b){b&&!d.j&&(On(d),d.i=null,d.g.forEach(function(x,P){const ee=P.toLowerCase();P!=ee&&(bc(this,P),Ga(this,ee,x))},d)),d.j=b}function br(d,b){const x=new yr;if(c.Image){const P=new Image;P.onload=_(tr,x,"TestLoadImage: loaded",!0,b,P),P.onerror=_(tr,x,"TestLoadImage: error",!1,b,P),P.onabort=_(tr,x,"TestLoadImage: abort",!1,b,P),P.ontimeout=_(tr,x,"TestLoadImage: timeout",!1,b,P),c.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=d}else b(!1)}function Dl(d,b){const x=new yr,P=new AbortController,ee=setTimeout(()=>{P.abort(),tr(x,"TestPingServer: timeout",!1,b)},1e4);fetch(d,{signal:P.signal}).then(oe=>{clearTimeout(ee),oe.ok?tr(x,"TestPingServer: ok",!0,b):tr(x,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ee),tr(x,"TestPingServer: error",!1,b)})}function tr(d,b,x,P,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),P(x)}catch{}}function Wi(){this.g=new lc}function Hr(d){this.i=d.Sb||null,this.h=d.ab||!1}v(Hr,uc),Hr.prototype.g=function(){return new ra(this.i,this.h)};function ra(d,b){ht.call(this),this.H=d,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(ra,ht),t=ra.prototype,t.open=function(d,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=b,this.readyState=1,Er(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(b.body=d),(this.H||c).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Xi(this)),this.readyState=0},t.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Er(this)),this.g&&(this.readyState=3,Er(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ka(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ka(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}t.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var b=d.value?d.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!d.done}))&&(this.response=this.responseText+=b)}d.done?Xi(this):Er(this),this.readyState==3&&Ka(this)}},t.Oa=function(d){this.g&&(this.response=this.responseText=d,Xi(this))},t.Na=function(d){this.g&&(this.response=d,Xi(this))},t.ga=function(){this.g&&Xi(this)};function Xi(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Er(d)}t.setRequestHeader=function(d,b){this.A.append(d,b)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],b=this.h.entries();for(var x=b.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=b.next();return d.join(`\r
`)};function Er(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(ra.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function nr(d){let b="";return ae(d,function(x,P){b+=P,b+=":",b+=x,b+=`\r
`}),b}function ia(d,b,x){e:{for(P in x){var P=!1;break e}P=!0}P||(x=nr(x),typeof d=="string"?x!=null&&ci(x):ut(d,b,x))}function ft(d){ht.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ft,ht);var Gr=/^https?$/i,Il=["POST","PUT"];t=ft.prototype,t.Fa=function(d){this.H=d},t.ea=function(d,b,x,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);b=b?b.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():vl.g(),this.g.onreadystatechange=E(m(this.Ca,this));try{this.B=!0,this.g.open(b,String(d),!0),this.B=!1}catch(oe){sa(this,oe);return}if(d=x||"",x=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var ee in P)x.set(ee,P[ee]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const oe of P.keys())x.set(oe,P.get(oe));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(x.keys()).find(oe=>oe.toLowerCase()=="content-type"),ee=c.FormData&&d instanceof c.FormData,!(Array.prototype.indexOf.call(Il,b,void 0)>=0)||P||ee||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[oe,Se]of x)this.g.setRequestHeader(oe,Se);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(oe){sa(this,oe)}};function sa(d,b){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=b,d.o=5,Ol(d),di(d)}function Ol(d){d.A||(d.A=!0,Xt(d,"complete"),Xt(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Xt(this,"complete"),Xt(this,"abort"),di(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),di(this,!0)),ft.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?aa(this):this.Xa())},t.Xa=function(){aa(this)};function aa(d){if(d.h&&typeof l<"u"){if(d.v&&Sr(d)==4)setTimeout(d.Ca.bind(d),0);else if(Xt(d,"readystatechange"),Sr(d)==4){d.h=!1;try{const oe=d.ca();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var x;if(!(x=b)){var P;if(P=oe===0){let Se=String(d.D).match(yc)[1]||null;!Se&&c.self&&c.self.location&&(Se=c.self.location.protocol.slice(0,-1)),P=!Gr.test(Se?Se.toLowerCase():"")}x=P}if(x)Xt(d,"complete"),Xt(d,"success");else{d.o=6;try{var ee=Sr(d)>2?d.g.statusText:""}catch{ee=""}d.l=ee+" ["+d.ca()+"]",Ol(d)}}finally{di(d)}}}}function di(d,b){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const x=d.g;d.g=null,b||Xt(d,"ready");try{x.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Sr(d){return d.g?d.g.readyState:0}t.ca=function(){try{return Sr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(d){if(this.g){var b=this.g.responseText;return d&&b.indexOf(d)==0&&(b=b.substring(d.length)),uf(b)}};function un(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function hi(d){const b={};d=(d.g&&Sr(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<d.length;P++){if(N(d[P]))continue;var x=mc(d[P]);const ee=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const oe=b[ee]||[];b[ee]=oe,oe.push(x)}ce(b,function(P){return P.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qr(d,b,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||b}function Ji(d){this.za=0,this.i=[],this.j=new yr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Qr("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Qr("baseRetryDelayMs",5e3,d),this.Za=Qr("retryDelaySeedMs",1e4,d),this.Ta=Qr("forwardChannelMaxRetries",2,d),this.va=Qr("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new bl(d&&d.concurrentRequestLimit),this.Ba=new Wi,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Ji.prototype,t.ka=8,t.I=1,t.connect=function(d,b,x,P){Ut(0),this.W=d,this.H=b||{},x&&P!==void 0&&(this.H.OSID=x,this.H.OAID=P),this.F=this.X,this.J=Rc(this,null,this.W),Kr(this)};function jl(d){if($a(d),d.I==3){var b=d.V++,x=Ft(d.J);if(ut(x,"SID",d.M),ut(x,"RID",b),ut(x,"TYPE","terminate"),oa(d,x),b=new _r(d,d.j,b),b.M=2,b.A=ta(Ft(x)),x=!1,c.navigator&&c.navigator.sendBeacon)try{x=c.navigator.sendBeacon(b.A.toString(),"")}catch{}!x&&c.Image&&(new Image().src=b.A,x=!0),x||(b.g=Dc(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Lr(b)}Cc(d)}function Zi(d){d.g&&(kl(d),d.g.cancel(),d.g=null)}function $a(d){Zi(d),d.v&&(c.clearTimeout(d.v),d.v=null),Wa(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&c.clearTimeout(d.m),d.m=null)}function Kr(d){if(!El(d.h)&&!d.m){d.m=!0;var b=d.Ea;Y||T(),X||(Y(),X=!0),C.add(b,d),d.D=0}}function Ya(d,b){return Br(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=b.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=Nr(m(d.Ea,d,b),Ac(d,d.D)),d.D++,!0)}t.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const ee=new _r(this,this.j,d);let oe=this.o;if(this.U&&(oe?(oe=U(oe),be(oe,this.U)):oe=this.U),this.u!==null||this.R||(ee.J=oe,oe=null),this.S)e:{for(var b=0,x=0;x<this.i.length;x++){t:{var P=this.i[x];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(b+=P,b>4096){b=x;break e}if(b===4096||x===this.i.length-1){b=x+1;break e}}b=1e3}else b=1e3;b=Sc(this,ee,b),x=Ft(this.J),ut(x,"RID",d),ut(x,"CVER",22),this.G&&ut(x,"X-HTTP-Session-Id",this.G),oa(this,x),oe&&(this.R?b="headers="+ci(nr(oe))+"&"+b:this.u&&ia(x,this.u,oe)),Sl(this.h,ee),this.Ra&&ut(x,"TYPE","init"),this.S?(ut(x,"$req",b),ut(x,"SID","null"),ee.U=!0,Vr(ee,x,null)):Vr(ee,x,b),this.I=2}}else this.I==3&&(d?Ml(this,d):this.i.length==0||El(this.h)||Ml(this))};function Ml(d,b){var x;b?x=b.l:x=d.V++;const P=Ft(d.J);ut(P,"SID",d.M),ut(P,"RID",x),ut(P,"AID",d.K),oa(d,P),d.u&&d.o&&ia(P,d.u,d.o),x=new _r(d,d.j,x,d.D+1),d.u===null&&(x.J=d.o),b&&(d.i=b.G.concat(d.i)),b=Sc(d,x,1e3),x.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),Sl(d.h,x),Vr(x,P,b)}function oa(d,b){d.H&&ae(d.H,function(x,P){ut(b,P,x)}),d.l&&ae({},function(x,P){ut(b,P,x)})}function Sc(d,b,x){x=Math.min(d.i.length,x);const P=d.l?m(d.l.Ka,d.l,d):null;e:{var ee=d.i;let Be=-1;for(;;){const kt=["count="+x];Be==-1?x>0?(Be=ee[0].g,kt.push("ofs="+Be)):Be=0:kt.push("ofs="+Be);let at=!0;for(let Tt=0;Tt<x;Tt++){var oe=ee[Tt].g;const rr=ee[Tt].map;if(oe-=Be,oe<0)Be=Math.max(0,ee[Tt].g-100),at=!1;else try{oe="req"+oe+"_"||"";try{var Se=rr instanceof Map?rr:Object.entries(rr);for(const[Yr,xr]of Se){let wr=xr;p(xr)&&(wr=Gi(xr)),kt.push(oe+Yr+"="+encodeURIComponent(wr))}}catch(Yr){throw kt.push(oe+"type="+encodeURIComponent("_badmap")),Yr}}catch{P&&P(rr)}}if(at){Se=kt.join("&");break e}}Se=void 0}return d=d.i.splice(0,x),b.G=d,Se}function xc(d){if(!d.g&&!d.v){d.Y=1;var b=d.Da;Y||T(),X||(Y(),X=!0),C.add(b,d),d.A=0}}function la(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=Nr(m(d.Da,d),Ac(d,d.A)),d.A++,!0)}t.Da=function(){if(this.v=null,wc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=Nr(m(this.Wa,this),d)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ut(10),Zi(this),wc(this))};function kl(d){d.B!=null&&(c.clearTimeout(d.B),d.B=null)}function wc(d){d.g=new _r(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var b=Ft(d.na);ut(b,"RID","rpc"),ut(b,"SID",d.M),ut(b,"AID",d.K),ut(b,"CI",d.F?"0":"1"),!d.F&&d.ia&&ut(b,"TO",d.ia),ut(b,"TYPE","xmlhttp"),oa(d,b),d.u&&d.o&&ia(b,d.u,d.o),d.O&&(d.g.H=d.O);var x=d.g;d=d.ba,x.M=1,x.A=ta(Ft(b)),x.u=null,x.R=!0,Ba(x,d)}t.Va=function(){this.C!=null&&(this.C=null,Zi(this),la(this),Ut(19))};function Wa(d){d.C!=null&&(c.clearTimeout(d.C),d.C=null)}function Tc(d,b){var x=null;if(d.g==b){Wa(d),kl(d),d.g=null;var P=2}else if(Fr(d.h,b))x=b.G,xl(d.h,b),P=1;else return;if(d.I!=0){if(b.o)if(P==1){x=b.u?b.u.length:0,b=Date.now()-b.F;var ee=d.D;P=za(),Xt(P,new kr(P,x)),Kr(d)}else xc(d);else if(ee=b.m,ee==3||ee==0&&b.X>0||!(P==1&&Ya(d,b)||P==2&&la(d)))switch(x&&x.length>0&&(b=d.h,b.i=b.i.concat(x)),ee){case 1:$r(d,5);break;case 4:$r(d,10);break;case 3:$r(d,6);break;default:$r(d,2)}}}function Ac(d,b){let x=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(x*=2),x*b}function $r(d,b){if(d.j.info("Error code "+b),b==2){var x=m(d.bb,d),P=d.Ua;const ee=!P;P=new Fn(P||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||rn(P,"https"),ta(P),ee?br(P.toString(),x):Dl(P.toString(),x)}else Ut(2);d.I=0,d.l&&d.l.pa(b),Cc(d),$a(d)}t.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Ut(2)):(this.j.info("Failed to ping google.com"),Ut(1))};function Cc(d){if(d.I=0,d.ja=[],d.l){const b=wl(d.h);(b.length!=0||d.i.length!=0)&&(A(d.ja,b),A(d.ja,d.i),d.h.i.length=0,w(d.i),d.i.length=0),d.l.oa()}}function Rc(d,b,x){var P=x instanceof Fn?Ft(x):new Fn(x);if(P.g!="")b&&(P.g=b+"."+P.g),Qi(P,P.u);else{var ee=c.location;P=ee.protocol,b=b?b+"."+ee.hostname:ee.hostname,ee=+ee.port;const oe=new Fn(null);P&&rn(oe,P),b&&(oe.g=b),ee&&Qi(oe,ee),x&&(oe.h=x),P=oe}return x=d.G,b=d.wa,x&&b&&ut(P,x,b),ut(P,"VER",d.ka),oa(d,P),P}function Dc(d,b,x){if(b&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=d.Aa&&!d.ma?new ft(new Hr({ab:x})):new ft(d.ma),b.Fa(d.L),b}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ic(){}t=Ic.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function es(){}es.prototype.g=function(d,b){return new Rn(d,b)};function Rn(d,b){ht.call(this),this.g=new Ji(b),this.l=d,this.h=b&&b.messageUrlParams||null,d=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(d?d["X-WebChannel-Content-Type"]=b.messageContentType:d={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(d?d["X-WebChannel-Client-Profile"]=b.sa:d={"X-WebChannel-Client-Profile":b.sa}),this.g.U=d,(d=b&&b.Qb)&&!N(d)&&(this.g.u=d),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!N(b)&&(this.g.G=b,d=this.h,d!==null&&b in d&&(d=this.h,b in d&&delete d[b])),this.j=new fi(this)}v(Rn,ht),Rn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Rn.prototype.close=function(){jl(this.g)},Rn.prototype.o=function(d){var b=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.v&&(x={},x.__data__=Gi(d),d=x);b.i.push(new Bt(b.Ya++,d)),b.I==3&&Kr(b)},Rn.prototype.N=function(){this.g.l=null,delete this.j,jl(this.g),delete this.g,Rn.Z.N.call(this)};function Oc(d){ln.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var b=d.__sm__;if(b){e:{for(const x in b){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,b=b!==null&&d in b?b[d]:void 0),this.data=b}else this.data=d}v(Oc,ln);function jc(){Zn.call(this),this.status=1}v(jc,Zn);function fi(d){this.g=d}v(fi,Ic),fi.prototype.ra=function(){Xt(this.g,"a")},fi.prototype.qa=function(d){Xt(this.g,new Oc(d))},fi.prototype.pa=function(d){Xt(this.g,new jc)},fi.prototype.oa=function(){Xt(this.g,"b")},es.prototype.createWebChannel=es.prototype.g,Rn.prototype.send=Rn.prototype.o,Rn.prototype.open=Rn.prototype.m,Rn.prototype.close=Rn.prototype.close,tx=function(){return new es},ex=function(){return za()},ZS=Mt,Fp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Zs.NO_ERROR=0,Zs.TIMEOUT=8,Zs.HTTP_ERROR=6,Kd=Zs,_l.COMPLETE="complete",JS=_l,cc.EventType=gr,gr.OPEN="a",gr.CLOSE="b",gr.ERROR="c",gr.MESSAGE="d",ht.prototype.listen=ht.prototype.J,xu=cc,ft.prototype.listenOnce=ft.prototype.K,ft.prototype.getLastError=ft.prototype.Ha,ft.prototype.getLastErrorCode=ft.prototype.ya,ft.prototype.getStatus=ft.prototype.ca,ft.prototype.getResponseJson=ft.prototype.La,ft.prototype.getResponseText=ft.prototype.la,ft.prototype.send=ft.prototype.ea,ft.prototype.setWithCredentials=ft.prototype.Fa,XS=ft}).apply(typeof Ld<"u"?Ld:typeof self<"u"?self:typeof window<"u"?window:{});const Mb="@firebase/firestore",kb="4.9.3";class En{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}En.UNAUTHENTICATED=new En(null),En.GOOGLE_CREDENTIALS=new En("google-credentials-uid"),En.FIRST_PARTY=new En("first-party-uid"),En.MOCK_USER=new En("mock-user");let sl="12.7.0";const Oa=new Cg("@firebase/firestore");function jo(){return Oa.logLevel}function Ae(t,...e){if(Oa.logLevel<=Je.DEBUG){const n=e.map(Ig);Oa.debug(`Firestore (${sl}): ${t}`,...n)}}function Vi(t,...e){if(Oa.logLevel<=Je.ERROR){const n=e.map(Ig);Oa.error(`Firestore (${sl}): ${t}`,...n)}}function qo(t,...e){if(Oa.logLevel<=Je.WARN){const n=e.map(Ig);Oa.warn(`Firestore (${sl}): ${t}`,...n)}}function Ig(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function ke(t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,nx(t,s,n)}function nx(t,e,n){let s=`FIRESTORE (${sl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw Vi(s),new Error(s)}function lt(t,e,n,s){let o="Unexpected state";typeof n=="string"?o=n:s=n,t||nx(e,o,s)}function Ue(t,e){return t}const pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends qi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ji{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class rx{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class AI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(En.UNAUTHENTICATED)))}shutdown(){}}class CI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class RI{constructor(e){this.t=e,this.currentUser=En.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){lt(this.o===void 0,42304);let s=this.i;const o=h=>this.i!==s?(s=this.i,n(h)):Promise.resolve();let l=new ji;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new ji,e.enqueueRetryable((()=>o(this.currentUser)))};const c=()=>{const h=l;e.enqueueRetryable((async()=>{await h.promise,await o(this.currentUser)}))},p=h=>{Ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((h=>p(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?p(h):(Ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new ji)}}),0),c()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((s=>this.i!==e?(Ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(lt(typeof s.accessToken=="string",31837,{l:s}),new rx(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return lt(e===null||typeof e=="string",2055,{h:e}),new En(e)}}class DI{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=En.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class II{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new DI(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(En.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Nb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class OI{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Rr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){lt(this.o===void 0,3512);const s=l=>{l.error!=null&&Ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Ae("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const o=l=>{Ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):Ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Nb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(lt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Nb(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function jI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}class Og{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const o=jI(40);for(let l=0;l<o.length;++l)s.length<20&&o[l]<n&&(s+=e.charAt(o[l]%62))}return s}}function Ze(t,e){return t<e?-1:t>e?1:0}function qp(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const o=t.charAt(s),l=e.charAt(s);if(o!==l)return Ep(o)===Ep(l)?Ze(o,l):Ep(o)?1:-1}return Ze(t.length,e.length)}const MI=55296,kI=57343;function Ep(t){const e=t.charCodeAt(0);return e>=MI&&e<=kI}function Ho(t,e,n){return t.length===e.length&&t.every(((s,o)=>n(s,e[o])))}const Pb="__name__";class ei{constructor(e,n,s){n===void 0?n=0:n>e.length&&ke(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&ke(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return ei.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ei?e.forEach((s=>{n.push(s)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let o=0;o<s;o++){const l=ei.compareSegments(e.get(o),n.get(o));if(l!==0)return l}return Ze(e.length,n.length)}static compareSegments(e,n){const s=ei.isNumericId(e),o=ei.isNumericId(n);return s&&!o?-1:!s&&o?1:s&&o?ei.extractNumericId(e).compare(ei.extractNumericId(n)):qp(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ks.fromString(e.substring(4,e.length-2))}}class bt extends ei{construct(e,n,s){return new bt(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new Te(pe.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter((o=>o.length>0)))}return new bt(n)}static emptyPath(){return new bt([])}}const NI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pn extends ei{construct(e,n,s){return new pn(e,n,s)}static isValidIdentifier(e){return NI.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Pb}static keyField(){return new pn([Pb])}static fromServerFormat(e){const n=[];let s="",o=0;const l=()=>{if(s.length===0)throw new Te(pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let c=!1;for(;o<e.length;){const p=e[o];if(p==="\\"){if(o+1===e.length)throw new Te(pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[o+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Te(pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=h,o+=2}else p==="`"?(c=!c,o++):p!=="."||c?(s+=p,o++):(l(),o++)}if(l(),c)throw new Te(pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pn(n)}static emptyPath(){return new pn([])}}class Oe{constructor(e){this.path=e}static fromPath(e){return new Oe(bt.fromString(e))}static fromName(e){return new Oe(bt.fromString(e).popFirst(5))}static empty(){return new Oe(bt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&bt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return bt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Oe(new bt(e.slice()))}}function ix(t,e,n){if(!n)throw new Te(pe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function PI(t,e,n,s){if(e===!0&&s===!0)throw new Te(pe.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Vb(t){if(!Oe.isDocumentKey(t))throw new Te(pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Lb(t){if(Oe.isDocumentKey(t))throw new Te(pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function sx(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Nh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ke(12329,{type:typeof t})}function Li(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Te(pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Nh(t);throw new Te(pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Wt(t,e){const n={typeString:t};return e&&(n.value=e),n}function $u(t,e){if(!sx(t))throw new Te(pe.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const o=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in t)){n=`JSON missing required field: '${s}'`;break}const c=t[s];if(o&&typeof c!==o){n=`JSON field '${s}' must be a ${o}.`;break}if(l!==void 0&&c!==l.value){n=`Expected '${s}' field to equal '${l.value}'`;break}}if(n)throw new Te(pe.INVALID_ARGUMENT,n);return!0}const Ub=-62135596800,zb=1e6;class wt{static now(){return wt.fromMillis(Date.now())}static fromDate(e){return wt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*zb);return new wt(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Te(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Te(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Ub)throw new Te(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/zb}_compareTo(e){return this.seconds===e.seconds?Ze(this.nanoseconds,e.nanoseconds):Ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($u(e,wt._jsonSchema))return new wt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Ub;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}wt._jsonSchemaVersion="firestore/timestamp/1.0",wt._jsonSchema={type:Wt("string",wt._jsonSchemaVersion),seconds:Wt("number"),nanoseconds:Wt("number")};class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new wt(0,0))}static max(){return new Ve(new wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Pu=-1;function VI(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,o=Ve.fromTimestamp(s===1e9?new wt(n+1,0):new wt(n,s));return new Ls(o,Oe.empty(),e)}function LI(t){return new Ls(t.readTime,t.key,Pu)}class Ls{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new Ls(Ve.min(),Oe.empty(),Pu)}static max(){return new Ls(Ve.max(),Oe.empty(),Pu)}}function UI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Oe.comparator(t.documentKey,e.documentKey),n!==0?n:Ze(t.largestBatchId,e.largestBatchId))}const zI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class BI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function al(t){if(t.code!==pe.FAILED_PRECONDITION||t.message!==zI)throw t;Ae("LocalStore","Unexpectedly lost primary lease")}class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ve(((s,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,o)},this.catchCallback=l=>{this.wrapFailure(n,l).next(s,o)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof ve?n:ve.resolve(n)}catch(n){return ve.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):ve.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):ve.reject(n)}static resolve(e){return new ve(((n,s)=>{n(e)}))}static reject(e){return new ve(((n,s)=>{s(e)}))}static waitFor(e){return new ve(((n,s)=>{let o=0,l=0,c=!1;e.forEach((p=>{++o,p.next((()=>{++l,c&&l===o&&n()}),(h=>s(h)))})),c=!0,l===o&&n()}))}static or(e){let n=ve.resolve(!1);for(const s of e)n=n.next((o=>o?ve.resolve(o):s()));return n}static forEach(e,n){const s=[];return e.forEach(((o,l)=>{s.push(n.call(this,o,l))})),this.waitFor(s)}static mapArray(e,n){return new ve(((s,o)=>{const l=e.length,c=new Array(l);let p=0;for(let h=0;h<l;h++){const m=h;n(e[m]).next((_=>{c[m]=_,++p,p===l&&s(c)}),(_=>o(_)))}}))}static doWhile(e,n){return new ve(((s,o)=>{const l=()=>{e()===!0?n().next((()=>{l()}),o):s()};l()}))}}function FI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ol(t){return t.name==="IndexedDbTransactionError"}class Ph{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ph.ce=-1;const jg=-1;function Vh(t){return t==null}function ch(t){return t===0&&1/t==-1/0}function qI(t){return typeof t=="number"&&Number.isInteger(t)&&!ch(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const ax="";function HI(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Bb(e)),e=GI(t.get(n),e);return Bb(e)}function GI(t,e){let n=e;const s=t.length;for(let o=0;o<s;o++){const l=t.charAt(o);switch(l){case"\0":n+="";break;case ax:n+="";break;default:n+=l}}return n}function Bb(t){return t+ax+""}function Fb(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Gs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ox(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class It{constructor(e,n){this.comparator=e,this.root=n||mn.EMPTY}insert(e,n){return new It(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,mn.BLACK,null,null))}remove(e){return new It(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const o=this.comparator(e,s.key);if(o===0)return n+s.left.size;o<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,s)=>(e(n,s),!1)))}toString(){const e=[];return this.inorderTraversal(((n,s)=>(e.push(`${n}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ud(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ud(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ud(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ud(this.root,e,this.comparator,!0)}}class Ud{constructor(e,n,s,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?s(e.key,n):1,n&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mn{constructor(e,n,s,o,l){this.key=e,this.value=n,this.color=s??mn.RED,this.left=o??mn.EMPTY,this.right=l??mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,o,l){return new mn(e??this.key,n??this.value,s??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let o=this;const l=s(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,n,s),null):l===0?o.copy(null,n,null,null,null):o.copy(null,null,null,null,o.right.insert(e,n,s)),o.fixUp()}removeMin(){if(this.left.isEmpty())return mn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,o=this;if(n(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,n),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),n(e,o.key)===0){if(o.right.isEmpty())return mn.EMPTY;s=o.right.min(),o=o.copy(s.key,s.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,n))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ke(27949);return e+(this.isRed()?0:1)}}mn.EMPTY=null,mn.RED=!0,mn.BLACK=!1;mn.EMPTY=new class{constructor(){this.size=0}get key(){throw ke(57766)}get value(){throw ke(16141)}get color(){throw ke(16727)}get left(){throw ke(29726)}get right(){throw ke(36894)}copy(e,n,s,o,l){return this}insert(e,n,s){return new mn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class tn{constructor(e){this.comparator=e,this.data=new It(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,s)=>(e(n),!1)))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const o=s.getNext();if(this.comparator(o.key,e[1])>=0)return;n(o.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new qb(this.data.getIterator())}getIteratorFrom(e){return new qb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((s=>{n=n.add(s)})),n}isEqual(e){if(!(e instanceof tn)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const o=n.getNext().key,l=s.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new tn(this.comparator);return n.data=e,n}}class qb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Xn{constructor(e){this.fields=e,e.sort(pn.comparator)}static empty(){return new Xn([])}unionWith(e){let n=new tn(pn.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new Xn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ho(this.fields,e.fields,((n,s)=>n.isEqual(s)))}}class lx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class gn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new lx("Invalid base64 string: "+l):l}})(e);return new gn(n)}static fromUint8Array(e){const n=(function(o){let l="";for(let c=0;c<o.length;++c)l+=String.fromCharCode(o[c]);return l})(e);return new gn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const s=new Uint8Array(n.length);for(let o=0;o<n.length;o++)s[o]=n.charCodeAt(o);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gn.EMPTY_BYTE_STRING=new gn("");const QI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Us(t){if(lt(!!t,39018),typeof t=="string"){let e=0;const n=QI.exec(t);if(lt(!!n,46558,{timestamp:t}),n[1]){let o=n[1];o=(o+"000000000").substr(0,9),e=Number(o)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Vt(t.seconds),nanos:Vt(t.nanos)}}function Vt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function zs(t){return typeof t=="string"?gn.fromBase64String(t):gn.fromUint8Array(t)}const ux="server_timestamp",cx="__type__",dx="__previous_value__",hx="__local_write_time__";function Mg(t){return(t?.mapValue?.fields||{})[cx]?.stringValue===ux}function Lh(t){const e=t.mapValue.fields[dx];return Mg(e)?Lh(e):e}function Vu(t){const e=Us(t.mapValue.fields[hx].timestampValue);return new wt(e.seconds,e.nanos)}class KI{constructor(e,n,s,o,l,c,p,h,m,_){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=o,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=p,this.longPollingOptions=h,this.useFetchStreams=m,this.isUsingEmulator=_}}const dh="(default)";class Lu{constructor(e,n){this.projectId=e,this.database=n||dh}static empty(){return new Lu("","")}get isDefaultDatabase(){return this.database===dh}isEqual(e){return e instanceof Lu&&e.projectId===this.projectId&&e.database===this.database}}const fx="__type__",$I="__max__",zd={mapValue:{}},mx="__vector__",hh="value";function Bs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Mg(t)?4:WI(t)?9007199254740991:YI(t)?10:11:ke(28295,{value:t})}function ui(t,e){if(t===e)return!0;const n=Bs(t);if(n!==Bs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Vu(t).isEqual(Vu(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const c=Us(o.timestampValue),p=Us(l.timestampValue);return c.seconds===p.seconds&&c.nanos===p.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(o,l){return zs(o.bytesValue).isEqual(zs(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(o,l){return Vt(o.geoPointValue.latitude)===Vt(l.geoPointValue.latitude)&&Vt(o.geoPointValue.longitude)===Vt(l.geoPointValue.longitude)})(t,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return Vt(o.integerValue)===Vt(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const c=Vt(o.doubleValue),p=Vt(l.doubleValue);return c===p?ch(c)===ch(p):isNaN(c)&&isNaN(p)}return!1})(t,e);case 9:return Ho(t.arrayValue.values||[],e.arrayValue.values||[],ui);case 10:case 11:return(function(o,l){const c=o.mapValue.fields||{},p=l.mapValue.fields||{};if(Fb(c)!==Fb(p))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(p[h]===void 0||!ui(c[h],p[h])))return!1;return!0})(t,e);default:return ke(52216,{left:t})}}function Uu(t,e){return(t.values||[]).find((n=>ui(n,e)))!==void 0}function Go(t,e){if(t===e)return 0;const n=Bs(t),s=Bs(e);if(n!==s)return Ze(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ze(t.booleanValue,e.booleanValue);case 2:return(function(l,c){const p=Vt(l.integerValue||l.doubleValue),h=Vt(c.integerValue||c.doubleValue);return p<h?-1:p>h?1:p===h?0:isNaN(p)?isNaN(h)?0:-1:1})(t,e);case 3:return Hb(t.timestampValue,e.timestampValue);case 4:return Hb(Vu(t),Vu(e));case 5:return qp(t.stringValue,e.stringValue);case 6:return(function(l,c){const p=zs(l),h=zs(c);return p.compareTo(h)})(t.bytesValue,e.bytesValue);case 7:return(function(l,c){const p=l.split("/"),h=c.split("/");for(let m=0;m<p.length&&m<h.length;m++){const _=Ze(p[m],h[m]);if(_!==0)return _}return Ze(p.length,h.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,c){const p=Ze(Vt(l.latitude),Vt(c.latitude));return p!==0?p:Ze(Vt(l.longitude),Vt(c.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return Gb(t.arrayValue,e.arrayValue);case 10:return(function(l,c){const p=l.fields||{},h=c.fields||{},m=p[hh]?.arrayValue,_=h[hh]?.arrayValue,v=Ze(m?.values?.length||0,_?.values?.length||0);return v!==0?v:Gb(m,_)})(t.mapValue,e.mapValue);case 11:return(function(l,c){if(l===zd.mapValue&&c===zd.mapValue)return 0;if(l===zd.mapValue)return 1;if(c===zd.mapValue)return-1;const p=l.fields||{},h=Object.keys(p),m=c.fields||{},_=Object.keys(m);h.sort(),_.sort();for(let v=0;v<h.length&&v<_.length;++v){const E=qp(h[v],_[v]);if(E!==0)return E;const w=Go(p[h[v]],m[_[v]]);if(w!==0)return w}return Ze(h.length,_.length)})(t.mapValue,e.mapValue);default:throw ke(23264,{he:n})}}function Hb(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ze(t,e);const n=Us(t),s=Us(e),o=Ze(n.seconds,s.seconds);return o!==0?o:Ze(n.nanos,s.nanos)}function Gb(t,e){const n=t.values||[],s=e.values||[];for(let o=0;o<n.length&&o<s.length;++o){const l=Go(n[o],s[o]);if(l)return l}return Ze(n.length,s.length)}function Qo(t){return Hp(t)}function Hp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const s=Us(n);return`time(${s.seconds},${s.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return zs(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return Oe.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let s="[",o=!0;for(const l of n.values||[])o?o=!1:s+=",",s+=Hp(l);return s+"]"})(t.arrayValue):"mapValue"in t?(function(n){const s=Object.keys(n.fields||{}).sort();let o="{",l=!0;for(const c of s)l?l=!1:o+=",",o+=`${c}:${Hp(n.fields[c])}`;return o+"}"})(t.mapValue):ke(61005,{value:t})}function $d(t){switch(Bs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Lh(t);return e?16+$d(e):16;case 5:return 2*t.stringValue.length;case 6:return zs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((o,l)=>o+$d(l)),0)})(t.arrayValue);case 10:case 11:return(function(s){let o=0;return Gs(s.fields,((l,c)=>{o+=l.length+$d(c)})),o})(t.mapValue);default:throw ke(13486,{value:t})}}function Qb(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Gp(t){return!!t&&"integerValue"in t}function kg(t){return!!t&&"arrayValue"in t}function Kb(t){return!!t&&"nullValue"in t}function $b(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yd(t){return!!t&&"mapValue"in t}function YI(t){return(t?.mapValue?.fields||{})[fx]?.stringValue===mx}function Ru(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Gs(t.mapValue.fields,((n,s)=>e.mapValue.fields[n]=Ru(s))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ru(t.arrayValue.values[n]);return e}return{...t}}function WI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===$I}class Un{constructor(e){this.value=e}static empty(){return new Un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Yd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ru(n)}setAll(e){let n=pn.emptyPath(),s={},o=[];e.forEach(((c,p)=>{if(!n.isImmediateParentOf(p)){const h=this.getFieldsMap(n);this.applyChanges(h,s,o),s={},o=[],n=p.popLast()}c?s[p.lastSegment()]=Ru(c):o.push(p.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,s,o)}delete(e){const n=this.field(e.popLast());Yd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ui(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let o=n.mapValue.fields[e.get(s)];Yd(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=o),n=o}return n.mapValue.fields}applyChanges(e,n,s){Gs(n,((o,l)=>e[o]=l));for(const o of s)delete e[o]}clone(){return new Un(Ru(this.value))}}function px(t){const e=[];return Gs(t.fields,((n,s)=>{const o=new pn([n]);if(Yd(s)){const l=px(s.mapValue).fields;if(l.length===0)e.push(o);else for(const c of l)e.push(o.child(c))}else e.push(o)})),new Xn(e)}class Sn{constructor(e,n,s,o,l,c,p){this.key=e,this.documentType=n,this.version=s,this.readTime=o,this.createTime=l,this.data=c,this.documentState=p}static newInvalidDocument(e){return new Sn(e,0,Ve.min(),Ve.min(),Ve.min(),Un.empty(),0)}static newFoundDocument(e,n,s,o){return new Sn(e,1,n,Ve.min(),s,o,0)}static newNoDocument(e,n){return new Sn(e,2,n,Ve.min(),Ve.min(),Un.empty(),0)}static newUnknownDocument(e,n){return new Sn(e,3,n,Ve.min(),Ve.min(),Un.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Sn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Sn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class fh{constructor(e,n){this.position=e,this.inclusive=n}}function Yb(t,e,n){let s=0;for(let o=0;o<t.position.length;o++){const l=e[o],c=t.position[o];if(l.field.isKeyField()?s=Oe.comparator(Oe.fromName(c.referenceValue),n.key):s=Go(c,n.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function Wb(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ui(t.position[n],e.position[n]))return!1;return!0}class mh{constructor(e,n="asc"){this.field=e,this.dir=n}}function XI(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class gx{}class Yt extends gx{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new ZI(e,n,s):n==="array-contains"?new n2(e,s):n==="in"?new r2(e,s):n==="not-in"?new i2(e,s):n==="array-contains-any"?new s2(e,s):new Yt(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new e2(e,s):new t2(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Go(n,this.value)):n!==null&&Bs(this.value)===Bs(n)&&this.matchesComparison(Go(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ir extends gx{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ir(e,n)}matches(e){return yx(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function yx(t){return t.op==="and"}function _x(t){return JI(t)&&yx(t)}function JI(t){for(const e of t.filters)if(e instanceof Ir)return!1;return!0}function Qp(t){if(t instanceof Yt)return t.field.canonicalString()+t.op.toString()+Qo(t.value);if(_x(t))return t.filters.map((e=>Qp(e))).join(",");{const e=t.filters.map((n=>Qp(n))).join(",");return`${t.op}(${e})`}}function vx(t,e){return t instanceof Yt?(function(s,o){return o instanceof Yt&&s.op===o.op&&s.field.isEqual(o.field)&&ui(s.value,o.value)})(t,e):t instanceof Ir?(function(s,o){return o instanceof Ir&&s.op===o.op&&s.filters.length===o.filters.length?s.filters.reduce(((l,c,p)=>l&&vx(c,o.filters[p])),!0):!1})(t,e):void ke(19439)}function bx(t){return t instanceof Yt?(function(n){return`${n.field.canonicalString()} ${n.op} ${Qo(n.value)}`})(t):t instanceof Ir?(function(n){return n.op.toString()+" {"+n.getFilters().map(bx).join(" ,")+"}"})(t):"Filter"}class ZI extends Yt{constructor(e,n,s){super(e,n,s),this.key=Oe.fromName(s.referenceValue)}matches(e){const n=Oe.comparator(e.key,this.key);return this.matchesComparison(n)}}class e2 extends Yt{constructor(e,n){super(e,"in",n),this.keys=Ex("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class t2 extends Yt{constructor(e,n){super(e,"not-in",n),this.keys=Ex("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function Ex(t,e){return(e.arrayValue?.values||[]).map((n=>Oe.fromName(n.referenceValue)))}class n2 extends Yt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return kg(n)&&Uu(n.arrayValue,this.value)}}class r2 extends Yt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Uu(this.value.arrayValue,n)}}class i2 extends Yt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Uu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Uu(this.value.arrayValue,n)}}class s2 extends Yt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!kg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((s=>Uu(this.value.arrayValue,s)))}}class a2{constructor(e,n=null,s=[],o=[],l=null,c=null,p=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=o,this.limit=l,this.startAt=c,this.endAt=p,this.Te=null}}function Xb(t,e=null,n=[],s=[],o=null,l=null,c=null){return new a2(t,e,n,s,o,l,c)}function Ng(t){const e=Ue(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((s=>Qp(s))).join(","),n+="|ob:",n+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),Vh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((s=>Qo(s))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((s=>Qo(s))).join(",")),e.Te=n}return e.Te}function Pg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!XI(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!vx(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Wb(t.startAt,e.startAt)&&Wb(t.endAt,e.endAt)}function Kp(t){return Oe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Yu{constructor(e,n=null,s=[],o=[],l=null,c="F",p=null,h=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=o,this.limit=l,this.limitType=c,this.startAt=p,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function o2(t,e,n,s,o,l,c,p){return new Yu(t,e,n,s,o,l,c,p)}function Vg(t){return new Yu(t)}function Jb(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Sx(t){return t.collectionGroup!==null}function Du(t){const e=Ue(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let p=new tn(pn.comparator);return c.filters.forEach((h=>{h.getFlattenedFilters().forEach((m=>{m.isInequality()&&(p=p.add(m.field))}))})),p})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new mh(l,s))})),n.has(pn.keyField().canonicalString())||e.Ie.push(new mh(pn.keyField(),s))}return e.Ie}function ni(t){const e=Ue(t);return e.Ee||(e.Ee=l2(e,Du(t))),e.Ee}function l2(t,e){if(t.limitType==="F")return Xb(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new mh(o.field,l)}));const n=t.endAt?new fh(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new fh(t.startAt.position,t.startAt.inclusive):null;return Xb(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function $p(t,e){const n=t.filters.concat([e]);return new Yu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Yp(t,e,n){return new Yu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Uh(t,e){return Pg(ni(t),ni(e))&&t.limitType===e.limitType}function xx(t){return`${Ng(ni(t))}|lt:${t.limitType}`}function Mo(t){return`Query(target=${(function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map((o=>bx(o))).join(", ")}]`),Vh(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map((o=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(o))).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map((o=>Qo(o))).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map((o=>Qo(o))).join(",")),`Target(${s})`})(ni(t))}; limitType=${t.limitType})`}function zh(t,e){return e.isFoundDocument()&&(function(s,o){const l=o.key.path;return s.collectionGroup!==null?o.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):Oe.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(t,e)&&(function(s,o){for(const l of Du(s))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(s,o){for(const l of s.filters)if(!l.matches(o))return!1;return!0})(t,e)&&(function(s,o){return!(s.startAt&&!(function(c,p,h){const m=Yb(c,p,h);return c.inclusive?m<=0:m<0})(s.startAt,Du(s),o)||s.endAt&&!(function(c,p,h){const m=Yb(c,p,h);return c.inclusive?m>=0:m>0})(s.endAt,Du(s),o))})(t,e)}function u2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wx(t){return(e,n)=>{let s=!1;for(const o of Du(t)){const l=c2(o,e,n);if(l!==0)return l;s=s||o.field.isKeyField()}return 0}}function c2(t,e,n){const s=t.field.isKeyField()?Oe.comparator(e.key,n.key):(function(l,c,p){const h=c.data.field(l),m=p.data.field(l);return h!==null&&m!==null?Go(h,m):ke(42886)})(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return ke(19790,{direction:t.dir})}}class Na{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[o,l]of s)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),o=this.inner[s];if(o===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,n]);o.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return s.length===1?delete this.inner[n]:s.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Gs(this.inner,((n,s)=>{for(const[o,l]of s)e(o,l)}))}isEmpty(){return ox(this.inner)}size(){return this.innerSize}}const d2=new It(Oe.comparator);function Ui(){return d2}const Tx=new It(Oe.comparator);function wu(...t){let e=Tx;for(const n of t)e=e.insert(n.key,n);return e}function Ax(t){let e=Tx;return t.forEach(((n,s)=>e=e.insert(n,s.overlayedDocument))),e}function Aa(){return Iu()}function Cx(){return Iu()}function Iu(){return new Na((t=>t.toString()),((t,e)=>t.isEqual(e)))}const h2=new It(Oe.comparator),f2=new tn(Oe.comparator);function et(...t){let e=f2;for(const n of t)e=e.add(n);return e}const m2=new tn(Ze);function p2(){return m2}function Lg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ch(e)?"-0":e}}function Rx(t){return{integerValue:""+t}}function g2(t,e){return qI(e)?Rx(e):Lg(t,e)}class Bh{constructor(){this._=void 0}}function y2(t,e,n){return t instanceof ph?(function(o,l){const c={fields:{[cx]:{stringValue:ux},[hx]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&Mg(l)&&(l=Lh(l)),l&&(c.fields[dx]=l),{mapValue:c}})(n,e):t instanceof Ko?Ix(t,e):t instanceof zu?Ox(t,e):(function(o,l){const c=Dx(o,l),p=Zb(c)+Zb(o.Ae);return Gp(c)&&Gp(o.Ae)?Rx(p):Lg(o.serializer,p)})(t,e)}function _2(t,e,n){return t instanceof Ko?Ix(t,e):t instanceof zu?Ox(t,e):n}function Dx(t,e){return t instanceof gh?(function(s){return Gp(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class ph extends Bh{}class Ko extends Bh{constructor(e){super(),this.elements=e}}function Ix(t,e){const n=jx(e);for(const s of t.elements)n.some((o=>ui(o,s)))||n.push(s);return{arrayValue:{values:n}}}class zu extends Bh{constructor(e){super(),this.elements=e}}function Ox(t,e){let n=jx(e);for(const s of t.elements)n=n.filter((o=>!ui(o,s)));return{arrayValue:{values:n}}}class gh extends Bh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Zb(t){return Vt(t.integerValue||t.doubleValue)}function jx(t){return kg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class v2{constructor(e,n){this.field=e,this.transform=n}}function b2(t,e){return t.field.isEqual(e.field)&&(function(s,o){return s instanceof Ko&&o instanceof Ko||s instanceof zu&&o instanceof zu?Ho(s.elements,o.elements,ui):s instanceof gh&&o instanceof gh?ui(s.Ae,o.Ae):s instanceof ph&&o instanceof ph})(t.transform,e.transform)}class E2{constructor(e,n){this.version=e,this.transformResults=n}}class ri{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ri}static exists(e){return new ri(void 0,e)}static updateTime(e){return new ri(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Fh{}function Mx(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Nx(t.key,ri.none()):new Wu(t.key,t.data,ri.none());{const n=t.data,s=Un.empty();let o=new tn(pn.comparator);for(let l of e.fields)if(!o.has(l)){let c=n.field(l);c===null&&l.length>1&&(l=l.popLast(),c=n.field(l)),c===null?s.delete(l):s.set(l,c),o=o.add(l)}return new Qs(t.key,s,new Xn(o.toArray()),ri.none())}}function S2(t,e,n){t instanceof Wu?(function(o,l,c){const p=o.value.clone(),h=tE(o.fieldTransforms,l,c.transformResults);p.setAll(h),l.convertToFoundDocument(c.version,p).setHasCommittedMutations()})(t,e,n):t instanceof Qs?(function(o,l,c){if(!Wd(o.precondition,l))return void l.convertToUnknownDocument(c.version);const p=tE(o.fieldTransforms,l,c.transformResults),h=l.data;h.setAll(kx(o)),h.setAll(p),l.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(t,e,n):(function(o,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,n)}function Ou(t,e,n,s){return t instanceof Wu?(function(l,c,p,h){if(!Wd(l.precondition,c))return p;const m=l.value.clone(),_=nE(l.fieldTransforms,h,c);return m.setAll(_),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(t,e,n,s):t instanceof Qs?(function(l,c,p,h){if(!Wd(l.precondition,c))return p;const m=nE(l.fieldTransforms,h,c),_=c.data;return _.setAll(kx(l)),_.setAll(m),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),p===null?null:p.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,n,s):(function(l,c,p){return Wd(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):p})(t,e,n)}function x2(t,e){let n=null;for(const s of t.fieldTransforms){const o=e.data.field(s.field),l=Dx(s.transform,o||null);l!=null&&(n===null&&(n=Un.empty()),n.set(s.field,l))}return n||null}function eE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(s,o){return s===void 0&&o===void 0||!(!s||!o)&&Ho(s,o,((l,c)=>b2(l,c)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Wu extends Fh{constructor(e,n,s,o=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Qs extends Fh{constructor(e,n,s,o,l=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function kx(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}})),e}function tE(t,e,n){const s=new Map;lt(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let o=0;o<n.length;o++){const l=t[o],c=l.transform,p=e.data.field(l.field);s.set(l.field,_2(c,p,n[o]))}return s}function nE(t,e,n){const s=new Map;for(const o of t){const l=o.transform,c=n.data.field(o.field);s.set(o.field,y2(l,c,e))}return s}class Nx extends Fh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class w2 extends Fh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class T2{constructor(e,n,s,o){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=o}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&S2(l,e,s[o])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=Ou(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=Ou(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=Cx();return this.mutations.forEach((o=>{const l=e.get(o.key),c=l.overlayedDocument;let p=this.applyToLocalView(c,l.mutatedFields);p=n.has(o.key)?null:p;const h=Mx(c,p);h!==null&&s.set(o.key,h),c.isValidDocument()||c.convertToNoDocument(Ve.min())})),s}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),et())}isEqual(e){return this.batchId===e.batchId&&Ho(this.mutations,e.mutations,((n,s)=>eE(n,s)))&&Ho(this.baseMutations,e.baseMutations,((n,s)=>eE(n,s)))}}class Ug{constructor(e,n,s,o){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=o}static from(e,n,s){lt(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let o=(function(){return h2})();const l=e.mutations;for(let c=0;c<l.length;c++)o=o.insert(l[c].key,s[c].version);return new Ug(e,n,s,o)}}class A2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class C2{constructor(e,n){this.count=e,this.unchangedNames=n}}var Kt,rt;function R2(t){switch(t){case pe.OK:return ke(64938);case pe.CANCELLED:case pe.UNKNOWN:case pe.DEADLINE_EXCEEDED:case pe.RESOURCE_EXHAUSTED:case pe.INTERNAL:case pe.UNAVAILABLE:case pe.UNAUTHENTICATED:return!1;case pe.INVALID_ARGUMENT:case pe.NOT_FOUND:case pe.ALREADY_EXISTS:case pe.PERMISSION_DENIED:case pe.FAILED_PRECONDITION:case pe.ABORTED:case pe.OUT_OF_RANGE:case pe.UNIMPLEMENTED:case pe.DATA_LOSS:return!0;default:return ke(15467,{code:t})}}function Px(t){if(t===void 0)return Vi("GRPC error has no .code"),pe.UNKNOWN;switch(t){case Kt.OK:return pe.OK;case Kt.CANCELLED:return pe.CANCELLED;case Kt.UNKNOWN:return pe.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return pe.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return pe.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return pe.INTERNAL;case Kt.UNAVAILABLE:return pe.UNAVAILABLE;case Kt.UNAUTHENTICATED:return pe.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return pe.INVALID_ARGUMENT;case Kt.NOT_FOUND:return pe.NOT_FOUND;case Kt.ALREADY_EXISTS:return pe.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return pe.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return pe.FAILED_PRECONDITION;case Kt.ABORTED:return pe.ABORTED;case Kt.OUT_OF_RANGE:return pe.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return pe.UNIMPLEMENTED;case Kt.DATA_LOSS:return pe.DATA_LOSS;default:return ke(39323,{code:t})}}(rt=Kt||(Kt={}))[rt.OK=0]="OK",rt[rt.CANCELLED=1]="CANCELLED",rt[rt.UNKNOWN=2]="UNKNOWN",rt[rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rt[rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rt[rt.NOT_FOUND=5]="NOT_FOUND",rt[rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",rt[rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",rt[rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",rt[rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rt[rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rt[rt.ABORTED=10]="ABORTED",rt[rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",rt[rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",rt[rt.INTERNAL=13]="INTERNAL",rt[rt.UNAVAILABLE=14]="UNAVAILABLE",rt[rt.DATA_LOSS=15]="DATA_LOSS";function D2(){return new TextEncoder}const I2=new ks([4294967295,4294967295],0);function rE(t){const e=D2().encode(t),n=new WS;return n.update(e),new Uint8Array(n.digest())}function iE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ks([n,s],0),new ks([o,l],0)]}class zg{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new Tu(`Invalid padding: ${n}`);if(s<0)throw new Tu(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Tu(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new Tu(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ks.fromNumber(this.ge)}ye(e,n,s){let o=e.add(n.multiply(ks.fromNumber(s)));return o.compare(I2)===1&&(o=new ks([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=rE(e),[s,o]=iE(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(s,o,l);if(!this.we(c))return!1}return!0}static create(e,n,s){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new zg(l,o,n);return s.forEach((p=>c.insert(p))),c}insert(e){if(this.ge===0)return;const n=rE(e),[s,o]=iE(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(s,o,l);this.Se(c)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class Tu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class qh{constructor(e,n,s,o,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const o=new Map;return o.set(e,Xu.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new qh(Ve.min(),o,new It(Ze),Ui(),et())}}class Xu{constructor(e,n,s,o,l){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new Xu(s,n,et(),et(),et())}}class Xd{constructor(e,n,s,o){this.be=e,this.removedTargetIds=n,this.key=s,this.De=o}}class Vx{constructor(e,n){this.targetId=e,this.Ce=n}}class Lx{constructor(e,n,s=gn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=o}}class sE{constructor(){this.ve=0,this.Fe=aE(),this.Me=gn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=et(),n=et(),s=et();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:n=n.add(o);break;case 1:s=s.add(o);break;default:ke(38017,{changeType:l})}})),new Xu(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=aE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class O2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ui(),this.Je=Bd(),this.He=Bd(),this.Ye=new It(Ze)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:ke(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((s,o)=>{this.rt(o)&&n(o)}))}st(e){const n=e.targetId,s=e.Ce.count,o=this.ot(n);if(o){const l=o.target;if(Kp(l))if(s===0){const c=new Oe(l.path);this.et(n,c,Sn.newNoDocument(c,Ve.min()))}else lt(s===1,20013,{expectedCount:s});else{const c=this._t(n);if(c!==s){const p=this.ut(e),h=p?this.ct(p,e,c):1;if(h!==0){this.it(n);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,m)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:o=0},hashCount:l=0}=n;let c,p;try{c=zs(s).toUint8Array()}catch(h){if(h instanceof lx)return qo("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{p=new zg(c,o,l)}catch(h){return qo(h instanceof Tu?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return p.ge===0?null:p}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let o=0;return s.forEach((l=>{const c=this.Ge.ht(),p=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(p)||(this.et(n,l,null),o++)})),o}Tt(e){const n=new Map;this.ze.forEach(((l,c)=>{const p=this.ot(c);if(p){if(l.current&&Kp(p.target)){const h=new Oe(p.target.path);this.It(h).has(c)||this.Et(c,h)||this.et(c,h,Sn.newNoDocument(h,e))}l.Be&&(n.set(c,l.ke()),l.qe())}}));let s=et();this.He.forEach(((l,c)=>{let p=!0;c.forEachWhile((h=>{const m=this.ot(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(s=s.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const o=new qh(e,n,this.Ye,this.je,s);return this.je=Ui(),this.Je=Bd(),this.He=Bd(),this.Ye=new It(Ze),o}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,n)?o.Qe(n,1):o.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new sE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new tn(Ze),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new tn(Ze),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ae("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new sE),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Bd(){return new It(Oe.comparator)}function aE(){return new It(Oe.comparator)}const j2={asc:"ASCENDING",desc:"DESCENDING"},M2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},k2={and:"AND",or:"OR"};class N2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Wp(t,e){return t.useProto3Json||Vh(e)?e:{value:e}}function yh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ux(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function P2(t,e){return yh(t,e.toTimestamp())}function ii(t){return lt(!!t,49232),Ve.fromTimestamp((function(n){const s=Us(n);return new wt(s.seconds,s.nanos)})(t))}function Bg(t,e){return Xp(t,e).canonicalString()}function Xp(t,e){const n=(function(o){return new bt(["projects",o.projectId,"databases",o.database])})(t).child("documents");return e===void 0?n:n.child(e)}function zx(t){const e=bt.fromString(t);return lt(Gx(e),10190,{key:e.toString()}),e}function Jp(t,e){return Bg(t.databaseId,e.path)}function Sp(t,e){const n=zx(e);if(n.get(1)!==t.databaseId.projectId)throw new Te(pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Te(pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Oe(Fx(n))}function Bx(t,e){return Bg(t.databaseId,e)}function V2(t){const e=zx(t);return e.length===4?bt.emptyPath():Fx(e)}function Zp(t){return new bt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Fx(t){return lt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function oE(t,e,n){return{name:Jp(t,e),fields:n.value.mapValue.fields}}function L2(t,e){let n;if("targetChange"in e){e.targetChange;const s=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:ke(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(m,_){return m.useProto3Json?(lt(_===void 0||typeof _=="string",58123),gn.fromBase64String(_||"")):(lt(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),gn.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),c=e.targetChange.cause,p=c&&(function(m){const _=m.code===void 0?pe.UNKNOWN:Px(m.code);return new Te(_,m.message||"")})(c);n=new Lx(s,o,l,p||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const o=Sp(t,s.document.name),l=ii(s.document.updateTime),c=s.document.createTime?ii(s.document.createTime):Ve.min(),p=new Un({mapValue:{fields:s.document.fields}}),h=Sn.newFoundDocument(o,l,c,p),m=s.targetIds||[],_=s.removedTargetIds||[];n=new Xd(m,_,h.key,h)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const o=Sp(t,s.document),l=s.readTime?ii(s.readTime):Ve.min(),c=Sn.newNoDocument(o,l),p=s.removedTargetIds||[];n=new Xd([],p,c.key,c)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const o=Sp(t,s.document),l=s.removedTargetIds||[];n=new Xd([],l,o,null)}else{if(!("filter"in e))return ke(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:o=0,unchangedNames:l}=s,c=new C2(o,l),p=s.targetId;n=new Vx(p,c)}}return n}function U2(t,e){let n;if(e instanceof Wu)n={update:oE(t,e.key,e.value)};else if(e instanceof Nx)n={delete:Jp(t,e.key)};else if(e instanceof Qs)n={update:oE(t,e.key,e.data),updateMask:$2(e.fieldMask)};else{if(!(e instanceof w2))return ke(16599,{Vt:e.type});n={verify:Jp(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((s=>(function(l,c){const p=c.transform;if(p instanceof ph)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Ko)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof zu)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof gh)return{fieldPath:c.field.canonicalString(),increment:p.Ae};throw ke(20930,{transform:c.transform})})(0,s)))),e.precondition.isNone||(n.currentDocument=(function(o,l){return l.updateTime!==void 0?{updateTime:P2(o,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:ke(27497)})(t,e.precondition)),n}function z2(t,e){return t&&t.length>0?(lt(e!==void 0,14353),t.map((n=>(function(o,l){let c=o.updateTime?ii(o.updateTime):ii(l);return c.isEqual(Ve.min())&&(c=ii(l)),new E2(c,o.transformResults||[])})(n,e)))):[]}function B2(t,e){return{documents:[Bx(t,e.path)]}}function F2(t,e){const n={structuredQuery:{}},s=e.path;let o;e.collectionGroup!==null?(o=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=Bx(t,o);const l=(function(m){if(m.length!==0)return Hx(Ir.create(m,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const c=(function(m){if(m.length!==0)return m.map((_=>(function(E){return{field:ko(E.field),direction:G2(E.dir)}})(_)))})(e.orderBy);c&&(n.structuredQuery.orderBy=c);const p=Wp(t,e.limit);return p!==null&&(n.structuredQuery.limit=p),e.startAt&&(n.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:n,parent:o}}function q2(t){let e=V2(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let o=null;if(s>0){lt(s===1,65062);const _=n.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(v){const E=qx(v);return E instanceof Ir&&_x(E)?E.getFilters():[E]})(n.where));let c=[];n.orderBy&&(c=(function(v){return v.map((E=>(function(A){return new mh(No(A.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(A.direction))})(E)))})(n.orderBy));let p=null;n.limit&&(p=(function(v){let E;return E=typeof v=="object"?v.value:v,Vh(E)?null:E})(n.limit));let h=null;n.startAt&&(h=(function(v){const E=!!v.before,w=v.values||[];return new fh(w,E)})(n.startAt));let m=null;return n.endAt&&(m=(function(v){const E=!v.before,w=v.values||[];return new fh(w,E)})(n.endAt)),o2(e,o,c,l,p,"F",h,m)}function H2(t,e){const n=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ke(28987,{purpose:o})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function qx(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=No(n.unaryFilter.field);return Yt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const o=No(n.unaryFilter.field);return Yt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=No(n.unaryFilter.field);return Yt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=No(n.unaryFilter.field);return Yt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ke(61313);default:return ke(60726)}})(t):t.fieldFilter!==void 0?(function(n){return Yt.create(No(n.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ke(58110);default:return ke(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Ir.create(n.compositeFilter.filters.map((s=>qx(s))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return ke(1026)}})(n.compositeFilter.op))})(t):ke(30097,{filter:t})}function G2(t){return j2[t]}function Q2(t){return M2[t]}function K2(t){return k2[t]}function ko(t){return{fieldPath:t.canonicalString()}}function No(t){return pn.fromServerFormat(t.fieldPath)}function Hx(t){return t instanceof Yt?(function(n){if(n.op==="=="){if($b(n.value))return{unaryFilter:{field:ko(n.field),op:"IS_NAN"}};if(Kb(n.value))return{unaryFilter:{field:ko(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if($b(n.value))return{unaryFilter:{field:ko(n.field),op:"IS_NOT_NAN"}};if(Kb(n.value))return{unaryFilter:{field:ko(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ko(n.field),op:Q2(n.op),value:n.value}}})(t):t instanceof Ir?(function(n){const s=n.getFilters().map((o=>Hx(o)));return s.length===1?s[0]:{compositeFilter:{op:K2(n.op),filters:s}}})(t):ke(54877,{filter:t})}function $2(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function Gx(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Ds{constructor(e,n,s,o,l=Ve.min(),c=Ve.min(),p=gn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=p,this.expectedCount=h}withSequenceNumber(e){return new Ds(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Y2{constructor(e){this.yt=e}}function W2(t){const e=q2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Yp(e,e.limit,"L"):e}class X2{constructor(){this.Cn=new J2}addToCollectionParentIndex(e,n){return this.Cn.add(n),ve.resolve()}getCollectionParents(e,n){return ve.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ve.resolve()}deleteFieldIndex(e,n){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,n){return ve.resolve()}getDocumentsMatchingTarget(e,n){return ve.resolve(null)}getIndexType(e,n){return ve.resolve(0)}getFieldIndexes(e,n){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,n){return ve.resolve(Ls.min())}getMinOffsetFromCollectionGroup(e,n){return ve.resolve(Ls.min())}updateCollectionGroup(e,n,s){return ve.resolve()}updateIndexEntries(e,n){return ve.resolve()}}class J2{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),o=this.index[n]||new tn(bt.comparator),l=!o.has(s);return this.index[n]=o.add(s),l}has(e){const n=e.lastSegment(),s=e.popLast(),o=this.index[n];return o&&o.has(s)}getEntries(e){return(this.index[e]||new tn(bt.comparator)).toArray()}}const lE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Qx=41943040;class Ln{static withCacheSize(e){return new Ln(e,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}Ln.DEFAULT_COLLECTION_PERCENTILE=10,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ln.DEFAULT=new Ln(Qx,Ln.DEFAULT_COLLECTION_PERCENTILE,Ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ln.DISABLED=new Ln(-1,0,0);class $o{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new $o(0)}static cr(){return new $o(-1)}}const uE="LruGarbageCollector",Z2=1048576;function cE([t,e],[n,s]){const o=Ze(t,n);return o===0?Ze(e,s):o}class e5{constructor(e){this.Ir=e,this.buffer=new tn(cE),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();cE(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class t5{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ae(uE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ol(n)?Ae(uE,"Ignoring IndexedDB error during garbage collection: ",n):await al(n)}await this.Vr(3e5)}))}}class n5{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((s=>Math.floor(n/100*s)))}nthSequenceNumber(e,n){if(n===0)return ve.resolve(Ph.ce);const s=new e5(n);return this.mr.forEachTarget(e,(o=>s.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>s.Ar(o))))).next((()=>s.maxValue))}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ae("LruGarbageCollector","Garbage collection skipped; disabled"),ve.resolve(lE)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lE):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,o,l,c,p,h,m;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),o=this.params.maximumSequenceNumbersToCollect):o=v,c=Date.now(),this.nthSequenceNumber(e,o)))).next((v=>(s=v,p=Date.now(),this.removeTargets(e,s,n)))).next((v=>(l=v,h=Date.now(),this.removeOrphanedDocuments(e,s)))).next((v=>(m=Date.now(),jo()<=Je.DEBUG&&Ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${o} in `+(p-c)+`ms
	Removed ${l} targets in `+(h-p)+`ms
	Removed ${v} documents in `+(m-h)+`ms
Total Duration: ${m-_}ms`),ve.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:v}))))}}function r5(t,e){return new n5(t,e)}class i5{constructor(){this.changes=new Na((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Sn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?ve.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class s5{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class a5{constructor(e,n,s,o){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=o}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next((o=>(s=o,this.remoteDocumentCache.getEntry(e,n)))).next((o=>(s!==null&&Ou(s.mutation,o,Xn.empty(),wt.now()),o)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((s=>this.getLocalViewOfDocuments(e,s,et()).next((()=>s))))}getLocalViewOfDocuments(e,n,s=et()){const o=Aa();return this.populateOverlays(e,o,n).next((()=>this.computeViews(e,n,o,s).next((l=>{let c=wu();return l.forEach(((p,h)=>{c=c.insert(p,h.overlayedDocument)})),c}))))}getOverlayedDocuments(e,n){const s=Aa();return this.populateOverlays(e,s,n).next((()=>this.computeViews(e,n,s,et())))}populateOverlays(e,n,s){const o=[];return s.forEach((l=>{n.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((c,p)=>{n.set(c,p)}))}))}computeViews(e,n,s,o){let l=Ui();const c=Iu(),p=(function(){return Iu()})();return n.forEach(((h,m)=>{const _=s.get(m.key);o.has(m.key)&&(_===void 0||_.mutation instanceof Qs)?l=l.insert(m.key,m):_!==void 0?(c.set(m.key,_.mutation.getFieldMask()),Ou(_.mutation,m,_.mutation.getFieldMask(),wt.now())):c.set(m.key,Xn.empty())})),this.recalculateAndSaveOverlays(e,l).next((h=>(h.forEach(((m,_)=>c.set(m,_))),n.forEach(((m,_)=>p.set(m,new s5(_,c.get(m)??null)))),p)))}recalculateAndSaveOverlays(e,n){const s=Iu();let o=new It(((c,p)=>c-p)),l=et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((c=>{for(const p of c)p.keys().forEach((h=>{const m=n.get(h);if(m===null)return;let _=s.get(h)||Xn.empty();_=p.applyToLocalView(m,_),s.set(h,_);const v=(o.get(p.batchId)||et()).add(h);o=o.insert(p.batchId,v)}))})).next((()=>{const c=[],p=o.getReverseIterator();for(;p.hasNext();){const h=p.getNext(),m=h.key,_=h.value,v=Cx();_.forEach((E=>{if(!l.has(E)){const w=Mx(n.get(E),s.get(E));w!==null&&v.set(E,w),l=l.add(E)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,v))}return ve.waitFor(c)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,n,s,o){return(function(c){return Oe.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Sx(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,o):this.getDocumentsMatchingCollectionQuery(e,n,s,o)}getNextDocuments(e,n,s,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,o).next((l=>{const c=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,o-l.size):ve.resolve(Aa());let p=Pu,h=l;return c.next((m=>ve.forEach(m,((_,v)=>(p<v.largestBatchId&&(p=v.largestBatchId),l.get(_)?ve.resolve():this.remoteDocumentCache.getEntry(e,_).next((E=>{h=h.insert(_,E)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,h,m,et()))).next((_=>({batchId:p,changes:Ax(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Oe(n)).next((s=>{let o=wu();return s.isFoundDocument()&&(o=o.insert(s.key,s)),o}))}getDocumentsMatchingCollectionGroupQuery(e,n,s,o){const l=n.collectionGroup;let c=wu();return this.indexManager.getCollectionParents(e,l).next((p=>ve.forEach(p,(h=>{const m=(function(v,E){return new Yu(E,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,h.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,s,o).next((_=>{_.forEach(((v,E)=>{c=c.insert(v,E)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,n,s,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,l,o)))).next((c=>{l.forEach(((h,m)=>{const _=m.getKey();c.get(_)===null&&(c=c.insert(_,Sn.newInvalidDocument(_)))}));let p=wu();return c.forEach(((h,m)=>{const _=l.get(h);_!==void 0&&Ou(_.mutation,m,Xn.empty(),wt.now()),zh(n,m)&&(p=p.insert(h,m))})),p}))}}class o5{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ve.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(o){return{id:o.id,version:o.version,createTime:ii(o.createTime)}})(n)),ve.resolve()}getNamedQuery(e,n){return ve.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(o){return{name:o.name,query:W2(o.bundledQuery),readTime:ii(o.readTime)}})(n)),ve.resolve()}}class l5{constructor(){this.overlays=new It(Oe.comparator),this.qr=new Map}getOverlay(e,n){return ve.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Aa();return ve.forEach(n,(o=>this.getOverlay(e,o).next((l=>{l!==null&&s.set(o,l)})))).next((()=>s))}saveOverlays(e,n,s){return s.forEach(((o,l)=>{this.St(e,n,l)})),ve.resolve()}removeOverlaysForBatchId(e,n,s){const o=this.qr.get(s);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(s)),ve.resolve()}getOverlaysForCollection(e,n,s){const o=Aa(),l=n.length+1,c=new Oe(n.child("")),p=this.overlays.getIteratorFrom(c);for(;p.hasNext();){const h=p.getNext().value,m=h.getKey();if(!n.isPrefixOf(m.path))break;m.path.length===l&&h.largestBatchId>s&&o.set(h.getKey(),h)}return ve.resolve(o)}getOverlaysForCollectionGroup(e,n,s,o){let l=new It(((m,_)=>m-_));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===n&&m.largestBatchId>s){let _=l.get(m.largestBatchId);_===null&&(_=Aa(),l=l.insert(m.largestBatchId,_)),_.set(m.getKey(),m)}}const p=Aa(),h=l.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((m,_)=>p.set(m,_))),!(p.size()>=o)););return ve.resolve(p)}St(e,n,s){const o=this.overlays.get(s.key);if(o!==null){const c=this.qr.get(o.largestBatchId).delete(s.key);this.qr.set(o.largestBatchId,c)}this.overlays=this.overlays.insert(s.key,new A2(n,s));let l=this.qr.get(n);l===void 0&&(l=et(),this.qr.set(n,l)),this.qr.set(n,l.add(s.key))}}class u5{constructor(){this.sessionToken=gn.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ve.resolve()}}class Fg{constructor(){this.Qr=new tn(an.$r),this.Ur=new tn(an.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new an(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach((s=>this.addReference(s,n)))}removeReference(e,n){this.Gr(new an(e,n))}zr(e,n){e.forEach((s=>this.removeReference(s,n)))}jr(e){const n=new Oe(new bt([])),s=new an(n,e),o=new an(n,e+1),l=[];return this.Ur.forEachInRange([s,o],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Oe(new bt([])),s=new an(n,e),o=new an(n,e+1);let l=et();return this.Ur.forEachInRange([s,o],(c=>{l=l.add(c.key)})),l}containsKey(e){const n=new an(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class an{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Oe.comparator(e.key,n.key)||Ze(e.Yr,n.Yr)}static Kr(e,n){return Ze(e.Yr,n.Yr)||Oe.comparator(e.key,n.key)}}class c5{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new tn(an.$r)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,o){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new T2(l,n,s,o);this.mutationQueue.push(c);for(const p of o)this.Zr=this.Zr.add(new an(p.key,l)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return ve.resolve(c)}lookupMutationBatch(e,n){return ve.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,o=this.ei(s),l=o<0?0:o;return ve.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?jg:this.tr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new an(n,0),o=new an(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([s,o],(c=>{const p=this.Xr(c.Yr);l.push(p)})),ve.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new tn(Ze);return n.forEach((o=>{const l=new an(o,0),c=new an(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(p=>{s=s.add(p.Yr)}))})),ve.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,o=s.length+1;let l=s;Oe.isDocumentKey(l)||(l=l.child(""));const c=new an(new Oe(l),0);let p=new tn(Ze);return this.Zr.forEachWhile((h=>{const m=h.key.path;return!!s.isPrefixOf(m)&&(m.length===o&&(p=p.add(h.Yr)),!0)}),c),ve.resolve(this.ti(p))}ti(e){const n=[];return e.forEach((s=>{const o=this.Xr(s);o!==null&&n.push(o)})),n}removeMutationBatch(e,n){lt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return ve.forEach(n.mutations,(o=>{const l=new an(o.key,n.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,n){const s=new an(n,0),o=this.Zr.firstAfterOrEqual(s);return ve.resolve(n.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class d5{constructor(e){this.ri=e,this.docs=(function(){return new It(Oe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,o=this.docs.get(s),l=o?o.size:0,c=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return ve.resolve(s?s.document.mutableCopy():Sn.newInvalidDocument(n))}getEntries(e,n){let s=Ui();return n.forEach((o=>{const l=this.docs.get(o);s=s.insert(o,l?l.document.mutableCopy():Sn.newInvalidDocument(o))})),ve.resolve(s)}getDocumentsMatchingQuery(e,n,s,o){let l=Ui();const c=n.path,p=new Oe(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(p);for(;h.hasNext();){const{key:m,value:{document:_}}=h.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||UI(LI(_),s)<=0||(o.has(_.key)||zh(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return ve.resolve(l)}getAllFromCollectionGroup(e,n,s,o){ke(9500)}ii(e,n){return ve.forEach(this.docs,(s=>n(s)))}newChangeBuffer(e){return new h5(this)}getSize(e){return ve.resolve(this.size)}}class h5 extends i5{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((s,o)=>{o.isValidDocument()?n.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(s)})),ve.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class f5{constructor(e){this.persistence=e,this.si=new Na((n=>Ng(n)),Pg),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.oi=0,this._i=new Fg,this.targetCount=0,this.ai=$o.ur()}forEachTarget(e,n){return this.si.forEach(((s,o)=>n(o))),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),ve.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new $o(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ve.resolve()}updateTargetData(e,n){return this.Pr(n),ve.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,n,s){let o=0;const l=[];return this.si.forEach(((c,p)=>{p.sequenceNumber<=n&&s.get(p.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,p.targetId)),o++)})),ve.waitFor(l).next((()=>o))}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return ve.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),ve.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const o=this.persistence.referenceDelegate,l=[];return o&&n.forEach((c=>{l.push(o.markPotentiallyOrphaned(e,c))})),ve.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ve.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return ve.resolve(s)}containsKey(e,n){return ve.resolve(this._i.containsKey(n))}}class Kx{constructor(e,n){this.ui={},this.overlays={},this.ci=new Ph(0),this.li=!1,this.li=!0,this.hi=new u5,this.referenceDelegate=e(this),this.Pi=new f5(this),this.indexManager=new X2,this.remoteDocumentCache=(function(o){return new d5(o)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new Y2(n),this.Ii=new o5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new l5,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new c5(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){Ae("MemoryPersistence","Starting transaction:",e);const o=new m5(this.ci.next());return this.referenceDelegate.Ei(),s(o).next((l=>this.referenceDelegate.di(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ai(e,n){return ve.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,n))))}}class m5 extends BI{constructor(e){super(),this.currentSequenceNumber=e}}class qg{constructor(e){this.persistence=e,this.Ri=new Fg,this.Vi=null}static mi(e){return new qg(e)}get fi(){if(this.Vi)return this.Vi;throw ke(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),ve.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),ve.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ve.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((o=>this.fi.add(o.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next((o=>{o.forEach((l=>this.fi.add(l.toString())))})).next((()=>s.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.fi,(s=>{const o=Oe.fromPath(s);return this.gi(e,o).next((l=>{l||n.removeEntry(o,Ve.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return ve.or([()=>ve.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class _h{constructor(e,n){this.persistence=e,this.pi=new Na((s=>HI(s.path)),((s,o)=>s.isEqual(o))),this.garbageCollector=r5(this,n)}static mi(e,n){return new _h(e,n)}Ei(){}di(e){return ve.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>n.next((o=>s+o))))}wr(e){let n=0;return this.pr(e,(s=>{n++})).next((()=>n))}pr(e,n){return ve.forEach(this.pi,((s,o)=>this.br(e,s,o).next((l=>l?ve.resolve():n(o)))))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ii(e,(c=>this.br(e,c,n).next((p=>{p||(s++,l.removeEntry(c,Ve.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ve.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),ve.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),ve.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ve.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=$d(e.data.value)),n}br(e,n,s){return ve.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const o=this.pi.get(n);return ve.resolve(o!==void 0&&o>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Hg{constructor(e,n,s,o){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=o}static As(e,n){let s=et(),o=et();for(const l of n.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new Hg(e,n.fromCache,s,o)}}class p5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class g5{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return lD()?8:FI(wn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,o){const l={result:null};return this.ys(e,n).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,n,o,s).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new p5;return this.Ss(e,n,c).next((p=>{if(l.result=p,this.Vs)return this.bs(e,n,c,p.size)}))})).next((()=>l.result))}bs(e,n,s,o){return s.documentReadCount<this.fs?(jo()<=Je.DEBUG&&Ae("QueryEngine","SDK will not create cache indexes for query:",Mo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ve.resolve()):(jo()<=Je.DEBUG&&Ae("QueryEngine","Query:",Mo(n),"scans",s.documentReadCount,"local documents and returns",o,"documents as results."),s.documentReadCount>this.gs*o?(jo()<=Je.DEBUG&&Ae("QueryEngine","The SDK decides to create cache indexes for query:",Mo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ni(n))):ve.resolve())}ys(e,n){if(Jb(n))return ve.resolve(null);let s=ni(n);return this.indexManager.getIndexType(e,s).next((o=>o===0?null:(n.limit!==null&&o===1&&(n=Yp(n,null,"F"),s=ni(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const c=et(...l);return this.ps.getDocuments(e,c).next((p=>this.indexManager.getMinOffset(e,s).next((h=>{const m=this.Ds(n,p);return this.Cs(n,m,c,h.readTime)?this.ys(e,Yp(n,null,"F")):this.vs(e,m,n,h)}))))})))))}ws(e,n,s,o){return Jb(n)||o.isEqual(Ve.min())?ve.resolve(null):this.ps.getDocuments(e,s).next((l=>{const c=this.Ds(n,l);return this.Cs(n,c,s,o)?ve.resolve(null):(jo()<=Je.DEBUG&&Ae("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Mo(n)),this.vs(e,c,n,VI(o,Pu)).next((p=>p)))}))}Ds(e,n){let s=new tn(wx(e));return n.forEach(((o,l)=>{zh(e,l)&&(s=s.add(l))})),s}Cs(e,n,s,o){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}Ss(e,n,s){return jo()<=Je.DEBUG&&Ae("QueryEngine","Using full collection scan to execute query:",Mo(n)),this.ps.getDocumentsMatchingQuery(e,n,Ls.min(),s)}vs(e,n,s,o){return this.ps.getDocumentsMatchingQuery(e,s,o).next((l=>(n.forEach((c=>{l=l.insert(c.key,c)})),l)))}}const Gg="LocalStore",y5=3e8;class _5{constructor(e,n,s,o){this.persistence=e,this.Fs=n,this.serializer=o,this.Ms=new It(Ze),this.xs=new Na((l=>Ng(l)),Pg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new a5(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function v5(t,e,n,s){return new _5(t,e,n,s)}async function $x(t,e){const n=Ue(t);return await n.persistence.runTransaction("Handle user change","readonly",(s=>{let o;return n.mutationQueue.getAllMutationBatches(s).next((l=>(o=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(s)))).next((l=>{const c=[],p=[];let h=et();for(const m of o){c.push(m.batchId);for(const _ of m.mutations)h=h.add(_.key)}for(const m of l){p.push(m.batchId);for(const _ of m.mutations)h=h.add(_.key)}return n.localDocuments.getDocuments(s,h).next((m=>({Ls:m,removedBatchIds:c,addedBatchIds:p})))}))}))}function b5(t,e){const n=Ue(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const o=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(p,h,m,_){const v=m.batch,E=v.keys();let w=ve.resolve();return E.forEach((A=>{w=w.next((()=>_.getEntry(h,A))).next((R=>{const O=m.docVersions.get(A);lt(O!==null,48541),R.version.compareTo(O)<0&&(v.applyToRemoteDocument(R,m),R.isValidDocument()&&(R.setReadTime(m.commitVersion),_.addEntry(R)))}))})),w.next((()=>p.mutationQueue.removeMutationBatch(h,v)))})(n,s,e,l).next((()=>l.apply(s))).next((()=>n.mutationQueue.performConsistencyCheck(s))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(s,o,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(p){let h=et();for(let m=0;m<p.mutationResults.length;++m)p.mutationResults[m].transformResults.length>0&&(h=h.add(p.batch.mutations[m].key));return h})(e)))).next((()=>n.localDocuments.getDocuments(s,o)))}))}function Yx(t){const e=Ue(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function E5(t,e){const n=Ue(t),s=e.snapshotVersion;let o=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=n.Ns.newChangeBuffer({trackRemovals:!0});o=n.Ms;const p=[];e.targetChanges.forEach(((_,v)=>{const E=o.get(v);if(!E)return;p.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,v))));let w=E.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?w=w.withResumeToken(gn.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):_.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(_.resumeToken,s)),o=o.insert(v,w),(function(R,O,F){return R.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=y5?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0})(E,w,_)&&p.push(n.Pi.updateTargetData(l,w))}));let h=Ui(),m=et();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&p.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),p.push(S5(l,c,e.documentUpdates).next((_=>{h=_.ks,m=_.qs}))),!s.isEqual(Ve.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,s)));p.push(_)}return ve.waitFor(p).next((()=>c.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,h,m))).next((()=>h))})).then((l=>(n.Ms=o,l)))}function S5(t,e,n){let s=et(),o=et();return n.forEach((l=>s=s.add(l))),e.getEntries(t,s).next((l=>{let c=Ui();return n.forEach(((p,h)=>{const m=l.get(p);h.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(p)),h.isNoDocument()&&h.version.isEqual(Ve.min())?(e.removeEntry(p,h.readTime),c=c.insert(p,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),c=c.insert(p,h)):Ae(Gg,"Ignoring outdated watch update for ",p,". Current version:",m.version," Watch version:",h.version)})),{ks:c,qs:o}}))}function x5(t,e){const n=Ue(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=jg),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function w5(t,e){const n=Ue(t);return n.persistence.runTransaction("Allocate target","readwrite",(s=>{let o;return n.Pi.getTargetData(s,e).next((l=>l?(o=l,ve.resolve(o)):n.Pi.allocateTargetId(s).next((c=>(o=new Ds(e,c,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,o).next((()=>o)))))))})).then((s=>{const o=n.Ms.get(s.targetId);return(o===null||s.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s}))}async function eg(t,e,n){const s=Ue(t),o=s.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",l,(c=>s.persistence.referenceDelegate.removeTarget(c,o)))}catch(c){if(!ol(c))throw c;Ae(Gg,`Failed to update sequence numbers for target ${e}: ${c}`)}s.Ms=s.Ms.remove(e),s.xs.delete(o.target)}function dE(t,e,n){const s=Ue(t);let o=Ve.min(),l=et();return s.persistence.runTransaction("Execute query","readwrite",(c=>(function(h,m,_){const v=Ue(h),E=v.xs.get(_);return E!==void 0?ve.resolve(v.Ms.get(E)):v.Pi.getTargetData(m,_)})(s,c,ni(e)).next((p=>{if(p)return o=p.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(c,p.targetId).next((h=>{l=h}))})).next((()=>s.Fs.getDocumentsMatchingQuery(c,e,n?o:Ve.min(),n?l:et()))).next((p=>(T5(s,u2(e),p),{documents:p,Qs:l})))))}function T5(t,e,n){let s=t.Os.get(e)||Ve.min();n.forEach(((o,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),t.Os.set(e,s)}class hE{constructor(){this.activeTargetIds=p2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class A5{constructor(){this.Mo=new hE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new hE,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class C5{Oo(e){}shutdown(){}}const fE="ConnectivityMonitor";class mE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ae(fE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ae(fE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Fd=null;function tg(){return Fd===null?Fd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Fd++,"0x"+Fd.toString(16)}const xp="RestConnection",R5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class D5{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${o}`,this.Wo=this.databaseId.database===dh?`project_id=${s}`:`project_id=${s}&database_id=${o}`}Go(e,n,s,o,l){const c=tg(),p=this.zo(e,n.toUriEncodedString());Ae(xp,`Sending RPC '${e}' ${c}:`,p,s);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,o,l);const{host:m}=new URL(p),_=rl(m);return this.Jo(e,p,h,s,_).then((v=>(Ae(xp,`Received RPC '${e}' ${c}: `,v),v)),(v=>{throw qo(xp,`RPC '${e}' ${c} failed with error: `,v,"url: ",p,"request:",s),v}))}Ho(e,n,s,o,l,c){return this.Go(e,n,s,o,l)}jo(e,n,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+sl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((o,l)=>e[l]=o)),s&&s.headers.forEach(((o,l)=>e[l]=o))}zo(e,n){const s=R5[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}class I5{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const vn="WebChannelConnection";class O5 extends D5{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,o,l){const c=tg();return new Promise(((p,h)=>{const m=new XS;m.setWithCredentials(!0),m.listenOnce(JS.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Kd.NO_ERROR:const v=m.getResponseJson();Ae(vn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(v)),p(v);break;case Kd.TIMEOUT:Ae(vn,`RPC '${e}' ${c} timed out`),h(new Te(pe.DEADLINE_EXCEEDED,"Request time out"));break;case Kd.HTTP_ERROR:const E=m.getStatus();if(Ae(vn,`RPC '${e}' ${c} failed with status:`,E,"response text:",m.getResponseText()),E>0){let w=m.getResponseJson();Array.isArray(w)&&(w=w[0]);const A=w?.error;if(A&&A.status&&A.message){const R=(function(F){const q=F.toLowerCase().replace(/_/g,"-");return Object.values(pe).indexOf(q)>=0?q:pe.UNKNOWN})(A.status);h(new Te(R,A.message))}else h(new Te(pe.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new Te(pe.UNAVAILABLE,"Connection failed."));break;default:ke(9055,{l_:e,streamId:c,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Ae(vn,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(o);Ae(vn,`RPC '${e}' ${c} sending request:`,o),m.send(n,"POST",_,s,15)}))}T_(e,n,s){const o=tg(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=tx(),p=ex(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,n,s),h.encodeInitMessageHeaders=!0;const _=l.join("");Ae(vn,`Creating RPC '${e}' stream ${o}: ${_}`,h);const v=c.createWebChannel(_,h);this.I_(v);let E=!1,w=!1;const A=new I5({Yo:O=>{w?Ae(vn,`Not sending because RPC '${e}' stream ${o} is closed:`,O):(E||(Ae(vn,`Opening RPC '${e}' stream ${o} transport.`),v.open(),E=!0),Ae(vn,`RPC '${e}' stream ${o} sending:`,O),v.send(O))},Zo:()=>v.close()}),R=(O,F,q)=>{O.listen(F,(B=>{try{q(B)}catch($){setTimeout((()=>{throw $}),0)}}))};return R(v,xu.EventType.OPEN,(()=>{w||(Ae(vn,`RPC '${e}' stream ${o} transport opened.`),A.o_())})),R(v,xu.EventType.CLOSE,(()=>{w||(w=!0,Ae(vn,`RPC '${e}' stream ${o} transport closed`),A.a_(),this.E_(v))})),R(v,xu.EventType.ERROR,(O=>{w||(w=!0,qo(vn,`RPC '${e}' stream ${o} transport errored. Name:`,O.name,"Message:",O.message),A.a_(new Te(pe.UNAVAILABLE,"The operation could not be completed")))})),R(v,xu.EventType.MESSAGE,(O=>{if(!w){const F=O.data[0];lt(!!F,16349);const q=F,B=q?.error||q[0]?.error;if(B){Ae(vn,`RPC '${e}' stream ${o} received error:`,B);const $=B.status;let Y=(function(T){const I=Kt[T];if(I!==void 0)return Px(I)})($),X=B.message;Y===void 0&&(Y=pe.INTERNAL,X="Unknown error status: "+$+" with message "+B.message),w=!0,A.a_(new Te(Y,X)),v.close()}else Ae(vn,`RPC '${e}' stream ${o} received:`,F),A.u_(F)}})),R(p,ZS.STAT_EVENT,(O=>{O.stat===Fp.PROXY?Ae(vn,`RPC '${e}' stream ${o} detected buffering proxy`):O.stat===Fp.NOPROXY&&Ae(vn,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{A.__()}),0),A}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function wp(){return typeof document<"u"?document:null}function Hh(t){return new N2(t,!0)}class Wx{constructor(e,n,s=1e3,o=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=o,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),o=Math.max(0,n-s);o>0&&Ae("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const pE="PersistentStream";class Xx{constructor(e,n,s,o,l,c,p,h){this.Mi=e,this.S_=s,this.b_=o,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=p,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Wx(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===pe.RESOURCE_EXHAUSTED?(Vi(n.toString()),Vi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,o])=>{this.D_===n&&this.G_(s,o)}),(s=>{e((()=>{const o=new Te(pe.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(o)}))}))}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{s((()=>this.z_(o)))})),this.stream.onMessage((o=>{s((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ae(pE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Ae(pE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class j5 extends Xx{constructor(e,n,s,o,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,o,c),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=L2(this.serializer,e),s=(function(l){if(!("targetChange"in l))return Ve.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Ve.min():c.readTime?ii(c.readTime):Ve.min()})(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=Zp(this.serializer),n.addTarget=(function(l,c){let p;const h=c.target;if(p=Kp(h)?{documents:B2(l,h)}:{query:F2(l,h).ft},p.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){p.resumeToken=Ux(l,c.resumeToken);const m=Wp(l,c.expectedCount);m!==null&&(p.expectedCount=m)}else if(c.snapshotVersion.compareTo(Ve.min())>0){p.readTime=yh(l,c.snapshotVersion.toTimestamp());const m=Wp(l,c.expectedCount);m!==null&&(p.expectedCount=m)}return p})(this.serializer,e);const s=H2(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=Zp(this.serializer),n.removeTarget=e,this.q_(n)}}class M5 extends Xx{constructor(e,n,s,o,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,o,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=z2(e.writeResults,e.commitTime),s=ii(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=Zp(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((s=>U2(this.serializer,s)))};this.q_(n)}}class k5{}class N5 extends k5{constructor(e,n,s,o){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Te(pe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,Xp(n,s),o,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Te(pe.UNKNOWN,l.toString())}))}Ho(e,n,s,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,p])=>this.connection.Ho(e,Xp(n,s),o,c,p,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Te(pe.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class P5{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Vi(n),this.aa=!1):Ae("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const ja="RemoteStore";class V5{constructor(e,n,s,o,l){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{s.enqueueAndForget((async()=>{Pa(this)&&(Ae(ja,"Restarting streams for network reachability change."),await(async function(h){const m=Ue(h);m.Ea.add(4),await Ju(m),m.Ra.set("Unknown"),m.Ea.delete(4),await Gh(m)})(this))}))})),this.Ra=new P5(s,o)}}async function Gh(t){if(Pa(t))for(const e of t.da)await e(!0)}async function Ju(t){for(const e of t.da)await e(!1)}function Jx(t,e){const n=Ue(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Yg(n)?$g(n):ll(n).O_()&&Kg(n,e))}function Qg(t,e){const n=Ue(t),s=ll(n);n.Ia.delete(e),s.O_()&&Zx(n,e),n.Ia.size===0&&(s.O_()?s.L_():Pa(n)&&n.Ra.set("Unknown"))}function Kg(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ll(t).Y_(e)}function Zx(t,e){t.Va.Ue(e),ll(t).Z_(e)}function $g(t){t.Va=new O2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ll(t).start(),t.Ra.ua()}function Yg(t){return Pa(t)&&!ll(t).x_()&&t.Ia.size>0}function Pa(t){return Ue(t).Ea.size===0}function ew(t){t.Va=void 0}async function L5(t){t.Ra.set("Online")}async function U5(t){t.Ia.forEach(((e,n)=>{Kg(t,e)}))}async function z5(t,e){ew(t),Yg(t)?(t.Ra.ha(e),$g(t)):t.Ra.set("Unknown")}async function B5(t,e,n){if(t.Ra.set("Online"),e instanceof Lx&&e.state===2&&e.cause)try{await(async function(o,l){const c=l.cause;for(const p of l.targetIds)o.Ia.has(p)&&(await o.remoteSyncer.rejectListen(p,c),o.Ia.delete(p),o.Va.removeTarget(p))})(t,e)}catch(s){Ae(ja,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await vh(t,s)}else if(e instanceof Xd?t.Va.Ze(e):e instanceof Vx?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ve.min()))try{const s=await Yx(t.localStore);n.compareTo(s)>=0&&await(function(l,c){const p=l.Va.Tt(c);return p.targetChanges.forEach(((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const _=l.Ia.get(m);_&&l.Ia.set(m,_.withResumeToken(h.resumeToken,c))}})),p.targetMismatches.forEach(((h,m)=>{const _=l.Ia.get(h);if(!_)return;l.Ia.set(h,_.withResumeToken(gn.EMPTY_BYTE_STRING,_.snapshotVersion)),Zx(l,h);const v=new Ds(_.target,h,m,_.sequenceNumber);Kg(l,v)})),l.remoteSyncer.applyRemoteEvent(p)})(t,n)}catch(s){Ae(ja,"Failed to raise snapshot:",s),await vh(t,s)}}async function vh(t,e,n){if(!ol(e))throw e;t.Ea.add(1),await Ju(t),t.Ra.set("Offline"),n||(n=()=>Yx(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ae(ja,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Gh(t)}))}function tw(t,e){return e().catch((n=>vh(t,n,e)))}async function Qh(t){const e=Ue(t),n=Fs(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:jg;for(;F5(e);)try{const o=await x5(e.localStore,s);if(o===null){e.Ta.length===0&&n.L_();break}s=o.batchId,q5(e,o)}catch(o){await vh(e,o)}nw(e)&&rw(e)}function F5(t){return Pa(t)&&t.Ta.length<10}function q5(t,e){t.Ta.push(e);const n=Fs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function nw(t){return Pa(t)&&!Fs(t).x_()&&t.Ta.length>0}function rw(t){Fs(t).start()}async function H5(t){Fs(t).ra()}async function G5(t){const e=Fs(t);for(const n of t.Ta)e.ea(n.mutations)}async function Q5(t,e,n){const s=t.Ta.shift(),o=Ug.from(s,e,n);await tw(t,(()=>t.remoteSyncer.applySuccessfulWrite(o))),await Qh(t)}async function K5(t,e){e&&Fs(t).X_&&await(async function(s,o){if((function(c){return R2(c)&&c!==pe.ABORTED})(o.code)){const l=s.Ta.shift();Fs(s).B_(),await tw(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,o))),await Qh(s)}})(t,e),nw(t)&&rw(t)}async function gE(t,e){const n=Ue(t);n.asyncQueue.verifyOperationInProgress(),Ae(ja,"RemoteStore received new credentials");const s=Pa(n);n.Ea.add(3),await Ju(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Gh(n)}async function $5(t,e){const n=Ue(t);e?(n.Ea.delete(2),await Gh(n)):e||(n.Ea.add(2),await Ju(n),n.Ra.set("Unknown"))}function ll(t){return t.ma||(t.ma=(function(n,s,o){const l=Ue(n);return l.sa(),new j5(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(t.datastore,t.asyncQueue,{Xo:L5.bind(null,t),t_:U5.bind(null,t),r_:z5.bind(null,t),H_:B5.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Yg(t)?$g(t):t.Ra.set("Unknown")):(await t.ma.stop(),ew(t))}))),t.ma}function Fs(t){return t.fa||(t.fa=(function(n,s,o){const l=Ue(n);return l.sa(),new M5(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:H5.bind(null,t),r_:K5.bind(null,t),ta:G5.bind(null,t),na:Q5.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await Qh(t)):(await t.fa.stop(),t.Ta.length>0&&(Ae(ja,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class Wg{constructor(e,n,s,o,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=o,this.removalCallback=l,this.deferred=new ji,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,o,l){const c=Date.now()+s,p=new Wg(e,n,c,o,l);return p.start(s),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xg(t,e){if(Vi("AsyncQueue",`${e}: ${t}`),ol(t))return new Te(pe.UNAVAILABLE,`${e}: ${t}`);throw t}class Vo{static emptySet(e){return new Vo(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||Oe.comparator(n.key,s.key):(n,s)=>Oe.comparator(n.key,s.key),this.keyedMap=wu(),this.sortedSet=new It(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,s)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Vo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const o=n.getNext().key,l=s.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Vo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}class yE{constructor(){this.ga=new It(Oe.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ke(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,s)=>{e.push(s)})),e}}class Yo{constructor(e,n,s,o,l,c,p,h,m){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=o,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=p,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,n,s,o,l){const c=[];return n.forEach((p=>{c.push({type:0,doc:p})})),new Yo(e,n,Vo.emptySet(n),c,s,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let o=0;o<n.length;o++)if(n[o].type!==s[o].type||!n[o].doc.isEqual(s[o].doc))return!1;return!0}}class Y5{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class W5{constructor(){this.queries=_E(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,s){const o=Ue(n),l=o.queries;o.queries=_E(),l.forEach(((c,p)=>{for(const h of p.Sa)h.onError(s)}))})(this,new Te(pe.ABORTED,"Firestore shutting down"))}}function _E(){return new Na((t=>xx(t)),Uh)}async function iw(t,e){const n=Ue(t);let s=3;const o=e.query;let l=n.queries.get(o);l?!l.ba()&&e.Da()&&(s=2):(l=new Y5,s=e.Da()?0:1);try{switch(s){case 0:l.wa=await n.onListen(o,!0);break;case 1:l.wa=await n.onListen(o,!1);break;case 2:await n.onFirstRemoteStoreListen(o)}}catch(c){const p=Xg(c,`Initialization of query '${Mo(e.query)}' failed`);return void e.onError(p)}n.queries.set(o,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&Jg(n)}async function sw(t,e){const n=Ue(t),s=e.query;let o=3;const l=n.queries.get(s);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?o=e.Da()?0:1:!l.ba()&&e.Da()&&(o=2))}switch(o){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function X5(t,e){const n=Ue(t);let s=!1;for(const o of e){const l=o.query,c=n.queries.get(l);if(c){for(const p of c.Sa)p.Fa(o)&&(s=!0);c.wa=o}}s&&Jg(n)}function J5(t,e,n){const s=Ue(t),o=s.queries.get(e);if(o)for(const l of o.Sa)l.onError(n);s.queries.delete(e)}function Jg(t){t.Ca.forEach((e=>{e.next()}))}var ng,vE;(vE=ng||(ng={})).Ma="default",vE.Cache="cache";class aw{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const o of e.docChanges)o.type!==3&&s.push(o);e=new Yo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ng.Cache}}class ow{constructor(e){this.key=e}}class lw{constructor(e){this.key=e}}class Z5{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=et(),this.mutatedKeys=et(),this.eu=wx(e),this.tu=new Vo(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new yE,o=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,c=o,p=!1;const h=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((_,v)=>{const E=o.get(_),w=zh(this.query,v)?v:null,A=!!E&&this.mutatedKeys.has(E.key),R=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let O=!1;E&&w?E.data.isEqual(w.data)?A!==R&&(s.track({type:3,doc:w}),O=!0):this.su(E,w)||(s.track({type:2,doc:w}),O=!0,(h&&this.eu(w,h)>0||m&&this.eu(w,m)<0)&&(p=!0)):!E&&w?(s.track({type:0,doc:w}),O=!0):E&&!w&&(s.track({type:1,doc:E}),O=!0,(h||m)&&(p=!0)),O&&(w?(c=c.add(w),l=R?l.add(_):l.delete(_)):(c=c.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),l=l.delete(_.key),s.track({type:1,doc:_})}return{tu:c,iu:s,Cs:p,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,v)=>(function(w,A){const R=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ke(20277,{Rt:O})}};return R(w)-R(A)})(_.type,v.type)||this.eu(_.doc,v.doc))),this.ou(s),o=o??!1;const p=n&&!o?this._u():[],h=this.Xa.size===0&&this.current&&!o?1:0,m=h!==this.Za;return this.Za=h,c.length!==0||m?{snapshot:new Yo(this.query,e.tu,l,c,e.mutatedKeys,h===0,m,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new yE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=et(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const n=[];return e.forEach((s=>{this.Xa.has(s)||n.push(new lw(s))})),this.Xa.forEach((s=>{e.has(s)||n.push(new ow(s))})),n}cu(e){this.Ya=e.Qs,this.Xa=et();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Yo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Zg="SyncEngine";class eO{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class tO{constructor(e){this.key=e,this.hu=!1}}class nO{constructor(e,n,s,o,l,c){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Na((p=>xx(p)),Uh),this.Iu=new Map,this.Eu=new Set,this.du=new It(Oe.comparator),this.Au=new Map,this.Ru=new Fg,this.Vu={},this.mu=new Map,this.fu=$o.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function rO(t,e,n=!0){const s=mw(t);let o;const l=s.Tu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await uw(s,e,n,!0),o}async function iO(t,e){const n=mw(t);await uw(n,e,!0,!1)}async function uw(t,e,n,s){const o=await w5(t.localStore,ni(e)),l=o.targetId,c=t.sharedClientState.addLocalQueryTarget(l,n);let p;return s&&(p=await sO(t,e,l,c==="current",o.resumeToken)),t.isPrimaryClient&&n&&Jx(t.remoteStore,o),p}async function sO(t,e,n,s,o){t.pu=(v,E,w)=>(async function(R,O,F,q){let B=O.view.ru(F);B.Cs&&(B=await dE(R.localStore,O.query,!1).then((({documents:C})=>O.view.ru(C,B))));const $=q&&q.targetChanges.get(O.targetId),Y=q&&q.targetMismatches.get(O.targetId)!=null,X=O.view.applyChanges(B,R.isPrimaryClient,$,Y);return EE(R,O.targetId,X.au),X.snapshot})(t,v,E,w);const l=await dE(t.localStore,e,!0),c=new Z5(e,l.Qs),p=c.ru(l.documents),h=Xu.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",o),m=c.applyChanges(p,t.isPrimaryClient,h);EE(t,n,m.au);const _=new eO(e,n,c);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),m.snapshot}async function aO(t,e,n){const s=Ue(t),o=s.Tu.get(e),l=s.Iu.get(o.targetId);if(l.length>1)return s.Iu.set(o.targetId,l.filter((c=>!Uh(c,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(o.targetId),s.sharedClientState.isActiveQueryTarget(o.targetId)||await eg(s.localStore,o.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(o.targetId),n&&Qg(s.remoteStore,o.targetId),rg(s,o.targetId)})).catch(al)):(rg(s,o.targetId),await eg(s.localStore,o.targetId,!0))}async function oO(t,e){const n=Ue(t),s=n.Tu.get(e),o=n.Iu.get(s.targetId);n.isPrimaryClient&&o.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),Qg(n.remoteStore,s.targetId))}async function lO(t,e,n){const s=pO(t);try{const o=await(function(c,p){const h=Ue(c),m=wt.now(),_=p.reduce(((w,A)=>w.add(A.key)),et());let v,E;return h.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let A=Ui(),R=et();return h.Ns.getEntries(w,_).next((O=>{A=O,A.forEach(((F,q)=>{q.isValidDocument()||(R=R.add(F))}))})).next((()=>h.localDocuments.getOverlayedDocuments(w,A))).next((O=>{v=O;const F=[];for(const q of p){const B=x2(q,v.get(q.key).overlayedDocument);B!=null&&F.push(new Qs(q.key,B,px(B.value.mapValue),ri.exists(!0)))}return h.mutationQueue.addMutationBatch(w,m,F,p)})).next((O=>{E=O;const F=O.applyToLocalDocumentSet(v,R);return h.documentOverlayCache.saveOverlays(w,O.batchId,F)}))})).then((()=>({batchId:E.batchId,changes:Ax(v)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(o.batchId),(function(c,p,h){let m=c.Vu[c.currentUser.toKey()];m||(m=new It(Ze)),m=m.insert(p,h),c.Vu[c.currentUser.toKey()]=m})(s,o.batchId,n),await Zu(s,o.changes),await Qh(s.remoteStore)}catch(o){const l=Xg(o,"Failed to persist write");n.reject(l)}}async function cw(t,e){const n=Ue(t);try{const s=await E5(n.localStore,e);e.targetChanges.forEach(((o,l)=>{const c=n.Au.get(l);c&&(lt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?c.hu=!0:o.modifiedDocuments.size>0?lt(c.hu,14607):o.removedDocuments.size>0&&(lt(c.hu,42227),c.hu=!1))})),await Zu(n,s,e)}catch(s){await al(s)}}function bE(t,e,n){const s=Ue(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const o=[];s.Tu.forEach(((l,c)=>{const p=c.view.va(e);p.snapshot&&o.push(p.snapshot)})),(function(c,p){const h=Ue(c);h.onlineState=p;let m=!1;h.queries.forEach(((_,v)=>{for(const E of v.Sa)E.va(p)&&(m=!0)})),m&&Jg(h)})(s.eventManager,e),o.length&&s.Pu.H_(o),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function uO(t,e,n){const s=Ue(t);s.sharedClientState.updateQueryState(e,"rejected",n);const o=s.Au.get(e),l=o&&o.key;if(l){let c=new It(Oe.comparator);c=c.insert(l,Sn.newNoDocument(l,Ve.min()));const p=et().add(l),h=new qh(Ve.min(),new Map,new It(Ze),c,p);await cw(s,h),s.du=s.du.remove(l),s.Au.delete(e),ey(s)}else await eg(s.localStore,e,!1).then((()=>rg(s,e,n))).catch(al)}async function cO(t,e){const n=Ue(t),s=e.batch.batchId;try{const o=await b5(n.localStore,e);hw(n,s,null),dw(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Zu(n,o)}catch(o){await al(o)}}async function dO(t,e,n){const s=Ue(t);try{const o=await(function(c,p){const h=Ue(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let _;return h.mutationQueue.lookupMutationBatch(m,p).next((v=>(lt(v!==null,37113),_=v.keys(),h.mutationQueue.removeMutationBatch(m,v)))).next((()=>h.mutationQueue.performConsistencyCheck(m))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(m,_,p))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,_))).next((()=>h.localDocuments.getDocuments(m,_)))}))})(s.localStore,e);hw(s,e,n),dw(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Zu(s,o)}catch(o){await al(o)}}function dw(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function hw(t,e,n){const s=Ue(t);let o=s.Vu[s.currentUser.toKey()];if(o){const l=o.get(e);l&&(n?l.reject(n):l.resolve(),o=o.remove(e)),s.Vu[s.currentUser.toKey()]=o}}function rg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Iu.get(e))t.Tu.delete(s),n&&t.Pu.yu(s,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((s=>{t.Ru.containsKey(s)||fw(t,s)}))}function fw(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Qg(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),ey(t))}function EE(t,e,n){for(const s of n)s instanceof ow?(t.Ru.addReference(s.key,e),hO(t,s)):s instanceof lw?(Ae(Zg,"Document no longer in limbo: "+s.key),t.Ru.removeReference(s.key,e),t.Ru.containsKey(s.key)||fw(t,s.key)):ke(19791,{wu:s})}function hO(t,e){const n=e.key,s=n.path.canonicalString();t.du.get(n)||t.Eu.has(s)||(Ae(Zg,"New document in limbo: "+n),t.Eu.add(s),ey(t))}function ey(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Oe(bt.fromString(e)),s=t.fu.next();t.Au.set(s,new tO(n)),t.du=t.du.insert(n,s),Jx(t.remoteStore,new Ds(ni(Vg(n.path)),s,"TargetPurposeLimboResolution",Ph.ce))}}async function Zu(t,e,n){const s=Ue(t),o=[],l=[],c=[];s.Tu.isEmpty()||(s.Tu.forEach(((p,h)=>{c.push(s.pu(h,e,n).then((m=>{if((m||n)&&s.isPrimaryClient){const _=m?!m.fromCache:n?.targetChanges.get(h.targetId)?.current;s.sharedClientState.updateQueryState(h.targetId,_?"current":"not-current")}if(m){o.push(m);const _=Hg.As(h.targetId,m);l.push(_)}})))})),await Promise.all(c),s.Pu.H_(o),await(async function(h,m){const _=Ue(h);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ve.forEach(m,(E=>ve.forEach(E.Es,(w=>_.persistence.referenceDelegate.addReference(v,E.targetId,w))).next((()=>ve.forEach(E.ds,(w=>_.persistence.referenceDelegate.removeReference(v,E.targetId,w)))))))))}catch(v){if(!ol(v))throw v;Ae(Gg,"Failed to update sequence numbers: "+v)}for(const v of m){const E=v.targetId;if(!v.fromCache){const w=_.Ms.get(E),A=w.snapshotVersion,R=w.withLastLimboFreeSnapshotVersion(A);_.Ms=_.Ms.insert(E,R)}}})(s.localStore,l))}async function fO(t,e){const n=Ue(t);if(!n.currentUser.isEqual(e)){Ae(Zg,"User change. New user:",e.toKey());const s=await $x(n.localStore,e);n.currentUser=e,(function(l,c){l.mu.forEach((p=>{p.forEach((h=>{h.reject(new Te(pe.CANCELLED,c))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Zu(n,s.Ls)}}function mO(t,e){const n=Ue(t),s=n.Au.get(e);if(s&&s.hu)return et().add(s.key);{let o=et();const l=n.Iu.get(e);if(!l)return o;for(const c of l){const p=n.Tu.get(c);o=o.unionWith(p.view.nu)}return o}}function mw(t){const e=Ue(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=cw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=mO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=uO.bind(null,e),e.Pu.H_=X5.bind(null,e.eventManager),e.Pu.yu=J5.bind(null,e.eventManager),e}function pO(t){const e=Ue(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=dO.bind(null,e),e}class bh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return v5(this.persistence,new g5,e.initialUser,this.serializer)}Cu(e){return new Kx(qg.mi,this.serializer)}Du(e){return new A5}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bh.provider={build:()=>new bh};class gO extends bh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){lt(this.persistence.referenceDelegate instanceof _h,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new t5(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Ln.withCacheSize(this.cacheSizeBytes):Ln.DEFAULT;return new Kx((s=>_h.mi(s,n)),this.serializer)}}class ig{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>bE(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=fO.bind(null,this.syncEngine),await $5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new W5})()}createDatastore(e){const n=Hh(e.databaseInfo.databaseId),s=(function(l){return new O5(l)})(e.databaseInfo);return(function(l,c,p,h){return new N5(l,c,p,h)})(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return(function(s,o,l,c,p){return new V5(s,o,l,c,p)})(this.localStore,this.datastore,e.asyncQueue,(n=>bE(this.syncEngine,n,0)),(function(){return mE.v()?new mE:new C5})())}createSyncEngine(e,n){return(function(o,l,c,p,h,m,_){const v=new nO(o,l,c,p,h,m);return _&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const s=Ue(n);Ae(ja,"RemoteStore shutting down."),s.Ea.add(5),await Ju(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ig.provider={build:()=>new ig};class pw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Vi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const qs="FirestoreClient";class yO{constructor(e,n,s,o,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=o,this.user=En.UNAUTHENTICATED,this.clientId=Og.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async c=>{Ae(qs,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(s,(c=>(Ae(qs,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ji;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=Xg(n,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function Tp(t,e){t.asyncQueue.verifyOperationInProgress(),Ae(qs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener((async o=>{s.isEqual(o)||(await $x(e.localStore,o),s=o)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function SE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await _O(t);Ae(qs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((s=>gE(e.remoteStore,s))),t.setAppCheckTokenChangeListener(((s,o)=>gE(e.remoteStore,o))),t._onlineComponents=e}async function _O(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ae(qs,"Using user provided OfflineComponentProvider");try{await Tp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(o){return o.name==="FirebaseError"?o.code===pe.FAILED_PRECONDITION||o.code===pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(n))throw n;qo("Error using user provided cache. Falling back to memory cache: "+n),await Tp(t,new bh)}}else Ae(qs,"Using default OfflineComponentProvider"),await Tp(t,new gO(void 0));return t._offlineComponents}async function gw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ae(qs,"Using user provided OnlineComponentProvider"),await SE(t,t._uninitializedComponentsProvider._online)):(Ae(qs,"Using default OnlineComponentProvider"),await SE(t,new ig))),t._onlineComponents}function vO(t){return gw(t).then((e=>e.syncEngine))}async function yw(t){const e=await gw(t),n=e.eventManager;return n.onListen=rO.bind(null,e.syncEngine),n.onUnlisten=aO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=iO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=oO.bind(null,e.syncEngine),n}function bO(t,e,n={}){const s=new ji;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,p,h,m){const _=new pw({next:E=>{_.Nu(),c.enqueueAndForget((()=>sw(l,v)));const w=E.docs.has(p);!w&&E.fromCache?m.reject(new Te(pe.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&E.fromCache&&h&&h.source==="server"?m.reject(new Te(pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(E)},error:E=>m.reject(E)}),v=new aw(Vg(p.path),_,{includeMetadataChanges:!0,qa:!0});return iw(l,v)})(await yw(t),t.asyncQueue,e,n,s))),s.promise}function EO(t,e,n={}){const s=new ji;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,p,h,m){const _=new pw({next:E=>{_.Nu(),c.enqueueAndForget((()=>sw(l,v))),E.fromCache&&h.source==="server"?m.reject(new Te(pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(E)},error:E=>m.reject(E)}),v=new aw(p,_,{includeMetadataChanges:!0,qa:!0});return iw(l,v)})(await yw(t),t.asyncQueue,e,n,s))),s.promise}function _w(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const xE=new Map;const vw="firestore.googleapis.com",wE=!0;class TE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Te(pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=vw,this.ssl=wE}else this.host=e.host,this.ssl=e.ssl??wE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Qx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Z2)throw new Te(pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}PI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_w(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Te(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Te(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Te(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,o){return s.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Kh{constructor(e,n,s,o){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new TE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Te(pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Te(pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new TE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new AI;switch(s.type){case"firstParty":return new II(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Te(pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const s=xE.get(n);s&&(Ae("ComponentProvider","Removing Datastore"),xE.delete(n),s.terminate())})(this),Promise.resolve()}}function SO(t,e,n,s={}){t=Li(t,Kh);const o=rl(e),l=t._getSettings(),c={...l,emulatorOptions:t._getEmulatorOptions()},p=`${e}:${n}`;o&&(FS(`https://${p}`),qS("Firestore",!0)),l.host!==vw&&l.host!==p&&qo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...l,host:p,ssl:o,emulatorOptions:s};if(!Vs(h,c)&&(t._setSettings(h),s.mockUserToken)){let m,_;if(typeof s.mockUserToken=="string")m=s.mockUserToken,_=En.MOCK_USER;else{m=ZR(s.mockUserToken,t._app?.options.projectId);const v=s.mockUserToken.sub||s.mockUserToken.user_id;if(!v)throw new Te(pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new En(v)}t._authCredentials=new CI(new rx(m,_))}}class ul{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new ul(this.firestore,e,this._query)}}class Lt{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ns(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Lt(this.firestore,e,this._key)}toJSON(){return{type:Lt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if($u(n,Lt._jsonSchema))return new Lt(e,s||null,new Oe(bt.fromString(n.referencePath)))}}Lt._jsonSchemaVersion="firestore/documentReference/1.0",Lt._jsonSchema={type:Wt("string",Lt._jsonSchemaVersion),referencePath:Wt("string")};class Ns extends ul{constructor(e,n,s){super(e,n,Vg(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Lt(this.firestore,null,new Oe(e))}withConverter(e){return new Ns(this.firestore,e,this._path)}}function $h(t,e,...n){if(t=on(t),ix("collection","path",e),t instanceof Kh){const s=bt.fromString(e,...n);return Lb(s),new Ns(t,null,s)}{if(!(t instanceof Lt||t instanceof Ns))throw new Te(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(bt.fromString(e,...n));return Lb(s),new Ns(t.firestore,null,s)}}function Pe(t,e,...n){if(t=on(t),arguments.length===1&&(e=Og.newId()),ix("doc","path",e),t instanceof Kh){const s=bt.fromString(e,...n);return Vb(s),new Lt(t,null,new Oe(s))}{if(!(t instanceof Lt||t instanceof Ns))throw new Te(pe.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(bt.fromString(e,...n));return Vb(s),new Lt(t.firestore,t instanceof Ns?t.converter:null,new Oe(s))}}const AE="AsyncQueue";class CE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Wx(this,"async_queue_retry"),this._c=()=>{const s=wp();s&&Ae(AE,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=wp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=wp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new ji;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ol(e))throw e;Ae(AE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,Vi("INTERNAL UNHANDLED ERROR: ",RE(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const o=Wg.createAndSchedule(this,e,n,s,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&ke(47125,{Pc:RE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,s)=>n.targetTimeMs-s.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function RE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class ec extends Kh{constructor(e,n,s,o){super(e,n,s,o),this.type="firestore",this._queue=new CE,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new CE(e),this._firestoreClient=void 0,await e}}}function Tn(t,e){const n=typeof t=="object"?t:KS(),s=typeof t=="string"?t:dh,o=Dg(n,"firestore").getImmediate({identifier:s});if(!o._initialized){const l=XR("firestore");l&&SO(o,...l)}return o}function ty(t){if(t._terminated)throw new Te(pe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||xO(t),t._firestoreClient}function xO(t){const e=t._freezeSettings(),n=(function(o,l,c,p){return new KI(o,l,c,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,_w(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new yO(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(o){const l=o?._online.build();return{_offline:o?._offline.build(l),_online:l}})(t._componentsProvider))}class fr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fr(gn.fromBase64String(e))}catch(n){throw new Te(pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new fr(gn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:fr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($u(e,fr._jsonSchema))return fr.fromBase64String(e.bytes)}}fr._jsonSchemaVersion="firestore/bytes/1.0",fr._jsonSchema={type:Wt("string",fr._jsonSchemaVersion),bytes:Wt("string")};class Yh{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Te(pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Wh{constructor(e){this._methodName=e}}class si{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Te(pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Te(pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ze(this._lat,e._lat)||Ze(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:si._jsonSchemaVersion}}static fromJSON(e){if($u(e,si._jsonSchema))return new si(e.latitude,e.longitude)}}si._jsonSchemaVersion="firestore/geoPoint/1.0",si._jsonSchema={type:Wt("string",si._jsonSchemaVersion),latitude:Wt("number"),longitude:Wt("number")};class ai{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,o){if(s.length!==o.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ai._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($u(e,ai._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new ai(e.vectorValues);throw new Te(pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ai._jsonSchemaVersion="firestore/vectorValue/1.0",ai._jsonSchema={type:Wt("string",ai._jsonSchemaVersion),vectorValues:Wt("object")};const wO=/^__.*__$/;class TO{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new Qs(e,this.data,this.fieldMask,n,this.fieldTransforms):new Wu(e,this.data,n,this.fieldTransforms)}}class bw{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new Qs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Ew(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ke(40011,{Ac:t})}}class Xh{constructor(e,n,s,o,l,c){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=o,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Xh({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){const n=this.path?.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Eh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Ew(this.Ac)&&wO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class AO{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||Hh(e)}Cc(e,n,s,o=!1){return new Xh({Ac:e,methodName:n,Dc:s,path:pn.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ny(t){const e=t._freezeSettings(),n=Hh(t._databaseId);return new AO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function CO(t,e,n,s,o,l={}){const c=t.Cc(l.merge||l.mergeFields?2:0,e,n,o);iy("Data must be an object, but it was:",c,s);const p=Sw(s,c);let h,m;if(l.merge)h=new Xn(c.fieldMask),m=c.fieldTransforms;else if(l.mergeFields){const _=[];for(const v of l.mergeFields){const E=sg(e,v,n);if(!c.contains(E))throw new Te(pe.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);ww(_,E)||_.push(E)}h=new Xn(_),m=c.fieldTransforms.filter((v=>h.covers(v.field)))}else h=null,m=c.fieldTransforms;return new TO(new Un(p),h,m)}class Jh extends Wh{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jh}}function RO(t,e,n){return new Xh({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class ry extends Wh{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=RO(this,e,!0),s=this.vc.map((l=>cl(l,n))),o=new Ko(s);return new v2(e.path,o)}isEqual(e){return e instanceof ry&&Vs(this.vc,e.vc)}}function DO(t,e,n,s){const o=t.Cc(1,e,n);iy("Data must be an object, but it was:",o,s);const l=[],c=Un.empty();Gs(s,((h,m)=>{const _=sy(e,h,n);m=on(m);const v=o.yc(_);if(m instanceof Jh)l.push(_);else{const E=cl(m,v);E!=null&&(l.push(_),c.set(_,E))}}));const p=new Xn(l);return new bw(c,p,o.fieldTransforms)}function IO(t,e,n,s,o,l){const c=t.Cc(1,e,n),p=[sg(e,s,n)],h=[o];if(l.length%2!=0)throw new Te(pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<l.length;E+=2)p.push(sg(e,l[E])),h.push(l[E+1]);const m=[],_=Un.empty();for(let E=p.length-1;E>=0;--E)if(!ww(m,p[E])){const w=p[E];let A=h[E];A=on(A);const R=c.yc(w);if(A instanceof Jh)m.push(w);else{const O=cl(A,R);O!=null&&(m.push(w),_.set(w,O))}}const v=new Xn(m);return new bw(_,v,c.fieldTransforms)}function OO(t,e,n,s=!1){return cl(n,t.Cc(s?4:3,e))}function cl(t,e){if(xw(t=on(t)))return iy("Unsupported field value:",e,t),Sw(t,e);if(t instanceof Wh)return(function(s,o){if(!Ew(o.Ac))throw o.Sc(`${s._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(o);l&&o.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,o){const l=[];let c=0;for(const p of s){let h=cl(p,o.wc(c));h==null&&(h={nullValue:"NULL_VALUE"}),l.push(h),c++}return{arrayValue:{values:l}}})(t,e)}return(function(s,o){if((s=on(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return g2(o.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=wt.fromDate(s);return{timestampValue:yh(o.serializer,l)}}if(s instanceof wt){const l=new wt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:yh(o.serializer,l)}}if(s instanceof si)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof fr)return{bytesValue:Ux(o.serializer,s._byteString)};if(s instanceof Lt){const l=o.databaseId,c=s.firestore._databaseId;if(!c.isEqual(l))throw o.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Bg(s.firestore._databaseId||o.databaseId,s._key.path)}}if(s instanceof ai)return(function(c,p){return{mapValue:{fields:{[fx]:{stringValue:mx},[hh]:{arrayValue:{values:c.toArray().map((m=>{if(typeof m!="number")throw p.Sc("VectorValues must only contain numeric values.");return Lg(p.serializer,m)}))}}}}}})(s,o);throw o.Sc(`Unsupported field value: ${Nh(s)}`)})(t,e)}function Sw(t,e){const n={};return ox(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gs(t,((s,o)=>{const l=cl(o,e.mc(s));l!=null&&(n[s]=l)})),{mapValue:{fields:n}}}function xw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof wt||t instanceof si||t instanceof fr||t instanceof Lt||t instanceof Wh||t instanceof ai)}function iy(t,e,n){if(!xw(n)||!sx(n)){const s=Nh(n);throw s==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+s)}}function sg(t,e,n){if((e=on(e))instanceof Yh)return e._internalPath;if(typeof e=="string")return sy(t,e);throw Eh("Field path arguments must be of type string or ",t,!1,void 0,n)}const jO=new RegExp("[~\\*/\\[\\]]");function sy(t,e,n){if(e.search(jO)>=0)throw Eh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Yh(...e.split("."))._internalPath}catch{throw Eh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Eh(t,e,n,s,o){const l=s&&!s.isEmpty(),c=o!==void 0;let p=`Function ${e}() called with invalid data`;n&&(p+=" (via `toFirestore()`)"),p+=". ";let h="";return(l||c)&&(h+=" (found",l&&(h+=` in field ${s}`),c&&(h+=` in document ${o}`),h+=")"),new Te(pe.INVALID_ARGUMENT,p+t+h)}function ww(t,e){return t.some((n=>n.isEqual(e)))}class Tw{constructor(e,n,s,o,l){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Lt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new MO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ay("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class MO extends Tw{data(){return super.data()}}function ay(t,e){return typeof e=="string"?sy(t,e):e instanceof Yh?e._internalPath:e._delegate._internalPath}function kO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Te(pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class oy{}class NO extends oy{}function ly(t,e,...n){let s=[];e instanceof oy&&s.push(e),s=s.concat(n),(function(l){const c=l.filter((h=>h instanceof cy)).length,p=l.filter((h=>h instanceof Zh)).length;if(c>1||c>0&&p>0)throw new Te(pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const o of s)t=o._apply(t);return t}class Zh extends NO{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new Zh(e,n,s)}_apply(e){const n=this._parse(e);return Aw(e._query,n),new ul(e.firestore,e.converter,$p(e._query,n))}_parse(e){const n=ny(e.firestore);return(function(l,c,p,h,m,_,v){let E;if(m.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new Te(pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){IE(v,_);const A=[];for(const R of v)A.push(DE(h,l,R));E={arrayValue:{values:A}}}else E=DE(h,l,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||IE(v,_),E=OO(p,c,v,_==="in"||_==="not-in");return Yt.create(m,_,E)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function uy(t,e,n){const s=e,o=ay("where",t);return Zh._create(o,s,n)}class cy extends oy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new cy(e,n)}_parse(e){const n=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return n.length===1?n[0]:Ir.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(o,l){let c=o;const p=l.getFlattenedFilters();for(const h of p)Aw(c,h),c=$p(c,h)})(e._query,n),new ul(e.firestore,e.converter,$p(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function DE(t,e,n){if(typeof(n=on(n))=="string"){if(n==="")throw new Te(pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sx(e)&&n.indexOf("/")!==-1)throw new Te(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(bt.fromString(n));if(!Oe.isDocumentKey(s))throw new Te(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Qb(t,new Oe(s))}if(n instanceof Lt)return Qb(t,n._key);throw new Te(pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Nh(n)}.`)}function IE(t,e){if(!Array.isArray(t)||t.length===0)throw new Te(pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Aw(t,e){const n=(function(o,l){for(const c of o)for(const p of c.getFlattenedFilters())if(l.indexOf(p.op)>=0)return p.op;return null})(t.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Te(pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Te(pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class PO{convertValue(e,n="none"){switch(Bs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(zs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ke(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Gs(e,((o,l)=>{s[o]=this.convertValue(l,n)})),s}convertVectorValue(e){const n=e.fields?.[hh].arrayValue?.values?.map((s=>Vt(s.doubleValue)));return new ai(n)}convertGeoPoint(e){return new si(Vt(e.latitude),Vt(e.longitude))}convertArray(e,n){return(e.values||[]).map((s=>this.convertValue(s,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const s=Lh(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(Vu(e));default:return null}}convertTimestamp(e){const n=Us(e);return new wt(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=bt.fromString(e);lt(Gx(s),9688,{name:e});const o=new Lu(s.get(1),s.get(3)),l=new Oe(s.popFirst(5));return o.isEqual(n)||Vi(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function VO(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class Au{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ca extends Tw{constructor(e,n,s,o,l,c){super(e,n,s,o,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Jd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(ay("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ca._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ca._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ca._jsonSchema={type:Wt("string",Ca._jsonSchemaVersion),bundleSource:Wt("string","DocumentSnapshot"),bundleName:Wt("string"),bundle:Wt("string")};class Jd extends Ca{data(e={}){return super.data(e)}}class Lo{constructor(e,n,s,o){this._firestore=e,this._userDataWriter=n,this._snapshot=o,this.metadata=new Au(o.hasPendingWrites,o.fromCache),this.query=s}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((s=>{e.call(n,new Jd(this._firestore,this._userDataWriter,s.key,s,new Au(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Te(pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let c=0;return o._snapshot.docChanges.map((p=>{const h=new Jd(o._firestore,o._userDataWriter,p.doc.key,p.doc,new Au(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);return p.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}}))}{let c=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((p=>l||p.type!==3)).map((p=>{const h=new Jd(o._firestore,o._userDataWriter,p.doc.key,p.doc,new Au(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);let m=-1,_=-1;return p.type!==0&&(m=c.indexOf(p.doc.key),c=c.delete(p.doc.key)),p.type!==1&&(c=c.add(p.doc),_=c.indexOf(p.doc.key)),{type:LO(p.type),doc:h,oldIndex:m,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Lo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Og.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function LO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ke(61501,{type:t})}}function qe(t){t=Li(t,Lt);const e=Li(t.firestore,ec);return bO(ty(e),t._key).then((n=>UO(e,t,n)))}Lo._jsonSchemaVersion="firestore/querySnapshot/1.0",Lo._jsonSchema={type:Wt("string",Lo._jsonSchemaVersion),bundleSource:Wt("string","QuerySnapshot"),bundleName:Wt("string"),bundle:Wt("string")};class Cw extends PO{constructor(e){super(),this.firestore=e}convertBytes(e){return new fr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Lt(this.firestore,null,n)}}function ef(t){t=Li(t,ul);const e=Li(t.firestore,ec),n=ty(e),s=new Cw(e);return kO(t._query),EO(n,t._query).then((o=>new Lo(e,s,t,o)))}function vt(t,e,n){t=Li(t,Lt);const s=Li(t.firestore,ec),o=VO(t.converter,e,n);return Rw(s,[CO(ny(s),"setDoc",t._key,o,t.converter!==null,n).toMutation(t._key,ri.none())])}function qd(t,e,n,...s){t=Li(t,Lt);const o=Li(t.firestore,ec),l=ny(o);let c;return c=typeof(e=on(e))=="string"||e instanceof Yh?IO(l,"updateDoc",t._key,e,n,s):DO(l,"updateDoc",t._key,e),Rw(o,[c.toMutation(t._key,ri.exists(!0))])}function Rw(t,e){return(function(s,o){const l=new ji;return s.asyncQueue.enqueueAndForget((async()=>lO(await vO(s),o,l))),l.promise})(ty(t),e)}function UO(t,e,n){const s=n.docs.get(e._key),o=new Cw(t);return new Ca(t,o,e._key,s,new Au(n.hasPendingWrites,n.fromCache),e.converter)}function zO(...t){return new ry("arrayUnion",t)}(function(e,n=!0){(function(o){sl=o})(il),Fo(new Ia("firestore",((s,{instanceIdentifier:o,options:l})=>{const c=s.getProvider("app").getImmediate(),p=new ec(new RI(s.getProvider("auth-internal")),new OI(c,s.getProvider("app-check-internal")),(function(m,_){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Te(pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lu(m.options.projectId,_)})(c,o),c);return l={useFetchStreams:n,...l},p._setSettings(l),p}),"PUBLIC").setMultipleInstances(!0)),Ms(Mb,kb,e),Ms(Mb,kb,"esm2020")})();var BO="firebase",FO="12.7.0";Ms(BO,FO,"app");const qO={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},yn=QS(qO);function HO(t={}){const e={};return Object.entries(t).forEach(([n,s])=>{e[n]={nickname:s.nickname,balance:s.balance,account_group_id:s.account_group_id??null,sort_order:s.sort_order??0,is_income_account:s.is_income_account,is_income_default:s.is_income_default,is_outgo_account:s.is_outgo_account,is_outgo_default:s.is_outgo_default,on_budget:s.on_budget,is_active:s.is_active}}),e}function GO(t={}){const e={};return Object.entries(t).forEach(([n,s])=>{e[n]={name:s.name,sort_order:s.sort_order??0,expected_balance:s.expected_balance??"positive",on_budget:s.on_budget,is_active:s.is_active}}),e}function QO(t={}){const e={};return Object.entries(t).forEach(([n,s])=>{e[n]={name:s.name,description:s.description,category_group_id:s.category_group_id??null,sort_order:s.sort_order??0,default_monthly_amount:s.default_monthly_amount,default_monthly_type:s.default_monthly_type,balance:s.balance??0}}),e}function KO(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,s)=>n.sort_order-s.sort_order),e}async function $O(t){const e=Tn(yn),n=Pe(e,"budgets",t),s=await qe(n);if(!s.exists())throw new Error(`Budget ${t} not found`);const o=s.data();return{budget:{id:t,name:o.name,user_ids:o.user_ids||[],accepted_user_ids:o.accepted_user_ids||[],owner_id:o.owner_id||o.user_ids?.[0]||"",owner_email:o.owner_email||null},accounts:HO(o.accounts),accountGroups:GO(o.account_groups),categories:QO(o.categories),categoryGroups:KO(o.category_groups)}}function YO(t,e){return nl({queryKey:t?se.budget(t):["budget","none"],queryFn:()=>$O(t),enabled:!!t&&e?.enabled!==!1})}function ag(t){const e={};return Object.entries(t).forEach(([n,s])=>{e[n]={nickname:s.nickname,balance:s.balance,account_group_id:s.account_group_id??null,sort_order:s.sort_order},s.is_income_account!==void 0&&(e[n].is_income_account=s.is_income_account),s.is_income_default!==void 0&&(e[n].is_income_default=s.is_income_default),s.is_outgo_account!==void 0&&(e[n].is_outgo_account=s.is_outgo_account),s.is_outgo_default!==void 0&&(e[n].is_outgo_default=s.is_outgo_default),s.on_budget!==void 0&&(e[n].on_budget=s.on_budget),s.is_active!==void 0&&(e[n].is_active=s.is_active)}),e}function WO(t){return t.map(e=>{const n={id:e.id,amount:e.amount,account_id:e.account_id,date:e.date,created_at:e.created_at};return e.payee&&(n.payee=e.payee),e.description&&(n.description=e.description),n})}function XO(t){return t.map(e=>({category_id:e.category_id,amount:e.amount}))}function JO(t){return t.map(e=>{const n={id:e.id,amount:e.amount,category_id:e.category_id,account_id:e.account_id,date:e.date,created_at:e.created_at};return e.payee&&(n.payee=e.payee),e.description&&(n.description=e.description),n})}function ZO(t){return t.map(e=>({category_id:e.category_id,start_balance:e.start_balance,allocated:e.allocated,spent:e.spent,end_balance:e.end_balance}))}function tc(t,e,n){const s=n.toString().padStart(2,"0");return`${t}_${e}_${s}`}function dy(t,e,n,s){const o=(t.income||[]).map(m=>({id:m.id,amount:m.amount,account_id:m.account_id,date:m.date,payee:m.payee,description:m.description,created_at:m.created_at})),l=(t.expenses||[]).map(m=>({id:m.id,amount:m.amount,category_id:m.category_id,account_id:m.account_id,date:m.date,payee:m.payee,description:m.description,created_at:m.created_at})),c=(t.allocations||[]).map(m=>({category_id:m.category_id,amount:m.amount})),p=(t.category_balances||[]).map(m=>({category_id:m.category_id,start_balance:m.start_balance,allocated:m.allocated,spent:m.spent,end_balance:m.end_balance}));let h;return t.previous_month_snapshot&&(h={total_income:t.previous_month_snapshot.total_income??0,account_balances_end:t.previous_month_snapshot.account_balances_end??{},category_balances_end:t.previous_month_snapshot.category_balances_end??{},snapshot_taken_at:t.previous_month_snapshot.snapshot_taken_at}),{budget_id:e,year:n,month:s,income:o,total_income:t.total_income??o.reduce((m,_)=>m+_.amount,0),expenses:l,total_expenses:t.total_expenses??l.reduce((m,_)=>m+_.amount,0),allocations:c,allocations_finalized:t.allocations_finalized||!1,account_balances_start:t.account_balances_start,account_balances_end:t.account_balances_end,category_balances:p,previous_month_snapshot:h,snapshot_stale:t.snapshot_stale??!1,created_at:t.created_at,updated_at:t.updated_at||t.created_at}}function Dw(t,e){let n=t,s=e-1;return s<1&&(s=12,n-=1),{prevYear:n,prevMonth:s}}function og(t){const e={};return t.category_balances&&t.category_balances.forEach(n=>{e[n.category_id]=n.end_balance}),{total_income:t.total_income,account_balances_end:t.account_balances_end??{},category_balances_end:e,snapshot_taken_at:new Date().toISOString()}}async function ej(t,e,n,s){const o=Tn(yn),l=tc(t,e,n),c=Pe(o,"months",l),p=await qe(c);if(p.exists()){const m=dy(p.data(),t,e,n);return m.snapshot_stale===!0||m.previous_month_snapshot===void 0&&n!==1?await tj(o,t,e,n,m,c,s):m}return await nj(o,t,e,n,c,s)}async function tj(t,e,n,s,o,l,c){const{prevYear:p,prevMonth:h}=Dw(n,s);let m=null;const _=c.getQueryData(se.month(e,p,h));if(_)m=_.month;else{const w=tc(e,p,h),A=Pe(t,"months",w),R=await qe(A);R.exists()&&(m=dy(R.data(),e,p,h),c.setQueryData(se.month(e,p,h),{month:m}))}const v=m?og(m):{total_income:0,account_balances_end:{},category_balances_end:{},snapshot_taken_at:new Date().toISOString()},E={...o,previous_month_snapshot:v,snapshot_stale:!1,updated_at:new Date().toISOString()};return await vt(l,{budget_id:E.budget_id,year:E.year,month:E.month,income:E.income,total_income:E.total_income,expenses:E.expenses,total_expenses:E.total_expenses,allocations:E.allocations,allocations_finalized:E.allocations_finalized,category_balances:E.category_balances,account_balances_start:E.account_balances_start,account_balances_end:E.account_balances_end,previous_month_snapshot:v,snapshot_stale:!1,created_at:E.created_at,updated_at:E.updated_at}),E}async function nj(t,e,n,s,o,l){const c=new Date().toISOString();let p;if(s>1||n>new Date().getFullYear()-10){const{prevYear:_,prevMonth:v}=Dw(n,s),E=l.getQueryData(se.month(e,_,v));if(E)p=og(E.month);else{const w=tc(e,_,v),A=Pe(t,"months",w),R=await qe(A);if(R.exists()){const O=dy(R.data(),e,_,v);p=og(O),l.setQueryData(se.month(e,_,v),{month:O})}}}const h={budget_id:e,year:n,month:s,income:[],total_income:0,expenses:[],total_expenses:0,allocations:[],allocations_finalized:!1,category_balances:[],previous_month_snapshot:p,snapshot_stale:!1,created_at:c,updated_at:c},m={budget_id:e,year:n,month:s,income:[],total_income:0,expenses:[],total_expenses:0,allocations:[],allocations_finalized:!1,category_balances:[],snapshot_stale:!1,created_at:c,updated_at:c};return p&&(m.previous_month_snapshot=p),await vt(o,m),h}function rj(t,e,n,s){const o=Fi();return nl({queryKey:t?se.month(t,e,n):["month","none"],queryFn:async()=>({month:await ej(t,e,n,o)}),enabled:!!t&&s?.enabled!==!1})}function Mi(t,e,n,s){let o=n,l=s+1;l>12&&(l=1,o+=1);const c=se.month(e,o,l),p=t.getQueryData(c);p&&!p.month.snapshot_stale&&t.setQueryData(c,{month:{...p.month,snapshot_stale:!0}})}async function ij(t,e,n,s){let o=e,l=n+1;l>12&&(l=1,o+=1);const c=Tn(yn),p=tc(t,o,l),h=Pe(c,"months",p),m=await qe(h);if(m.exists()){const _=m.data();if(!_.snapshot_stale){await vt(h,{..._,snapshot_stale:!0,updated_at:new Date().toISOString()});const v=se.month(t,o,l),E=s.getQueryData(v);E&&s.setQueryData(v,{month:{...E.month,snapshot_stale:!0}})}}}async function sj(t){const e=Tn(yn),n=Pe(e,"payees",t),s=await qe(n);return s.exists()?s.data().payees||[]:[]}function aj(t,e){return nl({queryKey:t?se.payees(t):["payees","none"],queryFn:()=>sj(t),enabled:!!t&&e?.enabled!==!1})}async function oj(t,e){const n=Tn(yn),s=Pe(n,"users",t),o=await qe(s);if(o.exists())return o.data();const l={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await vt(s,l),l}function lj(t,e,n){return nl({queryKey:t?se.user(t):["user","none"],queryFn:()=>oj(t,e),enabled:!!t&&n?.enabled!==!1})}async function uj(t,e){const n=Tn(yn),s=$h(n,"budgets"),o=ly(s,uy("user_ids","array-contains",t)),l=await ef(o),c=[],p=[];for(const h of l.docs){const m=h.data();m.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(h.id)?c.push({id:h.id,name:m.name||"Unnamed Budget",ownerEmail:m.owner_email||null,isOwner:m.owner_id===t,isPending:!1}):p.push({budgetId:h.id,budgetName:m.name||"Unnamed Budget",ownerEmail:m.owner_email||null})}return{budgets:c,pendingInvites:p}}function cj(t,e,n){return nl({queryKey:t?se.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?uj(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}async function dj(){const t=Tn(yn),e=$h(t,"feedback"),n=await ef(e),s=[];return n.forEach(o=>{const l=o.data(),c=l.items||[],p=l.user_email||o.id;c.forEach(h=>{s.push({...h,doc_id:o.id,user_email:p})})}),{items:s}}function hj(t){return nl({queryKey:se.feedback(),queryFn:dj,enabled:t?.enabled!==!1,staleTime:60*1e3})}function fj(t){const e={};return Object.entries(t).forEach(([n,s])=>{e[n]={name:s.name,category_group_id:s.category_group_id??null,sort_order:s.sort_order,balance:s.balance??0},s.description!==void 0&&(e[n].description=s.description),s.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=s.default_monthly_amount),s.default_monthly_type!==void 0&&(e[n].default_monthly_type=s.default_monthly_type)}),e}function mj(t){const e={};return Object.entries(t).forEach(([n,s])=>{e[n]={name:s.name,sort_order:s.sort_order},s.expected_balance!==void 0&&(e[n].expected_balance=s.expected_balance),s.on_budget!==void 0&&(e[n].on_budget=s.on_budget),s.is_active!==void 0&&(e[n].is_active=s.is_active)}),e}function pj(){const t=Fi(),e=Tn(yn),n=Ct({mutationFn:async({budgetId:h,accounts:m})=>{const _=Pe(e,"budgets",h),v=await qe(_);if(!v.exists())throw new Error("Budget not found");const E=v.data(),w=ag(m);return await vt(_,{...E,accounts:w}),m},onMutate:async({budgetId:h,accounts:m})=>{await t.cancelQueries({queryKey:se.budget(h)});const _=t.getQueryData(se.budget(h));return _&&t.setQueryData(se.budget(h),{..._,accounts:m}),{previousData:_}},onSuccess:(h,{budgetId:m})=>{const _=t.getQueryData(se.budget(m));_&&t.setQueryData(se.budget(m),{..._,accounts:h})},onError:(h,{budgetId:m},_)=>{_?.previousData&&t.setQueryData(se.budget(m),_.previousData)}}),s=Ct({mutationFn:async({budgetId:h,accountGroups:m})=>{const _=Pe(e,"budgets",h),v=await qe(_);if(!v.exists())throw new Error("Budget not found");const E=v.data(),w=mj(m);return await vt(_,{...E,account_groups:w}),m},onMutate:async({budgetId:h,accountGroups:m})=>{await t.cancelQueries({queryKey:se.budget(h)});const _=t.getQueryData(se.budget(h));return _&&t.setQueryData(se.budget(h),{..._,accountGroups:m}),{previousData:_}},onSuccess:(h,{budgetId:m})=>{const _=t.getQueryData(se.budget(m));_&&t.setQueryData(se.budget(m),{..._,accountGroups:h})},onError:(h,{budgetId:m},_)=>{_?.previousData&&t.setQueryData(se.budget(m),_.previousData)}}),o=Ct({mutationFn:async({budgetId:h,categories:m})=>{const _=Pe(e,"budgets",h),v=await qe(_);if(!v.exists())throw new Error("Budget not found");const E=v.data(),w=fj(m);return await vt(_,{...E,categories:w}),m},onMutate:async({budgetId:h,categories:m})=>{await t.cancelQueries({queryKey:se.budget(h)});const _=t.getQueryData(se.budget(h));return _&&t.setQueryData(se.budget(h),{..._,categories:m}),{previousData:_}},onSuccess:(h,{budgetId:m})=>{const _=t.getQueryData(se.budget(m));_&&t.setQueryData(se.budget(m),{..._,categories:h})},onError:(h,{budgetId:m},_)=>{_?.previousData&&t.setQueryData(se.budget(m),_.previousData)}}),l=Ct({mutationFn:async({budgetId:h,categoryGroups:m})=>{const _=Pe(e,"budgets",h),v=await qe(_);if(!v.exists())throw new Error("Budget not found");const E=v.data();return await vt(_,{...E,category_groups:m}),m},onMutate:async({budgetId:h,categoryGroups:m})=>{await t.cancelQueries({queryKey:se.budget(h)});const _=t.getQueryData(se.budget(h));return _&&t.setQueryData(se.budget(h),{..._,categoryGroups:m}),{previousData:_}},onSuccess:(h,{budgetId:m})=>{const _=t.getQueryData(se.budget(m));_&&t.setQueryData(se.budget(m),{..._,categoryGroups:h})},onError:(h,{budgetId:m},_)=>{_?.previousData&&t.setQueryData(se.budget(m),_.previousData)}}),c=Ct({mutationFn:async({budgetId:h,accountId:m,delta:_})=>{const v=Pe(e,"budgets",h),E=await qe(v);if(!E.exists())throw new Error("Budget not found");const w=E.data(),A=w.accounts||{};if(!A[m])throw new Error("Account not found");const R={...A,[m]:{...A[m],balance:A[m].balance+_}};return await vt(v,{...w,accounts:ag(R)}),R},onMutate:async({budgetId:h,accountId:m,delta:_})=>{await t.cancelQueries({queryKey:se.budget(h)});const v=t.getQueryData(se.budget(h));if(v&&v.accounts[m]){const E={...v.accounts,[m]:{...v.accounts[m],balance:v.accounts[m].balance+_}};t.setQueryData(se.budget(h),{...v,accounts:E})}return{previousData:v}},onSuccess:(h,{budgetId:m})=>{const _=t.getQueryData(se.budget(m));_&&t.setQueryData(se.budget(m),{..._,accounts:h})},onError:(h,{budgetId:m},_)=>{_?.previousData&&t.setQueryData(se.budget(m),_.previousData)}}),p=Ct({mutationFn:async({budgetId:h,newName:m})=>{const _=Pe(e,"budgets",h),v=await qe(_);if(!v.exists())throw new Error("Budget not found");const E=v.data();return await vt(_,{...E,name:m.trim()}),m.trim()},onMutate:async({budgetId:h,newName:m})=>{await t.cancelQueries({queryKey:se.budget(h)});const _=t.getQueryData(se.budget(h));return _&&t.setQueryData(se.budget(h),{..._,budget:{..._.budget,name:m.trim()}}),{previousData:_}},onSuccess:(h,{budgetId:m})=>{const _=t.getQueryData(se.budget(m));_&&t.setQueryData(se.budget(m),{..._,budget:{..._.budget,name:h}})},onError:(h,{budgetId:m},_)=>{_?.previousData&&t.setQueryData(se.budget(m),_.previousData)}});return{updateAccounts:n,updateAccountGroups:s,updateCategories:o,updateCategoryGroups:l,updateAccountBalance:c,renameBudget:p}}async function ki(t,e,n,s){const o=tc(e,n.year,n.month),l=Pe(t,"months",o),c={budget_id:n.budget_id,year:n.year,month:n.month,income:WO(n.income),total_income:n.total_income,updated_at:new Date().toISOString()};n.created_at&&(c.created_at=n.created_at),n.expenses&&(c.expenses=JO(n.expenses)),n.total_expenses!==void 0&&(c.total_expenses=n.total_expenses),n.allocations&&(c.allocations=XO(n.allocations)),n.allocations_finalized!==void 0&&(c.allocations_finalized=n.allocations_finalized),n.category_balances&&(c.category_balances=ZO(n.category_balances)),n.account_balances_start&&(c.account_balances_start=n.account_balances_start),n.account_balances_end&&(c.account_balances_end=n.account_balances_end),n.previous_month_snapshot&&(c.previous_month_snapshot=n.previous_month_snapshot),n.snapshot_stale!==void 0&&(c.snapshot_stale=n.snapshot_stale),await vt(l,c),await ij(e,n.year,n.month,s)}async function ti(t,e,n,s){const o=Pe(t,"budgets",e),l=await qe(o);if(!l.exists())return null;const c=l.data(),p=c.accounts||{};if(!p[n])return null;const h={...p,[n]:{...p[n],balance:p[n].balance+s}};return await vt(o,{...c,accounts:ag(h)}),h}async function Sh(t,e,n,s){const o=n.trim();if(!o||s.includes(o))return null;const l=Pe(t,"payees",e),c=[...s,o].sort((p,h)=>p.toLowerCase().localeCompare(h.toLowerCase()));return await vt(l,{budget_id:e,payees:c,updated_at:new Date().toISOString()}),c}function gj(){const t=Fi(),e=Tn(yn),n=Ct({mutationFn:async l=>{const{budgetId:c,year:p,month:h,amount:m,accountId:_,date:v,payee:E,description:w}=l,A=se.month(c,p,h),R=t.getQueryData(A);if(!R)throw new Error("Month data not found");const O={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:m,account_id:_,date:v,created_at:new Date().toISOString()};E?.trim()&&(O.payee=E.trim()),w&&(O.description=w);const F=[...R.month.income,O],q={...R.month,income:F,total_income:F.reduce((X,C)=>X+C.amount,0),updated_at:new Date().toISOString()};await ki(e,c,q,t);const B=await ti(e,c,_,m),$=t.getQueryData(se.payees(c))||[];let Y=null;return E?.trim()&&(Y=await Sh(e,c,E,$)),{updatedMonth:q,newIncome:O,updatedAccounts:B,updatedPayees:Y}},onMutate:async l=>{const{budgetId:c,year:p,month:h,amount:m,accountId:_,date:v,payee:E,description:w}=l,A=se.month(c,p,h),R=se.budget(c);await t.cancelQueries({queryKey:A}),await t.cancelQueries({queryKey:R});const O=t.getQueryData(A),F=t.getQueryData(R);if(O){const q={id:`income_optimistic_${Date.now()}`,amount:m,account_id:_,date:v,created_at:new Date().toISOString()};E?.trim()&&(q.payee=E.trim()),w&&(q.description=w);const B=[...O.month.income,q];t.setQueryData(A,{...O,month:{...O.month,income:B,total_income:B.reduce(($,Y)=>$+Y.amount,0)}})}return F&&F.accounts[_]&&t.setQueryData(R,{...F,accounts:{...F.accounts,[_]:{...F.accounts[_],balance:F.accounts[_].balance+m}}}),Mi(t,c,p,h),{previousMonth:O,previousBudget:F}},onSuccess:(l,c)=>{const{budgetId:p,year:h,month:m}=c,_=se.month(p,h,m),v=se.budget(p),E=se.payees(p);if(t.setQueryData(_,{month:l.updatedMonth}),l.updatedAccounts){const w=t.getQueryData(v);w&&t.setQueryData(v,{...w,accounts:l.updatedAccounts})}l.updatedPayees&&t.setQueryData(E,l.updatedPayees)},onError:(l,c,p)=>{const{budgetId:h,year:m,month:_}=c;p?.previousMonth&&t.setQueryData(se.month(h,m,_),p.previousMonth),p?.previousBudget&&t.setQueryData(se.budget(h),p.previousBudget)}}),s=Ct({mutationFn:async l=>{const{budgetId:c,year:p,month:h,incomeId:m,amount:_,accountId:v,date:E,payee:w,description:A,oldAmount:R,oldAccountId:O}=l,F=se.month(c,p,h),q=t.getQueryData(F);if(!q)throw new Error("Month data not found");const B={id:m,amount:_,account_id:v,date:E,created_at:q.month.income.find(I=>I.id===m)?.created_at||new Date().toISOString()};w?.trim()&&(B.payee=w.trim()),A&&(B.description=A);const $=q.month.income.map(I=>I.id===m?B:I),Y={...q.month,income:$,total_income:$.reduce((I,k)=>I+k.amount,0),updated_at:new Date().toISOString()};await ki(e,c,Y,t);let X=null;v!==O?(await ti(e,c,O,-R),X=await ti(e,c,v,_)):_!==R&&(X=await ti(e,c,v,_-R));const C=t.getQueryData(se.payees(c))||[];let T=null;return w?.trim()&&(T=await Sh(e,c,w,C)),{updatedMonth:Y,updatedAccounts:X,updatedPayees:T}},onMutate:async l=>{const{budgetId:c,year:p,month:h,incomeId:m,amount:_,accountId:v,date:E,payee:w,description:A,oldAmount:R,oldAccountId:O}=l,F=se.month(c,p,h),q=se.budget(c);await t.cancelQueries({queryKey:F}),await t.cancelQueries({queryKey:q});const B=t.getQueryData(F),$=t.getQueryData(q);if(B){const Y={id:m,amount:_,account_id:v,date:E,created_at:B.month.income.find(C=>C.id===m)?.created_at||new Date().toISOString()};w?.trim()&&(Y.payee=w.trim()),A&&(Y.description=A);const X=B.month.income.map(C=>C.id===m?Y:C);t.setQueryData(F,{...B,month:{...B.month,income:X,total_income:X.reduce((C,T)=>C+T.amount,0)}})}if($){const Y={...$.accounts};v!==O?(Y[O]&&(Y[O]={...Y[O],balance:Y[O].balance-R}),Y[v]&&(Y[v]={...Y[v],balance:Y[v].balance+_})):_!==R&&Y[v]&&(Y[v]={...Y[v],balance:Y[v].balance+(_-R)}),t.setQueryData(q,{...$,accounts:Y})}return Mi(t,c,p,h),{previousMonth:B,previousBudget:$}},onSuccess:(l,c)=>{const{budgetId:p,year:h,month:m}=c,_=se.month(p,h,m),v=se.budget(p),E=se.payees(p);if(t.setQueryData(_,{month:l.updatedMonth}),l.updatedAccounts){const w=t.getQueryData(v);w&&t.setQueryData(v,{...w,accounts:l.updatedAccounts})}l.updatedPayees&&t.setQueryData(E,l.updatedPayees)},onError:(l,c,p)=>{const{budgetId:h,year:m,month:_}=c;p?.previousMonth&&t.setQueryData(se.month(h,m,_),p.previousMonth),p?.previousBudget&&t.setQueryData(se.budget(h),p.previousBudget)}}),o=Ct({mutationFn:async l=>{const{budgetId:c,year:p,month:h,incomeId:m,amount:_,accountId:v}=l,E=se.month(c,p,h),w=t.getQueryData(E);if(!w)throw new Error("Month data not found");const A=w.month.income.filter(F=>F.id!==m),R={...w.month,income:A,total_income:A.reduce((F,q)=>F+q.amount,0),updated_at:new Date().toISOString()};await ki(e,c,R,t);const O=await ti(e,c,v,-_);return{updatedMonth:R,updatedAccounts:O}},onMutate:async l=>{const{budgetId:c,year:p,month:h,incomeId:m,amount:_,accountId:v}=l,E=se.month(c,p,h),w=se.budget(c);await t.cancelQueries({queryKey:E}),await t.cancelQueries({queryKey:w});const A=t.getQueryData(E),R=t.getQueryData(w);if(A){const O=A.month.income.filter(F=>F.id!==m);t.setQueryData(E,{...A,month:{...A.month,income:O,total_income:O.reduce((F,q)=>F+q.amount,0)}})}return R&&R.accounts[v]&&t.setQueryData(w,{...R,accounts:{...R.accounts,[v]:{...R.accounts[v],balance:R.accounts[v].balance-_}}}),Mi(t,c,p,h),{previousMonth:A,previousBudget:R}},onSuccess:(l,c)=>{const{budgetId:p,year:h,month:m}=c,_=se.month(p,h,m),v=se.budget(p);if(t.setQueryData(_,{month:l.updatedMonth}),l.updatedAccounts){const E=t.getQueryData(v);E&&t.setQueryData(v,{...E,accounts:l.updatedAccounts})}},onError:(l,c,p)=>{const{budgetId:h,year:m,month:_}=c;p?.previousMonth&&t.setQueryData(se.month(h,m,_),p.previousMonth),p?.previousBudget&&t.setQueryData(se.budget(h),p.previousBudget)}});return{addIncome:n,updateIncome:s,deleteIncome:o}}function yj(){const t=Fi(),e=Tn(yn),n=Ct({mutationFn:async l=>{const{budgetId:c,year:p,month:h,amount:m,categoryId:_,accountId:v,date:E,payee:w,description:A}=l,R=se.month(c,p,h),O=t.getQueryData(R);if(!O)throw new Error("Month data not found");const F={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:m,category_id:_,account_id:v,date:E,created_at:new Date().toISOString()};w?.trim()&&(F.payee=w.trim()),A&&(F.description=A);const q=[...O.month.expenses||[],F],B={...O.month,expenses:q,total_expenses:q.reduce((C,T)=>C+T.amount,0),updated_at:new Date().toISOString()};await ki(e,c,B,t);const $=await ti(e,c,v,-m),Y=t.getQueryData(se.payees(c))||[];let X=null;return w?.trim()&&(X=await Sh(e,c,w,Y)),{updatedMonth:B,newExpense:F,updatedAccounts:$,updatedPayees:X}},onMutate:async l=>{const{budgetId:c,year:p,month:h,amount:m,categoryId:_,accountId:v,date:E,payee:w,description:A}=l,R=se.month(c,p,h),O=se.budget(c);await t.cancelQueries({queryKey:R}),await t.cancelQueries({queryKey:O});const F=t.getQueryData(R),q=t.getQueryData(O);if(F){const B={id:`expense_optimistic_${Date.now()}`,amount:m,category_id:_,account_id:v,date:E,created_at:new Date().toISOString()};w?.trim()&&(B.payee=w.trim()),A&&(B.description=A);const $=[...F.month.expenses||[],B];t.setQueryData(R,{...F,month:{...F.month,expenses:$,total_expenses:$.reduce((Y,X)=>Y+X.amount,0)}})}return q&&q.accounts[v]&&t.setQueryData(O,{...q,accounts:{...q.accounts,[v]:{...q.accounts[v],balance:q.accounts[v].balance-m}}}),Mi(t,c,p,h),{previousMonth:F,previousBudget:q}},onSuccess:(l,c)=>{const{budgetId:p,year:h,month:m}=c,_=se.month(p,h,m),v=se.budget(p),E=se.payees(p);if(t.setQueryData(_,{month:l.updatedMonth}),l.updatedAccounts){const w=t.getQueryData(v);w&&t.setQueryData(v,{...w,accounts:l.updatedAccounts})}l.updatedPayees&&t.setQueryData(E,l.updatedPayees)},onError:(l,c,p)=>{const{budgetId:h,year:m,month:_}=c;p?.previousMonth&&t.setQueryData(se.month(h,m,_),p.previousMonth),p?.previousBudget&&t.setQueryData(se.budget(h),p.previousBudget)}}),s=Ct({mutationFn:async l=>{const{budgetId:c,year:p,month:h,expenseId:m,amount:_,categoryId:v,accountId:E,date:w,payee:A,description:R,oldAmount:O,oldAccountId:F}=l,q=se.month(c,p,h),B=t.getQueryData(q);if(!B)throw new Error("Month data not found");const $={id:m,amount:_,category_id:v,account_id:E,date:w,created_at:B.month.expenses?.find(k=>k.id===m)?.created_at||new Date().toISOString()};A?.trim()&&($.payee=A.trim()),R&&($.description=R);const Y=(B.month.expenses||[]).map(k=>k.id===m?$:k),X={...B.month,expenses:Y,total_expenses:Y.reduce((k,D)=>k+D.amount,0),updated_at:new Date().toISOString()};await ki(e,c,X,t);let C=null;E!==F?(await ti(e,c,F,O),C=await ti(e,c,E,-_)):_!==O&&(C=await ti(e,c,E,O-_));const T=t.getQueryData(se.payees(c))||[];let I=null;return A?.trim()&&(I=await Sh(e,c,A,T)),{updatedMonth:X,updatedAccounts:C,updatedPayees:I}},onMutate:async l=>{const{budgetId:c,year:p,month:h,expenseId:m,amount:_,categoryId:v,accountId:E,date:w,payee:A,description:R,oldAmount:O,oldAccountId:F}=l,q=se.month(c,p,h),B=se.budget(c);await t.cancelQueries({queryKey:q}),await t.cancelQueries({queryKey:B});const $=t.getQueryData(q),Y=t.getQueryData(B);if($){const X={id:m,amount:_,category_id:v,account_id:E,date:w,created_at:$.month.expenses?.find(T=>T.id===m)?.created_at||new Date().toISOString()};A?.trim()&&(X.payee=A.trim()),R&&(X.description=R);const C=($.month.expenses||[]).map(T=>T.id===m?X:T);t.setQueryData(q,{...$,month:{...$.month,expenses:C,total_expenses:C.reduce((T,I)=>T+I.amount,0)}})}if(Y){const X={...Y.accounts};E!==F?(X[F]&&(X[F]={...X[F],balance:X[F].balance+O}),X[E]&&(X[E]={...X[E],balance:X[E].balance-_})):_!==O&&X[E]&&(X[E]={...X[E],balance:X[E].balance+(O-_)}),t.setQueryData(B,{...Y,accounts:X})}return Mi(t,c,p,h),{previousMonth:$,previousBudget:Y}},onSuccess:(l,c)=>{const{budgetId:p,year:h,month:m}=c,_=se.month(p,h,m),v=se.budget(p),E=se.payees(p);if(t.setQueryData(_,{month:l.updatedMonth}),l.updatedAccounts){const w=t.getQueryData(v);w&&t.setQueryData(v,{...w,accounts:l.updatedAccounts})}l.updatedPayees&&t.setQueryData(E,l.updatedPayees)},onError:(l,c,p)=>{const{budgetId:h,year:m,month:_}=c;p?.previousMonth&&t.setQueryData(se.month(h,m,_),p.previousMonth),p?.previousBudget&&t.setQueryData(se.budget(h),p.previousBudget)}}),o=Ct({mutationFn:async l=>{const{budgetId:c,year:p,month:h,expenseId:m,amount:_,accountId:v}=l,E=se.month(c,p,h),w=t.getQueryData(E);if(!w)throw new Error("Month data not found");const A=(w.month.expenses||[]).filter(F=>F.id!==m),R={...w.month,expenses:A,total_expenses:A.reduce((F,q)=>F+q.amount,0),updated_at:new Date().toISOString()};await ki(e,c,R,t);const O=await ti(e,c,v,_);return{updatedMonth:R,updatedAccounts:O}},onMutate:async l=>{const{budgetId:c,year:p,month:h,expenseId:m,amount:_,accountId:v}=l,E=se.month(c,p,h),w=se.budget(c);await t.cancelQueries({queryKey:E}),await t.cancelQueries({queryKey:w});const A=t.getQueryData(E),R=t.getQueryData(w);if(A){const O=(A.month.expenses||[]).filter(F=>F.id!==m);t.setQueryData(E,{...A,month:{...A.month,expenses:O,total_expenses:O.reduce((F,q)=>F+q.amount,0)}})}return R&&R.accounts[v]&&t.setQueryData(w,{...R,accounts:{...R.accounts,[v]:{...R.accounts[v],balance:R.accounts[v].balance+_}}}),Mi(t,c,p,h),{previousMonth:A,previousBudget:R}},onSuccess:(l,c)=>{const{budgetId:p,year:h,month:m}=c,_=se.month(p,h,m),v=se.budget(p);if(t.setQueryData(_,{month:l.updatedMonth}),l.updatedAccounts){const E=t.getQueryData(v);E&&t.setQueryData(v,{...E,accounts:l.updatedAccounts})}},onError:(l,c,p)=>{const{budgetId:h,year:m,month:_}=c;p?.previousMonth&&t.setQueryData(se.month(h,m,_),p.previousMonth),p?.previousBudget&&t.setQueryData(se.budget(h),p.previousBudget)}});return{addExpense:n,updateExpense:s,deleteExpense:o}}function _j(){const t=Fi(),e=Tn(yn),n=Ct({mutationFn:async l=>{const{budgetId:c,year:p,month:h,allocations:m}=l,_=se.month(c,p,h),v=t.getQueryData(_);if(!v)throw new Error("Month data not found");const E={...v.month,allocations:m,updated_at:new Date().toISOString()};return await ki(e,c,E,t),{updatedMonth:E}},onMutate:async l=>{const{budgetId:c,year:p,month:h,allocations:m}=l,_=se.month(c,p,h);await t.cancelQueries({queryKey:_});const v=t.getQueryData(_);return v&&t.setQueryData(_,{...v,month:{...v.month,allocations:m}}),Mi(t,c,p,h),{previousMonth:v}},onSuccess:(l,c)=>{const{budgetId:p,year:h,month:m}=c;t.setQueryData(se.month(p,h,m),{month:l.updatedMonth})},onError:(l,c,p)=>{p?.previousMonth&&t.setQueryData(se.month(c.budgetId,c.year,c.month),p.previousMonth)}}),s=Ct({mutationFn:async l=>{const{budgetId:c,year:p,month:h,allocations:m}=l,_=se.month(c,p,h),v=t.getQueryData(_);if(!v)throw new Error("Month data not found");const E={...v.month,allocations:m,allocations_finalized:!0,updated_at:new Date().toISOString()};await ki(e,c,E,t);const w=se.budget(c),A=t.getQueryData(w);let R=null;if(A){const O=ly($h(e,"months"),uy("budget_id","==",c)),F=await ef(O),q={};Object.keys(A.categories).forEach(Y=>{q[Y]=0}),F.forEach(Y=>{const X=Y.data();if(X.allocations_finalized&&X.allocations)for(const C of X.allocations)q[C.category_id]=(q[C.category_id]||0)+C.amount}),R={...A.categories},Object.entries(R).forEach(([Y,X])=>{R[Y]={...X,balance:q[Y]??0}});const B=Pe(e,"budgets",c),$=await qe(B);if($.exists()){const Y=$.data();await vt(B,{...Y,categories:R})}}return{updatedMonth:E,updatedCategories:R}},onMutate:async l=>{const{budgetId:c,year:p,month:h,allocations:m}=l,_=se.month(c,p,h);await t.cancelQueries({queryKey:_});const v=t.getQueryData(_);return v&&t.setQueryData(_,{...v,month:{...v.month,allocations:m,allocations_finalized:!0}}),Mi(t,c,p,h),{previousMonth:v}},onSuccess:(l,c)=>{const{budgetId:p,year:h,month:m}=c,_=se.month(p,h,m),v=se.budget(p);if(t.setQueryData(_,{month:l.updatedMonth}),l.updatedCategories){const E=t.getQueryData(v);E&&t.setQueryData(v,{...E,categories:l.updatedCategories})}},onError:(l,c,p)=>{p?.previousMonth&&t.setQueryData(se.month(c.budgetId,c.year,c.month),p.previousMonth)}}),o=Ct({mutationFn:async l=>{const{budgetId:c,year:p,month:h}=l,m=se.month(c,p,h),_=t.getQueryData(m);if(!_)throw new Error("Month data not found");const v={..._.month,allocations_finalized:!1,updated_at:new Date().toISOString()};return await ki(e,c,v,t),{updatedMonth:v}},onMutate:async l=>{const{budgetId:c,year:p,month:h}=l,m=se.month(c,p,h);await t.cancelQueries({queryKey:m});const _=t.getQueryData(m);return _&&t.setQueryData(m,{..._,month:{..._.month,allocations_finalized:!1}}),Mi(t,c,p,h),{previousMonth:_}},onSuccess:(l,c)=>{const{budgetId:p,year:h,month:m}=c;t.setQueryData(se.month(p,h,m),{month:l.updatedMonth})},onError:(l,c,p)=>{p?.previousMonth&&t.setQueryData(se.month(c.budgetId,c.year,c.month),p.previousMonth)}});return{saveAllocations:n,finalizeAllocations:s,unfinalizeAllocations:o}}function vj(){const{addIncome:t,updateIncome:e,deleteIncome:n}=gj(),{addExpense:s,updateExpense:o,deleteExpense:l}=yj(),{saveAllocations:c,finalizeAllocations:p,unfinalizeAllocations:h}=_j();return{addIncome:t,updateIncome:e,deleteIncome:n,addExpense:s,updateExpense:o,deleteExpense:l,saveAllocations:c,finalizeAllocations:p,unfinalizeAllocations:h}}function bj(){const t=Fi(),e=Tn(yn),n=Ct({mutationFn:async({name:h,userId:m,userEmail:_})=>{const v=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,E=new Date().toISOString(),w=Pe(e,"budgets",v),A={name:h.trim()||"My Budget",user_ids:[m],accepted_user_ids:[m],owner_id:m,owner_email:_,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:E,updated_at:E};await vt(w,A);const R=Pe(e,"users",m),O=await qe(R);if(O.exists()){const F=O.data();await vt(R,{...F,budget_ids:[v,...F.budget_ids],updated_at:E})}else await vt(R,{uid:m,email:_,budget_ids:[v],created_at:E,updated_at:E});return{budgetId:v,budget:{id:v,...A}}},onSuccess:(h,{userId:m})=>{t.invalidateQueries({queryKey:se.user(m)}),t.invalidateQueries({queryKey:se.accessibleBudgets(m)})}}),s=Ct({mutationFn:async({budgetId:h,userId:m})=>{const _=new Date().toISOString(),v=Pe(e,"budgets",h),E=await qe(v);if(!E.exists())throw new Error("Budget not found");const w=E.data();if(!w.user_ids?.includes(m))throw new Error("You have not been invited to this budget");const A=Pe(e,"users",m),R=await qe(A),O=R.exists()?R.data():null;if(O?.budget_ids?.includes(h))throw new Error("You have already accepted this invite");return await vt(A,{...O||{uid:m,email:null},budget_ids:[h,...O?.budget_ids||[]],updated_at:_}),await vt(v,{...w,accepted_user_ids:[...w.accepted_user_ids||[],m]}),{budgetId:h}},onSuccess:(h,{userId:m})=>{t.invalidateQueries({queryKey:se.user(m)}),t.invalidateQueries({queryKey:se.accessibleBudgets(m)}),t.invalidateQueries({queryKey:se.budget(h.budgetId)})}}),o=Ct({mutationFn:async({budgetId:h,userId:m})=>{const _=Pe(e,"budgets",h),v=await qe(_);if(!v.exists())throw new Error("Budget not found");const E=v.data();if(E.user_ids?.includes(m))throw new Error("User is already invited");return await vt(_,{...E,user_ids:[...E.user_ids||[],m]}),{budgetId:h}},onMutate:async({budgetId:h,userId:m})=>{await t.cancelQueries({queryKey:se.budget(h)});const _=t.getQueryData(se.budget(h));return _&&t.setQueryData(se.budget(h),{..._,budget:{..._.budget,user_ids:[..._.budget.user_ids,m]}}),{previousData:_}},onError:(h,{budgetId:m},_)=>{_?.previousData&&t.setQueryData(se.budget(m),_.previousData)},onSettled:(h,m,{budgetId:_})=>{t.invalidateQueries({queryKey:se.budget(_)})}}),l=Ct({mutationFn:async({budgetId:h,userId:m})=>{const _=Pe(e,"budgets",h),v=await qe(_);if(!v.exists())throw new Error("Budget not found");const E=v.data();return await vt(_,{...E,user_ids:(E.user_ids||[]).filter(w=>w!==m),accepted_user_ids:(E.accepted_user_ids||[]).filter(w=>w!==m)}),{budgetId:h}},onMutate:async({budgetId:h,userId:m})=>{await t.cancelQueries({queryKey:se.budget(h)});const _=t.getQueryData(se.budget(h));return _&&t.setQueryData(se.budget(h),{..._,budget:{..._.budget,user_ids:_.budget.user_ids.filter(v=>v!==m),accepted_user_ids:_.budget.accepted_user_ids.filter(v=>v!==m)}}),{previousData:_}},onError:(h,{budgetId:m},_)=>{_?.previousData&&t.setQueryData(se.budget(m),_.previousData)},onSettled:(h,m,{budgetId:_})=>{t.invalidateQueries({queryKey:se.budget(_)})}}),c=Ct({mutationFn:async({budgetId:h,userId:m})=>{const _=Pe(e,"users",m),v=await qe(_);if(!v.exists())throw new Error("User document not found");const E=v.data(),w=[h,...E.budget_ids.filter(A=>A!==h)];return await vt(_,{...E,budget_ids:w,updated_at:new Date().toISOString()}),{budgetId:h}},onMutate:async({budgetId:h,userId:m})=>{await t.cancelQueries({queryKey:se.user(m)});const _=t.getQueryData(se.user(m));return _&&t.setQueryData(se.user(m),{..._,budget_ids:[h,..._.budget_ids.filter(v=>v!==h)]}),{previousData:_}},onError:(h,{userId:m},_)=>{_?.previousData&&t.setQueryData(se.user(m),_.previousData)},onSettled:(h,m,{userId:_})=>{t.invalidateQueries({queryKey:se.user(_)})}}),p=Ct({mutationFn:async({budgetId:h,userId:m,userBudgetIds:_})=>{const v=Pe(e,"budgets",h),E=await qe(v);if(!E.exists())return null;const w=E.data();return!w.user_ids?.includes(m)||_.includes(h)?null:{budgetId:E.id,budgetName:w.name,ownerEmail:w.owner_email||null}}});return{createBudget:n,acceptInvite:s,inviteUser:o,revokeUser:l,switchBudget:c,checkInvite:p}}function Iw(){const t=Fi(),e=Tn(yn),n=Ct({mutationFn:async({userId:l,userEmail:c,text:p,feedbackType:h,currentPath:m})=>{const v=Pe(e,"feedback",c||l),E={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`[${h.toUpperCase()}] ${p}

(Submitted from: ${m})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:h};return(await qe(v)).exists()?await vt(v,{items:zO(E),user_email:c,updated_at:new Date().toISOString()},{merge:!0}):await vt(v,{items:[E],user_email:c,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),{feedbackItem:E}},onSuccess:()=>{t.invalidateQueries({queryKey:se.feedback()})}}),s=Ct({mutationFn:async({item:l})=>{const c=Pe(e,"feedback",l.doc_id),p=await qe(c);if(!p.exists())throw new Error("Feedback document not found");const h=p.data(),_=(h.items||[]).map(v=>v.id===l.id?{...v,is_done:!v.is_done,completed_at:v.is_done?null:new Date().toISOString()}:v);return await vt(c,{...h,items:_,updated_at:new Date().toISOString()}),{itemId:l.id,isDone:!l.is_done}},onSuccess:()=>{t.invalidateQueries({queryKey:se.feedback()})}}),o=Ct({mutationFn:async({docId:l,items:c})=>{const p=Pe(e,"feedback",l),h=await qe(p);if(!h.exists())throw new Error("Feedback document not found");const m=h.data();return await vt(p,{...m,items:c,updated_at:new Date().toISOString()}),{docId:l}},onSuccess:()=>{t.invalidateQueries({queryKey:se.feedback()})}});return{submitFeedback:n,toggleFeedback:s,updateSortOrder:o}}function Ow(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ej=Ow,jw=new Qu("auth","Firebase",Ow());const xh=new Cg("@firebase/auth");function Sj(t,...e){xh.logLevel<=Je.WARN&&xh.warn(`Auth (${il}): ${t}`,...e)}function Zd(t,...e){xh.logLevel<=Je.ERROR&&xh.error(`Auth (${il}): ${t}`,...e)}function Or(t,...e){throw hy(t,...e)}function oi(t,...e){return hy(t,...e)}function Mw(t,e,n){const s={...Ej(),[e]:n};return new Qu("auth","Firebase",s).create(e,{appName:t.name})}function Ps(t){return Mw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hy(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return jw.create(t,...e)}function Me(t,e,...n){if(!t)throw hy(e,...n)}function Di(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Zd(e),new Error(e)}function zi(t,e){t||Di(e)}function lg(){return typeof self<"u"&&self.location?.href||""}function xj(){return OE()==="http:"||OE()==="https:"}function OE(){return typeof self<"u"&&self.location?.protocol||null}function wj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xj()||sD()||"connection"in navigator)?navigator.onLine:!0}function Tj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class nc{constructor(e,n){this.shortDelay=e,this.longDelay=n,zi(n>e,"Short delay should be less than long delay!"),this.isMobile=nD()||aD()}get(){return wj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function fy(t,e){zi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class kw{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Aj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Cj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Rj=new nc(3e4,6e4);function Va(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Ks(t,e,n,s,o={}){return Nw(t,o,async()=>{let l={},c={};s&&(e==="GET"?c=s:l={body:JSON.stringify(s)});const p=Ku({key:t.config.apiKey,...c}).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const m={method:e,headers:h,...l};return iD()||(m.referrerPolicy="no-referrer"),t.emulatorConfig&&rl(t.emulatorConfig.host)&&(m.credentials="include"),kw.fetch()(await Pw(t,t.config.apiHost,n,p),m)})}async function Nw(t,e,n){t._canInitEmulator=!1;const s={...Aj,...e};try{const o=new Ij(t),l=await Promise.race([n(),o.promise]);o.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Hd(t,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const p=l.ok?c.errorMessage:c.error.message,[h,m]=p.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Hd(t,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw Hd(t,"email-already-in-use",c);if(h==="USER_DISABLED")throw Hd(t,"user-disabled",c);const _=s[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw Mw(t,_,m);Or(t,_)}}catch(o){if(o instanceof qi)throw o;Or(t,"network-request-failed",{message:String(o)})}}async function tf(t,e,n,s,o={}){const l=await Ks(t,e,n,s,o);return"mfaPendingCredential"in l&&Or(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function Pw(t,e,n,s){const o=`${e}${n}?${s}`,l=t,c=l.config.emulator?fy(t.config,o):`${t.config.apiScheme}://${o}`;return Cj.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function Dj(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ij{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(oi(this.auth,"network-request-failed")),Rj.get())})}}function Hd(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const o=oi(t,e,s);return o.customData._tokenResponse=n,o}function jE(t){return t!==void 0&&t.enterprise!==void 0}class Oj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Dj(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function jj(t,e){return Ks(t,"GET","/v2/recaptchaConfig",Va(t,e))}async function Mj(t,e){return Ks(t,"POST","/v1/accounts:delete",e)}async function wh(t,e){return Ks(t,"POST","/v1/accounts:lookup",e)}function ju(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function kj(t,e=!1){const n=on(t),s=await n.getIdToken(e),o=my(s);Me(o&&o.exp&&o.auth_time&&o.iat,n.auth,"internal-error");const l=typeof o.firebase=="object"?o.firebase:void 0,c=l?.sign_in_provider;return{claims:o,token:s,authTime:ju(Ap(o.auth_time)),issuedAtTime:ju(Ap(o.iat)),expirationTime:ju(Ap(o.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Ap(t){return Number(t)*1e3}function my(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return Zd("JWT malformed, contained fewer than 3 sections"),null;try{const o=LS(n);return o?JSON.parse(o):(Zd("Failed to decode base64 JWT payload"),null)}catch(o){return Zd("Caught error parsing JWT payload as JSON",o?.toString()),null}}function ME(t){const e=my(t);return Me(e,"internal-error"),Me(typeof e.exp<"u","internal-error"),Me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Bu(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof qi&&Nj(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function Nj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class Pj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class ug{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ju(this.lastLoginAt),this.creationTime=ju(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Th(t){const e=t.auth,n=await t.getIdToken(),s=await Bu(t,wh(e,{idToken:n}));Me(s?.users.length,e,"internal-error");const o=s.users[0];t._notifyReloadListener(o);const l=o.providerUserInfo?.length?Vw(o.providerUserInfo):[],c=Lj(t.providerData,l),p=t.isAnonymous,h=!(t.email&&o.passwordHash)&&!c?.length,m=p?h:!1,_={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new ug(o.createdAt,o.lastLoginAt),isAnonymous:m};Object.assign(t,_)}async function Vj(t){const e=on(t);await Th(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Lj(t,e){return[...t.filter(s=>!e.some(o=>o.providerId===s.providerId)),...e]}function Vw(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function Uj(t,e){const n=await Nw(t,{},async()=>{const s=Ku({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:l}=t.config,c=await Pw(t,o,"/v1/token",`key=${l}`),p=await t._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:p,body:s};return t.emulatorConfig&&rl(t.emulatorConfig.host)&&(h.credentials="include"),kw.fetch()(c,h)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function zj(t,e){return Ks(t,"POST","/v2/accounts:revokeToken",Va(t,e))}class Uo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Me(e.idToken,"internal-error"),Me(typeof e.idToken<"u","internal-error"),Me(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ME(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Me(e.length!==0,"internal-error");const n=ME(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:o,expiresIn:l}=await Uj(e,n);this.updateTokensAndExpiration(s,o,Number(l))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:o,expirationTime:l}=n,c=new Uo;return s&&(Me(typeof s=="string","internal-error",{appName:e}),c.refreshToken=s),o&&(Me(typeof o=="string","internal-error",{appName:e}),c.accessToken=o),l&&(Me(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Uo,this.toJSON())}_performRefresh(){return Di("not implemented")}}function xs(t,e){Me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Dr{constructor({uid:e,auth:n,stsTokenManager:s,...o}){this.providerId="firebase",this.proactiveRefresh=new Pj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new ug(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await Bu(this,this.stsTokenManager.getToken(this.auth,e));return Me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return kj(this,e)}reload(){return Vj(this)}_assign(e){this!==e&&(Me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Dr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Th(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rr(this.auth.app))return Promise.reject(Ps(this.auth));const e=await this.getIdToken();return await Bu(this,Mj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,o=n.email??void 0,l=n.phoneNumber??void 0,c=n.photoURL??void 0,p=n.tenantId??void 0,h=n._redirectEventId??void 0,m=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:v,emailVerified:E,isAnonymous:w,providerData:A,stsTokenManager:R}=n;Me(v&&R,e,"internal-error");const O=Uo.fromJSON(this.name,R);Me(typeof v=="string",e,"internal-error"),xs(s,e.name),xs(o,e.name),Me(typeof E=="boolean",e,"internal-error"),Me(typeof w=="boolean",e,"internal-error"),xs(l,e.name),xs(c,e.name),xs(p,e.name),xs(h,e.name),xs(m,e.name),xs(_,e.name);const F=new Dr({uid:v,auth:e,email:o,emailVerified:E,displayName:s,isAnonymous:w,photoURL:c,phoneNumber:l,tenantId:p,stsTokenManager:O,createdAt:m,lastLoginAt:_});return A&&Array.isArray(A)&&(F.providerData=A.map(q=>({...q}))),h&&(F._redirectEventId=h),F}static async _fromIdTokenResponse(e,n,s=!1){const o=new Uo;o.updateFromServerResponse(n);const l=new Dr({uid:n.localId,auth:e,stsTokenManager:o,isAnonymous:s});return await Th(l),l}static async _fromGetAccountInfoResponse(e,n,s){const o=n.users[0];Me(o.localId!==void 0,"internal-error");const l=o.providerUserInfo!==void 0?Vw(o.providerUserInfo):[],c=!(o.email&&o.passwordHash)&&!l?.length,p=new Uo;p.updateFromIdToken(s);const h=new Dr({uid:o.localId,auth:e,stsTokenManager:p,isAnonymous:c}),m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new ug(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!l?.length};return Object.assign(h,m),h}}const kE=new Map;function Ii(t){zi(t instanceof Function,"Expected a class definition");let e=kE.get(t);return e?(zi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,kE.set(t,e),e)}class Lw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Lw.type="NONE";const NE=Lw;function eh(t,e,n){return`firebase:${t}:${e}:${n}`}class zo{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:o,name:l}=this.auth;this.fullUserKey=eh(this.userKey,o.apiKey,l),this.fullPersistenceKey=eh("persistence",o.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await wh(this.auth,{idToken:e}).catch(()=>{});return n?Dr._fromGetAccountInfoResponse(this.auth,n,e):null}return Dr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new zo(Ii(NE),e,s);const o=(await Promise.all(n.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=o[0]||Ii(NE);const c=eh(s,e.config.apiKey,e.name);let p=null;for(const m of n)try{const _=await m._get(c);if(_){let v;if(typeof _=="string"){const E=await wh(e,{idToken:_}).catch(()=>{});if(!E)break;v=await Dr._fromGetAccountInfoResponse(e,E,_)}else v=Dr._fromJSON(e,_);m!==l&&(p=v),l=m;break}}catch{}const h=o.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!h.length?new zo(l,e,s):(l=h[0],p&&await l._set(c,p.toJSON()),await Promise.all(n.map(async m=>{if(m!==l)try{await m._remove(c)}catch{}})),new zo(l,e,s))}}function PE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Fw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Uw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Hw(e))return"Blackberry";if(Gw(e))return"Webos";if(zw(e))return"Safari";if((e.includes("chrome/")||Bw(e))&&!e.includes("edge/"))return"Chrome";if(qw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if(s?.length===2)return s[1]}return"Other"}function Uw(t=wn()){return/firefox\//i.test(t)}function zw(t=wn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Bw(t=wn()){return/crios\//i.test(t)}function Fw(t=wn()){return/iemobile/i.test(t)}function qw(t=wn()){return/android/i.test(t)}function Hw(t=wn()){return/blackberry/i.test(t)}function Gw(t=wn()){return/webos/i.test(t)}function py(t=wn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Bj(t=wn()){return py(t)&&!!window.navigator?.standalone}function Fj(){return oD()&&document.documentMode===10}function Qw(t=wn()){return py(t)||qw(t)||Gw(t)||Hw(t)||/windows phone/i.test(t)||Fw(t)}function Kw(t,e=[]){let n;switch(t){case"Browser":n=PE(wn());break;case"Worker":n=`${PE(wn())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${il}/${s}`}class qj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=l=>new Promise((c,p)=>{try{const h=e(l);c(h)}catch(h){p(h)}});s.onAbort=n,this.queue.push(s);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const o of n)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function Hj(t,e={}){return Ks(t,"GET","/v2/passwordPolicy",Va(t,e))}const Gj=6;class Qj{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Gj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),o&&(n.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let o=0;o<e.length;o++)s=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,o,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class Kj{constructor(e,n,s,o){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new VE(this),this.idTokenSubscription=new VE(this),this.beforeStateQueue=new qj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ii(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await zo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await wh(this,{idToken:e}),s=await Dr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Rr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,c=s?._redirectEventId,p=await this.tryRedirectSignIn(e);(!l||l===c)&&p?.user&&(s=p.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Th(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Tj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rr(this.app))return Promise.reject(Ps(this));const n=e?on(e):null;return n&&Me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rr(this.app)?Promise.reject(Ps(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rr(this.app)?Promise.reject(Ps(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ii(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Hj(this),n=new Qj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qu("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await zj(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ii(e)||this._popupRedirectResolver;Me(n,this,"argument-error"),this.redirectPersistenceManager=await zo.create(this,[Ii(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,o){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let c=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(p,this,"internal-error"),p.then(()=>{c||l(this.currentUser)}),typeof n=="function"){const h=e.addObserver(n,s,o);return()=>{c=!0,h()}}else{const h=e.addObserver(n);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Kw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(Rr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Sj(`Error while retrieving App Check token: ${e.error}`),e?.token}}function dl(t){return on(t)}class VE{constructor(e){this.auth=e,this.observer=null,this.addObserver=pD(n=>this.observer=n)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let nf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $j(t){nf=t}function $w(t){return nf.loadJS(t)}function Yj(){return nf.recaptchaEnterpriseScript}function Wj(){return nf.gapiScript}function Xj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Jj{constructor(){this.enterprise=new Zj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Zj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const eM="recaptcha-enterprise",Yw="NO_RECAPTCHA";class tM{constructor(e){this.type=eM,this.auth=dl(e)}async verify(e="verify",n=!1){async function s(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,p)=>{jj(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const m=new Oj(h);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,c(m.siteKey)}}).catch(h=>{p(h)})})}function o(l,c,p){const h=window.grecaptcha;jE(h)?h.enterprise.ready(()=>{h.enterprise.execute(l,{action:e}).then(m=>{c(m)}).catch(()=>{c(Yw)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Jj().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{s(this.auth).then(p=>{if(!n&&jE(window.grecaptcha))o(p,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let h=Yj();h.length!==0&&(h+=p),$w(h).then(()=>{o(p,l,c)}).catch(m=>{c(m)})}}).catch(p=>{c(p)})})}}async function LE(t,e,n,s=!1,o=!1){const l=new tM(t);let c;if(o)c=Yw;else try{c=await l.verify(n)}catch{c=await l.verify(n,!0)}const p={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const h=p.phoneEnrollmentInfo.phoneNumber,m=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const h=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return s?Object.assign(p,{captchaResp:c}):Object.assign(p,{captchaResponse:c}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function UE(t,e,n,s,o){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await LE(t,e,n,n==="getOobCode");return s(t,l)}else return s(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await LE(t,e,n,n==="getOobCode");return s(t,c)}else return Promise.reject(l)})}function nM(t,e){const n=Dg(t,"auth");if(n.isInitialized()){const o=n.getImmediate(),l=n.getOptions();if(Vs(l,e??{}))return o;Or(o,"already-initialized")}return n.initialize({options:e})}function rM(t,e){const n=e?.persistence||[],s=(Array.isArray(n)?n:[n]).map(Ii);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e?.popupRedirectResolver)}function iM(t,e,n){const s=dl(t);Me(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const o=!1,l=Ww(e),{host:c,port:p}=sM(e),h=p===null?"":`:${p}`,m={url:`${l}//${c}${h}/`},_=Object.freeze({host:c,port:p,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!s._canInitEmulator){Me(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Me(Vs(m,s.config.emulator)&&Vs(_,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=m,s.emulatorConfig=_,s.settings.appVerificationDisabledForTesting=!0,rl(c)?(FS(`${l}//${c}${h}`),qS("Auth",!0)):aM()}function Ww(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function sM(t){const e=Ww(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(s);if(o){const l=o[1];return{host:l,port:zE(s.substr(l.length+1))}}else{const[l,c]=s.split(":");return{host:l,port:zE(c)}}}function zE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function aM(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class gy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Di("not implemented")}_getIdTokenResponse(e){return Di("not implemented")}_linkToIdToken(e,n){return Di("not implemented")}_getReauthenticationResolver(e){return Di("not implemented")}}async function oM(t,e){return Ks(t,"POST","/v1/accounts:signUp",e)}async function lM(t,e){return tf(t,"POST","/v1/accounts:signInWithPassword",Va(t,e))}async function uM(t,e){return tf(t,"POST","/v1/accounts:signInWithEmailLink",Va(t,e))}async function cM(t,e){return tf(t,"POST","/v1/accounts:signInWithEmailLink",Va(t,e))}class Fu extends gy{constructor(e,n,s,o=null){super("password",s),this._email=e,this._password=n,this._tenantId=o}static _fromEmailAndPassword(e,n){return new Fu(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new Fu(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return UE(e,n,"signInWithPassword",lM);case"emailLink":return uM(e,{email:this._email,oobCode:this._password});default:Or(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return UE(e,s,"signUpPassword",oM);case"emailLink":return cM(e,{idToken:n,email:this._email,oobCode:this._password});default:Or(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Bo(t,e){return tf(t,"POST","/v1/accounts:signInWithIdp",Va(t,e))}const dM="http://localhost";class Ma extends gy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ma(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Or("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:o,...l}=n;if(!s||!o)return null;const c=new Ma(s,o);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const n=this.buildRequest();return Bo(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,Bo(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Bo(e,n)}buildRequest(){const e={requestUri:dM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ku(n)}return e}}function hM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function fM(t){const e=Eu(Su(t)).link,n=e?Eu(Su(e)).deep_link_id:null,s=Eu(Su(t)).deep_link_id;return(s?Eu(Su(s)).link:null)||s||n||e||t}class yy{constructor(e){const n=Eu(Su(e)),s=n.apiKey??null,o=n.oobCode??null,l=hM(n.mode??null);Me(s&&o&&l,"argument-error"),this.apiKey=s,this.operation=l,this.code=o,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=fM(e);try{return new yy(n)}catch{return null}}}class hl{constructor(){this.providerId=hl.PROVIDER_ID}static credential(e,n){return Fu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=yy.parseLink(n);return Me(s,"argument-error"),Fu._fromEmailAndCode(e,s.code,s.tenantId)}}hl.PROVIDER_ID="password";hl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";hl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Xw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class rc extends Xw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ws extends rc{constructor(){super("facebook.com")}static credential(e){return Ma._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ws.credential(e.oauthAccessToken)}catch{return null}}}ws.FACEBOOK_SIGN_IN_METHOD="facebook.com";ws.PROVIDER_ID="facebook.com";class Ts extends rc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ma._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Ts.credential(n,s)}catch{return null}}}Ts.GOOGLE_SIGN_IN_METHOD="google.com";Ts.PROVIDER_ID="google.com";class As extends rc{constructor(){super("github.com")}static credential(e){return Ma._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return As.credential(e.oauthAccessToken)}catch{return null}}}As.GITHUB_SIGN_IN_METHOD="github.com";As.PROVIDER_ID="github.com";class Cs extends rc{constructor(){super("twitter.com")}static credential(e,n){return Ma._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Cs.credential(n,s)}catch{return null}}}Cs.TWITTER_SIGN_IN_METHOD="twitter.com";Cs.PROVIDER_ID="twitter.com";class Wo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,o=!1){const l=await Dr._fromIdTokenResponse(e,s,o),c=BE(s);return new Wo({user:l,providerId:c,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const o=BE(s);return new Wo({user:e,providerId:o,_tokenResponse:s,operationType:n})}}function BE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Ah extends qi{constructor(e,n,s,o){super(n.code,n.message),this.operationType=s,this.user=o,Object.setPrototypeOf(this,Ah.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,o){return new Ah(e,n,s,o)}}function Jw(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Ah._fromErrorAndOperation(t,l,e,s):l})}async function mM(t,e,n=!1){const s=await Bu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Wo._forOperation(t,"link",s)}async function pM(t,e,n=!1){const{auth:s}=t;if(Rr(s.app))return Promise.reject(Ps(s));const o="reauthenticate";try{const l=await Bu(t,Jw(s,o,e,t),n);Me(l.idToken,s,"internal-error");const c=my(l.idToken);Me(c,s,"internal-error");const{sub:p}=c;return Me(t.uid===p,s,"user-mismatch"),Wo._forOperation(t,o,l)}catch(l){throw l?.code==="auth/user-not-found"&&Or(s,"user-mismatch"),l}}async function Zw(t,e,n=!1){if(Rr(t.app))return Promise.reject(Ps(t));const s="signIn",o=await Jw(t,s,e),l=await Wo._fromIdTokenResponse(t,s,o);return n||await t._updateCurrentUser(l.user),l}async function gM(t,e){return Zw(dl(t),e)}async function yM(t){const e=dl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function _M(t,e,n){return Rr(t.app)?Promise.reject(Ps(t)):gM(on(t),hl.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&yM(t),s})}function vM(t,e,n,s){return on(t).onIdTokenChanged(e,n,s)}function bM(t,e,n){return on(t).beforeAuthStateChanged(e,n)}function EM(t,e,n,s){return on(t).onAuthStateChanged(e,n,s)}function SM(t){return on(t).signOut()}const Ch="__sak";class eT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ch,"1"),this.storage.removeItem(Ch),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const xM=1e3,wM=10;class tT extends eT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Qw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),o=this.localCache[n];s!==o&&e(n,o,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((c,p,h)=>{this.notifyListeners(c,h)});return}const s=e.key;n?this.detachListener():this.stopPolling();const o=()=>{const c=this.storage.getItem(s);!n&&this.localCache[s]===c||this.notifyListeners(s,c)},l=this.storage.getItem(s);Fj()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,wM):o()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},xM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}tT.type="LOCAL";const TM=tT;class nT extends eT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}nT.type="SESSION";const rT=nT;function AM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class rf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(o=>o.isListeningto(e));if(n)return n;const s=new rf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:o,data:l}=n.data,c=this.handlersMap[o];if(!c?.size)return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const p=Array.from(c).map(async m=>m(n.origin,l)),h=await AM(p);n.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:h})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}rf.receivers=[];function _y(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}class CM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let l,c;return new Promise((p,h)=>{const m=_y("",20);o.port1.start();const _=setTimeout(()=>{h(new Error("unsupported_event"))},s);c={messageChannel:o,onMessage(v){const E=v;if(E.data.eventId===m)switch(E.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),p(E.data.response);break;default:clearTimeout(_),clearTimeout(l),h(new Error("invalid_response"));break}}},this.handlers.add(c),o.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:n},[o.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function li(){return window}function RM(t){li().location.href=t}function iT(){return typeof li().WorkerGlobalScope<"u"&&typeof li().importScripts=="function"}async function DM(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function IM(){return navigator?.serviceWorker?.controller||null}function OM(){return iT()?self:null}const sT="firebaseLocalStorageDb",jM=1,Rh="firebaseLocalStorage",aT="fbase_key";class ic{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function sf(t,e){return t.transaction([Rh],e?"readwrite":"readonly").objectStore(Rh)}function MM(){const t=indexedDB.deleteDatabase(sT);return new ic(t).toPromise()}function cg(){const t=indexedDB.open(sT,jM);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(Rh,{keyPath:aT})}catch(o){n(o)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(Rh)?e(s):(s.close(),await MM(),e(await cg()))})})}async function FE(t,e,n){const s=sf(t,!0).put({[aT]:e,value:n});return new ic(s).toPromise()}async function kM(t,e){const n=sf(t,!1).get(e),s=await new ic(n).toPromise();return s===void 0?null:s.value}function qE(t,e){const n=sf(t,!0).delete(e);return new ic(n).toPromise()}const NM=800,PM=3;class oT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await cg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>PM)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return iT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=rf._getInstance(OM()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await DM(),!this.activeServiceWorker)return;this.sender=new CM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||IM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await cg();return await FE(e,Ch,"1"),await qE(e,Ch),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>FE(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>kM(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>qE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const l=sf(o,!1).getAll();return new ic(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:o,value:l}of e)s.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(l)&&(this.notifyListeners(o,l),n.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!s.has(o)&&(this.notifyListeners(o,null),n.push(o));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),NM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}oT.type="LOCAL";const VM=oT;new nc(3e4,6e4);function LM(t,e){return e?Ii(e):(Me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class vy extends gy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Bo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Bo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function UM(t){return Zw(t.auth,new vy(t),t.bypassAuthState)}function zM(t){const{auth:e,user:n}=t;return Me(n,e,"internal-error"),pM(n,new vy(t),t.bypassAuthState)}async function BM(t){const{auth:e,user:n}=t;return Me(n,e,"internal-error"),mM(n,new vy(t),t.bypassAuthState)}class lT{constructor(e,n,s,o,l=!1){this.auth=e,this.resolver=s,this.user=o,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:o,tenantId:l,error:c,type:p}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:n,sessionId:s,tenantId:l||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return UM;case"linkViaPopup":case"linkViaRedirect":return BM;case"reauthViaPopup":case"reauthViaRedirect":return zM;default:Or(this.auth,"internal-error")}}resolve(e){zi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const FM=new nc(2e3,1e4);class Po extends lT{constructor(e,n,s,o,l){super(e,n,o,l),this.provider=s,this.authWindow=null,this.pollId=null,Po.currentPopupAction&&Po.currentPopupAction.cancel(),Po.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Me(e,this.auth,"internal-error"),e}async onExecution(){zi(this.filter.length===1,"Popup operations only handle one event");const e=_y();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(oi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(oi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Po.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(oi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,FM.get())};e()}}Po.currentPopupAction=null;const qM="pendingRedirect",th=new Map;class HM extends lT{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=th.get(this.auth._key());if(!e){try{const s=await GM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}th.set(this.auth._key(),e)}return this.bypassAuthState||th.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function GM(t,e){const n=$M(e),s=KM(t);if(!await s._isAvailable())return!1;const o=await s._get(n)==="true";return await s._remove(n),o}function QM(t,e){th.set(t._key(),e)}function KM(t){return Ii(t._redirectPersistence)}function $M(t){return eh(qM,t.config.apiKey,t.name)}async function YM(t,e,n=!1){if(Rr(t.app))return Promise.reject(Ps(t));const s=dl(t),o=LM(s,e),c=await new HM(s,o,n).execute();return c&&!n&&(delete c.user._redirectEventId,await s._persistUserIfCurrent(c.user),await s._setRedirectUser(null,e)),c}const WM=600*1e3;class XM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!JM(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!uT(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";n.onError(oi(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WM&&this.cachedEventUids.clear(),this.cachedEventUids.has(HE(e))}saveEventToCache(e){this.cachedEventUids.add(HE(e)),this.lastProcessedEventTime=Date.now()}}function HE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function uT({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function JM(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return uT(t);default:return!1}}async function ZM(t,e={}){return Ks(t,"GET","/v1/projects",e)}const ek=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,tk=/^https?/;async function nk(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ZM(t);for(const n of e)try{if(rk(n))return}catch{}Or(t,"unauthorized-domain")}function rk(t){const e=lg(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&c.hostname===s}if(!tk.test(n))return!1;if(ek.test(t))return s===t;const o=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)}const ik=new nc(3e4,6e4);function GE(){const t=li().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function sk(t){return new Promise((e,n)=>{function s(){GE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{GE(),n(oi(t,"network-request-failed"))},timeout:ik.get()})}if(li().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(li().gapi?.load)s();else{const o=Xj("iframefcb");return li()[o]=()=>{gapi.load?s():n(oi(t,"network-request-failed"))},$w(`${Wj()}?onload=${o}`).catch(l=>n(l))}}).catch(e=>{throw nh=null,e})}let nh=null;function ak(t){return nh=nh||sk(t),nh}const ok=new nc(5e3,15e3),lk="__/auth/iframe",uk="emulator/auth/iframe",ck={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function hk(t){const e=t.config;Me(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?fy(e,uk):`https://${t.config.authDomain}/${lk}`,s={apiKey:e.apiKey,appName:t.name,v:il},o=dk.get(t.config.apiHost);o&&(s.eid=o);const l=t._getFrameworks();return l.length&&(s.fw=l.join(",")),`${n}?${Ku(s).slice(1)}`}async function fk(t){const e=await ak(t),n=li().gapi;return Me(n,t,"internal-error"),e.open({where:document.body,url:hk(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ck,dontclear:!0},s=>new Promise(async(o,l)=>{await s.restyle({setHideOnLeave:!1});const c=oi(t,"network-request-failed"),p=li().setTimeout(()=>{l(c)},ok.get());function h(){li().clearTimeout(p),o(s)}s.ping(h).then(h,()=>{l(c)})}))}const mk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},pk=500,gk=600,yk="_blank",_k="http://localhost";class QE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function vk(t,e,n,s=pk,o=gk){const l=Math.max((window.screen.availHeight-o)/2,0).toString(),c=Math.max((window.screen.availWidth-s)/2,0).toString();let p="";const h={...mk,width:s.toString(),height:o.toString(),top:l,left:c},m=wn().toLowerCase();n&&(p=Bw(m)?yk:n),Uw(m)&&(e=e||_k,h.scrollbars="yes");const _=Object.entries(h).reduce((E,[w,A])=>`${E}${w}=${A},`,"");if(Bj(m)&&p!=="_self")return bk(e||"",p),new QE(null);const v=window.open(e||"",p,_);Me(v,t,"popup-blocked");try{v.focus()}catch{}return new QE(v)}function bk(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}const Ek="__/auth/handler",Sk="emulator/auth/handler",xk=encodeURIComponent("fac");async function KE(t,e,n,s,o,l){Me(t.config.authDomain,t,"auth-domain-config-required"),Me(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:il,eventId:o};if(e instanceof Xw){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",mD(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))c[_]=v}if(e instanceof rc){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(c.scopes=_.join(","))}t.tenantId&&(c.tid=t.tenantId);const p=c;for(const _ of Object.keys(p))p[_]===void 0&&delete p[_];const h=await t._getAppCheckToken(),m=h?`#${xk}=${encodeURIComponent(h)}`:"";return`${wk(t)}?${Ku(p).slice(1)}${m}`}function wk({config:t}){return t.emulator?fy(t,Sk):`https://${t.authDomain}/${Ek}`}const Cp="webStorageSupport";class Tk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rT,this._completeRedirectFn=YM,this._overrideRedirectResult=QM}async _openPopup(e,n,s,o){zi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await KE(e,n,s,lg(),o);return vk(e,l,_y())}async _openRedirect(e,n,s,o){await this._originValidation(e);const l=await KE(e,n,s,lg(),o);return RM(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:o,promise:l}=this.eventManagers[n];return o?Promise.resolve(o):(zi(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await fk(e),s=new XM(e);return n.register("authEvent",o=>(Me(o?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Cp,{type:Cp},o=>{const l=o?.[0]?.[Cp];l!==void 0&&n(!!l),Or(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=nk(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Qw()||zw()||py()}}const Ak=Tk;var $E="@firebase/auth",YE="1.12.0";class Ck{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Rk(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Dk(t){Fo(new Ia("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:p}=s.options;Me(c&&!c.includes(":"),"invalid-api-key",{appName:s.name});const h={apiKey:c,authDomain:p,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Kw(t)},m=new Kj(s,o,l,h);return rM(m,n),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),Fo(new Ia("auth-internal",e=>{const n=dl(e.getProvider("auth").getImmediate());return(s=>new Ck(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ms($E,YE,Rk(t)),Ms($E,YE,"esm2020")}const Ik=300,Ok=BS("authIdTokenMaxAge")||Ik;let WE=null;const jk=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>Ok)return;const o=n?.token;WE!==o&&(WE=o,await fetch(t,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function Mk(t=KS()){const e=Dg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=nM(t,{popupRedirectResolver:Ak,persistence:[VM,TM,rT]}),s=BS("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const c=jk(l.toString());bM(n,c,()=>c(n.currentUser)),vM(n,p=>c(p))}}const o=US("auth");return o&&iM(n,`http://${o}`),n}function kk(){return document.getElementsByTagName("head")?.[0]??document}$j({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=o=>{const l=oi("internal-error");l.customData=o,n(l)},s.type="text/javascript",s.charset="UTF-8",kk().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Dk("Browser");function La(){const t=Mk(yn);async function e(){return!1}async function n(p,h){return _M(t,p,h)}function s(){return SM(t)}function o(p){EM(t,h=>{p(h)})}function l(){return t.currentUser}return{set_user_listener:o,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:s,get_current_firebase_user:l}}const Nk={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},cT=j.createContext(Nk);function Pk({children:t}){const n=La().get_current_firebase_user(),[s,o]=j.useState(null),[l,c]=j.useState(new Date().getFullYear()),[p,h]=j.useState(new Date().getMonth()+1),[m,_]=j.useState(!1),[v,E]=j.useState(!1),w=lj(n?.uid||null,n?.email||null),A=cj(n?.uid||null,w.data||null,{enabled:!!n?.uid&&!!w.data}),R=w.data?.permission_flags?.is_admin===!0,O=w.data?.permission_flags?.is_test===!0,F=A.data?.pendingInvites||[],q=A.data?.budgets||[],B=F.length>0;j.useEffect(()=>{if(!n||m||w.isLoading||A.isLoading)return;const D=w.data,V=A.data;!D&&!w.isError||(D&&D.budget_ids.length>0?(o(D.budget_ids[0]),E(!1)):V?.pendingInvites&&V.pendingInvites.length>0?E(!1):E(!0),_(!0))},[n,m,w.data,w.isLoading,w.isError,A.data,A.isLoading]);const $=j.useCallback(()=>{h(D=>D===1?(c(V=>V-1),12):D-1)},[]),Y=j.useCallback(()=>{h(D=>D===12?(c(V=>V+1),1):D+1)},[]),X=j.useCallback(async()=>{await A.refetch()},[A]),C=j.useCallback(D=>{o(D)},[]),T=j.useCallback(async D=>{if(!n)return null;try{const V=Tn(yn),N=Pe(V,"budgets",D),W=await qe(N);if(!W.exists())return null;const z=W.data(),L=z.user_ids?.includes(n.uid),H=z.accepted_user_ids?.includes(n.uid);return L&&!H?{budgetId:D,budgetName:z.name||"Unnamed Budget",ownerEmail:z.owner_email||null}:null}catch(V){return console.error("[BudgetContext] Error checking budget invite:",V),null}},[n]),I=j.useCallback(()=>{Vn.clear(),localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),k={currentUserId:n?.uid||null,selectedBudgetId:s,currentYear:l,currentMonthNumber:p,setSelectedBudgetId:o,setCurrentYear:c,setCurrentMonthNumber:h,isInitialized:m,needsFirstBudget:v,goToPreviousMonth:$,goToNextMonth:Y,pendingInvites:F,hasPendingInvites:B,accessibleBudgets:q,isAdmin:R,isTest:O,loadAccessibleBudgets:X,switchToBudget:C,checkBudgetInvite:T,clearCache:I};return f.jsx(cT.Provider,{value:k,children:t})}function An(){const t=j.useContext(cT);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}function Vk(){return f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("h1",{children:"Welcome"}),f.jsx("nav",{children:f.jsxs("ul",{children:[f.jsx("li",{children:f.jsx(Dt,{to:"/sql-test",children:"SQL Test"})}),f.jsx("li",{children:f.jsx(Dt,{to:"/budget",children:"Budget"})}),f.jsx("li",{children:f.jsx(Dt,{to:"/account",children:"Account"})})]})})]})}function Lk(){return f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("nav",{children:f.jsx(Dt,{to:"/",children:" Back to Home"})}),f.jsx("h1",{children:"SQL Test"}),f.jsx("h2",{children:"Setup"}),f.jsxs("h3",{children:["1. Open up your preferred web browser to ",f.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),f.jsxs("ul",{children:[f.jsx("li",{children:"This is a basic online sql query editor"}),f.jsxs("li",{children:["It will include three tables: ",f.jsx("b",{children:'"Customer"'}),", ",f.jsx("b",{children:'"Orders"'}),", and ",f.jsx("b",{children:'"Shippings"'})]})]}),f.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),f.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:f.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),f.jsx("h2",{children:"SQL Problems"}),f.jsx("p",{children:"Write queries in the online editor to answer these questions."}),f.jsx("h3",{children:"Question #1"}),f.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),f.jsx("h3",{children:"Question #2"}),f.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function Uk(){const t=j.useContext(Gu),e=La(),[n,s]=j.useState(!1),o=pr(),l=yg(),c=o.state?.from||"/";j.useEffect(()=>{t.is_logged_in&&c!=="/"&&l(c,{replace:!0})},[t.is_logged_in,c,l]);function p(){s(!0),e.logout_firebase_user().then(function(){s(!1)})}return f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("h1",{children:"Account"}),t.is_logged_in?n?f.jsx("p",{children:"Logging Out..."}):f.jsxs(f.Fragment,{children:[f.jsxs("p",{children:["You are logged in as ",t.username]}),f.jsx("button",{onClick:p,style:{marginTop:"1rem"},children:"Logout"})]}):f.jsx(zk,{}),f.jsx("p",{children:f.jsx(Dt,{to:"/",children:"Back to Home"})})]})}function zk(){const t=La(),[e,n]=j.useState(""),[s,o]=j.useState(""),[l,c]=j.useState(!1),[p,h]=j.useState("");function m(E){n(E.target.value)}function _(E){o(E.target.value)}function v(E){E.preventDefault(),c(!0),h(""),t.login_firebase_user(e,s).then(function(){}).catch(function(){h("Incorrect login credentials")}).finally(function(){c(!1)})}return f.jsxs("form",{onSubmit:v,children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"username",children:"Email: "}),f.jsx("input",{id:"username",type:"email",value:e,onChange:m})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",children:"Password: "}),f.jsx("input",{id:"password",type:"password",value:s,onChange:_})]}),l?f.jsx("p",{children:"Logging in..."}):f.jsx("button",{children:"Login"}),p&&f.jsx("p",{style:{color:"red"},children:p})]})}const Bk={mobile:640},Fk=Bk.mobile,dT=["January","February","March","April","May","June","July","August","September","October","November","December"],XE="admin_active_tab",qk=["my-budgets","accounts","categories","users","migration","feedback","tests"];function $s(t=Fk){const[e,n]=j.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return j.useEffect(()=>{function s(){n(window.innerWidth<t)}return window.addEventListener("resize",s),s(),()=>window.removeEventListener("resize",s)},[t]),e}function zn(t,e){const n=YO(t),s=pj(),o=bj(),l=n.data,c=l?.budget||null,p=l?.accounts||{},h=l?.accountGroups||{},m=l?.categories||{},_=l?.categoryGroups||[],v=c?.owner_id===e,E=c?.user_ids||[],w=c?.accepted_user_ids||[],A=j.useCallback(async z=>{if(!t)throw new Error("No budget selected");await s.updateAccounts.mutateAsync({budgetId:t,accounts:z})},[t,s.updateAccounts]),R=j.useCallback(async z=>{if(!t)throw new Error("No budget selected");await s.updateAccountGroups.mutateAsync({budgetId:t,accountGroups:z})},[t,s.updateAccountGroups]),O=j.useCallback(async z=>{if(!t)throw new Error("No budget selected");await s.updateCategories.mutateAsync({budgetId:t,categories:z})},[t,s.updateCategories]),F=j.useCallback(async z=>{if(!t)throw new Error("No budget selected");await s.updateCategoryGroups.mutateAsync({budgetId:t,categoryGroups:z})},[t,s.updateCategoryGroups]),q=j.useCallback(async(z,L)=>{if(!t)throw new Error("No budget selected");await Promise.all([s.updateAccounts.mutateAsync({budgetId:t,accounts:z}),s.updateAccountGroups.mutateAsync({budgetId:t,accountGroups:L})])},[t,s]),B=j.useCallback(async(z,L)=>{if(!t)throw new Error("No budget selected");await Promise.all([s.updateCategories.mutateAsync({budgetId:t,categories:z}),s.updateCategoryGroups.mutateAsync({budgetId:t,categoryGroups:L})])},[t,s]),$=j.useCallback(async z=>{if(!t)throw new Error("No budget selected");await s.renameBudget.mutateAsync({budgetId:t,newName:z})},[t,s.renameBudget]),Y=j.useCallback(async z=>{if(!e)throw new Error("Not authenticated");return await o.createBudget.mutateAsync({name:z.trim()||"My Budget",userId:e,userEmail:null})},[e,o.createBudget]),X=j.useCallback(async z=>{if(!t)throw new Error("No budget selected");await o.inviteUser.mutateAsync({budgetId:t,userId:z})},[t,o.inviteUser]),C=j.useCallback(async z=>{if(!t)throw new Error("No budget selected");await o.revokeUser.mutateAsync({budgetId:t,userId:z})},[t,o.revokeUser]),T=j.useCallback(async z=>{if(!e)throw new Error("Not authenticated");await o.acceptInvite.mutateAsync({budgetId:z,userId:e})},[e,o.acceptInvite]),I=j.useCallback(z=>{if(!t)return;const L=Vn.getQueryData(se.budget(t));L&&Vn.setQueryData(se.budget(t),{...L,accounts:z})},[t]),k=j.useCallback(z=>{if(!t)return;const L=Vn.getQueryData(se.budget(t));L&&Vn.setQueryData(se.budget(t),{...L,accountGroups:z})},[t]),D=j.useCallback(z=>{if(!t)return;const L=Vn.getQueryData(se.budget(t));L&&Vn.setQueryData(se.budget(t),{...L,categories:z})},[t]),V=j.useCallback(z=>{if(!t)return;const L=Vn.getQueryData(se.budget(t));L&&Vn.setQueryData(se.budget(t),{...L,categoryGroups:z})},[t]),N=j.useCallback(async()=>{t&&await Vn.invalidateQueries({queryKey:se.budget(t)})},[t]),W=j.useCallback(()=>Object.entries(p).filter(([,z])=>{const L=z.account_group_id?h[z.account_group_id]:void 0,H=L?.on_budget!==void 0?L.on_budget:z.on_budget!==!1,Q=L?.is_active!==void 0?L.is_active:z.is_active!==!1;return H&&Q}).reduce((z,[,L])=>z+L.balance,0),[p,h]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:c,accounts:p,accountGroups:h,categories:m,categoryGroups:_,isOwner:v,budgetUserIds:E,acceptedUserIds:w,saveAccounts:A,saveAccountGroups:R,saveCategories:O,saveCategoryGroups:F,saveAccountsAndGroups:q,saveCategoriesAndGroups:B,renameBudget:$,createBudget:Y,inviteUser:X,revokeUser:C,acceptInvite:T,setAccountsOptimistic:I,setAccountGroupsOptimistic:k,setCategoriesOptimistic:D,setCategoryGroupsOptimistic:V,refreshBudget:N,getOnBudgetTotal:W}}function fl(t,e,n){const s=rj(t,e,n,{enabled:!!t}),o=aj(t,{enabled:!!t}),l=vj(),c=s.data?.month||null,p=c?.income||[],h=c?.expenses||[],m=c?.allocations||[],_=c?.category_balances||[],v=c?.total_income||0,E=c?.total_expenses||0,w=c?.allocations_finalized||!1,A=j.useMemo(()=>{if(c?.previous_month_snapshot?.total_income!==void 0)return c.previous_month_snapshot.total_income;if(!t)return 0;let k=e,D=n-1;return D<1&&(D=12,k-=1),Vn.getQueryData(se.month(t,k,D))?.month?.total_income||0},[c,t,e,n]),R=o.data||[],O=j.useCallback(async(k,D,V,N,W)=>{if(!t)throw new Error("No budget selected");const[z,L]=V.split("-").map(Number);await l.addIncome.mutateAsync({budgetId:t,year:z,month:L,amount:k,accountId:D,date:V,payee:N,description:W})},[t,l.addIncome]),F=j.useCallback(async(k,D,V,N,W,z)=>{if(!t||!c)throw new Error("No budget or month loaded");const L=c.income.find(H=>H.id===k);if(!L)throw new Error("Income not found");await l.updateIncome.mutateAsync({budgetId:t,year:e,month:n,incomeId:k,amount:D,accountId:V,date:N,payee:W,description:z,oldAmount:L.amount,oldAccountId:L.account_id})},[t,c,e,n,l.updateIncome]),q=j.useCallback(async k=>{if(!t||!c)throw new Error("No budget or month loaded");const D=c.income.find(V=>V.id===k);if(!D)throw new Error("Income not found");await l.deleteIncome.mutateAsync({budgetId:t,year:e,month:n,incomeId:k,amount:D.amount,accountId:D.account_id})},[t,c,e,n,l.deleteIncome]),B=j.useCallback(async(k,D,V,N,W,z)=>{if(!t)throw new Error("No budget selected");const[L,H]=N.split("-").map(Number);await l.addExpense.mutateAsync({budgetId:t,year:L,month:H,amount:k,categoryId:D,accountId:V,date:N,payee:W,description:z})},[t,l.addExpense]),$=j.useCallback(async(k,D,V,N,W,z,L)=>{if(!t||!c)throw new Error("No budget or month loaded");const H=c.expenses?.find(Q=>Q.id===k);if(!H)throw new Error("Expense not found");await l.updateExpense.mutateAsync({budgetId:t,year:e,month:n,expenseId:k,amount:D,categoryId:V,accountId:N,date:W,payee:z,description:L,oldAmount:H.amount,oldAccountId:H.account_id})},[t,c,e,n,l.updateExpense]),Y=j.useCallback(async k=>{if(!t||!c)throw new Error("No budget or month loaded");const D=c.expenses?.find(V=>V.id===k);if(!D)throw new Error("Expense not found");await l.deleteExpense.mutateAsync({budgetId:t,year:e,month:n,expenseId:k,amount:D.amount,accountId:D.account_id})},[t,c,e,n,l.deleteExpense]),X=j.useCallback(async k=>{if(!t)throw new Error("No budget selected");await l.saveAllocations.mutateAsync({budgetId:t,year:e,month:n,allocations:k})},[t,e,n,l.saveAllocations]),C=j.useCallback(async()=>{if(!t||!c)throw new Error("No budget or month loaded");await l.finalizeAllocations.mutateAsync({budgetId:t,year:e,month:n,allocations:c.allocations||[]})},[t,c,e,n,l.finalizeAllocations]),T=j.useCallback(async()=>{if(!t)throw new Error("No budget selected");await l.unfinalizeAllocations.mutateAsync({budgetId:t,year:e,month:n})},[t,e,n,l.unfinalizeAllocations]),I=j.useCallback(async()=>{t&&await Vn.invalidateQueries({queryKey:se.month(t,e,n)})},[t,e,n]);return{isLoading:s.isLoading,isFetching:s.isFetching,error:s.error,month:c,income:p,expenses:h,allocations:m,categoryBalances:_,totalIncome:v,totalExpenses:E,allocationsFinalized:w,previousMonthIncome:A,payees:R,payeesLoading:o.isLoading,addIncome:O,updateIncome:F,deleteIncome:q,addExpense:B,updateExpense:$,deleteExpense:Y,saveAllocations:X,finalizeAllocations:C,unfinalizeAllocations:T,refreshMonth:I}}function Hk(){const{selectedBudgetId:t,currentUserId:e}=An(),{budget:n,accounts:s,accountGroups:o,saveAccounts:l,saveAccountGroups:c,saveAccountsAndGroups:p,setAccountsOptimistic:h,setAccountGroupsOptimistic:m}=zn(t,e),[_,v]=j.useState(null),E=j.useMemo(()=>Object.entries(s).reduce((T,[I,k])=>{const D=k.account_group_id||"ungrouped";return T[D]||(T[D]=[]),T[D].push({...k,id:I}),T},{}),[s]),w=j.useMemo(()=>Object.entries(o).sort(([,T],[,I])=>T.sort_order-I.sort_order).map(([T,I])=>({...I,id:T})),[o]),A=j.useCallback((T,I)=>{if(!n)return;const k=Object.values(s).filter(z=>I==="ungrouped"?!z.account_group_id:z.account_group_id===I),D=k.length>0?Math.max(...k.map(z=>z.sort_order)):-1,V=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,N={nickname:T.nickname,balance:0,account_group_id:I==="ungrouped"?null:I,sort_order:D+1,is_income_account:T.is_income_account,is_income_default:T.is_income_default,is_outgo_account:T.is_outgo_account,is_outgo_default:T.is_outgo_default,on_budget:T.on_budget!==!1,is_active:T.is_active!==!1},W={...s};T.is_income_default&&Object.keys(W).forEach(z=>{W[z]={...W[z],is_income_default:!1}}),T.is_outgo_default&&Object.keys(W).forEach(z=>{W[z]={...W[z],is_outgo_default:!1}}),W[V]=N,h(W),l(W).catch(z=>{console.error("[useAccountHandlers] Error creating account:",z),v(z instanceof Error?z.message:"Failed to create account.")})},[n,s,h,l]),R=j.useCallback((T,I)=>{if(!n)return;const k=s[T];if(!k)return;const D=k.account_group_id||"ungrouped",V=I.account_group_id;let N=k.sort_order;if(D!==(V||"ungrouped")){const z=Object.values(s).filter(L=>(L.account_group_id||"ungrouped")===(V||"ungrouped"));N=z.length>0?Math.max(...z.map(L=>L.sort_order))+1:0}const W={};Object.entries(s).forEach(([z,L])=>{z===T?W[z]={...L,nickname:I.nickname,account_group_id:V,sort_order:N,is_income_account:I.is_income_account,is_income_default:I.is_income_default,is_outgo_account:I.is_outgo_account,is_outgo_default:I.is_outgo_default,on_budget:I.on_budget!==!1,is_active:I.is_active!==!1}:(W[z]={...L},I.is_income_default&&!k.is_income_default&&(W[z].is_income_default=!1),I.is_outgo_default&&!k.is_outgo_default&&(W[z].is_outgo_default=!1))}),h(W),l(W).catch(z=>{console.error("[useAccountHandlers] Error saving account:",z),v(z instanceof Error?z.message:"Failed to save account.")})},[n,s,h,l]),O=j.useCallback(T=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[T]:I,...k}=s;h(k),l(k).catch(D=>{console.error("[useAccountHandlers] Error deleting account:",D),v(D instanceof Error?D.message:"Failed to delete account.")})},[n,s,h,l]),F=j.useCallback(async(T,I)=>{const k=s[T];if(!k)return;const D=k.account_group_id||"ungrouped",V=Object.entries(s).filter(([,Q])=>(Q.account_group_id||"ungrouped")===D).sort(([,Q],[,ae])=>Q.sort_order-ae.sort_order),N=V.findIndex(([Q])=>Q===T),W=I==="up"?N-1:N+1;if(W<0||W>=V.length)return;const[z,L]=V[W],H={};if(Object.entries(s).forEach(([Q,ae])=>{Q===T?H[Q]={...ae,sort_order:L.sort_order}:Q===z?H[Q]={...ae,sort_order:k.sort_order}:H[Q]={...ae}}),h(H),!!n)try{await l(H)}catch(Q){h(s),v(Q instanceof Error?Q.message:"Failed to move account")}},[n,s,h,l]),q=j.useCallback(T=>{if(!n)return;const I=Object.values(o).map(W=>W.sort_order),k=I.length>0?Math.max(...I):-1,D=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,V={name:T.name,sort_order:k+1,expected_balance:T.expected_balance,on_budget:T.on_budget,is_active:T.is_active},N={...o,[D]:V};m(N),c(N).catch(W=>{console.error("[useAccountHandlers] Error creating group:",W),v(W instanceof Error?W.message:"Failed to create account type.")})},[n,o,m,c]),B=j.useCallback((T,I)=>{if(!n)return;const k={...o,[T]:{...o[T],name:I.name,expected_balance:I.expected_balance,on_budget:I.on_budget,is_active:I.is_active}};m(k),c(k).catch(D=>{console.error("[useAccountHandlers] Error updating group:",D),v(D instanceof Error?D.message:"Failed to update account type.")})},[n,o,m,c]),$=j.useCallback(T=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const I={};Object.entries(s).forEach(([V,N])=>{I[V]=N.account_group_id===T?{...N,account_group_id:null}:N});const{[T]:k,...D}=o;h(I),m(D),p(I,D).catch(V=>{console.error("[useAccountHandlers] Error deleting group:",V),v(V instanceof Error?V.message:"Failed to delete account type.")})},[n,s,o,h,m,p]),Y=j.useCallback(async(T,I)=>{const k=Object.entries(o).sort(([,z],[,L])=>z.sort_order-L.sort_order),D=k.findIndex(([z])=>z===T),V=I==="up"?D-1:D+1;if(V<0||V>=k.length)return;const[N]=k.splice(D,1);k.splice(V,0,N);const W={};if(k.forEach(([z,L],H)=>{W[z]={...L,sort_order:H}}),m(W),!!n)try{await c(W)}catch(z){m(o),v(z instanceof Error?z.message:"Failed to move account type")}},[n,o,m,c]),X=j.useCallback(async(T,I,k)=>{const D=s[T];if(!D)return;const V=k==="ungrouped"?null:k,N=Object.entries(s).filter(([,L])=>(L.account_group_id||"ungrouped")===k),W={};Object.entries(s).forEach(([L,H])=>{L!==T&&(W[L]={...H})});let z;if(I==="__group_end__"||N.length===0||!N.find(([L])=>L===I))z=(N.length>0?Math.max(...N.filter(([H])=>H!==T).map(([,H])=>H.sort_order)):-1)+1;else{const L=N.find(([H])=>H===I);if(L){const[,H]=L;z=H.sort_order,Object.entries(W).forEach(([Q,ae])=>{(ae.account_group_id||"ungrouped")===k&&ae.sort_order>=z&&(W[Q]={...ae,sort_order:ae.sort_order+1})})}else z=0}if(W[T]={...D,account_group_id:V,sort_order:z},h(W),!!n)try{await l(W)}catch(L){v(L instanceof Error?L.message:"Failed to save changes")}},[n,s,h,l]),C=j.useCallback(async(T,I)=>{if(T===I)return;const k=Object.entries(o).sort(([,z],[,L])=>z.sort_order-L.sort_order),D=k.findIndex(([z])=>z===T),V=[...k],[N]=V.splice(D,1);if(I==="__end__")V.push(N);else{const z=V.findIndex(([L])=>L===I);V.splice(z,0,N)}const W={};if(V.forEach(([z,L],H)=>{W[z]={...L,sort_order:H}}),m(W),!!n)try{await c(W)}catch(z){v(z instanceof Error?z.message:"Failed to save new order")}},[n,o,m,c]);return{accounts:s,accountGroups:o,accountsByGroup:E,sortedGroups:w,currentBudget:n,error:_,setError:v,handleCreateAccount:A,handleUpdateAccount:R,handleDeleteAccount:O,handleMoveAccount:F,handleCreateGroup:q,handleUpdateGroup:B,handleDeleteGroup:$,handleMoveGroup:Y,reorderAccountsInGroup:X,reorderGroups:C}}function Gk(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:s}=An(),{categories:o,getOnBudgetTotal:l}=zn(t,e),{month:c,isLoading:p,previousMonthIncome:h,saveAllocations:m,finalizeAllocations:_}=fl(t,n,s),[v,E]=j.useState({}),[w,A]=j.useState(!1),[R,O]=j.useState(!1),[F,q]=j.useState(!1),[B,$]=j.useState(null),Y=j.useMemo(()=>Object.values(o).reduce((H,Q)=>H+Q.balance,0),[o]);j.useEffect(()=>{if(!c)return;const H={};Object.entries(o).forEach(([Q,ae])=>{if(ae.default_monthly_type==="percentage")return;const ce=c.allocations?.find(U=>U.category_id===Q);ce?H[Q]=ce.amount.toString():ae.default_monthly_amount!==void 0&&ae.default_monthly_amount>0?H[Q]=ae.default_monthly_amount.toString():H[Q]=""}),E(H)},[c?.year,c?.month,o]);const X=j.useCallback((H,Q)=>{if(Q.default_monthly_type==="percentage"&&Q.default_monthly_amount!==void 0)return Q.default_monthly_amount/100*h;const ae=v[H],ce=parseFloat(ae||"0");return isNaN(ce)?0:ce},[v,h]),C=j.useMemo(()=>Object.entries(o).reduce((H,[Q,ae])=>H+X(Q,ae),0),[o,X]),T=l(),I=c?.allocations_finalized?(c.allocations||[]).reduce((H,Q)=>H+Q.amount,0):0,k=T-Y,D=j.useMemo(()=>k-C+I,[k,C,I]),V=j.useCallback((H,Q)=>{E(ae=>({...ae,[H]:Q}))},[]),N=j.useCallback(()=>{if(!c)return;const H={};Object.entries(o).forEach(([Q,ae])=>{if(ae.default_monthly_type==="percentage")return;const ce=c.allocations?.find(U=>U.category_id===Q);ce?H[Q]=ce.amount.toString():ae.default_monthly_amount!==void 0&&ae.default_monthly_amount>0?H[Q]=ae.default_monthly_amount.toString():H[Q]=""}),E(H),q(!1)},[c,o]),W=j.useCallback(()=>{const H=[];return Object.entries(o).forEach(([Q,ae])=>{const ce=X(Q,ae);ce>0&&H.push({category_id:Q,amount:ce})}),H},[o,X]),z=j.useCallback(async()=>{$(null),A(!0);try{await m(W()),q(!1)}catch(H){$(H instanceof Error?H.message:"Failed to save allocations")}finally{A(!1)}},[m,W]),L=j.useCallback(async()=>{$(null),O(!0);try{await m(W()),await _()}catch(H){$(H instanceof Error?H.message:"Failed to finalize allocations")}finally{O(!1)}},[m,_,W]);return{localAllocations:v,isSavingAllocations:w,isFinalizingAllocations:R,isEditingAppliedAllocations:F,error:B,monthLoading:p,onBudgetTotal:T,availableNow:k,currentDraftTotal:C,availableAfterApply:D,previousMonthIncome:h,allocationsFinalized:c?.allocations_finalized??!1,getAllocationAmount:X,handleAllocationChange:V,resetAllocationsToSaved:N,handleSaveAllocations:z,handleFinalizeAllocations:L,setIsEditingAppliedAllocations:q,setError:$}}function Qk(){const{selectedBudgetId:t,currentUserId:e}=An(),{budget:n,categories:s,categoryGroups:o,saveCategories:l,saveCategoryGroups:c,saveCategoriesAndGroups:p,setCategoriesOptimistic:h,setCategoryGroupsOptimistic:m,getOnBudgetTotal:_}=zn(t,e),[v,E]=j.useState(null),[w,A]=j.useState({}),[R]=j.useState(!1),[O,F]=j.useState(null),[q,B]=j.useState(null),[$,Y]=j.useState(null),[X,C]=j.useState(null);j.useEffect(()=>{if(n&&Object.keys(s).length>0){const ge={};Object.entries(s).forEach(([de,Z])=>{ge[de]=Z.balance}),A(ge)}},[n?.id,s]);async function T(ge,de){if(!n)return;const Z=de==="ungrouped"?null:de,Re=Object.values(s).filter(ze=>de==="ungrouped"?!ze.category_group_id:ze.category_group_id===de),xe=Re.length>0?Math.max(...Re.map(ze=>ze.sort_order)):-1,Qe=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Ge={name:ge.name,description:ge.description,category_group_id:Z,sort_order:xe+1,default_monthly_amount:ge.default_monthly_amount,default_monthly_type:ge.default_monthly_type,balance:0},nt={...s,[Qe]:Ge};h(nt);try{await l(nt)}catch(ze){h(s),E(ze instanceof Error?ze.message:"Failed to create category")}}async function I(ge,de){if(n)try{const Z=s[ge];if(!Z)return;const Re=Z.category_group_id||"ungrouped",xe=de.category_group_id;let Qe=Z.sort_order;if(Re!==(xe||"ungrouped")){const nt=Object.values(s).filter(ze=>(ze.category_group_id||"ungrouped")===(xe||"ungrouped")).filter((ze,Et,yt)=>s[ge]!==yt[Et]);Qe=nt.length>0?Math.max(...nt.map(ze=>ze.sort_order))+1:0}const Ge={...s,[ge]:{...Z,name:de.name,description:de.description,category_group_id:xe,sort_order:Qe,default_monthly_amount:de.default_monthly_amount,default_monthly_type:de.default_monthly_type}};h(Ge),await l(Ge)}catch(Z){E(Z instanceof Error?Z.message:"Failed to update category")}}async function k(ge){if(confirm("Are you sure you want to delete this category?")&&n)try{const{[ge]:de,...Z}=s;h(Z),await l(Z)}catch(de){E(de instanceof Error?de.message:"Failed to delete category")}}async function D(ge,de){const Z=s[ge];if(!Z)return;const Re=Z.category_group_id||"ungrouped",xe=Object.entries(s).filter(([,yt])=>(yt.category_group_id||"ungrouped")===Re).sort((yt,ht)=>yt[1].sort_order-ht[1].sort_order),Qe=xe.findIndex(([yt])=>yt===ge),Ge=de==="up"?Qe-1:Qe+1;if(Ge<0||Ge>=xe.length)return;const[nt,ze]=xe[Ge],Et={};if(Object.entries(s).forEach(([yt,ht])=>{yt===ge?Et[yt]={...ht,sort_order:ze.sort_order}:yt===nt?Et[yt]={...ht,sort_order:Z.sort_order}:Et[yt]=ht}),h(Et),!!n)try{await l(Et)}catch(yt){h(s),E(yt instanceof Error?yt.message:"Failed to move category")}}async function V(ge){if(n)try{const de=o.length>0?Math.max(...o.map(xe=>xe.sort_order)):-1,Z={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:ge.name,sort_order:de+1},Re=[...o,Z];m(Re),await c(Re)}catch(de){E(de instanceof Error?de.message:"Failed to create group")}}async function N(ge,de){if(n)try{const Z=o.map(Re=>Re.id===ge?{...Re,name:de.name}:Re);m(Z),await c(Z)}catch(Z){E(Z instanceof Error?Z.message:"Failed to update group")}}async function W(ge){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&n)try{const de={};Object.entries(s).forEach(([Re,xe])=>{de[Re]=xe.category_group_id===ge?{...xe,category_group_id:null}:xe});const Z=o.filter(Re=>Re.id!==ge);h(de),m(Z),await p(de,Z)}catch(de){E(de instanceof Error?de.message:"Failed to delete group")}}async function z(ge,de){const Z=[...o].sort((nt,ze)=>nt.sort_order-ze.sort_order),Re=Z.findIndex(nt=>nt.id===ge),xe=de==="up"?Re-1:Re+1;if(xe<0||xe>=Z.length)return;const[Qe]=Z.splice(Re,1);Z.splice(xe,0,Qe);const Ge=Z.map((nt,ze)=>({...nt,sort_order:ze}));if(m(Ge),!!n)try{await c(Ge)}catch(nt){m(o),E(nt instanceof Error?nt.message:"Failed to move group")}}function L(ge,de){F("category"),B(de),ge.dataTransfer.effectAllowed="move"}function H(ge,de,Z){ge.preventDefault(),O==="category"&&(de!==q&&Y(de),C(Z))}function Q(ge,de){ge.preventDefault(),O==="category"?(C(de),Y(null)):O==="group"&&de!==q&&Y(de)}function ae(){Y(null)}function ce(){C(null)}function U(){F(null),B(null),Y(null),C(null)}async function te(ge,de,Z){if(ge.preventDefault(),ge.stopPropagation(),!q||O!=="category"){U();return}const Re=s[q];if(!Re)return;const xe=Z==="ungrouped"?null:Z,Qe=Object.entries(s).filter(([,ze])=>(ze.category_group_id||"ungrouped")===Z),Ge={};Object.entries(s).forEach(([ze,Et])=>{ze!==q&&(Ge[ze]=Et)});let nt;if(de==="__group_end__"||Qe.length===0||!Qe.find(([ze])=>ze===de))nt=(Qe.length>0?Math.max(...Qe.filter(([Et])=>Et!==q).map(([,Et])=>Et.sort_order)):-1)+1;else{const ze=Qe.find(([Et])=>Et===de);ze?(nt=ze[1].sort_order,Object.entries(Ge).forEach(([Et,yt])=>{(yt.category_group_id||"ungrouped")===Z&&yt.sort_order>=nt&&(Ge[Et]={...yt,sort_order:yt.sort_order+1})})):nt=0}if(Ge[q]={...Re,category_group_id:xe,sort_order:nt},h(Ge),U(),!!n)try{await l(Ge)}catch(ze){E(ze instanceof Error?ze.message:"Failed to save changes")}}async function be(ge,de){ge.preventDefault(),O==="category"?await te(ge,"__group_end__",de):O==="group"&&await fe(ge,de)}function _e(ge,de){ge.stopPropagation(),F("group"),B(de),ge.dataTransfer.effectAllowed="move"}async function fe(ge,de){if(ge.preventDefault(),!q||O!=="group"||q===de){U();return}const Z=o.findIndex(Ge=>Ge.id===q),Re=[...o],[xe]=Re.splice(Z,1);if(de==="__end__")Re.push(xe);else{const Ge=Re.findIndex(nt=>nt.id===de);Re.splice(Ge,0,xe)}const Qe=Re.map((Ge,nt)=>({...Ge,sort_order:nt}));if(m(Qe),U(),!!n)try{await c(Qe)}catch(Ge){E(Ge instanceof Error?Ge.message:"Failed to save new order")}}const Ee=Object.entries(s).reduce((ge,[de,Z])=>{const Re=Z.category_group_id||"ungrouped";return ge[Re]||(ge[Re]=[]),ge[Re].push([de,Z]),ge},{}),we=[...o].sort((ge,de)=>ge.sort_order-de.sort_order);return{currentBudget:n,categories:s,categoryGroups:o,categoriesByGroup:Ee,sortedGroups:we,categoryBalances:w,loadingBalances:R,error:v,setError:E,getOnBudgetTotal:_,handleCreateCategory:T,handleUpdateCategory:I,handleDeleteCategory:k,handleMoveCategory:D,handleCreateGroup:V,handleUpdateGroup:N,handleDeleteGroup:W,handleMoveGroup:z,dragType:O,draggedId:q,dragOverId:$,dragOverGroupId:X,setDragOverId:Y,setDragOverGroupId:C,handleCategoryDragStart:L,handleCategoryDragOver:H,handleDragOverGroup:Q,handleDragLeave:ae,handleDragLeaveGroup:ce,handleDragEnd:U,handleCategoryDrop:te,handleDropOnGroup:be,handleGroupDragStart:_e,handleGroupDrop:fe}}const ye={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15"},Kk={maxWidth:"60rem",margin:"0 auto",padding:"2rem"},rh={marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},sc={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},$k={...sc,padding:"0.6rem 0.875rem",gap:"0.5rem"},Yk={background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1rem 1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},Wk={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},Xk={display:"flex",flexDirection:"column",gap:"0.5rem"},Jk={fontSize:"0.9rem",fontWeight:500},ac={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit"},Zk={...ac,cursor:"pointer"},by={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},hT={...by,background:ye.primary,color:"white",border:"none"},eN={...hT,padding:"0.75rem 1.5rem",borderRadius:"8px"},tN={...by,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},nN={...by,background:"transparent",border:`1px solid ${ye.errorBorder}`,color:ye.error},rN={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},iN={display:"flex",gap:"0.5rem"},sN={display:"flex",gap:"0.25rem"},fT={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},aN={...fT,borderColor:ye.errorBorder,color:ye.error},Xo={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},Ey={display:"flex",flexDirection:"column",gap:"2px"},oN={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},mT={opacity:.4,cursor:"grab"},pT={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:ye.primary,borderRadius:"2px",transition:"opacity 0.15s"},lN={position:"relative",height:"2rem",marginTop:"-0.25rem"},uN={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ye.primary,borderRadius:"2px",transition:"opacity 0.15s"},cN={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},dN={background:ye.errorBg,border:`1px solid ${ye.errorBorder}`,color:ye.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},hN={background:"transparent",border:"none",color:ye.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},af={opacity:.7,marginBottom:"1.5rem"},ml={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},Sy={fontWeight:500,fontSize:"1.1rem"},Hs={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function ih({children:t}){return f.jsx("div",{style:Kk,children:t})}function pl({message:t,children:e,onDismiss:n,style:s}){return f.jsxs("div",{style:{...dN,...s},children:[f.jsx("span",{children:e??t}),n&&f.jsx("button",{onClick:n,style:hN,children:""})]})}const fN={primary:hT,"primary-large":eN,secondary:tN,danger:nN,small:rN};function Ne({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:s,disabled:o,style:l,...c}){const p=fN[t],h=o||e;return f.jsx("button",{disabled:h,style:{...p,cursor:h?"not-allowed":"pointer",opacity:h?.7:1,...l},...c,children:e?n:s})}function Ua({children:t,onSubmit:e}){return f.jsx("form",{onSubmit:e,style:Wk,children:t})}function $t({label:t,htmlFor:e,children:n,hint:s}){return f.jsxs("div",{style:Xk,children:[f.jsx("label",{htmlFor:e,style:Jk,children:t}),n,s&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:s})]})}function Bi(t){return f.jsx("input",{style:ac,...t})}function ka({children:t,...e}){return f.jsx("select",{style:Zk,...e,children:t})}function xy({minHeight:t="6rem",style:e,...n}){return f.jsx("textarea",{style:{...ac,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function Ys({children:t}){return f.jsx("div",{style:oN,children:t})}function Rp(t){const n=t.replace(/[^\d.]/g,"").split("."),s=n[0]||"",o=n[1],l=s.replace(/\B(?=(\d{3})+(?!\d))/g,",");return o!==void 0?`$${l}.${o.slice(0,2)}`:l?`$${l}`:""}function mN(t){return t.replace(/[$,]/g,"")}function wy({id:t,value:e,onChange:n,placeholder:s="$0.00",required:o,autoFocus:l}){const[c,p]=j.useState(()=>Rp(e)),h=j.useRef(null);j.useEffect(()=>{const _=Rp(e);mN(c)!==e&&p(_)},[e]);function m(_){const v=_.target.value;if(!v||v==="$"){p(""),n("");return}const w=v.replace(/[^\d.]/g,"").split(".");let A=w[0];w.length>1&&(A+="."+w.slice(1).join("").slice(0,2));const R=Rp(A);p(R),n(A)}return f.jsx("input",{ref:h,id:t,type:"text",inputMode:"decimal",value:c,onChange:m,placeholder:s,required:o,autoFocus:l,style:ac})}function pN(t,e){const n=t.toLowerCase(),s=e.toLowerCase();if(s.includes(n)){const p=s.indexOf(n);return{match:!0,score:p===0||/\s/.test(s[p-1])?100:90}}let o=0,l=0,c=0;for(let p=0;p<s.length&&o<n.length;p++)s[p]===n[o]?(o++,c++,l+=c*2):c=0;return o===n.length?{match:!0,score:l}:{match:!1,score:0}}function gT({id:t,value:e,onChange:n,payees:s,placeholder:o="Enter payee name"}){const[l,c]=j.useState(!1),[p,h]=j.useState(-1),m=j.useRef(null),_=j.useRef(null),v=e.trim()?s.map(A=>({payee:A,...pN(e,A)})).filter(A=>A.match).sort((A,R)=>R.score-A.score).slice(0,8).map(A=>A.payee):[];j.useEffect(()=>{function A(R){m.current&&!m.current.contains(R.target)&&c(!1)}return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]);function E(A){!l||v.length===0||(A.key==="ArrowDown"?(A.preventDefault(),h(R=>Math.min(R+1,v.length-1))):A.key==="ArrowUp"?(A.preventDefault(),h(R=>Math.max(R-1,-1))):A.key==="Enter"&&p>=0?(A.preventDefault(),n(v[p]),c(!1),h(-1)):A.key==="Escape"&&(c(!1),h(-1)))}function w(A){n(A),c(!1),h(-1),_.current?.focus()}return f.jsxs("div",{ref:m,style:{position:"relative"},children:[f.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:A=>{n(A.target.value),c(!0),h(-1)},onFocus:()=>c(!0),onKeyDown:E,placeholder:o,autoComplete:"off",style:ac}),l&&v.length>0&&f.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:v.map((A,R)=>f.jsx("div",{onClick:()=>w(A),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:R===p?`color-mix(in srgb, ${ye.primary} 20%, transparent)`:"transparent",borderBottom:R<v.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>h(R),children:A},A))})]})}function of({children:t,isDragging:e,isDragOver:n,onDragStart:s,onDragOver:o,onDragLeave:l,onDragEnd:c,onDrop:p,onEdit:h,onDelete:m,onMoveUp:_,onMoveDown:v,canMoveUp:E=!0,canMoveDown:w=!0}){const A=$s(),R=_||v;return f.jsxs("div",{onDragOver:O=>{O.stopPropagation(),o(O)},onDragLeave:O=>{O.stopPropagation(),l()},onDrop:O=>{O.stopPropagation(),p(O)},style:{position:"relative"},children:[f.jsx("div",{style:{...pT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),f.jsxs("div",{style:{...A?$k:sc,opacity:e?.5:1},children:[f.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:A?"0.5rem":"0.75rem",minWidth:0},children:[f.jsx("span",{draggable:!0,onDragStart:s,onDragEnd:c,style:{...mT,fontSize:A?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),f.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),f.jsxs("div",{style:A?sN:iN,children:[A?f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:h,style:fT,title:"Edit","aria-label":"Edit",children:""}),f.jsx("button",{onClick:m,style:aN,title:"Delete","aria-label":"Delete",children:""})]}):f.jsxs(f.Fragment,{children:[f.jsx(Ne,{variant:"secondary",onClick:h,children:"Edit"}),f.jsx(Ne,{variant:"danger",onClick:m,children:"Delete"})]}),R&&f.jsxs("div",{style:Ey,children:[f.jsx("button",{onClick:O=>{O.stopPropagation(),_?.()},disabled:!E,style:{...Xo,opacity:E?.6:.2,cursor:E?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),f.jsx("button",{onClick:O=>{O.stopPropagation(),v?.()},disabled:!w,style:{...Xo,opacity:w?.6:.2,cursor:w?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function Ty({isActive:t,onDragOver:e,onDragLeave:n,onDrop:s,label:o="Move to end"}){return f.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:s,style:lN,children:[f.jsx("div",{style:{...uN,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&f.jsx("span",{style:cN,children:o})]})}function Wn({children:t,style:e}){return f.jsx("div",{style:{...Yk,...e},children:t})}function Ke(t){return`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function xn(t){return t>=0?ye.success:ye.danger}function Dh({isOpen:t,onClose:e,title:n,children:s,maxWidth:o="28rem"}){return t?f.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:e,children:f.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:"100%",maxWidth:o,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:l=>l.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[f.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),f.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),s]})}):null}const gN={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function yN(){const[t,e]=j.useState(!1),[n,s]=j.useState(""),[o,l]=j.useState("bug"),[c,p]=j.useState(!1),[h,m]=j.useState(null),_=j.useContext(Gu),E=La().get_current_firebase_user(),w=pr(),A=Iw();if(w.pathname.includes("/admin/feedback")||!_.is_logged_in)return null;async function O(F){if(F.preventDefault(),!(!n.trim()||!_.username||!E)){m(null);try{await A.submitFeedback.mutateAsync({userId:E.uid,userEmail:_.username,text:n.trim(),feedbackType:o,currentPath:w.pathname}),s(""),l("bug"),p(!0),setTimeout(()=>{p(!1),e(!1)},1500)}catch(q){m(q instanceof Error?q.message:"Failed to submit feedback")}}}return f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>e(!0),style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:ye.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:F=>{F.currentTarget.style.transform="scale(1.1)",F.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:F=>{F.currentTarget.style.transform="scale(1)",F.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),f.jsx(Dh,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:c?f.jsxs("div",{style:{textAlign:"center",padding:"2rem 0",color:ye.success},children:[f.jsx("span",{style:{fontSize:"2rem",display:"block",marginBottom:"0.5rem"},children:""}),"Feedback submitted!"]}):f.jsxs("form",{onSubmit:O,children:[f.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(F=>{const q=gN[F],B=o===F;return f.jsxs("button",{type:"button",onClick:()=>l(F),style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${q.color}`,borderRadius:"0.5rem",background:B?q.bgColor:"transparent",color:B?q.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:B?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:B?1:.5,boxShadow:B?`0 0 12px ${q.bgColor}`:"none",position:"relative"},children:[q.label,B&&f.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},F)})}),f.jsx(xy,{value:n,onChange:F=>s(F.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),h&&f.jsx("p",{style:{color:ye.error,fontSize:"0.85rem",margin:"0.5rem 0"},children:h}),f.jsxs(Ys,{children:[f.jsx(Ne,{type:"button",variant:"secondary",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),f.jsx(Ne,{type:"submit",isLoading:A.submitFeedback.isPending,disabled:!n.trim(),children:"Submit"})]})]})})]})}function Ro({children:t,labelStyle:e,...n}){return f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[f.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:ye.primary},...n}),t]})}function _N({title:t,count:e,children:n,defaultExpanded:s=!1}){const[o,l]=j.useState(s);return f.jsxs("div",{style:{marginTop:"2rem"},children:[f.jsxs("button",{onClick:()=>l(!o),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[f.jsx("span",{style:{transition:"transform 0.2s",transform:o?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),o&&n]})}function yT(t){const{tabs:e,activeTab:n,accentColor:s=ye.primary}=t,o=e.filter(h=>!h.hidden),l=h=>({flex:1,padding:"0.75rem 1rem",borderRadius:"8px",border:h?`2px solid ${s}`:"2px solid transparent",background:h?`color-mix(in srgb, ${s} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",cursor:"pointer",fontWeight:h?600:400,fontSize:"0.95rem",color:"inherit",transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"}),c=h=>h?f.jsx("span",{style:{marginLeft:"0.5rem",fontSize:"0.7rem",background:h.color||ye.success,color:"white",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:h.text}):null,p=h=>f.jsxs(f.Fragment,{children:[h.icon&&f.jsx("span",{children:h.icon}),f.jsx("span",{children:h.label}),c(h.badge)]});return f.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:o.map(h=>{const m=n===h.id;return t.mode==="link"?f.jsx(Dt,{to:`${t.linkPrefix}/${h.id}`,style:l(m),children:p(h)},h.id):f.jsx("button",{onClick:()=>t.onTabChange(h.id),style:l(m),children:p(h)},h.id)})})}function dg(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function vN({onCreateNew:t}){const[e,n]=j.useState(""),[s,o]=j.useState(!1),[l,c]=j.useState(null);async function p(h){h.preventDefault(),o(!0),c(null);try{await t(e.trim()||void 0)}catch(m){c(m instanceof Error?m.message:"Failed to create budget"),o(!1)}}return f.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[f.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),f.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&f.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:l}),f.jsx("button",{onClick:()=>c(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[f.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""})," Create Your Budget"]}),f.jsxs("form",{onSubmit:p,children:[f.jsxs("div",{style:{marginBottom:"1.5rem"},children:[f.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),f.jsx("input",{type:"text",value:e,onChange:h=>n(h.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),f.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),f.jsx("button",{type:"submit",disabled:s,style:{width:"100%",background:ye.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:s?"not-allowed":"pointer",fontWeight:600,opacity:s?.7:1,fontSize:"1rem"},children:s?"Creating...":"Create Budget"})]})]}),f.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function bN({invites:t,onAccept:e,onCreateNew:n}){const[s,o]=j.useState(null),[l,c]=j.useState(!1),[p,h]=j.useState(""),[m,_]=j.useState(!1),[v,E]=j.useState(null);async function w(R){o(R),E(null);try{await e(R)}catch(O){E(O instanceof Error?O.message:"Failed to accept invitation"),o(null)}}async function A(R){R.preventDefault(),_(!0),E(null);try{await n(p.trim()||void 0)}catch(O){E(O instanceof Error?O.message:"Failed to create new budget"),_(!1)}}return f.jsxs("div",{children:[f.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),f.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),v&&f.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:v}),f.jsx("button",{onClick:()=>E(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[f.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""})," Budget Invitations"]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(R=>f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[f.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[f.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:R.budgetName}),R.ownerEmail&&f.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",R.ownerEmail]})]}),f.jsx("button",{onClick:()=>w(R.budgetId),disabled:s!==null||m,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:s!==null||m?"not-allowed":"pointer",fontWeight:500,opacity:s!==null||m?.7:1,fontSize:"0.9rem"},children:s===R.budgetId?"Joining...":"Accept & Join"})]},R.budgetId))})]}),f.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?f.jsxs("form",{onSubmit:A,children:[f.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),f.jsxs("div",{style:{marginBottom:"1rem"},children:[f.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),f.jsx("input",{type:"text",value:p,onChange:R=>h(R.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[f.jsx("button",{type:"submit",disabled:m||s!==null,style:{background:ye.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:m||s!==null?"not-allowed":"pointer",fontWeight:500,opacity:m||s!==null?.7:1,fontSize:"0.9rem"},children:m?"Creating...":"Create Budget"}),f.jsx("button",{type:"button",onClick:()=>{c(!1),h("")},disabled:m,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:m?"not-allowed":"pointer",fontWeight:500,opacity:m?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),f.jsx("button",{onClick:()=>c(!0),disabled:s!==null,style:{background:ye.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:s!==null?"not-allowed":"pointer",fontWeight:500,opacity:s!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function EN({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const s=j.useMemo(()=>[{id:"income",label:"Income",icon:""},{id:"allocations",label:"Allocations",icon:"",badge:n?{text:"Applied",color:ye.success}:void 0},{id:"spend",label:"Spend",icon:""},{id:"balances",label:"Balances",icon:""}],[n]);return f.jsx(yT,{mode:"button",tabs:s,activeTab:t,onTabChange:o=>e(o)})}function SN({isLoading:t,onPreviousMonth:e,onNextMonth:n,onRecalculateAll:s,isRecomputing:o}){const{currentYear:l,currentMonthNumber:c,isAdmin:p,selectedBudgetId:h,currentUserId:m}=An(),{budget:_}=zn(h,m),{month:v}=fl(h,l,c),[E,w]=j.useState(!1),A=j.useRef(null);j.useEffect(()=>{if(!E)return;function O(F){A.current&&!A.current.contains(F.target)&&w(!1)}return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[E]);function R(){if(!v||!_)return;const O={...v,_meta:{downloaded_at:new Date().toISOString(),budget_id:_.id,budget_name:_.name}},F=new Blob([JSON.stringify(O,null,2)],{type:"application/json"}),q=URL.createObjectURL(F),B=document.createElement("a");B.href=q,B.download=`month_${l}_${String(c).padStart(2,"0")}.json`,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(q),w(!1)}return f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[f.jsx("button",{onClick:e,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Previous month",children:""}),f.jsxs("div",{ref:A,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[f.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[dT[c-1]," ",l]}),f.jsx("button",{onClick:()=>w(!E),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:E?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),t&&f.jsxs(f.Fragment,{children:[f.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[f.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:ye.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),f.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),E&&f.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[f.jsxs("button",{onClick:()=>{s(),w(!1)},disabled:o||t,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:o||t?"not-allowed":"pointer",fontSize:"0.85rem",color:"inherit",opacity:o||t?.5:1,textAlign:"left",transition:"background 0.15s"},title:"Recalculate all totals and category balances for this month",children:[o?"":""," Recalculate All"]}),p&&v&&f.jsx("button",{onClick:R,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),f.jsx("button",{onClick:n,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Next month",children:""})]})}function JE({accounts:t,accountGroups:e,payees:n,initialData:s,defaultAccountId:o,defaultDate:l,onSubmit:c,onCancel:p,onDelete:h,submitLabel:m,isMobile:_}){const v=new Date().toISOString().split("T")[0],[E,w]=j.useState(s?.amount?.toString()||""),[A,R]=j.useState(s?.account_id||o||(t[0]?t[0][0]:"")),[O,F]=j.useState(s?.date||l||v),[q,B]=j.useState(s?.payee||""),[$,Y]=j.useState(s?.description||""),X={},C=[];t.forEach(([k,D])=>{D.account_group_id?(X[D.account_group_id]||(X[D.account_group_id]=[]),X[D.account_group_id].push([k,D])):C.push([k,D])});function T(k){k.preventDefault();const D=parseFloat(E);isNaN(D)||D<=0||A&&O&&c(D,A,O,q.trim()||void 0,$.trim()||void 0)}const I=_?{display:"flex",flexDirection:"column",gap:"1rem"}:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"};return f.jsxs(Ua,{onSubmit:T,children:[f.jsxs("div",{style:I,children:[f.jsx($t,{label:"Amount",htmlFor:"income-amount",children:f.jsx(wy,{id:"income-amount",value:E,onChange:w,placeholder:"$0.00",required:!0,autoFocus:!0})}),f.jsx($t,{label:"Date",htmlFor:"income-date",children:f.jsx(Bi,{id:"income-date",type:"date",value:O,onChange:k=>F(k.target.value),required:!0})})]}),f.jsxs("div",{style:I,children:[f.jsx($t,{label:"Deposit To",htmlFor:"income-account",children:f.jsxs(ka,{id:"income-account",value:A,onChange:k=>R(k.target.value),required:!0,children:[Object.entries(e).map(([k,D])=>{const V=X[k];return!V||V.length===0?null:f.jsx("optgroup",{label:D.name,children:V.map(([N,W])=>f.jsx("option",{value:N,children:W.nickname},N))},k)}),C.length>0&&f.jsx("optgroup",{label:"Other",children:C.map(([k,D])=>f.jsx("option",{value:k,children:D.nickname},k))})]})}),f.jsx($t,{label:"Payee",htmlFor:"income-payee",children:f.jsx(gT,{id:"income-payee",value:q,onChange:B,payees:n,placeholder:"e.g., Employer, Client name"})})]}),f.jsx($t,{label:"Description (optional)",htmlFor:"income-description",children:f.jsx(Bi,{id:"income-description",value:$,onChange:k=>Y(k.target.value),placeholder:"e.g., January paycheck, Project bonus"})}),f.jsxs(Ys,{children:[f.jsx(Ne,{type:"submit",children:m}),f.jsx(Ne,{type:"button",variant:"secondary",onClick:p,children:"Cancel"}),h&&f.jsx(Ne,{type:"button",variant:"danger",onClick:h,style:{marginLeft:"auto"},children:" Delete"})]})]})}function xN({income:t,accountName:e,accountGroupName:n,onEdit:s,onDelete:o,isMobile:l}){return f.jsxs("div",{onClick:l?s:void 0,style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:l?"0.875rem 1rem":"1rem 1.25rem",borderRadius:"8px",display:"flex",flexDirection:l?"column":"row",justifyContent:"space-between",alignItems:l?"stretch":"center",gap:l?"0.5rem":"1rem",cursor:l?"pointer":"default",transition:l?"background 0.15s":"none"},children:[f.jsxs("div",{style:{flex:1},children:[f.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"0.75rem",marginBottom:t.payee?"0.25rem":0},children:[t.date&&f.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,fontFamily:"monospace"},children:new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}),f.jsxs("span",{style:{fontSize:"1.15rem",fontWeight:600,color:ye.success},children:["+",Ke(t.amount)]})]}),t.payee&&f.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,marginBottom:"0.25rem"},children:t.payee}),f.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:[" ",e,n?` / ${n}`:""]}),t.description&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",opacity:.7},children:t.description})]}),!l&&f.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[f.jsx("button",{onClick:s,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit",children:""}),f.jsx("button",{onClick:o,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete",children:""})]})]})}function wN(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:s}=An(),{accounts:o,accountGroups:l}=zn(t,e),{month:c,isLoading:p,payees:h,addIncome:m,updateIncome:_,deleteIncome:v}=fl(t,n,s),E=$s(),[w,A]=j.useState(null),[R,O]=j.useState(!1),[F,q]=j.useState(null);function B(W){const z=W.account_group_id?l[W.account_group_id]:void 0;return z?.is_active!==void 0?z.is_active:W.is_active!==!1}function $(W){const z=W.account_group_id?l[W.account_group_id]:void 0;return z?.on_budget!==void 0?z.on_budget:W.on_budget!==!1}const Y=Object.entries(o).filter(([,W])=>B(W)&&$(W)),X=Y.filter(([,W])=>W.is_income_account),C=X.length>0?X:Y,T=Y.find(([,W])=>W.is_income_default),I=T?T[0]:void 0,k=c?.income.reduce((W,z)=>W+z.amount,0)||0;function D(W,z,L,H,Q){A(null),O(!1),m(W,z,L,H,Q).catch(ae=>{A(ae instanceof Error?ae.message:"Failed to add income")})}function V(W,z,L,H,Q,ae){A(null),q(null),_(W,z,L,H,Q,ae).catch(ce=>{A(ce instanceof Error?ce.message:"Failed to update income")})}function N(W){confirm("Are you sure you want to delete this income entry?")&&(A(null),v(W).catch(z=>{A(z instanceof Error?z.message:"Failed to delete income")}))}return f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:p?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:p?"none":"auto"},children:[w&&f.jsx("div",{style:{background:`color-mix(in srgb, ${ye.error} 15%, transparent)`,border:`1px solid ${ye.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ye.error},children:w}),f.jsxs("div",{style:{display:"flex",flexDirection:E?"column":"row",justifyContent:"space-between",alignItems:E?"stretch":"center",gap:E?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("div",{children:[f.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:"Total"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.25rem",fontWeight:600,color:xn(k)},children:Ke(k)})]}),!R&&f.jsx(Ne,{onClick:()=>O(!0),disabled:C.length===0,children:"+ Add Income"})]}),C.length===0&&f.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(o).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",f.jsx(Dt,{to:"/budget/accounts",style:{color:ye.primaryLight},children:"Manage accounts "})]}),R&&f.jsx("div",{style:{marginBottom:"1rem"},children:f.jsx(JE,{accounts:C,accountGroups:l,payees:h,defaultAccountId:I,defaultDate:`${n}-${String(s).padStart(2,"0")}-01`,onSubmit:D,onCancel:()=>O(!1),submitLabel:"Add Income",isMobile:E})}),f.jsxs("div",{style:Hs,children:[c?.income.slice().sort((W,z)=>(W.date||"").localeCompare(z.date||"")).map(W=>F===W.id?f.jsx(JE,{accounts:C,accountGroups:l,payees:h,initialData:W,onSubmit:(z,L,H,Q,ae)=>V(W.id,z,L,H,Q,ae),onCancel:()=>q(null),onDelete:()=>N(W.id),submitLabel:"Save",isMobile:E},W.id):f.jsx(xN,{income:W,accountName:o[W.account_id]?.nickname||"Unknown Account",accountGroupName:o[W.account_id]?.account_group_id?l[o[W.account_id].account_group_id]?.name:void 0,onEdit:()=>q(W.id),onDelete:()=>N(W.id),isMobile:E},W.id)),(!c?.income||c.income.length===0)&&!R&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1rem"},children:"No income recorded for this month"})]})]})}function ZE({accounts:t,accountGroups:e,categories:n,categoryGroups:s,payees:o,initialData:l,defaultAccountId:c,defaultDate:p,onSubmit:h,onCancel:m,onDelete:_,submitLabel:v,isMobile:E}){const w=new Date().toISOString().split("T")[0],[A,R]=j.useState(l?.amount?.toString()||""),[O,F]=j.useState(l?.category_id||""),[q,B]=j.useState(l?.account_id||c||(t[0]?t[0][0]:"")),[$,Y]=j.useState(l?.date||p||w),[X,C]=j.useState(l?.payee||""),[T,I]=j.useState(l?.description||""),k={},D=[];t.forEach(([H,Q])=>{Q.account_group_id?(k[Q.account_group_id]||(k[Q.account_group_id]=[]),k[Q.account_group_id].push([H,Q])):D.push([H,Q])});const V={},N=[];Object.entries(n).forEach(([H,Q])=>{Q.category_group_id?(V[Q.category_group_id]||(V[Q.category_group_id]=[]),V[Q.category_group_id].push([H,Q])):N.push([H,Q])}),Object.values(V).forEach(H=>{H.sort((Q,ae)=>Q[1].sort_order-ae[1].sort_order)}),N.sort((H,Q)=>H[1].sort_order-Q[1].sort_order);const W=[...s].sort((H,Q)=>H.sort_order-Q.sort_order);function z(H){H.preventDefault();const Q=parseFloat(A);isNaN(Q)||Q<=0||O&&q&&$&&h(Q,O,q,$,X.trim()||void 0,T.trim()||void 0)}const L=E?{display:"flex",flexDirection:"column",gap:"1rem"}:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"};return f.jsxs(Ua,{onSubmit:z,children:[f.jsxs("div",{style:L,children:[f.jsx($t,{label:"Amount",htmlFor:"expense-amount",children:f.jsx(wy,{id:"expense-amount",value:A,onChange:R,placeholder:"$0.00",required:!0,autoFocus:!0})}),f.jsx($t,{label:"Date",htmlFor:"expense-date",children:f.jsx(Bi,{id:"expense-date",type:"date",value:$,onChange:H=>Y(H.target.value),required:!0})})]}),f.jsxs("div",{style:L,children:[f.jsx($t,{label:"Category",htmlFor:"expense-category",children:f.jsxs(ka,{id:"expense-category",value:O,onChange:H=>F(H.target.value),required:!0,children:[f.jsx("option",{value:"",children:"Select category..."}),W.map(H=>{const Q=V[H.id];return!Q||Q.length===0?null:f.jsx("optgroup",{label:H.name,children:Q.map(([ae,ce])=>f.jsx("option",{value:ae,children:ce.name},ae))},H.id)}),N.length>0&&f.jsx("optgroup",{label:"Other",children:N.map(([H,Q])=>f.jsx("option",{value:H,children:Q.name},H))})]})}),f.jsx($t,{label:"Pay From",htmlFor:"expense-account",children:f.jsxs(ka,{id:"expense-account",value:q,onChange:H=>B(H.target.value),required:!0,children:[Object.entries(e).map(([H,Q])=>{const ae=k[H];return!ae||ae.length===0?null:f.jsx("optgroup",{label:Q.name,children:ae.map(([ce,U])=>f.jsx("option",{value:ce,children:U.nickname},ce))},H)}),D.length>0&&f.jsx("optgroup",{label:"Other",children:D.map(([H,Q])=>f.jsx("option",{value:H,children:Q.nickname},H))})]})})]}),f.jsx($t,{label:"Payee",htmlFor:"expense-payee",children:f.jsx(gT,{id:"expense-payee",value:X,onChange:C,payees:o,placeholder:"e.g., Grocery Store, Restaurant"})}),f.jsx($t,{label:"Description (optional)",htmlFor:"expense-description",children:f.jsx(Bi,{id:"expense-description",value:T,onChange:H=>I(H.target.value),placeholder:"e.g., Weekly groceries, Dinner with friends"})}),f.jsxs(Ys,{children:[f.jsx(Ne,{type:"submit",children:v}),f.jsx(Ne,{type:"button",variant:"secondary",onClick:m,children:"Cancel"}),_&&f.jsx(Ne,{type:"button",variant:"danger",onClick:_,style:{marginLeft:"auto"},children:" Delete"})]})]})}function TN({expense:t,categoryName:e,accountName:n,accountGroupName:s,onEdit:o,onDelete:l,isMobile:c}){return f.jsxs("div",{onClick:c?o:void 0,style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:c?"0.875rem 1rem":"1rem 1.25rem",borderRadius:"8px",display:"flex",flexDirection:c?"column":"row",justifyContent:"space-between",alignItems:c?"stretch":"center",gap:c?"0.5rem":"1rem",cursor:c?"pointer":"default",transition:c?"background 0.15s":"none"},children:[f.jsxs("div",{style:{flex:1},children:[f.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"0.75rem",marginBottom:t.payee?"0.25rem":0},children:[t.date&&f.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,fontFamily:"monospace"},children:new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}),f.jsxs("span",{style:{fontSize:"1.15rem",fontWeight:600,color:ye.error},children:["-",Ke(t.amount)]})]}),t.payee&&f.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,marginBottom:"0.25rem"},children:t.payee}),f.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center"},children:[f.jsx("div",{style:{fontSize:"0.85rem",background:`color-mix(in srgb, ${ye.primary} 20%, transparent)`,color:ye.primaryLight,padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:e}),f.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:[" ",n,s?` / ${s}`:""]})]}),t.description&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",opacity:.7},children:t.description})]}),!c&&f.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[f.jsx("button",{onClick:o,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit",children:""}),f.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete",children:""})]})]})}function AN(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:s}=An(),{accounts:o,accountGroups:l,categories:c,categoryGroups:p}=zn(t,e),{month:h,isLoading:m,payees:_,addExpense:v,updateExpense:E,deleteExpense:w}=fl(t,n,s),A=$s(),[R,O]=j.useState(null),[F,q]=j.useState(!1),[B,$]=j.useState(null);function Y(L){const H=L.account_group_id?l[L.account_group_id]:void 0;return H?.is_active!==void 0?H.is_active:L.is_active!==!1}function X(L){const H=L.account_group_id?l[L.account_group_id]:void 0;return H?.on_budget!==void 0?H.on_budget:L.on_budget!==!1}const C=Object.entries(o).filter(([,L])=>Y(L)&&X(L)),T=C.filter(([,L])=>L.is_outgo_account),I=T.length>0?T:C,k=C.find(([,L])=>L.is_outgo_default),D=k?k[0]:void 0,V=h?.expenses?.reduce((L,H)=>L+H.amount,0)||0;function N(L,H,Q,ae,ce,U){O(null),q(!1),v(L,H,Q,ae,ce,U).catch(te=>{O(te instanceof Error?te.message:"Failed to add expense")})}function W(L,H,Q,ae,ce,U,te){O(null),$(null),E(L,H,Q,ae,ce,U,te).catch(be=>{O(be instanceof Error?be.message:"Failed to update expense")})}function z(L){confirm("Are you sure you want to delete this expense?")&&(O(null),w(L).catch(H=>{O(H instanceof Error?H.message:"Failed to delete expense")}))}return f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:m?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:m?"none":"auto"},children:[R&&f.jsx("div",{style:{background:`color-mix(in srgb, ${ye.error} 15%, transparent)`,border:`1px solid ${ye.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ye.error},children:R}),f.jsxs("div",{style:{display:"flex",flexDirection:A?"column":"row",justifyContent:"space-between",alignItems:A?"stretch":"center",gap:A?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("div",{children:[f.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:"Total Expenses"}),f.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.25rem",fontWeight:600,color:V>0?ye.error:"inherit"},children:[V>0?"-":"",Ke(V)]})]}),!F&&f.jsx(Ne,{onClick:()=>q(!0),disabled:I.length===0||Object.keys(c).length===0,children:"+ Add Expense"})]}),I.length===0&&f.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(o).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",f.jsx(Dt,{to:"/budget/accounts",style:{color:ye.primaryLight},children:"Manage accounts "})]}),Object.keys(c).length===0&&f.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:["You need to create at least one category before adding expenses."," ",f.jsx(Dt,{to:"/budget/admin/categories",style:{color:ye.primaryLight},children:"Create categories "})]}),F&&f.jsx("div",{style:{marginBottom:"1rem"},children:f.jsx(ZE,{accounts:I,accountGroups:l,categories:c,categoryGroups:p,payees:_,defaultAccountId:D,defaultDate:`${n}-${String(s).padStart(2,"0")}-01`,onSubmit:N,onCancel:()=>q(!1),submitLabel:"Add Expense",isMobile:A})}),f.jsxs("div",{style:Hs,children:[h?.expenses?.slice().sort((L,H)=>(L.date||"").localeCompare(H.date||"")).map(L=>B===L.id?f.jsx(ZE,{accounts:I,accountGroups:l,categories:c,categoryGroups:p,payees:_,initialData:L,onSubmit:(H,Q,ae,ce,U,te)=>W(L.id,H,Q,ae,ce,U,te),onCancel:()=>$(null),onDelete:()=>z(L.id),submitLabel:"Save",isMobile:A},L.id):f.jsx(TN,{expense:L,categoryName:c[L.category_id]?.name||"Unknown Category",accountName:o[L.account_id]?.nickname||"Unknown Account",accountGroupName:o[L.account_id]?.account_group_id?l[o[L.account_id].account_group_id]?.name:void 0,onEdit:()=>$(L.id),onDelete:()=>z(L.id),isMobile:A},L.id)),(!h?.expenses||h.expenses.length===0)&&!F&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1rem"},children:"No expenses recorded for this month"})]})]})}function CN({category:t,value:e,onChange:n,previousMonthIncome:s,disabled:o}){const l=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,c=l?t.default_monthly_amount/100*s:0,p=l?c.toFixed(2):e;let h=null;return!l&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&(h=Ke(t.default_monthly_amount)),f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",padding:"0.6rem 0.75rem",background:l?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",maxWidth:"100%",boxSizing:"border-box",opacity:l?.8:1},children:[f.jsxs("div",{style:{flex:"1 1 auto",minWidth:0,overflow:"hidden"},children:[f.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),l?f.jsxs("span",{style:{fontSize:"0.7rem",opacity:.6,display:"block",marginTop:"0.15rem",color:ye.primary},children:[t.default_monthly_amount,"% of prev month income"]}):h&&f.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5,display:"block",marginTop:"0.15rem"},children:["Suggested: ",h]})]}),f.jsx("div",{style:{flexShrink:0,width:"110px"},children:l?f.jsx("div",{style:{width:"100%",padding:"0.5rem 0.6rem",borderRadius:"6px",border:"1px dashed color-mix(in srgb, currentColor 15%, transparent)",background:"color-mix(in srgb, currentColor 3%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box",textAlign:"right",opacity:.9},title:"Auto-calculated from previous month's income",children:Ke(c)}):f.jsx("input",{type:"text",inputMode:"decimal",value:p?`$${p}`:"",onChange:m=>{const _=m.target.value.replace(/[^\d.]/g,"");n(_)},placeholder:"$0.00",disabled:o,style:{width:"100%",padding:"0.5rem 0.6rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box",opacity:o?.6:1,cursor:o?"not-allowed":"text"}})})]})}function RN(){const{selectedBudgetId:t,currentUserId:e}=An(),{categories:n,categoryGroups:s}=zn(t,e),{localAllocations:o,isSavingAllocations:l,isFinalizingAllocations:c,isEditingAppliedAllocations:p,error:h,monthLoading:m,onBudgetTotal:_,availableNow:v,currentDraftTotal:E,availableAfterApply:w,previousMonthIncome:A,allocationsFinalized:R,getAllocationAmount:O,handleAllocationChange:F,resetAllocationsToSaved:q,handleSaveAllocations:B,handleFinalizeAllocations:$,setIsEditingAppliedAllocations:Y,setError:X}=Gk(),C=$s(),T=[...s].sort((D,V)=>D.sort_order-V.sort_order),I=j.useMemo(()=>{const D=Object.entries(n).reduce((V,[N,W])=>{const z=W.category_group_id||"ungrouped";return V[z]||(V[z]=[]),V[z].push([N,W]),V},{});return Object.keys(D).forEach(V=>{D[V].sort((N,W)=>N[1].sort_order-W[1].sort_order)}),D},[n]),k=Object.values(n).some(D=>D.default_monthly_type==="percentage");return f.jsxs("div",{style:{opacity:m?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:m?"none":"auto"},children:[h&&f.jsx(pl,{message:h,onDismiss:()=>X(null)}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:C?"1fr 1fr":"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[f.jsxs(Wn,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"On-Budget Total"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:xn(_)},children:Ke(_)})]}),f.jsxs(Wn,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"Available Now"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:xn(v)},children:Ke(v)}),f.jsx("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.7rem",opacity:.5},children:"(applied allocations only)"})]}),f.jsxs(Wn,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"This Month's Draft"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:ye.primary},children:Ke(E)})]}),f.jsxs(Wn,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"After Apply"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:xn(w)},children:Ke(w)}),f.jsx("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.7rem",opacity:.5},children:"(if you apply draft)"})]})]}),k&&f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.6rem 1rem",marginBottom:"1rem",fontSize:"0.85rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{style:{opacity:.6},children:""}),f.jsxs("span",{style:{opacity:.7},children:["Percentage allocations based on prev month income: ",f.jsx("strong",{style:{color:ye.primary},children:Ke(A)})]})]}),f.jsx(DN,{allocationsFinalized:R,isEditingAppliedAllocations:p,isSavingAllocations:l,isFinalizingAllocations:c,monthLoading:m,onCancel:q,onSave:B,onFinalize:$,onStartEdit:()=>Y(!0)}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(n).length===0&&f.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",f.jsx(Dt,{to:"/budget/admin/categories",style:{color:ye.primaryLight},children:"Create categories "})]}),T.map(D=>{const V=I[D.id]||[];if(V.length===0)return null;const N=V.reduce((W,[z,L])=>W+O(z,L),0);return f.jsx(eS,{name:D.name,categories:V,groupTotal:N,localAllocations:o,previousMonthIncome:A,disabled:R&&!p,onAllocationChange:F},D.id)}),I.ungrouped?.length>0&&f.jsx(eS,{name:"Uncategorized",categories:I.ungrouped,groupTotal:I.ungrouped.reduce((D,[V,N])=>D+O(V,N),0),localAllocations:o,previousMonthIncome:A,disabled:R&&!p,onAllocationChange:F,isUngrouped:!0})]})]})}function DN({allocationsFinalized:t,isEditingAppliedAllocations:e,isSavingAllocations:n,isFinalizingAllocations:s,monthLoading:o,onCancel:l,onSave:c,onFinalize:p,onStartEdit:h}){const m=t?e?ye.primary:ye.success:ye.warning;return f.jsxs("div",{style:{background:`color-mix(in srgb, ${m} 12%, transparent)`,border:`1px solid ${m}`,borderRadius:"8px",padding:"0.75rem 1rem",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.75rem"},children:[f.jsxs("div",{children:[f.jsx("p",{style:{margin:0,fontWeight:600,color:m},children:t?e?" Editing Applied Allocations":" Allocations Applied":" Allocations Not Applied"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:t?e?"Make changes and save, or cancel to revert.":"Click Edit to make changes to allocations.":"Save and apply to update category balances."})]}),f.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t?e?f.jsxs(f.Fragment,{children:[f.jsx(Ne,{onClick:l,disabled:n||o,variant:"secondary",children:"Cancel"}),f.jsx(Ne,{onClick:c,disabled:n||o,children:n?" Saving...":" Save Changes"})]}):f.jsx(Ne,{onClick:h,disabled:o,variant:"secondary",children:" Edit Allocations"}):f.jsxs(f.Fragment,{children:[f.jsx(Ne,{onClick:c,disabled:n||o,variant:"secondary",children:n?" Saving...":" Save Draft"}),f.jsx(Ne,{onClick:p,disabled:s||o,children:s?" Applying...":" Save & Apply"})]})})]})}function eS({name:t,categories:e,groupTotal:n,localAllocations:s,previousMonthIncome:o,disabled:l,onAllocationChange:c,isUngrouped:p}){return f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("h3",{style:{...ml,margin:0,opacity:p?.7:1},children:[t,f.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),f.jsx("span",{style:{fontWeight:600,color:ye.primary},children:Ke(n)})]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:e.map(([h,m])=>f.jsx(CN,{category:m,value:s[h]||"",onChange:_=>c(h,_),previousMonthIncome:o,disabled:l},h))})]})}function IN(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:s}=An(),{categories:o,categoryGroups:l}=zn(t,e),{month:c,isLoading:p}=fl(t,n,s),h=$s(),[m,_]=j.useState(!1),[v,E]=j.useState(!1),w=j.useCallback(async()=>{_(!0);try{console.warn("[BalancesSection] recalculateCategoryMonthBalances not yet implemented")}finally{_(!1)}},[]);j.useEffect(()=>{c&&!p&&(!c.category_balances||c.category_balances.length===0)&&!m&&!v&&(E(!0),w())},[c,p,v,m,w]),j.useEffect(()=>{E(!1)},[n,s]);const A=j.useMemo(()=>{if(c?.category_balances&&c.category_balances.length>0)return c.category_balances;const B=[];return Object.entries(o).forEach(([$])=>{let Y=0;if(c?.allocations_finalized&&c.allocations){const C=c.allocations.find(T=>T.category_id===$);C&&(Y=C.amount)}let X=0;c?.expenses&&(X=c.expenses.filter(C=>C.category_id===$).reduce((C,T)=>C+T.amount,0)),B.push({category_id:$,start_balance:0,allocated:Y,spent:X,end_balance:Y-X})}),B},[c,o]),R=B=>A.find($=>$.category_id===B),O=j.useMemo(()=>A.reduce((B,$)=>({start:B.start+$.start_balance,allocated:B.allocated+$.allocated,spent:B.spent+$.spent,end:B.end+$.end_balance}),{start:0,allocated:0,spent:0,end:0}),[A]),F=[...l].sort((B,$)=>B.sort_order-$.sort_order),q=j.useMemo(()=>{const B=Object.entries(o).reduce(($,[Y,X])=>{const C=X.category_group_id||"ungrouped";return $[C]||($[C]=[]),$[C].push([Y,X]),$},{});return Object.keys(B).forEach($=>{B[$].sort((Y,X)=>Y[1].sort_order-X[1].sort_order)}),B},[o]);return f.jsxs("div",{style:{opacity:p?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:p?"none":"auto"},children:[f.jsxs("div",{style:{display:"grid",gridTemplateColumns:h?"1fr 1fr":"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[f.jsxs(Wn,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"Start of Month"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:xn(O.start)},children:Ke(O.start)})]}),f.jsxs(Wn,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"Allocated"}),f.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:ye.success},children:["+",Ke(O.allocated)]})]}),f.jsxs(Wn,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"Spent"}),f.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:ye.error},children:["-",Ke(O.spent)]})]}),f.jsxs(Wn,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"End of Month"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:xn(O.end)},children:Ke(O.end)})]})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(o).length===0&&f.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",f.jsx(Dt,{to:"/budget/admin/categories",style:{color:ye.primaryLight},children:"Create categories "})]}),F.map(B=>{const $=q[B.id]||[];if($.length===0)return null;const Y=$.reduce((X,[C])=>{const T=R(C);return T?{start:X.start+T.start_balance,allocated:X.allocated+T.allocated,spent:X.spent+T.spent,end:X.end+T.end_balance}:X},{start:0,allocated:0,spent:0,end:0});return f.jsx(tS,{name:B.name,categories:$,groupEndBalance:Y.end,getCategoryBalance:R,isMobile:h},B.id)}),q.ungrouped?.length>0&&(()=>{const B=q.ungrouped,$=B.reduce((Y,[X])=>{const C=R(X);return C?{start:Y.start+C.start_balance,allocated:Y.allocated+C.allocated,spent:Y.spent+C.spent,end:Y.end+C.end_balance}:Y},{start:0,allocated:0,spent:0,end:0});return f.jsx(tS,{name:"Uncategorized",categories:B,groupEndBalance:$.end,getCategoryBalance:R,isMobile:h,isUngrouped:!0},"ungrouped")})()]})]})}function tS({name:t,categories:e,groupEndBalance:n,getCategoryBalance:s,isMobile:o,isUngrouped:l}){return f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("h3",{style:{...ml,margin:0,opacity:l?.7:1},children:[t,f.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),f.jsx("span",{style:{fontWeight:600,color:xn(n)},children:Ke(n)})]}),!o&&f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[f.jsx("span",{children:"Category"}),f.jsx("span",{style:{textAlign:"right"},children:"Start"}),f.jsx("span",{style:{textAlign:"right"},children:"Allocated"}),f.jsx("span",{style:{textAlign:"right"},children:"Spent"}),f.jsx("span",{style:{textAlign:"right"},children:"End"})]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:e.map(([c,p])=>{const h=s(c);return h?o?f.jsx(ON,{category:p,balance:h},c):f.jsx(jN,{category:p,balance:h},c):null})})]})}function ON({category:t,balance:e}){return f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[f.jsx("span",{style:{fontWeight:500},children:t.name}),f.jsx("span",{style:{fontWeight:600,color:xn(e.end_balance)},children:Ke(e.end_balance)})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.5rem",fontSize:"0.8rem"},children:[f.jsxs("div",{children:[f.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),f.jsx("span",{children:Ke(e.start_balance)})]}),f.jsxs("div",{children:[f.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),f.jsxs("span",{style:{color:e.allocated>0?ye.success:"inherit"},children:[e.allocated>0?"+":"",Ke(e.allocated)]})]}),f.jsxs("div",{children:[f.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),f.jsxs("span",{style:{color:e.spent>0?ye.error:"inherit"},children:[e.spent>0?"-":"",Ke(e.spent)]})]})]})]})}function jN({category:t,balance:e}){return f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[f.jsx("span",{style:{fontWeight:500},children:t.name}),f.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:Ke(e.start_balance)}),f.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.allocated>0?ye.success:"inherit"},children:[e.allocated>0?"+":"",Ke(e.allocated)]}),f.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.spent>0?ye.error:"inherit"},children:[e.spent>0?"-":"",Ke(e.spent)]}),f.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:xn(e.end_balance)},children:Ke(e.end_balance)})]})}function MN({isOpen:t,onClose:e,results:n}){const{currentYear:s,currentMonthNumber:o}=An(),l=n?.status==="done"||n?.status==="error";function c(){l&&e()}return f.jsx(Dh,{isOpen:t,onClose:c,title:"Recalculate Monthly Data",children:f.jsxs("div",{style:{padding:"0.5rem 0"},children:[f.jsxs("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:["Recalculating all totals and balances for ",dT[o-1]," ",s]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[f.jsx(Do,{status:n?.status==="pending"?"waiting":"complete",label:"Count income transactions",detail:n&&n.status!=="pending"?`Found ${n.incomeCount} transaction${n.incomeCount!==1?"s":""}`:void 0}),f.jsx(Do,{status:bu(n?.status,["income_counting"],"income_calculating"),label:"Calculate income total",detail:n?.newIncomeTotal!==void 0?Ke(n.newIncomeTotal):void 0}),f.jsx(Do,{status:bu(n?.status,["pending","income_counting","income_calculating"],"income_saving"),label:"Save income totals"}),f.jsx(Do,{status:bu(n?.status,["pending","income_counting","income_calculating","income_saving"],"expenses_counting"),label:"Count expense transactions",detail:n?.expenseCount!==void 0&&!["pending","income_counting","income_calculating","income_saving"].includes(n.status)?`Found ${n.expenseCount} expense${n.expenseCount!==1?"s":""} (${Ke(n.newExpenseTotal||0)})`:void 0}),f.jsx(Do,{status:bu(n?.status,["pending","income_counting","income_calculating","income_saving","expenses_counting"],"balances_calculating"),label:"Calculate category balances"}),f.jsx(Do,{status:n?.status==="error"?"error":bu(n?.status,["pending","income_counting","income_calculating","income_saving","expenses_counting","balances_calculating"],"balances_saving"),label:"Save category balances",detail:n?.status==="error"?n.error:void 0,isError:n?.status==="error"})]}),n?.status==="done"&&f.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${ye.success} 10%, transparent)`,border:`1px solid ${ye.success}`,borderRadius:"8px"},children:[f.jsx("p",{style:{margin:0,fontWeight:600,color:ye.success},children:" Recalculation complete!"}),f.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:["Income: ",Ke(n.newIncomeTotal||0),"  Expenses: ",Ke(n.newExpenseTotal||0),"  Category balances updated"]})]}),l&&f.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"flex-end"},children:f.jsx(Ne,{onClick:e,children:"Done"})})]})})}function bu(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function Do({status:t,label:e,detail:n,isError:s}){const o=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[f.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:o}),f.jsxs("div",{style:{flex:1},children:[f.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:s?1:.6,color:s?ye.error:"inherit"},children:n})]})]})}function kN(){const{currentUserId:t,selectedBudgetId:e,currentYear:n,currentMonthNumber:s,goToPreviousMonth:o,goToNextMonth:l,hasPendingInvites:c,pendingInvites:p,needsFirstBudget:h}=An(),{budget:m,isOwner:_,createBudget:v,acceptInvite:E}=zn(e,t),{month:w,isLoading:A}=fl(e,n,s),[R,O]=j.useState(null),[F,q]=j.useState(!1),[B,$]=j.useState(!1),[Y,X]=j.useState(null),[C,T]=j.useState(()=>{const W=localStorage.getItem("budget_active_tab");return W==="income"||W==="allocations"||W==="spend"||W==="balances"?W:"income"});j.useEffect(()=>{localStorage.setItem("budget_active_tab",C)},[C]);async function I(W){try{await E(W)}catch(z){O(z instanceof Error?z.message:"Failed to accept invite")}}async function k(W){try{await v(W||"My Budget")}catch(z){O(z instanceof Error?z.message:"Failed to create budget")}}if(!m&&c)return f.jsxs(ih,{children:[f.jsx("nav",{style:rh,children:f.jsx(Dt,{to:"/",children:" Back to Home"})}),f.jsx(bN,{invites:p,onAccept:I,onCreateNew:k})]});if(!m&&h)return f.jsxs(ih,{children:[f.jsx("nav",{style:rh,children:f.jsx(Dt,{to:"/",children:" Back to Home"})}),f.jsx(vN,{onCreateNew:k})]});function D(){O(null),o()}function V(){O(null),l()}async function N(){O(null),q(!0),$(!0),X({status:"pending"});try{await new Promise(ce=>setTimeout(ce,200));const W=w?.income.length||0,z=w?.total_income||0;X({status:"income_counting",incomeCount:W,oldIncomeTotal:z}),await new Promise(ce=>setTimeout(ce,200));const L=w?.income.reduce((ce,U)=>ce+U.amount,0)||0;X({status:"income_calculating",incomeCount:W,oldIncomeTotal:z,newIncomeTotal:L}),await new Promise(ce=>setTimeout(ce,150)),X({status:"income_saving",incomeCount:W,oldIncomeTotal:z,newIncomeTotal:L}),await new Promise(ce=>setTimeout(ce,200));const H=w?.expenses?.length||0,Q=w?.total_expenses||0,ae=w?.expenses?.reduce((ce,U)=>ce+U.amount,0)||0;X({status:"expenses_counting",incomeCount:W,oldIncomeTotal:z,newIncomeTotal:L,expenseCount:H,oldExpenseTotal:Q,newExpenseTotal:ae}),await new Promise(ce=>setTimeout(ce,200)),X({status:"balances_calculating",incomeCount:W,oldIncomeTotal:z,newIncomeTotal:L,expenseCount:H,oldExpenseTotal:Q,newExpenseTotal:ae}),await new Promise(ce=>setTimeout(ce,150)),X({status:"balances_saving",incomeCount:W,oldIncomeTotal:z,newIncomeTotal:L,expenseCount:H,oldExpenseTotal:Q,newExpenseTotal:ae}),X({status:"done",incomeCount:W,oldIncomeTotal:z,newIncomeTotal:L,expenseCount:H,oldExpenseTotal:Q,newExpenseTotal:ae})}catch(W){X({status:"error",error:W instanceof Error?W.message:"Failed to recalculate"})}finally{q(!1)}}return f.jsxs(ih,{children:[f.jsxs("nav",{style:rh,children:[f.jsx(Dt,{to:"/",children:" Back to Home"}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[f.jsx(Dt,{to:"/budget/analytics",style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 8%, transparent)",textDecoration:"none",fontSize:"1.25rem",transition:"background 0.15s"},title:"Analytics",children:""}),f.jsx(Dt,{to:"/budget/admin",style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 8%, transparent)",textDecoration:"none",fontSize:"1.25rem",transition:"background 0.15s"},title:_?"Admin Settings":"Budget Settings",children:""})]})]}),f.jsx(NN,{budgetName:m?.name,userCount:m?.user_ids.length,isOwner:_}),R&&f.jsx(pl,{message:R,onDismiss:()=>O(null)}),f.jsx(SN,{isLoading:A,onPreviousMonth:D,onNextMonth:V,onRecalculateAll:N,isRecomputing:F}),f.jsx(EN,{activeTab:C,setActiveTab:T,allocationsFinalized:w?.allocations_finalized}),C==="income"&&f.jsx(wN,{}),C==="allocations"&&f.jsx(RN,{}),C==="spend"&&f.jsx(AN,{}),C==="balances"&&f.jsx(IN,{}),f.jsx(MN,{isOpen:B,onClose:()=>{$(!1),X(null)},results:Y})]})}function NN({budgetName:t,userCount:e,isOwner:n}){return f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[f.jsx("h1",{style:{margin:0},children:"Budget"}),t&&f.jsx("span",{style:{background:`color-mix(in srgb, ${ye.primary} 15%, transparent)`,color:ye.primaryLight,padding:"0.25rem 0.75rem",borderRadius:"6px",fontSize:"0.85rem",fontWeight:500},children:t})]}),e!==void 0&&f.jsxs("p",{style:{opacity:.6,fontSize:"0.85rem",marginBottom:"1.5rem"},children:[e," user",e!==1?"s":""," ",n?" You are the owner":" Shared with you"]})]})}function PN(){return f.jsxs(ih,{children:[f.jsx("nav",{style:rh,children:f.jsx(Dt,{to:"/budget",children:" Back to Budget"})}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[f.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),f.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),f.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),f.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),f.jsx(Dt,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:ye.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})]})}function Ih({initialData:t,onSubmit:e,onCancel:n,submitLabel:s,accountGroups:o,showGroupSelector:l=!1,showIncomeSettings:c=!1,hasExistingIncomeDefault:p=!1,hasExistingOutgoDefault:h=!1,currentGroupId:m}){const[_,v]=j.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),E=_.account_group_id||m,w=E?o.find(B=>B.id===E):null,A=w?.is_active!==void 0,R=w?.on_budget!==void 0;function O(B){B.preventDefault(),_.nickname.trim()&&e(_)}function F(B){v({..._,is_income_account:B,is_income_default:B?_.is_income_default:!1})}function q(B){v({..._,is_outgo_account:B,is_outgo_default:B?_.is_outgo_default:!1})}return f.jsxs(Ua,{onSubmit:O,children:[f.jsx($t,{label:"Account Nickname",htmlFor:"account-nickname",children:f.jsx(Bi,{id:"account-nickname",type:"text",value:_.nickname,onChange:B=>v({..._,nickname:B.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&f.jsx($t,{label:"Account Type",htmlFor:"account-group",children:f.jsxs(ka,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:B=>v({..._,account_group_id:B.target.value==="ungrouped"?null:B.target.value}),children:[f.jsx("option",{value:"ungrouped",children:"Ungrouped"}),o.map(B=>f.jsx("option",{value:B.id,children:B.name},B.id))]})}),c&&f.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[f.jsx(Ro,{id:"is-active",checked:A?w.is_active:_.is_active!==!1,onChange:B=>v({..._,is_active:B.target.checked}),disabled:A,children:f.jsx("span",{style:{opacity:A?.5:1},children:"Active account"})}),A&&f.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ye.warning},children:['Set by account type "',w.name,'"']})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[f.jsx(Ro,{id:"on-budget",checked:R?w.on_budget:_.on_budget!==!1,onChange:B=>v({..._,on_budget:B.target.checked}),disabled:R,children:f.jsx("span",{style:{opacity:R?.5:1},children:"On budget (affects budget totals)"})}),R&&f.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ye.warning},children:['Set by account type "',w.name,'"']})]})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),f.jsx(Ro,{id:"is-income-account",checked:_.is_income_account||!1,onChange:B=>F(B.target.checked),children:"Show in income deposit list"}),_.is_income_account&&f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[f.jsx(Ro,{id:"is-income-default",checked:_.is_income_default||!1,onChange:B=>v({..._,is_income_default:B.target.checked}),disabled:p&&!t?.is_income_default,children:"Default account for new income"}),p&&!t?.is_income_default&&f.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),f.jsx(Ro,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:B=>q(B.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[f.jsx(Ro,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:B=>v({..._,is_outgo_default:B.target.checked}),disabled:h&&!t?.is_outgo_default,children:"Default account for new expenses"}),h&&!t?.is_outgo_default&&f.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),f.jsxs(Ys,{children:[f.jsx(Ne,{type:"submit",children:s}),f.jsx(Ne,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function nS({label:t,value:e,onChange:n,trueLabel:s,falseLabel:o,undefinedLabel:l}){function c(){n(e===void 0?!0:e===!0?!1:void 0)}const p=e===!0?s:e===!1?o:l,h=e===!0?ye.success:e===!1?ye.warning:"inherit",m=e===!0?"":e===!1?"":"";return f.jsxs("button",{type:"button",onClick:c,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${h} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${h} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[f.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?h:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:m}),f.jsxs("span",{style:{flex:1},children:[f.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",f.jsx("span",{style:{fontWeight:500,color:h},children:p})]}),f.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function _T({initialData:t,onSubmit:e,onCancel:n,submitLabel:s}){const[o,l]=j.useState(t||{name:"",expected_balance:"positive"});function c(p){p.preventDefault(),o.name.trim()&&e(o)}return f.jsxs(Ua,{onSubmit:c,children:[f.jsx($t,{label:"Account Type Name",htmlFor:"group-name",children:f.jsx(Bi,{id:"group-name",type:"text",value:o.name,onChange:p=>l({...o,name:p.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),f.jsx($t,{label:"Expected Balance",htmlFor:"expected-balance",children:f.jsxs(ka,{id:"expected-balance",value:o.expected_balance,onChange:p=>l({...o,expected_balance:p.target.value}),children:[f.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),f.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),f.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),f.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",f.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),f.jsx(nS,{label:"Active status",value:o.is_active,onChange:p=>l({...o,is_active:p}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),f.jsx(nS,{label:"Budget status",value:o.on_budget,onChange:p=>l({...o,on_budget:p}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),f.jsxs(Ys,{children:[f.jsx(Ne,{type:"submit",children:s}),f.jsx(Ne,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function Io({icon:t,label:e,variant:n,title:s}){const l={success:{background:`color-mix(in srgb, ${ye.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${ye.success} 40%, transparent)`,color:ye.success,opacity:1},warning:{background:`color-mix(in srgb, ${ye.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${ye.warning} 35%, transparent)`,color:ye.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${ye.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ye.success} 25%, transparent)`,color:ye.success,opacity:.7},expense:{background:`color-mix(in srgb, ${ye.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ye.warning} 25%, transparent)`,color:ye.warning,opacity:.7}}[n];return f.jsxs("span",{title:s||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[f.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function vT({account:t,accountGroups:e}){const n=[],s=t.account_group_id?e.find(c=>c.id===t.account_group_id):null,o=s?.is_active!==void 0?s.is_active:t.is_active!==!1,l=s?.on_budget!==void 0?s.on_budget:t.on_budget!==!1;if(!o){const c=s?.is_active!==void 0;n.push(f.jsx(Io,{icon:"",label:c?"Inactive (type)":"Inactive",variant:"warning",title:c?`Set by "${s.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const c=s?.on_budget!==void 0;n.push(f.jsx(Io,{icon:"",label:c?"Off Budget (type)":"Off Budget",variant:"warning",title:c?`Set by "${s.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(f.jsx(Io,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(f.jsx(Io,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(f.jsx(Io,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(f.jsx(Io,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:f.jsx(f.Fragment,{children:n})}function VN({group:t}){const e=[];return t.is_active===!1?e.push(f.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ye.warning} 20%, transparent)`,color:ye.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(f.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ye.success} 20%, transparent)`,color:ye.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(f.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ye.warning} 20%, transparent)`,color:ye.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(f.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ye.success} 20%, transparent)`,color:ye.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:f.jsx(f.Fragment,{children:e})}function bT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:s}){return f.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:s,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[f.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ye.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&f.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function LN(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function UN(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function zN({group:t,groupIndex:e,totalGroups:n,accounts:s,allGroups:o,allAccounts:l,editingAccountId:c,editingGroupId:p,createForGroupId:h,setEditingAccountId:m,setEditingGroupId:_,setCreateForGroupId:v,dragType:E,draggedId:w,dragOverId:A,dragOverGroupId:R,setDragOverId:O,setDragOverGroupId:F,onAccountDragStart:q,onAccountDragOver:B,onAccountDrop:$,onGroupDragStart:Y,onGroupDragOver:X,onGroupDrop:C,onDragLeave:T,onDragLeaveGroup:I,onDragEnd:k,onDropOnGroup:D,onCreateAccount:V,onUpdateAccount:N,onDeleteAccount:W,onMoveAccount:z,onUpdateGroup:L,onDeleteGroup:H,onMoveGroup:Q}){const ae=$s(),ce=[...s].sort((Z,Re)=>Z.sort_order-Re.sort_order),U=E==="group"&&w===t.id,te=E==="group"&&A===t.id,be=E==="account"&&R===t.id,fe=(w&&E==="account"?l[w]:null)&&Object.entries(l).find(([Z])=>Z===w)?.[1]&&Object.entries(l).find(([Z])=>Z===w)?.[1]?.account_group_id!==t.id,Ee=E==="group"&&te&&w!==t.id,we=e>0,ge=e<n-1,de=ce.reduce((Z,Re)=>Z+Re.balance,0);return f.jsxs("div",{children:[E==="group"&&!U&&f.jsxs("div",{onDragOver:Z=>{Z.preventDefault(),O(t.id)},onDragLeave:T,onDrop:Z=>C(Z,t.id),style:{position:"relative",height:Ee?"2.5rem":"0.5rem",marginBottom:Ee?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[f.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ye.primary,borderRadius:"2px",opacity:Ee?1:0,transition:"opacity 0.15s",boxShadow:Ee?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),Ee&&f.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),f.jsx("div",{draggable:p!==t.id,onDragStart:Z=>Y(Z,t.id),onDragOver:Z=>X(Z,t.id),onDragLeave:I,onDragEnd:k,onDrop:Z=>D(Z,t.id),style:{background:U?"color-mix(in srgb, currentColor 3%, transparent)":be&&fe?`color-mix(in srgb, ${ye.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:U?.5:1,border:be&&fe?`2px dashed ${ye.primary}`:"2px solid transparent",cursor:p===t.id?"default":"grab",transition:"all 0.15s"},children:p===t.id?f.jsx(_T,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:Z=>L(t.id,Z),onCancel:()=>_(null),submitLabel:"Save"}):f.jsxs(f.Fragment,{children:[f.jsx(BN,{group:t,accountCount:ce.length,groupTotal:de,canMoveUp:we,canMoveDown:ge,isMobile:ae,createForGroupId:h,onEdit:()=>_(t.id),onDelete:()=>H(t.id),onMoveUp:()=>Q(t.id,"up"),onMoveDown:()=>Q(t.id,"down"),onAddAccount:()=>v(t.id)}),ae&&f.jsx("div",{style:{marginBottom:"0.5rem"},children:f.jsx(Ne,{variant:"small",onClick:()=>v(t.id),disabled:h!==null,children:"+ Account"})}),f.jsxs("div",{style:Hs,children:[ce.map((Z,Re)=>c===Z.id?f.jsx(Ih,{initialData:{nickname:Z.nickname,account_group_id:Z.account_group_id,is_income_account:Z.is_income_account,is_income_default:Z.is_income_default,is_outgo_account:Z.is_outgo_account,is_outgo_default:Z.is_outgo_default,on_budget:Z.on_budget,is_active:Z.is_active},onSubmit:xe=>N(Z.id,xe),onCancel:()=>m(null),submitLabel:"Save",accountGroups:o,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:Z.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([xe,Qe])=>Qe.is_income_default&&xe!==Z.id),hasExistingOutgoDefault:Object.entries(l).some(([xe,Qe])=>Qe.is_outgo_default&&xe!==Z.id)},Z.id):f.jsx(of,{isDragging:E==="account"&&w===Z.id,isDragOver:A===Z.id,onDragStart:xe=>{xe.stopPropagation(),q(xe,Z.id)},onDragOver:xe=>B(xe,Z.id,t.id),onDragLeave:T,onDragEnd:k,onDrop:xe=>$(xe,Z.id,t.id),onEdit:()=>m(Z.id),onDelete:()=>W(Z.id),onMoveUp:()=>z(Z.id,"up"),onMoveDown:()=>z(Z.id,"down"),canMoveUp:Re>0,canMoveDown:Re<ce.length-1,children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[f.jsx("span",{style:Sy,children:Z.nickname}),f.jsx(vT,{account:Z,accountGroups:o})]}),f.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:xn(Z.balance)},children:[Ke(Z.balance),LN(Z.balance,t.expected_balance)&&f.jsx("span",{title:UN(Z.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},Z.id)),ce.length===0&&!h&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),E==="account"&&ce.length>0&&f.jsx(bT,{groupId:t.id,isActive:A===`__end__${t.id}`,onDragOver:Z=>{Z.preventDefault(),Z.stopPropagation(),O(`__end__${t.id}`),F(t.id)},onDragLeave:Z=>{Z.stopPropagation(),O(null)},onDrop:Z=>{Z.stopPropagation(),$(Z,"__group_end__",t.id)}}),h===t.id&&f.jsx(Ih,{initialData:{nickname:"",account_group_id:t.id},onSubmit:Z=>V(Z,t.id),onCancel:()=>v(null),submitLabel:"Create",accountGroups:o,showIncomeSettings:!0,currentGroupId:t.id})]}),h!==t.id&&f.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:f.jsx(Ne,{variant:"small",onClick:()=>v(t.id),disabled:h!==null,children:"+ Add Account"})})]})})]})}function BN({group:t,accountCount:e,groupTotal:n,canMoveUp:s,canMoveDown:o,isMobile:l,createForGroupId:c,onEdit:p,onDelete:h,onMoveUp:m,onMoveDown:_,onAddAccount:v}){return f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[f.jsxs("h3",{style:{...ml,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&f.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),f.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),f.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),f.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:xn(n),flexShrink:0},children:Ke(n)}),f.jsx(VN,{group:t})]}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&f.jsx(Ne,{variant:"small",onClick:v,disabled:c!==null,children:"+ Account"}),f.jsx("button",{onClick:p,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),f.jsx("button",{onClick:h,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),f.jsxs("div",{style:Ey,children:[f.jsx("button",{onClick:m,disabled:!s,style:{...Xo,opacity:s?.6:.2,cursor:s?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),f.jsx("button",{onClick:_,disabled:!o,style:{...Xo,opacity:o?.6:.2,cursor:o?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function FN({accounts:t,allGroups:e,allAccounts:n,hasGroups:s,editingAccountId:o,createForGroupId:l,setEditingAccountId:c,setCreateForGroupId:p,dragType:h,draggedId:m,dragOverId:_,dragOverGroupId:v,setDragOverId:E,setDragOverGroupId:w,onAccountDragStart:A,onAccountDragOver:R,onAccountDrop:O,onDragOverGroup:F,onDropOnGroup:q,onDragLeave:B,onDragLeaveGroup:$,onDragEnd:Y,onCreateAccount:X,onUpdateAccount:C,onDeleteAccount:T,onMoveAccount:I}){const k=[...t].sort((z,L)=>z.sort_order-L.sort_order),D=h==="account"&&v==="ungrouped",N=(m&&h==="account"?n[m]:null)&&Object.entries(n).find(([z])=>z===m)?.[1]&&Object.entries(n).find(([z])=>z===m)?.[1]?.account_group_id!==null;if(k.length===0&&!l&&s&&h!=="account")return null;const W=k.reduce((z,L)=>z+L.balance,0);return f.jsxs("div",{onDragOver:z=>F(z,"ungrouped"),onDragLeave:$,onDrop:z=>q(z,"ungrouped"),style:{background:D&&N?`color-mix(in srgb, ${ye.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:D&&N?`2px dashed ${ye.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("h3",{style:{...ml,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",f.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",k.length,")"]}),k.length>0&&f.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:xn(W)},children:Ke(W)})]}),f.jsx(Ne,{variant:"small",onClick:()=>p("ungrouped"),disabled:l!==null,children:"+ Account"})]}),f.jsxs("div",{style:Hs,children:[k.map((z,L)=>o===z.id?f.jsx(Ih,{initialData:{nickname:z.nickname,account_group_id:z.account_group_id,is_income_account:z.is_income_account,is_income_default:z.is_income_default,is_outgo_account:z.is_outgo_account,is_outgo_default:z.is_outgo_default,on_budget:z.on_budget,is_active:z.is_active},onSubmit:H=>C(z.id,H),onCancel:()=>c(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([H,Q])=>Q.is_income_default&&H!==z.id),hasExistingOutgoDefault:Object.entries(n).some(([H,Q])=>Q.is_outgo_default&&H!==z.id)},z.id):f.jsx(of,{isDragging:h==="account"&&m===z.id,isDragOver:_===z.id,onDragStart:H=>A(H,z.id),onDragOver:H=>R(H,z.id,"ungrouped"),onDragLeave:B,onDragEnd:Y,onDrop:H=>O(H,z.id,"ungrouped"),onEdit:()=>c(z.id),onDelete:()=>T(z.id),onMoveUp:()=>I(z.id,"up"),onMoveDown:()=>I(z.id,"down"),canMoveUp:L>0,canMoveDown:L<k.length-1,children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[f.jsx("span",{style:Sy,children:z.nickname}),f.jsx(vT,{account:z,accountGroups:e})]}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:xn(z.balance)},children:Ke(z.balance)})]})},z.id)),k.length===0&&h==="account"&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),h==="account"&&k.length>0&&f.jsx(bT,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:z=>{z.preventDefault(),z.stopPropagation(),E("__end__ungrouped"),w("ungrouped")},onDragLeave:z=>{z.stopPropagation(),E(null)},onDrop:z=>{z.stopPropagation(),O(z,"__group_end__","ungrouped")}}),l==="ungrouped"&&f.jsx(Ih,{initialData:{nickname:"",account_group_id:null},onSubmit:z=>X(z,"ungrouped"),onCancel:()=>p(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&f.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:f.jsx(Ne,{variant:"small",onClick:()=>p("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function qN(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:s,error:o,setError:l,handleCreateAccount:c,handleUpdateAccount:p,handleDeleteAccount:h,handleMoveAccount:m,handleCreateGroup:_,handleUpdateGroup:v,handleDeleteGroup:E,handleMoveGroup:w,reorderAccountsInGroup:A,reorderGroups:R}=Hk(),O=$s(),[F,q]=j.useState(null),[B,$]=j.useState(null),[Y,X]=j.useState(null),[C,T]=j.useState(!1),[I,k]=j.useState(null),[D,V]=j.useState(null),[N,W]=j.useState(null),[z,L]=j.useState(null);function H(ge,de){k("account"),V(de),ge.dataTransfer.effectAllowed="move"}function Q(ge,de,Z){ge.preventDefault(),I==="account"&&(de!==D&&W(de),L(Z))}function ae(ge,de){ge.preventDefault(),I==="account"?(L(de),W(null)):I==="group"&&de!==D&&W(de)}function ce(){W(null)}function U(){L(null)}function te(){k(null),V(null),W(null),L(null)}async function be(ge,de,Z){if(ge.preventDefault(),ge.stopPropagation(),!D||I!=="account"){te();return}await A(D,de,Z),te()}async function _e(ge,de){ge.preventDefault(),I==="account"?await be(ge,"__group_end__",de):I==="group"&&await Ee(ge,de)}function fe(ge,de){ge.stopPropagation(),k("group"),V(de),ge.dataTransfer.effectAllowed="move"}async function Ee(ge,de){if(ge.preventDefault(),!D||I!=="group"||D===de){te();return}await R(D,de),te()}if(!s)return f.jsx("p",{children:"No budget found. Please log in."});const we=e.ungrouped||[];return f.jsxs("div",{children:[f.jsx("h2",{style:{marginTop:0},children:"Accounts"}),f.jsxs("p",{style:af,children:["Organize your financial accounts by type.",f.jsx("br",{}),f.jsx("span",{style:{fontSize:"0.9rem"},children:O?"Use  buttons to reorder items, or drag to move between types.":"Drag accounts between types, or use  buttons to reorder."})]}),o&&f.jsx(pl,{message:o,onDismiss:()=>l(null)}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(t).length===0&&n.length===0&&f.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((ge,de)=>f.jsx(zN,{group:ge,groupIndex:de,totalGroups:n.length,accounts:e[ge.id]||[],allGroups:n,allAccounts:t,editingAccountId:F,editingGroupId:Y,createForGroupId:B,setEditingAccountId:q,setEditingGroupId:X,setCreateForGroupId:$,dragType:I,draggedId:D,dragOverId:N,dragOverGroupId:z,setDragOverId:W,setDragOverGroupId:L,onAccountDragStart:H,onAccountDragOver:Q,onAccountDrop:be,onGroupDragStart:fe,onGroupDragOver:ae,onGroupDrop:Ee,onDragLeave:ce,onDragLeaveGroup:U,onDragEnd:te,onDropOnGroup:_e,onCreateAccount:c,onUpdateAccount:(Z,Re)=>{p(Z,Re),q(null)},onDeleteAccount:h,onMoveAccount:m,onUpdateGroup:(Z,Re)=>{v(Z,Re),X(null)},onDeleteGroup:E,onMoveGroup:w},ge.id)),I==="group"&&n.length>0&&f.jsx(Ty,{isActive:N==="__end__",onDragOver:ge=>{ge.preventDefault(),W("__end__")},onDragLeave:ce,onDrop:ge=>Ee(ge,"__end__"),label:"Move account type to end"}),f.jsx(FN,{accounts:we,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:F,createForGroupId:B,setEditingAccountId:q,setCreateForGroupId:$,dragType:I,draggedId:D,dragOverId:N,dragOverGroupId:z,setDragOverId:W,setDragOverGroupId:L,onAccountDragStart:H,onAccountDragOver:Q,onAccountDrop:be,onDragOverGroup:ae,onDropOnGroup:_e,onDragLeave:ce,onDragLeaveGroup:U,onDragEnd:te,onCreateAccount:c,onUpdateAccount:(ge,de)=>{p(ge,de),q(null)},onDeleteAccount:h,onMoveAccount:m})]}),C?f.jsx(_T,{onSubmit:ge=>{_(ge),T(!1)},onCancel:()=>T(!1),submitLabel:"Create Account Type"}):f.jsx(Ne,{variant:"primary-large",onClick:()=>T(!0),children:"+ Add Account Type"})]})}function Oh({initialData:t,onSubmit:e,onCancel:n,submitLabel:s,categoryGroups:o=[],showGroupSelector:l=!1}){const[c,p]=j.useState(t||{name:"",category_group_id:null}),[h,m]=j.useState(t?.default_monthly_amount?.toString()||""),[_,v]=j.useState(t?.default_monthly_type||"fixed"),[E,w]=j.useState(!1);function A(R){if(R.preventDefault(),!c.name.trim())return;w(!0);const O=parseFloat(h),F=!isNaN(O)&&O>0;e({...c,description:c.description?.trim()||void 0,default_monthly_amount:F?O:void 0,default_monthly_type:F?_:void 0})}return f.jsxs(Ua,{onSubmit:A,children:[f.jsx($t,{label:"Category Name",htmlFor:"category-name",children:f.jsx(Bi,{id:"category-name",type:"text",value:c.name,onChange:R=>p({...c,name:R.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),f.jsx($t,{label:"Description (optional)",htmlFor:"category-description",children:f.jsx(xy,{id:"category-description",value:c.description||"",onChange:R=>p({...c,description:R.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&f.jsx($t,{label:"Category Group",htmlFor:"category-group",children:f.jsxs(ka,{id:"category-group",value:c.category_group_id||"ungrouped",onChange:R=>p({...c,category_group_id:R.target.value==="ungrouped"?null:R.target.value}),children:[f.jsx("option",{value:"ungrouped",children:"Uncategorized"}),o.map(R=>f.jsx("option",{value:R.id,children:R.name},R.id))]})}),f.jsxs($t,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[f.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[f.jsxs(ka,{id:"default-type",value:_,onChange:R=>v(R.target.value),style:{width:"auto",flex:"0 0 auto"},children:[f.jsx("option",{value:"fixed",children:"Fixed $"}),f.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?f.jsx(wy,{id:"default-amount",value:h,onChange:m,placeholder:"$0.00"}):f.jsx(Bi,{id:"default-amount",type:"number",value:h,onChange:R=>m(R.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&f.jsx("span",{style:{opacity:.6},children:"%"})]}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),f.jsxs(Ys,{children:[f.jsx(Ne,{type:"submit",isLoading:E,children:s}),f.jsx(Ne,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function ET({initialData:t,onSubmit:e,onCancel:n,submitLabel:s}){const[o,l]=j.useState(t||{name:""}),[c,p]=j.useState(!1);function h(m){m.preventDefault(),o.name.trim()&&(p(!0),e(o))}return f.jsxs(Ua,{onSubmit:h,children:[f.jsx($t,{label:"Group Name",htmlFor:"group-name",children:f.jsx(Bi,{id:"group-name",type:"text",value:o.name,onChange:m=>l({...o,name:m.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),f.jsxs(Ys,{children:[f.jsx(Ne,{type:"submit",isLoading:c,children:s}),f.jsx(Ne,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function ST({isActive:t,onDragOver:e,onDragLeave:n,onDrop:s}){return f.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:s,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[f.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ye.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&f.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function HN({group:t,groupIndex:e,groupCategories:n,sortedGroups:s,categoryGroups:o,categoryBalances:l,loadingBalances:c,dragType:p,draggedId:h,dragOverId:m,dragOverGroupId:_,editingCategoryId:v,setEditingCategoryId:E,createForGroupId:w,setCreateForGroupId:A,editingGroupId:R,setEditingGroupId:O,handleCreateCategory:F,handleUpdateCategory:q,handleDeleteCategory:B,handleMoveCategory:$,handleUpdateGroup:Y,handleDeleteGroup:X,handleMoveGroup:C,handleCategoryDragStart:T,handleCategoryDragOver:I,handleDragOverGroup:k,handleDragLeave:D,handleDragLeaveGroup:V,handleDragEnd:N,handleCategoryDrop:W,handleDropOnGroup:z,handleGroupDragStart:L,handleGroupDrop:H,setDragOverId:Q,setDragOverGroupId:ae,isMobile:ce,categories:U}){const te=p==="group"&&h===t.id,be=p==="group"&&m===t.id,_e=p==="category"&&_===t.id,fe=h&&p==="category"?U[h]:null,Ee=fe&&(fe.category_group_id||"ungrouped")!==t.id,we=p==="group"&&be&&h!==t.id,ge=e>0,de=e<s.length-1;return f.jsxs("div",{children:[p==="group"&&!te&&f.jsxs("div",{onDragOver:Z=>{Z.preventDefault(),Q(t.id)},onDragLeave:D,onDrop:Z=>H(Z,t.id),style:{position:"relative",height:we?"2.5rem":"0.5rem",marginBottom:we?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[f.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ye.primary,borderRadius:"2px",opacity:we?1:0,transition:"opacity 0.15s",boxShadow:we?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),we&&f.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),f.jsx("div",{onDragOver:Z=>k(Z,t.id),onDragLeave:V,onDrop:Z=>z(Z,t.id),style:{background:te?"color-mix(in srgb, currentColor 3%, transparent)":_e&&Ee?`color-mix(in srgb, ${ye.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:te?.5:1,border:_e&&Ee?`2px dashed ${ye.primary}`:"2px solid transparent",transition:"all 0.15s"},children:R===t.id?f.jsx(ET,{initialData:{name:t.name},onSubmit:Z=>Y(t.id,Z),onCancel:()=>O(null),submitLabel:"Save"}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:ce?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:ce?"wrap":"nowrap"},children:[f.jsxs("h3",{style:{...ml,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!ce&&f.jsx("span",{draggable:!0,onDragStart:Z=>L(Z,t.id),onDragEnd:N,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),f.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),f.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",n.length,")"]})]}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!ce&&f.jsx(Ne,{variant:"small",onClick:()=>A(t.id),disabled:w!==null,children:"+ Category"}),f.jsx("button",{onClick:()=>O(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),f.jsx("button",{onClick:()=>X(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),f.jsxs("div",{style:Ey,children:[f.jsx("button",{onClick:()=>C(t.id,"up"),disabled:!ge,style:{...Xo,opacity:ge?.6:.2,cursor:ge?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),f.jsx("button",{onClick:()=>C(t.id,"down"),disabled:!de,style:{...Xo,opacity:de?.6:.2,cursor:de?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),ce&&f.jsx("div",{style:{marginBottom:"0.5rem"},children:f.jsx(Ne,{variant:"small",onClick:()=>A(t.id),disabled:w!==null,children:"+ Category"})}),f.jsxs("div",{style:Hs,children:[n.map(([Z,Re])=>v===Z?f.jsx(Oh,{initialData:{name:Re.name,description:Re.description,category_group_id:Re.category_group_id,default_monthly_amount:Re.default_monthly_amount,default_monthly_type:Re.default_monthly_type},onSubmit:xe=>q(Z,xe),onCancel:()=>E(null),submitLabel:"Save",categoryGroups:o,showGroupSelector:!0},Z):f.jsx(of,{isDragging:p==="category"&&h===Z,isDragOver:m===Z,onDragStart:xe=>{xe.stopPropagation(),T(xe,Z)},onDragOver:xe=>I(xe,Z,t.id),onDragLeave:D,onDragEnd:N,onDrop:xe=>W(xe,Z,t.id),onEdit:()=>E(Z),onDelete:()=>B(Z),onMoveUp:()=>$(Z,"up"),onMoveDown:()=>$(Z,"down"),canMoveUp:n.findIndex(([xe])=>xe===Z)>0,canMoveDown:n.findIndex(([xe])=>xe===Z)<n.length-1,children:f.jsx(xT,{category:Re,catId:Z,categoryBalances:l,loadingBalances:c})},Z)),n.length===0&&!w&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),p==="category"&&n.length>0&&f.jsx(ST,{groupId:t.id,isActive:m===`__end__${t.id}`,onDragOver:Z=>{Z.preventDefault(),Z.stopPropagation(),Q(`__end__${t.id}`),ae(t.id)},onDragLeave:Z=>{Z.stopPropagation(),Q(null)},onDrop:Z=>{Z.stopPropagation(),W(Z,"__group_end__",t.id)}}),w===t.id&&f.jsx(Oh,{initialData:{name:"",category_group_id:t.id},onSubmit:Z=>F(Z,t.id),onCancel:()=>A(null),submitLabel:"Create",categoryGroups:o})]}),w!==t.id&&f.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:f.jsx(Ne,{variant:"small",onClick:()=>A(t.id),disabled:w!==null,children:"+ Add Category"})})]})})]})}function xT({category:t,catId:e,categoryBalances:n,loadingBalances:s}){return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[f.jsx("span",{style:Sy,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&f.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?f.jsxs(f.Fragment,{children:[f.jsxs("span",{style:{color:ye.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):f.jsxs(f.Fragment,{children:[f.jsx("span",{style:{color:ye.success,fontWeight:500},children:Ke(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1rem",fontWeight:600,color:xn(n[e]||0)},children:s?"...":Ke(n[e]||0)})]})}function GN({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:s,dragType:o,draggedId:l,dragOverId:c,dragOverGroupId:p,editingCategoryId:h,setEditingCategoryId:m,createForGroupId:_,setCreateForGroupId:v,handleCreateCategory:E,handleUpdateCategory:w,handleDeleteCategory:A,handleMoveCategory:R,handleCategoryDragStart:O,handleCategoryDragOver:F,handleDragOverGroup:q,handleDragLeaveGroup:B,handleDragLeave:$,handleDragEnd:Y,handleCategoryDrop:X,handleDropOnGroup:C,setDragOverId:T,setDragOverGroupId:I,categories:k,hasGroups:D}){const V=o==="category"&&p==="ungrouped",N=l&&o==="category"?k[l]:null,W=N&&N.category_group_id!==null;return t.length===0&&!_&&D&&o!=="category"?null:f.jsxs("div",{onDragOver:z=>q(z,"ungrouped"),onDragLeave:B,onDrop:z=>C(z,"ungrouped"),style:{background:V&&W?`color-mix(in srgb, ${ye.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:V&&W?`2px dashed ${ye.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("h3",{style:{...ml,margin:0,opacity:.7},children:["Uncategorized",f.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),f.jsx(Ne,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Category"})]}),f.jsxs("div",{style:Hs,children:[t.map(([z,L])=>h===z?f.jsx(Oh,{initialData:{name:L.name,description:L.description,category_group_id:L.category_group_id,default_monthly_amount:L.default_monthly_amount,default_monthly_type:L.default_monthly_type},onSubmit:H=>w(z,H),onCancel:()=>m(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},z):f.jsx(of,{isDragging:o==="category"&&l===z,isDragOver:c===z,onDragStart:H=>O(H,z),onDragOver:H=>F(H,z,"ungrouped"),onDragLeave:$,onDragEnd:Y,onDrop:H=>X(H,z,"ungrouped"),onEdit:()=>m(z),onDelete:()=>A(z),onMoveUp:()=>R(z,"up"),onMoveDown:()=>R(z,"down"),canMoveUp:t.findIndex(([H])=>H===z)>0,canMoveDown:t.findIndex(([H])=>H===z)<t.length-1,children:f.jsx(xT,{category:L,catId:z,categoryBalances:n,loadingBalances:s})},z)),t.length===0&&o==="category"&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),o==="category"&&t.length>0&&f.jsx(ST,{groupId:"ungrouped",isActive:c==="__end__ungrouped",onDragOver:z=>{z.preventDefault(),z.stopPropagation(),T("__end__ungrouped"),I("ungrouped")},onDragLeave:z=>{z.stopPropagation(),T(null)},onDrop:z=>{z.stopPropagation(),X(z,"__group_end__","ungrouped")}}),_==="ungrouped"&&f.jsx(Oh,{initialData:{name:"",category_group_id:null},onSubmit:z=>E(z,"ungrouped"),onCancel:()=>v(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&f.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:f.jsx(Ne,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function QN(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:s,sortedGroups:o,categoryBalances:l,loadingBalances:c,error:p,setError:h,getOnBudgetTotal:m,handleCreateCategory:_,handleUpdateCategory:v,handleDeleteCategory:E,handleMoveCategory:w,handleCreateGroup:A,handleUpdateGroup:R,handleDeleteGroup:O,handleMoveGroup:F,dragType:q,draggedId:B,dragOverId:$,dragOverGroupId:Y,setDragOverId:X,setDragOverGroupId:C,handleCategoryDragStart:T,handleCategoryDragOver:I,handleDragOverGroup:k,handleDragLeave:D,handleDragLeaveGroup:V,handleDragEnd:N,handleCategoryDrop:W,handleDropOnGroup:z,handleGroupDragStart:L,handleGroupDrop:H}=Qk(),Q=$s(),[ae,ce]=j.useState(null),[U,te]=j.useState(null),[be,_e]=j.useState(null),[fe,Ee]=j.useState(!1),[we,ge]=j.useState(!1),[de,Z]=j.useState(!1),Re=null;return t?f.jsxs("div",{children:[f.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),f.jsxs("p",{style:af,children:["Organize your spending categories into groups.",f.jsx("br",{}),f.jsx("span",{style:{fontSize:"0.9rem"},children:Q?"Use  buttons to reorder items, or drag to move between groups.":"Drag categories between groups, or use  buttons to reorder."})]}),p&&f.jsx(pl,{message:p,onDismiss:()=>h(null)}),Re,f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem",gap:"0.5rem"},children:[f.jsx("button",{onClick:async()=>{ge(!0);try{console.warn("[Categories] checkCategoryBalanceMismatch not yet implemented")}finally{ge(!1)}},disabled:we,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.85rem",cursor:we?"not-allowed":"pointer",opacity:we?.6:1},title:"Check if category balances match allocation/expense history",children:we?" Checking...":" Check Balances"}),f.jsx("button",{onClick:async()=>{Z(!0);try{console.warn("[Categories] recalculateAndSaveCategoryBalances not yet implemented")}catch(xe){h(xe instanceof Error?xe.message:"Failed to reconcile")}finally{Z(!1)}},disabled:de,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.85rem",cursor:de?"not-allowed":"pointer",opacity:de?.6:1},title:"Recalculate all category balances from allocation/expense history",children:de?" Reconciling...":" Reconcile All"})]}),f.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[f.jsxs(Wn,{style:{flex:1,minWidth:"120px"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Categories"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:Object.keys(e).length})]}),f.jsxs(Wn,{style:{flex:1,minWidth:"120px"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Groups"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:n.length})]}),f.jsxs(Wn,{style:{flex:1,minWidth:"120px"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"On-Budget"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:xn(m())},children:Ke(m())})]}),f.jsxs(Wn,{style:{flex:1,minWidth:"120px"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Allocated"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:ye.primary},children:c?"...":Ke(Object.values(l).reduce((xe,Qe)=>xe+Qe,0))})]}),f.jsxs(Wn,{style:{flex:1,minWidth:"120px"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Available"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:xn(m()-Object.values(l).reduce((xe,Qe)=>xe+Qe,0))},children:c?"...":Ke(m()-Object.values(l).reduce((xe,Qe)=>xe+Qe,0))})]})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(e).length===0&&n.length===0&&f.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),o.map((xe,Qe)=>{const Ge=(s[xe.id]||[]).sort((nt,ze)=>nt[1].sort_order-ze[1].sort_order);return f.jsx(HN,{group:xe,groupIndex:Qe,groupCategories:Ge,sortedGroups:o,categoryGroups:n,categoryBalances:l,loadingBalances:c,dragType:q,draggedId:B,dragOverId:$,dragOverGroupId:Y,editingCategoryId:ae,setEditingCategoryId:ce,createForGroupId:U,setCreateForGroupId:te,editingGroupId:be,setEditingGroupId:_e,handleCreateCategory:_,handleUpdateCategory:v,handleDeleteCategory:E,handleMoveCategory:w,handleUpdateGroup:R,handleDeleteGroup:O,handleMoveGroup:F,handleCategoryDragStart:T,handleCategoryDragOver:I,handleDragOverGroup:k,handleDragLeave:D,handleDragLeaveGroup:V,handleDragEnd:N,handleCategoryDrop:W,handleDropOnGroup:z,handleGroupDragStart:L,handleGroupDrop:H,setDragOverId:X,setDragOverGroupId:C,isMobile:Q,categories:e},xe.id)}),q==="group"&&o.length>0&&f.jsx(Ty,{isActive:$==="__end__",onDragOver:xe=>{xe.preventDefault(),X("__end__")},onDragLeave:D,onDrop:xe=>H(xe,"__end__"),label:"Move group to end"}),f.jsx(GN,{ungroupedCategories:(s.ungrouped||[]).sort((xe,Qe)=>xe[1].sort_order-Qe[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:c,dragType:q,draggedId:B,dragOverId:$,dragOverGroupId:Y,editingCategoryId:ae,setEditingCategoryId:ce,createForGroupId:U,setCreateForGroupId:te,handleCreateCategory:_,handleUpdateCategory:v,handleDeleteCategory:E,handleMoveCategory:w,handleCategoryDragStart:T,handleCategoryDragOver:I,handleDragOverGroup:k,handleDragLeaveGroup:V,handleDragLeave:D,handleDragEnd:N,handleCategoryDrop:W,handleDropOnGroup:z,setDragOverId:X,setDragOverGroupId:C,categories:e,hasGroups:n.length>0})]}),fe?f.jsx(ET,{onSubmit:xe=>{A(xe),Ee(!1)},onCancel:()=>Ee(!1),submitLabel:"Create Group"}):f.jsx(Ne,{variant:"primary-large",onClick:()=>Ee(!0),children:"+ Add Category Group"})]}):f.jsx("p",{children:"No budget found. Please log in."})}function KN(){const{selectedBudgetId:t,currentUserId:e,isAdmin:n,isTest:s}=An(),{budget:o,accounts:l,accountGroups:c,categories:p,categoryGroups:h,isOwner:m,isLoading:_}=zn(t,e),v=pr(),E=v.pathname==="/budget/admin",w=j.useMemo(()=>{const C=v.pathname;return C.includes("/admin/accounts")?"accounts":C.includes("/admin/categories")?"categories":C.includes("/admin/users")?"users":C.includes("/admin/migration")?"migration":C.includes("/admin/feedback")?"feedback":C.includes("/admin/tests")?"tests":(C.includes("/admin/my-budgets"),"my-budgets")},[v.pathname]),A=w==="users",R=w==="migration",O=w==="feedback",F=w==="tests";j.useEffect(()=>{E||localStorage.setItem(XE,w)},[w,E]);function q(){const C=localStorage.getItem(XE);return!(C&&qk.includes(C))||C==="users"&&!m||(C==="migration"||C==="feedback")&&!n||C==="tests"&&!s?"my-budgets":C}const B=j.useMemo(()=>[{id:"my-budgets",label:"My Budgets",icon:""},{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!m},{id:"migration",label:"Migration",icon:"",hidden:!n},{id:"feedback",label:"Feedback",icon:"",hidden:!n},{id:"tests",label:"Tests",icon:"",hidden:!s}],[m,n,s]);if(_)return f.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:f.jsx("p",{children:"Loading..."})});const $=A,Y=R||O,X=F;return!m&&$||!n&&Y||!s&&X?f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("nav",{style:{marginBottom:"1.5rem"},children:f.jsx(Dt,{to:"/budget",children:" Back to Budget"})}),f.jsx("h1",{children:"Access Denied"}),f.jsx("p",{style:{opacity:.7},children:X?"Only test users can access this section.":Y?"Only administrators can access this section.":"Only the budget owner can access this section."}),f.jsx("p",{style:{marginTop:"1rem"},children:f.jsx(Dt,{to:"/budget/admin/my-budgets",style:{color:"#646cff"},children:"Go to My Budgets "})})]}):f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("nav",{style:{marginBottom:"1.5rem"},children:f.jsx(Dt,{to:"/budget",children:" Back to Budget"})}),f.jsx("h1",{children:m?"Admin Settings":"Budget Settings"}),f.jsx("p",{style:{opacity:.7,marginBottom:"0.5rem"},children:m?"Manage your budget settings, users, and data migration.":"Manage your budgets, accounts, and categories."}),o&&f.jsxs("div",{style:{opacity:.6,marginBottom:"1.5rem",fontSize:"0.9rem",display:"flex",flexDirection:"column",gap:"0.25rem"},children:[f.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""}),f.jsxs("span",{children:["Budget Name: ",f.jsx("strong",{style:{opacity:1},children:o.name})]})]}),f.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""}),f.jsxs("span",{children:["Budget ID: ",f.jsx("code",{style:{opacity:1,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.1rem 0.4rem",borderRadius:"4px",fontSize:"0.85rem"},children:o.id})]})]}),f.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""}),f.jsxs("span",{children:["Budget Owner: ",f.jsx("strong",{style:{opacity:1},children:o.owner_email||o.owner_id})]})]}),n&&f.jsx("button",{onClick:()=>{const C={...o,accounts:l,account_groups:c,categories:p,category_groups:h,_meta:{downloaded_at:new Date().toISOString()}},T=new Blob([JSON.stringify(C,null,2)],{type:"application/json"}),I=URL.createObjectURL(T),k=document.createElement("a");k.href=I,k.download=`budget_${o.id}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(I)},style:{marginTop:"0.5rem",display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",opacity:1,transition:"background 0.15s",alignSelf:"flex-start"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]}),f.jsx("div",{style:{borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",paddingBottom:"0.5rem",marginBottom:"0.5rem"},children:f.jsx(yT,{mode:"link",linkPrefix:"/budget/admin",tabs:B,activeTab:w})}),E?f.jsx(vS,{to:`/budget/admin/${q()}`,replace:!0}):f.jsx(bg,{})]})}function $N(){const{selectedBudgetId:t,currentUserId:e}=An(),{budget:n,budgetUserIds:s,acceptedUserIds:o,inviteUser:l,revokeUser:c}=zn(t,e),[p,h]=j.useState(""),[m,_]=j.useState(!1),[v,E]=j.useState(null),[w,A]=j.useState(null);if(!n)return f.jsx("p",{children:"No budget found."});async function R(B){if(B.preventDefault(),!(!p.trim()||!n)){_(!0),E(null),A(null);try{await l(p.trim()),h(""),A("Invite sent! The user can now accept the invitation from their account.")}catch($){E($ instanceof Error?$.message:"Failed to invite user")}finally{_(!1)}}}async function O(B){if(!n)return;if(B===n.owner_id){E("Cannot revoke the budget owner");return}if(B===e){E("Cannot revoke yourself from the budget");return}const $=o.includes(B);if(confirm($?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){E(null),A(null);try{await c(B),A($?"User access revoked.":"Invitation cancelled.")}catch(X){E(X instanceof Error?X.message:"Failed to revoke user")}}}const F=s.filter(B=>o.includes(B)),q=s.filter(B=>!o.includes(B));return f.jsxs("div",{children:[f.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),f.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),v&&f.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:v}),f.jsx("button",{onClick:()=>E(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),w&&f.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:w}),f.jsx("button",{onClick:()=>A(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[f.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",F.length,")"]}),F.length===0?f.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:F.map(B=>{const $=B===n.owner_id,Y=B===e;return f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[f.jsx("div",{style:{flex:1,minWidth:0},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[f.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:B}),$&&f.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),Y&&f.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!$&&!Y&&f.jsx("button",{onClick:()=>O(B),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},B)})})]}),q.length>0&&f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[f.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",q.length,")"]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:q.map(B=>f.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[f.jsx("div",{style:{flex:1,minWidth:0},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[f.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:B}),f.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),f.jsx("button",{onClick:()=>O(B),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},B))})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[f.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),f.jsxs("form",{onSubmit:R,style:{display:"flex",gap:"0.75rem"},children:[f.jsx("input",{type:"text",value:p,onChange:B=>h(B.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),f.jsx("button",{type:"submit",disabled:m||!p.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:m||!p.trim()?"not-allowed":"pointer",fontWeight:500,opacity:m||!p.trim()?.7:1,whiteSpace:"nowrap"},children:m?"Inviting...":"Send Invite"})]}),f.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),f.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}function rS({budget:t,isCurrent:e,isAccepting:n,isSwitching:s,isEditing:o,editName:l,isRenaming:c,onAccept:p,onSwitch:h,onStartEdit:m,onCancelEdit:_,onEditNameChange:v,onSaveEdit:E}){const w=e&&t.isOwner;return f.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:o?f.jsxs("form",{onSubmit:E,children:[f.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:f.jsx("input",{type:"text",value:l,onChange:A=>v(A.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[f.jsx("button",{type:"submit",disabled:c||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:c||!l.trim()?.7:1,fontSize:"0.8rem"},children:c?"Saving...":"Save"}),f.jsx("button",{type:"button",onClick:_,disabled:c,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c?"not-allowed":"pointer",fontWeight:500,opacity:c?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[f.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[f.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&f.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&f.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&f.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),w&&f.jsx("button",{onClick:m,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),f.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?f.jsx("button",{onClick:p,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:f.jsx("button",{onClick:h,disabled:s,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:s?"not-allowed":"pointer",fontWeight:500,opacity:s?.7:1,fontSize:"0.85rem"},children:s?"Switching...":"Switch"})})]})})}const hg={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function wT({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,s=n&&n in hg?n:"bug",o=hg[s];return f.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:o.bgColor,color:o.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:o.label})}function YN({item:t,isDragging:e,isDragOver:n,onDragStart:s,onDragOver:o,onDragLeave:l,onDragEnd:c,onDrop:p,onToggleDone:h,onTypeClick:m}){return f.jsxs("div",{onDragOver:_=>{_.stopPropagation(),o(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),p(_)},style:{position:"relative"},children:[f.jsx("div",{style:{...pT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),f.jsxs("div",{draggable:!0,onDragStart:s,onDragEnd:c,style:{...sc,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[f.jsx("span",{style:{...mT},children:""}),f.jsx("input",{type:"checkbox",checked:t.is_done,onChange:h,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ye.primary,flexShrink:0}}),f.jsx(wT,{type:t.feedback_type,onClick:m})]}),f.jsxs("div",{style:{marginLeft:"3.25rem"},children:[f.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),f.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",dg(t.created_at)]})]})]})]})}function WN({item:t,onToggleDone:e,onTypeClick:n}){return f.jsxs("div",{style:{...sc,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[f.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ye.primary,flexShrink:0}}),f.jsx(wT,{type:t.feedback_type,onClick:n})]}),f.jsxs("div",{style:{marginLeft:"2rem"},children:[f.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),f.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",dg(t.created_at)]}),t.completed_at&&f.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:ye.success},children:[" Completed: ",dg(t.completed_at)]})]})]})}function XN(){return f.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:"0.5rem",verticalAlign:"middle"}})}function JN({title:t,description:e,isComplete:n,isMigrating:s,needsMigration:o,totalBudgetsToMigrate:l,budgetsToMigrateCategories:c,budgetsToMigrateAccounts:p,onRunMigration:h,disabled:m,children:_}){return f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[f.jsxs("h3",{style:{marginTop:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{style:{background:n?"rgba(34, 197, 94, 0.2)":"rgba(100, 108, 255, 0.2)",color:n?"#4ade80":"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:n?"Complete":"Required"}),t]}),f.jsx("p",{style:{opacity:.7,marginBottom:"1rem"},children:e}),s?f.jsxs("div",{style:{background:"rgba(100, 108, 255, 0.1)",border:"1px solid rgba(100, 108, 255, 0.3)",color:"#a5b4fc",padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:[f.jsx(XN,{})," Running migration across all budgets..."]}):n?f.jsx("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px"},children:" All budgets are using the new map structure"}):o?f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",color:"#fbbf24",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem"},children:[f.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",l," budget(s) needing migration:"]}),f.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[c>0&&f.jsxs("li",{children:[c," with categories to migrate"]}),p>0&&f.jsxs("li",{children:[p," with accounts to migrate"]})]})]}),f.jsx("button",{onClick:h,disabled:m,style:{background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:m?"not-allowed":"pointer",fontWeight:500,opacity:m?.7:1},children:"Migrate All Budgets"})]}):null,_]})}function ZN({results:t}){return f.jsxs("div",{style:{marginTop:"1rem"},children:[f.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem"},children:"Migration Results:"}),f.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:t.map((e,n)=>f.jsx(e4,{result:e,isLast:n===t.length-1},n))})]})}function e4({result:t,isLast:e}){const n=t.error&&t.error!=="Already migrated",s=t.error==="Already migrated";return f.jsxs("div",{style:{padding:"0.5rem",marginBottom:e?0:"0.5rem",borderRadius:"4px",background:n?"rgba(220, 38, 38, 0.1)":s?"rgba(100, 100, 100, 0.1)":"rgba(34, 197, 94, 0.1)",border:n?"1px solid rgba(220, 38, 38, 0.3)":s?"1px solid rgba(100, 100, 100, 0.3)":"1px solid rgba(34, 197, 94, 0.3)"},children:[f.jsxs("div",{style:{fontWeight:500},children:[n?"":s?"":""," ",t.budgetName]}),n?f.jsxs("div",{style:{fontSize:"0.85rem",opacity:.8,color:"#f87171"},children:["Error: ",t.error]}):s?f.jsx("div",{style:{fontSize:"0.85rem",opacity:.6},children:"Already using map structure"}):f.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7},children:[t.categoriesMigrated>0&&`Migrated ${t.categoriesMigrated} categories`,t.categoriesMigrated>0&&(t.accountsMigrated>0||t.accountGroupsMigrated>0)&&", ",t.accountsMigrated>0&&`${t.accountsMigrated} accounts`,t.accountsMigrated>0&&t.accountGroupsMigrated>0&&", ",t.accountGroupsMigrated>0&&`${t.accountGroupsMigrated} account groups`,t.balancesCalculated&&" with calculated balances"]})]})}function t4(){const t=La(),{selectedBudgetId:e,currentUserId:n}=An(),{budget:s}=zn(e,n),o=j.useRef(!1),[l,c]=j.useState({categoriesArrayMigrationNeeded:!1,accountsArrayMigrationNeeded:!1,budgetsToMigrateCategories:0,budgetsToMigrateAccounts:0,loading:!0}),[p,h]=j.useState(!1),[m,_]=j.useState(null),v=Tn(yn),E=t.get_current_firebase_user();j.useEffect(()=>{async function q(){if(!E||o.current){c(B=>({...B,loading:!1}));return}o.current=!0;try{const B=Pe(v,"users",E.uid),$=await qe(B);if(!$.exists()){c({categoriesArrayMigrationNeeded:!1,accountsArrayMigrationNeeded:!1,budgetsToMigrateCategories:0,budgetsToMigrateAccounts:0,loading:!1});return}const X=$.data().budget_ids||[];let C=0,T=0;for(const I of X){const k=Pe(v,"budgets",I),D=await qe(k);if(D.exists()){const V=D.data();Array.isArray(V.categories)&&C++,Array.isArray(V.accounts)&&T++}}c({categoriesArrayMigrationNeeded:C>0,accountsArrayMigrationNeeded:T>0,budgetsToMigrateCategories:C,budgetsToMigrateAccounts:T,loading:!1})}catch(B){console.error("Error checking migration status:",B),c({categoriesArrayMigrationNeeded:!1,accountsArrayMigrationNeeded:!1,budgetsToMigrateCategories:0,budgetsToMigrateAccounts:0,loading:!1})}}q()},[E,v]);async function w(q,B){const $={};B.forEach(Y=>{$[Y]=0});try{const Y=ly($h(v,"months"),uy("budget_id","==",q));(await ef(Y)).forEach(C=>{const T=C.data();if(T.allocations_finalized&&T.allocations)for(const I of T.allocations)$[I.category_id]=($[I.category_id]||0)+I.amount})}catch(Y){console.error("Error calculating balances for budget:",q,Y)}return $}async function A(){if(!E)return;h(!0),_(null);const q=[];try{const B=Pe(v,"users",E.uid),$=await qe(B);if(!$.exists()){_([{budgetId:"",budgetName:"No user document found",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"User document not found"}]),h(!1);return}const X=$.data().budget_ids||[];for(const C of X){const T=await R(C);q.push(T)}_(q),c({categoriesArrayMigrationNeeded:!1,accountsArrayMigrationNeeded:!1,budgetsToMigrateCategories:0,budgetsToMigrateAccounts:0,loading:!1})}catch(B){_([{budgetId:"",budgetName:"Migration Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:B instanceof Error?B.message:"Migration failed"}])}finally{h(!1)}}async function R(q){try{const B=Pe(v,"budgets",q),$=await qe(B);if(!$.exists())return{budgetId:q,budgetName:"Unknown",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Budget not found"};const Y=$.data(),X=Y.name||"Unnamed Budget",C=Array.isArray(Y.categories),T=Array.isArray(Y.accounts),I=Array.isArray(Y.account_groups);if(!C&&!T&&!I)return{budgetId:q,budgetName:X,categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Already migrated"};let k=Y.categories,D=Y.accounts,V=Y.account_groups,N=0,W=0,z=0,L=!1;if(C){const ae=Y.categories,ce={},U=[];for(const _e of ae){const fe=_e.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;U.push(fe),ce[fe]={name:_e.name,description:_e.description,category_group_id:_e.category_group_id??null,sort_order:_e.sort_order??0,default_monthly_amount:_e.default_monthly_amount,default_monthly_type:_e.default_monthly_type,balance:0}}const te=await w(q,U);for(const _e of U)ce[_e]&&(ce[_e].balance=te[_e]||0);const be={};Object.entries(ce).forEach(([_e,fe])=>{be[_e]={name:fe.name,category_group_id:fe.category_group_id??null,sort_order:fe.sort_order,balance:fe.balance},fe.description&&(be[_e].description=fe.description),fe.default_monthly_amount!==void 0&&(be[_e].default_monthly_amount=fe.default_monthly_amount),fe.default_monthly_type!==void 0&&(be[_e].default_monthly_type=fe.default_monthly_type)}),k=be,N=ae.length,L=!0}if(T){const ae=Y.accounts,ce={};for(const U of ae){const te=U.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;ce[te]={nickname:U.nickname,balance:U.balance??0,account_group_id:U.account_group_id??null,sort_order:U.sort_order??0},U.is_income_account!==void 0&&(ce[te].is_income_account=U.is_income_account),U.is_income_default!==void 0&&(ce[te].is_income_default=U.is_income_default),U.is_outgo_account!==void 0&&(ce[te].is_outgo_account=U.is_outgo_account),U.is_outgo_default!==void 0&&(ce[te].is_outgo_default=U.is_outgo_default),U.on_budget!==void 0&&(ce[te].on_budget=U.on_budget),U.is_active!==void 0&&(ce[te].is_active=U.is_active)}D=ce,W=ae.length}if(I){const ae=Y.account_groups,ce={};for(const U of ae){const te=U.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;ce[te]={name:U.name,sort_order:U.sort_order??0},U.expected_balance!==void 0&&(ce[te].expected_balance=U.expected_balance),U.on_budget!==void 0&&(ce[te].on_budget=U.on_budget),U.is_active!==void 0&&(ce[te].is_active=U.is_active)}if(T&&D){const U=D,te=Y.account_groups,be={};te.forEach((_e,fe)=>{const Ee=_e.id||String(fe),we=Object.keys(ce)[fe];we&&(be[Ee]=we)}),Object.entries(U).forEach(([_e,fe])=>{fe.account_group_id&&be[fe.account_group_id]&&(U[_e].account_group_id=be[fe.account_group_id])})}V=ce,z=ae.length}const{category_balances:H,...Q}=Y;return await vt(B,{...Q,categories:k,accounts:D,account_groups:V}),{budgetId:q,budgetName:X,categoriesMigrated:N,accountsMigrated:W,accountGroupsMigrated:z,balancesCalculated:L}}catch(B){return{budgetId:q,budgetName:"Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:B instanceof Error?B.message:"Migration failed"}}}const O=l.categoriesArrayMigrationNeeded||l.accountsArrayMigrationNeeded,F=Math.max(l.budgetsToMigrateCategories,l.budgetsToMigrateAccounts);return l.loading?f.jsxs("div",{children:[f.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),f.jsx("h2",{style:{marginTop:0},children:"Data Migrations"}),f.jsx("p",{style:{opacity:.7},children:"Checking migration status..."})]}):f.jsxs("div",{children:[f.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),f.jsx("h2",{style:{marginTop:0},children:"Data Migrations"}),f.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Run migrations to update your budget data structure."}),f.jsx(JN,{title:"Migrate Data to Map Structure",description:"Converts categories, accounts, and account groups from array format to map structure. This improves performance and enables direct lookup by ID.",isComplete:!O,isMigrating:p,needsMigration:O,totalBudgetsToMigrate:F,budgetsToMigrateCategories:l.budgetsToMigrateCategories,budgetsToMigrateAccounts:l.budgetsToMigrateAccounts,onRunMigration:A,disabled:!E,children:m&&f.jsx(ZN,{results:m})}),s&&f.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:f.jsxs("p",{style:{margin:0,opacity:.7},children:[f.jsx("strong",{children:"Note:"}),' This migration will process all budgets you have access to, not just "',s.name,'". After migration, reload the page to see updated data.']})})]})}function n4(){const[t,e]=j.useState(null),[n,s]=j.useState(null),[o,l]=j.useState(null),[c,p]=j.useState(!1),[h,m]=j.useState(""),[_,v]=j.useState("bug"),[E,w]=j.useState(null),[A,R]=j.useState(null),O=j.useContext(Gu),q=La().get_current_firebase_user(),B=hj(),$=Iw(),Y=B.data?.items||[];async function X(Q){if(Q.preventDefault(),!(!h.trim()||!O.username||!q)){e(null);try{await $.submitFeedback.mutateAsync({userId:q.uid,userEmail:O.username,text:h.trim(),feedbackType:_,currentPath:"/admin/feedback"}),m(""),v("bug"),p(!1)}catch(ae){e(ae instanceof Error?ae.message:"Failed to add feedback")}}}function C(Q){Q.is_done?T(Q):w(Q)}async function T(Q){try{await $.toggleFeedback.mutateAsync({item:Q})}catch(ae){e(ae instanceof Error?ae.message:"Failed to update feedback")}}function I(){E&&(T(E),w(null))}async function k(Q){if(A){try{const ce=Y.filter(U=>U.doc_id===A.doc_id).map(U=>U.id===A.id?{id:U.id,text:U.text,created_at:U.created_at,is_done:U.is_done,completed_at:U.completed_at,sort_order:U.sort_order,feedback_type:Q}:{id:U.id,text:U.text,created_at:U.created_at,is_done:U.is_done,completed_at:U.completed_at,sort_order:U.sort_order,feedback_type:U.feedback_type});await $.updateSortOrder.mutateAsync({docId:A.doc_id,items:ce})}catch(ae){e(ae instanceof Error?ae.message:"Failed to update feedback type")}R(null)}}const D=Y.filter(Q=>!Q.is_done).sort((Q,ae)=>Q.sort_order-ae.sort_order),V=Y.filter(Q=>Q.is_done).sort((Q,ae)=>{const ce=Q.completed_at?new Date(Q.completed_at).getTime():0;return(ae.completed_at?new Date(ae.completed_at).getTime():0)-ce});function N(Q,ae){s(ae),Q.dataTransfer.effectAllowed="move"}function W(Q,ae){Q.preventDefault(),ae!==n&&l(ae)}function z(){l(null)}function L(){s(null),l(null)}async function H(Q,ae){if(Q.preventDefault(),!n||n===ae){L();return}const ce=D.findIndex(fe=>fe.id===n),U=[...D],[te]=U.splice(ce,1);if(ae==="__end__")U.push(te);else{const fe=U.findIndex(Ee=>Ee.id===ae);U.splice(fe,0,te)}const be=U.map((fe,Ee)=>({...fe,sort_order:Ee}));L();const _e=new Map;for(const fe of be)_e.has(fe.doc_id)||_e.set(fe.doc_id,[]),_e.get(fe.doc_id).push({id:fe.id,text:fe.text,created_at:fe.created_at,is_done:fe.is_done,completed_at:fe.completed_at,sort_order:fe.sort_order,feedback_type:fe.feedback_type});for(const fe of V)_e.has(fe.doc_id)||_e.set(fe.doc_id,[]),_e.get(fe.doc_id).push({id:fe.id,text:fe.text,created_at:fe.created_at,is_done:fe.is_done,completed_at:fe.completed_at,sort_order:fe.sort_order,feedback_type:fe.feedback_type});try{for(const[fe,Ee]of _e)await $.updateSortOrder.mutateAsync({docId:fe,items:Ee})}catch(fe){e(fe instanceof Error?fe.message:"Failed to save order")}}return B.isLoading?f.jsx("p",{children:"Loading feedback..."}):f.jsxs("div",{children:[f.jsx("h2",{style:{marginTop:0},children:"Feedback"}),f.jsx("p",{style:{...af,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&f.jsx(pl,{message:t,onDismiss:()=>e(null)}),f.jsxs("div",{style:Hs,children:[D.length===0&&!c&&f.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),D.map(Q=>f.jsx(YN,{item:Q,isDragging:n===Q.id,isDragOver:o===Q.id,onDragStart:ae=>N(ae,Q.id),onDragOver:ae=>W(ae,Q.id),onDragLeave:z,onDragEnd:L,onDrop:ae=>H(ae,Q.id),onToggleDone:()=>C(Q),onTypeClick:()=>R(Q)},Q.id)),n&&D.length>0&&f.jsx(Ty,{isActive:o==="__end__",onDragOver:Q=>W(Q,"__end__"),onDragLeave:z,onDrop:Q=>H(Q,"__end__")})]}),c?f.jsxs(Ua,{onSubmit:X,children:[f.jsx(iS,{selectedType:_,onSelect:v}),f.jsx(xy,{value:h,onChange:Q=>m(Q.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),f.jsxs(Ys,{children:[f.jsx(Ne,{type:"submit",isLoading:$.submitFeedback.isPending,disabled:!h.trim(),children:"Add Feedback"}),f.jsx(Ne,{type:"button",variant:"secondary",onClick:()=>{p(!1),m(""),v("bug")},children:"Cancel"})]})]}):f.jsx(Ne,{variant:"primary-large",onClick:()=>p(!0),children:"+ Add Feedback"}),V.length>0&&f.jsx(_N,{title:"Completed",count:V.length,children:f.jsx("div",{style:{...Hs,marginTop:"0.5rem"},children:V.map(Q=>f.jsx(WN,{item:Q,onToggleDone:()=>C(Q),onTypeClick:()=>R(Q)},Q.id))})}),f.jsxs(Dh,{isOpen:E!==null,onClose:()=>w(null),title:"Mark as Complete",children:[f.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),E&&f.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',E.text,'"']}),f.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[f.jsx(Ne,{variant:"secondary",onClick:()=>w(null),children:"Cancel"}),f.jsx(Ne,{variant:"primary",onClick:I,children:"Mark Complete"})]})]}),f.jsxs(Dh,{isOpen:A!==null,onClose:()=>R(null),title:"Change Feedback Type",children:[f.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),f.jsx(iS,{selectedType:A?.feedback_type||"bug",onSelect:k}),f.jsx(Ne,{variant:"secondary",onClick:()=>R(null),style:{width:"100%"},children:"Cancel"})]})]})}function iS({selectedType:t,onSelect:e}){return f.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const s=hg[n],o=t==="feature"?"new_feature":t,l=o===n||!o&&n==="bug";return f.jsxs("button",{type:"button",onClick:()=>e(n),style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${s.color}`,borderRadius:"0.5rem",background:l?s.bgColor:"transparent",color:l?s.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${s.bgColor}`:"none",position:"relative"},children:[s.label,l&&f.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function r4(){const{currentUserId:t}=An(),[e,n]=j.useState([]),[s,o]=j.useState(!1),l=Tn(yn);function c(w,A){n(R=>R.map(O=>O.name===w?{...O,...A}:O))}async function p(){o(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await h("Read unauthorized budget",async()=>{const R=Pe(l,"budgets","unauthorized_budget_test_12345");return await qe(R),"Was able to read budget (unexpected)"},!0),await h("Read another user's document",async()=>{const R=Pe(l,"users","another_user_test_12345");return await qe(R),"Was able to read user document (unexpected)"},!0),await h("Read unauthorized budget month",async()=>{const O=Pe(l,"months","unauthorized_budget_test_12345_2024_01");return await qe(O),"Was able to read month document for unauthorized budget (unexpected)"},!0),await h("Toggle is_admin in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const A=Pe(l,"users",t),O=(await qe(A)).data()?.permission_flags?.is_admin??!1;return await qd(A,{"permission_flags.is_admin":!O}),`Was able to change is_admin from ${O} to ${!O} (SECURITY ISSUE!)`},!0),await h("Toggle is_test in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const A=Pe(l,"users",t),O=(await qe(A)).data()?.permission_flags?.is_test??!1;return await qd(A,{"permission_flags.is_test":!O}),`Was able to change is_test from ${O} to ${!O} (SECURITY ISSUE!)`},!0),await h("Read own user document",async()=>{if(!t)throw new Error("Not authenticated");const A=Pe(l,"users",t);if((await qe(A)).exists())return"Successfully read own document";throw new Error("Document does not exist")},!1),o(!1)}async function h(w,A,R){c(w,{status:"running",message:"Running..."});try{const O=await A();R?c(w,{status:"failed",message:` ${O}`}):c(w,{status:"passed",message:` ${O}`})}catch(O){const F=O instanceof Error?O.message:"Unknown error";R?c(w,{status:"passed",message:` Blocked as expected: ${F}`}):c(w,{status:"failed",message:` ${F}`})}}async function m(w){switch(e.find(R=>R.name===w)||n(R=>[...R,{name:w,status:"pending",message:"",expectedToFail:!0}]),o(!0),w){case"Read unauthorized budget":await h(w,async()=>{const O=Pe(l,"budgets","unauthorized_budget_test_12345");return await qe(O),"Was able to read budget (unexpected)"},!0);break;case"Read another user's document":await h(w,async()=>{const O=Pe(l,"users","another_user_test_12345");return await qe(O),"Was able to read user document (unexpected)"},!0);break;case"Read unauthorized budget month":await h(w,async()=>{const F=Pe(l,"months","unauthorized_budget_test_12345_2024_01");return await qe(F),"Was able to read month document for unauthorized budget (unexpected)"},!0);break;case"Toggle is_admin in own permission_flags":await h(w,async()=>{if(!t)throw new Error("Not authenticated");const R=Pe(l,"users",t),F=(await qe(R)).data()?.permission_flags?.is_admin??!1;return await qd(R,{"permission_flags.is_admin":!F}),`Was able to change is_admin from ${F} to ${!F} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await h(w,async()=>{if(!t)throw new Error("Not authenticated");const R=Pe(l,"users",t),F=(await qe(R)).data()?.permission_flags?.is_test??!1;return await qd(R,{"permission_flags.is_test":!F}),`Was able to change is_test from ${F} to ${!F} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await h(w,async()=>{if(!t)throw new Error("Not authenticated");const R=Pe(l,"users",t);if((await qe(R)).exists())return"Successfully read own document";throw new Error("Document does not exist")},!1);break}o(!1)}const _=e.filter(w=>w.status==="passed").length,v=e.filter(w=>w.status==="failed").length,E=e.length;return f.jsxs("div",{children:[f.jsx("p",{style:af,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),f.jsx("div",{style:{marginBottom:"1.5rem"},children:f.jsx(Ne,{onClick:p,disabled:s,variant:"primary",children:s?"Running Tests...":"Run All Tests"})}),e.length>0&&f.jsx("div",{style:{marginBottom:"1.5rem"},children:f.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[f.jsxs("span",{children:["Total: ",f.jsx("strong",{children:E})]}),f.jsxs("span",{style:{color:ye.success},children:["Passed: ",f.jsx("strong",{children:_})]}),f.jsxs("span",{style:{color:ye.danger},children:["Failed: ",f.jsx("strong",{children:v})]})]})}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[f.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),f.jsx(Oo,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(w=>w.name==="Read unauthorized budget"),onRun:()=>m("Read unauthorized budget"),disabled:s}),f.jsx(Oo,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(w=>w.name==="Read another user's document"),onRun:()=>m("Read another user's document"),disabled:s}),f.jsx(Oo,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(w=>w.name==="Read unauthorized budget month"),onRun:()=>m("Read unauthorized budget month"),disabled:s}),f.jsx(Oo,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(w=>w.name==="Toggle is_admin in own permission_flags"),onRun:()=>m("Toggle is_admin in own permission_flags"),disabled:s}),f.jsx(Oo,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(w=>w.name==="Toggle is_test in own permission_flags"),onRun:()=>m("Toggle is_test in own permission_flags"),disabled:s}),f.jsx(Oo,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(w=>w.name==="Read own user document"),onRun:()=>m("Read own user document"),disabled:s,expectedToSucceed:!0})]}),v>0&&f.jsxs(pl,{style:{marginTop:"1.5rem"},children:[" ",v," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function Oo({name:t,description:e,expectedBehavior:n,result:s,onRun:o,disabled:l,expectedToSucceed:c}){const p=s?.status==="passed"?ye.success:s?.status==="failed"?ye.danger:s?.status==="running"?ye.warning:"inherit";return f.jsxs("div",{style:{...sc,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[f.jsxs("div",{style:{flex:1},children:[f.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),f.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),f.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:c?ye.success:ye.warning},children:["Expected: ",n]})]}),f.jsx(Ne,{onClick:o,disabled:l,variant:"secondary",style:{flexShrink:0},children:s?.status==="running"?"":"Run"})]}),s&&s.status!=="pending"&&f.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${p} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${p} 30%, transparent)`,fontSize:"0.85rem",color:p},children:s.message})]})}function i4(){const{selectedBudgetId:t,currentUserId:e,accessibleBudgets:n,loadAccessibleBudgets:s,switchToBudget:o,checkBudgetInvite:l,isInitialized:c}=An(),{budget:p,renameBudget:h,acceptInvite:m,isLoading:_}=zn(t,e),[v,E]=j.useState(!1),[w,A]=j.useState(null),[R,O]=j.useState(null),[F,q]=j.useState(null),[B,$]=j.useState(null),[Y,X]=j.useState(null),[C,T]=j.useState(""),[I,k]=j.useState(!1),[D,V]=j.useState(""),[N,W]=j.useState(!1),[z,L]=j.useState(null);j.useEffect(()=>{async function Ee(){E(!0),await s(),E(!1)}Ee()},[]);async function H(Ee){if(Ee!==p?.id){A(Ee),q(null),$(null);try{await o(Ee),$("Switched to budget successfully!"),await s()}catch(we){q(we instanceof Error?we.message:"Failed to switch budget")}finally{A(null)}}}async function Q(Ee){O(Ee),q(null),$(null);try{await m(Ee),$("Invitation accepted! You now have access to this budget."),await s()}catch(we){q(we instanceof Error?we.message:"Failed to accept invitation")}finally{O(null)}}async function ae(Ee){if(Ee.preventDefault(),!!D.trim()){W(!0),q(null),L(null);try{const we=await l(D.trim());we?L(we):q("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(we){q(we instanceof Error?we.message:"Failed to check invitation")}finally{W(!1)}}}async function ce(){if(z){O(z.budgetId),q(null);try{await m(z.budgetId),$(`Successfully joined "${z.budgetName}"!`),L(null),V(""),await s()}catch(Ee){q(Ee instanceof Error?Ee.message:"Failed to accept invitation")}finally{O(null)}}}function U(Ee,we){T(we),X(Ee)}function te(){X(null),T("")}async function be(Ee){if(Ee.preventDefault(),!(!C.trim()||!Y)){k(!0),q(null),$(null);try{await h(C.trim()),$("Budget renamed successfully!"),X(null),await s()}catch(we){q(we instanceof Error?we.message:"Failed to rename budget")}finally{k(!1)}}}const _e=n.filter(Ee=>!Ee.isPending),fe=n.filter(Ee=>Ee.isPending);return _||v||!c?f.jsx("p",{children:"Loading your budgets..."}):f.jsxs("div",{children:[f.jsx("h2",{style:{marginTop:0},children:"My Budgets"}),f.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Manage your budgets, switch between them, and accept new invitations."}),F&&f.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:F}),f.jsx("button",{onClick:()=>q(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),B&&f.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:B}),f.jsx("button",{onClick:()=>$(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),fe.length>0&&f.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[f.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""})," Pending Invitations (",fe.length,")"]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:fe.map(Ee=>f.jsx(rS,{budget:Ee,isCurrent:!1,isAccepting:R===Ee.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>Q(Ee.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},Ee.id))})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[f.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""})," Your Budgets (",_e.length,")"]}),_e.length===0?f.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:_e.map(Ee=>{const we=Ee.id===p?.id,ge=Y===Ee.id;return f.jsx(rS,{budget:Ee,isCurrent:we,isAccepting:!1,isSwitching:w===Ee.id,isEditing:ge,editName:ge?C:"",isRenaming:I,onAccept:()=>{},onSwitch:()=>H(Ee.id),onStartEdit:()=>U(Ee.id,Ee.name),onCancelEdit:te,onEditNameChange:T,onSaveEdit:be},Ee.id)})})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[f.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""})," Join Budget by ID"]}),f.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),z?f.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[f.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[f.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:z.budgetName}),z.ownerEmail&&f.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",z.ownerEmail]})]}),f.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[f.jsx("button",{onClick:ce,disabled:R===z.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:R===z.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:R===z.budgetId?.7:1},children:R===z.budgetId?"Accepting...":"Accept Invitation"}),f.jsx("button",{onClick:()=>{L(null),V("")},disabled:R===z.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:R===z.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:R===z.budgetId?.7:.8},children:"Cancel"})]})]}):f.jsxs("form",{onSubmit:ae,style:{display:"flex",gap:"0.75rem"},children:[f.jsx("input",{type:"text",value:D,onChange:Ee=>V(Ee.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),f.jsx("button",{type:"submit",disabled:N||!D.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:N||!D.trim()?"not-allowed":"pointer",fontWeight:500,opacity:N||!D.trim()?.7:1,whiteSpace:"nowrap"},children:N?"Checking...":"Check Invite"})]})]}),e&&f.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[f.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),f.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:e})]})]})}function s4({children:t}){const e=j.useContext(Gu),n=pr();return e.is_auth_checked?e.is_logged_in?t?f.jsx(f.Fragment,{children:t}):f.jsx(bg,{}):f.jsx(vS,{to:"/account",state:{from:n.pathname},replace:!0}):f.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:f.jsx("p",{children:"Loading..."})})}function a4(){const{selectedBudgetId:t,currentUserId:e,isInitialized:n,clearCache:s}=An(),{isLoading:o,error:l,refreshBudget:c}=zn(t,e),[p,h]=j.useState(!1),[m,_]=j.useState(!1),v=j.useRef(null);j.useEffect(()=>{if(!m)return;function w(A){v.current&&!v.current.contains(A.target)&&_(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[m]);async function E(){h(!0);try{await c()}finally{h(!1)}}return n?l?(console.error("[BudgetLayout] Error:",l),f.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:f.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",l.message]})})):f.jsxs(f.Fragment,{children:[f.jsxs("div",{ref:v,style:{position:"fixed",bottom:"1.5rem",right:"5.5rem",zIndex:1e3,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[m&&f.jsxs("div",{style:{background:"rgba(30, 30, 35, 0.95)",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"1rem",minWidth:"220px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)"},children:[f.jsxs("div",{style:{marginBottom:"0.75rem"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Data Source"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",fontWeight:500},children:f.jsx("span",{style:{color:ye.success},children:" React Query Cache"})})]}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[f.jsx("button",{onClick:E,disabled:p||o,style:{flex:1,background:ye.primary,color:"white",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.8rem",fontWeight:500,cursor:p||o?"not-allowed":"pointer",opacity:p||o?.6:1,transition:"opacity 0.15s"},children:p?" Syncing...":" Sync Now"}),f.jsx("button",{onClick:()=>{s(),_(!1)},style:{background:"rgba(255, 255, 255, 0.1)",color:"inherit",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.8rem",cursor:"pointer",transition:"background 0.15s"},title:"Clear all cached data",children:""})]}),f.jsx("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.7rem",opacity:.5,lineHeight:1.4},children:'Data is cached via React Query. Click "Sync Now" to fetch fresh data.'})]}),f.jsxs("button",{onClick:()=>_(!m),style:{display:"flex",alignItems:"center",gap:"0.4rem",background:"rgba(30, 30, 35, 0.9)",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"20px",padding:"0.4rem 0.75rem",fontSize:"0.75rem",color:"inherit",cursor:"pointer",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.2)",transition:"all 0.15s"},title:"Data loaded via React Query",children:[f.jsx("span",{children:""}),f.jsx("span",{style:{opacity:.8},children:"Cache"}),f.jsx("span",{style:{opacity:.5,fontSize:"0.65rem"},children:m?"":""})]})]}),f.jsx("div",{style:{paddingBottom:"5rem"},children:f.jsx(bg,{})})]}):f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("p",{children:"Loading budget..."}),o&&f.jsx("p",{style:{opacity:.6},children:"Fetching data from server..."})]})}const o4={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function l4(){const[t,e]=j.useState(o4),n=La();return j.useEffect(function(){n.set_user_listener(s=>{e({is_logged_in:s!=null,is_auth_checked:!0,username:s?.email??"",set_user_context:e})})},[]),t.is_auth_checked?f.jsx(Gu.Provider,{value:t,children:f.jsx(FR,{children:f.jsx(Pk,{children:f.jsxs(MC,{children:[f.jsxs(uC,{children:[f.jsx(bn,{path:"/",element:f.jsx(Vk,{})}),f.jsx(bn,{path:"/account",element:f.jsx(Uk,{})}),f.jsx(bn,{path:"/sql-test",element:f.jsx(Lk,{})}),f.jsx(bn,{path:"/budget",element:f.jsx(s4,{}),children:f.jsxs(bn,{element:f.jsx(a4,{}),children:[f.jsx(bn,{index:!0,element:f.jsx(kN,{})}),f.jsx(bn,{path:"analytics",element:f.jsx(PN,{})}),f.jsxs(bn,{path:"admin",element:f.jsx(KN,{}),children:[f.jsx(bn,{path:"my-budgets",element:f.jsx(i4,{})}),f.jsx(bn,{path:"accounts",element:f.jsx(qN,{})}),f.jsx(bn,{path:"categories",element:f.jsx(QN,{})}),f.jsx(bn,{path:"users",element:f.jsx($N,{})}),f.jsx(bn,{path:"migration",element:f.jsx(t4,{})}),f.jsx(bn,{path:"feedback",element:f.jsx(n4,{})}),f.jsx(bn,{path:"tests",element:f.jsx(r4,{})})]})]})})]}),f.jsx(yN,{})]})})})}):f.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:f.jsx("p",{children:"Loading..."})})}cA.createRoot(document.getElementById("root")).render(f.jsx(j.StrictMode,{children:f.jsx(l4,{})}));
