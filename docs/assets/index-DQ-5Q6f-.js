(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var mp={exports:{}},Ac={};var hb;function HA(){if(hb)return Ac;hb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var f in a)f!=="key"&&(l[f]=a[f])}else l=a;return a=l.ref,{$$typeof:t,type:i,key:u,ref:a!==void 0?a:null,props:l}}return Ac.Fragment=e,Ac.jsx=n,Ac.jsxs=n,Ac}var fb;function GA(){return fb||(fb=1,mp.exports=HA()),mp.exports}var d=GA(),pp={exports:{}},Be={};var mb;function QA(){if(mb)return Be;mb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),x=Symbol.iterator;function w(z){return z===null||typeof z!="object"?null:(z=x&&z[x]||z["@@iterator"],typeof z=="function"?z:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,N={};function H(z,F,W){this.props=z,this.context=F,this.refs=N,this.updater=W||A}H.prototype.isReactComponent={},H.prototype.setState=function(z,F){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,F,"setState")},H.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function $(){}$.prototype=H.prototype;function q(z,F,W){this.props=z,this.context=F,this.refs=N,this.updater=W||A}var me=q.prototype=new $;me.constructor=q,I(me,H.prototype),me.isPureReactComponent=!0;var re=Array.isArray;function he(){}var L={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function R(z,F,W){var te=W.ref;return{$$typeof:t,type:z,key:F,ref:te!==void 0?te:null,props:W}}function M(z,F){return R(z.type,F,z.props)}function j(z){return typeof z=="object"&&z!==null&&z.$$typeof===t}function O(z){var F={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(W){return F[W]})}var C=/\/+/g;function Y(z,F){return typeof z=="object"&&z!==null&&z.key!=null?O(""+z.key):F.toString(36)}function U(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(he,he):(z.status="pending",z.then(function(F){z.status==="pending"&&(z.status="fulfilled",z.value=F)},function(F){z.status==="pending"&&(z.status="rejected",z.reason=F)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function P(z,F,W,te,se){var pe=typeof z;(pe==="undefined"||pe==="boolean")&&(z=null);var de=!1;if(z===null)de=!0;else switch(pe){case"bigint":case"string":case"number":de=!0;break;case"object":switch(z.$$typeof){case t:case e:de=!0;break;case _:return de=z._init,P(de(z._payload),F,W,te,se)}}if(de)return se=se(z),de=te===""?"."+Y(z,0):te,re(se)?(W="",de!=null&&(W=de.replace(C,"$&/")+"/"),P(se,F,W,"",function(ce){return ce})):se!=null&&(j(se)&&(se=M(se,W+(se.key==null||z&&z.key===se.key?"":(""+se.key).replace(C,"$&/")+"/")+de)),F.push(se)),1;de=0;var be=te===""?".":te+":";if(re(z))for(var Se=0;Se<z.length;Se++)te=z[Se],pe=be+Y(te,Se),de+=P(te,F,W,pe,se);else if(Se=w(z),typeof Se=="function")for(z=Se.call(z),Se=0;!(te=z.next()).done;)te=te.value,pe=be+Y(te,Se++),de+=P(te,F,W,pe,se);else if(pe==="object"){if(typeof z.then=="function")return P(U(z),F,W,te,se);throw F=String(z),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return de}function B(z,F,W){if(z==null)return z;var te=[],se=0;return P(z,te,"","",function(pe){return F.call(W,pe,se++)}),te}function Q(z){if(z._status===-1){var F=z._result;F=F(),F.then(function(W){(z._status===0||z._status===-1)&&(z._status=1,z._result=W)},function(W){(z._status===0||z._status===-1)&&(z._status=2,z._result=W)}),z._status===-1&&(z._status=0,z._result=F)}if(z._status===1)return z._result.default;throw z._result}var le=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)},J={map:B,forEach:function(z,F,W){B(z,function(){F.apply(this,arguments)},W)},count:function(z){var F=0;return B(z,function(){F++}),F},toArray:function(z){return B(z,function(F){return F})||[]},only:function(z){if(!j(z))throw Error("React.Children.only expected to receive a single React element child.");return z}};return Be.Activity=v,Be.Children=J,Be.Component=H,Be.Fragment=n,Be.Profiler=a,Be.PureComponent=q,Be.StrictMode=i,Be.Suspense=p,Be.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Be.__COMPILER_RUNTIME={__proto__:null,c:function(z){return L.H.useMemoCache(z)}},Be.cache=function(z){return function(){return z.apply(null,arguments)}},Be.cacheSignal=function(){return null},Be.cloneElement=function(z,F,W){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var te=I({},z.props),se=z.key;if(F!=null)for(pe in F.key!==void 0&&(se=""+F.key),F)!D.call(F,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&F.ref===void 0||(te[pe]=F[pe]);var pe=arguments.length-2;if(pe===1)te.children=W;else if(1<pe){for(var de=Array(pe),be=0;be<pe;be++)de[be]=arguments[be+2];te.children=de}return R(z.type,se,te)},Be.createContext=function(z){return z={$$typeof:u,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:l,_context:z},z},Be.createElement=function(z,F,W){var te,se={},pe=null;if(F!=null)for(te in F.key!==void 0&&(pe=""+F.key),F)D.call(F,te)&&te!=="key"&&te!=="__self"&&te!=="__source"&&(se[te]=F[te]);var de=arguments.length-2;if(de===1)se.children=W;else if(1<de){for(var be=Array(de),Se=0;Se<de;Se++)be[Se]=arguments[Se+2];se.children=be}if(z&&z.defaultProps)for(te in de=z.defaultProps,de)se[te]===void 0&&(se[te]=de[te]);return R(z,pe,se)},Be.createRef=function(){return{current:null}},Be.forwardRef=function(z){return{$$typeof:f,render:z}},Be.isValidElement=j,Be.lazy=function(z){return{$$typeof:_,_payload:{_status:-1,_result:z},_init:Q}},Be.memo=function(z,F){return{$$typeof:g,type:z,compare:F===void 0?null:F}},Be.startTransition=function(z){var F=L.T,W={};L.T=W;try{var te=z(),se=L.S;se!==null&&se(W,te),typeof te=="object"&&te!==null&&typeof te.then=="function"&&te.then(he,le)}catch(pe){le(pe)}finally{F!==null&&W.types!==null&&(F.types=W.types),L.T=F}},Be.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Be.use=function(z){return L.H.use(z)},Be.useActionState=function(z,F,W){return L.H.useActionState(z,F,W)},Be.useCallback=function(z,F){return L.H.useCallback(z,F)},Be.useContext=function(z){return L.H.useContext(z)},Be.useDebugValue=function(){},Be.useDeferredValue=function(z,F){return L.H.useDeferredValue(z,F)},Be.useEffect=function(z,F){return L.H.useEffect(z,F)},Be.useEffectEvent=function(z){return L.H.useEffectEvent(z)},Be.useId=function(){return L.H.useId()},Be.useImperativeHandle=function(z,F,W){return L.H.useImperativeHandle(z,F,W)},Be.useInsertionEffect=function(z,F){return L.H.useInsertionEffect(z,F)},Be.useLayoutEffect=function(z,F){return L.H.useLayoutEffect(z,F)},Be.useMemo=function(z,F){return L.H.useMemo(z,F)},Be.useOptimistic=function(z,F){return L.H.useOptimistic(z,F)},Be.useReducer=function(z,F,W){return L.H.useReducer(z,F,W)},Be.useRef=function(z){return L.H.useRef(z)},Be.useState=function(z){return L.H.useState(z)},Be.useSyncExternalStore=function(z,F,W){return L.H.useSyncExternalStore(z,F,W)},Be.useTransition=function(){return L.H.useTransition()},Be.version="19.2.3",Be}var pb;function Cg(){return pb||(pb=1,pp.exports=QA()),pp.exports}var T=Cg(),gp={exports:{}},Cc={},yp={exports:{}},_p={};var gb;function $A(){return gb||(gb=1,(function(t){function e(P,B){var Q=P.length;P.push(B);e:for(;0<Q;){var le=Q-1>>>1,J=P[le];if(0<a(J,B))P[le]=B,P[Q]=J,Q=le;else break e}}function n(P){return P.length===0?null:P[0]}function i(P){if(P.length===0)return null;var B=P[0],Q=P.pop();if(Q!==B){P[0]=Q;e:for(var le=0,J=P.length,z=J>>>1;le<z;){var F=2*(le+1)-1,W=P[F],te=F+1,se=P[te];if(0>a(W,Q))te<J&&0>a(se,W)?(P[le]=se,P[te]=Q,le=te):(P[le]=W,P[F]=Q,le=F);else if(te<J&&0>a(se,Q))P[le]=se,P[te]=Q,le=te;else break e}}return B}function a(P,B){var Q=P.sortIndex-B.sortIndex;return Q!==0?Q:P.id-B.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var u=Date,f=u.now();t.unstable_now=function(){return u.now()-f}}var p=[],g=[],_=1,v=null,x=3,w=!1,A=!1,I=!1,N=!1,H=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function me(P){for(var B=n(g);B!==null;){if(B.callback===null)i(g);else if(B.startTime<=P)i(g),B.sortIndex=B.expirationTime,e(p,B);else break;B=n(g)}}function re(P){if(I=!1,me(P),!A)if(n(p)!==null)A=!0,he||(he=!0,O());else{var B=n(g);B!==null&&U(re,B.startTime-P)}}var he=!1,L=-1,D=5,R=-1;function M(){return N?!0:!(t.unstable_now()-R<D)}function j(){if(N=!1,he){var P=t.unstable_now();R=P;var B=!0;try{e:{A=!1,I&&(I=!1,$(L),L=-1),w=!0;var Q=x;try{t:{for(me(P),v=n(p);v!==null&&!(v.expirationTime>P&&M());){var le=v.callback;if(typeof le=="function"){v.callback=null,x=v.priorityLevel;var J=le(v.expirationTime<=P);if(P=t.unstable_now(),typeof J=="function"){v.callback=J,me(P),B=!0;break t}v===n(p)&&i(p),me(P)}else i(p);v=n(p)}if(v!==null)B=!0;else{var z=n(g);z!==null&&U(re,z.startTime-P),B=!1}}break e}finally{v=null,x=Q,w=!1}B=void 0}}finally{B?O():he=!1}}}var O;if(typeof q=="function")O=function(){q(j)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,Y=C.port2;C.port1.onmessage=j,O=function(){Y.postMessage(null)}}else O=function(){H(j,0)};function U(P,B){L=H(function(){P(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(P){switch(x){case 1:case 2:case 3:var B=3;break;default:B=x}var Q=x;x=B;try{return P()}finally{x=Q}},t.unstable_requestPaint=function(){N=!0},t.unstable_runWithPriority=function(P,B){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var Q=x;x=P;try{return B()}finally{x=Q}},t.unstable_scheduleCallback=function(P,B,Q){var le=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?le+Q:le):Q=le,P){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Q+J,P={id:_++,callback:B,priorityLevel:P,startTime:Q,expirationTime:J,sortIndex:-1},Q>le?(P.sortIndex=Q,e(g,P),n(p)===null&&P===n(g)&&(I?($(L),L=-1):I=!0,U(re,Q-le))):(P.sortIndex=J,e(p,P),A||w||(A=!0,he||(he=!0,O()))),P},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(P){var B=x;return function(){var Q=x;x=B;try{return P.apply(this,arguments)}finally{x=Q}}}})(_p)),_p}var yb;function KA(){return yb||(yb=1,yp.exports=$A()),yp.exports}var vp={exports:{}},Tn={};var _b;function WA(){if(_b)return Tn;_b=1;var t=Cg();function e(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(p,g,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:p,containerInfo:g,implementation:_}}var u=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,g){if(p==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return Tn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Tn.createPortal=function(p,g){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return l(p,g,null,_)},Tn.flushSync=function(p){var g=u.T,_=i.p;try{if(u.T=null,i.p=2,p)return p()}finally{u.T=g,i.p=_,i.d.f()}},Tn.preconnect=function(p,g){typeof p=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(p,g))},Tn.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},Tn.preinit=function(p,g){if(typeof p=="string"&&g&&typeof g.as=="string"){var _=g.as,v=f(_,g.crossOrigin),x=typeof g.integrity=="string"?g.integrity:void 0,w=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;_==="style"?i.d.S(p,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:v,integrity:x,fetchPriority:w}):_==="script"&&i.d.X(p,{crossOrigin:v,integrity:x,fetchPriority:w,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},Tn.preinitModule=function(p,g){if(typeof p=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var _=f(g.as,g.crossOrigin);i.d.M(p,{crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(p)},Tn.preload=function(p,g){if(typeof p=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var _=g.as,v=f(_,g.crossOrigin);i.d.L(p,_,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},Tn.preloadModule=function(p,g){if(typeof p=="string")if(g){var _=f(g.as,g.crossOrigin);i.d.m(p,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(p)},Tn.requestFormReset=function(p){i.d.r(p)},Tn.unstable_batchedUpdates=function(p,g){return p(g)},Tn.useFormState=function(p,g,_){return u.H.useFormState(p,g,_)},Tn.useFormStatus=function(){return u.H.useHostTransitionStatus()},Tn.version="19.2.3",Tn}var vb;function YA(){if(vb)return vp.exports;vb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),vp.exports=WA(),vp.exports}var bb;function XA(){if(bb)return Cc;bb=1;var t=KA(),e=Cg(),n=YA();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var s=r,o=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(o=s.return),r=s.return;while(r)}return s.tag===3?o:null}function u(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function f(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function p(r){if(l(r)!==r)throw Error(i(188))}function g(r){var s=r.alternate;if(!s){if(s=l(r),s===null)throw Error(i(188));return s!==r?null:r}for(var o=r,c=s;;){var m=o.return;if(m===null)break;var y=m.alternate;if(y===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===o)return p(m),r;if(y===c)return p(m),s;y=y.sibling}throw Error(i(188))}if(o.return!==c.return)o=m,c=y;else{for(var E=!1,k=m.child;k;){if(k===o){E=!0,o=m,c=y;break}if(k===c){E=!0,c=m,o=y;break}k=k.sibling}if(!E){for(k=y.child;k;){if(k===o){E=!0,o=y,c=m;break}if(k===c){E=!0,c=y,o=m;break}k=k.sibling}if(!E)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?r:s}function _(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=_(r),s!==null)return s;r=r.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),q=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function O(r){return r===null||typeof r!="object"?null:(r=j&&r[j]||r["@@iterator"],typeof r=="function"?r:null)}var C=Symbol.for("react.client.reference");function Y(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===C?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case I:return"Fragment";case H:return"Profiler";case N:return"StrictMode";case re:return"Suspense";case he:return"SuspenseList";case R:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case A:return"Portal";case q:return r.displayName||"Context";case $:return(r._context.displayName||"Context")+".Consumer";case me:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case L:return s=r.displayName||null,s!==null?s:Y(r.type)||"Memo";case D:s=r._payload,r=r._init;try{return Y(r(s))}catch{}}return null}var U=Array.isArray,P=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},le=[],J=-1;function z(r){return{current:r}}function F(r){0>J||(r.current=le[J],le[J]=null,J--)}function W(r,s){J++,le[J]=r.current,r.current=s}var te=z(null),se=z(null),pe=z(null),de=z(null);function be(r,s){switch(W(pe,s),W(se,r),W(te,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?Nv(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=Nv(s),r=Pv(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}F(te),W(te,r)}function Se(){F(te),F(se),F(pe)}function ce(r){r.memoizedState!==null&&W(de,r);var s=te.current,o=Pv(s,r.type);s!==o&&(W(se,r),W(te,o))}function Te(r){se.current===r&&(F(te),F(se)),de.current===r&&(F(de),Ec._currentValue=Q)}var De,Ae;function Me(r){if(De===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);De=s&&s[1]||"",Ae=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+De+r+Ae}var $e=!1;function vt(r,s){if(!r||$e)return"";$e=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(oe){var ie=oe}Reflect.construct(r,[],ye)}else{try{ye.call()}catch(oe){ie=oe}r.call(ye.prototype)}}else{try{throw Error()}catch(oe){ie=oe}(ye=r())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(oe){if(oe&&ie&&typeof oe.stack=="string")return[oe.stack,ie.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=c.DetermineComponentFrameRoot(),E=y[0],k=y[1];if(E&&k){var G=E.split(`
`),ne=k.split(`
`);for(m=c=0;c<G.length&&!G[c].includes("DetermineComponentFrameRoot");)c++;for(;m<ne.length&&!ne[m].includes("DetermineComponentFrameRoot");)m++;if(c===G.length||m===ne.length)for(c=G.length-1,m=ne.length-1;1<=c&&0<=m&&G[c]!==ne[m];)m--;for(;1<=c&&0<=m;c--,m--)if(G[c]!==ne[m]){if(c!==1||m!==1)do if(c--,m--,0>m||G[c]!==ne[m]){var fe=`
`+G[c].replace(" at new "," at ");return r.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",r.displayName)),fe}while(1<=c&&0<=m);break}}}finally{$e=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?Me(o):""}function Tt(r,s){switch(r.tag){case 26:case 27:case 5:return Me(r.type);case 16:return Me("Lazy");case 13:return r.child!==s&&s!==null?Me("Suspense Fallback"):Me("Suspense");case 19:return Me("SuspenseList");case 0:case 15:return vt(r.type,!1);case 11:return vt(r.type.render,!1);case 1:return vt(r.type,!0);case 31:return Me("Activity");default:return""}}function tn(r){try{var s="",o=null;do s+=Tt(r,o),o=r,r=r.return;while(r);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var ct=Object.prototype.hasOwnProperty,Ne=t.unstable_scheduleCallback,Nt=t.unstable_cancelCallback,cn=t.unstable_shouldYield,In=t.unstable_requestPaint,Pt=t.unstable_now,Ot=t.unstable_getCurrentPriorityLevel,Qn=t.unstable_ImmediatePriority,Al=t.unstable_UserBlockingPriority,Zi=t.unstable_NormalPriority,yf=t.unstable_LowPriority,_u=t.unstable_IdlePriority,vu=t.log,bu=t.unstable_setDisableYieldValue,Er=null,pn=null;function ar(r){if(typeof vu=="function"&&bu(r),pn&&typeof pn.setStrictMode=="function")try{pn.setStrictMode(Er,r)}catch{}}var Lt=Math.clz32?Math.clz32:Eu,xu=Math.log,Qa=Math.LN2;function Eu(r){return r>>>=0,r===0?32:31-(xu(r)/Qa|0)|0}var Ur=256,ra=262144,qt=4194304;function Br(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Fr(r,s,o){var c=r.pendingLanes;if(c===0)return 0;var m=0,y=r.suspendedLanes,E=r.pingedLanes;r=r.warmLanes;var k=c&134217727;return k!==0?(c=k&~y,c!==0?m=Br(c):(E&=k,E!==0?m=Br(E):o||(o=k&~r,o!==0&&(m=Br(o))))):(k=c&~y,k!==0?m=Br(k):E!==0?m=Br(E):o||(o=c&~r,o!==0&&(m=Br(o)))),m===0?0:s!==0&&s!==m&&(s&y)===0&&(y=m&-m,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:m}function Sr(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function _f(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Su(){var r=qt;return qt<<=1,(qt&62914560)===0&&(qt=4194304),r}function qr(r){for(var s=[],o=0;31>o;o++)s.push(r);return s}function ia(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function vf(r,s,o,c,m,y){var E=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var k=r.entanglements,G=r.expirationTimes,ne=r.hiddenUpdates;for(o=E&~o;0<o;){var fe=31-Lt(o),ye=1<<fe;k[fe]=0,G[fe]=-1;var ie=ne[fe];if(ie!==null)for(ne[fe]=null,fe=0;fe<ie.length;fe++){var oe=ie[fe];oe!==null&&(oe.lane&=-536870913)}o&=~ye}c!==0&&sa(r,c,0),y!==0&&m===0&&r.tag!==0&&(r.suspendedLanes|=y&~(E&~s))}function sa(r,s,o){r.pendingLanes|=s,r.suspendedLanes&=~s;var c=31-Lt(s);r.entangledLanes|=s,r.entanglements[c]=r.entanglements[c]|1073741824|o&261930}function Cl(r,s){var o=r.entangledLanes|=s;for(r=r.entanglements;o;){var c=31-Lt(o),m=1<<c;m&s|r[c]&s&&(r[c]|=s),o&=~m}}function Rl(r,s){var o=s&-s;return o=(o&42)!==0?1:aa(o),(o&(r.suspendedLanes|s))!==0?0:o}function aa(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function yi(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function wu(){var r=B.p;return r!==0?r:(r=window.event,r===void 0?32:sb(r.type))}function wr(r,s){var o=B.p;try{return B.p=r,s()}finally{B.p=o}}var Tr=Math.random().toString(36).slice(2),Ht="__reactFiber$"+Tr,un="__reactProps$"+Tr,Hr="__reactContainer$"+Tr,$a="__reactEvents$"+Tr,bf="__reactListeners$"+Tr,Tu="__reactHandles$"+Tr,Au="__reactResources$"+Tr,Gr="__reactMarker$"+Tr;function Ka(r){delete r[Ht],delete r[un],delete r[$a],delete r[bf],delete r[Tu]}function Qr(r){var s=r[Ht];if(s)return s;for(var o=r.parentNode;o;){if(s=o[Hr]||o[Ht]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(r=qv(r);r!==null;){if(o=r[Ht])return o;r=qv(r)}return s}r=o,o=r.parentNode}return null}function or(r){if(r=r[Ht]||r[Hr]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function $n(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function $r(r){var s=r[Au];return s||(s=r[Au]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Gt(r){r[Gr]=!0}var Dl=new Set,Il={};function Kr(r,s){Wr(r,s),Wr(r+"Capture",s)}function Wr(r,s){for(Il[r]=s,r=0;r<s.length;r++)Dl.add(s[r])}var jl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ol={},kl={};function Cu(r){return ct.call(kl,r)?!0:ct.call(Ol,r)?!1:jl.test(r)?kl[r]=!0:(Ol[r]=!0,!1)}function Wa(r,s,o){if(Cu(s))if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+o)}}function Kn(r,s,o){if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+o)}}function Qt(r,s,o,c){if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(s,o,""+c)}}function dn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function es(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ml(r,s,o){var c=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,y=c.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return m.call(this)},set:function(E){o=""+E,y.call(this,E)}}),Object.defineProperty(r,s,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function ut(r){if(!r._valueTracker){var s=es(r)?"checked":"value";r._valueTracker=Ml(r,s,""+r[s])}}function oa(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var o=s.getValue(),c="";return r&&(c=es(r)?r.checked?"true":"false":r.value),r=c,r!==o?(s.setValue(r),!0):!1}function Yr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var la=/[\n"\\]/g;function Nn(r){return r.replace(la,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ya(r,s,o,c,m,y,E,k){r.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?r.type=E:r.removeAttribute("type"),s!=null?E==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+dn(s)):r.value!==""+dn(s)&&(r.value=""+dn(s)):E!=="submit"&&E!=="reset"||r.removeAttribute("value"),s!=null?Nl(r,E,dn(s)):o!=null?Nl(r,E,dn(o)):c!=null&&r.removeAttribute("value"),m==null&&y!=null&&(r.defaultChecked=!!y),m!=null&&(r.checked=m&&typeof m!="function"&&typeof m!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?r.name=""+dn(k):r.removeAttribute("name")}function Ru(r,s,o,c,m,y,E,k){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ut(r);return}o=o!=null?""+dn(o):"",s=s!=null?""+dn(s):o,k||s===r.value||(r.value=s),r.defaultValue=s}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,r.checked=k?r.checked:!!c,r.defaultChecked=!!c,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.name=E),ut(r)}function Nl(r,s,o){s==="number"&&Yr(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function ts(r,s,o,c){if(r=r.options,s){s={};for(var m=0;m<o.length;m++)s["$"+o[m]]=!0;for(o=0;o<r.length;o++)m=s.hasOwnProperty("$"+r[o].value),r[o].selected!==m&&(r[o].selected=m),m&&c&&(r[o].defaultSelected=!0)}else{for(o=""+dn(o),s=null,m=0;m<r.length;m++){if(r[m].value===o){r[m].selected=!0,c&&(r[m].defaultSelected=!0);return}s!==null||r[m].disabled||(s=r[m])}s!==null&&(s.selected=!0)}}function Du(r,s,o){if(s!=null&&(s=""+dn(s),s!==r.value&&(r.value=s),o==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=o!=null?""+dn(o):""}function ns(r,s,o,c){if(s==null){if(c!=null){if(o!=null)throw Error(i(92));if(U(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),s=o}o=dn(s),r.defaultValue=o,c=r.textContent,c===o&&c!==""&&c!==null&&(r.value=c),ut(r)}function Pn(r,s){if(s){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=s;return}}r.textContent=s}var Iu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Pl(r,s,o){var c=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":c?r.setProperty(s,o):typeof o!="number"||o===0||Iu.has(s)?s==="float"?r.cssFloat=o:r[s]=(""+o).trim():r[s]=o+"px"}function Ll(r,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?r.setProperty(c,""):c==="float"?r.cssFloat="":r[c]="");for(var m in s)c=s[m],s.hasOwnProperty(m)&&o[m]!==c&&Pl(r,m,c)}else for(var y in s)s.hasOwnProperty(y)&&Pl(r,y,s[y])}function Xa(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ju=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),rs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ja(r){return rs.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Ar(){}var Vl=null;function lr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var is=null,Xr=null;function ca(r){var s=or(r);if(s&&(r=s.stateNode)){var o=r[un]||null;e:switch(r=s.stateNode,s.type){case"input":if(Ya(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Nn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var c=o[s];if(c!==r&&c.form===r.form){var m=c[un]||null;if(!m)throw Error(i(90));Ya(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(s=0;s<o.length;s++)c=o[s],c.form===r.form&&oa(c)}break e;case"textarea":Du(r,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&ts(r,!!o.multiple,s,!1)}}}var Za=!1;function ss(r,s,o){if(Za)return r(s,o);Za=!0;try{var c=r(s);return c}finally{if(Za=!1,(is!==null||Xr!==null)&&(wd(),is&&(s=is,r=Xr,Xr=is=null,ca(s),r)))for(s=0;s<r.length;s++)ca(r[s])}}function Cr(r,s){var o=r.stateNode;if(o===null)return null;var c=o[un]||null;if(c===null)return null;o=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(r=r.type,c=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!c;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ua=!1;if(cr)try{var ft={};Object.defineProperty(ft,"passive",{get:function(){ua=!0}}),window.addEventListener("test",ft,ft),window.removeEventListener("test",ft,ft)}catch{ua=!1}var Jr=null,zl=null,da=null;function Ul(){if(da)return da;var r,s=zl,o=s.length,c,m="value"in Jr?Jr.value:Jr.textContent,y=m.length;for(r=0;r<o&&s[r]===m[r];r++);var E=o-r;for(c=1;c<=E&&s[o-c]===m[y-c];c++);return da=m.slice(r,1<c?1-c:void 0)}function ha(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function _i(){return!0}function Rr(){return!1}function gn(r){function s(o,c,m,y,E){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var k in r)r.hasOwnProperty(k)&&(o=r[k],this[k]=o?o(y):y[k]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?_i:Rr,this.isPropagationStopped=Rr,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=_i)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=_i)},persist:function(){},isPersistent:_i}),s}var vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zr=gn(vi),as=v({},vi,{view:0,detail:0}),Bl=gn(as),os,eo,ei,to=v({},as,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ls,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ei&&(ei&&r.type==="mousemove"?(os=r.screenX-ei.screenX,eo=r.screenY-ei.screenY):eo=os=0,ei=r),os)},movementY:function(r){return"movementY"in r?r.movementY:eo}}),Fl=gn(to),fa=v({},to,{dataTransfer:0}),Ou=gn(fa),ku=v({},as,{relatedTarget:0}),ma=gn(ku),ql=v({},vi,{animationName:0,elapsedTime:0,pseudoElement:0}),Mu=gn(ql),no=v({},vi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Nu=gn(no),Pu=v({},vi,{data:0}),ti=gn(Pu),Lu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Uu(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=zu[r])?!!s[r]:!1}function ls(){return Uu}var jn=v({},as,{key:function(r){if(r.key){var s=Lu[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=ha(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Vu[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ls,charCode:function(r){return r.type==="keypress"?ha(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ha(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Bu=gn(jn),Fu=v({},to,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bi=gn(Fu),h=v({},as,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ls}),b=gn(h),S=v({},vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),V=gn(S),Z=v({},to,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),ae=gn(Z),Ee=v({},vi,{newState:0,oldState:0}),qe=gn(Ee),Vt=[9,13,27,32],at=cr&&"CompositionEvent"in window,At=null;cr&&"documentMode"in document&&(At=document.documentMode);var ur=cr&&"TextEvent"in window&&!At,ni=cr&&(!at||At&&8<At&&11>=At),Dr=" ",Ir=!1;function pa(r,s){switch(r){case"keyup":return Vt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ro(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var io=!1;function m1(r,s){switch(r){case"compositionend":return ro(s);case"keypress":return s.which!==32?null:(Ir=!0,Dr);case"textInput":return r=s.data,r===Dr&&Ir?null:r;default:return null}}function p1(r,s){if(io)return r==="compositionend"||!at&&pa(r,s)?(r=Ul(),da=zl=Jr=null,io=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ni&&s.locale!=="ko"?null:s.data;default:return null}}var g1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qy(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!g1[r.type]:s==="textarea"}function $y(r,s,o,c){is?Xr?Xr.push(c):Xr=[c]:is=c,s=jd(s,"onChange"),0<s.length&&(o=new Zr("onChange","change",null,o,c),r.push({event:o,listeners:s}))}var Hl=null,Gl=null;function y1(r){Dv(r,0)}function qu(r){var s=$n(r);if(oa(s))return r}function Ky(r,s){if(r==="change")return s}var Wy=!1;if(cr){var xf;if(cr){var Ef="oninput"in document;if(!Ef){var Yy=document.createElement("div");Yy.setAttribute("oninput","return;"),Ef=typeof Yy.oninput=="function"}xf=Ef}else xf=!1;Wy=xf&&(!document.documentMode||9<document.documentMode)}function Xy(){Hl&&(Hl.detachEvent("onpropertychange",Jy),Gl=Hl=null)}function Jy(r){if(r.propertyName==="value"&&qu(Gl)){var s=[];$y(s,Gl,r,lr(r)),ss(y1,s)}}function _1(r,s,o){r==="focusin"?(Xy(),Hl=s,Gl=o,Hl.attachEvent("onpropertychange",Jy)):r==="focusout"&&Xy()}function v1(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return qu(Gl)}function b1(r,s){if(r==="click")return qu(s)}function x1(r,s){if(r==="input"||r==="change")return qu(s)}function E1(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Wn=typeof Object.is=="function"?Object.is:E1;function Ql(r,s){if(Wn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var o=Object.keys(r),c=Object.keys(s);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!ct.call(s,m)||!Wn(r[m],s[m]))return!1}return!0}function Zy(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function e_(r,s){var o=Zy(r);r=0;for(var c;o;){if(o.nodeType===3){if(c=r+o.textContent.length,r<=s&&c>=s)return{node:o,offset:s-r};r=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Zy(o)}}function t_(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?t_(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function n_(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=Yr(r.document);s instanceof r.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)r=s.contentWindow;else break;s=Yr(r.document)}return s}function Sf(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var S1=cr&&"documentMode"in document&&11>=document.documentMode,so=null,wf=null,$l=null,Tf=!1;function r_(r,s,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Tf||so==null||so!==Yr(c)||(c=so,"selectionStart"in c&&Sf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),$l&&Ql($l,c)||($l=c,c=jd(wf,"onSelect"),0<c.length&&(s=new Zr("onSelect","select",null,s,o),r.push({event:s,listeners:c}),s.target=so)))}function ga(r,s){var o={};return o[r.toLowerCase()]=s.toLowerCase(),o["Webkit"+r]="webkit"+s,o["Moz"+r]="moz"+s,o}var ao={animationend:ga("Animation","AnimationEnd"),animationiteration:ga("Animation","AnimationIteration"),animationstart:ga("Animation","AnimationStart"),transitionrun:ga("Transition","TransitionRun"),transitionstart:ga("Transition","TransitionStart"),transitioncancel:ga("Transition","TransitionCancel"),transitionend:ga("Transition","TransitionEnd")},Af={},i_={};cr&&(i_=document.createElement("div").style,"AnimationEvent"in window||(delete ao.animationend.animation,delete ao.animationiteration.animation,delete ao.animationstart.animation),"TransitionEvent"in window||delete ao.transitionend.transition);function ya(r){if(Af[r])return Af[r];if(!ao[r])return r;var s=ao[r],o;for(o in s)if(s.hasOwnProperty(o)&&o in i_)return Af[r]=s[o];return r}var s_=ya("animationend"),a_=ya("animationiteration"),o_=ya("animationstart"),w1=ya("transitionrun"),T1=ya("transitionstart"),A1=ya("transitioncancel"),l_=ya("transitionend"),c_=new Map,Cf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cf.push("scrollEnd");function jr(r,s){c_.set(r,s),Kr(s,[r])}var Hu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},dr=[],oo=0,Rf=0;function Gu(){for(var r=oo,s=Rf=oo=0;s<r;){var o=dr[s];dr[s++]=null;var c=dr[s];dr[s++]=null;var m=dr[s];dr[s++]=null;var y=dr[s];if(dr[s++]=null,c!==null&&m!==null){var E=c.pending;E===null?m.next=m:(m.next=E.next,E.next=m),c.pending=m}y!==0&&u_(o,m,y)}}function Qu(r,s,o,c){dr[oo++]=r,dr[oo++]=s,dr[oo++]=o,dr[oo++]=c,Rf|=c,r.lanes|=c,r=r.alternate,r!==null&&(r.lanes|=c)}function Df(r,s,o,c){return Qu(r,s,o,c),$u(r)}function _a(r,s){return Qu(r,null,null,s),$u(r)}function u_(r,s,o){r.lanes|=o;var c=r.alternate;c!==null&&(c.lanes|=o);for(var m=!1,y=r.return;y!==null;)y.childLanes|=o,c=y.alternate,c!==null&&(c.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(m=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,m&&s!==null&&(m=31-Lt(o),r=y.hiddenUpdates,c=r[m],c===null?r[m]=[s]:c.push(s),s.lane=o|536870912),y):null}function $u(r){if(50<pc)throw pc=0,Vm=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var lo={};function C1(r,s,o,c){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yn(r,s,o,c){return new C1(r,s,o,c)}function If(r){return r=r.prototype,!(!r||!r.isReactComponent)}function xi(r,s){var o=r.alternate;return o===null?(o=Yn(r.tag,s,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=s,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,s=r.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function d_(r,s){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,s=o.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function Ku(r,s,o,c,m,y){var E=0;if(c=r,typeof r=="function")If(r)&&(E=1);else if(typeof r=="string")E=OA(r,o,te.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case R:return r=Yn(31,o,s,m),r.elementType=R,r.lanes=y,r;case I:return va(o.children,m,y,s);case N:E=8,m|=24;break;case H:return r=Yn(12,o,s,m|2),r.elementType=H,r.lanes=y,r;case re:return r=Yn(13,o,s,m),r.elementType=re,r.lanes=y,r;case he:return r=Yn(19,o,s,m),r.elementType=he,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case q:E=10;break e;case $:E=9;break e;case me:E=11;break e;case L:E=14;break e;case D:E=16,c=null;break e}E=29,o=Error(i(130,r===null?"null":typeof r,"")),c=null}return s=Yn(E,o,s,m),s.elementType=r,s.type=c,s.lanes=y,s}function va(r,s,o,c){return r=Yn(7,r,c,s),r.lanes=o,r}function jf(r,s,o){return r=Yn(6,r,null,s),r.lanes=o,r}function h_(r){var s=Yn(18,null,null,0);return s.stateNode=r,s}function Of(r,s,o){return s=Yn(4,r.children!==null?r.children:[],r.key,s),s.lanes=o,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var f_=new WeakMap;function hr(r,s){if(typeof r=="object"&&r!==null){var o=f_.get(r);return o!==void 0?o:(s={value:r,source:s,stack:tn(s)},f_.set(r,s),s)}return{value:r,source:s,stack:tn(s)}}var co=[],uo=0,Wu=null,Kl=0,fr=[],mr=0,cs=null,ri=1,ii="";function Ei(r,s){co[uo++]=Kl,co[uo++]=Wu,Wu=r,Kl=s}function m_(r,s,o){fr[mr++]=ri,fr[mr++]=ii,fr[mr++]=cs,cs=r;var c=ri;r=ii;var m=32-Lt(c)-1;c&=~(1<<m),o+=1;var y=32-Lt(s)+m;if(30<y){var E=m-m%5;y=(c&(1<<E)-1).toString(32),c>>=E,m-=E,ri=1<<32-Lt(s)+m|o<<m|c,ii=y+r}else ri=1<<y|o<<m|c,ii=r}function kf(r){r.return!==null&&(Ei(r,1),m_(r,1,0))}function Mf(r){for(;r===Wu;)Wu=co[--uo],co[uo]=null,Kl=co[--uo],co[uo]=null;for(;r===cs;)cs=fr[--mr],fr[mr]=null,ii=fr[--mr],fr[mr]=null,ri=fr[--mr],fr[mr]=null}function p_(r,s){fr[mr++]=ri,fr[mr++]=ii,fr[mr++]=cs,ri=s.id,ii=s.overflow,cs=r}var yn=null,xt=null,tt=!1,us=null,pr=!1,Nf=Error(i(519));function ds(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Wl(hr(s,r)),Nf}function g_(r){var s=r.stateNode,o=r.type,c=r.memoizedProps;switch(s[Ht]=r,s[un]=c,o){case"dialog":We("cancel",s),We("close",s);break;case"iframe":case"object":case"embed":We("load",s);break;case"video":case"audio":for(o=0;o<yc.length;o++)We(yc[o],s);break;case"source":We("error",s);break;case"img":case"image":case"link":We("error",s),We("load",s);break;case"details":We("toggle",s);break;case"input":We("invalid",s),Ru(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":We("invalid",s);break;case"textarea":We("invalid",s),ns(s,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||c.suppressHydrationWarning===!0||kv(s.textContent,o)?(c.popover!=null&&(We("beforetoggle",s),We("toggle",s)),c.onScroll!=null&&We("scroll",s),c.onScrollEnd!=null&&We("scrollend",s),c.onClick!=null&&(s.onclick=Ar),s=!0):s=!1,s||ds(r,!0)}function y_(r){for(yn=r.return;yn;)switch(yn.tag){case 5:case 31:case 13:pr=!1;return;case 27:case 3:pr=!0;return;default:yn=yn.return}}function ho(r){if(r!==yn)return!1;if(!tt)return y_(r),tt=!0,!1;var s=r.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||Zm(r.type,r.memoizedProps)),o=!o),o&&xt&&ds(r),y_(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));xt=Fv(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));xt=Fv(r)}else s===27?(s=xt,Ts(r.type)?(r=ip,ip=null,xt=r):xt=s):xt=yn?yr(r.stateNode.nextSibling):null;return!0}function ba(){xt=yn=null,tt=!1}function Pf(){var r=us;return r!==null&&(Un===null?Un=r:Un.push.apply(Un,r),us=null),r}function Wl(r){us===null?us=[r]:us.push(r)}var Lf=z(null),xa=null,Si=null;function hs(r,s,o){W(Lf,s._currentValue),s._currentValue=o}function wi(r){r._currentValue=Lf.current,F(Lf)}function Vf(r,s,o){for(;r!==null;){var c=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),r===o)break;r=r.return}}function zf(r,s,o,c){var m=r.child;for(m!==null&&(m.return=r);m!==null;){var y=m.dependencies;if(y!==null){var E=m.child;y=y.firstContext;e:for(;y!==null;){var k=y;y=m;for(var G=0;G<s.length;G++)if(k.context===s[G]){y.lanes|=o,k=y.alternate,k!==null&&(k.lanes|=o),Vf(y.return,o,r),c||(E=null);break e}y=k.next}}else if(m.tag===18){if(E=m.return,E===null)throw Error(i(341));E.lanes|=o,y=E.alternate,y!==null&&(y.lanes|=o),Vf(E,o,r),E=null}else E=m.child;if(E!==null)E.return=m;else for(E=m;E!==null;){if(E===r){E=null;break}if(m=E.sibling,m!==null){m.return=E.return,E=m;break}E=E.return}m=E}}function fo(r,s,o,c){r=null;for(var m=s,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var E=m.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var k=m.type;Wn(m.pendingProps.value,E.value)||(r!==null?r.push(k):r=[k])}}else if(m===de.current){if(E=m.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(r!==null?r.push(Ec):r=[Ec])}m=m.return}r!==null&&zf(s,r,o,c),s.flags|=262144}function Yu(r){for(r=r.firstContext;r!==null;){if(!Wn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ea(r){xa=r,Si=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function _n(r){return __(xa,r)}function Xu(r,s){return xa===null&&Ea(r),__(r,s)}function __(r,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Si===null){if(r===null)throw Error(i(308));Si=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else Si=Si.next=s;return o}var R1=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(o,c){r.push(c)}};this.abort=function(){s.aborted=!0,r.forEach(function(o){return o()})}},D1=t.unstable_scheduleCallback,I1=t.unstable_NormalPriority,$t={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uf(){return{controller:new R1,data:new Map,refCount:0}}function Yl(r){r.refCount--,r.refCount===0&&D1(I1,function(){r.controller.abort()})}var Xl=null,Bf=0,mo=0,po=null;function j1(r,s){if(Xl===null){var o=Xl=[];Bf=0,mo=Hm(),po={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Bf++,s.then(v_,v_),s}function v_(){if(--Bf===0&&Xl!==null){po!==null&&(po.status="fulfilled");var r=Xl;Xl=null,mo=0,po=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function O1(r,s){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return r.then(function(){c.status="fulfilled",c.value=s;for(var m=0;m<o.length;m++)(0,o[m])(s)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var b_=P.S;P.S=function(r,s){rv=Pt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&j1(r,s),b_!==null&&b_(r,s)};var Sa=z(null);function Ff(){var r=Sa.current;return r!==null?r:yt.pooledCache}function Ju(r,s){s===null?W(Sa,Sa.current):W(Sa,s.pool)}function x_(){var r=Ff();return r===null?null:{parent:$t._currentValue,pool:r}}var go=Error(i(460)),qf=Error(i(474)),Zu=Error(i(542)),ed={then:function(){}};function E_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function S_(r,s,o){switch(o=r[o],o===void 0?r.push(s):o!==s&&(s.then(Ar,Ar),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,T_(r),r;default:if(typeof s.status=="string")s.then(Ar,Ar);else{if(r=yt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(c){if(s.status==="pending"){var m=s;m.status="fulfilled",m.value=c}},function(c){if(s.status==="pending"){var m=s;m.status="rejected",m.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,T_(r),r}throw Ta=s,go}}function wa(r){try{var s=r._init;return s(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ta=o,go):o}}var Ta=null;function w_(){if(Ta===null)throw Error(i(459));var r=Ta;return Ta=null,r}function T_(r){if(r===go||r===Zu)throw Error(i(483))}var yo=null,Jl=0;function td(r){var s=Jl;return Jl+=1,yo===null&&(yo=[]),S_(yo,r,s)}function Zl(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function nd(r,s){throw s.$$typeof===x?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function A_(r){function s(X,K){if(r){var ee=X.deletions;ee===null?(X.deletions=[K],X.flags|=16):ee.push(K)}}function o(X,K){if(!r)return null;for(;K!==null;)s(X,K),K=K.sibling;return null}function c(X){for(var K=new Map;X!==null;)X.key!==null?K.set(X.key,X):K.set(X.index,X),X=X.sibling;return K}function m(X,K){return X=xi(X,K),X.index=0,X.sibling=null,X}function y(X,K,ee){return X.index=ee,r?(ee=X.alternate,ee!==null?(ee=ee.index,ee<K?(X.flags|=67108866,K):ee):(X.flags|=67108866,K)):(X.flags|=1048576,K)}function E(X){return r&&X.alternate===null&&(X.flags|=67108866),X}function k(X,K,ee,ge){return K===null||K.tag!==6?(K=jf(ee,X.mode,ge),K.return=X,K):(K=m(K,ee),K.return=X,K)}function G(X,K,ee,ge){var Oe=ee.type;return Oe===I?fe(X,K,ee.props.children,ge,ee.key):K!==null&&(K.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===D&&wa(Oe)===K.type)?(K=m(K,ee.props),Zl(K,ee),K.return=X,K):(K=Ku(ee.type,ee.key,ee.props,null,X.mode,ge),Zl(K,ee),K.return=X,K)}function ne(X,K,ee,ge){return K===null||K.tag!==4||K.stateNode.containerInfo!==ee.containerInfo||K.stateNode.implementation!==ee.implementation?(K=Of(ee,X.mode,ge),K.return=X,K):(K=m(K,ee.children||[]),K.return=X,K)}function fe(X,K,ee,ge,Oe){return K===null||K.tag!==7?(K=va(ee,X.mode,ge,Oe),K.return=X,K):(K=m(K,ee),K.return=X,K)}function ye(X,K,ee){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=jf(""+K,X.mode,ee),K.return=X,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case w:return ee=Ku(K.type,K.key,K.props,null,X.mode,ee),Zl(ee,K),ee.return=X,ee;case A:return K=Of(K,X.mode,ee),K.return=X,K;case D:return K=wa(K),ye(X,K,ee)}if(U(K)||O(K))return K=va(K,X.mode,ee,null),K.return=X,K;if(typeof K.then=="function")return ye(X,td(K),ee);if(K.$$typeof===q)return ye(X,Xu(X,K),ee);nd(X,K)}return null}function ie(X,K,ee,ge){var Oe=K!==null?K.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return Oe!==null?null:k(X,K,""+ee,ge);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case w:return ee.key===Oe?G(X,K,ee,ge):null;case A:return ee.key===Oe?ne(X,K,ee,ge):null;case D:return ee=wa(ee),ie(X,K,ee,ge)}if(U(ee)||O(ee))return Oe!==null?null:fe(X,K,ee,ge,null);if(typeof ee.then=="function")return ie(X,K,td(ee),ge);if(ee.$$typeof===q)return ie(X,K,Xu(X,ee),ge);nd(X,ee)}return null}function oe(X,K,ee,ge,Oe){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return X=X.get(ee)||null,k(K,X,""+ge,Oe);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case w:return X=X.get(ge.key===null?ee:ge.key)||null,G(K,X,ge,Oe);case A:return X=X.get(ge.key===null?ee:ge.key)||null,ne(K,X,ge,Oe);case D:return ge=wa(ge),oe(X,K,ee,ge,Oe)}if(U(ge)||O(ge))return X=X.get(ee)||null,fe(K,X,ge,Oe,null);if(typeof ge.then=="function")return oe(X,K,ee,td(ge),Oe);if(ge.$$typeof===q)return oe(X,K,ee,Xu(K,ge),Oe);nd(K,ge)}return null}function Re(X,K,ee,ge){for(var Oe=null,rt=null,Ie=K,Ge=K=0,Xe=null;Ie!==null&&Ge<ee.length;Ge++){Ie.index>Ge?(Xe=Ie,Ie=null):Xe=Ie.sibling;var it=ie(X,Ie,ee[Ge],ge);if(it===null){Ie===null&&(Ie=Xe);break}r&&Ie&&it.alternate===null&&s(X,Ie),K=y(it,K,Ge),rt===null?Oe=it:rt.sibling=it,rt=it,Ie=Xe}if(Ge===ee.length)return o(X,Ie),tt&&Ei(X,Ge),Oe;if(Ie===null){for(;Ge<ee.length;Ge++)Ie=ye(X,ee[Ge],ge),Ie!==null&&(K=y(Ie,K,Ge),rt===null?Oe=Ie:rt.sibling=Ie,rt=Ie);return tt&&Ei(X,Ge),Oe}for(Ie=c(Ie);Ge<ee.length;Ge++)Xe=oe(Ie,X,Ge,ee[Ge],ge),Xe!==null&&(r&&Xe.alternate!==null&&Ie.delete(Xe.key===null?Ge:Xe.key),K=y(Xe,K,Ge),rt===null?Oe=Xe:rt.sibling=Xe,rt=Xe);return r&&Ie.forEach(function(Is){return s(X,Is)}),tt&&Ei(X,Ge),Oe}function Pe(X,K,ee,ge){if(ee==null)throw Error(i(151));for(var Oe=null,rt=null,Ie=K,Ge=K=0,Xe=null,it=ee.next();Ie!==null&&!it.done;Ge++,it=ee.next()){Ie.index>Ge?(Xe=Ie,Ie=null):Xe=Ie.sibling;var Is=ie(X,Ie,it.value,ge);if(Is===null){Ie===null&&(Ie=Xe);break}r&&Ie&&Is.alternate===null&&s(X,Ie),K=y(Is,K,Ge),rt===null?Oe=Is:rt.sibling=Is,rt=Is,Ie=Xe}if(it.done)return o(X,Ie),tt&&Ei(X,Ge),Oe;if(Ie===null){for(;!it.done;Ge++,it=ee.next())it=ye(X,it.value,ge),it!==null&&(K=y(it,K,Ge),rt===null?Oe=it:rt.sibling=it,rt=it);return tt&&Ei(X,Ge),Oe}for(Ie=c(Ie);!it.done;Ge++,it=ee.next())it=oe(Ie,X,Ge,it.value,ge),it!==null&&(r&&it.alternate!==null&&Ie.delete(it.key===null?Ge:it.key),K=y(it,K,Ge),rt===null?Oe=it:rt.sibling=it,rt=it);return r&&Ie.forEach(function(qA){return s(X,qA)}),tt&&Ei(X,Ge),Oe}function gt(X,K,ee,ge){if(typeof ee=="object"&&ee!==null&&ee.type===I&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case w:e:{for(var Oe=ee.key;K!==null;){if(K.key===Oe){if(Oe=ee.type,Oe===I){if(K.tag===7){o(X,K.sibling),ge=m(K,ee.props.children),ge.return=X,X=ge;break e}}else if(K.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===D&&wa(Oe)===K.type){o(X,K.sibling),ge=m(K,ee.props),Zl(ge,ee),ge.return=X,X=ge;break e}o(X,K);break}else s(X,K);K=K.sibling}ee.type===I?(ge=va(ee.props.children,X.mode,ge,ee.key),ge.return=X,X=ge):(ge=Ku(ee.type,ee.key,ee.props,null,X.mode,ge),Zl(ge,ee),ge.return=X,X=ge)}return E(X);case A:e:{for(Oe=ee.key;K!==null;){if(K.key===Oe)if(K.tag===4&&K.stateNode.containerInfo===ee.containerInfo&&K.stateNode.implementation===ee.implementation){o(X,K.sibling),ge=m(K,ee.children||[]),ge.return=X,X=ge;break e}else{o(X,K);break}else s(X,K);K=K.sibling}ge=Of(ee,X.mode,ge),ge.return=X,X=ge}return E(X);case D:return ee=wa(ee),gt(X,K,ee,ge)}if(U(ee))return Re(X,K,ee,ge);if(O(ee)){if(Oe=O(ee),typeof Oe!="function")throw Error(i(150));return ee=Oe.call(ee),Pe(X,K,ee,ge)}if(typeof ee.then=="function")return gt(X,K,td(ee),ge);if(ee.$$typeof===q)return gt(X,K,Xu(X,ee),ge);nd(X,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,K!==null&&K.tag===6?(o(X,K.sibling),ge=m(K,ee),ge.return=X,X=ge):(o(X,K),ge=jf(ee,X.mode,ge),ge.return=X,X=ge),E(X)):o(X,K)}return function(X,K,ee,ge){try{Jl=0;var Oe=gt(X,K,ee,ge);return yo=null,Oe}catch(Ie){if(Ie===go||Ie===Zu)throw Ie;var rt=Yn(29,Ie,null,X.mode);return rt.lanes=ge,rt.return=X,rt}}}var Aa=A_(!0),C_=A_(!1),fs=!1;function Hf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gf(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ms(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ps(r,s,o){var c=r.updateQueue;if(c===null)return null;if(c=c.shared,(ot&2)!==0){var m=c.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),c.pending=s,s=$u(r),u_(r,null,o),s}return Qu(r,c,s,o),$u(r)}function ec(r,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var c=s.lanes;c&=r.pendingLanes,o|=c,s.lanes=o,Cl(r,o)}}function Qf(r,s){var o=r.updateQueue,c=r.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?m=y=E:y=y.next=E,o=o.next}while(o!==null);y===null?m=y=s:y=y.next=s}else m=y=s;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:c.shared,callbacks:c.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=s:r.next=s,o.lastBaseUpdate=s}var $f=!1;function tc(){if($f){var r=po;if(r!==null)throw r}}function nc(r,s,o,c){$f=!1;var m=r.updateQueue;fs=!1;var y=m.firstBaseUpdate,E=m.lastBaseUpdate,k=m.shared.pending;if(k!==null){m.shared.pending=null;var G=k,ne=G.next;G.next=null,E===null?y=ne:E.next=ne,E=G;var fe=r.alternate;fe!==null&&(fe=fe.updateQueue,k=fe.lastBaseUpdate,k!==E&&(k===null?fe.firstBaseUpdate=ne:k.next=ne,fe.lastBaseUpdate=G))}if(y!==null){var ye=m.baseState;E=0,fe=ne=G=null,k=y;do{var ie=k.lane&-536870913,oe=ie!==k.lane;if(oe?(Ye&ie)===ie:(c&ie)===ie){ie!==0&&ie===mo&&($f=!0),fe!==null&&(fe=fe.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Re=r,Pe=k;ie=s;var gt=o;switch(Pe.tag){case 1:if(Re=Pe.payload,typeof Re=="function"){ye=Re.call(gt,ye,ie);break e}ye=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Pe.payload,ie=typeof Re=="function"?Re.call(gt,ye,ie):Re,ie==null)break e;ye=v({},ye,ie);break e;case 2:fs=!0}}ie=k.callback,ie!==null&&(r.flags|=64,oe&&(r.flags|=8192),oe=m.callbacks,oe===null?m.callbacks=[ie]:oe.push(ie))}else oe={lane:ie,tag:k.tag,payload:k.payload,callback:k.callback,next:null},fe===null?(ne=fe=oe,G=ye):fe=fe.next=oe,E|=ie;if(k=k.next,k===null){if(k=m.shared.pending,k===null)break;oe=k,k=oe.next,oe.next=null,m.lastBaseUpdate=oe,m.shared.pending=null}}while(!0);fe===null&&(G=ye),m.baseState=G,m.firstBaseUpdate=ne,m.lastBaseUpdate=fe,y===null&&(m.shared.lanes=0),bs|=E,r.lanes=E,r.memoizedState=ye}}function R_(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function D_(r,s){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)R_(o[r],s)}var _o=z(null),rd=z(0);function I_(r,s){r=ki,W(rd,r),W(_o,s),ki=r|s.baseLanes}function Kf(){W(rd,ki),W(_o,_o.current)}function Wf(){ki=rd.current,F(_o),F(rd)}var Xn=z(null),gr=null;function gs(r){var s=r.alternate;W(zt,zt.current&1),W(Xn,r),gr===null&&(s===null||_o.current!==null||s.memoizedState!==null)&&(gr=r)}function Yf(r){W(zt,zt.current),W(Xn,r),gr===null&&(gr=r)}function j_(r){r.tag===22?(W(zt,zt.current),W(Xn,r),gr===null&&(gr=r)):ys()}function ys(){W(zt,zt.current),W(Xn,Xn.current)}function Jn(r){F(Xn),gr===r&&(gr=null),F(zt)}var zt=z(0);function id(r){for(var s=r;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||np(o)||rp(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ti=0,He=null,mt=null,Kt=null,sd=!1,vo=!1,Ca=!1,ad=0,rc=0,bo=null,k1=0;function kt(){throw Error(i(321))}function Xf(r,s){if(s===null)return!1;for(var o=0;o<s.length&&o<r.length;o++)if(!Wn(r[o],s[o]))return!1;return!0}function Jf(r,s,o,c,m,y){return Ti=y,He=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,P.H=r===null||r.memoizedState===null?m0:fm,Ca=!1,y=o(c,m),Ca=!1,vo&&(y=k_(s,o,c,m)),O_(r),y}function O_(r){P.H=ac;var s=mt!==null&&mt.next!==null;if(Ti=0,Kt=mt=He=null,sd=!1,rc=0,bo=null,s)throw Error(i(300));r===null||Wt||(r=r.dependencies,r!==null&&Yu(r)&&(Wt=!0))}function k_(r,s,o,c){He=r;var m=0;do{if(vo&&(bo=null),rc=0,vo=!1,25<=m)throw Error(i(301));if(m+=1,Kt=mt=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}P.H=p0,y=s(o,c)}while(vo);return y}function M1(){var r=P.H,s=r.useState()[0];return s=typeof s.then=="function"?ic(s):s,r=r.useState()[0],(mt!==null?mt.memoizedState:null)!==r&&(He.flags|=1024),s}function Zf(){var r=ad!==0;return ad=0,r}function em(r,s,o){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~o}function tm(r){if(sd){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}sd=!1}Ti=0,Kt=mt=He=null,vo=!1,rc=ad=0,bo=null}function On(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kt===null?He.memoizedState=Kt=r:Kt=Kt.next=r,Kt}function Ut(){if(mt===null){var r=He.alternate;r=r!==null?r.memoizedState:null}else r=mt.next;var s=Kt===null?He.memoizedState:Kt.next;if(s!==null)Kt=s,mt=r;else{if(r===null)throw He.alternate===null?Error(i(467)):Error(i(310));mt=r,r={memoizedState:mt.memoizedState,baseState:mt.baseState,baseQueue:mt.baseQueue,queue:mt.queue,next:null},Kt===null?He.memoizedState=Kt=r:Kt=Kt.next=r}return Kt}function od(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ic(r){var s=rc;return rc+=1,bo===null&&(bo=[]),r=S_(bo,r,s),s=He,(Kt===null?s.memoizedState:Kt.next)===null&&(s=s.alternate,P.H=s===null||s.memoizedState===null?m0:fm),r}function ld(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return ic(r);if(r.$$typeof===q)return _n(r)}throw Error(i(438,String(r)))}function nm(r){var s=null,o=He.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var c=He.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(m){return m.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=od(),He.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(r),c=0;c<r;c++)o[c]=M;return s.index++,o}function Ai(r,s){return typeof s=="function"?s(r):s}function cd(r){var s=Ut();return rm(s,mt,r)}function rm(r,s,o){var c=r.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var m=r.baseQueue,y=c.pending;if(y!==null){if(m!==null){var E=m.next;m.next=y.next,y.next=E}s.baseQueue=m=y,c.pending=null}if(y=r.baseState,m===null)r.memoizedState=y;else{s=m.next;var k=E=null,G=null,ne=s,fe=!1;do{var ye=ne.lane&-536870913;if(ye!==ne.lane?(Ye&ye)===ye:(Ti&ye)===ye){var ie=ne.revertLane;if(ie===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),ye===mo&&(fe=!0);else if((Ti&ie)===ie){ne=ne.next,ie===mo&&(fe=!0);continue}else ye={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},G===null?(k=G=ye,E=y):G=G.next=ye,He.lanes|=ie,bs|=ie;ye=ne.action,Ca&&o(y,ye),y=ne.hasEagerState?ne.eagerState:o(y,ye)}else ie={lane:ye,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},G===null?(k=G=ie,E=y):G=G.next=ie,He.lanes|=ye,bs|=ye;ne=ne.next}while(ne!==null&&ne!==s);if(G===null?E=y:G.next=k,!Wn(y,r.memoizedState)&&(Wt=!0,fe&&(o=po,o!==null)))throw o;r.memoizedState=y,r.baseState=E,r.baseQueue=G,c.lastRenderedState=y}return m===null&&(c.lanes=0),[r.memoizedState,c.dispatch]}function im(r){var s=Ut(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var c=o.dispatch,m=o.pending,y=s.memoizedState;if(m!==null){o.pending=null;var E=m=m.next;do y=r(y,E.action),E=E.next;while(E!==m);Wn(y,s.memoizedState)||(Wt=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,c]}function M_(r,s,o){var c=He,m=Ut(),y=tt;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var E=!Wn((mt||m).memoizedState,o);if(E&&(m.memoizedState=o,Wt=!0),m=m.queue,om(L_.bind(null,c,m,r),[r]),m.getSnapshot!==s||E||Kt!==null&&Kt.memoizedState.tag&1){if(c.flags|=2048,xo(9,{destroy:void 0},P_.bind(null,c,m,o,s),null),yt===null)throw Error(i(349));y||(Ti&127)!==0||N_(c,s,o)}return o}function N_(r,s,o){r.flags|=16384,r={getSnapshot:s,value:o},s=He.updateQueue,s===null?(s=od(),He.updateQueue=s,s.stores=[r]):(o=s.stores,o===null?s.stores=[r]:o.push(r))}function P_(r,s,o,c){s.value=o,s.getSnapshot=c,V_(s)&&z_(r)}function L_(r,s,o){return o(function(){V_(s)&&z_(r)})}function V_(r){var s=r.getSnapshot;r=r.value;try{var o=s();return!Wn(r,o)}catch{return!0}}function z_(r){var s=_a(r,2);s!==null&&Bn(s,r,2)}function sm(r){var s=On();if(typeof r=="function"){var o=r;if(r=o(),Ca){ar(!0);try{o()}finally{ar(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:r},s}function U_(r,s,o,c){return r.baseState=o,rm(r,mt,typeof c=="function"?c:Ai)}function N1(r,s,o,c,m){if(hd(r))throw Error(i(485));if(r=s.action,r!==null){var y={payload:m,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){y.listeners.push(E)}};P.T!==null?o(!0):y.isTransition=!1,c(y),o=s.pending,o===null?(y.next=s.pending=y,B_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function B_(r,s){var o=s.action,c=s.payload,m=r.state;if(s.isTransition){var y=P.T,E={};P.T=E;try{var k=o(m,c),G=P.S;G!==null&&G(E,k),F_(r,s,k)}catch(ne){am(r,s,ne)}finally{y!==null&&E.types!==null&&(y.types=E.types),P.T=y}}else try{y=o(m,c),F_(r,s,y)}catch(ne){am(r,s,ne)}}function F_(r,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){q_(r,s,c)},function(c){return am(r,s,c)}):q_(r,s,o)}function q_(r,s,o){s.status="fulfilled",s.value=o,H_(s),r.state=o,s=r.pending,s!==null&&(o=s.next,o===s?r.pending=null:(o=o.next,s.next=o,B_(r,o)))}function am(r,s,o){var c=r.pending;if(r.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=o,H_(s),s=s.next;while(s!==c)}r.action=null}function H_(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function G_(r,s){return s}function Q_(r,s){if(tt){var o=yt.formState;if(o!==null){e:{var c=He;if(tt){if(xt){t:{for(var m=xt,y=pr;m.nodeType!==8;){if(!y){m=null;break t}if(m=yr(m.nextSibling),m===null){m=null;break t}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){xt=yr(m.nextSibling),c=m.data==="F!";break e}}ds(c)}c=!1}c&&(s=o[0])}}return o=On(),o.memoizedState=o.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:G_,lastRenderedState:s},o.queue=c,o=d0.bind(null,He,c),c.dispatch=o,c=sm(!1),y=hm.bind(null,He,!1,c.queue),c=On(),m={state:s,dispatch:null,action:r,pending:null},c.queue=m,o=N1.bind(null,He,m,y,o),m.dispatch=o,c.memoizedState=r,[s,o,!1]}function $_(r){var s=Ut();return K_(s,mt,r)}function K_(r,s,o){if(s=rm(r,s,G_)[0],r=cd(Ai)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=ic(s)}catch(E){throw E===go?Zu:E}else c=s;s=Ut();var m=s.queue,y=m.dispatch;return o!==s.memoizedState&&(He.flags|=2048,xo(9,{destroy:void 0},P1.bind(null,m,o),null)),[c,y,r]}function P1(r,s){r.action=s}function W_(r){var s=Ut(),o=mt;if(o!==null)return K_(s,o,r);Ut(),s=s.memoizedState,o=Ut();var c=o.queue.dispatch;return o.memoizedState=r,[s,c,!1]}function xo(r,s,o,c){return r={tag:r,create:o,deps:c,inst:s,next:null},s=He.updateQueue,s===null&&(s=od(),He.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=r.next=r:(c=o.next,o.next=r,r.next=c,s.lastEffect=r),r}function Y_(){return Ut().memoizedState}function ud(r,s,o,c){var m=On();He.flags|=r,m.memoizedState=xo(1|s,{destroy:void 0},o,c===void 0?null:c)}function dd(r,s,o,c){var m=Ut();c=c===void 0?null:c;var y=m.memoizedState.inst;mt!==null&&c!==null&&Xf(c,mt.memoizedState.deps)?m.memoizedState=xo(s,y,o,c):(He.flags|=r,m.memoizedState=xo(1|s,y,o,c))}function X_(r,s){ud(8390656,8,r,s)}function om(r,s){dd(2048,8,r,s)}function L1(r){He.flags|=4;var s=He.updateQueue;if(s===null)s=od(),He.updateQueue=s,s.events=[r];else{var o=s.events;o===null?s.events=[r]:o.push(r)}}function J_(r){var s=Ut().memoizedState;return L1({ref:s,nextImpl:r}),function(){if((ot&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function Z_(r,s){return dd(4,2,r,s)}function e0(r,s){return dd(4,4,r,s)}function t0(r,s){if(typeof s=="function"){r=r();var o=s(r);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function n0(r,s,o){o=o!=null?o.concat([r]):null,dd(4,4,t0.bind(null,s,r),o)}function lm(){}function r0(r,s){var o=Ut();s=s===void 0?null:s;var c=o.memoizedState;return s!==null&&Xf(s,c[1])?c[0]:(o.memoizedState=[r,s],r)}function i0(r,s){var o=Ut();s=s===void 0?null:s;var c=o.memoizedState;if(s!==null&&Xf(s,c[1]))return c[0];if(c=r(),Ca){ar(!0);try{r()}finally{ar(!1)}}return o.memoizedState=[c,s],c}function cm(r,s,o){return o===void 0||(Ti&1073741824)!==0&&(Ye&261930)===0?r.memoizedState=s:(r.memoizedState=o,r=sv(),He.lanes|=r,bs|=r,o)}function s0(r,s,o,c){return Wn(o,s)?o:_o.current!==null?(r=cm(r,o,c),Wn(r,s)||(Wt=!0),r):(Ti&42)===0||(Ti&1073741824)!==0&&(Ye&261930)===0?(Wt=!0,r.memoizedState=o):(r=sv(),He.lanes|=r,bs|=r,s)}function a0(r,s,o,c,m){var y=B.p;B.p=y!==0&&8>y?y:8;var E=P.T,k={};P.T=k,hm(r,!1,s,o);try{var G=m(),ne=P.S;if(ne!==null&&ne(k,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var fe=O1(G,c);sc(r,s,fe,tr(r))}else sc(r,s,c,tr(r))}catch(ye){sc(r,s,{then:function(){},status:"rejected",reason:ye},tr())}finally{B.p=y,E!==null&&k.types!==null&&(E.types=k.types),P.T=E}}function V1(){}function um(r,s,o,c){if(r.tag!==5)throw Error(i(476));var m=o0(r).queue;a0(r,m,s,Q,o===null?V1:function(){return l0(r),o(c)})}function o0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:Q},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:o},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function l0(r){var s=o0(r);s.next===null&&(s=r.alternate.memoizedState),sc(r,s.next.queue,{},tr())}function dm(){return _n(Ec)}function c0(){return Ut().memoizedState}function u0(){return Ut().memoizedState}function z1(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var o=tr();r=ms(o);var c=ps(s,r,o);c!==null&&(Bn(c,s,o),ec(c,s,o)),s={cache:Uf()},r.payload=s;return}s=s.return}}function U1(r,s,o){var c=tr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},hd(r)?h0(s,o):(o=Df(r,s,o,c),o!==null&&(Bn(o,r,c),f0(o,s,c)))}function d0(r,s,o){var c=tr();sc(r,s,o,c)}function sc(r,s,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(hd(r))h0(s,m);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var E=s.lastRenderedState,k=y(E,o);if(m.hasEagerState=!0,m.eagerState=k,Wn(k,E))return Qu(r,s,m,0),yt===null&&Gu(),!1}catch{}if(o=Df(r,s,m,c),o!==null)return Bn(o,r,c),f0(o,s,c),!0}return!1}function hm(r,s,o,c){if(c={lane:2,revertLane:Hm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},hd(r)){if(s)throw Error(i(479))}else s=Df(r,o,c,2),s!==null&&Bn(s,r,2)}function hd(r){var s=r.alternate;return r===He||s!==null&&s===He}function h0(r,s){vo=sd=!0;var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}function f0(r,s,o){if((o&4194048)!==0){var c=s.lanes;c&=r.pendingLanes,o|=c,s.lanes=o,Cl(r,o)}}var ac={readContext:_n,use:ld,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useLayoutEffect:kt,useInsertionEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useSyncExternalStore:kt,useId:kt,useHostTransitionStatus:kt,useFormState:kt,useActionState:kt,useOptimistic:kt,useMemoCache:kt,useCacheRefresh:kt};ac.useEffectEvent=kt;var m0={readContext:_n,use:ld,useCallback:function(r,s){return On().memoizedState=[r,s===void 0?null:s],r},useContext:_n,useEffect:X_,useImperativeHandle:function(r,s,o){o=o!=null?o.concat([r]):null,ud(4194308,4,t0.bind(null,s,r),o)},useLayoutEffect:function(r,s){return ud(4194308,4,r,s)},useInsertionEffect:function(r,s){ud(4,2,r,s)},useMemo:function(r,s){var o=On();s=s===void 0?null:s;var c=r();if(Ca){ar(!0);try{r()}finally{ar(!1)}}return o.memoizedState=[c,s],c},useReducer:function(r,s,o){var c=On();if(o!==void 0){var m=o(s);if(Ca){ar(!0);try{o(s)}finally{ar(!1)}}}else m=s;return c.memoizedState=c.baseState=m,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:m},c.queue=r,r=r.dispatch=U1.bind(null,He,r),[c.memoizedState,r]},useRef:function(r){var s=On();return r={current:r},s.memoizedState=r},useState:function(r){r=sm(r);var s=r.queue,o=d0.bind(null,He,s);return s.dispatch=o,[r.memoizedState,o]},useDebugValue:lm,useDeferredValue:function(r,s){var o=On();return cm(o,r,s)},useTransition:function(){var r=sm(!1);return r=a0.bind(null,He,r.queue,!0,!1),On().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,o){var c=He,m=On();if(tt){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),yt===null)throw Error(i(349));(Ye&127)!==0||N_(c,s,o)}m.memoizedState=o;var y={value:o,getSnapshot:s};return m.queue=y,X_(L_.bind(null,c,y,r),[r]),c.flags|=2048,xo(9,{destroy:void 0},P_.bind(null,c,y,o,s),null),o},useId:function(){var r=On(),s=yt.identifierPrefix;if(tt){var o=ii,c=ri;o=(c&~(1<<32-Lt(c)-1)).toString(32)+o,s="_"+s+"R_"+o,o=ad++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=k1++,s="_"+s+"r_"+o.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:dm,useFormState:Q_,useActionState:Q_,useOptimistic:function(r){var s=On();s.memoizedState=s.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=hm.bind(null,He,!0,o),o.dispatch=s,[r,s]},useMemoCache:nm,useCacheRefresh:function(){return On().memoizedState=z1.bind(null,He)},useEffectEvent:function(r){var s=On(),o={impl:r};return s.memoizedState=o,function(){if((ot&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},fm={readContext:_n,use:ld,useCallback:r0,useContext:_n,useEffect:om,useImperativeHandle:n0,useInsertionEffect:Z_,useLayoutEffect:e0,useMemo:i0,useReducer:cd,useRef:Y_,useState:function(){return cd(Ai)},useDebugValue:lm,useDeferredValue:function(r,s){var o=Ut();return s0(o,mt.memoizedState,r,s)},useTransition:function(){var r=cd(Ai)[0],s=Ut().memoizedState;return[typeof r=="boolean"?r:ic(r),s]},useSyncExternalStore:M_,useId:c0,useHostTransitionStatus:dm,useFormState:$_,useActionState:$_,useOptimistic:function(r,s){var o=Ut();return U_(o,mt,r,s)},useMemoCache:nm,useCacheRefresh:u0};fm.useEffectEvent=J_;var p0={readContext:_n,use:ld,useCallback:r0,useContext:_n,useEffect:om,useImperativeHandle:n0,useInsertionEffect:Z_,useLayoutEffect:e0,useMemo:i0,useReducer:im,useRef:Y_,useState:function(){return im(Ai)},useDebugValue:lm,useDeferredValue:function(r,s){var o=Ut();return mt===null?cm(o,r,s):s0(o,mt.memoizedState,r,s)},useTransition:function(){var r=im(Ai)[0],s=Ut().memoizedState;return[typeof r=="boolean"?r:ic(r),s]},useSyncExternalStore:M_,useId:c0,useHostTransitionStatus:dm,useFormState:W_,useActionState:W_,useOptimistic:function(r,s){var o=Ut();return mt!==null?U_(o,mt,r,s):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:nm,useCacheRefresh:u0};p0.useEffectEvent=J_;function mm(r,s,o,c){s=r.memoizedState,o=o(c,s),o=o==null?s:v({},s,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var pm={enqueueSetState:function(r,s,o){r=r._reactInternals;var c=tr(),m=ms(c);m.payload=s,o!=null&&(m.callback=o),s=ps(r,m,c),s!==null&&(Bn(s,r,c),ec(s,r,c))},enqueueReplaceState:function(r,s,o){r=r._reactInternals;var c=tr(),m=ms(c);m.tag=1,m.payload=s,o!=null&&(m.callback=o),s=ps(r,m,c),s!==null&&(Bn(s,r,c),ec(s,r,c))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var o=tr(),c=ms(o);c.tag=2,s!=null&&(c.callback=s),s=ps(r,c,o),s!==null&&(Bn(s,r,o),ec(s,r,o))}};function g0(r,s,o,c,m,y,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(c,y,E):s.prototype&&s.prototype.isPureReactComponent?!Ql(o,c)||!Ql(m,y):!0}function y0(r,s,o,c){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,c),s.state!==r&&pm.enqueueReplaceState(s,s.state,null)}function Ra(r,s){var o=s;if("ref"in s){o={};for(var c in s)c!=="ref"&&(o[c]=s[c])}if(r=r.defaultProps){o===s&&(o=v({},o));for(var m in r)o[m]===void 0&&(o[m]=r[m])}return o}function _0(r){Hu(r)}function v0(r){console.error(r)}function b0(r){Hu(r)}function fd(r,s){try{var o=r.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function x0(r,s,o){try{var c=r.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function gm(r,s,o){return o=ms(o),o.tag=3,o.payload={element:null},o.callback=function(){fd(r,s)},o}function E0(r){return r=ms(r),r.tag=3,r}function S0(r,s,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var y=c.value;r.payload=function(){return m(y)},r.callback=function(){x0(s,o,c)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(r.callback=function(){x0(s,o,c),typeof m!="function"&&(xs===null?xs=new Set([this]):xs.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})})}function B1(r,s,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=o.alternate,s!==null&&fo(s,o,m,!0),o=Xn.current,o!==null){switch(o.tag){case 31:case 13:return gr===null?Td():o.alternate===null&&Mt===0&&(Mt=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===ed?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([c]):s.add(c),Bm(r,c,m)),!1;case 22:return o.flags|=65536,c===ed?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([c]):o.add(c)),Bm(r,c,m)),!1}throw Error(i(435,o.tag))}return Bm(r,c,m),Td(),!1}if(tt)return s=Xn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=m,c!==Nf&&(r=Error(i(422),{cause:c}),Wl(hr(r,o)))):(c!==Nf&&(s=Error(i(423),{cause:c}),Wl(hr(s,o))),r=r.current.alternate,r.flags|=65536,m&=-m,r.lanes|=m,c=hr(c,o),m=gm(r.stateNode,c,m),Qf(r,m),Mt!==4&&(Mt=2)),!1;var y=Error(i(520),{cause:c});if(y=hr(y,o),mc===null?mc=[y]:mc.push(y),Mt!==4&&(Mt=2),s===null)return!0;c=hr(c,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,r=m&-m,o.lanes|=r,r=gm(o.stateNode,c,r),Qf(o,r),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(xs===null||!xs.has(y))))return o.flags|=65536,m&=-m,o.lanes|=m,m=E0(m),S0(m,r,o,c),Qf(o,m),!1}o=o.return}while(o!==null);return!1}var ym=Error(i(461)),Wt=!1;function vn(r,s,o,c){s.child=r===null?C_(s,null,o,c):Aa(s,r.child,o,c)}function w0(r,s,o,c,m){o=o.render;var y=s.ref;if("ref"in c){var E={};for(var k in c)k!=="ref"&&(E[k]=c[k])}else E=c;return Ea(s),c=Jf(r,s,o,E,y,m),k=Zf(),r!==null&&!Wt?(em(r,s,m),Ci(r,s,m)):(tt&&k&&kf(s),s.flags|=1,vn(r,s,c,m),s.child)}function T0(r,s,o,c,m){if(r===null){var y=o.type;return typeof y=="function"&&!If(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,A0(r,s,y,c,m)):(r=Ku(o.type,null,c,s,s.mode,m),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,!Tm(r,m)){var E=y.memoizedProps;if(o=o.compare,o=o!==null?o:Ql,o(E,c)&&r.ref===s.ref)return Ci(r,s,m)}return s.flags|=1,r=xi(y,c),r.ref=s.ref,r.return=s,s.child=r}function A0(r,s,o,c,m){if(r!==null){var y=r.memoizedProps;if(Ql(y,c)&&r.ref===s.ref)if(Wt=!1,s.pendingProps=c=y,Tm(r,m))(r.flags&131072)!==0&&(Wt=!0);else return s.lanes=r.lanes,Ci(r,s,m)}return _m(r,s,o,c,m)}function C0(r,s,o,c){var m=c.children,y=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(c=s.child=r.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~y}else c=0,s.child=null;return R0(r,s,y,o,c)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&Ju(s,y!==null?y.cachePool:null),y!==null?I_(s,y):Kf(),j_(s);else return c=s.lanes=536870912,R0(r,s,y!==null?y.baseLanes|o:o,o,c)}else y!==null?(Ju(s,y.cachePool),I_(s,y),ys(),s.memoizedState=null):(r!==null&&Ju(s,null),Kf(),ys());return vn(r,s,m,o),s.child}function oc(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function R0(r,s,o,c,m){var y=Ff();return y=y===null?null:{parent:$t._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},r!==null&&Ju(s,null),Kf(),j_(s),r!==null&&fo(r,s,c,!0),s.childLanes=m,null}function md(r,s){return s=gd({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function D0(r,s,o){return Aa(s,r.child,null,o),r=md(s,s.pendingProps),r.flags|=2,Jn(s),s.memoizedState=null,r}function F1(r,s,o){var c=s.pendingProps,m=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(tt){if(c.mode==="hidden")return r=md(s,c),s.lanes=536870912,oc(null,r);if(Yf(s),(r=xt)?(r=Bv(r,pr),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:cs!==null?{id:ri,overflow:ii}:null,retryLane:536870912,hydrationErrors:null},o=h_(r),o.return=s,s.child=o,yn=s,xt=null)):r=null,r===null)throw ds(s);return s.lanes=536870912,null}return md(s,c)}var y=r.memoizedState;if(y!==null){var E=y.dehydrated;if(Yf(s),m)if(s.flags&256)s.flags&=-257,s=D0(r,s,o);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(Wt||fo(r,s,o,!1),m=(o&r.childLanes)!==0,Wt||m){if(c=yt,c!==null&&(E=Rl(c,o),E!==0&&E!==y.retryLane))throw y.retryLane=E,_a(r,E),Bn(c,r,E),ym;Td(),s=D0(r,s,o)}else r=y.treeContext,xt=yr(E.nextSibling),yn=s,tt=!0,us=null,pr=!1,r!==null&&p_(s,r),s=md(s,c),s.flags|=4096;return s}return r=xi(r.child,{mode:c.mode,children:c.children}),r.ref=s.ref,s.child=r,r.return=s,r}function pd(r,s){var o=s.ref;if(o===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(r===null||r.ref!==o)&&(s.flags|=4194816)}}function _m(r,s,o,c,m){return Ea(s),o=Jf(r,s,o,c,void 0,m),c=Zf(),r!==null&&!Wt?(em(r,s,m),Ci(r,s,m)):(tt&&c&&kf(s),s.flags|=1,vn(r,s,o,m),s.child)}function I0(r,s,o,c,m,y){return Ea(s),s.updateQueue=null,o=k_(s,c,o,m),O_(r),c=Zf(),r!==null&&!Wt?(em(r,s,y),Ci(r,s,y)):(tt&&c&&kf(s),s.flags|=1,vn(r,s,o,y),s.child)}function j0(r,s,o,c,m){if(Ea(s),s.stateNode===null){var y=lo,E=o.contextType;typeof E=="object"&&E!==null&&(y=_n(E)),y=new o(c,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=pm,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=c,y.state=s.memoizedState,y.refs={},Hf(s),E=o.contextType,y.context=typeof E=="object"&&E!==null?_n(E):lo,y.state=s.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(mm(s,o,E,c),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(E=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),E!==y.state&&pm.enqueueReplaceState(y,y.state,null),nc(s,c,y,m),tc(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(r===null){y=s.stateNode;var k=s.memoizedProps,G=Ra(o,k);y.props=G;var ne=y.context,fe=o.contextType;E=lo,typeof fe=="object"&&fe!==null&&(E=_n(fe));var ye=o.getDerivedStateFromProps;fe=typeof ye=="function"||typeof y.getSnapshotBeforeUpdate=="function",k=s.pendingProps!==k,fe||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(k||ne!==E)&&y0(s,y,c,E),fs=!1;var ie=s.memoizedState;y.state=ie,nc(s,c,y,m),tc(),ne=s.memoizedState,k||ie!==ne||fs?(typeof ye=="function"&&(mm(s,o,ye,c),ne=s.memoizedState),(G=fs||g0(s,o,G,c,ie,ne,E))?(fe||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=ne),y.props=c,y.state=ne,y.context=E,c=G):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{y=s.stateNode,Gf(r,s),E=s.memoizedProps,fe=Ra(o,E),y.props=fe,ye=s.pendingProps,ie=y.context,ne=o.contextType,G=lo,typeof ne=="object"&&ne!==null&&(G=_n(ne)),k=o.getDerivedStateFromProps,(ne=typeof k=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(E!==ye||ie!==G)&&y0(s,y,c,G),fs=!1,ie=s.memoizedState,y.state=ie,nc(s,c,y,m),tc();var oe=s.memoizedState;E!==ye||ie!==oe||fs||r!==null&&r.dependencies!==null&&Yu(r.dependencies)?(typeof k=="function"&&(mm(s,o,k,c),oe=s.memoizedState),(fe=fs||g0(s,o,fe,c,ie,oe,G)||r!==null&&r.dependencies!==null&&Yu(r.dependencies))?(ne||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(c,oe,G),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(c,oe,G)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&ie===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&ie===r.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=oe),y.props=c,y.state=oe,y.context=G,c=fe):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&ie===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&ie===r.memoizedState||(s.flags|=1024),c=!1)}return y=c,pd(r,s),c=(s.flags&128)!==0,y||c?(y=s.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,r!==null&&c?(s.child=Aa(s,r.child,null,m),s.child=Aa(s,null,o,m)):vn(r,s,o,m),s.memoizedState=y.state,r=s.child):r=Ci(r,s,m),r}function O0(r,s,o,c){return ba(),s.flags|=256,vn(r,s,o,c),s.child}var vm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bm(r){return{baseLanes:r,cachePool:x_()}}function xm(r,s,o){return r=r!==null?r.childLanes&~o:0,s&&(r|=er),r}function k0(r,s,o){var c=s.pendingProps,m=!1,y=(s.flags&128)!==0,E;if((E=y)||(E=r!==null&&r.memoizedState===null?!1:(zt.current&2)!==0),E&&(m=!0,s.flags&=-129),E=(s.flags&32)!==0,s.flags&=-33,r===null){if(tt){if(m?gs(s):ys(),(r=xt)?(r=Bv(r,pr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:cs!==null?{id:ri,overflow:ii}:null,retryLane:536870912,hydrationErrors:null},o=h_(r),o.return=s,s.child=o,yn=s,xt=null)):r=null,r===null)throw ds(s);return rp(r)?s.lanes=32:s.lanes=536870912,null}var k=c.children;return c=c.fallback,m?(ys(),m=s.mode,k=gd({mode:"hidden",children:k},m),c=va(c,m,o,null),k.return=s,c.return=s,k.sibling=c,s.child=k,c=s.child,c.memoizedState=bm(o),c.childLanes=xm(r,E,o),s.memoizedState=vm,oc(null,c)):(gs(s),Em(s,k))}var G=r.memoizedState;if(G!==null&&(k=G.dehydrated,k!==null)){if(y)s.flags&256?(gs(s),s.flags&=-257,s=Sm(r,s,o)):s.memoizedState!==null?(ys(),s.child=r.child,s.flags|=128,s=null):(ys(),k=c.fallback,m=s.mode,c=gd({mode:"visible",children:c.children},m),k=va(k,m,o,null),k.flags|=2,c.return=s,k.return=s,c.sibling=k,s.child=c,Aa(s,r.child,null,o),c=s.child,c.memoizedState=bm(o),c.childLanes=xm(r,E,o),s.memoizedState=vm,s=oc(null,c));else if(gs(s),rp(k)){if(E=k.nextSibling&&k.nextSibling.dataset,E)var ne=E.dgst;E=ne,c=Error(i(419)),c.stack="",c.digest=E,Wl({value:c,source:null,stack:null}),s=Sm(r,s,o)}else if(Wt||fo(r,s,o,!1),E=(o&r.childLanes)!==0,Wt||E){if(E=yt,E!==null&&(c=Rl(E,o),c!==0&&c!==G.retryLane))throw G.retryLane=c,_a(r,c),Bn(E,r,c),ym;np(k)||Td(),s=Sm(r,s,o)}else np(k)?(s.flags|=192,s.child=r.child,s=null):(r=G.treeContext,xt=yr(k.nextSibling),yn=s,tt=!0,us=null,pr=!1,r!==null&&p_(s,r),s=Em(s,c.children),s.flags|=4096);return s}return m?(ys(),k=c.fallback,m=s.mode,G=r.child,ne=G.sibling,c=xi(G,{mode:"hidden",children:c.children}),c.subtreeFlags=G.subtreeFlags&65011712,ne!==null?k=xi(ne,k):(k=va(k,m,o,null),k.flags|=2),k.return=s,c.return=s,c.sibling=k,s.child=c,oc(null,c),c=s.child,k=r.child.memoizedState,k===null?k=bm(o):(m=k.cachePool,m!==null?(G=$t._currentValue,m=m.parent!==G?{parent:G,pool:G}:m):m=x_(),k={baseLanes:k.baseLanes|o,cachePool:m}),c.memoizedState=k,c.childLanes=xm(r,E,o),s.memoizedState=vm,oc(r.child,c)):(gs(s),o=r.child,r=o.sibling,o=xi(o,{mode:"visible",children:c.children}),o.return=s,o.sibling=null,r!==null&&(E=s.deletions,E===null?(s.deletions=[r],s.flags|=16):E.push(r)),s.child=o,s.memoizedState=null,o)}function Em(r,s){return s=gd({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function gd(r,s){return r=Yn(22,r,null,s),r.lanes=0,r}function Sm(r,s,o){return Aa(s,r.child,null,o),r=Em(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function M0(r,s,o){r.lanes|=s;var c=r.alternate;c!==null&&(c.lanes|=s),Vf(r.return,s,o)}function wm(r,s,o,c,m,y){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:y}:(E.isBackwards=s,E.rendering=null,E.renderingStartTime=0,E.last=c,E.tail=o,E.tailMode=m,E.treeForkCount=y)}function N0(r,s,o){var c=s.pendingProps,m=c.revealOrder,y=c.tail;c=c.children;var E=zt.current,k=(E&2)!==0;if(k?(E=E&1|2,s.flags|=128):E&=1,W(zt,E),vn(r,s,c,o),c=tt?Kl:0,!k&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&M0(r,o,s);else if(r.tag===19)M0(r,o,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(m){case"forwards":for(o=s.child,m=null;o!==null;)r=o.alternate,r!==null&&id(r)===null&&(m=o),o=o.sibling;o=m,o===null?(m=s.child,s.child=null):(m=o.sibling,o.sibling=null),wm(s,!1,m,o,y,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=s.child,s.child=null;m!==null;){if(r=m.alternate,r!==null&&id(r)===null){s.child=m;break}r=m.sibling,m.sibling=o,o=m,m=r}wm(s,!0,o,null,y,c);break;case"together":wm(s,!1,null,null,void 0,c);break;default:s.memoizedState=null}return s.child}function Ci(r,s,o){if(r!==null&&(s.dependencies=r.dependencies),bs|=s.lanes,(o&s.childLanes)===0)if(r!==null){if(fo(r,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,o=xi(r,r.pendingProps),s.child=o,o.return=s;r.sibling!==null;)r=r.sibling,o=o.sibling=xi(r,r.pendingProps),o.return=s;o.sibling=null}return s.child}function Tm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&Yu(r)))}function q1(r,s,o){switch(s.tag){case 3:be(s,s.stateNode.containerInfo),hs(s,$t,r.memoizedState.cache),ba();break;case 27:case 5:ce(s);break;case 4:be(s,s.stateNode.containerInfo);break;case 10:hs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Yf(s),null;break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(gs(s),s.flags|=128,null):(o&s.child.childLanes)!==0?k0(r,s,o):(gs(s),r=Ci(r,s,o),r!==null?r.sibling:null);gs(s);break;case 19:var m=(r.flags&128)!==0;if(c=(o&s.childLanes)!==0,c||(fo(r,s,o,!1),c=(o&s.childLanes)!==0),m){if(c)return N0(r,s,o);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),W(zt,zt.current),c)break;return null;case 22:return s.lanes=0,C0(r,s,o,s.pendingProps);case 24:hs(s,$t,r.memoizedState.cache)}return Ci(r,s,o)}function P0(r,s,o){if(r!==null)if(r.memoizedProps!==s.pendingProps)Wt=!0;else{if(!Tm(r,o)&&(s.flags&128)===0)return Wt=!1,q1(r,s,o);Wt=(r.flags&131072)!==0}else Wt=!1,tt&&(s.flags&1048576)!==0&&m_(s,Kl,s.index);switch(s.lanes=0,s.tag){case 16:e:{var c=s.pendingProps;if(r=wa(s.elementType),s.type=r,typeof r=="function")If(r)?(c=Ra(r,c),s.tag=1,s=j0(null,s,r,c,o)):(s.tag=0,s=_m(null,s,r,c,o));else{if(r!=null){var m=r.$$typeof;if(m===me){s.tag=11,s=w0(null,s,r,c,o);break e}else if(m===L){s.tag=14,s=T0(null,s,r,c,o);break e}}throw s=Y(r)||r,Error(i(306,s,""))}}return s;case 0:return _m(r,s,s.type,s.pendingProps,o);case 1:return c=s.type,m=Ra(c,s.pendingProps),j0(r,s,c,m,o);case 3:e:{if(be(s,s.stateNode.containerInfo),r===null)throw Error(i(387));c=s.pendingProps;var y=s.memoizedState;m=y.element,Gf(r,s),nc(s,c,null,o);var E=s.memoizedState;if(c=E.cache,hs(s,$t,c),c!==y.cache&&zf(s,[$t],o,!0),tc(),c=E.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:E.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=O0(r,s,c,o);break e}else if(c!==m){m=hr(Error(i(424)),s),Wl(m),s=O0(r,s,c,o);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,xt=yr(r.firstChild),yn=s,tt=!0,us=null,pr=!0,o=C_(s,null,c,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ba(),c===m){s=Ci(r,s,o);break e}vn(r,s,c,o)}s=s.child}return s;case 26:return pd(r,s),r===null?(o=$v(s.type,null,s.pendingProps,null))?s.memoizedState=o:tt||(o=s.type,r=s.pendingProps,c=Od(pe.current).createElement(o),c[Ht]=s,c[un]=r,bn(c,o,r),Gt(c),s.stateNode=c):s.memoizedState=$v(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return ce(s),r===null&&tt&&(c=s.stateNode=Hv(s.type,s.pendingProps,pe.current),yn=s,pr=!0,m=xt,Ts(s.type)?(ip=m,xt=yr(c.firstChild)):xt=m),vn(r,s,s.pendingProps.children,o),pd(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&tt&&((m=c=xt)&&(c=vA(c,s.type,s.pendingProps,pr),c!==null?(s.stateNode=c,yn=s,xt=yr(c.firstChild),pr=!1,m=!0):m=!1),m||ds(s)),ce(s),m=s.type,y=s.pendingProps,E=r!==null?r.memoizedProps:null,c=y.children,Zm(m,y)?c=null:E!==null&&Zm(m,E)&&(s.flags|=32),s.memoizedState!==null&&(m=Jf(r,s,M1,null,null,o),Ec._currentValue=m),pd(r,s),vn(r,s,c,o),s.child;case 6:return r===null&&tt&&((r=o=xt)&&(o=bA(o,s.pendingProps,pr),o!==null?(s.stateNode=o,yn=s,xt=null,r=!0):r=!1),r||ds(s)),null;case 13:return k0(r,s,o);case 4:return be(s,s.stateNode.containerInfo),c=s.pendingProps,r===null?s.child=Aa(s,null,c,o):vn(r,s,c,o),s.child;case 11:return w0(r,s,s.type,s.pendingProps,o);case 7:return vn(r,s,s.pendingProps,o),s.child;case 8:return vn(r,s,s.pendingProps.children,o),s.child;case 12:return vn(r,s,s.pendingProps.children,o),s.child;case 10:return c=s.pendingProps,hs(s,s.type,c.value),vn(r,s,c.children,o),s.child;case 9:return m=s.type._context,c=s.pendingProps.children,Ea(s),m=_n(m),c=c(m),s.flags|=1,vn(r,s,c,o),s.child;case 14:return T0(r,s,s.type,s.pendingProps,o);case 15:return A0(r,s,s.type,s.pendingProps,o);case 19:return N0(r,s,o);case 31:return F1(r,s,o);case 22:return C0(r,s,o,s.pendingProps);case 24:return Ea(s),c=_n($t),r===null?(m=Ff(),m===null&&(m=yt,y=Uf(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=o),m=y),s.memoizedState={parent:c,cache:m},Hf(s),hs(s,$t,m)):((r.lanes&o)!==0&&(Gf(r,s),nc(s,null,null,o),tc()),m=r.memoizedState,y=s.memoizedState,m.parent!==c?(m={parent:c,cache:c},s.memoizedState=m,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=m),hs(s,$t,c)):(c=y.cache,hs(s,$t,c),c!==m.cache&&zf(s,[$t],o,!0))),vn(r,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Ri(r){r.flags|=4}function Am(r,s,o,c,m){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(m&335544128)===m)if(r.stateNode.complete)r.flags|=8192;else if(cv())r.flags|=8192;else throw Ta=ed,qf}else r.flags&=-16777217}function L0(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Jv(s))if(cv())r.flags|=8192;else throw Ta=ed,qf}function yd(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?Su():536870912,r.lanes|=s,To|=s)}function lc(r,s){if(!tt)switch(r.tailMode){case"hidden":s=r.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:c.sibling=null}}function Et(r){var s=r.alternate!==null&&r.alternate.child===r.child,o=0,c=0;if(s)for(var m=r.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=r,m=m.sibling;else for(m=r.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=r,m=m.sibling;return r.subtreeFlags|=c,r.childLanes=o,s}function H1(r,s,o){var c=s.pendingProps;switch(Mf(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(s),null;case 1:return Et(s),null;case 3:return o=s.stateNode,c=null,r!==null&&(c=r.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),wi($t),Se(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(ho(s)?Ri(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Pf())),Et(s),null;case 26:var m=s.type,y=s.memoizedState;return r===null?(Ri(s),y!==null?(Et(s),L0(s,y)):(Et(s),Am(s,m,null,c,o))):y?y!==r.memoizedState?(Ri(s),Et(s),L0(s,y)):(Et(s),s.flags&=-16777217):(r=r.memoizedProps,r!==c&&Ri(s),Et(s),Am(s,m,r,c,o)),null;case 27:if(Te(s),o=pe.current,m=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==c&&Ri(s);else{if(!c){if(s.stateNode===null)throw Error(i(166));return Et(s),null}r=te.current,ho(s)?g_(s):(r=Hv(m,c,o),s.stateNode=r,Ri(s))}return Et(s),null;case 5:if(Te(s),m=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==c&&Ri(s);else{if(!c){if(s.stateNode===null)throw Error(i(166));return Et(s),null}if(y=te.current,ho(s))g_(s);else{var E=Od(pe.current);switch(y){case 1:y=E.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:y=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":y=E.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":y=E.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":y=E.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof c.is=="string"?E.createElement("select",{is:c.is}):E.createElement("select"),c.multiple?y.multiple=!0:c.size&&(y.size=c.size);break;default:y=typeof c.is=="string"?E.createElement(m,{is:c.is}):E.createElement(m)}}y[Ht]=s,y[un]=c;e:for(E=s.child;E!==null;){if(E.tag===5||E.tag===6)y.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===s)break e;for(;E.sibling===null;){if(E.return===null||E.return===s)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}s.stateNode=y;e:switch(bn(y,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Ri(s)}}return Et(s),Am(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,o),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==c&&Ri(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(i(166));if(r=pe.current,ho(s)){if(r=s.stateNode,o=s.memoizedProps,c=null,m=yn,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}r[Ht]=s,r=!!(r.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||kv(r.nodeValue,o)),r||ds(s,!0)}else r=Od(r).createTextNode(c),r[Ht]=s,s.stateNode=r}return Et(s),null;case 31:if(o=s.memoizedState,r===null||r.memoizedState!==null){if(c=ho(s),o!==null){if(r===null){if(!c)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Ht]=s}else ba(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Et(s),r=!1}else o=Pf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return s.flags&256?(Jn(s),s):(Jn(s),null);if((s.flags&128)!==0)throw Error(i(558))}return Et(s),null;case 13:if(c=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(m=ho(s),c!==null&&c.dehydrated!==null){if(r===null){if(!m)throw Error(i(318));if(m=s.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[Ht]=s}else ba(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Et(s),m=!1}else m=Pf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=m),m=!0;if(!m)return s.flags&256?(Jn(s),s):(Jn(s),null)}return Jn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=c!==null,r=r!==null&&r.memoizedState!==null,o&&(c=s.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==m&&(c.flags|=2048)),o!==r&&o&&(s.child.flags|=8192),yd(s,s.updateQueue),Et(s),null);case 4:return Se(),r===null&&Km(s.stateNode.containerInfo),Et(s),null;case 10:return wi(s.type),Et(s),null;case 19:if(F(zt),c=s.memoizedState,c===null)return Et(s),null;if(m=(s.flags&128)!==0,y=c.rendering,y===null)if(m)lc(c,!1);else{if(Mt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(y=id(r),y!==null){for(s.flags|=128,lc(c,!1),r=y.updateQueue,s.updateQueue=r,yd(s,r),s.subtreeFlags=0,r=o,o=s.child;o!==null;)d_(o,r),o=o.sibling;return W(zt,zt.current&1|2),tt&&Ei(s,c.treeForkCount),s.child}r=r.sibling}c.tail!==null&&Pt()>Ed&&(s.flags|=128,m=!0,lc(c,!1),s.lanes=4194304)}else{if(!m)if(r=id(y),r!==null){if(s.flags|=128,m=!0,r=r.updateQueue,s.updateQueue=r,yd(s,r),lc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!y.alternate&&!tt)return Et(s),null}else 2*Pt()-c.renderingStartTime>Ed&&o!==536870912&&(s.flags|=128,m=!0,lc(c,!1),s.lanes=4194304);c.isBackwards?(y.sibling=s.child,s.child=y):(r=c.last,r!==null?r.sibling=y:s.child=y,c.last=y)}return c.tail!==null?(r=c.tail,c.rendering=r,c.tail=r.sibling,c.renderingStartTime=Pt(),r.sibling=null,o=zt.current,W(zt,m?o&1|2:o&1),tt&&Ei(s,c.treeForkCount),r):(Et(s),null);case 22:case 23:return Jn(s),Wf(),c=s.memoizedState!==null,r!==null?r.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(o&536870912)!==0&&(s.flags&128)===0&&(Et(s),s.subtreeFlags&6&&(s.flags|=8192)):Et(s),o=s.updateQueue,o!==null&&yd(s,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==o&&(s.flags|=2048),r!==null&&F(Sa),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),wi($t),Et(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function G1(r,s){switch(Mf(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return wi($t),Se(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return Te(s),null;case 31:if(s.memoizedState!==null){if(Jn(s),s.alternate===null)throw Error(i(340));ba()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(Jn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));ba()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return F(zt),null;case 4:return Se(),null;case 10:return wi(s.type),null;case 22:case 23:return Jn(s),Wf(),r!==null&&F(Sa),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return wi($t),null;case 25:return null;default:return null}}function V0(r,s){switch(Mf(s),s.tag){case 3:wi($t),Se();break;case 26:case 27:case 5:Te(s);break;case 4:Se();break;case 31:s.memoizedState!==null&&Jn(s);break;case 13:Jn(s);break;case 19:F(zt);break;case 10:wi(s.type);break;case 22:case 23:Jn(s),Wf(),r!==null&&F(Sa);break;case 24:wi($t)}}function cc(r,s){try{var o=s.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&r)===r){c=void 0;var y=o.create,E=o.inst;c=y(),E.destroy=c}o=o.next}while(o!==m)}}catch(k){ht(s,s.return,k)}}function _s(r,s,o){try{var c=s.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var y=m.next;c=y;do{if((c.tag&r)===r){var E=c.inst,k=E.destroy;if(k!==void 0){E.destroy=void 0,m=s;var G=o,ne=k;try{ne()}catch(fe){ht(m,G,fe)}}}c=c.next}while(c!==y)}}catch(fe){ht(s,s.return,fe)}}function z0(r){var s=r.updateQueue;if(s!==null){var o=r.stateNode;try{D_(s,o)}catch(c){ht(r,r.return,c)}}}function U0(r,s,o){o.props=Ra(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(c){ht(r,s,c)}}function uc(r,s){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var c=r.stateNode;break;case 30:c=r.stateNode;break;default:c=r.stateNode}typeof o=="function"?r.refCleanup=o(c):o.current=c}}catch(m){ht(r,s,m)}}function si(r,s){var o=r.ref,c=r.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){ht(r,s,m)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){ht(r,s,m)}else o.current=null}function B0(r){var s=r.type,o=r.memoizedProps,c=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){ht(r,r.return,m)}}function Cm(r,s,o){try{var c=r.stateNode;fA(c,r.type,o,s),c[un]=s}catch(m){ht(r,r.return,m)}}function F0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Ts(r.type)||r.tag===4}function Rm(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||F0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Ts(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Dm(r,s,o){var c=r.tag;if(c===5||c===6)r=r.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(r),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=Ar));else if(c!==4&&(c===27&&Ts(r.type)&&(o=r.stateNode,s=null),r=r.child,r!==null))for(Dm(r,s,o),r=r.sibling;r!==null;)Dm(r,s,o),r=r.sibling}function _d(r,s,o){var c=r.tag;if(c===5||c===6)r=r.stateNode,s?o.insertBefore(r,s):o.appendChild(r);else if(c!==4&&(c===27&&Ts(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(_d(r,s,o),r=r.sibling;r!==null;)_d(r,s,o),r=r.sibling}function q0(r){var s=r.stateNode,o=r.memoizedProps;try{for(var c=r.type,m=s.attributes;m.length;)s.removeAttributeNode(m[0]);bn(s,c,o),s[Ht]=r,s[un]=o}catch(y){ht(r,r.return,y)}}var Di=!1,Yt=!1,Im=!1,H0=typeof WeakSet=="function"?WeakSet:Set,hn=null;function Q1(r,s){if(r=r.containerInfo,Xm=zd,r=n_(r),Sf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var E=0,k=-1,G=-1,ne=0,fe=0,ye=r,ie=null;t:for(;;){for(var oe;ye!==o||m!==0&&ye.nodeType!==3||(k=E+m),ye!==y||c!==0&&ye.nodeType!==3||(G=E+c),ye.nodeType===3&&(E+=ye.nodeValue.length),(oe=ye.firstChild)!==null;)ie=ye,ye=oe;for(;;){if(ye===r)break t;if(ie===o&&++ne===m&&(k=E),ie===y&&++fe===c&&(G=E),(oe=ye.nextSibling)!==null)break;ye=ie,ie=ye.parentNode}ye=oe}o=k===-1||G===-1?null:{start:k,end:G}}else o=null}o=o||{start:0,end:0}}else o=null;for(Jm={focusedElem:r,selectionRange:o},zd=!1,hn=s;hn!==null;)if(s=hn,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,hn=r;else for(;hn!==null;){switch(s=hn,y=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)m=r[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=s,m=y.memoizedProps,y=y.memoizedState,c=o.stateNode;try{var Re=Ra(o.type,m);r=c.getSnapshotBeforeUpdate(Re,y),c.__reactInternalSnapshotBeforeUpdate=r}catch(Pe){ht(o,o.return,Pe)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,o=r.nodeType,o===9)tp(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":tp(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,hn=r;break}hn=s.return}}function G0(r,s,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ji(r,o),c&4&&cc(5,o);break;case 1:if(ji(r,o),c&4)if(r=o.stateNode,s===null)try{r.componentDidMount()}catch(E){ht(o,o.return,E)}else{var m=Ra(o.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(m,s,r.__reactInternalSnapshotBeforeUpdate)}catch(E){ht(o,o.return,E)}}c&64&&z0(o),c&512&&uc(o,o.return);break;case 3:if(ji(r,o),c&64&&(r=o.updateQueue,r!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{D_(r,s)}catch(E){ht(o,o.return,E)}}break;case 27:s===null&&c&4&&q0(o);case 26:case 5:ji(r,o),s===null&&c&4&&B0(o),c&512&&uc(o,o.return);break;case 12:ji(r,o);break;case 31:ji(r,o),c&4&&K0(r,o);break;case 13:ji(r,o),c&4&&W0(r,o),c&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=tA.bind(null,o),xA(r,o))));break;case 22:if(c=o.memoizedState!==null||Di,!c){s=s!==null&&s.memoizedState!==null||Yt,m=Di;var y=Yt;Di=c,(Yt=s)&&!y?Oi(r,o,(o.subtreeFlags&8772)!==0):ji(r,o),Di=m,Yt=y}break;case 30:break;default:ji(r,o)}}function Q0(r){var s=r.alternate;s!==null&&(r.alternate=null,Q0(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&Ka(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Ct=null,Ln=!1;function Ii(r,s,o){for(o=o.child;o!==null;)$0(r,s,o),o=o.sibling}function $0(r,s,o){if(pn&&typeof pn.onCommitFiberUnmount=="function")try{pn.onCommitFiberUnmount(Er,o)}catch{}switch(o.tag){case 26:Yt||si(o,s),Ii(r,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Yt||si(o,s);var c=Ct,m=Ln;Ts(o.type)&&(Ct=o.stateNode,Ln=!1),Ii(r,s,o),vc(o.stateNode),Ct=c,Ln=m;break;case 5:Yt||si(o,s);case 6:if(c=Ct,m=Ln,Ct=null,Ii(r,s,o),Ct=c,Ln=m,Ct!==null)if(Ln)try{(Ct.nodeType===9?Ct.body:Ct.nodeName==="HTML"?Ct.ownerDocument.body:Ct).removeChild(o.stateNode)}catch(y){ht(o,s,y)}else try{Ct.removeChild(o.stateNode)}catch(y){ht(o,s,y)}break;case 18:Ct!==null&&(Ln?(r=Ct,zv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),ko(r)):zv(Ct,o.stateNode));break;case 4:c=Ct,m=Ln,Ct=o.stateNode.containerInfo,Ln=!0,Ii(r,s,o),Ct=c,Ln=m;break;case 0:case 11:case 14:case 15:_s(2,o,s),Yt||_s(4,o,s),Ii(r,s,o);break;case 1:Yt||(si(o,s),c=o.stateNode,typeof c.componentWillUnmount=="function"&&U0(o,s,c)),Ii(r,s,o);break;case 21:Ii(r,s,o);break;case 22:Yt=(c=Yt)||o.memoizedState!==null,Ii(r,s,o),Yt=c;break;default:Ii(r,s,o)}}function K0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{ko(r)}catch(o){ht(s,s.return,o)}}}function W0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{ko(r)}catch(o){ht(s,s.return,o)}}function $1(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new H0),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new H0),s;default:throw Error(i(435,r.tag))}}function vd(r,s){var o=$1(r);s.forEach(function(c){if(!o.has(c)){o.add(c);var m=nA.bind(null,r,c);c.then(m,m)}})}function Vn(r,s){var o=s.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],y=r,E=s,k=E;e:for(;k!==null;){switch(k.tag){case 27:if(Ts(k.type)){Ct=k.stateNode,Ln=!1;break e}break;case 5:Ct=k.stateNode,Ln=!1;break e;case 3:case 4:Ct=k.stateNode.containerInfo,Ln=!0;break e}k=k.return}if(Ct===null)throw Error(i(160));$0(y,E,m),Ct=null,Ln=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Y0(s,r),s=s.sibling}var Or=null;function Y0(r,s){var o=r.alternate,c=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Vn(s,r),zn(r),c&4&&(_s(3,r,r.return),cc(3,r),_s(5,r,r.return));break;case 1:Vn(s,r),zn(r),c&512&&(Yt||o===null||si(o,o.return)),c&64&&Di&&(r=r.updateQueue,r!==null&&(c=r.callbacks,c!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=Or;if(Vn(s,r),zn(r),c&512&&(Yt||o===null||si(o,o.return)),c&4){var y=o!==null?o.memoizedState:null;if(c=r.memoizedState,o===null)if(c===null)if(r.stateNode===null){e:{c=r.type,o=r.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":y=m.getElementsByTagName("title")[0],(!y||y[Gr]||y[Ht]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(c),m.head.insertBefore(y,m.querySelector("head > title"))),bn(y,c,o),y[Ht]=r,Gt(y),c=y;break e;case"link":var E=Yv("link","href",m).get(c+(o.href||""));if(E){for(var k=0;k<E.length;k++)if(y=E[k],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(k,1);break t}}y=m.createElement(c),bn(y,c,o),m.head.appendChild(y);break;case"meta":if(E=Yv("meta","content",m).get(c+(o.content||""))){for(k=0;k<E.length;k++)if(y=E[k],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(k,1);break t}}y=m.createElement(c),bn(y,c,o),m.head.appendChild(y);break;default:throw Error(i(468,c))}y[Ht]=r,Gt(y),c=y}r.stateNode=c}else Xv(m,r.type,r.stateNode);else r.stateNode=Wv(m,c,r.memoizedProps);else y!==c?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,c===null?Xv(m,r.type,r.stateNode):Wv(m,c,r.memoizedProps)):c===null&&r.stateNode!==null&&Cm(r,r.memoizedProps,o.memoizedProps)}break;case 27:Vn(s,r),zn(r),c&512&&(Yt||o===null||si(o,o.return)),o!==null&&c&4&&Cm(r,r.memoizedProps,o.memoizedProps);break;case 5:if(Vn(s,r),zn(r),c&512&&(Yt||o===null||si(o,o.return)),r.flags&32){m=r.stateNode;try{Pn(m,"")}catch(Re){ht(r,r.return,Re)}}c&4&&r.stateNode!=null&&(m=r.memoizedProps,Cm(r,m,o!==null?o.memoizedProps:m)),c&1024&&(Im=!0);break;case 6:if(Vn(s,r),zn(r),c&4){if(r.stateNode===null)throw Error(i(162));c=r.memoizedProps,o=r.stateNode;try{o.nodeValue=c}catch(Re){ht(r,r.return,Re)}}break;case 3:if(Nd=null,m=Or,Or=kd(s.containerInfo),Vn(s,r),Or=m,zn(r),c&4&&o!==null&&o.memoizedState.isDehydrated)try{ko(s.containerInfo)}catch(Re){ht(r,r.return,Re)}Im&&(Im=!1,X0(r));break;case 4:c=Or,Or=kd(r.stateNode.containerInfo),Vn(s,r),zn(r),Or=c;break;case 12:Vn(s,r),zn(r);break;case 31:Vn(s,r),zn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,vd(r,c)));break;case 13:Vn(s,r),zn(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(xd=Pt()),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,vd(r,c)));break;case 22:m=r.memoizedState!==null;var G=o!==null&&o.memoizedState!==null,ne=Di,fe=Yt;if(Di=ne||m,Yt=fe||G,Vn(s,r),Yt=fe,Di=ne,zn(r),c&8192)e:for(s=r.stateNode,s._visibility=m?s._visibility&-2:s._visibility|1,m&&(o===null||G||Di||Yt||Da(r)),o=null,s=r;;){if(s.tag===5||s.tag===26){if(o===null){G=o=s;try{if(y=G.stateNode,m)E=y.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{k=G.stateNode;var ye=G.memoizedProps.style,ie=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;k.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(Re){ht(G,G.return,Re)}}}else if(s.tag===6){if(o===null){G=s;try{G.stateNode.nodeValue=m?"":G.memoizedProps}catch(Re){ht(G,G.return,Re)}}}else if(s.tag===18){if(o===null){G=s;try{var oe=G.stateNode;m?Uv(oe,!0):Uv(G.stateNode,!1)}catch(Re){ht(G,G.return,Re)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=r.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,vd(r,o))));break;case 19:Vn(s,r),zn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,vd(r,c)));break;case 30:break;case 21:break;default:Vn(s,r),zn(r)}}function zn(r){var s=r.flags;if(s&2){try{for(var o,c=r.return;c!==null;){if(F0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var m=o.stateNode,y=Rm(r);_d(r,y,m);break;case 5:var E=o.stateNode;o.flags&32&&(Pn(E,""),o.flags&=-33);var k=Rm(r);_d(r,k,E);break;case 3:case 4:var G=o.stateNode.containerInfo,ne=Rm(r);Dm(r,ne,G);break;default:throw Error(i(161))}}catch(fe){ht(r,r.return,fe)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function X0(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;X0(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function ji(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)G0(r,s.alternate,s),s=s.sibling}function Da(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:_s(4,s,s.return),Da(s);break;case 1:si(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&U0(s,s.return,o),Da(s);break;case 27:vc(s.stateNode);case 26:case 5:si(s,s.return),Da(s);break;case 22:s.memoizedState===null&&Da(s);break;case 30:Da(s);break;default:Da(s)}r=r.sibling}}function Oi(r,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,m=r,y=s,E=y.flags;switch(y.tag){case 0:case 11:case 15:Oi(m,y,o),cc(4,y);break;case 1:if(Oi(m,y,o),c=y,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ne){ht(c,c.return,ne)}if(c=y,m=c.updateQueue,m!==null){var k=c.stateNode;try{var G=m.shared.hiddenCallbacks;if(G!==null)for(m.shared.hiddenCallbacks=null,m=0;m<G.length;m++)R_(G[m],k)}catch(ne){ht(c,c.return,ne)}}o&&E&64&&z0(y),uc(y,y.return);break;case 27:q0(y);case 26:case 5:Oi(m,y,o),o&&c===null&&E&4&&B0(y),uc(y,y.return);break;case 12:Oi(m,y,o);break;case 31:Oi(m,y,o),o&&E&4&&K0(m,y);break;case 13:Oi(m,y,o),o&&E&4&&W0(m,y);break;case 22:y.memoizedState===null&&Oi(m,y,o),uc(y,y.return);break;case 30:break;default:Oi(m,y,o)}s=s.sibling}}function jm(r,s){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&Yl(o))}function Om(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Yl(r))}function kr(r,s,o,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)J0(r,s,o,c),s=s.sibling}function J0(r,s,o,c){var m=s.flags;switch(s.tag){case 0:case 11:case 15:kr(r,s,o,c),m&2048&&cc(9,s);break;case 1:kr(r,s,o,c);break;case 3:kr(r,s,o,c),m&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Yl(r)));break;case 12:if(m&2048){kr(r,s,o,c),r=s.stateNode;try{var y=s.memoizedProps,E=y.id,k=y.onPostCommit;typeof k=="function"&&k(E,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(G){ht(s,s.return,G)}}else kr(r,s,o,c);break;case 31:kr(r,s,o,c);break;case 13:kr(r,s,o,c);break;case 23:break;case 22:y=s.stateNode,E=s.alternate,s.memoizedState!==null?y._visibility&2?kr(r,s,o,c):dc(r,s):y._visibility&2?kr(r,s,o,c):(y._visibility|=2,Eo(r,s,o,c,(s.subtreeFlags&10256)!==0||!1)),m&2048&&jm(E,s);break;case 24:kr(r,s,o,c),m&2048&&Om(s.alternate,s);break;default:kr(r,s,o,c)}}function Eo(r,s,o,c,m){for(m=m&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=r,E=s,k=o,G=c,ne=E.flags;switch(E.tag){case 0:case 11:case 15:Eo(y,E,k,G,m),cc(8,E);break;case 23:break;case 22:var fe=E.stateNode;E.memoizedState!==null?fe._visibility&2?Eo(y,E,k,G,m):dc(y,E):(fe._visibility|=2,Eo(y,E,k,G,m)),m&&ne&2048&&jm(E.alternate,E);break;case 24:Eo(y,E,k,G,m),m&&ne&2048&&Om(E.alternate,E);break;default:Eo(y,E,k,G,m)}s=s.sibling}}function dc(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=r,c=s,m=c.flags;switch(c.tag){case 22:dc(o,c),m&2048&&jm(c.alternate,c);break;case 24:dc(o,c),m&2048&&Om(c.alternate,c);break;default:dc(o,c)}s=s.sibling}}var hc=8192;function So(r,s,o){if(r.subtreeFlags&hc)for(r=r.child;r!==null;)Z0(r,s,o),r=r.sibling}function Z0(r,s,o){switch(r.tag){case 26:So(r,s,o),r.flags&hc&&r.memoizedState!==null&&kA(o,Or,r.memoizedState,r.memoizedProps);break;case 5:So(r,s,o);break;case 3:case 4:var c=Or;Or=kd(r.stateNode.containerInfo),So(r,s,o),Or=c;break;case 22:r.memoizedState===null&&(c=r.alternate,c!==null&&c.memoizedState!==null?(c=hc,hc=16777216,So(r,s,o),hc=c):So(r,s,o));break;default:So(r,s,o)}}function ev(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function fc(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];hn=c,nv(c,r)}ev(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)tv(r),r=r.sibling}function tv(r){switch(r.tag){case 0:case 11:case 15:fc(r),r.flags&2048&&_s(9,r,r.return);break;case 3:fc(r);break;case 12:fc(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,bd(r)):fc(r);break;default:fc(r)}}function bd(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];hn=c,nv(c,r)}ev(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:_s(8,s,s.return),bd(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,bd(s));break;default:bd(s)}r=r.sibling}}function nv(r,s){for(;hn!==null;){var o=hn;switch(o.tag){case 0:case 11:case 15:_s(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Yl(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,hn=c;else e:for(o=r;hn!==null;){c=hn;var m=c.sibling,y=c.return;if(Q0(c),c===o){hn=null;break e}if(m!==null){m.return=y,hn=m;break e}hn=y}}}var K1={getCacheForType:function(r){var s=_n($t),o=s.data.get(r);return o===void 0&&(o=r(),s.data.set(r,o)),o},cacheSignal:function(){return _n($t).controller.signal}},W1=typeof WeakMap=="function"?WeakMap:Map,ot=0,yt=null,Ke=null,Ye=0,dt=0,Zn=null,vs=!1,wo=!1,km=!1,ki=0,Mt=0,bs=0,Ia=0,Mm=0,er=0,To=0,mc=null,Un=null,Nm=!1,xd=0,rv=0,Ed=1/0,Sd=null,xs=null,nn=0,Es=null,Ao=null,Mi=0,Pm=0,Lm=null,iv=null,pc=0,Vm=null;function tr(){return(ot&2)!==0&&Ye!==0?Ye&-Ye:P.T!==null?Hm():wu()}function sv(){if(er===0)if((Ye&536870912)===0||tt){var r=ra;ra<<=1,(ra&3932160)===0&&(ra=262144),er=r}else er=536870912;return r=Xn.current,r!==null&&(r.flags|=32),er}function Bn(r,s,o){(r===yt&&(dt===2||dt===9)||r.cancelPendingCommit!==null)&&(Co(r,0),Ss(r,Ye,er,!1)),ia(r,o),((ot&2)===0||r!==yt)&&(r===yt&&((ot&2)===0&&(Ia|=o),Mt===4&&Ss(r,Ye,er,!1)),ai(r))}function av(r,s,o){if((ot&6)!==0)throw Error(i(327));var c=!o&&(s&127)===0&&(s&r.expiredLanes)===0||Sr(r,s),m=c?J1(r,s):Um(r,s,!0),y=c;do{if(m===0){wo&&!c&&Ss(r,s,0,!1);break}else{if(o=r.current.alternate,y&&!Y1(o)){m=Um(r,s,!1),y=!1;continue}if(m===2){if(y=s,r.errorRecoveryDisabledLanes&y)var E=0;else E=r.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){s=E;e:{var k=r;m=mc;var G=k.current.memoizedState.isDehydrated;if(G&&(Co(k,E).flags|=256),E=Um(k,E,!1),E!==2){if(km&&!G){k.errorRecoveryDisabledLanes|=y,Ia|=y,m=4;break e}y=Un,Un=m,y!==null&&(Un===null?Un=y:Un.push.apply(Un,y))}m=E}if(y=!1,m!==2)continue}}if(m===1){Co(r,0),Ss(r,s,0,!0);break}e:{switch(c=r,y=m,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Ss(c,s,er,!vs);break e;case 2:Un=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(m=xd+300-Pt(),10<m)){if(Ss(c,s,er,!vs),Fr(c,0,!0)!==0)break e;Mi=s,c.timeoutHandle=Lv(ov.bind(null,c,o,Un,Sd,Nm,s,er,Ia,To,vs,y,"Throttled",-0,0),m);break e}ov(c,o,Un,Sd,Nm,s,er,Ia,To,vs,y,null,-0,0)}}break}while(!0);ai(r)}function ov(r,s,o,c,m,y,E,k,G,ne,fe,ye,ie,oe){if(r.timeoutHandle=-1,ye=s.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ar},Z0(s,y,ye);var Re=(y&62914560)===y?xd-Pt():(y&4194048)===y?rv-Pt():0;if(Re=MA(ye,Re),Re!==null){Mi=y,r.cancelPendingCommit=Re(pv.bind(null,r,s,y,o,c,m,E,k,G,fe,ye,null,ie,oe)),Ss(r,y,E,!ne);return}}pv(r,s,y,o,c,m,E,k,G)}function Y1(r){for(var s=r;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],y=m.getSnapshot;m=m.value;try{if(!Wn(y(),m))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ss(r,s,o,c){s&=~Mm,s&=~Ia,r.suspendedLanes|=s,r.pingedLanes&=~s,c&&(r.warmLanes|=s),c=r.expirationTimes;for(var m=s;0<m;){var y=31-Lt(m),E=1<<y;c[y]=-1,m&=~E}o!==0&&sa(r,o,s)}function wd(){return(ot&6)===0?(gc(0),!1):!0}function zm(){if(Ke!==null){if(dt===0)var r=Ke.return;else r=Ke,Si=xa=null,tm(r),yo=null,Jl=0,r=Ke;for(;r!==null;)V0(r.alternate,r),r=r.return;Ke=null}}function Co(r,s){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,gA(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),Mi=0,zm(),yt=r,Ke=o=xi(r.current,null),Ye=s,dt=0,Zn=null,vs=!1,wo=Sr(r,s),km=!1,To=er=Mm=Ia=bs=Mt=0,Un=mc=null,Nm=!1,(s&8)!==0&&(s|=s&32);var c=r.entangledLanes;if(c!==0)for(r=r.entanglements,c&=s;0<c;){var m=31-Lt(c),y=1<<m;s|=r[m],c&=~y}return ki=s,Gu(),o}function lv(r,s){He=null,P.H=ac,s===go||s===Zu?(s=w_(),dt=3):s===qf?(s=w_(),dt=4):dt=s===ym?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Zn=s,Ke===null&&(Mt=1,fd(r,hr(s,r.current)))}function cv(){var r=Xn.current;return r===null?!0:(Ye&4194048)===Ye?gr===null:(Ye&62914560)===Ye||(Ye&536870912)!==0?r===gr:!1}function uv(){var r=P.H;return P.H=ac,r===null?ac:r}function dv(){var r=P.A;return P.A=K1,r}function Td(){Mt=4,vs||(Ye&4194048)!==Ye&&Xn.current!==null||(wo=!0),(bs&134217727)===0&&(Ia&134217727)===0||yt===null||Ss(yt,Ye,er,!1)}function Um(r,s,o){var c=ot;ot|=2;var m=uv(),y=dv();(yt!==r||Ye!==s)&&(Sd=null,Co(r,s)),s=!1;var E=Mt;e:do try{if(dt!==0&&Ke!==null){var k=Ke,G=Zn;switch(dt){case 8:zm(),E=6;break e;case 3:case 2:case 9:case 6:Xn.current===null&&(s=!0);var ne=dt;if(dt=0,Zn=null,Ro(r,k,G,ne),o&&wo){E=0;break e}break;default:ne=dt,dt=0,Zn=null,Ro(r,k,G,ne)}}X1(),E=Mt;break}catch(fe){lv(r,fe)}while(!0);return s&&r.shellSuspendCounter++,Si=xa=null,ot=c,P.H=m,P.A=y,Ke===null&&(yt=null,Ye=0,Gu()),E}function X1(){for(;Ke!==null;)hv(Ke)}function J1(r,s){var o=ot;ot|=2;var c=uv(),m=dv();yt!==r||Ye!==s?(Sd=null,Ed=Pt()+500,Co(r,s)):wo=Sr(r,s);e:do try{if(dt!==0&&Ke!==null){s=Ke;var y=Zn;t:switch(dt){case 1:dt=0,Zn=null,Ro(r,s,y,1);break;case 2:case 9:if(E_(y)){dt=0,Zn=null,fv(s);break}s=function(){dt!==2&&dt!==9||yt!==r||(dt=7),ai(r)},y.then(s,s);break e;case 3:dt=7;break e;case 4:dt=5;break e;case 7:E_(y)?(dt=0,Zn=null,fv(s)):(dt=0,Zn=null,Ro(r,s,y,7));break;case 5:var E=null;switch(Ke.tag){case 26:E=Ke.memoizedState;case 5:case 27:var k=Ke;if(E?Jv(E):k.stateNode.complete){dt=0,Zn=null;var G=k.sibling;if(G!==null)Ke=G;else{var ne=k.return;ne!==null?(Ke=ne,Ad(ne)):Ke=null}break t}}dt=0,Zn=null,Ro(r,s,y,5);break;case 6:dt=0,Zn=null,Ro(r,s,y,6);break;case 8:zm(),Mt=6;break e;default:throw Error(i(462))}}Z1();break}catch(fe){lv(r,fe)}while(!0);return Si=xa=null,P.H=c,P.A=m,ot=o,Ke!==null?0:(yt=null,Ye=0,Gu(),Mt)}function Z1(){for(;Ke!==null&&!cn();)hv(Ke)}function hv(r){var s=P0(r.alternate,r,ki);r.memoizedProps=r.pendingProps,s===null?Ad(r):Ke=s}function fv(r){var s=r,o=s.alternate;switch(s.tag){case 15:case 0:s=I0(o,s,s.pendingProps,s.type,void 0,Ye);break;case 11:s=I0(o,s,s.pendingProps,s.type.render,s.ref,Ye);break;case 5:tm(s);default:V0(o,s),s=Ke=d_(s,ki),s=P0(o,s,ki)}r.memoizedProps=r.pendingProps,s===null?Ad(r):Ke=s}function Ro(r,s,o,c){Si=xa=null,tm(s),yo=null,Jl=0;var m=s.return;try{if(B1(r,m,s,o,Ye)){Mt=1,fd(r,hr(o,r.current)),Ke=null;return}}catch(y){if(m!==null)throw Ke=m,y;Mt=1,fd(r,hr(o,r.current)),Ke=null;return}s.flags&32768?(tt||c===1?r=!0:wo||(Ye&536870912)!==0?r=!1:(vs=r=!0,(c===2||c===9||c===3||c===6)&&(c=Xn.current,c!==null&&c.tag===13&&(c.flags|=16384))),mv(s,r)):Ad(s)}function Ad(r){var s=r;do{if((s.flags&32768)!==0){mv(s,vs);return}r=s.return;var o=H1(s.alternate,s,ki);if(o!==null){Ke=o;return}if(s=s.sibling,s!==null){Ke=s;return}Ke=s=r}while(s!==null);Mt===0&&(Mt=5)}function mv(r,s){do{var o=G1(r.alternate,r);if(o!==null){o.flags&=32767,Ke=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(r=r.sibling,r!==null)){Ke=r;return}Ke=r=o}while(r!==null);Mt=6,Ke=null}function pv(r,s,o,c,m,y,E,k,G){r.cancelPendingCommit=null;do Cd();while(nn!==0);if((ot&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=Rf,vf(r,o,y,E,k,G),r===yt&&(Ke=yt=null,Ye=0),Ao=s,Es=r,Mi=o,Pm=y,Lm=m,iv=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,rA(Zi,function(){return bv(),null})):(r.callbackNode=null,r.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=P.T,P.T=null,m=B.p,B.p=2,E=ot,ot|=4;try{Q1(r,s,o)}finally{ot=E,B.p=m,P.T=c}}nn=1,gv(),yv(),_v()}}function gv(){if(nn===1){nn=0;var r=Es,s=Ao,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=P.T,P.T=null;var c=B.p;B.p=2;var m=ot;ot|=4;try{Y0(s,r);var y=Jm,E=n_(r.containerInfo),k=y.focusedElem,G=y.selectionRange;if(E!==k&&k&&k.ownerDocument&&t_(k.ownerDocument.documentElement,k)){if(G!==null&&Sf(k)){var ne=G.start,fe=G.end;if(fe===void 0&&(fe=ne),"selectionStart"in k)k.selectionStart=ne,k.selectionEnd=Math.min(fe,k.value.length);else{var ye=k.ownerDocument||document,ie=ye&&ye.defaultView||window;if(ie.getSelection){var oe=ie.getSelection(),Re=k.textContent.length,Pe=Math.min(G.start,Re),gt=G.end===void 0?Pe:Math.min(G.end,Re);!oe.extend&&Pe>gt&&(E=gt,gt=Pe,Pe=E);var X=e_(k,Pe),K=e_(k,gt);if(X&&K&&(oe.rangeCount!==1||oe.anchorNode!==X.node||oe.anchorOffset!==X.offset||oe.focusNode!==K.node||oe.focusOffset!==K.offset)){var ee=ye.createRange();ee.setStart(X.node,X.offset),oe.removeAllRanges(),Pe>gt?(oe.addRange(ee),oe.extend(K.node,K.offset)):(ee.setEnd(K.node,K.offset),oe.addRange(ee))}}}}for(ye=[],oe=k;oe=oe.parentNode;)oe.nodeType===1&&ye.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<ye.length;k++){var ge=ye[k];ge.element.scrollLeft=ge.left,ge.element.scrollTop=ge.top}}zd=!!Xm,Jm=Xm=null}finally{ot=m,B.p=c,P.T=o}}r.current=s,nn=2}}function yv(){if(nn===2){nn=0;var r=Es,s=Ao,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=P.T,P.T=null;var c=B.p;B.p=2;var m=ot;ot|=4;try{G0(r,s.alternate,s)}finally{ot=m,B.p=c,P.T=o}}nn=3}}function _v(){if(nn===4||nn===3){nn=0,In();var r=Es,s=Ao,o=Mi,c=iv;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?nn=5:(nn=0,Ao=Es=null,vv(r,r.pendingLanes));var m=r.pendingLanes;if(m===0&&(xs=null),yi(o),s=s.stateNode,pn&&typeof pn.onCommitFiberRoot=="function")try{pn.onCommitFiberRoot(Er,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=P.T,m=B.p,B.p=2,P.T=null;try{for(var y=r.onRecoverableError,E=0;E<c.length;E++){var k=c[E];y(k.value,{componentStack:k.stack})}}finally{P.T=s,B.p=m}}(Mi&3)!==0&&Cd(),ai(r),m=r.pendingLanes,(o&261930)!==0&&(m&42)!==0?r===Vm?pc++:(pc=0,Vm=r):pc=0,gc(0)}}function vv(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,Yl(s)))}function Cd(){return gv(),yv(),_v(),bv()}function bv(){if(nn!==5)return!1;var r=Es,s=Pm;Pm=0;var o=yi(Mi),c=P.T,m=B.p;try{B.p=32>o?32:o,P.T=null,o=Lm,Lm=null;var y=Es,E=Mi;if(nn=0,Ao=Es=null,Mi=0,(ot&6)!==0)throw Error(i(331));var k=ot;if(ot|=4,tv(y.current),J0(y,y.current,E,o),ot=k,gc(0,!1),pn&&typeof pn.onPostCommitFiberRoot=="function")try{pn.onPostCommitFiberRoot(Er,y)}catch{}return!0}finally{B.p=m,P.T=c,vv(r,s)}}function xv(r,s,o){s=hr(o,s),s=gm(r.stateNode,s,2),r=ps(r,s,2),r!==null&&(ia(r,2),ai(r))}function ht(r,s,o){if(r.tag===3)xv(r,r,o);else for(;s!==null;){if(s.tag===3){xv(s,r,o);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(xs===null||!xs.has(c))){r=hr(o,r),o=E0(2),c=ps(s,o,2),c!==null&&(S0(o,c,s,r),ia(c,2),ai(c));break}}s=s.return}}function Bm(r,s,o){var c=r.pingCache;if(c===null){c=r.pingCache=new W1;var m=new Set;c.set(s,m)}else m=c.get(s),m===void 0&&(m=new Set,c.set(s,m));m.has(o)||(km=!0,m.add(o),r=eA.bind(null,r,s,o),s.then(r,r))}function eA(r,s,o){var c=r.pingCache;c!==null&&c.delete(s),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,yt===r&&(Ye&o)===o&&(Mt===4||Mt===3&&(Ye&62914560)===Ye&&300>Pt()-xd?(ot&2)===0&&Co(r,0):Mm|=o,To===Ye&&(To=0)),ai(r)}function Ev(r,s){s===0&&(s=Su()),r=_a(r,s),r!==null&&(ia(r,s),ai(r))}function tA(r){var s=r.memoizedState,o=0;s!==null&&(o=s.retryLane),Ev(r,o)}function nA(r,s){var o=0;switch(r.tag){case 31:case 13:var c=r.stateNode,m=r.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=r.stateNode;break;case 22:c=r.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(s),Ev(r,o)}function rA(r,s){return Ne(r,s)}var Rd=null,Do=null,Fm=!1,Dd=!1,qm=!1,ws=0;function ai(r){r!==Do&&r.next===null&&(Do===null?Rd=Do=r:Do=Do.next=r),Dd=!0,Fm||(Fm=!0,sA())}function gc(r,s){if(!qm&&Dd){qm=!0;do for(var o=!1,c=Rd;c!==null;){if(r!==0){var m=c.pendingLanes;if(m===0)var y=0;else{var E=c.suspendedLanes,k=c.pingedLanes;y=(1<<31-Lt(42|r)+1)-1,y&=m&~(E&~k),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,Av(c,y))}else y=Ye,y=Fr(c,c===yt?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(y&3)===0||Sr(c,y)||(o=!0,Av(c,y));c=c.next}while(o);qm=!1}}function iA(){Sv()}function Sv(){Dd=Fm=!1;var r=0;ws!==0&&pA()&&(r=ws);for(var s=Pt(),o=null,c=Rd;c!==null;){var m=c.next,y=wv(c,s);y===0?(c.next=null,o===null?Rd=m:o.next=m,m===null&&(Do=o)):(o=c,(r!==0||(y&3)!==0)&&(Dd=!0)),c=m}nn!==0&&nn!==5||gc(r),ws!==0&&(ws=0)}function wv(r,s){for(var o=r.suspendedLanes,c=r.pingedLanes,m=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var E=31-Lt(y),k=1<<E,G=m[E];G===-1?((k&o)===0||(k&c)!==0)&&(m[E]=_f(k,s)):G<=s&&(r.expiredLanes|=k),y&=~k}if(s=yt,o=Ye,o=Fr(r,r===s?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c=r.callbackNode,o===0||r===s&&(dt===2||dt===9)||r.cancelPendingCommit!==null)return c!==null&&c!==null&&Nt(c),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||Sr(r,o)){if(s=o&-o,s===r.callbackPriority)return s;switch(c!==null&&Nt(c),yi(o)){case 2:case 8:o=Al;break;case 32:o=Zi;break;case 268435456:o=_u;break;default:o=Zi}return c=Tv.bind(null,r),o=Ne(o,c),r.callbackPriority=s,r.callbackNode=o,s}return c!==null&&c!==null&&Nt(c),r.callbackPriority=2,r.callbackNode=null,2}function Tv(r,s){if(nn!==0&&nn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(Cd()&&r.callbackNode!==o)return null;var c=Ye;return c=Fr(r,r===yt?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c===0?null:(av(r,c,s),wv(r,Pt()),r.callbackNode!=null&&r.callbackNode===o?Tv.bind(null,r):null)}function Av(r,s){if(Cd())return null;av(r,s,!0)}function sA(){yA(function(){(ot&6)!==0?Ne(Qn,iA):Sv()})}function Hm(){if(ws===0){var r=mo;r===0&&(r=Ur,Ur<<=1,(Ur&261888)===0&&(Ur=256)),ws=r}return ws}function Cv(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Ja(""+r)}function Rv(r,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,r.id&&o.setAttribute("form",r.id),s.parentNode.insertBefore(o,s),r=new FormData(r),o.parentNode.removeChild(o),r}function aA(r,s,o,c,m){if(s==="submit"&&o&&o.stateNode===m){var y=Cv((m[un]||null).action),E=c.submitter;E&&(s=(s=E[un]||null)?Cv(s.formAction):E.getAttribute("formAction"),s!==null&&(y=s,E=null));var k=new Zr("action","action",null,c,m);r.push({event:k,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(ws!==0){var G=E?Rv(m,E):new FormData(m);um(o,{pending:!0,data:G,method:m.method,action:y},null,G)}}else typeof y=="function"&&(k.preventDefault(),G=E?Rv(m,E):new FormData(m),um(o,{pending:!0,data:G,method:m.method,action:y},y,G))},currentTarget:m}]})}}for(var Gm=0;Gm<Cf.length;Gm++){var Qm=Cf[Gm],oA=Qm.toLowerCase(),lA=Qm[0].toUpperCase()+Qm.slice(1);jr(oA,"on"+lA)}jr(s_,"onAnimationEnd"),jr(a_,"onAnimationIteration"),jr(o_,"onAnimationStart"),jr("dblclick","onDoubleClick"),jr("focusin","onFocus"),jr("focusout","onBlur"),jr(w1,"onTransitionRun"),jr(T1,"onTransitionStart"),jr(A1,"onTransitionCancel"),jr(l_,"onTransitionEnd"),Wr("onMouseEnter",["mouseout","mouseover"]),Wr("onMouseLeave",["mouseout","mouseover"]),Wr("onPointerEnter",["pointerout","pointerover"]),Wr("onPointerLeave",["pointerout","pointerover"]),Kr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Kr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Kr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Kr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Kr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Kr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(yc));function Dv(r,s){s=(s&4)!==0;for(var o=0;o<r.length;o++){var c=r[o],m=c.event;c=c.listeners;e:{var y=void 0;if(s)for(var E=c.length-1;0<=E;E--){var k=c[E],G=k.instance,ne=k.currentTarget;if(k=k.listener,G!==y&&m.isPropagationStopped())break e;y=k,m.currentTarget=ne;try{y(m)}catch(fe){Hu(fe)}m.currentTarget=null,y=G}else for(E=0;E<c.length;E++){if(k=c[E],G=k.instance,ne=k.currentTarget,k=k.listener,G!==y&&m.isPropagationStopped())break e;y=k,m.currentTarget=ne;try{y(m)}catch(fe){Hu(fe)}m.currentTarget=null,y=G}}}}function We(r,s){var o=s[$a];o===void 0&&(o=s[$a]=new Set);var c=r+"__bubble";o.has(c)||(Iv(s,r,2,!1),o.add(c))}function $m(r,s,o){var c=0;s&&(c|=4),Iv(o,r,c,s)}var Id="_reactListening"+Math.random().toString(36).slice(2);function Km(r){if(!r[Id]){r[Id]=!0,Dl.forEach(function(o){o!=="selectionchange"&&(cA.has(o)||$m(o,!1,r),$m(o,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Id]||(s[Id]=!0,$m("selectionchange",!1,s))}}function Iv(r,s,o,c){switch(sb(s)){case 2:var m=LA;break;case 8:m=VA;break;default:m=cp}o=m.bind(null,s,o,r),m=void 0,!ua||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),c?m!==void 0?r.addEventListener(s,o,{capture:!0,passive:m}):r.addEventListener(s,o,!0):m!==void 0?r.addEventListener(s,o,{passive:m}):r.addEventListener(s,o,!1)}function Wm(r,s,o,c,m){var y=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var E=c.tag;if(E===3||E===4){var k=c.stateNode.containerInfo;if(k===m)break;if(E===4)for(E=c.return;E!==null;){var G=E.tag;if((G===3||G===4)&&E.stateNode.containerInfo===m)return;E=E.return}for(;k!==null;){if(E=Qr(k),E===null)return;if(G=E.tag,G===5||G===6||G===26||G===27){c=y=E;continue e}k=k.parentNode}}c=c.return}ss(function(){var ne=y,fe=lr(o),ye=[];e:{var ie=c_.get(r);if(ie!==void 0){var oe=Zr,Re=r;switch(r){case"keypress":if(ha(o)===0)break e;case"keydown":case"keyup":oe=Bu;break;case"focusin":Re="focus",oe=ma;break;case"focusout":Re="blur",oe=ma;break;case"beforeblur":case"afterblur":oe=ma;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Fl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=Ou;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=b;break;case s_:case a_:case o_:oe=Mu;break;case l_:oe=V;break;case"scroll":case"scrollend":oe=Bl;break;case"wheel":oe=ae;break;case"copy":case"cut":case"paste":oe=Nu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=bi;break;case"toggle":case"beforetoggle":oe=qe}var Pe=(s&4)!==0,gt=!Pe&&(r==="scroll"||r==="scrollend"),X=Pe?ie!==null?ie+"Capture":null:ie;Pe=[];for(var K=ne,ee;K!==null;){var ge=K;if(ee=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||ee===null||X===null||(ge=Cr(K,X),ge!=null&&Pe.push(_c(K,ge,ee))),gt)break;K=K.return}0<Pe.length&&(ie=new oe(ie,Re,null,o,fe),ye.push({event:ie,listeners:Pe}))}}if((s&7)===0){e:{if(ie=r==="mouseover"||r==="pointerover",oe=r==="mouseout"||r==="pointerout",ie&&o!==Vl&&(Re=o.relatedTarget||o.fromElement)&&(Qr(Re)||Re[Hr]))break e;if((oe||ie)&&(ie=fe.window===fe?fe:(ie=fe.ownerDocument)?ie.defaultView||ie.parentWindow:window,oe?(Re=o.relatedTarget||o.toElement,oe=ne,Re=Re?Qr(Re):null,Re!==null&&(gt=l(Re),Pe=Re.tag,Re!==gt||Pe!==5&&Pe!==27&&Pe!==6)&&(Re=null)):(oe=null,Re=ne),oe!==Re)){if(Pe=Fl,ge="onMouseLeave",X="onMouseEnter",K="mouse",(r==="pointerout"||r==="pointerover")&&(Pe=bi,ge="onPointerLeave",X="onPointerEnter",K="pointer"),gt=oe==null?ie:$n(oe),ee=Re==null?ie:$n(Re),ie=new Pe(ge,K+"leave",oe,o,fe),ie.target=gt,ie.relatedTarget=ee,ge=null,Qr(fe)===ne&&(Pe=new Pe(X,K+"enter",Re,o,fe),Pe.target=ee,Pe.relatedTarget=gt,ge=Pe),gt=ge,oe&&Re)t:{for(Pe=uA,X=oe,K=Re,ee=0,ge=X;ge;ge=Pe(ge))ee++;ge=0;for(var Oe=K;Oe;Oe=Pe(Oe))ge++;for(;0<ee-ge;)X=Pe(X),ee--;for(;0<ge-ee;)K=Pe(K),ge--;for(;ee--;){if(X===K||K!==null&&X===K.alternate){Pe=X;break t}X=Pe(X),K=Pe(K)}Pe=null}else Pe=null;oe!==null&&jv(ye,ie,oe,Pe,!1),Re!==null&&gt!==null&&jv(ye,gt,Re,Pe,!0)}}e:{if(ie=ne?$n(ne):window,oe=ie.nodeName&&ie.nodeName.toLowerCase(),oe==="select"||oe==="input"&&ie.type==="file")var rt=Ky;else if(Qy(ie))if(Wy)rt=x1;else{rt=v1;var Ie=_1}else oe=ie.nodeName,!oe||oe.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?ne&&Xa(ne.elementType)&&(rt=Ky):rt=b1;if(rt&&(rt=rt(r,ne))){$y(ye,rt,o,fe);break e}Ie&&Ie(r,ie,ne),r==="focusout"&&ne&&ie.type==="number"&&ne.memoizedProps.value!=null&&Nl(ie,"number",ie.value)}switch(Ie=ne?$n(ne):window,r){case"focusin":(Qy(Ie)||Ie.contentEditable==="true")&&(so=Ie,wf=ne,$l=null);break;case"focusout":$l=wf=so=null;break;case"mousedown":Tf=!0;break;case"contextmenu":case"mouseup":case"dragend":Tf=!1,r_(ye,o,fe);break;case"selectionchange":if(S1)break;case"keydown":case"keyup":r_(ye,o,fe)}var Ge;if(at)e:{switch(r){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else io?pa(r,o)&&(Xe="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Xe="onCompositionStart");Xe&&(ni&&o.locale!=="ko"&&(io||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&io&&(Ge=Ul()):(Jr=fe,zl="value"in Jr?Jr.value:Jr.textContent,io=!0)),Ie=jd(ne,Xe),0<Ie.length&&(Xe=new ti(Xe,r,null,o,fe),ye.push({event:Xe,listeners:Ie}),Ge?Xe.data=Ge:(Ge=ro(o),Ge!==null&&(Xe.data=Ge)))),(Ge=ur?m1(r,o):p1(r,o))&&(Xe=jd(ne,"onBeforeInput"),0<Xe.length&&(Ie=new ti("onBeforeInput","beforeinput",null,o,fe),ye.push({event:Ie,listeners:Xe}),Ie.data=Ge)),aA(ye,r,ne,o,fe)}Dv(ye,s)})}function _c(r,s,o){return{instance:r,listener:s,currentTarget:o}}function jd(r,s){for(var o=s+"Capture",c=[];r!==null;){var m=r,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=Cr(r,o),m!=null&&c.unshift(_c(r,m,y)),m=Cr(r,s),m!=null&&c.push(_c(r,m,y))),r.tag===3)return c;r=r.return}return[]}function uA(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function jv(r,s,o,c,m){for(var y=s._reactName,E=[];o!==null&&o!==c;){var k=o,G=k.alternate,ne=k.stateNode;if(k=k.tag,G!==null&&G===c)break;k!==5&&k!==26&&k!==27||ne===null||(G=ne,m?(ne=Cr(o,y),ne!=null&&E.unshift(_c(o,ne,G))):m||(ne=Cr(o,y),ne!=null&&E.push(_c(o,ne,G)))),o=o.return}E.length!==0&&r.push({event:s,listeners:E})}var dA=/\r\n?/g,hA=/\u0000|\uFFFD/g;function Ov(r){return(typeof r=="string"?r:""+r).replace(dA,`
`).replace(hA,"")}function kv(r,s){return s=Ov(s),Ov(r)===s}function pt(r,s,o,c,m,y){switch(o){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||Pn(r,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&Pn(r,""+c);break;case"className":Kn(r,"class",c);break;case"tabIndex":Kn(r,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Kn(r,o,c);break;case"style":Ll(r,c,y);break;case"data":if(s!=="object"){Kn(r,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||o!=="href")){r.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(o);break}c=Ja(""+c),r.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&pt(r,s,"name",m.name,m,null),pt(r,s,"formEncType",m.formEncType,m,null),pt(r,s,"formMethod",m.formMethod,m,null),pt(r,s,"formTarget",m.formTarget,m,null)):(pt(r,s,"encType",m.encType,m,null),pt(r,s,"method",m.method,m,null),pt(r,s,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(o);break}c=Ja(""+c),r.setAttribute(o,c);break;case"onClick":c!=null&&(r.onclick=Ar);break;case"onScroll":c!=null&&We("scroll",r);break;case"onScrollEnd":c!=null&&We("scrollend",r);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"multiple":r.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":r.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){r.removeAttribute("xlink:href");break}o=Ja(""+c),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,""+c):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":c===!0?r.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,c):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?r.setAttribute(o,c):r.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?r.removeAttribute(o):r.setAttribute(o,c);break;case"popover":We("beforetoggle",r),We("toggle",r),Wa(r,"popover",c);break;case"xlinkActuate":Qt(r,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Qt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Qt(r,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Qt(r,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Qt(r,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Qt(r,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Qt(r,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Qt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Qt(r,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Wa(r,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=ju.get(o)||o,Wa(r,o,c))}}function Ym(r,s,o,c,m,y){switch(o){case"style":Ll(r,c,y);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"children":typeof c=="string"?Pn(r,c):(typeof c=="number"||typeof c=="bigint")&&Pn(r,""+c);break;case"onScroll":c!=null&&We("scroll",r);break;case"onScrollEnd":c!=null&&We("scrollend",r);break;case"onClick":c!=null&&(r.onclick=Ar);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Il.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),s=o.slice(2,m?o.length-7:void 0),y=r[un]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(s,y,m),typeof c=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(s,c,m);break e}o in r?r[o]=c:c===!0?r.setAttribute(o,""):Wa(r,o,c)}}}function bn(r,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":We("error",r),We("load",r);var c=!1,m=!1,y;for(y in o)if(o.hasOwnProperty(y)){var E=o[y];if(E!=null)switch(y){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:pt(r,s,y,E,o,null)}}m&&pt(r,s,"srcSet",o.srcSet,o,null),c&&pt(r,s,"src",o.src,o,null);return;case"input":We("invalid",r);var k=y=E=m=null,G=null,ne=null;for(c in o)if(o.hasOwnProperty(c)){var fe=o[c];if(fe!=null)switch(c){case"name":m=fe;break;case"type":E=fe;break;case"checked":G=fe;break;case"defaultChecked":ne=fe;break;case"value":y=fe;break;case"defaultValue":k=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,s));break;default:pt(r,s,c,fe,o,null)}}Ru(r,y,k,G,ne,E,m,!1);return;case"select":We("invalid",r),c=E=y=null;for(m in o)if(o.hasOwnProperty(m)&&(k=o[m],k!=null))switch(m){case"value":y=k;break;case"defaultValue":E=k;break;case"multiple":c=k;default:pt(r,s,m,k,o,null)}s=y,o=E,r.multiple=!!c,s!=null?ts(r,!!c,s,!1):o!=null&&ts(r,!!c,o,!0);return;case"textarea":We("invalid",r),y=m=c=null;for(E in o)if(o.hasOwnProperty(E)&&(k=o[E],k!=null))switch(E){case"value":c=k;break;case"defaultValue":m=k;break;case"children":y=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(i(91));break;default:pt(r,s,E,k,o,null)}ns(r,c,m,y);return;case"option":for(G in o)o.hasOwnProperty(G)&&(c=o[G],c!=null)&&(G==="selected"?r.selected=c&&typeof c!="function"&&typeof c!="symbol":pt(r,s,G,c,o,null));return;case"dialog":We("beforetoggle",r),We("toggle",r),We("cancel",r),We("close",r);break;case"iframe":case"object":We("load",r);break;case"video":case"audio":for(c=0;c<yc.length;c++)We(yc[c],r);break;case"image":We("error",r),We("load",r);break;case"details":We("toggle",r);break;case"embed":case"source":case"link":We("error",r),We("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in o)if(o.hasOwnProperty(ne)&&(c=o[ne],c!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:pt(r,s,ne,c,o,null)}return;default:if(Xa(s)){for(fe in o)o.hasOwnProperty(fe)&&(c=o[fe],c!==void 0&&Ym(r,s,fe,c,o,void 0));return}}for(k in o)o.hasOwnProperty(k)&&(c=o[k],c!=null&&pt(r,s,k,c,o,null))}function fA(r,s,o,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,E=null,k=null,G=null,ne=null,fe=null;for(oe in o){var ye=o[oe];if(o.hasOwnProperty(oe)&&ye!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":G=ye;default:c.hasOwnProperty(oe)||pt(r,s,oe,null,c,ye)}}for(var ie in c){var oe=c[ie];if(ye=o[ie],c.hasOwnProperty(ie)&&(oe!=null||ye!=null))switch(ie){case"type":y=oe;break;case"name":m=oe;break;case"checked":ne=oe;break;case"defaultChecked":fe=oe;break;case"value":E=oe;break;case"defaultValue":k=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,s));break;default:oe!==ye&&pt(r,s,ie,oe,c,ye)}}Ya(r,E,k,G,ne,fe,y,m);return;case"select":oe=E=k=ie=null;for(y in o)if(G=o[y],o.hasOwnProperty(y)&&G!=null)switch(y){case"value":break;case"multiple":oe=G;default:c.hasOwnProperty(y)||pt(r,s,y,null,c,G)}for(m in c)if(y=c[m],G=o[m],c.hasOwnProperty(m)&&(y!=null||G!=null))switch(m){case"value":ie=y;break;case"defaultValue":k=y;break;case"multiple":E=y;default:y!==G&&pt(r,s,m,y,c,G)}s=k,o=E,c=oe,ie!=null?ts(r,!!o,ie,!1):!!c!=!!o&&(s!=null?ts(r,!!o,s,!0):ts(r,!!o,o?[]:"",!1));return;case"textarea":oe=ie=null;for(k in o)if(m=o[k],o.hasOwnProperty(k)&&m!=null&&!c.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:pt(r,s,k,null,c,m)}for(E in c)if(m=c[E],y=o[E],c.hasOwnProperty(E)&&(m!=null||y!=null))switch(E){case"value":ie=m;break;case"defaultValue":oe=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==y&&pt(r,s,E,m,c,y)}Du(r,ie,oe);return;case"option":for(var Re in o)ie=o[Re],o.hasOwnProperty(Re)&&ie!=null&&!c.hasOwnProperty(Re)&&(Re==="selected"?r.selected=!1:pt(r,s,Re,null,c,ie));for(G in c)ie=c[G],oe=o[G],c.hasOwnProperty(G)&&ie!==oe&&(ie!=null||oe!=null)&&(G==="selected"?r.selected=ie&&typeof ie!="function"&&typeof ie!="symbol":pt(r,s,G,ie,c,oe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pe in o)ie=o[Pe],o.hasOwnProperty(Pe)&&ie!=null&&!c.hasOwnProperty(Pe)&&pt(r,s,Pe,null,c,ie);for(ne in c)if(ie=c[ne],oe=o[ne],c.hasOwnProperty(ne)&&ie!==oe&&(ie!=null||oe!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(137,s));break;default:pt(r,s,ne,ie,c,oe)}return;default:if(Xa(s)){for(var gt in o)ie=o[gt],o.hasOwnProperty(gt)&&ie!==void 0&&!c.hasOwnProperty(gt)&&Ym(r,s,gt,void 0,c,ie);for(fe in c)ie=c[fe],oe=o[fe],!c.hasOwnProperty(fe)||ie===oe||ie===void 0&&oe===void 0||Ym(r,s,fe,ie,c,oe);return}}for(var X in o)ie=o[X],o.hasOwnProperty(X)&&ie!=null&&!c.hasOwnProperty(X)&&pt(r,s,X,null,c,ie);for(ye in c)ie=c[ye],oe=o[ye],!c.hasOwnProperty(ye)||ie===oe||ie==null&&oe==null||pt(r,s,ye,ie,c,oe)}function Mv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function mA(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],y=m.transferSize,E=m.initiatorType,k=m.duration;if(y&&k&&Mv(E)){for(E=0,k=m.responseEnd,c+=1;c<o.length;c++){var G=o[c],ne=G.startTime;if(ne>k)break;var fe=G.transferSize,ye=G.initiatorType;fe&&Mv(ye)&&(G=G.responseEnd,E+=fe*(G<k?1:(k-ne)/(G-ne)))}if(--c,s+=8*(y+E)/(m.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Xm=null,Jm=null;function Od(r){return r.nodeType===9?r:r.ownerDocument}function Nv(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Pv(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function Zm(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ep=null;function pA(){var r=window.event;return r&&r.type==="popstate"?r===ep?!1:(ep=r,!0):(ep=null,!1)}var Lv=typeof setTimeout=="function"?setTimeout:void 0,gA=typeof clearTimeout=="function"?clearTimeout:void 0,Vv=typeof Promise=="function"?Promise:void 0,yA=typeof queueMicrotask=="function"?queueMicrotask:typeof Vv<"u"?function(r){return Vv.resolve(null).then(r).catch(_A)}:Lv;function _A(r){setTimeout(function(){throw r})}function Ts(r){return r==="head"}function zv(r,s){var o=s,c=0;do{var m=o.nextSibling;if(r.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){r.removeChild(m),ko(s);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")vc(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,vc(o);for(var y=o.firstChild;y;){var E=y.nextSibling,k=y.nodeName;y[Gr]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=E}}else o==="body"&&vc(r.ownerDocument.body);o=m}while(o);ko(s)}function Uv(r,s){var o=r;r=0;do{var c=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=c}while(o)}function tp(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":tp(o),Ka(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function vA(r,s,o,c){for(;r.nodeType===1;){var m=o;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(c){if(!r[Gr])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==m.rel||r.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||r.getAttribute("title")!==(m.title==null?null:m.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(m.src==null?null:m.src)||r.getAttribute("type")!==(m.type==null?null:m.type)||r.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=yr(r.nextSibling),r===null)break}return null}function bA(r,s,o){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=yr(r.nextSibling),r===null))return null;return r}function Bv(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=yr(r.nextSibling),r===null))return null;return r}function np(r){return r.data==="$?"||r.data==="$~"}function rp(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function xA(r,s){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||o.readyState!=="loading")s();else{var c=function(){s(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),r._reactRetry=c}}function yr(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var ip=null;function Fv(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(s===0)return yr(r.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}r=r.nextSibling}return null}function qv(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return r;s--}else o!=="/$"&&o!=="/&"||s++}r=r.previousSibling}return null}function Hv(r,s,o){switch(s=Od(o),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function vc(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);Ka(r)}var _r=new Map,Gv=new Set;function kd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ni=B.d;B.d={f:EA,r:SA,D:wA,C:TA,L:AA,m:CA,X:DA,S:RA,M:IA};function EA(){var r=Ni.f(),s=wd();return r||s}function SA(r){var s=or(r);s!==null&&s.tag===5&&s.type==="form"?l0(s):Ni.r(r)}var Io=typeof document>"u"?null:document;function Qv(r,s,o){var c=Io;if(c&&typeof s=="string"&&s){var m=Nn(s);m='link[rel="'+r+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),Gv.has(m)||(Gv.add(m),r={rel:r,crossOrigin:o,href:s},c.querySelector(m)===null&&(s=c.createElement("link"),bn(s,"link",r),Gt(s),c.head.appendChild(s)))}}function wA(r){Ni.D(r),Qv("dns-prefetch",r,null)}function TA(r,s){Ni.C(r,s),Qv("preconnect",r,s)}function AA(r,s,o){Ni.L(r,s,o);var c=Io;if(c&&r&&s){var m='link[rel="preload"][as="'+Nn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Nn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Nn(o.imageSizes)+'"]')):m+='[href="'+Nn(r)+'"]';var y=m;switch(s){case"style":y=jo(r);break;case"script":y=Oo(r)}_r.has(y)||(r=v({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:r,as:s},o),_r.set(y,r),c.querySelector(m)!==null||s==="style"&&c.querySelector(bc(y))||s==="script"&&c.querySelector(xc(y))||(s=c.createElement("link"),bn(s,"link",r),Gt(s),c.head.appendChild(s)))}}function CA(r,s){Ni.m(r,s);var o=Io;if(o&&r){var c=s&&typeof s.as=="string"?s.as:"script",m='link[rel="modulepreload"][as="'+Nn(c)+'"][href="'+Nn(r)+'"]',y=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Oo(r)}if(!_r.has(y)&&(r=v({rel:"modulepreload",href:r},s),_r.set(y,r),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(xc(y)))return}c=o.createElement("link"),bn(c,"link",r),Gt(c),o.head.appendChild(c)}}}function RA(r,s,o){Ni.S(r,s,o);var c=Io;if(c&&r){var m=$r(c).hoistableStyles,y=jo(r);s=s||"default";var E=m.get(y);if(!E){var k={loading:0,preload:null};if(E=c.querySelector(bc(y)))k.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":s},o),(o=_r.get(y))&&sp(r,o);var G=E=c.createElement("link");Gt(G),bn(G,"link",r),G._p=new Promise(function(ne,fe){G.onload=ne,G.onerror=fe}),G.addEventListener("load",function(){k.loading|=1}),G.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Md(E,s,c)}E={type:"stylesheet",instance:E,count:1,state:k},m.set(y,E)}}}function DA(r,s){Ni.X(r,s);var o=Io;if(o&&r){var c=$r(o).hoistableScripts,m=Oo(r),y=c.get(m);y||(y=o.querySelector(xc(m)),y||(r=v({src:r,async:!0},s),(s=_r.get(m))&&ap(r,s),y=o.createElement("script"),Gt(y),bn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(m,y))}}function IA(r,s){Ni.M(r,s);var o=Io;if(o&&r){var c=$r(o).hoistableScripts,m=Oo(r),y=c.get(m);y||(y=o.querySelector(xc(m)),y||(r=v({src:r,async:!0,type:"module"},s),(s=_r.get(m))&&ap(r,s),y=o.createElement("script"),Gt(y),bn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(m,y))}}function $v(r,s,o,c){var m=(m=pe.current)?kd(m):null;if(!m)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=jo(o.href),o=$r(m).hoistableStyles,c=o.get(s),c||(c={type:"style",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=jo(o.href);var y=$r(m).hoistableStyles,E=y.get(r);if(E||(m=m.ownerDocument||m,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,E),(y=m.querySelector(bc(r)))&&!y._p&&(E.instance=y,E.state.loading=5),_r.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},_r.set(r,o),y||jA(m,r,o,E.state))),s&&c===null)throw Error(i(528,""));return E}if(s&&c!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Oo(o),o=$r(m).hoistableScripts,c=o.get(s),c||(c={type:"script",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function jo(r){return'href="'+Nn(r)+'"'}function bc(r){return'link[rel="stylesheet"]['+r+"]"}function Kv(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function jA(r,s,o,c){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=r.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),bn(s,"link",o),Gt(s),r.head.appendChild(s))}function Oo(r){return'[src="'+Nn(r)+'"]'}function xc(r){return"script[async]"+r}function Wv(r,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var c=r.querySelector('style[data-href~="'+Nn(o.href)+'"]');if(c)return s.instance=c,Gt(c),c;var m=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(r.ownerDocument||r).createElement("style"),Gt(c),bn(c,"style",m),Md(c,o.precedence,r),s.instance=c;case"stylesheet":m=jo(o.href);var y=r.querySelector(bc(m));if(y)return s.state.loading|=4,s.instance=y,Gt(y),y;c=Kv(o),(m=_r.get(m))&&sp(c,m),y=(r.ownerDocument||r).createElement("link"),Gt(y);var E=y;return E._p=new Promise(function(k,G){E.onload=k,E.onerror=G}),bn(y,"link",c),s.state.loading|=4,Md(y,o.precedence,r),s.instance=y;case"script":return y=Oo(o.src),(m=r.querySelector(xc(y)))?(s.instance=m,Gt(m),m):(c=o,(m=_r.get(y))&&(c=v({},o),ap(c,m)),r=r.ownerDocument||r,m=r.createElement("script"),Gt(m),bn(m,"link",c),r.head.appendChild(m),s.instance=m);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,Md(c,o.precedence,r));return s.instance}function Md(r,s,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,y=m,E=0;E<c.length;E++){var k=c[E];if(k.dataset.precedence===s)y=k;else if(y!==m)break}y?y.parentNode.insertBefore(r,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(r,s.firstChild))}function sp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function ap(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var Nd=null;function Yv(r,s,o){if(Nd===null){var c=new Map,m=Nd=new Map;m.set(o,c)}else m=Nd,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(r))return c;for(c.set(r,null),o=o.getElementsByTagName(r),m=0;m<o.length;m++){var y=o[m];if(!(y[Gr]||y[Ht]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var E=y.getAttribute(s)||"";E=r+E;var k=c.get(E);k?k.push(y):c.set(E,[y])}}return c}function Xv(r,s,o){r=r.ownerDocument||r,r.head.insertBefore(o,s==="title"?r.querySelector("head > title"):null)}function OA(r,s,o){if(o===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Jv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function kA(r,s,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=jo(c.href),y=s.querySelector(bc(m));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=Pd.bind(r),s.then(r,r)),o.state.loading|=4,o.instance=y,Gt(y);return}y=s.ownerDocument||s,c=Kv(c),(m=_r.get(m))&&sp(c,m),y=y.createElement("link"),Gt(y);var E=y;E._p=new Promise(function(k,G){E.onload=k,E.onerror=G}),bn(y,"link",c),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=Pd.bind(r),s.addEventListener("load",o),s.addEventListener("error",o))}}var op=0;function MA(r,s){return r.stylesheets&&r.count===0&&Vd(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var c=setTimeout(function(){if(r.stylesheets&&Vd(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+s);0<r.imgBytes&&op===0&&(op=62500*mA());var m=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Vd(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>op?50:800)+s);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Pd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Vd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Ld=null;function Vd(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Ld=new Map,s.forEach(NA,r),Ld=null,Pd.call(r))}function NA(r,s){if(!(s.state.loading&4)){var o=Ld.get(r);if(o)var c=o.get(null);else{o=new Map,Ld.set(r,o);for(var m=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var E=m[y];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),c=E)}c&&o.set(null,c)}m=s.instance,E=m.getAttribute("data-precedence"),y=o.get(E)||c,y===c&&o.set(null,m),o.set(E,m),this.count++,c=Pd.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),y?y.parentNode.insertBefore(m,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(m,r.firstChild)),s.state.loading|=4}}var Ec={$$typeof:q,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function PA(r,s,o,c,m,y,E,k,G){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qr(0),this.hiddenUpdates=qr(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function Zv(r,s,o,c,m,y,E,k,G,ne,fe,ye){return r=new PA(r,s,o,E,G,ne,fe,ye,k),s=1,y===!0&&(s|=24),y=Yn(3,null,null,s),r.current=y,y.stateNode=r,s=Uf(),s.refCount++,r.pooledCache=s,s.refCount++,y.memoizedState={element:c,isDehydrated:o,cache:s},Hf(y),r}function eb(r){return r?(r=lo,r):lo}function tb(r,s,o,c,m,y){m=eb(m),c.context===null?c.context=m:c.pendingContext=m,c=ms(s),c.payload={element:o},y=y===void 0?null:y,y!==null&&(c.callback=y),o=ps(r,c,s),o!==null&&(Bn(o,r,s),ec(o,r,s))}function nb(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<s?o:s}}function lp(r,s){nb(r,s),(r=r.alternate)&&nb(r,s)}function rb(r){if(r.tag===13||r.tag===31){var s=_a(r,67108864);s!==null&&Bn(s,r,67108864),lp(r,67108864)}}function ib(r){if(r.tag===13||r.tag===31){var s=tr();s=aa(s);var o=_a(r,s);o!==null&&Bn(o,r,s),lp(r,s)}}var zd=!0;function LA(r,s,o,c){var m=P.T;P.T=null;var y=B.p;try{B.p=2,cp(r,s,o,c)}finally{B.p=y,P.T=m}}function VA(r,s,o,c){var m=P.T;P.T=null;var y=B.p;try{B.p=8,cp(r,s,o,c)}finally{B.p=y,P.T=m}}function cp(r,s,o,c){if(zd){var m=up(c);if(m===null)Wm(r,s,c,Ud,o),ab(r,c);else if(UA(m,r,s,o,c))c.stopPropagation();else if(ab(r,c),s&4&&-1<zA.indexOf(r)){for(;m!==null;){var y=or(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var E=Br(y.pendingLanes);if(E!==0){var k=y;for(k.pendingLanes|=2,k.entangledLanes|=2;E;){var G=1<<31-Lt(E);k.entanglements[1]|=G,E&=~G}ai(y),(ot&6)===0&&(Ed=Pt()+500,gc(0))}}break;case 31:case 13:k=_a(y,2),k!==null&&Bn(k,y,2),wd(),lp(y,2)}if(y=up(c),y===null&&Wm(r,s,c,Ud,o),y===m)break;m=y}m!==null&&c.stopPropagation()}else Wm(r,s,c,null,o)}}function up(r){return r=lr(r),dp(r)}var Ud=null;function dp(r){if(Ud=null,r=Qr(r),r!==null){var s=l(r);if(s===null)r=null;else{var o=s.tag;if(o===13){if(r=u(s),r!==null)return r;r=null}else if(o===31){if(r=f(s),r!==null)return r;r=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return Ud=r,null}function sb(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ot()){case Qn:return 2;case Al:return 8;case Zi:case yf:return 32;case _u:return 268435456;default:return 32}default:return 32}}var hp=!1,As=null,Cs=null,Rs=null,Sc=new Map,wc=new Map,Ds=[],zA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ab(r,s){switch(r){case"focusin":case"focusout":As=null;break;case"dragenter":case"dragleave":Cs=null;break;case"mouseover":case"mouseout":Rs=null;break;case"pointerover":case"pointerout":Sc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":wc.delete(s.pointerId)}}function Tc(r,s,o,c,m,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:o,eventSystemFlags:c,nativeEvent:y,targetContainers:[m]},s!==null&&(s=or(s),s!==null&&rb(s)),r):(r.eventSystemFlags|=c,s=r.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),r)}function UA(r,s,o,c,m){switch(s){case"focusin":return As=Tc(As,r,s,o,c,m),!0;case"dragenter":return Cs=Tc(Cs,r,s,o,c,m),!0;case"mouseover":return Rs=Tc(Rs,r,s,o,c,m),!0;case"pointerover":var y=m.pointerId;return Sc.set(y,Tc(Sc.get(y)||null,r,s,o,c,m)),!0;case"gotpointercapture":return y=m.pointerId,wc.set(y,Tc(wc.get(y)||null,r,s,o,c,m)),!0}return!1}function ob(r){var s=Qr(r.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=u(o),s!==null){r.blockedOn=s,wr(r.priority,function(){ib(o)});return}}else if(s===31){if(s=f(o),s!==null){r.blockedOn=s,wr(r.priority,function(){ib(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Bd(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var o=up(r.nativeEvent);if(o===null){o=r.nativeEvent;var c=new o.constructor(o.type,o);Vl=c,o.target.dispatchEvent(c),Vl=null}else return s=or(o),s!==null&&rb(s),r.blockedOn=o,!1;s.shift()}return!0}function lb(r,s,o){Bd(r)&&o.delete(s)}function BA(){hp=!1,As!==null&&Bd(As)&&(As=null),Cs!==null&&Bd(Cs)&&(Cs=null),Rs!==null&&Bd(Rs)&&(Rs=null),Sc.forEach(lb),wc.forEach(lb)}function Fd(r,s){r.blockedOn===s&&(r.blockedOn=null,hp||(hp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,BA)))}var qd=null;function cb(r){qd!==r&&(qd=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){qd===r&&(qd=null);for(var s=0;s<r.length;s+=3){var o=r[s],c=r[s+1],m=r[s+2];if(typeof c!="function"){if(dp(c||o)===null)continue;break}var y=or(o);y!==null&&(r.splice(s,3),s-=3,um(y,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function ko(r){function s(G){return Fd(G,r)}As!==null&&Fd(As,r),Cs!==null&&Fd(Cs,r),Rs!==null&&Fd(Rs,r),Sc.forEach(s),wc.forEach(s);for(var o=0;o<Ds.length;o++){var c=Ds[o];c.blockedOn===r&&(c.blockedOn=null)}for(;0<Ds.length&&(o=Ds[0],o.blockedOn===null);)ob(o),o.blockedOn===null&&Ds.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],y=o[c+1],E=m[un]||null;if(typeof y=="function")E||cb(o);else if(E){var k=null;if(y&&y.hasAttribute("formAction")){if(m=y,E=y[un]||null)k=E.formAction;else if(dp(m)!==null)continue}else k=E.action;typeof k=="function"?o[c+1]=k:(o.splice(c,3),c-=3),cb(o)}}}function ub(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(E){return m=E})},focusReset:"manual",scroll:"manual"})}function s(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),m!==null&&(m(),m=null)}}}function fp(r){this._internalRoot=r}Hd.prototype.render=fp.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,c=tr();tb(o,c,r,s,null,null)},Hd.prototype.unmount=fp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;tb(r.current,2,null,r,null,null),wd(),s[Hr]=null}};function Hd(r){this._internalRoot=r}Hd.prototype.unstable_scheduleHydration=function(r){if(r){var s=wu();r={blockedOn:null,target:r,priority:s};for(var o=0;o<Ds.length&&s!==0&&s<Ds[o].priority;o++);Ds.splice(o,0,r),o===0&&ob(r)}};var db=e.version;if(db!=="19.2.3")throw Error(i(527,db,"19.2.3"));B.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=g(s),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var FA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gd.isDisabled&&Gd.supportsFiber)try{Er=Gd.inject(FA),pn=Gd}catch{}}return Cc.createRoot=function(r,s){if(!a(r))throw Error(i(299));var o=!1,c="",m=_0,y=v0,E=b0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(m=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(E=s.onRecoverableError)),s=Zv(r,1,!1,null,null,o,c,null,m,y,E,ub),r[Hr]=s.current,Km(r),new fp(s)},Cc.hydrateRoot=function(r,s,o){if(!a(r))throw Error(i(299));var c=!1,m="",y=_0,E=v0,k=b0,G=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(k=o.onRecoverableError),o.formState!==void 0&&(G=o.formState)),s=Zv(r,1,!0,s,o??null,c,m,G,y,E,k,ub),s.context=eb(null),o=s.current,c=tr(),c=aa(c),m=ms(c),m.callback=null,ps(o,m,c),o=c,s.current.lanes=o,ia(s,o),ai(s),r[Hr]=s.current,Km(r),new Hd(s)},Cc.version="19.2.3",Cc}var xb;function JA(){if(xb)return gp.exports;xb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),gp.exports=XA(),gp.exports}var ZA=JA();var Eb="popstate";function eC(t={}){function e(i,a){let{pathname:l,search:u,hash:f}=i.location;return Bp("",{pathname:l,search:u,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:Fc(a)}return nC(e,n,null,t)}function Rt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function rr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tC(){return Math.random().toString(36).substring(2,10)}function Sb(t,e){return{usr:t.state,key:t.key,idx:e}}function Bp(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ol(e):e,state:n,key:e&&e.key||i||tC()}}function Fc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ol(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function nC(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,u=a.history,f="POP",p=null,g=_();g==null&&(g=0,u.replaceState({...u.state,idx:g},""));function _(){return(u.state||{idx:null}).idx}function v(){f="POP";let N=_(),H=N==null?null:N-g;g=N,p&&p({action:f,location:I.location,delta:H})}function x(N,H){f="PUSH";let $=Bp(I.location,N,H);g=_()+1;let q=Sb($,g),me=I.createHref($);try{u.pushState(q,"",me)}catch(re){if(re instanceof DOMException&&re.name==="DataCloneError")throw re;a.location.assign(me)}l&&p&&p({action:f,location:I.location,delta:1})}function w(N,H){f="REPLACE";let $=Bp(I.location,N,H);g=_();let q=Sb($,g),me=I.createHref($);u.replaceState(q,"",me),l&&p&&p({action:f,location:I.location,delta:0})}function A(N){return rC(N)}let I={get action(){return f},get location(){return t(a,u)},listen(N){if(p)throw new Error("A history only accepts one active listener");return a.addEventListener(Eb,v),p=N,()=>{a.removeEventListener(Eb,v),p=null}},createHref(N){return e(a,N)},createURL:A,encodeLocation(N){let H=A(N);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:x,replace:w,go(N){return u.go(N)}};return I}function rC(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Rt(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Fc(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function qE(t,e,n="/"){return iC(t,e,n,!1)}function iC(t,e,n,i){let a=typeof e=="string"?ol(e):e,l=Hi(a.pathname||"/",n);if(l==null)return null;let u=HE(t);sC(u);let f=null;for(let p=0;f==null&&p<u.length;++p){let g=gC(l);f=mC(u[p],g,i)}return f}function HE(t,e=[],n=[],i="",a=!1){let l=(u,f,p=a,g)=>{let _={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:f,route:u};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&p)return;Rt(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let v=Ui([i,_.relativePath]),x=n.concat(_);u.children&&u.children.length>0&&(Rt(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),HE(u.children,e,x,v,p)),!(u.path==null&&!u.index)&&e.push({path:v,score:hC(v,u.index),routesMeta:x})};return t.forEach((u,f)=>{if(u.path===""||!u.path?.includes("?"))l(u,f);else for(let p of GE(u.path))l(u,f,!0,p)}),e}function GE(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let u=GE(i.join("/")),f=[];return f.push(...u.map(p=>p===""?l:[l,p].join("/"))),a&&f.push(...u),f.map(p=>t.startsWith("/")&&p===""?"/":p)}function sC(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:fC(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var aC=/^:[\w-]+$/,oC=3,lC=2,cC=1,uC=10,dC=-2,wb=t=>t==="*";function hC(t,e){let n=t.split("/"),i=n.length;return n.some(wb)&&(i+=dC),e&&(i+=lC),n.filter(a=>!wb(a)).reduce((a,l)=>a+(aC.test(l)?oC:l===""?cC:uC),i)}function fC(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function mC(t,e,n=!1){let{routesMeta:i}=t,a={},l="/",u=[];for(let f=0;f<i.length;++f){let p=i[f],g=f===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",v=mh({path:p.relativePath,caseSensitive:p.caseSensitive,end:g},_),x=p.route;if(!v&&g&&n&&!i[i.length-1].route.index&&(v=mh({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},_)),!v)return null;Object.assign(a,v.params),u.push({params:a,pathname:Ui([l,v.pathname]),pathnameBase:bC(Ui([l,v.pathnameBase])),route:x}),v.pathnameBase!=="/"&&(l=Ui([l,v.pathnameBase]))}return u}function mh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=pC(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],u=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:i.reduce((g,{paramName:_,isOptional:v},x)=>{if(_==="*"){let A=f[x]||"";u=l.slice(0,l.length-A.length).replace(/(.)\/+$/,"$1")}const w=f[x];return v&&!w?g[_]=void 0:g[_]=(w||"").replace(/%2F/g,"/"),g},{}),pathname:l,pathnameBase:u,pattern:t}}function pC(t,e=!1,n=!0){rr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,f,p)=>(i.push({paramName:f,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function gC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return rr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Hi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var QE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yC=t=>QE.test(t);function _C(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?ol(t):t,l;if(n)if(yC(n))l=n;else{if(n.includes("//")){let u=n;n=n.replace(/\/\/+/g,"/"),rr(!1,`Pathnames cannot have embedded double slashes - normalizing ${u} -> ${n}`)}n.startsWith("/")?l=Tb(n.substring(1),"/"):l=Tb(n,e)}else l=e;return{pathname:l,search:xC(i),hash:EC(a)}}function Tb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function bp(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function vC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Rg(t){let e=vC(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function Dg(t,e,n,i=!1){let a;typeof t=="string"?a=ol(t):(a={...t},Rt(!a.pathname||!a.pathname.includes("?"),bp("?","pathname","search",a)),Rt(!a.pathname||!a.pathname.includes("#"),bp("#","pathname","hash",a)),Rt(!a.search||!a.search.includes("#"),bp("#","search","hash",a)));let l=t===""||a.pathname==="",u=l?"/":a.pathname,f;if(u==null)f=n;else{let v=e.length-1;if(!i&&u.startsWith("..")){let x=u.split("/");for(;x[0]==="..";)x.shift(),v-=1;a.pathname=x.join("/")}f=v>=0?e[v]:"/"}let p=_C(a,f),g=u&&u!=="/"&&u.endsWith("/"),_=(l||u===".")&&n.endsWith("/");return!p.pathname.endsWith("/")&&(g||_)&&(p.pathname+="/"),p}var Ui=t=>t.join("/").replace(/\/\/+/g,"/"),bC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),xC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,EC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,SC=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function wC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function TC(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var $E=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function KE(t,e){let n=t;if(typeof n!="string"||!QE.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if($E)try{let l=new URL(window.location.href),u=n.startsWith("//")?new URL(l.protocol+n):new URL(n),f=Hi(u.pathname,e);u.origin===l.origin&&f!=null?n=f+u.search+u.hash:a=!0}catch{rr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var WE=["POST","PUT","PATCH","DELETE"];new Set(WE);var AC=["GET",...WE];new Set(AC);var ll=T.createContext(null);ll.displayName="DataRouter";var zh=T.createContext(null);zh.displayName="DataRouterState";var CC=T.createContext(!1),YE=T.createContext({isTransitioning:!1});YE.displayName="ViewTransition";var RC=T.createContext(new Map);RC.displayName="Fetchers";var DC=T.createContext(null);DC.displayName="Await";var ir=T.createContext(null);ir.displayName="Navigation";var eu=T.createContext(null);eu.displayName="Location";var xr=T.createContext({outlet:null,matches:[],isDataRoute:!1});xr.displayName="Route";var Ig=T.createContext(null);Ig.displayName="RouteError";var XE="REACT_ROUTER_ERROR",IC="REDIRECT",jC="ROUTE_ERROR_RESPONSE";function OC(t){if(t.startsWith(`${XE}:${IC}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function kC(t){if(t.startsWith(`${XE}:${jC}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new SC(e.status,e.statusText,e.data)}catch{}}function MC(t,{relative:e}={}){Rt(cl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=T.useContext(ir),{hash:a,pathname:l,search:u}=nu(t,{relative:e}),f=l;return n!=="/"&&(f=l==="/"?n:Ui([n,l])),i.createHref({pathname:f,search:u,hash:a})}function cl(){return T.useContext(eu)!=null}function Mn(){return Rt(cl(),"useLocation() may be used only in the context of a <Router> component."),T.useContext(eu).location}var JE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ZE(t){T.useContext(ir).static||T.useLayoutEffect(t)}function tu(){let{isDataRoute:t}=T.useContext(xr);return t?YC():NC()}function NC(){Rt(cl(),"useNavigate() may be used only in the context of a <Router> component.");let t=T.useContext(ll),{basename:e,navigator:n}=T.useContext(ir),{matches:i}=T.useContext(xr),{pathname:a}=Mn(),l=JSON.stringify(Rg(i)),u=T.useRef(!1);return ZE(()=>{u.current=!0}),T.useCallback((p,g={})=>{if(rr(u.current,JE),!u.current)return;if(typeof p=="number"){n.go(p);return}let _=Dg(p,JSON.parse(l),a,g.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:Ui([e,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[e,n,l,a,t])}var PC=T.createContext(null);function LC(t){let e=T.useContext(xr).outlet;return T.useMemo(()=>e&&T.createElement(PC.Provider,{value:t},e),[e,t])}function VC(){let{matches:t}=T.useContext(xr),e=t[t.length-1];return e?e.params:{}}function nu(t,{relative:e}={}){let{matches:n}=T.useContext(xr),{pathname:i}=Mn(),a=JSON.stringify(Rg(n));return T.useMemo(()=>Dg(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function zC(t,e){return eS(t,e)}function eS(t,e,n,i,a){Rt(cl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=T.useContext(ir),{matches:u}=T.useContext(xr),f=u[u.length-1],p=f?f.params:{},g=f?f.pathname:"/",_=f?f.pathnameBase:"/",v=f&&f.route;{let $=v&&v.path||"";nS(g,!v||$.endsWith("*")||$.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${$}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${$}"> to <Route path="${$==="/"?"*":`${$}/*`}">.`)}let x=Mn(),w;if(e){let $=typeof e=="string"?ol(e):e;Rt(_==="/"||$.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${$.pathname}" was given in the \`location\` prop.`),w=$}else w=x;let A=w.pathname||"/",I=A;if(_!=="/"){let $=_.replace(/^\//,"").split("/");I="/"+A.replace(/^\//,"").split("/").slice($.length).join("/")}let N=qE(t,{pathname:I});rr(v||N!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),rr(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let H=HC(N&&N.map($=>Object.assign({},$,{params:Object.assign({},p,$.params),pathname:Ui([_,l.encodeLocation?l.encodeLocation($.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:$.pathname]),pathnameBase:$.pathnameBase==="/"?_:Ui([_,l.encodeLocation?l.encodeLocation($.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:$.pathnameBase])})),u,n,i,a);return e&&H?T.createElement(eu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},H):H}function UC(){let t=WC(),e=wC(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=T.createElement(T.Fragment,null,T.createElement("p",null," Hey developer "),T.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",T.createElement("code",{style:l},"ErrorBoundary")," or"," ",T.createElement("code",{style:l},"errorElement")," prop on your route.")),T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),n?T.createElement("pre",{style:a},n):null,u)}var BC=T.createElement(UC,null),tS=class extends T.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=kC(t.digest);n&&(t=n)}let e=t!==void 0?T.createElement(xr.Provider,{value:this.props.routeContext},T.createElement(Ig.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?T.createElement(FC,{error:t},e):e}};tS.contextType=CC;var xp=new WeakMap;function FC({children:t,error:e}){let{basename:n}=T.useContext(ir);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=OC(e.digest);if(i){let a=xp.get(e);if(a)throw a;let l=KE(i.location,n);if($E&&!xp.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw xp.set(e,u),u}return T.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function qC({routeContext:t,match:e,children:n}){let i=T.useContext(ll);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),T.createElement(xr.Provider,{value:t},n)}function HC(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,u=n?.errors;if(u!=null){let _=l.findIndex(v=>v.route.id&&u?.[v.route.id]!==void 0);Rt(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let f=!1,p=-1;if(n)for(let _=0;_<l.length;_++){let v=l[_];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(p=_),v.route.id){let{loaderData:x,errors:w}=n,A=v.route.loader&&!x.hasOwnProperty(v.route.id)&&(!w||w[v.route.id]===void 0);if(v.route.lazy||A){f=!0,p>=0?l=l.slice(0,p+1):l=[l[0]];break}}}let g=n&&i?(_,v)=>{i(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:TC(n.matches),errorInfo:v})}:void 0;return l.reduceRight((_,v,x)=>{let w,A=!1,I=null,N=null;n&&(w=u&&v.route.id?u[v.route.id]:void 0,I=v.route.errorElement||BC,f&&(p<0&&x===0?(nS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,N=null):p===x&&(A=!0,N=v.route.hydrateFallbackElement||null)));let H=e.concat(l.slice(0,x+1)),$=()=>{let q;return w?q=I:A?q=N:v.route.Component?q=T.createElement(v.route.Component,null):v.route.element?q=v.route.element:q=_,T.createElement(qC,{match:v,routeContext:{outlet:_,matches:H,isDataRoute:n!=null},children:q})};return n&&(v.route.ErrorBoundary||v.route.errorElement||x===0)?T.createElement(tS,{location:n.location,revalidation:n.revalidation,component:I,error:w,children:$(),routeContext:{outlet:null,matches:H,isDataRoute:!0},onError:g}):$()},null)}function jg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function GC(t){let e=T.useContext(ll);return Rt(e,jg(t)),e}function QC(t){let e=T.useContext(zh);return Rt(e,jg(t)),e}function $C(t){let e=T.useContext(xr);return Rt(e,jg(t)),e}function Og(t){let e=$C(t),n=e.matches[e.matches.length-1];return Rt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function KC(){return Og("useRouteId")}function WC(){let t=T.useContext(Ig),e=QC("useRouteError"),n=Og("useRouteError");return t!==void 0?t:e.errors?.[n]}function YC(){let{router:t}=GC("useNavigate"),e=Og("useNavigate"),n=T.useRef(!1);return ZE(()=>{n.current=!0}),T.useCallback(async(a,l={})=>{rr(n.current,JE),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var Ab={};function nS(t,e,n){!e&&!Ab[t]&&(Ab[t]=!0,rr(!1,n))}T.memo(XC);function XC({routes:t,future:e,state:n,onError:i}){return eS(t,void 0,n,i,e)}function Uh({to:t,replace:e,state:n,relative:i}){Rt(cl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=T.useContext(ir);rr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=T.useContext(xr),{pathname:u}=Mn(),f=tu(),p=Dg(t,Rg(l),u,i==="path"),g=JSON.stringify(p);return T.useEffect(()=>{f(JSON.parse(g),{replace:e,state:n,relative:i})},[f,g,i,e,n]),null}function Bh(t){return LC(t.context)}function Xt(t){Rt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function JC({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:u}){Rt(!cl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=t.replace(/^\/*/,"/"),p=T.useMemo(()=>({basename:f,navigator:a,static:l,unstable_useTransitions:u,future:{}}),[f,a,l,u]);typeof n=="string"&&(n=ol(n));let{pathname:g="/",search:_="",hash:v="",state:x=null,key:w="default"}=n,A=T.useMemo(()=>{let I=Hi(g,f);return I==null?null:{location:{pathname:I,search:_,hash:v,state:x,key:w},navigationType:i}},[f,g,_,v,x,w,i]);return rr(A!=null,`<Router basename="${f}"> is not able to match the URL "${g}${_}${v}" because it does not start with the basename, so the <Router> won't render anything.`),A==null?null:T.createElement(ir.Provider,{value:p},T.createElement(eu.Provider,{children:e,value:A}))}function ZC({children:t,location:e}){return zC(Fp(t),e)}function Fp(t,e=[]){let n=[];return T.Children.forEach(t,(i,a)=>{if(!T.isValidElement(i))return;let l=[...e,a];if(i.type===T.Fragment){n.push.apply(n,Fp(i.props.children,l));return}Rt(i.type===Xt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Rt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let u={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(u.children=Fp(i.props.children,l)),n.push(u)}),n}var eh="get",th="application/x-www-form-urlencoded";function Fh(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function eR(t){return Fh(t)&&t.tagName.toLowerCase()==="button"}function tR(t){return Fh(t)&&t.tagName.toLowerCase()==="form"}function nR(t){return Fh(t)&&t.tagName.toLowerCase()==="input"}function rR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function iR(t,e){return t.button===0&&(!e||e==="_self")&&!rR(t)}function qp(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(a=>[n,a]):[[n,i]])},[]))}function sR(t,e){let n=qp(t);return e&&e.forEach((i,a)=>{n.has(a)||e.getAll(a).forEach(l=>{n.append(a,l)})}),n}var Qd=null;function aR(){if(Qd===null)try{new FormData(document.createElement("form"),0),Qd=!1}catch{Qd=!0}return Qd}var oR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ep(t){return t!=null&&!oR.has(t)?(rr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${th}"`),null):t}function lR(t,e){let n,i,a,l,u;if(tR(t)){let f=t.getAttribute("action");i=f?Hi(f,e):null,n=t.getAttribute("method")||eh,a=Ep(t.getAttribute("enctype"))||th,l=new FormData(t)}else if(eR(t)||nR(t)&&(t.type==="submit"||t.type==="image")){let f=t.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=t.getAttribute("formaction")||f.getAttribute("action");if(i=p?Hi(p,e):null,n=t.getAttribute("formmethod")||f.getAttribute("method")||eh,a=Ep(t.getAttribute("formenctype"))||Ep(f.getAttribute("enctype"))||th,l=new FormData(f,t),!aR()){let{name:g,type:_,value:v}=t;if(_==="image"){let x=g?`${g}.`:"";l.append(`${x}x`,"0"),l.append(`${x}y`,"0")}else g&&l.append(g,v)}}else{if(Fh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=eh,i=null,a=th,u=t}return l&&a==="text/plain"&&(u=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function kg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function cR(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Hi(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function uR(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function dR(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function hR(t,e,n){let i=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let u=await uR(l,n);return u.links?u.links():[]}return[]}));return gR(i.flat(1).filter(dR).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Cb(t,e,n,i,a,l){let u=(p,g)=>n[g]?p.route.id!==n[g].route.id:!0,f=(p,g)=>n[g].pathname!==p.pathname||n[g].route.path?.endsWith("*")&&n[g].params["*"]!==p.params["*"];return l==="assets"?e.filter((p,g)=>u(p,g)||f(p,g)):l==="data"?e.filter((p,g)=>{let _=i.routes[p.route.id];if(!_||!_.hasLoader)return!1;if(u(p,g)||f(p,g))return!0;if(p.route.shouldRevalidate){let v=p.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function fR(t,e,{includeHydrateFallback:n}={}){return mR(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function mR(t){return[...new Set(t)]}function pR(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function gR(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let l=JSON.stringify(pR(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function rS(){let t=T.useContext(ll);return kg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function yR(){let t=T.useContext(zh);return kg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Mg=T.createContext(void 0);Mg.displayName="FrameworkContext";function iS(){let t=T.useContext(Mg);return kg(t,"You must render this element inside a <HydratedRouter> element"),t}function _R(t,e){let n=T.useContext(Mg),[i,a]=T.useState(!1),[l,u]=T.useState(!1),{onFocus:f,onBlur:p,onMouseEnter:g,onMouseLeave:_,onTouchStart:v}=e,x=T.useRef(null);T.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let I=H=>{H.forEach($=>{u($.isIntersecting)})},N=new IntersectionObserver(I,{threshold:.5});return x.current&&N.observe(x.current),()=>{N.disconnect()}}},[t]),T.useEffect(()=>{if(i){let I=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(I)}}},[i]);let w=()=>{a(!0)},A=()=>{a(!1),u(!1)};return n?t!=="intent"?[l,x,{}]:[l,x,{onFocus:Rc(f,w),onBlur:Rc(p,A),onMouseEnter:Rc(g,w),onMouseLeave:Rc(_,A),onTouchStart:Rc(v,w)}]:[!1,x,{}]}function Rc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function vR({page:t,...e}){let{router:n}=rS(),i=T.useMemo(()=>qE(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?T.createElement(xR,{page:t,matches:i,...e}):null}function bR(t){let{manifest:e,routeModules:n}=iS(),[i,a]=T.useState([]);return T.useEffect(()=>{let l=!1;return hR(t,e,n).then(u=>{l||a(u)}),()=>{l=!0}},[t,e,n]),i}function xR({page:t,matches:e,...n}){let i=Mn(),{manifest:a,routeModules:l}=iS(),{basename:u}=rS(),{loaderData:f,matches:p}=yR(),g=T.useMemo(()=>Cb(t,e,p,a,i,"data"),[t,e,p,a,i]),_=T.useMemo(()=>Cb(t,e,p,a,i,"assets"),[t,e,p,a,i]),v=T.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let A=new Set,I=!1;if(e.forEach(H=>{let $=a.routes[H.route.id];!$||!$.hasLoader||(!g.some(q=>q.route.id===H.route.id)&&H.route.id in f&&l[H.route.id]?.shouldRevalidate||$.hasClientLoader?I=!0:A.add(H.route.id))}),A.size===0)return[];let N=cR(t,u,"data");return I&&A.size>0&&N.searchParams.set("_routes",e.filter(H=>A.has(H.route.id)).map(H=>H.route.id).join(",")),[N.pathname+N.search]},[u,f,i,a,g,e,t,l]),x=T.useMemo(()=>fR(_,a),[_,a]),w=bR(_);return T.createElement(T.Fragment,null,v.map(A=>T.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...n})),x.map(A=>T.createElement("link",{key:A,rel:"modulepreload",href:A,...n})),w.map(({key:A,link:I})=>T.createElement("link",{key:A,nonce:n.nonce,...I})))}function ER(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var SR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{SR&&(window.__reactRouterVersion="7.11.0")}catch{}function wR({basename:t,children:e,unstable_useTransitions:n,window:i}){let a=T.useRef();a.current==null&&(a.current=eC({window:i,v5Compat:!0}));let l=a.current,[u,f]=T.useState({action:l.action,location:l.location}),p=T.useCallback(g=>{n===!1?f(g):T.startTransition(()=>f(g))},[n]);return T.useLayoutEffect(()=>l.listen(p),[l,p]),T.createElement(JC,{basename:t,children:e,location:u.location,navigationType:u.action,navigator:l,unstable_useTransitions:n})}var sS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,It=T.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:u,state:f,target:p,to:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:x,...w},A){let{basename:I,unstable_useTransitions:N}=T.useContext(ir),H=typeof g=="string"&&sS.test(g),$=KE(g,I);g=$.to;let q=MC(g,{relative:a}),[me,re,he]=_R(i,w),L=RR(g,{replace:u,state:f,target:p,preventScrollReset:_,relative:a,viewTransition:v,unstable_defaultShouldRevalidate:x,unstable_useTransitions:N});function D(M){e&&e(M),M.defaultPrevented||L(M)}let R=T.createElement("a",{...w,...he,href:$.absoluteURL||q,onClick:$.isExternal||l?e:D,ref:ER(A,re),target:p,"data-discover":!H&&n==="render"?"true":void 0});return me&&!H?T.createElement(T.Fragment,null,R,T.createElement(vR,{page:q})):R});It.displayName="Link";var TR=T.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:u,viewTransition:f,children:p,...g},_){let v=nu(u,{relative:g.relative}),x=Mn(),w=T.useContext(zh),{navigator:A,basename:I}=T.useContext(ir),N=w!=null&&MR(v)&&f===!0,H=A.encodeLocation?A.encodeLocation(v).pathname:v.pathname,$=x.pathname,q=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||($=$.toLowerCase(),q=q?q.toLowerCase():null,H=H.toLowerCase()),q&&I&&(q=Hi(q,I)||q);const me=H!=="/"&&H.endsWith("/")?H.length-1:H.length;let re=$===H||!a&&$.startsWith(H)&&$.charAt(me)==="/",he=q!=null&&(q===H||!a&&q.startsWith(H)&&q.charAt(H.length)==="/"),L={isActive:re,isPending:he,isTransitioning:N},D=re?e:void 0,R;typeof i=="function"?R=i(L):R=[i,re?"active":null,he?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let M=typeof l=="function"?l(L):l;return T.createElement(It,{...g,"aria-current":D,className:R,ref:_,style:M,to:u,viewTransition:f},typeof p=="function"?p(L):p)});TR.displayName="NavLink";var AR=T.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:l,method:u=eh,action:f,onSubmit:p,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:x,...w},A)=>{let{unstable_useTransitions:I}=T.useContext(ir),N=OR(),H=kR(f,{relative:g}),$=u.toLowerCase()==="get"?"get":"post",q=typeof f=="string"&&sS.test(f),me=re=>{if(p&&p(re),re.defaultPrevented)return;re.preventDefault();let he=re.nativeEvent.submitter,L=he?.getAttribute("formmethod")||u,D=()=>N(he||re.currentTarget,{fetcherKey:e,method:L,navigate:n,replace:a,state:l,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:x});I&&n!==!1?T.startTransition(()=>D()):D()};return T.createElement("form",{ref:A,method:$,action:H,onSubmit:i?p:me,...w,"data-discover":!q&&t==="render"?"true":void 0})});AR.displayName="Form";function CR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function aS(t){let e=T.useContext(ll);return Rt(e,CR(t)),e}function RR(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:u,unstable_defaultShouldRevalidate:f,unstable_useTransitions:p}={}){let g=tu(),_=Mn(),v=nu(t,{relative:l});return T.useCallback(x=>{if(iR(x,e)){x.preventDefault();let w=n!==void 0?n:Fc(_)===Fc(v),A=()=>g(t,{replace:w,state:i,preventScrollReset:a,relative:l,viewTransition:u,unstable_defaultShouldRevalidate:f});p?T.startTransition(()=>A()):A()}},[_,g,v,n,i,e,t,a,l,u,f,p])}function DR(t){rr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=T.useRef(qp(t)),n=T.useRef(!1),i=Mn(),a=T.useMemo(()=>sR(i.search,n.current?null:e.current),[i.search]),l=tu(),u=T.useCallback((f,p)=>{const g=qp(typeof f=="function"?f(new URLSearchParams(a)):f);n.current=!0,l("?"+g,p)},[l,a]);return[a,u]}var IR=0,jR=()=>`__${String(++IR)}__`;function OR(){let{router:t}=aS("useSubmit"),{basename:e}=T.useContext(ir),n=KC(),i=t.fetch,a=t.navigate;return T.useCallback(async(l,u={})=>{let{action:f,method:p,encType:g,formData:_,body:v}=lR(l,e);if(u.navigate===!1){let x=u.fetcherKey||jR();await i(x,n,u.action||f,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:_,body:v,formMethod:u.method||p,formEncType:u.encType||g,flushSync:u.flushSync})}else await a(u.action||f,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:_,body:v,formMethod:u.method||p,formEncType:u.encType||g,replace:u.replace,state:u.state,fromRouteId:n,flushSync:u.flushSync,viewTransition:u.viewTransition})},[i,a,e,n])}function kR(t,{relative:e}={}){let{basename:n}=T.useContext(ir),i=T.useContext(xr);Rt(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...nu(t||".",{relative:e})},u=Mn();if(t==null){l.search=u.search;let f=new URLSearchParams(l.search),p=f.getAll("index");if(p.some(_=>_==="")){f.delete("index"),p.filter(v=>v).forEach(v=>f.append("index",v));let _=f.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Ui([n,l.pathname])),Fc(l)}function MR(t,{relative:e}={}){let n=T.useContext(YE);Rt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=aS("useViewTransitionState"),a=nu(t,{relative:e});if(!n.isTransitioning)return!1;let l=Hi(n.currentLocation.pathname,i)||n.currentLocation.pathname,u=Hi(n.nextLocation.pathname,i)||n.nextLocation.pathname;return mh(a.pathname,u)!=null||mh(a.pathname,l)!=null}const NR=function(){},PR={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:NR},ru=T.createContext(PR);var ul=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},LR={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},VR=class{#e=LR;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Pi=new VR;function zR(t){setTimeout(t,0)}var Ma=typeof window>"u"||"Deno"in globalThis;function rn(){}function UR(t,e){return typeof t=="function"?t(e):t}function Hp(t){return typeof t=="number"&&t>=0&&t!==1/0}function oS(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Vs(t,e){return typeof t=="function"?t(e):t}function vr(t,e){return typeof t=="function"?t(e):t}function Rb(t,e){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:u,stale:f}=t;if(u){if(i){if(e.queryHash!==Ng(u,e.options))return!1}else if(!qc(e.queryKey,u))return!1}if(n!=="all"){const p=e.isActive();if(n==="active"&&!p||n==="inactive"&&p)return!1}return!(typeof f=="boolean"&&e.isStale()!==f||a&&a!==e.state.fetchStatus||l&&!l(e))}function Db(t,e){const{exact:n,status:i,predicate:a,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(Na(e.options.mutationKey)!==Na(l))return!1}else if(!qc(e.options.mutationKey,l))return!1}return!(i&&e.state.status!==i||a&&!a(e))}function Ng(t,e){return(e?.queryKeyHashFn||Na)(t)}function Na(t){return JSON.stringify(t,(e,n)=>Gp(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function qc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>qc(t[n],e[n])):!1}var BR=Object.prototype.hasOwnProperty;function lS(t,e){if(t===e)return t;const n=Ib(t)&&Ib(e);if(!n&&!(Gp(t)&&Gp(e)))return e;const a=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),u=l.length,f=n?new Array(u):{};let p=0;for(let g=0;g<u;g++){const _=n?g:l[g],v=t[_],x=e[_];if(v===x){f[_]=v,(n?g<a:BR.call(t,_))&&p++;continue}if(v===null||x===null||typeof v!="object"||typeof x!="object"){f[_]=x;continue}const w=lS(v,x);f[_]=w,w===v&&p++}return a===u&&p===a?t:f}function ph(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Ib(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Gp(t){if(!jb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!jb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function jb(t){return Object.prototype.toString.call(t)==="[object Object]"}function FR(t){return new Promise(e=>{Pi.setTimeout(e,t)})}function Qp(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?lS(t,e):e}function qR(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function HR(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var Pg=Symbol();function cS(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Pg?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function uS(t,e){return typeof t=="function"?t(...e):!!t}var GR=class extends ul{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!Ma&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Lg=new GR;function $p(){let t,e;const n=new Promise((a,l)=>{t=a,e=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),e(a)},n}function QR(t){let e;if(t.then(n=>(e=n,n),rn)?.catch(rn),e!==void 0)return{data:e}}function dS(t){return t}function $R(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function KR(t,e,n){const i=()=>{const a=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return a?.catch(rn),a};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:i()},...t.meta&&{meta:t.meta}}}function WR(t){return t.state.isPaused}function YR(t){return t.state.status==="success"}function XR(t){return!0}function JR(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??WR,i=t.getMutationCache().getAll().flatMap(p=>n(p)?[$R(p)]:[]),a=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??YR,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??XR,u=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??dS,f=t.getQueryCache().getAll().flatMap(p=>a(p)?[KR(p,u,l)]:[]);return{mutations:i,queries:f}}function ZR(t,e,n){if(typeof e!="object"||e===null)return;const i=t.getMutationCache(),a=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??dS,u=e.mutations||[],f=e.queries||[];u.forEach(({state:p,...g})=>{i.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...g},p)}),f.forEach(({queryKey:p,state:g,queryHash:_,meta:v,promise:x,dehydratedAt:w})=>{const A=x?QR(x):void 0,I=g.data===void 0?A?.data:g.data,N=I===void 0?I:l(I);let H=a.get(_);const $=H?.state.status==="pending",q=H?.state.fetchStatus==="fetching";if(H){const me=A&&w!==void 0&&w>H.state.dataUpdatedAt;if(g.dataUpdatedAt>H.state.dataUpdatedAt||me){const{fetchStatus:re,...he}=g;H.setState({...he,data:N})}}else H=a.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:p,queryHash:_,meta:v},{...g,data:N,fetchStatus:"idle",status:N!==void 0?"success":g.status});x&&!$&&!q&&(w===void 0||w>H.state.dataUpdatedAt)&&H.fetch(void 0,{initialPromise:Promise.resolve(x).then(l)}).catch(rn)})}var eD=zR;function tD(){let t=[],e=0,n=f=>{f()},i=f=>{f()},a=eD;const l=f=>{e?t.push(f):a(()=>{n(f)})},u=()=>{const f=t;t=[],f.length&&a(()=>{i(()=>{f.forEach(p=>{n(p)})})})};return{batch:f=>{let p;e++;try{p=f()}finally{e--,e||u()}return p},batchCalls:f=>(...p)=>{l(()=>{f(...p)})},schedule:l,setNotifyFunction:f=>{n=f},setBatchNotifyFunction:f=>{i=f},setScheduler:f=>{a=f}}}var sn=tD(),nD=class extends ul{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!Ma&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},gh=new nD;function rD(t){return Math.min(1e3*2**t,3e4)}function hS(t){return(t??"online")==="online"?gh.isOnline():!0}var Kp=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function fS(t){let e=!1,n=0,i;const a=$p(),l=()=>a.status!=="pending",u=I=>{if(!l()){const N=new Kp(I);x(N),t.onCancel?.(N)}},f=()=>{e=!0},p=()=>{e=!1},g=()=>Lg.isFocused()&&(t.networkMode==="always"||gh.isOnline())&&t.canRun(),_=()=>hS(t.networkMode)&&t.canRun(),v=I=>{l()||(i?.(),a.resolve(I))},x=I=>{l()||(i?.(),a.reject(I))},w=()=>new Promise(I=>{i=N=>{(l()||g())&&I(N)},t.onPause?.()}).then(()=>{i=void 0,l()||t.onContinue?.()}),A=()=>{if(l())return;let I;const N=n===0?t.initialPromise:void 0;try{I=N??t.fn()}catch(H){I=Promise.reject(H)}Promise.resolve(I).then(v).catch(H=>{if(l())return;const $=t.retry??(Ma?0:3),q=t.retryDelay??rD,me=typeof q=="function"?q(n,H):q,re=$===!0||typeof $=="number"&&n<$||typeof $=="function"&&$(n,H);if(e||!re){x(H);return}n++,t.onFail?.(n,H),FR(me).then(()=>g()?void 0:w()).then(()=>{e?x(H):A()})})};return{promise:a,status:()=>a.status,cancel:u,continue:()=>(i?.(),a),cancelRetry:f,continueRetry:p,canStart:_,start:()=>(_()?A():w().then(A),a)}}var mS=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Hp(this.gcTime)&&(this.#e=Pi.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Ma?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Pi.clearTimeout(this.#e),this.#e=void 0)}},iD=class extends mS{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=kb(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=kb(this.options);n.data!==void 0&&(this.setState(Ob(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const i=Qp(this.state.data,e,this.options);return this.#s({data:i,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),i}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then(rn).catch(rn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>vr(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Pg||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Vs(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!oS(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const p=this.observers.find(g=>g.options.queryFn);p&&this.setOptions(p.options)}const i=new AbortController,a=p=>{Object.defineProperty(p,"signal",{enumerable:!0,get:()=>(this.#o=!0,i.signal)})},l=()=>{const p=cS(this.options,n),_=(()=>{const v={client:this.#i,queryKey:this.queryKey,meta:this.meta};return a(v),v})();return this.#o=!1,this.options.persister?this.options.persister(p,_,this):p(_)},f=(()=>{const p={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return a(p),p})();this.options.behavior?.onFetch(f,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==f.fetchOptions?.meta)&&this.#s({type:"fetch",meta:f.fetchOptions?.meta}),this.#r=fS({initialPromise:n?.initialPromise,fn:f.fetchFn,onCancel:p=>{p instanceof Kp&&p.revert&&this.setState({...this.#t,fetchStatus:"idle"}),i.abort()},onFail:(p,g)=>{this.#s({type:"failed",failureCount:p,error:g})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:f.options.retry,retryDelay:f.options.retryDelay,networkMode:f.options.networkMode,canRun:()=>!0});try{const p=await this.#r.start();if(p===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(p),this.#n.config.onSuccess?.(p,this),this.#n.config.onSettled?.(p,this.state.error,this),p}catch(p){if(p instanceof Kp){if(p.silent)return this.#r.promise;if(p.revert){if(this.state.data===void 0)throw p;return this.state.data}}throw this.#s({type:"error",error:p}),this.#n.config.onError?.(p,this),this.#n.config.onSettled?.(this.state.data,p,this),p}finally{this.scheduleGc()}}#s(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...pS(i.data,this.options),fetchMeta:e.meta??null};case"success":const a={...i,...Ob(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const l=e.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),sn.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function pS(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:hS(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Ob(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function kb(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var sD=class extends ul{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=$p(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Mb(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Wp(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Wp(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#x(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof vr(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#E(),this.#t.setOptions(this.options),e._defaulted&&!ph(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&Nb(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),i&&(this.#t!==n||vr(this.options.enabled,this.#t)!==vr(e.enabled,this.#t)||Vs(this.options.staleTime,this.#t)!==Vs(e.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||vr(this.options.enabled,this.#t)!==vr(e.enabled,this.#t)||a!==this.#l)&&this.#_(a)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return oD(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),e?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#E();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(rn)),e}#g(){this.#b();const t=Vs(this.options.staleTime,this.#t);if(Ma||this.#i.isStale||!Hp(t))return;const n=oS(this.#i.dataUpdatedAt,t)+1;this.#c=Pi.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#x(),this.#l=t,!(Ma||vr(this.options.enabled,this.#t)===!1||!Hp(this.#l)||this.#l===0)&&(this.#u=Pi.setInterval(()=>{(this.options.refetchIntervalInBackground||Lg.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#b(){this.#c&&(Pi.clearTimeout(this.#c),this.#c=void 0)}#x(){this.#u&&(Pi.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,i=this.options,a=this.#i,l=this.#r,u=this.#a,p=t!==n?t.state:this.#n,{state:g}=t;let _={...g},v=!1,x;if(e._optimisticResults){const D=this.hasListeners(),R=!D&&Mb(t,e),M=D&&Nb(t,n,e,i);(R||M)&&(_={..._,...pS(g.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:w,errorUpdatedAt:A,status:I}=_;x=_.data;let N=!1;if(e.placeholderData!==void 0&&x===void 0&&I==="pending"){let D;a?.isPlaceholderData&&e.placeholderData===u?.placeholderData?(D=a.data,N=!0):D=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,D!==void 0&&(I="success",x=Qp(a?.data,D,e),v=!0)}if(e.select&&x!==void 0&&!N)if(a&&x===l?.data&&e.select===this.#p)x=this.#h;else try{this.#p=e.select,x=e.select(x),x=Qp(a?.data,x,e),this.#h=x,this.#s=null}catch(D){this.#s=D}this.#s&&(w=this.#s,x=this.#h,A=Date.now(),I="error");const H=_.fetchStatus==="fetching",$=I==="pending",q=I==="error",me=$&&H,re=x!==void 0,L={status:I,fetchStatus:_.fetchStatus,isPending:$,isSuccess:I==="success",isError:q,isInitialLoading:me,isLoading:me,data:x,dataUpdatedAt:_.dataUpdatedAt,error:w,errorUpdatedAt:A,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>p.dataUpdateCount||_.errorUpdateCount>p.errorUpdateCount,isFetching:H,isRefetching:H&&!$,isLoadingError:q&&!re,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:q&&re,isStale:Vg(t,e),refetch:this.refetch,promise:this.#o,isEnabled:vr(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const D=j=>{L.status==="error"?j.reject(L.error):L.data!==void 0&&j.resolve(L.data)},R=()=>{const j=this.#o=L.promise=$p();D(j)},M=this.#o;switch(M.status){case"pending":t.queryHash===n.queryHash&&D(M);break;case"fulfilled":(L.status==="error"||L.data!==M.value)&&R();break;case"rejected":(L.status!=="error"||L.error!==M.reason)&&R();break}}return L}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),ph(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(u=>{const f=u;return this.#i[f]!==t[f]&&l.has(f)})};this.#S({listeners:n()})}#E(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#S(t){sn.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function aD(t,e){return vr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Mb(t,e){return aD(t,e)||t.state.data!==void 0&&Wp(t,e,e.refetchOnMount)}function Wp(t,e,n){if(vr(e.enabled,t)!==!1&&Vs(e.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&Vg(t,e)}return!1}function Nb(t,e,n,i){return(t!==e||vr(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Vg(t,n)}function Vg(t,e){return vr(e.enabled,t)!==!1&&t.isStaleByTime(Vs(e.staleTime,t))}function oD(t,e){return!ph(t.getCurrentResult(),e)}function Pb(t){return{onFetch:(e,n)=>{const i=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],u=e.state.data?.pageParams||[];let f={pages:[],pageParams:[]},p=0;const g=async()=>{let _=!1;const v=A=>{Object.defineProperty(A,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},x=cS(e.options,e.fetchOptions),w=async(A,I,N)=>{if(_)return Promise.reject();if(I==null&&A.pages.length)return Promise.resolve(A);const $=(()=>{const he={client:e.client,queryKey:e.queryKey,pageParam:I,direction:N?"backward":"forward",meta:e.options.meta};return v(he),he})(),q=await x($),{maxPages:me}=e.options,re=N?HR:qR;return{pages:re(A.pages,q,me),pageParams:re(A.pageParams,I,me)}};if(a&&l.length){const A=a==="backward",I=A?lD:Lb,N={pages:l,pageParams:u},H=I(i,N);f=await w(N,H,A)}else{const A=t??l.length;do{const I=p===0?u[0]??i.initialPageParam:Lb(i,f);if(p>0&&I==null)break;f=await w(f,I),p++}while(p<A)}return f};e.options.persister?e.fetchFn=()=>e.options.persister?.(g,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=g}}}function Lb(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function lD(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var cD=class extends mS{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||gS(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=fS({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(u,f)=>{this.#r({type:"failed",failureCount:u,error:f})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",l=!this.#i.canStart();try{if(a)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,i);const f=await this.options.onMutate?.(e,i);f!==this.state.context&&this.#r({type:"pending",context:f,variables:e,isPaused:l})}const u=await this.#i.start();return await this.#n.config.onSuccess?.(u,e,this.state.context,this,i),await this.options.onSuccess?.(u,e,this.state.context,i),await this.#n.config.onSettled?.(u,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(u,null,e,this.state.context,i),this.#r({type:"success",data:u}),u}catch(u){try{throw await this.#n.config.onError?.(u,e,this.state.context,this,i),await this.options.onError?.(u,e,this.state.context,i),await this.#n.config.onSettled?.(void 0,u,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,u,e,this.state.context,i),u}finally{this.#r({type:"error",error:u})}}finally{this.#n.runNext(this)}}#r(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),sn.batch(()=>{this.#t.forEach(i=>{i.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function gS(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var uD=class extends ul{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const i=new cD({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){this.#e.add(t);const e=$d(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=$d(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=$d(t);if(typeof e=="string"){const i=this.#t.get(e)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const e=$d(t);return typeof e=="string"?this.#t.get(e)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){sn.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Db(e,n))}findAll(t={}){return this.getAll().filter(e=>Db(t,e))}notify(t){sn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return sn.batch(()=>Promise.all(t.map(e=>e.continue().catch(rn))))}};function $d(t){return t.options.scope?.id}var dD=class extends ul{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),ph(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&Na(n.mutationKey)!==Na(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??gS();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){sn.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,i,a),this.#i.onSettled?.(e.data,null,n,i,a)):e?.type==="error"&&(this.#i.onError?.(e.error,n,i,a),this.#i.onSettled?.(void 0,e.error,n,i,a))}this.listeners.forEach(n=>{n(this.#t)})})}},hD=class extends ul{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const i=e.queryKey,a=e.queryHash??Ng(i,e);let l=this.get(a);return l||(l=new iD({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){sn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Rb(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>Rb(t,n)):e}notify(t){sn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){sn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){sn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},fD=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new hD,this.#t=t.mutationCache||new uD,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=Lg.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=gh.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Vs(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(i.queryHash)?.state.data,u=UR(e,l);if(u!==void 0)return this.#e.build(this,i).setData(u,{...n,manual:!0})}setQueriesData(t,e,n){return sn.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;sn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return sn.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=sn.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then(rn).catch(rn)}invalidateQueries(t,e={}){return sn.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=sn.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(rn)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(rn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Vs(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(rn).catch(rn)}fetchInfiniteQuery(t){return t.behavior=Pb(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(rn).catch(rn)}ensureInfiniteQueryData(t){return t.behavior=Pb(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return gh.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Na(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(i=>{qc(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Na(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(i=>{qc(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Ng(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Pg&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},yS=T.createContext(void 0),ln=t=>{const e=T.useContext(yS);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},mD=({client:t,children:e})=>(T.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),d.jsx(yS.Provider,{value:t,children:e})),_S=T.createContext(!1),pD=()=>T.useContext(_S),gD=_S.Provider;function yD(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var _D=T.createContext(yD()),vD=()=>T.useContext(_D),bD=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},xD=t=>{T.useEffect(()=>{t.clearReset()},[t])},ED=({result:t,errorResetBoundary:e,throwOnError:n,query:i,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||uS(n,[t.error,i])),SD=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},wD=(t,e)=>t.isLoading&&t.isFetching&&!e,TD=(t,e)=>t?.suspense&&e.isPending,Vb=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function AD(t,e,n){const i=pD(),a=vD(),l=ln(),u=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(u),u._optimisticResults=i?"isRestoring":"optimistic",SD(u),bD(u,a),xD(a);const f=!l.getQueryCache().get(u.queryHash),[p]=T.useState(()=>new e(l,u)),g=p.getOptimisticResult(u),_=!i&&t.subscribed!==!1;if(T.useSyncExternalStore(T.useCallback(v=>{const x=_?p.subscribe(sn.batchCalls(v)):rn;return p.updateResult(),x},[p,_]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),T.useEffect(()=>{p.setOptions(u)},[u,p]),TD(u,g))throw Vb(u,p,a);if(ED({result:g,errorResetBoundary:a,throwOnError:u.throwOnError,query:l.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw g.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(u,g),u.experimental_prefetchInRender&&!Ma&&wD(g,i)&&(f?Vb(u,p,a):l.getQueryCache().get(u.queryHash)?.promise)?.catch(rn).finally(()=>{p.updateResult()}),u.notifyOnChangeProps?g:p.trackResult(g)}function dl(t,e){return AD(t,sD)}function sr(t,e){const n=ln(),[i]=T.useState(()=>new dD(n,t));T.useEffect(()=>{i.setOptions(t)},[i,t]);const a=T.useSyncExternalStore(T.useCallback(u=>i.subscribe(sn.batchCalls(u)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=T.useCallback((u,f)=>{i.mutate(u,f).catch(rn)},[i]);if(a.error&&uS(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}function Yp(){}function CD(t,{interval:e=1e3,onError:n=Yp}={}){if(typeof t!="function")throw new Error("argument is not function.");let i=0,a=null,l=!1,u=!1;return async(...f)=>{if(a=f,!u){for(u=!0;l;)await new Promise(p=>Pi.setTimeout(p,e));for(;Date.now()<i;)await new Promise(p=>Pi.setTimeout(p,i-Date.now()));u=!1,l=!0;try{await t(...a)}catch(p){try{n(p)}catch{}}i=Date.now()+e,l=!1}}}var RD=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:i=JSON.stringify,deserialize:a=JSON.parse,retry:l})=>{if(t){const u=async f=>{try{const p=await i(f);await t.setItem(e,p);return}catch(p){return p}};return{persistClient:CD(async f=>{let p=f,g=await u(p),_=0;for(;g&&p;)_++,p=await l?.({persistedClient:p,error:g,errorCount:_}),p&&(g=await u(p))},{interval:n}),restoreClient:async()=>{const f=await t.getItem(e);if(f)return await a(f)},removeClient:()=>t.removeItem(e)}}return{persistClient:Yp,restoreClient:()=>Promise.resolve(void 0),removeClient:Yp}};const vS=300*1e3,DD=1440*60*1e3,Dt=new fD({defaultOptions:{queries:{staleTime:vS,gcTime:DD,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}});Dt.getQueryCache().subscribe(t=>{const e=t?.query;if(e&&t.type==="updated"){const{state:n}=e;n.status==="error"&&n.error&&console.error("[RQ] Query FAILED:",e.queryKey,n.error)}});const ID=RD({storage:typeof window<"u"?{getItem:t=>Promise.resolve(localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(localStorage.removeItem(t))}:void 0,key:"BUDGET_APP_QUERY_CACHE"}),xe={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};var jD=["added","removed","updated"];function zb(t){return jD.includes(t)}async function OD({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:i="",hydrateOptions:a}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const u=Date.now()-l.timestamp>n,f=l.buster!==i;if(u||f)return e.removeClient();ZR(t,l.clientState,a)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function Ub({queryClient:t,persister:e,buster:n="",dehydrateOptions:i}){const a={buster:n,timestamp:Date.now(),clientState:JR(t,i)};await e.persistClient(a)}function kD(t){const e=t.queryClient.getQueryCache().subscribe(i=>{zb(i.type)&&Ub(t)}),n=t.queryClient.getMutationCache().subscribe(i=>{zb(i.type)&&Ub(t)});return()=>{e(),n()}}var MD=({children:t,persistOptions:e,onSuccess:n,onError:i,...a})=>{const[l,u]=T.useState(!0),f=T.useRef({persistOptions:e,onSuccess:n,onError:i}),p=T.useRef(!1);return T.useEffect(()=>{f.current={persistOptions:e,onSuccess:n,onError:i}}),T.useEffect(()=>{const g={...f.current.persistOptions,queryClient:a.client};return p.current||(p.current=!0,OD(g).then(()=>f.current.onSuccess?.()).catch(()=>f.current.onError?.()).finally(()=>{u(!1)})),l?void 0:kD(g)},[a.client,l]),d.jsx(mD,{...a,children:d.jsx(gD,{value:l,children:t})})};function ND({children:t}){return d.jsx(MD,{client:Dt,persistOptions:{persister:ID,maxAge:1440*60*1e3,buster:"v1"},children:t})}const PD=()=>{};var Bb={};const bS=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},LD=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],u=t[n++],f=t[n++],p=((a&7)<<18|(l&63)<<12|(u&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(p>>10)),e[i++]=String.fromCharCode(56320+(p&1023))}else{const l=t[n++],u=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},xS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],u=a+1<t.length,f=u?t[a+1]:0,p=a+2<t.length,g=p?t[a+2]:0,_=l>>2,v=(l&3)<<4|f>>4;let x=(f&15)<<2|g>>6,w=g&63;p||(w=64,u||(x=64)),i.push(n[_],n[v],n[x],n[w])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(bS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):LD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],f=a<t.length?n[t.charAt(a)]:0;++a;const g=a<t.length?n[t.charAt(a)]:64;++a;const v=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||f==null||g==null||v==null)throw new VD;const x=l<<2|f>>4;if(i.push(x),g!==64){const w=f<<4&240|g>>2;if(i.push(w),v!==64){const A=g<<6&192|v;i.push(A)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class VD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zD=function(t){const e=bS(t);return xS.encodeByteArray(e,!0)},yh=function(t){return zD(t).replace(/\./g,"")},ES=function(t){try{return xS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function UD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const BD=()=>UD().__FIREBASE_DEFAULTS__,FD=()=>{if(typeof process>"u"||typeof Bb>"u")return;const t=Bb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},qD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ES(t[1]);return e&&JSON.parse(e)},qh=()=>{try{return PD()||BD()||FD()||qD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},SS=t=>qh()?.emulatorHosts?.[t],HD=t=>{const e=SS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},wS=()=>qh()?.config,TS=t=>qh()?.[`_${t}`];class GD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function hl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function AS(t){return(await fetch(t,{credentials:"include"})).ok}function QD(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[yh(JSON.stringify(n)),yh(JSON.stringify(u)),""].join(".")}const Pc={};function $D(){const t={prod:[],emulator:[]};for(const e of Object.keys(Pc))Pc[e]?t.emulator.push(e):t.prod.push(e);return t}function KD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Fb=!1;function CS(t,e){if(typeof window>"u"||typeof document>"u"||!hl(window.location.host)||Pc[t]===e||Pc[t]||Fb)return;Pc[t]=e;function n(x){return`__firebase__banner__${x}`}const i="__firebase__banner",l=$D().prod.length>0;function u(){const x=document.getElementById(i);x&&x.remove()}function f(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function p(x,w){x.setAttribute("width","24"),x.setAttribute("id",w),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function g(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{Fb=!0,u()},x}function _(x,w){x.setAttribute("id",w),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function v(){const x=KD(i),w=n("text"),A=document.getElementById(w)||document.createElement("span"),I=n("learnmore"),N=document.getElementById(I)||document.createElement("a"),H=n("preprendIcon"),$=document.getElementById(H)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const q=x.element;f(q),_(N,I);const me=g();p($,H),q.append($,A,N,me),document.body.appendChild(q)}l?(A.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function Dn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function WD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Dn())}function YD(){const t=qh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function XD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function JD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function ZD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eI(){const t=Dn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function tI(){return!YD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nI(){try{return typeof indexedDB=="object"}catch{return!1}}function rI(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const iI="FirebaseError";class Wi extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=iI,Object.setPrototypeOf(this,Wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,iu.prototype.create)}}class iu{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?sI(l,i):"Error",f=`${this.serviceName}: ${u} (${a}).`;return new Wi(a,f,i)}}function sI(t,e){return t.replace(aI,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const aI=/\{\$([^}]+)}/g;function oI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function $s(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],u=e[a];if(qb(l)&&qb(u)){if(!$s(l,u))return!1}else if(l!==u)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function qb(t){return t!==null&&typeof t=="object"}function su(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Ic(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function jc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function lI(t,e){const n=new cI(t,e);return n.subscribe.bind(n)}class cI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");uI(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=Sp),a.error===void 0&&(a.error=Sp),a.complete===void 0&&(a.complete=Sp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Sp(){}function mn(t){return t&&t._delegate?t._delegate:t}class Pa{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ja="[DEFAULT]";class dI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new GD;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fI(e))try{this.getOrInitializeService({instanceIdentifier:ja})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=ja){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ja){return this.instances.has(e)}getOptions(e=ja){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);i===f&&u.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:hI(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ja){return this.component?this.component.multipleInstances?e:ja:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function hI(t){return t===ja?void 0:t}function fI(t){return t.instantiationMode==="EAGER"}class mI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new dI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Je||(Je={}));const pI={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},gI=Je.INFO,yI={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},_I=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=yI[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class zg{constructor(e){this.name=e,this._logLevel=gI,this._logHandler=_I,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}const vI=(t,e)=>e.some(n=>t instanceof n);let Hb,Gb;function bI(){return Hb||(Hb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xI(){return Gb||(Gb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const RS=new WeakMap,Xp=new WeakMap,DS=new WeakMap,wp=new WeakMap,Ug=new WeakMap;function EI(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",u)},l=()=>{n(zs(t.result)),a()},u=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",u)});return e.then(n=>{n instanceof IDBCursor&&RS.set(n,t)}).catch(()=>{}),Ug.set(e,t),e}function SI(t){if(Xp.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",u),t.removeEventListener("abort",u)},l=()=>{n(),a()},u=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",u),t.addEventListener("abort",u)});Xp.set(t,e)}let Jp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Xp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||DS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return zs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function wI(t){Jp=t(Jp)}function TI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(Tp(this),e,...n);return DS.set(i,e.sort?e.sort():[e]),zs(i)}:xI().includes(t)?function(...e){return t.apply(Tp(this),e),zs(RS.get(this))}:function(...e){return zs(t.apply(Tp(this),e))}}function AI(t){return typeof t=="function"?TI(t):(t instanceof IDBTransaction&&SI(t),vI(t,bI())?new Proxy(t,Jp):t)}function zs(t){if(t instanceof IDBRequest)return EI(t);if(wp.has(t))return wp.get(t);const e=AI(t);return e!==t&&(wp.set(t,e),Ug.set(e,t)),e}const Tp=t=>Ug.get(t);function CI(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const u=indexedDB.open(t,e),f=zs(u);return i&&u.addEventListener("upgradeneeded",p=>{i(zs(u.result),p.oldVersion,p.newVersion,zs(u.transaction),p)}),n&&u.addEventListener("blocked",p=>n(p.oldVersion,p.newVersion,p)),f.then(p=>{l&&p.addEventListener("close",()=>l()),a&&p.addEventListener("versionchange",g=>a(g.oldVersion,g.newVersion,g))}).catch(()=>{}),f}const RI=["get","getKey","getAll","getAllKeys","count"],DI=["put","add","delete","clear"],Ap=new Map;function Qb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Ap.get(e))return Ap.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=DI.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||RI.includes(n)))return;const l=async function(u,...f){const p=this.transaction(u,a?"readwrite":"readonly");let g=p.store;return i&&(g=g.index(f.shift())),(await Promise.all([g[n](...f),a&&p.done]))[0]};return Ap.set(e,l),l}wI(t=>({...t,get:(e,n,i)=>Qb(e,n)||t.get(e,n,i),has:(e,n)=>!!Qb(e,n)||t.has(e,n)}));class II{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(jI(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function jI(t){return t.getComponent()?.type==="VERSION"}const Zp="@firebase/app",$b="0.14.6";const Gi=new zg("@firebase/app"),OI="@firebase/app-compat",kI="@firebase/analytics-compat",MI="@firebase/analytics",NI="@firebase/app-check-compat",PI="@firebase/app-check",LI="@firebase/auth",VI="@firebase/auth-compat",zI="@firebase/database",UI="@firebase/data-connect",BI="@firebase/database-compat",FI="@firebase/functions",qI="@firebase/functions-compat",HI="@firebase/installations",GI="@firebase/installations-compat",QI="@firebase/messaging",$I="@firebase/messaging-compat",KI="@firebase/performance",WI="@firebase/performance-compat",YI="@firebase/remote-config",XI="@firebase/remote-config-compat",JI="@firebase/storage",ZI="@firebase/storage-compat",ej="@firebase/firestore",tj="@firebase/ai",nj="@firebase/firestore-compat",rj="firebase",ij="12.6.0";const eg="[DEFAULT]",sj={[Zp]:"fire-core",[OI]:"fire-core-compat",[MI]:"fire-analytics",[kI]:"fire-analytics-compat",[PI]:"fire-app-check",[NI]:"fire-app-check-compat",[LI]:"fire-auth",[VI]:"fire-auth-compat",[zI]:"fire-rtdb",[UI]:"fire-data-connect",[BI]:"fire-rtdb-compat",[FI]:"fire-fn",[qI]:"fire-fn-compat",[HI]:"fire-iid",[GI]:"fire-iid-compat",[QI]:"fire-fcm",[$I]:"fire-fcm-compat",[KI]:"fire-perf",[WI]:"fire-perf-compat",[YI]:"fire-rc",[XI]:"fire-rc-compat",[JI]:"fire-gcs",[ZI]:"fire-gcs-compat",[ej]:"fire-fst",[nj]:"fire-fst-compat",[tj]:"fire-vertex","fire-js":"fire-js",[rj]:"fire-js-all"};const _h=new Map,aj=new Map,tg=new Map;function Kb(t,e){try{t.container.addComponent(e)}catch(n){Gi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Wo(t){const e=t.name;if(tg.has(e))return Gi.debug(`There were multiple attempts to register component ${e}.`),!1;tg.set(e,t);for(const n of _h.values())Kb(n,t);for(const n of aj.values())Kb(n,t);return!0}function Bg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Mr(t){return t==null?!1:t.settings!==void 0}const oj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Us=new iu("app","Firebase",oj);class lj{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Pa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Us.create("app-deleted",{appName:this._name})}}const fl=ij;function IS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:eg,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Us.create("bad-app-name",{appName:String(a)});if(n||(n=wS()),!n)throw Us.create("no-options");const l=_h.get(a);if(l){if($s(n,l.options)&&$s(i,l.config))return l;throw Us.create("duplicate-app",{appName:a})}const u=new mI(a);for(const p of tg.values())u.addComponent(p);const f=new lj(n,i,u);return _h.set(a,f),f}function jS(t=eg){const e=_h.get(t);if(!e&&t===eg&&wS())return IS();if(!e)throw Us.create("no-app",{appName:t});return e}function Bs(t,e,n){let i=sj[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${i}" with version "${e}":`];a&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gi.warn(u.join(" "));return}Wo(new Pa(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const cj="firebase-heartbeat-database",uj=1,Hc="firebase-heartbeat-store";let Cp=null;function OS(){return Cp||(Cp=CI(cj,uj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Hc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Us.create("idb-open",{originalErrorMessage:t.message})})),Cp}async function dj(t){try{const n=(await OS()).transaction(Hc),i=await n.objectStore(Hc).get(kS(t));return await n.done,i}catch(e){if(e instanceof Wi)Gi.warn(e.message);else{const n=Us.create("idb-get",{originalErrorMessage:e?.message});Gi.warn(n.message)}}}async function Wb(t,e){try{const i=(await OS()).transaction(Hc,"readwrite");await i.objectStore(Hc).put(e,kS(t)),await i.done}catch(n){if(n instanceof Wi)Gi.warn(n.message);else{const i=Us.create("idb-set",{originalErrorMessage:n?.message});Gi.warn(i.message)}}}function kS(t){return`${t.name}!${t.options.appId}`}const hj=1024,fj=30;class mj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new gj(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Yb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>fj){const a=yj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Gi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Yb(),{heartbeatsToSend:n,unsentEntries:i}=pj(this._heartbeatsCache.heartbeats),a=yh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Gi.warn(e),""}}}function Yb(){return new Date().toISOString().substring(0,10)}function pj(t,e=hj){const n=[];let i=t.slice();for(const a of t){const l=n.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),Xb(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Xb(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class gj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nI()?rI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await dj(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Wb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Wb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Xb(t){return yh(JSON.stringify({version:2,heartbeats:t})).length}function yj(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function _j(t){Wo(new Pa("platform-logger",e=>new II(e),"PRIVATE")),Wo(new Pa("heartbeat",e=>new mj(e),"PRIVATE")),Bs(Zp,$b,t),Bs(Zp,$b,"esm2020"),Bs("fire-js","")}_j("");var vj="firebase",bj="12.7.0";Bs(vj,bj,"app");const xj={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},MS=IS(xj);var Jb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Fs,NS;(function(){var t;function e(L,D){function R(){}R.prototype=D.prototype,L.F=D.prototype,L.prototype=new R,L.prototype.constructor=L,L.D=function(M,j,O){for(var C=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)C[Y-2]=arguments[Y];return D.prototype[j].apply(M,C)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(L,D,R){R||(R=0);const M=Array(16);if(typeof D=="string")for(var j=0;j<16;++j)M[j]=D.charCodeAt(R++)|D.charCodeAt(R++)<<8|D.charCodeAt(R++)<<16|D.charCodeAt(R++)<<24;else for(j=0;j<16;++j)M[j]=D[R++]|D[R++]<<8|D[R++]<<16|D[R++]<<24;D=L.g[0],R=L.g[1],j=L.g[2];let O=L.g[3],C;C=D+(O^R&(j^O))+M[0]+3614090360&4294967295,D=R+(C<<7&4294967295|C>>>25),C=O+(j^D&(R^j))+M[1]+3905402710&4294967295,O=D+(C<<12&4294967295|C>>>20),C=j+(R^O&(D^R))+M[2]+606105819&4294967295,j=O+(C<<17&4294967295|C>>>15),C=R+(D^j&(O^D))+M[3]+3250441966&4294967295,R=j+(C<<22&4294967295|C>>>10),C=D+(O^R&(j^O))+M[4]+4118548399&4294967295,D=R+(C<<7&4294967295|C>>>25),C=O+(j^D&(R^j))+M[5]+1200080426&4294967295,O=D+(C<<12&4294967295|C>>>20),C=j+(R^O&(D^R))+M[6]+2821735955&4294967295,j=O+(C<<17&4294967295|C>>>15),C=R+(D^j&(O^D))+M[7]+4249261313&4294967295,R=j+(C<<22&4294967295|C>>>10),C=D+(O^R&(j^O))+M[8]+1770035416&4294967295,D=R+(C<<7&4294967295|C>>>25),C=O+(j^D&(R^j))+M[9]+2336552879&4294967295,O=D+(C<<12&4294967295|C>>>20),C=j+(R^O&(D^R))+M[10]+4294925233&4294967295,j=O+(C<<17&4294967295|C>>>15),C=R+(D^j&(O^D))+M[11]+2304563134&4294967295,R=j+(C<<22&4294967295|C>>>10),C=D+(O^R&(j^O))+M[12]+1804603682&4294967295,D=R+(C<<7&4294967295|C>>>25),C=O+(j^D&(R^j))+M[13]+4254626195&4294967295,O=D+(C<<12&4294967295|C>>>20),C=j+(R^O&(D^R))+M[14]+2792965006&4294967295,j=O+(C<<17&4294967295|C>>>15),C=R+(D^j&(O^D))+M[15]+1236535329&4294967295,R=j+(C<<22&4294967295|C>>>10),C=D+(j^O&(R^j))+M[1]+4129170786&4294967295,D=R+(C<<5&4294967295|C>>>27),C=O+(R^j&(D^R))+M[6]+3225465664&4294967295,O=D+(C<<9&4294967295|C>>>23),C=j+(D^R&(O^D))+M[11]+643717713&4294967295,j=O+(C<<14&4294967295|C>>>18),C=R+(O^D&(j^O))+M[0]+3921069994&4294967295,R=j+(C<<20&4294967295|C>>>12),C=D+(j^O&(R^j))+M[5]+3593408605&4294967295,D=R+(C<<5&4294967295|C>>>27),C=O+(R^j&(D^R))+M[10]+38016083&4294967295,O=D+(C<<9&4294967295|C>>>23),C=j+(D^R&(O^D))+M[15]+3634488961&4294967295,j=O+(C<<14&4294967295|C>>>18),C=R+(O^D&(j^O))+M[4]+3889429448&4294967295,R=j+(C<<20&4294967295|C>>>12),C=D+(j^O&(R^j))+M[9]+568446438&4294967295,D=R+(C<<5&4294967295|C>>>27),C=O+(R^j&(D^R))+M[14]+3275163606&4294967295,O=D+(C<<9&4294967295|C>>>23),C=j+(D^R&(O^D))+M[3]+4107603335&4294967295,j=O+(C<<14&4294967295|C>>>18),C=R+(O^D&(j^O))+M[8]+1163531501&4294967295,R=j+(C<<20&4294967295|C>>>12),C=D+(j^O&(R^j))+M[13]+2850285829&4294967295,D=R+(C<<5&4294967295|C>>>27),C=O+(R^j&(D^R))+M[2]+4243563512&4294967295,O=D+(C<<9&4294967295|C>>>23),C=j+(D^R&(O^D))+M[7]+1735328473&4294967295,j=O+(C<<14&4294967295|C>>>18),C=R+(O^D&(j^O))+M[12]+2368359562&4294967295,R=j+(C<<20&4294967295|C>>>12),C=D+(R^j^O)+M[5]+4294588738&4294967295,D=R+(C<<4&4294967295|C>>>28),C=O+(D^R^j)+M[8]+2272392833&4294967295,O=D+(C<<11&4294967295|C>>>21),C=j+(O^D^R)+M[11]+1839030562&4294967295,j=O+(C<<16&4294967295|C>>>16),C=R+(j^O^D)+M[14]+4259657740&4294967295,R=j+(C<<23&4294967295|C>>>9),C=D+(R^j^O)+M[1]+2763975236&4294967295,D=R+(C<<4&4294967295|C>>>28),C=O+(D^R^j)+M[4]+1272893353&4294967295,O=D+(C<<11&4294967295|C>>>21),C=j+(O^D^R)+M[7]+4139469664&4294967295,j=O+(C<<16&4294967295|C>>>16),C=R+(j^O^D)+M[10]+3200236656&4294967295,R=j+(C<<23&4294967295|C>>>9),C=D+(R^j^O)+M[13]+681279174&4294967295,D=R+(C<<4&4294967295|C>>>28),C=O+(D^R^j)+M[0]+3936430074&4294967295,O=D+(C<<11&4294967295|C>>>21),C=j+(O^D^R)+M[3]+3572445317&4294967295,j=O+(C<<16&4294967295|C>>>16),C=R+(j^O^D)+M[6]+76029189&4294967295,R=j+(C<<23&4294967295|C>>>9),C=D+(R^j^O)+M[9]+3654602809&4294967295,D=R+(C<<4&4294967295|C>>>28),C=O+(D^R^j)+M[12]+3873151461&4294967295,O=D+(C<<11&4294967295|C>>>21),C=j+(O^D^R)+M[15]+530742520&4294967295,j=O+(C<<16&4294967295|C>>>16),C=R+(j^O^D)+M[2]+3299628645&4294967295,R=j+(C<<23&4294967295|C>>>9),C=D+(j^(R|~O))+M[0]+4096336452&4294967295,D=R+(C<<6&4294967295|C>>>26),C=O+(R^(D|~j))+M[7]+1126891415&4294967295,O=D+(C<<10&4294967295|C>>>22),C=j+(D^(O|~R))+M[14]+2878612391&4294967295,j=O+(C<<15&4294967295|C>>>17),C=R+(O^(j|~D))+M[5]+4237533241&4294967295,R=j+(C<<21&4294967295|C>>>11),C=D+(j^(R|~O))+M[12]+1700485571&4294967295,D=R+(C<<6&4294967295|C>>>26),C=O+(R^(D|~j))+M[3]+2399980690&4294967295,O=D+(C<<10&4294967295|C>>>22),C=j+(D^(O|~R))+M[10]+4293915773&4294967295,j=O+(C<<15&4294967295|C>>>17),C=R+(O^(j|~D))+M[1]+2240044497&4294967295,R=j+(C<<21&4294967295|C>>>11),C=D+(j^(R|~O))+M[8]+1873313359&4294967295,D=R+(C<<6&4294967295|C>>>26),C=O+(R^(D|~j))+M[15]+4264355552&4294967295,O=D+(C<<10&4294967295|C>>>22),C=j+(D^(O|~R))+M[6]+2734768916&4294967295,j=O+(C<<15&4294967295|C>>>17),C=R+(O^(j|~D))+M[13]+1309151649&4294967295,R=j+(C<<21&4294967295|C>>>11),C=D+(j^(R|~O))+M[4]+4149444226&4294967295,D=R+(C<<6&4294967295|C>>>26),C=O+(R^(D|~j))+M[11]+3174756917&4294967295,O=D+(C<<10&4294967295|C>>>22),C=j+(D^(O|~R))+M[2]+718787259&4294967295,j=O+(C<<15&4294967295|C>>>17),C=R+(O^(j|~D))+M[9]+3951481745&4294967295,L.g[0]=L.g[0]+D&4294967295,L.g[1]=L.g[1]+(j+(C<<21&4294967295|C>>>11))&4294967295,L.g[2]=L.g[2]+j&4294967295,L.g[3]=L.g[3]+O&4294967295}i.prototype.v=function(L,D){D===void 0&&(D=L.length);const R=D-this.blockSize,M=this.C;let j=this.h,O=0;for(;O<D;){if(j==0)for(;O<=R;)a(this,L,O),O+=this.blockSize;if(typeof L=="string"){for(;O<D;)if(M[j++]=L.charCodeAt(O++),j==this.blockSize){a(this,M),j=0;break}}else for(;O<D;)if(M[j++]=L[O++],j==this.blockSize){a(this,M),j=0;break}}this.h=j,this.o+=D},i.prototype.A=function(){var L=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);L[0]=128;for(var D=1;D<L.length-8;++D)L[D]=0;D=this.o*8;for(var R=L.length-8;R<L.length;++R)L[R]=D&255,D/=256;for(this.v(L),L=Array(16),D=0,R=0;R<4;++R)for(let M=0;M<32;M+=8)L[D++]=this.g[R]>>>M&255;return L};function l(L,D){var R=f;return Object.prototype.hasOwnProperty.call(R,L)?R[L]:R[L]=D(L)}function u(L,D){this.h=D;const R=[];let M=!0;for(let j=L.length-1;j>=0;j--){const O=L[j]|0;M&&O==D||(R[j]=O,M=!1)}this.g=R}var f={};function p(L){return-128<=L&&L<128?l(L,function(D){return new u([D|0],D<0?-1:0)}):new u([L|0],L<0?-1:0)}function g(L){if(isNaN(L)||!isFinite(L))return v;if(L<0)return N(g(-L));const D=[];let R=1;for(let M=0;L>=R;M++)D[M]=L/R|0,R*=4294967296;return new u(D,0)}function _(L,D){if(L.length==0)throw Error("number format error: empty string");if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(L.charAt(0)=="-")return N(_(L.substring(1),D));if(L.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=g(Math.pow(D,8));let M=v;for(let O=0;O<L.length;O+=8){var j=Math.min(8,L.length-O);const C=parseInt(L.substring(O,O+j),D);j<8?(j=g(Math.pow(D,j)),M=M.j(j).add(g(C))):(M=M.j(R),M=M.add(g(C)))}return M}var v=p(0),x=p(1),w=p(16777216);t=u.prototype,t.m=function(){if(I(this))return-N(this).m();let L=0,D=1;for(let R=0;R<this.g.length;R++){const M=this.i(R);L+=(M>=0?M:4294967296+M)*D,D*=4294967296}return L},t.toString=function(L){if(L=L||10,L<2||36<L)throw Error("radix out of range: "+L);if(A(this))return"0";if(I(this))return"-"+N(this).toString(L);const D=g(Math.pow(L,6));var R=this;let M="";for(;;){const j=me(R,D).g;R=H(R,j.j(D));let O=((R.g.length>0?R.g[0]:R.h)>>>0).toString(L);if(R=j,A(R))return O+M;for(;O.length<6;)O="0"+O;M=O+M}},t.i=function(L){return L<0?0:L<this.g.length?this.g[L]:this.h};function A(L){if(L.h!=0)return!1;for(let D=0;D<L.g.length;D++)if(L.g[D]!=0)return!1;return!0}function I(L){return L.h==-1}t.l=function(L){return L=H(this,L),I(L)?-1:A(L)?0:1};function N(L){const D=L.g.length,R=[];for(let M=0;M<D;M++)R[M]=~L.g[M];return new u(R,~L.h).add(x)}t.abs=function(){return I(this)?N(this):this},t.add=function(L){const D=Math.max(this.g.length,L.g.length),R=[];let M=0;for(let j=0;j<=D;j++){let O=M+(this.i(j)&65535)+(L.i(j)&65535),C=(O>>>16)+(this.i(j)>>>16)+(L.i(j)>>>16);M=C>>>16,O&=65535,C&=65535,R[j]=C<<16|O}return new u(R,R[R.length-1]&-2147483648?-1:0)};function H(L,D){return L.add(N(D))}t.j=function(L){if(A(this)||A(L))return v;if(I(this))return I(L)?N(this).j(N(L)):N(N(this).j(L));if(I(L))return N(this.j(N(L)));if(this.l(w)<0&&L.l(w)<0)return g(this.m()*L.m());const D=this.g.length+L.g.length,R=[];for(var M=0;M<2*D;M++)R[M]=0;for(M=0;M<this.g.length;M++)for(let j=0;j<L.g.length;j++){const O=this.i(M)>>>16,C=this.i(M)&65535,Y=L.i(j)>>>16,U=L.i(j)&65535;R[2*M+2*j]+=C*U,$(R,2*M+2*j),R[2*M+2*j+1]+=O*U,$(R,2*M+2*j+1),R[2*M+2*j+1]+=C*Y,$(R,2*M+2*j+1),R[2*M+2*j+2]+=O*Y,$(R,2*M+2*j+2)}for(L=0;L<D;L++)R[L]=R[2*L+1]<<16|R[2*L];for(L=D;L<2*D;L++)R[L]=0;return new u(R,0)};function $(L,D){for(;(L[D]&65535)!=L[D];)L[D+1]+=L[D]>>>16,L[D]&=65535,D++}function q(L,D){this.g=L,this.h=D}function me(L,D){if(A(D))throw Error("division by zero");if(A(L))return new q(v,v);if(I(L))return D=me(N(L),D),new q(N(D.g),N(D.h));if(I(D))return D=me(L,N(D)),new q(N(D.g),D.h);if(L.g.length>30){if(I(L)||I(D))throw Error("slowDivide_ only works with positive integers.");for(var R=x,M=D;M.l(L)<=0;)R=re(R),M=re(M);var j=he(R,1),O=he(M,1);for(M=he(M,2),R=he(R,2);!A(M);){var C=O.add(M);C.l(L)<=0&&(j=j.add(R),O=C),M=he(M,1),R=he(R,1)}return D=H(L,j.j(D)),new q(j,D)}for(j=v;L.l(D)>=0;){for(R=Math.max(1,Math.floor(L.m()/D.m())),M=Math.ceil(Math.log(R)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),O=g(R),C=O.j(D);I(C)||C.l(L)>0;)R-=M,O=g(R),C=O.j(D);A(O)&&(O=x),j=j.add(O),L=H(L,C)}return new q(j,L)}t.B=function(L){return me(this,L).h},t.and=function(L){const D=Math.max(this.g.length,L.g.length),R=[];for(let M=0;M<D;M++)R[M]=this.i(M)&L.i(M);return new u(R,this.h&L.h)},t.or=function(L){const D=Math.max(this.g.length,L.g.length),R=[];for(let M=0;M<D;M++)R[M]=this.i(M)|L.i(M);return new u(R,this.h|L.h)},t.xor=function(L){const D=Math.max(this.g.length,L.g.length),R=[];for(let M=0;M<D;M++)R[M]=this.i(M)^L.i(M);return new u(R,this.h^L.h)};function re(L){const D=L.g.length+1,R=[];for(let M=0;M<D;M++)R[M]=L.i(M)<<1|L.i(M-1)>>>31;return new u(R,L.h)}function he(L,D){const R=D>>5;D%=32;const M=L.g.length-R,j=[];for(let O=0;O<M;O++)j[O]=D>0?L.i(O+R)>>>D|L.i(O+R+1)<<32-D:L.i(O+R);return new u(j,L.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,NS=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=g,u.fromString=_,Fs=u}).apply(typeof Jb<"u"?Jb:typeof self<"u"?self:typeof window<"u"?window:{});var Kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var PS,Oc,LS,nh,ng,VS,zS,US;(function(){var t,e=Object.defineProperty;function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Kd=="object"&&Kd];for(var b=0;b<h.length;++b){var S=h[b];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=n(this);function a(h,b){if(b)e:{var S=i;h=h.split(".");for(var V=0;V<h.length-1;V++){var Z=h[V];if(!(Z in S))break e;S=S[Z]}h=h[h.length-1],V=S[h],b=b(V),b!=V&&b!=null&&e(S,h,{configurable:!0,writable:!0,value:b})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(b){var S=[],V;for(V in b)Object.prototype.hasOwnProperty.call(b,V)&&S.push([V,b[V]]);return S}});var l=l||{},u=this||self;function f(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function p(h,b,S){return h.call.apply(h.bind,arguments)}function g(h,b,S){return g=p,g.apply(null,arguments)}function _(h,b){var S=Array.prototype.slice.call(arguments,1);return function(){var V=S.slice();return V.push.apply(V,arguments),h.apply(this,V)}}function v(h,b){function S(){}S.prototype=b.prototype,h.Z=b.prototype,h.prototype=new S,h.prototype.constructor=h,h.Ob=function(V,Z,ae){for(var Ee=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)Ee[qe-2]=arguments[qe];return b.prototype[Z].apply(V,Ee)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function w(h){const b=h.length;if(b>0){const S=Array(b);for(let V=0;V<b;V++)S[V]=h[V];return S}return[]}function A(h,b){for(let V=1;V<arguments.length;V++){const Z=arguments[V];var S=typeof Z;if(S=S!="object"?S:Z?Array.isArray(Z)?"array":S:"null",S=="array"||S=="object"&&typeof Z.length=="number"){S=h.length||0;const ae=Z.length||0;h.length=S+ae;for(let Ee=0;Ee<ae;Ee++)h[S+Ee]=Z[Ee]}else h.push(Z)}}class I{constructor(b,S){this.i=b,this.j=S,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function N(h){u.setTimeout(()=>{throw h},0)}function H(){var h=L;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class ${constructor(){this.h=this.g=null}add(b,S){const V=q.get();V.set(b,S),this.h?this.h.next=V:this.g=V,this.h=V}}var q=new I(()=>new me,h=>h.reset());class me{constructor(){this.next=this.g=this.h=null}set(b,S){this.h=b,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let re,he=!1,L=new $,D=()=>{const h=Promise.resolve(void 0);re=()=>{h.then(R)}};function R(){for(var h;h=H();){try{h.h.call(h.g)}catch(S){N(S)}var b=q;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}he=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const S=()=>{};u.addEventListener("test",S,b),u.removeEventListener("test",S,b)}catch{}return h})();function C(h){return/^[\s\xa0]*$/.test(h)}function Y(h,b){j.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}v(Y,j),Y.prototype.init=function(h,b){const S=this.type=h.type,V=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(S=="mouseover"?b=h.fromElement:S=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Y.Z.h.call(this)},Y.prototype.h=function(){Y.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var U="closure_listenable_"+(Math.random()*1e6|0),P=0;function B(h,b,S,V,Z){this.listener=h,this.proxy=null,this.src=b,this.type=S,this.capture=!!V,this.ha=Z,this.key=++P,this.da=this.fa=!1}function Q(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function le(h,b,S){for(const V in h)b.call(S,h[V],V,h)}function J(h,b){for(const S in h)b.call(void 0,h[S],S,h)}function z(h){const b={};for(const S in h)b[S]=h[S];return b}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(h,b){let S,V;for(let Z=1;Z<arguments.length;Z++){V=arguments[Z];for(S in V)h[S]=V[S];for(let ae=0;ae<F.length;ae++)S=F[ae],Object.prototype.hasOwnProperty.call(V,S)&&(h[S]=V[S])}}function te(h){this.src=h,this.g={},this.h=0}te.prototype.add=function(h,b,S,V,Z){const ae=h.toString();h=this.g[ae],h||(h=this.g[ae]=[],this.h++);const Ee=pe(h,b,V,Z);return Ee>-1?(b=h[Ee],S||(b.fa=!1)):(b=new B(b,this.src,ae,!!V,Z),b.fa=S,h.push(b)),b};function se(h,b){const S=b.type;if(S in h.g){var V=h.g[S],Z=Array.prototype.indexOf.call(V,b,void 0),ae;(ae=Z>=0)&&Array.prototype.splice.call(V,Z,1),ae&&(Q(b),h.g[S].length==0&&(delete h.g[S],h.h--))}}function pe(h,b,S,V){for(let Z=0;Z<h.length;++Z){const ae=h[Z];if(!ae.da&&ae.listener==b&&ae.capture==!!S&&ae.ha==V)return Z}return-1}var de="closure_lm_"+(Math.random()*1e6|0),be={};function Se(h,b,S,V,Z){if(Array.isArray(b)){for(let ae=0;ae<b.length;ae++)Se(h,b[ae],S,V,Z);return null}return S=tn(S),h&&h[U]?h.J(b,S,f(V)?!!V.capture:!1,Z):ce(h,b,S,!1,V,Z)}function ce(h,b,S,V,Z,ae){if(!b)throw Error("Invalid event type");const Ee=f(Z)?!!Z.capture:!!Z;let qe=vt(h);if(qe||(h[de]=qe=new te(h)),S=qe.add(b,S,V,Ee,ae),S.proxy)return S;if(V=Te(),S.proxy=V,V.src=h,V.listener=S,h.addEventListener)O||(Z=Ee),Z===void 0&&(Z=!1),h.addEventListener(b.toString(),V,Z);else if(h.attachEvent)h.attachEvent(Me(b.toString()),V);else if(h.addListener&&h.removeListener)h.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Te(){function h(S){return b.call(h.src,h.listener,S)}const b=$e;return h}function De(h,b,S,V,Z){if(Array.isArray(b))for(var ae=0;ae<b.length;ae++)De(h,b[ae],S,V,Z);else V=f(V)?!!V.capture:!!V,S=tn(S),h&&h[U]?(h=h.i,ae=String(b).toString(),ae in h.g&&(b=h.g[ae],S=pe(b,S,V,Z),S>-1&&(Q(b[S]),Array.prototype.splice.call(b,S,1),b.length==0&&(delete h.g[ae],h.h--)))):h&&(h=vt(h))&&(b=h.g[b.toString()],h=-1,b&&(h=pe(b,S,V,Z)),(S=h>-1?b[h]:null)&&Ae(S))}function Ae(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[U])se(b.i,h);else{var S=h.type,V=h.proxy;b.removeEventListener?b.removeEventListener(S,V,h.capture):b.detachEvent?b.detachEvent(Me(S),V):b.addListener&&b.removeListener&&b.removeListener(V),(S=vt(b))?(se(S,h),S.h==0&&(S.src=null,b[de]=null)):Q(h)}}}function Me(h){return h in be?be[h]:be[h]="on"+h}function $e(h,b){if(h.da)h=!0;else{b=new Y(b,this);const S=h.listener,V=h.ha||h.src;h.fa&&Ae(h),h=S.call(V,b)}return h}function vt(h){return h=h[de],h instanceof te?h:null}var Tt="__closure_events_fn_"+(Math.random()*1e9>>>0);function tn(h){return typeof h=="function"?h:(h[Tt]||(h[Tt]=function(b){return h.handleEvent(b)}),h[Tt])}function ct(){M.call(this),this.i=new te(this),this.M=this,this.G=null}v(ct,M),ct.prototype[U]=!0,ct.prototype.removeEventListener=function(h,b,S,V){De(this,h,b,S,V)};function Ne(h,b){var S,V=h.G;if(V)for(S=[];V;V=V.G)S.push(V);if(h=h.M,V=b.type||b,typeof b=="string")b=new j(b,h);else if(b instanceof j)b.target=b.target||h;else{var Z=b;b=new j(V,h),W(b,Z)}Z=!0;let ae,Ee;if(S)for(Ee=S.length-1;Ee>=0;Ee--)ae=b.g=S[Ee],Z=Nt(ae,V,!0,b)&&Z;if(ae=b.g=h,Z=Nt(ae,V,!0,b)&&Z,Z=Nt(ae,V,!1,b)&&Z,S)for(Ee=0;Ee<S.length;Ee++)ae=b.g=S[Ee],Z=Nt(ae,V,!1,b)&&Z}ct.prototype.N=function(){if(ct.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const S=h.g[b];for(let V=0;V<S.length;V++)Q(S[V]);delete h.g[b],h.h--}}this.G=null},ct.prototype.J=function(h,b,S,V){return this.i.add(String(h),b,!1,S,V)},ct.prototype.K=function(h,b,S,V){return this.i.add(String(h),b,!0,S,V)};function Nt(h,b,S,V){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let Z=!0;for(let ae=0;ae<b.length;++ae){const Ee=b[ae];if(Ee&&!Ee.da&&Ee.capture==S){const qe=Ee.listener,Vt=Ee.ha||Ee.src;Ee.fa&&se(h.i,Ee),Z=qe.call(Vt,V)!==!1&&Z}}return Z&&!V.defaultPrevented}function cn(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:u.setTimeout(h,b||0)}function In(h){h.g=cn(()=>{h.g=null,h.i&&(h.i=!1,In(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class Pt extends M{constructor(b,S){super(),this.m=b,this.l=S,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:In(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ot(h){M.call(this),this.h=h,this.g={}}v(Ot,M);var Qn=[];function Al(h){le(h.g,function(b,S){this.g.hasOwnProperty(S)&&Ae(b)},h),h.g={}}Ot.prototype.N=function(){Ot.Z.N.call(this),Al(this)},Ot.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Zi=u.JSON.stringify,yf=u.JSON.parse,_u=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function vu(){}function bu(){}var Er={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function pn(){j.call(this,"d")}v(pn,j);function ar(){j.call(this,"c")}v(ar,j);var Lt={},xu=null;function Qa(){return xu=xu||new ct}Lt.Ia="serverreachability";function Eu(h){j.call(this,Lt.Ia,h)}v(Eu,j);function Ur(h){const b=Qa();Ne(b,new Eu(b))}Lt.STAT_EVENT="statevent";function ra(h,b){j.call(this,Lt.STAT_EVENT,h),this.stat=b}v(ra,j);function qt(h){const b=Qa();Ne(b,new ra(b,h))}Lt.Ja="timingevent";function Br(h,b){j.call(this,Lt.Ja,h),this.size=b}v(Br,j);function Fr(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},b)}function Sr(){this.g=!0}Sr.prototype.ua=function(){this.g=!1};function _f(h,b,S,V,Z,ae){h.info(function(){if(h.g)if(ae){var Ee="",qe=ae.split("&");for(let at=0;at<qe.length;at++){var Vt=qe[at].split("=");if(Vt.length>1){const At=Vt[0];Vt=Vt[1];const ur=At.split("_");Ee=ur.length>=2&&ur[1]=="type"?Ee+(At+"="+Vt+"&"):Ee+(At+"=redacted&")}}}else Ee=null;else Ee=ae;return"XMLHTTP REQ ("+V+") [attempt "+Z+"]: "+b+`
`+S+`
`+Ee})}function Su(h,b,S,V,Z,ae,Ee){h.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+Z+"]: "+b+`
`+S+`
`+ae+" "+Ee})}function qr(h,b,S,V){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+vf(h,S)+(V?" "+V:"")})}function ia(h,b){h.info(function(){return"TIMEOUT: "+b})}Sr.prototype.info=function(){};function vf(h,b){if(!h.g)return b;if(!b)return null;try{const ae=JSON.parse(b);if(ae){for(h=0;h<ae.length;h++)if(Array.isArray(ae[h])){var S=ae[h];if(!(S.length<2)){var V=S[1];if(Array.isArray(V)&&!(V.length<1)){var Z=V[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(let Ee=1;Ee<V.length;Ee++)V[Ee]=""}}}}return Zi(ae)}catch{return b}}var sa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Cl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Rl;function aa(){}v(aa,vu),aa.prototype.g=function(){return new XMLHttpRequest},Rl=new aa;function yi(h){return encodeURIComponent(String(h))}function wu(h){var b=1;h=h.split(":");const S=[];for(;b>0&&h.length;)S.push(h.shift()),b--;return h.length&&S.push(h.join(":")),S}function wr(h,b,S,V){this.j=h,this.i=b,this.l=S,this.S=V||1,this.V=new Ot(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Tr}function Tr(){this.i=null,this.g="",this.h=!1}var Ht={},un={};function Hr(h,b,S){h.M=1,h.A=oa(Qt(b)),h.u=S,h.R=!0,$a(h,null)}function $a(h,b){h.F=Date.now(),Gr(h),h.B=Qt(h.A);var S=h.B,V=h.S;Array.isArray(V)||(V=[String(V)]),Xa(S.i,"t",V),h.C=0,S=h.j.L,h.h=new Tr,h.g=zu(h.j,S?b:null,!h.u),h.P>0&&(h.O=new Pt(g(h.Y,h,h.g),h.P)),b=h.V,S=h.g,V=h.ba;var Z="readystatechange";Array.isArray(Z)||(Z&&(Qn[0]=Z.toString()),Z=Qn);for(let ae=0;ae<Z.length;ae++){const Ee=Se(S,Z[ae],V||b.handleEvent,!1,b.h||b);if(!Ee)break;b.g[Ee.key]=Ee}b=h.J?z(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),Ur(),_f(h.i,h.v,h.B,h.l,h.S,h.u)}wr.prototype.ba=function(h){h=h.target;const b=this.O;b&&Rr(h)==3?b.j():this.Y(h)},wr.prototype.Y=function(h){try{if(h==this.g)e:{const qe=Rr(this.g),Vt=this.g.ya(),at=this.g.ca();if(!(qe<3)&&(qe!=3||this.g&&(this.h.h||this.g.la()||gn(this.g)))){this.K||qe!=4||Vt==7||(Vt==8||at<=0?Ur(3):Ur(2)),Qr(this);var b=this.g.ca();this.X=b;var S=bf(this);if(this.o=b==200,Su(this.i,this.v,this.B,this.l,this.S,qe,b),this.o){if(this.U&&!this.L){t:{if(this.g){var V,Z=this.g;if((V=Z.g?Z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(V)){var ae=V;break t}}ae=null}if(h=ae)qr(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,$r(this,h);else{this.o=!1,this.m=3,qt(12),$n(this),or(this);break e}}if(this.R){h=!0;let At;for(;!this.K&&this.C<S.length;)if(At=Au(this,S),At==un){qe==4&&(this.m=4,qt(14),h=!1),qr(this.i,this.l,null,"[Incomplete Response]");break}else if(At==Ht){this.m=4,qt(15),qr(this.i,this.l,S,"[Invalid Chunk]"),h=!1;break}else qr(this.i,this.l,At,null),$r(this,At);if(Tu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qe!=4||S.length!=0||this.h.h||(this.m=1,qt(16),h=!1),this.o=this.o&&h,!h)qr(this.i,this.l,S,"[Invalid Chunked Response]"),$n(this),or(this);else if(S.length>0&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.aa&&!Ee.P&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),ql(Ee),Ee.P=!0,qt(11))}}else qr(this.i,this.l,S,null),$r(this,S);qe==4&&$n(this),this.o&&!this.K&&(qe==4?Nu(this.j,this):(this.o=!1,Gr(this)))}else vi(this.g),b==400&&S.indexOf("Unknown SID")>0?(this.m=3,qt(12)):(this.m=0,qt(13)),$n(this),or(this)}}}catch{}};function bf(h){if(!Tu(h))return h.g.la();const b=gn(h.g);if(b==="")return"";let S="";const V=b.length,Z=Rr(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return $n(h),or(h),"";h.h.i=new u.TextDecoder}for(let ae=0;ae<V;ae++)h.h.h=!0,S+=h.h.i.decode(b[ae],{stream:!(Z&&ae==V-1)});return b.length=0,h.h.g+=S,h.C=0,h.h.g}function Tu(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Au(h,b){var S=h.C,V=b.indexOf(`
`,S);return V==-1?un:(S=Number(b.substring(S,V)),isNaN(S)?Ht:(V+=1,V+S>b.length?un:(b=b.slice(V,V+S),h.C=V+S,b)))}wr.prototype.cancel=function(){this.K=!0,$n(this)};function Gr(h){h.T=Date.now()+h.H,Ka(h,h.H)}function Ka(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Fr(g(h.aa,h),b)}function Qr(h){h.D&&(u.clearTimeout(h.D),h.D=null)}wr.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(ia(this.i,this.B),this.M!=2&&(Ur(),qt(17)),$n(this),this.m=2,or(this)):Ka(this,this.T-h)};function or(h){h.j.I==0||h.K||Nu(h.j,h)}function $n(h){Qr(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,Al(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function $r(h,b){try{var S=h.j;if(S.I!=0&&(S.g==h||Wr(S.h,h))){if(!h.L&&Wr(S.h,h)&&S.I==3){try{var V=S.Ba.g.parse(b)}catch{V=null}if(Array.isArray(V)&&V.length==3){var Z=V;if(Z[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<h.F)no(S),os(S);else break e;ma(S),qt(18)}}else S.xa=Z[1],0<S.xa-S.K&&Z[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=Fr(g(S.Va,S),6e3));Kr(S.h)<=1&&S.ta&&(S.ta=void 0)}else ti(S,11)}else if((h.L||S.g==h)&&no(S),!C(b))for(Z=S.Ba.g.parse(b),b=0;b<Z.length;b++){let at=Z[b];const At=at[0];if(!(At<=S.K))if(S.K=At,at=at[1],S.I==2)if(at[0]=="c"){S.M=at[1],S.ba=at[2];const ur=at[3];ur!=null&&(S.ka=ur,S.j.info("VER="+S.ka));const ni=at[4];ni!=null&&(S.za=ni,S.j.info("SVER="+S.za));const Dr=at[5];Dr!=null&&typeof Dr=="number"&&Dr>0&&(V=1.5*Dr,S.O=V,S.j.info("backChannelRequestTimeoutMs_="+V)),V=S;const Ir=h.g;if(Ir){const pa=Ir.g?Ir.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pa){var ae=V.h;ae.g||pa.indexOf("spdy")==-1&&pa.indexOf("quic")==-1&&pa.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(jl(ae,ae.h),ae.h=null))}if(V.G){const ro=Ir.g?Ir.g.getResponseHeader("X-HTTP-Session-Id"):null;ro&&(V.wa=ro,ut(V.J,V.G,ro))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-h.F,S.j.info("Handshake RTT: "+S.T+"ms")),V=S;var Ee=h;if(V.na=Vu(V,V.L?V.ba:null,V.W),Ee.L){Ol(V.h,Ee);var qe=Ee,Vt=V.O;Vt&&(qe.H=Vt),qe.D&&(Qr(qe),Gr(qe)),V.g=Ee}else ku(V);S.i.length>0&&ei(S)}else at[0]!="stop"&&at[0]!="close"||ti(S,7);else S.I==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?ti(S,7):Bl(S):at[0]!="noop"&&S.l&&S.l.qa(at),S.A=0)}}Ur(4)}catch{}}var Gt=class{constructor(h,b){this.g=h,this.map=b}};function Dl(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Il(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Kr(h){return h.h?1:h.g?h.g.size:0}function Wr(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function jl(h,b){h.g?h.g.add(b):h.h=b}function Ol(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}Dl.prototype.cancel=function(){if(this.i=kl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function kl(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const S of h.g.values())b=b.concat(S.G);return b}return w(h.i)}var Cu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wa(h,b){if(h){h=h.split("&");for(let S=0;S<h.length;S++){const V=h[S].indexOf("=");let Z,ae=null;V>=0?(Z=h[S].substring(0,V),ae=h[S].substring(V+1)):Z=h[S],b(Z,ae?decodeURIComponent(ae.replace(/\+/g," ")):"")}}}function Kn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof Kn?(this.l=h.l,dn(this,h.j),this.o=h.o,this.g=h.g,es(this,h.u),this.h=h.h,Ml(this,ju(h.i)),this.m=h.m):h&&(b=String(h).match(Cu))?(this.l=!1,dn(this,b[1]||"",!0),this.o=Yr(b[2]||""),this.g=Yr(b[3]||"",!0),es(this,b[4]),this.h=Yr(b[5]||"",!0),Ml(this,b[6]||"",!0),this.m=Yr(b[7]||"")):(this.l=!1,this.i=new ns(null,this.l))}Kn.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(la(b,Ya,!0),":");var S=this.g;return(S||b=="file")&&(h.push("//"),(b=this.o)&&h.push(la(b,Ya,!0),"@"),h.push(yi(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&h.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&h.push("/"),h.push(la(S,S.charAt(0)=="/"?Nl:Ru,!0))),(S=this.i.toString())&&h.push("?",S),(S=this.m)&&h.push("#",la(S,Du)),h.join("")},Kn.prototype.resolve=function(h){const b=Qt(this);let S=!!h.j;S?dn(b,h.j):S=!!h.o,S?b.o=h.o:S=!!h.g,S?b.g=h.g:S=h.u!=null;var V=h.h;if(S)es(b,h.u);else if(S=!!h.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var Z=b.h.lastIndexOf("/");Z!=-1&&(V=b.h.slice(0,Z+1)+V)}if(Z=V,Z==".."||Z==".")V="";else if(Z.indexOf("./")!=-1||Z.indexOf("/.")!=-1){V=Z.lastIndexOf("/",0)==0,Z=Z.split("/");const ae=[];for(let Ee=0;Ee<Z.length;){const qe=Z[Ee++];qe=="."?V&&Ee==Z.length&&ae.push(""):qe==".."?((ae.length>1||ae.length==1&&ae[0]!="")&&ae.pop(),V&&Ee==Z.length&&ae.push("")):(ae.push(qe),V=!0)}V=ae.join("/")}else V=Z}return S?b.h=V:S=h.i.toString()!=="",S?Ml(b,ju(h.i)):S=!!h.m,S&&(b.m=h.m),b};function Qt(h){return new Kn(h)}function dn(h,b,S){h.j=S?Yr(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function es(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function Ml(h,b,S){b instanceof ns?(h.i=b,Ja(h.i,h.l)):(S||(b=la(b,ts)),h.i=new ns(b,h.l))}function ut(h,b,S){h.i.set(b,S)}function oa(h){return ut(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Yr(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function la(h,b,S){return typeof h=="string"?(h=encodeURI(h).replace(b,Nn),S&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Nn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ya=/[#\/\?@]/g,Ru=/[#\?:]/g,Nl=/[#\?]/g,ts=/[#\?@]/g,Du=/#/g;function ns(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Pn(h){h.g||(h.g=new Map,h.h=0,h.i&&Wa(h.i,function(b,S){h.add(decodeURIComponent(b.replace(/\+/g," ")),S)}))}t=ns.prototype,t.add=function(h,b){Pn(this),this.i=null,h=rs(this,h);let S=this.g.get(h);return S||this.g.set(h,S=[]),S.push(b),this.h+=1,this};function Iu(h,b){Pn(h),b=rs(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Pl(h,b){return Pn(h),b=rs(h,b),h.g.has(b)}t.forEach=function(h,b){Pn(this),this.g.forEach(function(S,V){S.forEach(function(Z){h.call(b,Z,V,this)},this)},this)};function Ll(h,b){Pn(h);let S=[];if(typeof b=="string")Pl(h,b)&&(S=S.concat(h.g.get(rs(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)S=S.concat(h[b]);return S}t.set=function(h,b){return Pn(this),this.i=null,h=rs(this,h),Pl(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},t.get=function(h,b){return h?(h=Ll(this,h),h.length>0?String(h[0]):b):b};function Xa(h,b,S){Iu(h,b),S.length>0&&(h.i=null,h.g.set(rs(h,b),w(S)),h.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let V=0;V<b.length;V++){var S=b[V];const Z=yi(S);S=Ll(this,S);for(let ae=0;ae<S.length;ae++){let Ee=Z;S[ae]!==""&&(Ee+="="+yi(S[ae])),h.push(Ee)}}return this.i=h.join("&")};function ju(h){const b=new ns;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function rs(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Ja(h,b){b&&!h.j&&(Pn(h),h.i=null,h.g.forEach(function(S,V){const Z=V.toLowerCase();V!=Z&&(Iu(this,V),Xa(this,Z,S))},h)),h.j=b}function Ar(h,b){const S=new Sr;if(u.Image){const V=new Image;V.onload=_(lr,S,"TestLoadImage: loaded",!0,b,V),V.onerror=_(lr,S,"TestLoadImage: error",!1,b,V),V.onabort=_(lr,S,"TestLoadImage: abort",!1,b,V),V.ontimeout=_(lr,S,"TestLoadImage: timeout",!1,b,V),u.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=h}else b(!1)}function Vl(h,b){const S=new Sr,V=new AbortController,Z=setTimeout(()=>{V.abort(),lr(S,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:V.signal}).then(ae=>{clearTimeout(Z),ae.ok?lr(S,"TestPingServer: ok",!0,b):lr(S,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(Z),lr(S,"TestPingServer: error",!1,b)})}function lr(h,b,S,V,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),V(S)}catch{}}function is(){this.g=new _u}function Xr(h){this.i=h.Sb||null,this.h=h.ab||!1}v(Xr,vu),Xr.prototype.g=function(){return new ca(this.i,this.h)};function ca(h,b){ct.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(ca,ct),t=ca.prototype,t.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,Cr(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||u).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ss(this)),this.readyState=0},t.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Cr(this)),this.g&&(this.readyState=3,Cr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Za(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Za(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}t.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?ss(this):Cr(this),this.readyState==3&&Za(this)}},t.Oa=function(h){this.g&&(this.response=this.responseText=h,ss(this))},t.Na=function(h){this.g&&(this.response=h,ss(this))},t.ga=function(){this.g&&ss(this)};function ss(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Cr(h)}t.setRequestHeader=function(h,b){this.A.append(h,b)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var S=b.next();!S.done;)S=S.value,h.push(S[0]+": "+S[1]),S=b.next();return h.join(`\r
`)};function Cr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function cr(h){let b="";return le(h,function(S,V){b+=V,b+=":",b+=S,b+=`\r
`}),b}function ua(h,b,S){e:{for(V in S){var V=!1;break e}V=!0}V||(S=cr(S),typeof h=="string"?S!=null&&yi(S):ut(h,b,S))}function ft(h){ct.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ft,ct);var Jr=/^https?$/i,zl=["POST","PUT"];t=ft.prototype,t.Fa=function(h){this.H=h},t.ea=function(h,b,S,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Rl.g(),this.g.onreadystatechange=x(g(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(ae){da(this,ae);return}if(h=S||"",S=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var Z in V)S.set(Z,V[Z]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const ae of V.keys())S.set(ae,V.get(ae));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(S.keys()).find(ae=>ae.toLowerCase()=="content-type"),Z=u.FormData&&h instanceof u.FormData,!(Array.prototype.indexOf.call(zl,b,void 0)>=0)||V||Z||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,Ee]of S)this.g.setRequestHeader(ae,Ee);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ae){da(this,ae)}};function da(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,Ul(h),_i(h)}function Ul(h){h.A||(h.A=!0,Ne(h,"complete"),Ne(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ne(this,"complete"),Ne(this,"abort"),_i(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_i(this,!0)),ft.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ha(this):this.Xa())},t.Xa=function(){ha(this)};function ha(h){if(h.h&&typeof l<"u"){if(h.v&&Rr(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ne(h,"readystatechange"),Rr(h)==4){h.h=!1;try{const ae=h.ca();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var S;if(!(S=b)){var V;if(V=ae===0){let Ee=String(h.D).match(Cu)[1]||null;!Ee&&u.self&&u.self.location&&(Ee=u.self.location.protocol.slice(0,-1)),V=!Jr.test(Ee?Ee.toLowerCase():"")}S=V}if(S)Ne(h,"complete"),Ne(h,"success");else{h.o=6;try{var Z=Rr(h)>2?h.g.statusText:""}catch{Z=""}h.l=Z+" ["+h.ca()+"]",Ul(h)}}finally{_i(h)}}}}function _i(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const S=h.g;h.g=null,b||Ne(h,"ready");try{S.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Rr(h){return h.g?h.g.readyState:0}t.ca=function(){try{return Rr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),yf(b)}};function gn(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function vi(h){const b={};h=(h.g&&Rr(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<h.length;V++){if(C(h[V]))continue;var S=wu(h[V]);const Z=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const ae=b[Z]||[];b[Z]=ae,ae.push(S)}J(b,function(V){return V.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zr(h,b,S){return S&&S.internalChannelParams&&S.internalChannelParams[h]||b}function as(h){this.za=0,this.i=[],this.j=new Sr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Zr("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Zr("baseRetryDelayMs",5e3,h),this.Za=Zr("retryDelaySeedMs",1e4,h),this.Ta=Zr("forwardChannelMaxRetries",2,h),this.va=Zr("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Dl(h&&h.concurrentRequestLimit),this.Ba=new is,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=as.prototype,t.ka=8,t.I=1,t.connect=function(h,b,S,V){qt(0),this.W=h,this.H=b||{},S&&V!==void 0&&(this.H.OSID=S,this.H.OAID=V),this.F=this.X,this.J=Vu(this,null,this.W),ei(this)};function Bl(h){if(eo(h),h.I==3){var b=h.V++,S=Qt(h.J);if(ut(S,"SID",h.M),ut(S,"RID",b),ut(S,"TYPE","terminate"),fa(h,S),b=new wr(h,h.j,b),b.M=2,b.A=oa(Qt(S)),S=!1,u.navigator&&u.navigator.sendBeacon)try{S=u.navigator.sendBeacon(b.A.toString(),"")}catch{}!S&&u.Image&&(new Image().src=b.A,S=!0),S||(b.g=zu(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Gr(b)}Lu(h)}function os(h){h.g&&(ql(h),h.g.cancel(),h.g=null)}function eo(h){os(h),h.v&&(u.clearTimeout(h.v),h.v=null),no(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&u.clearTimeout(h.m),h.m=null)}function ei(h){if(!Il(h.h)&&!h.m){h.m=!0;var b=h.Ea;re||D(),he||(re(),he=!0),L.add(b,h),h.D=0}}function to(h,b){return Kr(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Fr(g(h.Ea,h,b),Pu(h,h.D)),h.D++,!0)}t.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const Z=new wr(this,this.j,h);let ae=this.o;if(this.U&&(ae?(ae=z(ae),W(ae,this.U)):ae=this.U),this.u!==null||this.R||(Z.J=ae,ae=null),this.S)e:{for(var b=0,S=0;S<this.i.length;S++){t:{var V=this.i[S];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(b+=V,b>4096){b=S;break e}if(b===4096||S===this.i.length-1){b=S+1;break e}}b=1e3}else b=1e3;b=Ou(this,Z,b),S=Qt(this.J),ut(S,"RID",h),ut(S,"CVER",22),this.G&&ut(S,"X-HTTP-Session-Id",this.G),fa(this,S),ae&&(this.R?b="headers="+yi(cr(ae))+"&"+b:this.u&&ua(S,this.u,ae)),jl(this.h,Z),this.Ra&&ut(S,"TYPE","init"),this.S?(ut(S,"$req",b),ut(S,"SID","null"),Z.U=!0,Hr(Z,S,null)):Hr(Z,S,b),this.I=2}}else this.I==3&&(h?Fl(this,h):this.i.length==0||Il(this.h)||Fl(this))};function Fl(h,b){var S;b?S=b.l:S=h.V++;const V=Qt(h.J);ut(V,"SID",h.M),ut(V,"RID",S),ut(V,"AID",h.K),fa(h,V),h.u&&h.o&&ua(V,h.u,h.o),S=new wr(h,h.j,S,h.D+1),h.u===null&&(S.J=h.o),b&&(h.i=b.G.concat(h.i)),b=Ou(h,S,1e3),S.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),jl(h.h,S),Hr(S,V,b)}function fa(h,b){h.H&&le(h.H,function(S,V){ut(b,V,S)}),h.l&&le({},function(S,V){ut(b,V,S)})}function Ou(h,b,S){S=Math.min(h.i.length,S);const V=h.l?g(h.l.Ka,h.l,h):null;e:{var Z=h.i;let qe=-1;for(;;){const Vt=["count="+S];qe==-1?S>0?(qe=Z[0].g,Vt.push("ofs="+qe)):qe=0:Vt.push("ofs="+qe);let at=!0;for(let At=0;At<S;At++){var ae=Z[At].g;const ur=Z[At].map;if(ae-=qe,ae<0)qe=Math.max(0,Z[At].g-100),at=!1;else try{ae="req"+ae+"_"||"";try{var Ee=ur instanceof Map?ur:Object.entries(ur);for(const[ni,Dr]of Ee){let Ir=Dr;f(Dr)&&(Ir=Zi(Dr)),Vt.push(ae+ni+"="+encodeURIComponent(Ir))}}catch(ni){throw Vt.push(ae+"type="+encodeURIComponent("_badmap")),ni}}catch{V&&V(ur)}}if(at){Ee=Vt.join("&");break e}}Ee=void 0}return h=h.i.splice(0,S),b.G=h,Ee}function ku(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;re||D(),he||(re(),he=!0),L.add(b,h),h.A=0}}function ma(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Fr(g(h.Da,h),Pu(h,h.A)),h.A++,!0)}t.Da=function(){if(this.v=null,Mu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Fr(g(this.Wa,this),h)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,qt(10),os(this),Mu(this))};function ql(h){h.B!=null&&(u.clearTimeout(h.B),h.B=null)}function Mu(h){h.g=new wr(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=Qt(h.na);ut(b,"RID","rpc"),ut(b,"SID",h.M),ut(b,"AID",h.K),ut(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&ut(b,"TO",h.ia),ut(b,"TYPE","xmlhttp"),fa(h,b),h.u&&h.o&&ua(b,h.u,h.o),h.O&&(h.g.H=h.O);var S=h.g;h=h.ba,S.M=1,S.A=oa(Qt(b)),S.u=null,S.R=!0,$a(S,h)}t.Va=function(){this.C!=null&&(this.C=null,os(this),ma(this),qt(19))};function no(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function Nu(h,b){var S=null;if(h.g==b){no(h),ql(h),h.g=null;var V=2}else if(Wr(h.h,b))S=b.G,Ol(h.h,b),V=1;else return;if(h.I!=0){if(b.o)if(V==1){S=b.u?b.u.length:0,b=Date.now()-b.F;var Z=h.D;V=Qa(),Ne(V,new Br(V,S)),ei(h)}else ku(h);else if(Z=b.m,Z==3||Z==0&&b.X>0||!(V==1&&to(h,b)||V==2&&ma(h)))switch(S&&S.length>0&&(b=h.h,b.i=b.i.concat(S)),Z){case 1:ti(h,5);break;case 4:ti(h,10);break;case 3:ti(h,6);break;default:ti(h,2)}}}function Pu(h,b){let S=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(S*=2),S*b}function ti(h,b){if(h.j.info("Error code "+b),b==2){var S=g(h.bb,h),V=h.Ua;const Z=!V;V=new Kn(V||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||dn(V,"https"),oa(V),Z?Ar(V.toString(),S):Vl(V.toString(),S)}else qt(2);h.I=0,h.l&&h.l.pa(b),Lu(h),eo(h)}t.bb=function(h){h?(this.j.info("Successfully pinged google.com"),qt(2)):(this.j.info("Failed to ping google.com"),qt(1))};function Lu(h){if(h.I=0,h.ja=[],h.l){const b=kl(h.h);(b.length!=0||h.i.length!=0)&&(A(h.ja,b),A(h.ja,h.i),h.h.i.length=0,w(h.i),h.i.length=0),h.l.oa()}}function Vu(h,b,S){var V=S instanceof Kn?Qt(S):new Kn(S);if(V.g!="")b&&(V.g=b+"."+V.g),es(V,V.u);else{var Z=u.location;V=Z.protocol,b=b?b+"."+Z.hostname:Z.hostname,Z=+Z.port;const ae=new Kn(null);V&&dn(ae,V),b&&(ae.g=b),Z&&es(ae,Z),S&&(ae.h=S),V=ae}return S=h.G,b=h.wa,S&&b&&ut(V,S,b),ut(V,"VER",h.ka),fa(h,V),V}function zu(h,b,S){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new ft(new Xr({ab:S})):new ft(h.ma),b.Fa(h.L),b}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Uu(){}t=Uu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ls(){}ls.prototype.g=function(h,b){return new jn(h,b)};function jn(h,b){ct.call(this),this.g=new as(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!C(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!C(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new bi(this)}v(jn,ct),jn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},jn.prototype.close=function(){Bl(this.g)},jn.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var S={};S.__data__=h,h=S}else this.v&&(S={},S.__data__=Zi(h),h=S);b.i.push(new Gt(b.Ya++,h)),b.I==3&&ei(b)},jn.prototype.N=function(){this.g.l=null,delete this.j,Bl(this.g),delete this.g,jn.Z.N.call(this)};function Bu(h){pn.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const S in b){h=S;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}v(Bu,pn);function Fu(){ar.call(this),this.status=1}v(Fu,ar);function bi(h){this.g=h}v(bi,Uu),bi.prototype.ra=function(){Ne(this.g,"a")},bi.prototype.qa=function(h){Ne(this.g,new Bu(h))},bi.prototype.pa=function(h){Ne(this.g,new Fu)},bi.prototype.oa=function(){Ne(this.g,"b")},ls.prototype.createWebChannel=ls.prototype.g,jn.prototype.send=jn.prototype.o,jn.prototype.open=jn.prototype.m,jn.prototype.close=jn.prototype.close,US=function(){return new ls},zS=function(){return Qa()},VS=Lt,ng={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},sa.NO_ERROR=0,sa.TIMEOUT=8,sa.HTTP_ERROR=6,nh=sa,Cl.COMPLETE="complete",LS=Cl,bu.EventType=Er,Er.OPEN="a",Er.CLOSE="b",Er.ERROR="c",Er.MESSAGE="d",ct.prototype.listen=ct.prototype.J,Oc=bu,ft.prototype.listenOnce=ft.prototype.K,ft.prototype.getLastError=ft.prototype.Ha,ft.prototype.getLastErrorCode=ft.prototype.ya,ft.prototype.getStatus=ft.prototype.ca,ft.prototype.getResponseJson=ft.prototype.La,ft.prototype.getResponseText=ft.prototype.la,ft.prototype.send=ft.prototype.ea,ft.prototype.setWithCredentials=ft.prototype.Fa,PS=ft}).apply(typeof Kd<"u"?Kd:typeof self<"u"?self:typeof window<"u"?window:{});const Zb="@firebase/firestore",ex="4.9.3";class Cn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Cn.UNAUTHENTICATED=new Cn(null),Cn.GOOGLE_CREDENTIALS=new Cn("google-credentials-uid"),Cn.FIRST_PARTY=new Cn("first-party-uid"),Cn.MOCK_USER=new Cn("mock-user");let ml="12.7.0";const La=new zg("@firebase/firestore");function Lo(){return La.logLevel}function Ce(t,...e){if(La.logLevel<=Je.DEBUG){const n=e.map(Fg);La.debug(`Firestore (${ml}): ${t}`,...n)}}function Qi(t,...e){if(La.logLevel<=Je.ERROR){const n=e.map(Fg);La.error(`Firestore (${ml}): ${t}`,...n)}}function Yo(t,...e){if(La.logLevel<=Je.WARN){const n=e.map(Fg);La.warn(`Firestore (${ml}): ${t}`,...n)}}function Fg(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function ze(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,BS(t,i,n)}function BS(t,e,n){let i=`FIRESTORE (${ml}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Qi(i),new Error(i)}function lt(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||BS(e,a,i)}function Fe(t,e){return t}const _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends Wi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Bi{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class FS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ej{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Cn.UNAUTHENTICATED)))}shutdown(){}}class Sj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class wj{constructor(e){this.t=e,this.currentUser=Cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){lt(this.o===void 0,42304);let i=this.i;const a=p=>this.i!==i?(i=this.i,n(p)):Promise.resolve();let l=new Bi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Bi,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const p=l;e.enqueueRetryable((async()=>{await p.promise,await a(this.currentUser)}))},f=p=>{Ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((p=>f(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(Ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Bi)}}),0),u()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(Ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(lt(typeof i.accessToken=="string",31837,{l:i}),new FS(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return lt(e===null||typeof e=="string",2055,{h:e}),new Cn(e)}}class Tj{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=Cn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Aj{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new Tj(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Cn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Cj{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){lt(this.o===void 0,3512);const i=l=>{l.error!=null&&Ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,Ce("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{Ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(lt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new tx(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Rj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class qg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=Rj(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function Ze(t,e){return t<e?-1:t>e?1:0}function rg(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return Rp(a)===Rp(l)?Ze(a,l):Rp(a)?1:-1}return Ze(t.length,e.length)}const Dj=55296,Ij=57343;function Rp(t){const e=t.charCodeAt(0);return e>=Dj&&e<=Ij}function Xo(t,e,n){return t.length===e.length&&t.every(((i,a)=>n(i,e[a])))}const nx="__name__";class oi{constructor(e,n,i){n===void 0?n=0:n>e.length&&ze(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&ze(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return oi.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof oi?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=oi.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return Ze(e.length,n.length)}static compareSegments(e,n){const i=oi.isNumericId(e),a=oi.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?oi.extractNumericId(e).compare(oi.extractNumericId(n)):rg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fs.fromString(e.substring(4,e.length-2))}}class bt extends oi{construct(e,n,i){return new bt(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new we(_e.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((a=>a.length>0)))}return new bt(n)}static emptyPath(){return new bt([])}}const jj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class En extends oi{construct(e,n,i){return new En(e,n,i)}static isValidIdentifier(e){return jj.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),En.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nx}static keyField(){return new En([nx])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new we(_e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let u=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new we(_e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[a+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new we(_e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,a+=2}else f==="`"?(u=!u,a++):f!=="."||u?(i+=f,a++):(l(),a++)}if(l(),u)throw new we(_e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new En(n)}static emptyPath(){return new En([])}}class ke{constructor(e){this.path=e}static fromPath(e){return new ke(bt.fromString(e))}static fromName(e){return new ke(bt.fromString(e).popFirst(5))}static empty(){return new ke(bt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&bt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return bt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ke(new bt(e.slice()))}}function qS(t,e,n){if(!n)throw new we(_e.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Oj(t,e,n,i){if(e===!0&&i===!0)throw new we(_e.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function rx(t){if(!ke.isDocumentKey(t))throw new we(_e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function ix(t){if(ke.isDocumentKey(t))throw new we(_e.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function HS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Hh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ze(12329,{type:typeof t})}function pi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new we(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Hh(t);throw new we(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function en(t,e){const n={typeString:t};return e&&(n.value=e),n}function au(t,e){if(!HS(t))throw new we(_e.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const u=t[i];if(a&&typeof u!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new we(_e.INVALID_ARGUMENT,n);return!0}const sx=-62135596800,ax=1e6;class wt{static now(){return wt.fromMillis(Date.now())}static fromDate(e){return wt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*ax);return new wt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new we(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new we(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<sx)throw new we(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ax}_compareTo(e){return this.seconds===e.seconds?Ze(this.nanoseconds,e.nanoseconds):Ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(au(e,wt._jsonSchema))return new wt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-sx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}wt._jsonSchemaVersion="firestore/timestamp/1.0",wt._jsonSchema={type:en("string",wt._jsonSchemaVersion),seconds:en("number"),nanoseconds:en("number")};class Ue{static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new wt(0,0))}static max(){return new Ue(new wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Gc=-1;function kj(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Ue.fromTimestamp(i===1e9?new wt(n+1,0):new wt(n,i));return new Ks(a,ke.empty(),e)}function Mj(t){return new Ks(t.readTime,t.key,Gc)}class Ks{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Ks(Ue.min(),ke.empty(),Gc)}static max(){return new Ks(Ue.max(),ke.empty(),Gc)}}function Nj(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ke.comparator(t.documentKey,e.documentKey),n!==0?n:Ze(t.largestBatchId,e.largestBatchId))}const Pj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Lj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function pl(t){if(t.code!==_e.FAILED_PRECONDITION||t.message!==Pj)throw t;Ce("LocalStore","Unexpectedly lost primary lease")}class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ve(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof ve?n:ve.resolve(n)}catch(n){return ve.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):ve.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):ve.reject(n)}static resolve(e){return new ve(((n,i)=>{n(e)}))}static reject(e){return new ve(((n,i)=>{i(e)}))}static waitFor(e){return new ve(((n,i)=>{let a=0,l=0,u=!1;e.forEach((f=>{++a,f.next((()=>{++l,u&&l===a&&n()}),(p=>i(p)))})),u=!0,l===a&&n()}))}static or(e){let n=ve.resolve(!1);for(const i of e)n=n.next((a=>a?ve.resolve(a):i()));return n}static forEach(e,n){const i=[];return e.forEach(((a,l)=>{i.push(n.call(this,a,l))})),this.waitFor(i)}static mapArray(e,n){return new ve(((i,a)=>{const l=e.length,u=new Array(l);let f=0;for(let p=0;p<l;p++){const g=p;n(e[g]).next((_=>{u[g]=_,++f,f===l&&i(u)}),(_=>a(_)))}}))}static doWhile(e,n){return new ve(((i,a)=>{const l=()=>{e()===!0?n().next((()=>{l()}),a):i()};l()}))}}function Vj(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function gl(t){return t.name==="IndexedDbTransactionError"}class Gh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Gh.ce=-1;const Hg=-1;function Qh(t){return t==null}function vh(t){return t===0&&1/t==-1/0}function zj(t){return typeof t=="number"&&Number.isInteger(t)&&!vh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const GS="";function Uj(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ox(e)),e=Bj(t.get(n),e);return ox(e)}function Bj(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case GS:n+="";break;default:n+=l}}return n}function ox(t){return t+GS+""}function lx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ea(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function QS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class jt{constructor(e,n){this.comparator=e,this.root=n||xn.EMPTY}insert(e,n){return new jt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,xn.BLACK,null,null))}remove(e){return new jt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wd(this.root,e,this.comparator,!0)}}class Wd{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xn{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??xn.RED,this.left=a??xn.EMPTY,this.right=l??xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new xn(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return xn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ze(27949);return e+(this.isRed()?0:1)}}xn.EMPTY=null,xn.RED=!0,xn.BLACK=!1;xn.EMPTY=new class{constructor(){this.size=0}get key(){throw ze(57766)}get value(){throw ze(16141)}get color(){throw ze(16727)}get left(){throw ze(29726)}get right(){throw ze(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new xn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class on{constructor(e){this.comparator=e,this.data=new jt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new cx(this.data.getIterator())}getIteratorFrom(e){return new cx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof on)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new on(this.comparator);return n.data=e,n}}class cx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class nr{constructor(e){this.fields=e,e.sort(En.comparator)}static empty(){return new nr([])}unionWith(e){let n=new on(En.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new nr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Xo(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class $S extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Sn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new $S("Invalid base64 string: "+l):l}})(e);return new Sn(n)}static fromUint8Array(e){const n=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new Sn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Sn.EMPTY_BYTE_STRING=new Sn("");const Fj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ws(t){if(lt(!!t,39018),typeof t=="string"){let e=0;const n=Fj.exec(t);if(lt(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Bt(t.seconds),nanos:Bt(t.nanos)}}function Bt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ys(t){return typeof t=="string"?Sn.fromBase64String(t):Sn.fromUint8Array(t)}const KS="server_timestamp",WS="__type__",YS="__previous_value__",XS="__local_write_time__";function Gg(t){return(t?.mapValue?.fields||{})[WS]?.stringValue===KS}function $h(t){const e=t.mapValue.fields[YS];return Gg(e)?$h(e):e}function Qc(t){const e=Ws(t.mapValue.fields[XS].timestampValue);return new wt(e.seconds,e.nanos)}class qj{constructor(e,n,i,a,l,u,f,p,g,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=g,this.isUsingEmulator=_}}const bh="(default)";class $c{constructor(e,n){this.projectId=e,this.database=n||bh}static empty(){return new $c("","")}get isDefaultDatabase(){return this.database===bh}isEqual(e){return e instanceof $c&&e.projectId===this.projectId&&e.database===this.database}}const JS="__type__",Hj="__max__",Yd={mapValue:{}},ZS="__vector__",xh="value";function Xs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Gg(t)?4:Qj(t)?9007199254740991:Gj(t)?10:11:ze(28295,{value:t})}function gi(t,e){if(t===e)return!0;const n=Xs(t);if(n!==Xs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qc(t).isEqual(Qc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=Ws(a.timestampValue),f=Ws(l.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return Ys(a.bytesValue).isEqual(Ys(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return Bt(a.geoPointValue.latitude)===Bt(l.geoPointValue.latitude)&&Bt(a.geoPointValue.longitude)===Bt(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Bt(a.integerValue)===Bt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Bt(a.doubleValue),f=Bt(l.doubleValue);return u===f?vh(u)===vh(f):isNaN(u)&&isNaN(f)}return!1})(t,e);case 9:return Xo(t.arrayValue.values||[],e.arrayValue.values||[],gi);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},f=l.mapValue.fields||{};if(lx(u)!==lx(f))return!1;for(const p in u)if(u.hasOwnProperty(p)&&(f[p]===void 0||!gi(u[p],f[p])))return!1;return!0})(t,e);default:return ze(52216,{left:t})}}function Kc(t,e){return(t.values||[]).find((n=>gi(n,e)))!==void 0}function Jo(t,e){if(t===e)return 0;const n=Xs(t),i=Xs(e);if(n!==i)return Ze(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ze(t.booleanValue,e.booleanValue);case 2:return(function(l,u){const f=Bt(l.integerValue||l.doubleValue),p=Bt(u.integerValue||u.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1})(t,e);case 3:return ux(t.timestampValue,e.timestampValue);case 4:return ux(Qc(t),Qc(e));case 5:return rg(t.stringValue,e.stringValue);case 6:return(function(l,u){const f=Ys(l),p=Ys(u);return f.compareTo(p)})(t.bytesValue,e.bytesValue);case 7:return(function(l,u){const f=l.split("/"),p=u.split("/");for(let g=0;g<f.length&&g<p.length;g++){const _=Ze(f[g],p[g]);if(_!==0)return _}return Ze(f.length,p.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,u){const f=Ze(Bt(l.latitude),Bt(u.latitude));return f!==0?f:Ze(Bt(l.longitude),Bt(u.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return dx(t.arrayValue,e.arrayValue);case 10:return(function(l,u){const f=l.fields||{},p=u.fields||{},g=f[xh]?.arrayValue,_=p[xh]?.arrayValue,v=Ze(g?.values?.length||0,_?.values?.length||0);return v!==0?v:dx(g,_)})(t.mapValue,e.mapValue);case 11:return(function(l,u){if(l===Yd.mapValue&&u===Yd.mapValue)return 0;if(l===Yd.mapValue)return 1;if(u===Yd.mapValue)return-1;const f=l.fields||{},p=Object.keys(f),g=u.fields||{},_=Object.keys(g);p.sort(),_.sort();for(let v=0;v<p.length&&v<_.length;++v){const x=rg(p[v],_[v]);if(x!==0)return x;const w=Jo(f[p[v]],g[_[v]]);if(w!==0)return w}return Ze(p.length,_.length)})(t.mapValue,e.mapValue);default:throw ze(23264,{he:n})}}function ux(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ze(t,e);const n=Ws(t),i=Ws(e),a=Ze(n.seconds,i.seconds);return a!==0?a:Ze(n.nanos,i.nanos)}function dx(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=Jo(n[a],i[a]);if(l)return l}return Ze(n.length,i.length)}function Zo(t){return ig(t)}function ig(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=Ws(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Ys(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return ke.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=ig(l);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const u of i)l?l=!1:a+=",",a+=`${u}:${ig(n.fields[u])}`;return a+"}"})(t.mapValue):ze(61005,{value:t})}function rh(t){switch(Xs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$h(t);return e?16+rh(e):16;case 5:return 2*t.stringValue.length;case 6:return Ys(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+rh(l)),0)})(t.arrayValue);case 10:case 11:return(function(i){let a=0;return ea(i.fields,((l,u)=>{a+=l.length+rh(u)})),a})(t.mapValue);default:throw ze(13486,{value:t})}}function hx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function sg(t){return!!t&&"integerValue"in t}function Qg(t){return!!t&&"arrayValue"in t}function fx(t){return!!t&&"nullValue"in t}function mx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ih(t){return!!t&&"mapValue"in t}function Gj(t){return(t?.mapValue?.fields||{})[JS]?.stringValue===ZS}function Lc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ea(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=Lc(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Lc(t.arrayValue.values[n]);return e}return{...t}}function Qj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Hj}class qn{constructor(e){this.value=e}static empty(){return new qn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!ih(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lc(n)}setAll(e){let n=En.emptyPath(),i={},a=[];e.forEach(((u,f)=>{if(!n.isImmediateParentOf(f)){const p=this.getFieldsMap(n);this.applyChanges(p,i,a),i={},a=[],n=f.popLast()}u?i[f.lastSegment()]=Lc(u):a.push(f.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());ih(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return gi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];ih(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){ea(n,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new qn(Lc(this.value))}}function ew(t){const e=[];return ea(t.fields,((n,i)=>{const a=new En([n]);if(ih(i)){const l=ew(i.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new nr(e)}class Rn{constructor(e,n,i,a,l,u,f){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=u,this.documentState=f}static newInvalidDocument(e){return new Rn(e,0,Ue.min(),Ue.min(),Ue.min(),qn.empty(),0)}static newFoundDocument(e,n,i,a){return new Rn(e,1,n,Ue.min(),i,a,0)}static newNoDocument(e,n){return new Rn(e,2,n,Ue.min(),Ue.min(),qn.empty(),0)}static newUnknownDocument(e,n){return new Rn(e,3,n,Ue.min(),Ue.min(),qn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Rn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Rn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Eh{constructor(e,n){this.position=e,this.inclusive=n}}function px(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],u=t.position[a];if(l.field.isKeyField()?i=ke.comparator(ke.fromName(u.referenceValue),n.key):i=Jo(u,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function gx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!gi(t.position[n],e.position[n]))return!1;return!0}class Sh{constructor(e,n="asc"){this.field=e,this.dir=n}}function $j(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class tw{}class Zt extends tw{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new Wj(e,n,i):n==="array-contains"?new Jj(e,i):n==="in"?new Zj(e,i):n==="not-in"?new e2(e,i):n==="array-contains-any"?new t2(e,i):new Zt(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new Yj(e,i):new Xj(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Jo(n,this.value)):n!==null&&Xs(this.value)===Xs(n)&&this.matchesComparison(Jo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vr extends tw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Vr(e,n)}matches(e){return nw(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function nw(t){return t.op==="and"}function rw(t){return Kj(t)&&nw(t)}function Kj(t){for(const e of t.filters)if(e instanceof Vr)return!1;return!0}function ag(t){if(t instanceof Zt)return t.field.canonicalString()+t.op.toString()+Zo(t.value);if(rw(t))return t.filters.map((e=>ag(e))).join(",");{const e=t.filters.map((n=>ag(n))).join(",");return`${t.op}(${e})`}}function iw(t,e){return t instanceof Zt?(function(i,a){return a instanceof Zt&&i.op===a.op&&i.field.isEqual(a.field)&&gi(i.value,a.value)})(t,e):t instanceof Vr?(function(i,a){return a instanceof Vr&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,u,f)=>l&&iw(u,a.filters[f])),!0):!1})(t,e):void ze(19439)}function sw(t){return t instanceof Zt?(function(n){return`${n.field.canonicalString()} ${n.op} ${Zo(n.value)}`})(t):t instanceof Vr?(function(n){return n.op.toString()+" {"+n.getFilters().map(sw).join(" ,")+"}"})(t):"Filter"}class Wj extends Zt{constructor(e,n,i){super(e,n,i),this.key=ke.fromName(i.referenceValue)}matches(e){const n=ke.comparator(e.key,this.key);return this.matchesComparison(n)}}class Yj extends Zt{constructor(e,n){super(e,"in",n),this.keys=aw("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class Xj extends Zt{constructor(e,n){super(e,"not-in",n),this.keys=aw("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function aw(t,e){return(e.arrayValue?.values||[]).map((n=>ke.fromName(n.referenceValue)))}class Jj extends Zt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Qg(n)&&Kc(n.arrayValue,this.value)}}class Zj extends Zt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Kc(this.value.arrayValue,n)}}class e2 extends Zt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Kc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Kc(this.value.arrayValue,n)}}class t2 extends Zt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Qg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>Kc(this.value.arrayValue,i)))}}class n2{constructor(e,n=null,i=[],a=[],l=null,u=null,f=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=u,this.endAt=f,this.Te=null}}function yx(t,e=null,n=[],i=[],a=null,l=null,u=null){return new n2(t,e,n,i,a,l,u)}function $g(t){const e=Fe(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>ag(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),Qh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>Zo(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>Zo(i))).join(",")),e.Te=n}return e.Te}function Kg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!$j(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!iw(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gx(t.startAt,e.startAt)&&gx(t.endAt,e.endAt)}function og(t){return ke.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class ou{constructor(e,n=null,i=[],a=[],l=null,u="F",f=null,p=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=u,this.startAt=f,this.endAt=p,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function r2(t,e,n,i,a,l,u,f){return new ou(t,e,n,i,a,l,u,f)}function Wg(t){return new ou(t)}function _x(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ow(t){return t.collectionGroup!==null}function Vc(t){const e=Fe(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new on(En.comparator);return u.filters.forEach((p=>{p.getFlattenedFilters().forEach((g=>{g.isInequality()&&(f=f.add(g.field))}))})),f})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Sh(l,i))})),n.has(En.keyField().canonicalString())||e.Ie.push(new Sh(En.keyField(),i))}return e.Ie}function li(t){const e=Fe(t);return e.Ee||(e.Ee=i2(e,Vc(t))),e.Ee}function i2(t,e){if(t.limitType==="F")return yx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Sh(a.field,l)}));const n=t.endAt?new Eh(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Eh(t.startAt.position,t.startAt.inclusive):null;return yx(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function lg(t,e){const n=t.filters.concat([e]);return new ou(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function cg(t,e,n){return new ou(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Kh(t,e){return Kg(li(t),li(e))&&t.limitType===e.limitType}function lw(t){return`${$g(li(t))}|lt:${t.limitType}`}function Vo(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((a=>sw(a))).join(", ")}]`),Qh(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((a=>Zo(a))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((a=>Zo(a))).join(",")),`Target(${i})`})(li(t))}; limitType=${t.limitType})`}function Wh(t,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):ke.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(t,e)&&(function(i,a){for(const l of Vc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(i,a){return!(i.startAt&&!(function(u,f,p){const g=px(u,f,p);return u.inclusive?g<=0:g<0})(i.startAt,Vc(i),a)||i.endAt&&!(function(u,f,p){const g=px(u,f,p);return u.inclusive?g>=0:g>0})(i.endAt,Vc(i),a))})(t,e)}function s2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function cw(t){return(e,n)=>{let i=!1;for(const a of Vc(t)){const l=a2(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function a2(t,e,n){const i=t.field.isKeyField()?ke.comparator(e.key,n.key):(function(l,u,f){const p=u.data.field(l),g=f.data.field(l);return p!==null&&g!==null?Jo(p,g):ze(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return ze(19790,{direction:t.dir})}}class Ua{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){ea(this.inner,((n,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return QS(this.inner)}size(){return this.innerSize}}const o2=new jt(ke.comparator);function $i(){return o2}const uw=new jt(ke.comparator);function kc(...t){let e=uw;for(const n of t)e=e.insert(n.key,n);return e}function dw(t){let e=uw;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function Oa(){return zc()}function hw(){return zc()}function zc(){return new Ua((t=>t.toString()),((t,e)=>t.isEqual(e)))}const l2=new jt(ke.comparator),c2=new on(ke.comparator);function et(...t){let e=c2;for(const n of t)e=e.add(n);return e}const u2=new on(Ze);function d2(){return u2}function Yg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vh(e)?"-0":e}}function fw(t){return{integerValue:""+t}}function h2(t,e){return zj(e)?fw(e):Yg(t,e)}class Yh{constructor(){this._=void 0}}function f2(t,e,n){return t instanceof wh?(function(a,l){const u={fields:{[WS]:{stringValue:KS},[XS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Gg(l)&&(l=$h(l)),l&&(u.fields[YS]=l),{mapValue:u}})(n,e):t instanceof el?pw(t,e):t instanceof Wc?gw(t,e):(function(a,l){const u=mw(a,l),f=vx(u)+vx(a.Ae);return sg(u)&&sg(a.Ae)?fw(f):Yg(a.serializer,f)})(t,e)}function m2(t,e,n){return t instanceof el?pw(t,e):t instanceof Wc?gw(t,e):n}function mw(t,e){return t instanceof Th?(function(i){return sg(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class wh extends Yh{}class el extends Yh{constructor(e){super(),this.elements=e}}function pw(t,e){const n=yw(e);for(const i of t.elements)n.some((a=>gi(a,i)))||n.push(i);return{arrayValue:{values:n}}}class Wc extends Yh{constructor(e){super(),this.elements=e}}function gw(t,e){let n=yw(e);for(const i of t.elements)n=n.filter((a=>!gi(a,i)));return{arrayValue:{values:n}}}class Th extends Yh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function vx(t){return Bt(t.integerValue||t.doubleValue)}function yw(t){return Qg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class p2{constructor(e,n){this.field=e,this.transform=n}}function g2(t,e){return t.field.isEqual(e.field)&&(function(i,a){return i instanceof el&&a instanceof el||i instanceof Wc&&a instanceof Wc?Xo(i.elements,a.elements,gi):i instanceof Th&&a instanceof Th?gi(i.Ae,a.Ae):i instanceof wh&&a instanceof wh})(t.transform,e.transform)}class y2{constructor(e,n){this.version=e,this.transformResults=n}}class Lr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Lr}static exists(e){return new Lr(void 0,e)}static updateTime(e){return new Lr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Xh{}function _w(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Xg(t.key,Lr.none()):new lu(t.key,t.data,Lr.none());{const n=t.data,i=qn.empty();let a=new on(En.comparator);for(let l of e.fields)if(!a.has(l)){let u=n.field(l);u===null&&l.length>1&&(l=l.popLast(),u=n.field(l)),u===null?i.delete(l):i.set(l,u),a=a.add(l)}return new ta(t.key,i,new nr(a.toArray()),Lr.none())}}function _2(t,e,n){t instanceof lu?(function(a,l,u){const f=a.value.clone(),p=xx(a.fieldTransforms,l,u.transformResults);f.setAll(p),l.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(t,e,n):t instanceof ta?(function(a,l,u){if(!sh(a.precondition,l))return void l.convertToUnknownDocument(u.version);const f=xx(a.fieldTransforms,l,u.transformResults),p=l.data;p.setAll(vw(a)),p.setAll(f),l.convertToFoundDocument(u.version,p).setHasCommittedMutations()})(t,e,n):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,n)}function Uc(t,e,n,i){return t instanceof lu?(function(l,u,f,p){if(!sh(l.precondition,u))return f;const g=l.value.clone(),_=Ex(l.fieldTransforms,p,u);return g.setAll(_),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),null})(t,e,n,i):t instanceof ta?(function(l,u,f,p){if(!sh(l.precondition,u))return f;const g=Ex(l.fieldTransforms,p,u),_=u.data;return _.setAll(vw(l)),_.setAll(g),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,n,i):(function(l,u,f){return sh(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f})(t,e,n)}function v2(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=mw(i.transform,a||null);l!=null&&(n===null&&(n=qn.empty()),n.set(i.field,l))}return n||null}function bx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&Xo(i,a,((l,u)=>g2(l,u)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class lu extends Xh{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ta extends Xh{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function vw(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function xx(t,e,n){const i=new Map;lt(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],u=l.transform,f=e.data.field(l.field);i.set(l.field,m2(u,f,n[a]))}return i}function Ex(t,e,n){const i=new Map;for(const a of t){const l=a.transform,u=n.data.field(a.field);i.set(a.field,f2(l,u,e))}return i}class Xg extends Xh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class b2 extends Xh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class x2{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&_2(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=Uc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=Uc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=hw();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let f=this.applyToLocalView(u,l.mutatedFields);f=n.has(a.key)?null:f;const p=_w(u,f);p!==null&&i.set(a.key,p),u.isValidDocument()||u.convertToNoDocument(Ue.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),et())}isEqual(e){return this.batchId===e.batchId&&Xo(this.mutations,e.mutations,((n,i)=>bx(n,i)))&&Xo(this.baseMutations,e.baseMutations,((n,i)=>bx(n,i)))}}class Jg{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){lt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return l2})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,i[u].version);return new Jg(e,n,i,a)}}class E2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class S2{constructor(e,n){this.count=e,this.unchangedNames=n}}var Jt,nt;function w2(t){switch(t){case _e.OK:return ze(64938);case _e.CANCELLED:case _e.UNKNOWN:case _e.DEADLINE_EXCEEDED:case _e.RESOURCE_EXHAUSTED:case _e.INTERNAL:case _e.UNAVAILABLE:case _e.UNAUTHENTICATED:return!1;case _e.INVALID_ARGUMENT:case _e.NOT_FOUND:case _e.ALREADY_EXISTS:case _e.PERMISSION_DENIED:case _e.FAILED_PRECONDITION:case _e.ABORTED:case _e.OUT_OF_RANGE:case _e.UNIMPLEMENTED:case _e.DATA_LOSS:return!0;default:return ze(15467,{code:t})}}function bw(t){if(t===void 0)return Qi("GRPC error has no .code"),_e.UNKNOWN;switch(t){case Jt.OK:return _e.OK;case Jt.CANCELLED:return _e.CANCELLED;case Jt.UNKNOWN:return _e.UNKNOWN;case Jt.DEADLINE_EXCEEDED:return _e.DEADLINE_EXCEEDED;case Jt.RESOURCE_EXHAUSTED:return _e.RESOURCE_EXHAUSTED;case Jt.INTERNAL:return _e.INTERNAL;case Jt.UNAVAILABLE:return _e.UNAVAILABLE;case Jt.UNAUTHENTICATED:return _e.UNAUTHENTICATED;case Jt.INVALID_ARGUMENT:return _e.INVALID_ARGUMENT;case Jt.NOT_FOUND:return _e.NOT_FOUND;case Jt.ALREADY_EXISTS:return _e.ALREADY_EXISTS;case Jt.PERMISSION_DENIED:return _e.PERMISSION_DENIED;case Jt.FAILED_PRECONDITION:return _e.FAILED_PRECONDITION;case Jt.ABORTED:return _e.ABORTED;case Jt.OUT_OF_RANGE:return _e.OUT_OF_RANGE;case Jt.UNIMPLEMENTED:return _e.UNIMPLEMENTED;case Jt.DATA_LOSS:return _e.DATA_LOSS;default:return ze(39323,{code:t})}}(nt=Jt||(Jt={}))[nt.OK=0]="OK",nt[nt.CANCELLED=1]="CANCELLED",nt[nt.UNKNOWN=2]="UNKNOWN",nt[nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nt[nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nt[nt.NOT_FOUND=5]="NOT_FOUND",nt[nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",nt[nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",nt[nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",nt[nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nt[nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nt[nt.ABORTED=10]="ABORTED",nt[nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",nt[nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",nt[nt.INTERNAL=13]="INTERNAL",nt[nt.UNAVAILABLE=14]="UNAVAILABLE",nt[nt.DATA_LOSS=15]="DATA_LOSS";function T2(){return new TextEncoder}const A2=new Fs([4294967295,4294967295],0);function Sx(t){const e=T2().encode(t),n=new NS;return n.update(e),new Uint8Array(n.digest())}function wx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Fs([n,i],0),new Fs([a,l],0)]}class Zg{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Mc(`Invalid padding: ${n}`);if(i<0)throw new Mc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Mc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Mc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Fs.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(Fs.fromNumber(i)));return a.compare(A2)===1&&(a=new Fs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Sx(e),[i,a]=wx(n);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);if(!this.we(u))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Zg(l,a,n);return i.forEach((f=>u.insert(f))),u}insert(e){if(this.ge===0)return;const n=Sx(e),[i,a]=wx(n);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);this.Se(u)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Mc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Jh{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,cu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new Jh(Ue.min(),a,new jt(Ze),$i(),et())}}class cu{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new cu(i,n,et(),et(),et())}}class ah{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class xw{constructor(e,n){this.targetId=e,this.Ce=n}}class Ew{constructor(e,n,i=Sn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class Tx{constructor(){this.ve=0,this.Fe=Ax(),this.Me=Sn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=et(),n=et(),i=et();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:ze(38017,{changeType:l})}})),new cu(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=Ax()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class C2{constructor(e){this.Ge=e,this.ze=new Map,this.je=$i(),this.Je=Xd(),this.He=Xd(),this.Ye=new jt(Ze)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:ze(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(og(l))if(i===0){const u=new ke(l.path);this.et(n,u,Rn.newNoDocument(u,Ue.min()))}else lt(i===1,20013,{expectedCount:i});else{const u=this._t(n);if(u!==i){const f=this.ut(e),p=f?this.ct(f,e,u):1;if(p!==0){this.it(n);const g=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,g)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let u,f;try{u=Ys(i).toUint8Array()}catch(p){if(p instanceof $S)return Yo("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new Zg(u,a,l)}catch(p){return Yo(p instanceof Mc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.ge===0?null:f}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach((l=>{const u=this.Ge.ht(),f=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.et(n,l,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((l,u)=>{const f=this.ot(u);if(f){if(l.current&&og(f.target)){const p=new ke(f.target.path);this.It(p).has(u)||this.Et(u,p)||this.et(u,p,Rn.newNoDocument(p,e))}l.Be&&(n.set(u,l.ke()),l.qe())}}));let i=et();this.He.forEach(((l,u)=>{let f=!0;u.forEachWhile((p=>{const g=this.ot(p);return!g||g.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new Jh(e,n,this.Ye,this.je,i);return this.je=$i(),this.Je=Xd(),this.He=Xd(),this.Ye=new jt(Ze),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Tx,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new on(Ze),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new on(Ze),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ce("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Tx),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Xd(){return new jt(ke.comparator)}function Ax(){return new jt(ke.comparator)}const R2={asc:"ASCENDING",desc:"DESCENDING"},D2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},I2={and:"AND",or:"OR"};class j2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ug(t,e){return t.useProto3Json||Qh(e)?e:{value:e}}function Ah(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function O2(t,e){return Ah(t,e.toTimestamp())}function ci(t){return lt(!!t,49232),Ue.fromTimestamp((function(n){const i=Ws(n);return new wt(i.seconds,i.nanos)})(t))}function ey(t,e){return dg(t,e).canonicalString()}function dg(t,e){const n=(function(a){return new bt(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function ww(t){const e=bt.fromString(t);return lt(Dw(e),10190,{key:e.toString()}),e}function hg(t,e){return ey(t.databaseId,e.path)}function Dp(t,e){const n=ww(e);if(n.get(1)!==t.databaseId.projectId)throw new we(_e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new we(_e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ke(Aw(n))}function Tw(t,e){return ey(t.databaseId,e)}function k2(t){const e=ww(t);return e.length===4?bt.emptyPath():Aw(e)}function fg(t){return new bt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Aw(t){return lt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Cx(t,e,n){return{name:hg(t,e),fields:n.value.mapValue.fields}}function M2(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:ze(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(g,_){return g.useProto3Json?(lt(_===void 0||typeof _=="string",58123),Sn.fromBase64String(_||"")):(lt(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Sn.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&(function(g){const _=g.code===void 0?_e.UNKNOWN:bw(g.code);return new we(_,g.message||"")})(u);n=new Ew(i,a,l,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Dp(t,i.document.name),l=ci(i.document.updateTime),u=i.document.createTime?ci(i.document.createTime):Ue.min(),f=new qn({mapValue:{fields:i.document.fields}}),p=Rn.newFoundDocument(a,l,u,f),g=i.targetIds||[],_=i.removedTargetIds||[];n=new ah(g,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Dp(t,i.document),l=i.readTime?ci(i.readTime):Ue.min(),u=Rn.newNoDocument(a,l),f=i.removedTargetIds||[];n=new ah([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Dp(t,i.document),l=i.removedTargetIds||[];n=new ah([],l,a,null)}else{if(!("filter"in e))return ze(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,u=new S2(a,l),f=i.targetId;n=new xw(f,u)}}return n}function N2(t,e){let n;if(e instanceof lu)n={update:Cx(t,e.key,e.value)};else if(e instanceof Xg)n={delete:hg(t,e.key)};else if(e instanceof ta)n={update:Cx(t,e.key,e.data),updateMask:H2(e.fieldMask)};else{if(!(e instanceof b2))return ze(16599,{Vt:e.type});n={verify:hg(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const f=u.transform;if(f instanceof wh)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof el)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Wc)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Th)return{fieldPath:u.field.canonicalString(),increment:f.Ae};throw ze(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:O2(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:ze(27497)})(t,e.precondition)),n}function P2(t,e){return t&&t.length>0?(lt(e!==void 0,14353),t.map((n=>(function(a,l){let u=a.updateTime?ci(a.updateTime):ci(l);return u.isEqual(Ue.min())&&(u=ci(l)),new y2(u,a.transformResults||[])})(n,e)))):[]}function L2(t,e){return{documents:[Tw(t,e.path)]}}function V2(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Tw(t,a);const l=(function(g){if(g.length!==0)return Rw(Vr.create(g,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const u=(function(g){if(g.length!==0)return g.map((_=>(function(x){return{field:zo(x.field),direction:B2(x.dir)}})(_)))})(e.orderBy);u&&(n.structuredQuery.orderBy=u);const f=ug(t,e.limit);return f!==null&&(n.structuredQuery.limit=f),e.startAt&&(n.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:n,parent:a}}function z2(t){let e=k2(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){lt(i===1,65062);const _=n.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(v){const x=Cw(v);return x instanceof Vr&&rw(x)?x.getFilters():[x]})(n.where));let u=[];n.orderBy&&(u=(function(v){return v.map((x=>(function(A){return new Sh(Uo(A.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(A.direction))})(x)))})(n.orderBy));let f=null;n.limit&&(f=(function(v){let x;return x=typeof v=="object"?v.value:v,Qh(x)?null:x})(n.limit));let p=null;n.startAt&&(p=(function(v){const x=!!v.before,w=v.values||[];return new Eh(w,x)})(n.startAt));let g=null;return n.endAt&&(g=(function(v){const x=!v.before,w=v.values||[];return new Eh(w,x)})(n.endAt)),r2(e,a,u,l,f,"F",p,g)}function U2(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ze(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Cw(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Uo(n.unaryFilter.field);return Zt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=Uo(n.unaryFilter.field);return Zt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Uo(n.unaryFilter.field);return Zt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Uo(n.unaryFilter.field);return Zt.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ze(61313);default:return ze(60726)}})(t):t.fieldFilter!==void 0?(function(n){return Zt.create(Uo(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ze(58110);default:return ze(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Vr.create(n.compositeFilter.filters.map((i=>Cw(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ze(1026)}})(n.compositeFilter.op))})(t):ze(30097,{filter:t})}function B2(t){return R2[t]}function F2(t){return D2[t]}function q2(t){return I2[t]}function zo(t){return{fieldPath:t.canonicalString()}}function Uo(t){return En.fromServerFormat(t.fieldPath)}function Rw(t){return t instanceof Zt?(function(n){if(n.op==="=="){if(mx(n.value))return{unaryFilter:{field:zo(n.field),op:"IS_NAN"}};if(fx(n.value))return{unaryFilter:{field:zo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(mx(n.value))return{unaryFilter:{field:zo(n.field),op:"IS_NOT_NAN"}};if(fx(n.value))return{unaryFilter:{field:zo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zo(n.field),op:F2(n.op),value:n.value}}})(t):t instanceof Vr?(function(n){const i=n.getFilters().map((a=>Rw(a)));return i.length===1?i[0]:{compositeFilter:{op:q2(n.op),filters:i}}})(t):ze(54877,{filter:t})}function H2(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function Dw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Ls{constructor(e,n,i,a,l=Ue.min(),u=Ue.min(),f=Sn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new Ls(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ls(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ls(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ls(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class G2{constructor(e){this.yt=e}}function Q2(t){const e=z2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cg(e,e.limit,"L"):e}class $2{constructor(){this.Cn=new K2}addToCollectionParentIndex(e,n){return this.Cn.add(n),ve.resolve()}getCollectionParents(e,n){return ve.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ve.resolve()}deleteFieldIndex(e,n){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,n){return ve.resolve()}getDocumentsMatchingTarget(e,n){return ve.resolve(null)}getIndexType(e,n){return ve.resolve(0)}getFieldIndexes(e,n){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,n){return ve.resolve(Ks.min())}getMinOffsetFromCollectionGroup(e,n){return ve.resolve(Ks.min())}updateCollectionGroup(e,n,i){return ve.resolve()}updateIndexEntries(e,n){return ve.resolve()}}class K2{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new on(bt.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new on(bt.comparator)).toArray()}}const Rx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Iw=41943040;class Fn{static withCacheSize(e){return new Fn(e,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}Fn.DEFAULT_COLLECTION_PERCENTILE=10,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fn.DEFAULT=new Fn(Iw,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fn.DISABLED=new Fn(-1,0,0);class tl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new tl(0)}static cr(){return new tl(-1)}}const Dx="LruGarbageCollector",W2=1048576;function Ix([t,e],[n,i]){const a=Ze(t,n);return a===0?Ze(e,i):a}class Y2{constructor(e){this.Ir=e,this.buffer=new on(Ix),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Ix(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class X2{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ce(Dx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){gl(n)?Ce(Dx,"Ignoring IndexedDB error during garbage collection: ",n):await pl(n)}await this.Vr(3e5)}))}}class J2{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return ve.resolve(Gh.ce);const i=new Y2(n);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ce("LruGarbageCollector","Garbage collection skipped; disabled"),ve.resolve(Rx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Rx):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,u,f,p,g;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,u=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(i=v,f=Date.now(),this.removeTargets(e,i,n)))).next((v=>(l=v,p=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(g=Date.now(),Lo()<=Je.DEBUG&&Ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${a} in `+(f-u)+`ms
	Removed ${l} targets in `+(p-f)+`ms
	Removed ${v} documents in `+(g-p)+`ms
Total Duration: ${g-_}ms`),ve.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:v}))))}}function Z2(t,e){return new J2(t,e)}class e5{constructor(){this.changes=new Ua((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Rn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?ve.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class t5{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class n5{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(i!==null&&Uc(i.mutation,a,nr.empty(),wt.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,et()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=et()){const a=Oa();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,i).next((l=>{let u=kc();return l.forEach(((f,p)=>{u=u.insert(f,p.overlayedDocument)})),u}))))}getOverlayedDocuments(e,n){const i=Oa();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,et())))}populateOverlays(e,n,i){const a=[];return i.forEach((l=>{n.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,f)=>{n.set(u,f)}))}))}computeViews(e,n,i,a){let l=$i();const u=zc(),f=(function(){return zc()})();return n.forEach(((p,g)=>{const _=i.get(g.key);a.has(g.key)&&(_===void 0||_.mutation instanceof ta)?l=l.insert(g.key,g):_!==void 0?(u.set(g.key,_.mutation.getFieldMask()),Uc(_.mutation,g,_.mutation.getFieldMask(),wt.now())):u.set(g.key,nr.empty())})),this.recalculateAndSaveOverlays(e,l).next((p=>(p.forEach(((g,_)=>u.set(g,_))),n.forEach(((g,_)=>f.set(g,new t5(_,u.get(g)??null)))),f)))}recalculateAndSaveOverlays(e,n){const i=zc();let a=new jt(((u,f)=>u-f)),l=et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((u=>{for(const f of u)f.keys().forEach((p=>{const g=n.get(p);if(g===null)return;let _=i.get(p)||nr.empty();_=f.applyToLocalView(g,_),i.set(p,_);const v=(a.get(f.batchId)||et()).add(p);a=a.insert(f.batchId,v)}))})).next((()=>{const u=[],f=a.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),g=p.key,_=p.value,v=hw();_.forEach((x=>{if(!l.has(x)){const w=_w(n.get(x),i.get(x));w!==null&&v.set(x,w),l=l.add(x)}})),u.push(this.documentOverlayCache.saveOverlays(e,g,v))}return ve.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,a){return(function(u){return ke.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):ow(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):ve.resolve(Oa());let f=Gc,p=l;return u.next((g=>ve.forEach(g,((_,v)=>(f<v.largestBatchId&&(f=v.largestBatchId),l.get(_)?ve.resolve():this.remoteDocumentCache.getEntry(e,_).next((x=>{p=p.insert(_,x)}))))).next((()=>this.populateOverlays(e,g,l))).next((()=>this.computeViews(e,p,g,et()))).next((_=>({batchId:f,changes:dw(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ke(n)).next((i=>{let a=kc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let u=kc();return this.indexManager.getCollectionParents(e,l).next((f=>ve.forEach(f,(p=>{const g=(function(v,x){return new ou(x,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,g,i,a).next((_=>{_.forEach(((v,x)=>{u=u.insert(v,x)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a)))).next((u=>{l.forEach(((p,g)=>{const _=g.getKey();u.get(_)===null&&(u=u.insert(_,Rn.newInvalidDocument(_)))}));let f=kc();return u.forEach(((p,g)=>{const _=l.get(p);_!==void 0&&Uc(_.mutation,g,nr.empty(),wt.now()),Wh(n,g)&&(f=f.insert(p,g))})),f}))}}class r5{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ve.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:ci(a.createTime)}})(n)),ve.resolve()}getNamedQuery(e,n){return ve.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:Q2(a.bundledQuery),readTime:ci(a.readTime)}})(n)),ve.resolve()}}class i5{constructor(){this.overlays=new jt(ke.comparator),this.qr=new Map}getOverlay(e,n){return ve.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Oa();return ve.forEach(n,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((a,l)=>{this.St(e,n,l)})),ve.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),ve.resolve()}getOverlaysForCollection(e,n,i){const a=Oa(),l=n.length+1,u=new ke(n.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const p=f.getNext().value,g=p.getKey();if(!n.isPrefixOf(g.path))break;g.path.length===l&&p.largestBatchId>i&&a.set(p.getKey(),p)}return ve.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new jt(((g,_)=>g-_));const u=this.overlays.getIterator();for(;u.hasNext();){const g=u.getNext().value;if(g.getKey().getCollectionGroup()===n&&g.largestBatchId>i){let _=l.get(g.largestBatchId);_===null&&(_=Oa(),l=l.insert(g.largestBatchId,_)),_.set(g.getKey(),g)}}const f=Oa(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((g,_)=>f.set(g,_))),!(f.size()>=a)););return ve.resolve(f)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const u=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new E2(n,i));let l=this.qr.get(n);l===void 0&&(l=et(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}class s5{constructor(){this.sessionToken=Sn.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ve.resolve()}}class ty{constructor(){this.Qr=new on(fn.$r),this.Ur=new on(fn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new fn(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new fn(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new ke(new bt([])),i=new fn(n,e),a=new fn(n,e+1),l=[];return this.Ur.forEachInRange([i,a],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ke(new bt([])),i=new fn(n,e),a=new fn(n,e+1);let l=et();return this.Ur.forEachInRange([i,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const n=new fn(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class fn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ke.comparator(e.key,n.key)||Ze(e.Yr,n.Yr)}static Kr(e,n){return Ze(e.Yr,n.Yr)||ke.comparator(e.key,n.key)}}class a5{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new on(fn.$r)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new x2(l,n,i,a);this.mutationQueue.push(u);for(const f of a)this.Zr=this.Zr.add(new fn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ve.resolve(u)}lookupMutationBatch(e,n){return ve.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return ve.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?Hg:this.tr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new fn(n,0),a=new fn(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(u=>{const f=this.Xr(u.Yr);l.push(f)})),ve.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new on(Ze);return n.forEach((a=>{const l=new fn(a,0),u=new fn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(f=>{i=i.add(f.Yr)}))})),ve.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;ke.isDocumentKey(l)||(l=l.child(""));const u=new fn(new ke(l),0);let f=new on(Ze);return this.Zr.forEachWhile((p=>{const g=p.key.path;return!!i.isPrefixOf(g)&&(g.length===a&&(f=f.add(p.Yr)),!0)}),u),ve.resolve(this.ti(f))}ti(e){const n=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){lt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ve.forEach(n.mutations,(a=>{const l=new fn(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new fn(n,0),a=this.Zr.firstAfterOrEqual(i);return ve.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class o5{constructor(e){this.ri=e,this.docs=(function(){return new jt(ke.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,u=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return ve.resolve(i?i.document.mutableCopy():Rn.newInvalidDocument(n))}getEntries(e,n){let i=$i();return n.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():Rn.newInvalidDocument(a))})),ve.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=$i();const u=n.path,f=new ke(u.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:g,value:{document:_}}=p.getNext();if(!u.isPrefixOf(g.path))break;g.path.length>u.length+1||Nj(Mj(_),i)<=0||(a.has(_.key)||Wh(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return ve.resolve(l)}getAllFromCollectionGroup(e,n,i,a){ze(9500)}ii(e,n){return ve.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new l5(this)}getSize(e){return ve.resolve(this.size)}}class l5 extends e5{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),ve.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class c5{constructor(e){this.persistence=e,this.si=new Ua((n=>$g(n)),Kg),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this.oi=0,this._i=new ty,this.targetCount=0,this.ai=tl.ur()}forEachTarget(e,n){return this.si.forEach(((i,a)=>n(a))),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),ve.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new tl(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ve.resolve()}updateTargetData(e,n){return this.Pr(n),ve.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach(((u,f)=>{f.sequenceNumber<=n&&i.get(f.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ve.waitFor(l).next((()=>a))}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return ve.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),ve.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),ve.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ve.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return ve.resolve(i)}containsKey(e,n){return ve.resolve(this._i.containsKey(n))}}class jw{constructor(e,n){this.ui={},this.overlays={},this.ci=new Gh(0),this.li=!1,this.li=!0,this.hi=new s5,this.referenceDelegate=e(this),this.Pi=new c5(this),this.indexManager=new $2,this.remoteDocumentCache=(function(a){return new o5(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new G2(n),this.Ii=new r5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new i5,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new a5(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){Ce("MemoryPersistence","Starting transaction:",e);const a=new u5(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,n){return ve.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class u5 extends Lj{constructor(e){super(),this.currentSequenceNumber=e}}class ny{constructor(e){this.persistence=e,this.Ri=new ty,this.Vi=null}static mi(e){return new ny(e)}get fi(){if(this.Vi)return this.Vi;throw ze(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),ve.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),ve.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ve.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.fi,(i=>{const a=ke.fromPath(i);return this.gi(e,a).next((l=>{l||n.removeEntry(a,Ue.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return ve.or([()=>ve.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Ch{constructor(e,n){this.persistence=e,this.pi=new Ua((i=>Uj(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=Z2(this,n)}static mi(e,n){return new Ch(e,n)}Ei(){}di(e){return ve.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((a=>i+a))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return ve.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?ve.resolve():n(a)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(u=>this.br(e,u,n).next((f=>{f||(i++,l.removeEntry(u,Ue.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ve.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ve.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ve.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ve.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=rh(e.data.value)),n}br(e,n,i){return ve.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return ve.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ry{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=et(),a=et();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new ry(e,n.fromCache,i,a)}}class d5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class h5{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return tI()?8:Vj(Dn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,n,a,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new d5;return this.Ss(e,n,u).next((f=>{if(l.result=f,this.Vs)return this.bs(e,n,u,f.size)}))})).next((()=>l.result))}bs(e,n,i,a){return i.documentReadCount<this.fs?(Lo()<=Je.DEBUG&&Ce("QueryEngine","SDK will not create cache indexes for query:",Vo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ve.resolve()):(Lo()<=Je.DEBUG&&Ce("QueryEngine","Query:",Vo(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(Lo()<=Je.DEBUG&&Ce("QueryEngine","The SDK decides to create cache indexes for query:",Vo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,li(n))):ve.resolve())}ys(e,n){if(_x(n))return ve.resolve(null);let i=li(n);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=cg(n,null,"F"),i=li(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=et(...l);return this.ps.getDocuments(e,u).next((f=>this.indexManager.getMinOffset(e,i).next((p=>{const g=this.Ds(n,f);return this.Cs(n,g,u,p.readTime)?this.ys(e,cg(n,null,"F")):this.vs(e,g,n,p)}))))})))))}ws(e,n,i,a){return _x(n)||a.isEqual(Ue.min())?ve.resolve(null):this.ps.getDocuments(e,i).next((l=>{const u=this.Ds(n,l);return this.Cs(n,u,i,a)?ve.resolve(null):(Lo()<=Je.DEBUG&&Ce("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Vo(n)),this.vs(e,u,n,kj(a,Gc)).next((f=>f)))}))}Ds(e,n){let i=new on(cw(e));return n.forEach(((a,l)=>{Wh(e,l)&&(i=i.add(l))})),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return Lo()<=Je.DEBUG&&Ce("QueryEngine","Using full collection scan to execute query:",Vo(n)),this.ps.getDocumentsMatchingQuery(e,n,Ks.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(n.forEach((u=>{l=l.insert(u.key,u)})),l)))}}const iy="LocalStore",f5=3e8;class m5{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new jt(Ze),this.xs=new Ua((l=>$g(l)),Kg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new n5(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function p5(t,e,n,i){return new m5(t,e,n,i)}async function Ow(t,e){const n=Fe(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],f=[];let p=et();for(const g of a){u.push(g.batchId);for(const _ of g.mutations)p=p.add(_.key)}for(const g of l){f.push(g.batchId);for(const _ of g.mutations)p=p.add(_.key)}return n.localDocuments.getDocuments(i,p).next((g=>({Ls:g,removedBatchIds:u,addedBatchIds:f})))}))}))}function g5(t,e){const n=Fe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(f,p,g,_){const v=g.batch,x=v.keys();let w=ve.resolve();return x.forEach((A=>{w=w.next((()=>_.getEntry(p,A))).next((I=>{const N=g.docVersions.get(A);lt(N!==null,48541),I.version.compareTo(N)<0&&(v.applyToRemoteDocument(I,g),I.isValidDocument()&&(I.setReadTime(g.commitVersion),_.addEntry(I)))}))})),w.next((()=>f.mutationQueue.removeMutationBatch(p,v)))})(n,i,e,l).next((()=>l.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(f){let p=et();for(let g=0;g<f.mutationResults.length;++g)f.mutationResults[g].transformResults.length>0&&(p=p.add(f.batch.mutations[g].key));return p})(e)))).next((()=>n.localDocuments.getDocuments(i,a)))}))}function kw(t){const e=Fe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function y5(t,e){const n=Fe(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const f=[];e.targetChanges.forEach(((_,v)=>{const x=a.get(v);if(!x)return;f.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,v))));let w=x.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?w=w.withResumeToken(Sn.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):_.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(_.resumeToken,i)),a=a.insert(v,w),(function(I,N,H){return I.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=f5?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0})(x,w,_)&&f.push(n.Pi.updateTargetData(l,w))}));let p=$i(),g=et();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&f.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),f.push(_5(l,u,e.documentUpdates).next((_=>{p=_.ks,g=_.qs}))),!i.isEqual(Ue.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));f.push(_)}return ve.waitFor(f).next((()=>u.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,p,g))).next((()=>p))})).then((l=>(n.Ms=a,l)))}function _5(t,e,n){let i=et(),a=et();return n.forEach((l=>i=i.add(l))),e.getEntries(t,i).next((l=>{let u=$i();return n.forEach(((f,p)=>{const g=l.get(f);p.isFoundDocument()!==g.isFoundDocument()&&(a=a.add(f)),p.isNoDocument()&&p.version.isEqual(Ue.min())?(e.removeEntry(f,p.readTime),u=u.insert(f,p)):!g.isValidDocument()||p.version.compareTo(g.version)>0||p.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(p),u=u.insert(f,p)):Ce(iy,"Ignoring outdated watch update for ",f,". Current version:",g.version," Watch version:",p.version)})),{ks:u,qs:a}}))}function v5(t,e){const n=Fe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Hg),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function b5(t,e){const n=Fe(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return n.Pi.getTargetData(i,e).next((l=>l?(a=l,ve.resolve(a)):n.Pi.allocateTargetId(i).next((u=>(a=new Ls(e,u,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function mg(t,e,n){const i=Fe(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!gl(u))throw u;Ce(iy,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function jx(t,e,n){const i=Fe(t);let a=Ue.min(),l=et();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(p,g,_){const v=Fe(p),x=v.xs.get(_);return x!==void 0?ve.resolve(v.Ms.get(x)):v.Pi.getTargetData(g,_)})(i,u,li(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,f.targetId).next((p=>{l=p}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,n?a:Ue.min(),n?l:et()))).next((f=>(x5(i,s2(e),f),{documents:f,Qs:l})))))}function x5(t,e,n){let i=t.Os.get(e)||Ue.min();n.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),t.Os.set(e,i)}class Ox{constructor(){this.activeTargetIds=d2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class E5{constructor(){this.Mo=new Ox,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ox,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class S5{Oo(e){}shutdown(){}}const kx="ConnectivityMonitor";class Mx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ce(kx,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ce(kx,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Jd=null;function pg(){return Jd===null?Jd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Jd++,"0x"+Jd.toString(16)}const Ip="RestConnection",w5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class T5{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===bh?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const u=pg(),f=this.zo(e,n.toUriEncodedString());Ce(Ip,`Sending RPC '${e}' ${u}:`,f,i);const p={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(p,a,l);const{host:g}=new URL(f),_=hl(g);return this.Jo(e,f,p,i,_).then((v=>(Ce(Ip,`Received RPC '${e}' ${u}: `,v),v)),(v=>{throw Yo(Ip,`RPC '${e}' ${u} failed with error: `,v,"url: ",f,"request:",i),v}))}Ho(e,n,i,a,l,u){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ml})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,n){const i=w5[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class A5{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const An="WebChannelConnection";class C5 extends T5{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const u=pg();return new Promise(((f,p)=>{const g=new PS;g.setWithCredentials(!0),g.listenOnce(LS.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case nh.NO_ERROR:const v=g.getResponseJson();Ce(An,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(v)),f(v);break;case nh.TIMEOUT:Ce(An,`RPC '${e}' ${u} timed out`),p(new we(_e.DEADLINE_EXCEEDED,"Request time out"));break;case nh.HTTP_ERROR:const x=g.getStatus();if(Ce(An,`RPC '${e}' ${u} failed with status:`,x,"response text:",g.getResponseText()),x>0){let w=g.getResponseJson();Array.isArray(w)&&(w=w[0]);const A=w?.error;if(A&&A.status&&A.message){const I=(function(H){const $=H.toLowerCase().replace(/_/g,"-");return Object.values(_e).indexOf($)>=0?$:_e.UNKNOWN})(A.status);p(new we(I,A.message))}else p(new we(_e.UNKNOWN,"Server responded with status "+g.getStatus()))}else p(new we(_e.UNAVAILABLE,"Connection failed."));break;default:ze(9055,{l_:e,streamId:u,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Ce(An,`RPC '${e}' ${u} completed.`)}}));const _=JSON.stringify(a);Ce(An,`RPC '${e}' ${u} sending request:`,a),g.send(n,"POST",_,i,15)}))}T_(e,n,i){const a=pg(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=US(),f=zS(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(p.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(p.useFetchStreams=!0),this.jo(p.initMessageHeaders,n,i),p.encodeInitMessageHeaders=!0;const _=l.join("");Ce(An,`Creating RPC '${e}' stream ${a}: ${_}`,p);const v=u.createWebChannel(_,p);this.I_(v);let x=!1,w=!1;const A=new A5({Yo:N=>{w?Ce(An,`Not sending because RPC '${e}' stream ${a} is closed:`,N):(x||(Ce(An,`Opening RPC '${e}' stream ${a} transport.`),v.open(),x=!0),Ce(An,`RPC '${e}' stream ${a} sending:`,N),v.send(N))},Zo:()=>v.close()}),I=(N,H,$)=>{N.listen(H,(q=>{try{$(q)}catch(me){setTimeout((()=>{throw me}),0)}}))};return I(v,Oc.EventType.OPEN,(()=>{w||(Ce(An,`RPC '${e}' stream ${a} transport opened.`),A.o_())})),I(v,Oc.EventType.CLOSE,(()=>{w||(w=!0,Ce(An,`RPC '${e}' stream ${a} transport closed`),A.a_(),this.E_(v))})),I(v,Oc.EventType.ERROR,(N=>{w||(w=!0,Yo(An,`RPC '${e}' stream ${a} transport errored. Name:`,N.name,"Message:",N.message),A.a_(new we(_e.UNAVAILABLE,"The operation could not be completed")))})),I(v,Oc.EventType.MESSAGE,(N=>{if(!w){const H=N.data[0];lt(!!H,16349);const $=H,q=$?.error||$[0]?.error;if(q){Ce(An,`RPC '${e}' stream ${a} received error:`,q);const me=q.status;let re=(function(D){const R=Jt[D];if(R!==void 0)return bw(R)})(me),he=q.message;re===void 0&&(re=_e.INTERNAL,he="Unknown error status: "+me+" with message "+q.message),w=!0,A.a_(new we(re,he)),v.close()}else Ce(An,`RPC '${e}' stream ${a} received:`,H),A.u_(H)}})),I(f,VS.STAT_EVENT,(N=>{N.stat===ng.PROXY?Ce(An,`RPC '${e}' stream ${a} detected buffering proxy`):N.stat===ng.NOPROXY&&Ce(An,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{A.__()}),0),A}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function jp(){return typeof document<"u"?document:null}function Zh(t){return new j2(t,!0)}class Mw{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&Ce("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Nx="PersistentStream";class Nw{constructor(e,n,i,a,l,u,f,p){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Mw(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===_e.RESOURCE_EXHAUSTED?(Qi(n.toString()),Qi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===_e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===n&&this.G_(i,a)}),(i=>{e((()=>{const a=new we(_e.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ce(Nx,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Ce(Nx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class R5 extends Nw{constructor(e,n,i,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,u),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=M2(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Ue.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Ue.min():u.readTime?ci(u.readTime):Ue.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=fg(this.serializer),n.addTarget=(function(l,u){let f;const p=u.target;if(f=og(p)?{documents:L2(l,p)}:{query:V2(l,p).ft},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=Sw(l,u.resumeToken);const g=ug(l,u.expectedCount);g!==null&&(f.expectedCount=g)}else if(u.snapshotVersion.compareTo(Ue.min())>0){f.readTime=Ah(l,u.snapshotVersion.toTimestamp());const g=ug(l,u.expectedCount);g!==null&&(f.expectedCount=g)}return f})(this.serializer,e);const i=U2(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=fg(this.serializer),n.removeTarget=e,this.q_(n)}}class D5 extends Nw{constructor(e,n,i,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=P2(e.writeResults,e.commitTime),i=ci(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=fg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>N2(this.serializer,i)))};this.q_(n)}}class I5{}class j5 extends I5{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new we(_e.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,dg(n,i),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new we(_e.UNKNOWN,l.toString())}))}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,f])=>this.connection.Ho(e,dg(n,i),a,u,f,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new we(_e.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class O5{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Qi(n),this.aa=!1):Ce("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Va="RemoteStore";class k5{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{Ba(this)&&(Ce(Va,"Restarting streams for network reachability change."),await(async function(p){const g=Fe(p);g.Ea.add(4),await uu(g),g.Ra.set("Unknown"),g.Ea.delete(4),await ef(g)})(this))}))})),this.Ra=new O5(i,a)}}async function ef(t){if(Ba(t))for(const e of t.da)await e(!0)}async function uu(t){for(const e of t.da)await e(!1)}function Pw(t,e){const n=Fe(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),ly(n)?oy(n):yl(n).O_()&&ay(n,e))}function sy(t,e){const n=Fe(t),i=yl(n);n.Ia.delete(e),i.O_()&&Lw(n,e),n.Ia.size===0&&(i.O_()?i.L_():Ba(n)&&n.Ra.set("Unknown"))}function ay(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}yl(t).Y_(e)}function Lw(t,e){t.Va.Ue(e),yl(t).Z_(e)}function oy(t){t.Va=new C2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),yl(t).start(),t.Ra.ua()}function ly(t){return Ba(t)&&!yl(t).x_()&&t.Ia.size>0}function Ba(t){return Fe(t).Ea.size===0}function Vw(t){t.Va=void 0}async function M5(t){t.Ra.set("Online")}async function N5(t){t.Ia.forEach(((e,n)=>{ay(t,e)}))}async function P5(t,e){Vw(t),ly(t)?(t.Ra.ha(e),oy(t)):t.Ra.set("Unknown")}async function L5(t,e,n){if(t.Ra.set("Online"),e instanceof Ew&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const f of l.targetIds)a.Ia.has(f)&&(await a.remoteSyncer.rejectListen(f,u),a.Ia.delete(f),a.Va.removeTarget(f))})(t,e)}catch(i){Ce(Va,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Rh(t,i)}else if(e instanceof ah?t.Va.Ze(e):e instanceof xw?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ue.min()))try{const i=await kw(t.localStore);n.compareTo(i)>=0&&await(function(l,u){const f=l.Va.Tt(u);return f.targetChanges.forEach(((p,g)=>{if(p.resumeToken.approximateByteSize()>0){const _=l.Ia.get(g);_&&l.Ia.set(g,_.withResumeToken(p.resumeToken,u))}})),f.targetMismatches.forEach(((p,g)=>{const _=l.Ia.get(p);if(!_)return;l.Ia.set(p,_.withResumeToken(Sn.EMPTY_BYTE_STRING,_.snapshotVersion)),Lw(l,p);const v=new Ls(_.target,p,g,_.sequenceNumber);ay(l,v)})),l.remoteSyncer.applyRemoteEvent(f)})(t,n)}catch(i){Ce(Va,"Failed to raise snapshot:",i),await Rh(t,i)}}async function Rh(t,e,n){if(!gl(e))throw e;t.Ea.add(1),await uu(t),t.Ra.set("Offline"),n||(n=()=>kw(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ce(Va,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await ef(t)}))}function zw(t,e){return e().catch((n=>Rh(t,n,e)))}async function tf(t){const e=Fe(t),n=Js(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Hg;for(;V5(e);)try{const a=await v5(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,z5(e,a)}catch(a){await Rh(e,a)}Uw(e)&&Bw(e)}function V5(t){return Ba(t)&&t.Ta.length<10}function z5(t,e){t.Ta.push(e);const n=Js(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Uw(t){return Ba(t)&&!Js(t).x_()&&t.Ta.length>0}function Bw(t){Js(t).start()}async function U5(t){Js(t).ra()}async function B5(t){const e=Js(t);for(const n of t.Ta)e.ea(n.mutations)}async function F5(t,e,n){const i=t.Ta.shift(),a=Jg.from(i,e,n);await zw(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await tf(t)}async function q5(t,e){e&&Js(t).X_&&await(async function(i,a){if((function(u){return w2(u)&&u!==_e.ABORTED})(a.code)){const l=i.Ta.shift();Js(i).B_(),await zw(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await tf(i)}})(t,e),Uw(t)&&Bw(t)}async function Px(t,e){const n=Fe(t);n.asyncQueue.verifyOperationInProgress(),Ce(Va,"RemoteStore received new credentials");const i=Ba(n);n.Ea.add(3),await uu(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ef(n)}async function H5(t,e){const n=Fe(t);e?(n.Ea.delete(2),await ef(n)):e||(n.Ea.add(2),await uu(n),n.Ra.set("Unknown"))}function yl(t){return t.ma||(t.ma=(function(n,i,a){const l=Fe(n);return l.sa(),new R5(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:M5.bind(null,t),t_:N5.bind(null,t),r_:P5.bind(null,t),H_:L5.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),ly(t)?oy(t):t.Ra.set("Unknown")):(await t.ma.stop(),Vw(t))}))),t.ma}function Js(t){return t.fa||(t.fa=(function(n,i,a){const l=Fe(n);return l.sa(),new D5(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:U5.bind(null,t),r_:q5.bind(null,t),ta:B5.bind(null,t),na:F5.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await tf(t)):(await t.fa.stop(),t.Ta.length>0&&(Ce(Va,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class cy{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Bi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const u=Date.now()+i,f=new cy(e,n,u,a,l);return f.start(i),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uy(t,e){if(Qi("AsyncQueue",`${e}: ${t}`),gl(t))return new we(_e.UNAVAILABLE,`${e}: ${t}`);throw t}class qo{static emptySet(e){return new qo(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||ke.comparator(n.key,i.key):(n,i)=>ke.comparator(n.key,i.key),this.keyedMap=kc(),this.sortedSet=new jt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof qo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new qo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class Lx{constructor(){this.ga=new jt(ke.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ze(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class nl{constructor(e,n,i,a,l,u,f,p,g){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=g}static fromInitialDocuments(e,n,i,a,l){const u=[];return n.forEach((f=>{u.push({type:0,doc:f})})),new nl(e,n,qo.emptySet(n),u,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}class G5{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Q5{constructor(){this.queries=Vx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=Fe(n),l=a.queries;a.queries=Vx(),l.forEach(((u,f)=>{for(const p of f.Sa)p.onError(i)}))})(this,new we(_e.ABORTED,"Firestore shutting down"))}}function Vx(){return new Ua((t=>lw(t)),Kh)}async function Fw(t,e){const n=Fe(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new G5,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(u){const f=uy(u,`Initialization of query '${Vo(e.query)}' failed`);return void e.onError(f)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&dy(n)}async function qw(t,e){const n=Fe(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function $5(t,e){const n=Fe(t);let i=!1;for(const a of e){const l=a.query,u=n.queries.get(l);if(u){for(const f of u.Sa)f.Fa(a)&&(i=!0);u.wa=a}}i&&dy(n)}function K5(t,e,n){const i=Fe(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function dy(t){t.Ca.forEach((e=>{e.next()}))}var gg,zx;(zx=gg||(gg={})).Ma="default",zx.Cache="cache";class Hw{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new nl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=nl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gg.Cache}}class Gw{constructor(e){this.key=e}}class Qw{constructor(e){this.key=e}}class W5{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=et(),this.mutatedKeys=et(),this.eu=cw(e),this.tu=new qo(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new Lx,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,u=a,f=!1;const p=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,g=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,v)=>{const x=a.get(_),w=Wh(this.query,v)?v:null,A=!!x&&this.mutatedKeys.has(x.key),I=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let N=!1;x&&w?x.data.isEqual(w.data)?A!==I&&(i.track({type:3,doc:w}),N=!0):this.su(x,w)||(i.track({type:2,doc:w}),N=!0,(p&&this.eu(w,p)>0||g&&this.eu(w,g)<0)&&(f=!0)):!x&&w?(i.track({type:0,doc:w}),N=!0):x&&!w&&(i.track({type:1,doc:x}),N=!0,(p||g)&&(f=!0)),N&&(w?(u=u.add(w),l=I?l.add(_):l.delete(_)):(u=u.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:u,iu:i,Cs:f,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((_,v)=>(function(w,A){const I=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ze(20277,{Rt:N})}};return I(w)-I(A)})(_.type,v.type)||this.eu(_.doc,v.doc))),this.ou(i),a=a??!1;const f=n&&!a?this._u():[],p=this.Xa.size===0&&this.current&&!a?1:0,g=p!==this.Za;return this.Za=p,u.length!==0||g?{snapshot:new nl(this.query,e.tu,l,u,e.mutatedKeys,p===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Lx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=et(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new Qw(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new Gw(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=et();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return nl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const hy="SyncEngine";class Y5{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class X5{constructor(e){this.key=e,this.hu=!1}}class J5{constructor(e,n,i,a,l,u){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Ua((f=>lw(f)),Kh),this.Iu=new Map,this.Eu=new Set,this.du=new jt(ke.comparator),this.Au=new Map,this.Ru=new ty,this.Vu={},this.mu=new Map,this.fu=tl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Z5(t,e,n=!0){const i=Jw(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await $w(i,e,n,!0),a}async function eO(t,e){const n=Jw(t);await $w(n,e,!0,!1)}async function $w(t,e,n,i){const a=await b5(t.localStore,li(e)),l=a.targetId,u=t.sharedClientState.addLocalQueryTarget(l,n);let f;return i&&(f=await tO(t,e,l,u==="current",a.resumeToken)),t.isPrimaryClient&&n&&Pw(t.remoteStore,a),f}async function tO(t,e,n,i,a){t.pu=(v,x,w)=>(async function(I,N,H,$){let q=N.view.ru(H);q.Cs&&(q=await jx(I.localStore,N.query,!1).then((({documents:L})=>N.view.ru(L,q))));const me=$&&$.targetChanges.get(N.targetId),re=$&&$.targetMismatches.get(N.targetId)!=null,he=N.view.applyChanges(q,I.isPrimaryClient,me,re);return Bx(I,N.targetId,he.au),he.snapshot})(t,v,x,w);const l=await jx(t.localStore,e,!0),u=new W5(e,l.Qs),f=u.ru(l.documents),p=cu.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),g=u.applyChanges(f,t.isPrimaryClient,p);Bx(t,n,g.au);const _=new Y5(e,n,u);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),g.snapshot}async function nO(t,e,n){const i=Fe(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((u=>!Kh(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await mg(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&sy(i.remoteStore,a.targetId),yg(i,a.targetId)})).catch(pl)):(yg(i,a.targetId),await mg(i.localStore,a.targetId,!0))}async function rO(t,e){const n=Fe(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),sy(n.remoteStore,i.targetId))}async function iO(t,e,n){const i=dO(t);try{const a=await(function(u,f){const p=Fe(u),g=wt.now(),_=f.reduce(((w,A)=>w.add(A.key)),et());let v,x;return p.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let A=$i(),I=et();return p.Ns.getEntries(w,_).next((N=>{A=N,A.forEach(((H,$)=>{$.isValidDocument()||(I=I.add(H))}))})).next((()=>p.localDocuments.getOverlayedDocuments(w,A))).next((N=>{v=N;const H=[];for(const $ of f){const q=v2($,v.get($.key).overlayedDocument);q!=null&&H.push(new ta($.key,q,ew(q.value.mapValue),Lr.exists(!0)))}return p.mutationQueue.addMutationBatch(w,g,H,f)})).next((N=>{x=N;const H=N.applyToLocalDocumentSet(v,I);return p.documentOverlayCache.saveOverlays(w,N.batchId,H)}))})).then((()=>({batchId:x.batchId,changes:dw(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(u,f,p){let g=u.Vu[u.currentUser.toKey()];g||(g=new jt(Ze)),g=g.insert(f,p),u.Vu[u.currentUser.toKey()]=g})(i,a.batchId,n),await du(i,a.changes),await tf(i.remoteStore)}catch(a){const l=uy(a,"Failed to persist write");n.reject(l)}}async function Kw(t,e){const n=Fe(t);try{const i=await y5(n.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=n.Au.get(l);u&&(lt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?lt(u.hu,14607):a.removedDocuments.size>0&&(lt(u.hu,42227),u.hu=!1))})),await du(n,i,e)}catch(i){await pl(i)}}function Ux(t,e,n){const i=Fe(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach(((l,u)=>{const f=u.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(u,f){const p=Fe(u);p.onlineState=f;let g=!1;p.queries.forEach(((_,v)=>{for(const x of v.Sa)x.va(f)&&(g=!0)})),g&&dy(p)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function sO(t,e,n){const i=Fe(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let u=new jt(ke.comparator);u=u.insert(l,Rn.newNoDocument(l,Ue.min()));const f=et().add(l),p=new Jh(Ue.min(),new Map,new jt(Ze),u,f);await Kw(i,p),i.du=i.du.remove(l),i.Au.delete(e),fy(i)}else await mg(i.localStore,e,!1).then((()=>yg(i,e,n))).catch(pl)}async function aO(t,e){const n=Fe(t),i=e.batch.batchId;try{const a=await g5(n.localStore,e);Yw(n,i,null),Ww(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await du(n,a)}catch(a){await pl(a)}}async function oO(t,e,n){const i=Fe(t);try{const a=await(function(u,f){const p=Fe(u);return p.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let _;return p.mutationQueue.lookupMutationBatch(g,f).next((v=>(lt(v!==null,37113),_=v.keys(),p.mutationQueue.removeMutationBatch(g,v)))).next((()=>p.mutationQueue.performConsistencyCheck(g))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(g,_,f))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,_))).next((()=>p.localDocuments.getDocuments(g,_)))}))})(i.localStore,e);Yw(i,e,n),Ww(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await du(i,a)}catch(a){await pl(a)}}function Ww(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Yw(t,e,n){const i=Fe(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function yg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||Xw(t,i)}))}function Xw(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(sy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),fy(t))}function Bx(t,e,n){for(const i of n)i instanceof Gw?(t.Ru.addReference(i.key,e),lO(t,i)):i instanceof Qw?(Ce(hy,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||Xw(t,i.key)):ze(19791,{wu:i})}function lO(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(Ce(hy,"New document in limbo: "+n),t.Eu.add(i),fy(t))}function fy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ke(bt.fromString(e)),i=t.fu.next();t.Au.set(i,new X5(n)),t.du=t.du.insert(n,i),Pw(t.remoteStore,new Ls(li(Wg(n.path)),i,"TargetPurposeLimboResolution",Gh.ce))}}async function du(t,e,n){const i=Fe(t),a=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((f,p)=>{u.push(i.pu(p,e,n).then((g=>{if((g||n)&&i.isPrimaryClient){const _=g?!g.fromCache:n?.targetChanges.get(p.targetId)?.current;i.sharedClientState.updateQueryState(p.targetId,_?"current":"not-current")}if(g){a.push(g);const _=ry.As(p.targetId,g);l.push(_)}})))})),await Promise.all(u),i.Pu.H_(a),await(async function(p,g){const _=Fe(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ve.forEach(g,(x=>ve.forEach(x.Es,(w=>_.persistence.referenceDelegate.addReference(v,x.targetId,w))).next((()=>ve.forEach(x.ds,(w=>_.persistence.referenceDelegate.removeReference(v,x.targetId,w)))))))))}catch(v){if(!gl(v))throw v;Ce(iy,"Failed to update sequence numbers: "+v)}for(const v of g){const x=v.targetId;if(!v.fromCache){const w=_.Ms.get(x),A=w.snapshotVersion,I=w.withLastLimboFreeSnapshotVersion(A);_.Ms=_.Ms.insert(x,I)}}})(i.localStore,l))}async function cO(t,e){const n=Fe(t);if(!n.currentUser.isEqual(e)){Ce(hy,"User change. New user:",e.toKey());const i=await Ow(n.localStore,e);n.currentUser=e,(function(l,u){l.mu.forEach((f=>{f.forEach((p=>{p.reject(new we(_e.CANCELLED,u))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await du(n,i.Ls)}}function uO(t,e){const n=Fe(t),i=n.Au.get(e);if(i&&i.hu)return et().add(i.key);{let a=et();const l=n.Iu.get(e);if(!l)return a;for(const u of l){const f=n.Tu.get(u);a=a.unionWith(f.view.nu)}return a}}function Jw(t){const e=Fe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Kw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=uO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sO.bind(null,e),e.Pu.H_=$5.bind(null,e.eventManager),e.Pu.yu=K5.bind(null,e.eventManager),e}function dO(t){const e=Fe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=aO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=oO.bind(null,e),e}class Dh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return p5(this.persistence,new h5,e.initialUser,this.serializer)}Cu(e){return new jw(ny.mi,this.serializer)}Du(e){return new E5}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Dh.provider={build:()=>new Dh};class hO extends Dh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){lt(this.persistence.referenceDelegate instanceof Ch,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new X2(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Fn.withCacheSize(this.cacheSizeBytes):Fn.DEFAULT;return new jw((i=>Ch.mi(i,n)),this.serializer)}}class _g{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Ux(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=cO.bind(null,this.syncEngine),await H5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Q5})()}createDatastore(e){const n=Zh(e.databaseInfo.databaseId),i=(function(l){return new C5(l)})(e.databaseInfo);return(function(l,u,f,p){return new j5(l,u,f,p)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,a,l,u,f){return new k5(i,a,l,u,f)})(this.localStore,this.datastore,e.asyncQueue,(n=>Ux(this.syncEngine,n,0)),(function(){return Mx.v()?new Mx:new S5})())}createSyncEngine(e,n){return(function(a,l,u,f,p,g,_){const v=new J5(a,l,u,f,p,g);return _&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Fe(n);Ce(Va,"RemoteStore shutting down."),i.Ea.add(5),await uu(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}_g.provider={build:()=>new _g};class Zw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Qi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Zs="FirestoreClient";class fO{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=Cn.UNAUTHENTICATED,this.clientId=qg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{Ce(Zs,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(Ce(Zs,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Bi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=uy(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Op(t,e){t.asyncQueue.verifyOperationInProgress(),Ce(Zs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async a=>{i.isEqual(a)||(await Ow(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Fx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await mO(t);Ce(Zs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>Px(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,a)=>Px(e.remoteStore,a))),t._onlineComponents=e}async function mO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ce(Zs,"Using user provided OfflineComponentProvider");try{await Op(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===_e.FAILED_PRECONDITION||a.code===_e.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;Yo("Error using user provided cache. Falling back to memory cache: "+n),await Op(t,new Dh)}}else Ce(Zs,"Using default OfflineComponentProvider"),await Op(t,new hO(void 0));return t._offlineComponents}async function eT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ce(Zs,"Using user provided OnlineComponentProvider"),await Fx(t,t._uninitializedComponentsProvider._online)):(Ce(Zs,"Using default OnlineComponentProvider"),await Fx(t,new _g))),t._onlineComponents}function pO(t){return eT(t).then((e=>e.syncEngine))}async function tT(t){const e=await eT(t),n=e.eventManager;return n.onListen=Z5.bind(null,e.syncEngine),n.onUnlisten=nO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=eO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=rO.bind(null,e.syncEngine),n}function gO(t,e,n={}){const i=new Bi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,p,g){const _=new Zw({next:x=>{_.Nu(),u.enqueueAndForget((()=>qw(l,v)));const w=x.docs.has(f);!w&&x.fromCache?g.reject(new we(_e.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&x.fromCache&&p&&p.source==="server"?g.reject(new we(_e.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(x)},error:x=>g.reject(x)}),v=new Hw(Wg(f.path),_,{includeMetadataChanges:!0,qa:!0});return Fw(l,v)})(await tT(t),t.asyncQueue,e,n,i))),i.promise}function yO(t,e,n={}){const i=new Bi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,p,g){const _=new Zw({next:x=>{_.Nu(),u.enqueueAndForget((()=>qw(l,v))),x.fromCache&&p.source==="server"?g.reject(new we(_e.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(x)},error:x=>g.reject(x)}),v=new Hw(f,_,{includeMetadataChanges:!0,qa:!0});return Fw(l,v)})(await tT(t),t.asyncQueue,e,n,i))),i.promise}function nT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const qx=new Map;const rT="firestore.googleapis.com",Hx=!0;class Gx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new we(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rT,this.ssl=Hx}else this.host=e.host,this.ssl=e.ssl??Hx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Iw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<W2)throw new we(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Oj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nT(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new we(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new we(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new we(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class nf{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Ej;switch(i.type){case"firstParty":return new Aj(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new we(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=qx.get(n);i&&(Ce("ComponentProvider","Removing Datastore"),qx.delete(n),i.terminate())})(this),Promise.resolve()}}function _O(t,e,n,i={}){t=pi(t,nf);const a=hl(e),l=t._getSettings(),u={...l,emulatorOptions:t._getEmulatorOptions()},f=`${e}:${n}`;a&&(AS(`https://${f}`),CS("Firestore",!0)),l.host!==rT&&l.host!==f&&Yo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p={...l,host:f,ssl:a,emulatorOptions:i};if(!$s(p,u)&&(t._setSettings(p),i.mockUserToken)){let g,_;if(typeof i.mockUserToken=="string")g=i.mockUserToken,_=Cn.MOCK_USER;else{g=QD(i.mockUserToken,t._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new we(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new Cn(v)}t._authCredentials=new Sj(new FS(g,_))}}class _l{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new _l(this.firestore,e,this._query)}}class Ft{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ft(this.firestore,e,this._key)}toJSON(){return{type:Ft._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(au(n,Ft._jsonSchema))return new Ft(e,i||null,new ke(bt.fromString(n.referencePath)))}}Ft._jsonSchemaVersion="firestore/documentReference/1.0",Ft._jsonSchema={type:en("string",Ft._jsonSchemaVersion),referencePath:en("string")};class qs extends _l{constructor(e,n,i){super(e,n,Wg(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ft(this.firestore,null,new ke(e))}withConverter(e){return new qs(this.firestore,e,this._path)}}function vO(t,e,...n){if(t=mn(t),qS("collection","path",e),t instanceof nf){const i=bt.fromString(e,...n);return ix(i),new qs(t,null,i)}{if(!(t instanceof Ft||t instanceof qs))throw new we(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(bt.fromString(e,...n));return ix(i),new qs(t.firestore,null,i)}}function rf(t,e,...n){if(t=mn(t),arguments.length===1&&(e=qg.newId()),qS("doc","path",e),t instanceof nf){const i=bt.fromString(e,...n);return rx(i),new Ft(t,null,new ke(i))}{if(!(t instanceof Ft||t instanceof qs))throw new we(_e.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(bt.fromString(e,...n));return rx(i),new Ft(t.firestore,t instanceof qs?t.converter:null,new ke(i))}}const Qx="AsyncQueue";class $x{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Mw(this,"async_queue_retry"),this._c=()=>{const i=jp();i&&Ce(Qx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=jp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=jp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Bi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!gl(e))throw e;Ce(Qx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Qi("INTERNAL UNHANDLED ERROR: ",Kx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=cy.createAndSchedule(this,e,n,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&ze(47125,{Pc:Kx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Kx(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class vl extends nf{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new $x,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $x(e),this._firestoreClient=void 0,await e}}}function bO(t,e){const n=typeof t=="object"?t:jS(),i=typeof t=="string"?t:bh,a=Bg(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=HD("firestore");l&&_O(a,...l)}return a}function my(t){if(t._terminated)throw new we(_e.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||xO(t),t._firestoreClient}function xO(t){const e=t._freezeSettings(),n=(function(a,l,u,f){return new qj(a,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,nT(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new fO(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(t._componentsProvider))}class br{constructor(e){this._byteString=e}static fromBase64String(e){try{return new br(Sn.fromBase64String(e))}catch(n){throw new we(_e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new br(Sn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:br._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(au(e,br._jsonSchema))return br.fromBase64String(e.bytes)}}br._jsonSchemaVersion="firestore/bytes/1.0",br._jsonSchema={type:en("string",br._jsonSchemaVersion),bytes:en("string")};class sf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new we(_e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new En(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class af{constructor(e){this._methodName=e}}class ui{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new we(_e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new we(_e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ze(this._lat,e._lat)||Ze(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ui._jsonSchemaVersion}}static fromJSON(e){if(au(e,ui._jsonSchema))return new ui(e.latitude,e.longitude)}}ui._jsonSchemaVersion="firestore/geoPoint/1.0",ui._jsonSchema={type:en("string",ui._jsonSchemaVersion),latitude:en("number"),longitude:en("number")};class di{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:di._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(au(e,di._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new di(e.vectorValues);throw new we(_e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}di._jsonSchemaVersion="firestore/vectorValue/1.0",di._jsonSchema={type:en("string",di._jsonSchemaVersion),vectorValues:en("object")};const EO=/^__.*__$/;class SO{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new ta(e,this.data,this.fieldMask,n,this.fieldTransforms):new lu(e,this.data,n,this.fieldTransforms)}}class iT{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new ta(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function sT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ze(40011,{Ac:t})}}class of{constructor(e,n,i,a,l,u){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new of({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ih(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(sT(this.Ac)&&EO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class wO{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||Zh(e)}Cc(e,n,i,a=!1){return new of({Ac:e,methodName:n,Dc:i,path:En.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function py(t){const e=t._freezeSettings(),n=Zh(t._databaseId);return new wO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function TO(t,e,n,i,a,l={}){const u=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);yy("Data must be an object, but it was:",u,i);const f=aT(i,u);let p,g;if(l.merge)p=new nr(u.fieldMask),g=u.fieldTransforms;else if(l.mergeFields){const _=[];for(const v of l.mergeFields){const x=vg(e,v,n);if(!u.contains(x))throw new we(_e.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);lT(_,x)||_.push(x)}p=new nr(_),g=u.fieldTransforms.filter((v=>p.covers(v.field)))}else p=null,g=u.fieldTransforms;return new SO(new qn(f),p,g)}class lf extends af{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lf}}function AO(t,e,n){return new of({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class gy extends af{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=AO(this,e,!0),i=this.vc.map((l=>bl(l,n))),a=new el(i);return new p2(e.path,a)}isEqual(e){return e instanceof gy&&$s(this.vc,e.vc)}}function CO(t,e,n,i){const a=t.Cc(1,e,n);yy("Data must be an object, but it was:",a,i);const l=[],u=qn.empty();ea(i,((p,g)=>{const _=_y(e,p,n);g=mn(g);const v=a.yc(_);if(g instanceof lf)l.push(_);else{const x=bl(g,v);x!=null&&(l.push(_),u.set(_,x))}}));const f=new nr(l);return new iT(u,f,a.fieldTransforms)}function RO(t,e,n,i,a,l){const u=t.Cc(1,e,n),f=[vg(e,i,n)],p=[a];if(l.length%2!=0)throw new we(_e.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<l.length;x+=2)f.push(vg(e,l[x])),p.push(l[x+1]);const g=[],_=qn.empty();for(let x=f.length-1;x>=0;--x)if(!lT(g,f[x])){const w=f[x];let A=p[x];A=mn(A);const I=u.yc(w);if(A instanceof lf)g.push(w);else{const N=bl(A,I);N!=null&&(g.push(w),_.set(w,N))}}const v=new nr(g);return new iT(_,v,u.fieldTransforms)}function DO(t,e,n,i=!1){return bl(n,t.Cc(i?4:3,e))}function bl(t,e){if(oT(t=mn(t)))return yy("Unsupported field value:",e,t),aT(t,e);if(t instanceof af)return(function(i,a){if(!sT(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let u=0;for(const f of i){let p=bl(f,a.wc(u));p==null&&(p={nullValue:"NULL_VALUE"}),l.push(p),u++}return{arrayValue:{values:l}}})(t,e)}return(function(i,a){if((i=mn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return h2(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=wt.fromDate(i);return{timestampValue:Ah(a.serializer,l)}}if(i instanceof wt){const l=new wt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ah(a.serializer,l)}}if(i instanceof ui)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof br)return{bytesValue:Sw(a.serializer,i._byteString)};if(i instanceof Ft){const l=a.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw a.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:ey(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof di)return(function(u,f){return{mapValue:{fields:{[JS]:{stringValue:ZS},[xh]:{arrayValue:{values:u.toArray().map((g=>{if(typeof g!="number")throw f.Sc("VectorValues must only contain numeric values.");return Yg(f.serializer,g)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${Hh(i)}`)})(t,e)}function aT(t,e){const n={};return QS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ea(t,((i,a)=>{const l=bl(a,e.mc(i));l!=null&&(n[i]=l)})),{mapValue:{fields:n}}}function oT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof wt||t instanceof ui||t instanceof br||t instanceof Ft||t instanceof af||t instanceof di)}function yy(t,e,n){if(!oT(n)||!HS(n)){const i=Hh(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function vg(t,e,n){if((e=mn(e))instanceof sf)return e._internalPath;if(typeof e=="string")return _y(t,e);throw Ih("Field path arguments must be of type string or ",t,!1,void 0,n)}const IO=new RegExp("[~\\*/\\[\\]]");function _y(t,e,n){if(e.search(IO)>=0)throw Ih(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new sf(...e.split("."))._internalPath}catch{throw Ih(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ih(t,e,n,i,a){const l=i&&!i.isEmpty(),u=a!==void 0;let f=`Function ${e}() called with invalid data`;n&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(l||u)&&(p+=" (found",l&&(p+=` in field ${i}`),u&&(p+=` in document ${a}`),p+=")"),new we(_e.INVALID_ARGUMENT,f+t+p)}function lT(t,e){return t.some((n=>n.isEqual(e)))}class cT{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new jO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(vy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class jO extends cT{data(){return super.data()}}function vy(t,e){return typeof e=="string"?_y(t,e):e instanceof sf?e._internalPath:e._delegate._internalPath}function OO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new we(_e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class by{}class kO extends by{}function MO(t,e,...n){let i=[];e instanceof by&&i.push(e),i=i.concat(n),(function(l){const u=l.filter((p=>p instanceof xy)).length,f=l.filter((p=>p instanceof cf)).length;if(u>1||u>0&&f>0)throw new we(_e.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)t=a._apply(t);return t}class cf extends kO{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new cf(e,n,i)}_apply(e){const n=this._parse(e);return uT(e._query,n),new _l(e.firestore,e.converter,lg(e._query,n))}_parse(e){const n=py(e.firestore);return(function(l,u,f,p,g,_,v){let x;if(g.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new we(_e.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){Yx(v,_);const A=[];for(const I of v)A.push(Wx(p,l,I));x={arrayValue:{values:A}}}else x=Wx(p,l,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||Yx(v,_),x=DO(f,u,v,_==="in"||_==="not-in");return Zt.create(g,_,x)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function NO(t,e,n){const i=e,a=vy("where",t);return cf._create(a,i,n)}class xy extends by{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new xy(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Vr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,l){let u=a;const f=l.getFlattenedFilters();for(const p of f)uT(u,p),u=lg(u,p)})(e._query,n),new _l(e.firestore,e.converter,lg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Wx(t,e,n){if(typeof(n=mn(n))=="string"){if(n==="")throw new we(_e.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ow(e)&&n.indexOf("/")!==-1)throw new we(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(bt.fromString(n));if(!ke.isDocumentKey(i))throw new we(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return hx(t,new ke(i))}if(n instanceof Ft)return hx(t,n._key);throw new we(_e.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hh(n)}.`)}function Yx(t,e){if(!Array.isArray(t)||t.length===0)throw new we(_e.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uT(t,e){const n=(function(a,l){for(const u of a)for(const f of u.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new we(_e.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new we(_e.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class PO{convertValue(e,n="none"){switch(Xs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ys(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ze(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return ea(e,((a,l)=>{i[a]=this.convertValue(l,n)})),i}convertVectorValue(e){const n=e.fields?.[xh].arrayValue?.values?.map((i=>Bt(i.doubleValue)));return new di(n)}convertGeoPoint(e){return new ui(Bt(e.latitude),Bt(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=$h(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Qc(e));default:return null}}convertTimestamp(e){const n=Ws(e);return new wt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=bt.fromString(e);lt(Dw(i),9688,{name:e});const a=new $c(i.get(1),i.get(3)),l=new ke(i.popFirst(5));return a.isEqual(n)||Qi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function LO(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Nc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ka extends cT{constructor(e,n,i,a,l,u){super(e,n,i,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new oh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(vy("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new we(_e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ka._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ka._jsonSchemaVersion="firestore/documentSnapshot/1.0",ka._jsonSchema={type:en("string",ka._jsonSchemaVersion),bundleSource:en("string","DocumentSnapshot"),bundleName:en("string"),bundle:en("string")};class oh extends ka{data(e={}){return super.data(e)}}class Ho{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Nc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new oh(this._firestore,this._userDataWriter,i.key,i,new Nc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new we(_e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((f=>{const p=new oh(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Nc(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const p=new oh(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Nc(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let g=-1,_=-1;return f.type!==0&&(g=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),_=u.indexOf(f.doc.key)),{type:VO(f.type),doc:p,oldIndex:g,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new we(_e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ho._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=qg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function VO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ze(61501,{type:t})}}function zO(t){t=pi(t,Ft);const e=pi(t.firestore,vl);return gO(my(e),t._key).then((n=>HO(e,t,n)))}Ho._jsonSchemaVersion="firestore/querySnapshot/1.0",Ho._jsonSchema={type:en("string",Ho._jsonSchemaVersion),bundleSource:en("string","QuerySnapshot"),bundleName:en("string"),bundle:en("string")};class dT extends PO{constructor(e){super(),this.firestore=e}convertBytes(e){return new br(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,n)}}function UO(t){t=pi(t,_l);const e=pi(t.firestore,vl),n=my(e),i=new dT(e);return OO(t._query),yO(n,t._query).then((a=>new Ho(e,i,t,a)))}function BO(t,e,n){t=pi(t,Ft);const i=pi(t.firestore,vl),a=LO(t.converter,e,n);return Ey(i,[TO(py(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,Lr.none())])}function FO(t,e,n,...i){t=pi(t,Ft);const a=pi(t.firestore,vl),l=py(a);let u;return u=typeof(e=mn(e))=="string"||e instanceof sf?RO(l,"updateDoc",t._key,e,n,i):CO(l,"updateDoc",t._key,e),Ey(a,[u.toMutation(t._key,Lr.exists(!0))])}function qO(t){return Ey(pi(t.firestore,vl),[new Xg(t._key,Lr.none())])}function Ey(t,e){return(function(i,a){const l=new Bi;return i.asyncQueue.enqueueAndForget((async()=>iO(await pO(i),a,l))),l.promise})(my(t),e)}function HO(t,e,n){const i=n.docs.get(e._key),a=new dT(t);return new ka(t,a,e._key,i,new Nc(n.hasPendingWrites,n.fromCache),e.converter)}function GO(...t){return new gy("arrayUnion",t)}(function(e,n=!0){(function(a){ml=a})(fl),Wo(new Pa("firestore",((i,{instanceIdentifier:a,options:l})=>{const u=i.getProvider("app").getImmediate(),f=new vl(new wj(i.getProvider("auth-internal")),new Cj(u,i.getProvider("app-check-internal")),(function(g,_){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new we(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $c(g.options.projectId,_)})(u,a),u);return l={useFetchStreams:n,...l},f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Bs(Zb,ex,e),Bs(Zb,ex,"esm2020")})();function hu(){return bO(MS)}function fu(t,e,n,i=1,a){{let l=e;if(e.startsWith("budgets/"))l="budgets";else if(e.startsWith("months/")){const p=e.replace("months/","").split("_");if(p.length>=2){const g=p[p.length-1];l=`months/${p[p.length-2]}/${g}`}}console.log(`[Firebase] ${t}(${i}): ${l}${a===!1?" [NOT FOUND]":""}  ${n}`)}}async function Qe(t,e,n){const i=rf(hu(),t,e),a=`${t}/${e}`,l=await zO(i),u=l.exists();return fu("READ",a,n,1,u),{exists:u,data:u?l.data():null,ref:i}}async function Nr(t,e,n){const i=hu(),a=vO(i,t);let l;if(n&&n.length>0){const p=n.map(g=>NO(g.field,g.op,g.value));l=MO(a,...p)}else l=a;const u=await UO(l);let f=t;if(n&&n.length>0){const p=n.map(g=>`${g.field} ${g.op} ${JSON.stringify(g.value)}`).join(", ");f+=` WHERE ${p}`}return fu("QUERY",f,e,u.docs.length),{docs:u.docs.map(p=>({id:p.id,data:p.data()}))}}async function _t(t,e,n,i,a){const l=rf(hu(),t,e),u=`${t}/${e}`;return fu("WRITE",u,i),BO(l,n,a??{})}async function Bo(t,e,n,i){const a=rf(hu(),t,e),l=`${t}/${e}`;return fu("UPDATE",l,i),FO(a,n)}async function Sy(t,e,n){const i=rf(hu(),t,e),a=`${t}/${e}`;return fu("DELETE",a,n),qO(i)}function Fi(t,e,n){const i=n.toString().padStart(2,"0");return`${t}_${e}_${i}`}function wy(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function QO(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}function qi(t,e){return`${t}${e.toString().padStart(2,"0")}`}function $O(){const t=new Date,e=t.getHours().toString().padStart(2,"0"),n=t.getMinutes().toString().padStart(2,"0"),i=t.getSeconds().toString().padStart(2,"0"),a=t.getMilliseconds().toString().padStart(3,"0");return`${e}:${n}:${i}.${a}`}function kp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(t==="")return"(empty)";if(typeof t=="string")return t.length>50?`"${t.slice(0,47)}..."`:`"${t}"`;if(typeof t=="boolean")return t?"true":"false";if(typeof t=="number")return t.toString();if(Array.isArray(t))return`[${t.length} items]`;if(typeof t=="object"){const e=Object.keys(t);return`{${e.slice(0,3).join(", ")}${e.length>3?"...":""}}`}return String(t)}function st(t,e,n){let a=`[${$O()}] [User] ${t}: ${e}`;(n?.value!==void 0||n?.previousValue!==void 0)&&(n.previousValue!==void 0&&n.value!==void 0?a+=` (${kp(n.previousValue)}  ${kp(n.value)})`:n.value!==void 0&&(a+=` = ${kp(n.value)}`)),n?.details&&(a+=`  ${n.details}`),n?.component&&(a+=` [${n.component}]`),console.log(a)}async function Ty(t,e,n){const i=qi(e,n),l=(await Nr("months","getFutureMonths: querying months after specified month",[{field:"budget_id",op:"==",value:t},{field:"year_month_ordinal",op:">",value:i}])).docs.map(u=>({id:u.id,...u.data})).sort((u,f)=>u.year!==f.year?u.year-f.year:u.month-f.month);for(const u of l)Dt.setQueryData(xe.month(t,u.year,u.month),{month:u});return l}function KO(t){const e=xe.budget(t),n=Dt.getQueryData(e);return n?n.isNeedsRecalculation===!0:!1}function WO(t){const e=xe.budget(t),n=Dt.getQueryData(e);n&&Dt.setQueryData(e,{...n,isNeedsRecalculation:!0})}async function YO(t){return KO(t)?!1:(WO(t),await Bo("budgets",t,{is_needs_recalculation:!0,updated_at:new Date().toISOString()},"marking budget as is_needs_recalculation (month data changed)"),!0)}function XO(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??qi(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,is_needs_recalculation:t.is_needs_recalculation??!1,created_at:t.created_at,updated_at:t.updated_at}}async function hT(t,e,n,i){const a={triggerRecalc:!0,...i},l=Fi(t,e,n),f=(await Dt.fetchQuery({queryKey:xe.month(t,e,n),queryFn:async()=>{const{exists:p,data:g}=await Qe("months",l,a.description??`reading month ${e}/${n}`);return!p||!g?null:{month:XO(g,t,e,n)}},staleTime:vS}))?.month??null;if(!f)return null;if(a.triggerRecalc&&f.is_needs_recalculation){const p=qi(e,n);return console.log(`[readMonth] Month ${p} needs recalculation, triggering...`),await Ay(t,{targetMonthOrdinal:p}),await hT(t,e,n,{triggerRecalc:!1,description:"reading recalculated month"})}return f}async function Yi(t,e,n,i){const a=Fi(t,e,n),l=i?`PRE-EDIT-READ: ${i}`:"PRE-EDIT-READ",{exists:u,data:f}=await Qe("months",a,l);if(!u||!f)throw new Error(`Month data not found for ${e}/${n}`);return f}function JO(t){const e={},n={};return t.category_balances&&t.category_balances.forEach(i=>{e[i.category_id]=i.end_balance}),t.account_balances&&t.account_balances.forEach(i=>{n[i.account_id]=i.end_balance}),{categoryEndBalances:e,accountEndBalances:n}}async function ZO(t,e,n){const i=new Date().toISOString(),a=Fi(t,e,n);let l=0,u={},f={};if(n>1||e>new Date().getFullYear()-10){const{year:x,month:w}=wy(e,n),A=Fi(t,x,w),{exists:I,data:N}=await Qe("months",A,"fetching previous month to create start balances for new month");if(I&&N){const H={year_month_ordinal:N.year_month_ordinal??qi(x,w),year:N.year??x,month:N.month??w,income:N.income||[],total_income:N.total_income??0,previous_month_income:N.previous_month_income??0,expenses:N.expenses||[],total_expenses:N.total_expenses??0,account_balances:N.account_balances||[],category_balances:N.category_balances||[],are_allocations_finalized:N.are_allocations_finalized??!1,is_needs_recalculation:N.is_needs_recalculation??!1,created_at:N.created_at,updated_at:N.updated_at};l=H.total_income;const{categoryEndBalances:$,accountEndBalances:q}=JO(H);u=$,f=q}}const p=Object.entries(u).map(([x,w])=>({category_id:x,start_balance:w,allocated:0,spent:0,end_balance:w})),g=Object.entries(f).map(([x,w])=>({account_id:x,start_balance:w,income:0,expenses:0,net_change:0,end_balance:w})),_={budget_id:t,year_month_ordinal:qi(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:l,expenses:[],total_expenses:0,account_balances:g,category_balances:p,are_allocations_finalized:!1,is_needs_recalculation:!1,created_at:i,updated_at:i},v={budget_id:t,year_month_ordinal:qi(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:l,expenses:[],total_expenses:0,account_balances:g,category_balances:p,are_allocations_finalized:!1,is_needs_recalculation:!1,created_at:i,updated_at:i};return await _t("months",a,v,"creating new month document (first time viewing this month)"),Dt.setQueryData(xe.month(t,e,n),{month:_}),_}function ek(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??qi(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,is_needs_recalculation:t.is_needs_recalculation??!1,created_at:t.created_at,updated_at:t.updated_at}}async function Xx(t,e,n){const i=Fi(t,e,n),{exists:a,data:l}=await Qe("months",i,`loading month ${e}/${n}`);return!a||!l?null:ek(l,t,e,n)}async function tk(t,e,n){const i=await Xx(t,e,n);if(i){if(i.is_needs_recalculation){const a=qi(e,n);return console.log(`[useMonthQuery] Month ${a} needs recalculation, triggering...`),await Ay(t,{targetMonthOrdinal:a}),await Xx(t,e,n)||i}return i}return ZO(t,e,n)}function nk(t,e,n,i){return dl({queryKey:t?xe.month(t,e,n):["month","none"],queryFn:async()=>({month:await tk(t,e,n)}),enabled:!!t&&i?.enabled!==!1})}function rk(t,e,n){const i=xe.month(t,e,n),a=Dt.getQueryData(i);return a?.month?a.month.is_needs_recalculation===!0:!1}function ik(t,e){const n=xe.month(t,e.year,e.month),i={...e,is_needs_recalculation:!0};Dt.setQueryData(n,{month:i})}async function sk(t,e,n){const i=await Ty(t,e,n);if(i.length===0)return{markedCount:0,skippedCount:0,totalFutureMonths:0};let a=0,l=0;const u=[];for(const f of i){if(rk(t,f.year,f.month)){l++;continue}ik(t,f),u.push(Bo("months",f.id,{is_needs_recalculation:!0,updated_at:new Date().toISOString()},`marking month ${f.year}/${f.month} as is_needs_recalculation`)),a++}return u.length>0&&await Promise.all(u),{markedCount:a,skippedCount:l,totalFutureMonths:i.length}}const ak={categoryEndBalances:{},accountEndBalances:{},totalIncome:0};function ok(t,e){const n=lk(t.category_balances,e.categoryEndBalances),i=ck(t,e.accountEndBalances);return{...t,previous_month_income:e.totalIncome,category_balances:n,account_balances:i,is_needs_recalculation:!1,updated_at:new Date().toISOString()}}function lk(t,e){const n=new Map;for(const a of t)n.set(a.category_id,a);const i=t.map(a=>{const l=e[a.category_id]??0;return{...a,start_balance:l,end_balance:l+a.allocated-a.spent}});for(const[a,l]of Object.entries(e))n.has(a)||i.push({category_id:a,start_balance:l,allocated:0,spent:0,end_balance:l});return i}function ck(t,e){const n=new Set;for(const a of t.income||[])n.add(a.account_id);for(const a of t.expenses||[])n.add(a.account_id);for(const a of Object.keys(e))n.add(a);for(const a of t.account_balances||[])n.add(a.account_id);const i=[];for(const a of n){const l=e[a]??0,u=(t.income||[]).filter(g=>g.account_id===a).reduce((g,_)=>g+_.amount,0),f=(t.expenses||[]).filter(g=>g.account_id===a).reduce((g,_)=>g+_.amount,0),p=u-f;i.push({account_id:a,start_balance:l,income:u,expenses:f,net_change:p,end_balance:l+p})}return i}function Jx(t){const e={},n={};for(const i of t.category_balances||[])e[i.category_id]=i.end_balance;for(const i of t.account_balances||[])n[i.account_id]=i.end_balance;return{categoryEndBalances:e,accountEndBalances:n,totalIncome:t.total_income}}async function fT(t,e,n){const i=Fi(t,e.year,e.month);await _t("months",i,e,`writeMonthData: ${n}`)}async function mT(t,e,n){await Promise.all([sk(t,e,n),YO(t)])}async function pT(t){const{budgetId:e,month:n,description:i,cascadeRecalculation:a=!0}=t;await fT(e,n,i||`${n.year}/${n.month}`),Dt.setQueryData(xe.month(e,n.year,n.month),{month:n}),a&&await mT(e,n.year,n.month)}function Xi(){const t=ln();return{writeData:sr({mutationFn:async({budgetId:n,month:i,description:a,cascadeRecalculation:l=!0})=>(await fT(n,i,a||`${i.year}/${i.month}`),{budgetId:n,year:i.year,month:i.month,cascadeRecalculation:l}),onMutate:async({budgetId:n,month:i})=>{const a=xe.month(n,i.year,i.month);await t.cancelQueries({queryKey:a});const l=t.getQueryData(a);return t.setQueryData(a,{month:i}),{oldMonthQueryData:l,monthKey:a}},onSuccess:async({budgetId:n,year:i,month:a,cascadeRecalculation:l})=>{l&&await mT(n,i,a)},onError:(n,i,a)=>{a?.oldMonthQueryData&&t.setQueryData(a.monthKey,a.oldMonthQueryData)}})}}function uk(t,e,n,i){const a={};t.category_balances&&t.category_balances.forEach(u=>{a[u.category_id]=u});const l=t.expenses??[];return e.map(u=>{const p=a[u]?.start_balance??0,g=n[u]??0,_=l.filter(v=>v.category_id===u).reduce((v,x)=>v+x.amount,0);return{category_id:u,start_balance:p,allocated:g,spent:_,end_balance:p+g-_}})}function dk(){const{writeData:t}=Xi();return{saveDraftAllocations:async(n,i,a,l)=>{const u=await Yi(n,i,a,"save draft allocations"),f=u.category_balances.map(g=>({...g,allocated:l[g.category_id]??g.allocated})),p={...u,category_balances:f,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:n,month:p,cascadeRecalculation:!1}),{updatedMonth:p}},isPending:t.isPending,isError:t.isError,error:t.error}}function hk(){const{writeData:t}=Xi();return{finalizeAllocations:async n=>{const{budgetId:i,year:a,month:l,allocations:u}=n,f=await Yi(i,a,l,"finalize allocations"),p=f.category_balances?.map(v=>v.category_id)??Object.keys(u),g=p.length>0?uk(f,p,u):f.category_balances,_={...f,category_balances:g,are_allocations_finalized:!0,is_needs_recalculation:!1,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:i,month:_,description:"finalize allocations"}),{updatedMonth:_}},isPending:t.isPending,isError:t.isError,error:t.error}}function fk(){const{writeData:t}=Xi();return{deleteAllocations:async n=>{const{budgetId:i,year:a,month:l}=n,u=await Yi(i,a,l,"delete allocations"),f=u.category_balances.map(g=>({...g,allocated:0,end_balance:g.start_balance-g.spent})),p={...u,category_balances:f,are_allocations_finalized:!1,is_needs_recalculation:!1,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:i,month:p,description:"delete allocations"}),{updatedMonth:p}},isPending:t.isPending,isError:t.isError,error:t.error}}async function uf(t,e,n){const i=e.trim();if(!i||n.includes(i))return null;const a=[...n,i].sort((l,u)=>l.toLowerCase().localeCompare(u.toLowerCase()));return await _t("payees",t,{budget_id:t,payees:a,updated_at:new Date().toISOString()},`adding new payee "${i}" to autocomplete list`),a}function mk(){const t=ln(),{writeData:e}=Xi();return{addIncome:async(i,a,l,u,f,p,g,_)=>{const v=await Yi(i,a,l,"add income"),x={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:u,account_id:f,date:p,created_at:new Date().toISOString()};g?.trim()&&(x.payee=g.trim()),_&&(x.description=_);const w=[...v.income||[],x],A={...v,income:w,total_income:w.reduce((I,N)=>I+N.amount,0),updated_at:new Date().toISOString()};if(await e.mutateAsync({budgetId:i,month:A,description:"add income"}),g?.trim()){const I=t.getQueryData(xe.payees(i))||[],N=await uf(i,g,I);N&&t.setQueryData(xe.payees(i),N)}return{updatedMonth:A,newIncome:x}},isPending:e.isPending,isError:e.isError,error:e.error}}function pk(){const t=ln(),{writeData:e}=Xi();return{updateIncome:async(i,a,l,u,f,p,g,_,v)=>{const x=await Yi(i,a,l,"update income"),w={id:u,amount:f,account_id:p,date:g,created_at:(x.income||[]).find(N=>N.id===u)?.created_at||new Date().toISOString()};_?.trim()&&(w.payee=_.trim()),v&&(w.description=v);const A=(x.income||[]).map(N=>N.id===u?w:N),I={...x,income:A,total_income:A.reduce((N,H)=>N+H.amount,0),updated_at:new Date().toISOString()};if(await e.mutateAsync({budgetId:i,month:I,description:"update income"}),_?.trim()){const N=t.getQueryData(xe.payees(i))||[],H=await uf(i,_,N);H&&t.setQueryData(xe.payees(i),H)}return{updatedMonth:I}},isPending:e.isPending,isError:e.isError,error:e.error}}function gk(){const{writeData:t}=Xi();return{deleteIncome:async(n,i,a,l)=>{const u=await Yi(n,i,a,"delete income"),f=(u.income||[]).filter(g=>g.id!==l),p={...u,income:f,total_income:f.reduce((g,_)=>g+_.amount,0),updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:n,month:p,description:"delete income"}),{updatedMonth:p}},isPending:t.isPending,isError:t.isError,error:t.error}}function yk(){const t=ln(),{writeData:e}=Xi();return{addExpense:async(i,a,l,u,f,p,g,_,v,x)=>{const w=await Yi(i,a,l,"add expense"),A={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:u,category_id:f,account_id:p,date:g,created_at:new Date().toISOString()};_?.trim()&&(A.payee=_.trim()),v&&(A.description=v),x!==void 0&&(A.cleared=x);const I=[...w.expenses||[],A],N={...w,expenses:I,total_expenses:I.reduce((H,$)=>H+$.amount,0),updated_at:new Date().toISOString()};if(await e.mutateAsync({budgetId:i,month:N,description:"add expense"}),_?.trim()){const H=t.getQueryData(xe.payees(i))||[],$=await uf(i,_,H);$&&t.setQueryData(xe.payees(i),$)}return{updatedMonth:N,newExpense:A}},isPending:e.isPending,isError:e.isError,error:e.error}}function _k(){const t=ln(),{writeData:e}=Xi();return{updateExpense:async(i,a,l,u,f,p,g,_,v,x,w)=>{const A=await Yi(i,a,l,"update expense"),I={id:u,amount:f,category_id:p,account_id:g,date:_,created_at:A.expenses?.find($=>$.id===u)?.created_at||new Date().toISOString()};v?.trim()&&(I.payee=v.trim()),x&&(I.description=x),w!==void 0&&(I.cleared=w);const N=(A.expenses||[]).map($=>$.id===u?I:$),H={...A,expenses:N,total_expenses:N.reduce(($,q)=>$+q.amount,0),updated_at:new Date().toISOString()};if(await e.mutateAsync({budgetId:i,month:H,description:"update expense"}),v?.trim()){const $=t.getQueryData(xe.payees(i))||[],q=await uf(i,v,$);q&&t.setQueryData(xe.payees(i),q)}return{updatedMonth:H}},isPending:e.isPending,isError:e.isError,error:e.error}}function vk(){const{writeData:t}=Xi();return{deleteExpense:async(n,i,a,l)=>{const u=await Yi(n,i,a,"delete expense"),f=(u.expenses||[]).filter(g=>g.id!==l),p={...u,expenses:f,total_expenses:f.reduce((g,_)=>g+_.amount,0),updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:n,month:p,description:"delete expense"}),{updatedMonth:p}},isPending:t.isPending,isError:t.isError,error:t.error}}function Mp(t,e){return`${t}${e.toString().padStart(2,"0")}`}async function bk(t){return Ty(t,1900,1)}function xk(t){for(let e=t.length-1;e>=0;e--)if(!t[e].is_needs_recalculation)return e;return-1}async function Ay(t,e={}){const{targetMonthOrdinal:n}=e,i=!n;console.log(`[Recalculation] Starting for budget ${t}`,{trigger:i?"budget":`month ${n}`});const a=await bk(t);if(a.length===0)return console.log("[Recalculation] No months found, nothing to recalculate"),i&&await Sk(t),{monthsRecalculated:0,budgetUpdated:i};const l=xk(a);if(n){const x=l>=0?Mp(a[l].year,a[l].month):"000000";if(x>n)throw new Error(`[Recalculation] Bug detected: Starting point (${x}) is after target month (${n}). This indicates markFutureMonthsNeedRecalculation may have an issue - months before the target are marked as needing recalculation.`)}const u=l+1;let f=a.length-1;if(n){const x=a.findIndex(w=>Mp(w.year,w.month)===n);x>=0&&(f=x)}let p=ak;l>=0&&(p=Jx(a[l])),console.log(`[Recalculation] Recalculating months ${u} to ${f}`,{totalMonths:a.length,startingFrom:l>=0?Mp(a[l].year,a[l].month):"beginning"});let g=0;for(let x=u;x<=f;x++){const w=a[x],A=ok(w,p);await pT({budgetId:t,month:A,description:`recalculating month ${w.year}/${w.month}`,cascadeRecalculation:!1}),p=Jx(A),g++,console.log(`[Recalculation] Completed ${w.year}/${w.month}`)}let _=!1,v;return i&&((g>0?f:l)>=0&&(v=p.accountEndBalances),await Ek(t,v||{}),_=!0),console.log("[Recalculation] Complete",{monthsRecalculated:g,budgetUpdated:_}),{monthsRecalculated:g,budgetUpdated:_,finalAccountBalances:v}}async function Ek(t,e){const{exists:n,data:i}=await Qe("budgets",t,"reading budget for balance update");if(!n||!i){console.warn(`[Recalculation] Budget ${t} not found when updating balances`);return}const a={...i.accounts};for(const[l,u]of Object.entries(e))a[l]&&(a[l]={...a[l],balance:u});await _t("budgets",t,{...i,accounts:a,is_needs_recalculation:!1,updated_at:new Date().toISOString()},"saving recalculated account balances")}async function Sk(t){const{exists:e,data:n}=await Qe("budgets",t,"reading budget to clear recalc flag");!e||!n||await _t("budgets",t,{...n,is_needs_recalculation:!1,updated_at:new Date().toISOString()},"clearing budget recalc flag (no months to recalculate)")}function Zx(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname??"",description:i.description??"",balance:i.balance??0,account_group_id:i.account_group_id??null,sort_order:i.sort_order??0,is_income_account:i.is_income_account??!1,is_income_default:i.is_income_default??!1,is_outgo_account:i.is_outgo_account??!1,is_outgo_default:i.is_outgo_default??!1,on_budget:i.on_budget??!0,is_active:i.is_active??!0}}),e}function wk(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order??0,expected_balance:i.expected_balance??"positive",on_budget:i.on_budget,is_active:i.is_active}}),e}function Tk(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,description:i.description,category_group_id:i.category_group_id??null,sort_order:i.sort_order??0,default_monthly_amount:i.default_monthly_amount,default_monthly_type:i.default_monthly_type,balance:i.balance??0}}),e}function Ak(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,i)=>n.sort_order-i.sort_order),e}async function Ck(t){const{exists:e,data:n}=await Qe("budgets",t,"loading budget data (cache miss or stale)");if(!e||!n)throw new Error(`Budget ${t} not found`);let i=Zx(n.accounts);if(n.is_needs_recalculation??!1){console.log("[Budget] Balances are stale, triggering full recalculation...");const p=await Ay(t),{data:g}=await Qe("budgets",t,"reading budget after recalculation");g&&(i=Zx(g.accounts)),console.log("[Budget] Recalculation complete",{monthsRecalculated:p.monthsRecalculated})}const l=wk(n.account_groups),u=Tk(n.categories),f=Ak(n.category_groups);return{budget:{id:t,name:n.name,user_ids:n.user_ids||[],accepted_user_ids:n.accepted_user_ids||[],owner_id:n.owner_id||n.user_ids?.[0]||"",owner_email:n.owner_email||"",accounts:i,account_groups:l,categories:u,category_groups:f,is_needs_recalculation:!1},accounts:i,accountGroups:l,categories:u,categoryGroups:f,isNeedsRecalculation:!1}}function Rk(t,e){return dl({queryKey:t?xe.budget(t):["budget","none"],queryFn:()=>Ck(t),enabled:!!t&&e?.enabled!==!1})}async function Dk(t){const{exists:e,data:n}=await Qe("payees",t,"loading payees for autocomplete (cache miss or stale)");return e&&n?n.payees||[]:[]}function gT(t,e){return dl({queryKey:t?xe.payees(t):["payees","none"],queryFn:()=>Dk(t),enabled:!!t&&e?.enabled!==!1})}async function Ik(t,e){const{exists:n,data:i}=await Qe("users",t,"loading user profile (cache miss or stale)");if(n&&i)return i;const a={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await _t("users",t,a,"creating new user document (first login)"),a}function jk(t,e,n){return dl({queryKey:t?xe.user(t):["user","none"],queryFn:()=>Ik(t,e),enabled:!!t&&n?.enabled!==!1})}async function Ok(t,e){const n=await Nr("budgets","loading budgets user has access to (cache miss or stale)",[{field:"user_ids",op:"array-contains",value:t}]),i=[],a=[];for(const l of n.docs){const u=l.data;u.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(l.id)?i.push({id:l.id,name:u.name||"Unnamed Budget",ownerEmail:u.owner_email||null,isOwner:u.owner_id===t,isPending:!1}):a.push({budgetId:l.id,budgetName:u.name||"Unnamed Budget",ownerEmail:u.owner_email||null})}return{budgets:i,pendingInvites:a}}function kk(t,e,n){return dl({queryKey:t?xe.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?Ok(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}function Mk(t){if(Array.isArray(t))return t;if(t&&typeof t=="object"&&!Array.isArray(t)){const e=t;if(e._methodName==="arrayUnion"&&Array.isArray(e.vc))return console.warn("[fetchFeedback] Found corrupted arrayUnion in feedback document - extracting items from vc"),e.vc}return[]}async function Nk(){const t=await Nr("feedback","admin loading all feedback (cache miss or stale)"),e=[];for(const n of t.docs){const i=Mk(n.data.items),a=n.data.user_email||n.id;i.forEach(l=>{e.push({...l,doc_id:n.id,user_email:a})})}return{items:e}}function Pk(t){return dl({queryKey:xe.feedback(),queryFn:Nk,enabled:t?.enabled!==!1})}async function Lk(t,e){return Dt.fetchQuery({queryKey:["budgetInvite",t,e],queryFn:async()=>{const{exists:n,data:i}=await Qe("budgets",t,"checking if user has pending invite for budget");return!n||!i?null:{isInvited:i.user_ids?.includes(e)??!1,hasAccepted:i.accepted_user_ids?.includes(e)??!1,budgetName:i.name||"Unnamed Budget",ownerEmail:i.owner_email||null}},staleTime:60*1e3})}async function bg(t,e,n){const i=await hT(t,e,n,{description:`fetching month for balance calculation (walking ${e}/${n})`});return i?{year:i.year,month:i.month,category_balances:i.category_balances,is_needs_recalculation:i.is_needs_recalculation,are_allocations_finalized:i.are_allocations_finalized,expenses:i.expenses}:null}async function Vk(t,e,n,i){const a={};e.forEach(x=>{a[x]=0});const l=await bg(t,n,i);if(l?.category_balances&&!l.is_needs_recalculation){for(const x of l.category_balances)e.includes(x.category_id)&&(a[x.category_id]=x.end_balance);return a}const u={};e.forEach(x=>{u[x]=0});const f=[];l&&f.push(l);let p=n,g=i,_=!1;const v=120;for(let x=0;x<v&&!_;x++){const w=wy(p,g);p=w.year,g=w.month;const A=await bg(t,p,g);if(!A)_=!0;else if(A.category_balances&&!A.is_needs_recalculation){_=!0;for(const I of A.category_balances)e.includes(I.category_id)&&(u[I.category_id]=I.end_balance)}else f.push(A)}f.reverse(),Object.assign(a,u);for(const x of f){if(x.are_allocations_finalized&&x.category_balances)for(const w of x.category_balances)e.includes(w.category_id)&&(a[w.category_id]=(a[w.category_id]||0)+w.allocated);if(x.expenses)for(const w of x.expenses)e.includes(w.category_id)&&(a[w.category_id]=(a[w.category_id]||0)-w.amount)}return a}async function zk(t,e,n,i,a){const l={...n};let u=i,f=a;const p=24;for(let g=0;g<p;g++){const _=QO(u,f);u=_.year,f=_.month;const v=await bg(t,u,f);if(!v)break;if(v.are_allocations_finalized&&v.category_balances)for(const x of v.category_balances)e.includes(x.category_id)&&(l[x.category_id]=(l[x.category_id]||0)+x.allocated);if(v.expenses)for(const x of v.expenses)e.includes(x.category_id)&&(l[x.category_id]=(l[x.category_id]||0)-x.amount)}return l}async function eE(t,e,n,i){const a=await Vk(t,e,n,i),l=await zk(t,e,a,n,i);return{current:a,total:l}}function yT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Uk=yT,_T=new iu("auth","Firebase",yT());const jh=new zg("@firebase/auth");function Bk(t,...e){jh.logLevel<=Je.WARN&&jh.warn(`Auth (${fl}): ${t}`,...e)}function lh(t,...e){jh.logLevel<=Je.ERROR&&jh.error(`Auth (${fl}): ${t}`,...e)}function zr(t,...e){throw Cy(t,...e)}function hi(t,...e){return Cy(t,...e)}function vT(t,e,n){const i={...Uk(),[e]:n};return new iu("auth","Firebase",i).create(e,{appName:t.name})}function Hs(t){return vT(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Cy(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return _T.create(t,...e)}function Ve(t,e,...n){if(!t)throw Cy(e,...n)}function Li(t){const e="INTERNAL ASSERTION FAILED: "+t;throw lh(e),new Error(e)}function Ki(t,e){t||Li(e)}function xg(){return typeof self<"u"&&self.location?.href||""}function Fk(){return tE()==="http:"||tE()==="https:"}function tE(){return typeof self<"u"&&self.location?.protocol||null}function qk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Fk()||JD()||"connection"in navigator)?navigator.onLine:!0}function Hk(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class mu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ki(n>e,"Short delay should be less than long delay!"),this.isMobile=WD()||ZD()}get(){return qk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ry(t,e){Ki(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class bT{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Li("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Li("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Li("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Gk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Qk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],$k=new mu(3e4,6e4);function Fa(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function na(t,e,n,i,a={}){return xT(t,a,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const f=su({key:t.config.apiKey,...u}).slice(1),p=await t._getAdditionalHeaders();p["Content-Type"]="application/json",t.languageCode&&(p["X-Firebase-Locale"]=t.languageCode);const g={method:e,headers:p,...l};return XD()||(g.referrerPolicy="no-referrer"),t.emulatorConfig&&hl(t.emulatorConfig.host)&&(g.credentials="include"),bT.fetch()(await ET(t,t.config.apiHost,n,f),g)})}async function xT(t,e,n){t._canInitEmulator=!1;const i={...Gk,...e};try{const a=new Wk(t),l=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw Zd(t,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const f=l.ok?u.errorMessage:u.error.message,[p,g]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zd(t,"credential-already-in-use",u);if(p==="EMAIL_EXISTS")throw Zd(t,"email-already-in-use",u);if(p==="USER_DISABLED")throw Zd(t,"user-disabled",u);const _=i[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw vT(t,_,g);zr(t,_)}}catch(a){if(a instanceof Wi)throw a;zr(t,"network-request-failed",{message:String(a)})}}async function df(t,e,n,i,a={}){const l=await na(t,e,n,i,a);return"mfaPendingCredential"in l&&zr(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function ET(t,e,n,i){const a=`${e}${n}?${i}`,l=t,u=l.config.emulator?Ry(t.config,a):`${t.config.apiScheme}://${a}`;return Qk.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function Kk(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Wk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(hi(this.auth,"network-request-failed")),$k.get())})}}function Zd(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=hi(t,e,i);return a.customData._tokenResponse=n,a}function nE(t){return t!==void 0&&t.enterprise!==void 0}class Yk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Kk(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Xk(t,e){return na(t,"GET","/v2/recaptchaConfig",Fa(t,e))}async function Jk(t,e){return na(t,"POST","/v1/accounts:delete",e)}async function Oh(t,e){return na(t,"POST","/v1/accounts:lookup",e)}function Bc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Zk(t,e=!1){const n=mn(t),i=await n.getIdToken(e),a=Dy(i);Ve(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:i,authTime:Bc(Np(a.auth_time)),issuedAtTime:Bc(Np(a.iat)),expirationTime:Bc(Np(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Np(t){return Number(t)*1e3}function Dy(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return lh("JWT malformed, contained fewer than 3 sections"),null;try{const a=ES(n);return a?JSON.parse(a):(lh("Failed to decode base64 JWT payload"),null)}catch(a){return lh("Caught error parsing JWT payload as JSON",a?.toString()),null}}function rE(t){const e=Dy(t);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Yc(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Wi&&eM(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function eM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class tM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Eg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bc(this.lastLoginAt),this.creationTime=Bc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function kh(t){const e=t.auth,n=await t.getIdToken(),i=await Yc(t,Oh(e,{idToken:n}));Ve(i?.users.length,e,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=a.providerUserInfo?.length?ST(a.providerUserInfo):[],u=rM(t.providerData,l),f=t.isAnonymous,p=!(t.email&&a.passwordHash)&&!u?.length,g=f?p:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new Eg(a.createdAt,a.lastLoginAt),isAnonymous:g};Object.assign(t,_)}async function nM(t){const e=mn(t);await kh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function rM(t,e){return[...t.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function ST(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function iM(t,e){const n=await xT(t,{},async()=>{const i=su({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,u=await ET(t,a,"/v1/token",`key=${l}`),f=await t._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:i};return t.emulatorConfig&&hl(t.emulatorConfig.host)&&(p.credentials="include"),bT.fetch()(u,p)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function sM(t,e){return na(t,"POST","/v2/accounts:revokeToken",Fa(t,e))}class Go{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ve(e.length!==0,"internal-error");const n=rE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:a,expiresIn:l}=await iM(e,n);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:a,expirationTime:l}=n,u=new Go;return i&&(Ve(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),a&&(Ve(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(Ve(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Go,this.toJSON())}_performRefresh(){return Li("not implemented")}}function js(t,e){Ve(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Pr{constructor({uid:e,auth:n,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new tM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Eg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await Yc(this,this.stsTokenManager.getToken(this.auth,e));return Ve(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Zk(this,e)}reload(){return nM(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Pr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await kh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mr(this.auth.app))return Promise.reject(Hs(this.auth));const e=await this.getIdToken();return await Yc(this,Jk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,a=n.email??void 0,l=n.phoneNumber??void 0,u=n.photoURL??void 0,f=n.tenantId??void 0,p=n._redirectEventId??void 0,g=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:v,emailVerified:x,isAnonymous:w,providerData:A,stsTokenManager:I}=n;Ve(v&&I,e,"internal-error");const N=Go.fromJSON(this.name,I);Ve(typeof v=="string",e,"internal-error"),js(i,e.name),js(a,e.name),Ve(typeof x=="boolean",e,"internal-error"),Ve(typeof w=="boolean",e,"internal-error"),js(l,e.name),js(u,e.name),js(f,e.name),js(p,e.name),js(g,e.name),js(_,e.name);const H=new Pr({uid:v,auth:e,email:a,emailVerified:x,displayName:i,isAnonymous:w,photoURL:u,phoneNumber:l,tenantId:f,stsTokenManager:N,createdAt:g,lastLoginAt:_});return A&&Array.isArray(A)&&(H.providerData=A.map($=>({...$}))),p&&(H._redirectEventId=p),H}static async _fromIdTokenResponse(e,n,i=!1){const a=new Go;a.updateFromServerResponse(n);const l=new Pr({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await kh(l),l}static async _fromGetAccountInfoResponse(e,n,i){const a=n.users[0];Ve(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?ST(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,f=new Go;f.updateFromIdToken(i);const p=new Pr({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:u}),g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Eg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(p,g),p}}const iE=new Map;function Vi(t){Ki(t instanceof Function,"Expected a class definition");let e=iE.get(t);return e?(Ki(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,iE.set(t,e),e)}class wT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}wT.type="NONE";const sE=wT;function ch(t,e,n){return`firebase:${t}:${e}:${n}`}class Qo{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=ch(this.userKey,a.apiKey,l),this.fullPersistenceKey=ch("persistence",a.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Oh(this.auth,{idToken:e}).catch(()=>{});return n?Pr._fromGetAccountInfoResponse(this.auth,n,e):null}return Pr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Qo(Vi(sE),e,i);const a=(await Promise.all(n.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let l=a[0]||Vi(sE);const u=ch(i,e.config.apiKey,e.name);let f=null;for(const g of n)try{const _=await g._get(u);if(_){let v;if(typeof _=="string"){const x=await Oh(e,{idToken:_}).catch(()=>{});if(!x)break;v=await Pr._fromGetAccountInfoResponse(e,x,_)}else v=Pr._fromJSON(e,_);g!==l&&(f=v),l=g;break}}catch{}const p=a.filter(g=>g._shouldAllowMigration);return!l._shouldAllowMigration||!p.length?new Qo(l,e,i):(l=p[0],f&&await l._set(u,f.toJSON()),await Promise.all(n.map(async g=>{if(g!==l)try{await g._remove(u)}catch{}})),new Qo(l,e,i))}}function aE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(TT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IT(e))return"Blackberry";if(jT(e))return"Webos";if(AT(e))return"Safari";if((e.includes("chrome/")||CT(e))&&!e.includes("edge/"))return"Chrome";if(DT(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function TT(t=Dn()){return/firefox\//i.test(t)}function AT(t=Dn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function CT(t=Dn()){return/crios\//i.test(t)}function RT(t=Dn()){return/iemobile/i.test(t)}function DT(t=Dn()){return/android/i.test(t)}function IT(t=Dn()){return/blackberry/i.test(t)}function jT(t=Dn()){return/webos/i.test(t)}function Iy(t=Dn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function aM(t=Dn()){return Iy(t)&&!!window.navigator?.standalone}function oM(){return eI()&&document.documentMode===10}function OT(t=Dn()){return Iy(t)||DT(t)||jT(t)||IT(t)||/windows phone/i.test(t)||RT(t)}function kT(t,e=[]){let n;switch(t){case"Browser":n=aE(Dn());break;case"Worker":n=`${aE(Dn())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${fl}/${i}`}class lM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=l=>new Promise((u,f)=>{try{const p=e(l);u(p)}catch(p){f(p)}});i.onAbort=n,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function cM(t,e={}){return na(t,"GET","/v2/passwordPolicy",Fa(t,e))}const uM=6;class dM{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??uM,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class hM{constructor(e,n,i,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new oE(this),this.idTokenSubscription=new oE(this),this.beforeStateQueue=new lM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_T,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Vi(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Qo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Oh(this,{idToken:e}),i=await Pr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Mr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=i?._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===u)&&f?.user&&(i=f.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await kh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Hk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mr(this.app))return Promise.reject(Hs(this));const n=e?mn(e):null;return n&&Ve(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mr(this.app)?Promise.reject(Hs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mr(this.app)?Promise.reject(Hs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Vi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await cM(this),n=new dM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new iu("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await sM(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Vi(e)||this._popupRedirectResolver;Ve(n,this,"argument-error"),this.redirectPersistenceManager=await Qo.create(this,[Vi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,a){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let u=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(f,this,"internal-error"),f.then(()=>{u||l(this.currentUser)}),typeof n=="function"){const p=e.addObserver(n,i,a);return()=>{u=!0,p()}}else{const p=e.addObserver(n);return()=>{u=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Bk(`Error while retrieving App Check token: ${e.error}`),e?.token}}function xl(t){return mn(t)}class oE{constructor(e){this.auth=e,this.observer=null,this.addObserver=lI(n=>this.observer=n)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let hf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function fM(t){hf=t}function MT(t){return hf.loadJS(t)}function mM(){return hf.recaptchaEnterpriseScript}function pM(){return hf.gapiScript}function gM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class yM{constructor(){this.enterprise=new _M}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class _M{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const vM="recaptcha-enterprise",NT="NO_RECAPTCHA";class bM{constructor(e){this.type=vM,this.auth=xl(e)}async verify(e="verify",n=!1){async function i(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,f)=>{Xk(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const g=new Yk(p);return l.tenantId==null?l._agentRecaptchaConfig=g:l._tenantRecaptchaConfigs[l.tenantId]=g,u(g.siteKey)}}).catch(p=>{f(p)})})}function a(l,u,f){const p=window.grecaptcha;nE(p)?p.enterprise.ready(()=>{p.enterprise.execute(l,{action:e}).then(g=>{u(g)}).catch(()=>{u(NT)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new yM().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(f=>{if(!n&&nE(window.grecaptcha))a(f,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let p=mM();p.length!==0&&(p+=f),MT(p).then(()=>{a(f,l,u)}).catch(g=>{u(g)})}}).catch(f=>{u(f)})})}}async function lE(t,e,n,i=!1,a=!1){const l=new bM(t);let u;if(a)u=NT;else try{u=await l.verify(n)}catch{u=await l.verify(n,!0)}const f={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,g=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:u}):Object.assign(f,{captchaResponse:u}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function cE(t,e,n,i,a){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await lE(t,e,n,n==="getOobCode");return i(t,l)}else return i(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await lE(t,e,n,n==="getOobCode");return i(t,u)}else return Promise.reject(l)})}function xM(t,e){const n=Bg(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),l=n.getOptions();if($s(l,e??{}))return a;zr(a,"already-initialized")}return n.initialize({options:e})}function EM(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(Vi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function SM(t,e,n){const i=xl(t);Ve(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=PT(e),{host:u,port:f}=wM(e),p=f===null?"":`:${f}`,g={url:`${l}//${u}${p}/`},_=Object.freeze({host:u,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Ve(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ve($s(g,i.config.emulator)&&$s(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,hl(u)?(AS(`${l}//${u}${p}`),CS("Auth",!0)):TM()}function PT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function wM(t){const e=PT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:uE(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:uE(u)}}}function uE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function TM(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class jy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Li("not implemented")}_getIdTokenResponse(e){return Li("not implemented")}_linkToIdToken(e,n){return Li("not implemented")}_getReauthenticationResolver(e){return Li("not implemented")}}async function AM(t,e){return na(t,"POST","/v1/accounts:signUp",e)}async function CM(t,e){return df(t,"POST","/v1/accounts:signInWithPassword",Fa(t,e))}async function RM(t,e){return df(t,"POST","/v1/accounts:signInWithEmailLink",Fa(t,e))}async function DM(t,e){return df(t,"POST","/v1/accounts:signInWithEmailLink",Fa(t,e))}class Xc extends jy{constructor(e,n,i,a=null){super("password",i),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new Xc(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new Xc(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cE(e,n,"signInWithPassword",CM);case"emailLink":return RM(e,{email:this._email,oobCode:this._password});default:zr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cE(e,i,"signUpPassword",AM);case"emailLink":return DM(e,{idToken:n,email:this._email,oobCode:this._password});default:zr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function $o(t,e){return df(t,"POST","/v1/accounts:signInWithIdp",Fa(t,e))}const IM="http://localhost";class za extends jy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new za(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):zr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=n;if(!i||!a)return null;const u=new za(i,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const n=this.buildRequest();return $o(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,$o(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,$o(e,n)}buildRequest(){const e={requestUri:IM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=su(n)}return e}}function jM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function OM(t){const e=Ic(jc(t)).link,n=e?Ic(jc(e)).deep_link_id:null,i=Ic(jc(t)).deep_link_id;return(i?Ic(jc(i)).link:null)||i||n||e||t}class Oy{constructor(e){const n=Ic(jc(e)),i=n.apiKey??null,a=n.oobCode??null,l=jM(n.mode??null);Ve(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=OM(e);try{return new Oy(n)}catch{return null}}}class El{constructor(){this.providerId=El.PROVIDER_ID}static credential(e,n){return Xc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Oy.parseLink(n);return Ve(i,"argument-error"),Xc._fromEmailAndCode(e,i.code,i.tenantId)}}El.PROVIDER_ID="password";El.EMAIL_PASSWORD_SIGN_IN_METHOD="password";El.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class LT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class pu extends LT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ks extends pu{constructor(){super("facebook.com")}static credential(e){return za._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ks.credential(e.oauthAccessToken)}catch{return null}}}ks.FACEBOOK_SIGN_IN_METHOD="facebook.com";ks.PROVIDER_ID="facebook.com";class Ms extends pu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return za._fromParams({providerId:Ms.PROVIDER_ID,signInMethod:Ms.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ms.credentialFromTaggedObject(e)}static credentialFromError(e){return Ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return Ms.credential(n,i)}catch{return null}}}Ms.GOOGLE_SIGN_IN_METHOD="google.com";Ms.PROVIDER_ID="google.com";class Ns extends pu{constructor(){super("github.com")}static credential(e){return za._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ns.credentialFromTaggedObject(e)}static credentialFromError(e){return Ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ns.credential(e.oauthAccessToken)}catch{return null}}}Ns.GITHUB_SIGN_IN_METHOD="github.com";Ns.PROVIDER_ID="github.com";class Ps extends pu{constructor(){super("twitter.com")}static credential(e,n){return za._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Ps.credential(n,i)}catch{return null}}}Ps.TWITTER_SIGN_IN_METHOD="twitter.com";Ps.PROVIDER_ID="twitter.com";class rl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,a=!1){const l=await Pr._fromIdTokenResponse(e,i,a),u=dE(i);return new rl({user:l,providerId:u,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const a=dE(i);return new rl({user:e,providerId:a,_tokenResponse:i,operationType:n})}}function dE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Mh extends Wi{constructor(e,n,i,a){super(n.code,n.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Mh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,a){return new Mh(e,n,i,a)}}function VT(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Mh._fromErrorAndOperation(t,l,e,i):l})}async function kM(t,e,n=!1){const i=await Yc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return rl._forOperation(t,"link",i)}async function MM(t,e,n=!1){const{auth:i}=t;if(Mr(i.app))return Promise.reject(Hs(i));const a="reauthenticate";try{const l=await Yc(t,VT(i,a,e,t),n);Ve(l.idToken,i,"internal-error");const u=Dy(l.idToken);Ve(u,i,"internal-error");const{sub:f}=u;return Ve(t.uid===f,i,"user-mismatch"),rl._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&zr(i,"user-mismatch"),l}}async function zT(t,e,n=!1){if(Mr(t.app))return Promise.reject(Hs(t));const i="signIn",a=await VT(t,i,e),l=await rl._fromIdTokenResponse(t,i,a);return n||await t._updateCurrentUser(l.user),l}async function NM(t,e){return zT(xl(t),e)}async function PM(t){const e=xl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function LM(t,e,n){return Mr(t.app)?Promise.reject(Hs(t)):NM(mn(t),El.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&PM(t),i})}function VM(t,e,n,i){return mn(t).onIdTokenChanged(e,n,i)}function zM(t,e,n){return mn(t).beforeAuthStateChanged(e,n)}function UM(t,e,n,i){return mn(t).onAuthStateChanged(e,n,i)}function BM(t){return mn(t).signOut()}const Nh="__sak";class UT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Nh,"1"),this.storage.removeItem(Nh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const FM=1e3,qM=10;class BT extends UT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=OT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),a=this.localCache[n];i!==a&&e(n,a,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((u,f,p)=>{this.notifyListeners(u,p)});return}const i=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(i);!n&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);oM()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,qM):a()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},FM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}BT.type="LOCAL";const HM=BT;class FT extends UT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}FT.type="SESSION";const qT=FT;function GM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class ff{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const i=new ff(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:a,data:l}=n.data,u=this.handlersMap[a];if(!u?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const f=Array.from(u).map(async g=>g(n.origin,l)),p=await GM(f);n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:p})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ff.receivers=[];function ky(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class QM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((f,p)=>{const g=ky("",20);a.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},i);u={messageChannel:a,onMessage(v){const x=v;if(x.data.eventId===g)switch(x.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(x.data.response);break;default:clearTimeout(_),clearTimeout(l),p(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:g,data:n},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function fi(){return window}function $M(t){fi().location.href=t}function HT(){return typeof fi().WorkerGlobalScope<"u"&&typeof fi().importScripts=="function"}async function KM(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function WM(){return navigator?.serviceWorker?.controller||null}function YM(){return HT()?self:null}const GT="firebaseLocalStorageDb",XM=1,Ph="firebaseLocalStorage",QT="fbase_key";class gu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function mf(t,e){return t.transaction([Ph],e?"readwrite":"readonly").objectStore(Ph)}function JM(){const t=indexedDB.deleteDatabase(GT);return new gu(t).toPromise()}function Sg(){const t=indexedDB.open(GT,XM);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Ph,{keyPath:QT})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Ph)?e(i):(i.close(),await JM(),e(await Sg()))})})}async function hE(t,e,n){const i=mf(t,!0).put({[QT]:e,value:n});return new gu(i).toPromise()}async function ZM(t,e){const n=mf(t,!1).get(e),i=await new gu(n).toPromise();return i===void 0?null:i.value}function fE(t,e){const n=mf(t,!0).delete(e);return new gu(n).toPromise()}const eN=800,tN=3;class $T{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>tN)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return HT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ff._getInstance(YM()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await KM(),!this.activeServiceWorker)return;this.sender=new QM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||WM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sg();return await hE(e,Nh,"1"),await fE(e,Nh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>hE(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>ZM(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>fE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=mf(a,!1).getAll();return new gu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),eN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$T.type="LOCAL";const nN=$T;new mu(3e4,6e4);function rN(t,e){return e?Vi(e):(Ve(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class My extends jy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return $o(e,this._buildIdpRequest())}_linkToIdToken(e,n){return $o(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return $o(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function iN(t){return zT(t.auth,new My(t),t.bypassAuthState)}function sN(t){const{auth:e,user:n}=t;return Ve(n,e,"internal-error"),MM(n,new My(t),t.bypassAuthState)}async function aN(t){const{auth:e,user:n}=t;return Ve(n,e,"internal-error"),kM(n,new My(t),t.bypassAuthState)}class KT{constructor(e,n,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:a,tenantId:l,error:u,type:f}=e;if(u){this.reject(u);return}const p={auth:this.auth,requestUri:n,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iN;case"linkViaPopup":case"linkViaRedirect":return aN;case"reauthViaPopup":case"reauthViaRedirect":return sN;default:zr(this.auth,"internal-error")}}resolve(e){Ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const oN=new mu(2e3,1e4);class Fo extends KT{constructor(e,n,i,a,l){super(e,n,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Fo.currentPopupAction&&Fo.currentPopupAction.cancel(),Fo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ve(e,this.auth,"internal-error"),e}async onExecution(){Ki(this.filter.length===1,"Popup operations only handle one event");const e=ky();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(hi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(hi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Fo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(hi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oN.get())};e()}}Fo.currentPopupAction=null;const lN="pendingRedirect",uh=new Map;class cN extends KT{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=uh.get(this.auth._key());if(!e){try{const i=await uN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}uh.set(this.auth._key(),e)}return this.bypassAuthState||uh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uN(t,e){const n=fN(e),i=hN(t);if(!await i._isAvailable())return!1;const a=await i._get(n)==="true";return await i._remove(n),a}function dN(t,e){uh.set(t._key(),e)}function hN(t){return Vi(t._redirectPersistence)}function fN(t){return ch(lN,t.config.apiKey,t.name)}async function mN(t,e,n=!1){if(Mr(t.app))return Promise.reject(Hs(t));const i=xl(t),a=rN(i,e),u=await new cN(i,a,n).execute();return u&&!n&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}const pN=600*1e3;class gN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!yN(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!WT(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(hi(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=pN&&this.cachedEventUids.clear(),this.cachedEventUids.has(mE(e))}saveEventToCache(e){this.cachedEventUids.add(mE(e)),this.lastProcessedEventTime=Date.now()}}function mE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function WT({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function yN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WT(t);default:return!1}}async function _N(t,e={}){return na(t,"GET","/v1/projects",e)}const vN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bN=/^https?/;async function xN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _N(t);for(const n of e)try{if(EN(n))return}catch{}zr(t,"unauthorized-domain")}function EN(t){const e=xg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const u=new URL(t);return u.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&u.hostname===i}if(!bN.test(n))return!1;if(vN.test(t))return i===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const SN=new mu(3e4,6e4);function pE(){const t=fi().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function wN(t){return new Promise((e,n)=>{function i(){pE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pE(),n(hi(t,"network-request-failed"))},timeout:SN.get()})}if(fi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(fi().gapi?.load)i();else{const a=gM("iframefcb");return fi()[a]=()=>{gapi.load?i():n(hi(t,"network-request-failed"))},MT(`${pM()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw dh=null,e})}let dh=null;function TN(t){return dh=dh||wN(t),dh}const AN=new mu(5e3,15e3),CN="__/auth/iframe",RN="emulator/auth/iframe",DN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},IN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function jN(t){const e=t.config;Ve(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ry(e,RN):`https://${t.config.authDomain}/${CN}`,i={apiKey:e.apiKey,appName:t.name,v:fl},a=IN.get(t.config.apiHost);a&&(i.eid=a);const l=t._getFrameworks();return l.length&&(i.fw=l.join(",")),`${n}?${su(i).slice(1)}`}async function ON(t){const e=await TN(t),n=fi().gapi;return Ve(n,t,"internal-error"),e.open({where:document.body,url:jN(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:DN,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const u=hi(t,"network-request-failed"),f=fi().setTimeout(()=>{l(u)},AN.get());function p(){fi().clearTimeout(f),a(i)}i.ping(p).then(p,()=>{l(u)})}))}const kN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},MN=500,NN=600,PN="_blank",LN="http://localhost";class gE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VN(t,e,n,i=MN,a=NN){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const p={...kN,width:i.toString(),height:a.toString(),top:l,left:u},g=Dn().toLowerCase();n&&(f=CT(g)?PN:n),TT(g)&&(e=e||LN,p.scrollbars="yes");const _=Object.entries(p).reduce((x,[w,A])=>`${x}${w}=${A},`,"");if(aM(g)&&f!=="_self")return zN(e||"",f),new gE(null);const v=window.open(e||"",f,_);Ve(v,t,"popup-blocked");try{v.focus()}catch{}return new gE(v)}function zN(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const UN="__/auth/handler",BN="emulator/auth/handler",FN=encodeURIComponent("fac");async function yE(t,e,n,i,a,l){Ve(t.config.authDomain,t,"auth-domain-config-required"),Ve(t.config.apiKey,t,"invalid-api-key");const u={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:fl,eventId:a};if(e instanceof LT){e.setDefaultLanguage(t.languageCode),u.providerId=e.providerId||"",oI(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))u[_]=v}if(e instanceof pu){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(u.scopes=_.join(","))}t.tenantId&&(u.tid=t.tenantId);const f=u;for(const _ of Object.keys(f))f[_]===void 0&&delete f[_];const p=await t._getAppCheckToken(),g=p?`#${FN}=${encodeURIComponent(p)}`:"";return`${qN(t)}?${su(f).slice(1)}${g}`}function qN({config:t}){return t.emulator?Ry(t,BN):`https://${t.authDomain}/${UN}`}const Pp="webStorageSupport";class HN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qT,this._completeRedirectFn=mN,this._overrideRedirectResult=dN}async _openPopup(e,n,i,a){Ki(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await yE(e,n,i,xg(),a);return VN(e,l,ky())}async _openRedirect(e,n,i,a){await this._originValidation(e);const l=await yE(e,n,i,xg(),a);return $M(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:l}=this.eventManagers[n];return a?Promise.resolve(a):(Ki(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await ON(e),i=new gN(e);return n.register("authEvent",a=>(Ve(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Pp,{type:Pp},a=>{const l=a?.[0]?.[Pp];l!==void 0&&n(!!l),zr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=xN(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return OT()||AT()||Iy()}}const GN=HN;var _E="@firebase/auth",vE="1.12.0";class QN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function $N(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function KN(t){Wo(new Pa("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:f}=i.options;Ve(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const p={apiKey:u,authDomain:f,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kT(t)},g=new hM(i,a,l,p);return EM(g,n),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Wo(new Pa("auth-internal",e=>{const n=xl(e.getProvider("auth").getImmediate());return(i=>new QN(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Bs(_E,vE,$N(t)),Bs(_E,vE,"esm2020")}const WN=300,YN=TS("authIdTokenMaxAge")||WN;let bE=null;const XN=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>YN)return;const a=n?.token;bE!==a&&(bE=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function JN(t=jS()){const e=Bg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=xM(t,{popupRedirectResolver:GN,persistence:[nN,HM,qT]}),i=TS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=XN(l.toString());zM(n,u,()=>u(n.currentUser)),VM(n,f=>u(f))}}const a=SS("auth");return a&&SM(n,`http://${a}`),n}function ZN(){return document.getElementsByTagName("head")?.[0]??document}fM({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=a=>{const l=hi("internal-error");l.customData=a,n(l)},i.type="text/javascript",i.charset="UTF-8",ZN().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});KN("Browser");function qa(){const t=JN(MS);async function e(){return!1}async function n(f,p){return LM(t,f,p)}function i(){return BM(t)}function a(f){UM(t,p=>{f(p)})}function l(){return t.currentUser}return{set_user_listener:a,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:i,get_current_firebase_user:l}}const eP={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,lastActiveTab:"balances",lastSettingsTab:"categories",lastAdminTab:"budget",lastBalancesView:"categories",setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},setLastActiveTab:()=>{},setLastSettingsTab:()=>{},setLastAdminTab:()=>{},setLastBalancesView:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},YT=T.createContext(eP);function tP({children:t}){const n=qa().get_current_firebase_user(),[i,a]=T.useState(null),[l,u]=T.useState(new Date().getFullYear()),[f,p]=T.useState(new Date().getMonth()+1),[g,_]=T.useState("balances"),[v,x]=T.useState("categories"),[w,A]=T.useState("budget"),[I,N]=T.useState("categories"),[H,$]=T.useState(!1),[q,me]=T.useState(!1),re=jk(n?.uid||null,n?.email||null),he=re.data&&re.data.budget_ids.length===0,L=kk(n?.uid||null,re.data||null,{enabled:!!n?.uid&&!!re.data&&he}),D=re.data?.permission_flags?.is_admin===!0,R=re.data?.permission_flags?.is_test===!0,M=L.data?.pendingInvites||[],j=L.data?.budgets||[],O=M.length>0;T.useEffect(()=>{if(!n||H||re.isLoading)return;const J=re.data;if(!(!J&&!re.isError))if(J&&J.budget_ids.length>0)a(J.budget_ids[0]),me(!1),$(!0);else{if(L.isLoading)return;const z=L.data;z?.pendingInvites&&z.pendingInvites.length>0?me(!1):me(!0),$(!0)}},[n,H,re.data,re.isLoading,re.isError,L.data,L.isLoading]);const C=T.useCallback(()=>{p(J=>J===1?(u(z=>z-1),12):J-1)},[]),Y=T.useCallback(()=>{p(J=>J===12?(u(z=>z+1),1):J+1)},[]),U=T.useCallback(async()=>{await L.refetch()},[L]),P=T.useCallback(J=>{a(J)},[]),B=T.useCallback(async J=>{if(!n)return null;try{const z=await Lk(J,n.uid);return z&&z.isInvited&&!z.hasAccepted?{budgetId:J,budgetName:z.budgetName,ownerEmail:z.ownerEmail}:null}catch(z){return console.error("[BudgetContext] Error checking budget invite:",z),null}},[n]),Q=T.useCallback(()=>{localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),le={currentUserId:n?.uid||null,selectedBudgetId:i,currentYear:l,currentMonthNumber:f,lastActiveTab:g,lastSettingsTab:v,lastAdminTab:w,lastBalancesView:I,setSelectedBudgetId:a,setCurrentYear:u,setCurrentMonthNumber:p,setLastActiveTab:_,setLastSettingsTab:x,setLastAdminTab:A,setLastBalancesView:N,isInitialized:H,needsFirstBudget:q,goToPreviousMonth:C,goToNextMonth:Y,pendingInvites:M,hasPendingInvites:O,accessibleBudgets:j,isAdmin:D,isTest:R,loadAccessibleBudgets:U,switchToBudget:P,checkBudgetInvite:B,clearCache:Q};return d.jsx(YT.Provider,{value:le,children:t})}function wn(){const t=T.useContext(YT);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}const zi={mobile:640,wide:1200},nP=zi.mobile,pf=["January","February","March","April","May","June","July","August","September","October","November","December"],ue={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15"},Hn={maxWidth:"var(--page-max-width, 85rem)",margin:"0 auto",padding:"var(--page-padding, 2rem)"},yu={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},rP={...yu,padding:"0.6rem 0.875rem",gap:"0.5rem"},iP={background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1rem 1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},sP={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},aP={display:"flex",flexDirection:"column",gap:"0.5rem"},oP={fontSize:"0.9rem",fontWeight:500},Ha={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit"},lP={...Ha,cursor:"pointer"},Ny={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},XT={...Ny,background:ue.primary,color:"white",border:"none"},cP={...XT,padding:"0.75rem 1.5rem",borderRadius:"8px"},uP={...Ny,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},dP={...Ny,background:"transparent",border:`1px solid ${ue.errorBorder}`,color:ue.error},hP={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},fP={display:"flex",gap:"0.5rem"},mP={display:"flex",gap:"0.25rem"},JT={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},pP={...JT,borderColor:ue.errorBorder,color:ue.error},il={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},Py={display:"flex",flexDirection:"column",gap:"2px"},gP={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},ZT={opacity:.4,cursor:"grab"},e1={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:ue.primary,borderRadius:"2px",transition:"opacity 0.15s"},yP={position:"relative",height:"2rem",marginTop:"-0.25rem"},_P={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ue.primary,borderRadius:"2px",transition:"opacity 0.15s"},vP={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},bP={background:ue.errorBg,border:`1px solid ${ue.errorBorder}`,color:ue.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},xP={background:"transparent",border:"none",color:ue.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},Jc={opacity:.7,marginBottom:"1.5rem"},Sl={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},Ly={fontWeight:500,fontSize:"1.1rem"},sl={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function EP(){return d.jsxs("div",{style:Hn,children:[d.jsx("nav",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:d.jsx(It,{to:"/",style:{display:"flex",alignItems:"center"},title:"Tarron Lane Home",children:d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane Home",style:{width:"2rem",height:"2rem"}})})}),d.jsx("h1",{children:"Tarron Lane Homepage"}),d.jsx("nav",{children:d.jsxs("ul",{children:[d.jsx("li",{children:d.jsx(It,{to:"/sql-test",children:"SQL Test"})}),d.jsx("li",{children:d.jsx(It,{to:"/budget",children:"Budget"})}),d.jsx("li",{children:d.jsx(It,{to:"/account",children:"Account"})})]})})]})}function Ko({children:t}){return d.jsx("div",{style:Hn,children:t})}function wl({message:t,children:e,onDismiss:n,style:i}){return d.jsxs("div",{style:{...bP,...i},children:[d.jsx("span",{children:e??t}),n&&d.jsx("button",{onClick:n,style:xP,children:""})]})}const SP={primary:XT,"primary-large":cP,secondary:uP,danger:dP,small:hP};function Le({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:i,disabled:a,style:l,actionName:u,onClick:f,...p}){const g=SP[t],_=a||e;function v(x){u&&st("CLICK",u),f?.(x)}return d.jsx("button",{disabled:_,style:{...g,cursor:_?"not-allowed":"pointer",opacity:_?.7:1,...l},onClick:v,...p,children:e?n:i})}function wg(t,e){const n=t.toLowerCase(),i=e.toLowerCase();if(i.includes(n)){const f=i.indexOf(n);return{match:!0,score:f===0||/\s/.test(i[f-1])?100:90}}let a=0,l=0,u=0;for(let f=0;f<i.length&&a<n.length;f++)i[f]===n[a]?(a++,u++,l+=u*2):u=0;return a===n.length?{match:!0,score:l}:{match:!1,score:0}}function Lp({id:t,value:e,onChange:n,payees:i,placeholder:a="Enter payee name"}){const[l,u]=T.useState(!1),[f,p]=T.useState(-1),g=T.useRef(null),_=T.useRef(null),v=e.trim()?i.map(A=>({payee:A,...wg(e,A)})).filter(A=>A.match).sort((A,I)=>I.score-A.score).slice(0,8).map(A=>A.payee):[];T.useEffect(()=>{function A(I){g.current&&!g.current.contains(I.target)&&u(!1)}return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]);function x(A){!l||v.length===0||(A.key==="ArrowDown"?(A.preventDefault(),p(I=>Math.min(I+1,v.length-1))):A.key==="ArrowUp"?(A.preventDefault(),p(I=>Math.max(I-1,-1))):A.key==="Enter"&&f>=0?(A.preventDefault(),n(v[f]),u(!1),p(-1)):A.key==="Escape"&&(u(!1),p(-1)))}function w(A){n(A),u(!1),p(-1),_.current?.focus()}return d.jsxs("div",{ref:g,style:{position:"relative"},children:[d.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:A=>{n(A.target.value),u(!0),p(-1)},onFocus:()=>u(!0),onKeyDown:x,placeholder:a,autoComplete:"off",style:Ha}),l&&v.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:v.map((A,I)=>d.jsx("div",{onClick:()=>w(A),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:I===f?`color-mix(in srgb, ${ue.primary} 20%, transparent)`:"transparent",borderBottom:I<v.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>p(I),children:A},A))})]})}function wP({id:t,value:e,onChange:n,categories:i,categoryGroups:a,placeholder:l="Search categories...",required:u}){const f=Object.fromEntries(a.map(O=>[O.id,O.name])),p=Object.entries(i).map(([O,C])=>({id:O,name:C.name,groupId:C.category_group_id,groupName:C.category_group_id&&f[C.category_group_id]||null,sortOrder:C.sort_order})),_=(e?i[e]:null)?.name||"",[v,x]=T.useState(_),[w,A]=T.useState(!1),[I,N]=T.useState(-1),H=T.useRef(null),$=T.useRef(null);T.useEffect(()=>{const O=e?i[e]:null;x(O?.name||"")},[e,i]);const q=v.trim()?p.map(O=>({...O,...wg(v,O.name),groupMatch:O.groupName?wg(v,O.groupName):{match:!1,score:0}})).filter(O=>O.match||O.groupMatch.match).sort((O,C)=>{const Y=Math.max(O.score,O.groupMatch.score*.5),U=Math.max(C.score,C.groupMatch.score*.5);if(U!==Y)return U-Y;if(O.groupId!==C.groupId){if(!O.groupId)return 1;if(!C.groupId)return-1;const P=(O.groupName||"").localeCompare(C.groupName||"");return P!==0?P:O.groupId.localeCompare(C.groupId)}return O.sortOrder-C.sortOrder}).slice(0,10):[...p].sort((O,C)=>{if(O.groupId!==C.groupId){if(!O.groupId)return 1;if(!C.groupId)return-1;const Y=(O.groupName||"").localeCompare(C.groupName||"");return Y!==0?Y:O.groupId.localeCompare(C.groupId)}return O.sortOrder-C.sortOrder}).slice(0,10);T.useEffect(()=>{function O(C){if(H.current&&!H.current.contains(C.target)){A(!1);const Y=e?i[e]:null;x(Y?.name||"")}}return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[e,i]);function me(O){if(O.key==="ArrowDown")O.preventDefault(),w?N(C=>Math.min(C+1,q.length-1)):(A(!0),N(0));else if(O.key==="ArrowUp")O.preventDefault(),N(C=>Math.max(C-1,0));else if(O.key==="Enter")O.preventDefault(),w&&I>=0&&q[I]&&re(q[I]);else if(O.key==="Escape"){A(!1),N(-1);const C=e?i[e]:null;x(C?.name||"")}else if(O.key==="Tab"&&w&&q.length>0){const C=I>=0?I:0;re(q[C])}}function re(O){n(O.id),x(O.name),A(!1),N(-1),$.current?.focus()}function he(O){const C=O.target.value;x(C),A(!0),N(-1),C!==_&&n("")}function L(){A(!0),q.length>0&&N(0)}const D=[];let R="__initial__";q.forEach(O=>{O.groupId!==R&&(R=O.groupId,D.push({groupId:O.groupId,groupName:O.groupName,items:[]})),D[D.length-1].items.push(O)});let M=-1;const j=()=>++M;return d.jsxs("div",{ref:H,style:{position:"relative"},children:[d.jsx("input",{ref:$,id:t,type:"text",value:v,onChange:he,onFocus:L,onKeyDown:me,placeholder:l,autoComplete:"off",required:u,style:{...Ha,borderColor:u&&!e?ue.error:void 0}}),w&&q.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"250px",overflowY:"auto"},children:D.map((O,C)=>d.jsxs("div",{children:[O.groupName&&d.jsx("div",{style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6,background:"color-mix(in srgb, currentColor 5%, transparent)",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:O.groupName}),O.items.map(Y=>{const U=j();return d.jsx("div",{onClick:()=>re(Y),style:{padding:"0.6rem 0.8rem",paddingLeft:O.groupName?"1.2rem":"0.8rem",cursor:"pointer",background:U===I?`color-mix(in srgb, ${ue.primary} 20%, transparent)`:"transparent",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",transition:"background 0.1s"},onMouseEnter:()=>N(U),children:Y.name},Y.id)})]},`group-${C}`))}),w&&q.length===0&&v.trim()&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,padding:"0.6rem 0.8rem",opacity:.6,fontStyle:"italic"},children:"No matching categories"})]})}function Gs({children:t,onSubmit:e,actionName:n}){function i(a){n&&st("SUBMIT",n),e(a)}return d.jsx("form",{onSubmit:i,style:sP,children:t})}function St({label:t,htmlFor:e,children:n,hint:i,style:a}){return d.jsxs("div",{style:{...aP,...a},children:[d.jsx("label",{htmlFor:e,style:oP,children:t}),n,i&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:i})]})}function Qs(t){return d.jsx("input",{style:Ha,...t})}function TP(t){if(!t)return"";try{return new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return t}}function Vp({value:t,onChange:e,style:n,...i}){const a=T.useRef(null),l=TP(t);function u(){a.current?.showPicker?.()}return d.jsxs("div",{style:{position:"relative"},children:[d.jsx("input",{ref:a,type:"date",value:t||"",onChange:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,pointerEvents:"none"},...i}),d.jsx("div",{onClick:u,style:{...Ha,cursor:"pointer",display:"flex",alignItems:"center",fontSize:"0.85rem",fontFamily:"monospace",color:t?"inherit":"color-mix(in srgb, currentColor 50%, transparent)",...n},children:l||"Select date"})]})}function Zc({children:t,...e}){return d.jsx("select",{style:lP,...e,children:t})}function Vy({minHeight:t="6rem",style:e,...n}){return d.jsx("textarea",{style:{...Ha,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function Ga({children:t}){return d.jsx("div",{style:gP,children:t})}function zp(t){const n=t.replace(/[^\d.]/g,"").split("."),i=n[0]||"",a=n[1],l=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return a!==void 0?`$${l}.${a.slice(0,2)}`:l?`$${l}`:""}function AP(t){return t.replace(/[$,]/g,"")}function hh({id:t,value:e,onChange:n,placeholder:i="$0.00",required:a,autoFocus:l}){const[u,f]=T.useState(()=>zp(e)),p=T.useRef(null);T.useEffect(()=>{const _=zp(e);AP(u)!==e&&f(_)},[e]);function g(_){const v=_.target.value;if(!v||v==="$"){f(""),n("");return}const w=v.replace(/[^\d.]/g,"").split(".");let A=w[0];w.length>1&&(A+="."+w.slice(1).join("").slice(0,2));const I=zp(A);f(I),n(A)}return d.jsx("input",{ref:p,id:t,type:"text",inputMode:"decimal",value:u,onChange:g,placeholder:i,required:a,autoFocus:l,style:Ha})}function Ji(t=nP){const[e,n]=T.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return T.useEffect(()=>{function i(){n(window.innerWidth<t)}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[t]),e}function gf({children:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:u,onDrop:f,onEdit:p,onDelete:g,onMoveUp:_,onMoveDown:v,canMoveUp:x=!0,canMoveDown:w=!0}){const A=Ji(),I=_||v;return d.jsxs("div",{onDragOver:N=>{N.stopPropagation(),a(N)},onDragLeave:N=>{N.stopPropagation(),l()},onDrop:N=>{N.stopPropagation(),f(N)},style:{position:"relative"},children:[d.jsx("div",{style:{...e1,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{style:{...A?rP:yu,opacity:e?.5:1},children:[d.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:A?"0.5rem":"0.75rem",minWidth:0},children:[d.jsx("span",{draggable:!0,onDragStart:i,onDragEnd:u,style:{...ZT,fontSize:A?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),d.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),d.jsxs("div",{style:A?mP:fP,children:[A?d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:p,style:JT,title:"Edit","aria-label":"Edit",children:""}),d.jsx("button",{onClick:g,style:pP,title:"Delete","aria-label":"Delete",children:""})]}):d.jsxs(d.Fragment,{children:[d.jsx(Le,{variant:"secondary",onClick:p,children:"Edit"}),d.jsx(Le,{variant:"danger",onClick:g,children:"Delete"})]}),I&&d.jsxs("div",{style:Py,children:[d.jsx("button",{onClick:N=>{N.stopPropagation(),_?.()},disabled:!x,style:{...il,opacity:x?.6:.2,cursor:x?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:N=>{N.stopPropagation(),v?.()},disabled:!w,style:{...il,opacity:w?.6:.2,cursor:w?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function zy({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i,label:a="Move to end"}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:yP,children:[d.jsx("div",{style:{..._P,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:vP,children:a})]})}function Dc({children:t,style:e}){return d.jsx("div",{style:{...iP,...e},children:t})}function CP({items:t}){const e=Ji(),n=a=>e?[1,3,4,2][a]:a+1,i=a=>{if(e)switch(a){case 0:return{borderRight:!0,borderBottom:!0};case 3:return{borderRight:!1,borderBottom:!0};case 1:return{borderRight:!0,borderBottom:!1};case 2:return{borderRight:!1,borderBottom:!1};default:return{borderRight:!1,borderBottom:!1}}else return{borderRight:a<3,borderBottom:!1}};return d.jsx("div",{style:{display:"grid",gridTemplateColumns:e?"1fr 1fr":"repeat(4, 1fr)",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",marginBottom:"1.5rem",overflow:"hidden"},children:t.map((a,l)=>{const u=i(l);return d.jsxs("div",{style:{padding:"0.75rem 1rem",borderRight:u.borderRight?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",borderBottom:u.borderBottom?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center",order:n(l)},children:[d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:a.label}),d.jsx("div",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600},children:a.value}),a.subtitle&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.65rem",opacity:.5},children:a.subtitle}),a.action&&d.jsx("div",{style:{marginTop:"0.25rem"},children:a.action})]},l)})})}function je(t){return`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function an(t){return t>=0?ue.success:ue.danger}function t1(){const t=ln();return{submitFeedback:sr({mutationFn:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:u})=>{const f=i||n,p={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`${a}

(Submitted from: ${u})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l},{exists:g}=await Qe("feedback",f,"checking if user has existing feedback document");return g?await _t("feedback",f,{items:GO(p),user_email:i,updated_at:new Date().toISOString()},"adding new feedback item to existing document",{merge:!0}):await _t("feedback",f,{items:[p],user_email:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},"creating new feedback document for user"),{feedbackItem:p,docId:f}},onMutate:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:u})=>{await t.cancelQueries({queryKey:xe.feedback()});const f=t.getQueryData(xe.feedback()),p=i||n,g={id:`feedback_optimistic_${Date.now()}`,text:`${a}

(Submitted from: ${u})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l,doc_id:p,user_email:i};return t.setQueryData(xe.feedback(),_=>_?{items:[..._.items,g]}:{items:[g]}),{previousData:f,optimisticItemId:g.id}},onSuccess:(n,i,a)=>{t.setQueryData(xe.feedback(),l=>l&&{items:l.items.map(u=>u.id===a?.optimisticItemId?{...n.feedbackItem,doc_id:n.docId,user_email:i.userEmail}:u)})},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function RP(){const t=ln();return{toggleFeedback:sr({mutationFn:async({item:n})=>{const{exists:i,data:a}=await Qe("feedback",n.doc_id,"PRE-EDIT-READ");if(!i||!a)throw new Error(`Feedback document not found: ${n.doc_id}`);const l=!n.is_done,u=l?new Date().toISOString():null,f=a.items||[];let p=!1;const g=f.map(_=>_.id===n.id?(p=!0,{..._,is_done:l,completed_at:u}):_);if(!p)throw console.error("[toggleFeedback] Item not found in document",{searchingFor:n.id,inDocument:n.doc_id,availableIds:f.map(_=>_.id)}),new Error(`Feedback item not found in document. Item ID: ${n.id}, Doc ID: ${n.doc_id}`);return await _t("feedback",n.doc_id,{...a,items:g,updated_at:new Date().toISOString()},`marking feedback item as ${l?"done":"not done"}`),{itemId:n.id,isDone:l,completedAt:u}},onMutate:async({item:n})=>{await t.cancelQueries({queryKey:xe.feedback()});const i=t.getQueryData(xe.feedback()),a=!n.is_done,l=a?new Date().toISOString():null;return t.setQueryData(xe.feedback(),u=>u&&{items:u.items.map(f=>f.id===n.id?{...f,is_done:a,completed_at:l}:f)}),{previousData:i}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function DP(){const t=ln();return{updateSortOrder:sr({mutationFn:async({docId:n,items:i})=>{const{exists:a,data:l}=await Qe("feedback",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Feedback document not found");return await _t("feedback",n,{...l,items:i,updated_at:new Date().toISOString()},"saving reordered feedback items"),{docId:n,items:i}},onMutate:async({docId:n,items:i})=>{await t.cancelQueries({queryKey:xe.feedback()});const a=t.getQueryData(xe.feedback());return t.setQueryData(xe.feedback(),l=>{if(!l)return l;const u=new Map;return i.forEach(f=>{u.set(f.id,f.sort_order)}),{items:l.items.map(f=>f.doc_id===n&&u.has(f.id)?{...f,sort_order:u.get(f.id)}:f)}}),{previousData:a}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function al({isOpen:t,onClose:e,title:n,children:i,width:a="28rem"}){if(!t)return null;function l(){st("CLOSE",`${n} Modal`),e()}return d.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:l,children:d.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:a,maxWidth:"calc(100vw - 2rem)",flexShrink:0,boxSizing:"border-box",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:u=>u.stopPropagation(),children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[d.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),i]})})}const IP=2e3,jP={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function OP(){const[t,e]=T.useState(!1),[n,i]=T.useState(""),[a,l]=T.useState("bug"),[u,f]=T.useState(!1),p=T.useContext(ru),_=qa().get_current_firebase_user(),v=Mn(),{submitFeedback:x}=t1();if(T.useEffect(()=>{if(u){const I=setTimeout(()=>f(!1),IP);return()=>clearTimeout(I)}},[u]),v.pathname.includes("/admin/feedback")||!p.is_logged_in)return null;function A(I){I.preventDefault(),!(!n.trim()||!p.username||!_)&&(x.mutate({userId:_.uid,userEmail:p.username,text:n.trim(),feedbackType:a,currentPath:v.pathname}),i(""),l("bug"),e(!1),f(!0))}return d.jsxs(d.Fragment,{children:[u&&d.jsxs("div",{style:{position:"fixed",bottom:"5rem",right:"1.5rem",background:"rgba(46, 213, 115, 0.95)",color:"white",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1001,display:"flex",alignItems:"center",gap:"0.5rem",animation:"fadeInUp 0.2s ease-out"},children:[d.jsx("span",{children:""}),d.jsx("span",{children:"Feedback submitted!"})]}),d.jsx("button",{onClick:()=>{st("OPEN","Feedback Modal"),e(!0)},style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:ue.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:I=>{I.currentTarget.style.transform="scale(1.1)",I.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:I=>{I.currentTarget.style.transform="scale(1)",I.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),d.jsx(al,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:d.jsxs("form",{onSubmit:A,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(I=>{const N=jP[I],H=a===I;return d.jsxs("button",{type:"button",onClick:()=>{st("SELECT","Feedback Type",{value:N.label}),l(I)},style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${N.color}`,borderRadius:"0.5rem",background:H?N.bgColor:"transparent",color:H?N.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:H?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:H?1:.5,boxShadow:H?`0 0 12px ${N.bgColor}`:"none",position:"relative"},children:[N.label,H&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},I)})}),d.jsx(Vy,{value:n,onChange:I=>i(I.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),d.jsxs(Ga,{children:[d.jsx(Le,{type:"button",variant:"secondary",actionName:"Cancel Feedback",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),d.jsx(Le,{type:"submit",actionName:"Submit Feedback",disabled:!n.trim(),children:"Submit"})]})]})})]})}function Os({children:t,labelStyle:e,...n}){return d.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[d.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:ue.primary},...n}),t]})}function kP({title:t,count:e,children:n,defaultExpanded:i=!1}){const[a,l]=T.useState(i);return d.jsxs("div",{style:{marginTop:"2rem"},children:[d.jsxs("button",{onClick:()=>l(!a),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[d.jsx("span",{style:{transition:"transform 0.2s",transform:a?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),a&&n]})}const MP=t=>{switch(t){case 2:return 220;case 3:return 320;case 4:return 420;case 5:return 520;case 6:return 620;default:return t*100+20}},NP=t=>t<=4?2:t<=6?3:Math.ceil(t/2);function Uy(t){const{tabs:e,activeTab:n}=t,i=e.filter(v=>!v.hidden),a=i.length,l=MP(a),u=NP(a),f=Math.floor(100/u),p=`tab-nav-${a}`,g=v=>({flex:"1 1 0",padding:"0.6rem 0.5rem",border:"none",borderRadius:0,background:"transparent",cursor:"pointer",fontWeight:v?600:400,fontSize:"0.9rem",color:"inherit",opacity:v?1:.5,transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem",position:"relative",boxSizing:"border-box",outline:"none"}),_=(v,x)=>d.jsxs(d.Fragment,{children:[d.jsx("span",{children:v.label}),v.checkmark&&d.jsx("span",{style:{color:ue.success,fontWeight:600},children:""}),x&&d.jsx("span",{style:{position:"absolute",bottom:"-1px",left:"15%",right:"15%",height:"3px",background:"white",borderRadius:"2px"}})]});return d.jsxs(d.Fragment,{children:[d.jsx("style",{children:`
        .${p} {
          display: flex;
          flex-wrap: wrap;
          margin-bottom: 1.5rem;
          border-bottom: 1px solid color-mix(in srgb, currentColor 15%, transparent);
        }
        .${p} > button,
        .${p} > a {
          border: none !important;
          border-radius: 0 !important;
          outline: none !important;
        }
        .${p} > button:hover,
        .${p} > button:focus,
        .${p} > a:hover,
        .${p} > a:focus {
          border: none !important;
          border-color: transparent !important;
        }
        @media (max-width: ${l}px) {
          .${p} > * {
            flex: 1 1 ${f}% !important;
            min-width: ${f}% !important;
          }
        }
      `}),d.jsx("div",{className:p,children:i.map(v=>{const x=n===v.id;return t.mode==="link"?d.jsx(It,{to:`${t.linkPrefix}/${v.id}`,style:g(x),children:_(v,x)},v.id):d.jsx("button",{onClick:()=>{st("NAVIGATE",`Tab: ${v.label}`),t.onTabChange(v.id)},style:g(x),children:_(v,x)},v.id)})})]})}function By({items:t}){const[e,n]=T.useState(!1),i=T.useRef(null),l=Mn().pathname;T.useEffect(()=>{function f(p){i.current&&!i.current.contains(p.target)&&n(!1)}if(e)return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[e]),T.useEffect(()=>{function f(p){p.key==="Escape"&&n(!1)}if(e)return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[e]);const u=t.filter(f=>f.hidden?!1:f.to?f.to==="/budget"?!(l==="/budget"||/^\/budget\/\d{4}\/\d{1,2}\/\w+$/.test(l)):f.to==="/account"||f.to==="/"?l!==f.to:!l.startsWith(f.to):!0);return d.jsxs("div",{ref:i,style:{position:"relative"},children:[d.jsx("button",{onClick:()=>n(!e),style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:e?"color-mix(in srgb, currentColor 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:"none",cursor:"pointer",fontSize:"1.25rem",color:"inherit",transition:"background 0.15s",lineHeight:1},title:"Menu","aria-expanded":e,"aria-haspopup":"true",children:""}),e&&d.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",minWidth:"180px",background:"#1a1a2e",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",zIndex:1e3,overflow:"hidden"},children:u.map((f,p)=>{if(f.divider)return d.jsx("div",{style:{height:"1px",background:"color-mix(in srgb, currentColor 15%, transparent)",margin:"0.25rem 0"}},p);const g=d.jsxs(d.Fragment,{children:[f.icon&&d.jsx("span",{style:{width:"1.5rem",textAlign:"center"},children:f.icon}),d.jsx("span",{children:f.label})]}),_={display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",fontSize:"0.95rem",color:"inherit",textDecoration:"none",cursor:"pointer",transition:"background 0.15s",background:"transparent",border:"none",width:"100%",textAlign:"left"},v={background:"color-mix(in srgb, currentColor 10%, transparent)"};return f.to?d.jsx(It,{to:f.to,style:_,onMouseEnter:x=>Object.assign(x.currentTarget.style,v),onMouseLeave:x=>x.currentTarget.style.background="transparent",onClick:()=>n(!1),children:g},p):d.jsx("button",{onClick:()=>{f.onClick?.(),n(!1)},style:_,onMouseEnter:x=>Object.assign(x.currentTarget.style,v),onMouseLeave:x=>x.currentTarget.style.background="transparent",children:g},p)})})]})}function mi({title:t,showBackArrow:e=!1,hideMenu:n=!1}){const{isAdmin:i}=wn(),a=[{label:"Budget",icon:"",to:"/budget"},{label:"Budget Settings",icon:"",to:"/budget/settings"},{label:"Analytics",icon:"",to:"/budget/analytics"},...i?[{label:"Admin",icon:"",to:"/budget/admin"}]:[],{label:"Switch Budgets",icon:"",to:"/budget/my-budgets"},{divider:!0,label:""},{label:"Exit Budget App",icon:"",to:"/"}];return d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{children:e?d.jsx(It,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none"},title:"Back to Home",children:""}):d.jsx(It,{to:"/budget",title:"Budget Home",children:d.jsx("img",{src:"/budget-icon.svg",alt:"Budget",style:{width:"1.5rem",height:"1.5rem"}})})}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem",textAlign:"center"},children:t}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:!n&&d.jsx(By,{items:a})})]})}function PP({children:t,style:e}){return d.jsx("div",{style:{width:"100%",maxWidth:"var(--content-max-width, 900px)",marginLeft:"auto",marginRight:"auto",...e},children:t})}function n1({label:t,value:e,action:n,inlineAction:i,compact:a}){const l=Ji();return a?d.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("span",{style:{display:"flex",alignItems:"baseline",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:t}),d.jsx("span",{style:{fontSize:"1.1rem",fontWeight:600},children:e})]}),n]}),i]}):d.jsxs("div",{style:{display:"flex",flexDirection:l?"column":"row",justifyContent:"space-between",alignItems:l?"stretch":"center",gap:l?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("div",{children:[d.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:t}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0.25rem 0 0 0"},children:[d.jsx("span",{style:{fontSize:"1.25rem",fontWeight:600},children:e}),i]})]}),n]})}function LP({isVisible:t,message:e="Loading..."}){return t?d.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999,gap:"1rem"},children:[d.jsx("div",{style:{width:"3rem",height:"3rem",border:"3px solid rgba(255, 255, 255, 0.2)",borderTopColor:ue.primary,borderRadius:"50%",animation:"loadingOverlaySpin 0.8s linear infinite"}}),d.jsx("p",{style:{color:"white",fontSize:"1.1rem",fontWeight:500},children:e}),d.jsx("style",{children:`
        @keyframes loadingOverlaySpin {
          to { transform: rotate(360deg); }
        }
      `})]}):null}function Tg(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function VP(){return d.jsxs("div",{style:Hn,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(It,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(It,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"SQL Test"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(By,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"SQL Test"}),d.jsx("h2",{children:"Setup"}),d.jsxs("h3",{children:["1. Open up your preferred web browser to ",d.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),d.jsxs("ul",{children:[d.jsx("li",{children:"This is a basic online sql query editor"}),d.jsxs("li",{children:["It will include three tables: ",d.jsx("b",{children:'"Customer"'}),", ",d.jsx("b",{children:'"Orders"'}),", and ",d.jsx("b",{children:'"Shippings"'})]})]}),d.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),d.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:d.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),d.jsx("h2",{children:"SQL Problems"}),d.jsx("p",{children:"Write queries in the online editor to answer these questions."}),d.jsx("h3",{children:"Question #1"}),d.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),d.jsx("h3",{children:"Question #2"}),d.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function zP(){const t=T.useContext(ru),e=qa(),[n,i]=T.useState(!1),a=Mn(),l=tu(),u=a.state?.from||"/";T.useEffect(()=>{t.is_logged_in&&u!=="/"&&l(u,{replace:!0})},[t.is_logged_in,u,l]);function f(){i(!0),e.logout_firebase_user().then(function(){i(!1)})}return d.jsxs("div",{style:Hn,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(It,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(It,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"Account"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(By,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"Account"}),t.is_logged_in?n?d.jsx("p",{children:"Logging Out..."}):d.jsxs(d.Fragment,{children:[d.jsxs("p",{children:["You are logged in as ",t.username]}),d.jsx("button",{onClick:f,style:{marginTop:"1rem"},children:"Logout"})]}):d.jsx(UP,{})]})}function UP(){const t=qa(),[e,n]=T.useState(""),[i,a]=T.useState(""),[l,u]=T.useState(!1),[f,p]=T.useState("");function g(x){n(x.target.value)}function _(x){a(x.target.value)}function v(x){x.preventDefault(),u(!0),p(""),t.login_firebase_user(e,i).then(function(){}).catch(function(){p("Incorrect login credentials")}).finally(function(){u(!1)})}return d.jsxs("form",{onSubmit:v,children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"username",children:"Email: "}),d.jsx("input",{id:"username",type:"email",value:e,onChange:g})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",children:"Password: "}),d.jsx("input",{id:"password",type:"password",value:i,onChange:_})]}),l?d.jsx("p",{children:"Logging in..."}):d.jsx("button",{children:"Login"}),f&&d.jsx("p",{style:{color:"red"},children:f})]})}function BP(){const[t,e]=T.useState(()=>typeof window>"u"?1200:window.innerWidth);return T.useEffect(()=>{function n(){e(window.innerWidth)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),{width:t,isWide:t>=zi.wide,isMedium:t>=zi.mobile&&t<zi.wide,isMobile:t<zi.mobile}}function FP(){const t=ln();return{updateAccounts:sr({mutationFn:async({budgetId:n,accounts:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await _t("budgets",n,{...l,accounts:i},"saving updated accounts (user edited account settings)"),i},onMutate:async({budgetId:n,accounts:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,accounts:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,accounts:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function qP(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order},i.expected_balance!==void 0&&(e[n].expected_balance=i.expected_balance),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function HP(){const t=ln();return{updateAccountGroups:sr({mutationFn:async({budgetId:n,accountGroups:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const u=qP(i);return await _t("budgets",n,{...l,account_groups:u},"saving updated account groups (user edited group settings)"),i},onMutate:async({budgetId:n,accountGroups:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,accountGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,accountGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function GP(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,category_group_id:i.category_group_id??null,sort_order:i.sort_order,balance:i.balance??0},i.description!==void 0&&(e[n].description=i.description),i.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=i.default_monthly_amount),i.default_monthly_type!==void 0&&(e[n].default_monthly_type=i.default_monthly_type)}),e}function QP(){const t=ln();return{updateCategories:sr({mutationFn:async({budgetId:n,categories:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const u=GP(i);return await _t("budgets",n,{...l,categories:u},"saving updated categories (user edited category settings)"),i},onMutate:async({budgetId:n,categories:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,categories:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,categories:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function $P(){const t=ln();return{updateCategoryGroups:sr({mutationFn:async({budgetId:n,categoryGroups:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await _t("budgets",n,{...l,category_groups:i},"saving updated category groups (user edited group settings)"),i},onMutate:async({budgetId:n,categoryGroups:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,categoryGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,categoryGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function KP(){const t=ln();return{renameBudget:sr({mutationFn:async({budgetId:n,newName:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await _t("budgets",n,{...l,name:i.trim()},`renaming budget to "${i.trim()}"`),i.trim()},onMutate:async({budgetId:n,newName:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,name:i.trim()}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,budget:{...a.budget,name:n}})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function WP(){const t=ln();return{createBudget:sr({mutationFn:async({name:n,userId:i,userEmail:a})=>{const l=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,u=new Date().toISOString(),f={name:n.trim()||"My Budget",user_ids:[i],accepted_user_ids:[i],owner_id:i,owner_email:a,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:u,updated_at:u};await _t("budgets",l,f,"creating new budget document");const{exists:p,data:g}=await Qe("users",i,"reading user document to add new budget to their list");return p&&g?await _t("users",i,{...g,budget_ids:[l,...g.budget_ids],updated_at:u},"adding new budget to user's budget list"):await _t("users",i,{uid:i,email:a,budget_ids:[l],created_at:u,updated_at:u},"creating new user document with first budget"),{budgetId:l,budget:{id:l,...f}}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:xe.user(i)}),t.invalidateQueries({queryKey:xe.accessibleBudgets(i)})}})}}function YP(){const t=ln();return{acceptInvite:sr({mutationFn:async({budgetId:n,userId:i})=>{const a=new Date().toISOString(),{exists:l,data:u}=await Qe("budgets",n,"verifying user was invited to this budget");if(!l||!u)throw new Error("Budget not found");if(!u.user_ids?.includes(i))throw new Error("You have not been invited to this budget");const{data:f}=await Qe("users",i,"PRE-EDIT-READ");if(f?.budget_ids?.includes(n))throw new Error("You have already accepted this invite");return await _t("users",i,{...f||{uid:i,email:null},budget_ids:[n,...f?.budget_ids||[]],updated_at:a},"adding accepted budget to user's budget list"),await _t("budgets",n,{...u,accepted_user_ids:[...u.accepted_user_ids||[],i]},"marking user as accepted in budget's accepted_user_ids"),{budgetId:n}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:xe.user(i)}),t.invalidateQueries({queryKey:xe.accessibleBudgets(i)}),t.invalidateQueries({queryKey:xe.budget(n.budgetId)})}})}}function XP(){const t=ln();return{inviteUser:sr({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");if(l.user_ids?.includes(i))throw new Error("User is already invited");return await _t("budgets",n,{...l,user_ids:[...l.user_ids||[],i]},"adding user to budget's invited users list"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,user_ids:[...a.budget.user_ids,i]}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function JP(){const t=ln();return{revokeUser:sr({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await _t("budgets",n,{...l,user_ids:(l.user_ids||[]).filter(u=>u!==i),accepted_user_ids:(l.accepted_user_ids||[]).filter(u=>u!==i)},"removing user from budget's access lists"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,user_ids:a.budget.user_ids.filter(l=>l!==i),accepted_user_ids:a.budget.accepted_user_ids.filter(l=>l!==i)}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function Gn(t,e){const n=Rk(t),{updateAccounts:i}=FP(),{updateAccountGroups:a}=HP(),{updateCategories:l}=QP(),{updateCategoryGroups:u}=$P(),{renameBudget:f}=KP(),{createBudget:p}=WP(),{acceptInvite:g}=YP(),{inviteUser:_}=XP(),{revokeUser:v}=JP(),x=n.data,w=x?.budget||null,A=T.useMemo(()=>x?.accounts||{},[x?.accounts]),I=T.useMemo(()=>x?.accountGroups||{},[x?.accountGroups]),N=T.useMemo(()=>x?.categories||{},[x?.categories]),H=T.useMemo(()=>x?.categoryGroups||[],[x?.categoryGroups]),$=w?.owner_id===e,q=T.useMemo(()=>w?.user_ids||[],[w?.user_ids]),me=T.useMemo(()=>w?.accepted_user_ids||[],[w?.accepted_user_ids]),re=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await i.mutateAsync({budgetId:t,accounts:F})},[t,i]),he=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await a.mutateAsync({budgetId:t,accountGroups:F})},[t,a]),L=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await l.mutateAsync({budgetId:t,categories:F})},[t,l]),D=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await u.mutateAsync({budgetId:t,categoryGroups:F})},[t,u]),R=T.useCallback(async(F,W)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.mutateAsync({budgetId:t,accounts:F}),a.mutateAsync({budgetId:t,accountGroups:W})])},[t,i,a]),M=T.useCallback(async(F,W)=>{if(!t)throw new Error("No budget selected");await Promise.all([l.mutateAsync({budgetId:t,categories:F}),u.mutateAsync({budgetId:t,categoryGroups:W})])},[t,l,u]),j=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await f.mutateAsync({budgetId:t,newName:F})},[t,f]),O=T.useCallback(async F=>{if(!e)throw new Error("Not authenticated");return await p.mutateAsync({name:F.trim()||"My Budget",userId:e,userEmail:null})},[e,p]),C=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await _.mutateAsync({budgetId:t,userId:F})},[t,_]),Y=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await v.mutateAsync({budgetId:t,userId:F})},[t,v]),U=T.useCallback(async F=>{if(!e)throw new Error("Not authenticated");await g.mutateAsync({budgetId:F,userId:e})},[e,g]),P=T.useCallback(F=>{if(!t)return;const W=Dt.getQueryData(xe.budget(t));W&&Dt.setQueryData(xe.budget(t),{...W,accounts:F})},[t]),B=T.useCallback(F=>{if(!t)return;const W=Dt.getQueryData(xe.budget(t));W&&Dt.setQueryData(xe.budget(t),{...W,accountGroups:F})},[t]),Q=T.useCallback(F=>{if(!t)return;const W=Dt.getQueryData(xe.budget(t));W&&Dt.setQueryData(xe.budget(t),{...W,categories:F})},[t]),le=T.useCallback(F=>{if(!t)return;const W=Dt.getQueryData(xe.budget(t));W&&Dt.setQueryData(xe.budget(t),{...W,categoryGroups:F})},[t]),J=T.useCallback(async()=>{t&&await Dt.invalidateQueries({queryKey:xe.budget(t)})},[t]),z=T.useCallback(()=>Object.entries(A).filter(([,F])=>{const W=F.account_group_id?I[F.account_group_id]:void 0,te=W?.on_budget!==void 0?W.on_budget:F.on_budget!==!1,se=W?.is_active!==void 0?W.is_active:F.is_active!==!1;return te&&se}).reduce((F,[,W])=>F+W.balance,0),[A,I]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:w,accounts:A,accountGroups:I,categories:N,categoryGroups:H,isOwner:$,budgetUserIds:q,acceptedUserIds:me,saveAccounts:re,saveAccountGroups:he,saveCategories:L,saveCategoryGroups:D,saveAccountsAndGroups:R,saveCategoriesAndGroups:M,renameBudget:j,createBudget:O,inviteUser:C,revokeUser:Y,acceptInvite:U,setAccountsOptimistic:P,setAccountGroupsOptimistic:B,setCategoriesOptimistic:Q,setCategoryGroupsOptimistic:le,refreshBudget:J,getOnBudgetTotal:z}}function Tl(t,e,n){const i=nk(t,e,n,{enabled:!!t}),{addIncome:a}=mk(),{updateIncome:l}=pk(),{deleteIncome:u}=gk(),{addExpense:f}=yk(),{updateExpense:p}=_k(),{deleteExpense:g}=vk(),_=i.data?.month||null,v=_?.income||[],x=_?.expenses||[],w=_?.category_balances||[],A=_?.total_income||0,I=_?.total_expenses||0,N=_?.are_allocations_finalized||!1,H=_?.previous_month_income??0,$=T.useCallback(async(R,M,j,O,C)=>{if(!t)throw new Error("No budget selected");const[Y,U]=j.split("-").map(Number);await a(t,Y,U,R,M,j,O,C)},[t,a]),q=T.useCallback(async(R,M,j,O,C,Y)=>{if(!t)throw new Error("No budget selected");await l(t,e,n,R,M,j,O,C,Y)},[t,e,n,l]),me=T.useCallback(async R=>{if(!t)throw new Error("No budget selected");await u(t,e,n,R)},[t,e,n,u]),re=T.useCallback(async(R,M,j,O,C,Y,U)=>{if(!t)throw new Error("No budget selected");const[P,B]=O.split("-").map(Number);await f(t,P,B,R,M,j,O,C,Y,U)},[t,f]),he=T.useCallback(async(R,M,j,O,C,Y,U,P)=>{if(!t)throw new Error("No budget selected");await p(t,e,n,R,M,j,O,C,Y,U,P)},[t,e,n,p]),L=T.useCallback(async R=>{if(!t)throw new Error("No budget selected");await g(t,e,n,R)},[t,e,n,g]),D=T.useCallback(async()=>{t&&await Dt.invalidateQueries({queryKey:xe.month(t,e,n)})},[t,e,n]);return{isLoading:i.isLoading,isFetching:i.isFetching,error:i.error,month:_,income:v,expenses:x,categoryBalances:w,totalIncome:A,totalExpenses:I,areAllocationsFinalized:N,previousMonthIncome:H,addIncome:$,updateIncome:q,deleteIncome:me,addExpense:re,updateExpense:he,deleteExpense:L,refreshMonth:D}}function ZP(){const{selectedBudgetId:t,currentUserId:e}=wn(),{budget:n,accounts:i,accountGroups:a,saveAccounts:l,saveAccountGroups:u,saveAccountsAndGroups:f,setAccountsOptimistic:p,setAccountGroupsOptimistic:g}=Gn(t,e),[_,v]=T.useState(null),x=T.useMemo(()=>Object.entries(i).reduce((D,[R,M])=>{const j=M.account_group_id||"ungrouped";return D[j]||(D[j]=[]),D[j].push({...M,id:R}),D},{}),[i]),w=T.useMemo(()=>Object.entries(a).sort(([,D],[,R])=>D.sort_order-R.sort_order).map(([D,R])=>({...R,id:D})),[a]),A=T.useCallback((D,R)=>{if(!n)return;const M=Object.values(i).filter(U=>R==="ungrouped"?!U.account_group_id:U.account_group_id===R),j=M.length>0?Math.max(...M.map(U=>U.sort_order)):-1,O=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,C={nickname:D.nickname,description:"",balance:0,account_group_id:R==="ungrouped"?null:R,sort_order:j+1,is_income_account:D.is_income_account??!1,is_income_default:D.is_income_default??!1,is_outgo_account:D.is_outgo_account??!1,is_outgo_default:D.is_outgo_default??!1,on_budget:D.on_budget!==!1,is_active:D.is_active!==!1},Y={...i};D.is_income_default&&Object.keys(Y).forEach(U=>{Y[U]={...Y[U],is_income_default:!1}}),D.is_outgo_default&&Object.keys(Y).forEach(U=>{Y[U]={...Y[U],is_outgo_default:!1}}),Y[O]=C,p(Y),l(Y).catch(U=>{console.error("[useAccountHandlers] Error creating account:",U),v(U instanceof Error?U.message:"Failed to create account.")})},[n,i,p,l]),I=T.useCallback((D,R)=>{if(!n)return;const M=i[D];if(!M)return;const j=M.account_group_id||"ungrouped",O=R.account_group_id;let C=M.sort_order;if(j!==(O||"ungrouped")){const U=Object.values(i).filter(P=>(P.account_group_id||"ungrouped")===(O||"ungrouped"));C=U.length>0?Math.max(...U.map(P=>P.sort_order))+1:0}const Y={};Object.entries(i).forEach(([U,P])=>{U===D?Y[U]={...P,nickname:R.nickname,account_group_id:O,sort_order:C,is_income_account:R.is_income_account??!1,is_income_default:R.is_income_default??!1,is_outgo_account:R.is_outgo_account??!1,is_outgo_default:R.is_outgo_default??!1,on_budget:R.on_budget!==!1,is_active:R.is_active!==!1}:(Y[U]={...P},R.is_income_default&&!M.is_income_default&&(Y[U].is_income_default=!1),R.is_outgo_default&&!M.is_outgo_default&&(Y[U].is_outgo_default=!1))}),p(Y),l(Y).catch(U=>{console.error("[useAccountHandlers] Error saving account:",U),v(U instanceof Error?U.message:"Failed to save account.")})},[n,i,p,l]),N=T.useCallback(D=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[D]:R,...M}=i;p(M),l(M).catch(j=>{console.error("[useAccountHandlers] Error deleting account:",j),v(j instanceof Error?j.message:"Failed to delete account.")})},[n,i,p,l]),H=T.useCallback(async(D,R)=>{const M=i[D];if(!M)return;const j=M.account_group_id||"ungrouped",O=Object.entries(i).filter(([,Q])=>(Q.account_group_id||"ungrouped")===j).sort(([,Q],[,le])=>Q.sort_order-le.sort_order),C=O.findIndex(([Q])=>Q===D),Y=R==="up"?C-1:C+1;if(Y<0||Y>=O.length)return;const[U,P]=O[Y],B={};if(Object.entries(i).forEach(([Q,le])=>{Q===D?B[Q]={...le,sort_order:P.sort_order}:Q===U?B[Q]={...le,sort_order:M.sort_order}:B[Q]={...le}}),p(B),!!n)try{await l(B)}catch(Q){p(i),v(Q instanceof Error?Q.message:"Failed to move account")}},[n,i,p,l]),$=T.useCallback(D=>{if(!n)return;const R=Object.values(a).map(Y=>Y.sort_order),M=R.length>0?Math.max(...R):-1,j=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,O={name:D.name,sort_order:M+1,expected_balance:D.expected_balance,on_budget:D.on_budget,is_active:D.is_active},C={...a,[j]:O};g(C),u(C).catch(Y=>{console.error("[useAccountHandlers] Error creating group:",Y),v(Y instanceof Error?Y.message:"Failed to create account type.")})},[n,a,g,u]),q=T.useCallback((D,R)=>{if(!n)return;const M={...a,[D]:{...a[D],name:R.name,expected_balance:R.expected_balance,on_budget:R.on_budget,is_active:R.is_active}};g(M),u(M).catch(j=>{console.error("[useAccountHandlers] Error updating group:",j),v(j instanceof Error?j.message:"Failed to update account type.")})},[n,a,g,u]),me=T.useCallback(D=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const R={};Object.entries(i).forEach(([O,C])=>{R[O]=C.account_group_id===D?{...C,account_group_id:null}:C});const{[D]:M,...j}=a;p(R),g(j),f(R,j).catch(O=>{console.error("[useAccountHandlers] Error deleting group:",O),v(O instanceof Error?O.message:"Failed to delete account type.")})},[n,i,a,p,g,f]),re=T.useCallback(async(D,R)=>{const M=Object.entries(a).sort(([,U],[,P])=>U.sort_order-P.sort_order),j=M.findIndex(([U])=>U===D),O=R==="up"?j-1:j+1;if(O<0||O>=M.length)return;const[C]=M.splice(j,1);M.splice(O,0,C);const Y={};if(M.forEach(([U,P],B)=>{Y[U]={...P,sort_order:B}}),g(Y),!!n)try{await u(Y)}catch(U){g(a),v(U instanceof Error?U.message:"Failed to move account type")}},[n,a,g,u]),he=T.useCallback(async(D,R,M)=>{const j=i[D];if(!j)return;const O=M==="ungrouped"?null:M,C=Object.entries(i).filter(([,P])=>(P.account_group_id||"ungrouped")===M),Y={};Object.entries(i).forEach(([P,B])=>{P!==D&&(Y[P]={...B})});let U;if(R==="__group_end__"||C.length===0||!C.find(([P])=>P===R))U=(C.length>0?Math.max(...C.filter(([B])=>B!==D).map(([,B])=>B.sort_order)):-1)+1;else{const P=C.find(([B])=>B===R);if(P){const[,B]=P;U=B.sort_order,Object.entries(Y).forEach(([Q,le])=>{(le.account_group_id||"ungrouped")===M&&le.sort_order>=U&&(Y[Q]={...le,sort_order:le.sort_order+1})})}else U=0}if(Y[D]={...j,account_group_id:O,sort_order:U},p(Y),!!n)try{await l(Y)}catch(P){v(P instanceof Error?P.message:"Failed to save changes")}},[n,i,p,l]),L=T.useCallback(async(D,R)=>{if(D===R)return;const M=Object.entries(a).sort(([,U],[,P])=>U.sort_order-P.sort_order),j=M.findIndex(([U])=>U===D),O=[...M],[C]=O.splice(j,1);if(R==="__end__")O.push(C);else{const U=O.findIndex(([P])=>P===R);O.splice(U,0,C)}const Y={};if(O.forEach(([U,P],B)=>{Y[U]={...P,sort_order:B}}),g(Y),!!n)try{await u(Y)}catch(U){v(U instanceof Error?U.message:"Failed to save new order")}},[n,a,g,u]);return{accounts:i,accountGroups:a,accountsByGroup:x,sortedGroups:w,currentBudget:n,error:_,setError:v,handleCreateAccount:A,handleUpdateAccount:I,handleDeleteAccount:N,handleMoveAccount:H,handleCreateGroup:$,handleUpdateGroup:q,handleDeleteGroup:me,handleMoveGroup:re,reorderAccountsInGroup:he,reorderGroups:L}}function xE(t,e){if(!t)return{};const n={};return Object.entries(e).forEach(([i,a])=>{if(a.default_monthly_type==="percentage")return;const l=t.category_balances?.find(u=>u.category_id===i);l&&l.allocated>0?n[i]=l.allocated.toString():a.default_monthly_amount!==void 0&&a.default_monthly_amount>0?n[i]=a.default_monthly_amount.toString():n[i]=""}),n}function e4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=wn(),{categories:a,getOnBudgetTotal:l}=Gn(t,e),{month:u,isLoading:f,previousMonthIncome:p,areAllocationsFinalized:g}=Tl(t,n,i),{saveDraftAllocations:_}=dk(),{finalizeAllocations:v}=hk(),{deleteAllocations:x}=fk(),w=T.useMemo(()=>xE(u,a),[u,a]),[A,I]=T.useState(w),[N,H]=T.useState(!1),[$,q]=T.useState(!1),[me,re]=T.useState(!1),[he,L]=T.useState(!1),[D,R]=T.useState(null),M=T.useRef(null),j=T.useMemo(()=>Object.values(a).reduce((se,pe)=>se+(pe.balance??0),0),[a]);T.useEffect(()=>{if(!u)return;const se=`${u.year}-${u.month}`;M.current!==se&&(I(xE(u,a)),M.current=se)},[u,a]);const O=T.useCallback((se,pe)=>{if(pe.default_monthly_type==="percentage"&&pe.default_monthly_amount!==void 0)return pe.default_monthly_amount/100*p;const de=A[se],be=parseFloat(de||"0");return isNaN(be)?0:be},[A,p]),C=T.useMemo(()=>Object.entries(a).reduce((se,[pe,de])=>se+O(pe,de),0),[a,O]),Y=l(),U=g?(u?.category_balances||[]).reduce((se,pe)=>se+pe.allocated,0):0,P=Y-j,B=T.useMemo(()=>P-C+U,[P,C,U]),Q=T.useCallback((se,pe)=>{I(de=>({...de,[se]:pe}))},[]),le=T.useCallback(()=>{if(!u)return;const se={};Object.entries(a).forEach(([pe,de])=>{if(de.default_monthly_type==="percentage")return;const be=u.category_balances?.find(Se=>Se.category_id===pe);be&&be.allocated>0?se[pe]=be.allocated.toString():de.default_monthly_amount!==void 0&&de.default_monthly_amount>0?se[pe]=de.default_monthly_amount.toString():se[pe]=""}),I(se),L(!1)},[u,a]),J=T.useCallback(()=>{const se={};return Object.entries(a).forEach(([pe,de])=>{const be=O(pe,de);be>0&&(se[pe]=be)}),se},[a,O]),z=T.useCallback(async()=>{if(t){R(null),H(!0);try{await _(t,n,i,J()),L(!1)}catch(se){R(se instanceof Error?se.message:"Failed to save allocations")}finally{H(!1)}}},[t,n,i,_,J]),F=T.useCallback(async()=>{if(t){R(null),q(!0);try{await v({budgetId:t,year:n,month:i,allocations:J()}),L(!1)}catch(se){R(se instanceof Error?se.message:"Failed to finalize allocations")}finally{q(!1)}}},[t,n,i,v,J]),W=T.useCallback(async()=>{if(t){R(null),re(!0);try{await x({budgetId:t,year:n,month:i});const se={};Object.entries(a).forEach(([pe,de])=>{de.default_monthly_type!=="percentage"&&(de.default_monthly_amount!==void 0&&de.default_monthly_amount>0?se[pe]=de.default_monthly_amount.toString():se[pe]="")}),I(se),L(!1)}catch(se){R(se instanceof Error?se.message:"Failed to delete allocations")}finally{re(!1)}}},[t,n,i,x,a]),te=C-U;return{localAllocations:A,isSavingAllocations:N,isFinalizingAllocations:$,isDeletingAllocations:me,isEditingAppliedAllocations:he,error:D,monthLoading:f,onBudgetTotal:Y,availableNow:P,currentDraftTotal:C,draftChangeAmount:te,availableAfterApply:B,previousMonthIncome:p,allocationsFinalized:g,getAllocationAmount:O,handleAllocationChange:Q,resetAllocationsToSaved:le,handleSaveAllocations:z,handleFinalizeAllocations:F,handleDeleteAllocations:W,setIsEditingAppliedAllocations:L,setError:R}}function t4({budgetId:t,categories:e,currentYear:n,currentMonth:i,updateCategoriesWithBalances:a}){const l=T.useMemo(()=>{const x={};return Object.entries(e).forEach(([w,A])=>{x[w]={current:A.balance??0,total:A.balance??0}}),x},[e]),[u,f]=T.useState(!1),[p,g]=T.useState(null),_=T.useCallback(async()=>{if(!t||Object.keys(e).length===0)return null;const x=Object.keys(e),{total:w}=await eE(t,x,n,i),A={};Object.entries(e).forEach(([N,H])=>{const $=H.balance,q=w[N]??0;Math.abs($-q)>.01&&(A[N]={stored:$,calculated:q})});const I=Object.keys(A).length>0?A:null;return g(I),I},[t,e,n,i]),v=T.useCallback(async()=>{if(!(!t||Object.keys(e).length===0)){f(!0);try{const x=Object.keys(e),{total:w}=await eE(t,x,n,i),A={};Object.entries(e).forEach(([I,N])=>{A[I]={...N,balance:w[I]??0}}),await a(A),g(null)}finally{f(!1)}}},[t,e,a,n,i]);return{categoryBalances:l,loadingBalances:u,categoryBalanceMismatch:p,checkCategoryBalanceMismatch:_,recalculateAndSaveCategoryBalances:v}}function n4({categories:t,categoryGroups:e,currentBudget:n,setCategoriesOptimistic:i,setCategoryGroupsOptimistic:a,saveCategories:l,saveCategoryGroups:u,setError:f}){const[p,g]=T.useState(null),[_,v]=T.useState(null),[x,w]=T.useState(null),[A,I]=T.useState(null);function N(M,j){g("category"),v(j),M.dataTransfer.effectAllowed="move"}function H(M,j,O){M.preventDefault(),p==="category"&&(j!==_&&w(j),I(O))}function $(M,j){M.preventDefault(),p==="category"?(I(j),w(null)):p==="group"&&j!==_&&w(j)}function q(){w(null)}function me(){I(null)}function re(){g(null),v(null),w(null),I(null)}async function he(M,j,O){if(M.preventDefault(),M.stopPropagation(),!_||p!=="category"){re();return}const C=t[_];if(!C)return;const Y=O==="ungrouped"?null:O,U=Object.entries(t).filter(([,Q])=>(Q.category_group_id||"ungrouped")===O),P={};Object.entries(t).forEach(([Q,le])=>{Q!==_&&(P[Q]=le)});let B;if(j==="__group_end__"||U.length===0||!U.find(([Q])=>Q===j))B=(U.length>0?Math.max(...U.filter(([le])=>le!==_).map(([,le])=>le.sort_order)):-1)+1;else{const Q=U.find(([le])=>le===j);Q?(B=Q[1].sort_order,Object.entries(P).forEach(([le,J])=>{(J.category_group_id||"ungrouped")===O&&J.sort_order>=B&&(P[le]={...J,sort_order:J.sort_order+1})})):B=0}if(P[_]={...C,category_group_id:Y,sort_order:B},i(P),re(),!!n)try{await l(P)}catch(Q){f(Q instanceof Error?Q.message:"Failed to save changes")}}async function L(M,j){M.preventDefault(),p==="category"?await he(M,"__group_end__",j):p==="group"&&await R(M,j)}function D(M,j){M.stopPropagation(),g("group"),v(j),M.dataTransfer.effectAllowed="move"}async function R(M,j){if(M.preventDefault(),!_||p!=="group"||_===j){re();return}const O=e.findIndex(P=>P.id===_),C=[...e],[Y]=C.splice(O,1);if(j==="__end__")C.push(Y);else{const P=C.findIndex(B=>B.id===j);C.splice(P,0,Y)}const U=C.map((P,B)=>({...P,sort_order:B}));if(a(U),re(),!!n)try{await u(U)}catch(P){f(P instanceof Error?P.message:"Failed to save new order")}}return{dragType:p,draggedId:_,dragOverId:x,dragOverGroupId:A,setDragOverId:w,setDragOverGroupId:I,handleCategoryDragStart:N,handleCategoryDragOver:H,handleDragOverGroup:$,handleDragLeave:q,handleDragLeaveGroup:me,handleDragEnd:re,handleCategoryDrop:he,handleDropOnGroup:L,handleGroupDragStart:D,handleGroupDrop:R}}function r4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=wn(),{budget:a,categories:l,categoryGroups:u,isLoading:f,saveCategories:p,saveCategoryGroups:g,saveCategoriesAndGroups:_,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:x,getOnBudgetTotal:w}=Gn(t,e),[A,I]=T.useState(null),{categoryBalances:N,loadingBalances:H,categoryBalanceMismatch:$,checkCategoryBalanceMismatch:q,recalculateAndSaveCategoryBalances:me}=t4({budgetId:t,categories:l,currentYear:n,currentMonth:i,updateCategoriesWithBalances:p}),re=n4({categories:l,categoryGroups:u,currentBudget:a,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:x,saveCategories:p,saveCategoryGroups:g,setError:I});async function he(P,B){if(!a)return;const Q=B==="ungrouped"?null:B,le=Object.values(l).filter(te=>B==="ungrouped"?!te.category_group_id:te.category_group_id===B),J=le.length>0?Math.max(...le.map(te=>te.sort_order)):-1,z=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,F={name:P.name,description:P.description??"",category_group_id:Q,sort_order:J+1,default_monthly_amount:P.default_monthly_amount??0,default_monthly_type:P.default_monthly_type??"fixed",balance:0},W={...l,[z]:F};v(W);try{await p(W)}catch(te){v(l),I(te instanceof Error?te.message:"Failed to create category")}}async function L(P,B){if(a)try{const Q=l[P];if(!Q)return;const le=Q.category_group_id||"ungrouped",J=B.category_group_id;let z=Q.sort_order;if(le!==(J||"ungrouped")){const W=Object.values(l).filter(te=>(te.category_group_id||"ungrouped")===(J||"ungrouped")).filter((te,se,pe)=>l[P]!==pe[se]);z=W.length>0?Math.max(...W.map(te=>te.sort_order))+1:0}const F={...l,[P]:{...Q,name:B.name,description:B.description??"",category_group_id:J,sort_order:z,default_monthly_amount:B.default_monthly_amount??0,default_monthly_type:B.default_monthly_type??"fixed"}};v(F),await p(F)}catch(Q){I(Q instanceof Error?Q.message:"Failed to update category")}}async function D(P){if(confirm("Are you sure you want to delete this category?")&&a)try{const{[P]:B,...Q}=l;v(Q),await p(Q)}catch(B){I(B instanceof Error?B.message:"Failed to delete category")}}async function R(P,B){const Q=l[P];if(!Q)return;const le=Q.category_group_id||"ungrouped",J=Object.entries(l).filter(([,pe])=>(pe.category_group_id||"ungrouped")===le).sort((pe,de)=>pe[1].sort_order-de[1].sort_order),z=J.findIndex(([pe])=>pe===P),F=B==="up"?z-1:z+1;if(F<0||F>=J.length)return;const[W,te]=J[F],se={};if(Object.entries(l).forEach(([pe,de])=>{pe===P?se[pe]={...de,sort_order:te.sort_order}:pe===W?se[pe]={...de,sort_order:Q.sort_order}:se[pe]=de}),v(se),!!a)try{await p(se)}catch(pe){v(l),I(pe instanceof Error?pe.message:"Failed to move category")}}async function M(P){if(a)try{const B=u.length>0?Math.max(...u.map(J=>J.sort_order)):-1,Q={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:P.name,sort_order:B+1},le=[...u,Q];x(le),await g(le)}catch(B){I(B instanceof Error?B.message:"Failed to create group")}}async function j(P,B){if(a)try{const Q=u.map(le=>le.id===P?{...le,name:B.name}:le);x(Q),await g(Q)}catch(Q){I(Q instanceof Error?Q.message:"Failed to update group")}}async function O(P){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&a)try{const B={};Object.entries(l).forEach(([le,J])=>{B[le]=J.category_group_id===P?{...J,category_group_id:null}:J});const Q=u.filter(le=>le.id!==P);v(B),x(Q),await _(B,Q)}catch(B){I(B instanceof Error?B.message:"Failed to delete group")}}async function C(P,B){const Q=[...u].sort((W,te)=>W.sort_order-te.sort_order),le=Q.findIndex(W=>W.id===P),J=B==="up"?le-1:le+1;if(J<0||J>=Q.length)return;const[z]=Q.splice(le,1);Q.splice(J,0,z);const F=Q.map((W,te)=>({...W,sort_order:te}));if(x(F),!!a)try{await g(F)}catch(W){x(u),I(W instanceof Error?W.message:"Failed to move group")}}const Y=Object.entries(l).reduce((P,[B,Q])=>{const le=Q.category_group_id||"ungrouped";return P[le]||(P[le]=[]),P[le].push([B,Q]),P},{}),U=[...u].sort((P,B)=>P.sort_order-B.sort_order);return{currentBudget:a,categories:l,categoryGroups:u,categoriesByGroup:Y,sortedGroups:U,categoryBalances:N,isLoading:f,loadingBalances:H,error:A,setError:I,getOnBudgetTotal:w,categoryBalanceMismatch:$,checkCategoryBalanceMismatch:q,recalculateAndSaveCategoryBalances:me,handleCreateCategory:he,handleUpdateCategory:L,handleDeleteCategory:D,handleMoveCategory:R,handleCreateGroup:M,handleUpdateGroup:j,handleDeleteGroup:O,handleMoveGroup:C,dragType:re.dragType,draggedId:re.draggedId,dragOverId:re.dragOverId,dragOverGroupId:re.dragOverGroupId,setDragOverId:re.setDragOverId,setDragOverGroupId:re.setDragOverGroupId,handleCategoryDragStart:re.handleCategoryDragStart,handleCategoryDragOver:re.handleCategoryDragOver,handleDragOverGroup:re.handleDragOverGroup,handleDragLeave:re.handleDragLeave,handleDragLeaveGroup:re.handleDragLeaveGroup,handleDragEnd:re.handleDragEnd,handleCategoryDrop:re.handleCategoryDrop,handleDropOnGroup:re.handleDropOnGroup,handleGroupDragStart:re.handleGroupDragStart,handleGroupDrop:re.handleGroupDrop}}function EE(t){return{nickname:t.nickname??"",description:t.description??"",balance:t.balance??0,account_group_id:t.account_group_id??null,sort_order:t.sort_order??0,is_income_account:t.is_income_account??!1,is_income_default:t.is_income_default??!1,is_outgo_account:t.is_outgo_account??!1,is_outgo_default:t.is_outgo_default??!1,on_budget:t.on_budget??!0,is_active:t.is_active??!0}}function SE(t){return{name:t.name??"",description:t.description??"",category_group_id:t.category_group_id??null,sort_order:t.sort_order??0,default_monthly_amount:t.default_monthly_amount??0,default_monthly_type:t.default_monthly_type??"fixed",balance:t.balance??0}}function wE(t){return{name:t.name??"",sort_order:t.sort_order??0,...t.expected_balance!==void 0&&{expected_balance:t.expected_balance},...t.on_budget!==void 0&&{on_budget:t.on_budget},...t.is_active!==void 0&&{is_active:t.is_active}}}function i4(t,e){const n=e.match(/_(\d{4})(\d{2})$/),i=n?parseInt(n[1]):new Date().getFullYear(),a=n?parseInt(n[2]):new Date().getMonth()+1,l=`${i}${String(a).padStart(2,"0")}`;return{budget_id:t.budget_id??"",year_month_ordinal:t.year_month_ordinal??l,year:t.year??i,month:t.month??a,income:Array.isArray(t.income)?t.income:[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:Array.isArray(t.expenses)?t.expenses:[],total_expenses:t.total_expenses??0,account_balances:Array.isArray(t.account_balances)?t.account_balances:[],category_balances:Array.isArray(t.category_balances)?t.category_balances:[],are_allocations_finalized:t.are_allocations_finalized??!1,is_needs_recalculation:t.is_needs_recalculation??!0,created_at:t.created_at??new Date().toISOString(),updated_at:t.updated_at??new Date().toISOString()}}function TE(t){return t.nickname===void 0||t.description===void 0||t.balance===void 0||t.sort_order===void 0||t.is_income_account===void 0||t.is_income_default===void 0||t.is_outgo_account===void 0||t.is_outgo_default===void 0||t.on_budget===void 0||t.is_active===void 0}function AE(t){return t.name===void 0||t.description===void 0||t.sort_order===void 0||t.default_monthly_amount===void 0||t.default_monthly_type===void 0||t.balance===void 0}function CE(t){return t.name===void 0||t.sort_order===void 0}function RE(t){return t.budget_id===void 0||t.year_month_ordinal===void 0||t.year===void 0||t.month===void 0||!Array.isArray(t.income)||t.total_income===void 0||t.previous_month_income===void 0||!Array.isArray(t.expenses)||t.total_expenses===void 0||!Array.isArray(t.account_balances)||!Array.isArray(t.category_balances)||t.are_allocations_finalized===void 0||t.is_needs_recalculation===void 0||t.created_at===void 0||t.updated_at===void 0}function DE(){const t=new Date,e=t.getFullYear();let i=t.getMonth()+1+2,a=e;return i>12&&(i-=12,a+=1),{year:a,month:i}}function IE(t,e,n){return t>n.year||t===n.year&&e>n.month}function s4({currentUser:t,onComplete:e}){const[n,i]=T.useState(!1),[a,l]=T.useState(!1),[u,f]=T.useState(null),[p,g]=T.useState(null);async function _(){if(t){i(!0);try{const A=await Nr("budgets","database cleanup: scanning all budgets");let I=0,N=0,H=0,$=0,q=0,me=0,re=0;for(const M of A.docs){const j=M.data;if(Array.isArray(j.accounts)||Array.isArray(j.categories)||Array.isArray(j.account_groups)){I++;continue}const O=j.accounts;if(O&&typeof O=="object"){let U=!1;for(const P of Object.values(O))TE(P)&&(q++,U=!0);U&&N++}const C=j.categories;if(C&&typeof C=="object"){let U=!1;for(const P of Object.values(C))AE(P)&&(me++,U=!0);U&&H++}const Y=j.account_groups;if(Y&&typeof Y=="object"){let U=!1;for(const P of Object.values(Y))CE(P)&&(re++,U=!0);U&&$++}}const he=await Nr("months","database cleanup: scanning all months"),L=DE(),D=[];let R=0;for(const M of he.docs){const j=M.data,O=j.year,C=j.month;O&&C&&IE(O,C,L)&&D.push({docId:M.id,budgetId:j.budget_id,year:O,month:C}),RE(j)&&R++}D.sort((M,j)=>M.year!==j.year?M.year-j.year:M.month-j.month),f({totalBudgets:A.docs.length,budgetsWithArrays:I,budgetsWithMissingAccountDefaults:N,budgetsWithMissingCategoryDefaults:H,budgetsWithMissingGroupDefaults:$,accountsNeedingDefaults:q,categoriesNeedingDefaults:me,groupsNeedingDefaults:re,totalMonths:he.docs.length,futureMonthsToDelete:D,monthsWithSchemaIssues:R})}catch(A){console.error("Failed to scan database:",A)}finally{i(!1)}}}async function v(){if(!t)return;l(!0),g(null);const A=[];let I=0,N=0,H=0,$=0,q=0,me=0,re=0;try{const he=await Nr("budgets","database cleanup: reading all budgets to fix");for(const R of he.docs)try{const{exists:M,data:j}=await Qe("budgets",R.id,"database cleanup: reading budget for update");if(!M||!j)continue;let O=!1;const C={...j};if(Array.isArray(j.accounts)){const Y=j.accounts,U={};for(const P of Y){const B=P.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;U[B]=EE(P),N++}C.accounts=U,O=!0,q++}if(Array.isArray(j.categories)){const Y=j.categories,U={};for(const P of Y){const B=P.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;U[B]=SE(P),H++}C.categories=U,O=!0,q++}if(Array.isArray(j.account_groups)){const Y=j.account_groups,U={};for(const P of Y){const B=P.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;U[B]=wE(P),$++}C.account_groups=U,O=!0,q++}if(!Array.isArray(j.accounts)&&j.accounts&&typeof j.accounts=="object"){const Y=j.accounts,U={};for(const[P,B]of Object.entries(Y))TE(B)?(U[P]=EE(B),N++,O=!0):U[P]=B;O&&(C.accounts=U)}if(!Array.isArray(j.categories)&&j.categories&&typeof j.categories=="object"){const Y=j.categories,U={};let P=!1;for(const[B,Q]of Object.entries(Y))AE(Q)?(U[B]=SE(Q),H++,P=!0):U[B]=Q;P&&(C.categories=U,O=!0)}if(!Array.isArray(j.account_groups)&&j.account_groups&&typeof j.account_groups=="object"){const Y=j.account_groups,U={};let P=!1;for(const[B,Q]of Object.entries(Y))CE(Q)?(U[B]=wE(Q),$++,P=!0):U[B]=Q;P&&(C.account_groups=U,O=!0)}C.is_needs_recalculation===void 0&&(C.is_needs_recalculation=!1,O=!0),delete C.category_balances,delete C.allocations,delete C.allocations_finalized,O&&(await _t("budgets",R.id,C,"database cleanup: saving fixed budget"),I++)}catch(M){A.push(`Budget ${R.id}: ${M instanceof Error?M.message:"Unknown error"}`)}const L=await Nr("months","database cleanup: reading all months"),D=DE();for(const R of L.docs)try{const M=R.data,j=M.year,O=M.month;if(j&&O&&IE(j,O,D)){await Sy("months",R.id,`database cleanup: deleting future month ${j}-${O}`),me++;continue}if(RE(M)){const C=i4(M,R.id);await _t("months",R.id,C,"database cleanup: saving fixed month"),re++}}catch(M){A.push(`Month ${R.id}: ${M instanceof Error?M.message:"Unknown error"}`)}g({budgetsProcessed:I,accountsFixed:N,categoriesFixed:H,groupsFixed:$,arraysConverted:q,futureMonthsDeleted:me,monthsFixed:re,errors:A}),e?.()}catch(he){g({budgetsProcessed:0,accountsFixed:0,categoriesFixed:0,groupsFixed:0,arraysConverted:0,futureMonthsDeleted:0,monthsFixed:0,errors:[he instanceof Error?he.message:"Unknown error"]})}finally{l(!1)}}const x=u!==null&&(u.budgetsWithArrays>0||u.accountsNeedingDefaults>0||u.categoriesNeedingDefaults>0||u.groupsNeedingDefaults>0||u.futureMonthsToDelete.length>0||u.monthsWithSchemaIssues>0),w=u!==null?u.budgetsWithArrays+u.accountsNeedingDefaults+u.categoriesNeedingDefaults+u.groupsNeedingDefaults+u.futureMonthsToDelete.length+u.monthsWithSchemaIssues:0;return{status:u,isScanning:n,scanStatus:_,hasIssues:x,totalIssues:w,isRunning:a,result:p,runCleanup:v}}function Up(t){return t.includes("@")?!1:!!(/_[a-z0-9]+_(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=2||/_[a-z0-9]+\.(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=1)}function a4(t){let e=t;const n=/^(.+)_(gmail|yahoo|hotmail|outlook|icloud|aol|proton|protonmail)\.(.+)$/i,i=e.match(n);return i?`${i[1]}@${i[2]}.${i[3]}`:(e=e.replace(/_com$/,".com").replace(/_net$/,".net").replace(/_org$/,".org").replace(/_edu$/,".edu").replace(/_io$/,".io"),e=e.replace(/_gmail_/,"@gmail.").replace(/_yahoo_/,"@yahoo.").replace(/_hotmail_/,"@hotmail.").replace(/_outlook_/,"@outlook.").replace(/_icloud_/,"@icloud."),e)}function fh(t){if(t===null||typeof t!="object"||Array.isArray(t))return!1;const e=t;return e._methodName==="arrayUnion"&&Array.isArray(e.vc)}function r1(t){return t.vc||[]}function jE(t){return Array.isArray(t.items)?t.items:fh(t.items)?r1(t.items):[]}function o4({currentUser:t}){const[e,n]=T.useState(!1),[i,a]=T.useState(!1),[l,u]=T.useState(null),[f,p]=T.useState(null);async function g(){if(!t)return;n(!0);const v={documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],isHealthy:!0};try{const x=await Nr("feedback","feedback migration: scanning for issues");v.documentsFound=x.docs.length;for(const w of x.docs)Up(w.id)&&v.sanitizedDocuments.push(w.id),fh(w.data.items)&&v.corruptedDocuments.push(w.id);v.isHealthy=v.sanitizedDocuments.length===0&&v.corruptedDocuments.length===0,u(v)}catch(x){console.error("Failed to scan feedback:",x)}finally{n(!1)}}async function _(){if(!t)return;a(!0);const v=f?{...f,mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]}:{documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]};try{const x=await Nr("feedback","feedback migration: listing all documents");v.documentsFound=x.docs.length,v.sanitizedDocuments=[],v.corruptedDocuments=[];for(const w of x.docs){const A=Up(w.id);if(fh(w.data.items)&&!A){v.corruptedDocuments.push(w.id);const N=r1(w.data.items);try{await _t("feedback",w.id,{items:N,user_email:w.data.user_email||w.id,created_at:w.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: fixing corrupted arrayUnion in ${w.id}`),v.fixedDocuments++}catch(H){v.errors.push(`Failed to fix ${w.id}: ${H instanceof Error?H.message:"Unknown error"}`)}}}for(const w of x.docs)if(Up(w.id)){v.sanitizedDocuments.push(w.id);const A=w.id,I=a4(A),N=jE(w.data),{exists:H,data:$}=await Qe("feedback",I,`feedback migration: checking if ${I} exists`);if(H&&$){const q=jE($),me=new Set(q.map(he=>he.id)),re=N.filter(he=>!me.has(he.id));if(re.length>0||fh($.items)){const he=[...q,...re];await _t("feedback",I,{...$,items:he,updated_at:new Date().toISOString()},`feedback migration: merging ${re.length} items from ${A}`),v.mergedItems+=re.length}}else N.length>0&&(await _t("feedback",I,{items:N,user_email:I,created_at:w.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: creating ${I} from ${A}`),v.mergedItems+=N.length);try{await Sy("feedback",A,`feedback migration: deleting sanitized document ${A}`),v.deletedDocuments++}catch(q){v.errors.push(`Failed to delete ${A}: ${q instanceof Error?q.message:"Unknown error"}`)}}p(v)}catch(x){v.errors.push(x instanceof Error?x.message:"Migration failed"),p(v)}finally{a(!1)}}return{status:l,isScanning:e,scanStatus:g,isMigratingFeedback:i,feedbackMigrationResult:f,migrateFeedbackDocuments:_}}function l4({currentUser:t,onComplete:e}){const[n,i]=T.useState(!1),[a,l]=T.useState(!1),[u,f]=T.useState(null),[p,g]=T.useState(null);async function _(){if(t){i(!0);try{const x=await Nr("months","delete all months: scanning for all months"),w=[],A=new Set;for(const I of x.docs){const{budget_id:N,year:H,month:$}=I.data;A.add(N),w.push({docId:I.id,budgetId:N,year:H,month:$})}w.sort((I,N)=>I.budgetId!==N.budgetId?I.budgetId.localeCompare(N.budgetId):I.year!==N.year?I.year-N.year:I.month-N.month),f({monthsToDelete:w,monthsCount:w.length,budgetCount:A.size})}catch(x){console.error("Failed to scan months:",x)}finally{i(!1)}}}async function v(){if(!t||!u||u.monthsToDelete.length===0)return;l(!0),g(null);let x=0;const w=[];for(const A of u.monthsToDelete)try{await Sy("months",A.docId,`delete all months: deleting month ${A.year}-${A.month} for budget ${A.budgetId}`),x++}catch(I){w.push(`Failed to delete ${A.docId}: ${I instanceof Error?I.message:"Unknown error"}`)}g({deleted:x,errors:w}),l(!1),w.length===0&&(f({monthsToDelete:[],monthsCount:0,budgetCount:0}),e?.())}return{status:u,isScanning:n,scanStatus:_,isDeleting:a,deleteResult:p,deleteAllMonths:v}}function c4({onCreateNew:t}){const[e,n]=T.useState(""),[i,a]=T.useState(!1),[l,u]=T.useState(null);async function f(p){p.preventDefault(),a(!0),u(null);try{await t(e.trim()||void 0)}catch(g){u(g instanceof Error?g.message:"Failed to create budget"),a(!1)}}return d.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:l}),d.jsx("button",{onClick:()=>u(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Create Your Budget"]}),d.jsxs("form",{onSubmit:f,children:[d.jsxs("div",{style:{marginBottom:"1.5rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:e,onChange:p=>n(p.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),d.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),d.jsx("button",{type:"submit",disabled:i,style:{width:"100%",background:ue.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontWeight:600,opacity:i?.7:1,fontSize:"1rem"},children:i?"Creating...":"Create Budget"})]})]}),d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function u4({invites:t,onAccept:e,onCreateNew:n}){const[i,a]=T.useState(null),[l,u]=T.useState(!1),[f,p]=T.useState(""),[g,_]=T.useState(!1),[v,x]=T.useState(null);async function w(I){a(I),x(null);try{await e(I)}catch(N){x(N instanceof Error?N.message:"Failed to accept invitation"),a(null)}}async function A(I){I.preventDefault(),_(!0),x(null);try{await n(f.trim()||void 0)}catch(N){x(N instanceof Error?N.message:"Failed to create new budget"),_(!1)}}return d.jsxs("div",{children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>x(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Budget Invitations"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(I=>d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:I.budgetName}),I.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",I.ownerEmail]})]}),d.jsx("button",{onClick:()=>w(I.budgetId),disabled:i!==null||g,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null||g?"not-allowed":"pointer",fontWeight:500,opacity:i!==null||g?.7:1,fontSize:"0.9rem"},children:i===I.budgetId?"Joining...":"Accept & Join"})]},I.budgetId))})]}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?d.jsxs("form",{onSubmit:A,children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),d.jsxs("div",{style:{marginBottom:"1rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:f,onChange:I=>p(I.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{type:"submit",disabled:g||i!==null,style:{background:ue.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||i!==null?"not-allowed":"pointer",fontWeight:500,opacity:g||i!==null?.7:1,fontSize:"0.9rem"},children:g?"Creating...":"Create Budget"}),d.jsx("button",{type:"button",onClick:()=>{u(!1),p("")},disabled:g,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g?"not-allowed":"pointer",fontWeight:500,opacity:g?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),d.jsx("button",{onClick:()=>u(!0),disabled:i!==null,style:{background:ue.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null?"not-allowed":"pointer",fontWeight:500,opacity:i!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function d4({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const i=T.useMemo(()=>[{id:"income",label:"Income"},{id:"balances",label:"Balances",checkmark:n},{id:"spend",label:"Spend"}],[n]);return d.jsx(Uy,{mode:"button",tabs:i,activeTab:t,onTabChange:a=>e(a)})}function h4({isOpen:t,onClose:e,onProceed:n,results:i}){const a=!i||i.status==="confirming",l=i&&!["confirming","done","error"].includes(i.status),u=a||i?.status==="done"||i?.status==="error";function f(){u&&e()}return d.jsx(al,{isOpen:t,onClose:f,title:"Recalculate Balances",width:"540px",children:d.jsxs("div",{style:{padding:"0.5rem 0"},children:[a&&d.jsxs(d.Fragment,{children:[d.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",lineHeight:1.5},children:["This will recalculate category balances and account balances from the ",d.jsx("strong",{children:"current month forward"}),"."]}),d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Use this if your data seems out of sync or after fixing bugs. Past months will not be modified."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginBottom:"1.5rem"},children:[d.jsx(Mo,{status:"waiting",label:"Find all months to process"}),d.jsx(Mo,{status:"waiting",label:"Process months"}),d.jsx(Mo,{status:"waiting",label:"Update budget totals"})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Le,{variant:"secondary",onClick:e,children:"Cancel"}),d.jsx(Le,{onClick:n,children:"Proceed"})]})]}),!a&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Recalculating category balances and account balances..."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx(Mo,{status:i?.status==="pending"?"waiting":"complete",label:"Find all months to process",detail:i&&i.status!=="pending"?`Found ${i.monthsFound||0} month${i.monthsFound!==1?"s":""}`:void 0}),d.jsx(Mo,{status:OE(i?.status,["pending","finding_months"],"processing_months"),label:"Process months",detail:i?.status==="processing_months"?`Processing: ${i.currentMonthLabel} (${(i.currentMonthIndex||0)+1}/${i.monthsFound||0})`:i?.monthsProcessed!==void 0?`Processed ${i.monthsProcessed} month${i.monthsProcessed!==1?"s":""}`:void 0}),d.jsx(Mo,{status:i?.status==="error"?"error":OE(i?.status,["pending","finding_months","processing_months"],"updating_budget"),label:"Update budget totals",detail:i?.status==="error"?i.error:void 0,isError:i?.status==="error"})]}),i?.status==="done"&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${ue.success} 10%, transparent)`,border:`1px solid ${ue.success}`,borderRadius:"8px",textAlign:"center"},children:[d.jsx("p",{style:{margin:0,fontWeight:600,color:ue.success},children:" Recalculation complete!"}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:[i.monthsProcessed," month",i.monthsProcessed!==1?"s":""," processed",d.jsx("br",{}),"Total Income: ",je(i.totalIncomeRecalculated||0),d.jsx("br",{}),"Total Expenses: ",je(i.totalExpensesRecalculated||0)]})]}),(i?.status==="done"||i?.status==="error")&&d.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"center"},children:d.jsx(Le,{onClick:e,children:"Done"})}),l&&d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"Please wait, do not close this window..."})]})]})})}function OE(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function Mo({status:t,label:e,detail:n,isError:i}){const a=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:a}),d.jsxs("div",{style:{flex:1},children:[d.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:i?1:.6,color:i?ue.error:"inherit"},children:n})]})]})}function Fy({isDisabled:t}){const{selectedBudgetId:e,currentUserId:n,currentYear:i,currentMonthNumber:a}=wn(),{categories:l,accounts:u,saveCategories:f,saveAccounts:p}=Gn(e,n),[g,_]=T.useState(!1),[v,x]=T.useState(!1),[w,A]=T.useState(null);function I(){x(!0),A({status:"confirming"})}async function N(){if(e){_(!0),A({status:"pending"});try{A({status:"finding_months"});const $=new Date,q=i||$.getFullYear(),me=a||$.getMonth()+1,{year:re,month:he}=wy(q,me),L={year:re,month:he},D=await Ty(e,re,he),R=Object.keys(l);A({status:"finding_months",monthsFound:D.length}),await new Promise(F=>setTimeout(F,100));const M={};let j=null;const O=Fi(e,L.year,L.month),{exists:C,data:Y}=await Qe("months",O,"recalculate: reading previous month for starting balances");if(C&&Y&&(j=Y,Y.category_balances))for(const F of Y.category_balances)M[F.category_id]=F.end_balance??0;R.forEach(F=>{M[F]===void 0&&(M[F]=0)});let U=0,P=0;for(let F=0;F<D.length;F++){const W=D[F],te=`${pf[W.month-1]} ${W.year}`;A({status:"processing_months",monthsFound:D.length,currentMonthIndex:F,currentMonthLabel:te});const se=Fi(e,W.year,W.month),{exists:pe,data:de}=await Qe("months",se,`recalculate: reading full month data for ${te}`);if(!pe||!de){console.warn(`Month ${te} not found, skipping`);continue}const be=de.income||[],Se=de.expenses||[],ce=de.are_allocations_finalized||!1,Te=be.reduce((Ne,Nt)=>Ne+Nt.amount,0),De=Se.reduce((Ne,Nt)=>Ne+Nt.amount,0);U+=Te,P+=De;const Ae={};if(de.category_balances)for(const Ne of de.category_balances)Ae[Ne.category_id]={allocated:Ne.allocated??0};const Me=R.map(Ne=>{const Nt=M[Ne]??0;let cn=0;ce&&Ae[Ne]&&(cn=Ae[Ne].allocated);let In=0;Se.length>0&&(In=Se.filter(Ot=>Ot.category_id===Ne).reduce((Ot,Qn)=>Ot+Qn.amount,0));const Pt=Nt+cn-In;return{category_id:Ne,start_balance:Nt,allocated:cn,spent:In,end_balance:Pt}});Me.forEach(Ne=>{M[Ne.category_id]=Ne.end_balance});const vt=(F===0?j:D[F-1])?.total_income??0,tn=Object.keys(u).map(Ne=>{const Nt=be.filter(Ot=>Ot.account_id===Ne).reduce((Ot,Qn)=>Ot+Qn.amount,0),cn=Se.filter(Ot=>Ot.account_id===Ne).reduce((Ot,Qn)=>Ot+Qn.amount,0),In=Nt-cn;let Pt=0;if(de.account_balances){const Ot=de.account_balances.find(Qn=>Qn.account_id===Ne);Ot&&(Pt=Ot.start_balance??0)}return{account_id:Ne,start_balance:Pt,income:Nt,expenses:cn,net_change:In,end_balance:Pt+In}}),ct={budget_id:e,year_month_ordinal:qi(W.year,W.month),year:W.year,month:W.month,income:be,total_income:Te,previous_month_income:vt,expenses:Se,total_expenses:De,account_balances:tn,category_balances:Me,are_allocations_finalized:ce,is_needs_recalculation:!1,created_at:de.created_at||new Date().toISOString(),updated_at:new Date().toISOString()};await pT({budgetId:e,month:ct,description:"recalculate all months"}),await new Promise(Ne=>setTimeout(Ne,50))}const B={};Object.keys(u).forEach(F=>{B[F]=0});const Q=await Nr("months","recalculate: querying all months for account balances",[{field:"budget_id",op:"==",value:e}]);for(const F of Q.docs){const W=Fi(e,F.data.year,F.data.month),{exists:te,data:se}=await Qe("months",W,`recalculate: reading month ${F.data.year}/${F.data.month} for account balances`);if(!te||!se)continue;const pe=se.income||[],de=se.expenses||[];for(const be of pe)be.account_id&&B[be.account_id]!==void 0&&(B[be.account_id]+=be.amount);for(const be of de)be.account_id&&B[be.account_id]!==void 0&&(B[be.account_id]-=be.amount)}const le={};Object.entries(u).forEach(([F,W])=>{le[F]={...W,balance:B[F]??0}}),await p(le),A({status:"updating_budget",monthsFound:D.length,monthsProcessed:D.length,totalIncomeRecalculated:U,totalExpensesRecalculated:P});const J={...M},z={};Object.entries(l).forEach(([F,W])=>{z[F]={...W,balance:J[F]??0}}),await f(z);for(const F of D)Dt.invalidateQueries({queryKey:xe.month(e,F.year,F.month)});A({status:"done",monthsFound:D.length,monthsProcessed:D.length,totalIncomeRecalculated:U,totalExpensesRecalculated:P})}catch($){console.error("Recalculate error:",$),A({status:"error",error:$ instanceof Error?$.message:"Failed to recalculate"})}finally{_(!1)}}}function H(){x(!1),A(null)}return d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:I,disabled:t||g,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:t||g?"not-allowed":"pointer",opacity:t||g?.5:1,fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},title:"Recalculate balances from this month forward",children:[g?"":""," Recalculate"]}),d.jsx(h4,{isOpen:v,onClose:H,onProceed:N,results:w})]})}function f4({isLoading:t,onPreviousMonth:e,onNextMonth:n}){const{currentYear:i,currentMonthNumber:a,isAdmin:l,selectedBudgetId:u,currentUserId:f}=wn(),{budget:p}=Gn(u,f),{month:g}=Tl(u,i,a),[_,v]=T.useState(!1),x=T.useRef(null);T.useEffect(()=>{if(!_)return;function A(I){x.current&&!x.current.contains(I.target)&&v(!1)}return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[_]);function w(){if(!g||!p)return;const A={...g,_meta:{downloaded_at:new Date().toISOString(),budget_id:p.id,budget_name:p.name}},I=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),N=URL.createObjectURL(I),H=document.createElement("a");H.href=N,H.download=`month_${i}_${String(a).padStart(2,"0")}.json`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(N),v(!1)}return d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[d.jsx("button",{onClick:()=>{st("NAVIGATE","Previous Month"),e()},disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Previous month",children:""}),d.jsxs("div",{ref:x,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[d.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[pf[a-1]," ",i]}),d.jsx("button",{onClick:()=>v(!_),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:_?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),t&&d.jsxs(d.Fragment,{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:ue.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),_&&d.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[d.jsx(Fy,{isDisabled:t}),l&&g&&d.jsx("button",{onClick:()=>{st("CLICK","Download Month JSON"),w()},style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),d.jsx("button",{onClick:()=>{st("NAVIGATE","Next Month"),n()},disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Next month",children:""})]})}const m4={background:ue.primary,border:"none",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px",color:"white"},p4={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"},g4={background:"transparent",border:`1px solid ${ue.errorBorder}`,color:ue.error,cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"};function i1({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:u,defaultDate:f,config:p,onSubmit:g,onCancel:_,onDelete:v,extraContent:x}){const{isMedium:w,isMobile:A}=BP(),{showCategory:I=!1,showCleared:N=!1,accountLabel:H="Account",payeePlaceholder:$="Payee name",descriptionPlaceholder:q="Optional note",submitLabel:me}=p,re=new Date().toISOString().split("T")[0],[he,L]=T.useState(l?.date||f||re),[D,R]=T.useState(l?.payee||""),[M,j]=T.useState(l?.categoryId||""),[O,C]=T.useState(l?.accountId||u||(t[0]?t[0][0]:"")),[Y,U]=T.useState(l?.amount?.toString()||""),[P,B]=T.useState(l?.description||""),[Q,le]=T.useState(l?.cleared||!1),J={},z=[];t.forEach(([Te,De])=>{De.account_group_id?(J[De.account_group_id]||(J[De.account_group_id]=[]),J[De.account_group_id].push([Te,De])):z.push([Te,De])});function F(Te){Te.preventDefault();const De=parseFloat(Y);isNaN(De)||De<=0||I&&!M||!O||!he||g({date:he,payee:D.trim()||void 0,categoryId:I?M:void 0,accountId:O,amount:De,description:P.trim()||void 0,cleared:N?Q:void 0})}const W=d.jsxs(Zc,{id:"txn-account",value:O,onChange:Te=>C(Te.target.value),required:!0,style:{fontSize:"0.85rem",padding:"0.5rem"},children:[Object.entries(e).map(([Te,De])=>{const Ae=J[Te];return Ae?.length?d.jsx("optgroup",{label:De.name,children:Ae.map(([Me,$e])=>d.jsx("option",{value:Me,children:$e.nickname},Me))},Te):null}),z.length>0&&d.jsx("optgroup",{label:"Other",children:z.map(([Te,De])=>d.jsx("option",{value:Te,children:De.nickname},Te))})]}),te=I&&n&&i?d.jsx(St,{label:"Category",htmlFor:"txn-category",children:d.jsx(wP,{id:"txn-category",value:M,onChange:j,categories:n,categoryGroups:i,placeholder:"Search...",required:!0})}):null,se=N?d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.35rem"},children:[d.jsx("label",{htmlFor:"txn-cleared",style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:"Clr"}),d.jsx(Os,{id:"txn-cleared",checked:Q,onChange:Te=>le(Te.target.checked)})]}):null,pe=d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.1rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[d.jsx("button",{type:"submit",title:me,style:m4,children:""}),d.jsx("button",{type:"button",onClick:()=>{st("CLICK","Cancel Transaction Form"),_()},title:"Cancel",style:p4,children:""}),v&&d.jsx("button",{type:"button",onClick:()=>{st("CLICK","Delete Transaction"),v()},title:"Delete",style:g4,children:""})]})]}),de=d.jsxs(Ga,{children:[d.jsx(Le,{type:"submit",actionName:me,children:me}),d.jsx(Le,{type:"button",variant:"secondary",actionName:"Cancel Transaction Form",onClick:_,children:"Cancel"}),v&&d.jsx(Le,{type:"button",variant:"danger",actionName:"Delete Transaction",onClick:v,children:" Delete"})]});if(A)return d.jsxs(Gs,{actionName:me,onSubmit:F,children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[d.jsx(St,{label:"Date",htmlFor:"txn-date",children:d.jsx(Vp,{id:"txn-date",value:he,onChange:Te=>L(Te.target.value),required:!0})}),d.jsx(St,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(hh,{id:"txn-amount",value:Y,onChange:U,placeholder:"$0.00",required:!0,autoFocus:!0})})]}),d.jsx(St,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(Lp,{id:"txn-payee",value:D,onChange:R,payees:a,placeholder:$})}),te,d.jsx(St,{label:H,htmlFor:"txn-account",children:W}),d.jsx(St,{label:"Description (optional)",htmlFor:"txn-description",children:d.jsx(Qs,{id:"txn-description",value:P,onChange:Te=>B(Te.target.value),placeholder:q})}),N&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx(Os,{id:"txn-cleared-mobile",checked:Q,onChange:Te=>le(Te.target.checked)}),d.jsx("label",{htmlFor:"txn-cleared-mobile",style:{fontSize:"0.9rem",cursor:"pointer"},children:"Cleared (appeared in bank account)"})]}),x]}),de]});const be=I&&n&&i,Se={fontSize:"0.85rem",padding:"0.5rem"};if(w){const Te=be?"6rem 1fr 1fr 1fr":"6rem 1fr 1fr",De=be?2:1;return d.jsxs(Gs,{actionName:me,onSubmit:F,children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:Te,gap:"0.75rem",alignItems:"end"},children:[d.jsx(St,{label:"Date",htmlFor:"txn-date",children:d.jsx(Vp,{id:"txn-date",value:he,onChange:Ae=>L(Ae.target.value),required:!0,style:Se})}),d.jsx(St,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(Lp,{id:"txn-payee",value:D,onChange:R,payees:a,placeholder:$})}),te,d.jsx(St,{label:H,htmlFor:"txn-account",children:W})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:Te,gap:"0.75rem",alignItems:"end",marginTop:"0.75rem"},children:[d.jsx(St,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(hh,{id:"txn-amount",value:Y,onChange:U,placeholder:"$0.00",required:!0,autoFocus:!0})}),d.jsx(St,{label:"Description",htmlFor:"txn-description",style:{gridColumn:`span ${De}`},children:d.jsx(Qs,{id:"txn-description",value:P,onChange:Ae=>B(Ae.target.value),placeholder:q,style:Se})}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"end",justifyContent:"flex-end"},children:[se,pe]})]}),x]})}const ce=be?N?"6rem 1fr 1fr 1fr 6rem 1fr auto auto":"6rem 1fr 1fr 1fr 6rem 1fr auto":N?"6rem 1fr 1fr 6rem 1fr auto auto":"6rem 1fr 1fr 6rem 1fr auto";return d.jsxs(Gs,{actionName:me,onSubmit:F,children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:ce,gap:"0.75rem",alignItems:"end"},children:[d.jsx(St,{label:"Date",htmlFor:"txn-date",children:d.jsx(Vp,{id:"txn-date",value:he,onChange:Te=>L(Te.target.value),required:!0,style:Se})}),d.jsx(St,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(Lp,{id:"txn-payee",value:D,onChange:R,payees:a,placeholder:$})}),te,d.jsx(St,{label:H,htmlFor:"txn-account",children:W}),d.jsx(St,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(hh,{id:"txn-amount",value:Y,onChange:U,placeholder:"$0.00",required:!0,autoFocus:!0})}),d.jsx(St,{label:"Description",htmlFor:"txn-description",children:d.jsx(Qs,{id:"txn-description",value:P,onChange:Te=>B(Te.target.value),placeholder:q,style:Se})}),se,pe]}),x]})}function kE({accounts:t,accountGroups:e,payees:n,initialData:i,defaultAccountId:a,defaultDate:l,onSubmit:u,onCancel:f,onDelete:p,submitLabel:g}){function _(v){u(v.amount,v.accountId,v.date,v.payee,v.description)}return d.jsx(i1,{accounts:t,accountGroups:e,payees:n,initialData:i?{date:i.date,payee:i.payee,accountId:i.account_id,amount:i.amount,description:i.description}:void 0,defaultAccountId:a,defaultDate:l,config:{showCategory:!1,showCleared:!1,accountLabel:"Deposit To",payeePlaceholder:"e.g., Employer, Client name",descriptionPlaceholder:"e.g., January paycheck",submitLabel:g},onSubmit:_,onCancel:f,onDelete:p})}function s1(){const[t,e]=T.useState(()=>typeof window>"u"?!0:window.innerWidth>=zi.wide);return T.useEffect(()=>{function n(){e(window.innerWidth>=zi.wide)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}function y4({income:t,accountName:e,accountGroupName:n,onEdit:i,onDelete:a,isMobile:l}){const u=s1(),f=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",p=n?`${n} / ${e}`:e;return l?d.jsxs("div",{onClick:i,style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:f}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""})]}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",p]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:ue.success,fontFamily:"monospace"},children:["+",je(t.amount)]})})]}):u?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 6rem 1fr 4rem",gap:"0.75rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:g=>g.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:f}),d.jsx("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),d.jsx("span",{style:{fontSize:"0.85rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:p}),d.jsxs("span",{style:{fontWeight:600,color:ue.success,fontFamily:"monospace",textAlign:"right"},children:["+",je(t.amount)]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description||""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 6rem 4rem",gap:"0.5rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:g=>g.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:f}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),t.description&&d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e}),d.jsxs("span",{style:{fontWeight:600,color:ue.success,fontFamily:"monospace",textAlign:"right",fontSize:"0.9rem"},children:["+",je(t.amount)]}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function _4(){return s1()?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 6rem 1fr 4rem",gap:"0.75rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{children:"Description"}),d.jsx("span",{})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 6rem 4rem",gap:"0.5rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{})]})}function v4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=wn(),{accounts:a,accountGroups:l}=Gn(t,e),{month:u,isLoading:f,addIncome:p,updateIncome:g,deleteIncome:_}=Tl(t,n,i),v=Ji(),[x,w]=T.useState(null),[A,I]=T.useState(!1),[N,H]=T.useState(null),me=gT(t,{enabled:A||N!==null}).data||[];function re(P){const B=P.account_group_id?l[P.account_group_id]:void 0;return B?.is_active!==void 0?B.is_active:P.is_active!==!1}function he(P){const B=P.account_group_id?l[P.account_group_id]:void 0;return B?.on_budget!==void 0?B.on_budget:P.on_budget!==!1}const L=Object.entries(a).filter(([,P])=>re(P)&&he(P)),D=L.filter(([,P])=>P.is_income_account),R=D.length>0?D:L,M=L.find(([,P])=>P.is_income_default),j=M?M[0]:void 0,O=u?.income.reduce((P,B)=>P+B.amount,0)||0;function C(P,B,Q,le,J){w(null),I(!1),p(P,B,Q,le,J).catch(z=>{w(z instanceof Error?z.message:"Failed to add income")})}function Y(P,B,Q,le,J,z){w(null),H(null),g(P,B,Q,le,J,z).catch(F=>{w(F instanceof Error?F.message:"Failed to update income")})}function U(P){confirm("Are you sure you want to delete this income entry?")&&(w(null),_(P).catch(B=>{w(B instanceof Error?B.message:"Failed to delete income")}))}return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:f?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:f?"none":"auto"},children:[x&&d.jsx("div",{style:{background:`color-mix(in srgb, ${ue.error} 15%, transparent)`,border:`1px solid ${ue.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ue.error},children:x}),d.jsx(n1,{label:"Total",value:d.jsx("span",{style:{color:an(O)},children:je(O)}),action:!A&&d.jsx(Le,{actionName:"Open Add Income Form",onClick:()=>I(!0),disabled:R.length===0,children:"+ Add Income"})}),R.length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",d.jsx(It,{to:"/budget/accounts",style:{color:ue.primaryLight},children:"Manage accounts "})]}),A&&d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx(kE,{accounts:R,accountGroups:l,payees:me,defaultAccountId:j,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:C,onCancel:()=>I(!1),submitLabel:"Add Income",isMobile:v})}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem"},children:[!v&&u?.income&&u.income.length>0&&d.jsx(_4,{}),u?.income.slice().sort((P,B)=>(P.date||"").localeCompare(B.date||"")).map(P=>N===P.id?d.jsx("div",{style:{padding:"0.5rem"},children:d.jsx(kE,{accounts:R,accountGroups:l,payees:me,initialData:P,onSubmit:(B,Q,le,J,z)=>Y(P.id,B,Q,le,J,z),onCancel:()=>H(null),onDelete:()=>U(P.id),submitLabel:"Save",isMobile:v})},P.id):d.jsx(y4,{income:P,accountName:a[P.account_id]?.nickname||"Unknown Account",accountGroupName:a[P.account_id]?.account_group_id?l[a[P.account_id].account_group_id]?.name:void 0,onEdit:()=>{st("CLICK","Edit Income",{details:P.payee||`$${P.amount}`}),H(P.id)},onDelete:()=>U(P.id),isMobile:v},P.id)),(!u?.income||u.income.length===0)&&!A&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No income recorded for this month"})]})]})}function ME({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:u,defaultDate:f,onSubmit:p,onCancel:g,onDelete:_,submitLabel:v}){function x(w){p(w.amount,w.categoryId,w.accountId,w.date,w.payee,w.description,w.cleared)}return d.jsx(i1,{accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l?{date:l.date,payee:l.payee,categoryId:l.category_id,accountId:l.account_id,amount:l.amount,description:l.description,cleared:l.cleared}:void 0,defaultAccountId:u,defaultDate:f,config:{showCategory:!0,showCleared:!0,accountLabel:"Pay From",payeePlaceholder:"e.g., Grocery Store",descriptionPlaceholder:"e.g., Weekly groceries",submitLabel:v},onSubmit:x,onCancel:g,onDelete:_})}function a1(){const[t,e]=T.useState(()=>typeof window>"u"?!0:window.innerWidth>=zi.wide);return T.useEffect(()=>{function n(){e(window.innerWidth>=zi.wide)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}function b4({expense:t,categoryName:e,accountName:n,accountGroupName:i,onEdit:a,onDelete:l,isMobile:u}){const f=a1(),p=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",g=i?`${i} / ${n}`:n;return u?d.jsxs("div",{onClick:a,style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:p}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""}),t.cleared&&d.jsx("span",{style:{fontSize:"0.7rem",color:ue.success},title:"Cleared",children:""})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:{fontSize:"0.7rem",background:`color-mix(in srgb, ${ue.primary} 20%, transparent)`,color:ue.primaryLight,padding:"0.1rem 0.4rem",borderRadius:"3px"},children:e}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",g]})]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:ue.error,fontFamily:"monospace"},children:["-",je(t.amount)]})})]}):f?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 8rem 6rem 1fr 3rem 4rem",gap:"0.75rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:_=>_.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:p}),d.jsx("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),d.jsx("span",{style:{fontSize:"0.8rem",background:`color-mix(in srgb, ${ue.primary} 15%, transparent)`,color:ue.primaryLight,padding:"0.2rem 0.5rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e}),d.jsx("span",{style:{fontSize:"0.85rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:g}),d.jsxs("span",{style:{fontWeight:600,color:ue.error,fontFamily:"monospace",textAlign:"right"},children:["-",je(t.amount)]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description||""}),d.jsx("span",{style:{textAlign:"center",color:t.cleared?ue.success:"inherit",opacity:t.cleared?1:.3,fontSize:"1rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 7rem 6rem 3rem 4rem",gap:"0.5rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:_=>_.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:p}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),t.description&&d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]}),d.jsx("span",{style:{fontSize:"0.75rem",background:`color-mix(in srgb, ${ue.primary} 15%, transparent)`,color:ue.primaryLight,padding:"0.15rem 0.4rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n}),d.jsxs("span",{style:{fontWeight:600,color:ue.error,fontFamily:"monospace",textAlign:"right",fontSize:"0.9rem"},children:["-",je(t.amount)]}),d.jsx("span",{style:{textAlign:"center",color:t.cleared?ue.success:"inherit",opacity:t.cleared?1:.3,fontSize:"0.9rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function x4(){return a1()?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 8rem 6rem 1fr 3rem 4rem",gap:"0.75rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{style:{textAlign:"center"},children:"Category"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{children:"Description"}),d.jsx("span",{style:{textAlign:"center"},children:"Clr"}),d.jsx("span",{})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 7rem 6rem 3rem 4rem",gap:"0.5rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{style:{textAlign:"center"},children:"Category"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{style:{textAlign:"center"},children:"Clr"}),d.jsx("span",{})]})}function E4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=wn(),{accounts:a,accountGroups:l,categories:u,categoryGroups:f}=Gn(t,e),{month:p,isLoading:g,addExpense:_,updateExpense:v,deleteExpense:x}=Tl(t,n,i),w=Ji(),[A,I]=T.useState(null),[N,H]=T.useState(!1),[$,q]=T.useState(null),he=gT(t,{enabled:N||$!==null}).data||[];function L(Q){const le=Q.account_group_id?l[Q.account_group_id]:void 0;return le?.is_active!==void 0?le.is_active:Q.is_active!==!1}function D(Q){const le=Q.account_group_id?l[Q.account_group_id]:void 0;return le?.on_budget!==void 0?le.on_budget:Q.on_budget!==!1}const R=Object.entries(a).filter(([,Q])=>L(Q)&&D(Q)),M=R.filter(([,Q])=>Q.is_outgo_account),j=M.length>0?M:R,O=R.find(([,Q])=>Q.is_outgo_default),C=O?O[0]:void 0,Y=p?.expenses?.reduce((Q,le)=>Q+le.amount,0)||0;function U(Q,le,J,z,F,W,te){I(null),H(!1),_(Q,le,J,z,F,W,te).catch(se=>{I(se instanceof Error?se.message:"Failed to add expense")})}function P(Q,le,J,z,F,W,te,se){I(null),q(null),v(Q,le,J,z,F,W,te,se).catch(pe=>{I(pe instanceof Error?pe.message:"Failed to update expense")})}function B(Q){confirm("Are you sure you want to delete this expense?")&&(I(null),x(Q).catch(le=>{I(le instanceof Error?le.message:"Failed to delete expense")}))}return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:g?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:g?"none":"auto"},children:[A&&d.jsx("div",{style:{background:`color-mix(in srgb, ${ue.error} 15%, transparent)`,border:`1px solid ${ue.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ue.error},children:A}),d.jsx(n1,{label:"Total Expenses",value:d.jsxs("span",{style:{color:Y>0?ue.error:"inherit"},children:[Y>0?"-":"",je(Y)]}),action:!N&&d.jsx(Le,{actionName:"Open Add Expense Form",onClick:()=>H(!0),disabled:j.length===0||Object.keys(u).length===0,children:"+ Add Expense"})}),j.length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",d.jsx(It,{to:"/budget/accounts",style:{color:ue.primaryLight},children:"Manage accounts "})]}),Object.keys(u).length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:["You need to create at least one category before adding expenses."," ",d.jsx(It,{to:"/budget/settings/categories",style:{color:ue.primaryLight},children:"Create categories "})]}),N&&d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx(ME,{accounts:j,accountGroups:l,categories:u,categoryGroups:f,payees:he,defaultAccountId:C,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:U,onCancel:()=>H(!1),submitLabel:"Add Expense",isMobile:w})}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem"},children:[!w&&p?.expenses&&p.expenses.length>0&&d.jsx(x4,{}),p?.expenses?.slice().sort((Q,le)=>(Q.date||"").localeCompare(le.date||"")).map(Q=>$===Q.id?d.jsx("div",{style:{padding:"0.5rem"},children:d.jsx(ME,{accounts:j,accountGroups:l,categories:u,categoryGroups:f,payees:he,initialData:Q,onSubmit:(le,J,z,F,W,te,se)=>P(Q.id,le,J,z,F,W,te,se),onCancel:()=>q(null),onDelete:()=>B(Q.id),submitLabel:"Save",isMobile:w})},Q.id):d.jsx(b4,{expense:Q,categoryName:u[Q.category_id]?.name||"Unknown Category",accountName:a[Q.account_id]?.nickname||"Unknown Account",accountGroupName:a[Q.account_id]?.account_group_id?l[a[Q.account_id].account_group_id]?.name:void 0,onEdit:()=>{st("CLICK","Edit Expense",{details:Q.payee||`$${Q.amount}`}),q(Q.id)},onDelete:()=>B(Q.id),isMobile:w},Q.id)),(!p?.expenses||p.expenses.length===0)&&!N&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No expenses recorded for this month"})]})]})}function S4({accounts:t,accountGroups:e,accountBalances:n,isMobile:i}){const a=T.useMemo(()=>Object.entries(e).map(([u,f])=>({id:u,...f})).sort((u,f)=>u.sort_order-f.sort_order),[e]),l=T.useMemo(()=>{const u={};return Object.entries(t).forEach(([f,p])=>{const g=p.account_group_id||"ungrouped";u[g]||(u[g]=[]),u[g].push([f,p])}),Object.keys(u).forEach(f=>{u[f].sort((p,g)=>p[1].sort_order-g[1].sort_order)}),u},[t]);return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(t).length===0&&d.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No accounts yet."," ",d.jsx(It,{to:"/budget/settings/accounts",style:{color:ue.primaryLight},children:"Add accounts "})]}),a.map(u=>{const f=l[u.id]||[];if(f.length===0)return null;const p=f.reduce((g,[_])=>{const v=n[_];return v?{start:g.start+v.start_balance,income:g.income+v.income,expenses:g.expenses+v.expenses,netChange:g.netChange+v.net_change,end:g.end+v.end_balance}:g},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(NE,{name:u.name,accounts:f,groupTotals:p,accountBalances:n,isMobile:i},u.id)}),l.ungrouped?.length>0&&(()=>{const u=l.ungrouped,f=u.reduce((p,[g])=>{const _=n[g];return _?{start:p.start+_.start_balance,income:p.income+_.income,expenses:p.expenses+_.expenses,netChange:p.netChange+_.net_change,end:p.end+_.end_balance}:p},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(NE,{name:"Ungrouped",accounts:u,groupTotals:f,accountBalances:n,isMobile:i,isUngrouped:!0},"ungrouped")})()]})}function NE({name:t,accounts:e,groupTotals:n,accountBalances:i,isMobile:a,isUngrouped:l}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Sl,margin:0,opacity:l?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"0.8rem",color:n.netChange>=0?ue.success:ue.error},children:[n.netChange>=0?"+":"",je(n.netChange)]}),d.jsx("span",{style:{fontWeight:600,color:an(n.end)},children:je(n.end)})]})]}),!a&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Start"}),d.jsx("span",{style:{textAlign:"right"},children:"Net Change"}),d.jsx("span",{style:{textAlign:"right"},children:"End"}),d.jsx("span",{style:{textAlign:"right"}})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:e.map(([u,f])=>{const p=i[u];return p?a?d.jsx(w4,{account:f,balance:p},u):d.jsx(T4,{account:f,balance:p},u):null})})]})}function w4({account:t,balance:e}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.nickname})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:je(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Net Change"}),d.jsxs("span",{style:{color:e.net_change>=0?ue.success:ue.error},children:[e.net_change>=0?"+":"",je(e.net_change)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:an(e.end_balance)},children:je(e.end_balance)})]})]}),(e.income>0||e.expenses>0)&&d.jsxs("div",{style:{marginTop:"0.5rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)",display:"flex",gap:"1rem",fontSize:"0.7rem",opacity:.7},children:[e.income>0&&d.jsxs("span",{children:["+",je(e.income)," income"]}),e.expenses>0&&d.jsxs("span",{children:["-",je(e.expenses)," expenses"]})]})]})}function T4({account:t,balance:e}){return d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[d.jsxs("div",{style:{minWidth:0,overflow:"hidden"},children:[d.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.nickname}),(e.income>0||e.expenses>0)&&d.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5},children:[e.income>0&&`+${je(e.income)}`,e.income>0&&e.expenses>0&&" / ",e.expenses>0&&`-${je(e.expenses)}`]})]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:je(e.start_balance)}),d.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.net_change>=0?ue.success:ue.error},children:[e.net_change>=0?"+":"",je(e.net_change)]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:an(e.end_balance)},children:je(e.end_balance)}),d.jsx("span",{})]})}function PE({name:t,categories:e,groupEndBalance:n,groupAllocated:i,getCategoryBalance:a,localAllocations:l,previousMonthIncome:u,isDraftMode:f,onAllocationChange:p,isMobile:g,isUngrouped:_}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Sl,margin:0,opacity:_?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"0.8rem",opacity:.6},children:["+",je(i)]}),d.jsx("span",{style:{fontWeight:600,color:an(n)},children:je(n)})]})]}),!g&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"2fr 120px 1fr 1fr 1fr":"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[d.jsx("span",{children:"Category"}),d.jsx("span",{style:{textAlign:f?"center":"right"},children:"Allocated"}),d.jsx("span",{style:{textAlign:"right"},children:"Start"}),d.jsx("span",{style:{textAlign:"right"},children:"Spent"}),d.jsx("span",{style:{textAlign:"right"},children:"End"})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:f?"0.5rem":"0.25rem"},children:e.map(([v,x])=>{const w=a(v);return w?g?d.jsx(A4,{category:x,balance:w,localAllocation:l[v]||"",previousMonthIncome:u,isDraftMode:f,onAllocationChange:A=>p(v,A)},v):d.jsx(C4,{category:x,balance:w,localAllocation:l[v]||"",previousMonthIncome:u,isDraftMode:f,onAllocationChange:A=>p(v,A)},v):null})})]})}function A4({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l}){const u=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,f=u?t.default_monthly_amount/100*i:0,p=u?f.toFixed(2):n,g=a&&!u;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.name})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:je(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),g?d.jsx("input",{type:"text",inputMode:"decimal",value:p?`$${p}`:"",onChange:_=>{const v=_.target.value.replace(/[^\d.]/g,"");l(v)},placeholder:"$0",style:{width:"100%",maxWidth:"80px",padding:"0.25rem 0.35rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 8%, transparent)",fontSize:"0.8rem",color:"inherit",boxSizing:"border-box"}}):d.jsxs("span",{style:{color:e.allocated>0?ue.success:"inherit"},children:[e.allocated>0?"+":"",je(e.allocated)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),d.jsxs("span",{style:{color:e.spent>0?ue.error:"inherit"},children:[e.spent>0?"-":"",je(e.spent)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:an(e.end_balance)},children:je(e.end_balance)})]})]}),a&&u&&d.jsx("div",{style:{marginTop:"0.5rem"},children:d.jsxs("span",{style:{fontSize:"0.8rem"},children:[d.jsxs("span",{style:{opacity:.6},children:[je(i),"  "]}),d.jsxs("span",{style:{color:ue.primary},children:[t.default_monthly_amount,"%"]}),d.jsx("span",{style:{opacity:.6},children:" = "}),d.jsx("span",{style:{color:ue.primary},children:je(f)})]})})]})}function C4({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l}){const u=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,f=u?t.default_monthly_amount/100*i:0,p=u?f.toFixed(2):n;let g=null;return a&&!u&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&(g=je(t.default_monthly_amount)),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:a?"2fr 120px 1fr 1fr 1fr":"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[d.jsxs("div",{style:{minWidth:0,overflow:"hidden"},children:[d.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),g&&d.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5},children:["Suggested: ",g]})]}),a?d.jsx("div",{children:u?d.jsxs("div",{style:{textAlign:"center",fontSize:"0.8rem"},children:[d.jsxs("span",{style:{opacity:.5},children:[je(i),"  "]}),d.jsxs("span",{style:{color:ue.primary},children:[t.default_monthly_amount,"%"]}),d.jsxs("span",{style:{display:"block",marginTop:"0.15rem"},children:[d.jsx("span",{style:{opacity:.5},children:"= "}),d.jsx("span",{style:{color:ue.primary},children:je(f)})]})]}):d.jsx("input",{type:"text",inputMode:"decimal",value:p?`$${p}`:"",onChange:_=>{const v=_.target.value.replace(/[^\d.]/g,"");l(v)},placeholder:"$0.00",style:{width:"100%",padding:"0.4rem 0.5rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box"}})}):d.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.allocated>0?ue.success:"inherit"},children:[e.allocated>0?"+":"",je(e.allocated)]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:je(e.start_balance)}),d.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.spent>0?ue.error:"inherit"},children:[e.spent>0?"-":"",je(e.spent)]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:an(e.end_balance)},children:je(e.end_balance)})]})}const LE=["categories","accounts"];function R4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,lastBalancesView:a,setLastBalancesView:l}=wn(),{categories:u,categoryGroups:f,accounts:p,accountGroups:g}=Gn(t,e),{month:_,isLoading:v}=Tl(t,n,i),x=Ji(),[w,A]=DR(),I=()=>{const Ae=w.get("view");return Ae&&LE.includes(Ae)?Ae:a},[N,H]=T.useState(I),[$,q]=T.useState(!1),me=Ae=>{H(Ae),l(Ae),A({view:Ae},{replace:!0})};T.useEffect(()=>{const Ae=w.get("view");(!Ae||!LE.includes(Ae))&&A({view:a},{replace:!0})},[]);const{localAllocations:re,isSavingAllocations:he,isFinalizingAllocations:L,isDeletingAllocations:D,isEditingAppliedAllocations:R,error:M,availableNow:j,draftChangeAmount:O,availableAfterApply:C,previousMonthIncome:Y,allocationsFinalized:U,getAllocationAmount:P,handleAllocationChange:B,resetAllocationsToSaved:Q,handleSaveAllocations:le,handleFinalizeAllocations:J,handleDeleteAllocations:z,setIsEditingAppliedAllocations:F,setError:W}=e4(),te=[...f].sort((Ae,Me)=>Ae.sort_order-Me.sort_order),se=T.useMemo(()=>{const Ae=Object.entries(u).reduce((Me,[$e,vt])=>{const Tt=vt.category_group_id||"ungrouped";return Me[Tt]||(Me[Tt]=[]),Me[Tt].push([$e,vt]),Me},{});return Object.keys(Ae).forEach(Me=>{Ae[Me].sort(($e,vt)=>$e[1].sort_order-vt[1].sort_order)}),Ae},[u]),pe=L||D,de=!U||R,be=T.useMemo(()=>{const Ae={};_?.category_balances&&_.category_balances.forEach($e=>{Ae[$e.category_id]=$e});const Me={};return Object.entries(u).forEach(([$e,vt])=>{const Tt=Ae[$e],tn=Tt?.start_balance??0,ct=Tt?.spent??0;let Ne=0;de?Ne=P($e,vt):U&&Tt&&(Ne=Tt.allocated),Me[$e]={category_id:$e,start_balance:tn,allocated:Ne,spent:ct,end_balance:tn+Ne-ct}}),Me},[_,u,de,U,P]),Se=Ae=>be[Ae],ce=T.useMemo(()=>{const Ae={};_?.account_balances&&_.account_balances.forEach($e=>{Ae[$e.account_id]=$e});const Me={};return Object.entries(p).forEach(([$e,vt])=>{const tn=Ae[$e]?.start_balance??vt.balance;let ct=0;_?.income&&(ct=_.income.filter(cn=>cn.account_id===$e).reduce((cn,In)=>cn+In.amount,0));let Ne=0;_?.expenses&&(Ne=_.expenses.filter(cn=>cn.account_id===$e).reduce((cn,In)=>cn+In.amount,0));const Nt=ct-Ne;Me[$e]={account_id:$e,start_balance:tn,income:ct,expenses:Ne,net_change:Nt,end_balance:tn+Nt}}),Me},[_,p]),Te=T.useMemo(()=>Object.values(ce).reduce((Ae,Me)=>({start:Ae.start+Me.start_balance,income:Ae.income+Me.income,expenses:Ae.expenses+Me.expenses,netChange:Ae.netChange+Me.net_change,end:Ae.end+Me.end_balance}),{start:0,income:0,expenses:0,netChange:0,end:0}),[ce]),De=T.useMemo(()=>Object.values(be).reduce((Ae,Me)=>({start:Ae.start+Me.start_balance,allocated:Ae.allocated+Me.allocated,spent:Ae.spent+Me.spent,end:Ae.end+Me.end_balance}),{start:0,allocated:0,spent:0,end:0}),[be]);return d.jsxs("div",{style:{opacity:v?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:v?"none":"auto"},children:[d.jsx(LP,{isVisible:pe,message:D?"Deleting allocations...":"Saving allocations..."}),M&&d.jsx(wl,{message:M,onDismiss:()=>W(null)}),d.jsx(CP,{items:N==="categories"?[{label:"Available Now",value:d.jsx("span",{style:{color:an(j)},children:je(j)})},{label:de?"Draft Allocations":"Allocated",value:R?d.jsxs("span",{children:[d.jsxs("span",{style:{color:ue.primary},children:["+",je(De.allocated)]}),O!==0&&d.jsxs("span",{style:{marginLeft:"0.35rem",fontSize:"0.85em",color:O>0?ue.warning:ue.success},children:["(",O>0?"+":"",je(Math.abs(O)),")"]})]}):d.jsxs("span",{style:{color:de?ue.primary:ue.success},children:["+",je(De.allocated)]})},{label:"Spent",value:d.jsxs("span",{style:{color:ue.error},children:["-",je(De.spent)]})},{label:"Available After",value:d.jsx("span",{style:{color:an(C)},children:je(C)})}]:[{label:"Start of Month",value:d.jsx("span",{style:{color:an(Te.start)},children:je(Te.start)})},{label:"Income",value:d.jsxs("span",{style:{color:ue.success},children:["+",je(Te.income)]})},{label:"Expenses",value:d.jsxs("span",{style:{color:ue.error},children:["-",je(Te.expenses)]})},{label:"End of Month",value:d.jsx("span",{style:{color:an(Te.end)},children:je(Te.end)})}]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap",alignItems:"center"},children:[d.jsx(Le,{actionName:N==="categories"?"Switch to Account Balances":"Switch to Category Balances",onClick:()=>me(N==="categories"?"accounts":"categories"),variant:"secondary",style:{fontSize:"0.85rem"},children:N==="categories"?" Switch to Account Balances":" Switch to Category Balances"}),N==="categories"&&de&&!R&&d.jsxs(d.Fragment,{children:[d.jsx(Le,{actionName:"Save Draft Allocations",onClick:le,disabled:he||L||v,variant:"secondary",style:{fontSize:"0.85rem"},children:he?"...":" Save Draft"}),d.jsx(Le,{actionName:"Apply Allocations",onClick:J,disabled:he||L||v,variant:"secondary",style:{fontSize:"0.85rem"},children:L?"...":" Apply Allocations"})]}),N==="categories"&&!de&&U&&d.jsx(Le,{actionName:"Edit Allocations",onClick:()=>F(!0),variant:"secondary",style:{fontSize:"0.85rem"},children:" Edit Allocations"}),N==="categories"&&R&&d.jsxs(d.Fragment,{children:[d.jsx(Le,{actionName:"Apply Allocations",onClick:J,disabled:he||L||v,variant:"secondary",style:{fontSize:"0.85rem"},children:L?"...":" Apply Allocations"}),d.jsx(Le,{actionName:"Cancel Edit Allocations",onClick:Q,disabled:L||D||v,variant:"secondary",style:{fontSize:"0.85rem"},children:" Cancel"}),d.jsx(Le,{actionName:"Open Delete Allocations Modal",onClick:()=>q(!0),disabled:D||v,variant:"secondary",style:{fontSize:"0.85rem",color:ue.error},children:" Delete"})]})]}),N==="accounts"&&d.jsx(S4,{accounts:p,accountGroups:g,accountBalances:ce,isMobile:x}),N==="categories"&&d.jsx(d.Fragment,{children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(u).length===0&&d.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",d.jsx(It,{to:"/budget/settings/categories",style:{color:ue.primaryLight},children:"Create categories "})]}),te.map(Ae=>{const Me=se[Ae.id]||[];if(Me.length===0)return null;const $e=Me.reduce((vt,[Tt])=>{const tn=Se(Tt);return tn?{start:vt.start+tn.start_balance,allocated:vt.allocated+tn.allocated,spent:vt.spent+tn.spent,end:vt.end+tn.end_balance}:vt},{start:0,allocated:0,spent:0,end:0});return d.jsx(PE,{name:Ae.name,categories:Me,groupEndBalance:$e.end,groupAllocated:$e.allocated,getCategoryBalance:Se,localAllocations:re,previousMonthIncome:Y,isDraftMode:de,onAllocationChange:B,isMobile:x},Ae.id)}),se.ungrouped?.length>0&&(()=>{const Ae=se.ungrouped,Me=Ae.reduce(($e,[vt])=>{const Tt=Se(vt);return Tt?{start:$e.start+Tt.start_balance,allocated:$e.allocated+Tt.allocated,spent:$e.spent+Tt.spent,end:$e.end+Tt.end_balance}:$e},{start:0,allocated:0,spent:0,end:0});return d.jsx(PE,{name:"Uncategorized",categories:Ae,groupEndBalance:Me.end,groupAllocated:Me.allocated,getCategoryBalance:Se,localAllocations:re,previousMonthIncome:Y,isDraftMode:de,onAllocationChange:B,isMobile:x,isUngrouped:!0},"ungrouped")})()]})}),d.jsxs(al,{isOpen:$,onClose:()=>q(!1),title:"Delete Allocations",children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to delete all allocations for this month? This will remove all allocated amounts and reset the month to unfinalized."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Le,{actionName:"Cancel Delete Allocations",variant:"secondary",onClick:()=>q(!1),children:"Cancel"}),d.jsx(Le,{actionName:"Confirm Delete Allocations",variant:"danger",onClick:()=>{q(!1),z()},children:"Delete Allocations"})]})]})]})}const D4=["income","balances","spend"];function VE(t){const e=t.year?parseInt(t.year,10):null,n=t.month?parseInt(t.month,10):null,i=t.tab&&D4.includes(t.tab)?t.tab:null;return{year:e&&!isNaN(e)&&e>=2e3&&e<=2100?e:null,month:n&&!isNaN(n)&&n>=1&&n<=12?n:null,tab:i}}function zE(){const t=VC(),e=tu(),{currentUserId:n,selectedBudgetId:i,currentYear:a,currentMonthNumber:l,lastActiveTab:u,setCurrentYear:f,setCurrentMonthNumber:p,setLastActiveTab:g,goToPreviousMonth:_,goToNextMonth:v,hasPendingInvites:x,pendingInvites:w,needsFirstBudget:A}=wn(),{budget:I,createBudget:N,acceptInvite:H}=Gn(i,n),{month:$,isLoading:q}=Tl(i,a,l),[me,re]=T.useState(null),he=T.useRef(!1),[L,D]=T.useState(()=>{const{tab:Y}=VE(t);return Y??u}),R=Y=>{D(Y),g(Y)};T.useEffect(()=>{if(he.current)return;const{year:Y,month:U}=VE(t);Y&&f(Y),U&&p(U),he.current=!0},[t,f,p]),T.useEffect(()=>{if(!he.current)return;const Y=`/budget/${a}/${l}/${L}`,U=`/budget/${t.year}/${t.month}/${t.tab}`;Y!==U&&e(Y,{replace:!0})},[a,l,L,e,t]);async function M(Y){try{await H(Y)}catch(U){re(U instanceof Error?U.message:"Failed to accept invite")}}async function j(Y){try{await N(Y||"My Budget")}catch(U){re(U instanceof Error?U.message:"Failed to create budget")}}if(!I&&x)return d.jsxs(Ko,{children:[d.jsx(mi,{title:"Budget",showBackArrow:!0,hideMenu:!0}),d.jsx(u4,{invites:w,onAccept:M,onCreateNew:j})]});if(!I&&A)return d.jsxs(Ko,{children:[d.jsx(mi,{title:"Budget",showBackArrow:!0,hideMenu:!0}),d.jsx(c4,{onCreateNew:j})]});function O(){re(null),_()}function C(){re(null),v()}return d.jsxs(Ko,{children:[d.jsx(mi,{title:I?.name||"Budget"}),d.jsxs(PP,{children:[me&&d.jsx(wl,{message:me,onDismiss:()=>re(null)}),d.jsx(f4,{isLoading:q,onPreviousMonth:O,onNextMonth:C}),d.jsx(d4,{activeTab:L,setActiveTab:R,allocationsFinalized:$?.are_allocations_finalized}),L==="income"&&d.jsx(v4,{}),L==="balances"&&d.jsx(R4,{}),L==="spend"&&d.jsx(E4,{})]})]})}function I4(){return d.jsxs(Ko,{children:[d.jsx(mi,{title:"Analytics"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[d.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),d.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),d.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),d.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),d.jsx(It,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:ue.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})]})}function Lh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,accountGroups:a,showGroupSelector:l=!1,showIncomeSettings:u=!1,hasExistingIncomeDefault:f=!1,hasExistingOutgoDefault:p=!1,currentGroupId:g}){const[_,v]=T.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),x=_.account_group_id||g,w=x?a.find(q=>q.id===x):null,A=w?.is_active!==void 0,I=w?.on_budget!==void 0;function N(q){q.preventDefault(),_.nickname.trim()&&e(_)}function H(q){v({..._,is_income_account:q,is_income_default:q?_.is_income_default:!1})}function $(q){v({..._,is_outgo_account:q,is_outgo_default:q?_.is_outgo_default:!1})}return d.jsxs(Gs,{actionName:i==="Create Account"?"Create Account":"Update Account",onSubmit:N,children:[d.jsx(St,{label:"Account Nickname",htmlFor:"account-nickname",children:d.jsx(Qs,{id:"account-nickname",type:"text",value:_.nickname,onChange:q=>v({..._,nickname:q.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&d.jsx(St,{label:"Account Type",htmlFor:"account-group",children:d.jsxs(Zc,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:q=>v({..._,account_group_id:q.target.value==="ungrouped"?null:q.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Ungrouped"}),a.map(q=>d.jsx("option",{value:q.id,children:q.name},q.id))]})}),u&&d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(Os,{id:"is-active",checked:A?w.is_active:_.is_active!==!1,onChange:q=>v({..._,is_active:q.target.checked}),disabled:A,children:d.jsx("span",{style:{opacity:A?.5:1},children:"Active account"})}),A&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ue.warning},children:['Set by account type "',w.name,'"']})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(Os,{id:"on-budget",checked:I?w.on_budget:_.on_budget!==!1,onChange:q=>v({..._,on_budget:q.target.checked}),disabled:I,children:d.jsx("span",{style:{opacity:I?.5:1},children:"On budget (affects budget totals)"})}),I&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ue.warning},children:['Set by account type "',w.name,'"']})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),d.jsx(Os,{id:"is-income-account",checked:_.is_income_account||!1,onChange:q=>H(q.target.checked),children:"Show in income deposit list"}),_.is_income_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(Os,{id:"is-income-default",checked:_.is_income_default||!1,onChange:q=>v({..._,is_income_default:q.target.checked}),disabled:f&&!t?.is_income_default,children:"Default account for new income"}),f&&!t?.is_income_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),d.jsx(Os,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:q=>$(q.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(Os,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:q=>v({..._,is_outgo_default:q.target.checked}),disabled:p&&!t?.is_outgo_default,children:"Default account for new expenses"}),p&&!t?.is_outgo_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),d.jsxs(Ga,{children:[d.jsx(Le,{type:"submit",actionName:i,children:i}),d.jsx(Le,{type:"button",variant:"secondary",actionName:"Cancel Account Form",onClick:n,children:"Cancel"})]})]})}function UE({label:t,value:e,onChange:n,trueLabel:i,falseLabel:a,undefinedLabel:l}){function u(){n(e===void 0?!0:e===!0?!1:void 0)}const f=e===!0?i:e===!1?a:l,p=e===!0?ue.success:e===!1?ue.warning:"inherit",g=e===!0?"":e===!1?"":"";return d.jsxs("button",{type:"button",onClick:u,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${p} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${p} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[d.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?p:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:g}),d.jsxs("span",{style:{flex:1},children:[d.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",d.jsx("span",{style:{fontWeight:500,color:p},children:f})]}),d.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function o1({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=T.useState(t||{name:"",expected_balance:"positive"});function u(f){f.preventDefault(),a.name.trim()&&e(a)}return d.jsxs(Gs,{actionName:i==="Create Account Type"?"Create Account Type":"Update Account Type",onSubmit:u,children:[d.jsx(St,{label:"Account Type Name",htmlFor:"group-name",children:d.jsx(Qs,{id:"group-name",type:"text",value:a.name,onChange:f=>l({...a,name:f.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),d.jsx(St,{label:"Expected Balance",htmlFor:"expected-balance",children:d.jsxs(Zc,{id:"expected-balance",value:a.expected_balance,onChange:f=>l({...a,expected_balance:f.target.value}),children:[d.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),d.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),d.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",d.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),d.jsx(UE,{label:"Active status",value:a.is_active,onChange:f=>l({...a,is_active:f}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),d.jsx(UE,{label:"Budget status",value:a.on_budget,onChange:f=>l({...a,on_budget:f}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),d.jsxs(Ga,{children:[d.jsx(Le,{type:"submit",actionName:i,children:i}),d.jsx(Le,{type:"button",variant:"secondary",actionName:"Cancel Account Type Form",onClick:n,children:"Cancel"})]})]})}function No({icon:t,label:e,variant:n,title:i}){const l={success:{background:`color-mix(in srgb, ${ue.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${ue.success} 40%, transparent)`,color:ue.success,opacity:1},warning:{background:`color-mix(in srgb, ${ue.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${ue.warning} 35%, transparent)`,color:ue.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${ue.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ue.success} 25%, transparent)`,color:ue.success,opacity:.7},expense:{background:`color-mix(in srgb, ${ue.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ue.warning} 25%, transparent)`,color:ue.warning,opacity:.7}}[n];return d.jsxs("span",{title:i||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[d.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function l1({account:t,accountGroups:e}){const n=[],i=t.account_group_id?e.find(u=>u.id===t.account_group_id):null,a=i?.is_active!==void 0?i.is_active:t.is_active!==!1,l=i?.on_budget!==void 0?i.on_budget:t.on_budget!==!1;if(!a){const u=i?.is_active!==void 0;n.push(d.jsx(No,{icon:"",label:u?"Inactive (type)":"Inactive",variant:"warning",title:u?`Set by "${i.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const u=i?.on_budget!==void 0;n.push(d.jsx(No,{icon:"",label:u?"Off Budget (type)":"Off Budget",variant:"warning",title:u?`Set by "${i.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(d.jsx(No,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(d.jsx(No,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(d.jsx(No,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(d.jsx(No,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:d.jsx(d.Fragment,{children:n})}function j4({group:t}){const e=[];return t.is_active===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ue.warning} 20%, transparent)`,color:ue.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ue.success} 20%, transparent)`,color:ue.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ue.warning} 20%, transparent)`,color:ue.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ue.success} 20%, transparent)`,color:ue.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:d.jsx(d.Fragment,{children:e})}function c1({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ue.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function O4(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function k4(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function M4({group:t,groupIndex:e,totalGroups:n,accounts:i,allGroups:a,allAccounts:l,editingAccountId:u,editingGroupId:f,createForGroupId:p,setEditingAccountId:g,setEditingGroupId:_,setCreateForGroupId:v,dragType:x,draggedId:w,dragOverId:A,dragOverGroupId:I,setDragOverId:N,setDragOverGroupId:H,onAccountDragStart:$,onAccountDragOver:q,onAccountDrop:me,onGroupDragStart:re,onGroupDragOver:he,onGroupDrop:L,onDragLeave:D,onDragLeaveGroup:R,onDragEnd:M,onDropOnGroup:j,onCreateAccount:O,onUpdateAccount:C,onDeleteAccount:Y,onMoveAccount:U,onUpdateGroup:P,onDeleteGroup:B,onMoveGroup:Q}){const le=Ji(),J=[...i].sort((ce,Te)=>ce.sort_order-Te.sort_order),z=x==="group"&&w===t.id,F=x==="group"&&A===t.id,W=x==="account"&&I===t.id,se=(w&&x==="account"?l[w]:null)&&Object.entries(l).find(([ce])=>ce===w)?.[1]&&Object.entries(l).find(([ce])=>ce===w)?.[1]?.account_group_id!==t.id,pe=x==="group"&&F&&w!==t.id,de=e>0,be=e<n-1,Se=J.reduce((ce,Te)=>ce+Te.balance,0);return d.jsxs("div",{children:[x==="group"&&!z&&d.jsxs("div",{onDragOver:ce=>{ce.preventDefault(),N(t.id)},onDragLeave:D,onDrop:ce=>L(ce,t.id),style:{position:"relative",height:pe?"2.5rem":"0.5rem",marginBottom:pe?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ue.primary,borderRadius:"2px",opacity:pe?1:0,transition:"opacity 0.15s",boxShadow:pe?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),pe&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{draggable:f!==t.id,onDragStart:ce=>re(ce,t.id),onDragOver:ce=>he(ce,t.id),onDragLeave:R,onDragEnd:M,onDrop:ce=>j(ce,t.id),style:{background:z?"color-mix(in srgb, currentColor 3%, transparent)":W&&se?`color-mix(in srgb, ${ue.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:z?.5:1,border:W&&se?`2px dashed ${ue.primary}`:"2px solid transparent",cursor:f===t.id?"default":"grab",transition:"all 0.15s"},children:f===t.id?d.jsx(o1,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:ce=>P(t.id,ce),onCancel:()=>_(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsx(N4,{group:t,accountCount:J.length,groupTotal:Se,canMoveUp:de,canMoveDown:be,isMobile:le,createForGroupId:p,onEdit:()=>_(t.id),onDelete:()=>B(t.id),onMoveUp:()=>Q(t.id,"up"),onMoveDown:()=>Q(t.id,"down"),onAddAccount:()=>v(t.id)}),le&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Le,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:()=>v(t.id),disabled:p!==null,children:"+ Account"})}),d.jsxs("div",{style:sl,children:[J.map((ce,Te)=>u===ce.id?d.jsx(Lh,{initialData:{nickname:ce.nickname,account_group_id:ce.account_group_id,is_income_account:ce.is_income_account,is_income_default:ce.is_income_default,is_outgo_account:ce.is_outgo_account,is_outgo_default:ce.is_outgo_default,on_budget:ce.on_budget,is_active:ce.is_active},onSubmit:De=>C(ce.id,De),onCancel:()=>g(null),submitLabel:"Save",accountGroups:a,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:ce.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([De,Ae])=>Ae.is_income_default&&De!==ce.id),hasExistingOutgoDefault:Object.entries(l).some(([De,Ae])=>Ae.is_outgo_default&&De!==ce.id)},ce.id):d.jsx(gf,{isDragging:x==="account"&&w===ce.id,isDragOver:A===ce.id,onDragStart:De=>{De.stopPropagation(),$(De,ce.id)},onDragOver:De=>q(De,ce.id,t.id),onDragLeave:D,onDragEnd:M,onDrop:De=>me(De,ce.id,t.id),onEdit:()=>{st("CLICK","Edit Account",{details:ce.nickname}),g(ce.id)},onDelete:()=>{st("CLICK","Delete Account",{details:ce.nickname}),Y(ce.id)},onMoveUp:()=>U(ce.id,"up"),onMoveDown:()=>U(ce.id,"down"),canMoveUp:Te>0,canMoveDown:Te<J.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Ly,children:ce.nickname}),d.jsx(l1,{account:ce,accountGroups:a})]}),d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:an(ce.balance)},children:[je(ce.balance),O4(ce.balance,t.expected_balance)&&d.jsx("span",{title:k4(ce.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},ce.id)),J.length===0&&!p&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),x==="account"&&J.length>0&&d.jsx(c1,{groupId:t.id,isActive:A===`__end__${t.id}`,onDragOver:ce=>{ce.preventDefault(),ce.stopPropagation(),N(`__end__${t.id}`),H(t.id)},onDragLeave:ce=>{ce.stopPropagation(),N(null)},onDrop:ce=>{ce.stopPropagation(),me(ce,"__group_end__",t.id)}}),p===t.id&&d.jsx(Lh,{initialData:{nickname:"",account_group_id:t.id},onSubmit:ce=>O(ce,t.id),onCancel:()=>v(null),submitLabel:"Create",accountGroups:a,showIncomeSettings:!0,currentGroupId:t.id})]}),p!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Le,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:()=>v(t.id),disabled:p!==null,children:"+ Add Account"})})]})})]})}function N4({group:t,accountCount:e,groupTotal:n,canMoveUp:i,canMoveDown:a,isMobile:l,createForGroupId:u,onEdit:f,onDelete:p,onMoveUp:g,onMoveDown:_,onAddAccount:v}){return d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{...Sl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&d.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:an(n),flexShrink:0},children:je(n)}),d.jsx(j4,{group:t})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&d.jsx(Le,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:v,disabled:u!==null,children:"+ Account"}),d.jsx("button",{onClick:()=>{st("CLICK","Edit Account Type",{details:t.name}),f()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),d.jsx("button",{onClick:()=>{st("CLICK","Delete Account Type",{details:t.name}),p()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),d.jsxs("div",{style:Py,children:[d.jsx("button",{onClick:g,disabled:!i,style:{...il,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:_,disabled:!a,style:{...il,opacity:a?.6:.2,cursor:a?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function P4({accounts:t,allGroups:e,allAccounts:n,hasGroups:i,editingAccountId:a,createForGroupId:l,setEditingAccountId:u,setCreateForGroupId:f,dragType:p,draggedId:g,dragOverId:_,dragOverGroupId:v,setDragOverId:x,setDragOverGroupId:w,onAccountDragStart:A,onAccountDragOver:I,onAccountDrop:N,onDragOverGroup:H,onDropOnGroup:$,onDragLeave:q,onDragLeaveGroup:me,onDragEnd:re,onCreateAccount:he,onUpdateAccount:L,onDeleteAccount:D,onMoveAccount:R}){const M=[...t].sort((U,P)=>U.sort_order-P.sort_order),j=p==="account"&&v==="ungrouped",C=(g&&p==="account"?n[g]:null)&&Object.entries(n).find(([U])=>U===g)?.[1]&&Object.entries(n).find(([U])=>U===g)?.[1]?.account_group_id!==null;if(M.length===0&&!l&&i&&p!=="account")return null;const Y=M.reduce((U,P)=>U+P.balance,0);return d.jsxs("div",{onDragOver:U=>H(U,"ungrouped"),onDragLeave:me,onDrop:U=>$(U,"ungrouped"),style:{background:j&&C?`color-mix(in srgb, ${ue.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:j&&C?`2px dashed ${ue.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Sl,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",M.length,")"]}),M.length>0&&d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:an(Y)},children:je(Y)})]}),d.jsx(Le,{variant:"small",actionName:"Open Add Account Form (Ungrouped)",onClick:()=>f("ungrouped"),disabled:l!==null,children:"+ Account"})]}),d.jsxs("div",{style:sl,children:[M.map((U,P)=>a===U.id?d.jsx(Lh,{initialData:{nickname:U.nickname,account_group_id:U.account_group_id,is_income_account:U.is_income_account,is_income_default:U.is_income_default,is_outgo_account:U.is_outgo_account,is_outgo_default:U.is_outgo_default,on_budget:U.on_budget,is_active:U.is_active},onSubmit:B=>L(U.id,B),onCancel:()=>u(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([B,Q])=>Q.is_income_default&&B!==U.id),hasExistingOutgoDefault:Object.entries(n).some(([B,Q])=>Q.is_outgo_default&&B!==U.id)},U.id):d.jsx(gf,{isDragging:p==="account"&&g===U.id,isDragOver:_===U.id,onDragStart:B=>A(B,U.id),onDragOver:B=>I(B,U.id,"ungrouped"),onDragLeave:q,onDragEnd:re,onDrop:B=>N(B,U.id,"ungrouped"),onEdit:()=>{st("CLICK","Edit Account",{details:U.nickname}),u(U.id)},onDelete:()=>{st("CLICK","Delete Account",{details:U.nickname}),D(U.id)},onMoveUp:()=>R(U.id,"up"),onMoveDown:()=>R(U.id,"down"),canMoveUp:P>0,canMoveDown:P<M.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Ly,children:U.nickname}),d.jsx(l1,{account:U,accountGroups:e})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:an(U.balance)},children:je(U.balance)})]})},U.id)),M.length===0&&p==="account"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),p==="account"&&M.length>0&&d.jsx(c1,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:U=>{U.preventDefault(),U.stopPropagation(),x("__end__ungrouped"),w("ungrouped")},onDragLeave:U=>{U.stopPropagation(),x(null)},onDrop:U=>{U.stopPropagation(),N(U,"__group_end__","ungrouped")}}),l==="ungrouped"&&d.jsx(Lh,{initialData:{nickname:"",account_group_id:null},onSubmit:U=>he(U,"ungrouped"),onCancel:()=>f(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Le,{variant:"small",actionName:"Open Add Account Form (Ungrouped)",onClick:()=>f("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function L4(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:i,error:a,setError:l,handleCreateAccount:u,handleUpdateAccount:f,handleDeleteAccount:p,handleMoveAccount:g,handleCreateGroup:_,handleUpdateGroup:v,handleDeleteGroup:x,handleMoveGroup:w,reorderAccountsInGroup:A,reorderGroups:I}=ZP(),N=Ji(),[H,$]=T.useState(null),[q,me]=T.useState(null),[re,he]=T.useState(null),[L,D]=T.useState(!1),[R,M]=T.useState(null),[j,O]=T.useState(null),[C,Y]=T.useState(null),[U,P]=T.useState(null);function B(be,Se){M("account"),O(Se),be.dataTransfer.effectAllowed="move"}function Q(be,Se,ce){be.preventDefault(),R==="account"&&(Se!==j&&Y(Se),P(ce))}function le(be,Se){be.preventDefault(),R==="account"?(P(Se),Y(null)):R==="group"&&Se!==j&&Y(Se)}function J(){Y(null)}function z(){P(null)}function F(){M(null),O(null),Y(null),P(null)}async function W(be,Se,ce){if(be.preventDefault(),be.stopPropagation(),!j||R!=="account"){F();return}await A(j,Se,ce),F()}async function te(be,Se){be.preventDefault(),R==="account"?await W(be,"__group_end__",Se):R==="group"&&await pe(be,Se)}function se(be,Se){be.stopPropagation(),M("group"),O(Se),be.dataTransfer.effectAllowed="move"}async function pe(be,Se){if(be.preventDefault(),!j||R!=="group"||j===Se){F();return}await I(j,Se),F()}if(!i)return d.jsx("p",{children:"No budget found. Please log in."});const de=e.ungrouped||[];return d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Accounts"}),d.jsxs("p",{style:Jc,children:["Organize your financial accounts by type.",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"0.9rem"},children:N?"Use  buttons to reorder items, or drag to move between types.":"Drag accounts between types, or use  buttons to reorder."})]}),a&&d.jsx(wl,{message:a,onDismiss:()=>l(null)}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:d.jsx(Fy,{})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(t).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((be,Se)=>d.jsx(M4,{group:be,groupIndex:Se,totalGroups:n.length,accounts:e[be.id]||[],allGroups:n,allAccounts:t,editingAccountId:H,editingGroupId:re,createForGroupId:q,setEditingAccountId:$,setEditingGroupId:he,setCreateForGroupId:me,dragType:R,draggedId:j,dragOverId:C,dragOverGroupId:U,setDragOverId:Y,setDragOverGroupId:P,onAccountDragStart:B,onAccountDragOver:Q,onAccountDrop:W,onGroupDragStart:se,onGroupDragOver:le,onGroupDrop:pe,onDragLeave:J,onDragLeaveGroup:z,onDragEnd:F,onDropOnGroup:te,onCreateAccount:u,onUpdateAccount:(ce,Te)=>{f(ce,Te),$(null)},onDeleteAccount:p,onMoveAccount:g,onUpdateGroup:(ce,Te)=>{v(ce,Te),he(null)},onDeleteGroup:x,onMoveGroup:w},be.id)),R==="group"&&n.length>0&&d.jsx(zy,{isActive:C==="__end__",onDragOver:be=>{be.preventDefault(),Y("__end__")},onDragLeave:J,onDrop:be=>pe(be,"__end__"),label:"Move account type to end"}),d.jsx(P4,{accounts:de,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:H,createForGroupId:q,setEditingAccountId:$,setCreateForGroupId:me,dragType:R,draggedId:j,dragOverId:C,dragOverGroupId:U,setDragOverId:Y,setDragOverGroupId:P,onAccountDragStart:B,onAccountDragOver:Q,onAccountDrop:W,onDragOverGroup:le,onDropOnGroup:te,onDragLeave:J,onDragLeaveGroup:z,onDragEnd:F,onCreateAccount:u,onUpdateAccount:(be,Se)=>{f(be,Se),$(null)},onDeleteAccount:p,onMoveAccount:g})]}),L?d.jsx(o1,{onSubmit:be=>{_(be),D(!1)},onCancel:()=>D(!1),submitLabel:"Create Account Type"}):d.jsx(Le,{variant:"primary-large",actionName:"Open Add Account Type Form",onClick:()=>D(!0),children:"+ Add Account Type"})]})}function Vh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,categoryGroups:a=[],showGroupSelector:l=!1}){const[u,f]=T.useState(t||{name:"",category_group_id:null}),[p,g]=T.useState(t?.default_monthly_amount?.toString()||""),[_,v]=T.useState(t?.default_monthly_type||"fixed"),[x,w]=T.useState(!1);function A(I){if(I.preventDefault(),!u.name.trim())return;w(!0);const N=parseFloat(p),H=!isNaN(N)&&N>0;e({...u,description:u.description?.trim()||void 0,default_monthly_amount:H?N:void 0,default_monthly_type:H?_:void 0})}return d.jsxs(Gs,{actionName:i==="Create"?"Create Category":"Update Category",onSubmit:A,children:[d.jsx(St,{label:"Category Name",htmlFor:"category-name",children:d.jsx(Qs,{id:"category-name",type:"text",value:u.name,onChange:I=>f({...u,name:I.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),d.jsx(St,{label:"Description (optional)",htmlFor:"category-description",children:d.jsx(Vy,{id:"category-description",value:u.description||"",onChange:I=>f({...u,description:I.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&d.jsx(St,{label:"Category Group",htmlFor:"category-group",children:d.jsxs(Zc,{id:"category-group",value:u.category_group_id||"ungrouped",onChange:I=>f({...u,category_group_id:I.target.value==="ungrouped"?null:I.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Uncategorized"}),a.map(I=>d.jsx("option",{value:I.id,children:I.name},I.id))]})}),d.jsxs(St,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[d.jsxs(Zc,{id:"default-type",value:_,onChange:I=>v(I.target.value),style:{width:"auto",flex:"0 0 auto"},children:[d.jsx("option",{value:"fixed",children:"Fixed $"}),d.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?d.jsx(hh,{id:"default-amount",value:p,onChange:g,placeholder:"$0.00"}):d.jsx(Qs,{id:"default-amount",type:"number",value:p,onChange:I=>g(I.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&d.jsx("span",{style:{opacity:.6},children:"%"})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),d.jsxs(Ga,{children:[d.jsx(Le,{type:"submit",actionName:i==="Create"?"Create Category":"Save Category",isLoading:x,children:i}),d.jsx(Le,{type:"button",variant:"secondary",actionName:"Cancel Category Form",onClick:n,children:"Cancel"})]})]})}function u1({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=T.useState(t||{name:""}),[u,f]=T.useState(!1);function p(g){g.preventDefault(),a.name.trim()&&(f(!0),e(a))}return d.jsxs(Gs,{actionName:i==="Create Group"?"Create Category Group":"Update Category Group",onSubmit:p,children:[d.jsx(St,{label:"Group Name",htmlFor:"group-name",children:d.jsx(Qs,{id:"group-name",type:"text",value:a.name,onChange:g=>l({...a,name:g.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),d.jsxs(Ga,{children:[d.jsx(Le,{type:"submit",actionName:i==="Create Group"?"Create Category Group":"Save Category Group",isLoading:u,children:i}),d.jsx(Le,{type:"button",variant:"secondary",actionName:"Cancel Category Group Form",onClick:n,children:"Cancel"})]})]})}function d1({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ue.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function V4({group:t,groupIndex:e,groupCategories:n,sortedGroups:i,categoryGroups:a,categoryBalances:l,loadingBalances:u,dragType:f,draggedId:p,dragOverId:g,dragOverGroupId:_,editingCategoryId:v,setEditingCategoryId:x,createForGroupId:w,setCreateForGroupId:A,editingGroupId:I,setEditingGroupId:N,handleCreateCategory:H,handleUpdateCategory:$,handleDeleteCategory:q,handleMoveCategory:me,handleUpdateGroup:re,handleDeleteGroup:he,handleMoveGroup:L,handleCategoryDragStart:D,handleCategoryDragOver:R,handleDragOverGroup:M,handleDragLeave:j,handleDragLeaveGroup:O,handleDragEnd:C,handleCategoryDrop:Y,handleDropOnGroup:U,handleGroupDragStart:P,handleGroupDrop:B,setDragOverId:Q,setDragOverGroupId:le,isMobile:J,categories:z}){const F=f==="group"&&p===t.id,W=f==="group"&&g===t.id,te=f==="category"&&_===t.id,se=p&&f==="category"?z[p]:null,pe=se&&(se.category_group_id||"ungrouped")!==t.id,de=f==="group"&&W&&p!==t.id,be=e>0,Se=e<i.length-1;return d.jsxs("div",{children:[f==="group"&&!F&&d.jsxs("div",{onDragOver:ce=>{ce.preventDefault(),Q(t.id)},onDragLeave:j,onDrop:ce=>B(ce,t.id),style:{position:"relative",height:de?"2.5rem":"0.5rem",marginBottom:de?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ue.primary,borderRadius:"2px",opacity:de?1:0,transition:"opacity 0.15s",boxShadow:de?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),de&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{onDragOver:ce=>M(ce,t.id),onDragLeave:O,onDrop:ce=>U(ce,t.id),style:{background:F?"color-mix(in srgb, currentColor 3%, transparent)":te&&pe?`color-mix(in srgb, ${ue.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:F?.5:1,border:te&&pe?`2px dashed ${ue.primary}`:"2px solid transparent",transition:"all 0.15s"},children:I===t.id?d.jsx(u1,{initialData:{name:t.name},onSubmit:ce=>re(t.id,ce),onCancel:()=>N(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:J?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:J?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{...Sl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!J&&d.jsx("span",{draggable:!0,onDragStart:ce=>P(ce,t.id),onDragEnd:C,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",n.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!J&&d.jsx(Le,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>A(t.id),disabled:w!==null,children:"+ Category"}),d.jsx("button",{onClick:()=>{st("CLICK","Edit Category Group",{details:t.name}),N(t.id)},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),d.jsx("button",{onClick:()=>{st("CLICK","Delete Category Group",{details:t.name}),he(t.id)},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),d.jsxs("div",{style:Py,children:[d.jsx("button",{onClick:()=>L(t.id,"up"),disabled:!be,style:{...il,opacity:be?.6:.2,cursor:be?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),d.jsx("button",{onClick:()=>L(t.id,"down"),disabled:!Se,style:{...il,opacity:Se?.6:.2,cursor:Se?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),J&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Le,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>A(t.id),disabled:w!==null,children:"+ Category"})}),d.jsxs("div",{style:sl,children:[n.map(([ce,Te])=>v===ce?d.jsx(Vh,{initialData:{name:Te.name,description:Te.description,category_group_id:Te.category_group_id,default_monthly_amount:Te.default_monthly_amount,default_monthly_type:Te.default_monthly_type},onSubmit:De=>$(ce,De),onCancel:()=>x(null),submitLabel:"Save",categoryGroups:a,showGroupSelector:!0},ce):d.jsx(gf,{isDragging:f==="category"&&p===ce,isDragOver:g===ce,onDragStart:De=>{De.stopPropagation(),D(De,ce)},onDragOver:De=>R(De,ce,t.id),onDragLeave:j,onDragEnd:C,onDrop:De=>Y(De,ce,t.id),onEdit:()=>{st("CLICK","Edit Category",{details:Te.name}),x(ce)},onDelete:()=>{st("CLICK","Delete Category",{details:Te.name}),q(ce)},onMoveUp:()=>me(ce,"up"),onMoveDown:()=>me(ce,"down"),canMoveUp:n.findIndex(([De])=>De===ce)>0,canMoveDown:n.findIndex(([De])=>De===ce)<n.length-1,children:d.jsx(h1,{category:Te,catId:ce,categoryBalances:l,loadingBalances:u})},ce)),n.length===0&&!w&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),f==="category"&&n.length>0&&d.jsx(d1,{groupId:t.id,isActive:g===`__end__${t.id}`,onDragOver:ce=>{ce.preventDefault(),ce.stopPropagation(),Q(`__end__${t.id}`),le(t.id)},onDragLeave:ce=>{ce.stopPropagation(),Q(null)},onDrop:ce=>{ce.stopPropagation(),Y(ce,"__group_end__",t.id)}}),w===t.id&&d.jsx(Vh,{initialData:{name:"",category_group_id:t.id},onSubmit:ce=>H(ce,t.id),onCancel:()=>A(null),submitLabel:"Create",categoryGroups:a})]}),w!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Le,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>A(t.id),disabled:w!==null,children:"+ Add Category"})})]})})]})}function h1({category:t,catId:e,categoryBalances:n,loadingBalances:i}){const a=n[e]||{current:0,total:0};return d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Ly,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?d.jsxs(d.Fragment,{children:[d.jsxs("span",{style:{color:ue.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{style:{color:ue.success,fontWeight:500},children:je(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),d.jsxs("div",{style:{marginTop:"0.25rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:an(a.current)},children:[i?"...":je(a.current),d.jsx("span",{style:{fontSize:"0.75rem",fontWeight:400,opacity:.6,marginLeft:"0.35rem"},children:"available now"})]}),d.jsxs("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.85rem",fontWeight:500,color:an(a.total),opacity:.75},children:[i?"...":je(a.total),d.jsx("span",{style:{fontSize:"0.7rem",fontWeight:400,opacity:.7,marginLeft:"0.35rem"},children:"total allocated"})]})]})]})}function z4({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:i,dragType:a,draggedId:l,dragOverId:u,dragOverGroupId:f,editingCategoryId:p,setEditingCategoryId:g,createForGroupId:_,setCreateForGroupId:v,handleCreateCategory:x,handleUpdateCategory:w,handleDeleteCategory:A,handleMoveCategory:I,handleCategoryDragStart:N,handleCategoryDragOver:H,handleDragOverGroup:$,handleDragLeaveGroup:q,handleDragLeave:me,handleDragEnd:re,handleCategoryDrop:he,handleDropOnGroup:L,setDragOverId:D,setDragOverGroupId:R,categories:M,hasGroups:j}){const O=a==="category"&&f==="ungrouped",C=l&&a==="category"?M[l]:null,Y=C&&C.category_group_id!==null;return t.length===0&&!_&&j&&a!=="category"?null:d.jsxs("div",{onDragOver:U=>$(U,"ungrouped"),onDragLeave:q,onDrop:U=>L(U,"ungrouped"),style:{background:O&&Y?`color-mix(in srgb, ${ue.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:O&&Y?`2px dashed ${ue.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Sl,margin:0,opacity:.7},children:["Uncategorized",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),d.jsx(Le,{variant:"small",actionName:"Open Add Category Form (Uncategorized)",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Category"})]}),d.jsxs("div",{style:sl,children:[t.map(([U,P])=>p===U?d.jsx(Vh,{initialData:{name:P.name,description:P.description,category_group_id:P.category_group_id,default_monthly_amount:P.default_monthly_amount,default_monthly_type:P.default_monthly_type},onSubmit:B=>w(U,B),onCancel:()=>g(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},U):d.jsx(gf,{isDragging:a==="category"&&l===U,isDragOver:u===U,onDragStart:B=>N(B,U),onDragOver:B=>H(B,U,"ungrouped"),onDragLeave:me,onDragEnd:re,onDrop:B=>he(B,U,"ungrouped"),onEdit:()=>{st("CLICK","Edit Category",{details:P.name}),g(U)},onDelete:()=>{st("CLICK","Delete Category",{details:P.name}),A(U)},onMoveUp:()=>I(U,"up"),onMoveDown:()=>I(U,"down"),canMoveUp:t.findIndex(([B])=>B===U)>0,canMoveDown:t.findIndex(([B])=>B===U)<t.length-1,children:d.jsx(h1,{category:P,catId:U,categoryBalances:n,loadingBalances:i})},U)),t.length===0&&a==="category"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),a==="category"&&t.length>0&&d.jsx(d1,{groupId:"ungrouped",isActive:u==="__end__ungrouped",onDragOver:U=>{U.preventDefault(),U.stopPropagation(),D("__end__ungrouped"),R("ungrouped")},onDragLeave:U=>{U.stopPropagation(),D(null)},onDrop:U=>{U.stopPropagation(),he(U,"__group_end__","ungrouped")}}),_==="ungrouped"&&d.jsx(Vh,{initialData:{name:"",category_group_id:null},onSubmit:U=>x(U,"ungrouped"),onCancel:()=>v(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Le,{variant:"small",actionName:"Open Add Category Form (Uncategorized)",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function U4(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:i,sortedGroups:a,categoryBalances:l,isLoading:u,loadingBalances:f,error:p,setError:g,getOnBudgetTotal:_,handleCreateCategory:v,handleUpdateCategory:x,handleDeleteCategory:w,handleMoveCategory:A,handleCreateGroup:I,handleUpdateGroup:N,handleDeleteGroup:H,handleMoveGroup:$,dragType:q,draggedId:me,dragOverId:re,dragOverGroupId:he,setDragOverId:L,setDragOverGroupId:D,handleCategoryDragStart:R,handleCategoryDragOver:M,handleDragOverGroup:j,handleDragLeave:O,handleDragLeaveGroup:C,handleDragEnd:Y,handleCategoryDrop:U,handleDropOnGroup:P,handleGroupDragStart:B,handleGroupDrop:Q}=r4(),le=Ji(),[J,z]=T.useState(null),[F,W]=T.useState(null),[te,se]=T.useState(null),[pe,de]=T.useState(!1);return t?u?d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),d.jsx("p",{style:Jc,children:"Organize your spending categories into groups."}),d.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",opacity:.7},children:d.jsx("p",{children:"Loading..."})})]}):d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),d.jsxs("p",{style:Jc,children:["Organize your spending categories into groups.",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"0.9rem"},children:le?"Use  buttons to reorder items, or drag to move between groups.":"Drag categories between groups, or use  buttons to reorder."})]}),p&&d.jsx(wl,{message:p,onDismiss:()=>g(null)}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:d.jsx(Fy,{})}),(()=>{const be=Object.values(l).reduce((Ae,Me)=>Ae+Me.current,0),Se=Object.values(l).reduce((Ae,Me)=>Ae+Me.total,0),ce=_()-be,Te=_()-Se,De=Math.abs(Se-be)>.01;return d.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[d.jsxs(Dc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Categories"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:Object.keys(e).length})]}),d.jsxs(Dc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Groups"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:n.length})]}),d.jsxs(Dc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"On-Budget"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:an(_())},children:je(_())})]}),d.jsxs(Dc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Allocated Now"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:ue.primary},children:f?"...":je(be)}),De&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:f?"":`${je(Se)} total`})]}),d.jsxs(Dc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Available Now"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:an(ce)},children:f?"...":je(ce)}),De&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:f?"":`${je(Te)} after future`})]})]})})(),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(e).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),a.map((be,Se)=>{const ce=(i[be.id]||[]).sort((Te,De)=>Te[1].sort_order-De[1].sort_order);return d.jsx(V4,{group:be,groupIndex:Se,groupCategories:ce,sortedGroups:a,categoryGroups:n,categoryBalances:l,loadingBalances:f,dragType:q,draggedId:me,dragOverId:re,dragOverGroupId:he,editingCategoryId:J,setEditingCategoryId:z,createForGroupId:F,setCreateForGroupId:W,editingGroupId:te,setEditingGroupId:se,handleCreateCategory:v,handleUpdateCategory:x,handleDeleteCategory:w,handleMoveCategory:A,handleUpdateGroup:N,handleDeleteGroup:H,handleMoveGroup:$,handleCategoryDragStart:R,handleCategoryDragOver:M,handleDragOverGroup:j,handleDragLeave:O,handleDragLeaveGroup:C,handleDragEnd:Y,handleCategoryDrop:U,handleDropOnGroup:P,handleGroupDragStart:B,handleGroupDrop:Q,setDragOverId:L,setDragOverGroupId:D,isMobile:le,categories:e},be.id)}),q==="group"&&a.length>0&&d.jsx(zy,{isActive:re==="__end__",onDragOver:be=>{be.preventDefault(),L("__end__")},onDragLeave:O,onDrop:be=>Q(be,"__end__"),label:"Move group to end"}),d.jsx(z4,{ungroupedCategories:(i.ungrouped||[]).sort((be,Se)=>be[1].sort_order-Se[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:f,dragType:q,draggedId:me,dragOverId:re,dragOverGroupId:he,editingCategoryId:J,setEditingCategoryId:z,createForGroupId:F,setCreateForGroupId:W,handleCreateCategory:v,handleUpdateCategory:x,handleDeleteCategory:w,handleMoveCategory:A,handleCategoryDragStart:R,handleCategoryDragOver:M,handleDragOverGroup:j,handleDragLeaveGroup:C,handleDragLeave:O,handleDragEnd:Y,handleCategoryDrop:U,handleDropOnGroup:P,setDragOverId:L,setDragOverGroupId:D,categories:e,hasGroups:n.length>0})]}),pe?d.jsx(u1,{onSubmit:be=>{I(be),de(!1)},onCancel:()=>de(!1),submitLabel:"Create Group"}):d.jsx(Le,{variant:"primary-large",actionName:"Open Add Category Group Form",onClick:()=>de(!0),children:"+ Add Category Group"})]}):d.jsx("p",{children:"No budget found. Please log in."})}const B4=["accounts","categories","users"];function F4(){const{selectedBudgetId:t,currentUserId:e,lastSettingsTab:n,setLastSettingsTab:i}=wn(),{isOwner:a,isLoading:l}=Gn(t,e),u=Mn(),f=u.pathname==="/budget/settings",p=T.useMemo(()=>{const w=u.pathname;return w.includes("/settings/accounts")?"accounts":w.includes("/settings/categories")?"categories":w.includes("/settings/users")?"users":"categories"},[u.pathname]),g=p==="users";T.useEffect(()=>{f||i(p)},[p,f,i]);function _(){return!B4.includes(n)||n==="users"&&!a?"categories":n}const v=T.useMemo(()=>[{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!a}],[a]);return l?d.jsx("div",{style:Hn,children:d.jsx("p",{children:"Loading..."})}):!a&&g?d.jsxs("div",{style:Hn,children:[d.jsx(mi,{title:"Budget Settings"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only the budget owner can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(It,{to:"/budget/settings/categories",style:{color:"#646cff"},children:"Go to Categories "})})]}):d.jsxs("div",{style:Hn,children:[d.jsx(mi,{title:"Budget Settings"}),d.jsx(Uy,{mode:"link",linkPrefix:"/budget/settings",tabs:v,activeTab:f?_():p}),f?d.jsx(Uh,{to:`/budget/settings/${_()}`,replace:!0}):d.jsx(Bh,{})]})}function q4(){const{selectedBudgetId:t,currentUserId:e}=wn(),{budget:n,budgetUserIds:i,acceptedUserIds:a,inviteUser:l,revokeUser:u}=Gn(t,e),[f,p]=T.useState(""),[g,_]=T.useState(!1),[v,x]=T.useState(null),[w,A]=T.useState(null);if(!n)return d.jsx("p",{children:"No budget found."});async function I(q){if(q.preventDefault(),!(!f.trim()||!n)){_(!0),x(null),A(null);try{await l(f.trim()),p(""),A("Invite sent! The user can now accept the invitation from their account.")}catch(me){x(me instanceof Error?me.message:"Failed to invite user")}finally{_(!1)}}}async function N(q){if(!n)return;if(q===n.owner_id){x("Cannot revoke the budget owner");return}if(q===e){x("Cannot revoke yourself from the budget");return}const me=a.includes(q);if(confirm(me?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){x(null),A(null);try{await u(q),A(me?"User access revoked.":"Invitation cancelled.")}catch(he){x(he instanceof Error?he.message:"Failed to revoke user")}}}const H=i.filter(q=>a.includes(q)),$=i.filter(q=>!a.includes(q));return d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>x(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),w&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:w}),d.jsx("button",{onClick:()=>A(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",H.length,")"]}),H.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:H.map(q=>{const me=q===n.owner_id,re=q===e;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:q}),me&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),re&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!me&&!re&&d.jsx("button",{onClick:()=>N(q),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},q)})})]}),$.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",$.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:$.map(q=>d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:q}),d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),d.jsx("button",{onClick:()=>N(q),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},q))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),d.jsxs("form",{onSubmit:I,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:f,onChange:q=>p(q.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:g||!f.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||!f.trim()?"not-allowed":"pointer",fontWeight:500,opacity:g||!f.trim()?.7:1,whiteSpace:"nowrap"},children:g?"Inviting...":"Send Invite"})]}),d.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),d.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}const H4=["budget","feedback","migration","tests"];function G4(){const{isAdmin:t,isTest:e,lastAdminTab:n,setLastAdminTab:i}=wn(),a=Mn(),l=a.pathname==="/budget/admin",u=T.useMemo(()=>{const _=a.pathname;return _.includes("/admin/budget")?"budget":_.includes("/admin/feedback")?"feedback":_.includes("/admin/migration")?"migration":_.includes("/admin/tests")?"tests":"budget"},[a.pathname]),f=u==="tests";T.useEffect(()=>{l||i(u)},[u,l,i]);function p(){return!H4.includes(n)||n==="tests"&&!e?"budget":n}const g=T.useMemo(()=>[{id:"budget",label:"Budget",icon:""},{id:"feedback",label:"Feedback",icon:""},{id:"migration",label:"Migration",icon:""},{id:"tests",label:"Tests",icon:"",hidden:!e}],[e]);return t?!e&&f?d.jsxs("div",{style:Hn,children:[d.jsx(mi,{title:"Budget Admin"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only test users can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(It,{to:"/budget/admin/budget",style:{color:"#646cff"},children:"Go to Admin "})})]}):d.jsxs("div",{style:Hn,children:[d.jsx(mi,{title:"Budget Admin"}),d.jsx(Uy,{mode:"link",linkPrefix:"/budget/admin",tabs:g,activeTab:u}),l?d.jsx(Uh,{to:`/budget/admin/${p()}`,replace:!0}):d.jsx(Bh,{})]}):d.jsxs("div",{style:Hn,children:[d.jsx(mi,{title:"Budget Admin"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only administrators can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(It,{to:"/budget",style:{color:"#646cff"},children:"Go to Budget "})})]})}function Q4(){const{selectedBudgetId:t,currentUserId:e,isAdmin:n}=wn(),{budget:i,accounts:a,accountGroups:l,categories:u,categoryGroups:f,isOwner:p,isLoading:g}=Gn(t,e);return g?d.jsx("p",{children:"Loading budget info..."}):i?d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Summary"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Information about the currently selected budget."}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",fontSize:"0.95rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Name:"}),d.jsx("strong",{children:i.name})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"ID:"}),d.jsx("code",{style:{background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:i.id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Owner:"}),d.jsx("strong",{children:i.owner_email||i.owner_id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Users:"}),d.jsxs("span",{children:[i.user_ids.length," user",i.user_ids.length!==1?"s":"",d.jsxs("span",{style:{opacity:.7},children:["  ",p?"You are the owner":"Shared with you"]})]})]})]})}),n&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem"},children:"Admin Tools"}),d.jsx("button",{onClick:()=>{const _={...i,accounts:a,account_groups:l,categories:u,category_groups:f,_meta:{downloaded_at:new Date().toISOString()}},v=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),x=URL.createObjectURL(v),w=document.createElement("a");w.href=x,w.download=`budget_${i.id}.json`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(x)},style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",transition:"background 0.15s"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]})]}):d.jsx("p",{style:{opacity:.7},children:"No budget selected."})}function BE({budget:t,isCurrent:e,isAccepting:n,isSwitching:i,isEditing:a,editName:l,isRenaming:u,onAccept:f,onSwitch:p,onStartEdit:g,onCancelEdit:_,onEditNameChange:v,onSaveEdit:x}){const w=e&&t.isOwner;return d.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:a?d.jsxs("form",{onSubmit:x,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:d.jsx("input",{type:"text",value:l,onChange:A=>v(A.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[d.jsx("button",{type:"submit",disabled:u||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:u||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:u||!l.trim()?.7:1,fontSize:"0.8rem"},children:u?"Saving...":"Save"}),d.jsx("button",{type:"button",onClick:_,disabled:u,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:u?"not-allowed":"pointer",fontWeight:500,opacity:u?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[d.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),w&&d.jsx("button",{onClick:g,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),d.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?d.jsx("button",{onClick:f,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:d.jsx("button",{onClick:p,disabled:i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,fontSize:"0.85rem"},children:i?"Switching...":"Switch"})})]})})}const Ag={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function f1({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,i=n&&n in Ag?n:"bug",a=Ag[i];return d.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:a.bgColor,color:a.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:a.label})}function $4({item:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:u,onDrop:f,onToggleDone:p,onTypeClick:g}){return d.jsxs("div",{onDragOver:_=>{_.stopPropagation(),a(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),f(_)},style:{position:"relative"},children:[d.jsx("div",{style:{...e1,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:u,style:{...yu,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{...ZT},children:""}),d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:p,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ue.primary,flexShrink:0}}),d.jsx(f1,{type:t.feedback_type,onClick:g})]}),d.jsxs("div",{style:{marginLeft:"3.25rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",Tg(t.created_at)]})]})]})]})}function K4({item:t,onToggleDone:e,onTypeClick:n}){return d.jsxs("div",{style:{...yu,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ue.primary,flexShrink:0}}),d.jsx(f1,{type:t.feedback_type,onClick:n})]}),d.jsxs("div",{style:{marginLeft:"2rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",Tg(t.created_at)]}),t.completed_at&&d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:ue.success},children:[" Completed: ",Tg(t.completed_at)]})]})]})}function qy({noMargin:t}={}){return d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:t?0:"0.5rem",verticalAlign:"middle"}})}function Hy({title:t,description:e,status:n,statusText:i,onRefresh:a,isRefreshing:l,isBusy:u=!1,children:f}){const g=(()=>{switch(n){case"unknown":return{color:"#9ca3af",text:i??"Unknown"};case"clean":case"complete":return{color:"#22c55e",text:i??" Clean"};case"needs-action":return{color:"#f59e0b",text:i??"Action Needed"}}})(),_=l||u;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:t}),d.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.9rem"},children:e})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexShrink:0},children:[n!=="unknown"&&d.jsx("span",{style:{color:g.color,fontWeight:600,fontSize:"0.9rem"},children:g.text}),d.jsxs("button",{onClick:a,disabled:_,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem 0.65rem",borderRadius:"6px",cursor:_?"not-allowed":"pointer",fontWeight:500,fontSize:"0.85rem",opacity:_?.6:1,display:"flex",alignItems:"center",gap:"0.3rem"},title:"Refresh status",children:[l?d.jsx(qy,{noMargin:!0}):""," Refresh"]})]})]}),f]})}const W4={unknown:{bg:"rgba(100, 100, 100, 0.1)",border:"rgba(100, 100, 100, 0.3)",color:"#9ca3af"},clean:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"},warning:{bg:"rgba(245, 158, 11, 0.1)",border:"rgba(245, 158, 11, 0.3)",color:"#fbbf24"},running:{bg:"rgba(100, 108, 255, 0.1)",border:"rgba(100, 108, 255, 0.3)",color:"#a5b4fc"},success:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"}};function kn({type:t,children:e}){const n=W4[t];return d.jsx("div",{style:{background:n.bg,border:`1px solid ${n.border}`,color:n.color,padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:e})}function Gy({onClick:t,disabled:e,isBusy:n,busyText:i,children:a}){const l=e||n;return d.jsx("button",{onClick:t,disabled:l,style:{marginTop:"1rem",background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:l?"not-allowed":"pointer",fontWeight:500,opacity:l?.7:1,display:"flex",alignItems:"center",gap:"0.4rem"},children:n?d.jsxs(d.Fragment,{children:[d.jsx(qy,{noMargin:!0})," ",i??"Running..."]}):a})}function Y4({hasData:t,status:e,hasIssues:n,totalIssues:i,isRunning:a,result:l,onRunCleanup:u,onRefresh:f,isRefreshing:p,disabled:g}){const _=()=>t?l&&l.errors.length===0&&(l.accountsFixed>0||l.categoriesFixed>0||l.groupsFixed>0||l.futureMonthsDeleted>0||l.monthsFixed>0)?"complete":n?"needs-action":"clean":"unknown",v=l?l.accountsFixed+l.categoriesFixed+l.groupsFixed+l.futureMonthsDeleted+l.monthsFixed:0;return d.jsx(Hy,{title:" Database Cleanup",description:"Validates and fixes all budget and month documents to match the expected schema. Converts legacy formats, adds missing default values, and removes invalid future months.",status:_(),onRefresh:f,isRefreshing:p,isBusy:a,children:a?d.jsx(kn,{type:"running",children:"Running database cleanup..."}):l?d.jsx(kn,{type:l.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[l.errors.length>0?"":""," Cleanup complete",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.9rem"},children:[l.budgetsProcessed>0&&d.jsxs("li",{children:[l.budgetsProcessed," budget",l.budgetsProcessed!==1?"s":""," updated"]}),l.arraysConverted>0&&d.jsxs("li",{children:[l.arraysConverted," array",l.arraysConverted!==1?"s":""," converted to maps"]}),l.accountsFixed>0&&d.jsxs("li",{children:[l.accountsFixed," account",l.accountsFixed!==1?"s":""," fixed"]}),l.categoriesFixed>0&&d.jsxs("li",{children:[l.categoriesFixed," categor",l.categoriesFixed!==1?"ies":"y"," fixed"]}),l.groupsFixed>0&&d.jsxs("li",{children:[l.groupsFixed," group",l.groupsFixed!==1?"s":""," fixed"]}),l.futureMonthsDeleted>0&&d.jsxs("li",{children:[l.futureMonthsDeleted," future month",l.futureMonthsDeleted!==1?"s":""," deleted"]}),l.monthsFixed>0&&d.jsxs("li",{children:[l.monthsFixed," month",l.monthsFixed!==1?"s":""," schema fixed"]}),v===0&&d.jsx("li",{children:"No changes needed"})]}),l.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0.75rem 0 0.25rem 0",fontWeight:500,color:"#ef4444"},children:"Errors:"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.85rem",color:"#ef4444"},children:[l.errors.slice(0,5).map((x,w)=>d.jsx("li",{children:x},w)),l.errors.length>5&&d.jsxs("li",{style:{opacity:.7},children:["...and ",l.errors.length-5," more errors"]})]})]})]})}):t?n?d.jsxs(d.Fragment,{children:[d.jsx(kn,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",i," issue",i!==1?"s":""," to fix:"]}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[e.budgetsWithArrays>0&&d.jsxs("li",{children:[e.budgetsWithArrays," budget",e.budgetsWithArrays!==1?"s":""," using legacy array format"]}),e.accountsNeedingDefaults>0&&d.jsxs("li",{children:[e.accountsNeedingDefaults," account",e.accountsNeedingDefaults!==1?"s":""," missing default values"]}),e.categoriesNeedingDefaults>0&&d.jsxs("li",{children:[e.categoriesNeedingDefaults," categor",e.categoriesNeedingDefaults!==1?"ies":"y"," missing default values"]}),e.groupsNeedingDefaults>0&&d.jsxs("li",{children:[e.groupsNeedingDefaults," account group",e.groupsNeedingDefaults!==1?"s":""," missing default values"]}),e.futureMonthsToDelete.length>0&&d.jsxs("li",{children:[e.futureMonthsToDelete.length," future month",e.futureMonthsToDelete.length!==1?"s":""," to delete",d.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.85rem",opacity:.8},children:[e.futureMonthsToDelete.slice(0,3).map(x=>d.jsxs("li",{children:[pf[x.month-1]," ",x.year]},x.docId)),e.futureMonthsToDelete.length>3&&d.jsxs("li",{style:{opacity:.7},children:["...and ",e.futureMonthsToDelete.length-3," more"]})]})]}),e.monthsWithSchemaIssues>0&&d.jsxs("li",{children:[e.monthsWithSchemaIssues," month",e.monthsWithSchemaIssues!==1?"s":""," with schema issues"]})]}),d.jsxs("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["Scanned ",e.totalBudgets," budgets and ",e.totalMonths," months."]})]})}),d.jsxs(Gy,{onClick:u,disabled:g,isBusy:a,busyText:"Running...",children:[" Fix ",i," Issue",i!==1?"s":""]})]}):d.jsx(kn,{type:"clean",children:d.jsxs("div",{children:[" Database is clean",d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["All ",e.totalBudgets," budgets and ",e.totalMonths," months match expected schema."]})]})}):d.jsx(kn,{type:"unknown",children:" Status unknown  click Refresh to scan the database"})})}function X4({hasData:t,status:e,isMigrating:n,onMigrate:i,onRefresh:a,isRefreshing:l,disabled:u,migrationResult:f}){const p=e&&(e.sanitizedDocuments.length>0||e.corruptedDocuments.length>0),g=f&&(f.deletedDocuments>0||f.fixedDocuments>0),_=()=>t?g?"complete":p?"needs-action":"clean":"unknown";return d.jsx(Hy,{title:" Consolidate Feedback Documents",description:"Fixes corrupted feedback data and merges documents with sanitized IDs into proper email format.",status:_(),onRefresh:a,isRefreshing:l,isBusy:n,children:n?d.jsx(kn,{type:"running",children:"Migrating feedback documents..."}):t?g?d.jsx(kn,{type:"success",children:d.jsxs("div",{children:[" Migration complete:",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[f.fixedDocuments>0&&d.jsxs("li",{children:["Fixed ",f.fixedDocuments," corrupted document(s)"]}),f.deletedDocuments>0&&d.jsxs("li",{children:["Merged & deleted ",f.deletedDocuments," sanitized document(s)"]}),f.mergedItems>0&&d.jsxs("li",{children:["Merged ",f.mergedItems," feedback item(s)"]})]}),f.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{marginTop:"0.5rem"},children:" Errors:"}),d.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:f.errors.map((v,x)=>d.jsx("li",{children:v},x))})]})]})}):p?d.jsxs(d.Fragment,{children:[d.jsx(kn,{type:"warning",children:d.jsxs("div",{children:[e?.corruptedDocuments&&e.corruptedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.corruptedDocuments.length," corrupted document(s):"]}),d.jsx("ul",{style:{margin:"0 0 0.75rem 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.corruptedDocuments.map(v=>d.jsxs("li",{children:[v," ",d.jsx("span",{style:{opacity:.6},children:"(broken arrayUnion)"})]},v))})]}),e?.sanitizedDocuments&&e.sanitizedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.sanitizedDocuments.length," sanitized document(s) to merge:"]}),d.jsx("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.sanitizedDocuments.map(v=>d.jsx("li",{children:v},v))})]})]})}),d.jsx(Gy,{onClick:i,disabled:u,isBusy:n,busyText:"Migrating...",children:"Run Migration"})]}):d.jsxs(kn,{type:"clean",children:[" No issues found. All feedback documents are healthy.",d.jsxs("span",{style:{display:"block",fontSize:"0.85rem",opacity:.7,marginTop:"0.25rem"},children:["Found ",e?.documentsFound??0," document(s) total."]})]}):d.jsx(kn,{type:"unknown",children:" Status unknown  click Refresh to scan for issues"})})}function J4({hasData:t,monthsCount:e,budgetCount:n,monthsToDelete:i,isDeleting:a,onDelete:l,onRefresh:u,isRefreshing:f,disabled:p,deleteResult:g}){const _=()=>t?g&&g.deleted>0&&g.errors.length===0?"complete":e===0?"clean":"needs-action":"unknown",v=i.reduce((x,w)=>{const A=w.budgetId;return x[A]||(x[A]=[]),x[A].push(w),x},{});return d.jsx(Hy,{title:" Delete ALL Months",description:"DESTRUCTIVE: Deletes ALL month documents from Firebase for ALL budgets. This will reset all income, expenses, and allocations. Use with extreme caution!",status:_(),onRefresh:u,isRefreshing:f,isBusy:a,children:a?d.jsx(kn,{type:"running",children:"Deleting all months..."}):g?d.jsx(kn,{type:g.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[g.errors.length>0?"":""," Deleted ",g.deleted," month",g.deleted!==1?"s":"",g.errors.length>0&&d.jsx("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem"},children:g.errors.map((x,w)=>d.jsx("li",{children:x},w))})]})}):t?e>0?d.jsxs(d.Fragment,{children:[d.jsx(kn,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",d.jsx("strong",{children:e})," month",e!==1?"s":""," across ",d.jsx("strong",{children:n})," budget",n!==1?"s":"",":"]}),d.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto"},children:[Object.entries(v).slice(0,5).map(([x,w])=>d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[d.jsxs("div",{style:{fontWeight:500,fontSize:"0.85rem"},children:["Budget: ",x.slice(0,12),"..."]}),d.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.85rem"},children:[w.slice(0,3).map(A=>d.jsxs("li",{children:[pf[A.month-1]," ",A.year]},A.docId)),w.length>3&&d.jsxs("li",{style:{opacity:.7},children:["...and ",w.length-3," more"]})]})]},x)),Object.keys(v).length>5&&d.jsxs("div",{style:{opacity:.7,fontSize:"0.85rem",marginTop:"0.5rem"},children:["...and ",Object.keys(v).length-5," more budgets"]})]})]})}),d.jsxs(Gy,{onClick:l,disabled:p,isBusy:a,busyText:"Deleting...",children:[" Delete ALL ",e," Month",e!==1?"s":""]}),d.jsx("p",{style:{fontSize:"0.8rem",color:"#ef4444",marginTop:"0.5rem",fontWeight:500},children:" This action cannot be undone!"})]}):d.jsx(kn,{type:"clean",children:" No month documents found in Firebase."}):d.jsx(kn,{type:"unknown",children:" Status unknown  click Refresh to scan for months"})})}function Z4(){try{localStorage.removeItem("BUDGET_APP_QUERY_CACHE"),console.log("[Cache] Cleared React Query cache from localStorage")}catch(t){console.warn("Failed to clear localStorage cache:",t)}window.location.reload()}function e6(){const e=qa().get_current_firebase_user(),[n,i]=T.useState(!1),a=s4({currentUser:e}),l=o4({currentUser:e}),u=l4({currentUser:e,onComplete:()=>i(!0)}),f=a.isScanning||l.isScanning||u.isScanning,p=a.isRunning||l.isMigratingFeedback||u.isDeleting,g=async()=>{await Promise.all([a.scanStatus(),l.scanStatus(),u.scanStatus()])};return d.jsxs("div",{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[d.jsx("h2",{style:{margin:0},children:"Data Migrations"}),d.jsxs("button",{onClick:g,disabled:f||p,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:f||p?"not-allowed":"pointer",fontWeight:500,opacity:f||p?.7:1,display:"flex",alignItems:"center",gap:"0.4rem",minWidth:"130px",minHeight:"36px"},children:[d.jsx("span",{style:{width:"18px",height:"18px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:f?d.jsx(qy,{noMargin:!0}):""}),"Refresh All"]})]}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:'Run migrations to validate and fix your database. Click "Refresh All" to scan Firestore directly.'}),d.jsx(Y4,{hasData:!!a.status,status:a.status,hasIssues:a.hasIssues,totalIssues:a.totalIssues,isRunning:a.isRunning,result:a.result,onRunCleanup:a.runCleanup,onRefresh:a.scanStatus,isRefreshing:a.isScanning,disabled:!e}),d.jsx(X4,{hasData:!!l.status,status:l.status,isMigrating:l.isMigratingFeedback,onMigrate:l.migrateFeedbackDocuments,onRefresh:l.scanStatus,isRefreshing:l.isScanning,disabled:!e,migrationResult:l.feedbackMigrationResult}),d.jsx(J4,{hasData:!!u.status,monthsCount:u.status?.monthsCount??0,budgetCount:u.status?.budgetCount??0,monthsToDelete:u.status?.monthsToDelete??[],isDeleting:u.isDeleting,onDelete:u.deleteAllMonths,onRefresh:u.scanStatus,isRefreshing:u.isScanning,disabled:!e,deleteResult:u.deleteResult}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:d.jsxs("p",{style:{margin:0,opacity:.7},children:[d.jsx("strong",{children:"Note:"})," These migrations will process ",d.jsx("strong",{children:"all budgets and months"})," in the system, not just the ones you own or are invited to."]})}),d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, #ff6b6b 10%, transparent)",borderRadius:"8px",border:"1px solid color-mix(in srgb, #ff6b6b 30%, transparent)"},children:[d.jsxs("p",{style:{margin:"0 0 0.75rem 0",fontSize:"0.9rem"},children:[d.jsx("strong",{children:" Clear All Caches"}),d.jsx("span",{style:{opacity:.7,display:"block",marginTop:"0.25rem"},children:"If you're seeing stale data after running migrations, clear all cached data and reload to fetch fresh data from Firestore."})]}),d.jsx("button",{onClick:()=>i(!0),style:{background:"#dc2626",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,display:"flex",alignItems:"center",gap:"0.4rem"},children:" Clear All Caches & Reload"})]}),d.jsxs(al,{isOpen:n,onClose:()=>i(!1),title:"Clear Caches & Reload?",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.8},children:"This will clear all cached data from localStorage and reload the page. The app will fetch fresh data from Firestore for everything."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:()=>i(!1),style:{background:"transparent",color:"inherit",border:"1px solid rgba(255, 255, 255, 0.2)",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:500},children:"Cancel"}),d.jsx("button",{onClick:Z4,style:{background:"#dc2626",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:500},children:"Clear & Reload"})]})]})]})}function t6(){const[t,e]=T.useState(null),[n,i]=T.useState(null),[a,l]=T.useState(null),[u,f]=T.useState(!1),[p,g]=T.useState(""),[_,v]=T.useState("bug"),[x,w]=T.useState(null),[A,I]=T.useState(null),N=T.useContext(ru),$=qa().get_current_firebase_user(),q=Pk(),{submitFeedback:me}=t1(),{toggleFeedback:re}=RP(),{updateSortOrder:he}=DP(),L=q.data?.items||[];function D(J){J.preventDefault(),!(!p.trim()||!N.username||!$)&&(me.mutate({userId:$.uid,userEmail:N.username,text:p.trim(),feedbackType:_,currentPath:"/settings/feedback"}),g(""),v("bug"),f(!1))}function R(J){J.is_done?M(J):w(J)}async function M(J){try{await re.mutateAsync({item:J})}catch(z){e(z instanceof Error?z.message:"Failed to update feedback")}}function j(){x&&(M(x),w(null))}async function O(J){if(A){try{const F=L.filter(W=>W.doc_id===A.doc_id).map(W=>W.id===A.id?{id:W.id,text:W.text,created_at:W.created_at,is_done:W.is_done,completed_at:W.completed_at,sort_order:W.sort_order,feedback_type:J}:{id:W.id,text:W.text,created_at:W.created_at,is_done:W.is_done,completed_at:W.completed_at,sort_order:W.sort_order,feedback_type:W.feedback_type});await he.mutateAsync({docId:A.doc_id,items:F})}catch(z){e(z instanceof Error?z.message:"Failed to update feedback type")}I(null)}}const C=L.filter(J=>!J.is_done).sort((J,z)=>J.sort_order-z.sort_order),Y=L.filter(J=>J.is_done).sort((J,z)=>{const F=J.completed_at?new Date(J.completed_at).getTime():0;return(z.completed_at?new Date(z.completed_at).getTime():0)-F});function U(J,z){i(z),J.dataTransfer.effectAllowed="move"}function P(J,z){J.preventDefault(),z!==n&&l(z)}function B(){l(null)}function Q(){i(null),l(null)}async function le(J,z){if(J.preventDefault(),!n||n===z){Q();return}const F=C.findIndex(de=>de.id===n),W=[...C],[te]=W.splice(F,1);if(z==="__end__")W.push(te);else{const de=W.findIndex(be=>be.id===z);W.splice(de,0,te)}const se=W.map((de,be)=>({...de,sort_order:be}));Q();const pe=new Map;for(const de of se)pe.has(de.doc_id)||pe.set(de.doc_id,[]),pe.get(de.doc_id).push({id:de.id,text:de.text,created_at:de.created_at,is_done:de.is_done,completed_at:de.completed_at,sort_order:de.sort_order,feedback_type:de.feedback_type});for(const de of Y)pe.has(de.doc_id)||pe.set(de.doc_id,[]),pe.get(de.doc_id).push({id:de.id,text:de.text,created_at:de.created_at,is_done:de.is_done,completed_at:de.completed_at,sort_order:de.sort_order,feedback_type:de.feedback_type});try{for(const[de,be]of pe)await he.mutateAsync({docId:de,items:be})}catch(de){e(de instanceof Error?de.message:"Failed to save order")}}return q.isLoading?d.jsx("p",{children:"Loading feedback..."}):d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Feedback"}),d.jsx("p",{style:{...Jc,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&d.jsx(wl,{message:t,onDismiss:()=>e(null)}),d.jsxs("div",{style:sl,children:[C.length===0&&!u&&d.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),C.map(J=>d.jsx($4,{item:J,isDragging:n===J.id,isDragOver:a===J.id,onDragStart:z=>U(z,J.id),onDragOver:z=>P(z,J.id),onDragLeave:B,onDragEnd:Q,onDrop:z=>le(z,J.id),onToggleDone:()=>R(J),onTypeClick:()=>I(J)},J.id)),n&&C.length>0&&d.jsx(zy,{isActive:a==="__end__",onDragOver:J=>P(J,"__end__"),onDragLeave:B,onDrop:J=>le(J,"__end__")})]}),u?d.jsxs(Gs,{actionName:"Add Feedback",onSubmit:D,children:[d.jsx(FE,{selectedType:_,onSelect:v}),d.jsx(Vy,{value:p,onChange:J=>g(J.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),d.jsxs(Ga,{children:[d.jsx(Le,{type:"submit",actionName:"Add Feedback",disabled:!p.trim(),children:"Add Feedback"}),d.jsx(Le,{type:"button",variant:"secondary",actionName:"Cancel Add Feedback",onClick:()=>{f(!1),g(""),v("bug")},children:"Cancel"})]})]}):d.jsx(Le,{variant:"primary-large",actionName:"Open Add Feedback Form",onClick:()=>f(!0),children:"+ Add Feedback"}),Y.length>0&&d.jsx(kP,{title:"Completed",count:Y.length,children:d.jsx("div",{style:{...sl,marginTop:"0.5rem"},children:Y.map(J=>d.jsx(K4,{item:J,onToggleDone:()=>R(J),onTypeClick:()=>I(J)},J.id))})}),d.jsxs(al,{isOpen:x!==null,onClose:()=>w(null),title:"Mark as Complete",children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),x&&d.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',x.text,'"']}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Le,{variant:"secondary",actionName:"Cancel Mark Complete",onClick:()=>w(null),children:"Cancel"}),d.jsx(Le,{variant:"primary",actionName:"Confirm Mark Complete",onClick:j,children:"Mark Complete"})]})]}),d.jsxs(al,{isOpen:A!==null,onClose:()=>I(null),title:"Change Feedback Type",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),d.jsx(FE,{selectedType:A?.feedback_type||"bug",onSelect:O}),d.jsx(Le,{variant:"secondary",actionName:"Cancel Change Feedback Type",onClick:()=>I(null),style:{width:"100%"},children:"Cancel"})]})]})}function FE({selectedType:t,onSelect:e}){return d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const i=Ag[n],a=t==="feature"?"new_feature":t,l=a===n||!a&&n==="bug";return d.jsxs("button",{type:"button",onClick:()=>{st("SELECT","Feedback Type",{value:i.label}),e(n)},style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${i.color}`,borderRadius:"0.5rem",background:l?i.bgColor:"transparent",color:l?i.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${i.bgColor}`:"none",position:"relative"},children:[i.label,l&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function n6(){const{currentUserId:t}=wn(),[e,n]=T.useState([]),[i,a]=T.useState(!1);function l(x,w){n(A=>A.map(I=>I.name===x?{...I,...w}:I))}async function u(){a(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await f("Read unauthorized budget",async()=>(await Qe("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0),await f("Read another user's document",async()=>(await Qe("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0),await f("Read unauthorized budget month",async()=>(await Qe("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0),await f("Toggle is_admin in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Qe("users",t,"security test: reading own user to get current is_admin value"),A=w?.permission_flags?.is_admin??!1;return await Bo("users",t,{"permission_flags.is_admin":!A},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${A} to ${!A} (SECURITY ISSUE!)`},!0),await f("Toggle is_test in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Qe("users",t,"security test: reading own user to get current is_test value"),A=w?.permission_flags?.is_test??!1;return await Bo("users",t,{"permission_flags.is_test":!A},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${A} to ${!A} (SECURITY ISSUE!)`},!0),await f("Read own user document",async()=>{if(!t)throw new Error("Not authenticated");const{exists:w}=await Qe("users",t,"security test: reading own user document (should succeed)");if(w)return"Successfully read own document";throw new Error("Document does not exist")},!1),a(!1)}async function f(x,w,A){l(x,{status:"running",message:"Running..."});try{const I=await w();A?l(x,{status:"failed",message:` ${I}`}):l(x,{status:"passed",message:` ${I}`})}catch(I){const N=I instanceof Error?I.message:"Unknown error";A?l(x,{status:"passed",message:` Blocked as expected: ${N}`}):l(x,{status:"failed",message:` ${N}`})}}async function p(x){switch(e.find(A=>A.name===x)||n(A=>[...A,{name:x,status:"pending",message:"",expectedToFail:!0}]),a(!0),x){case"Read unauthorized budget":await f(x,async()=>(await Qe("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0);break;case"Read another user's document":await f(x,async()=>(await Qe("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0);break;case"Read unauthorized budget month":await f(x,async()=>(await Qe("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0);break;case"Toggle is_admin in own permission_flags":await f(x,async()=>{if(!t)throw new Error("Not authenticated");const{data:A}=await Qe("users",t,"security test: reading own user to get current is_admin value"),I=A?.permission_flags?.is_admin??!1;return await Bo("users",t,{"permission_flags.is_admin":!I},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${I} to ${!I} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await f(x,async()=>{if(!t)throw new Error("Not authenticated");const{data:A}=await Qe("users",t,"security test: reading own user to get current is_test value"),I=A?.permission_flags?.is_test??!1;return await Bo("users",t,{"permission_flags.is_test":!I},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${I} to ${!I} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await f(x,async()=>{if(!t)throw new Error("Not authenticated");const{exists:A}=await Qe("users",t,"security test: reading own user document (should succeed)");if(A)return"Successfully read own document";throw new Error("Document does not exist")},!1);break}a(!1)}const g=e.filter(x=>x.status==="passed").length,_=e.filter(x=>x.status==="failed").length,v=e.length;return d.jsxs("div",{children:[d.jsx("p",{style:Jc,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsx(Le,{onClick:u,disabled:i,variant:"primary",children:i?"Running Tests...":"Run All Tests"})}),e.length>0&&d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[d.jsxs("span",{children:["Total: ",d.jsx("strong",{children:v})]}),d.jsxs("span",{style:{color:ue.success},children:["Passed: ",d.jsx("strong",{children:g})]}),d.jsxs("span",{style:{color:ue.danger},children:["Failed: ",d.jsx("strong",{children:_})]})]})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),d.jsx(Po,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(x=>x.name==="Read unauthorized budget"),onRun:()=>p("Read unauthorized budget"),disabled:i}),d.jsx(Po,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(x=>x.name==="Read another user's document"),onRun:()=>p("Read another user's document"),disabled:i}),d.jsx(Po,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(x=>x.name==="Read unauthorized budget month"),onRun:()=>p("Read unauthorized budget month"),disabled:i}),d.jsx(Po,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(x=>x.name==="Toggle is_admin in own permission_flags"),onRun:()=>p("Toggle is_admin in own permission_flags"),disabled:i}),d.jsx(Po,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(x=>x.name==="Toggle is_test in own permission_flags"),onRun:()=>p("Toggle is_test in own permission_flags"),disabled:i}),d.jsx(Po,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(x=>x.name==="Read own user document"),onRun:()=>p("Read own user document"),disabled:i,expectedToSucceed:!0})]}),_>0&&d.jsxs(wl,{style:{marginTop:"1.5rem"},children:[" ",_," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function Po({name:t,description:e,expectedBehavior:n,result:i,onRun:a,disabled:l,expectedToSucceed:u}){const f=i?.status==="passed"?ue.success:i?.status==="failed"?ue.danger:i?.status==="running"?ue.warning:"inherit";return d.jsxs("div",{style:{...yu,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),d.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),d.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:u?ue.success:ue.warning},children:["Expected: ",n]})]}),d.jsx(Le,{onClick:a,disabled:l,variant:"secondary",style:{flexShrink:0},children:i?.status==="running"?"":"Run"})]}),i&&i.status!=="pending"&&d.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${f} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${f} 30%, transparent)`,fontSize:"0.85rem",color:f},children:i.message})]})}function r6(){const{selectedBudgetId:t,currentUserId:e,accessibleBudgets:n,loadAccessibleBudgets:i,switchToBudget:a,checkBudgetInvite:l,isInitialized:u}=wn();T.useEffect(()=>{u&&i()},[u,i]);const{budget:f,renameBudget:p,acceptInvite:g,isLoading:_}=Gn(t,e),[v,x]=T.useState(null),[w,A]=T.useState(null),[I,N]=T.useState(null),[H,$]=T.useState(null),[q,me]=T.useState(null),[re,he]=T.useState(""),[L,D]=T.useState(!1),[R,M]=T.useState(""),[j,O]=T.useState(!1),[C,Y]=T.useState(null);async function U(te){if(te!==f?.id){st("CLICK","Switch Budget",{details:te}),x(te),N(null),$(null);try{await a(te),$("Switched to budget successfully!"),await i()}catch(se){N(se instanceof Error?se.message:"Failed to switch budget")}finally{x(null)}}}async function P(te){st("CLICK","Accept Budget Invite",{details:te}),A(te),N(null),$(null);try{await g(te),$("Invitation accepted! You now have access to this budget."),await i()}catch(se){N(se instanceof Error?se.message:"Failed to accept invitation")}finally{A(null)}}async function B(te){if(te.preventDefault(),!!R.trim()){st("SUBMIT","Check Manual Invite",{value:R}),O(!0),N(null),Y(null);try{const se=await l(R.trim());se?Y(se):N("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(se){N(se instanceof Error?se.message:"Failed to check invitation")}finally{O(!1)}}}async function Q(){if(C){st("CLICK","Accept Manual Invite",{details:C.budgetName}),A(C.budgetId),N(null);try{await g(C.budgetId),$(`Successfully joined "${C.budgetName}"!`),Y(null),M(""),await i()}catch(te){N(te instanceof Error?te.message:"Failed to accept invitation")}finally{A(null)}}}function le(te,se){st("CLICK","Start Edit Budget Name",{details:se}),he(se),me(te)}function J(){me(null),he("")}async function z(te){if(te.preventDefault(),!(!re.trim()||!q)){st("SUBMIT","Rename Budget",{value:re.trim()}),D(!0),N(null),$(null);try{await p(re.trim()),$("Budget renamed successfully!"),me(null),await i()}catch(se){N(se instanceof Error?se.message:"Failed to rename budget")}finally{D(!1)}}}const F=n.filter(te=>!te.isPending),W=n.filter(te=>te.isPending);return _||!u?d.jsx(Ko,{children:d.jsx("p",{children:"Loading your budgets..."})}):d.jsxs(Ko,{children:[d.jsx(mi,{title:"My Budgets"}),d.jsx("h1",{children:"My Budgets"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Switch between budgets, accept invitations, or join a budget by ID."}),I&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:I}),d.jsx("button",{onClick:()=>N(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),H&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:H}),d.jsx("button",{onClick:()=>$(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),W.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Pending Invitations (",W.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:W.map(te=>d.jsx(BE,{budget:te,isCurrent:!1,isAccepting:w===te.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>P(te.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},te.id))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Your Budgets (",F.length,")"]}),F.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:F.map(te=>{const se=te.id===f?.id,pe=q===te.id;return d.jsx(BE,{budget:te,isCurrent:se,isAccepting:!1,isSwitching:v===te.id,isEditing:pe,editName:pe?re:"",isRenaming:L,onAccept:()=>{},onSwitch:()=>U(te.id),onStartEdit:()=>le(te.id,te.name),onCancelEdit:J,onEditNameChange:he,onSaveEdit:z},te.id)})})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Join Budget by ID"]}),d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),C?d.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[d.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:C.budgetName}),C.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",C.ownerEmail]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{onClick:Q,disabled:w===C.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:w===C.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:w===C.budgetId?.7:1},children:w===C.budgetId?"Accepting...":"Accept Invitation"}),d.jsx("button",{onClick:()=>{Y(null),M("")},disabled:w===C.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:w===C.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:w===C.budgetId?.7:.8},children:"Cancel"})]})]}):d.jsxs("form",{onSubmit:B,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:R,onChange:te=>M(te.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:j||!R.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:j||!R.trim()?"not-allowed":"pointer",fontWeight:500,opacity:j||!R.trim()?.7:1,whiteSpace:"nowrap"},children:j?"Checking...":"Check Invite"})]})]}),e&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[d.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),d.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:e})]})]})}function i6({children:t}){const e=T.useContext(ru),n=Mn();return e.is_auth_checked?e.is_logged_in?t?d.jsx(d.Fragment,{children:t}):d.jsx(Bh,{}):d.jsx(Uh,{to:"/account",state:{from:n.pathname},replace:!0}):d.jsx("div",{style:Hn,children:d.jsx("p",{children:"Loading..."})})}function s6(){const{selectedBudgetId:t,currentUserId:e,isInitialized:n}=wn(),{isLoading:i,error:a}=Gn(t,e);return n?a?(console.error("[BudgetLayout] Error:",a),d.jsx("div",{style:Hn,children:d.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",a.message]})})):d.jsx("div",{style:{paddingBottom:"5rem"},children:d.jsx(Bh,{})}):d.jsxs("div",{style:Hn,children:[d.jsx("p",{children:"Loading budget..."}),i&&d.jsx("p",{style:{opacity:.6},children:"Fetching data from server..."})]})}const a6={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function o6(){const[t,e]=T.useState(a6),n=qa(),i=T.useRef(!1);return T.useEffect(function(){i.current||(i.current=!0,n.set_user_listener(a=>{e({is_logged_in:a!=null,is_auth_checked:!0,username:a?.email??"",set_user_context:e})}))},[n]),t.is_auth_checked?d.jsx(ru.Provider,{value:t,children:d.jsx(ND,{children:d.jsx(tP,{children:d.jsxs(wR,{children:[d.jsxs(ZC,{children:[d.jsx(Xt,{path:"/",element:d.jsx(EP,{})}),d.jsx(Xt,{path:"/account",element:d.jsx(zP,{})}),d.jsx(Xt,{path:"/sql-test",element:d.jsx(VP,{})}),d.jsx(Xt,{path:"/budget",element:d.jsx(i6,{}),children:d.jsxs(Xt,{element:d.jsx(s6,{}),children:[d.jsx(Xt,{index:!0,element:d.jsx(zE,{})}),d.jsx(Xt,{path:":year/:month/:tab",element:d.jsx(zE,{})}),d.jsx(Xt,{path:"analytics",element:d.jsx(I4,{})}),d.jsx(Xt,{path:"my-budgets",element:d.jsx(r6,{})}),d.jsxs(Xt,{path:"settings",element:d.jsx(F4,{}),children:[d.jsx(Xt,{index:!0,element:d.jsx(Uh,{to:"categories",replace:!0})}),d.jsx(Xt,{path:"accounts",element:d.jsx(L4,{})}),d.jsx(Xt,{path:"categories",element:d.jsx(U4,{})}),d.jsx(Xt,{path:"users",element:d.jsx(q4,{})})]}),d.jsxs(Xt,{path:"admin",element:d.jsx(G4,{}),children:[d.jsx(Xt,{path:"budget",element:d.jsx(Q4,{})}),d.jsx(Xt,{path:"feedback",element:d.jsx(t6,{})}),d.jsx(Xt,{path:"migration",element:d.jsx(e6,{})}),d.jsx(Xt,{path:"tests",element:d.jsx(n6,{})})]})]})})]}),d.jsx(OP,{})]})})})}):d.jsx("div",{style:Hn,children:d.jsx("p",{children:"Loading..."})})}ZA.createRoot(document.getElementById("root")).render(d.jsx(T.StrictMode,{children:d.jsx(o6,{})}));
