(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var dp={exports:{}},gc={};var Jv;function dA(){if(Jv)return gc;Jv=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:t,type:i,key:u,ref:a!==void 0?a:null,props:l}}return gc.Fragment=e,gc.jsx=n,gc.jsxs=n,gc}var Zv;function hA(){return Zv||(Zv=1,dp.exports=dA()),dp.exports}var m=hA(),hp={exports:{}},Pe={};var eb;function fA(){if(eb)return Pe;eb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),E=Symbol.iterator;function T(P){return P===null||typeof P!="object"?null:(P=E&&P[E]||P["@@iterator"],typeof P=="function"?P:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,N={};function U(P,X,he){this.props=P,this.context=X,this.refs=N,this.updater=he||w}U.prototype.isReactComponent={},U.prototype.setState=function(P,X){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,X,"setState")},U.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function G(){}G.prototype=U.prototype;function z(P,X,he){this.props=P,this.context=X,this.refs=N,this.updater=he||w}var $=z.prototype=new G;$.constructor=z,I($,U.prototype),$.isPureReactComponent=!0;var J=Array.isArray;function te(){}var j={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function R(P,X,he){var re=he.ref;return{$$typeof:t,type:P,key:X,ref:re!==void 0?re:null,props:he}}function D(P,X){return R(P.type,X,P.props)}function C(P){return typeof P=="object"&&P!==null&&P.$$typeof===t}function L(P){var X={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(he){return X[he]})}var k=/\/+/g;function ee(P,X){return typeof P=="object"&&P!==null&&P.key!=null?L(""+P.key):X.toString(36)}function H(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(te,te):(P.status="pending",P.then(function(X){P.status==="pending"&&(P.status="fulfilled",P.value=X)},function(X){P.status==="pending"&&(P.status="rejected",P.reason=X)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function B(P,X,he,re,ae){var ve=typeof P;(ve==="undefined"||ve==="boolean")&&(P=null);var Ae=!1;if(P===null)Ae=!0;else switch(ve){case"bigint":case"string":case"number":Ae=!0;break;case"object":switch(P.$$typeof){case t:case e:Ae=!0;break;case _:return Ae=P._init,B(Ae(P._payload),X,he,re,ae)}}if(Ae)return ae=ae(P),Ae=re===""?"."+ee(P,0):re,J(ae)?(he="",Ae!=null&&(he=Ae.replace(k,"$&/")+"/"),B(ae,X,he,"",function(fe){return fe})):ae!=null&&(C(ae)&&(ae=D(ae,he+(ae.key==null||P&&P.key===ae.key?"":(""+ae.key).replace(k,"$&/")+"/")+Ae)),X.push(ae)),1;Ae=0;var Ee=re===""?".":re+":";if(J(P))for(var Te=0;Te<P.length;Te++)re=P[Te],ve=Ee+ee(re,Te),Ae+=B(re,X,he,ve,ae);else if(Te=T(P),typeof Te=="function")for(P=Te.call(P),Te=0;!(re=P.next()).done;)re=re.value,ve=Ee+ee(re,Te++),Ae+=B(re,X,he,ve,ae);else if(ve==="object"){if(typeof P.then=="function")return B(H(P),X,he,re,ae);throw X=String(P),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.")}return Ae}function q(P,X,he){if(P==null)return P;var re=[],ae=0;return B(P,re,"","",function(ve){return X.call(he,ve,ae++)}),re}function F(P){if(P._status===-1){var X=P._result;X=X(),X.then(function(he){(P._status===0||P._status===-1)&&(P._status=1,P._result=he)},function(he){(P._status===0||P._status===-1)&&(P._status=2,P._result=he)}),P._status===-1&&(P._status=0,P._result=X)}if(P._status===1)return P._result.default;throw P._result}var Q=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var X=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(X))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},W={map:q,forEach:function(P,X,he){q(P,function(){X.apply(this,arguments)},he)},count:function(P){var X=0;return q(P,function(){X++}),X},toArray:function(P){return q(P,function(X){return X})||[]},only:function(P){if(!C(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return Pe.Activity=v,Pe.Children=W,Pe.Component=U,Pe.Fragment=n,Pe.Profiler=a,Pe.PureComponent=z,Pe.StrictMode=i,Pe.Suspense=f,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(P){return j.H.useMemoCache(P)}},Pe.cache=function(P){return function(){return P.apply(null,arguments)}},Pe.cacheSignal=function(){return null},Pe.cloneElement=function(P,X,he){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var re=I({},P.props),ae=P.key;if(X!=null)for(ve in X.key!==void 0&&(ae=""+X.key),X)!A.call(X,ve)||ve==="key"||ve==="__self"||ve==="__source"||ve==="ref"&&X.ref===void 0||(re[ve]=X[ve]);var ve=arguments.length-2;if(ve===1)re.children=he;else if(1<ve){for(var Ae=Array(ve),Ee=0;Ee<ve;Ee++)Ae[Ee]=arguments[Ee+2];re.children=Ae}return R(P.type,ae,re)},Pe.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:l,_context:P},P},Pe.createElement=function(P,X,he){var re,ae={},ve=null;if(X!=null)for(re in X.key!==void 0&&(ve=""+X.key),X)A.call(X,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(ae[re]=X[re]);var Ae=arguments.length-2;if(Ae===1)ae.children=he;else if(1<Ae){for(var Ee=Array(Ae),Te=0;Te<Ae;Te++)Ee[Te]=arguments[Te+2];ae.children=Ee}if(P&&P.defaultProps)for(re in Ae=P.defaultProps,Ae)ae[re]===void 0&&(ae[re]=Ae[re]);return R(P,ve,ae)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(P){return{$$typeof:d,render:P}},Pe.isValidElement=C,Pe.lazy=function(P){return{$$typeof:_,_payload:{_status:-1,_result:P},_init:F}},Pe.memo=function(P,X){return{$$typeof:g,type:P,compare:X===void 0?null:X}},Pe.startTransition=function(P){var X=j.T,he={};j.T=he;try{var re=P(),ae=j.S;ae!==null&&ae(he,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(te,Q)}catch(ve){Q(ve)}finally{X!==null&&he.types!==null&&(X.types=he.types),j.T=X}},Pe.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},Pe.use=function(P){return j.H.use(P)},Pe.useActionState=function(P,X,he){return j.H.useActionState(P,X,he)},Pe.useCallback=function(P,X){return j.H.useCallback(P,X)},Pe.useContext=function(P){return j.H.useContext(P)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(P,X){return j.H.useDeferredValue(P,X)},Pe.useEffect=function(P,X){return j.H.useEffect(P,X)},Pe.useEffectEvent=function(P){return j.H.useEffectEvent(P)},Pe.useId=function(){return j.H.useId()},Pe.useImperativeHandle=function(P,X,he){return j.H.useImperativeHandle(P,X,he)},Pe.useInsertionEffect=function(P,X){return j.H.useInsertionEffect(P,X)},Pe.useLayoutEffect=function(P,X){return j.H.useLayoutEffect(P,X)},Pe.useMemo=function(P,X){return j.H.useMemo(P,X)},Pe.useOptimistic=function(P,X){return j.H.useOptimistic(P,X)},Pe.useReducer=function(P,X,he){return j.H.useReducer(P,X,he)},Pe.useRef=function(P){return j.H.useRef(P)},Pe.useState=function(P){return j.H.useState(P)},Pe.useSyncExternalStore=function(P,X,he){return j.H.useSyncExternalStore(P,X,he)},Pe.useTransition=function(){return j.H.useTransition()},Pe.version="19.2.3",Pe}var tb;function Eg(){return tb||(tb=1,hp.exports=fA()),hp.exports}var O=Eg(),fp={exports:{}},yc={},mp={exports:{}},pp={};var nb;function mA(){return nb||(nb=1,(function(t){function e(B,q){var F=B.length;B.push(q);e:for(;0<F;){var Q=F-1>>>1,W=B[Q];if(0<a(W,q))B[Q]=q,B[F]=W,F=Q;else break e}}function n(B){return B.length===0?null:B[0]}function i(B){if(B.length===0)return null;var q=B[0],F=B.pop();if(F!==q){B[0]=F;e:for(var Q=0,W=B.length,P=W>>>1;Q<P;){var X=2*(Q+1)-1,he=B[X],re=X+1,ae=B[re];if(0>a(he,F))re<W&&0>a(ae,he)?(B[Q]=ae,B[re]=F,Q=re):(B[Q]=he,B[X]=F,Q=X);else if(re<W&&0>a(ae,F))B[Q]=ae,B[re]=F,Q=re;else break e}}return q}function a(B,q){var F=B.sortIndex-q.sortIndex;return F!==0?F:B.id-q.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var u=Date,d=u.now();t.unstable_now=function(){return u.now()-d}}var f=[],g=[],_=1,v=null,E=3,T=!1,w=!1,I=!1,N=!1,U=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;function $(B){for(var q=n(g);q!==null;){if(q.callback===null)i(g);else if(q.startTime<=B)i(g),q.sortIndex=q.expirationTime,e(f,q);else break;q=n(g)}}function J(B){if(I=!1,$(B),!w)if(n(f)!==null)w=!0,te||(te=!0,L());else{var q=n(g);q!==null&&H(J,q.startTime-B)}}var te=!1,j=-1,A=5,R=-1;function D(){return N?!0:!(t.unstable_now()-R<A)}function C(){if(N=!1,te){var B=t.unstable_now();R=B;var q=!0;try{e:{w=!1,I&&(I=!1,G(j),j=-1),T=!0;var F=E;try{t:{for($(B),v=n(f);v!==null&&!(v.expirationTime>B&&D());){var Q=v.callback;if(typeof Q=="function"){v.callback=null,E=v.priorityLevel;var W=Q(v.expirationTime<=B);if(B=t.unstable_now(),typeof W=="function"){v.callback=W,$(B),q=!0;break t}v===n(f)&&i(f),$(B)}else i(f);v=n(f)}if(v!==null)q=!0;else{var P=n(g);P!==null&&H(J,P.startTime-B),q=!1}}break e}finally{v=null,E=F,T=!1}q=void 0}}finally{q?L():te=!1}}}var L;if(typeof z=="function")L=function(){z(C)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,ee=k.port2;k.port1.onmessage=C,L=function(){ee.postMessage(null)}}else L=function(){U(C,0)};function H(B,q){j=U(function(){B(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return E},t.unstable_next=function(B){switch(E){case 1:case 2:case 3:var q=3;break;default:q=E}var F=E;E=q;try{return B()}finally{E=F}},t.unstable_requestPaint=function(){N=!0},t.unstable_runWithPriority=function(B,q){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var F=E;E=B;try{return q()}finally{E=F}},t.unstable_scheduleCallback=function(B,q,F){var Q=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?Q+F:Q):F=Q,B){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=F+W,B={id:_++,callback:q,priorityLevel:B,startTime:F,expirationTime:W,sortIndex:-1},F>Q?(B.sortIndex=F,e(g,B),n(f)===null&&B===n(g)&&(I?(G(j),j=-1):I=!0,H(J,F-Q))):(B.sortIndex=W,e(f,B),w||T||(w=!0,te||(te=!0,L()))),B},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(B){var q=E;return function(){var F=E;E=q;try{return B.apply(this,arguments)}finally{E=F}}}})(pp)),pp}var rb;function pA(){return rb||(rb=1,mp.exports=mA()),mp.exports}var gp={exports:{}},pn={};var ib;function gA(){if(ib)return pn;ib=1;var t=Eg();function e(f){var g="https://react.dev/errors/"+f;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(f,g,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:f,containerInfo:g,implementation:_}}var u=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,g){if(f==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return pn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,pn.createPortal=function(f,g){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return l(f,g,null,_)},pn.flushSync=function(f){var g=u.T,_=i.p;try{if(u.T=null,i.p=2,f)return f()}finally{u.T=g,i.p=_,i.d.f()}},pn.preconnect=function(f,g){typeof f=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(f,g))},pn.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},pn.preinit=function(f,g){if(typeof f=="string"&&g&&typeof g.as=="string"){var _=g.as,v=d(_,g.crossOrigin),E=typeof g.integrity=="string"?g.integrity:void 0,T=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;_==="style"?i.d.S(f,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:v,integrity:E,fetchPriority:T}):_==="script"&&i.d.X(f,{crossOrigin:v,integrity:E,fetchPriority:T,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},pn.preinitModule=function(f,g){if(typeof f=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var _=d(g.as,g.crossOrigin);i.d.M(f,{crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(f)},pn.preload=function(f,g){if(typeof f=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var _=g.as,v=d(_,g.crossOrigin);i.d.L(f,_,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},pn.preloadModule=function(f,g){if(typeof f=="string")if(g){var _=d(g.as,g.crossOrigin);i.d.m(f,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(f)},pn.requestFormReset=function(f){i.d.r(f)},pn.unstable_batchedUpdates=function(f,g){return f(g)},pn.useFormState=function(f,g,_){return u.H.useFormState(f,g,_)},pn.useFormStatus=function(){return u.H.useHostTransitionStatus()},pn.version="19.2.3",pn}var sb;function yA(){if(sb)return gp.exports;sb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),gp.exports=gA(),gp.exports}var ab;function _A(){if(ab)return yc;ab=1;var t=pA(),e=Eg(),n=yA();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var s=r,o=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(o=s.return),r=s.return;while(r)}return s.tag===3?o:null}function u(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function d(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function f(r){if(l(r)!==r)throw Error(i(188))}function g(r){var s=r.alternate;if(!s){if(s=l(r),s===null)throw Error(i(188));return s!==r?null:r}for(var o=r,c=s;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(c=p.return,c!==null){o=c;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return f(p),r;if(y===c)return f(p),s;y=y.sibling}throw Error(i(188))}if(o.return!==c.return)o=p,c=y;else{for(var S=!1,M=p.child;M;){if(M===o){S=!0,o=p,c=y;break}if(M===c){S=!0,c=p,o=y;break}M=M.sibling}if(!S){for(M=y.child;M;){if(M===o){S=!0,o=y,c=p;break}if(M===c){S=!0,c=y,o=p;break}M=M.sibling}if(!S)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?r:s}function _(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=_(r),s!==null)return s;r=r.sibling}return null}var v=Object.assign,E=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),U=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),z=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),C=Symbol.iterator;function L(r){return r===null||typeof r!="object"?null:(r=C&&r[C]||r["@@iterator"],typeof r=="function"?r:null)}var k=Symbol.for("react.client.reference");function ee(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===k?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case I:return"Fragment";case U:return"Profiler";case N:return"StrictMode";case J:return"Suspense";case te:return"SuspenseList";case R:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case z:return r.displayName||"Context";case G:return(r._context.displayName||"Context")+".Consumer";case $:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case j:return s=r.displayName||null,s!==null?s:ee(r.type)||"Memo";case A:s=r._payload,r=r._init;try{return ee(r(s))}catch{}}return null}var H=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},Q=[],W=-1;function P(r){return{current:r}}function X(r){0>W||(r.current=Q[W],Q[W]=null,W--)}function he(r,s){W++,Q[W]=r.current,r.current=s}var re=P(null),ae=P(null),ve=P(null),Ae=P(null);function Ee(r,s){switch(he(ve,s),he(ae,r),he(re,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?Ev(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=Ev(s),r=Sv(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}X(re),he(re,r)}function Te(){X(re),X(ae),X(ve)}function fe(r){r.memoizedState!==null&&he(Ae,r);var s=re.current,o=Sv(s,r.type);s!==o&&(he(ae,r),he(re,o))}function ft(r){ae.current===r&&(X(re),X(ae)),Ae.current===r&&(X(Ae),hc._currentValue=F)}var Be,bn;function Ze(r){if(Be===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Be=s&&s[1]||"",bn=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Be+r+bn}var kn=!1;function $n(r,s){if(!r||kn)return"";kn=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var pe=function(){throw Error()};if(Object.defineProperty(pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pe,[])}catch(ue){var oe=ue}Reflect.construct(r,[],pe)}else{try{pe.call()}catch(ue){oe=ue}r.call(pe.prototype)}}else{try{throw Error()}catch(ue){oe=ue}(pe=r())&&typeof pe.catch=="function"&&pe.catch(function(){})}}catch(ue){if(ue&&oe&&typeof ue.stack=="string")return[ue.stack,oe.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=c.DetermineComponentFrameRoot(),S=y[0],M=y[1];if(S&&M){var K=S.split(`
`),se=M.split(`
`);for(p=c=0;c<K.length&&!K[c].includes("DetermineComponentFrameRoot");)c++;for(;p<se.length&&!se[p].includes("DetermineComponentFrameRoot");)p++;if(c===K.length||p===se.length)for(c=K.length-1,p=se.length-1;1<=c&&0<=p&&K[c]!==se[p];)p--;for(;1<=c&&0<=p;c--,p--)if(K[c]!==se[p]){if(c!==1||p!==1)do if(c--,p--,0>p||K[c]!==se[p]){var de=`
`+K[c].replace(" at new "," at ");return r.displayName&&de.includes("<anonymous>")&&(de=de.replace("<anonymous>",r.displayName)),de}while(1<=c&&0<=p);break}}}finally{kn=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?Ze(o):""}function li(r,s){switch(r.tag){case 26:case 27:case 5:return Ze(r.type);case 16:return Ze("Lazy");case 13:return r.child!==s&&s!==null?Ze("Suspense Fallback"):Ze("Suspense");case 19:return Ze("SuspenseList");case 0:case 15:return $n(r.type,!1);case 11:return $n(r.type.render,!1);case 1:return $n(r.type,!0);case 31:return Ze("Activity");default:return""}}function Dr(r){try{var s="",o=null;do s+=li(r,o),o=r,r=r.return;while(r);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var bt=Object.prototype.hasOwnProperty,wt=t.unstable_scheduleCallback,qi=t.unstable_cancelCallback,ff=t.unstable_shouldYield,du=t.unstable_requestPaint,En=t.unstable_now,$s=t.unstable_getCurrentPriorityLevel,pl=t.unstable_ImmediatePriority,gl=t.unstable_UserBlockingPriority,Gi=t.unstable_NormalPriority,mf=t.unstable_LowPriority,hu=t.unstable_IdlePriority,fu=t.log,mu=t.unstable_setDisableYieldValue,fr=null,rn=null;function Yn(r){if(typeof fu=="function"&&mu(r),rn&&typeof rn.setStrictMode=="function")try{rn.setStrictMode(fr,r)}catch{}}var Dt=Math.clz32?Math.clz32:gu,pu=Math.log,Ba=Math.LN2;function gu(r){return r>>>=0,r===0?32:31-(pu(r)/Ba|0)|0}var Ir=256,Ys=262144,Nt=4194304;function Or(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function jr(r,s,o){var c=r.pendingLanes;if(c===0)return 0;var p=0,y=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var M=c&134217727;return M!==0?(c=M&~y,c!==0?p=Or(c):(S&=M,S!==0?p=Or(S):o||(o=M&~r,o!==0&&(p=Or(o))))):(M=c&~y,M!==0?p=Or(M):S!==0?p=Or(S):o||(o=c&~r,o!==0&&(p=Or(o)))),p===0?0:s!==0&&s!==p&&(s&y)===0&&(y=p&-p,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:p}function mr(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function pf(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yu(){var r=Nt;return Nt<<=1,(Nt&62914560)===0&&(Nt=4194304),r}function Mr(r){for(var s=[],o=0;31>o;o++)s.push(r);return s}function Ws(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function gf(r,s,o,c,p,y){var S=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var M=r.entanglements,K=r.expirationTimes,se=r.hiddenUpdates;for(o=S&~o;0<o;){var de=31-Dt(o),pe=1<<de;M[de]=0,K[de]=-1;var oe=se[de];if(oe!==null)for(se[de]=null,de=0;de<oe.length;de++){var ue=oe[de];ue!==null&&(ue.lane&=-536870913)}o&=~pe}c!==0&&Xs(r,c,0),y!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=y&~(S&~s))}function Xs(r,s,o){r.pendingLanes|=s,r.suspendedLanes&=~s;var c=31-Dt(s);r.entangledLanes|=s,r.entanglements[c]=r.entanglements[c]|1073741824|o&261930}function yl(r,s){var o=r.entangledLanes|=s;for(r=r.entanglements;o;){var c=31-Dt(o),p=1<<c;p&s|r[c]&s&&(r[c]|=s),o&=~p}}function _l(r,s){var o=s&-s;return o=(o&42)!==0?1:Js(o),(o&(r.suspendedLanes|s))!==0?0:o}function Js(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ci(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function _u(){var r=q.p;return r!==0?r:(r=window.event,r===void 0?32:Hv(r.type))}function pr(r,s){var o=q.p;try{return q.p=r,s()}finally{q.p=o}}var gr=Math.random().toString(36).slice(2),Pt="__reactFiber$"+gr,Xt="__reactProps$"+gr,kr="__reactContainer$"+gr,za="__reactEvents$"+gr,yf="__reactListeners$"+gr,vu="__reactHandles$"+gr,bu="__reactResources$"+gr,Nr="__reactMarker$"+gr;function Fa(r){delete r[Pt],delete r[Xt],delete r[za],delete r[yf],delete r[vu]}function Pr(r){var s=r[Pt];if(s)return s;for(var o=r.parentNode;o;){if(s=o[kr]||o[Pt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(r=Dv(r);r!==null;){if(o=r[Pt])return o;r=Dv(r)}return s}r=o,o=r.parentNode}return null}function Wn(r){if(r=r[Pt]||r[kr]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function Nn(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function Vr(r){var s=r[bu];return s||(s=r[bu]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Vt(r){r[Nr]=!0}var vl=new Set,bl={};function Lr(r,s){Ur(r,s),Ur(r+"Capture",s)}function Ur(r,s){for(bl[r]=s,r=0;r<s.length;r++)vl.add(s[r])}var El=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Sl={},xl={};function Eu(r){return bt.call(xl,r)?!0:bt.call(Sl,r)?!1:El.test(r)?xl[r]=!0:(Sl[r]=!0,!1)}function qa(r,s,o){if(Eu(s))if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+o)}}function Pn(r,s,o){if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+o)}}function Lt(r,s,o,c){if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(s,o,""+c)}}function Jt(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Hi(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function wl(r,s,o){var c=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,y=c.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return p.call(this)},set:function(S){o=""+S,y.call(this,S)}}),Object.defineProperty(r,s,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(S){o=""+S},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function at(r){if(!r._valueTracker){var s=Hi(r)?"checked":"value";r._valueTracker=wl(r,s,""+r[s])}}function Zs(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var o=s.getValue(),c="";return r&&(c=Hi(r)?r.checked?"true":"false":r.value),r=c,r!==o?(s.setValue(r),!0):!1}function Br(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var ea=/[\n"\\]/g;function Tn(r){return r.replace(ea,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ga(r,s,o,c,p,y,S,M){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),s!=null?S==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+Jt(s)):r.value!==""+Jt(s)&&(r.value=""+Jt(s)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),s!=null?Tl(r,S,Jt(s)):o!=null?Tl(r,S,Jt(o)):c!=null&&r.removeAttribute("value"),p==null&&y!=null&&(r.defaultChecked=!!y),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?r.name=""+Jt(M):r.removeAttribute("name")}function Su(r,s,o,c,p,y,S,M){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){at(r);return}o=o!=null?""+Jt(o):"",s=s!=null?""+Jt(s):o,M||s===r.value||(r.value=s),r.defaultValue=s}c=c??p,c=typeof c!="function"&&typeof c!="symbol"&&!!c,r.checked=M?r.checked:!!c,r.defaultChecked=!!c,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S),at(r)}function Tl(r,s,o){s==="number"&&Br(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function Qi(r,s,o,c){if(r=r.options,s){s={};for(var p=0;p<o.length;p++)s["$"+o[p]]=!0;for(o=0;o<r.length;o++)p=s.hasOwnProperty("$"+r[o].value),r[o].selected!==p&&(r[o].selected=p),p&&c&&(r[o].defaultSelected=!0)}else{for(o=""+Jt(o),s=null,p=0;p<r.length;p++){if(r[p].value===o){r[p].selected=!0,c&&(r[p].defaultSelected=!0);return}s!==null||r[p].disabled||(s=r[p])}s!==null&&(s.selected=!0)}}function xu(r,s,o){if(s!=null&&(s=""+Jt(s),s!==r.value&&(r.value=s),o==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=o!=null?""+Jt(o):""}function Ki(r,s,o,c){if(s==null){if(c!=null){if(o!=null)throw Error(i(92));if(H(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),s=o}o=Jt(s),r.defaultValue=o,c=r.textContent,c===o&&c!==""&&c!==null&&(r.value=c),at(r)}function An(r,s){if(s){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=s;return}}r.textContent=s}var wu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Al(r,s,o){var c=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":c?r.setProperty(s,o):typeof o!="number"||o===0||wu.has(s)?s==="float"?r.cssFloat=o:r[s]=(""+o).trim():r[s]=o+"px"}function Cl(r,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?r.setProperty(c,""):c==="float"?r.cssFloat="":r[c]="");for(var p in s)c=s[p],s.hasOwnProperty(p)&&o[p]!==c&&Al(r,p,c)}else for(var y in s)s.hasOwnProperty(y)&&Al(r,y,s[y])}function Ha(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$i=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qa(r){return $i.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function yr(){}var Rl=null;function Xn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Yi=null,zr=null;function ta(r){var s=Wn(r);if(s&&(r=s.stateNode)){var o=r[Xt]||null;e:switch(r=s.stateNode,s.type){case"input":if(Ga(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Tn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var c=o[s];if(c!==r&&c.form===r.form){var p=c[Xt]||null;if(!p)throw Error(i(90));Ga(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<o.length;s++)c=o[s],c.form===r.form&&Zs(c)}break e;case"textarea":xu(r,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&Qi(r,!!o.multiple,s,!1)}}}var Ka=!1;function Wi(r,s,o){if(Ka)return r(s,o);Ka=!0;try{var c=r(s);return c}finally{if(Ka=!1,(Yi!==null||zr!==null)&&(_d(),Yi&&(s=Yi,r=zr,zr=Yi=null,ta(s),r)))for(s=0;s<r.length;s++)ta(r[s])}}function _r(r,s){var o=r.stateNode;if(o===null)return null;var c=o[Xt]||null;if(c===null)return null;o=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(r=r.type,c=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!c;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var Jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),na=!1;if(Jn)try{var ct={};Object.defineProperty(ct,"passive",{get:function(){na=!0}}),window.addEventListener("test",ct,ct),window.removeEventListener("test",ct,ct)}catch{na=!1}var Fr=null,Dl=null,ra=null;function Il(){if(ra)return ra;var r,s=Dl,o=s.length,c,p="value"in Fr?Fr.value:Fr.textContent,y=p.length;for(r=0;r<o&&s[r]===p[r];r++);var S=o-r;for(c=1;c<=S&&s[o-c]===p[y-c];c++);return ra=p.slice(r,1<c?1-c:void 0)}function ia(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function ui(){return!0}function vr(){return!1}function sn(r){function s(o,c,p,y,S){this._reactName=o,this._targetInst=p,this.type=c,this.nativeEvent=y,this.target=S,this.currentTarget=null;for(var M in r)r.hasOwnProperty(M)&&(o=r[M],this[M]=o?o(y):y[M]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?ui:vr,this.isPropagationStopped=vr,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ui)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ui)},persist:function(){},isPersistent:ui}),s}var di={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qr=sn(di),Xi=v({},di,{view:0,detail:0}),Ol=sn(Xi),Ji,$a,Gr,Ya=v({},Xi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zi,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Gr&&(Gr&&r.type==="mousemove"?(Ji=r.screenX-Gr.screenX,$a=r.screenY-Gr.screenY):$a=Ji=0,Gr=r),Ji)},movementY:function(r){return"movementY"in r?r.movementY:$a}}),jl=sn(Ya),sa=v({},Ya,{dataTransfer:0}),Au=sn(sa),Cu=v({},Xi,{relatedTarget:0}),aa=sn(Cu),Ml=v({},di,{animationName:0,elapsedTime:0,pseudoElement:0}),Ru=sn(Ml),Wa=v({},di,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Du=sn(Wa),Iu=v({},di,{data:0}),Hr=sn(Iu),Ou={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ju={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ku(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=Mu[r])?!!s[r]:!1}function Zi(){return ku}var Sn=v({},Xi,{key:function(r){if(r.key){var s=Ou[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=ia(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?ju[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zi,charCode:function(r){return r.type==="keypress"?ia(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ia(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Nu=sn(Sn),Pu=v({},Ya,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hi=sn(Pu),h=v({},Xi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zi}),b=sn(h),x=v({},di,{propertyName:0,elapsedTime:0,pseudoElement:0}),V=sn(x),ne=v({},Ya,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),ce=sn(ne),be=v({},di,{newState:0,oldState:0}),Le=sn(be),It=[9,13,27,32],rt=Jn&&"CompositionEvent"in window,Et=null;Jn&&"documentMode"in document&&(Et=document.documentMode);var Zn=Jn&&"TextEvent"in window&&!Et,Qr=Jn&&(!rt||Et&&8<Et&&11>=Et),br=" ",Er=!1;function oa(r,s){switch(r){case"keyup":return It.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xa(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ja=!1;function NT(r,s){switch(r){case"compositionend":return Xa(s);case"keypress":return s.which!==32?null:(Er=!0,br);case"textInput":return r=s.data,r===br&&Er?null:r;default:return null}}function PT(r,s){if(Ja)return r==="compositionend"||!rt&&oa(r,s)?(r=Il(),ra=Dl=Fr=null,Ja=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Qr&&s.locale!=="ko"?null:s.data;default:return null}}var VT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jy(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!VT[r.type]:s==="textarea"}function My(r,s,o,c){Yi?zr?zr.push(c):zr=[c]:Yi=c,s=Td(s,"onChange"),0<s.length&&(o=new qr("onChange","change",null,o,c),r.push({event:o,listeners:s}))}var kl=null,Nl=null;function LT(r){pv(r,0)}function Vu(r){var s=Nn(r);if(Zs(s))return r}function ky(r,s){if(r==="change")return s}var Ny=!1;if(Jn){var _f;if(Jn){var vf="oninput"in document;if(!vf){var Py=document.createElement("div");Py.setAttribute("oninput","return;"),vf=typeof Py.oninput=="function"}_f=vf}else _f=!1;Ny=_f&&(!document.documentMode||9<document.documentMode)}function Vy(){kl&&(kl.detachEvent("onpropertychange",Ly),Nl=kl=null)}function Ly(r){if(r.propertyName==="value"&&Vu(Nl)){var s=[];My(s,Nl,r,Xn(r)),Wi(LT,s)}}function UT(r,s,o){r==="focusin"?(Vy(),kl=s,Nl=o,kl.attachEvent("onpropertychange",Ly)):r==="focusout"&&Vy()}function BT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Vu(Nl)}function zT(r,s){if(r==="click")return Vu(s)}function FT(r,s){if(r==="input"||r==="change")return Vu(s)}function qT(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Vn=typeof Object.is=="function"?Object.is:qT;function Pl(r,s){if(Vn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var o=Object.keys(r),c=Object.keys(s);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var p=o[c];if(!bt.call(s,p)||!Vn(r[p],s[p]))return!1}return!0}function Uy(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function By(r,s){var o=Uy(r);r=0;for(var c;o;){if(o.nodeType===3){if(c=r+o.textContent.length,r<=s&&c>=s)return{node:o,offset:s-r};r=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Uy(o)}}function zy(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?zy(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function Fy(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=Br(r.document);s instanceof r.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)r=s.contentWindow;else break;s=Br(r.document)}return s}function bf(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var GT=Jn&&"documentMode"in document&&11>=document.documentMode,Za=null,Ef=null,Vl=null,Sf=!1;function qy(r,s,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Sf||Za==null||Za!==Br(c)||(c=Za,"selectionStart"in c&&bf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Vl&&Pl(Vl,c)||(Vl=c,c=Td(Ef,"onSelect"),0<c.length&&(s=new qr("onSelect","select",null,s,o),r.push({event:s,listeners:c}),s.target=Za)))}function la(r,s){var o={};return o[r.toLowerCase()]=s.toLowerCase(),o["Webkit"+r]="webkit"+s,o["Moz"+r]="moz"+s,o}var eo={animationend:la("Animation","AnimationEnd"),animationiteration:la("Animation","AnimationIteration"),animationstart:la("Animation","AnimationStart"),transitionrun:la("Transition","TransitionRun"),transitionstart:la("Transition","TransitionStart"),transitioncancel:la("Transition","TransitionCancel"),transitionend:la("Transition","TransitionEnd")},xf={},Gy={};Jn&&(Gy=document.createElement("div").style,"AnimationEvent"in window||(delete eo.animationend.animation,delete eo.animationiteration.animation,delete eo.animationstart.animation),"TransitionEvent"in window||delete eo.transitionend.transition);function ca(r){if(xf[r])return xf[r];if(!eo[r])return r;var s=eo[r],o;for(o in s)if(s.hasOwnProperty(o)&&o in Gy)return xf[r]=s[o];return r}var Hy=ca("animationend"),Qy=ca("animationiteration"),Ky=ca("animationstart"),HT=ca("transitionrun"),QT=ca("transitionstart"),KT=ca("transitioncancel"),$y=ca("transitionend"),Yy=new Map,wf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wf.push("scrollEnd");function Sr(r,s){Yy.set(r,s),Lr(s,[r])}var Lu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},er=[],to=0,Tf=0;function Uu(){for(var r=to,s=Tf=to=0;s<r;){var o=er[s];er[s++]=null;var c=er[s];er[s++]=null;var p=er[s];er[s++]=null;var y=er[s];if(er[s++]=null,c!==null&&p!==null){var S=c.pending;S===null?p.next=p:(p.next=S.next,S.next=p),c.pending=p}y!==0&&Wy(o,p,y)}}function Bu(r,s,o,c){er[to++]=r,er[to++]=s,er[to++]=o,er[to++]=c,Tf|=c,r.lanes|=c,r=r.alternate,r!==null&&(r.lanes|=c)}function Af(r,s,o,c){return Bu(r,s,o,c),zu(r)}function ua(r,s){return Bu(r,null,null,s),zu(r)}function Wy(r,s,o){r.lanes|=o;var c=r.alternate;c!==null&&(c.lanes|=o);for(var p=!1,y=r.return;y!==null;)y.childLanes|=o,c=y.alternate,c!==null&&(c.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(p=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,p&&s!==null&&(p=31-Dt(o),r=y.hiddenUpdates,c=r[p],c===null?r[p]=[s]:c.push(s),s.lane=o|536870912),y):null}function zu(r){if(50<sc)throw sc=0,Nm=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var no={};function $T(r,s,o,c){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(r,s,o,c){return new $T(r,s,o,c)}function Cf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function fi(r,s){var o=r.alternate;return o===null?(o=Ln(r.tag,s,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=s,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,s=r.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function Xy(r,s){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,s=o.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function Fu(r,s,o,c,p,y){var S=0;if(c=r,typeof r=="function")Cf(r)&&(S=1);else if(typeof r=="string")S=Z1(r,o,re.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case R:return r=Ln(31,o,s,p),r.elementType=R,r.lanes=y,r;case I:return da(o.children,p,y,s);case N:S=8,p|=24;break;case U:return r=Ln(12,o,s,p|2),r.elementType=U,r.lanes=y,r;case J:return r=Ln(13,o,s,p),r.elementType=J,r.lanes=y,r;case te:return r=Ln(19,o,s,p),r.elementType=te,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case z:S=10;break e;case G:S=9;break e;case $:S=11;break e;case j:S=14;break e;case A:S=16,c=null;break e}S=29,o=Error(i(130,r===null?"null":typeof r,"")),c=null}return s=Ln(S,o,s,p),s.elementType=r,s.type=c,s.lanes=y,s}function da(r,s,o,c){return r=Ln(7,r,c,s),r.lanes=o,r}function Rf(r,s,o){return r=Ln(6,r,null,s),r.lanes=o,r}function Jy(r){var s=Ln(18,null,null,0);return s.stateNode=r,s}function Df(r,s,o){return s=Ln(4,r.children!==null?r.children:[],r.key,s),s.lanes=o,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var Zy=new WeakMap;function tr(r,s){if(typeof r=="object"&&r!==null){var o=Zy.get(r);return o!==void 0?o:(s={value:r,source:s,stack:Dr(s)},Zy.set(r,s),s)}return{value:r,source:s,stack:Dr(s)}}var ro=[],io=0,qu=null,Ll=0,nr=[],rr=0,es=null,Kr=1,$r="";function mi(r,s){ro[io++]=Ll,ro[io++]=qu,qu=r,Ll=s}function e_(r,s,o){nr[rr++]=Kr,nr[rr++]=$r,nr[rr++]=es,es=r;var c=Kr;r=$r;var p=32-Dt(c)-1;c&=~(1<<p),o+=1;var y=32-Dt(s)+p;if(30<y){var S=p-p%5;y=(c&(1<<S)-1).toString(32),c>>=S,p-=S,Kr=1<<32-Dt(s)+p|o<<p|c,$r=y+r}else Kr=1<<y|o<<p|c,$r=r}function If(r){r.return!==null&&(mi(r,1),e_(r,1,0))}function Of(r){for(;r===qu;)qu=ro[--io],ro[io]=null,Ll=ro[--io],ro[io]=null;for(;r===es;)es=nr[--rr],nr[rr]=null,$r=nr[--rr],nr[rr]=null,Kr=nr[--rr],nr[rr]=null}function t_(r,s){nr[rr++]=Kr,nr[rr++]=$r,nr[rr++]=es,Kr=s.id,$r=s.overflow,es=r}var an=null,yt=null,Xe=!1,ts=null,ir=!1,jf=Error(i(519));function ns(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ul(tr(s,r)),jf}function n_(r){var s=r.stateNode,o=r.type,c=r.memoizedProps;switch(s[Pt]=r,s[Xt]=c,o){case"dialog":Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":case"embed":Ge("load",s);break;case"video":case"audio":for(o=0;o<oc.length;o++)Ge(oc[o],s);break;case"source":Ge("error",s);break;case"img":case"image":case"link":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"input":Ge("invalid",s),Su(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ge("invalid",s);break;case"textarea":Ge("invalid",s),Ki(s,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||c.suppressHydrationWarning===!0||vv(s.textContent,o)?(c.popover!=null&&(Ge("beforetoggle",s),Ge("toggle",s)),c.onScroll!=null&&Ge("scroll",s),c.onScrollEnd!=null&&Ge("scrollend",s),c.onClick!=null&&(s.onclick=yr),s=!0):s=!1,s||ns(r,!0)}function r_(r){for(an=r.return;an;)switch(an.tag){case 5:case 31:case 13:ir=!1;return;case 27:case 3:ir=!0;return;default:an=an.return}}function so(r){if(r!==an)return!1;if(!Xe)return r_(r),Xe=!0,!1;var s=r.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||Wm(r.type,r.memoizedProps)),o=!o),o&&yt&&ns(r),r_(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));yt=Rv(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));yt=Rv(r)}else s===27?(s=yt,gs(r.type)?(r=tp,tp=null,yt=r):yt=s):yt=an?ar(r.stateNode.nextSibling):null;return!0}function ha(){yt=an=null,Xe=!1}function Mf(){var r=ts;return r!==null&&(In===null?In=r:In.push.apply(In,r),ts=null),r}function Ul(r){ts===null?ts=[r]:ts.push(r)}var kf=P(null),fa=null,pi=null;function rs(r,s,o){he(kf,s._currentValue),s._currentValue=o}function gi(r){r._currentValue=kf.current,X(kf)}function Nf(r,s,o){for(;r!==null;){var c=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),r===o)break;r=r.return}}function Pf(r,s,o,c){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var y=p.dependencies;if(y!==null){var S=p.child;y=y.firstContext;e:for(;y!==null;){var M=y;y=p;for(var K=0;K<s.length;K++)if(M.context===s[K]){y.lanes|=o,M=y.alternate,M!==null&&(M.lanes|=o),Nf(y.return,o,r),c||(S=null);break e}y=M.next}}else if(p.tag===18){if(S=p.return,S===null)throw Error(i(341));S.lanes|=o,y=S.alternate,y!==null&&(y.lanes|=o),Nf(S,o,r),S=null}else S=p.child;if(S!==null)S.return=p;else for(S=p;S!==null;){if(S===r){S=null;break}if(p=S.sibling,p!==null){p.return=S.return,S=p;break}S=S.return}p=S}}function ao(r,s,o,c){r=null;for(var p=s,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var S=p.alternate;if(S===null)throw Error(i(387));if(S=S.memoizedProps,S!==null){var M=p.type;Vn(p.pendingProps.value,S.value)||(r!==null?r.push(M):r=[M])}}else if(p===Ae.current){if(S=p.alternate,S===null)throw Error(i(387));S.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(hc):r=[hc])}p=p.return}r!==null&&Pf(s,r,o,c),s.flags|=262144}function Gu(r){for(r=r.firstContext;r!==null;){if(!Vn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ma(r){fa=r,pi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function on(r){return i_(fa,r)}function Hu(r,s){return fa===null&&ma(r),i_(r,s)}function i_(r,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},pi===null){if(r===null)throw Error(i(308));pi=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else pi=pi.next=s;return o}var YT=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(o,c){r.push(c)}};this.abort=function(){s.aborted=!0,r.forEach(function(o){return o()})}},WT=t.unstable_scheduleCallback,XT=t.unstable_NormalPriority,Ut={$$typeof:z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vf(){return{controller:new YT,data:new Map,refCount:0}}function Bl(r){r.refCount--,r.refCount===0&&WT(XT,function(){r.controller.abort()})}var zl=null,Lf=0,oo=0,lo=null;function JT(r,s){if(zl===null){var o=zl=[];Lf=0,oo=zm(),lo={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Lf++,s.then(s_,s_),s}function s_(){if(--Lf===0&&zl!==null){lo!==null&&(lo.status="fulfilled");var r=zl;zl=null,oo=0,lo=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function ZT(r,s){var o=[],c={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return r.then(function(){c.status="fulfilled",c.value=s;for(var p=0;p<o.length;p++)(0,o[p])(s)},function(p){for(c.status="rejected",c.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),c}var a_=B.S;B.S=function(r,s){q0=En(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&JT(r,s),a_!==null&&a_(r,s)};var pa=P(null);function Uf(){var r=pa.current;return r!==null?r:mt.pooledCache}function Qu(r,s){s===null?he(pa,pa.current):he(pa,s.pool)}function o_(){var r=Uf();return r===null?null:{parent:Ut._currentValue,pool:r}}var co=Error(i(460)),Bf=Error(i(474)),Ku=Error(i(542)),$u={then:function(){}};function l_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function c_(r,s,o){switch(o=r[o],o===void 0?r.push(s):o!==s&&(s.then(yr,yr),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,d_(r),r;default:if(typeof s.status=="string")s.then(yr,yr);else{if(r=mt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(c){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=c}},function(c){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,d_(r),r}throw ya=s,co}}function ga(r){try{var s=r._init;return s(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ya=o,co):o}}var ya=null;function u_(){if(ya===null)throw Error(i(459));var r=ya;return ya=null,r}function d_(r){if(r===co||r===Ku)throw Error(i(483))}var uo=null,Fl=0;function Yu(r){var s=Fl;return Fl+=1,uo===null&&(uo=[]),c_(uo,r,s)}function ql(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function Wu(r,s){throw s.$$typeof===E?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function h_(r){function s(Z,Y){if(r){var ie=Z.deletions;ie===null?(Z.deletions=[Y],Z.flags|=16):ie.push(Y)}}function o(Z,Y){if(!r)return null;for(;Y!==null;)s(Z,Y),Y=Y.sibling;return null}function c(Z){for(var Y=new Map;Z!==null;)Z.key!==null?Y.set(Z.key,Z):Y.set(Z.index,Z),Z=Z.sibling;return Y}function p(Z,Y){return Z=fi(Z,Y),Z.index=0,Z.sibling=null,Z}function y(Z,Y,ie){return Z.index=ie,r?(ie=Z.alternate,ie!==null?(ie=ie.index,ie<Y?(Z.flags|=67108866,Y):ie):(Z.flags|=67108866,Y)):(Z.flags|=1048576,Y)}function S(Z){return r&&Z.alternate===null&&(Z.flags|=67108866),Z}function M(Z,Y,ie,me){return Y===null||Y.tag!==6?(Y=Rf(ie,Z.mode,me),Y.return=Z,Y):(Y=p(Y,ie),Y.return=Z,Y)}function K(Z,Y,ie,me){var De=ie.type;return De===I?de(Z,Y,ie.props.children,me,ie.key):Y!==null&&(Y.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===A&&ga(De)===Y.type)?(Y=p(Y,ie.props),ql(Y,ie),Y.return=Z,Y):(Y=Fu(ie.type,ie.key,ie.props,null,Z.mode,me),ql(Y,ie),Y.return=Z,Y)}function se(Z,Y,ie,me){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==ie.containerInfo||Y.stateNode.implementation!==ie.implementation?(Y=Df(ie,Z.mode,me),Y.return=Z,Y):(Y=p(Y,ie.children||[]),Y.return=Z,Y)}function de(Z,Y,ie,me,De){return Y===null||Y.tag!==7?(Y=da(ie,Z.mode,me,De),Y.return=Z,Y):(Y=p(Y,ie),Y.return=Z,Y)}function pe(Z,Y,ie){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=Rf(""+Y,Z.mode,ie),Y.return=Z,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case T:return ie=Fu(Y.type,Y.key,Y.props,null,Z.mode,ie),ql(ie,Y),ie.return=Z,ie;case w:return Y=Df(Y,Z.mode,ie),Y.return=Z,Y;case A:return Y=ga(Y),pe(Z,Y,ie)}if(H(Y)||L(Y))return Y=da(Y,Z.mode,ie,null),Y.return=Z,Y;if(typeof Y.then=="function")return pe(Z,Yu(Y),ie);if(Y.$$typeof===z)return pe(Z,Hu(Z,Y),ie);Wu(Z,Y)}return null}function oe(Z,Y,ie,me){var De=Y!==null?Y.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return De!==null?null:M(Z,Y,""+ie,me);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case T:return ie.key===De?K(Z,Y,ie,me):null;case w:return ie.key===De?se(Z,Y,ie,me):null;case A:return ie=ga(ie),oe(Z,Y,ie,me)}if(H(ie)||L(ie))return De!==null?null:de(Z,Y,ie,me,null);if(typeof ie.then=="function")return oe(Z,Y,Yu(ie),me);if(ie.$$typeof===z)return oe(Z,Y,Hu(Z,ie),me);Wu(Z,ie)}return null}function ue(Z,Y,ie,me,De){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return Z=Z.get(ie)||null,M(Y,Z,""+me,De);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case T:return Z=Z.get(me.key===null?ie:me.key)||null,K(Y,Z,me,De);case w:return Z=Z.get(me.key===null?ie:me.key)||null,se(Y,Z,me,De);case A:return me=ga(me),ue(Z,Y,ie,me,De)}if(H(me)||L(me))return Z=Z.get(ie)||null,de(Y,Z,me,De,null);if(typeof me.then=="function")return ue(Z,Y,ie,Yu(me),De);if(me.$$typeof===z)return ue(Z,Y,ie,Hu(Y,me),De);Wu(Y,me)}return null}function we(Z,Y,ie,me){for(var De=null,et=null,Ce=Y,ze=Y=0,Ke=null;Ce!==null&&ze<ie.length;ze++){Ce.index>ze?(Ke=Ce,Ce=null):Ke=Ce.sibling;var tt=oe(Z,Ce,ie[ze],me);if(tt===null){Ce===null&&(Ce=Ke);break}r&&Ce&&tt.alternate===null&&s(Z,Ce),Y=y(tt,Y,ze),et===null?De=tt:et.sibling=tt,et=tt,Ce=Ke}if(ze===ie.length)return o(Z,Ce),Xe&&mi(Z,ze),De;if(Ce===null){for(;ze<ie.length;ze++)Ce=pe(Z,ie[ze],me),Ce!==null&&(Y=y(Ce,Y,ze),et===null?De=Ce:et.sibling=Ce,et=Ce);return Xe&&mi(Z,ze),De}for(Ce=c(Ce);ze<ie.length;ze++)Ke=ue(Ce,Z,ze,ie[ze],me),Ke!==null&&(r&&Ke.alternate!==null&&Ce.delete(Ke.key===null?ze:Ke.key),Y=y(Ke,Y,ze),et===null?De=Ke:et.sibling=Ke,et=Ke);return r&&Ce.forEach(function(Es){return s(Z,Es)}),Xe&&mi(Z,ze),De}function Oe(Z,Y,ie,me){if(ie==null)throw Error(i(151));for(var De=null,et=null,Ce=Y,ze=Y=0,Ke=null,tt=ie.next();Ce!==null&&!tt.done;ze++,tt=ie.next()){Ce.index>ze?(Ke=Ce,Ce=null):Ke=Ce.sibling;var Es=oe(Z,Ce,tt.value,me);if(Es===null){Ce===null&&(Ce=Ke);break}r&&Ce&&Es.alternate===null&&s(Z,Ce),Y=y(Es,Y,ze),et===null?De=Es:et.sibling=Es,et=Es,Ce=Ke}if(tt.done)return o(Z,Ce),Xe&&mi(Z,ze),De;if(Ce===null){for(;!tt.done;ze++,tt=ie.next())tt=pe(Z,tt.value,me),tt!==null&&(Y=y(tt,Y,ze),et===null?De=tt:et.sibling=tt,et=tt);return Xe&&mi(Z,ze),De}for(Ce=c(Ce);!tt.done;ze++,tt=ie.next())tt=ue(Ce,Z,ze,tt.value,me),tt!==null&&(r&&tt.alternate!==null&&Ce.delete(tt.key===null?ze:tt.key),Y=y(tt,Y,ze),et===null?De=tt:et.sibling=tt,et=tt);return r&&Ce.forEach(function(uA){return s(Z,uA)}),Xe&&mi(Z,ze),De}function ht(Z,Y,ie,me){if(typeof ie=="object"&&ie!==null&&ie.type===I&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case T:e:{for(var De=ie.key;Y!==null;){if(Y.key===De){if(De=ie.type,De===I){if(Y.tag===7){o(Z,Y.sibling),me=p(Y,ie.props.children),me.return=Z,Z=me;break e}}else if(Y.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===A&&ga(De)===Y.type){o(Z,Y.sibling),me=p(Y,ie.props),ql(me,ie),me.return=Z,Z=me;break e}o(Z,Y);break}else s(Z,Y);Y=Y.sibling}ie.type===I?(me=da(ie.props.children,Z.mode,me,ie.key),me.return=Z,Z=me):(me=Fu(ie.type,ie.key,ie.props,null,Z.mode,me),ql(me,ie),me.return=Z,Z=me)}return S(Z);case w:e:{for(De=ie.key;Y!==null;){if(Y.key===De)if(Y.tag===4&&Y.stateNode.containerInfo===ie.containerInfo&&Y.stateNode.implementation===ie.implementation){o(Z,Y.sibling),me=p(Y,ie.children||[]),me.return=Z,Z=me;break e}else{o(Z,Y);break}else s(Z,Y);Y=Y.sibling}me=Df(ie,Z.mode,me),me.return=Z,Z=me}return S(Z);case A:return ie=ga(ie),ht(Z,Y,ie,me)}if(H(ie))return we(Z,Y,ie,me);if(L(ie)){if(De=L(ie),typeof De!="function")throw Error(i(150));return ie=De.call(ie),Oe(Z,Y,ie,me)}if(typeof ie.then=="function")return ht(Z,Y,Yu(ie),me);if(ie.$$typeof===z)return ht(Z,Y,Hu(Z,ie),me);Wu(Z,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,Y!==null&&Y.tag===6?(o(Z,Y.sibling),me=p(Y,ie),me.return=Z,Z=me):(o(Z,Y),me=Rf(ie,Z.mode,me),me.return=Z,Z=me),S(Z)):o(Z,Y)}return function(Z,Y,ie,me){try{Fl=0;var De=ht(Z,Y,ie,me);return uo=null,De}catch(Ce){if(Ce===co||Ce===Ku)throw Ce;var et=Ln(29,Ce,null,Z.mode);return et.lanes=me,et.return=Z,et}}}var _a=h_(!0),f_=h_(!1),is=!1;function zf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ff(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ss(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function as(r,s,o){var c=r.updateQueue;if(c===null)return null;if(c=c.shared,(it&2)!==0){var p=c.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),c.pending=s,s=zu(r),Wy(r,null,o),s}return Bu(r,c,s,o),zu(r)}function Gl(r,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var c=s.lanes;c&=r.pendingLanes,o|=c,s.lanes=o,yl(r,o)}}function qf(r,s){var o=r.updateQueue,c=r.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var S={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?p=y=S:y=y.next=S,o=o.next}while(o!==null);y===null?p=y=s:y=y.next=s}else p=y=s;o={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:c.shared,callbacks:c.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=s:r.next=s,o.lastBaseUpdate=s}var Gf=!1;function Hl(){if(Gf){var r=lo;if(r!==null)throw r}}function Ql(r,s,o,c){Gf=!1;var p=r.updateQueue;is=!1;var y=p.firstBaseUpdate,S=p.lastBaseUpdate,M=p.shared.pending;if(M!==null){p.shared.pending=null;var K=M,se=K.next;K.next=null,S===null?y=se:S.next=se,S=K;var de=r.alternate;de!==null&&(de=de.updateQueue,M=de.lastBaseUpdate,M!==S&&(M===null?de.firstBaseUpdate=se:M.next=se,de.lastBaseUpdate=K))}if(y!==null){var pe=p.baseState;S=0,de=se=K=null,M=y;do{var oe=M.lane&-536870913,ue=oe!==M.lane;if(ue?(Qe&oe)===oe:(c&oe)===oe){oe!==0&&oe===oo&&(Gf=!0),de!==null&&(de=de.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var we=r,Oe=M;oe=s;var ht=o;switch(Oe.tag){case 1:if(we=Oe.payload,typeof we=="function"){pe=we.call(ht,pe,oe);break e}pe=we;break e;case 3:we.flags=we.flags&-65537|128;case 0:if(we=Oe.payload,oe=typeof we=="function"?we.call(ht,pe,oe):we,oe==null)break e;pe=v({},pe,oe);break e;case 2:is=!0}}oe=M.callback,oe!==null&&(r.flags|=64,ue&&(r.flags|=8192),ue=p.callbacks,ue===null?p.callbacks=[oe]:ue.push(oe))}else ue={lane:oe,tag:M.tag,payload:M.payload,callback:M.callback,next:null},de===null?(se=de=ue,K=pe):de=de.next=ue,S|=oe;if(M=M.next,M===null){if(M=p.shared.pending,M===null)break;ue=M,M=ue.next,ue.next=null,p.lastBaseUpdate=ue,p.shared.pending=null}}while(!0);de===null&&(K=pe),p.baseState=K,p.firstBaseUpdate=se,p.lastBaseUpdate=de,y===null&&(p.shared.lanes=0),ds|=S,r.lanes=S,r.memoizedState=pe}}function m_(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function p_(r,s){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)m_(o[r],s)}var ho=P(null),Xu=P(0);function g_(r,s){r=Ti,he(Xu,r),he(ho,s),Ti=r|s.baseLanes}function Hf(){he(Xu,Ti),he(ho,ho.current)}function Qf(){Ti=Xu.current,X(ho),X(Xu)}var Un=P(null),sr=null;function os(r){var s=r.alternate;he(Ot,Ot.current&1),he(Un,r),sr===null&&(s===null||ho.current!==null||s.memoizedState!==null)&&(sr=r)}function Kf(r){he(Ot,Ot.current),he(Un,r),sr===null&&(sr=r)}function y_(r){r.tag===22?(he(Ot,Ot.current),he(Un,r),sr===null&&(sr=r)):ls()}function ls(){he(Ot,Ot.current),he(Un,Un.current)}function Bn(r){X(Un),sr===r&&(sr=null),X(Ot)}var Ot=P(0);function Ju(r){for(var s=r;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Zm(o)||ep(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var yi=0,Ue=null,ut=null,Bt=null,Zu=!1,fo=!1,va=!1,ed=0,Kl=0,mo=null,e1=0;function Ct(){throw Error(i(321))}function $f(r,s){if(s===null)return!1;for(var o=0;o<s.length&&o<r.length;o++)if(!Vn(r[o],s[o]))return!1;return!0}function Yf(r,s,o,c,p,y){return yi=y,Ue=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,B.H=r===null||r.memoizedState===null?e0:um,va=!1,y=o(c,p),va=!1,fo&&(y=v_(s,o,c,p)),__(r),y}function __(r){B.H=Wl;var s=ut!==null&&ut.next!==null;if(yi=0,Bt=ut=Ue=null,Zu=!1,Kl=0,mo=null,s)throw Error(i(300));r===null||zt||(r=r.dependencies,r!==null&&Gu(r)&&(zt=!0))}function v_(r,s,o,c){Ue=r;var p=0;do{if(fo&&(mo=null),Kl=0,fo=!1,25<=p)throw Error(i(301));if(p+=1,Bt=ut=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}B.H=t0,y=s(o,c)}while(fo);return y}function t1(){var r=B.H,s=r.useState()[0];return s=typeof s.then=="function"?$l(s):s,r=r.useState()[0],(ut!==null?ut.memoizedState:null)!==r&&(Ue.flags|=1024),s}function Wf(){var r=ed!==0;return ed=0,r}function Xf(r,s,o){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~o}function Jf(r){if(Zu){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Zu=!1}yi=0,Bt=ut=Ue=null,fo=!1,Kl=ed=0,mo=null}function xn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?Ue.memoizedState=Bt=r:Bt=Bt.next=r,Bt}function jt(){if(ut===null){var r=Ue.alternate;r=r!==null?r.memoizedState:null}else r=ut.next;var s=Bt===null?Ue.memoizedState:Bt.next;if(s!==null)Bt=s,ut=r;else{if(r===null)throw Ue.alternate===null?Error(i(467)):Error(i(310));ut=r,r={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},Bt===null?Ue.memoizedState=Bt=r:Bt=Bt.next=r}return Bt}function td(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $l(r){var s=Kl;return Kl+=1,mo===null&&(mo=[]),r=c_(mo,r,s),s=Ue,(Bt===null?s.memoizedState:Bt.next)===null&&(s=s.alternate,B.H=s===null||s.memoizedState===null?e0:um),r}function nd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return $l(r);if(r.$$typeof===z)return on(r)}throw Error(i(438,String(r)))}function Zf(r){var s=null,o=Ue.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var c=Ue.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=td(),Ue.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(r),c=0;c<r;c++)o[c]=D;return s.index++,o}function _i(r,s){return typeof s=="function"?s(r):s}function rd(r){var s=jt();return em(s,ut,r)}function em(r,s,o){var c=r.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var p=r.baseQueue,y=c.pending;if(y!==null){if(p!==null){var S=p.next;p.next=y.next,y.next=S}s.baseQueue=p=y,c.pending=null}if(y=r.baseState,p===null)r.memoizedState=y;else{s=p.next;var M=S=null,K=null,se=s,de=!1;do{var pe=se.lane&-536870913;if(pe!==se.lane?(Qe&pe)===pe:(yi&pe)===pe){var oe=se.revertLane;if(oe===0)K!==null&&(K=K.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),pe===oo&&(de=!0);else if((yi&oe)===oe){se=se.next,oe===oo&&(de=!0);continue}else pe={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},K===null?(M=K=pe,S=y):K=K.next=pe,Ue.lanes|=oe,ds|=oe;pe=se.action,va&&o(y,pe),y=se.hasEagerState?se.eagerState:o(y,pe)}else oe={lane:pe,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},K===null?(M=K=oe,S=y):K=K.next=oe,Ue.lanes|=pe,ds|=pe;se=se.next}while(se!==null&&se!==s);if(K===null?S=y:K.next=M,!Vn(y,r.memoizedState)&&(zt=!0,de&&(o=lo,o!==null)))throw o;r.memoizedState=y,r.baseState=S,r.baseQueue=K,c.lastRenderedState=y}return p===null&&(c.lanes=0),[r.memoizedState,c.dispatch]}function tm(r){var s=jt(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var c=o.dispatch,p=o.pending,y=s.memoizedState;if(p!==null){o.pending=null;var S=p=p.next;do y=r(y,S.action),S=S.next;while(S!==p);Vn(y,s.memoizedState)||(zt=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,c]}function b_(r,s,o){var c=Ue,p=jt(),y=Xe;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var S=!Vn((ut||p).memoizedState,o);if(S&&(p.memoizedState=o,zt=!0),p=p.queue,im(x_.bind(null,c,p,r),[r]),p.getSnapshot!==s||S||Bt!==null&&Bt.memoizedState.tag&1){if(c.flags|=2048,po(9,{destroy:void 0},S_.bind(null,c,p,o,s),null),mt===null)throw Error(i(349));y||(yi&127)!==0||E_(c,s,o)}return o}function E_(r,s,o){r.flags|=16384,r={getSnapshot:s,value:o},s=Ue.updateQueue,s===null?(s=td(),Ue.updateQueue=s,s.stores=[r]):(o=s.stores,o===null?s.stores=[r]:o.push(r))}function S_(r,s,o,c){s.value=o,s.getSnapshot=c,w_(s)&&T_(r)}function x_(r,s,o){return o(function(){w_(s)&&T_(r)})}function w_(r){var s=r.getSnapshot;r=r.value;try{var o=s();return!Vn(r,o)}catch{return!0}}function T_(r){var s=ua(r,2);s!==null&&On(s,r,2)}function nm(r){var s=xn();if(typeof r=="function"){var o=r;if(r=o(),va){Yn(!0);try{o()}finally{Yn(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_i,lastRenderedState:r},s}function A_(r,s,o,c){return r.baseState=o,em(r,ut,typeof c=="function"?c:_i)}function n1(r,s,o,c,p){if(ad(r))throw Error(i(485));if(r=s.action,r!==null){var y={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){y.listeners.push(S)}};B.T!==null?o(!0):y.isTransition=!1,c(y),o=s.pending,o===null?(y.next=s.pending=y,C_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function C_(r,s){var o=s.action,c=s.payload,p=r.state;if(s.isTransition){var y=B.T,S={};B.T=S;try{var M=o(p,c),K=B.S;K!==null&&K(S,M),R_(r,s,M)}catch(se){rm(r,s,se)}finally{y!==null&&S.types!==null&&(y.types=S.types),B.T=y}}else try{y=o(p,c),R_(r,s,y)}catch(se){rm(r,s,se)}}function R_(r,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){D_(r,s,c)},function(c){return rm(r,s,c)}):D_(r,s,o)}function D_(r,s,o){s.status="fulfilled",s.value=o,I_(s),r.state=o,s=r.pending,s!==null&&(o=s.next,o===s?r.pending=null:(o=o.next,s.next=o,C_(r,o)))}function rm(r,s,o){var c=r.pending;if(r.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=o,I_(s),s=s.next;while(s!==c)}r.action=null}function I_(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function O_(r,s){return s}function j_(r,s){if(Xe){var o=mt.formState;if(o!==null){e:{var c=Ue;if(Xe){if(yt){t:{for(var p=yt,y=ir;p.nodeType!==8;){if(!y){p=null;break t}if(p=ar(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){yt=ar(p.nextSibling),c=p.data==="F!";break e}}ns(c)}c=!1}c&&(s=o[0])}}return o=xn(),o.memoizedState=o.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:O_,lastRenderedState:s},o.queue=c,o=X_.bind(null,Ue,c),c.dispatch=o,c=nm(!1),y=cm.bind(null,Ue,!1,c.queue),c=xn(),p={state:s,dispatch:null,action:r,pending:null},c.queue=p,o=n1.bind(null,Ue,p,y,o),p.dispatch=o,c.memoizedState=r,[s,o,!1]}function M_(r){var s=jt();return k_(s,ut,r)}function k_(r,s,o){if(s=em(r,s,O_)[0],r=rd(_i)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=$l(s)}catch(S){throw S===co?Ku:S}else c=s;s=jt();var p=s.queue,y=p.dispatch;return o!==s.memoizedState&&(Ue.flags|=2048,po(9,{destroy:void 0},r1.bind(null,p,o),null)),[c,y,r]}function r1(r,s){r.action=s}function N_(r){var s=jt(),o=ut;if(o!==null)return k_(s,o,r);jt(),s=s.memoizedState,o=jt();var c=o.queue.dispatch;return o.memoizedState=r,[s,c,!1]}function po(r,s,o,c){return r={tag:r,create:o,deps:c,inst:s,next:null},s=Ue.updateQueue,s===null&&(s=td(),Ue.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=r.next=r:(c=o.next,o.next=r,r.next=c,s.lastEffect=r),r}function P_(){return jt().memoizedState}function id(r,s,o,c){var p=xn();Ue.flags|=r,p.memoizedState=po(1|s,{destroy:void 0},o,c===void 0?null:c)}function sd(r,s,o,c){var p=jt();c=c===void 0?null:c;var y=p.memoizedState.inst;ut!==null&&c!==null&&$f(c,ut.memoizedState.deps)?p.memoizedState=po(s,y,o,c):(Ue.flags|=r,p.memoizedState=po(1|s,y,o,c))}function V_(r,s){id(8390656,8,r,s)}function im(r,s){sd(2048,8,r,s)}function i1(r){Ue.flags|=4;var s=Ue.updateQueue;if(s===null)s=td(),Ue.updateQueue=s,s.events=[r];else{var o=s.events;o===null?s.events=[r]:o.push(r)}}function L_(r){var s=jt().memoizedState;return i1({ref:s,nextImpl:r}),function(){if((it&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function U_(r,s){return sd(4,2,r,s)}function B_(r,s){return sd(4,4,r,s)}function z_(r,s){if(typeof s=="function"){r=r();var o=s(r);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function F_(r,s,o){o=o!=null?o.concat([r]):null,sd(4,4,z_.bind(null,s,r),o)}function sm(){}function q_(r,s){var o=jt();s=s===void 0?null:s;var c=o.memoizedState;return s!==null&&$f(s,c[1])?c[0]:(o.memoizedState=[r,s],r)}function G_(r,s){var o=jt();s=s===void 0?null:s;var c=o.memoizedState;if(s!==null&&$f(s,c[1]))return c[0];if(c=r(),va){Yn(!0);try{r()}finally{Yn(!1)}}return o.memoizedState=[c,s],c}function am(r,s,o){return o===void 0||(yi&1073741824)!==0&&(Qe&261930)===0?r.memoizedState=s:(r.memoizedState=o,r=H0(),Ue.lanes|=r,ds|=r,o)}function H_(r,s,o,c){return Vn(o,s)?o:ho.current!==null?(r=am(r,o,c),Vn(r,s)||(zt=!0),r):(yi&42)===0||(yi&1073741824)!==0&&(Qe&261930)===0?(zt=!0,r.memoizedState=o):(r=H0(),Ue.lanes|=r,ds|=r,s)}function Q_(r,s,o,c,p){var y=q.p;q.p=y!==0&&8>y?y:8;var S=B.T,M={};B.T=M,cm(r,!1,s,o);try{var K=p(),se=B.S;if(se!==null&&se(M,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var de=ZT(K,c);Yl(r,s,de,qn(r))}else Yl(r,s,c,qn(r))}catch(pe){Yl(r,s,{then:function(){},status:"rejected",reason:pe},qn())}finally{q.p=y,S!==null&&M.types!==null&&(S.types=M.types),B.T=S}}function s1(){}function om(r,s,o,c){if(r.tag!==5)throw Error(i(476));var p=K_(r).queue;Q_(r,p,s,F,o===null?s1:function(){return $_(r),o(c)})}function K_(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_i,lastRenderedState:F},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_i,lastRenderedState:o},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function $_(r){var s=K_(r);s.next===null&&(s=r.alternate.memoizedState),Yl(r,s.next.queue,{},qn())}function lm(){return on(hc)}function Y_(){return jt().memoizedState}function W_(){return jt().memoizedState}function a1(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var o=qn();r=ss(o);var c=as(s,r,o);c!==null&&(On(c,s,o),Gl(c,s,o)),s={cache:Vf()},r.payload=s;return}s=s.return}}function o1(r,s,o){var c=qn();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},ad(r)?J_(s,o):(o=Af(r,s,o,c),o!==null&&(On(o,r,c),Z_(o,s,c)))}function X_(r,s,o){var c=qn();Yl(r,s,o,c)}function Yl(r,s,o,c){var p={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(ad(r))J_(s,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var S=s.lastRenderedState,M=y(S,o);if(p.hasEagerState=!0,p.eagerState=M,Vn(M,S))return Bu(r,s,p,0),mt===null&&Uu(),!1}catch{}if(o=Af(r,s,p,c),o!==null)return On(o,r,c),Z_(o,s,c),!0}return!1}function cm(r,s,o,c){if(c={lane:2,revertLane:zm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},ad(r)){if(s)throw Error(i(479))}else s=Af(r,o,c,2),s!==null&&On(s,r,2)}function ad(r){var s=r.alternate;return r===Ue||s!==null&&s===Ue}function J_(r,s){fo=Zu=!0;var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}function Z_(r,s,o){if((o&4194048)!==0){var c=s.lanes;c&=r.pendingLanes,o|=c,s.lanes=o,yl(r,o)}}var Wl={readContext:on,use:nd,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useLayoutEffect:Ct,useInsertionEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useSyncExternalStore:Ct,useId:Ct,useHostTransitionStatus:Ct,useFormState:Ct,useActionState:Ct,useOptimistic:Ct,useMemoCache:Ct,useCacheRefresh:Ct};Wl.useEffectEvent=Ct;var e0={readContext:on,use:nd,useCallback:function(r,s){return xn().memoizedState=[r,s===void 0?null:s],r},useContext:on,useEffect:V_,useImperativeHandle:function(r,s,o){o=o!=null?o.concat([r]):null,id(4194308,4,z_.bind(null,s,r),o)},useLayoutEffect:function(r,s){return id(4194308,4,r,s)},useInsertionEffect:function(r,s){id(4,2,r,s)},useMemo:function(r,s){var o=xn();s=s===void 0?null:s;var c=r();if(va){Yn(!0);try{r()}finally{Yn(!1)}}return o.memoizedState=[c,s],c},useReducer:function(r,s,o){var c=xn();if(o!==void 0){var p=o(s);if(va){Yn(!0);try{o(s)}finally{Yn(!1)}}}else p=s;return c.memoizedState=c.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},c.queue=r,r=r.dispatch=o1.bind(null,Ue,r),[c.memoizedState,r]},useRef:function(r){var s=xn();return r={current:r},s.memoizedState=r},useState:function(r){r=nm(r);var s=r.queue,o=X_.bind(null,Ue,s);return s.dispatch=o,[r.memoizedState,o]},useDebugValue:sm,useDeferredValue:function(r,s){var o=xn();return am(o,r,s)},useTransition:function(){var r=nm(!1);return r=Q_.bind(null,Ue,r.queue,!0,!1),xn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,o){var c=Ue,p=xn();if(Xe){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),mt===null)throw Error(i(349));(Qe&127)!==0||E_(c,s,o)}p.memoizedState=o;var y={value:o,getSnapshot:s};return p.queue=y,V_(x_.bind(null,c,y,r),[r]),c.flags|=2048,po(9,{destroy:void 0},S_.bind(null,c,y,o,s),null),o},useId:function(){var r=xn(),s=mt.identifierPrefix;if(Xe){var o=$r,c=Kr;o=(c&~(1<<32-Dt(c)-1)).toString(32)+o,s="_"+s+"R_"+o,o=ed++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=e1++,s="_"+s+"r_"+o.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:lm,useFormState:j_,useActionState:j_,useOptimistic:function(r){var s=xn();s.memoizedState=s.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=cm.bind(null,Ue,!0,o),o.dispatch=s,[r,s]},useMemoCache:Zf,useCacheRefresh:function(){return xn().memoizedState=a1.bind(null,Ue)},useEffectEvent:function(r){var s=xn(),o={impl:r};return s.memoizedState=o,function(){if((it&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},um={readContext:on,use:nd,useCallback:q_,useContext:on,useEffect:im,useImperativeHandle:F_,useInsertionEffect:U_,useLayoutEffect:B_,useMemo:G_,useReducer:rd,useRef:P_,useState:function(){return rd(_i)},useDebugValue:sm,useDeferredValue:function(r,s){var o=jt();return H_(o,ut.memoizedState,r,s)},useTransition:function(){var r=rd(_i)[0],s=jt().memoizedState;return[typeof r=="boolean"?r:$l(r),s]},useSyncExternalStore:b_,useId:Y_,useHostTransitionStatus:lm,useFormState:M_,useActionState:M_,useOptimistic:function(r,s){var o=jt();return A_(o,ut,r,s)},useMemoCache:Zf,useCacheRefresh:W_};um.useEffectEvent=L_;var t0={readContext:on,use:nd,useCallback:q_,useContext:on,useEffect:im,useImperativeHandle:F_,useInsertionEffect:U_,useLayoutEffect:B_,useMemo:G_,useReducer:tm,useRef:P_,useState:function(){return tm(_i)},useDebugValue:sm,useDeferredValue:function(r,s){var o=jt();return ut===null?am(o,r,s):H_(o,ut.memoizedState,r,s)},useTransition:function(){var r=tm(_i)[0],s=jt().memoizedState;return[typeof r=="boolean"?r:$l(r),s]},useSyncExternalStore:b_,useId:Y_,useHostTransitionStatus:lm,useFormState:N_,useActionState:N_,useOptimistic:function(r,s){var o=jt();return ut!==null?A_(o,ut,r,s):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:Zf,useCacheRefresh:W_};t0.useEffectEvent=L_;function dm(r,s,o,c){s=r.memoizedState,o=o(c,s),o=o==null?s:v({},s,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var hm={enqueueSetState:function(r,s,o){r=r._reactInternals;var c=qn(),p=ss(c);p.payload=s,o!=null&&(p.callback=o),s=as(r,p,c),s!==null&&(On(s,r,c),Gl(s,r,c))},enqueueReplaceState:function(r,s,o){r=r._reactInternals;var c=qn(),p=ss(c);p.tag=1,p.payload=s,o!=null&&(p.callback=o),s=as(r,p,c),s!==null&&(On(s,r,c),Gl(s,r,c))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var o=qn(),c=ss(o);c.tag=2,s!=null&&(c.callback=s),s=as(r,c,o),s!==null&&(On(s,r,o),Gl(s,r,o))}};function n0(r,s,o,c,p,y,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(c,y,S):s.prototype&&s.prototype.isPureReactComponent?!Pl(o,c)||!Pl(p,y):!0}function r0(r,s,o,c){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,c),s.state!==r&&hm.enqueueReplaceState(s,s.state,null)}function ba(r,s){var o=s;if("ref"in s){o={};for(var c in s)c!=="ref"&&(o[c]=s[c])}if(r=r.defaultProps){o===s&&(o=v({},o));for(var p in r)o[p]===void 0&&(o[p]=r[p])}return o}function i0(r){Lu(r)}function s0(r){console.error(r)}function a0(r){Lu(r)}function od(r,s){try{var o=r.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function o0(r,s,o){try{var c=r.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function fm(r,s,o){return o=ss(o),o.tag=3,o.payload={element:null},o.callback=function(){od(r,s)},o}function l0(r){return r=ss(r),r.tag=3,r}function c0(r,s,o,c){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var y=c.value;r.payload=function(){return p(y)},r.callback=function(){o0(s,o,c)}}var S=o.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){o0(s,o,c),typeof p!="function"&&(hs===null?hs=new Set([this]):hs.add(this));var M=c.stack;this.componentDidCatch(c.value,{componentStack:M!==null?M:""})})}function l1(r,s,o,c,p){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=o.alternate,s!==null&&ao(s,o,p,!0),o=Un.current,o!==null){switch(o.tag){case 31:case 13:return sr===null?vd():o.alternate===null&&Rt===0&&(Rt=3),o.flags&=-257,o.flags|=65536,o.lanes=p,c===$u?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([c]):s.add(c),Lm(r,c,p)),!1;case 22:return o.flags|=65536,c===$u?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([c]):o.add(c)),Lm(r,c,p)),!1}throw Error(i(435,o.tag))}return Lm(r,c,p),vd(),!1}if(Xe)return s=Un.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,c!==jf&&(r=Error(i(422),{cause:c}),Ul(tr(r,o)))):(c!==jf&&(s=Error(i(423),{cause:c}),Ul(tr(s,o))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,c=tr(c,o),p=fm(r.stateNode,c,p),qf(r,p),Rt!==4&&(Rt=2)),!1;var y=Error(i(520),{cause:c});if(y=tr(y,o),ic===null?ic=[y]:ic.push(y),Rt!==4&&(Rt=2),s===null)return!0;c=tr(c,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,r=p&-p,o.lanes|=r,r=fm(o.stateNode,c,r),qf(o,r),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(hs===null||!hs.has(y))))return o.flags|=65536,p&=-p,o.lanes|=p,p=l0(p),c0(p,r,o,c),qf(o,p),!1}o=o.return}while(o!==null);return!1}var mm=Error(i(461)),zt=!1;function ln(r,s,o,c){s.child=r===null?f_(s,null,o,c):_a(s,r.child,o,c)}function u0(r,s,o,c,p){o=o.render;var y=s.ref;if("ref"in c){var S={};for(var M in c)M!=="ref"&&(S[M]=c[M])}else S=c;return ma(s),c=Yf(r,s,o,S,y,p),M=Wf(),r!==null&&!zt?(Xf(r,s,p),vi(r,s,p)):(Xe&&M&&If(s),s.flags|=1,ln(r,s,c,p),s.child)}function d0(r,s,o,c,p){if(r===null){var y=o.type;return typeof y=="function"&&!Cf(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,h0(r,s,y,c,p)):(r=Fu(o.type,null,c,s,s.mode,p),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,!Sm(r,p)){var S=y.memoizedProps;if(o=o.compare,o=o!==null?o:Pl,o(S,c)&&r.ref===s.ref)return vi(r,s,p)}return s.flags|=1,r=fi(y,c),r.ref=s.ref,r.return=s,s.child=r}function h0(r,s,o,c,p){if(r!==null){var y=r.memoizedProps;if(Pl(y,c)&&r.ref===s.ref)if(zt=!1,s.pendingProps=c=y,Sm(r,p))(r.flags&131072)!==0&&(zt=!0);else return s.lanes=r.lanes,vi(r,s,p)}return pm(r,s,o,c,p)}function f0(r,s,o,c){var p=c.children,y=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(c=s.child=r.child,p=0;c!==null;)p=p|c.lanes|c.childLanes,c=c.sibling;c=p&~y}else c=0,s.child=null;return m0(r,s,y,o,c)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&Qu(s,y!==null?y.cachePool:null),y!==null?g_(s,y):Hf(),y_(s);else return c=s.lanes=536870912,m0(r,s,y!==null?y.baseLanes|o:o,o,c)}else y!==null?(Qu(s,y.cachePool),g_(s,y),ls(),s.memoizedState=null):(r!==null&&Qu(s,null),Hf(),ls());return ln(r,s,p,o),s.child}function Xl(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function m0(r,s,o,c,p){var y=Uf();return y=y===null?null:{parent:Ut._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},r!==null&&Qu(s,null),Hf(),y_(s),r!==null&&ao(r,s,c,!0),s.childLanes=p,null}function ld(r,s){return s=ud({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function p0(r,s,o){return _a(s,r.child,null,o),r=ld(s,s.pendingProps),r.flags|=2,Bn(s),s.memoizedState=null,r}function c1(r,s,o){var c=s.pendingProps,p=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(Xe){if(c.mode==="hidden")return r=ld(s,c),s.lanes=536870912,Xl(null,r);if(Kf(s),(r=yt)?(r=Cv(r,ir),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:es!==null?{id:Kr,overflow:$r}:null,retryLane:536870912,hydrationErrors:null},o=Jy(r),o.return=s,s.child=o,an=s,yt=null)):r=null,r===null)throw ns(s);return s.lanes=536870912,null}return ld(s,c)}var y=r.memoizedState;if(y!==null){var S=y.dehydrated;if(Kf(s),p)if(s.flags&256)s.flags&=-257,s=p0(r,s,o);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(zt||ao(r,s,o,!1),p=(o&r.childLanes)!==0,zt||p){if(c=mt,c!==null&&(S=_l(c,o),S!==0&&S!==y.retryLane))throw y.retryLane=S,ua(r,S),On(c,r,S),mm;vd(),s=p0(r,s,o)}else r=y.treeContext,yt=ar(S.nextSibling),an=s,Xe=!0,ts=null,ir=!1,r!==null&&t_(s,r),s=ld(s,c),s.flags|=4096;return s}return r=fi(r.child,{mode:c.mode,children:c.children}),r.ref=s.ref,s.child=r,r.return=s,r}function cd(r,s){var o=s.ref;if(o===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(r===null||r.ref!==o)&&(s.flags|=4194816)}}function pm(r,s,o,c,p){return ma(s),o=Yf(r,s,o,c,void 0,p),c=Wf(),r!==null&&!zt?(Xf(r,s,p),vi(r,s,p)):(Xe&&c&&If(s),s.flags|=1,ln(r,s,o,p),s.child)}function g0(r,s,o,c,p,y){return ma(s),s.updateQueue=null,o=v_(s,c,o,p),__(r),c=Wf(),r!==null&&!zt?(Xf(r,s,y),vi(r,s,y)):(Xe&&c&&If(s),s.flags|=1,ln(r,s,o,y),s.child)}function y0(r,s,o,c,p){if(ma(s),s.stateNode===null){var y=no,S=o.contextType;typeof S=="object"&&S!==null&&(y=on(S)),y=new o(c,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=hm,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=c,y.state=s.memoizedState,y.refs={},zf(s),S=o.contextType,y.context=typeof S=="object"&&S!==null?on(S):no,y.state=s.memoizedState,S=o.getDerivedStateFromProps,typeof S=="function"&&(dm(s,o,S,c),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(S=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),S!==y.state&&hm.enqueueReplaceState(y,y.state,null),Ql(s,c,y,p),Hl(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(r===null){y=s.stateNode;var M=s.memoizedProps,K=ba(o,M);y.props=K;var se=y.context,de=o.contextType;S=no,typeof de=="object"&&de!==null&&(S=on(de));var pe=o.getDerivedStateFromProps;de=typeof pe=="function"||typeof y.getSnapshotBeforeUpdate=="function",M=s.pendingProps!==M,de||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(M||se!==S)&&r0(s,y,c,S),is=!1;var oe=s.memoizedState;y.state=oe,Ql(s,c,y,p),Hl(),se=s.memoizedState,M||oe!==se||is?(typeof pe=="function"&&(dm(s,o,pe,c),se=s.memoizedState),(K=is||n0(s,o,K,c,oe,se,S))?(de||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=se),y.props=c,y.state=se,y.context=S,c=K):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{y=s.stateNode,Ff(r,s),S=s.memoizedProps,de=ba(o,S),y.props=de,pe=s.pendingProps,oe=y.context,se=o.contextType,K=no,typeof se=="object"&&se!==null&&(K=on(se)),M=o.getDerivedStateFromProps,(se=typeof M=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S!==pe||oe!==K)&&r0(s,y,c,K),is=!1,oe=s.memoizedState,y.state=oe,Ql(s,c,y,p),Hl();var ue=s.memoizedState;S!==pe||oe!==ue||is||r!==null&&r.dependencies!==null&&Gu(r.dependencies)?(typeof M=="function"&&(dm(s,o,M,c),ue=s.memoizedState),(de=is||n0(s,o,de,c,oe,ue,K)||r!==null&&r.dependencies!==null&&Gu(r.dependencies))?(se||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(c,ue,K),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(c,ue,K)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=ue),y.props=c,y.state=ue,y.context=K,c=de):(typeof y.componentDidUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(s.flags|=1024),c=!1)}return y=c,cd(r,s),c=(s.flags&128)!==0,y||c?(y=s.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,r!==null&&c?(s.child=_a(s,r.child,null,p),s.child=_a(s,null,o,p)):ln(r,s,o,p),s.memoizedState=y.state,r=s.child):r=vi(r,s,p),r}function _0(r,s,o,c){return ha(),s.flags|=256,ln(r,s,o,c),s.child}var gm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ym(r){return{baseLanes:r,cachePool:o_()}}function _m(r,s,o){return r=r!==null?r.childLanes&~o:0,s&&(r|=Fn),r}function v0(r,s,o){var c=s.pendingProps,p=!1,y=(s.flags&128)!==0,S;if((S=y)||(S=r!==null&&r.memoizedState===null?!1:(Ot.current&2)!==0),S&&(p=!0,s.flags&=-129),S=(s.flags&32)!==0,s.flags&=-33,r===null){if(Xe){if(p?os(s):ls(),(r=yt)?(r=Cv(r,ir),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:es!==null?{id:Kr,overflow:$r}:null,retryLane:536870912,hydrationErrors:null},o=Jy(r),o.return=s,s.child=o,an=s,yt=null)):r=null,r===null)throw ns(s);return ep(r)?s.lanes=32:s.lanes=536870912,null}var M=c.children;return c=c.fallback,p?(ls(),p=s.mode,M=ud({mode:"hidden",children:M},p),c=da(c,p,o,null),M.return=s,c.return=s,M.sibling=c,s.child=M,c=s.child,c.memoizedState=ym(o),c.childLanes=_m(r,S,o),s.memoizedState=gm,Xl(null,c)):(os(s),vm(s,M))}var K=r.memoizedState;if(K!==null&&(M=K.dehydrated,M!==null)){if(y)s.flags&256?(os(s),s.flags&=-257,s=bm(r,s,o)):s.memoizedState!==null?(ls(),s.child=r.child,s.flags|=128,s=null):(ls(),M=c.fallback,p=s.mode,c=ud({mode:"visible",children:c.children},p),M=da(M,p,o,null),M.flags|=2,c.return=s,M.return=s,c.sibling=M,s.child=c,_a(s,r.child,null,o),c=s.child,c.memoizedState=ym(o),c.childLanes=_m(r,S,o),s.memoizedState=gm,s=Xl(null,c));else if(os(s),ep(M)){if(S=M.nextSibling&&M.nextSibling.dataset,S)var se=S.dgst;S=se,c=Error(i(419)),c.stack="",c.digest=S,Ul({value:c,source:null,stack:null}),s=bm(r,s,o)}else if(zt||ao(r,s,o,!1),S=(o&r.childLanes)!==0,zt||S){if(S=mt,S!==null&&(c=_l(S,o),c!==0&&c!==K.retryLane))throw K.retryLane=c,ua(r,c),On(S,r,c),mm;Zm(M)||vd(),s=bm(r,s,o)}else Zm(M)?(s.flags|=192,s.child=r.child,s=null):(r=K.treeContext,yt=ar(M.nextSibling),an=s,Xe=!0,ts=null,ir=!1,r!==null&&t_(s,r),s=vm(s,c.children),s.flags|=4096);return s}return p?(ls(),M=c.fallback,p=s.mode,K=r.child,se=K.sibling,c=fi(K,{mode:"hidden",children:c.children}),c.subtreeFlags=K.subtreeFlags&65011712,se!==null?M=fi(se,M):(M=da(M,p,o,null),M.flags|=2),M.return=s,c.return=s,c.sibling=M,s.child=c,Xl(null,c),c=s.child,M=r.child.memoizedState,M===null?M=ym(o):(p=M.cachePool,p!==null?(K=Ut._currentValue,p=p.parent!==K?{parent:K,pool:K}:p):p=o_(),M={baseLanes:M.baseLanes|o,cachePool:p}),c.memoizedState=M,c.childLanes=_m(r,S,o),s.memoizedState=gm,Xl(r.child,c)):(os(s),o=r.child,r=o.sibling,o=fi(o,{mode:"visible",children:c.children}),o.return=s,o.sibling=null,r!==null&&(S=s.deletions,S===null?(s.deletions=[r],s.flags|=16):S.push(r)),s.child=o,s.memoizedState=null,o)}function vm(r,s){return s=ud({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function ud(r,s){return r=Ln(22,r,null,s),r.lanes=0,r}function bm(r,s,o){return _a(s,r.child,null,o),r=vm(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function b0(r,s,o){r.lanes|=s;var c=r.alternate;c!==null&&(c.lanes|=s),Nf(r.return,s,o)}function Em(r,s,o,c,p,y){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:p,treeForkCount:y}:(S.isBackwards=s,S.rendering=null,S.renderingStartTime=0,S.last=c,S.tail=o,S.tailMode=p,S.treeForkCount=y)}function E0(r,s,o){var c=s.pendingProps,p=c.revealOrder,y=c.tail;c=c.children;var S=Ot.current,M=(S&2)!==0;if(M?(S=S&1|2,s.flags|=128):S&=1,he(Ot,S),ln(r,s,c,o),c=Xe?Ll:0,!M&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&b0(r,o,s);else if(r.tag===19)b0(r,o,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(p){case"forwards":for(o=s.child,p=null;o!==null;)r=o.alternate,r!==null&&Ju(r)===null&&(p=o),o=o.sibling;o=p,o===null?(p=s.child,s.child=null):(p=o.sibling,o.sibling=null),Em(s,!1,p,o,y,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=s.child,s.child=null;p!==null;){if(r=p.alternate,r!==null&&Ju(r)===null){s.child=p;break}r=p.sibling,p.sibling=o,o=p,p=r}Em(s,!0,o,null,y,c);break;case"together":Em(s,!1,null,null,void 0,c);break;default:s.memoizedState=null}return s.child}function vi(r,s,o){if(r!==null&&(s.dependencies=r.dependencies),ds|=s.lanes,(o&s.childLanes)===0)if(r!==null){if(ao(r,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,o=fi(r,r.pendingProps),s.child=o,o.return=s;r.sibling!==null;)r=r.sibling,o=o.sibling=fi(r,r.pendingProps),o.return=s;o.sibling=null}return s.child}function Sm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&Gu(r)))}function u1(r,s,o){switch(s.tag){case 3:Ee(s,s.stateNode.containerInfo),rs(s,Ut,r.memoizedState.cache),ha();break;case 27:case 5:fe(s);break;case 4:Ee(s,s.stateNode.containerInfo);break;case 10:rs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Kf(s),null;break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(os(s),s.flags|=128,null):(o&s.child.childLanes)!==0?v0(r,s,o):(os(s),r=vi(r,s,o),r!==null?r.sibling:null);os(s);break;case 19:var p=(r.flags&128)!==0;if(c=(o&s.childLanes)!==0,c||(ao(r,s,o,!1),c=(o&s.childLanes)!==0),p){if(c)return E0(r,s,o);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),he(Ot,Ot.current),c)break;return null;case 22:return s.lanes=0,f0(r,s,o,s.pendingProps);case 24:rs(s,Ut,r.memoizedState.cache)}return vi(r,s,o)}function S0(r,s,o){if(r!==null)if(r.memoizedProps!==s.pendingProps)zt=!0;else{if(!Sm(r,o)&&(s.flags&128)===0)return zt=!1,u1(r,s,o);zt=(r.flags&131072)!==0}else zt=!1,Xe&&(s.flags&1048576)!==0&&e_(s,Ll,s.index);switch(s.lanes=0,s.tag){case 16:e:{var c=s.pendingProps;if(r=ga(s.elementType),s.type=r,typeof r=="function")Cf(r)?(c=ba(r,c),s.tag=1,s=y0(null,s,r,c,o)):(s.tag=0,s=pm(null,s,r,c,o));else{if(r!=null){var p=r.$$typeof;if(p===$){s.tag=11,s=u0(null,s,r,c,o);break e}else if(p===j){s.tag=14,s=d0(null,s,r,c,o);break e}}throw s=ee(r)||r,Error(i(306,s,""))}}return s;case 0:return pm(r,s,s.type,s.pendingProps,o);case 1:return c=s.type,p=ba(c,s.pendingProps),y0(r,s,c,p,o);case 3:e:{if(Ee(s,s.stateNode.containerInfo),r===null)throw Error(i(387));c=s.pendingProps;var y=s.memoizedState;p=y.element,Ff(r,s),Ql(s,c,null,o);var S=s.memoizedState;if(c=S.cache,rs(s,Ut,c),c!==y.cache&&Pf(s,[Ut],o,!0),Hl(),c=S.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:S.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=_0(r,s,c,o);break e}else if(c!==p){p=tr(Error(i(424)),s),Ul(p),s=_0(r,s,c,o);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,yt=ar(r.firstChild),an=s,Xe=!0,ts=null,ir=!0,o=f_(s,null,c,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ha(),c===p){s=vi(r,s,o);break e}ln(r,s,c,o)}s=s.child}return s;case 26:return cd(r,s),r===null?(o=Mv(s.type,null,s.pendingProps,null))?s.memoizedState=o:Xe||(o=s.type,r=s.pendingProps,c=Ad(ve.current).createElement(o),c[Pt]=s,c[Xt]=r,cn(c,o,r),Vt(c),s.stateNode=c):s.memoizedState=Mv(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return fe(s),r===null&&Xe&&(c=s.stateNode=Iv(s.type,s.pendingProps,ve.current),an=s,ir=!0,p=yt,gs(s.type)?(tp=p,yt=ar(c.firstChild)):yt=p),ln(r,s,s.pendingProps.children,o),cd(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&Xe&&((p=c=yt)&&(c=B1(c,s.type,s.pendingProps,ir),c!==null?(s.stateNode=c,an=s,yt=ar(c.firstChild),ir=!1,p=!0):p=!1),p||ns(s)),fe(s),p=s.type,y=s.pendingProps,S=r!==null?r.memoizedProps:null,c=y.children,Wm(p,y)?c=null:S!==null&&Wm(p,S)&&(s.flags|=32),s.memoizedState!==null&&(p=Yf(r,s,t1,null,null,o),hc._currentValue=p),cd(r,s),ln(r,s,c,o),s.child;case 6:return r===null&&Xe&&((r=o=yt)&&(o=z1(o,s.pendingProps,ir),o!==null?(s.stateNode=o,an=s,yt=null,r=!0):r=!1),r||ns(s)),null;case 13:return v0(r,s,o);case 4:return Ee(s,s.stateNode.containerInfo),c=s.pendingProps,r===null?s.child=_a(s,null,c,o):ln(r,s,c,o),s.child;case 11:return u0(r,s,s.type,s.pendingProps,o);case 7:return ln(r,s,s.pendingProps,o),s.child;case 8:return ln(r,s,s.pendingProps.children,o),s.child;case 12:return ln(r,s,s.pendingProps.children,o),s.child;case 10:return c=s.pendingProps,rs(s,s.type,c.value),ln(r,s,c.children,o),s.child;case 9:return p=s.type._context,c=s.pendingProps.children,ma(s),p=on(p),c=c(p),s.flags|=1,ln(r,s,c,o),s.child;case 14:return d0(r,s,s.type,s.pendingProps,o);case 15:return h0(r,s,s.type,s.pendingProps,o);case 19:return E0(r,s,o);case 31:return c1(r,s,o);case 22:return f0(r,s,o,s.pendingProps);case 24:return ma(s),c=on(Ut),r===null?(p=Uf(),p===null&&(p=mt,y=Vf(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=o),p=y),s.memoizedState={parent:c,cache:p},zf(s),rs(s,Ut,p)):((r.lanes&o)!==0&&(Ff(r,s),Ql(s,null,null,o),Hl()),p=r.memoizedState,y=s.memoizedState,p.parent!==c?(p={parent:c,cache:c},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),rs(s,Ut,c)):(c=y.cache,rs(s,Ut,c),c!==p.cache&&Pf(s,[Ut],o,!0))),ln(r,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function bi(r){r.flags|=4}function xm(r,s,o,c,p){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(p&335544128)===p)if(r.stateNode.complete)r.flags|=8192;else if(Y0())r.flags|=8192;else throw ya=$u,Bf}else r.flags&=-16777217}function x0(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Lv(s))if(Y0())r.flags|=8192;else throw ya=$u,Bf}function dd(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?yu():536870912,r.lanes|=s,vo|=s)}function Jl(r,s){if(!Xe)switch(r.tailMode){case"hidden":s=r.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:c.sibling=null}}function _t(r){var s=r.alternate!==null&&r.alternate.child===r.child,o=0,c=0;if(s)for(var p=r.child;p!==null;)o|=p.lanes|p.childLanes,c|=p.subtreeFlags&65011712,c|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)o|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=c,r.childLanes=o,s}function d1(r,s,o){var c=s.pendingProps;switch(Of(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(s),null;case 1:return _t(s),null;case 3:return o=s.stateNode,c=null,r!==null&&(c=r.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),gi(Ut),Te(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(so(s)?bi(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Mf())),_t(s),null;case 26:var p=s.type,y=s.memoizedState;return r===null?(bi(s),y!==null?(_t(s),x0(s,y)):(_t(s),xm(s,p,null,c,o))):y?y!==r.memoizedState?(bi(s),_t(s),x0(s,y)):(_t(s),s.flags&=-16777217):(r=r.memoizedProps,r!==c&&bi(s),_t(s),xm(s,p,r,c,o)),null;case 27:if(ft(s),o=ve.current,p=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==c&&bi(s);else{if(!c){if(s.stateNode===null)throw Error(i(166));return _t(s),null}r=re.current,so(s)?n_(s):(r=Iv(p,c,o),s.stateNode=r,bi(s))}return _t(s),null;case 5:if(ft(s),p=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==c&&bi(s);else{if(!c){if(s.stateNode===null)throw Error(i(166));return _t(s),null}if(y=re.current,so(s))n_(s);else{var S=Ad(ve.current);switch(y){case 1:y=S.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=S.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=S.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=S.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=S.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof c.is=="string"?S.createElement("select",{is:c.is}):S.createElement("select"),c.multiple?y.multiple=!0:c.size&&(y.size=c.size);break;default:y=typeof c.is=="string"?S.createElement(p,{is:c.is}):S.createElement(p)}}y[Pt]=s,y[Xt]=c;e:for(S=s.child;S!==null;){if(S.tag===5||S.tag===6)y.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===s)break e;for(;S.sibling===null;){if(S.return===null||S.return===s)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}s.stateNode=y;e:switch(cn(y,p,c),p){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&bi(s)}}return _t(s),xm(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,o),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==c&&bi(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(i(166));if(r=ve.current,so(s)){if(r=s.stateNode,o=s.memoizedProps,c=null,p=an,p!==null)switch(p.tag){case 27:case 5:c=p.memoizedProps}r[Pt]=s,r=!!(r.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||vv(r.nodeValue,o)),r||ns(s,!0)}else r=Ad(r).createTextNode(c),r[Pt]=s,s.stateNode=r}return _t(s),null;case 31:if(o=s.memoizedState,r===null||r.memoizedState!==null){if(c=so(s),o!==null){if(r===null){if(!c)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Pt]=s}else ha(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;_t(s),r=!1}else o=Mf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return s.flags&256?(Bn(s),s):(Bn(s),null);if((s.flags&128)!==0)throw Error(i(558))}return _t(s),null;case 13:if(c=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=so(s),c!==null&&c.dehydrated!==null){if(r===null){if(!p)throw Error(i(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Pt]=s}else ha(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;_t(s),p=!1}else p=Mf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(Bn(s),s):(Bn(s),null)}return Bn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=c!==null,r=r!==null&&r.memoizedState!==null,o&&(c=s.child,p=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(p=c.alternate.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==p&&(c.flags|=2048)),o!==r&&o&&(s.child.flags|=8192),dd(s,s.updateQueue),_t(s),null);case 4:return Te(),r===null&&Hm(s.stateNode.containerInfo),_t(s),null;case 10:return gi(s.type),_t(s),null;case 19:if(X(Ot),c=s.memoizedState,c===null)return _t(s),null;if(p=(s.flags&128)!==0,y=c.rendering,y===null)if(p)Jl(c,!1);else{if(Rt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(y=Ju(r),y!==null){for(s.flags|=128,Jl(c,!1),r=y.updateQueue,s.updateQueue=r,dd(s,r),s.subtreeFlags=0,r=o,o=s.child;o!==null;)Xy(o,r),o=o.sibling;return he(Ot,Ot.current&1|2),Xe&&mi(s,c.treeForkCount),s.child}r=r.sibling}c.tail!==null&&En()>gd&&(s.flags|=128,p=!0,Jl(c,!1),s.lanes=4194304)}else{if(!p)if(r=Ju(y),r!==null){if(s.flags|=128,p=!0,r=r.updateQueue,s.updateQueue=r,dd(s,r),Jl(c,!0),c.tail===null&&c.tailMode==="hidden"&&!y.alternate&&!Xe)return _t(s),null}else 2*En()-c.renderingStartTime>gd&&o!==536870912&&(s.flags|=128,p=!0,Jl(c,!1),s.lanes=4194304);c.isBackwards?(y.sibling=s.child,s.child=y):(r=c.last,r!==null?r.sibling=y:s.child=y,c.last=y)}return c.tail!==null?(r=c.tail,c.rendering=r,c.tail=r.sibling,c.renderingStartTime=En(),r.sibling=null,o=Ot.current,he(Ot,p?o&1|2:o&1),Xe&&mi(s,c.treeForkCount),r):(_t(s),null);case 22:case 23:return Bn(s),Qf(),c=s.memoizedState!==null,r!==null?r.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(o&536870912)!==0&&(s.flags&128)===0&&(_t(s),s.subtreeFlags&6&&(s.flags|=8192)):_t(s),o=s.updateQueue,o!==null&&dd(s,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==o&&(s.flags|=2048),r!==null&&X(pa),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),gi(Ut),_t(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function h1(r,s){switch(Of(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return gi(Ut),Te(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return ft(s),null;case 31:if(s.memoizedState!==null){if(Bn(s),s.alternate===null)throw Error(i(340));ha()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(Bn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));ha()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return X(Ot),null;case 4:return Te(),null;case 10:return gi(s.type),null;case 22:case 23:return Bn(s),Qf(),r!==null&&X(pa),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return gi(Ut),null;case 25:return null;default:return null}}function w0(r,s){switch(Of(s),s.tag){case 3:gi(Ut),Te();break;case 26:case 27:case 5:ft(s);break;case 4:Te();break;case 31:s.memoizedState!==null&&Bn(s);break;case 13:Bn(s);break;case 19:X(Ot);break;case 10:gi(s.type);break;case 22:case 23:Bn(s),Qf(),r!==null&&X(pa);break;case 24:gi(Ut)}}function Zl(r,s){try{var o=s.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var p=c.next;o=p;do{if((o.tag&r)===r){c=void 0;var y=o.create,S=o.inst;c=y(),S.destroy=c}o=o.next}while(o!==p)}}catch(M){lt(s,s.return,M)}}function cs(r,s,o){try{var c=s.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var y=p.next;c=y;do{if((c.tag&r)===r){var S=c.inst,M=S.destroy;if(M!==void 0){S.destroy=void 0,p=s;var K=o,se=M;try{se()}catch(de){lt(p,K,de)}}}c=c.next}while(c!==y)}}catch(de){lt(s,s.return,de)}}function T0(r){var s=r.updateQueue;if(s!==null){var o=r.stateNode;try{p_(s,o)}catch(c){lt(r,r.return,c)}}}function A0(r,s,o){o.props=ba(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(c){lt(r,s,c)}}function ec(r,s){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var c=r.stateNode;break;case 30:c=r.stateNode;break;default:c=r.stateNode}typeof o=="function"?r.refCleanup=o(c):o.current=c}}catch(p){lt(r,s,p)}}function Yr(r,s){var o=r.ref,c=r.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(p){lt(r,s,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){lt(r,s,p)}else o.current=null}function C0(r){var s=r.type,o=r.memoizedProps,c=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(p){lt(r,r.return,p)}}function wm(r,s,o){try{var c=r.stateNode;k1(c,r.type,o,s),c[Xt]=s}catch(p){lt(r,r.return,p)}}function R0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&gs(r.type)||r.tag===4}function Tm(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||R0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&gs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Am(r,s,o){var c=r.tag;if(c===5||c===6)r=r.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(r),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=yr));else if(c!==4&&(c===27&&gs(r.type)&&(o=r.stateNode,s=null),r=r.child,r!==null))for(Am(r,s,o),r=r.sibling;r!==null;)Am(r,s,o),r=r.sibling}function hd(r,s,o){var c=r.tag;if(c===5||c===6)r=r.stateNode,s?o.insertBefore(r,s):o.appendChild(r);else if(c!==4&&(c===27&&gs(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(hd(r,s,o),r=r.sibling;r!==null;)hd(r,s,o),r=r.sibling}function D0(r){var s=r.stateNode,o=r.memoizedProps;try{for(var c=r.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);cn(s,c,o),s[Pt]=r,s[Xt]=o}catch(y){lt(r,r.return,y)}}var Ei=!1,Ft=!1,Cm=!1,I0=typeof WeakSet=="function"?WeakSet:Set,Zt=null;function f1(r,s){if(r=r.containerInfo,$m=Md,r=Fy(r),bf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var p=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var S=0,M=-1,K=-1,se=0,de=0,pe=r,oe=null;t:for(;;){for(var ue;pe!==o||p!==0&&pe.nodeType!==3||(M=S+p),pe!==y||c!==0&&pe.nodeType!==3||(K=S+c),pe.nodeType===3&&(S+=pe.nodeValue.length),(ue=pe.firstChild)!==null;)oe=pe,pe=ue;for(;;){if(pe===r)break t;if(oe===o&&++se===p&&(M=S),oe===y&&++de===c&&(K=S),(ue=pe.nextSibling)!==null)break;pe=oe,oe=pe.parentNode}pe=ue}o=M===-1||K===-1?null:{start:M,end:K}}else o=null}o=o||{start:0,end:0}}else o=null;for(Ym={focusedElem:r,selectionRange:o},Md=!1,Zt=s;Zt!==null;)if(s=Zt,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,Zt=r;else for(;Zt!==null;){switch(s=Zt,y=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)p=r[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=s,p=y.memoizedProps,y=y.memoizedState,c=o.stateNode;try{var we=ba(o.type,p);r=c.getSnapshotBeforeUpdate(we,y),c.__reactInternalSnapshotBeforeUpdate=r}catch(Oe){lt(o,o.return,Oe)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,o=r.nodeType,o===9)Jm(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Jm(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,Zt=r;break}Zt=s.return}}function O0(r,s,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:xi(r,o),c&4&&Zl(5,o);break;case 1:if(xi(r,o),c&4)if(r=o.stateNode,s===null)try{r.componentDidMount()}catch(S){lt(o,o.return,S)}else{var p=ba(o.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(p,s,r.__reactInternalSnapshotBeforeUpdate)}catch(S){lt(o,o.return,S)}}c&64&&T0(o),c&512&&ec(o,o.return);break;case 3:if(xi(r,o),c&64&&(r=o.updateQueue,r!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{p_(r,s)}catch(S){lt(o,o.return,S)}}break;case 27:s===null&&c&4&&D0(o);case 26:case 5:xi(r,o),s===null&&c&4&&C0(o),c&512&&ec(o,o.return);break;case 12:xi(r,o);break;case 31:xi(r,o),c&4&&k0(r,o);break;case 13:xi(r,o),c&4&&N0(r,o),c&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=S1.bind(null,o),F1(r,o))));break;case 22:if(c=o.memoizedState!==null||Ei,!c){s=s!==null&&s.memoizedState!==null||Ft,p=Ei;var y=Ft;Ei=c,(Ft=s)&&!y?wi(r,o,(o.subtreeFlags&8772)!==0):xi(r,o),Ei=p,Ft=y}break;case 30:break;default:xi(r,o)}}function j0(r){var s=r.alternate;s!==null&&(r.alternate=null,j0(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&Fa(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var St=null,Cn=!1;function Si(r,s,o){for(o=o.child;o!==null;)M0(r,s,o),o=o.sibling}function M0(r,s,o){if(rn&&typeof rn.onCommitFiberUnmount=="function")try{rn.onCommitFiberUnmount(fr,o)}catch{}switch(o.tag){case 26:Ft||Yr(o,s),Si(r,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Ft||Yr(o,s);var c=St,p=Cn;gs(o.type)&&(St=o.stateNode,Cn=!1),Si(r,s,o),cc(o.stateNode),St=c,Cn=p;break;case 5:Ft||Yr(o,s);case 6:if(c=St,p=Cn,St=null,Si(r,s,o),St=c,Cn=p,St!==null)if(Cn)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(o.stateNode)}catch(y){lt(o,s,y)}else try{St.removeChild(o.stateNode)}catch(y){lt(o,s,y)}break;case 18:St!==null&&(Cn?(r=St,Tv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),Co(r)):Tv(St,o.stateNode));break;case 4:c=St,p=Cn,St=o.stateNode.containerInfo,Cn=!0,Si(r,s,o),St=c,Cn=p;break;case 0:case 11:case 14:case 15:cs(2,o,s),Ft||cs(4,o,s),Si(r,s,o);break;case 1:Ft||(Yr(o,s),c=o.stateNode,typeof c.componentWillUnmount=="function"&&A0(o,s,c)),Si(r,s,o);break;case 21:Si(r,s,o);break;case 22:Ft=(c=Ft)||o.memoizedState!==null,Si(r,s,o),Ft=c;break;default:Si(r,s,o)}}function k0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Co(r)}catch(o){lt(s,s.return,o)}}}function N0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Co(r)}catch(o){lt(s,s.return,o)}}function m1(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new I0),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new I0),s;default:throw Error(i(435,r.tag))}}function fd(r,s){var o=m1(r);s.forEach(function(c){if(!o.has(c)){o.add(c);var p=x1.bind(null,r,c);c.then(p,p)}})}function Rn(r,s){var o=s.deletions;if(o!==null)for(var c=0;c<o.length;c++){var p=o[c],y=r,S=s,M=S;e:for(;M!==null;){switch(M.tag){case 27:if(gs(M.type)){St=M.stateNode,Cn=!1;break e}break;case 5:St=M.stateNode,Cn=!1;break e;case 3:case 4:St=M.stateNode.containerInfo,Cn=!0;break e}M=M.return}if(St===null)throw Error(i(160));M0(y,S,p),St=null,Cn=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)P0(s,r),s=s.sibling}var xr=null;function P0(r,s){var o=r.alternate,c=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Rn(s,r),Dn(r),c&4&&(cs(3,r,r.return),Zl(3,r),cs(5,r,r.return));break;case 1:Rn(s,r),Dn(r),c&512&&(Ft||o===null||Yr(o,o.return)),c&64&&Ei&&(r=r.updateQueue,r!==null&&(c=r.callbacks,c!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var p=xr;if(Rn(s,r),Dn(r),c&512&&(Ft||o===null||Yr(o,o.return)),c&4){var y=o!==null?o.memoizedState:null;if(c=r.memoizedState,o===null)if(c===null)if(r.stateNode===null){e:{c=r.type,o=r.memoizedProps,p=p.ownerDocument||p;t:switch(c){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Nr]||y[Pt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(c),p.head.insertBefore(y,p.querySelector("head > title"))),cn(y,c,o),y[Pt]=r,Vt(y),c=y;break e;case"link":var S=Pv("link","href",p).get(c+(o.href||""));if(S){for(var M=0;M<S.length;M++)if(y=S[M],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){S.splice(M,1);break t}}y=p.createElement(c),cn(y,c,o),p.head.appendChild(y);break;case"meta":if(S=Pv("meta","content",p).get(c+(o.content||""))){for(M=0;M<S.length;M++)if(y=S[M],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){S.splice(M,1);break t}}y=p.createElement(c),cn(y,c,o),p.head.appendChild(y);break;default:throw Error(i(468,c))}y[Pt]=r,Vt(y),c=y}r.stateNode=c}else Vv(p,r.type,r.stateNode);else r.stateNode=Nv(p,c,r.memoizedProps);else y!==c?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,c===null?Vv(p,r.type,r.stateNode):Nv(p,c,r.memoizedProps)):c===null&&r.stateNode!==null&&wm(r,r.memoizedProps,o.memoizedProps)}break;case 27:Rn(s,r),Dn(r),c&512&&(Ft||o===null||Yr(o,o.return)),o!==null&&c&4&&wm(r,r.memoizedProps,o.memoizedProps);break;case 5:if(Rn(s,r),Dn(r),c&512&&(Ft||o===null||Yr(o,o.return)),r.flags&32){p=r.stateNode;try{An(p,"")}catch(we){lt(r,r.return,we)}}c&4&&r.stateNode!=null&&(p=r.memoizedProps,wm(r,p,o!==null?o.memoizedProps:p)),c&1024&&(Cm=!0);break;case 6:if(Rn(s,r),Dn(r),c&4){if(r.stateNode===null)throw Error(i(162));c=r.memoizedProps,o=r.stateNode;try{o.nodeValue=c}catch(we){lt(r,r.return,we)}}break;case 3:if(Dd=null,p=xr,xr=Cd(s.containerInfo),Rn(s,r),xr=p,Dn(r),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Co(s.containerInfo)}catch(we){lt(r,r.return,we)}Cm&&(Cm=!1,V0(r));break;case 4:c=xr,xr=Cd(r.stateNode.containerInfo),Rn(s,r),Dn(r),xr=c;break;case 12:Rn(s,r),Dn(r);break;case 31:Rn(s,r),Dn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,fd(r,c)));break;case 13:Rn(s,r),Dn(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(pd=En()),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,fd(r,c)));break;case 22:p=r.memoizedState!==null;var K=o!==null&&o.memoizedState!==null,se=Ei,de=Ft;if(Ei=se||p,Ft=de||K,Rn(s,r),Ft=de,Ei=se,Dn(r),c&8192)e:for(s=r.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(o===null||K||Ei||Ft||Ea(r)),o=null,s=r;;){if(s.tag===5||s.tag===26){if(o===null){K=o=s;try{if(y=K.stateNode,p)S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{M=K.stateNode;var pe=K.memoizedProps.style,oe=pe!=null&&pe.hasOwnProperty("display")?pe.display:null;M.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(we){lt(K,K.return,we)}}}else if(s.tag===6){if(o===null){K=s;try{K.stateNode.nodeValue=p?"":K.memoizedProps}catch(we){lt(K,K.return,we)}}}else if(s.tag===18){if(o===null){K=s;try{var ue=K.stateNode;p?Av(ue,!0):Av(K.stateNode,!1)}catch(we){lt(K,K.return,we)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=r.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,fd(r,o))));break;case 19:Rn(s,r),Dn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,fd(r,c)));break;case 30:break;case 21:break;default:Rn(s,r),Dn(r)}}function Dn(r){var s=r.flags;if(s&2){try{for(var o,c=r.return;c!==null;){if(R0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var p=o.stateNode,y=Tm(r);hd(r,y,p);break;case 5:var S=o.stateNode;o.flags&32&&(An(S,""),o.flags&=-33);var M=Tm(r);hd(r,M,S);break;case 3:case 4:var K=o.stateNode.containerInfo,se=Tm(r);Am(r,se,K);break;default:throw Error(i(161))}}catch(de){lt(r,r.return,de)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function V0(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;V0(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function xi(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)O0(r,s.alternate,s),s=s.sibling}function Ea(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:cs(4,s,s.return),Ea(s);break;case 1:Yr(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&A0(s,s.return,o),Ea(s);break;case 27:cc(s.stateNode);case 26:case 5:Yr(s,s.return),Ea(s);break;case 22:s.memoizedState===null&&Ea(s);break;case 30:Ea(s);break;default:Ea(s)}r=r.sibling}}function wi(r,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,p=r,y=s,S=y.flags;switch(y.tag){case 0:case 11:case 15:wi(p,y,o),Zl(4,y);break;case 1:if(wi(p,y,o),c=y,p=c.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(se){lt(c,c.return,se)}if(c=y,p=c.updateQueue,p!==null){var M=c.stateNode;try{var K=p.shared.hiddenCallbacks;if(K!==null)for(p.shared.hiddenCallbacks=null,p=0;p<K.length;p++)m_(K[p],M)}catch(se){lt(c,c.return,se)}}o&&S&64&&T0(y),ec(y,y.return);break;case 27:D0(y);case 26:case 5:wi(p,y,o),o&&c===null&&S&4&&C0(y),ec(y,y.return);break;case 12:wi(p,y,o);break;case 31:wi(p,y,o),o&&S&4&&k0(p,y);break;case 13:wi(p,y,o),o&&S&4&&N0(p,y);break;case 22:y.memoizedState===null&&wi(p,y,o),ec(y,y.return);break;case 30:break;default:wi(p,y,o)}s=s.sibling}}function Rm(r,s){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&Bl(o))}function Dm(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Bl(r))}function wr(r,s,o,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)L0(r,s,o,c),s=s.sibling}function L0(r,s,o,c){var p=s.flags;switch(s.tag){case 0:case 11:case 15:wr(r,s,o,c),p&2048&&Zl(9,s);break;case 1:wr(r,s,o,c);break;case 3:wr(r,s,o,c),p&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Bl(r)));break;case 12:if(p&2048){wr(r,s,o,c),r=s.stateNode;try{var y=s.memoizedProps,S=y.id,M=y.onPostCommit;typeof M=="function"&&M(S,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(K){lt(s,s.return,K)}}else wr(r,s,o,c);break;case 31:wr(r,s,o,c);break;case 13:wr(r,s,o,c);break;case 23:break;case 22:y=s.stateNode,S=s.alternate,s.memoizedState!==null?y._visibility&2?wr(r,s,o,c):tc(r,s):y._visibility&2?wr(r,s,o,c):(y._visibility|=2,go(r,s,o,c,(s.subtreeFlags&10256)!==0||!1)),p&2048&&Rm(S,s);break;case 24:wr(r,s,o,c),p&2048&&Dm(s.alternate,s);break;default:wr(r,s,o,c)}}function go(r,s,o,c,p){for(p=p&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=r,S=s,M=o,K=c,se=S.flags;switch(S.tag){case 0:case 11:case 15:go(y,S,M,K,p),Zl(8,S);break;case 23:break;case 22:var de=S.stateNode;S.memoizedState!==null?de._visibility&2?go(y,S,M,K,p):tc(y,S):(de._visibility|=2,go(y,S,M,K,p)),p&&se&2048&&Rm(S.alternate,S);break;case 24:go(y,S,M,K,p),p&&se&2048&&Dm(S.alternate,S);break;default:go(y,S,M,K,p)}s=s.sibling}}function tc(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=r,c=s,p=c.flags;switch(c.tag){case 22:tc(o,c),p&2048&&Rm(c.alternate,c);break;case 24:tc(o,c),p&2048&&Dm(c.alternate,c);break;default:tc(o,c)}s=s.sibling}}var nc=8192;function yo(r,s,o){if(r.subtreeFlags&nc)for(r=r.child;r!==null;)U0(r,s,o),r=r.sibling}function U0(r,s,o){switch(r.tag){case 26:yo(r,s,o),r.flags&nc&&r.memoizedState!==null&&eA(o,xr,r.memoizedState,r.memoizedProps);break;case 5:yo(r,s,o);break;case 3:case 4:var c=xr;xr=Cd(r.stateNode.containerInfo),yo(r,s,o),xr=c;break;case 22:r.memoizedState===null&&(c=r.alternate,c!==null&&c.memoizedState!==null?(c=nc,nc=16777216,yo(r,s,o),nc=c):yo(r,s,o));break;default:yo(r,s,o)}}function B0(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function rc(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];Zt=c,F0(c,r)}B0(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)z0(r),r=r.sibling}function z0(r){switch(r.tag){case 0:case 11:case 15:rc(r),r.flags&2048&&cs(9,r,r.return);break;case 3:rc(r);break;case 12:rc(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,md(r)):rc(r);break;default:rc(r)}}function md(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];Zt=c,F0(c,r)}B0(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:cs(8,s,s.return),md(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,md(s));break;default:md(s)}r=r.sibling}}function F0(r,s){for(;Zt!==null;){var o=Zt;switch(o.tag){case 0:case 11:case 15:cs(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Bl(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,Zt=c;else e:for(o=r;Zt!==null;){c=Zt;var p=c.sibling,y=c.return;if(j0(c),c===o){Zt=null;break e}if(p!==null){p.return=y,Zt=p;break e}Zt=y}}}var p1={getCacheForType:function(r){var s=on(Ut),o=s.data.get(r);return o===void 0&&(o=r(),s.data.set(r,o)),o},cacheSignal:function(){return on(Ut).controller.signal}},g1=typeof WeakMap=="function"?WeakMap:Map,it=0,mt=null,qe=null,Qe=0,ot=0,zn=null,us=!1,_o=!1,Im=!1,Ti=0,Rt=0,ds=0,Sa=0,Om=0,Fn=0,vo=0,ic=null,In=null,jm=!1,pd=0,q0=0,gd=1/0,yd=null,hs=null,Kt=0,fs=null,bo=null,Ai=0,Mm=0,km=null,G0=null,sc=0,Nm=null;function qn(){return(it&2)!==0&&Qe!==0?Qe&-Qe:B.T!==null?zm():_u()}function H0(){if(Fn===0)if((Qe&536870912)===0||Xe){var r=Ys;Ys<<=1,(Ys&3932160)===0&&(Ys=262144),Fn=r}else Fn=536870912;return r=Un.current,r!==null&&(r.flags|=32),Fn}function On(r,s,o){(r===mt&&(ot===2||ot===9)||r.cancelPendingCommit!==null)&&(Eo(r,0),ms(r,Qe,Fn,!1)),Ws(r,o),((it&2)===0||r!==mt)&&(r===mt&&((it&2)===0&&(Sa|=o),Rt===4&&ms(r,Qe,Fn,!1)),Wr(r))}function Q0(r,s,o){if((it&6)!==0)throw Error(i(327));var c=!o&&(s&127)===0&&(s&r.expiredLanes)===0||mr(r,s),p=c?v1(r,s):Vm(r,s,!0),y=c;do{if(p===0){_o&&!c&&ms(r,s,0,!1);break}else{if(o=r.current.alternate,y&&!y1(o)){p=Vm(r,s,!1),y=!1;continue}if(p===2){if(y=s,r.errorRecoveryDisabledLanes&y)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){s=S;e:{var M=r;p=ic;var K=M.current.memoizedState.isDehydrated;if(K&&(Eo(M,S).flags|=256),S=Vm(M,S,!1),S!==2){if(Im&&!K){M.errorRecoveryDisabledLanes|=y,Sa|=y,p=4;break e}y=In,In=p,y!==null&&(In===null?In=y:In.push.apply(In,y))}p=S}if(y=!1,p!==2)continue}}if(p===1){Eo(r,0),ms(r,s,0,!0);break}e:{switch(c=r,y=p,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:ms(c,s,Fn,!us);break e;case 2:In=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(p=pd+300-En(),10<p)){if(ms(c,s,Fn,!us),jr(c,0,!0)!==0)break e;Ai=s,c.timeoutHandle=xv(K0.bind(null,c,o,In,yd,jm,s,Fn,Sa,vo,us,y,"Throttled",-0,0),p);break e}K0(c,o,In,yd,jm,s,Fn,Sa,vo,us,y,null,-0,0)}}break}while(!0);Wr(r)}function K0(r,s,o,c,p,y,S,M,K,se,de,pe,oe,ue){if(r.timeoutHandle=-1,pe=s.subtreeFlags,pe&8192||(pe&16785408)===16785408){pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:yr},U0(s,y,pe);var we=(y&62914560)===y?pd-En():(y&4194048)===y?q0-En():0;if(we=tA(pe,we),we!==null){Ai=y,r.cancelPendingCommit=we(tv.bind(null,r,s,y,o,c,p,S,M,K,de,pe,null,oe,ue)),ms(r,y,S,!se);return}}tv(r,s,y,o,c,p,S,M,K)}function y1(r){for(var s=r;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var p=o[c],y=p.getSnapshot;p=p.value;try{if(!Vn(y(),p))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ms(r,s,o,c){s&=~Om,s&=~Sa,r.suspendedLanes|=s,r.pingedLanes&=~s,c&&(r.warmLanes|=s),c=r.expirationTimes;for(var p=s;0<p;){var y=31-Dt(p),S=1<<y;c[y]=-1,p&=~S}o!==0&&Xs(r,o,s)}function _d(){return(it&6)===0?(ac(0),!1):!0}function Pm(){if(qe!==null){if(ot===0)var r=qe.return;else r=qe,pi=fa=null,Jf(r),uo=null,Fl=0,r=qe;for(;r!==null;)w0(r.alternate,r),r=r.return;qe=null}}function Eo(r,s){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,V1(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),Ai=0,Pm(),mt=r,qe=o=fi(r.current,null),Qe=s,ot=0,zn=null,us=!1,_o=mr(r,s),Im=!1,vo=Fn=Om=Sa=ds=Rt=0,In=ic=null,jm=!1,(s&8)!==0&&(s|=s&32);var c=r.entangledLanes;if(c!==0)for(r=r.entanglements,c&=s;0<c;){var p=31-Dt(c),y=1<<p;s|=r[p],c&=~y}return Ti=s,Uu(),o}function $0(r,s){Ue=null,B.H=Wl,s===co||s===Ku?(s=u_(),ot=3):s===Bf?(s=u_(),ot=4):ot=s===mm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,zn=s,qe===null&&(Rt=1,od(r,tr(s,r.current)))}function Y0(){var r=Un.current;return r===null?!0:(Qe&4194048)===Qe?sr===null:(Qe&62914560)===Qe||(Qe&536870912)!==0?r===sr:!1}function W0(){var r=B.H;return B.H=Wl,r===null?Wl:r}function X0(){var r=B.A;return B.A=p1,r}function vd(){Rt=4,us||(Qe&4194048)!==Qe&&Un.current!==null||(_o=!0),(ds&134217727)===0&&(Sa&134217727)===0||mt===null||ms(mt,Qe,Fn,!1)}function Vm(r,s,o){var c=it;it|=2;var p=W0(),y=X0();(mt!==r||Qe!==s)&&(yd=null,Eo(r,s)),s=!1;var S=Rt;e:do try{if(ot!==0&&qe!==null){var M=qe,K=zn;switch(ot){case 8:Pm(),S=6;break e;case 3:case 2:case 9:case 6:Un.current===null&&(s=!0);var se=ot;if(ot=0,zn=null,So(r,M,K,se),o&&_o){S=0;break e}break;default:se=ot,ot=0,zn=null,So(r,M,K,se)}}_1(),S=Rt;break}catch(de){$0(r,de)}while(!0);return s&&r.shellSuspendCounter++,pi=fa=null,it=c,B.H=p,B.A=y,qe===null&&(mt=null,Qe=0,Uu()),S}function _1(){for(;qe!==null;)J0(qe)}function v1(r,s){var o=it;it|=2;var c=W0(),p=X0();mt!==r||Qe!==s?(yd=null,gd=En()+500,Eo(r,s)):_o=mr(r,s);e:do try{if(ot!==0&&qe!==null){s=qe;var y=zn;t:switch(ot){case 1:ot=0,zn=null,So(r,s,y,1);break;case 2:case 9:if(l_(y)){ot=0,zn=null,Z0(s);break}s=function(){ot!==2&&ot!==9||mt!==r||(ot=7),Wr(r)},y.then(s,s);break e;case 3:ot=7;break e;case 4:ot=5;break e;case 7:l_(y)?(ot=0,zn=null,Z0(s)):(ot=0,zn=null,So(r,s,y,7));break;case 5:var S=null;switch(qe.tag){case 26:S=qe.memoizedState;case 5:case 27:var M=qe;if(S?Lv(S):M.stateNode.complete){ot=0,zn=null;var K=M.sibling;if(K!==null)qe=K;else{var se=M.return;se!==null?(qe=se,bd(se)):qe=null}break t}}ot=0,zn=null,So(r,s,y,5);break;case 6:ot=0,zn=null,So(r,s,y,6);break;case 8:Pm(),Rt=6;break e;default:throw Error(i(462))}}b1();break}catch(de){$0(r,de)}while(!0);return pi=fa=null,B.H=c,B.A=p,it=o,qe!==null?0:(mt=null,Qe=0,Uu(),Rt)}function b1(){for(;qe!==null&&!ff();)J0(qe)}function J0(r){var s=S0(r.alternate,r,Ti);r.memoizedProps=r.pendingProps,s===null?bd(r):qe=s}function Z0(r){var s=r,o=s.alternate;switch(s.tag){case 15:case 0:s=g0(o,s,s.pendingProps,s.type,void 0,Qe);break;case 11:s=g0(o,s,s.pendingProps,s.type.render,s.ref,Qe);break;case 5:Jf(s);default:w0(o,s),s=qe=Xy(s,Ti),s=S0(o,s,Ti)}r.memoizedProps=r.pendingProps,s===null?bd(r):qe=s}function So(r,s,o,c){pi=fa=null,Jf(s),uo=null,Fl=0;var p=s.return;try{if(l1(r,p,s,o,Qe)){Rt=1,od(r,tr(o,r.current)),qe=null;return}}catch(y){if(p!==null)throw qe=p,y;Rt=1,od(r,tr(o,r.current)),qe=null;return}s.flags&32768?(Xe||c===1?r=!0:_o||(Qe&536870912)!==0?r=!1:(us=r=!0,(c===2||c===9||c===3||c===6)&&(c=Un.current,c!==null&&c.tag===13&&(c.flags|=16384))),ev(s,r)):bd(s)}function bd(r){var s=r;do{if((s.flags&32768)!==0){ev(s,us);return}r=s.return;var o=d1(s.alternate,s,Ti);if(o!==null){qe=o;return}if(s=s.sibling,s!==null){qe=s;return}qe=s=r}while(s!==null);Rt===0&&(Rt=5)}function ev(r,s){do{var o=h1(r.alternate,r);if(o!==null){o.flags&=32767,qe=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(r=r.sibling,r!==null)){qe=r;return}qe=r=o}while(r!==null);Rt=6,qe=null}function tv(r,s,o,c,p,y,S,M,K){r.cancelPendingCommit=null;do Ed();while(Kt!==0);if((it&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=Tf,gf(r,o,y,S,M,K),r===mt&&(qe=mt=null,Qe=0),bo=s,fs=r,Ai=o,Mm=y,km=p,G0=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,w1(Gi,function(){return av(),null})):(r.callbackNode=null,r.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=B.T,B.T=null,p=q.p,q.p=2,S=it,it|=4;try{f1(r,s,o)}finally{it=S,q.p=p,B.T=c}}Kt=1,nv(),rv(),iv()}}function nv(){if(Kt===1){Kt=0;var r=fs,s=bo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=B.T,B.T=null;var c=q.p;q.p=2;var p=it;it|=4;try{P0(s,r);var y=Ym,S=Fy(r.containerInfo),M=y.focusedElem,K=y.selectionRange;if(S!==M&&M&&M.ownerDocument&&zy(M.ownerDocument.documentElement,M)){if(K!==null&&bf(M)){var se=K.start,de=K.end;if(de===void 0&&(de=se),"selectionStart"in M)M.selectionStart=se,M.selectionEnd=Math.min(de,M.value.length);else{var pe=M.ownerDocument||document,oe=pe&&pe.defaultView||window;if(oe.getSelection){var ue=oe.getSelection(),we=M.textContent.length,Oe=Math.min(K.start,we),ht=K.end===void 0?Oe:Math.min(K.end,we);!ue.extend&&Oe>ht&&(S=ht,ht=Oe,Oe=S);var Z=By(M,Oe),Y=By(M,ht);if(Z&&Y&&(ue.rangeCount!==1||ue.anchorNode!==Z.node||ue.anchorOffset!==Z.offset||ue.focusNode!==Y.node||ue.focusOffset!==Y.offset)){var ie=pe.createRange();ie.setStart(Z.node,Z.offset),ue.removeAllRanges(),Oe>ht?(ue.addRange(ie),ue.extend(Y.node,Y.offset)):(ie.setEnd(Y.node,Y.offset),ue.addRange(ie))}}}}for(pe=[],ue=M;ue=ue.parentNode;)ue.nodeType===1&&pe.push({element:ue,left:ue.scrollLeft,top:ue.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<pe.length;M++){var me=pe[M];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}Md=!!$m,Ym=$m=null}finally{it=p,q.p=c,B.T=o}}r.current=s,Kt=2}}function rv(){if(Kt===2){Kt=0;var r=fs,s=bo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=B.T,B.T=null;var c=q.p;q.p=2;var p=it;it|=4;try{O0(r,s.alternate,s)}finally{it=p,q.p=c,B.T=o}}Kt=3}}function iv(){if(Kt===4||Kt===3){Kt=0,du();var r=fs,s=bo,o=Ai,c=G0;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Kt=5:(Kt=0,bo=fs=null,sv(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&(hs=null),ci(o),s=s.stateNode,rn&&typeof rn.onCommitFiberRoot=="function")try{rn.onCommitFiberRoot(fr,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=B.T,p=q.p,q.p=2,B.T=null;try{for(var y=r.onRecoverableError,S=0;S<c.length;S++){var M=c[S];y(M.value,{componentStack:M.stack})}}finally{B.T=s,q.p=p}}(Ai&3)!==0&&Ed(),Wr(r),p=r.pendingLanes,(o&261930)!==0&&(p&42)!==0?r===Nm?sc++:(sc=0,Nm=r):sc=0,ac(0)}}function sv(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,Bl(s)))}function Ed(){return nv(),rv(),iv(),av()}function av(){if(Kt!==5)return!1;var r=fs,s=Mm;Mm=0;var o=ci(Ai),c=B.T,p=q.p;try{q.p=32>o?32:o,B.T=null,o=km,km=null;var y=fs,S=Ai;if(Kt=0,bo=fs=null,Ai=0,(it&6)!==0)throw Error(i(331));var M=it;if(it|=4,z0(y.current),L0(y,y.current,S,o),it=M,ac(0,!1),rn&&typeof rn.onPostCommitFiberRoot=="function")try{rn.onPostCommitFiberRoot(fr,y)}catch{}return!0}finally{q.p=p,B.T=c,sv(r,s)}}function ov(r,s,o){s=tr(o,s),s=fm(r.stateNode,s,2),r=as(r,s,2),r!==null&&(Ws(r,2),Wr(r))}function lt(r,s,o){if(r.tag===3)ov(r,r,o);else for(;s!==null;){if(s.tag===3){ov(s,r,o);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(hs===null||!hs.has(c))){r=tr(o,r),o=l0(2),c=as(s,o,2),c!==null&&(c0(o,c,s,r),Ws(c,2),Wr(c));break}}s=s.return}}function Lm(r,s,o){var c=r.pingCache;if(c===null){c=r.pingCache=new g1;var p=new Set;c.set(s,p)}else p=c.get(s),p===void 0&&(p=new Set,c.set(s,p));p.has(o)||(Im=!0,p.add(o),r=E1.bind(null,r,s,o),s.then(r,r))}function E1(r,s,o){var c=r.pingCache;c!==null&&c.delete(s),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,mt===r&&(Qe&o)===o&&(Rt===4||Rt===3&&(Qe&62914560)===Qe&&300>En()-pd?(it&2)===0&&Eo(r,0):Om|=o,vo===Qe&&(vo=0)),Wr(r)}function lv(r,s){s===0&&(s=yu()),r=ua(r,s),r!==null&&(Ws(r,s),Wr(r))}function S1(r){var s=r.memoizedState,o=0;s!==null&&(o=s.retryLane),lv(r,o)}function x1(r,s){var o=0;switch(r.tag){case 31:case 13:var c=r.stateNode,p=r.memoizedState;p!==null&&(o=p.retryLane);break;case 19:c=r.stateNode;break;case 22:c=r.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(s),lv(r,o)}function w1(r,s){return wt(r,s)}var Sd=null,xo=null,Um=!1,xd=!1,Bm=!1,ps=0;function Wr(r){r!==xo&&r.next===null&&(xo===null?Sd=xo=r:xo=xo.next=r),xd=!0,Um||(Um=!0,A1())}function ac(r,s){if(!Bm&&xd){Bm=!0;do for(var o=!1,c=Sd;c!==null;){if(r!==0){var p=c.pendingLanes;if(p===0)var y=0;else{var S=c.suspendedLanes,M=c.pingedLanes;y=(1<<31-Dt(42|r)+1)-1,y&=p&~(S&~M),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,hv(c,y))}else y=Qe,y=jr(c,c===mt?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(y&3)===0||mr(c,y)||(o=!0,hv(c,y));c=c.next}while(o);Bm=!1}}function T1(){cv()}function cv(){xd=Um=!1;var r=0;ps!==0&&P1()&&(r=ps);for(var s=En(),o=null,c=Sd;c!==null;){var p=c.next,y=uv(c,s);y===0?(c.next=null,o===null?Sd=p:o.next=p,p===null&&(xo=o)):(o=c,(r!==0||(y&3)!==0)&&(xd=!0)),c=p}Kt!==0&&Kt!==5||ac(r),ps!==0&&(ps=0)}function uv(r,s){for(var o=r.suspendedLanes,c=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var S=31-Dt(y),M=1<<S,K=p[S];K===-1?((M&o)===0||(M&c)!==0)&&(p[S]=pf(M,s)):K<=s&&(r.expiredLanes|=M),y&=~M}if(s=mt,o=Qe,o=jr(r,r===s?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c=r.callbackNode,o===0||r===s&&(ot===2||ot===9)||r.cancelPendingCommit!==null)return c!==null&&c!==null&&qi(c),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||mr(r,o)){if(s=o&-o,s===r.callbackPriority)return s;switch(c!==null&&qi(c),ci(o)){case 2:case 8:o=gl;break;case 32:o=Gi;break;case 268435456:o=hu;break;default:o=Gi}return c=dv.bind(null,r),o=wt(o,c),r.callbackPriority=s,r.callbackNode=o,s}return c!==null&&c!==null&&qi(c),r.callbackPriority=2,r.callbackNode=null,2}function dv(r,s){if(Kt!==0&&Kt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(Ed()&&r.callbackNode!==o)return null;var c=Qe;return c=jr(r,r===mt?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c===0?null:(Q0(r,c,s),uv(r,En()),r.callbackNode!=null&&r.callbackNode===o?dv.bind(null,r):null)}function hv(r,s){if(Ed())return null;Q0(r,s,!0)}function A1(){L1(function(){(it&6)!==0?wt(pl,T1):cv()})}function zm(){if(ps===0){var r=oo;r===0&&(r=Ir,Ir<<=1,(Ir&261888)===0&&(Ir=256)),ps=r}return ps}function fv(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Qa(""+r)}function mv(r,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,r.id&&o.setAttribute("form",r.id),s.parentNode.insertBefore(o,s),r=new FormData(r),o.parentNode.removeChild(o),r}function C1(r,s,o,c,p){if(s==="submit"&&o&&o.stateNode===p){var y=fv((p[Xt]||null).action),S=c.submitter;S&&(s=(s=S[Xt]||null)?fv(s.formAction):S.getAttribute("formAction"),s!==null&&(y=s,S=null));var M=new qr("action","action",null,c,p);r.push({event:M,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(ps!==0){var K=S?mv(p,S):new FormData(p);om(o,{pending:!0,data:K,method:p.method,action:y},null,K)}}else typeof y=="function"&&(M.preventDefault(),K=S?mv(p,S):new FormData(p),om(o,{pending:!0,data:K,method:p.method,action:y},y,K))},currentTarget:p}]})}}for(var Fm=0;Fm<wf.length;Fm++){var qm=wf[Fm],R1=qm.toLowerCase(),D1=qm[0].toUpperCase()+qm.slice(1);Sr(R1,"on"+D1)}Sr(Hy,"onAnimationEnd"),Sr(Qy,"onAnimationIteration"),Sr(Ky,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(HT,"onTransitionRun"),Sr(QT,"onTransitionStart"),Sr(KT,"onTransitionCancel"),Sr($y,"onTransitionEnd"),Ur("onMouseEnter",["mouseout","mouseover"]),Ur("onMouseLeave",["mouseout","mouseover"]),Ur("onPointerEnter",["pointerout","pointerover"]),Ur("onPointerLeave",["pointerout","pointerover"]),Lr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Lr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Lr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Lr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Lr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Lr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(oc));function pv(r,s){s=(s&4)!==0;for(var o=0;o<r.length;o++){var c=r[o],p=c.event;c=c.listeners;e:{var y=void 0;if(s)for(var S=c.length-1;0<=S;S--){var M=c[S],K=M.instance,se=M.currentTarget;if(M=M.listener,K!==y&&p.isPropagationStopped())break e;y=M,p.currentTarget=se;try{y(p)}catch(de){Lu(de)}p.currentTarget=null,y=K}else for(S=0;S<c.length;S++){if(M=c[S],K=M.instance,se=M.currentTarget,M=M.listener,K!==y&&p.isPropagationStopped())break e;y=M,p.currentTarget=se;try{y(p)}catch(de){Lu(de)}p.currentTarget=null,y=K}}}}function Ge(r,s){var o=s[za];o===void 0&&(o=s[za]=new Set);var c=r+"__bubble";o.has(c)||(gv(s,r,2,!1),o.add(c))}function Gm(r,s,o){var c=0;s&&(c|=4),gv(o,r,c,s)}var wd="_reactListening"+Math.random().toString(36).slice(2);function Hm(r){if(!r[wd]){r[wd]=!0,vl.forEach(function(o){o!=="selectionchange"&&(I1.has(o)||Gm(o,!1,r),Gm(o,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[wd]||(s[wd]=!0,Gm("selectionchange",!1,s))}}function gv(r,s,o,c){switch(Hv(s)){case 2:var p=iA;break;case 8:p=sA;break;default:p=ap}o=p.bind(null,s,o,r),p=void 0,!na||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),c?p!==void 0?r.addEventListener(s,o,{capture:!0,passive:p}):r.addEventListener(s,o,!0):p!==void 0?r.addEventListener(s,o,{passive:p}):r.addEventListener(s,o,!1)}function Qm(r,s,o,c,p){var y=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var M=c.stateNode.containerInfo;if(M===p)break;if(S===4)for(S=c.return;S!==null;){var K=S.tag;if((K===3||K===4)&&S.stateNode.containerInfo===p)return;S=S.return}for(;M!==null;){if(S=Pr(M),S===null)return;if(K=S.tag,K===5||K===6||K===26||K===27){c=y=S;continue e}M=M.parentNode}}c=c.return}Wi(function(){var se=y,de=Xn(o),pe=[];e:{var oe=Yy.get(r);if(oe!==void 0){var ue=qr,we=r;switch(r){case"keypress":if(ia(o)===0)break e;case"keydown":case"keyup":ue=Nu;break;case"focusin":we="focus",ue=aa;break;case"focusout":we="blur",ue=aa;break;case"beforeblur":case"afterblur":ue=aa;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=jl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=Au;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=b;break;case Hy:case Qy:case Ky:ue=Ru;break;case $y:ue=V;break;case"scroll":case"scrollend":ue=Ol;break;case"wheel":ue=ce;break;case"copy":case"cut":case"paste":ue=Du;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=hi;break;case"toggle":case"beforetoggle":ue=Le}var Oe=(s&4)!==0,ht=!Oe&&(r==="scroll"||r==="scrollend"),Z=Oe?oe!==null?oe+"Capture":null:oe;Oe=[];for(var Y=se,ie;Y!==null;){var me=Y;if(ie=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||ie===null||Z===null||(me=_r(Y,Z),me!=null&&Oe.push(lc(Y,me,ie))),ht)break;Y=Y.return}0<Oe.length&&(oe=new ue(oe,we,null,o,de),pe.push({event:oe,listeners:Oe}))}}if((s&7)===0){e:{if(oe=r==="mouseover"||r==="pointerover",ue=r==="mouseout"||r==="pointerout",oe&&o!==Rl&&(we=o.relatedTarget||o.fromElement)&&(Pr(we)||we[kr]))break e;if((ue||oe)&&(oe=de.window===de?de:(oe=de.ownerDocument)?oe.defaultView||oe.parentWindow:window,ue?(we=o.relatedTarget||o.toElement,ue=se,we=we?Pr(we):null,we!==null&&(ht=l(we),Oe=we.tag,we!==ht||Oe!==5&&Oe!==27&&Oe!==6)&&(we=null)):(ue=null,we=se),ue!==we)){if(Oe=jl,me="onMouseLeave",Z="onMouseEnter",Y="mouse",(r==="pointerout"||r==="pointerover")&&(Oe=hi,me="onPointerLeave",Z="onPointerEnter",Y="pointer"),ht=ue==null?oe:Nn(ue),ie=we==null?oe:Nn(we),oe=new Oe(me,Y+"leave",ue,o,de),oe.target=ht,oe.relatedTarget=ie,me=null,Pr(de)===se&&(Oe=new Oe(Z,Y+"enter",we,o,de),Oe.target=ie,Oe.relatedTarget=ht,me=Oe),ht=me,ue&&we)t:{for(Oe=O1,Z=ue,Y=we,ie=0,me=Z;me;me=Oe(me))ie++;me=0;for(var De=Y;De;De=Oe(De))me++;for(;0<ie-me;)Z=Oe(Z),ie--;for(;0<me-ie;)Y=Oe(Y),me--;for(;ie--;){if(Z===Y||Y!==null&&Z===Y.alternate){Oe=Z;break t}Z=Oe(Z),Y=Oe(Y)}Oe=null}else Oe=null;ue!==null&&yv(pe,oe,ue,Oe,!1),we!==null&&ht!==null&&yv(pe,ht,we,Oe,!0)}}e:{if(oe=se?Nn(se):window,ue=oe.nodeName&&oe.nodeName.toLowerCase(),ue==="select"||ue==="input"&&oe.type==="file")var et=ky;else if(jy(oe))if(Ny)et=FT;else{et=BT;var Ce=UT}else ue=oe.nodeName,!ue||ue.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?se&&Ha(se.elementType)&&(et=ky):et=zT;if(et&&(et=et(r,se))){My(pe,et,o,de);break e}Ce&&Ce(r,oe,se),r==="focusout"&&se&&oe.type==="number"&&se.memoizedProps.value!=null&&Tl(oe,"number",oe.value)}switch(Ce=se?Nn(se):window,r){case"focusin":(jy(Ce)||Ce.contentEditable==="true")&&(Za=Ce,Ef=se,Vl=null);break;case"focusout":Vl=Ef=Za=null;break;case"mousedown":Sf=!0;break;case"contextmenu":case"mouseup":case"dragend":Sf=!1,qy(pe,o,de);break;case"selectionchange":if(GT)break;case"keydown":case"keyup":qy(pe,o,de)}var ze;if(rt)e:{switch(r){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else Ja?oa(r,o)&&(Ke="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ke="onCompositionStart");Ke&&(Qr&&o.locale!=="ko"&&(Ja||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&Ja&&(ze=Il()):(Fr=de,Dl="value"in Fr?Fr.value:Fr.textContent,Ja=!0)),Ce=Td(se,Ke),0<Ce.length&&(Ke=new Hr(Ke,r,null,o,de),pe.push({event:Ke,listeners:Ce}),ze?Ke.data=ze:(ze=Xa(o),ze!==null&&(Ke.data=ze)))),(ze=Zn?NT(r,o):PT(r,o))&&(Ke=Td(se,"onBeforeInput"),0<Ke.length&&(Ce=new Hr("onBeforeInput","beforeinput",null,o,de),pe.push({event:Ce,listeners:Ke}),Ce.data=ze)),C1(pe,r,se,o,de)}pv(pe,s)})}function lc(r,s,o){return{instance:r,listener:s,currentTarget:o}}function Td(r,s){for(var o=s+"Capture",c=[];r!==null;){var p=r,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=_r(r,o),p!=null&&c.unshift(lc(r,p,y)),p=_r(r,s),p!=null&&c.push(lc(r,p,y))),r.tag===3)return c;r=r.return}return[]}function O1(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function yv(r,s,o,c,p){for(var y=s._reactName,S=[];o!==null&&o!==c;){var M=o,K=M.alternate,se=M.stateNode;if(M=M.tag,K!==null&&K===c)break;M!==5&&M!==26&&M!==27||se===null||(K=se,p?(se=_r(o,y),se!=null&&S.unshift(lc(o,se,K))):p||(se=_r(o,y),se!=null&&S.push(lc(o,se,K)))),o=o.return}S.length!==0&&r.push({event:s,listeners:S})}var j1=/\r\n?/g,M1=/\u0000|\uFFFD/g;function _v(r){return(typeof r=="string"?r:""+r).replace(j1,`
`).replace(M1,"")}function vv(r,s){return s=_v(s),_v(r)===s}function dt(r,s,o,c,p,y){switch(o){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||An(r,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&An(r,""+c);break;case"className":Pn(r,"class",c);break;case"tabIndex":Pn(r,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Pn(r,o,c);break;case"style":Cl(r,c,y);break;case"data":if(s!=="object"){Pn(r,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||o!=="href")){r.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(o);break}c=Qa(""+c),r.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&dt(r,s,"name",p.name,p,null),dt(r,s,"formEncType",p.formEncType,p,null),dt(r,s,"formMethod",p.formMethod,p,null),dt(r,s,"formTarget",p.formTarget,p,null)):(dt(r,s,"encType",p.encType,p,null),dt(r,s,"method",p.method,p,null),dt(r,s,"target",p.target,p,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(o);break}c=Qa(""+c),r.setAttribute(o,c);break;case"onClick":c!=null&&(r.onclick=yr);break;case"onScroll":c!=null&&Ge("scroll",r);break;case"onScrollEnd":c!=null&&Ge("scrollend",r);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"multiple":r.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":r.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){r.removeAttribute("xlink:href");break}o=Qa(""+c),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,""+c):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":c===!0?r.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,c):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?r.setAttribute(o,c):r.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?r.removeAttribute(o):r.setAttribute(o,c);break;case"popover":Ge("beforetoggle",r),Ge("toggle",r),qa(r,"popover",c);break;case"xlinkActuate":Lt(r,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Lt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Lt(r,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Lt(r,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Lt(r,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Lt(r,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Lt(r,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Lt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Lt(r,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":qa(r,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Tu.get(o)||o,qa(r,o,c))}}function Km(r,s,o,c,p,y){switch(o){case"style":Cl(r,c,y);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"children":typeof c=="string"?An(r,c):(typeof c=="number"||typeof c=="bigint")&&An(r,""+c);break;case"onScroll":c!=null&&Ge("scroll",r);break;case"onScrollEnd":c!=null&&Ge("scrollend",r);break;case"onClick":c!=null&&(r.onclick=yr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!bl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),s=o.slice(2,p?o.length-7:void 0),y=r[Xt]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(s,y,p),typeof c=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(s,c,p);break e}o in r?r[o]=c:c===!0?r.setAttribute(o,""):qa(r,o,c)}}}function cn(r,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",r),Ge("load",r);var c=!1,p=!1,y;for(y in o)if(o.hasOwnProperty(y)){var S=o[y];if(S!=null)switch(y){case"src":c=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:dt(r,s,y,S,o,null)}}p&&dt(r,s,"srcSet",o.srcSet,o,null),c&&dt(r,s,"src",o.src,o,null);return;case"input":Ge("invalid",r);var M=y=S=p=null,K=null,se=null;for(c in o)if(o.hasOwnProperty(c)){var de=o[c];if(de!=null)switch(c){case"name":p=de;break;case"type":S=de;break;case"checked":K=de;break;case"defaultChecked":se=de;break;case"value":y=de;break;case"defaultValue":M=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,s));break;default:dt(r,s,c,de,o,null)}}Su(r,y,M,K,se,S,p,!1);return;case"select":Ge("invalid",r),c=S=y=null;for(p in o)if(o.hasOwnProperty(p)&&(M=o[p],M!=null))switch(p){case"value":y=M;break;case"defaultValue":S=M;break;case"multiple":c=M;default:dt(r,s,p,M,o,null)}s=y,o=S,r.multiple=!!c,s!=null?Qi(r,!!c,s,!1):o!=null&&Qi(r,!!c,o,!0);return;case"textarea":Ge("invalid",r),y=p=c=null;for(S in o)if(o.hasOwnProperty(S)&&(M=o[S],M!=null))switch(S){case"value":c=M;break;case"defaultValue":p=M;break;case"children":y=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(i(91));break;default:dt(r,s,S,M,o,null)}Ki(r,c,p,y);return;case"option":for(K in o)o.hasOwnProperty(K)&&(c=o[K],c!=null)&&(K==="selected"?r.selected=c&&typeof c!="function"&&typeof c!="symbol":dt(r,s,K,c,o,null));return;case"dialog":Ge("beforetoggle",r),Ge("toggle",r),Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":Ge("load",r);break;case"video":case"audio":for(c=0;c<oc.length;c++)Ge(oc[c],r);break;case"image":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"embed":case"source":case"link":Ge("error",r),Ge("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in o)if(o.hasOwnProperty(se)&&(c=o[se],c!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:dt(r,s,se,c,o,null)}return;default:if(Ha(s)){for(de in o)o.hasOwnProperty(de)&&(c=o[de],c!==void 0&&Km(r,s,de,c,o,void 0));return}}for(M in o)o.hasOwnProperty(M)&&(c=o[M],c!=null&&dt(r,s,M,c,o,null))}function k1(r,s,o,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,S=null,M=null,K=null,se=null,de=null;for(ue in o){var pe=o[ue];if(o.hasOwnProperty(ue)&&pe!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":K=pe;default:c.hasOwnProperty(ue)||dt(r,s,ue,null,c,pe)}}for(var oe in c){var ue=c[oe];if(pe=o[oe],c.hasOwnProperty(oe)&&(ue!=null||pe!=null))switch(oe){case"type":y=ue;break;case"name":p=ue;break;case"checked":se=ue;break;case"defaultChecked":de=ue;break;case"value":S=ue;break;case"defaultValue":M=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(i(137,s));break;default:ue!==pe&&dt(r,s,oe,ue,c,pe)}}Ga(r,S,M,K,se,de,y,p);return;case"select":ue=S=M=oe=null;for(y in o)if(K=o[y],o.hasOwnProperty(y)&&K!=null)switch(y){case"value":break;case"multiple":ue=K;default:c.hasOwnProperty(y)||dt(r,s,y,null,c,K)}for(p in c)if(y=c[p],K=o[p],c.hasOwnProperty(p)&&(y!=null||K!=null))switch(p){case"value":oe=y;break;case"defaultValue":M=y;break;case"multiple":S=y;default:y!==K&&dt(r,s,p,y,c,K)}s=M,o=S,c=ue,oe!=null?Qi(r,!!o,oe,!1):!!c!=!!o&&(s!=null?Qi(r,!!o,s,!0):Qi(r,!!o,o?[]:"",!1));return;case"textarea":ue=oe=null;for(M in o)if(p=o[M],o.hasOwnProperty(M)&&p!=null&&!c.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:dt(r,s,M,null,c,p)}for(S in c)if(p=c[S],y=o[S],c.hasOwnProperty(S)&&(p!=null||y!=null))switch(S){case"value":oe=p;break;case"defaultValue":ue=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==y&&dt(r,s,S,p,c,y)}xu(r,oe,ue);return;case"option":for(var we in o)oe=o[we],o.hasOwnProperty(we)&&oe!=null&&!c.hasOwnProperty(we)&&(we==="selected"?r.selected=!1:dt(r,s,we,null,c,oe));for(K in c)oe=c[K],ue=o[K],c.hasOwnProperty(K)&&oe!==ue&&(oe!=null||ue!=null)&&(K==="selected"?r.selected=oe&&typeof oe!="function"&&typeof oe!="symbol":dt(r,s,K,oe,c,ue));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Oe in o)oe=o[Oe],o.hasOwnProperty(Oe)&&oe!=null&&!c.hasOwnProperty(Oe)&&dt(r,s,Oe,null,c,oe);for(se in c)if(oe=c[se],ue=o[se],c.hasOwnProperty(se)&&oe!==ue&&(oe!=null||ue!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,s));break;default:dt(r,s,se,oe,c,ue)}return;default:if(Ha(s)){for(var ht in o)oe=o[ht],o.hasOwnProperty(ht)&&oe!==void 0&&!c.hasOwnProperty(ht)&&Km(r,s,ht,void 0,c,oe);for(de in c)oe=c[de],ue=o[de],!c.hasOwnProperty(de)||oe===ue||oe===void 0&&ue===void 0||Km(r,s,de,oe,c,ue);return}}for(var Z in o)oe=o[Z],o.hasOwnProperty(Z)&&oe!=null&&!c.hasOwnProperty(Z)&&dt(r,s,Z,null,c,oe);for(pe in c)oe=c[pe],ue=o[pe],!c.hasOwnProperty(pe)||oe===ue||oe==null&&ue==null||dt(r,s,pe,oe,c,ue)}function bv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function N1(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var p=o[c],y=p.transferSize,S=p.initiatorType,M=p.duration;if(y&&M&&bv(S)){for(S=0,M=p.responseEnd,c+=1;c<o.length;c++){var K=o[c],se=K.startTime;if(se>M)break;var de=K.transferSize,pe=K.initiatorType;de&&bv(pe)&&(K=K.responseEnd,S+=de*(K<M?1:(M-se)/(K-se)))}if(--c,s+=8*(y+S)/(p.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var $m=null,Ym=null;function Ad(r){return r.nodeType===9?r:r.ownerDocument}function Ev(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Sv(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function Wm(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Xm=null;function P1(){var r=window.event;return r&&r.type==="popstate"?r===Xm?!1:(Xm=r,!0):(Xm=null,!1)}var xv=typeof setTimeout=="function"?setTimeout:void 0,V1=typeof clearTimeout=="function"?clearTimeout:void 0,wv=typeof Promise=="function"?Promise:void 0,L1=typeof queueMicrotask=="function"?queueMicrotask:typeof wv<"u"?function(r){return wv.resolve(null).then(r).catch(U1)}:xv;function U1(r){setTimeout(function(){throw r})}function gs(r){return r==="head"}function Tv(r,s){var o=s,c=0;do{var p=o.nextSibling;if(r.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(c===0){r.removeChild(p),Co(s);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")cc(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,cc(o);for(var y=o.firstChild;y;){var S=y.nextSibling,M=y.nodeName;y[Nr]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=S}}else o==="body"&&cc(r.ownerDocument.body);o=p}while(o);Co(s)}function Av(r,s){var o=r;r=0;do{var c=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=c}while(o)}function Jm(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Jm(o),Fa(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function B1(r,s,o,c){for(;r.nodeType===1;){var p=o;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(c){if(!r[Nr])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=ar(r.nextSibling),r===null)break}return null}function z1(r,s,o){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=ar(r.nextSibling),r===null))return null;return r}function Cv(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=ar(r.nextSibling),r===null))return null;return r}function Zm(r){return r.data==="$?"||r.data==="$~"}function ep(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function F1(r,s){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||o.readyState!=="loading")s();else{var c=function(){s(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),r._reactRetry=c}}function ar(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var tp=null;function Rv(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(s===0)return ar(r.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}r=r.nextSibling}return null}function Dv(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return r;s--}else o!=="/$"&&o!=="/&"||s++}r=r.previousSibling}return null}function Iv(r,s,o){switch(s=Ad(o),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function cc(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);Fa(r)}var or=new Map,Ov=new Set;function Cd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ci=q.d;q.d={f:q1,r:G1,D:H1,C:Q1,L:K1,m:$1,X:W1,S:Y1,M:X1};function q1(){var r=Ci.f(),s=_d();return r||s}function G1(r){var s=Wn(r);s!==null&&s.tag===5&&s.type==="form"?$_(s):Ci.r(r)}var wo=typeof document>"u"?null:document;function jv(r,s,o){var c=wo;if(c&&typeof s=="string"&&s){var p=Tn(s);p='link[rel="'+r+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),Ov.has(p)||(Ov.add(p),r={rel:r,crossOrigin:o,href:s},c.querySelector(p)===null&&(s=c.createElement("link"),cn(s,"link",r),Vt(s),c.head.appendChild(s)))}}function H1(r){Ci.D(r),jv("dns-prefetch",r,null)}function Q1(r,s){Ci.C(r,s),jv("preconnect",r,s)}function K1(r,s,o){Ci.L(r,s,o);var c=wo;if(c&&r&&s){var p='link[rel="preload"][as="'+Tn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+Tn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+Tn(o.imageSizes)+'"]')):p+='[href="'+Tn(r)+'"]';var y=p;switch(s){case"style":y=To(r);break;case"script":y=Ao(r)}or.has(y)||(r=v({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:r,as:s},o),or.set(y,r),c.querySelector(p)!==null||s==="style"&&c.querySelector(uc(y))||s==="script"&&c.querySelector(dc(y))||(s=c.createElement("link"),cn(s,"link",r),Vt(s),c.head.appendChild(s)))}}function $1(r,s){Ci.m(r,s);var o=wo;if(o&&r){var c=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+Tn(c)+'"][href="'+Tn(r)+'"]',y=p;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Ao(r)}if(!or.has(y)&&(r=v({rel:"modulepreload",href:r},s),or.set(y,r),o.querySelector(p)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(dc(y)))return}c=o.createElement("link"),cn(c,"link",r),Vt(c),o.head.appendChild(c)}}}function Y1(r,s,o){Ci.S(r,s,o);var c=wo;if(c&&r){var p=Vr(c).hoistableStyles,y=To(r);s=s||"default";var S=p.get(y);if(!S){var M={loading:0,preload:null};if(S=c.querySelector(uc(y)))M.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":s},o),(o=or.get(y))&&np(r,o);var K=S=c.createElement("link");Vt(K),cn(K,"link",r),K._p=new Promise(function(se,de){K.onload=se,K.onerror=de}),K.addEventListener("load",function(){M.loading|=1}),K.addEventListener("error",function(){M.loading|=2}),M.loading|=4,Rd(S,s,c)}S={type:"stylesheet",instance:S,count:1,state:M},p.set(y,S)}}}function W1(r,s){Ci.X(r,s);var o=wo;if(o&&r){var c=Vr(o).hoistableScripts,p=Ao(r),y=c.get(p);y||(y=o.querySelector(dc(p)),y||(r=v({src:r,async:!0},s),(s=or.get(p))&&rp(r,s),y=o.createElement("script"),Vt(y),cn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(p,y))}}function X1(r,s){Ci.M(r,s);var o=wo;if(o&&r){var c=Vr(o).hoistableScripts,p=Ao(r),y=c.get(p);y||(y=o.querySelector(dc(p)),y||(r=v({src:r,async:!0,type:"module"},s),(s=or.get(p))&&rp(r,s),y=o.createElement("script"),Vt(y),cn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(p,y))}}function Mv(r,s,o,c){var p=(p=ve.current)?Cd(p):null;if(!p)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=To(o.href),o=Vr(p).hoistableStyles,c=o.get(s),c||(c={type:"style",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=To(o.href);var y=Vr(p).hoistableStyles,S=y.get(r);if(S||(p=p.ownerDocument||p,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,S),(y=p.querySelector(uc(r)))&&!y._p&&(S.instance=y,S.state.loading=5),or.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},or.set(r,o),y||J1(p,r,o,S.state))),s&&c===null)throw Error(i(528,""));return S}if(s&&c!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Ao(o),o=Vr(p).hoistableScripts,c=o.get(s),c||(c={type:"script",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function To(r){return'href="'+Tn(r)+'"'}function uc(r){return'link[rel="stylesheet"]['+r+"]"}function kv(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function J1(r,s,o,c){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=r.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),cn(s,"link",o),Vt(s),r.head.appendChild(s))}function Ao(r){return'[src="'+Tn(r)+'"]'}function dc(r){return"script[async]"+r}function Nv(r,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var c=r.querySelector('style[data-href~="'+Tn(o.href)+'"]');if(c)return s.instance=c,Vt(c),c;var p=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(r.ownerDocument||r).createElement("style"),Vt(c),cn(c,"style",p),Rd(c,o.precedence,r),s.instance=c;case"stylesheet":p=To(o.href);var y=r.querySelector(uc(p));if(y)return s.state.loading|=4,s.instance=y,Vt(y),y;c=kv(o),(p=or.get(p))&&np(c,p),y=(r.ownerDocument||r).createElement("link"),Vt(y);var S=y;return S._p=new Promise(function(M,K){S.onload=M,S.onerror=K}),cn(y,"link",c),s.state.loading|=4,Rd(y,o.precedence,r),s.instance=y;case"script":return y=Ao(o.src),(p=r.querySelector(dc(y)))?(s.instance=p,Vt(p),p):(c=o,(p=or.get(y))&&(c=v({},o),rp(c,p)),r=r.ownerDocument||r,p=r.createElement("script"),Vt(p),cn(p,"link",c),r.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,Rd(c,o.precedence,r));return s.instance}function Rd(r,s,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=c.length?c[c.length-1]:null,y=p,S=0;S<c.length;S++){var M=c[S];if(M.dataset.precedence===s)y=M;else if(y!==p)break}y?y.parentNode.insertBefore(r,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(r,s.firstChild))}function np(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function rp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var Dd=null;function Pv(r,s,o){if(Dd===null){var c=new Map,p=Dd=new Map;p.set(o,c)}else p=Dd,c=p.get(o),c||(c=new Map,p.set(o,c));if(c.has(r))return c;for(c.set(r,null),o=o.getElementsByTagName(r),p=0;p<o.length;p++){var y=o[p];if(!(y[Nr]||y[Pt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var S=y.getAttribute(s)||"";S=r+S;var M=c.get(S);M?M.push(y):c.set(S,[y])}}return c}function Vv(r,s,o){r=r.ownerDocument||r,r.head.insertBefore(o,s==="title"?r.querySelector("head > title"):null)}function Z1(r,s,o){if(o===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Lv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function eA(r,s,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=To(c.href),y=s.querySelector(uc(p));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=Id.bind(r),s.then(r,r)),o.state.loading|=4,o.instance=y,Vt(y);return}y=s.ownerDocument||s,c=kv(c),(p=or.get(p))&&np(c,p),y=y.createElement("link"),Vt(y);var S=y;S._p=new Promise(function(M,K){S.onload=M,S.onerror=K}),cn(y,"link",c),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=Id.bind(r),s.addEventListener("load",o),s.addEventListener("error",o))}}var ip=0;function tA(r,s){return r.stylesheets&&r.count===0&&jd(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var c=setTimeout(function(){if(r.stylesheets&&jd(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+s);0<r.imgBytes&&ip===0&&(ip=62500*N1());var p=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&jd(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>ip?50:800)+s);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(c),clearTimeout(p)}}:null}function Id(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)jd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Od=null;function jd(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Od=new Map,s.forEach(nA,r),Od=null,Id.call(r))}function nA(r,s){if(!(s.state.loading&4)){var o=Od.get(r);if(o)var c=o.get(null);else{o=new Map,Od.set(r,o);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var S=p[y];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(o.set(S.dataset.precedence,S),c=S)}c&&o.set(null,c)}p=s.instance,S=p.getAttribute("data-precedence"),y=o.get(S)||c,y===c&&o.set(null,p),o.set(S,p),this.count++,c=Id.bind(this),p.addEventListener("load",c),p.addEventListener("error",c),y?y.parentNode.insertBefore(p,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),s.state.loading|=4}}var hc={$$typeof:z,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function rA(r,s,o,c,p,y,S,M,K){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Mr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mr(0),this.hiddenUpdates=Mr(null),this.identifierPrefix=c,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function Uv(r,s,o,c,p,y,S,M,K,se,de,pe){return r=new rA(r,s,o,S,K,se,de,pe,M),s=1,y===!0&&(s|=24),y=Ln(3,null,null,s),r.current=y,y.stateNode=r,s=Vf(),s.refCount++,r.pooledCache=s,s.refCount++,y.memoizedState={element:c,isDehydrated:o,cache:s},zf(y),r}function Bv(r){return r?(r=no,r):no}function zv(r,s,o,c,p,y){p=Bv(p),c.context===null?c.context=p:c.pendingContext=p,c=ss(s),c.payload={element:o},y=y===void 0?null:y,y!==null&&(c.callback=y),o=as(r,c,s),o!==null&&(On(o,r,s),Gl(o,r,s))}function Fv(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<s?o:s}}function sp(r,s){Fv(r,s),(r=r.alternate)&&Fv(r,s)}function qv(r){if(r.tag===13||r.tag===31){var s=ua(r,67108864);s!==null&&On(s,r,67108864),sp(r,67108864)}}function Gv(r){if(r.tag===13||r.tag===31){var s=qn();s=Js(s);var o=ua(r,s);o!==null&&On(o,r,s),sp(r,s)}}var Md=!0;function iA(r,s,o,c){var p=B.T;B.T=null;var y=q.p;try{q.p=2,ap(r,s,o,c)}finally{q.p=y,B.T=p}}function sA(r,s,o,c){var p=B.T;B.T=null;var y=q.p;try{q.p=8,ap(r,s,o,c)}finally{q.p=y,B.T=p}}function ap(r,s,o,c){if(Md){var p=op(c);if(p===null)Qm(r,s,c,kd,o),Qv(r,c);else if(oA(p,r,s,o,c))c.stopPropagation();else if(Qv(r,c),s&4&&-1<aA.indexOf(r)){for(;p!==null;){var y=Wn(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var S=Or(y.pendingLanes);if(S!==0){var M=y;for(M.pendingLanes|=2,M.entangledLanes|=2;S;){var K=1<<31-Dt(S);M.entanglements[1]|=K,S&=~K}Wr(y),(it&6)===0&&(gd=En()+500,ac(0))}}break;case 31:case 13:M=ua(y,2),M!==null&&On(M,y,2),_d(),sp(y,2)}if(y=op(c),y===null&&Qm(r,s,c,kd,o),y===p)break;p=y}p!==null&&c.stopPropagation()}else Qm(r,s,c,null,o)}}function op(r){return r=Xn(r),lp(r)}var kd=null;function lp(r){if(kd=null,r=Pr(r),r!==null){var s=l(r);if(s===null)r=null;else{var o=s.tag;if(o===13){if(r=u(s),r!==null)return r;r=null}else if(o===31){if(r=d(s),r!==null)return r;r=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return kd=r,null}function Hv(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch($s()){case pl:return 2;case gl:return 8;case Gi:case mf:return 32;case hu:return 268435456;default:return 32}default:return 32}}var cp=!1,ys=null,_s=null,vs=null,fc=new Map,mc=new Map,bs=[],aA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Qv(r,s){switch(r){case"focusin":case"focusout":ys=null;break;case"dragenter":case"dragleave":_s=null;break;case"mouseover":case"mouseout":vs=null;break;case"pointerover":case"pointerout":fc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":mc.delete(s.pointerId)}}function pc(r,s,o,c,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:o,eventSystemFlags:c,nativeEvent:y,targetContainers:[p]},s!==null&&(s=Wn(s),s!==null&&qv(s)),r):(r.eventSystemFlags|=c,s=r.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),r)}function oA(r,s,o,c,p){switch(s){case"focusin":return ys=pc(ys,r,s,o,c,p),!0;case"dragenter":return _s=pc(_s,r,s,o,c,p),!0;case"mouseover":return vs=pc(vs,r,s,o,c,p),!0;case"pointerover":var y=p.pointerId;return fc.set(y,pc(fc.get(y)||null,r,s,o,c,p)),!0;case"gotpointercapture":return y=p.pointerId,mc.set(y,pc(mc.get(y)||null,r,s,o,c,p)),!0}return!1}function Kv(r){var s=Pr(r.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=u(o),s!==null){r.blockedOn=s,pr(r.priority,function(){Gv(o)});return}}else if(s===31){if(s=d(o),s!==null){r.blockedOn=s,pr(r.priority,function(){Gv(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Nd(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var o=op(r.nativeEvent);if(o===null){o=r.nativeEvent;var c=new o.constructor(o.type,o);Rl=c,o.target.dispatchEvent(c),Rl=null}else return s=Wn(o),s!==null&&qv(s),r.blockedOn=o,!1;s.shift()}return!0}function $v(r,s,o){Nd(r)&&o.delete(s)}function lA(){cp=!1,ys!==null&&Nd(ys)&&(ys=null),_s!==null&&Nd(_s)&&(_s=null),vs!==null&&Nd(vs)&&(vs=null),fc.forEach($v),mc.forEach($v)}function Pd(r,s){r.blockedOn===s&&(r.blockedOn=null,cp||(cp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,lA)))}var Vd=null;function Yv(r){Vd!==r&&(Vd=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Vd===r&&(Vd=null);for(var s=0;s<r.length;s+=3){var o=r[s],c=r[s+1],p=r[s+2];if(typeof c!="function"){if(lp(c||o)===null)continue;break}var y=Wn(o);y!==null&&(r.splice(s,3),s-=3,om(y,{pending:!0,data:p,method:o.method,action:c},c,p))}}))}function Co(r){function s(K){return Pd(K,r)}ys!==null&&Pd(ys,r),_s!==null&&Pd(_s,r),vs!==null&&Pd(vs,r),fc.forEach(s),mc.forEach(s);for(var o=0;o<bs.length;o++){var c=bs[o];c.blockedOn===r&&(c.blockedOn=null)}for(;0<bs.length&&(o=bs[0],o.blockedOn===null);)Kv(o),o.blockedOn===null&&bs.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var p=o[c],y=o[c+1],S=p[Xt]||null;if(typeof y=="function")S||Yv(o);else if(S){var M=null;if(y&&y.hasAttribute("formAction")){if(p=y,S=y[Xt]||null)M=S.formAction;else if(lp(p)!==null)continue}else M=S.action;typeof M=="function"?o[c+1]=M:(o.splice(c,3),c-=3),Yv(o)}}}function Wv(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(S){return p=S})},focusReset:"manual",scroll:"manual"})}function s(){p!==null&&(p(),p=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,p=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),p!==null&&(p(),p=null)}}}function up(r){this._internalRoot=r}Ld.prototype.render=up.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,c=qn();zv(o,c,r,s,null,null)},Ld.prototype.unmount=up.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;zv(r.current,2,null,r,null,null),_d(),s[kr]=null}};function Ld(r){this._internalRoot=r}Ld.prototype.unstable_scheduleHydration=function(r){if(r){var s=_u();r={blockedOn:null,target:r,priority:s};for(var o=0;o<bs.length&&s!==0&&s<bs[o].priority;o++);bs.splice(o,0,r),o===0&&Kv(r)}};var Xv=e.version;if(Xv!=="19.2.3")throw Error(i(527,Xv,"19.2.3"));q.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=g(s),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var cA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ud=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ud.isDisabled&&Ud.supportsFiber)try{fr=Ud.inject(cA),rn=Ud}catch{}}return yc.createRoot=function(r,s){if(!a(r))throw Error(i(299));var o=!1,c="",p=i0,y=s0,S=a0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(S=s.onRecoverableError)),s=Uv(r,1,!1,null,null,o,c,null,p,y,S,Wv),r[kr]=s.current,Hm(r),new up(s)},yc.hydrateRoot=function(r,s,o){if(!a(r))throw Error(i(299));var c=!1,p="",y=i0,S=s0,M=a0,K=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(S=o.onCaughtError),o.onRecoverableError!==void 0&&(M=o.onRecoverableError),o.formState!==void 0&&(K=o.formState)),s=Uv(r,1,!0,s,o??null,c,p,K,y,S,M,Wv),s.context=Bv(null),o=s.current,c=qn(),c=Js(c),p=ss(c),p.callback=null,as(o,p,c),o=c,s.current.lanes=o,Ws(s,o),Wr(s),r[kr]=s.current,Hm(r),new Ld(s)},yc.version="19.2.3",yc}var ob;function vA(){if(ob)return fp.exports;ob=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),fp.exports=_A(),fp.exports}var bA=vA();var lb="popstate";function EA(t={}){function e(i,a){let{pathname:l,search:u,hash:d}=i.location;return kp("",{pathname:l,search:u,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:Lc(a)}return xA(e,n,null,t)}function xt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ur(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function SA(){return Math.random().toString(36).substring(2,10)}function cb(t,e){return{usr:t.state,key:t.key,idx:e}}function kp(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Jo(e):e,state:n,key:e&&e.key||i||SA()}}function Lc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Jo(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function xA(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,u=a.history,d="POP",f=null,g=_();g==null&&(g=0,u.replaceState({...u.state,idx:g},""));function _(){return(u.state||{idx:null}).idx}function v(){d="POP";let N=_(),U=N==null?null:N-g;g=N,f&&f({action:d,location:I.location,delta:U})}function E(N,U){d="PUSH";let G=kp(I.location,N,U);g=_()+1;let z=cb(G,g),$=I.createHref(G);try{u.pushState(z,"",$)}catch(J){if(J instanceof DOMException&&J.name==="DataCloneError")throw J;a.location.assign($)}l&&f&&f({action:d,location:I.location,delta:1})}function T(N,U){d="REPLACE";let G=kp(I.location,N,U);g=_();let z=cb(G,g),$=I.createHref(G);u.replaceState(z,"",$),l&&f&&f({action:d,location:I.location,delta:0})}function w(N){return wA(N)}let I={get action(){return d},get location(){return t(a,u)},listen(N){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(lb,v),f=N,()=>{a.removeEventListener(lb,v),f=null}},createHref(N){return e(a,N)},createURL:w,encodeLocation(N){let U=w(N);return{pathname:U.pathname,search:U.search,hash:U.hash}},push:E,replace:T,go(N){return u.go(N)}};return I}function wA(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),xt(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Lc(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function mS(t,e,n="/"){return TA(t,e,n,!1)}function TA(t,e,n,i){let a=typeof e=="string"?Jo(e):e,l=Ni(a.pathname||"/",n);if(l==null)return null;let u=pS(t);AA(u);let d=null;for(let f=0;d==null&&f<u.length;++f){let g=VA(l);d=NA(u[f],g,i)}return d}function pS(t,e=[],n=[],i="",a=!1){let l=(u,d,f=a,g)=>{let _={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:d,route:u};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&f)return;xt(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let v=Oi([i,_.relativePath]),E=n.concat(_);u.children&&u.children.length>0&&(xt(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),pS(u.children,e,E,v,f)),!(u.path==null&&!u.index)&&e.push({path:v,score:MA(v,u.index),routesMeta:E})};return t.forEach((u,d)=>{if(u.path===""||!u.path?.includes("?"))l(u,d);else for(let f of gS(u.path))l(u,d,!0,f)}),e}function gS(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let u=gS(i.join("/")),d=[];return d.push(...u.map(f=>f===""?l:[l,f].join("/"))),a&&d.push(...u),d.map(f=>t.startsWith("/")&&f===""?"/":f)}function AA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:kA(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var CA=/^:[\w-]+$/,RA=3,DA=2,IA=1,OA=10,jA=-2,ub=t=>t==="*";function MA(t,e){let n=t.split("/"),i=n.length;return n.some(ub)&&(i+=jA),e&&(i+=DA),n.filter(a=>!ub(a)).reduce((a,l)=>a+(CA.test(l)?RA:l===""?IA:OA),i)}function kA(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function NA(t,e,n=!1){let{routesMeta:i}=t,a={},l="/",u=[];for(let d=0;d<i.length;++d){let f=i[d],g=d===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",v=ch({path:f.relativePath,caseSensitive:f.caseSensitive,end:g},_),E=f.route;if(!v&&g&&n&&!i[i.length-1].route.index&&(v=ch({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},_)),!v)return null;Object.assign(a,v.params),u.push({params:a,pathname:Oi([l,v.pathname]),pathnameBase:zA(Oi([l,v.pathnameBase])),route:E}),v.pathnameBase!=="/"&&(l=Oi([l,v.pathnameBase]))}return u}function ch(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=PA(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],u=l.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:i.reduce((g,{paramName:_,isOptional:v},E)=>{if(_==="*"){let w=d[E]||"";u=l.slice(0,l.length-w.length).replace(/(.)\/+$/,"$1")}const T=d[E];return v&&!T?g[_]=void 0:g[_]=(T||"").replace(/%2F/g,"/"),g},{}),pathname:l,pathnameBase:u,pattern:t}}function PA(t,e=!1,n=!0){ur(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,d,f)=>(i.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function VA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ur(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ni(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var yS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LA=t=>yS.test(t);function UA(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?Jo(t):t,l;if(n)if(LA(n))l=n;else{if(n.includes("//")){let u=n;n=n.replace(/\/\/+/g,"/"),ur(!1,`Pathnames cannot have embedded double slashes - normalizing ${u} -> ${n}`)}n.startsWith("/")?l=db(n.substring(1),"/"):l=db(n,e)}else l=e;return{pathname:l,search:FA(i),hash:qA(a)}}function db(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function yp(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function BA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Sg(t){let e=BA(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function xg(t,e,n,i=!1){let a;typeof t=="string"?a=Jo(t):(a={...t},xt(!a.pathname||!a.pathname.includes("?"),yp("?","pathname","search",a)),xt(!a.pathname||!a.pathname.includes("#"),yp("#","pathname","hash",a)),xt(!a.search||!a.search.includes("#"),yp("#","search","hash",a)));let l=t===""||a.pathname==="",u=l?"/":a.pathname,d;if(u==null)d=n;else{let v=e.length-1;if(!i&&u.startsWith("..")){let E=u.split("/");for(;E[0]==="..";)E.shift(),v-=1;a.pathname=E.join("/")}d=v>=0?e[v]:"/"}let f=UA(a,d),g=u&&u!=="/"&&u.endsWith("/"),_=(l||u===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(g||_)&&(f.pathname+="/"),f}var Oi=t=>t.join("/").replace(/\/\/+/g,"/"),zA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),FA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,qA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,GA=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function HA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function QA(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var _S=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function vS(t,e){let n=t;if(typeof n!="string"||!yS.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if(_S)try{let l=new URL(window.location.href),u=n.startsWith("//")?new URL(l.protocol+n):new URL(n),d=Ni(u.pathname,e);u.origin===l.origin&&d!=null?n=d+u.search+u.hash:a=!0}catch{ur(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var bS=["POST","PUT","PATCH","DELETE"];new Set(bS);var KA=["GET",...bS];new Set(KA);var Zo=O.createContext(null);Zo.displayName="DataRouter";var Vh=O.createContext(null);Vh.displayName="DataRouterState";var $A=O.createContext(!1),ES=O.createContext({isTransitioning:!1});ES.displayName="ViewTransition";var YA=O.createContext(new Map);YA.displayName="Fetchers";var WA=O.createContext(null);WA.displayName="Await";var Qn=O.createContext(null);Qn.displayName="Navigation";var $c=O.createContext(null);$c.displayName="Location";var dr=O.createContext({outlet:null,matches:[],isDataRoute:!1});dr.displayName="Route";var wg=O.createContext(null);wg.displayName="RouteError";var SS="REACT_ROUTER_ERROR",XA="REDIRECT",JA="ROUTE_ERROR_RESPONSE";function ZA(t){if(t.startsWith(`${SS}:${XA}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function eC(t){if(t.startsWith(`${SS}:${JA}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new GA(e.status,e.statusText,e.data)}catch{}}function tC(t,{relative:e}={}){xt(el(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=O.useContext(Qn),{hash:a,pathname:l,search:u}=Yc(t,{relative:e}),d=l;return n!=="/"&&(d=l==="/"?n:Oi([n,l])),i.createHref({pathname:d,search:u,hash:a})}function el(){return O.useContext($c)!=null}function hr(){return xt(el(),"useLocation() may be used only in the context of a <Router> component."),O.useContext($c).location}var xS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function wS(t){O.useContext(Qn).static||O.useLayoutEffect(t)}function Lh(){let{isDataRoute:t}=O.useContext(dr);return t?yC():nC()}function nC(){xt(el(),"useNavigate() may be used only in the context of a <Router> component.");let t=O.useContext(Zo),{basename:e,navigator:n}=O.useContext(Qn),{matches:i}=O.useContext(dr),{pathname:a}=hr(),l=JSON.stringify(Sg(i)),u=O.useRef(!1);return wS(()=>{u.current=!0}),O.useCallback((f,g={})=>{if(ur(u.current,xS),!u.current)return;if(typeof f=="number"){n.go(f);return}let _=xg(f,JSON.parse(l),a,g.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:Oi([e,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[e,n,l,a,t])}var rC=O.createContext(null);function iC(t){let e=O.useContext(dr).outlet;return O.useMemo(()=>e&&O.createElement(rC.Provider,{value:t},e),[e,t])}function sC(){let{matches:t}=O.useContext(dr),e=t[t.length-1];return e?e.params:{}}function Yc(t,{relative:e}={}){let{matches:n}=O.useContext(dr),{pathname:i}=hr(),a=JSON.stringify(Sg(n));return O.useMemo(()=>xg(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function aC(t,e){return TS(t,e)}function TS(t,e,n,i,a){xt(el(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=O.useContext(Qn),{matches:u}=O.useContext(dr),d=u[u.length-1],f=d?d.params:{},g=d?d.pathname:"/",_=d?d.pathnameBase:"/",v=d&&d.route;{let G=v&&v.path||"";CS(g,!v||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let E=hr(),T;if(e){let G=typeof e=="string"?Jo(e):e;xt(_==="/"||G.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${G.pathname}" was given in the \`location\` prop.`),T=G}else T=E;let w=T.pathname||"/",I=w;if(_!=="/"){let G=_.replace(/^\//,"").split("/");I="/"+w.replace(/^\//,"").split("/").slice(G.length).join("/")}let N=mS(t,{pathname:I});ur(v||N!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),ur(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let U=dC(N&&N.map(G=>Object.assign({},G,{params:Object.assign({},f,G.params),pathname:Oi([_,l.encodeLocation?l.encodeLocation(G.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?_:Oi([_,l.encodeLocation?l.encodeLocation(G.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathnameBase])})),u,n,i,a);return e&&U?O.createElement($c.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},U):U}function oC(){let t=gC(),e=HA(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=O.createElement(O.Fragment,null,O.createElement("p",null," Hey developer "),O.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",O.createElement("code",{style:l},"ErrorBoundary")," or"," ",O.createElement("code",{style:l},"errorElement")," prop on your route.")),O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},e),n?O.createElement("pre",{style:a},n):null,u)}var lC=O.createElement(oC,null),AS=class extends O.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=eC(t.digest);n&&(t=n)}let e=t!==void 0?O.createElement(dr.Provider,{value:this.props.routeContext},O.createElement(wg.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?O.createElement(cC,{error:t},e):e}};AS.contextType=$A;var _p=new WeakMap;function cC({children:t,error:e}){let{basename:n}=O.useContext(Qn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=ZA(e.digest);if(i){let a=_p.get(e);if(a)throw a;let l=vS(i.location,n);if(_S&&!_p.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw _p.set(e,u),u}return O.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function uC({routeContext:t,match:e,children:n}){let i=O.useContext(Zo);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),O.createElement(dr.Provider,{value:t},n)}function dC(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,u=n?.errors;if(u!=null){let _=l.findIndex(v=>v.route.id&&u?.[v.route.id]!==void 0);xt(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let d=!1,f=-1;if(n)for(let _=0;_<l.length;_++){let v=l[_];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(f=_),v.route.id){let{loaderData:E,errors:T}=n,w=v.route.loader&&!E.hasOwnProperty(v.route.id)&&(!T||T[v.route.id]===void 0);if(v.route.lazy||w){d=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}let g=n&&i?(_,v)=>{i(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:QA(n.matches),errorInfo:v})}:void 0;return l.reduceRight((_,v,E)=>{let T,w=!1,I=null,N=null;n&&(T=u&&v.route.id?u[v.route.id]:void 0,I=v.route.errorElement||lC,d&&(f<0&&E===0?(CS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,N=null):f===E&&(w=!0,N=v.route.hydrateFallbackElement||null)));let U=e.concat(l.slice(0,E+1)),G=()=>{let z;return T?z=I:w?z=N:v.route.Component?z=O.createElement(v.route.Component,null):v.route.element?z=v.route.element:z=_,O.createElement(uC,{match:v,routeContext:{outlet:_,matches:U,isDataRoute:n!=null},children:z})};return n&&(v.route.ErrorBoundary||v.route.errorElement||E===0)?O.createElement(AS,{location:n.location,revalidation:n.revalidation,component:I,error:T,children:G(),routeContext:{outlet:null,matches:U,isDataRoute:!0},onError:g}):G()},null)}function Tg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hC(t){let e=O.useContext(Zo);return xt(e,Tg(t)),e}function fC(t){let e=O.useContext(Vh);return xt(e,Tg(t)),e}function mC(t){let e=O.useContext(dr);return xt(e,Tg(t)),e}function Ag(t){let e=mC(t),n=e.matches[e.matches.length-1];return xt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function pC(){return Ag("useRouteId")}function gC(){let t=O.useContext(wg),e=fC("useRouteError"),n=Ag("useRouteError");return t!==void 0?t:e.errors?.[n]}function yC(){let{router:t}=hC("useNavigate"),e=Ag("useNavigate"),n=O.useRef(!1);return wS(()=>{n.current=!0}),O.useCallback(async(a,l={})=>{ur(n.current,xS),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var hb={};function CS(t,e,n){!e&&!hb[t]&&(hb[t]=!0,ur(!1,n))}O.memo(_C);function _C({routes:t,future:e,state:n,onError:i}){return TS(t,void 0,n,i,e)}function RS({to:t,replace:e,state:n,relative:i}){xt(el(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=O.useContext(Qn);ur(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=O.useContext(dr),{pathname:u}=hr(),d=Lh(),f=xg(t,Sg(l),u,i==="path"),g=JSON.stringify(f);return O.useEffect(()=>{d(JSON.parse(g),{replace:e,state:n,relative:i})},[d,g,i,e,n]),null}function Cg(t){return iC(t.context)}function un(t){xt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function vC({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:u}){xt(!el(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=t.replace(/^\/*/,"/"),f=O.useMemo(()=>({basename:d,navigator:a,static:l,unstable_useTransitions:u,future:{}}),[d,a,l,u]);typeof n=="string"&&(n=Jo(n));let{pathname:g="/",search:_="",hash:v="",state:E=null,key:T="default"}=n,w=O.useMemo(()=>{let I=Ni(g,d);return I==null?null:{location:{pathname:I,search:_,hash:v,state:E,key:T},navigationType:i}},[d,g,_,v,E,T,i]);return ur(w!=null,`<Router basename="${d}"> is not able to match the URL "${g}${_}${v}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:O.createElement(Qn.Provider,{value:f},O.createElement($c.Provider,{children:e,value:w}))}function bC({children:t,location:e}){return aC(Np(t),e)}function Np(t,e=[]){let n=[];return O.Children.forEach(t,(i,a)=>{if(!O.isValidElement(i))return;let l=[...e,a];if(i.type===O.Fragment){n.push.apply(n,Np(i.props.children,l));return}xt(i.type===un,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let u={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(u.children=Np(i.props.children,l)),n.push(u)}),n}var Yd="get",Wd="application/x-www-form-urlencoded";function Uh(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function EC(t){return Uh(t)&&t.tagName.toLowerCase()==="button"}function SC(t){return Uh(t)&&t.tagName.toLowerCase()==="form"}function xC(t){return Uh(t)&&t.tagName.toLowerCase()==="input"}function wC(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function TC(t,e){return t.button===0&&(!e||e==="_self")&&!wC(t)}var Bd=null;function AC(){if(Bd===null)try{new FormData(document.createElement("form"),0),Bd=!1}catch{Bd=!0}return Bd}var CC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function vp(t){return t!=null&&!CC.has(t)?(ur(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Wd}"`),null):t}function RC(t,e){let n,i,a,l,u;if(SC(t)){let d=t.getAttribute("action");i=d?Ni(d,e):null,n=t.getAttribute("method")||Yd,a=vp(t.getAttribute("enctype"))||Wd,l=new FormData(t)}else if(EC(t)||xC(t)&&(t.type==="submit"||t.type==="image")){let d=t.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||d.getAttribute("action");if(i=f?Ni(f,e):null,n=t.getAttribute("formmethod")||d.getAttribute("method")||Yd,a=vp(t.getAttribute("formenctype"))||vp(d.getAttribute("enctype"))||Wd,l=new FormData(d,t),!AC()){let{name:g,type:_,value:v}=t;if(_==="image"){let E=g?`${g}.`:"";l.append(`${E}x`,"0"),l.append(`${E}y`,"0")}else g&&l.append(g,v)}}else{if(Uh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Yd,i=null,a=Wd,u=t}return l&&a==="text/plain"&&(u=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Rg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function DC(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Ni(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function IC(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function OC(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function jC(t,e,n){let i=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let u=await IC(l,n);return u.links?u.links():[]}return[]}));return PC(i.flat(1).filter(OC).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function fb(t,e,n,i,a,l){let u=(f,g)=>n[g]?f.route.id!==n[g].route.id:!0,d=(f,g)=>n[g].pathname!==f.pathname||n[g].route.path?.endsWith("*")&&n[g].params["*"]!==f.params["*"];return l==="assets"?e.filter((f,g)=>u(f,g)||d(f,g)):l==="data"?e.filter((f,g)=>{let _=i.routes[f.route.id];if(!_||!_.hasLoader)return!1;if(u(f,g)||d(f,g))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function MC(t,e,{includeHydrateFallback:n}={}){return kC(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function kC(t){return[...new Set(t)]}function NC(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function PC(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let l=JSON.stringify(NC(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function DS(){let t=O.useContext(Zo);return Rg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function VC(){let t=O.useContext(Vh);return Rg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Dg=O.createContext(void 0);Dg.displayName="FrameworkContext";function IS(){let t=O.useContext(Dg);return Rg(t,"You must render this element inside a <HydratedRouter> element"),t}function LC(t,e){let n=O.useContext(Dg),[i,a]=O.useState(!1),[l,u]=O.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:g,onMouseLeave:_,onTouchStart:v}=e,E=O.useRef(null);O.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let I=U=>{U.forEach(G=>{u(G.isIntersecting)})},N=new IntersectionObserver(I,{threshold:.5});return E.current&&N.observe(E.current),()=>{N.disconnect()}}},[t]),O.useEffect(()=>{if(i){let I=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(I)}}},[i]);let T=()=>{a(!0)},w=()=>{a(!1),u(!1)};return n?t!=="intent"?[l,E,{}]:[l,E,{onFocus:_c(d,T),onBlur:_c(f,w),onMouseEnter:_c(g,T),onMouseLeave:_c(_,w),onTouchStart:_c(v,T)}]:[!1,E,{}]}function _c(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function UC({page:t,...e}){let{router:n}=DS(),i=O.useMemo(()=>mS(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?O.createElement(zC,{page:t,matches:i,...e}):null}function BC(t){let{manifest:e,routeModules:n}=IS(),[i,a]=O.useState([]);return O.useEffect(()=>{let l=!1;return jC(t,e,n).then(u=>{l||a(u)}),()=>{l=!0}},[t,e,n]),i}function zC({page:t,matches:e,...n}){let i=hr(),{manifest:a,routeModules:l}=IS(),{basename:u}=DS(),{loaderData:d,matches:f}=VC(),g=O.useMemo(()=>fb(t,e,f,a,i,"data"),[t,e,f,a,i]),_=O.useMemo(()=>fb(t,e,f,a,i,"assets"),[t,e,f,a,i]),v=O.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let w=new Set,I=!1;if(e.forEach(U=>{let G=a.routes[U.route.id];!G||!G.hasLoader||(!g.some(z=>z.route.id===U.route.id)&&U.route.id in d&&l[U.route.id]?.shouldRevalidate||G.hasClientLoader?I=!0:w.add(U.route.id))}),w.size===0)return[];let N=DC(t,u,"data");return I&&w.size>0&&N.searchParams.set("_routes",e.filter(U=>w.has(U.route.id)).map(U=>U.route.id).join(",")),[N.pathname+N.search]},[u,d,i,a,g,e,t,l]),E=O.useMemo(()=>MC(_,a),[_,a]),T=BC(_);return O.createElement(O.Fragment,null,v.map(w=>O.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...n})),E.map(w=>O.createElement("link",{key:w,rel:"modulepreload",href:w,...n})),T.map(({key:w,link:I})=>O.createElement("link",{key:w,nonce:n.nonce,...I})))}function FC(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var qC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{qC&&(window.__reactRouterVersion="7.11.0")}catch{}function GC({basename:t,children:e,unstable_useTransitions:n,window:i}){let a=O.useRef();a.current==null&&(a.current=EA({window:i,v5Compat:!0}));let l=a.current,[u,d]=O.useState({action:l.action,location:l.location}),f=O.useCallback(g=>{n===!1?d(g):O.startTransition(()=>d(g))},[n]);return O.useLayoutEffect(()=>l.listen(f),[l,f]),O.createElement(vC,{basename:t,children:e,location:u.location,navigationType:u.action,navigator:l,unstable_useTransitions:n})}var OS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tt=O.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:u,state:d,target:f,to:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:E,...T},w){let{basename:I,unstable_useTransitions:N}=O.useContext(Qn),U=typeof g=="string"&&OS.test(g),G=vS(g,I);g=G.to;let z=tC(g,{relative:a}),[$,J,te]=LC(i,T),j=$C(g,{replace:u,state:d,target:f,preventScrollReset:_,relative:a,viewTransition:v,unstable_defaultShouldRevalidate:E,unstable_useTransitions:N});function A(D){e&&e(D),D.defaultPrevented||j(D)}let R=O.createElement("a",{...T,...te,href:G.absoluteURL||z,onClick:G.isExternal||l?e:A,ref:FC(w,J),target:f,"data-discover":!U&&n==="render"?"true":void 0});return $&&!U?O.createElement(O.Fragment,null,R,O.createElement(UC,{page:z})):R});Tt.displayName="Link";var HC=O.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:u,viewTransition:d,children:f,...g},_){let v=Yc(u,{relative:g.relative}),E=hr(),T=O.useContext(Vh),{navigator:w,basename:I}=O.useContext(Qn),N=T!=null&&ZC(v)&&d===!0,U=w.encodeLocation?w.encodeLocation(v).pathname:v.pathname,G=E.pathname,z=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(G=G.toLowerCase(),z=z?z.toLowerCase():null,U=U.toLowerCase()),z&&I&&(z=Ni(z,I)||z);const $=U!=="/"&&U.endsWith("/")?U.length-1:U.length;let J=G===U||!a&&G.startsWith(U)&&G.charAt($)==="/",te=z!=null&&(z===U||!a&&z.startsWith(U)&&z.charAt(U.length)==="/"),j={isActive:J,isPending:te,isTransitioning:N},A=J?e:void 0,R;typeof i=="function"?R=i(j):R=[i,J?"active":null,te?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let D=typeof l=="function"?l(j):l;return O.createElement(Tt,{...g,"aria-current":A,className:R,ref:_,style:D,to:u,viewTransition:d},typeof f=="function"?f(j):f)});HC.displayName="NavLink";var QC=O.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:l,method:u=Yd,action:d,onSubmit:f,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:E,...T},w)=>{let{unstable_useTransitions:I}=O.useContext(Qn),N=XC(),U=JC(d,{relative:g}),G=u.toLowerCase()==="get"?"get":"post",z=typeof d=="string"&&OS.test(d),$=J=>{if(f&&f(J),J.defaultPrevented)return;J.preventDefault();let te=J.nativeEvent.submitter,j=te?.getAttribute("formmethod")||u,A=()=>N(te||J.currentTarget,{fetcherKey:e,method:j,navigate:n,replace:a,state:l,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:E});I&&n!==!1?O.startTransition(()=>A()):A()};return O.createElement("form",{ref:w,method:G,action:U,onSubmit:i?f:$,...T,"data-discover":!z&&t==="render"?"true":void 0})});QC.displayName="Form";function KC(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jS(t){let e=O.useContext(Zo);return xt(e,KC(t)),e}function $C(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:u,unstable_defaultShouldRevalidate:d,unstable_useTransitions:f}={}){let g=Lh(),_=hr(),v=Yc(t,{relative:l});return O.useCallback(E=>{if(TC(E,e)){E.preventDefault();let T=n!==void 0?n:Lc(_)===Lc(v),w=()=>g(t,{replace:T,state:i,preventScrollReset:a,relative:l,viewTransition:u,unstable_defaultShouldRevalidate:d});f?O.startTransition(()=>w()):w()}},[_,g,v,n,i,e,t,a,l,u,d,f])}var YC=0,WC=()=>`__${String(++YC)}__`;function XC(){let{router:t}=jS("useSubmit"),{basename:e}=O.useContext(Qn),n=pC(),i=t.fetch,a=t.navigate;return O.useCallback(async(l,u={})=>{let{action:d,method:f,encType:g,formData:_,body:v}=RC(l,e);if(u.navigate===!1){let E=u.fetcherKey||WC();await i(E,n,u.action||d,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:_,body:v,formMethod:u.method||f,formEncType:u.encType||g,flushSync:u.flushSync})}else await a(u.action||d,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:_,body:v,formMethod:u.method||f,formEncType:u.encType||g,replace:u.replace,state:u.state,fromRouteId:n,flushSync:u.flushSync,viewTransition:u.viewTransition})},[i,a,e,n])}function JC(t,{relative:e}={}){let{basename:n}=O.useContext(Qn),i=O.useContext(dr);xt(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...Yc(t||".",{relative:e})},u=hr();if(t==null){l.search=u.search;let d=new URLSearchParams(l.search),f=d.getAll("index");if(f.some(_=>_==="")){d.delete("index"),f.filter(v=>v).forEach(v=>d.append("index",v));let _=d.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Oi([n,l.pathname])),Lc(l)}function ZC(t,{relative:e}={}){let n=O.useContext(ES);xt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=jS("useViewTransitionState"),a=Yc(t,{relative:e});if(!n.isTransitioning)return!1;let l=Ni(n.currentLocation.pathname,i)||n.currentLocation.pathname,u=Ni(n.nextLocation.pathname,i)||n.nextLocation.pathname;return ch(a.pathname,u)!=null||ch(a.pathname,l)!=null}const eR=function(){},tR={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:eR},Wc=O.createContext(tR);var tl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},nR={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},rR=class{#e=nR;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Ri=new rR;function iR(t){setTimeout(t,0)}var Aa=typeof window>"u"||"Deno"in globalThis;function $t(){}function sR(t,e){return typeof t=="function"?t(e):t}function Pp(t){return typeof t=="number"&&t>=0&&t!==1/0}function MS(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Rs(t,e){return typeof t=="function"?t(e):t}function lr(t,e){return typeof t=="function"?t(e):t}function mb(t,e){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:u,stale:d}=t;if(u){if(i){if(e.queryHash!==Ig(u,e.options))return!1}else if(!Uc(e.queryKey,u))return!1}if(n!=="all"){const f=e.isActive();if(n==="active"&&!f||n==="inactive"&&f)return!1}return!(typeof d=="boolean"&&e.isStale()!==d||a&&a!==e.state.fetchStatus||l&&!l(e))}function pb(t,e){const{exact:n,status:i,predicate:a,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(Ca(e.options.mutationKey)!==Ca(l))return!1}else if(!Uc(e.options.mutationKey,l))return!1}return!(i&&e.state.status!==i||a&&!a(e))}function Ig(t,e){return(e?.queryKeyHashFn||Ca)(t)}function Ca(t){return JSON.stringify(t,(e,n)=>Vp(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function Uc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Uc(t[n],e[n])):!1}var aR=Object.prototype.hasOwnProperty;function kS(t,e){if(t===e)return t;const n=gb(t)&&gb(e);if(!n&&!(Vp(t)&&Vp(e)))return e;const a=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),u=l.length,d=n?new Array(u):{};let f=0;for(let g=0;g<u;g++){const _=n?g:l[g],v=t[_],E=e[_];if(v===E){d[_]=v,(n?g<a:aR.call(t,_))&&f++;continue}if(v===null||E===null||typeof v!="object"||typeof E!="object"){d[_]=E;continue}const T=kS(v,E);d[_]=T,T===v&&f++}return a===u&&f===a?t:d}function uh(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function gb(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Vp(t){if(!yb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!yb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function yb(t){return Object.prototype.toString.call(t)==="[object Object]"}function oR(t){return new Promise(e=>{Ri.setTimeout(e,t)})}function Lp(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?kS(t,e):e}function lR(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function cR(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var Og=Symbol();function NS(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Og?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function PS(t,e){return typeof t=="function"?t(...e):!!t}var uR=class extends tl{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!Aa&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},jg=new uR;function Up(){let t,e;const n=new Promise((a,l)=>{t=a,e=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),e(a)},n}function dR(t){let e;if(t.then(n=>(e=n,n),$t)?.catch($t),e!==void 0)return{data:e}}function VS(t){return t}function hR(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function fR(t,e,n){const i=()=>{const a=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return a?.catch($t),a};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:i()},...t.meta&&{meta:t.meta}}}function mR(t){return t.state.isPaused}function pR(t){return t.state.status==="success"}function gR(t){return!0}function yR(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??mR,i=t.getMutationCache().getAll().flatMap(f=>n(f)?[hR(f)]:[]),a=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??pR,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??gR,u=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??VS,d=t.getQueryCache().getAll().flatMap(f=>a(f)?[fR(f,u,l)]:[]);return{mutations:i,queries:d}}function _R(t,e,n){if(typeof e!="object"||e===null)return;const i=t.getMutationCache(),a=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??VS,u=e.mutations||[],d=e.queries||[];u.forEach(({state:f,...g})=>{i.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...g},f)}),d.forEach(({queryKey:f,state:g,queryHash:_,meta:v,promise:E,dehydratedAt:T})=>{const w=E?dR(E):void 0,I=g.data===void 0?w?.data:g.data,N=I===void 0?I:l(I);let U=a.get(_);const G=U?.state.status==="pending",z=U?.state.fetchStatus==="fetching";if(U){const $=w&&T!==void 0&&T>U.state.dataUpdatedAt;if(g.dataUpdatedAt>U.state.dataUpdatedAt||$){const{fetchStatus:J,...te}=g;U.setState({...te,data:N})}}else U=a.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:f,queryHash:_,meta:v},{...g,data:N,fetchStatus:"idle",status:N!==void 0?"success":g.status});E&&!G&&!z&&(T===void 0||T>U.state.dataUpdatedAt)&&U.fetch(void 0,{initialPromise:Promise.resolve(E).then(l)}).catch($t)})}var vR=iR;function bR(){let t=[],e=0,n=d=>{d()},i=d=>{d()},a=vR;const l=d=>{e?t.push(d):a(()=>{n(d)})},u=()=>{const d=t;t=[],d.length&&a(()=>{i(()=>{d.forEach(f=>{n(f)})})})};return{batch:d=>{let f;e++;try{f=d()}finally{e--,e||u()}return f},batchCalls:d=>(...f)=>{l(()=>{d(...f)})},schedule:l,setNotifyFunction:d=>{n=d},setBatchNotifyFunction:d=>{i=d},setScheduler:d=>{a=d}}}var Yt=bR(),ER=class extends tl{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!Aa&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},dh=new ER;function SR(t){return Math.min(1e3*2**t,3e4)}function LS(t){return(t??"online")==="online"?dh.isOnline():!0}var Bp=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function US(t){let e=!1,n=0,i;const a=Up(),l=()=>a.status!=="pending",u=I=>{if(!l()){const N=new Bp(I);E(N),t.onCancel?.(N)}},d=()=>{e=!0},f=()=>{e=!1},g=()=>jg.isFocused()&&(t.networkMode==="always"||dh.isOnline())&&t.canRun(),_=()=>LS(t.networkMode)&&t.canRun(),v=I=>{l()||(i?.(),a.resolve(I))},E=I=>{l()||(i?.(),a.reject(I))},T=()=>new Promise(I=>{i=N=>{(l()||g())&&I(N)},t.onPause?.()}).then(()=>{i=void 0,l()||t.onContinue?.()}),w=()=>{if(l())return;let I;const N=n===0?t.initialPromise:void 0;try{I=N??t.fn()}catch(U){I=Promise.reject(U)}Promise.resolve(I).then(v).catch(U=>{if(l())return;const G=t.retry??(Aa?0:3),z=t.retryDelay??SR,$=typeof z=="function"?z(n,U):z,J=G===!0||typeof G=="number"&&n<G||typeof G=="function"&&G(n,U);if(e||!J){E(U);return}n++,t.onFail?.(n,U),oR($).then(()=>g()?void 0:T()).then(()=>{e?E(U):w()})})};return{promise:a,status:()=>a.status,cancel:u,continue:()=>(i?.(),a),cancelRetry:d,continueRetry:f,canStart:_,start:()=>(_()?w():T().then(w),a)}}var BS=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Pp(this.gcTime)&&(this.#e=Ri.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Aa?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Ri.clearTimeout(this.#e),this.#e=void 0)}},xR=class extends BS{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=vb(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=vb(this.options);n.data!==void 0&&(this.setState(_b(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const i=Lp(this.state.data,e,this.options);return this.#s({data:i,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),i}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then($t).catch($t):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>lr(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Og||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Rs(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!MS(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(g=>g.options.queryFn);f&&this.setOptions(f.options)}const i=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(this.#o=!0,i.signal)})},l=()=>{const f=NS(this.options,n),_=(()=>{const v={client:this.#i,queryKey:this.queryKey,meta:this.meta};return a(v),v})();return this.#o=!1,this.options.persister?this.options.persister(f,_,this):f(_)},d=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return a(f),f})();this.options.behavior?.onFetch(d,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==d.fetchOptions?.meta)&&this.#s({type:"fetch",meta:d.fetchOptions?.meta}),this.#r=US({initialPromise:n?.initialPromise,fn:d.fetchFn,onCancel:f=>{f instanceof Bp&&f.revert&&this.setState({...this.#t,fetchStatus:"idle"}),i.abort()},onFail:(f,g)=>{this.#s({type:"failed",failureCount:f,error:g})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0});try{const f=await this.#r.start();if(f===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(f),this.#n.config.onSuccess?.(f,this),this.#n.config.onSettled?.(f,this.state.error,this),f}catch(f){if(f instanceof Bp){if(f.silent)return this.#r.promise;if(f.revert){if(this.state.data===void 0)throw f;return this.state.data}}throw this.#s({type:"error",error:f}),this.#n.config.onError?.(f,this),this.#n.config.onSettled?.(this.state.data,f,this),f}finally{this.scheduleGc()}}#s(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...zS(i.data,this.options),fetchMeta:e.meta??null};case"success":const a={...i,..._b(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const l=e.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),Yt.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function zS(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:LS(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function _b(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function vb(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var wR=class extends tl{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=Up(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),bb(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return zp(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return zp(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#E(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof lr(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#S(),this.#t.setOptions(this.options),e._defaulted&&!uh(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&Eb(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),i&&(this.#t!==n||lr(this.options.enabled,this.#t)!==lr(e.enabled,this.#t)||Rs(this.options.staleTime,this.#t)!==Rs(e.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||lr(this.options.enabled,this.#t)!==lr(e.enabled,this.#t)||a!==this.#l)&&this.#_(a)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return AR(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),e?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#S();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch($t)),e}#g(){this.#b();const t=Rs(this.options.staleTime,this.#t);if(Aa||this.#i.isStale||!Pp(t))return;const n=MS(this.#i.dataUpdatedAt,t)+1;this.#c=Ri.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#E(),this.#l=t,!(Aa||lr(this.options.enabled,this.#t)===!1||!Pp(this.#l)||this.#l===0)&&(this.#u=Ri.setInterval(()=>{(this.options.refetchIntervalInBackground||jg.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#b(){this.#c&&(Ri.clearTimeout(this.#c),this.#c=void 0)}#E(){this.#u&&(Ri.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,i=this.options,a=this.#i,l=this.#r,u=this.#a,f=t!==n?t.state:this.#n,{state:g}=t;let _={...g},v=!1,E;if(e._optimisticResults){const A=this.hasListeners(),R=!A&&bb(t,e),D=A&&Eb(t,n,e,i);(R||D)&&(_={..._,...zS(g.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:T,errorUpdatedAt:w,status:I}=_;E=_.data;let N=!1;if(e.placeholderData!==void 0&&E===void 0&&I==="pending"){let A;a?.isPlaceholderData&&e.placeholderData===u?.placeholderData?(A=a.data,N=!0):A=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,A!==void 0&&(I="success",E=Lp(a?.data,A,e),v=!0)}if(e.select&&E!==void 0&&!N)if(a&&E===l?.data&&e.select===this.#p)E=this.#h;else try{this.#p=e.select,E=e.select(E),E=Lp(a?.data,E,e),this.#h=E,this.#s=null}catch(A){this.#s=A}this.#s&&(T=this.#s,E=this.#h,w=Date.now(),I="error");const U=_.fetchStatus==="fetching",G=I==="pending",z=I==="error",$=G&&U,J=E!==void 0,j={status:I,fetchStatus:_.fetchStatus,isPending:G,isSuccess:I==="success",isError:z,isInitialLoading:$,isLoading:$,data:E,dataUpdatedAt:_.dataUpdatedAt,error:T,errorUpdatedAt:w,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>f.dataUpdateCount||_.errorUpdateCount>f.errorUpdateCount,isFetching:U,isRefetching:U&&!G,isLoadingError:z&&!J,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:z&&J,isStale:Mg(t,e),refetch:this.refetch,promise:this.#o,isEnabled:lr(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const A=C=>{j.status==="error"?C.reject(j.error):j.data!==void 0&&C.resolve(j.data)},R=()=>{const C=this.#o=j.promise=Up();A(C)},D=this.#o;switch(D.status){case"pending":t.queryHash===n.queryHash&&A(D);break;case"fulfilled":(j.status==="error"||j.data!==D.value)&&R();break;case"rejected":(j.status!=="error"||j.error!==D.reason)&&R();break}}return j}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),uh(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(u=>{const d=u;return this.#i[d]!==t[d]&&l.has(d)})};this.#x({listeners:n()})}#S(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#x(t){Yt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function TR(t,e){return lr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function bb(t,e){return TR(t,e)||t.state.data!==void 0&&zp(t,e,e.refetchOnMount)}function zp(t,e,n){if(lr(e.enabled,t)!==!1&&Rs(e.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&Mg(t,e)}return!1}function Eb(t,e,n,i){return(t!==e||lr(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Mg(t,n)}function Mg(t,e){return lr(e.enabled,t)!==!1&&t.isStaleByTime(Rs(e.staleTime,t))}function AR(t,e){return!uh(t.getCurrentResult(),e)}function Sb(t){return{onFetch:(e,n)=>{const i=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],u=e.state.data?.pageParams||[];let d={pages:[],pageParams:[]},f=0;const g=async()=>{let _=!1;const v=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},E=NS(e.options,e.fetchOptions),T=async(w,I,N)=>{if(_)return Promise.reject();if(I==null&&w.pages.length)return Promise.resolve(w);const G=(()=>{const te={client:e.client,queryKey:e.queryKey,pageParam:I,direction:N?"backward":"forward",meta:e.options.meta};return v(te),te})(),z=await E(G),{maxPages:$}=e.options,J=N?cR:lR;return{pages:J(w.pages,z,$),pageParams:J(w.pageParams,I,$)}};if(a&&l.length){const w=a==="backward",I=w?CR:xb,N={pages:l,pageParams:u},U=I(i,N);d=await T(N,U,w)}else{const w=t??l.length;do{const I=f===0?u[0]??i.initialPageParam:xb(i,d);if(f>0&&I==null)break;d=await T(d,I),f++}while(f<w)}return d};e.options.persister?e.fetchFn=()=>e.options.persister?.(g,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=g}}}function xb(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function CR(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var RR=class extends BS{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||FS(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=US({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(u,d)=>{this.#r({type:"failed",failureCount:u,error:d})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",l=!this.#i.canStart();try{if(a)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,i);const d=await this.options.onMutate?.(e,i);d!==this.state.context&&this.#r({type:"pending",context:d,variables:e,isPaused:l})}const u=await this.#i.start();return await this.#n.config.onSuccess?.(u,e,this.state.context,this,i),await this.options.onSuccess?.(u,e,this.state.context,i),await this.#n.config.onSettled?.(u,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(u,null,e,this.state.context,i),this.#r({type:"success",data:u}),u}catch(u){try{throw await this.#n.config.onError?.(u,e,this.state.context,this,i),await this.options.onError?.(u,e,this.state.context,i),await this.#n.config.onSettled?.(void 0,u,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,u,e,this.state.context,i),u}finally{this.#r({type:"error",error:u})}}finally{this.#n.runNext(this)}}#r(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Yt.batch(()=>{this.#t.forEach(i=>{i.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function FS(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var DR=class extends tl{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const i=new RR({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){this.#e.add(t);const e=zd(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=zd(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=zd(t);if(typeof e=="string"){const i=this.#t.get(e)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const e=zd(t);return typeof e=="string"?this.#t.get(e)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Yt.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>pb(e,n))}findAll(t={}){return this.getAll().filter(e=>pb(t,e))}notify(t){Yt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return Yt.batch(()=>Promise.all(t.map(e=>e.continue().catch($t))))}};function zd(t){return t.options.scope?.id}var IR=class extends tl{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),uh(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&Ca(n.mutationKey)!==Ca(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??FS();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){Yt.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,i,a),this.#i.onSettled?.(e.data,null,n,i,a)):e?.type==="error"&&(this.#i.onError?.(e.error,n,i,a),this.#i.onSettled?.(void 0,e.error,n,i,a))}this.listeners.forEach(n=>{n(this.#t)})})}},OR=class extends tl{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const i=e.queryKey,a=e.queryHash??Ig(i,e);let l=this.get(a);return l||(l=new xR({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Yt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>mb(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>mb(t,n)):e}notify(t){Yt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Yt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Yt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},jR=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new OR,this.#t=t.mutationCache||new DR,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=jg.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=dh.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Rs(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(i.queryHash)?.state.data,u=sR(e,l);if(u!==void 0)return this.#e.build(this,i).setData(u,{...n,manual:!0})}setQueriesData(t,e,n){return Yt.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;Yt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return Yt.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=Yt.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then($t).catch($t)}invalidateQueries(t,e={}){return Yt.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=Yt.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch($t)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then($t)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Rs(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then($t).catch($t)}fetchInfiniteQuery(t){return t.behavior=Sb(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then($t).catch($t)}ensureInfiniteQueryData(t){return t.behavior=Sb(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return dh.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Ca(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(i=>{Uc(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Ca(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(i=>{Uc(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Ig(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Og&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},qS=O.createContext(void 0),oi=t=>{const e=O.useContext(qS);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},MR=({client:t,children:e})=>(O.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),m.jsx(qS.Provider,{value:t,children:e})),GS=O.createContext(!1),kR=()=>O.useContext(GS),NR=GS.Provider;function PR(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var VR=O.createContext(PR()),LR=()=>O.useContext(VR),UR=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},BR=t=>{O.useEffect(()=>{t.clearReset()},[t])},zR=({result:t,errorResetBoundary:e,throwOnError:n,query:i,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||PS(n,[t.error,i])),FR=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},qR=(t,e)=>t.isLoading&&t.isFetching&&!e,GR=(t,e)=>t?.suspense&&e.isPending,wb=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function HR(t,e,n){const i=kR(),a=LR(),l=oi(),u=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(u),u._optimisticResults=i?"isRestoring":"optimistic",FR(u),UR(u,a),BR(a);const d=!l.getQueryCache().get(u.queryHash),[f]=O.useState(()=>new e(l,u)),g=f.getOptimisticResult(u),_=!i&&t.subscribed!==!1;if(O.useSyncExternalStore(O.useCallback(v=>{const E=_?f.subscribe(Yt.batchCalls(v)):$t;return f.updateResult(),E},[f,_]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),O.useEffect(()=>{f.setOptions(u)},[u,f]),GR(u,g))throw wb(u,f,a);if(zR({result:g,errorResetBoundary:a,throwOnError:u.throwOnError,query:l.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw g.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(u,g),u.experimental_prefetchInRender&&!Aa&&qR(g,i)&&(d?wb(u,f,a):l.getQueryCache().get(u.queryHash)?.promise)?.catch($t).finally(()=>{f.updateResult()}),u.notifyOnChangeProps?g:f.trackResult(g)}function ka(t,e){return HR(t,wR)}function pt(t,e){const n=oi(),[i]=O.useState(()=>new IR(n,t));O.useEffect(()=>{i.setOptions(t)},[i,t]);const a=O.useSyncExternalStore(O.useCallback(u=>i.subscribe(Yt.batchCalls(u)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=O.useCallback((u,d)=>{i.mutate(u,d).catch($t)},[i]);if(a.error&&PS(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}function Fp(){}function QR(t,{interval:e=1e3,onError:n=Fp}={}){if(typeof t!="function")throw new Error("argument is not function.");let i=0,a=null,l=!1,u=!1;return async(...d)=>{if(a=d,!u){for(u=!0;l;)await new Promise(f=>Ri.setTimeout(f,e));for(;Date.now()<i;)await new Promise(f=>Ri.setTimeout(f,i-Date.now()));u=!1,l=!0;try{await t(...a)}catch(f){try{n(f)}catch{}}i=Date.now()+e,l=!1}}}var KR=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:i=JSON.stringify,deserialize:a=JSON.parse,retry:l})=>{if(t){const u=async d=>{try{const f=await i(d);await t.setItem(e,f);return}catch(f){return f}};return{persistClient:QR(async d=>{let f=d,g=await u(f),_=0;for(;g&&f;)_++,f=await l?.({persistedClient:f,error:g,errorCount:_}),f&&(g=await u(f))},{interval:n}),restoreClient:async()=>{const d=await t.getItem(e);if(d)return await a(d)},removeClient:()=>t.removeItem(e)}}return{persistClient:Fp,restoreClient:()=>Promise.resolve(void 0),removeClient:Fp}};const He=new jR({defaultOptions:{queries:{staleTime:300*1e3,gcTime:1440*60*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}});He.getQueryCache().subscribe(t=>{const e=t?.query;if(e&&t.type==="updated"){const{state:n}=e;n.status==="error"&&n.error&&console.error("[RQ] Query FAILED:",e.queryKey,n.error)}});const $R=KR({storage:typeof window<"u"?{getItem:t=>Promise.resolve(localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(localStorage.removeItem(t))}:void 0,key:"BUDGET_APP_QUERY_CACHE"}),le={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};var YR=["added","removed","updated"];function Tb(t){return YR.includes(t)}async function WR({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:i="",hydrateOptions:a}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const u=Date.now()-l.timestamp>n,d=l.buster!==i;if(u||d)return e.removeClient();_R(t,l.clientState,a)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function Ab({queryClient:t,persister:e,buster:n="",dehydrateOptions:i}){const a={buster:n,timestamp:Date.now(),clientState:yR(t,i)};await e.persistClient(a)}function XR(t){const e=t.queryClient.getQueryCache().subscribe(i=>{Tb(i.type)&&Ab(t)}),n=t.queryClient.getMutationCache().subscribe(i=>{Tb(i.type)&&Ab(t)});return()=>{e(),n()}}var JR=({children:t,persistOptions:e,onSuccess:n,onError:i,...a})=>{const[l,u]=O.useState(!0),d=O.useRef({persistOptions:e,onSuccess:n,onError:i}),f=O.useRef(!1);return O.useEffect(()=>{d.current={persistOptions:e,onSuccess:n,onError:i}}),O.useEffect(()=>{const g={...d.current.persistOptions,queryClient:a.client};return f.current||(f.current=!0,WR(g).then(()=>d.current.onSuccess?.()).catch(()=>d.current.onError?.()).finally(()=>{u(!1)})),l?void 0:XR(g)},[a.client,l]),m.jsx(MR,{...a,children:m.jsx(NR,{value:l,children:t})})};function ZR({children:t}){return m.jsx(JR,{client:He,persistOptions:{persister:$R,maxAge:1440*60*1e3,buster:"v1"},children:t})}const eD=()=>{};var Cb={};const HS=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},tD=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],u=t[n++],d=t[n++],f=((a&7)<<18|(l&63)<<12|(u&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const l=t[n++],u=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},QS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],u=a+1<t.length,d=u?t[a+1]:0,f=a+2<t.length,g=f?t[a+2]:0,_=l>>2,v=(l&3)<<4|d>>4;let E=(d&15)<<2|g>>6,T=g&63;f||(T=64,u||(E=64)),i.push(n[_],n[v],n[E],n[T])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(HS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):tD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],d=a<t.length?n[t.charAt(a)]:0;++a;const g=a<t.length?n[t.charAt(a)]:64;++a;const v=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||d==null||g==null||v==null)throw new nD;const E=l<<2|d>>4;if(i.push(E),g!==64){const T=d<<4&240|g>>2;if(i.push(T),v!==64){const w=g<<6&192|v;i.push(w)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class nD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const rD=function(t){const e=HS(t);return QS.encodeByteArray(e,!0)},hh=function(t){return rD(t).replace(/\./g,"")},KS=function(t){try{return QS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function iD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const sD=()=>iD().__FIREBASE_DEFAULTS__,aD=()=>{if(typeof process>"u"||typeof Cb>"u")return;const t=Cb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},oD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&KS(t[1]);return e&&JSON.parse(e)},Bh=()=>{try{return eD()||sD()||aD()||oD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},$S=t=>Bh()?.emulatorHosts?.[t],lD=t=>{const e=$S(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},YS=()=>Bh()?.config,WS=t=>Bh()?.[`_${t}`];class cD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function nl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function XS(t){return(await fetch(t,{credentials:"include"})).ok}function uD(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[hh(JSON.stringify(n)),hh(JSON.stringify(u)),""].join(".")}const Ac={};function dD(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ac))Ac[e]?t.emulator.push(e):t.prod.push(e);return t}function hD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Rb=!1;function JS(t,e){if(typeof window>"u"||typeof document>"u"||!nl(window.location.host)||Ac[t]===e||Ac[t]||Rb)return;Ac[t]=e;function n(E){return`__firebase__banner__${E}`}const i="__firebase__banner",l=dD().prod.length>0;function u(){const E=document.getElementById(i);E&&E.remove()}function d(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function f(E,T){E.setAttribute("width","24"),E.setAttribute("id",T),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function g(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Rb=!0,u()},E}function _(E,T){E.setAttribute("id",T),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function v(){const E=hD(i),T=n("text"),w=document.getElementById(T)||document.createElement("span"),I=n("learnmore"),N=document.getElementById(I)||document.createElement("a"),U=n("preprendIcon"),G=document.getElementById(U)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const z=E.element;d(z),_(N,I);const $=g();f(G,U),z.append(G,w,N,$),document.body.appendChild(z)}l?(w.innerText="Preview backend disconnected.",G.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(G.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function vn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(vn())}function mD(){const t=Bh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function gD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function yD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _D(){const t=vn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function vD(){return!mD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function bD(){try{return typeof indexedDB=="object"}catch{return!1}}function ED(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const SD="FirebaseError";class Fi extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=SD,Object.setPrototypeOf(this,Fi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xc.prototype.create)}}class Xc{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?xD(l,i):"Error",d=`${this.serviceName}: ${u} (${a}).`;return new Fi(a,d,i)}}function xD(t,e){return t.replace(wD,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const wD=/\{\$([^}]+)}/g;function TD(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ns(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],u=e[a];if(Db(l)&&Db(u)){if(!Ns(l,u))return!1}else if(l!==u)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function Db(t){return t!==null&&typeof t=="object"}function Jc(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function bc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Ec(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function AD(t,e){const n=new CD(t,e);return n.subscribe.bind(n)}class CD{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");RD(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=bp),a.error===void 0&&(a.error=bp),a.complete===void 0&&(a.complete=bp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function RD(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function bp(){}function nn(t){return t&&t._delegate?t._delegate:t}class Ra{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const xa="[DEFAULT]";class DD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new cD;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(OD(e))try{this.getOrInitializeService({instanceIdentifier:xa})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=xa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xa){return this.instances.has(e)}getOptions(e=xa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,u]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);i===d&&u.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:ID(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=xa){return this.component?this.component.multipleInstances?e:xa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ID(t){return t===xa?void 0:t}function OD(t){return t.instantiationMode==="EAGER"}class jD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new DD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var $e;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})($e||($e={}));const MD={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},kD=$e.INFO,ND={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},PD=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=ND[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kg{constructor(e){this.name=e,this._logLevel=kD,this._logHandler=PD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?MD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const VD=(t,e)=>e.some(n=>t instanceof n);let Ib,Ob;function LD(){return Ib||(Ib=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function UD(){return Ob||(Ob=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ZS=new WeakMap,qp=new WeakMap,ex=new WeakMap,Ep=new WeakMap,Ng=new WeakMap;function BD(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",u)},l=()=>{n(Ds(t.result)),a()},u=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",u)});return e.then(n=>{n instanceof IDBCursor&&ZS.set(n,t)}).catch(()=>{}),Ng.set(e,t),e}function zD(t){if(qp.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",u),t.removeEventListener("abort",u)},l=()=>{n(),a()},u=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",u),t.addEventListener("abort",u)});qp.set(t,e)}let Gp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ex.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ds(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function FD(t){Gp=t(Gp)}function qD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(Sp(this),e,...n);return ex.set(i,e.sort?e.sort():[e]),Ds(i)}:UD().includes(t)?function(...e){return t.apply(Sp(this),e),Ds(ZS.get(this))}:function(...e){return Ds(t.apply(Sp(this),e))}}function GD(t){return typeof t=="function"?qD(t):(t instanceof IDBTransaction&&zD(t),VD(t,LD())?new Proxy(t,Gp):t)}function Ds(t){if(t instanceof IDBRequest)return BD(t);if(Ep.has(t))return Ep.get(t);const e=GD(t);return e!==t&&(Ep.set(t,e),Ng.set(e,t)),e}const Sp=t=>Ng.get(t);function HD(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const u=indexedDB.open(t,e),d=Ds(u);return i&&u.addEventListener("upgradeneeded",f=>{i(Ds(u.result),f.oldVersion,f.newVersion,Ds(u.transaction),f)}),n&&u.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),d.then(f=>{l&&f.addEventListener("close",()=>l()),a&&f.addEventListener("versionchange",g=>a(g.oldVersion,g.newVersion,g))}).catch(()=>{}),d}const QD=["get","getKey","getAll","getAllKeys","count"],KD=["put","add","delete","clear"],xp=new Map;function jb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xp.get(e))return xp.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=KD.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||QD.includes(n)))return;const l=async function(u,...d){const f=this.transaction(u,a?"readwrite":"readonly");let g=f.store;return i&&(g=g.index(d.shift())),(await Promise.all([g[n](...d),a&&f.done]))[0]};return xp.set(e,l),l}FD(t=>({...t,get:(e,n,i)=>jb(e,n)||t.get(e,n,i),has:(e,n)=>!!jb(e,n)||t.has(e,n)}));class $D{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(YD(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function YD(t){return t.getComponent()?.type==="VERSION"}const Hp="@firebase/app",Mb="0.14.6";const Pi=new kg("@firebase/app"),WD="@firebase/app-compat",XD="@firebase/analytics-compat",JD="@firebase/analytics",ZD="@firebase/app-check-compat",eI="@firebase/app-check",tI="@firebase/auth",nI="@firebase/auth-compat",rI="@firebase/database",iI="@firebase/data-connect",sI="@firebase/database-compat",aI="@firebase/functions",oI="@firebase/functions-compat",lI="@firebase/installations",cI="@firebase/installations-compat",uI="@firebase/messaging",dI="@firebase/messaging-compat",hI="@firebase/performance",fI="@firebase/performance-compat",mI="@firebase/remote-config",pI="@firebase/remote-config-compat",gI="@firebase/storage",yI="@firebase/storage-compat",_I="@firebase/firestore",vI="@firebase/ai",bI="@firebase/firestore-compat",EI="firebase",SI="12.6.0";const Qp="[DEFAULT]",xI={[Hp]:"fire-core",[WD]:"fire-core-compat",[JD]:"fire-analytics",[XD]:"fire-analytics-compat",[eI]:"fire-app-check",[ZD]:"fire-app-check-compat",[tI]:"fire-auth",[nI]:"fire-auth-compat",[rI]:"fire-rtdb",[iI]:"fire-data-connect",[sI]:"fire-rtdb-compat",[aI]:"fire-fn",[oI]:"fire-fn-compat",[lI]:"fire-iid",[cI]:"fire-iid-compat",[uI]:"fire-fcm",[dI]:"fire-fcm-compat",[hI]:"fire-perf",[fI]:"fire-perf-compat",[mI]:"fire-rc",[pI]:"fire-rc-compat",[gI]:"fire-gcs",[yI]:"fire-gcs-compat",[_I]:"fire-fst",[bI]:"fire-fst-compat",[vI]:"fire-vertex","fire-js":"fire-js",[EI]:"fire-js-all"};const fh=new Map,wI=new Map,Kp=new Map;function kb(t,e){try{t.container.addComponent(e)}catch(n){Pi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Fo(t){const e=t.name;if(Kp.has(e))return Pi.debug(`There were multiple attempts to register component ${e}.`),!1;Kp.set(e,t);for(const n of fh.values())kb(n,t);for(const n of wI.values())kb(n,t);return!0}function Pg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Tr(t){return t==null?!1:t.settings!==void 0}const TI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Is=new Xc("app","Firebase",TI);class AI{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ra("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Is.create("app-deleted",{appName:this._name})}}const rl=SI;function tx(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:Qp,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Is.create("bad-app-name",{appName:String(a)});if(n||(n=YS()),!n)throw Is.create("no-options");const l=fh.get(a);if(l){if(Ns(n,l.options)&&Ns(i,l.config))return l;throw Is.create("duplicate-app",{appName:a})}const u=new jD(a);for(const f of Kp.values())u.addComponent(f);const d=new AI(n,i,u);return fh.set(a,d),d}function nx(t=Qp){const e=fh.get(t);if(!e&&t===Qp&&YS())return tx();if(!e)throw Is.create("no-app",{appName:t});return e}function Os(t,e,n){let i=xI[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${i}" with version "${e}":`];a&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pi.warn(u.join(" "));return}Fo(new Ra(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const CI="firebase-heartbeat-database",RI=1,Bc="firebase-heartbeat-store";let wp=null;function rx(){return wp||(wp=HD(CI,RI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Bc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Is.create("idb-open",{originalErrorMessage:t.message})})),wp}async function DI(t){try{const n=(await rx()).transaction(Bc),i=await n.objectStore(Bc).get(ix(t));return await n.done,i}catch(e){if(e instanceof Fi)Pi.warn(e.message);else{const n=Is.create("idb-get",{originalErrorMessage:e?.message});Pi.warn(n.message)}}}async function Nb(t,e){try{const i=(await rx()).transaction(Bc,"readwrite");await i.objectStore(Bc).put(e,ix(t)),await i.done}catch(n){if(n instanceof Fi)Pi.warn(n.message);else{const i=Is.create("idb-set",{originalErrorMessage:n?.message});Pi.warn(i.message)}}}function ix(t){return`${t.name}!${t.options.appId}`}const II=1024,OI=30;class jI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new kI(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Pb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>OI){const a=NI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Pi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Pb(),{heartbeatsToSend:n,unsentEntries:i}=MI(this._heartbeatsCache.heartbeats),a=hh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Pi.warn(e),""}}}function Pb(){return new Date().toISOString().substring(0,10)}function MI(t,e=II){const n=[];let i=t.slice();for(const a of t){const l=n.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),Vb(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Vb(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class kI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bD()?ED().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await DI(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Nb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Nb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Vb(t){return hh(JSON.stringify({version:2,heartbeats:t})).length}function NI(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function PI(t){Fo(new Ra("platform-logger",e=>new $D(e),"PRIVATE")),Fo(new Ra("heartbeat",e=>new jI(e),"PRIVATE")),Os(Hp,Mb,t),Os(Hp,Mb,"esm2020"),Os("fire-js","")}PI("");var Lb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var js,sx;(function(){var t;function e(j,A){function R(){}R.prototype=A.prototype,j.F=A.prototype,j.prototype=new R,j.prototype.constructor=j,j.D=function(D,C,L){for(var k=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)k[ee-2]=arguments[ee];return A.prototype[C].apply(D,k)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(j,A,R){R||(R=0);const D=Array(16);if(typeof A=="string")for(var C=0;C<16;++C)D[C]=A.charCodeAt(R++)|A.charCodeAt(R++)<<8|A.charCodeAt(R++)<<16|A.charCodeAt(R++)<<24;else for(C=0;C<16;++C)D[C]=A[R++]|A[R++]<<8|A[R++]<<16|A[R++]<<24;A=j.g[0],R=j.g[1],C=j.g[2];let L=j.g[3],k;k=A+(L^R&(C^L))+D[0]+3614090360&4294967295,A=R+(k<<7&4294967295|k>>>25),k=L+(C^A&(R^C))+D[1]+3905402710&4294967295,L=A+(k<<12&4294967295|k>>>20),k=C+(R^L&(A^R))+D[2]+606105819&4294967295,C=L+(k<<17&4294967295|k>>>15),k=R+(A^C&(L^A))+D[3]+3250441966&4294967295,R=C+(k<<22&4294967295|k>>>10),k=A+(L^R&(C^L))+D[4]+4118548399&4294967295,A=R+(k<<7&4294967295|k>>>25),k=L+(C^A&(R^C))+D[5]+1200080426&4294967295,L=A+(k<<12&4294967295|k>>>20),k=C+(R^L&(A^R))+D[6]+2821735955&4294967295,C=L+(k<<17&4294967295|k>>>15),k=R+(A^C&(L^A))+D[7]+4249261313&4294967295,R=C+(k<<22&4294967295|k>>>10),k=A+(L^R&(C^L))+D[8]+1770035416&4294967295,A=R+(k<<7&4294967295|k>>>25),k=L+(C^A&(R^C))+D[9]+2336552879&4294967295,L=A+(k<<12&4294967295|k>>>20),k=C+(R^L&(A^R))+D[10]+4294925233&4294967295,C=L+(k<<17&4294967295|k>>>15),k=R+(A^C&(L^A))+D[11]+2304563134&4294967295,R=C+(k<<22&4294967295|k>>>10),k=A+(L^R&(C^L))+D[12]+1804603682&4294967295,A=R+(k<<7&4294967295|k>>>25),k=L+(C^A&(R^C))+D[13]+4254626195&4294967295,L=A+(k<<12&4294967295|k>>>20),k=C+(R^L&(A^R))+D[14]+2792965006&4294967295,C=L+(k<<17&4294967295|k>>>15),k=R+(A^C&(L^A))+D[15]+1236535329&4294967295,R=C+(k<<22&4294967295|k>>>10),k=A+(C^L&(R^C))+D[1]+4129170786&4294967295,A=R+(k<<5&4294967295|k>>>27),k=L+(R^C&(A^R))+D[6]+3225465664&4294967295,L=A+(k<<9&4294967295|k>>>23),k=C+(A^R&(L^A))+D[11]+643717713&4294967295,C=L+(k<<14&4294967295|k>>>18),k=R+(L^A&(C^L))+D[0]+3921069994&4294967295,R=C+(k<<20&4294967295|k>>>12),k=A+(C^L&(R^C))+D[5]+3593408605&4294967295,A=R+(k<<5&4294967295|k>>>27),k=L+(R^C&(A^R))+D[10]+38016083&4294967295,L=A+(k<<9&4294967295|k>>>23),k=C+(A^R&(L^A))+D[15]+3634488961&4294967295,C=L+(k<<14&4294967295|k>>>18),k=R+(L^A&(C^L))+D[4]+3889429448&4294967295,R=C+(k<<20&4294967295|k>>>12),k=A+(C^L&(R^C))+D[9]+568446438&4294967295,A=R+(k<<5&4294967295|k>>>27),k=L+(R^C&(A^R))+D[14]+3275163606&4294967295,L=A+(k<<9&4294967295|k>>>23),k=C+(A^R&(L^A))+D[3]+4107603335&4294967295,C=L+(k<<14&4294967295|k>>>18),k=R+(L^A&(C^L))+D[8]+1163531501&4294967295,R=C+(k<<20&4294967295|k>>>12),k=A+(C^L&(R^C))+D[13]+2850285829&4294967295,A=R+(k<<5&4294967295|k>>>27),k=L+(R^C&(A^R))+D[2]+4243563512&4294967295,L=A+(k<<9&4294967295|k>>>23),k=C+(A^R&(L^A))+D[7]+1735328473&4294967295,C=L+(k<<14&4294967295|k>>>18),k=R+(L^A&(C^L))+D[12]+2368359562&4294967295,R=C+(k<<20&4294967295|k>>>12),k=A+(R^C^L)+D[5]+4294588738&4294967295,A=R+(k<<4&4294967295|k>>>28),k=L+(A^R^C)+D[8]+2272392833&4294967295,L=A+(k<<11&4294967295|k>>>21),k=C+(L^A^R)+D[11]+1839030562&4294967295,C=L+(k<<16&4294967295|k>>>16),k=R+(C^L^A)+D[14]+4259657740&4294967295,R=C+(k<<23&4294967295|k>>>9),k=A+(R^C^L)+D[1]+2763975236&4294967295,A=R+(k<<4&4294967295|k>>>28),k=L+(A^R^C)+D[4]+1272893353&4294967295,L=A+(k<<11&4294967295|k>>>21),k=C+(L^A^R)+D[7]+4139469664&4294967295,C=L+(k<<16&4294967295|k>>>16),k=R+(C^L^A)+D[10]+3200236656&4294967295,R=C+(k<<23&4294967295|k>>>9),k=A+(R^C^L)+D[13]+681279174&4294967295,A=R+(k<<4&4294967295|k>>>28),k=L+(A^R^C)+D[0]+3936430074&4294967295,L=A+(k<<11&4294967295|k>>>21),k=C+(L^A^R)+D[3]+3572445317&4294967295,C=L+(k<<16&4294967295|k>>>16),k=R+(C^L^A)+D[6]+76029189&4294967295,R=C+(k<<23&4294967295|k>>>9),k=A+(R^C^L)+D[9]+3654602809&4294967295,A=R+(k<<4&4294967295|k>>>28),k=L+(A^R^C)+D[12]+3873151461&4294967295,L=A+(k<<11&4294967295|k>>>21),k=C+(L^A^R)+D[15]+530742520&4294967295,C=L+(k<<16&4294967295|k>>>16),k=R+(C^L^A)+D[2]+3299628645&4294967295,R=C+(k<<23&4294967295|k>>>9),k=A+(C^(R|~L))+D[0]+4096336452&4294967295,A=R+(k<<6&4294967295|k>>>26),k=L+(R^(A|~C))+D[7]+1126891415&4294967295,L=A+(k<<10&4294967295|k>>>22),k=C+(A^(L|~R))+D[14]+2878612391&4294967295,C=L+(k<<15&4294967295|k>>>17),k=R+(L^(C|~A))+D[5]+4237533241&4294967295,R=C+(k<<21&4294967295|k>>>11),k=A+(C^(R|~L))+D[12]+1700485571&4294967295,A=R+(k<<6&4294967295|k>>>26),k=L+(R^(A|~C))+D[3]+2399980690&4294967295,L=A+(k<<10&4294967295|k>>>22),k=C+(A^(L|~R))+D[10]+4293915773&4294967295,C=L+(k<<15&4294967295|k>>>17),k=R+(L^(C|~A))+D[1]+2240044497&4294967295,R=C+(k<<21&4294967295|k>>>11),k=A+(C^(R|~L))+D[8]+1873313359&4294967295,A=R+(k<<6&4294967295|k>>>26),k=L+(R^(A|~C))+D[15]+4264355552&4294967295,L=A+(k<<10&4294967295|k>>>22),k=C+(A^(L|~R))+D[6]+2734768916&4294967295,C=L+(k<<15&4294967295|k>>>17),k=R+(L^(C|~A))+D[13]+1309151649&4294967295,R=C+(k<<21&4294967295|k>>>11),k=A+(C^(R|~L))+D[4]+4149444226&4294967295,A=R+(k<<6&4294967295|k>>>26),k=L+(R^(A|~C))+D[11]+3174756917&4294967295,L=A+(k<<10&4294967295|k>>>22),k=C+(A^(L|~R))+D[2]+718787259&4294967295,C=L+(k<<15&4294967295|k>>>17),k=R+(L^(C|~A))+D[9]+3951481745&4294967295,j.g[0]=j.g[0]+A&4294967295,j.g[1]=j.g[1]+(C+(k<<21&4294967295|k>>>11))&4294967295,j.g[2]=j.g[2]+C&4294967295,j.g[3]=j.g[3]+L&4294967295}i.prototype.v=function(j,A){A===void 0&&(A=j.length);const R=A-this.blockSize,D=this.C;let C=this.h,L=0;for(;L<A;){if(C==0)for(;L<=R;)a(this,j,L),L+=this.blockSize;if(typeof j=="string"){for(;L<A;)if(D[C++]=j.charCodeAt(L++),C==this.blockSize){a(this,D),C=0;break}}else for(;L<A;)if(D[C++]=j[L++],C==this.blockSize){a(this,D),C=0;break}}this.h=C,this.o+=A},i.prototype.A=function(){var j=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);j[0]=128;for(var A=1;A<j.length-8;++A)j[A]=0;A=this.o*8;for(var R=j.length-8;R<j.length;++R)j[R]=A&255,A/=256;for(this.v(j),j=Array(16),A=0,R=0;R<4;++R)for(let D=0;D<32;D+=8)j[A++]=this.g[R]>>>D&255;return j};function l(j,A){var R=d;return Object.prototype.hasOwnProperty.call(R,j)?R[j]:R[j]=A(j)}function u(j,A){this.h=A;const R=[];let D=!0;for(let C=j.length-1;C>=0;C--){const L=j[C]|0;D&&L==A||(R[C]=L,D=!1)}this.g=R}var d={};function f(j){return-128<=j&&j<128?l(j,function(A){return new u([A|0],A<0?-1:0)}):new u([j|0],j<0?-1:0)}function g(j){if(isNaN(j)||!isFinite(j))return v;if(j<0)return N(g(-j));const A=[];let R=1;for(let D=0;j>=R;D++)A[D]=j/R|0,R*=4294967296;return new u(A,0)}function _(j,A){if(j.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(j.charAt(0)=="-")return N(_(j.substring(1),A));if(j.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=g(Math.pow(A,8));let D=v;for(let L=0;L<j.length;L+=8){var C=Math.min(8,j.length-L);const k=parseInt(j.substring(L,L+C),A);C<8?(C=g(Math.pow(A,C)),D=D.j(C).add(g(k))):(D=D.j(R),D=D.add(g(k)))}return D}var v=f(0),E=f(1),T=f(16777216);t=u.prototype,t.m=function(){if(I(this))return-N(this).m();let j=0,A=1;for(let R=0;R<this.g.length;R++){const D=this.i(R);j+=(D>=0?D:4294967296+D)*A,A*=4294967296}return j},t.toString=function(j){if(j=j||10,j<2||36<j)throw Error("radix out of range: "+j);if(w(this))return"0";if(I(this))return"-"+N(this).toString(j);const A=g(Math.pow(j,6));var R=this;let D="";for(;;){const C=$(R,A).g;R=U(R,C.j(A));let L=((R.g.length>0?R.g[0]:R.h)>>>0).toString(j);if(R=C,w(R))return L+D;for(;L.length<6;)L="0"+L;D=L+D}},t.i=function(j){return j<0?0:j<this.g.length?this.g[j]:this.h};function w(j){if(j.h!=0)return!1;for(let A=0;A<j.g.length;A++)if(j.g[A]!=0)return!1;return!0}function I(j){return j.h==-1}t.l=function(j){return j=U(this,j),I(j)?-1:w(j)?0:1};function N(j){const A=j.g.length,R=[];for(let D=0;D<A;D++)R[D]=~j.g[D];return new u(R,~j.h).add(E)}t.abs=function(){return I(this)?N(this):this},t.add=function(j){const A=Math.max(this.g.length,j.g.length),R=[];let D=0;for(let C=0;C<=A;C++){let L=D+(this.i(C)&65535)+(j.i(C)&65535),k=(L>>>16)+(this.i(C)>>>16)+(j.i(C)>>>16);D=k>>>16,L&=65535,k&=65535,R[C]=k<<16|L}return new u(R,R[R.length-1]&-2147483648?-1:0)};function U(j,A){return j.add(N(A))}t.j=function(j){if(w(this)||w(j))return v;if(I(this))return I(j)?N(this).j(N(j)):N(N(this).j(j));if(I(j))return N(this.j(N(j)));if(this.l(T)<0&&j.l(T)<0)return g(this.m()*j.m());const A=this.g.length+j.g.length,R=[];for(var D=0;D<2*A;D++)R[D]=0;for(D=0;D<this.g.length;D++)for(let C=0;C<j.g.length;C++){const L=this.i(D)>>>16,k=this.i(D)&65535,ee=j.i(C)>>>16,H=j.i(C)&65535;R[2*D+2*C]+=k*H,G(R,2*D+2*C),R[2*D+2*C+1]+=L*H,G(R,2*D+2*C+1),R[2*D+2*C+1]+=k*ee,G(R,2*D+2*C+1),R[2*D+2*C+2]+=L*ee,G(R,2*D+2*C+2)}for(j=0;j<A;j++)R[j]=R[2*j+1]<<16|R[2*j];for(j=A;j<2*A;j++)R[j]=0;return new u(R,0)};function G(j,A){for(;(j[A]&65535)!=j[A];)j[A+1]+=j[A]>>>16,j[A]&=65535,A++}function z(j,A){this.g=j,this.h=A}function $(j,A){if(w(A))throw Error("division by zero");if(w(j))return new z(v,v);if(I(j))return A=$(N(j),A),new z(N(A.g),N(A.h));if(I(A))return A=$(j,N(A)),new z(N(A.g),A.h);if(j.g.length>30){if(I(j)||I(A))throw Error("slowDivide_ only works with positive integers.");for(var R=E,D=A;D.l(j)<=0;)R=J(R),D=J(D);var C=te(R,1),L=te(D,1);for(D=te(D,2),R=te(R,2);!w(D);){var k=L.add(D);k.l(j)<=0&&(C=C.add(R),L=k),D=te(D,1),R=te(R,1)}return A=U(j,C.j(A)),new z(C,A)}for(C=v;j.l(A)>=0;){for(R=Math.max(1,Math.floor(j.m()/A.m())),D=Math.ceil(Math.log(R)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),L=g(R),k=L.j(A);I(k)||k.l(j)>0;)R-=D,L=g(R),k=L.j(A);w(L)&&(L=E),C=C.add(L),j=U(j,k)}return new z(C,j)}t.B=function(j){return $(this,j).h},t.and=function(j){const A=Math.max(this.g.length,j.g.length),R=[];for(let D=0;D<A;D++)R[D]=this.i(D)&j.i(D);return new u(R,this.h&j.h)},t.or=function(j){const A=Math.max(this.g.length,j.g.length),R=[];for(let D=0;D<A;D++)R[D]=this.i(D)|j.i(D);return new u(R,this.h|j.h)},t.xor=function(j){const A=Math.max(this.g.length,j.g.length),R=[];for(let D=0;D<A;D++)R[D]=this.i(D)^j.i(D);return new u(R,this.h^j.h)};function J(j){const A=j.g.length+1,R=[];for(let D=0;D<A;D++)R[D]=j.i(D)<<1|j.i(D-1)>>>31;return new u(R,j.h)}function te(j,A){const R=A>>5;A%=32;const D=j.g.length-R,C=[];for(let L=0;L<D;L++)C[L]=A>0?j.i(L+R)>>>A|j.i(L+R+1)<<32-A:j.i(L+R);return new u(C,j.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,sx=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=g,u.fromString=_,js=u}).apply(typeof Lb<"u"?Lb:typeof self<"u"?self:typeof window<"u"?window:{});var Fd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ax,Sc,ox,Xd,$p,lx,cx,ux;(function(){var t,e=Object.defineProperty;function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fd=="object"&&Fd];for(var b=0;b<h.length;++b){var x=h[b];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var i=n(this);function a(h,b){if(b)e:{var x=i;h=h.split(".");for(var V=0;V<h.length-1;V++){var ne=h[V];if(!(ne in x))break e;x=x[ne]}h=h[h.length-1],V=x[h],b=b(V),b!=V&&b!=null&&e(x,h,{configurable:!0,writable:!0,value:b})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(b){var x=[],V;for(V in b)Object.prototype.hasOwnProperty.call(b,V)&&x.push([V,b[V]]);return x}});var l=l||{},u=this||self;function d(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function f(h,b,x){return h.call.apply(h.bind,arguments)}function g(h,b,x){return g=f,g.apply(null,arguments)}function _(h,b){var x=Array.prototype.slice.call(arguments,1);return function(){var V=x.slice();return V.push.apply(V,arguments),h.apply(this,V)}}function v(h,b){function x(){}x.prototype=b.prototype,h.Z=b.prototype,h.prototype=new x,h.prototype.constructor=h,h.Ob=function(V,ne,ce){for(var be=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)be[Le-2]=arguments[Le];return b.prototype[ne].apply(V,be)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function T(h){const b=h.length;if(b>0){const x=Array(b);for(let V=0;V<b;V++)x[V]=h[V];return x}return[]}function w(h,b){for(let V=1;V<arguments.length;V++){const ne=arguments[V];var x=typeof ne;if(x=x!="object"?x:ne?Array.isArray(ne)?"array":x:"null",x=="array"||x=="object"&&typeof ne.length=="number"){x=h.length||0;const ce=ne.length||0;h.length=x+ce;for(let be=0;be<ce;be++)h[x+be]=ne[be]}else h.push(ne)}}class I{constructor(b,x){this.i=b,this.j=x,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function N(h){u.setTimeout(()=>{throw h},0)}function U(){var h=j;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class G{constructor(){this.h=this.g=null}add(b,x){const V=z.get();V.set(b,x),this.h?this.h.next=V:this.g=V,this.h=V}}var z=new I(()=>new $,h=>h.reset());class ${constructor(){this.next=this.g=this.h=null}set(b,x){this.h=b,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let J,te=!1,j=new G,A=()=>{const h=Promise.resolve(void 0);J=()=>{h.then(R)}};function R(){for(var h;h=U();){try{h.h.call(h.g)}catch(x){N(x)}var b=z;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}te=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const x=()=>{};u.addEventListener("test",x,b),u.removeEventListener("test",x,b)}catch{}return h})();function k(h){return/^[\s\xa0]*$/.test(h)}function ee(h,b){C.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}v(ee,C),ee.prototype.init=function(h,b){const x=this.type=h.type,V=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(x=="mouseover"?b=h.fromElement:x=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&ee.Z.h.call(this)},ee.prototype.h=function(){ee.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var H="closure_listenable_"+(Math.random()*1e6|0),B=0;function q(h,b,x,V,ne){this.listener=h,this.proxy=null,this.src=b,this.type=x,this.capture=!!V,this.ha=ne,this.key=++B,this.da=this.fa=!1}function F(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Q(h,b,x){for(const V in h)b.call(x,h[V],V,h)}function W(h,b){for(const x in h)b.call(void 0,h[x],x,h)}function P(h){const b={};for(const x in h)b[x]=h[x];return b}const X="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function he(h,b){let x,V;for(let ne=1;ne<arguments.length;ne++){V=arguments[ne];for(x in V)h[x]=V[x];for(let ce=0;ce<X.length;ce++)x=X[ce],Object.prototype.hasOwnProperty.call(V,x)&&(h[x]=V[x])}}function re(h){this.src=h,this.g={},this.h=0}re.prototype.add=function(h,b,x,V,ne){const ce=h.toString();h=this.g[ce],h||(h=this.g[ce]=[],this.h++);const be=ve(h,b,V,ne);return be>-1?(b=h[be],x||(b.fa=!1)):(b=new q(b,this.src,ce,!!V,ne),b.fa=x,h.push(b)),b};function ae(h,b){const x=b.type;if(x in h.g){var V=h.g[x],ne=Array.prototype.indexOf.call(V,b,void 0),ce;(ce=ne>=0)&&Array.prototype.splice.call(V,ne,1),ce&&(F(b),h.g[x].length==0&&(delete h.g[x],h.h--))}}function ve(h,b,x,V){for(let ne=0;ne<h.length;++ne){const ce=h[ne];if(!ce.da&&ce.listener==b&&ce.capture==!!x&&ce.ha==V)return ne}return-1}var Ae="closure_lm_"+(Math.random()*1e6|0),Ee={};function Te(h,b,x,V,ne){if(Array.isArray(b)){for(let ce=0;ce<b.length;ce++)Te(h,b[ce],x,V,ne);return null}return x=Dr(x),h&&h[H]?h.J(b,x,d(V)?!!V.capture:!1,ne):fe(h,b,x,!1,V,ne)}function fe(h,b,x,V,ne,ce){if(!b)throw Error("Invalid event type");const be=d(ne)?!!ne.capture:!!ne;let Le=$n(h);if(Le||(h[Ae]=Le=new re(h)),x=Le.add(b,x,V,be,ce),x.proxy)return x;if(V=ft(),x.proxy=V,V.src=h,V.listener=x,h.addEventListener)L||(ne=be),ne===void 0&&(ne=!1),h.addEventListener(b.toString(),V,ne);else if(h.attachEvent)h.attachEvent(Ze(b.toString()),V);else if(h.addListener&&h.removeListener)h.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return x}function ft(){function h(x){return b.call(h.src,h.listener,x)}const b=kn;return h}function Be(h,b,x,V,ne){if(Array.isArray(b))for(var ce=0;ce<b.length;ce++)Be(h,b[ce],x,V,ne);else V=d(V)?!!V.capture:!!V,x=Dr(x),h&&h[H]?(h=h.i,ce=String(b).toString(),ce in h.g&&(b=h.g[ce],x=ve(b,x,V,ne),x>-1&&(F(b[x]),Array.prototype.splice.call(b,x,1),b.length==0&&(delete h.g[ce],h.h--)))):h&&(h=$n(h))&&(b=h.g[b.toString()],h=-1,b&&(h=ve(b,x,V,ne)),(x=h>-1?b[h]:null)&&bn(x))}function bn(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[H])ae(b.i,h);else{var x=h.type,V=h.proxy;b.removeEventListener?b.removeEventListener(x,V,h.capture):b.detachEvent?b.detachEvent(Ze(x),V):b.addListener&&b.removeListener&&b.removeListener(V),(x=$n(b))?(ae(x,h),x.h==0&&(x.src=null,b[Ae]=null)):F(h)}}}function Ze(h){return h in Ee?Ee[h]:Ee[h]="on"+h}function kn(h,b){if(h.da)h=!0;else{b=new ee(b,this);const x=h.listener,V=h.ha||h.src;h.fa&&bn(h),h=x.call(V,b)}return h}function $n(h){return h=h[Ae],h instanceof re?h:null}var li="__closure_events_fn_"+(Math.random()*1e9>>>0);function Dr(h){return typeof h=="function"?h:(h[li]||(h[li]=function(b){return h.handleEvent(b)}),h[li])}function bt(){D.call(this),this.i=new re(this),this.M=this,this.G=null}v(bt,D),bt.prototype[H]=!0,bt.prototype.removeEventListener=function(h,b,x,V){Be(this,h,b,x,V)};function wt(h,b){var x,V=h.G;if(V)for(x=[];V;V=V.G)x.push(V);if(h=h.M,V=b.type||b,typeof b=="string")b=new C(b,h);else if(b instanceof C)b.target=b.target||h;else{var ne=b;b=new C(V,h),he(b,ne)}ne=!0;let ce,be;if(x)for(be=x.length-1;be>=0;be--)ce=b.g=x[be],ne=qi(ce,V,!0,b)&&ne;if(ce=b.g=h,ne=qi(ce,V,!0,b)&&ne,ne=qi(ce,V,!1,b)&&ne,x)for(be=0;be<x.length;be++)ce=b.g=x[be],ne=qi(ce,V,!1,b)&&ne}bt.prototype.N=function(){if(bt.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const x=h.g[b];for(let V=0;V<x.length;V++)F(x[V]);delete h.g[b],h.h--}}this.G=null},bt.prototype.J=function(h,b,x,V){return this.i.add(String(h),b,!1,x,V)},bt.prototype.K=function(h,b,x,V){return this.i.add(String(h),b,!0,x,V)};function qi(h,b,x,V){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let ne=!0;for(let ce=0;ce<b.length;++ce){const be=b[ce];if(be&&!be.da&&be.capture==x){const Le=be.listener,It=be.ha||be.src;be.fa&&ae(h.i,be),ne=Le.call(It,V)!==!1&&ne}}return ne&&!V.defaultPrevented}function ff(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:u.setTimeout(h,b||0)}function du(h){h.g=ff(()=>{h.g=null,h.i&&(h.i=!1,du(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class En extends D{constructor(b,x){super(),this.m=b,this.l=x,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:du(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $s(h){D.call(this),this.h=h,this.g={}}v($s,D);var pl=[];function gl(h){Q(h.g,function(b,x){this.g.hasOwnProperty(x)&&bn(b)},h),h.g={}}$s.prototype.N=function(){$s.Z.N.call(this),gl(this)},$s.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Gi=u.JSON.stringify,mf=u.JSON.parse,hu=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function fu(){}function mu(){}var fr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function rn(){C.call(this,"d")}v(rn,C);function Yn(){C.call(this,"c")}v(Yn,C);var Dt={},pu=null;function Ba(){return pu=pu||new bt}Dt.Ia="serverreachability";function gu(h){C.call(this,Dt.Ia,h)}v(gu,C);function Ir(h){const b=Ba();wt(b,new gu(b))}Dt.STAT_EVENT="statevent";function Ys(h,b){C.call(this,Dt.STAT_EVENT,h),this.stat=b}v(Ys,C);function Nt(h){const b=Ba();wt(b,new Ys(b,h))}Dt.Ja="timingevent";function Or(h,b){C.call(this,Dt.Ja,h),this.size=b}v(Or,C);function jr(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},b)}function mr(){this.g=!0}mr.prototype.ua=function(){this.g=!1};function pf(h,b,x,V,ne,ce){h.info(function(){if(h.g)if(ce){var be="",Le=ce.split("&");for(let rt=0;rt<Le.length;rt++){var It=Le[rt].split("=");if(It.length>1){const Et=It[0];It=It[1];const Zn=Et.split("_");be=Zn.length>=2&&Zn[1]=="type"?be+(Et+"="+It+"&"):be+(Et+"=redacted&")}}}else be=null;else be=ce;return"XMLHTTP REQ ("+V+") [attempt "+ne+"]: "+b+`
`+x+`
`+be})}function yu(h,b,x,V,ne,ce,be){h.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+ne+"]: "+b+`
`+x+`
`+ce+" "+be})}function Mr(h,b,x,V){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+gf(h,x)+(V?" "+V:"")})}function Ws(h,b){h.info(function(){return"TIMEOUT: "+b})}mr.prototype.info=function(){};function gf(h,b){if(!h.g)return b;if(!b)return null;try{const ce=JSON.parse(b);if(ce){for(h=0;h<ce.length;h++)if(Array.isArray(ce[h])){var x=ce[h];if(!(x.length<2)){var V=x[1];if(Array.isArray(V)&&!(V.length<1)){var ne=V[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(let be=1;be<V.length;be++)V[be]=""}}}}return Gi(ce)}catch{return b}}var Xs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},yl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},_l;function Js(){}v(Js,fu),Js.prototype.g=function(){return new XMLHttpRequest},_l=new Js;function ci(h){return encodeURIComponent(String(h))}function _u(h){var b=1;h=h.split(":");const x=[];for(;b>0&&h.length;)x.push(h.shift()),b--;return h.length&&x.push(h.join(":")),x}function pr(h,b,x,V){this.j=h,this.i=b,this.l=x,this.S=V||1,this.V=new $s(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new gr}function gr(){this.i=null,this.g="",this.h=!1}var Pt={},Xt={};function kr(h,b,x){h.M=1,h.A=Zs(Lt(b)),h.u=x,h.R=!0,za(h,null)}function za(h,b){h.F=Date.now(),Nr(h),h.B=Lt(h.A);var x=h.B,V=h.S;Array.isArray(V)||(V=[String(V)]),Ha(x.i,"t",V),h.C=0,x=h.j.L,h.h=new gr,h.g=Mu(h.j,x?b:null,!h.u),h.P>0&&(h.O=new En(g(h.Y,h,h.g),h.P)),b=h.V,x=h.g,V=h.ba;var ne="readystatechange";Array.isArray(ne)||(ne&&(pl[0]=ne.toString()),ne=pl);for(let ce=0;ce<ne.length;ce++){const be=Te(x,ne[ce],V||b.handleEvent,!1,b.h||b);if(!be)break;b.g[be.key]=be}b=h.J?P(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),Ir(),pf(h.i,h.v,h.B,h.l,h.S,h.u)}pr.prototype.ba=function(h){h=h.target;const b=this.O;b&&vr(h)==3?b.j():this.Y(h)},pr.prototype.Y=function(h){try{if(h==this.g)e:{const Le=vr(this.g),It=this.g.ya(),rt=this.g.ca();if(!(Le<3)&&(Le!=3||this.g&&(this.h.h||this.g.la()||sn(this.g)))){this.K||Le!=4||It==7||(It==8||rt<=0?Ir(3):Ir(2)),Pr(this);var b=this.g.ca();this.X=b;var x=yf(this);if(this.o=b==200,yu(this.i,this.v,this.B,this.l,this.S,Le,b),this.o){if(this.U&&!this.L){t:{if(this.g){var V,ne=this.g;if((V=ne.g?ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(V)){var ce=V;break t}}ce=null}if(h=ce)Mr(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Vr(this,h);else{this.o=!1,this.m=3,Nt(12),Nn(this),Wn(this);break e}}if(this.R){h=!0;let Et;for(;!this.K&&this.C<x.length;)if(Et=bu(this,x),Et==Xt){Le==4&&(this.m=4,Nt(14),h=!1),Mr(this.i,this.l,null,"[Incomplete Response]");break}else if(Et==Pt){this.m=4,Nt(15),Mr(this.i,this.l,x,"[Invalid Chunk]"),h=!1;break}else Mr(this.i,this.l,Et,null),Vr(this,Et);if(vu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Le!=4||x.length!=0||this.h.h||(this.m=1,Nt(16),h=!1),this.o=this.o&&h,!h)Mr(this.i,this.l,x,"[Invalid Chunked Response]"),Nn(this),Wn(this);else if(x.length>0&&!this.W){this.W=!0;var be=this.j;be.g==this&&be.aa&&!be.P&&(be.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),Ml(be),be.P=!0,Nt(11))}}else Mr(this.i,this.l,x,null),Vr(this,x);Le==4&&Nn(this),this.o&&!this.K&&(Le==4?Du(this.j,this):(this.o=!1,Nr(this)))}else di(this.g),b==400&&x.indexOf("Unknown SID")>0?(this.m=3,Nt(12)):(this.m=0,Nt(13)),Nn(this),Wn(this)}}}catch{}};function yf(h){if(!vu(h))return h.g.la();const b=sn(h.g);if(b==="")return"";let x="";const V=b.length,ne=vr(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Nn(h),Wn(h),"";h.h.i=new u.TextDecoder}for(let ce=0;ce<V;ce++)h.h.h=!0,x+=h.h.i.decode(b[ce],{stream:!(ne&&ce==V-1)});return b.length=0,h.h.g+=x,h.C=0,h.h.g}function vu(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function bu(h,b){var x=h.C,V=b.indexOf(`
`,x);return V==-1?Xt:(x=Number(b.substring(x,V)),isNaN(x)?Pt:(V+=1,V+x>b.length?Xt:(b=b.slice(V,V+x),h.C=V+x,b)))}pr.prototype.cancel=function(){this.K=!0,Nn(this)};function Nr(h){h.T=Date.now()+h.H,Fa(h,h.H)}function Fa(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=jr(g(h.aa,h),b)}function Pr(h){h.D&&(u.clearTimeout(h.D),h.D=null)}pr.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Ws(this.i,this.B),this.M!=2&&(Ir(),Nt(17)),Nn(this),this.m=2,Wn(this)):Fa(this,this.T-h)};function Wn(h){h.j.I==0||h.K||Du(h.j,h)}function Nn(h){Pr(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,gl(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function Vr(h,b){try{var x=h.j;if(x.I!=0&&(x.g==h||Ur(x.h,h))){if(!h.L&&Ur(x.h,h)&&x.I==3){try{var V=x.Ba.g.parse(b)}catch{V=null}if(Array.isArray(V)&&V.length==3){var ne=V;if(ne[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<h.F)Wa(x),Ji(x);else break e;aa(x),Nt(18)}}else x.xa=ne[1],0<x.xa-x.K&&ne[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=jr(g(x.Va,x),6e3));Lr(x.h)<=1&&x.ta&&(x.ta=void 0)}else Hr(x,11)}else if((h.L||x.g==h)&&Wa(x),!k(b))for(ne=x.Ba.g.parse(b),b=0;b<ne.length;b++){let rt=ne[b];const Et=rt[0];if(!(Et<=x.K))if(x.K=Et,rt=rt[1],x.I==2)if(rt[0]=="c"){x.M=rt[1],x.ba=rt[2];const Zn=rt[3];Zn!=null&&(x.ka=Zn,x.j.info("VER="+x.ka));const Qr=rt[4];Qr!=null&&(x.za=Qr,x.j.info("SVER="+x.za));const br=rt[5];br!=null&&typeof br=="number"&&br>0&&(V=1.5*br,x.O=V,x.j.info("backChannelRequestTimeoutMs_="+V)),V=x;const Er=h.g;if(Er){const oa=Er.g?Er.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(oa){var ce=V.h;ce.g||oa.indexOf("spdy")==-1&&oa.indexOf("quic")==-1&&oa.indexOf("h2")==-1||(ce.j=ce.l,ce.g=new Set,ce.h&&(El(ce,ce.h),ce.h=null))}if(V.G){const Xa=Er.g?Er.g.getResponseHeader("X-HTTP-Session-Id"):null;Xa&&(V.wa=Xa,at(V.J,V.G,Xa))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-h.F,x.j.info("Handshake RTT: "+x.T+"ms")),V=x;var be=h;if(V.na=ju(V,V.L?V.ba:null,V.W),be.L){Sl(V.h,be);var Le=be,It=V.O;It&&(Le.H=It),Le.D&&(Pr(Le),Nr(Le)),V.g=be}else Cu(V);x.i.length>0&&Gr(x)}else rt[0]!="stop"&&rt[0]!="close"||Hr(x,7);else x.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?Hr(x,7):Ol(x):rt[0]!="noop"&&x.l&&x.l.qa(rt),x.A=0)}}Ir(4)}catch{}}var Vt=class{constructor(h,b){this.g=h,this.map=b}};function vl(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function bl(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Lr(h){return h.h?1:h.g?h.g.size:0}function Ur(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function El(h,b){h.g?h.g.add(b):h.h=b}function Sl(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}vl.prototype.cancel=function(){if(this.i=xl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function xl(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const x of h.g.values())b=b.concat(x.G);return b}return T(h.i)}var Eu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qa(h,b){if(h){h=h.split("&");for(let x=0;x<h.length;x++){const V=h[x].indexOf("=");let ne,ce=null;V>=0?(ne=h[x].substring(0,V),ce=h[x].substring(V+1)):ne=h[x],b(ne,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function Pn(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof Pn?(this.l=h.l,Jt(this,h.j),this.o=h.o,this.g=h.g,Hi(this,h.u),this.h=h.h,wl(this,Tu(h.i)),this.m=h.m):h&&(b=String(h).match(Eu))?(this.l=!1,Jt(this,b[1]||"",!0),this.o=Br(b[2]||""),this.g=Br(b[3]||"",!0),Hi(this,b[4]),this.h=Br(b[5]||"",!0),wl(this,b[6]||"",!0),this.m=Br(b[7]||"")):(this.l=!1,this.i=new Ki(null,this.l))}Pn.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(ea(b,Ga,!0),":");var x=this.g;return(x||b=="file")&&(h.push("//"),(b=this.o)&&h.push(ea(b,Ga,!0),"@"),h.push(ci(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&h.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&h.push("/"),h.push(ea(x,x.charAt(0)=="/"?Tl:Su,!0))),(x=this.i.toString())&&h.push("?",x),(x=this.m)&&h.push("#",ea(x,xu)),h.join("")},Pn.prototype.resolve=function(h){const b=Lt(this);let x=!!h.j;x?Jt(b,h.j):x=!!h.o,x?b.o=h.o:x=!!h.g,x?b.g=h.g:x=h.u!=null;var V=h.h;if(x)Hi(b,h.u);else if(x=!!h.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var ne=b.h.lastIndexOf("/");ne!=-1&&(V=b.h.slice(0,ne+1)+V)}if(ne=V,ne==".."||ne==".")V="";else if(ne.indexOf("./")!=-1||ne.indexOf("/.")!=-1){V=ne.lastIndexOf("/",0)==0,ne=ne.split("/");const ce=[];for(let be=0;be<ne.length;){const Le=ne[be++];Le=="."?V&&be==ne.length&&ce.push(""):Le==".."?((ce.length>1||ce.length==1&&ce[0]!="")&&ce.pop(),V&&be==ne.length&&ce.push("")):(ce.push(Le),V=!0)}V=ce.join("/")}else V=ne}return x?b.h=V:x=h.i.toString()!=="",x?wl(b,Tu(h.i)):x=!!h.m,x&&(b.m=h.m),b};function Lt(h){return new Pn(h)}function Jt(h,b,x){h.j=x?Br(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function Hi(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function wl(h,b,x){b instanceof Ki?(h.i=b,Qa(h.i,h.l)):(x||(b=ea(b,Qi)),h.i=new Ki(b,h.l))}function at(h,b,x){h.i.set(b,x)}function Zs(h){return at(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Br(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ea(h,b,x){return typeof h=="string"?(h=encodeURI(h).replace(b,Tn),x&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Tn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ga=/[#\/\?@]/g,Su=/[#\?:]/g,Tl=/[#\?]/g,Qi=/[#\?@]/g,xu=/#/g;function Ki(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function An(h){h.g||(h.g=new Map,h.h=0,h.i&&qa(h.i,function(b,x){h.add(decodeURIComponent(b.replace(/\+/g," ")),x)}))}t=Ki.prototype,t.add=function(h,b){An(this),this.i=null,h=$i(this,h);let x=this.g.get(h);return x||this.g.set(h,x=[]),x.push(b),this.h+=1,this};function wu(h,b){An(h),b=$i(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Al(h,b){return An(h),b=$i(h,b),h.g.has(b)}t.forEach=function(h,b){An(this),this.g.forEach(function(x,V){x.forEach(function(ne){h.call(b,ne,V,this)},this)},this)};function Cl(h,b){An(h);let x=[];if(typeof b=="string")Al(h,b)&&(x=x.concat(h.g.get($i(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)x=x.concat(h[b]);return x}t.set=function(h,b){return An(this),this.i=null,h=$i(this,h),Al(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},t.get=function(h,b){return h?(h=Cl(this,h),h.length>0?String(h[0]):b):b};function Ha(h,b,x){wu(h,b),x.length>0&&(h.i=null,h.g.set($i(h,b),T(x)),h.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let V=0;V<b.length;V++){var x=b[V];const ne=ci(x);x=Cl(this,x);for(let ce=0;ce<x.length;ce++){let be=ne;x[ce]!==""&&(be+="="+ci(x[ce])),h.push(be)}}return this.i=h.join("&")};function Tu(h){const b=new Ki;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function $i(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Qa(h,b){b&&!h.j&&(An(h),h.i=null,h.g.forEach(function(x,V){const ne=V.toLowerCase();V!=ne&&(wu(this,V),Ha(this,ne,x))},h)),h.j=b}function yr(h,b){const x=new mr;if(u.Image){const V=new Image;V.onload=_(Xn,x,"TestLoadImage: loaded",!0,b,V),V.onerror=_(Xn,x,"TestLoadImage: error",!1,b,V),V.onabort=_(Xn,x,"TestLoadImage: abort",!1,b,V),V.ontimeout=_(Xn,x,"TestLoadImage: timeout",!1,b,V),u.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=h}else b(!1)}function Rl(h,b){const x=new mr,V=new AbortController,ne=setTimeout(()=>{V.abort(),Xn(x,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:V.signal}).then(ce=>{clearTimeout(ne),ce.ok?Xn(x,"TestPingServer: ok",!0,b):Xn(x,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ne),Xn(x,"TestPingServer: error",!1,b)})}function Xn(h,b,x,V,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),V(x)}catch{}}function Yi(){this.g=new hu}function zr(h){this.i=h.Sb||null,this.h=h.ab||!1}v(zr,fu),zr.prototype.g=function(){return new ta(this.i,this.h)};function ta(h,b){bt.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(ta,bt),t=ta.prototype,t.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,_r(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||u).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Wi(this)),this.readyState=0},t.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,_r(this)),this.g&&(this.readyState=3,_r(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ka(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ka(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}t.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Wi(this):_r(this),this.readyState==3&&Ka(this)}},t.Oa=function(h){this.g&&(this.response=this.responseText=h,Wi(this))},t.Na=function(h){this.g&&(this.response=h,Wi(this))},t.ga=function(){this.g&&Wi(this)};function Wi(h){h.readyState=4,h.l=null,h.j=null,h.B=null,_r(h)}t.setRequestHeader=function(h,b){this.A.append(h,b)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var x=b.next();!x.done;)x=x.value,h.push(x[0]+": "+x[1]),x=b.next();return h.join(`\r
`)};function _r(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(ta.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Jn(h){let b="";return Q(h,function(x,V){b+=V,b+=":",b+=x,b+=`\r
`}),b}function na(h,b,x){e:{for(V in x){var V=!1;break e}V=!0}V||(x=Jn(x),typeof h=="string"?x!=null&&ci(x):at(h,b,x))}function ct(h){bt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ct,bt);var Fr=/^https?$/i,Dl=["POST","PUT"];t=ct.prototype,t.Fa=function(h){this.H=h},t.ea=function(h,b,x,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():_l.g(),this.g.onreadystatechange=E(g(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(ce){ra(this,ce);return}if(h=x||"",x=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var ne in V)x.set(ne,V[ne]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const ce of V.keys())x.set(ce,V.get(ce));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(x.keys()).find(ce=>ce.toLowerCase()=="content-type"),ne=u.FormData&&h instanceof u.FormData,!(Array.prototype.indexOf.call(Dl,b,void 0)>=0)||V||ne||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ce,be]of x)this.g.setRequestHeader(ce,be);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(ce){ra(this,ce)}};function ra(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,Il(h),ui(h)}function Il(h){h.A||(h.A=!0,wt(h,"complete"),wt(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,wt(this,"complete"),wt(this,"abort"),ui(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ui(this,!0)),ct.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ia(this):this.Xa())},t.Xa=function(){ia(this)};function ia(h){if(h.h&&typeof l<"u"){if(h.v&&vr(h)==4)setTimeout(h.Ca.bind(h),0);else if(wt(h,"readystatechange"),vr(h)==4){h.h=!1;try{const ce=h.ca();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var x;if(!(x=b)){var V;if(V=ce===0){let be=String(h.D).match(Eu)[1]||null;!be&&u.self&&u.self.location&&(be=u.self.location.protocol.slice(0,-1)),V=!Fr.test(be?be.toLowerCase():"")}x=V}if(x)wt(h,"complete"),wt(h,"success");else{h.o=6;try{var ne=vr(h)>2?h.g.statusText:""}catch{ne=""}h.l=ne+" ["+h.ca()+"]",Il(h)}}finally{ui(h)}}}}function ui(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const x=h.g;h.g=null,b||wt(h,"ready");try{x.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function vr(h){return h.g?h.g.readyState:0}t.ca=function(){try{return vr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),mf(b)}};function sn(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function di(h){const b={};h=(h.g&&vr(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<h.length;V++){if(k(h[V]))continue;var x=_u(h[V]);const ne=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const ce=b[ne]||[];b[ne]=ce,ce.push(x)}W(b,function(V){return V.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function qr(h,b,x){return x&&x.internalChannelParams&&x.internalChannelParams[h]||b}function Xi(h){this.za=0,this.i=[],this.j=new mr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=qr("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=qr("baseRetryDelayMs",5e3,h),this.Za=qr("retryDelaySeedMs",1e4,h),this.Ta=qr("forwardChannelMaxRetries",2,h),this.va=qr("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new vl(h&&h.concurrentRequestLimit),this.Ba=new Yi,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Xi.prototype,t.ka=8,t.I=1,t.connect=function(h,b,x,V){Nt(0),this.W=h,this.H=b||{},x&&V!==void 0&&(this.H.OSID=x,this.H.OAID=V),this.F=this.X,this.J=ju(this,null,this.W),Gr(this)};function Ol(h){if($a(h),h.I==3){var b=h.V++,x=Lt(h.J);if(at(x,"SID",h.M),at(x,"RID",b),at(x,"TYPE","terminate"),sa(h,x),b=new pr(h,h.j,b),b.M=2,b.A=Zs(Lt(x)),x=!1,u.navigator&&u.navigator.sendBeacon)try{x=u.navigator.sendBeacon(b.A.toString(),"")}catch{}!x&&u.Image&&(new Image().src=b.A,x=!0),x||(b.g=Mu(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Nr(b)}Ou(h)}function Ji(h){h.g&&(Ml(h),h.g.cancel(),h.g=null)}function $a(h){Ji(h),h.v&&(u.clearTimeout(h.v),h.v=null),Wa(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&u.clearTimeout(h.m),h.m=null)}function Gr(h){if(!bl(h.h)&&!h.m){h.m=!0;var b=h.Ea;J||A(),te||(J(),te=!0),j.add(b,h),h.D=0}}function Ya(h,b){return Lr(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=jr(g(h.Ea,h,b),Iu(h,h.D)),h.D++,!0)}t.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const ne=new pr(this,this.j,h);let ce=this.o;if(this.U&&(ce?(ce=P(ce),he(ce,this.U)):ce=this.U),this.u!==null||this.R||(ne.J=ce,ce=null),this.S)e:{for(var b=0,x=0;x<this.i.length;x++){t:{var V=this.i[x];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(b+=V,b>4096){b=x;break e}if(b===4096||x===this.i.length-1){b=x+1;break e}}b=1e3}else b=1e3;b=Au(this,ne,b),x=Lt(this.J),at(x,"RID",h),at(x,"CVER",22),this.G&&at(x,"X-HTTP-Session-Id",this.G),sa(this,x),ce&&(this.R?b="headers="+ci(Jn(ce))+"&"+b:this.u&&na(x,this.u,ce)),El(this.h,ne),this.Ra&&at(x,"TYPE","init"),this.S?(at(x,"$req",b),at(x,"SID","null"),ne.U=!0,kr(ne,x,null)):kr(ne,x,b),this.I=2}}else this.I==3&&(h?jl(this,h):this.i.length==0||bl(this.h)||jl(this))};function jl(h,b){var x;b?x=b.l:x=h.V++;const V=Lt(h.J);at(V,"SID",h.M),at(V,"RID",x),at(V,"AID",h.K),sa(h,V),h.u&&h.o&&na(V,h.u,h.o),x=new pr(h,h.j,x,h.D+1),h.u===null&&(x.J=h.o),b&&(h.i=b.G.concat(h.i)),b=Au(h,x,1e3),x.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),El(h.h,x),kr(x,V,b)}function sa(h,b){h.H&&Q(h.H,function(x,V){at(b,V,x)}),h.l&&Q({},function(x,V){at(b,V,x)})}function Au(h,b,x){x=Math.min(h.i.length,x);const V=h.l?g(h.l.Ka,h.l,h):null;e:{var ne=h.i;let Le=-1;for(;;){const It=["count="+x];Le==-1?x>0?(Le=ne[0].g,It.push("ofs="+Le)):Le=0:It.push("ofs="+Le);let rt=!0;for(let Et=0;Et<x;Et++){var ce=ne[Et].g;const Zn=ne[Et].map;if(ce-=Le,ce<0)Le=Math.max(0,ne[Et].g-100),rt=!1;else try{ce="req"+ce+"_"||"";try{var be=Zn instanceof Map?Zn:Object.entries(Zn);for(const[Qr,br]of be){let Er=br;d(br)&&(Er=Gi(br)),It.push(ce+Qr+"="+encodeURIComponent(Er))}}catch(Qr){throw It.push(ce+"type="+encodeURIComponent("_badmap")),Qr}}catch{V&&V(Zn)}}if(rt){be=It.join("&");break e}}be=void 0}return h=h.i.splice(0,x),b.G=h,be}function Cu(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;J||A(),te||(J(),te=!0),j.add(b,h),h.A=0}}function aa(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=jr(g(h.Da,h),Iu(h,h.A)),h.A++,!0)}t.Da=function(){if(this.v=null,Ru(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=jr(g(this.Wa,this),h)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Nt(10),Ji(this),Ru(this))};function Ml(h){h.B!=null&&(u.clearTimeout(h.B),h.B=null)}function Ru(h){h.g=new pr(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=Lt(h.na);at(b,"RID","rpc"),at(b,"SID",h.M),at(b,"AID",h.K),at(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&at(b,"TO",h.ia),at(b,"TYPE","xmlhttp"),sa(h,b),h.u&&h.o&&na(b,h.u,h.o),h.O&&(h.g.H=h.O);var x=h.g;h=h.ba,x.M=1,x.A=Zs(Lt(b)),x.u=null,x.R=!0,za(x,h)}t.Va=function(){this.C!=null&&(this.C=null,Ji(this),aa(this),Nt(19))};function Wa(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function Du(h,b){var x=null;if(h.g==b){Wa(h),Ml(h),h.g=null;var V=2}else if(Ur(h.h,b))x=b.G,Sl(h.h,b),V=1;else return;if(h.I!=0){if(b.o)if(V==1){x=b.u?b.u.length:0,b=Date.now()-b.F;var ne=h.D;V=Ba(),wt(V,new Or(V,x)),Gr(h)}else Cu(h);else if(ne=b.m,ne==3||ne==0&&b.X>0||!(V==1&&Ya(h,b)||V==2&&aa(h)))switch(x&&x.length>0&&(b=h.h,b.i=b.i.concat(x)),ne){case 1:Hr(h,5);break;case 4:Hr(h,10);break;case 3:Hr(h,6);break;default:Hr(h,2)}}}function Iu(h,b){let x=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(x*=2),x*b}function Hr(h,b){if(h.j.info("Error code "+b),b==2){var x=g(h.bb,h),V=h.Ua;const ne=!V;V=new Pn(V||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Jt(V,"https"),Zs(V),ne?yr(V.toString(),x):Rl(V.toString(),x)}else Nt(2);h.I=0,h.l&&h.l.pa(b),Ou(h),$a(h)}t.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Nt(2)):(this.j.info("Failed to ping google.com"),Nt(1))};function Ou(h){if(h.I=0,h.ja=[],h.l){const b=xl(h.h);(b.length!=0||h.i.length!=0)&&(w(h.ja,b),w(h.ja,h.i),h.h.i.length=0,T(h.i),h.i.length=0),h.l.oa()}}function ju(h,b,x){var V=x instanceof Pn?Lt(x):new Pn(x);if(V.g!="")b&&(V.g=b+"."+V.g),Hi(V,V.u);else{var ne=u.location;V=ne.protocol,b=b?b+"."+ne.hostname:ne.hostname,ne=+ne.port;const ce=new Pn(null);V&&Jt(ce,V),b&&(ce.g=b),ne&&Hi(ce,ne),x&&(ce.h=x),V=ce}return x=h.G,b=h.wa,x&&b&&at(V,x,b),at(V,"VER",h.ka),sa(h,V),V}function Mu(h,b,x){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new ct(new zr({ab:x})):new ct(h.ma),b.Fa(h.L),b}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ku(){}t=ku.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Zi(){}Zi.prototype.g=function(h,b){return new Sn(h,b)};function Sn(h,b){bt.call(this),this.g=new Xi(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!k(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!k(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new hi(this)}v(Sn,bt),Sn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Sn.prototype.close=function(){Ol(this.g)},Sn.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var x={};x.__data__=h,h=x}else this.v&&(x={},x.__data__=Gi(h),h=x);b.i.push(new Vt(b.Ya++,h)),b.I==3&&Gr(b)},Sn.prototype.N=function(){this.g.l=null,delete this.j,Ol(this.g),delete this.g,Sn.Z.N.call(this)};function Nu(h){rn.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const x in b){h=x;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}v(Nu,rn);function Pu(){Yn.call(this),this.status=1}v(Pu,Yn);function hi(h){this.g=h}v(hi,ku),hi.prototype.ra=function(){wt(this.g,"a")},hi.prototype.qa=function(h){wt(this.g,new Nu(h))},hi.prototype.pa=function(h){wt(this.g,new Pu)},hi.prototype.oa=function(){wt(this.g,"b")},Zi.prototype.createWebChannel=Zi.prototype.g,Sn.prototype.send=Sn.prototype.o,Sn.prototype.open=Sn.prototype.m,Sn.prototype.close=Sn.prototype.close,ux=function(){return new Zi},cx=function(){return Ba()},lx=Dt,$p={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Xs.NO_ERROR=0,Xs.TIMEOUT=8,Xs.HTTP_ERROR=6,Xd=Xs,yl.COMPLETE="complete",ox=yl,mu.EventType=fr,fr.OPEN="a",fr.CLOSE="b",fr.ERROR="c",fr.MESSAGE="d",bt.prototype.listen=bt.prototype.J,Sc=mu,ct.prototype.listenOnce=ct.prototype.K,ct.prototype.getLastError=ct.prototype.Ha,ct.prototype.getLastErrorCode=ct.prototype.ya,ct.prototype.getStatus=ct.prototype.ca,ct.prototype.getResponseJson=ct.prototype.La,ct.prototype.getResponseText=ct.prototype.la,ct.prototype.send=ct.prototype.ea,ct.prototype.setWithCredentials=ct.prototype.Fa,ax=ct}).apply(typeof Fd<"u"?Fd:typeof self<"u"?self:typeof window<"u"?window:{});const Ub="@firebase/firestore",Bb="4.9.3";class yn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");let il="12.7.0";const Da=new kg("@firebase/firestore");function jo(){return Da.logLevel}function xe(t,...e){if(Da.logLevel<=$e.DEBUG){const n=e.map(Vg);Da.debug(`Firestore (${il}): ${t}`,...n)}}function Vi(t,...e){if(Da.logLevel<=$e.ERROR){const n=e.map(Vg);Da.error(`Firestore (${il}): ${t}`,...n)}}function qo(t,...e){if(Da.logLevel<=$e.WARN){const n=e.map(Vg);Da.warn(`Firestore (${il}): ${t}`,...n)}}function Vg(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Me(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,dx(t,i,n)}function dx(t,e,n){let i=`FIRESTORE (${il}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Vi(i),new Error(i)}function st(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||dx(e,a,i)}function Ve(t,e){return t}const ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends Fi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ji{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class hx{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class VI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(yn.UNAUTHENTICATED)))}shutdown(){}}class LI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class UI{constructor(e){this.t=e,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){st(this.o===void 0,42304);let i=this.i;const a=f=>this.i!==i?(i=this.i,n(f)):Promise.resolve();let l=new ji;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new ji,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const f=l;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},d=f=>{xe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(xe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new ji)}}),0),u()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(xe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(st(typeof i.accessToken=="string",31837,{l:i}),new hx(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return st(e===null||typeof e=="string",2055,{h:e}),new yn(e)}}class BI{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class zI{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new BI(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(yn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class zb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class FI{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Tr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){st(this.o===void 0,3512);const i=l=>{l.error!=null&&xe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,xe("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{xe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):xe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new zb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(st(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new zb(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function qI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class Lg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=qI(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function Ye(t,e){return t<e?-1:t>e?1:0}function Yp(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return Tp(a)===Tp(l)?Ye(a,l):Tp(a)?1:-1}return Ye(t.length,e.length)}const GI=55296,HI=57343;function Tp(t){const e=t.charCodeAt(0);return e>=GI&&e<=HI}function Go(t,e,n){return t.length===e.length&&t.every(((i,a)=>n(i,e[a])))}const Fb="__name__";class Xr{constructor(e,n,i){n===void 0?n=0:n>e.length&&Me(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Me(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return Xr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Xr?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=Xr.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return Ye(e.length,n.length)}static compareSegments(e,n){const i=Xr.isNumericId(e),a=Xr.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?Xr.extractNumericId(e).compare(Xr.extractNumericId(n)):Yp(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return js.fromString(e.substring(4,e.length-2))}}class gt extends Xr{construct(e,n,i){return new gt(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new Se(ge.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((a=>a.length>0)))}return new gt(n)}static emptyPath(){return new gt([])}}const QI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hn extends Xr{construct(e,n,i){return new hn(e,n,i)}static isValidIdentifier(e){return QI.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Fb}static keyField(){return new hn([Fb])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new Se(ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let u=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new Se(ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Se(ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,a+=2}else d==="`"?(u=!u,a++):d!=="."||u?(i+=d,a++):(l(),a++)}if(l(),u)throw new Se(ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hn(n)}static emptyPath(){return new hn([])}}class Ie{constructor(e){this.path=e}static fromPath(e){return new Ie(gt.fromString(e))}static fromName(e){return new Ie(gt.fromString(e).popFirst(5))}static empty(){return new Ie(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return gt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ie(new gt(e.slice()))}}function fx(t,e,n){if(!n)throw new Se(ge.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function KI(t,e,n,i){if(e===!0&&i===!0)throw new Se(ge.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function qb(t){if(!Ie.isDocumentKey(t))throw new Se(ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Gb(t){if(Ie.isDocumentKey(t))throw new Se(ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function mx(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function zh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Me(12329,{type:typeof t})}function Li(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Se(ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=zh(t);throw new Se(ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Qt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Zc(t,e){if(!mx(t))throw new Se(ge.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const u=t[i];if(a&&typeof u!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new Se(ge.INVALID_ARGUMENT,n);return!0}const Hb=-62135596800,Qb=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*Qb);return new vt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Se(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Se(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Hb)throw new Se(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Qb}_compareTo(e){return this.seconds===e.seconds?Ye(this.nanoseconds,e.nanoseconds):Ye(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Zc(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Hb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Qt("string",vt._jsonSchemaVersion),seconds:Qt("number"),nanoseconds:Qt("number")};class Ne{static fromTimestamp(e){return new Ne(e)}static min(){return new Ne(new vt(0,0))}static max(){return new Ne(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const zc=-1;function $I(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Ne.fromTimestamp(i===1e9?new vt(n+1,0):new vt(n,i));return new Ps(a,Ie.empty(),e)}function YI(t){return new Ps(t.readTime,t.key,zc)}class Ps{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Ps(Ne.min(),Ie.empty(),zc)}static max(){return new Ps(Ne.max(),Ie.empty(),zc)}}function WI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ie.comparator(t.documentKey,e.documentKey),n!==0?n:Ye(t.largestBatchId,e.largestBatchId))}const XI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class JI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function sl(t){if(t.code!==ge.FAILED_PRECONDITION||t.message!==XI)throw t;xe("LocalStore","Unexpectedly lost primary lease")}class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ye(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof ye?n:ye.resolve(n)}catch(n){return ye.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):ye.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):ye.reject(n)}static resolve(e){return new ye(((n,i)=>{n(e)}))}static reject(e){return new ye(((n,i)=>{i(e)}))}static waitFor(e){return new ye(((n,i)=>{let a=0,l=0,u=!1;e.forEach((d=>{++a,d.next((()=>{++l,u&&l===a&&n()}),(f=>i(f)))})),u=!0,l===a&&n()}))}static or(e){let n=ye.resolve(!1);for(const i of e)n=n.next((a=>a?ye.resolve(a):i()));return n}static forEach(e,n){const i=[];return e.forEach(((a,l)=>{i.push(n.call(this,a,l))})),this.waitFor(i)}static mapArray(e,n){return new ye(((i,a)=>{const l=e.length,u=new Array(l);let d=0;for(let f=0;f<l;f++){const g=f;n(e[g]).next((_=>{u[g]=_,++d,d===l&&i(u)}),(_=>a(_)))}}))}static doWhile(e,n){return new ye(((i,a)=>{const l=()=>{e()===!0?n().next((()=>{l()}),a):i()};l()}))}}function ZI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function al(t){return t.name==="IndexedDbTransactionError"}class Fh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Fh.ce=-1;const Ug=-1;function qh(t){return t==null}function mh(t){return t===0&&1/t==-1/0}function e2(t){return typeof t=="number"&&Number.isInteger(t)&&!mh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const px="";function t2(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Kb(e)),e=n2(t.get(n),e);return Kb(e)}function n2(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case px:n+="";break;default:n+=l}}return n}function Kb(t){return t+px+""}function $b(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function gx(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class At{constructor(e,n){this.comparator=e,this.root=n||dn.EMPTY}insert(e,n){return new At(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,dn.BLACK,null,null))}remove(e){return new At(this.comparator,this.root.remove(e,this.comparator).copy(null,null,dn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qd(this.root,e,this.comparator,!1)}getReverseIterator(){return new qd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qd(this.root,e,this.comparator,!0)}}class qd{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class dn{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??dn.RED,this.left=a??dn.EMPTY,this.right=l??dn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new dn(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return dn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return dn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,dn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,dn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Me(27949);return e+(this.isRed()?0:1)}}dn.EMPTY=null,dn.RED=!0,dn.BLACK=!1;dn.EMPTY=new class{constructor(){this.size=0}get key(){throw Me(57766)}get value(){throw Me(16141)}get color(){throw Me(16727)}get left(){throw Me(29726)}get right(){throw Me(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new dn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Wt{constructor(e){this.comparator=e,this.data=new At(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Yb(this.data.getIterator())}getIteratorFrom(e){return new Yb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof Wt)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Wt(this.comparator);return n.data=e,n}}class Yb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Hn{constructor(e){this.fields=e,e.sort(hn.comparator)}static empty(){return new Hn([])}unionWith(e){let n=new Wt(hn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new Hn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Go(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class yx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class mn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new yx("Invalid base64 string: "+l):l}})(e);return new mn(n)}static fromUint8Array(e){const n=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new mn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ye(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mn.EMPTY_BYTE_STRING=new mn("");const r2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vs(t){if(st(!!t,39018),typeof t=="string"){let e=0;const n=r2.exec(t);if(st(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Mt(t.seconds),nanos:Mt(t.nanos)}}function Mt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ls(t){return typeof t=="string"?mn.fromBase64String(t):mn.fromUint8Array(t)}const _x="server_timestamp",vx="__type__",bx="__previous_value__",Ex="__local_write_time__";function Bg(t){return(t?.mapValue?.fields||{})[vx]?.stringValue===_x}function Gh(t){const e=t.mapValue.fields[bx];return Bg(e)?Gh(e):e}function Fc(t){const e=Vs(t.mapValue.fields[Ex].timestampValue);return new vt(e.seconds,e.nanos)}class i2{constructor(e,n,i,a,l,u,d,f,g,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=g,this.isUsingEmulator=_}}const ph="(default)";class qc{constructor(e,n){this.projectId=e,this.database=n||ph}static empty(){return new qc("","")}get isDefaultDatabase(){return this.database===ph}isEqual(e){return e instanceof qc&&e.projectId===this.projectId&&e.database===this.database}}const Sx="__type__",s2="__max__",Gd={mapValue:{}},xx="__vector__",gh="value";function Us(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Bg(t)?4:o2(t)?9007199254740991:a2(t)?10:11:Me(28295,{value:t})}function ai(t,e){if(t===e)return!0;const n=Us(t);if(n!==Us(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Fc(t).isEqual(Fc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=Vs(a.timestampValue),d=Vs(l.timestampValue);return u.seconds===d.seconds&&u.nanos===d.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return Ls(a.bytesValue).isEqual(Ls(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return Mt(a.geoPointValue.latitude)===Mt(l.geoPointValue.latitude)&&Mt(a.geoPointValue.longitude)===Mt(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Mt(a.integerValue)===Mt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Mt(a.doubleValue),d=Mt(l.doubleValue);return u===d?mh(u)===mh(d):isNaN(u)&&isNaN(d)}return!1})(t,e);case 9:return Go(t.arrayValue.values||[],e.arrayValue.values||[],ai);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},d=l.mapValue.fields||{};if($b(u)!==$b(d))return!1;for(const f in u)if(u.hasOwnProperty(f)&&(d[f]===void 0||!ai(u[f],d[f])))return!1;return!0})(t,e);default:return Me(52216,{left:t})}}function Gc(t,e){return(t.values||[]).find((n=>ai(n,e)))!==void 0}function Ho(t,e){if(t===e)return 0;const n=Us(t),i=Us(e);if(n!==i)return Ye(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ye(t.booleanValue,e.booleanValue);case 2:return(function(l,u){const d=Mt(l.integerValue||l.doubleValue),f=Mt(u.integerValue||u.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(t,e);case 3:return Wb(t.timestampValue,e.timestampValue);case 4:return Wb(Fc(t),Fc(e));case 5:return Yp(t.stringValue,e.stringValue);case 6:return(function(l,u){const d=Ls(l),f=Ls(u);return d.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(l,u){const d=l.split("/"),f=u.split("/");for(let g=0;g<d.length&&g<f.length;g++){const _=Ye(d[g],f[g]);if(_!==0)return _}return Ye(d.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,u){const d=Ye(Mt(l.latitude),Mt(u.latitude));return d!==0?d:Ye(Mt(l.longitude),Mt(u.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return Xb(t.arrayValue,e.arrayValue);case 10:return(function(l,u){const d=l.fields||{},f=u.fields||{},g=d[gh]?.arrayValue,_=f[gh]?.arrayValue,v=Ye(g?.values?.length||0,_?.values?.length||0);return v!==0?v:Xb(g,_)})(t.mapValue,e.mapValue);case 11:return(function(l,u){if(l===Gd.mapValue&&u===Gd.mapValue)return 0;if(l===Gd.mapValue)return 1;if(u===Gd.mapValue)return-1;const d=l.fields||{},f=Object.keys(d),g=u.fields||{},_=Object.keys(g);f.sort(),_.sort();for(let v=0;v<f.length&&v<_.length;++v){const E=Yp(f[v],_[v]);if(E!==0)return E;const T=Ho(d[f[v]],g[_[v]]);if(T!==0)return T}return Ye(f.length,_.length)})(t.mapValue,e.mapValue);default:throw Me(23264,{he:n})}}function Wb(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ye(t,e);const n=Vs(t),i=Vs(e),a=Ye(n.seconds,i.seconds);return a!==0?a:Ye(n.nanos,i.nanos)}function Xb(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=Ho(n[a],i[a]);if(l)return l}return Ye(n.length,i.length)}function Qo(t){return Wp(t)}function Wp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=Vs(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Ls(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return Ie.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=Wp(l);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const u of i)l?l=!1:a+=",",a+=`${u}:${Wp(n.fields[u])}`;return a+"}"})(t.mapValue):Me(61005,{value:t})}function Jd(t){switch(Us(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Gh(t);return e?16+Jd(e):16;case 5:return 2*t.stringValue.length;case 6:return Ls(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+Jd(l)),0)})(t.arrayValue);case 10:case 11:return(function(i){let a=0;return qs(i.fields,((l,u)=>{a+=l.length+Jd(u)})),a})(t.mapValue);default:throw Me(13486,{value:t})}}function Jb(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Xp(t){return!!t&&"integerValue"in t}function zg(t){return!!t&&"arrayValue"in t}function Zb(t){return!!t&&"nullValue"in t}function eE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Zd(t){return!!t&&"mapValue"in t}function a2(t){return(t?.mapValue?.fields||{})[Sx]?.stringValue===xx}function Cc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return qs(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=Cc(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Cc(t.arrayValue.values[n]);return e}return{...t}}function o2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===s2}class Mn{constructor(e){this.value=e}static empty(){return new Mn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!Zd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cc(n)}setAll(e){let n=hn.emptyPath(),i={},a=[];e.forEach(((u,d)=>{if(!n.isImmediateParentOf(d)){const f=this.getFieldsMap(n);this.applyChanges(f,i,a),i={},a=[],n=d.popLast()}u?i[d.lastSegment()]=Cc(u):a.push(d.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());Zd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ai(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];Zd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){qs(n,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new Mn(Cc(this.value))}}function wx(t){const e=[];return qs(t.fields,((n,i)=>{const a=new hn([n]);if(Zd(i)){const l=wx(i.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new Hn(e)}class _n{constructor(e,n,i,a,l,u,d){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=u,this.documentState=d}static newInvalidDocument(e){return new _n(e,0,Ne.min(),Ne.min(),Ne.min(),Mn.empty(),0)}static newFoundDocument(e,n,i,a){return new _n(e,1,n,Ne.min(),i,a,0)}static newNoDocument(e,n){return new _n(e,2,n,Ne.min(),Ne.min(),Mn.empty(),0)}static newUnknownDocument(e,n){return new _n(e,3,n,Ne.min(),Ne.min(),Mn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Mn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Mn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof _n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new _n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class yh{constructor(e,n){this.position=e,this.inclusive=n}}function tE(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],u=t.position[a];if(l.field.isKeyField()?i=Ie.comparator(Ie.fromName(u.referenceValue),n.key):i=Ho(u,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function nE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ai(t.position[n],e.position[n]))return!1;return!0}class _h{constructor(e,n="asc"){this.field=e,this.dir=n}}function l2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Tx{}class Ht extends Tx{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new u2(e,n,i):n==="array-contains"?new f2(e,i):n==="in"?new m2(e,i):n==="not-in"?new p2(e,i):n==="array-contains-any"?new g2(e,i):new Ht(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new d2(e,i):new h2(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ho(n,this.value)):n!==null&&Us(this.value)===Us(n)&&this.matchesComparison(Ho(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Cr extends Tx{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Cr(e,n)}matches(e){return Ax(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ax(t){return t.op==="and"}function Cx(t){return c2(t)&&Ax(t)}function c2(t){for(const e of t.filters)if(e instanceof Cr)return!1;return!0}function Jp(t){if(t instanceof Ht)return t.field.canonicalString()+t.op.toString()+Qo(t.value);if(Cx(t))return t.filters.map((e=>Jp(e))).join(",");{const e=t.filters.map((n=>Jp(n))).join(",");return`${t.op}(${e})`}}function Rx(t,e){return t instanceof Ht?(function(i,a){return a instanceof Ht&&i.op===a.op&&i.field.isEqual(a.field)&&ai(i.value,a.value)})(t,e):t instanceof Cr?(function(i,a){return a instanceof Cr&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,u,d)=>l&&Rx(u,a.filters[d])),!0):!1})(t,e):void Me(19439)}function Dx(t){return t instanceof Ht?(function(n){return`${n.field.canonicalString()} ${n.op} ${Qo(n.value)}`})(t):t instanceof Cr?(function(n){return n.op.toString()+" {"+n.getFilters().map(Dx).join(" ,")+"}"})(t):"Filter"}class u2 extends Ht{constructor(e,n,i){super(e,n,i),this.key=Ie.fromName(i.referenceValue)}matches(e){const n=Ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class d2 extends Ht{constructor(e,n){super(e,"in",n),this.keys=Ix("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class h2 extends Ht{constructor(e,n){super(e,"not-in",n),this.keys=Ix("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function Ix(t,e){return(e.arrayValue?.values||[]).map((n=>Ie.fromName(n.referenceValue)))}class f2 extends Ht{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return zg(n)&&Gc(n.arrayValue,this.value)}}class m2 extends Ht{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Gc(this.value.arrayValue,n)}}class p2 extends Ht{constructor(e,n){super(e,"not-in",n)}matches(e){if(Gc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Gc(this.value.arrayValue,n)}}class g2 extends Ht{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!zg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>Gc(this.value.arrayValue,i)))}}class y2{constructor(e,n=null,i=[],a=[],l=null,u=null,d=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=u,this.endAt=d,this.Te=null}}function rE(t,e=null,n=[],i=[],a=null,l=null,u=null){return new y2(t,e,n,i,a,l,u)}function Fg(t){const e=Ve(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>Jp(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),qh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>Qo(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>Qo(i))).join(",")),e.Te=n}return e.Te}function qg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!l2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Rx(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!nE(t.startAt,e.startAt)&&nE(t.endAt,e.endAt)}function Zp(t){return Ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class eu{constructor(e,n=null,i=[],a=[],l=null,u="F",d=null,f=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=u,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function _2(t,e,n,i,a,l,u,d){return new eu(t,e,n,i,a,l,u,d)}function Gg(t){return new eu(t)}function iE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Ox(t){return t.collectionGroup!==null}function Rc(t){const e=Ve(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let d=new Wt(hn.comparator);return u.filters.forEach((f=>{f.getFlattenedFilters().forEach((g=>{g.isInequality()&&(d=d.add(g.field))}))})),d})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new _h(l,i))})),n.has(hn.keyField().canonicalString())||e.Ie.push(new _h(hn.keyField(),i))}return e.Ie}function Zr(t){const e=Ve(t);return e.Ee||(e.Ee=v2(e,Rc(t))),e.Ee}function v2(t,e){if(t.limitType==="F")return rE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new _h(a.field,l)}));const n=t.endAt?new yh(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new yh(t.startAt.position,t.startAt.inclusive):null;return rE(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function eg(t,e){const n=t.filters.concat([e]);return new eu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function tg(t,e,n){return new eu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Hh(t,e){return qg(Zr(t),Zr(e))&&t.limitType===e.limitType}function jx(t){return`${Fg(Zr(t))}|lt:${t.limitType}`}function Mo(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((a=>Dx(a))).join(", ")}]`),qh(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((a=>Qo(a))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((a=>Qo(a))).join(",")),`Target(${i})`})(Zr(t))}; limitType=${t.limitType})`}function Qh(t,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Ie.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(t,e)&&(function(i,a){for(const l of Rc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(i,a){return!(i.startAt&&!(function(u,d,f){const g=tE(u,d,f);return u.inclusive?g<=0:g<0})(i.startAt,Rc(i),a)||i.endAt&&!(function(u,d,f){const g=tE(u,d,f);return u.inclusive?g>=0:g>0})(i.endAt,Rc(i),a))})(t,e)}function b2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Mx(t){return(e,n)=>{let i=!1;for(const a of Rc(t)){const l=E2(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function E2(t,e,n){const i=t.field.isKeyField()?Ie.comparator(e.key,n.key):(function(l,u,d){const f=u.data.field(l),g=d.data.field(l);return f!==null&&g!==null?Ho(f,g):Me(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Me(19790,{direction:t.dir})}}class Na{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){qs(this.inner,((n,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return gx(this.inner)}size(){return this.innerSize}}const S2=new At(Ie.comparator);function Ui(){return S2}const kx=new At(Ie.comparator);function xc(...t){let e=kx;for(const n of t)e=e.insert(n.key,n);return e}function Nx(t){let e=kx;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function wa(){return Dc()}function Px(){return Dc()}function Dc(){return new Na((t=>t.toString()),((t,e)=>t.isEqual(e)))}const x2=new At(Ie.comparator),w2=new Wt(Ie.comparator);function We(...t){let e=w2;for(const n of t)e=e.add(n);return e}const T2=new Wt(Ye);function A2(){return T2}function Hg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mh(e)?"-0":e}}function Vx(t){return{integerValue:""+t}}function C2(t,e){return e2(e)?Vx(e):Hg(t,e)}class Kh{constructor(){this._=void 0}}function R2(t,e,n){return t instanceof vh?(function(a,l){const u={fields:{[vx]:{stringValue:_x},[Ex]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Bg(l)&&(l=Gh(l)),l&&(u.fields[bx]=l),{mapValue:u}})(n,e):t instanceof Ko?Ux(t,e):t instanceof Hc?Bx(t,e):(function(a,l){const u=Lx(a,l),d=sE(u)+sE(a.Ae);return Xp(u)&&Xp(a.Ae)?Vx(d):Hg(a.serializer,d)})(t,e)}function D2(t,e,n){return t instanceof Ko?Ux(t,e):t instanceof Hc?Bx(t,e):n}function Lx(t,e){return t instanceof bh?(function(i){return Xp(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class vh extends Kh{}class Ko extends Kh{constructor(e){super(),this.elements=e}}function Ux(t,e){const n=zx(e);for(const i of t.elements)n.some((a=>ai(a,i)))||n.push(i);return{arrayValue:{values:n}}}class Hc extends Kh{constructor(e){super(),this.elements=e}}function Bx(t,e){let n=zx(e);for(const i of t.elements)n=n.filter((a=>!ai(a,i)));return{arrayValue:{values:n}}}class bh extends Kh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function sE(t){return Mt(t.integerValue||t.doubleValue)}function zx(t){return zg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class I2{constructor(e,n){this.field=e,this.transform=n}}function O2(t,e){return t.field.isEqual(e.field)&&(function(i,a){return i instanceof Ko&&a instanceof Ko||i instanceof Hc&&a instanceof Hc?Go(i.elements,a.elements,ai):i instanceof bh&&a instanceof bh?ai(i.Ae,a.Ae):i instanceof vh&&a instanceof vh})(t.transform,e.transform)}class j2{constructor(e,n){this.version=e,this.transformResults=n}}class ei{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new ei}static exists(e){return new ei(void 0,e)}static updateTime(e){return new ei(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function eh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class $h{}function Fx(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Gx(t.key,ei.none()):new tu(t.key,t.data,ei.none());{const n=t.data,i=Mn.empty();let a=new Wt(hn.comparator);for(let l of e.fields)if(!a.has(l)){let u=n.field(l);u===null&&l.length>1&&(l=l.popLast(),u=n.field(l)),u===null?i.delete(l):i.set(l,u),a=a.add(l)}return new Gs(t.key,i,new Hn(a.toArray()),ei.none())}}function M2(t,e,n){t instanceof tu?(function(a,l,u){const d=a.value.clone(),f=oE(a.fieldTransforms,l,u.transformResults);d.setAll(f),l.convertToFoundDocument(u.version,d).setHasCommittedMutations()})(t,e,n):t instanceof Gs?(function(a,l,u){if(!eh(a.precondition,l))return void l.convertToUnknownDocument(u.version);const d=oE(a.fieldTransforms,l,u.transformResults),f=l.data;f.setAll(qx(a)),f.setAll(d),l.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(t,e,n):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,n)}function Ic(t,e,n,i){return t instanceof tu?(function(l,u,d,f){if(!eh(l.precondition,u))return d;const g=l.value.clone(),_=lE(l.fieldTransforms,f,u);return g.setAll(_),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),null})(t,e,n,i):t instanceof Gs?(function(l,u,d,f){if(!eh(l.precondition,u))return d;const g=lE(l.fieldTransforms,f,u),_=u.data;return _.setAll(qx(l)),_.setAll(g),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,n,i):(function(l,u,d){return eh(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):d})(t,e,n)}function k2(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=Lx(i.transform,a||null);l!=null&&(n===null&&(n=Mn.empty()),n.set(i.field,l))}return n||null}function aE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&Go(i,a,((l,u)=>O2(l,u)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class tu extends $h{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Gs extends $h{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function qx(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function oE(t,e,n){const i=new Map;st(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],u=l.transform,d=e.data.field(l.field);i.set(l.field,D2(u,d,n[a]))}return i}function lE(t,e,n){const i=new Map;for(const a of t){const l=a.transform,u=n.data.field(a.field);i.set(a.field,R2(l,u,e))}return i}class Gx extends $h{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class N2 extends $h{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class P2{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&M2(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=Ic(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=Ic(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=Px();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let d=this.applyToLocalView(u,l.mutatedFields);d=n.has(a.key)?null:d;const f=Fx(u,d);f!==null&&i.set(a.key,f),u.isValidDocument()||u.convertToNoDocument(Ne.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),We())}isEqual(e){return this.batchId===e.batchId&&Go(this.mutations,e.mutations,((n,i)=>aE(n,i)))&&Go(this.baseMutations,e.baseMutations,((n,i)=>aE(n,i)))}}class Qg{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){st(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return x2})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,i[u].version);return new Qg(e,n,i,a)}}class V2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class L2{constructor(e,n){this.count=e,this.unchangedNames=n}}var qt,Je;function U2(t){switch(t){case ge.OK:return Me(64938);case ge.CANCELLED:case ge.UNKNOWN:case ge.DEADLINE_EXCEEDED:case ge.RESOURCE_EXHAUSTED:case ge.INTERNAL:case ge.UNAVAILABLE:case ge.UNAUTHENTICATED:return!1;case ge.INVALID_ARGUMENT:case ge.NOT_FOUND:case ge.ALREADY_EXISTS:case ge.PERMISSION_DENIED:case ge.FAILED_PRECONDITION:case ge.ABORTED:case ge.OUT_OF_RANGE:case ge.UNIMPLEMENTED:case ge.DATA_LOSS:return!0;default:return Me(15467,{code:t})}}function Hx(t){if(t===void 0)return Vi("GRPC error has no .code"),ge.UNKNOWN;switch(t){case qt.OK:return ge.OK;case qt.CANCELLED:return ge.CANCELLED;case qt.UNKNOWN:return ge.UNKNOWN;case qt.DEADLINE_EXCEEDED:return ge.DEADLINE_EXCEEDED;case qt.RESOURCE_EXHAUSTED:return ge.RESOURCE_EXHAUSTED;case qt.INTERNAL:return ge.INTERNAL;case qt.UNAVAILABLE:return ge.UNAVAILABLE;case qt.UNAUTHENTICATED:return ge.UNAUTHENTICATED;case qt.INVALID_ARGUMENT:return ge.INVALID_ARGUMENT;case qt.NOT_FOUND:return ge.NOT_FOUND;case qt.ALREADY_EXISTS:return ge.ALREADY_EXISTS;case qt.PERMISSION_DENIED:return ge.PERMISSION_DENIED;case qt.FAILED_PRECONDITION:return ge.FAILED_PRECONDITION;case qt.ABORTED:return ge.ABORTED;case qt.OUT_OF_RANGE:return ge.OUT_OF_RANGE;case qt.UNIMPLEMENTED:return ge.UNIMPLEMENTED;case qt.DATA_LOSS:return ge.DATA_LOSS;default:return Me(39323,{code:t})}}(Je=qt||(qt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";function B2(){return new TextEncoder}const z2=new js([4294967295,4294967295],0);function cE(t){const e=B2().encode(t),n=new sx;return n.update(e),new Uint8Array(n.digest())}function uE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new js([n,i],0),new js([a,l],0)]}class Kg{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new wc(`Invalid padding: ${n}`);if(i<0)throw new wc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new wc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new wc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=js.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(js.fromNumber(i)));return a.compare(z2)===1&&(a=new js([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=cE(e),[i,a]=uE(n);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);if(!this.we(u))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Kg(l,a,n);return i.forEach((d=>u.insert(d))),u}insert(e){if(this.ge===0)return;const n=cE(e),[i,a]=uE(n);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);this.Se(u)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class wc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Yh{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,nu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new Yh(Ne.min(),a,new At(Ye),Ui(),We())}}class nu{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new nu(i,n,We(),We(),We())}}class th{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class Qx{constructor(e,n){this.targetId=e,this.Ce=n}}class Kx{constructor(e,n,i=mn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class dE{constructor(){this.ve=0,this.Fe=hE(),this.Me=mn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=We(),n=We(),i=We();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:Me(38017,{changeType:l})}})),new nu(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=hE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,st(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class F2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ui(),this.Je=Hd(),this.He=Hd(),this.Ye=new At(Ye)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Me(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(Zp(l))if(i===0){const u=new Ie(l.path);this.et(n,u,_n.newNoDocument(u,Ne.min()))}else st(i===1,20013,{expectedCount:i});else{const u=this._t(n);if(u!==i){const d=this.ut(e),f=d?this.ct(d,e,u):1;if(f!==0){this.it(n);const g=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,g)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let u,d;try{u=Ls(i).toUint8Array()}catch(f){if(f instanceof yx)return qo("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new Kg(u,a,l)}catch(f){return qo(f instanceof wc?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach((l=>{const u=this.Ge.ht(),d=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(n,l,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((l,u)=>{const d=this.ot(u);if(d){if(l.current&&Zp(d.target)){const f=new Ie(d.target.path);this.It(f).has(u)||this.Et(u,f)||this.et(u,f,_n.newNoDocument(f,e))}l.Be&&(n.set(u,l.ke()),l.qe())}}));let i=We();this.He.forEach(((l,u)=>{let d=!0;u.forEachWhile((f=>{const g=this.ot(f);return!g||g.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new Yh(e,n,this.Ye,this.je,i);return this.je=Ui(),this.Je=Hd(),this.He=Hd(),this.Ye=new At(Ye),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new dE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Wt(Ye),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Wt(Ye),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||xe("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new dE),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Hd(){return new At(Ie.comparator)}function hE(){return new At(Ie.comparator)}const q2={asc:"ASCENDING",desc:"DESCENDING"},G2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},H2={and:"AND",or:"OR"};class Q2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ng(t,e){return t.useProto3Json||qh(e)?e:{value:e}}function Eh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $x(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function K2(t,e){return Eh(t,e.toTimestamp())}function ti(t){return st(!!t,49232),Ne.fromTimestamp((function(n){const i=Vs(n);return new vt(i.seconds,i.nanos)})(t))}function $g(t,e){return rg(t,e).canonicalString()}function rg(t,e){const n=(function(a){return new gt(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function Yx(t){const e=gt.fromString(t);return st(ew(e),10190,{key:e.toString()}),e}function ig(t,e){return $g(t.databaseId,e.path)}function Ap(t,e){const n=Yx(e);if(n.get(1)!==t.databaseId.projectId)throw new Se(ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Se(ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ie(Xx(n))}function Wx(t,e){return $g(t.databaseId,e)}function $2(t){const e=Yx(t);return e.length===4?gt.emptyPath():Xx(e)}function sg(t){return new gt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Xx(t){return st(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function fE(t,e,n){return{name:ig(t,e),fields:n.value.mapValue.fields}}function Y2(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Me(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(g,_){return g.useProto3Json?(st(_===void 0||typeof _=="string",58123),mn.fromBase64String(_||"")):(st(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),mn.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),u=e.targetChange.cause,d=u&&(function(g){const _=g.code===void 0?ge.UNKNOWN:Hx(g.code);return new Se(_,g.message||"")})(u);n=new Kx(i,a,l,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Ap(t,i.document.name),l=ti(i.document.updateTime),u=i.document.createTime?ti(i.document.createTime):Ne.min(),d=new Mn({mapValue:{fields:i.document.fields}}),f=_n.newFoundDocument(a,l,u,d),g=i.targetIds||[],_=i.removedTargetIds||[];n=new th(g,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Ap(t,i.document),l=i.readTime?ti(i.readTime):Ne.min(),u=_n.newNoDocument(a,l),d=i.removedTargetIds||[];n=new th([],d,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Ap(t,i.document),l=i.removedTargetIds||[];n=new th([],l,a,null)}else{if(!("filter"in e))return Me(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,u=new L2(a,l),d=i.targetId;n=new Qx(d,u)}}return n}function W2(t,e){let n;if(e instanceof tu)n={update:fE(t,e.key,e.value)};else if(e instanceof Gx)n={delete:ig(t,e.key)};else if(e instanceof Gs)n={update:fE(t,e.key,e.data),updateMask:sO(e.fieldMask)};else{if(!(e instanceof N2))return Me(16599,{Vt:e.type});n={verify:ig(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const d=u.transform;if(d instanceof vh)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Ko)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Hc)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof bh)return{fieldPath:u.field.canonicalString(),increment:d.Ae};throw Me(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:K2(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Me(27497)})(t,e.precondition)),n}function X2(t,e){return t&&t.length>0?(st(e!==void 0,14353),t.map((n=>(function(a,l){let u=a.updateTime?ti(a.updateTime):ti(l);return u.isEqual(Ne.min())&&(u=ti(l)),new j2(u,a.transformResults||[])})(n,e)))):[]}function J2(t,e){return{documents:[Wx(t,e.path)]}}function Z2(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Wx(t,a);const l=(function(g){if(g.length!==0)return Zx(Cr.create(g,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const u=(function(g){if(g.length!==0)return g.map((_=>(function(E){return{field:ko(E.field),direction:nO(E.dir)}})(_)))})(e.orderBy);u&&(n.structuredQuery.orderBy=u);const d=ng(t,e.limit);return d!==null&&(n.structuredQuery.limit=d),e.startAt&&(n.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:n,parent:a}}function eO(t){let e=$2(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){st(i===1,65062);const _=n.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(v){const E=Jx(v);return E instanceof Cr&&Cx(E)?E.getFilters():[E]})(n.where));let u=[];n.orderBy&&(u=(function(v){return v.map((E=>(function(w){return new _h(No(w.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(E)))})(n.orderBy));let d=null;n.limit&&(d=(function(v){let E;return E=typeof v=="object"?v.value:v,qh(E)?null:E})(n.limit));let f=null;n.startAt&&(f=(function(v){const E=!!v.before,T=v.values||[];return new yh(T,E)})(n.startAt));let g=null;return n.endAt&&(g=(function(v){const E=!v.before,T=v.values||[];return new yh(T,E)})(n.endAt)),_2(e,a,u,l,d,"F",f,g)}function tO(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Me(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Jx(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=No(n.unaryFilter.field);return Ht.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=No(n.unaryFilter.field);return Ht.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=No(n.unaryFilter.field);return Ht.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=No(n.unaryFilter.field);return Ht.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Me(61313);default:return Me(60726)}})(t):t.fieldFilter!==void 0?(function(n){return Ht.create(No(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Me(58110);default:return Me(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Cr.create(n.compositeFilter.filters.map((i=>Jx(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Me(1026)}})(n.compositeFilter.op))})(t):Me(30097,{filter:t})}function nO(t){return q2[t]}function rO(t){return G2[t]}function iO(t){return H2[t]}function ko(t){return{fieldPath:t.canonicalString()}}function No(t){return hn.fromServerFormat(t.fieldPath)}function Zx(t){return t instanceof Ht?(function(n){if(n.op==="=="){if(eE(n.value))return{unaryFilter:{field:ko(n.field),op:"IS_NAN"}};if(Zb(n.value))return{unaryFilter:{field:ko(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(eE(n.value))return{unaryFilter:{field:ko(n.field),op:"IS_NOT_NAN"}};if(Zb(n.value))return{unaryFilter:{field:ko(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ko(n.field),op:rO(n.op),value:n.value}}})(t):t instanceof Cr?(function(n){const i=n.getFilters().map((a=>Zx(a)));return i.length===1?i[0]:{compositeFilter:{op:iO(n.op),filters:i}}})(t):Me(54877,{filter:t})}function sO(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function ew(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Cs{constructor(e,n,i,a,l=Ne.min(),u=Ne.min(),d=mn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new Cs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class aO{constructor(e){this.yt=e}}function oO(t){const e=eO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?tg(e,e.limit,"L"):e}class lO{constructor(){this.Cn=new cO}addToCollectionParentIndex(e,n){return this.Cn.add(n),ye.resolve()}getCollectionParents(e,n){return ye.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ye.resolve()}deleteFieldIndex(e,n){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,n){return ye.resolve()}getDocumentsMatchingTarget(e,n){return ye.resolve(null)}getIndexType(e,n){return ye.resolve(0)}getFieldIndexes(e,n){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,n){return ye.resolve(Ps.min())}getMinOffsetFromCollectionGroup(e,n){return ye.resolve(Ps.min())}updateCollectionGroup(e,n,i){return ye.resolve()}updateIndexEntries(e,n){return ye.resolve()}}class cO{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new Wt(gt.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new Wt(gt.comparator)).toArray()}}const mE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},tw=41943040;class jn{static withCacheSize(e){return new jn(e,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}jn.DEFAULT_COLLECTION_PERCENTILE=10,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jn.DEFAULT=new jn(tw,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jn.DISABLED=new jn(-1,0,0);class $o{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new $o(0)}static cr(){return new $o(-1)}}const pE="LruGarbageCollector",uO=1048576;function gE([t,e],[n,i]){const a=Ye(t,n);return a===0?Ye(e,i):a}class dO{constructor(e){this.Ir=e,this.buffer=new Wt(gE),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();gE(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class hO{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){xe(pE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){al(n)?xe(pE,"Ignoring IndexedDB error during garbage collection: ",n):await sl(n)}await this.Vr(3e5)}))}}class fO{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return ye.resolve(Fh.ce);const i=new dO(n);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(xe("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve(mE)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(xe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mE):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,u,d,f,g;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(xe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,u=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(i=v,d=Date.now(),this.removeTargets(e,i,n)))).next((v=>(l=v,f=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(g=Date.now(),jo()<=$e.DEBUG&&xe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${a} in `+(d-u)+`ms
	Removed ${l} targets in `+(f-d)+`ms
	Removed ${v} documents in `+(g-f)+`ms
Total Duration: ${g-_}ms`),ye.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:v}))))}}function mO(t,e){return new fO(t,e)}class pO{constructor(){this.changes=new Na((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,_n.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?ye.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class gO{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class yO{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(i!==null&&Ic(i.mutation,a,Hn.empty(),vt.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,We()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=We()){const a=wa();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,i).next((l=>{let u=xc();return l.forEach(((d,f)=>{u=u.insert(d,f.overlayedDocument)})),u}))))}getOverlayedDocuments(e,n){const i=wa();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,We())))}populateOverlays(e,n,i){const a=[];return i.forEach((l=>{n.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,d)=>{n.set(u,d)}))}))}computeViews(e,n,i,a){let l=Ui();const u=Dc(),d=(function(){return Dc()})();return n.forEach(((f,g)=>{const _=i.get(g.key);a.has(g.key)&&(_===void 0||_.mutation instanceof Gs)?l=l.insert(g.key,g):_!==void 0?(u.set(g.key,_.mutation.getFieldMask()),Ic(_.mutation,g,_.mutation.getFieldMask(),vt.now())):u.set(g.key,Hn.empty())})),this.recalculateAndSaveOverlays(e,l).next((f=>(f.forEach(((g,_)=>u.set(g,_))),n.forEach(((g,_)=>d.set(g,new gO(_,u.get(g)??null)))),d)))}recalculateAndSaveOverlays(e,n){const i=Dc();let a=new At(((u,d)=>u-d)),l=We();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((u=>{for(const d of u)d.keys().forEach((f=>{const g=n.get(f);if(g===null)return;let _=i.get(f)||Hn.empty();_=d.applyToLocalView(g,_),i.set(f,_);const v=(a.get(d.batchId)||We()).add(f);a=a.insert(d.batchId,v)}))})).next((()=>{const u=[],d=a.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),g=f.key,_=f.value,v=Px();_.forEach((E=>{if(!l.has(E)){const T=Fx(n.get(E),i.get(E));T!==null&&v.set(E,T),l=l.add(E)}})),u.push(this.documentOverlayCache.saveOverlays(e,g,v))}return ye.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,a){return(function(u){return Ie.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ox(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):ye.resolve(wa());let d=zc,f=l;return u.next((g=>ye.forEach(g,((_,v)=>(d<v.largestBatchId&&(d=v.largestBatchId),l.get(_)?ye.resolve():this.remoteDocumentCache.getEntry(e,_).next((E=>{f=f.insert(_,E)}))))).next((()=>this.populateOverlays(e,g,l))).next((()=>this.computeViews(e,f,g,We()))).next((_=>({batchId:d,changes:Nx(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ie(n)).next((i=>{let a=xc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let u=xc();return this.indexManager.getCollectionParents(e,l).next((d=>ye.forEach(d,(f=>{const g=(function(v,E){return new eu(E,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,f.child(l));return this.getDocumentsMatchingCollectionQuery(e,g,i,a).next((_=>{_.forEach(((v,E)=>{u=u.insert(v,E)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a)))).next((u=>{l.forEach(((f,g)=>{const _=g.getKey();u.get(_)===null&&(u=u.insert(_,_n.newInvalidDocument(_)))}));let d=xc();return u.forEach(((f,g)=>{const _=l.get(f);_!==void 0&&Ic(_.mutation,g,Hn.empty(),vt.now()),Qh(n,g)&&(d=d.insert(f,g))})),d}))}}class _O{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ye.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:ti(a.createTime)}})(n)),ye.resolve()}getNamedQuery(e,n){return ye.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:oO(a.bundledQuery),readTime:ti(a.readTime)}})(n)),ye.resolve()}}class vO{constructor(){this.overlays=new At(Ie.comparator),this.qr=new Map}getOverlay(e,n){return ye.resolve(this.overlays.get(n))}getOverlays(e,n){const i=wa();return ye.forEach(n,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((a,l)=>{this.St(e,n,l)})),ye.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),ye.resolve()}getOverlaysForCollection(e,n,i){const a=wa(),l=n.length+1,u=new Ie(n.child("")),d=this.overlays.getIteratorFrom(u);for(;d.hasNext();){const f=d.getNext().value,g=f.getKey();if(!n.isPrefixOf(g.path))break;g.path.length===l&&f.largestBatchId>i&&a.set(f.getKey(),f)}return ye.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new At(((g,_)=>g-_));const u=this.overlays.getIterator();for(;u.hasNext();){const g=u.getNext().value;if(g.getKey().getCollectionGroup()===n&&g.largestBatchId>i){let _=l.get(g.largestBatchId);_===null&&(_=wa(),l=l.insert(g.largestBatchId,_)),_.set(g.getKey(),g)}}const d=wa(),f=l.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((g,_)=>d.set(g,_))),!(d.size()>=a)););return ye.resolve(d)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const u=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new V2(n,i));let l=this.qr.get(n);l===void 0&&(l=We(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}class bO{constructor(){this.sessionToken=mn.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ye.resolve()}}class Yg{constructor(){this.Qr=new Wt(en.$r),this.Ur=new Wt(en.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new en(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new en(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new Ie(new gt([])),i=new en(n,e),a=new en(n,e+1),l=[];return this.Ur.forEachInRange([i,a],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Ie(new gt([])),i=new en(n,e),a=new en(n,e+1);let l=We();return this.Ur.forEachInRange([i,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const n=new en(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class en{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Ie.comparator(e.key,n.key)||Ye(e.Yr,n.Yr)}static Kr(e,n){return Ye(e.Yr,n.Yr)||Ie.comparator(e.key,n.key)}}class EO{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Wt(en.$r)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new P2(l,n,i,a);this.mutationQueue.push(u);for(const d of a)this.Zr=this.Zr.add(new en(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return ye.resolve(u)}lookupMutationBatch(e,n){return ye.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return ye.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?Ug:this.tr-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new en(n,0),a=new en(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(u=>{const d=this.Xr(u.Yr);l.push(d)})),ye.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new Wt(Ye);return n.forEach((a=>{const l=new en(a,0),u=new en(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(d=>{i=i.add(d.Yr)}))})),ye.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;Ie.isDocumentKey(l)||(l=l.child(""));const u=new en(new Ie(l),0);let d=new Wt(Ye);return this.Zr.forEachWhile((f=>{const g=f.key.path;return!!i.isPrefixOf(g)&&(g.length===a&&(d=d.add(f.Yr)),!0)}),u),ye.resolve(this.ti(d))}ti(e){const n=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){st(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ye.forEach(n.mutations,(a=>{const l=new en(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new en(n,0),a=this.Zr.firstAfterOrEqual(i);return ye.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class SO{constructor(e){this.ri=e,this.docs=(function(){return new At(Ie.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,u=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return ye.resolve(i?i.document.mutableCopy():_n.newInvalidDocument(n))}getEntries(e,n){let i=Ui();return n.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():_n.newInvalidDocument(a))})),ye.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=Ui();const u=n.path,d=new Ie(u.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:g,value:{document:_}}=f.getNext();if(!u.isPrefixOf(g.path))break;g.path.length>u.length+1||WI(YI(_),i)<=0||(a.has(_.key)||Qh(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return ye.resolve(l)}getAllFromCollectionGroup(e,n,i,a){Me(9500)}ii(e,n){return ye.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new xO(this)}getSize(e){return ye.resolve(this.size)}}class xO extends pO{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),ye.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class wO{constructor(e){this.persistence=e,this.si=new Na((n=>Fg(n)),qg),this.lastRemoteSnapshotVersion=Ne.min(),this.highestTargetId=0,this.oi=0,this._i=new Yg,this.targetCount=0,this.ai=$o.ur()}forEachTarget(e,n){return this.si.forEach(((i,a)=>n(a))),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),ye.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new $o(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ye.resolve()}updateTargetData(e,n){return this.Pr(n),ye.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach(((u,d)=>{d.sequenceNumber<=n&&i.get(d.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),ye.waitFor(l).next((()=>a))}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return ye.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),ye.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),ye.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ye.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return ye.resolve(i)}containsKey(e,n){return ye.resolve(this._i.containsKey(n))}}class nw{constructor(e,n){this.ui={},this.overlays={},this.ci=new Fh(0),this.li=!1,this.li=!0,this.hi=new bO,this.referenceDelegate=e(this),this.Pi=new wO(this),this.indexManager=new lO,this.remoteDocumentCache=(function(a){return new SO(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new aO(n),this.Ii=new _O(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new vO,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new EO(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){xe("MemoryPersistence","Starting transaction:",e);const a=new TO(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,n){return ye.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class TO extends JI{constructor(e){super(),this.currentSequenceNumber=e}}class Wg{constructor(e){this.persistence=e,this.Ri=new Yg,this.Vi=null}static mi(e){return new Wg(e)}get fi(){if(this.Vi)return this.Vi;throw Me(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),ye.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),ye.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ye.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.fi,(i=>{const a=Ie.fromPath(i);return this.gi(e,a).next((l=>{l||n.removeEntry(a,Ne.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return ye.or([()=>ye.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Sh{constructor(e,n){this.persistence=e,this.pi=new Na((i=>t2(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=mO(this,n)}static mi(e,n){return new Sh(e,n)}Ei(){}di(e){return ye.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((a=>i+a))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return ye.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?ye.resolve():n(a)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(u=>this.br(e,u,n).next((d=>{d||(i++,l.removeEntry(u,Ne.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ye.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ye.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ye.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Jd(e.data.value)),n}br(e,n,i){return ye.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return ye.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Xg{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=We(),a=We();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Xg(e,n.fromCache,i,a)}}class AO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class CO{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return vD()?8:ZI(vn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,n,a,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new AO;return this.Ss(e,n,u).next((d=>{if(l.result=d,this.Vs)return this.bs(e,n,u,d.size)}))})).next((()=>l.result))}bs(e,n,i,a){return i.documentReadCount<this.fs?(jo()<=$e.DEBUG&&xe("QueryEngine","SDK will not create cache indexes for query:",Mo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ye.resolve()):(jo()<=$e.DEBUG&&xe("QueryEngine","Query:",Mo(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(jo()<=$e.DEBUG&&xe("QueryEngine","The SDK decides to create cache indexes for query:",Mo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zr(n))):ye.resolve())}ys(e,n){if(iE(n))return ye.resolve(null);let i=Zr(n);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=tg(n,null,"F"),i=Zr(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=We(...l);return this.ps.getDocuments(e,u).next((d=>this.indexManager.getMinOffset(e,i).next((f=>{const g=this.Ds(n,d);return this.Cs(n,g,u,f.readTime)?this.ys(e,tg(n,null,"F")):this.vs(e,g,n,f)}))))})))))}ws(e,n,i,a){return iE(n)||a.isEqual(Ne.min())?ye.resolve(null):this.ps.getDocuments(e,i).next((l=>{const u=this.Ds(n,l);return this.Cs(n,u,i,a)?ye.resolve(null):(jo()<=$e.DEBUG&&xe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Mo(n)),this.vs(e,u,n,$I(a,zc)).next((d=>d)))}))}Ds(e,n){let i=new Wt(Mx(e));return n.forEach(((a,l)=>{Qh(e,l)&&(i=i.add(l))})),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return jo()<=$e.DEBUG&&xe("QueryEngine","Using full collection scan to execute query:",Mo(n)),this.ps.getDocumentsMatchingQuery(e,n,Ps.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(n.forEach((u=>{l=l.insert(u.key,u)})),l)))}}const Jg="LocalStore",RO=3e8;class DO{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new At(Ye),this.xs=new Na((l=>Fg(l)),qg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yO(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function IO(t,e,n,i){return new DO(t,e,n,i)}async function rw(t,e){const n=Ve(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],d=[];let f=We();for(const g of a){u.push(g.batchId);for(const _ of g.mutations)f=f.add(_.key)}for(const g of l){d.push(g.batchId);for(const _ of g.mutations)f=f.add(_.key)}return n.localDocuments.getDocuments(i,f).next((g=>({Ls:g,removedBatchIds:u,addedBatchIds:d})))}))}))}function OO(t,e){const n=Ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,f,g,_){const v=g.batch,E=v.keys();let T=ye.resolve();return E.forEach((w=>{T=T.next((()=>_.getEntry(f,w))).next((I=>{const N=g.docVersions.get(w);st(N!==null,48541),I.version.compareTo(N)<0&&(v.applyToRemoteDocument(I,g),I.isValidDocument()&&(I.setReadTime(g.commitVersion),_.addEntry(I)))}))})),T.next((()=>d.mutationQueue.removeMutationBatch(f,v)))})(n,i,e,l).next((()=>l.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let f=We();for(let g=0;g<d.mutationResults.length;++g)d.mutationResults[g].transformResults.length>0&&(f=f.add(d.batch.mutations[g].key));return f})(e)))).next((()=>n.localDocuments.getDocuments(i,a)))}))}function iw(t){const e=Ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function jO(t,e){const n=Ve(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const d=[];e.targetChanges.forEach(((_,v)=>{const E=a.get(v);if(!E)return;d.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,v))));let T=E.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?T=T.withResumeToken(mn.EMPTY_BYTE_STRING,Ne.min()).withLastLimboFreeSnapshotVersion(Ne.min()):_.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(_.resumeToken,i)),a=a.insert(v,T),(function(I,N,U){return I.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=RO?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0})(E,T,_)&&d.push(n.Pi.updateTargetData(l,T))}));let f=Ui(),g=We();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),d.push(MO(l,u,e.documentUpdates).next((_=>{f=_.ks,g=_.qs}))),!i.isEqual(Ne.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));d.push(_)}return ye.waitFor(d).next((()=>u.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,f,g))).next((()=>f))})).then((l=>(n.Ms=a,l)))}function MO(t,e,n){let i=We(),a=We();return n.forEach((l=>i=i.add(l))),e.getEntries(t,i).next((l=>{let u=Ui();return n.forEach(((d,f)=>{const g=l.get(d);f.isFoundDocument()!==g.isFoundDocument()&&(a=a.add(d)),f.isNoDocument()&&f.version.isEqual(Ne.min())?(e.removeEntry(d,f.readTime),u=u.insert(d,f)):!g.isValidDocument()||f.version.compareTo(g.version)>0||f.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(f),u=u.insert(d,f)):xe(Jg,"Ignoring outdated watch update for ",d,". Current version:",g.version," Watch version:",f.version)})),{ks:u,qs:a}}))}function kO(t,e){const n=Ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Ug),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function NO(t,e){const n=Ve(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return n.Pi.getTargetData(i,e).next((l=>l?(a=l,ye.resolve(a)):n.Pi.allocateTargetId(i).next((u=>(a=new Cs(e,u,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function ag(t,e,n){const i=Ve(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!al(u))throw u;xe(Jg,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function yE(t,e,n){const i=Ve(t);let a=Ne.min(),l=We();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(f,g,_){const v=Ve(f),E=v.xs.get(_);return E!==void 0?ye.resolve(v.Ms.get(E)):v.Pi.getTargetData(g,_)})(i,u,Zr(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,d.targetId).next((f=>{l=f}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,n?a:Ne.min(),n?l:We()))).next((d=>(PO(i,b2(e),d),{documents:d,Qs:l})))))}function PO(t,e,n){let i=t.Os.get(e)||Ne.min();n.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),t.Os.set(e,i)}class _E{constructor(){this.activeTargetIds=A2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class VO{constructor(){this.Mo=new _E,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new _E,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class LO{Oo(e){}shutdown(){}}const vE="ConnectivityMonitor";class bE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){xe(vE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){xe(vE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Qd=null;function og(){return Qd===null?Qd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Qd++,"0x"+Qd.toString(16)}const Cp="RestConnection",UO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class BO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===ph?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const u=og(),d=this.zo(e,n.toUriEncodedString());xe(Cp,`Sending RPC '${e}' ${u}:`,d,i);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,l);const{host:g}=new URL(d),_=nl(g);return this.Jo(e,d,f,i,_).then((v=>(xe(Cp,`Received RPC '${e}' ${u}: `,v),v)),(v=>{throw qo(Cp,`RPC '${e}' ${u} failed with error: `,v,"url: ",d,"request:",i),v}))}Ho(e,n,i,a,l,u){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+il})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,n){const i=UO[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class zO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const gn="WebChannelConnection";class FO extends BO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const u=og();return new Promise(((d,f)=>{const g=new ax;g.setWithCredentials(!0),g.listenOnce(ox.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case Xd.NO_ERROR:const v=g.getResponseJson();xe(gn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(v)),d(v);break;case Xd.TIMEOUT:xe(gn,`RPC '${e}' ${u} timed out`),f(new Se(ge.DEADLINE_EXCEEDED,"Request time out"));break;case Xd.HTTP_ERROR:const E=g.getStatus();if(xe(gn,`RPC '${e}' ${u} failed with status:`,E,"response text:",g.getResponseText()),E>0){let T=g.getResponseJson();Array.isArray(T)&&(T=T[0]);const w=T?.error;if(w&&w.status&&w.message){const I=(function(U){const G=U.toLowerCase().replace(/_/g,"-");return Object.values(ge).indexOf(G)>=0?G:ge.UNKNOWN})(w.status);f(new Se(I,w.message))}else f(new Se(ge.UNKNOWN,"Server responded with status "+g.getStatus()))}else f(new Se(ge.UNAVAILABLE,"Connection failed."));break;default:Me(9055,{l_:e,streamId:u,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{xe(gn,`RPC '${e}' ${u} completed.`)}}));const _=JSON.stringify(a);xe(gn,`RPC '${e}' ${u} sending request:`,a),g.send(n,"POST",_,i,15)}))}T_(e,n,i){const a=og(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=ux(),d=cx(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(f.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,n,i),f.encodeInitMessageHeaders=!0;const _=l.join("");xe(gn,`Creating RPC '${e}' stream ${a}: ${_}`,f);const v=u.createWebChannel(_,f);this.I_(v);let E=!1,T=!1;const w=new zO({Yo:N=>{T?xe(gn,`Not sending because RPC '${e}' stream ${a} is closed:`,N):(E||(xe(gn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),E=!0),xe(gn,`RPC '${e}' stream ${a} sending:`,N),v.send(N))},Zo:()=>v.close()}),I=(N,U,G)=>{N.listen(U,(z=>{try{G(z)}catch($){setTimeout((()=>{throw $}),0)}}))};return I(v,Sc.EventType.OPEN,(()=>{T||(xe(gn,`RPC '${e}' stream ${a} transport opened.`),w.o_())})),I(v,Sc.EventType.CLOSE,(()=>{T||(T=!0,xe(gn,`RPC '${e}' stream ${a} transport closed`),w.a_(),this.E_(v))})),I(v,Sc.EventType.ERROR,(N=>{T||(T=!0,qo(gn,`RPC '${e}' stream ${a} transport errored. Name:`,N.name,"Message:",N.message),w.a_(new Se(ge.UNAVAILABLE,"The operation could not be completed")))})),I(v,Sc.EventType.MESSAGE,(N=>{if(!T){const U=N.data[0];st(!!U,16349);const G=U,z=G?.error||G[0]?.error;if(z){xe(gn,`RPC '${e}' stream ${a} received error:`,z);const $=z.status;let J=(function(A){const R=qt[A];if(R!==void 0)return Hx(R)})($),te=z.message;J===void 0&&(J=ge.INTERNAL,te="Unknown error status: "+$+" with message "+z.message),T=!0,w.a_(new Se(J,te)),v.close()}else xe(gn,`RPC '${e}' stream ${a} received:`,U),w.u_(U)}})),I(d,lx.STAT_EVENT,(N=>{N.stat===$p.PROXY?xe(gn,`RPC '${e}' stream ${a} detected buffering proxy`):N.stat===$p.NOPROXY&&xe(gn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function Rp(){return typeof document<"u"?document:null}function Wh(t){return new Q2(t,!0)}class sw{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&xe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const EE="PersistentStream";class aw{constructor(e,n,i,a,l,u,d,f){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new sw(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===ge.RESOURCE_EXHAUSTED?(Vi(n.toString()),Vi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===n&&this.G_(i,a)}),(i=>{e((()=>{const a=new Se(ge.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return xe(EE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(xe(EE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class qO extends aw{constructor(e,n,i,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,u),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=Y2(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Ne.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Ne.min():u.readTime?ti(u.readTime):Ne.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=sg(this.serializer),n.addTarget=(function(l,u){let d;const f=u.target;if(d=Zp(f)?{documents:J2(l,f)}:{query:Z2(l,f).ft},d.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){d.resumeToken=$x(l,u.resumeToken);const g=ng(l,u.expectedCount);g!==null&&(d.expectedCount=g)}else if(u.snapshotVersion.compareTo(Ne.min())>0){d.readTime=Eh(l,u.snapshotVersion.toTimestamp());const g=ng(l,u.expectedCount);g!==null&&(d.expectedCount=g)}return d})(this.serializer,e);const i=tO(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=sg(this.serializer),n.removeTarget=e,this.q_(n)}}class GO extends aw{constructor(e,n,i,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return st(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,st(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){st(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=X2(e.writeResults,e.commitTime),i=ti(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=sg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>W2(this.serializer,i)))};this.q_(n)}}class HO{}class QO extends HO{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Se(ge.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,rg(n,i),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Se(ge.UNKNOWN,l.toString())}))}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Ho(e,rg(n,i),a,u,d,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Se(ge.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class KO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Vi(n),this.aa=!1):xe("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ia="RemoteStore";class $O{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{Pa(this)&&(xe(Ia,"Restarting streams for network reachability change."),await(async function(f){const g=Ve(f);g.Ea.add(4),await ru(g),g.Ra.set("Unknown"),g.Ea.delete(4),await Xh(g)})(this))}))})),this.Ra=new KO(i,a)}}async function Xh(t){if(Pa(t))for(const e of t.da)await e(!0)}async function ru(t){for(const e of t.da)await e(!1)}function ow(t,e){const n=Ve(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),ny(n)?ty(n):ol(n).O_()&&ey(n,e))}function Zg(t,e){const n=Ve(t),i=ol(n);n.Ia.delete(e),i.O_()&&lw(n,e),n.Ia.size===0&&(i.O_()?i.L_():Pa(n)&&n.Ra.set("Unknown"))}function ey(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ne.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ol(t).Y_(e)}function lw(t,e){t.Va.Ue(e),ol(t).Z_(e)}function ty(t){t.Va=new F2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ol(t).start(),t.Ra.ua()}function ny(t){return Pa(t)&&!ol(t).x_()&&t.Ia.size>0}function Pa(t){return Ve(t).Ea.size===0}function cw(t){t.Va=void 0}async function YO(t){t.Ra.set("Online")}async function WO(t){t.Ia.forEach(((e,n)=>{ey(t,e)}))}async function XO(t,e){cw(t),ny(t)?(t.Ra.ha(e),ty(t)):t.Ra.set("Unknown")}async function JO(t,e,n){if(t.Ra.set("Online"),e instanceof Kx&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const d of l.targetIds)a.Ia.has(d)&&(await a.remoteSyncer.rejectListen(d,u),a.Ia.delete(d),a.Va.removeTarget(d))})(t,e)}catch(i){xe(Ia,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await xh(t,i)}else if(e instanceof th?t.Va.Ze(e):e instanceof Qx?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ne.min()))try{const i=await iw(t.localStore);n.compareTo(i)>=0&&await(function(l,u){const d=l.Va.Tt(u);return d.targetChanges.forEach(((f,g)=>{if(f.resumeToken.approximateByteSize()>0){const _=l.Ia.get(g);_&&l.Ia.set(g,_.withResumeToken(f.resumeToken,u))}})),d.targetMismatches.forEach(((f,g)=>{const _=l.Ia.get(f);if(!_)return;l.Ia.set(f,_.withResumeToken(mn.EMPTY_BYTE_STRING,_.snapshotVersion)),lw(l,f);const v=new Cs(_.target,f,g,_.sequenceNumber);ey(l,v)})),l.remoteSyncer.applyRemoteEvent(d)})(t,n)}catch(i){xe(Ia,"Failed to raise snapshot:",i),await xh(t,i)}}async function xh(t,e,n){if(!al(e))throw e;t.Ea.add(1),await ru(t),t.Ra.set("Offline"),n||(n=()=>iw(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{xe(Ia,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Xh(t)}))}function uw(t,e){return e().catch((n=>xh(t,n,e)))}async function Jh(t){const e=Ve(t),n=Bs(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ug;for(;ZO(e);)try{const a=await kO(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,e5(e,a)}catch(a){await xh(e,a)}dw(e)&&hw(e)}function ZO(t){return Pa(t)&&t.Ta.length<10}function e5(t,e){t.Ta.push(e);const n=Bs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function dw(t){return Pa(t)&&!Bs(t).x_()&&t.Ta.length>0}function hw(t){Bs(t).start()}async function t5(t){Bs(t).ra()}async function n5(t){const e=Bs(t);for(const n of t.Ta)e.ea(n.mutations)}async function r5(t,e,n){const i=t.Ta.shift(),a=Qg.from(i,e,n);await uw(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await Jh(t)}async function i5(t,e){e&&Bs(t).X_&&await(async function(i,a){if((function(u){return U2(u)&&u!==ge.ABORTED})(a.code)){const l=i.Ta.shift();Bs(i).B_(),await uw(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Jh(i)}})(t,e),dw(t)&&hw(t)}async function SE(t,e){const n=Ve(t);n.asyncQueue.verifyOperationInProgress(),xe(Ia,"RemoteStore received new credentials");const i=Pa(n);n.Ea.add(3),await ru(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Xh(n)}async function s5(t,e){const n=Ve(t);e?(n.Ea.delete(2),await Xh(n)):e||(n.Ea.add(2),await ru(n),n.Ra.set("Unknown"))}function ol(t){return t.ma||(t.ma=(function(n,i,a){const l=Ve(n);return l.sa(),new qO(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:YO.bind(null,t),t_:WO.bind(null,t),r_:XO.bind(null,t),H_:JO.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),ny(t)?ty(t):t.Ra.set("Unknown")):(await t.ma.stop(),cw(t))}))),t.ma}function Bs(t){return t.fa||(t.fa=(function(n,i,a){const l=Ve(n);return l.sa(),new GO(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:t5.bind(null,t),r_:i5.bind(null,t),ta:n5.bind(null,t),na:r5.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await Jh(t)):(await t.fa.stop(),t.Ta.length>0&&(xe(Ia,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class ry{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new ji,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const u=Date.now()+i,d=new ry(e,n,u,a,l);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function iy(t,e){if(Vi("AsyncQueue",`${e}: ${t}`),al(t))return new Se(ge.UNAVAILABLE,`${e}: ${t}`);throw t}class Vo{static emptySet(e){return new Vo(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||Ie.comparator(n.key,i.key):(n,i)=>Ie.comparator(n.key,i.key),this.keyedMap=xc(),this.sortedSet=new At(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Vo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Vo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class xE{constructor(){this.ga=new At(Ie.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Me(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class Yo{constructor(e,n,i,a,l,u,d,f,g){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=g}static fromInitialDocuments(e,n,i,a,l){const u=[];return n.forEach((d=>{u.push({type:0,doc:d})})),new Yo(e,n,Vo.emptySet(n),u,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}class a5{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class o5{constructor(){this.queries=wE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=Ve(n),l=a.queries;a.queries=wE(),l.forEach(((u,d)=>{for(const f of d.Sa)f.onError(i)}))})(this,new Se(ge.ABORTED,"Firestore shutting down"))}}function wE(){return new Na((t=>jx(t)),Hh)}async function fw(t,e){const n=Ve(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new a5,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(u){const d=iy(u,`Initialization of query '${Mo(e.query)}' failed`);return void e.onError(d)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&sy(n)}async function mw(t,e){const n=Ve(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function l5(t,e){const n=Ve(t);let i=!1;for(const a of e){const l=a.query,u=n.queries.get(l);if(u){for(const d of u.Sa)d.Fa(a)&&(i=!0);u.wa=a}}i&&sy(n)}function c5(t,e,n){const i=Ve(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function sy(t){t.Ca.forEach((e=>{e.next()}))}var lg,TE;(TE=lg||(lg={})).Ma="default",TE.Cache="cache";class pw{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new Yo(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==lg.Cache}}class gw{constructor(e){this.key=e}}class yw{constructor(e){this.key=e}}class u5{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=We(),this.mutatedKeys=We(),this.eu=Mx(e),this.tu=new Vo(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new xE,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,u=a,d=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,g=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,v)=>{const E=a.get(_),T=Qh(this.query,v)?v:null,w=!!E&&this.mutatedKeys.has(E.key),I=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let N=!1;E&&T?E.data.isEqual(T.data)?w!==I&&(i.track({type:3,doc:T}),N=!0):this.su(E,T)||(i.track({type:2,doc:T}),N=!0,(f&&this.eu(T,f)>0||g&&this.eu(T,g)<0)&&(d=!0)):!E&&T?(i.track({type:0,doc:T}),N=!0):E&&!T&&(i.track({type:1,doc:E}),N=!0,(f||g)&&(d=!0)),N&&(T?(u=u.add(T),l=I?l.add(_):l.delete(_)):(u=u.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:u,iu:i,Cs:d,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((_,v)=>(function(T,w){const I=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Me(20277,{Rt:N})}};return I(T)-I(w)})(_.type,v.type)||this.eu(_.doc,v.doc))),this.ou(i),a=a??!1;const d=n&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,g=f!==this.Za;return this.Za=f,u.length!==0||g?{snapshot:new Yo(this.query,e.tu,l,u,e.mutatedKeys,f===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new xE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=We(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new yw(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new gw(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=We();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Yo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ay="SyncEngine";class d5{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class h5{constructor(e){this.key=e,this.hu=!1}}class f5{constructor(e,n,i,a,l,u){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Na((d=>jx(d)),Hh),this.Iu=new Map,this.Eu=new Set,this.du=new At(Ie.comparator),this.Au=new Map,this.Ru=new Yg,this.Vu={},this.mu=new Map,this.fu=$o.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function m5(t,e,n=!0){const i=xw(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await _w(i,e,n,!0),a}async function p5(t,e){const n=xw(t);await _w(n,e,!0,!1)}async function _w(t,e,n,i){const a=await NO(t.localStore,Zr(e)),l=a.targetId,u=t.sharedClientState.addLocalQueryTarget(l,n);let d;return i&&(d=await g5(t,e,l,u==="current",a.resumeToken)),t.isPrimaryClient&&n&&ow(t.remoteStore,a),d}async function g5(t,e,n,i,a){t.pu=(v,E,T)=>(async function(I,N,U,G){let z=N.view.ru(U);z.Cs&&(z=await yE(I.localStore,N.query,!1).then((({documents:j})=>N.view.ru(j,z))));const $=G&&G.targetChanges.get(N.targetId),J=G&&G.targetMismatches.get(N.targetId)!=null,te=N.view.applyChanges(z,I.isPrimaryClient,$,J);return CE(I,N.targetId,te.au),te.snapshot})(t,v,E,T);const l=await yE(t.localStore,e,!0),u=new u5(e,l.Qs),d=u.ru(l.documents),f=nu.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),g=u.applyChanges(d,t.isPrimaryClient,f);CE(t,n,g.au);const _=new d5(e,n,u);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),g.snapshot}async function y5(t,e,n){const i=Ve(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((u=>!Hh(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await ag(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&Zg(i.remoteStore,a.targetId),cg(i,a.targetId)})).catch(sl)):(cg(i,a.targetId),await ag(i.localStore,a.targetId,!0))}async function _5(t,e){const n=Ve(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),Zg(n.remoteStore,i.targetId))}async function v5(t,e,n){const i=A5(t);try{const a=await(function(u,d){const f=Ve(u),g=vt.now(),_=d.reduce(((T,w)=>T.add(w.key)),We());let v,E;return f.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let w=Ui(),I=We();return f.Ns.getEntries(T,_).next((N=>{w=N,w.forEach(((U,G)=>{G.isValidDocument()||(I=I.add(U))}))})).next((()=>f.localDocuments.getOverlayedDocuments(T,w))).next((N=>{v=N;const U=[];for(const G of d){const z=k2(G,v.get(G.key).overlayedDocument);z!=null&&U.push(new Gs(G.key,z,wx(z.value.mapValue),ei.exists(!0)))}return f.mutationQueue.addMutationBatch(T,g,U,d)})).next((N=>{E=N;const U=N.applyToLocalDocumentSet(v,I);return f.documentOverlayCache.saveOverlays(T,N.batchId,U)}))})).then((()=>({batchId:E.batchId,changes:Nx(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(u,d,f){let g=u.Vu[u.currentUser.toKey()];g||(g=new At(Ye)),g=g.insert(d,f),u.Vu[u.currentUser.toKey()]=g})(i,a.batchId,n),await iu(i,a.changes),await Jh(i.remoteStore)}catch(a){const l=iy(a,"Failed to persist write");n.reject(l)}}async function vw(t,e){const n=Ve(t);try{const i=await jO(n.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=n.Au.get(l);u&&(st(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?st(u.hu,14607):a.removedDocuments.size>0&&(st(u.hu,42227),u.hu=!1))})),await iu(n,i,e)}catch(i){await sl(i)}}function AE(t,e,n){const i=Ve(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach(((l,u)=>{const d=u.view.va(e);d.snapshot&&a.push(d.snapshot)})),(function(u,d){const f=Ve(u);f.onlineState=d;let g=!1;f.queries.forEach(((_,v)=>{for(const E of v.Sa)E.va(d)&&(g=!0)})),g&&sy(f)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function b5(t,e,n){const i=Ve(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let u=new At(Ie.comparator);u=u.insert(l,_n.newNoDocument(l,Ne.min()));const d=We().add(l),f=new Yh(Ne.min(),new Map,new At(Ye),u,d);await vw(i,f),i.du=i.du.remove(l),i.Au.delete(e),oy(i)}else await ag(i.localStore,e,!1).then((()=>cg(i,e,n))).catch(sl)}async function E5(t,e){const n=Ve(t),i=e.batch.batchId;try{const a=await OO(n.localStore,e);Ew(n,i,null),bw(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await iu(n,a)}catch(a){await sl(a)}}async function S5(t,e,n){const i=Ve(t);try{const a=await(function(u,d){const f=Ve(u);return f.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let _;return f.mutationQueue.lookupMutationBatch(g,d).next((v=>(st(v!==null,37113),_=v.keys(),f.mutationQueue.removeMutationBatch(g,v)))).next((()=>f.mutationQueue.performConsistencyCheck(g))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(g,_,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,_))).next((()=>f.localDocuments.getDocuments(g,_)))}))})(i.localStore,e);Ew(i,e,n),bw(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await iu(i,a)}catch(a){await sl(a)}}function bw(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Ew(t,e,n){const i=Ve(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function cg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||Sw(t,i)}))}function Sw(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Zg(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),oy(t))}function CE(t,e,n){for(const i of n)i instanceof gw?(t.Ru.addReference(i.key,e),x5(t,i)):i instanceof yw?(xe(ay,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||Sw(t,i.key)):Me(19791,{wu:i})}function x5(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(xe(ay,"New document in limbo: "+n),t.Eu.add(i),oy(t))}function oy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Ie(gt.fromString(e)),i=t.fu.next();t.Au.set(i,new h5(n)),t.du=t.du.insert(n,i),ow(t.remoteStore,new Cs(Zr(Gg(n.path)),i,"TargetPurposeLimboResolution",Fh.ce))}}async function iu(t,e,n){const i=Ve(t),a=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,f)=>{u.push(i.pu(f,e,n).then((g=>{if((g||n)&&i.isPrimaryClient){const _=g?!g.fromCache:n?.targetChanges.get(f.targetId)?.current;i.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(g){a.push(g);const _=Xg.As(f.targetId,g);l.push(_)}})))})),await Promise.all(u),i.Pu.H_(a),await(async function(f,g){const _=Ve(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ye.forEach(g,(E=>ye.forEach(E.Es,(T=>_.persistence.referenceDelegate.addReference(v,E.targetId,T))).next((()=>ye.forEach(E.ds,(T=>_.persistence.referenceDelegate.removeReference(v,E.targetId,T)))))))))}catch(v){if(!al(v))throw v;xe(Jg,"Failed to update sequence numbers: "+v)}for(const v of g){const E=v.targetId;if(!v.fromCache){const T=_.Ms.get(E),w=T.snapshotVersion,I=T.withLastLimboFreeSnapshotVersion(w);_.Ms=_.Ms.insert(E,I)}}})(i.localStore,l))}async function w5(t,e){const n=Ve(t);if(!n.currentUser.isEqual(e)){xe(ay,"User change. New user:",e.toKey());const i=await rw(n.localStore,e);n.currentUser=e,(function(l,u){l.mu.forEach((d=>{d.forEach((f=>{f.reject(new Se(ge.CANCELLED,u))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await iu(n,i.Ls)}}function T5(t,e){const n=Ve(t),i=n.Au.get(e);if(i&&i.hu)return We().add(i.key);{let a=We();const l=n.Iu.get(e);if(!l)return a;for(const u of l){const d=n.Tu.get(u);a=a.unionWith(d.view.nu)}return a}}function xw(t){const e=Ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=vw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=T5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=b5.bind(null,e),e.Pu.H_=l5.bind(null,e.eventManager),e.Pu.yu=c5.bind(null,e.eventManager),e}function A5(t){const e=Ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=E5.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=S5.bind(null,e),e}class wh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Wh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return IO(this.persistence,new CO,e.initialUser,this.serializer)}Cu(e){return new nw(Wg.mi,this.serializer)}Du(e){return new VO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wh.provider={build:()=>new wh};class C5 extends wh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){st(this.persistence.referenceDelegate instanceof Sh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new hO(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new nw((i=>Sh.mi(i,n)),this.serializer)}}class ug{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>AE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=w5.bind(null,this.syncEngine),await s5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new o5})()}createDatastore(e){const n=Wh(e.databaseInfo.databaseId),i=(function(l){return new FO(l)})(e.databaseInfo);return(function(l,u,d,f){return new QO(l,u,d,f)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,a,l,u,d){return new $O(i,a,l,u,d)})(this.localStore,this.datastore,e.asyncQueue,(n=>AE(this.syncEngine,n,0)),(function(){return bE.v()?new bE:new LO})())}createSyncEngine(e,n){return(function(a,l,u,d,f,g,_){const v=new f5(a,l,u,d,f,g);return _&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Ve(n);xe(Ia,"RemoteStore shutting down."),i.Ea.add(5),await ru(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ug.provider={build:()=>new ug};class ww{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Vi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const zs="FirestoreClient";class R5{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=yn.UNAUTHENTICATED,this.clientId=Lg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{xe(zs,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(xe(zs,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ji;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=iy(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Dp(t,e){t.asyncQueue.verifyOperationInProgress(),xe(zs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async a=>{i.isEqual(a)||(await rw(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function RE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await D5(t);xe(zs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>SE(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,a)=>SE(e.remoteStore,a))),t._onlineComponents=e}async function D5(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){xe(zs,"Using user provided OfflineComponentProvider");try{await Dp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ge.FAILED_PRECONDITION||a.code===ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;qo("Error using user provided cache. Falling back to memory cache: "+n),await Dp(t,new wh)}}else xe(zs,"Using default OfflineComponentProvider"),await Dp(t,new C5(void 0));return t._offlineComponents}async function Tw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(xe(zs,"Using user provided OnlineComponentProvider"),await RE(t,t._uninitializedComponentsProvider._online)):(xe(zs,"Using default OnlineComponentProvider"),await RE(t,new ug))),t._onlineComponents}function I5(t){return Tw(t).then((e=>e.syncEngine))}async function Aw(t){const e=await Tw(t),n=e.eventManager;return n.onListen=m5.bind(null,e.syncEngine),n.onUnlisten=y5.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=p5.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=_5.bind(null,e.syncEngine),n}function O5(t,e,n={}){const i=new ji;return t.asyncQueue.enqueueAndForget((async()=>(function(l,u,d,f,g){const _=new ww({next:E=>{_.Nu(),u.enqueueAndForget((()=>mw(l,v)));const T=E.docs.has(d);!T&&E.fromCache?g.reject(new Se(ge.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&E.fromCache&&f&&f.source==="server"?g.reject(new Se(ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(E)},error:E=>g.reject(E)}),v=new pw(Gg(d.path),_,{includeMetadataChanges:!0,qa:!0});return fw(l,v)})(await Aw(t),t.asyncQueue,e,n,i))),i.promise}function j5(t,e,n={}){const i=new ji;return t.asyncQueue.enqueueAndForget((async()=>(function(l,u,d,f,g){const _=new ww({next:E=>{_.Nu(),u.enqueueAndForget((()=>mw(l,v))),E.fromCache&&f.source==="server"?g.reject(new Se(ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(E)},error:E=>g.reject(E)}),v=new pw(d,_,{includeMetadataChanges:!0,qa:!0});return fw(l,v)})(await Aw(t),t.asyncQueue,e,n,i))),i.promise}function Cw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const DE=new Map;const Rw="firestore.googleapis.com",IE=!0;class OE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Rw,this.ssl=IE}else this.host=e.host,this.ssl=e.ssl??IE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=tw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<uO)throw new Se(ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}KI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Cw(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Se(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Se(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Se(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Zh{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new OE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new OE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new VI;switch(i.type){case"firstParty":return new zI(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Se(ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=DE.get(n);i&&(xe("ComponentProvider","Removing Datastore"),DE.delete(n),i.terminate())})(this),Promise.resolve()}}function M5(t,e,n,i={}){t=Li(t,Zh);const a=nl(e),l=t._getSettings(),u={...l,emulatorOptions:t._getEmulatorOptions()},d=`${e}:${n}`;a&&(XS(`https://${d}`),JS("Firestore",!0)),l.host!==Rw&&l.host!==d&&qo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...l,host:d,ssl:a,emulatorOptions:i};if(!Ns(f,u)&&(t._setSettings(f),i.mockUserToken)){let g,_;if(typeof i.mockUserToken=="string")g=i.mockUserToken,_=yn.MOCK_USER;else{g=uD(i.mockUserToken,t._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new Se(ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new yn(v)}t._authCredentials=new LI(new hx(g,_))}}class ll{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new ll(this.firestore,e,this._query)}}class kt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ms(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kt(this.firestore,e,this._key)}toJSON(){return{type:kt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(Zc(n,kt._jsonSchema))return new kt(e,i||null,new Ie(gt.fromString(n.referencePath)))}}kt._jsonSchemaVersion="firestore/documentReference/1.0",kt._jsonSchema={type:Qt("string",kt._jsonSchemaVersion),referencePath:Qt("string")};class Ms extends ll{constructor(e,n,i){super(e,n,Gg(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kt(this.firestore,null,new Ie(e))}withConverter(e){return new Ms(this.firestore,e,this._path)}}function k5(t,e,...n){if(t=nn(t),fx("collection","path",e),t instanceof Zh){const i=gt.fromString(e,...n);return Gb(i),new Ms(t,null,i)}{if(!(t instanceof kt||t instanceof Ms))throw new Se(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(gt.fromString(e,...n));return Gb(i),new Ms(t.firestore,null,i)}}function ly(t,e,...n){if(t=nn(t),arguments.length===1&&(e=Lg.newId()),fx("doc","path",e),t instanceof Zh){const i=gt.fromString(e,...n);return qb(i),new kt(t,null,new Ie(i))}{if(!(t instanceof kt||t instanceof Ms))throw new Se(ge.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(gt.fromString(e,...n));return qb(i),new kt(t.firestore,t instanceof Ms?t.converter:null,new Ie(i))}}const jE="AsyncQueue";class ME{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new sw(this,"async_queue_retry"),this._c=()=>{const i=Rp();i&&xe(jE,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Rp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Rp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new ji;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!al(e))throw e;xe(jE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Vi("INTERNAL UNHANDLED ERROR: ",kE(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=ry.createAndSchedule(this,e,n,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Me(47125,{Pc:kE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function kE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class su extends Zh{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new ME,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ME(e),this._firestoreClient=void 0,await e}}}function N5(t,e){const n=typeof t=="object"?t:nx(),i=typeof t=="string"?t:ph,a=Pg(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=lD("firestore");l&&M5(a,...l)}return a}function cy(t){if(t._terminated)throw new Se(ge.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||P5(t),t._firestoreClient}function P5(t){const e=t._freezeSettings(),n=(function(a,l,u,d){return new i2(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Cw(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new R5(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(t._componentsProvider))}class cr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cr(mn.fromBase64String(e))}catch(n){throw new Se(ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new cr(mn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:cr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Zc(e,cr._jsonSchema))return cr.fromBase64String(e.bytes)}}cr._jsonSchemaVersion="firestore/bytes/1.0",cr._jsonSchema={type:Qt("string",cr._jsonSchemaVersion),bytes:Qt("string")};class ef{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Se(ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class tf{constructor(e){this._methodName=e}}class ni{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Se(ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Se(ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ye(this._lat,e._lat)||Ye(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ni._jsonSchemaVersion}}static fromJSON(e){if(Zc(e,ni._jsonSchema))return new ni(e.latitude,e.longitude)}}ni._jsonSchemaVersion="firestore/geoPoint/1.0",ni._jsonSchema={type:Qt("string",ni._jsonSchemaVersion),latitude:Qt("number"),longitude:Qt("number")};class ri{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ri._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Zc(e,ri._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new ri(e.vectorValues);throw new Se(ge.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ri._jsonSchemaVersion="firestore/vectorValue/1.0",ri._jsonSchema={type:Qt("string",ri._jsonSchemaVersion),vectorValues:Qt("object")};const V5=/^__.*__$/;class L5{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new Gs(e,this.data,this.fieldMask,n,this.fieldTransforms):new tu(e,this.data,n,this.fieldTransforms)}}class Dw{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new Gs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Iw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Me(40011,{Ac:t})}}class nf{constructor(e,n,i,a,l,u){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new nf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Th(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Iw(this.Ac)&&V5.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class U5{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||Wh(e)}Cc(e,n,i,a=!1){return new nf({Ac:e,methodName:n,Dc:i,path:hn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uy(t){const e=t._freezeSettings(),n=Wh(t._databaseId);return new U5(t._databaseId,!!e.ignoreUndefinedProperties,n)}function B5(t,e,n,i,a,l={}){const u=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);hy("Data must be an object, but it was:",u,i);const d=Ow(i,u);let f,g;if(l.merge)f=new Hn(u.fieldMask),g=u.fieldTransforms;else if(l.mergeFields){const _=[];for(const v of l.mergeFields){const E=dg(e,v,n);if(!u.contains(E))throw new Se(ge.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);Mw(_,E)||_.push(E)}f=new Hn(_),g=u.fieldTransforms.filter((v=>f.covers(v.field)))}else f=null,g=u.fieldTransforms;return new L5(new Mn(d),f,g)}class rf extends tf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rf}}function z5(t,e,n){return new nf({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class dy extends tf{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=z5(this,e,!0),i=this.vc.map((l=>cl(l,n))),a=new Ko(i);return new I2(e.path,a)}isEqual(e){return e instanceof dy&&Ns(this.vc,e.vc)}}function F5(t,e,n,i){const a=t.Cc(1,e,n);hy("Data must be an object, but it was:",a,i);const l=[],u=Mn.empty();qs(i,((f,g)=>{const _=fy(e,f,n);g=nn(g);const v=a.yc(_);if(g instanceof rf)l.push(_);else{const E=cl(g,v);E!=null&&(l.push(_),u.set(_,E))}}));const d=new Hn(l);return new Dw(u,d,a.fieldTransforms)}function q5(t,e,n,i,a,l){const u=t.Cc(1,e,n),d=[dg(e,i,n)],f=[a];if(l.length%2!=0)throw new Se(ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<l.length;E+=2)d.push(dg(e,l[E])),f.push(l[E+1]);const g=[],_=Mn.empty();for(let E=d.length-1;E>=0;--E)if(!Mw(g,d[E])){const T=d[E];let w=f[E];w=nn(w);const I=u.yc(T);if(w instanceof rf)g.push(T);else{const N=cl(w,I);N!=null&&(g.push(T),_.set(T,N))}}const v=new Hn(g);return new Dw(_,v,u.fieldTransforms)}function G5(t,e,n,i=!1){return cl(n,t.Cc(i?4:3,e))}function cl(t,e){if(jw(t=nn(t)))return hy("Unsupported field value:",e,t),Ow(t,e);if(t instanceof tf)return(function(i,a){if(!Iw(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let u=0;for(const d of i){let f=cl(d,a.wc(u));f==null&&(f={nullValue:"NULL_VALUE"}),l.push(f),u++}return{arrayValue:{values:l}}})(t,e)}return(function(i,a){if((i=nn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return C2(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=vt.fromDate(i);return{timestampValue:Eh(a.serializer,l)}}if(i instanceof vt){const l=new vt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Eh(a.serializer,l)}}if(i instanceof ni)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof cr)return{bytesValue:$x(a.serializer,i._byteString)};if(i instanceof kt){const l=a.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw a.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:$g(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof ri)return(function(u,d){return{mapValue:{fields:{[Sx]:{stringValue:xx},[gh]:{arrayValue:{values:u.toArray().map((g=>{if(typeof g!="number")throw d.Sc("VectorValues must only contain numeric values.");return Hg(d.serializer,g)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${zh(i)}`)})(t,e)}function Ow(t,e){const n={};return gx(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qs(t,((i,a)=>{const l=cl(a,e.mc(i));l!=null&&(n[i]=l)})),{mapValue:{fields:n}}}function jw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vt||t instanceof ni||t instanceof cr||t instanceof kt||t instanceof tf||t instanceof ri)}function hy(t,e,n){if(!jw(n)||!mx(n)){const i=zh(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function dg(t,e,n){if((e=nn(e))instanceof ef)return e._internalPath;if(typeof e=="string")return fy(t,e);throw Th("Field path arguments must be of type string or ",t,!1,void 0,n)}const H5=new RegExp("[~\\*/\\[\\]]");function fy(t,e,n){if(e.search(H5)>=0)throw Th(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ef(...e.split("."))._internalPath}catch{throw Th(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Th(t,e,n,i,a){const l=i&&!i.isEmpty(),u=a!==void 0;let d=`Function ${e}() called with invalid data`;n&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(l||u)&&(f+=" (found",l&&(f+=` in field ${i}`),u&&(f+=` in document ${a}`),f+=")"),new Se(ge.INVALID_ARGUMENT,d+t+f)}function Mw(t,e){return t.some((n=>n.isEqual(e)))}class kw{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new kt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Q5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(my("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Q5 extends kw{data(){return super.data()}}function my(t,e){return typeof e=="string"?fy(t,e):e instanceof ef?e._internalPath:e._delegate._internalPath}function K5(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Se(ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class py{}class $5 extends py{}function Y5(t,e,...n){let i=[];e instanceof py&&i.push(e),i=i.concat(n),(function(l){const u=l.filter((f=>f instanceof gy)).length,d=l.filter((f=>f instanceof sf)).length;if(u>1||u>0&&d>0)throw new Se(ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)t=a._apply(t);return t}class sf extends $5{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new sf(e,n,i)}_apply(e){const n=this._parse(e);return Nw(e._query,n),new ll(e.firestore,e.converter,eg(e._query,n))}_parse(e){const n=uy(e.firestore);return(function(l,u,d,f,g,_,v){let E;if(g.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new Se(ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){PE(v,_);const w=[];for(const I of v)w.push(NE(f,l,I));E={arrayValue:{values:w}}}else E=NE(f,l,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||PE(v,_),E=G5(d,u,v,_==="in"||_==="not-in");return Ht.create(g,_,E)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function W5(t,e,n){const i=e,a=my("where",t);return sf._create(a,i,n)}class gy extends py{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new gy(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Cr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,l){let u=a;const d=l.getFlattenedFilters();for(const f of d)Nw(u,f),u=eg(u,f)})(e._query,n),new ll(e.firestore,e.converter,eg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function NE(t,e,n){if(typeof(n=nn(n))=="string"){if(n==="")throw new Se(ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ox(e)&&n.indexOf("/")!==-1)throw new Se(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(gt.fromString(n));if(!Ie.isDocumentKey(i))throw new Se(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Jb(t,new Ie(i))}if(n instanceof kt)return Jb(t,n._key);throw new Se(ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zh(n)}.`)}function PE(t,e){if(!Array.isArray(t)||t.length===0)throw new Se(ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Nw(t,e){const n=(function(a,l){for(const u of a)for(const d of u.getFlattenedFilters())if(l.indexOf(d.op)>=0)return d.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Se(ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Se(ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class X5{convertValue(e,n="none"){switch(Us(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ls(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Me(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return qs(e,((a,l)=>{i[a]=this.convertValue(l,n)})),i}convertVectorValue(e){const n=e.fields?.[gh].arrayValue?.values?.map((i=>Mt(i.doubleValue)));return new ri(n)}convertGeoPoint(e){return new ni(Mt(e.latitude),Mt(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Gh(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Fc(e));default:return null}}convertTimestamp(e){const n=Vs(e);return new vt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=gt.fromString(e);st(ew(i),9688,{name:e});const a=new qc(i.get(1),i.get(3)),l=new Ie(i.popFirst(5));return a.isEqual(n)||Vi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function J5(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Tc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ta extends kw{constructor(e,n,i,a,l,u){super(e,n,i,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new nh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(my("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ge.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ta._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ta._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ta._jsonSchema={type:Qt("string",Ta._jsonSchemaVersion),bundleSource:Qt("string","DocumentSnapshot"),bundleName:Qt("string"),bundle:Qt("string")};class nh extends Ta{data(e={}){return super.data(e)}}class Lo{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Tc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new nh(this._firestore,this._userDataWriter,i.key,i,new Tc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Se(ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((d=>{const f=new nh(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Tc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const f=new nh(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Tc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let g=-1,_=-1;return d.type!==0&&(g=u.indexOf(d.doc.key),u=u.delete(d.doc.key)),d.type!==1&&(u=u.add(d.doc),_=u.indexOf(d.doc.key)),{type:Z5(d.type),doc:f,oldIndex:g,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ge.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Lo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Lg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Z5(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Me(61501,{type:t})}}function ej(t){t=Li(t,kt);const e=Li(t.firestore,su);return O5(cy(e),t._key).then((n=>ij(e,t,n)))}Lo._jsonSchemaVersion="firestore/querySnapshot/1.0",Lo._jsonSchema={type:Qt("string",Lo._jsonSchemaVersion),bundleSource:Qt("string","QuerySnapshot"),bundleName:Qt("string"),bundle:Qt("string")};class Pw extends X5{constructor(e){super(),this.firestore=e}convertBytes(e){return new cr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new kt(this.firestore,null,n)}}function tj(t){t=Li(t,ll);const e=Li(t.firestore,su),n=cy(e),i=new Pw(e);return K5(t._query),j5(n,t._query).then((a=>new Lo(e,i,t,a)))}function nj(t,e,n){t=Li(t,kt);const i=Li(t.firestore,su),a=J5(t.converter,e,n);return Vw(i,[B5(uy(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,ei.none())])}function rj(t,e,n,...i){t=Li(t,kt);const a=Li(t.firestore,su),l=uy(a);let u;return u=typeof(e=nn(e))=="string"||e instanceof ef?q5(l,"updateDoc",t._key,e,n,i):F5(l,"updateDoc",t._key,e),Vw(a,[u.toMutation(t._key,ei.exists(!0))])}function Vw(t,e){return(function(i,a){const l=new ji;return i.asyncQueue.enqueueAndForget((async()=>v5(await I5(i),a,l))),l.promise})(cy(t),e)}function ij(t,e,n){const i=n.docs.get(e._key),a=new Pw(t);return new Ta(t,a,e._key,i,new Tc(n.hasPendingWrites,n.fromCache),e.converter)}function sj(...t){return new dy("arrayUnion",t)}(function(e,n=!0){(function(a){il=a})(rl),Fo(new Ra("firestore",((i,{instanceIdentifier:a,options:l})=>{const u=i.getProvider("app").getImmediate(),d=new su(new UI(i.getProvider("auth-internal")),new FI(u,i.getProvider("app-check-internal")),(function(g,_){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new Se(ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qc(g.options.projectId,_)})(u,a),u);return l={useFetchStreams:n,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),Os(Ub,Bb,e),Os(Ub,Bb,"esm2020")})();var aj="firebase",oj="12.7.0";Os(aj,oj,"app");const lj={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},Lw=tx(lj);function af(){return N5(Lw)}function Ah(t){const e={};for(const[n,i]of Object.entries(t))i!==void 0&&(i!==null&&typeof i=="object"&&!Array.isArray(i)?e[n]=Ah(i):Array.isArray(i)?e[n]=i.map(a=>a!==null&&typeof a=="object"?Ah(a):a):e[n]=i);return e}async function Re(t,e){const n=ly(af(),t,e),i=`${t}/${e}`;console.log("[Firebase] READ getDoc:",i);const a=await ej(n);return{exists:a.exists(),data:a.exists()?a.data():null,ref:n}}async function nt(t,e,n,i){const a=ly(af(),t,e),l=Ah(n),u=`${t}/${e}`;return console.log("[Firebase] WRITE setDoc:",u,l),nj(a,l,i??{})}async function Kd(t,e,n){const i=ly(af(),t,e),a=Ah(n),l=`${t}/${e}`;return console.log("[Firebase] WRITE updateDoc:",l,a),rj(i,a)}async function Oa(t,e){const n=af(),i=k5(n,t);let a=t;if(e&&e.length>0){const d=e.map(f=>`${f.field} ${f.op} ${JSON.stringify(f.value)}`).join(", ");a+=` WHERE ${d}`}console.log("[Firebase] READ getDocs:",a);let l;if(e&&e.length>0){const d=e.map(f=>W5(f.field,f.op,f.value));l=Y5(i,...d)}else l=i;return{docs:(await tj(l)).docs.map(d=>({id:d.id,data:d.data()}))}}function hg(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname,balance:i.balance,account_group_id:i.account_group_id??null,sort_order:i.sort_order},i.is_income_account!==void 0&&(e[n].is_income_account=i.is_income_account),i.is_income_default!==void 0&&(e[n].is_income_default=i.is_income_default),i.is_outgo_account!==void 0&&(e[n].is_outgo_account=i.is_outgo_account),i.is_outgo_default!==void 0&&(e[n].is_outgo_default=i.is_outgo_default),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function cj(t){return t.map(e=>{const n={id:e.id,amount:e.amount,account_id:e.account_id,date:e.date,created_at:e.created_at};return e.payee&&(n.payee=e.payee),e.description&&(n.description=e.description),n})}function uj(t){return t.map(e=>({category_id:e.category_id,amount:e.amount}))}function dj(t){return t.map(e=>{const n={id:e.id,amount:e.amount,category_id:e.category_id,account_id:e.account_id,date:e.date,created_at:e.created_at};return e.payee&&(n.payee=e.payee),e.description&&(n.description=e.description),n})}function hj(t){return t.map(e=>({category_id:e.category_id,start_balance:e.start_balance,allocated:e.allocated,spent:e.spent,end_balance:e.end_balance}))}function tn(t,e,n){const i=n.toString().padStart(2,"0");return`${t}_${e}_${i}`}function fj(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname,balance:i.balance,account_group_id:i.account_group_id??null,sort_order:i.sort_order??0,is_income_account:i.is_income_account,is_income_default:i.is_income_default,is_outgo_account:i.is_outgo_account,is_outgo_default:i.is_outgo_default,on_budget:i.on_budget,is_active:i.is_active}}),e}function mj(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order??0,expected_balance:i.expected_balance??"positive",on_budget:i.on_budget,is_active:i.is_active}}),e}function pj(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,description:i.description,category_group_id:i.category_group_id??null,sort_order:i.sort_order??0,default_monthly_amount:i.default_monthly_amount,default_monthly_type:i.default_monthly_type,balance:i.balance??0}}),e}function gj(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,i)=>n.sort_order-i.sort_order),e}function yj(t){return!t||typeof t.computed_at!="string"||typeof t.computed_for_year!="number"||typeof t.computed_for_month!="number"||typeof t.is_stale!="boolean"||!t.balances?null:{computed_at:t.computed_at,computed_for_year:t.computed_for_year,computed_for_month:t.computed_for_month,is_stale:t.is_stale,balances:t.balances}}async function _j(t){const{exists:e,data:n}=await Re("budgets",t);if(!e||!n)throw new Error(`Budget ${t} not found`);return{budget:{id:t,name:n.name,user_ids:n.user_ids||[],accepted_user_ids:n.accepted_user_ids||[],owner_id:n.owner_id||n.user_ids?.[0]||"",owner_email:n.owner_email||null},accounts:fj(n.accounts),accountGroups:mj(n.account_groups),categories:pj(n.categories),categoryGroups:gj(n.category_groups),categoryBalancesSnapshot:yj(n.category_balances_snapshot)}}function vj(t,e){return ka({queryKey:t?le.budget(t):["budget","none"],queryFn:()=>_j(t),enabled:!!t&&e?.enabled!==!1})}function yy(t,e,n,i){const a=(t.income||[]).map(g=>({id:g.id,amount:g.amount,account_id:g.account_id,date:g.date,payee:g.payee,description:g.description,created_at:g.created_at})),l=(t.expenses||[]).map(g=>({id:g.id,amount:g.amount,category_id:g.category_id,account_id:g.account_id,date:g.date,payee:g.payee,description:g.description,created_at:g.created_at})),u=(t.allocations||[]).map(g=>({category_id:g.category_id,amount:g.amount})),d=(t.category_balances||[]).map(g=>({category_id:g.category_id,start_balance:g.start_balance,allocated:g.allocated,spent:g.spent,end_balance:g.end_balance}));let f;return t.previous_month_snapshot&&(f={total_income:t.previous_month_snapshot.total_income??0,account_balances_end:t.previous_month_snapshot.account_balances_end??{},category_balances_end:t.previous_month_snapshot.category_balances_end??{},snapshot_taken_at:t.previous_month_snapshot.snapshot_taken_at}),{budget_id:e,year:n,month:i,income:a,total_income:t.total_income??a.reduce((g,_)=>g+_.amount,0),expenses:l,total_expenses:t.total_expenses??l.reduce((g,_)=>g+_.amount,0),allocations:u,allocations_finalized:t.allocations_finalized||!1,account_balances_start:t.account_balances_start,account_balances_end:t.account_balances_end,category_balances:d,previous_month_snapshot:f,previous_month_snapshot_stale:t.previous_month_snapshot_stale??!1,created_at:t.created_at,updated_at:t.updated_at||t.created_at}}function Uw(t,e){let n=t,i=e-1;return i<1&&(i=12,n-=1),{prevYear:n,prevMonth:i}}function fg(t){const e={};return t.category_balances&&t.category_balances.forEach(n=>{e[n.category_id]=n.end_balance}),{total_income:t.total_income??0,account_balances_end:t.account_balances_end??{},category_balances_end:e,snapshot_taken_at:new Date().toISOString()}}async function bj(t,e,n){const i=tn(t,e,n),{exists:a,data:l}=await Re("months",i);if(a&&l){const d=yy(l,t,e,n);return d.previous_month_snapshot_stale===!0||d.previous_month_snapshot===void 0&&n!==1?await Ej(t,e,n,d):d}return await Sj(t,e,n)}async function Ej(t,e,n,i){const{prevYear:a,prevMonth:l}=Uw(e,n),u=tn(t,e,n);let d=null;const f=He.getQueryData(le.month(t,a,l));if(f)d=f.month;else{const E=tn(t,a,l),{exists:T,data:w}=await Re("months",E);T&&w&&(d=yy(w,t,a,l),He.setQueryData(le.month(t,a,l),{month:d}))}const g=d?fg(d):{total_income:0,account_balances_end:{},category_balances_end:{},snapshot_taken_at:new Date().toISOString()},_={...i,previous_month_snapshot:g,previous_month_snapshot_stale:!1,updated_at:new Date().toISOString()},v={budget_id:_.budget_id,year:_.year,month:_.month,income:_.income??[],total_income:_.total_income??0,expenses:_.expenses??[],total_expenses:_.total_expenses??0,allocations:_.allocations??[],allocations_finalized:_.allocations_finalized??!1,category_balances:_.category_balances??[],previous_month_snapshot:g,previous_month_snapshot_stale:!1,created_at:_.created_at??new Date().toISOString(),updated_at:_.updated_at};return _.account_balances_start!==void 0&&(v.account_balances_start=_.account_balances_start),_.account_balances_end!==void 0&&(v.account_balances_end=_.account_balances_end),await nt("months",u,v),_}async function Sj(t,e,n){const i=new Date().toISOString(),a=tn(t,e,n);let l;if(n>1||e>new Date().getFullYear()-10){const{prevYear:f,prevMonth:g}=Uw(e,n),_=He.getQueryData(le.month(t,f,g));if(_)l=fg(_.month);else{const v=tn(t,f,g),{exists:E,data:T}=await Re("months",v);if(E&&T){const w=yy(T,t,f,g);l=fg(w),He.setQueryData(le.month(t,f,g),{month:w})}}}const u={budget_id:t,year:e,month:n,income:[],total_income:0,expenses:[],total_expenses:0,allocations:[],allocations_finalized:!1,category_balances:[],previous_month_snapshot:l,previous_month_snapshot_stale:!1,created_at:i,updated_at:i},d={budget_id:t,year:e,month:n,income:[],total_income:0,expenses:[],total_expenses:0,allocations:[],allocations_finalized:!1,category_balances:[],previous_month_snapshot_stale:!1,created_at:i,updated_at:i};return l&&(d.previous_month_snapshot=l),await nt("months",a,d),u}function xj(t,e,n,i){return ka({queryKey:t?le.month(t,e,n):["month","none"],queryFn:async()=>({month:await bj(t,e,n)}),enabled:!!t&&i?.enabled!==!1})}function Mi(t,e,n){let i=e,a=n+1;a>12&&(a=1,i+=1);const l=le.month(t,i,a),u=He.getQueryData(l);u&&!u.month.previous_month_snapshot_stale&&He.setQueryData(l,{month:{...u.month,previous_month_snapshot_stale:!0}})}async function wj(t,e,n){let i=e,a=n+1;a>12&&(a=1,i+=1);const l=tn(t,i,a),{exists:u,data:d}=await Re("months",l);if(u&&d&&!d.previous_month_snapshot_stale){await nt("months",l,{...d,previous_month_snapshot_stale:!0,updated_at:new Date().toISOString()});const f=le.month(t,i,a),g=He.getQueryData(f);g&&He.setQueryData(f,{month:{...g.month,previous_month_snapshot_stale:!0}})}}async function Tj(t){const{exists:e,data:n}=await Re("payees",t);return e&&n?n.payees||[]:[]}function Aj(t,e){return ka({queryKey:t?le.payees(t):["payees","none"],queryFn:()=>Tj(t),enabled:!!t&&e?.enabled!==!1})}async function Cj(t,e){const{exists:n,data:i}=await Re("users",t);if(n&&i)return i;const a={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await nt("users",t,a),a}function Rj(t,e,n){return ka({queryKey:t?le.user(t):["user","none"],queryFn:()=>Cj(t,e),enabled:!!t&&n?.enabled!==!1})}async function Dj(t,e){const n=await Oa("budgets",[{field:"user_ids",op:"array-contains",value:t}]),i=[],a=[];for(const l of n.docs){const u=l.data;u.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(l.id)?i.push({id:l.id,name:u.name||"Unnamed Budget",ownerEmail:u.owner_email||null,isOwner:u.owner_id===t,isPending:!1}):a.push({budgetId:l.id,budgetName:u.name||"Unnamed Budget",ownerEmail:u.owner_email||null})}return{budgets:i,pendingInvites:a}}function Ij(t,e,n){return ka({queryKey:t?le.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?Dj(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}async function Oj(){const t=await Oa("feedback"),e=[];for(const n of t.docs){const i=n.data.items||[],a=n.data.user_email||n.id;i.forEach(l=>{e.push({...l,doc_id:n.id,user_email:a})})}return{items:e}}function jj(t){return ka({queryKey:le.feedback(),queryFn:Oj,enabled:t?.enabled!==!1,staleTime:60*1e3})}async function Mj(){const t=await Oa("budgets",[]);let e=0,n=0,i=0;for(const a of t.docs){const l=a.data;if(Array.isArray(l.categories)&&e++,Array.isArray(l.accounts)&&n++,l.categories&&typeof l.categories=="object"&&!Array.isArray(l.categories)){const u=l.categories;Object.values(u).some(f=>f.balance===void 0)&&i++}}return{categoriesArrayMigrationNeeded:e>0,accountsArrayMigrationNeeded:n>0,budgetsToMigrateCategories:e,budgetsToMigrateAccounts:n,budgetsNeedingCategoryBalance:i,totalBudgetsChecked:t.docs.length}}function kj(){return ka({queryKey:["adminMigration","all"],queryFn:async()=>Mj(),enabled:!1,staleTime:300*1e3,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1})}function Nj(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order},i.expected_balance!==void 0&&(e[n].expected_balance=i.expected_balance),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function Pj(){const t=oi(),e=pt({mutationFn:async({budgetId:a,accounts:l})=>{const{exists:u,data:d}=await Re("budgets",a);if(!u||!d)throw new Error("Budget not found");const f=hg(l);return await nt("budgets",a,{...d,accounts:f}),l},onMutate:async({budgetId:a,accounts:l})=>{await t.cancelQueries({queryKey:le.budget(a)});const u=t.getQueryData(le.budget(a));return u&&t.setQueryData(le.budget(a),{...u,accounts:l}),{previousData:u}},onSuccess:(a,{budgetId:l})=>{const u=t.getQueryData(le.budget(l));u&&t.setQueryData(le.budget(l),{...u,accounts:a})},onError:(a,{budgetId:l},u)=>{u?.previousData&&t.setQueryData(le.budget(l),u.previousData)}}),n=pt({mutationFn:async({budgetId:a,accountGroups:l})=>{const{exists:u,data:d}=await Re("budgets",a);if(!u||!d)throw new Error("Budget not found");const f=Nj(l);return await nt("budgets",a,{...d,account_groups:f}),l},onMutate:async({budgetId:a,accountGroups:l})=>{await t.cancelQueries({queryKey:le.budget(a)});const u=t.getQueryData(le.budget(a));return u&&t.setQueryData(le.budget(a),{...u,accountGroups:l}),{previousData:u}},onSuccess:(a,{budgetId:l})=>{const u=t.getQueryData(le.budget(l));u&&t.setQueryData(le.budget(l),{...u,accountGroups:a})},onError:(a,{budgetId:l},u)=>{u?.previousData&&t.setQueryData(le.budget(l),u.previousData)}}),i=pt({mutationFn:async({budgetId:a,accountId:l,delta:u})=>{const{exists:d,data:f}=await Re("budgets",a);if(!d||!f)throw new Error("Budget not found");const g=f.accounts||{};if(!g[l])throw new Error("Account not found");const _={...g,[l]:{...g[l],balance:g[l].balance+u}};return await nt("budgets",a,{...f,accounts:hg(_)}),_},onMutate:async({budgetId:a,accountId:l,delta:u})=>{await t.cancelQueries({queryKey:le.budget(a)});const d=t.getQueryData(le.budget(a));if(d&&d.accounts[l]){const f={...d.accounts,[l]:{...d.accounts[l],balance:d.accounts[l].balance+u}};t.setQueryData(le.budget(a),{...d,accounts:f})}return{previousData:d}},onSuccess:(a,{budgetId:l})=>{const u=t.getQueryData(le.budget(l));u&&t.setQueryData(le.budget(l),{...u,accounts:a})},onError:(a,{budgetId:l},u)=>{u?.previousData&&t.setQueryData(le.budget(l),u.previousData)}});return{updateAccounts:e,updateAccountGroups:n,updateAccountBalance:i}}function VE(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,category_group_id:i.category_group_id??null,sort_order:i.sort_order,balance:i.balance??0},i.description!==void 0&&(e[n].description=i.description),i.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=i.default_monthly_amount),i.default_monthly_type!==void 0&&(e[n].default_monthly_type=i.default_monthly_type)}),e}function Vj(){const t=oi(),e=pt({mutationFn:async({budgetId:l,categories:u})=>{const{exists:d,data:f}=await Re("budgets",l);if(!d||!f)throw new Error("Budget not found");const g=VE(u);return await nt("budgets",l,{...f,categories:g}),u},onMutate:async({budgetId:l,categories:u})=>{await t.cancelQueries({queryKey:le.budget(l)});const d=t.getQueryData(le.budget(l));return d&&t.setQueryData(le.budget(l),{...d,categories:u}),{previousData:d}},onSuccess:(l,{budgetId:u})=>{const d=t.getQueryData(le.budget(u));d&&t.setQueryData(le.budget(u),{...d,categories:l})},onError:(l,{budgetId:u},d)=>{d?.previousData&&t.setQueryData(le.budget(u),d.previousData)}}),n=pt({mutationFn:async({budgetId:l,categoryGroups:u})=>{const{exists:d,data:f}=await Re("budgets",l);if(!d||!f)throw new Error("Budget not found");return await nt("budgets",l,{...f,category_groups:u}),u},onMutate:async({budgetId:l,categoryGroups:u})=>{await t.cancelQueries({queryKey:le.budget(l)});const d=t.getQueryData(le.budget(l));return d&&t.setQueryData(le.budget(l),{...d,categoryGroups:u}),{previousData:d}},onSuccess:(l,{budgetId:u})=>{const d=t.getQueryData(le.budget(u));d&&t.setQueryData(le.budget(u),{...d,categoryGroups:l})},onError:(l,{budgetId:u},d)=>{d?.previousData&&t.setQueryData(le.budget(u),d.previousData)}}),i=pt({mutationFn:async({budgetId:l,balances:u,year:d,month:f})=>{const g={computed_at:new Date().toISOString(),computed_for_year:d,computed_for_month:f,is_stale:!1,balances:u},{exists:_,data:v}=await Re("budgets",l);if(!_||!v)throw new Error("Budget not found");return await nt("budgets",l,{...v,category_balances_snapshot:g}),g},onMutate:async({budgetId:l,balances:u,year:d,month:f})=>{await t.cancelQueries({queryKey:le.budget(l)});const g=t.getQueryData(le.budget(l)),_={computed_at:new Date().toISOString(),computed_for_year:d,computed_for_month:f,is_stale:!1,balances:u};return g&&t.setQueryData(le.budget(l),{...g,categoryBalancesSnapshot:_}),{previousData:g}},onSuccess:(l,{budgetId:u})=>{const d=t.getQueryData(le.budget(u));d&&t.setQueryData(le.budget(u),{...d,categoryBalancesSnapshot:l})},onError:(l,{budgetId:u},d)=>{d?.previousData&&t.setQueryData(le.budget(u),d.previousData)}}),a=pt({mutationFn:async({budgetId:l,categories:u,balances:d,year:f,month:g})=>{const _={computed_at:new Date().toISOString(),computed_for_year:f,computed_for_month:g,is_stale:!1,balances:d},{exists:v,data:E}=await Re("budgets",l);if(!v||!E)throw new Error("Budget not found");return await nt("budgets",l,{...E,categories:VE(u),category_balances_snapshot:_}),{categories:u,snapshot:_}},onMutate:async({budgetId:l,categories:u,balances:d,year:f,month:g})=>{await t.cancelQueries({queryKey:le.budget(l)});const _=t.getQueryData(le.budget(l)),v={computed_at:new Date().toISOString(),computed_for_year:f,computed_for_month:g,is_stale:!1,balances:d};return _&&t.setQueryData(le.budget(l),{..._,categories:u,categoryBalancesSnapshot:v}),{previousData:_}},onSuccess:({categories:l,snapshot:u},{budgetId:d})=>{const f=t.getQueryData(le.budget(d));f&&t.setQueryData(le.budget(d),{...f,categories:l,categoryBalancesSnapshot:u})},onError:(l,{budgetId:u},d)=>{d?.previousData&&t.setQueryData(le.budget(u),d.previousData)}});return{updateCategories:e,updateCategoryGroups:n,saveCategoryBalancesSnapshot:i,recalculateCategoryBalances:a}}function Lj(){const t=oi(),e=Pj(),n=Vj(),i=pt({mutationFn:async({budgetId:a,newName:l})=>{const{exists:u,data:d}=await Re("budgets",a);if(!u||!d)throw new Error("Budget not found");return await nt("budgets",a,{...d,name:l.trim()}),l.trim()},onMutate:async({budgetId:a,newName:l})=>{await t.cancelQueries({queryKey:le.budget(a)});const u=t.getQueryData(le.budget(a));return u&&t.setQueryData(le.budget(a),{...u,budget:{...u.budget,name:l.trim()}}),{previousData:u}},onSuccess:(a,{budgetId:l})=>{const u=t.getQueryData(le.budget(l));u&&t.setQueryData(le.budget(l),{...u,budget:{...u.budget,name:a}})},onError:(a,{budgetId:l},u)=>{u?.previousData&&t.setQueryData(le.budget(l),u.previousData)}});return{updateAccounts:e.updateAccounts,updateAccountGroups:e.updateAccountGroups,updateAccountBalance:e.updateAccountBalance,updateCategories:n.updateCategories,updateCategoryGroups:n.updateCategoryGroups,saveCategoryBalancesSnapshot:n.saveCategoryBalancesSnapshot,recalculateCategoryBalances:n.recalculateCategoryBalances,renameBudget:i}}async function ki(t,e){const n=tn(t,e.year,e.month),i={budget_id:e.budget_id,year:e.year,month:e.month,income:cj(e.income),total_income:e.total_income,updated_at:new Date().toISOString()};e.created_at&&(i.created_at=e.created_at),e.expenses&&(i.expenses=dj(e.expenses)),e.total_expenses!==void 0&&(i.total_expenses=e.total_expenses),e.allocations&&(i.allocations=uj(e.allocations)),e.allocations_finalized!==void 0&&(i.allocations_finalized=e.allocations_finalized),e.category_balances&&(i.category_balances=hj(e.category_balances)),e.account_balances_start&&(i.account_balances_start=e.account_balances_start),e.account_balances_end&&(i.account_balances_end=e.account_balances_end),e.previous_month_snapshot&&(i.previous_month_snapshot=e.previous_month_snapshot),e.previous_month_snapshot_stale!==void 0&&(i.previous_month_snapshot_stale=e.previous_month_snapshot_stale),await nt("months",n,i),await wj(t,e.year,e.month)}async function Jr(t,e,n){const{exists:i,data:a}=await Re("budgets",t);if(!i||!a)return null;const l=a.accounts||{};if(!l[e])return null;const u={...l,[e]:{...l[e],balance:l[e].balance+n}};return await nt("budgets",t,{...a,accounts:hg(u)}),u}async function Ch(t,e,n){const i=e.trim();if(!i||n.includes(i))return null;const a=[...n,i].sort((l,u)=>l.toLowerCase().localeCompare(u.toLowerCase()));return await nt("payees",t,{budget_id:t,payees:a,updated_at:new Date().toISOString()}),a}function Oc(t){const e=le.budget(t),n=He.getQueryData(e);n?.categoryBalancesSnapshot&&!n.categoryBalancesSnapshot.is_stale&&He.setQueryData(e,{...n,categoryBalancesSnapshot:{...n.categoryBalancesSnapshot,is_stale:!0}})}async function jc(t){try{const{exists:e,data:n}=await Re("budgets",t);e&&n&&n.category_balances_snapshot&&!n.category_balances_snapshot.is_stale&&await nt("budgets",t,{...n,category_balances_snapshot:{...n.category_balances_snapshot,is_stale:!0}})}catch(e){console.error("Error marking category balances snapshot stale in Firestore:",e)}}function Mc(t,e,n){const i=le.month(t,e,n),a=He.getQueryData(i);a?.month&&!a.month.category_balances_stale&&He.setQueryData(i,{...a,month:{...a.month,category_balances_stale:!0}})}async function kc(t,e,n){try{const i=tn(t,e,n),{exists:a,data:l}=await Re("months",i);a&&l&&!l.category_balances_stale&&await nt("months",i,{...l,category_balances_stale:!0})}catch(i){console.error("Error marking month category balances stale in Firestore:",i)}}function Nc(t,e,n){const a=He.getQueryCache().findAll({predicate:l=>{const u=l.queryKey;return u[0]==="month"&&u[1]===t}});for(const l of a){const u=l.queryKey,d=u[2],f=u[3];if(d>e||d===e&&f>n){const _=He.getQueryData(u);_?.month&&!_.month.category_balances_stale&&He.setQueryData(u,{..._,month:{..._.month,category_balances_stale:!0}})}}}async function Pc(t,e,n){try{const i=await Oa("months",[{field:"budget_id",op:"==",value:t}]);for(const a of i.docs){const l=a.data.year,u=a.data.month;(l>e||l===e&&u>n)&&!a.data.category_balances_stale&&await nt("months",a.id,{...a.data,budget_id:t,category_balances_stale:!0})}}catch(i){console.error("Error marking future months category balances stale in Firestore:",i)}}function Uj(){const t=oi(),e=pt({mutationFn:async a=>{const{budgetId:l,year:u,month:d,amount:f,accountId:g,date:_,payee:v,description:E}=a,T=tn(l,u,d),{exists:w,data:I}=await Re("months",T);if(!w||!I)throw new Error("Month data not found in Firestore");const N={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:f,account_id:g,date:_,created_at:new Date().toISOString()};v?.trim()&&(N.payee=v.trim()),E&&(N.description=E);const U=[...I.income||[],N],G={...I,income:U,total_income:U.reduce((J,te)=>J+te.amount,0),updated_at:new Date().toISOString()};await ki(l,G);const z=await Jr(l,g,f);let $=null;if(v?.trim()){const{data:J}=await Re("payees",l),te=J?.payees||[];$=await Ch(l,v,te)}return{updatedMonth:G,newIncome:N,updatedAccounts:z,updatedPayees:$}},onMutate:async a=>{const{budgetId:l,year:u,month:d,amount:f,accountId:g,date:_,payee:v,description:E}=a,T=le.month(l,u,d),w=le.budget(l);await t.cancelQueries({queryKey:T}),await t.cancelQueries({queryKey:w});const I=t.getQueryData(T),N=t.getQueryData(w);if(I){const U={id:`income_optimistic_${Date.now()}`,amount:f,account_id:g,date:_,created_at:new Date().toISOString()};v?.trim()&&(U.payee=v.trim()),E&&(U.description=E);const G=[...I.month.income,U];t.setQueryData(T,{...I,month:{...I.month,income:G,total_income:G.reduce((z,$)=>z+$.amount,0)}})}return N&&N.accounts[g]&&t.setQueryData(w,{...N,accounts:{...N.accounts,[g]:{...N.accounts[g],balance:N.accounts[g].balance+f}}}),Mi(l,u,d),{previousMonth:I,previousBudget:N}},onSuccess:(a,l)=>{const{budgetId:u,year:d,month:f}=l,g=le.month(u,d,f),_=le.budget(u),v=le.payees(u);if(t.setQueryData(g,{month:a.updatedMonth}),a.updatedAccounts){const E=t.getQueryData(_);E&&t.setQueryData(_,{...E,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,u)=>{const{budgetId:d,year:f,month:g}=l;u?.previousMonth&&t.setQueryData(le.month(d,f,g),u.previousMonth),u?.previousBudget&&t.setQueryData(le.budget(d),u.previousBudget)}}),n=pt({mutationFn:async a=>{const{budgetId:l,year:u,month:d,incomeId:f,amount:g,accountId:_,date:v,payee:E,description:T,oldAmount:w,oldAccountId:I}=a,N=tn(l,u,d),{exists:U,data:G}=await Re("months",N);if(!U||!G)throw new Error("Month data not found in Firestore");const z={id:f,amount:g,account_id:_,date:v,created_at:(G.income||[]).find(A=>A.id===f)?.created_at||new Date().toISOString()};E?.trim()&&(z.payee=E.trim()),T&&(z.description=T);const $=(G.income||[]).map(A=>A.id===f?z:A),J={...G,income:$,total_income:$.reduce((A,R)=>A+R.amount,0),updated_at:new Date().toISOString()};await ki(l,J);let te=null;_!==I?(await Jr(l,I,-w),te=await Jr(l,_,g)):g!==w&&(te=await Jr(l,_,g-w));let j=null;if(E?.trim()){const{data:A}=await Re("payees",l),R=A?.payees||[];j=await Ch(l,E,R)}return{updatedMonth:J,updatedAccounts:te,updatedPayees:j}},onMutate:async a=>{const{budgetId:l,year:u,month:d,incomeId:f,amount:g,accountId:_,date:v,payee:E,description:T,oldAmount:w,oldAccountId:I}=a,N=le.month(l,u,d),U=le.budget(l);await t.cancelQueries({queryKey:N}),await t.cancelQueries({queryKey:U});const G=t.getQueryData(N),z=t.getQueryData(U);if(G){const $={id:f,amount:g,account_id:_,date:v,created_at:G.month.income.find(te=>te.id===f)?.created_at||new Date().toISOString()};E?.trim()&&($.payee=E.trim()),T&&($.description=T);const J=G.month.income.map(te=>te.id===f?$:te);t.setQueryData(N,{...G,month:{...G.month,income:J,total_income:J.reduce((te,j)=>te+j.amount,0)}})}if(z){const $={...z.accounts};_!==I?($[I]&&($[I]={...$[I],balance:$[I].balance-w}),$[_]&&($[_]={...$[_],balance:$[_].balance+g})):g!==w&&$[_]&&($[_]={...$[_],balance:$[_].balance+(g-w)}),t.setQueryData(U,{...z,accounts:$})}return Mi(l,u,d),{previousMonth:G,previousBudget:z}},onSuccess:(a,l)=>{const{budgetId:u,year:d,month:f}=l,g=le.month(u,d,f),_=le.budget(u),v=le.payees(u);if(t.setQueryData(g,{month:a.updatedMonth}),a.updatedAccounts){const E=t.getQueryData(_);E&&t.setQueryData(_,{...E,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,u)=>{const{budgetId:d,year:f,month:g}=l;u?.previousMonth&&t.setQueryData(le.month(d,f,g),u.previousMonth),u?.previousBudget&&t.setQueryData(le.budget(d),u.previousBudget)}}),i=pt({mutationFn:async a=>{const{budgetId:l,year:u,month:d,incomeId:f,amount:g,accountId:_}=a,v=tn(l,u,d),{exists:E,data:T}=await Re("months",v);if(!E||!T)throw new Error("Month data not found in Firestore");const w=(T.income||[]).filter(U=>U.id!==f),I={...T,income:w,total_income:w.reduce((U,G)=>U+G.amount,0),updated_at:new Date().toISOString()};await ki(l,I);const N=await Jr(l,_,-g);return{updatedMonth:I,updatedAccounts:N}},onMutate:async a=>{const{budgetId:l,year:u,month:d,incomeId:f,amount:g,accountId:_}=a,v=le.month(l,u,d),E=le.budget(l);await t.cancelQueries({queryKey:v}),await t.cancelQueries({queryKey:E});const T=t.getQueryData(v),w=t.getQueryData(E);if(T){const I=T.month.income.filter(N=>N.id!==f);t.setQueryData(v,{...T,month:{...T.month,income:I,total_income:I.reduce((N,U)=>N+U.amount,0)}})}return w&&w.accounts[_]&&t.setQueryData(E,{...w,accounts:{...w.accounts,[_]:{...w.accounts[_],balance:w.accounts[_].balance-g}}}),Mi(l,u,d),{previousMonth:T,previousBudget:w}},onSuccess:(a,l)=>{const{budgetId:u,year:d,month:f}=l,g=le.month(u,d,f),_=le.budget(u);if(t.setQueryData(g,{month:a.updatedMonth}),a.updatedAccounts){const v=t.getQueryData(_);v&&t.setQueryData(_,{...v,accounts:a.updatedAccounts})}},onError:(a,l,u)=>{const{budgetId:d,year:f,month:g}=l;u?.previousMonth&&t.setQueryData(le.month(d,f,g),u.previousMonth),u?.previousBudget&&t.setQueryData(le.budget(d),u.previousBudget)}});return{addIncome:e,updateIncome:n,deleteIncome:i}}function Bj(){const t=oi(),e=pt({mutationFn:async a=>{const{budgetId:l,year:u,month:d,amount:f,categoryId:g,accountId:_,date:v,payee:E,description:T}=a,w=tn(l,u,d),{exists:I,data:N}=await Re("months",w);if(!I||!N)throw new Error("Month data not found in Firestore");const U={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:f,category_id:g,account_id:_,date:v,created_at:new Date().toISOString()};E?.trim()&&(U.payee=E.trim()),T&&(U.description=T);const G=[...N.expenses||[],U],z={...N,expenses:G,total_expenses:G.reduce((te,j)=>te+j.amount,0),updated_at:new Date().toISOString()};await ki(l,z);const $=await Jr(l,_,-f);let J=null;if(E?.trim()){const{data:te}=await Re("payees",l),j=te?.payees||[];J=await Ch(l,E,j)}return await jc(l),await kc(l,u,d),await Pc(l,u,d),{updatedMonth:z,newExpense:U,updatedAccounts:$,updatedPayees:J}},onMutate:async a=>{const{budgetId:l,year:u,month:d,amount:f,categoryId:g,accountId:_,date:v,payee:E,description:T}=a,w=le.month(l,u,d),I=le.budget(l);await t.cancelQueries({queryKey:w}),await t.cancelQueries({queryKey:I});const N=t.getQueryData(w),U=t.getQueryData(I);if(N){const G={id:`expense_optimistic_${Date.now()}`,amount:f,category_id:g,account_id:_,date:v,created_at:new Date().toISOString()};E?.trim()&&(G.payee=E.trim()),T&&(G.description=T);const z=[...N.month.expenses||[],G];t.setQueryData(w,{...N,month:{...N.month,expenses:z,total_expenses:z.reduce(($,J)=>$+J.amount,0)}})}return U&&U.accounts[_]&&t.setQueryData(I,{...U,accounts:{...U.accounts,[_]:{...U.accounts[_],balance:U.accounts[_].balance-f}}}),Mi(l,u,d),Oc(l),Mc(l,u,d),Nc(l,u,d),{previousMonth:N,previousBudget:U}},onSuccess:(a,l)=>{const{budgetId:u,year:d,month:f}=l,g=le.month(u,d,f),_=le.budget(u),v=le.payees(u);if(t.setQueryData(g,{month:a.updatedMonth}),a.updatedAccounts){const E=t.getQueryData(_);E&&t.setQueryData(_,{...E,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,u)=>{const{budgetId:d,year:f,month:g}=l;u?.previousMonth&&t.setQueryData(le.month(d,f,g),u.previousMonth),u?.previousBudget&&t.setQueryData(le.budget(d),u.previousBudget)}}),n=pt({mutationFn:async a=>{const{budgetId:l,year:u,month:d,expenseId:f,amount:g,categoryId:_,accountId:v,date:E,payee:T,description:w,oldAmount:I,oldAccountId:N}=a,U=tn(l,u,d),{exists:G,data:z}=await Re("months",U);if(!G||!z)throw new Error("Month data not found in Firestore");const $={id:f,amount:g,category_id:_,account_id:v,date:E,created_at:z.expenses?.find(R=>R.id===f)?.created_at||new Date().toISOString()};T?.trim()&&($.payee=T.trim()),w&&($.description=w);const J=(z.expenses||[]).map(R=>R.id===f?$:R),te={...z,expenses:J,total_expenses:J.reduce((R,D)=>R+D.amount,0),updated_at:new Date().toISOString()};await ki(l,te);let j=null;v!==N?(await Jr(l,N,I),j=await Jr(l,v,-g)):g!==I&&(j=await Jr(l,v,I-g));let A=null;if(T?.trim()){const{data:R}=await Re("payees",l),D=R?.payees||[];A=await Ch(l,T,D)}return await jc(l),await kc(l,u,d),await Pc(l,u,d),{updatedMonth:te,updatedAccounts:j,updatedPayees:A}},onMutate:async a=>{const{budgetId:l,year:u,month:d,expenseId:f,amount:g,categoryId:_,accountId:v,date:E,payee:T,description:w,oldAmount:I,oldAccountId:N}=a,U=le.month(l,u,d),G=le.budget(l);await t.cancelQueries({queryKey:U}),await t.cancelQueries({queryKey:G});const z=t.getQueryData(U),$=t.getQueryData(G);if(z){const J={id:f,amount:g,category_id:_,account_id:v,date:E,created_at:z.month.expenses?.find(j=>j.id===f)?.created_at||new Date().toISOString()};T?.trim()&&(J.payee=T.trim()),w&&(J.description=w);const te=(z.month.expenses||[]).map(j=>j.id===f?J:j);t.setQueryData(U,{...z,month:{...z.month,expenses:te,total_expenses:te.reduce((j,A)=>j+A.amount,0)}})}if($){const J={...$.accounts};v!==N?(J[N]&&(J[N]={...J[N],balance:J[N].balance+I}),J[v]&&(J[v]={...J[v],balance:J[v].balance-g})):g!==I&&J[v]&&(J[v]={...J[v],balance:J[v].balance+(I-g)}),t.setQueryData(G,{...$,accounts:J})}return Mi(l,u,d),Oc(l),Mc(l,u,d),Nc(l,u,d),{previousMonth:z,previousBudget:$}},onSuccess:(a,l)=>{const{budgetId:u,year:d,month:f}=l,g=le.month(u,d,f),_=le.budget(u),v=le.payees(u);if(t.setQueryData(g,{month:a.updatedMonth}),a.updatedAccounts){const E=t.getQueryData(_);E&&t.setQueryData(_,{...E,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,u)=>{const{budgetId:d,year:f,month:g}=l;u?.previousMonth&&t.setQueryData(le.month(d,f,g),u.previousMonth),u?.previousBudget&&t.setQueryData(le.budget(d),u.previousBudget)}}),i=pt({mutationFn:async a=>{const{budgetId:l,year:u,month:d,expenseId:f,amount:g,accountId:_}=a,v=tn(l,u,d),{exists:E,data:T}=await Re("months",v);if(!E||!T)throw new Error("Month data not found in Firestore");const w=(T.expenses||[]).filter(U=>U.id!==f),I={...T,expenses:w,total_expenses:w.reduce((U,G)=>U+G.amount,0),updated_at:new Date().toISOString()};await ki(l,I);const N=await Jr(l,_,g);return await jc(l),await kc(l,u,d),await Pc(l,u,d),{updatedMonth:I,updatedAccounts:N}},onMutate:async a=>{const{budgetId:l,year:u,month:d,expenseId:f,amount:g,accountId:_}=a,v=le.month(l,u,d),E=le.budget(l);await t.cancelQueries({queryKey:v}),await t.cancelQueries({queryKey:E});const T=t.getQueryData(v),w=t.getQueryData(E);if(T){const I=(T.month.expenses||[]).filter(N=>N.id!==f);t.setQueryData(v,{...T,month:{...T.month,expenses:I,total_expenses:I.reduce((N,U)=>N+U.amount,0)}})}return w&&w.accounts[_]&&t.setQueryData(E,{...w,accounts:{...w.accounts,[_]:{...w.accounts[_],balance:w.accounts[_].balance+g}}}),Mi(l,u,d),Oc(l),Mc(l,u,d),Nc(l,u,d),{previousMonth:T,previousBudget:w}},onSuccess:(a,l)=>{const{budgetId:u,year:d,month:f}=l,g=le.month(u,d,f),_=le.budget(u);if(t.setQueryData(g,{month:a.updatedMonth}),a.updatedAccounts){const v=t.getQueryData(_);v&&t.setQueryData(_,{...v,accounts:a.updatedAccounts})}},onError:(a,l,u)=>{const{budgetId:d,year:f,month:g}=l;u?.previousMonth&&t.setQueryData(le.month(d,f,g),u.previousMonth),u?.previousBudget&&t.setQueryData(le.budget(d),u.previousBudget)}});return{addExpense:e,updateExpense:n,deleteExpense:i}}function zj(){const t=oi(),e=pt({mutationFn:async a=>{const{budgetId:l,year:u,month:d,allocations:f}=a,g=tn(l,u,d),{exists:_,data:v}=await Re("months",g);if(!_||!v)throw new Error("Month data not found in Firestore");const E={...v,allocations:f,updated_at:new Date().toISOString()};return await ki(l,E),{updatedMonth:E}},onMutate:async a=>{const{budgetId:l,year:u,month:d,allocations:f}=a,g=le.month(l,u,d);await t.cancelQueries({queryKey:g});const _=t.getQueryData(g);return _&&t.setQueryData(g,{..._,month:{..._.month,allocations:f}}),Mi(l,u,d),{previousMonth:_}},onSuccess:(a,l)=>{const{budgetId:u,year:d,month:f}=l;t.setQueryData(le.month(u,d,f),{month:a.updatedMonth})},onError:(a,l,u)=>{u?.previousMonth&&t.setQueryData(le.month(l.budgetId,l.year,l.month),u.previousMonth)}}),n=pt({mutationFn:async a=>{const{budgetId:l,year:u,month:d,allocations:f}=a,g=tn(l,u,d),{exists:_,data:v}=await Re("months",g);if(!_||!v)throw new Error("Month data not found in Firestore");const E={...v,allocations:f,allocations_finalized:!0,updated_at:new Date().toISOString()};await ki(l,E);const{exists:T,data:w}=await Re("budgets",l);let I=null;if(T&&w){const N=await Oa("months",[{field:"budget_id",op:"==",value:l}]),U={},G=w.categories||{};Object.keys(G).forEach($=>{U[$]=0});for(const $ of N.docs){const J=$.data;if(J.allocations_finalized&&J.allocations)for(const te of J.allocations)U[te.category_id]=(U[te.category_id]||0)+te.amount}const z={};Object.entries(G).forEach(([$,J])=>{z[$]={...J,balance:U[$]??0}}),I=z,await nt("budgets",l,{...w,categories:I})}return await jc(l),await kc(l,u,d),await Pc(l,u,d),{updatedMonth:E,updatedCategories:I}},onMutate:async a=>{const{budgetId:l,year:u,month:d,allocations:f}=a,g=le.month(l,u,d);await t.cancelQueries({queryKey:g});const _=t.getQueryData(g);return _&&t.setQueryData(g,{..._,month:{..._.month,allocations:f,allocations_finalized:!0}}),Mi(l,u,d),Oc(l),Mc(l,u,d),Nc(l,u,d),{previousMonth:_}},onSuccess:(a,l)=>{const{budgetId:u,year:d,month:f}=l,g=le.month(u,d,f),_=le.budget(u);if(t.setQueryData(g,{month:a.updatedMonth}),a.updatedCategories){const v=t.getQueryData(_);v&&t.setQueryData(_,{...v,categories:a.updatedCategories})}},onError:(a,l,u)=>{u?.previousMonth&&t.setQueryData(le.month(l.budgetId,l.year,l.month),u.previousMonth)}}),i=pt({mutationFn:async a=>{const{budgetId:l,year:u,month:d}=a,f=tn(l,u,d),{exists:g,data:_}=await Re("months",f);if(!g||!_)throw new Error("Month data not found in Firestore");const v={..._,allocations_finalized:!1,updated_at:new Date().toISOString()};return await ki(l,v),await jc(l),await kc(l,u,d),await Pc(l,u,d),{updatedMonth:v}},onMutate:async a=>{const{budgetId:l,year:u,month:d}=a,f=le.month(l,u,d);await t.cancelQueries({queryKey:f});const g=t.getQueryData(f);return g&&t.setQueryData(f,{...g,month:{...g.month,allocations_finalized:!1}}),Mi(l,u,d),Oc(l),Mc(l,u,d),Nc(l,u,d),{previousMonth:g}},onSuccess:(a,l)=>{const{budgetId:u,year:d,month:f}=l;t.setQueryData(le.month(u,d,f),{month:a.updatedMonth})},onError:(a,l,u)=>{u?.previousMonth&&t.setQueryData(le.month(l.budgetId,l.year,l.month),u.previousMonth)}});return{saveAllocations:e,finalizeAllocations:n,unfinalizeAllocations:i}}function Fj(){const{addIncome:t,updateIncome:e,deleteIncome:n}=Uj(),{addExpense:i,updateExpense:a,deleteExpense:l}=Bj(),{saveAllocations:u,finalizeAllocations:d,unfinalizeAllocations:f}=zj();return{addIncome:t,updateIncome:e,deleteIncome:n,addExpense:i,updateExpense:a,deleteExpense:l,saveAllocations:u,finalizeAllocations:d,unfinalizeAllocations:f}}function qj(){const t=oi(),e=pt({mutationFn:async({name:d,userId:f,userEmail:g})=>{const _=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,v=new Date().toISOString(),E={name:d.trim()||"My Budget",user_ids:[f],accepted_user_ids:[f],owner_id:f,owner_email:g,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:v,updated_at:v};await nt("budgets",_,E);const{exists:T,data:w}=await Re("users",f);return T&&w?await nt("users",f,{...w,budget_ids:[_,...w.budget_ids],updated_at:v}):await nt("users",f,{uid:f,email:g,budget_ids:[_],created_at:v,updated_at:v}),{budgetId:_,budget:{id:_,...E}}},onSuccess:(d,{userId:f})=>{t.invalidateQueries({queryKey:le.user(f)}),t.invalidateQueries({queryKey:le.accessibleBudgets(f)})}}),n=pt({mutationFn:async({budgetId:d,userId:f})=>{const g=new Date().toISOString(),{exists:_,data:v}=await Re("budgets",d);if(!_||!v)throw new Error("Budget not found");if(!v.user_ids?.includes(f))throw new Error("You have not been invited to this budget");const{data:E}=await Re("users",f);if(E?.budget_ids?.includes(d))throw new Error("You have already accepted this invite");return await nt("users",f,{...E||{uid:f,email:null},budget_ids:[d,...E?.budget_ids||[]],updated_at:g}),await nt("budgets",d,{...v,accepted_user_ids:[...v.accepted_user_ids||[],f]}),{budgetId:d}},onSuccess:(d,{userId:f})=>{t.invalidateQueries({queryKey:le.user(f)}),t.invalidateQueries({queryKey:le.accessibleBudgets(f)}),t.invalidateQueries({queryKey:le.budget(d.budgetId)})}}),i=pt({mutationFn:async({budgetId:d,userId:f})=>{const{exists:g,data:_}=await Re("budgets",d);if(!g||!_)throw new Error("Budget not found");if(_.user_ids?.includes(f))throw new Error("User is already invited");return await nt("budgets",d,{..._,user_ids:[..._.user_ids||[],f]}),{budgetId:d}},onMutate:async({budgetId:d,userId:f})=>{await t.cancelQueries({queryKey:le.budget(d)});const g=t.getQueryData(le.budget(d));return g&&t.setQueryData(le.budget(d),{...g,budget:{...g.budget,user_ids:[...g.budget.user_ids,f]}}),{previousData:g}},onError:(d,{budgetId:f},g)=>{g?.previousData&&t.setQueryData(le.budget(f),g.previousData)},onSettled:(d,f,{budgetId:g})=>{t.invalidateQueries({queryKey:le.budget(g)})}}),a=pt({mutationFn:async({budgetId:d,userId:f})=>{const{exists:g,data:_}=await Re("budgets",d);if(!g||!_)throw new Error("Budget not found");return await nt("budgets",d,{..._,user_ids:(_.user_ids||[]).filter(v=>v!==f),accepted_user_ids:(_.accepted_user_ids||[]).filter(v=>v!==f)}),{budgetId:d}},onMutate:async({budgetId:d,userId:f})=>{await t.cancelQueries({queryKey:le.budget(d)});const g=t.getQueryData(le.budget(d));return g&&t.setQueryData(le.budget(d),{...g,budget:{...g.budget,user_ids:g.budget.user_ids.filter(_=>_!==f),accepted_user_ids:g.budget.accepted_user_ids.filter(_=>_!==f)}}),{previousData:g}},onError:(d,{budgetId:f},g)=>{g?.previousData&&t.setQueryData(le.budget(f),g.previousData)},onSettled:(d,f,{budgetId:g})=>{t.invalidateQueries({queryKey:le.budget(g)})}}),l=pt({mutationFn:async({budgetId:d,userId:f})=>{const{exists:g,data:_}=await Re("users",f);if(!g||!_)throw new Error("User document not found");const v=[d,..._.budget_ids.filter(E=>E!==d)];return await nt("users",f,{..._,budget_ids:v,updated_at:new Date().toISOString()}),{budgetId:d}},onMutate:async({budgetId:d,userId:f})=>{await t.cancelQueries({queryKey:le.user(f)});const g=t.getQueryData(le.user(f));return g&&t.setQueryData(le.user(f),{...g,budget_ids:[d,...g.budget_ids.filter(_=>_!==d)]}),{previousData:g}},onError:(d,{userId:f},g)=>{g?.previousData&&t.setQueryData(le.user(f),g.previousData)},onSettled:(d,f,{userId:g})=>{t.invalidateQueries({queryKey:le.user(g)})}}),u=pt({mutationFn:async({budgetId:d,userId:f,userBudgetIds:g})=>{const{exists:_,data:v}=await Re("budgets",d);return!_||!v||!v.user_ids?.includes(f)||g.includes(d)?null:{budgetId:d,budgetName:v.name,ownerEmail:v.owner_email||null}}});return{createBudget:e,acceptInvite:n,inviteUser:i,revokeUser:a,switchBudget:l,checkInvite:u}}function Bw(){const t=oi(),e=pt({mutationFn:async({userId:a,userEmail:l,text:u,feedbackType:d,currentPath:f})=>{const g=l||a,_={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`[${d.toUpperCase()}] ${u}

(Submitted from: ${f})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:d},{exists:v}=await Re("feedback",g);return v?await nt("feedback",g,{items:sj(_),user_email:l,updated_at:new Date().toISOString()},{merge:!0}):await nt("feedback",g,{items:[_],user_email:l,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),{feedbackItem:_}},onSuccess:()=>{t.invalidateQueries({queryKey:le.feedback()})}}),n=pt({mutationFn:async({item:a})=>{const{exists:l,data:u}=await Re("feedback",a.doc_id);if(!l||!u)throw new Error("Feedback document not found");const f=(u.items||[]).map(g=>g.id===a.id?{...g,is_done:!g.is_done,completed_at:g.is_done?null:new Date().toISOString()}:g);return await nt("feedback",a.doc_id,{...u,items:f,updated_at:new Date().toISOString()}),{itemId:a.id,isDone:!a.is_done}},onSuccess:()=>{t.invalidateQueries({queryKey:le.feedback()})}}),i=pt({mutationFn:async({docId:a,items:l})=>{const{exists:u,data:d}=await Re("feedback",a);if(!u||!d)throw new Error("Feedback document not found");return await nt("feedback",a,{...d,items:l,updated_at:new Date().toISOString()}),{docId:a}},onSuccess:()=>{t.invalidateQueries({queryKey:le.feedback()})}});return{submitFeedback:e,toggleFeedback:n,updateSortOrder:i}}async function Gj(t,e){return He.fetchQuery({queryKey:["budgetInvite",t,e],queryFn:async()=>{const{exists:n,data:i}=await Re("budgets",t);return!n||!i?null:{isInvited:i.user_ids?.includes(e)??!1,hasAccepted:i.accepted_user_ids?.includes(e)??!1,budgetName:i.name||"Unnamed Budget",ownerEmail:i.owner_email||null}},staleTime:60*1e3})}async function mg(t,e,n){const i=tn(t,e,n),a=He.getQueryData(le.month(t,e,n));if(a?.month)return{year:a.month.year,month:a.month.month,category_balances:a.month.category_balances,category_balances_stale:a.month.category_balances_stale,allocations_finalized:a.month.allocations_finalized,allocations:a.month.allocations,expenses:a.month.expenses};const{exists:l,data:u}=await Re("months",i);return l?u:null}function Hj(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function Qj(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}async function Kj(t,e,n,i){const a={};e.forEach(E=>{a[E]=0});const l=await mg(t,n,i);if(l?.category_balances&&!l.category_balances_stale){for(const E of l.category_balances)e.includes(E.category_id)&&(a[E.category_id]=E.end_balance);return a}const u={};e.forEach(E=>{u[E]=0});const d=[];l&&d.push(l);let f=n,g=i,_=!1;const v=120;for(let E=0;E<v&&!_;E++){const T=Hj(f,g);f=T.year,g=T.month;const w=await mg(t,f,g);if(!w)_=!0;else if(w.category_balances&&!w.category_balances_stale){_=!0;for(const I of w.category_balances)e.includes(I.category_id)&&(u[I.category_id]=I.end_balance)}else d.push(w)}d.reverse(),Object.assign(a,u);for(const E of d){if(E.allocations_finalized&&E.allocations)for(const T of E.allocations)e.includes(T.category_id)&&(a[T.category_id]=(a[T.category_id]||0)+T.amount);if(E.expenses)for(const T of E.expenses)e.includes(T.category_id)&&(a[T.category_id]=(a[T.category_id]||0)-T.amount)}return a}async function $j(t,e,n,i,a){const l={...n};let u=i,d=a;const f=24;for(let g=0;g<f;g++){const _=Qj(u,d);u=_.year,d=_.month;const v=await mg(t,u,d);if(!v)break;if(v.allocations_finalized&&v.allocations)for(const E of v.allocations)e.includes(E.category_id)&&(l[E.category_id]=(l[E.category_id]||0)+E.amount);if(v.expenses)for(const E of v.expenses)e.includes(E.category_id)&&(l[E.category_id]=(l[E.category_id]||0)-E.amount)}return l}async function Ip(t,e,n,i,a){const l=await Kj(t,e,n,i);let u;return a&&!a.is_stale&&a.computed_for_year===n&&a.computed_for_month===i?(u={},e.forEach(f=>{u[f]=a.balances[f]?.total??l[f]??0})):u=await $j(t,e,l,n,i),{current:l,total:u}}function zw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Yj=zw,Fw=new Xc("auth","Firebase",zw());const Rh=new kg("@firebase/auth");function Wj(t,...e){Rh.logLevel<=$e.WARN&&Rh.warn(`Auth (${rl}): ${t}`,...e)}function rh(t,...e){Rh.logLevel<=$e.ERROR&&Rh.error(`Auth (${rl}): ${t}`,...e)}function Rr(t,...e){throw _y(t,...e)}function ii(t,...e){return _y(t,...e)}function qw(t,e,n){const i={...Yj(),[e]:n};return new Xc("auth","Firebase",i).create(e,{appName:t.name})}function ks(t){return qw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _y(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return Fw.create(t,...e)}function je(t,e,...n){if(!t)throw _y(e,...n)}function Di(t){const e="INTERNAL ASSERTION FAILED: "+t;throw rh(e),new Error(e)}function Bi(t,e){t||Di(e)}function pg(){return typeof self<"u"&&self.location?.href||""}function Xj(){return LE()==="http:"||LE()==="https:"}function LE(){return typeof self<"u"&&self.location?.protocol||null}function Jj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xj()||gD()||"connection"in navigator)?navigator.onLine:!0}function Zj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class au{constructor(e,n){this.shortDelay=e,this.longDelay=n,Bi(n>e,"Short delay should be less than long delay!"),this.isMobile=fD()||yD()}get(){return Jj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function vy(t,e){Bi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Gw{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const eM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const tM=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nM=new au(3e4,6e4);function Va(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Hs(t,e,n,i,a={}){return Hw(t,a,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const d=Jc({key:t.config.apiKey,...u}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const g={method:e,headers:f,...l};return pD()||(g.referrerPolicy="no-referrer"),t.emulatorConfig&&nl(t.emulatorConfig.host)&&(g.credentials="include"),Gw.fetch()(await Qw(t,t.config.apiHost,n,d),g)})}async function Hw(t,e,n){t._canInitEmulator=!1;const i={...eM,...e};try{const a=new iM(t),l=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw $d(t,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const d=l.ok?u.errorMessage:u.error.message,[f,g]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw $d(t,"credential-already-in-use",u);if(f==="EMAIL_EXISTS")throw $d(t,"email-already-in-use",u);if(f==="USER_DISABLED")throw $d(t,"user-disabled",u);const _=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw qw(t,_,g);Rr(t,_)}}catch(a){if(a instanceof Fi)throw a;Rr(t,"network-request-failed",{message:String(a)})}}async function of(t,e,n,i,a={}){const l=await Hs(t,e,n,i,a);return"mfaPendingCredential"in l&&Rr(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function Qw(t,e,n,i){const a=`${e}${n}?${i}`,l=t,u=l.config.emulator?vy(t.config,a):`${t.config.apiScheme}://${a}`;return tM.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function rM(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iM{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(ii(this.auth,"network-request-failed")),nM.get())})}}function $d(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=ii(t,e,i);return a.customData._tokenResponse=n,a}function UE(t){return t!==void 0&&t.enterprise!==void 0}class sM{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return rM(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function aM(t,e){return Hs(t,"GET","/v2/recaptchaConfig",Va(t,e))}async function oM(t,e){return Hs(t,"POST","/v1/accounts:delete",e)}async function Dh(t,e){return Hs(t,"POST","/v1/accounts:lookup",e)}function Vc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function lM(t,e=!1){const n=nn(t),i=await n.getIdToken(e),a=by(i);je(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:i,authTime:Vc(Op(a.auth_time)),issuedAtTime:Vc(Op(a.iat)),expirationTime:Vc(Op(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Op(t){return Number(t)*1e3}function by(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return rh("JWT malformed, contained fewer than 3 sections"),null;try{const a=KS(n);return a?JSON.parse(a):(rh("Failed to decode base64 JWT payload"),null)}catch(a){return rh("Caught error parsing JWT payload as JSON",a?.toString()),null}}function BE(t){const e=by(t);return je(e,"internal-error"),je(typeof e.exp<"u","internal-error"),je(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Qc(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Fi&&cM(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function cM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class uM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class gg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vc(this.lastLoginAt),this.creationTime=Vc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ih(t){const e=t.auth,n=await t.getIdToken(),i=await Qc(t,Dh(e,{idToken:n}));je(i?.users.length,e,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=a.providerUserInfo?.length?Kw(a.providerUserInfo):[],u=hM(t.providerData,l),d=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!u?.length,g=d?f:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new gg(a.createdAt,a.lastLoginAt),isAnonymous:g};Object.assign(t,_)}async function dM(t){const e=nn(t);await Ih(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hM(t,e){return[...t.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function Kw(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function fM(t,e){const n=await Hw(t,{},async()=>{const i=Jc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,u=await Qw(t,a,"/v1/token",`key=${l}`),d=await t._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:i};return t.emulatorConfig&&nl(t.emulatorConfig.host)&&(f.credentials="include"),Gw.fetch()(u,f)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function mM(t,e){return Hs(t,"POST","/v2/accounts:revokeToken",Va(t,e))}class Uo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){je(e.idToken,"internal-error"),je(typeof e.idToken<"u","internal-error"),je(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):BE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){je(e.length!==0,"internal-error");const n=BE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(je(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:a,expiresIn:l}=await fM(e,n);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:a,expirationTime:l}=n,u=new Uo;return i&&(je(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),a&&(je(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(je(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Uo,this.toJSON())}_performRefresh(){return Di("not implemented")}}function Ss(t,e){je(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ar{constructor({uid:e,auth:n,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new uM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new gg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await Qc(this,this.stsTokenManager.getToken(this.auth,e));return je(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return lM(this,e)}reload(){return dM(this)}_assign(e){this!==e&&(je(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ar({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Ih(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Tr(this.auth.app))return Promise.reject(ks(this.auth));const e=await this.getIdToken();return await Qc(this,oM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,a=n.email??void 0,l=n.phoneNumber??void 0,u=n.photoURL??void 0,d=n.tenantId??void 0,f=n._redirectEventId??void 0,g=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:v,emailVerified:E,isAnonymous:T,providerData:w,stsTokenManager:I}=n;je(v&&I,e,"internal-error");const N=Uo.fromJSON(this.name,I);je(typeof v=="string",e,"internal-error"),Ss(i,e.name),Ss(a,e.name),je(typeof E=="boolean",e,"internal-error"),je(typeof T=="boolean",e,"internal-error"),Ss(l,e.name),Ss(u,e.name),Ss(d,e.name),Ss(f,e.name),Ss(g,e.name),Ss(_,e.name);const U=new Ar({uid:v,auth:e,email:a,emailVerified:E,displayName:i,isAnonymous:T,photoURL:u,phoneNumber:l,tenantId:d,stsTokenManager:N,createdAt:g,lastLoginAt:_});return w&&Array.isArray(w)&&(U.providerData=w.map(G=>({...G}))),f&&(U._redirectEventId=f),U}static async _fromIdTokenResponse(e,n,i=!1){const a=new Uo;a.updateFromServerResponse(n);const l=new Ar({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Ih(l),l}static async _fromGetAccountInfoResponse(e,n,i){const a=n.users[0];je(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?Kw(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,d=new Uo;d.updateFromIdToken(i);const f=new Ar({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:u}),g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new gg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(f,g),f}}const zE=new Map;function Ii(t){Bi(t instanceof Function,"Expected a class definition");let e=zE.get(t);return e?(Bi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,zE.set(t,e),e)}class $w{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}$w.type="NONE";const FE=$w;function ih(t,e,n){return`firebase:${t}:${e}:${n}`}class Bo{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=ih(this.userKey,a.apiKey,l),this.fullPersistenceKey=ih("persistence",a.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Dh(this.auth,{idToken:e}).catch(()=>{});return n?Ar._fromGetAccountInfoResponse(this.auth,n,e):null}return Ar._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Bo(Ii(FE),e,i);const a=(await Promise.all(n.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let l=a[0]||Ii(FE);const u=ih(i,e.config.apiKey,e.name);let d=null;for(const g of n)try{const _=await g._get(u);if(_){let v;if(typeof _=="string"){const E=await Dh(e,{idToken:_}).catch(()=>{});if(!E)break;v=await Ar._fromGetAccountInfoResponse(e,E,_)}else v=Ar._fromJSON(e,_);g!==l&&(d=v),l=g;break}}catch{}const f=a.filter(g=>g._shouldAllowMigration);return!l._shouldAllowMigration||!f.length?new Bo(l,e,i):(l=f[0],d&&await l._set(u,d.toJSON()),await Promise.all(n.map(async g=>{if(g!==l)try{await g._remove(u)}catch{}})),new Bo(l,e,i))}}function qE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Jw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Yw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(eT(e))return"Blackberry";if(tT(e))return"Webos";if(Ww(e))return"Safari";if((e.includes("chrome/")||Xw(e))&&!e.includes("edge/"))return"Chrome";if(Zw(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function Yw(t=vn()){return/firefox\//i.test(t)}function Ww(t=vn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Xw(t=vn()){return/crios\//i.test(t)}function Jw(t=vn()){return/iemobile/i.test(t)}function Zw(t=vn()){return/android/i.test(t)}function eT(t=vn()){return/blackberry/i.test(t)}function tT(t=vn()){return/webos/i.test(t)}function Ey(t=vn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function pM(t=vn()){return Ey(t)&&!!window.navigator?.standalone}function gM(){return _D()&&document.documentMode===10}function nT(t=vn()){return Ey(t)||Zw(t)||tT(t)||eT(t)||/windows phone/i.test(t)||Jw(t)}function rT(t,e=[]){let n;switch(t){case"Browser":n=qE(vn());break;case"Worker":n=`${qE(vn())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${rl}/${i}`}class yM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=l=>new Promise((u,d)=>{try{const f=e(l);u(f)}catch(f){d(f)}});i.onAbort=n,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function _M(t,e={}){return Hs(t,"GET","/v2/passwordPolicy",Va(t,e))}const vM=6;class bM{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??vM,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class EM{constructor(e,n,i,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new GE(this),this.idTokenSubscription=new GE(this),this.beforeStateQueue=new yM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Fw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ii(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Bo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Dh(this,{idToken:e}),i=await Ar._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Tr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=i?._redirectEventId,d=await this.tryRedirectSignIn(e);(!l||l===u)&&d?.user&&(i=d.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return je(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ih(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Zj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Tr(this.app))return Promise.reject(ks(this));const n=e?nn(e):null;return n&&je(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&je(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Tr(this.app)?Promise.reject(ks(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Tr(this.app)?Promise.reject(ks(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ii(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _M(this),n=new bM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Xc("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await mM(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ii(e)||this._popupRedirectResolver;je(n,this,"argument-error"),this.redirectPersistenceManager=await Bo.create(this,[Ii(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,a){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let u=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(je(d,this,"internal-error"),d.then(()=>{u||l(this.currentUser)}),typeof n=="function"){const f=e.addObserver(n,i,a);return()=>{u=!0,f()}}else{const f=e.addObserver(n);return()=>{u=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=rT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Tr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Wj(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ul(t){return nn(t)}class GE{constructor(e){this.auth=e,this.observer=null,this.addObserver=AD(n=>this.observer=n)}get next(){return je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let lf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function SM(t){lf=t}function iT(t){return lf.loadJS(t)}function xM(){return lf.recaptchaEnterpriseScript}function wM(){return lf.gapiScript}function TM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class AM{constructor(){this.enterprise=new CM}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class CM{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const RM="recaptcha-enterprise",sT="NO_RECAPTCHA";class DM{constructor(e){this.type=RM,this.auth=ul(e)}async verify(e="verify",n=!1){async function i(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,d)=>{aM(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const g=new sM(f);return l.tenantId==null?l._agentRecaptchaConfig=g:l._tenantRecaptchaConfigs[l.tenantId]=g,u(g.siteKey)}}).catch(f=>{d(f)})})}function a(l,u,d){const f=window.grecaptcha;UE(f)?f.enterprise.ready(()=>{f.enterprise.execute(l,{action:e}).then(g=>{u(g)}).catch(()=>{u(sT)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new AM().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(d=>{if(!n&&UE(window.grecaptcha))a(d,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let f=xM();f.length!==0&&(f+=d),iT(f).then(()=>{a(d,l,u)}).catch(g=>{u(g)})}}).catch(d=>{u(d)})})}}async function HE(t,e,n,i=!1,a=!1){const l=new DM(t);let u;if(a)u=sT;else try{u=await l.verify(n)}catch{u=await l.verify(n,!0)}const d={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const f=d.phoneEnrollmentInfo.phoneNumber,g=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const f=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:u}):Object.assign(d,{captchaResponse:u}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function QE(t,e,n,i,a){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await HE(t,e,n,n==="getOobCode");return i(t,l)}else return i(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await HE(t,e,n,n==="getOobCode");return i(t,u)}else return Promise.reject(l)})}function IM(t,e){const n=Pg(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),l=n.getOptions();if(Ns(l,e??{}))return a;Rr(a,"already-initialized")}return n.initialize({options:e})}function OM(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(Ii);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function jM(t,e,n){const i=ul(t);je(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=aT(e),{host:u,port:d}=MM(e),f=d===null?"":`:${d}`,g={url:`${l}//${u}${f}/`},_=Object.freeze({host:u,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){je(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),je(Ns(g,i.config.emulator)&&Ns(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,nl(u)?(XS(`${l}//${u}${f}`),JS("Auth",!0)):kM()}function aT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function MM(t){const e=aT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:KE(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:KE(u)}}}function KE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function kM(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Sy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Di("not implemented")}_getIdTokenResponse(e){return Di("not implemented")}_linkToIdToken(e,n){return Di("not implemented")}_getReauthenticationResolver(e){return Di("not implemented")}}async function NM(t,e){return Hs(t,"POST","/v1/accounts:signUp",e)}async function PM(t,e){return of(t,"POST","/v1/accounts:signInWithPassword",Va(t,e))}async function VM(t,e){return of(t,"POST","/v1/accounts:signInWithEmailLink",Va(t,e))}async function LM(t,e){return of(t,"POST","/v1/accounts:signInWithEmailLink",Va(t,e))}class Kc extends Sy{constructor(e,n,i,a=null){super("password",i),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new Kc(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new Kc(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return QE(e,n,"signInWithPassword",PM);case"emailLink":return VM(e,{email:this._email,oobCode:this._password});default:Rr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return QE(e,i,"signUpPassword",NM);case"emailLink":return LM(e,{idToken:n,email:this._email,oobCode:this._password});default:Rr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function zo(t,e){return of(t,"POST","/v1/accounts:signInWithIdp",Va(t,e))}const UM="http://localhost";class ja extends Sy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ja(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Rr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=n;if(!i||!a)return null;const u=new ja(i,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const n=this.buildRequest();return zo(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,zo(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,zo(e,n)}buildRequest(){const e={requestUri:UM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Jc(n)}return e}}function BM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function zM(t){const e=bc(Ec(t)).link,n=e?bc(Ec(e)).deep_link_id:null,i=bc(Ec(t)).deep_link_id;return(i?bc(Ec(i)).link:null)||i||n||e||t}class xy{constructor(e){const n=bc(Ec(e)),i=n.apiKey??null,a=n.oobCode??null,l=BM(n.mode??null);je(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=zM(e);try{return new xy(n)}catch{return null}}}class dl{constructor(){this.providerId=dl.PROVIDER_ID}static credential(e,n){return Kc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=xy.parseLink(n);return je(i,"argument-error"),Kc._fromEmailAndCode(e,i.code,i.tenantId)}}dl.PROVIDER_ID="password";dl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";dl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class oT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ou extends oT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class xs extends ou{constructor(){super("facebook.com")}static credential(e){return ja._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xs.credentialFromTaggedObject(e)}static credentialFromError(e){return xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xs.credential(e.oauthAccessToken)}catch{return null}}}xs.FACEBOOK_SIGN_IN_METHOD="facebook.com";xs.PROVIDER_ID="facebook.com";class ws extends ou{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ja._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return ws.credential(n,i)}catch{return null}}}ws.GOOGLE_SIGN_IN_METHOD="google.com";ws.PROVIDER_ID="google.com";class Ts extends ou{constructor(){super("github.com")}static credential(e){return ja._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.GITHUB_SIGN_IN_METHOD="github.com";Ts.PROVIDER_ID="github.com";class As extends ou{constructor(){super("twitter.com")}static credential(e,n){return ja._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return As.credential(n,i)}catch{return null}}}As.TWITTER_SIGN_IN_METHOD="twitter.com";As.PROVIDER_ID="twitter.com";class Wo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,a=!1){const l=await Ar._fromIdTokenResponse(e,i,a),u=$E(i);return new Wo({user:l,providerId:u,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const a=$E(i);return new Wo({user:e,providerId:a,_tokenResponse:i,operationType:n})}}function $E(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Oh extends Fi{constructor(e,n,i,a){super(n.code,n.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Oh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,a){return new Oh(e,n,i,a)}}function lT(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Oh._fromErrorAndOperation(t,l,e,i):l})}async function FM(t,e,n=!1){const i=await Qc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Wo._forOperation(t,"link",i)}async function qM(t,e,n=!1){const{auth:i}=t;if(Tr(i.app))return Promise.reject(ks(i));const a="reauthenticate";try{const l=await Qc(t,lT(i,a,e,t),n);je(l.idToken,i,"internal-error");const u=by(l.idToken);je(u,i,"internal-error");const{sub:d}=u;return je(t.uid===d,i,"user-mismatch"),Wo._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Rr(i,"user-mismatch"),l}}async function cT(t,e,n=!1){if(Tr(t.app))return Promise.reject(ks(t));const i="signIn",a=await lT(t,i,e),l=await Wo._fromIdTokenResponse(t,i,a);return n||await t._updateCurrentUser(l.user),l}async function GM(t,e){return cT(ul(t),e)}async function HM(t){const e=ul(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function QM(t,e,n){return Tr(t.app)?Promise.reject(ks(t)):GM(nn(t),dl.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&HM(t),i})}function KM(t,e,n,i){return nn(t).onIdTokenChanged(e,n,i)}function $M(t,e,n){return nn(t).beforeAuthStateChanged(e,n)}function YM(t,e,n,i){return nn(t).onAuthStateChanged(e,n,i)}function WM(t){return nn(t).signOut()}const jh="__sak";class uT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(jh,"1"),this.storage.removeItem(jh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const XM=1e3,JM=10;class dT extends uT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=nT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),a=this.localCache[n];i!==a&&e(n,a,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((u,d,f)=>{this.notifyListeners(u,f)});return}const i=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(i);!n&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);gM()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,JM):a()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},XM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}dT.type="LOCAL";const ZM=dT;class hT extends uT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}hT.type="SESSION";const fT=hT;function ek(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class cf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const i=new cf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:a,data:l}=n.data,u=this.handlersMap[a];if(!u?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const d=Array.from(u).map(async g=>g(n.origin,l)),f=await ek(d);n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:f})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}cf.receivers=[];function wy(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class tk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((d,f)=>{const g=wy("",20);a.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},i);u={messageChannel:a,onMessage(v){const E=v;if(E.data.eventId===g)switch(E.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(E.data.response);break;default:clearTimeout(_),clearTimeout(l),f(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:g,data:n},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function si(){return window}function nk(t){si().location.href=t}function mT(){return typeof si().WorkerGlobalScope<"u"&&typeof si().importScripts=="function"}async function rk(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ik(){return navigator?.serviceWorker?.controller||null}function sk(){return mT()?self:null}const pT="firebaseLocalStorageDb",ak=1,Mh="firebaseLocalStorage",gT="fbase_key";class lu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function uf(t,e){return t.transaction([Mh],e?"readwrite":"readonly").objectStore(Mh)}function ok(){const t=indexedDB.deleteDatabase(pT);return new lu(t).toPromise()}function yg(){const t=indexedDB.open(pT,ak);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Mh,{keyPath:gT})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Mh)?e(i):(i.close(),await ok(),e(await yg()))})})}async function YE(t,e,n){const i=uf(t,!0).put({[gT]:e,value:n});return new lu(i).toPromise()}async function lk(t,e){const n=uf(t,!1).get(e),i=await new lu(n).toPromise();return i===void 0?null:i.value}function WE(t,e){const n=uf(t,!0).delete(e);return new lu(n).toPromise()}const ck=800,uk=3;class yT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>uk)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=cf._getInstance(sk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await rk(),!this.activeServiceWorker)return;this.sender=new tk(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ik()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await yg();return await YE(e,jh,"1"),await WE(e,jh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>YE(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>lk(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>WE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=uf(a,!1).getAll();return new lu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ck)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yT.type="LOCAL";const dk=yT;new au(3e4,6e4);function hk(t,e){return e?Ii(e):(je(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Ty extends Sy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return zo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return zo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return zo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function fk(t){return cT(t.auth,new Ty(t),t.bypassAuthState)}function mk(t){const{auth:e,user:n}=t;return je(n,e,"internal-error"),qM(n,new Ty(t),t.bypassAuthState)}async function pk(t){const{auth:e,user:n}=t;return je(n,e,"internal-error"),FM(n,new Ty(t),t.bypassAuthState)}class _T{constructor(e,n,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:a,tenantId:l,error:u,type:d}=e;if(u){this.reject(u);return}const f={auth:this.auth,requestUri:n,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return fk;case"linkViaPopup":case"linkViaRedirect":return pk;case"reauthViaPopup":case"reauthViaRedirect":return mk;default:Rr(this.auth,"internal-error")}}resolve(e){Bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const gk=new au(2e3,1e4);class Po extends _T{constructor(e,n,i,a,l){super(e,n,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Po.currentPopupAction&&Po.currentPopupAction.cancel(),Po.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return je(e,this.auth,"internal-error"),e}async onExecution(){Bi(this.filter.length===1,"Popup operations only handle one event");const e=wy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ii(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ii(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Po.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ii(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,gk.get())};e()}}Po.currentPopupAction=null;const yk="pendingRedirect",sh=new Map;class _k extends _T{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=sh.get(this.auth._key());if(!e){try{const i=await vk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}sh.set(this.auth._key(),e)}return this.bypassAuthState||sh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function vk(t,e){const n=Sk(e),i=Ek(t);if(!await i._isAvailable())return!1;const a=await i._get(n)==="true";return await i._remove(n),a}function bk(t,e){sh.set(t._key(),e)}function Ek(t){return Ii(t._redirectPersistence)}function Sk(t){return ih(yk,t.config.apiKey,t.name)}async function xk(t,e,n=!1){if(Tr(t.app))return Promise.reject(ks(t));const i=ul(t),a=hk(i,e),u=await new _k(i,a,n).execute();return u&&!n&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}const wk=600*1e3;class Tk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Ak(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!vT(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(ii(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wk&&this.cachedEventUids.clear(),this.cachedEventUids.has(XE(e))}saveEventToCache(e){this.cachedEventUids.add(XE(e)),this.lastProcessedEventTime=Date.now()}}function XE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function vT({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function Ak(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vT(t);default:return!1}}async function Ck(t,e={}){return Hs(t,"GET","/v1/projects",e)}const Rk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Dk=/^https?/;async function Ik(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Ck(t);for(const n of e)try{if(Ok(n))return}catch{}Rr(t,"unauthorized-domain")}function Ok(t){const e=pg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const u=new URL(t);return u.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&u.hostname===i}if(!Dk.test(n))return!1;if(Rk.test(t))return i===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const jk=new au(3e4,6e4);function JE(){const t=si().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Mk(t){return new Promise((e,n)=>{function i(){JE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{JE(),n(ii(t,"network-request-failed"))},timeout:jk.get()})}if(si().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(si().gapi?.load)i();else{const a=TM("iframefcb");return si()[a]=()=>{gapi.load?i():n(ii(t,"network-request-failed"))},iT(`${wM()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw ah=null,e})}let ah=null;function kk(t){return ah=ah||Mk(t),ah}const Nk=new au(5e3,15e3),Pk="__/auth/iframe",Vk="emulator/auth/iframe",Lk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Uk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Bk(t){const e=t.config;je(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?vy(e,Vk):`https://${t.config.authDomain}/${Pk}`,i={apiKey:e.apiKey,appName:t.name,v:rl},a=Uk.get(t.config.apiHost);a&&(i.eid=a);const l=t._getFrameworks();return l.length&&(i.fw=l.join(",")),`${n}?${Jc(i).slice(1)}`}async function zk(t){const e=await kk(t),n=si().gapi;return je(n,t,"internal-error"),e.open({where:document.body,url:Bk(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Lk,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const u=ii(t,"network-request-failed"),d=si().setTimeout(()=>{l(u)},Nk.get());function f(){si().clearTimeout(d),a(i)}i.ping(f).then(f,()=>{l(u)})}))}const Fk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qk=500,Gk=600,Hk="_blank",Qk="http://localhost";class ZE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Kk(t,e,n,i=qk,a=Gk){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const f={...Fk,width:i.toString(),height:a.toString(),top:l,left:u},g=vn().toLowerCase();n&&(d=Xw(g)?Hk:n),Yw(g)&&(e=e||Qk,f.scrollbars="yes");const _=Object.entries(f).reduce((E,[T,w])=>`${E}${T}=${w},`,"");if(pM(g)&&d!=="_self")return $k(e||"",d),new ZE(null);const v=window.open(e||"",d,_);je(v,t,"popup-blocked");try{v.focus()}catch{}return new ZE(v)}function $k(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const Yk="__/auth/handler",Wk="emulator/auth/handler",Xk=encodeURIComponent("fac");async function eS(t,e,n,i,a,l){je(t.config.authDomain,t,"auth-domain-config-required"),je(t.config.apiKey,t,"invalid-api-key");const u={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:rl,eventId:a};if(e instanceof oT){e.setDefaultLanguage(t.languageCode),u.providerId=e.providerId||"",TD(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))u[_]=v}if(e instanceof ou){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(u.scopes=_.join(","))}t.tenantId&&(u.tid=t.tenantId);const d=u;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const f=await t._getAppCheckToken(),g=f?`#${Xk}=${encodeURIComponent(f)}`:"";return`${Jk(t)}?${Jc(d).slice(1)}${g}`}function Jk({config:t}){return t.emulator?vy(t,Wk):`https://${t.authDomain}/${Yk}`}const jp="webStorageSupport";class Zk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fT,this._completeRedirectFn=xk,this._overrideRedirectResult=bk}async _openPopup(e,n,i,a){Bi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await eS(e,n,i,pg(),a);return Kk(e,l,wy())}async _openRedirect(e,n,i,a){await this._originValidation(e);const l=await eS(e,n,i,pg(),a);return nk(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:l}=this.eventManagers[n];return a?Promise.resolve(a):(Bi(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await zk(e),i=new Tk(e);return n.register("authEvent",a=>(je(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(jp,{type:jp},a=>{const l=a?.[0]?.[jp];l!==void 0&&n(!!l),Rr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Ik(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return nT()||Ww()||Ey()}}const eN=Zk;var tS="@firebase/auth",nS="1.12.0";class tN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function nN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rN(t){Fo(new Ra("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:d}=i.options;je(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:u,authDomain:d,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:rT(t)},g=new EM(i,a,l,f);return OM(g,n),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Fo(new Ra("auth-internal",e=>{const n=ul(e.getProvider("auth").getImmediate());return(i=>new tN(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Os(tS,nS,nN(t)),Os(tS,nS,"esm2020")}const iN=300,sN=WS("authIdTokenMaxAge")||iN;let rS=null;const aN=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>sN)return;const a=n?.token;rS!==a&&(rS=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function oN(t=nx()){const e=Pg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=IM(t,{popupRedirectResolver:eN,persistence:[dk,ZM,fT]}),i=WS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=aN(l.toString());$M(n,u,()=>u(n.currentUser)),KM(n,d=>u(d))}}const a=$S("auth");return a&&jM(n,`http://${a}`),n}function lN(){return document.getElementsByTagName("head")?.[0]??document}SM({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=a=>{const l=ii("internal-error");l.customData=a,n(l)},i.type="text/javascript",i.charset="UTF-8",lN().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});rN("Browser");function La(){const t=oN(Lw);async function e(){return!1}async function n(d,f){return QM(t,d,f)}function i(){return WM(t)}function a(d){YM(t,f=>{d(f)})}function l(){return t.currentUser}return{set_user_listener:a,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:i,get_current_firebase_user:l}}const cN={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},bT=O.createContext(cN);function uN({children:t}){const n=La().get_current_firebase_user(),[i,a]=O.useState(null),[l,u]=O.useState(new Date().getFullYear()),[d,f]=O.useState(new Date().getMonth()+1),[g,_]=O.useState(!1),[v,E]=O.useState(!1),T=Rj(n?.uid||null,n?.email||null),w=Ij(n?.uid||null,T.data||null,{enabled:!!n?.uid&&!!T.data}),I=T.data?.permission_flags?.is_admin===!0,N=T.data?.permission_flags?.is_test===!0,U=w.data?.pendingInvites||[],G=w.data?.budgets||[],z=U.length>0;O.useEffect(()=>{if(!n||g||T.isLoading||w.isLoading)return;const C=T.data,L=w.data;!C&&!T.isError||(C&&C.budget_ids.length>0?(a(C.budget_ids[0]),E(!1)):L?.pendingInvites&&L.pendingInvites.length>0?E(!1):E(!0),_(!0))},[n,g,T.data,T.isLoading,T.isError,w.data,w.isLoading]);const $=O.useCallback(()=>{f(C=>C===1?(u(L=>L-1),12):C-1)},[]),J=O.useCallback(()=>{f(C=>C===12?(u(L=>L+1),1):C+1)},[]),te=O.useCallback(async()=>{await w.refetch()},[w]),j=O.useCallback(C=>{a(C)},[]),A=O.useCallback(async C=>{if(!n)return null;try{const L=await Gj(C,n.uid);return L&&L.isInvited&&!L.hasAccepted?{budgetId:C,budgetName:L.budgetName,ownerEmail:L.ownerEmail}:null}catch(L){return console.error("[BudgetContext] Error checking budget invite:",L),null}},[n]),R=O.useCallback(()=>{He.clear(),localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),D={currentUserId:n?.uid||null,selectedBudgetId:i,currentYear:l,currentMonthNumber:d,setSelectedBudgetId:a,setCurrentYear:u,setCurrentMonthNumber:f,isInitialized:g,needsFirstBudget:v,goToPreviousMonth:$,goToNextMonth:J,pendingInvites:U,hasPendingInvites:z,accessibleBudgets:G,isAdmin:I,isTest:N,loadAccessibleBudgets:te,switchToBudget:j,checkBudgetInvite:A,clearCache:R};return m.jsx(bT.Provider,{value:D,children:t})}function wn(){const t=O.useContext(bT);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}function dN(){return m.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[m.jsx("h1",{children:"Welcome"}),m.jsx("nav",{children:m.jsxs("ul",{children:[m.jsx("li",{children:m.jsx(Tt,{to:"/sql-test",children:"SQL Test"})}),m.jsx("li",{children:m.jsx(Tt,{to:"/budget",children:"Budget"})}),m.jsx("li",{children:m.jsx(Tt,{to:"/account",children:"Account"})})]})})]})}function hN(){return m.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[m.jsx("nav",{children:m.jsx(Tt,{to:"/",children:" Back to Home"})}),m.jsx("h1",{children:"SQL Test"}),m.jsx("h2",{children:"Setup"}),m.jsxs("h3",{children:["1. Open up your preferred web browser to ",m.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),m.jsxs("ul",{children:[m.jsx("li",{children:"This is a basic online sql query editor"}),m.jsxs("li",{children:["It will include three tables: ",m.jsx("b",{children:'"Customer"'}),", ",m.jsx("b",{children:'"Orders"'}),", and ",m.jsx("b",{children:'"Shippings"'})]})]}),m.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),m.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:m.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),m.jsx("h2",{children:"SQL Problems"}),m.jsx("p",{children:"Write queries in the online editor to answer these questions."}),m.jsx("h3",{children:"Question #1"}),m.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),m.jsx("h3",{children:"Question #2"}),m.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function fN(){const t=O.useContext(Wc),e=La(),[n,i]=O.useState(!1),a=hr(),l=Lh(),u=a.state?.from||"/";O.useEffect(()=>{t.is_logged_in&&u!=="/"&&l(u,{replace:!0})},[t.is_logged_in,u,l]);function d(){i(!0),e.logout_firebase_user().then(function(){i(!1)})}return m.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[m.jsx("h1",{children:"Account"}),t.is_logged_in?n?m.jsx("p",{children:"Logging Out..."}):m.jsxs(m.Fragment,{children:[m.jsxs("p",{children:["You are logged in as ",t.username]}),m.jsx("button",{onClick:d,style:{marginTop:"1rem"},children:"Logout"})]}):m.jsx(mN,{}),m.jsx("p",{children:m.jsx(Tt,{to:"/",children:"Back to Home"})})]})}function mN(){const t=La(),[e,n]=O.useState(""),[i,a]=O.useState(""),[l,u]=O.useState(!1),[d,f]=O.useState("");function g(E){n(E.target.value)}function _(E){a(E.target.value)}function v(E){E.preventDefault(),u(!0),f(""),t.login_firebase_user(e,i).then(function(){}).catch(function(){f("Incorrect login credentials")}).finally(function(){u(!1)})}return m.jsxs("form",{onSubmit:v,children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"username",children:"Email: "}),m.jsx("input",{id:"username",type:"email",value:e,onChange:g})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"password",children:"Password: "}),m.jsx("input",{id:"password",type:"password",value:i,onChange:_})]}),l?m.jsx("p",{children:"Logging in..."}):m.jsx("button",{children:"Login"}),d&&m.jsx("p",{style:{color:"red"},children:d})]})}const pN={mobile:640},gN=pN.mobile,ET=["January","February","March","April","May","June","July","August","September","October","November","December"],iS="admin_active_tab",yN=["my-budgets","accounts","categories","users","migration","feedback","tests"];function Qs(t=gN){const[e,n]=O.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return O.useEffect(()=>{function i(){n(window.innerWidth<t)}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[t]),e}function Kn(t,e){const n=vj(t),i=Lj(),a=qj(),l=n.data,u=l?.budget||null,d=O.useMemo(()=>l?.accounts||{},[l?.accounts]),f=O.useMemo(()=>l?.accountGroups||{},[l?.accountGroups]),g=O.useMemo(()=>l?.categories||{},[l?.categories]),_=O.useMemo(()=>l?.categoryGroups||[],[l?.categoryGroups]),v=l?.categoryBalancesSnapshot||null,E=u?.owner_id===e,T=O.useMemo(()=>u?.user_ids||[],[u?.user_ids]),w=O.useMemo(()=>u?.accepted_user_ids||[],[u?.accepted_user_ids]),I=O.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.updateAccounts.mutateAsync({budgetId:t,accounts:Q})},[t,i.updateAccounts]),N=O.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.updateAccountGroups.mutateAsync({budgetId:t,accountGroups:Q})},[t,i.updateAccountGroups]),U=O.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.updateCategories.mutateAsync({budgetId:t,categories:Q})},[t,i.updateCategories]),G=O.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.updateCategoryGroups.mutateAsync({budgetId:t,categoryGroups:Q})},[t,i.updateCategoryGroups]),z=O.useCallback(async(Q,W)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.updateAccounts.mutateAsync({budgetId:t,accounts:Q}),i.updateAccountGroups.mutateAsync({budgetId:t,accountGroups:W})])},[t,i]),$=O.useCallback(async(Q,W)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.updateCategories.mutateAsync({budgetId:t,categories:Q}),i.updateCategoryGroups.mutateAsync({budgetId:t,categoryGroups:W})])},[t,i]),J=O.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.renameBudget.mutateAsync({budgetId:t,newName:Q})},[t,i.renameBudget]),te=O.useCallback(async Q=>{if(!e)throw new Error("Not authenticated");return await a.createBudget.mutateAsync({name:Q.trim()||"My Budget",userId:e,userEmail:null})},[e,a.createBudget]),j=O.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await a.inviteUser.mutateAsync({budgetId:t,userId:Q})},[t,a.inviteUser]),A=O.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await a.revokeUser.mutateAsync({budgetId:t,userId:Q})},[t,a.revokeUser]),R=O.useCallback(async Q=>{if(!e)throw new Error("Not authenticated");await a.acceptInvite.mutateAsync({budgetId:Q,userId:e})},[e,a.acceptInvite]),D=O.useCallback(async(Q,W,P)=>{if(!t)throw new Error("No budget selected");await i.saveCategoryBalancesSnapshot.mutateAsync({budgetId:t,balances:Q,year:W,month:P})},[t,i.saveCategoryBalancesSnapshot]),C=O.useCallback(async(Q,W,P,X)=>{if(!t)throw new Error("No budget selected");await i.recalculateCategoryBalances.mutateAsync({budgetId:t,categories:Q,balances:W,year:P,month:X})},[t,i.recalculateCategoryBalances]),L=O.useCallback(Q=>{if(!t)return;const W=He.getQueryData(le.budget(t));W&&He.setQueryData(le.budget(t),{...W,accounts:Q})},[t]),k=O.useCallback(Q=>{if(!t)return;const W=He.getQueryData(le.budget(t));W&&He.setQueryData(le.budget(t),{...W,accountGroups:Q})},[t]),ee=O.useCallback(Q=>{if(!t)return;const W=He.getQueryData(le.budget(t));W&&He.setQueryData(le.budget(t),{...W,categories:Q})},[t]),H=O.useCallback(Q=>{if(!t)return;const W=He.getQueryData(le.budget(t));W&&He.setQueryData(le.budget(t),{...W,categoryGroups:Q})},[t]),B=O.useCallback(Q=>{if(!t)return;const W=He.getQueryData(le.budget(t));W&&He.setQueryData(le.budget(t),{...W,categoryBalancesSnapshot:Q})},[t]),q=O.useCallback(async()=>{t&&await He.invalidateQueries({queryKey:le.budget(t)})},[t]),F=O.useCallback(()=>Object.entries(d).filter(([,Q])=>{const W=Q.account_group_id?f[Q.account_group_id]:void 0,P=W?.on_budget!==void 0?W.on_budget:Q.on_budget!==!1,X=W?.is_active!==void 0?W.is_active:Q.is_active!==!1;return P&&X}).reduce((Q,[,W])=>Q+W.balance,0),[d,f]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:u,accounts:d,accountGroups:f,categories:g,categoryGroups:_,categoryBalancesSnapshot:v,isOwner:E,budgetUserIds:T,acceptedUserIds:w,saveAccounts:I,saveAccountGroups:N,saveCategories:U,saveCategoryGroups:G,saveAccountsAndGroups:z,saveCategoriesAndGroups:$,renameBudget:J,createBudget:te,inviteUser:j,revokeUser:A,acceptInvite:R,saveCategoryBalancesSnapshot:D,recalculateCategoryBalances:C,setAccountsOptimistic:L,setAccountGroupsOptimistic:k,setCategoriesOptimistic:ee,setCategoryGroupsOptimistic:H,setCategoryBalancesSnapshotOptimistic:B,refreshBudget:q,getOnBudgetTotal:F}}function hl(t,e,n){const i=xj(t,e,n,{enabled:!!t}),a=Aj(t,{enabled:!!t}),l=Fj(),u=i.data?.month||null,d=u?.income||[],f=u?.expenses||[],g=u?.allocations||[],_=u?.category_balances||[],v=u?.total_income||0,E=u?.total_expenses||0,T=u?.allocations_finalized||!1,w=O.useMemo(()=>{if(u?.previous_month_snapshot?.total_income!==void 0)return u.previous_month_snapshot.total_income;if(!t)return 0;let D=e,C=n-1;return C<1&&(C=12,D-=1),He.getQueryData(le.month(t,D,C))?.month?.total_income||0},[u,t,e,n]),I=a.data||[],N=O.useCallback(async(D,C,L,k,ee)=>{if(!t)throw new Error("No budget selected");const[H,B]=L.split("-").map(Number);await l.addIncome.mutateAsync({budgetId:t,year:H,month:B,amount:D,accountId:C,date:L,payee:k,description:ee})},[t,l.addIncome]),U=O.useCallback(async(D,C,L,k,ee,H)=>{if(!t||!u)throw new Error("No budget or month loaded");const B=u.income.find(q=>q.id===D);if(!B)throw new Error("Income not found");await l.updateIncome.mutateAsync({budgetId:t,year:e,month:n,incomeId:D,amount:C,accountId:L,date:k,payee:ee,description:H,oldAmount:B.amount,oldAccountId:B.account_id})},[t,u,e,n,l.updateIncome]),G=O.useCallback(async D=>{if(!t||!u)throw new Error("No budget or month loaded");const C=u.income.find(L=>L.id===D);if(!C)throw new Error("Income not found");await l.deleteIncome.mutateAsync({budgetId:t,year:e,month:n,incomeId:D,amount:C.amount,accountId:C.account_id})},[t,u,e,n,l.deleteIncome]),z=O.useCallback(async(D,C,L,k,ee,H)=>{if(!t)throw new Error("No budget selected");const[B,q]=k.split("-").map(Number);await l.addExpense.mutateAsync({budgetId:t,year:B,month:q,amount:D,categoryId:C,accountId:L,date:k,payee:ee,description:H})},[t,l.addExpense]),$=O.useCallback(async(D,C,L,k,ee,H,B)=>{if(!t||!u)throw new Error("No budget or month loaded");const q=u.expenses?.find(F=>F.id===D);if(!q)throw new Error("Expense not found");await l.updateExpense.mutateAsync({budgetId:t,year:e,month:n,expenseId:D,amount:C,categoryId:L,accountId:k,date:ee,payee:H,description:B,oldAmount:q.amount,oldAccountId:q.account_id})},[t,u,e,n,l.updateExpense]),J=O.useCallback(async D=>{if(!t||!u)throw new Error("No budget or month loaded");const C=u.expenses?.find(L=>L.id===D);if(!C)throw new Error("Expense not found");await l.deleteExpense.mutateAsync({budgetId:t,year:e,month:n,expenseId:D,amount:C.amount,accountId:C.account_id})},[t,u,e,n,l.deleteExpense]),te=O.useCallback(async D=>{if(!t)throw new Error("No budget selected");await l.saveAllocations.mutateAsync({budgetId:t,year:e,month:n,allocations:D})},[t,e,n,l.saveAllocations]),j=O.useCallback(async()=>{if(!t||!u)throw new Error("No budget or month loaded");await l.finalizeAllocations.mutateAsync({budgetId:t,year:e,month:n,allocations:u.allocations||[]})},[t,u,e,n,l.finalizeAllocations]),A=O.useCallback(async()=>{if(!t)throw new Error("No budget selected");await l.unfinalizeAllocations.mutateAsync({budgetId:t,year:e,month:n})},[t,e,n,l.unfinalizeAllocations]),R=O.useCallback(async()=>{t&&await He.invalidateQueries({queryKey:le.month(t,e,n)})},[t,e,n]);return{isLoading:i.isLoading,isFetching:i.isFetching,error:i.error,month:u,income:d,expenses:f,allocations:g,categoryBalances:_,totalIncome:v,totalExpenses:E,allocationsFinalized:T,previousMonthIncome:w,payees:I,payeesLoading:a.isLoading,addIncome:N,updateIncome:U,deleteIncome:G,addExpense:z,updateExpense:$,deleteExpense:J,saveAllocations:te,finalizeAllocations:j,unfinalizeAllocations:A,refreshMonth:R}}function _N(){const{selectedBudgetId:t,currentUserId:e}=wn(),{budget:n,accounts:i,accountGroups:a,saveAccounts:l,saveAccountGroups:u,saveAccountsAndGroups:d,setAccountsOptimistic:f,setAccountGroupsOptimistic:g}=Kn(t,e),[_,v]=O.useState(null),E=O.useMemo(()=>Object.entries(i).reduce((A,[R,D])=>{const C=D.account_group_id||"ungrouped";return A[C]||(A[C]=[]),A[C].push({...D,id:R}),A},{}),[i]),T=O.useMemo(()=>Object.entries(a).sort(([,A],[,R])=>A.sort_order-R.sort_order).map(([A,R])=>({...R,id:A})),[a]),w=O.useCallback((A,R)=>{if(!n)return;const D=Object.values(i).filter(H=>R==="ungrouped"?!H.account_group_id:H.account_group_id===R),C=D.length>0?Math.max(...D.map(H=>H.sort_order)):-1,L=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,k={nickname:A.nickname,balance:0,account_group_id:R==="ungrouped"?null:R,sort_order:C+1,is_income_account:A.is_income_account,is_income_default:A.is_income_default,is_outgo_account:A.is_outgo_account,is_outgo_default:A.is_outgo_default,on_budget:A.on_budget!==!1,is_active:A.is_active!==!1},ee={...i};A.is_income_default&&Object.keys(ee).forEach(H=>{ee[H]={...ee[H],is_income_default:!1}}),A.is_outgo_default&&Object.keys(ee).forEach(H=>{ee[H]={...ee[H],is_outgo_default:!1}}),ee[L]=k,f(ee),l(ee).catch(H=>{console.error("[useAccountHandlers] Error creating account:",H),v(H instanceof Error?H.message:"Failed to create account.")})},[n,i,f,l]),I=O.useCallback((A,R)=>{if(!n)return;const D=i[A];if(!D)return;const C=D.account_group_id||"ungrouped",L=R.account_group_id;let k=D.sort_order;if(C!==(L||"ungrouped")){const H=Object.values(i).filter(B=>(B.account_group_id||"ungrouped")===(L||"ungrouped"));k=H.length>0?Math.max(...H.map(B=>B.sort_order))+1:0}const ee={};Object.entries(i).forEach(([H,B])=>{H===A?ee[H]={...B,nickname:R.nickname,account_group_id:L,sort_order:k,is_income_account:R.is_income_account,is_income_default:R.is_income_default,is_outgo_account:R.is_outgo_account,is_outgo_default:R.is_outgo_default,on_budget:R.on_budget!==!1,is_active:R.is_active!==!1}:(ee[H]={...B},R.is_income_default&&!D.is_income_default&&(ee[H].is_income_default=!1),R.is_outgo_default&&!D.is_outgo_default&&(ee[H].is_outgo_default=!1))}),f(ee),l(ee).catch(H=>{console.error("[useAccountHandlers] Error saving account:",H),v(H instanceof Error?H.message:"Failed to save account.")})},[n,i,f,l]),N=O.useCallback(A=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[A]:R,...D}=i;f(D),l(D).catch(C=>{console.error("[useAccountHandlers] Error deleting account:",C),v(C instanceof Error?C.message:"Failed to delete account.")})},[n,i,f,l]),U=O.useCallback(async(A,R)=>{const D=i[A];if(!D)return;const C=D.account_group_id||"ungrouped",L=Object.entries(i).filter(([,F])=>(F.account_group_id||"ungrouped")===C).sort(([,F],[,Q])=>F.sort_order-Q.sort_order),k=L.findIndex(([F])=>F===A),ee=R==="up"?k-1:k+1;if(ee<0||ee>=L.length)return;const[H,B]=L[ee],q={};if(Object.entries(i).forEach(([F,Q])=>{F===A?q[F]={...Q,sort_order:B.sort_order}:F===H?q[F]={...Q,sort_order:D.sort_order}:q[F]={...Q}}),f(q),!!n)try{await l(q)}catch(F){f(i),v(F instanceof Error?F.message:"Failed to move account")}},[n,i,f,l]),G=O.useCallback(A=>{if(!n)return;const R=Object.values(a).map(ee=>ee.sort_order),D=R.length>0?Math.max(...R):-1,C=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,L={name:A.name,sort_order:D+1,expected_balance:A.expected_balance,on_budget:A.on_budget,is_active:A.is_active},k={...a,[C]:L};g(k),u(k).catch(ee=>{console.error("[useAccountHandlers] Error creating group:",ee),v(ee instanceof Error?ee.message:"Failed to create account type.")})},[n,a,g,u]),z=O.useCallback((A,R)=>{if(!n)return;const D={...a,[A]:{...a[A],name:R.name,expected_balance:R.expected_balance,on_budget:R.on_budget,is_active:R.is_active}};g(D),u(D).catch(C=>{console.error("[useAccountHandlers] Error updating group:",C),v(C instanceof Error?C.message:"Failed to update account type.")})},[n,a,g,u]),$=O.useCallback(A=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const R={};Object.entries(i).forEach(([L,k])=>{R[L]=k.account_group_id===A?{...k,account_group_id:null}:k});const{[A]:D,...C}=a;f(R),g(C),d(R,C).catch(L=>{console.error("[useAccountHandlers] Error deleting group:",L),v(L instanceof Error?L.message:"Failed to delete account type.")})},[n,i,a,f,g,d]),J=O.useCallback(async(A,R)=>{const D=Object.entries(a).sort(([,H],[,B])=>H.sort_order-B.sort_order),C=D.findIndex(([H])=>H===A),L=R==="up"?C-1:C+1;if(L<0||L>=D.length)return;const[k]=D.splice(C,1);D.splice(L,0,k);const ee={};if(D.forEach(([H,B],q)=>{ee[H]={...B,sort_order:q}}),g(ee),!!n)try{await u(ee)}catch(H){g(a),v(H instanceof Error?H.message:"Failed to move account type")}},[n,a,g,u]),te=O.useCallback(async(A,R,D)=>{const C=i[A];if(!C)return;const L=D==="ungrouped"?null:D,k=Object.entries(i).filter(([,B])=>(B.account_group_id||"ungrouped")===D),ee={};Object.entries(i).forEach(([B,q])=>{B!==A&&(ee[B]={...q})});let H;if(R==="__group_end__"||k.length===0||!k.find(([B])=>B===R))H=(k.length>0?Math.max(...k.filter(([q])=>q!==A).map(([,q])=>q.sort_order)):-1)+1;else{const B=k.find(([q])=>q===R);if(B){const[,q]=B;H=q.sort_order,Object.entries(ee).forEach(([F,Q])=>{(Q.account_group_id||"ungrouped")===D&&Q.sort_order>=H&&(ee[F]={...Q,sort_order:Q.sort_order+1})})}else H=0}if(ee[A]={...C,account_group_id:L,sort_order:H},f(ee),!!n)try{await l(ee)}catch(B){v(B instanceof Error?B.message:"Failed to save changes")}},[n,i,f,l]),j=O.useCallback(async(A,R)=>{if(A===R)return;const D=Object.entries(a).sort(([,H],[,B])=>H.sort_order-B.sort_order),C=D.findIndex(([H])=>H===A),L=[...D],[k]=L.splice(C,1);if(R==="__end__")L.push(k);else{const H=L.findIndex(([B])=>B===R);L.splice(H,0,k)}const ee={};if(L.forEach(([H,B],q)=>{ee[H]={...B,sort_order:q}}),g(ee),!!n)try{await u(ee)}catch(H){v(H instanceof Error?H.message:"Failed to save new order")}},[n,a,g,u]);return{accounts:i,accountGroups:a,accountsByGroup:E,sortedGroups:T,currentBudget:n,error:_,setError:v,handleCreateAccount:w,handleUpdateAccount:I,handleDeleteAccount:N,handleMoveAccount:U,handleCreateGroup:G,handleUpdateGroup:z,handleDeleteGroup:$,handleMoveGroup:J,reorderAccountsInGroup:te,reorderGroups:j}}function vN(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=wn(),{categories:a,getOnBudgetTotal:l}=Kn(t,e),{month:u,isLoading:d,previousMonthIncome:f,saveAllocations:g,finalizeAllocations:_}=hl(t,n,i),[v,E]=O.useState({}),[T,w]=O.useState(!1),[I,N]=O.useState(!1),[U,G]=O.useState(!1),[z,$]=O.useState(null),J=O.useMemo(()=>Object.values(a).reduce((q,F)=>q+F.balance,0),[a]);O.useEffect(()=>{if(!u)return;const q={};Object.entries(a).forEach(([F,Q])=>{if(Q.default_monthly_type==="percentage")return;const W=u.allocations?.find(P=>P.category_id===F);W?q[F]=W.amount.toString():Q.default_monthly_amount!==void 0&&Q.default_monthly_amount>0?q[F]=Q.default_monthly_amount.toString():q[F]=""}),E(q)},[u,a]);const te=O.useCallback((q,F)=>{if(F.default_monthly_type==="percentage"&&F.default_monthly_amount!==void 0)return F.default_monthly_amount/100*f;const Q=v[q],W=parseFloat(Q||"0");return isNaN(W)?0:W},[v,f]),j=O.useMemo(()=>Object.entries(a).reduce((q,[F,Q])=>q+te(F,Q),0),[a,te]),A=l(),R=u?.allocations_finalized?(u.allocations||[]).reduce((q,F)=>q+F.amount,0):0,D=A-J,C=O.useMemo(()=>D-j+R,[D,j,R]),L=O.useCallback((q,F)=>{E(Q=>({...Q,[q]:F}))},[]),k=O.useCallback(()=>{if(!u)return;const q={};Object.entries(a).forEach(([F,Q])=>{if(Q.default_monthly_type==="percentage")return;const W=u.allocations?.find(P=>P.category_id===F);W?q[F]=W.amount.toString():Q.default_monthly_amount!==void 0&&Q.default_monthly_amount>0?q[F]=Q.default_monthly_amount.toString():q[F]=""}),E(q),G(!1)},[u,a]),ee=O.useCallback(()=>{const q=[];return Object.entries(a).forEach(([F,Q])=>{const W=te(F,Q);W>0&&q.push({category_id:F,amount:W})}),q},[a,te]),H=O.useCallback(async()=>{$(null),w(!0);try{await g(ee()),G(!1)}catch(q){$(q instanceof Error?q.message:"Failed to save allocations")}finally{w(!1)}},[g,ee]),B=O.useCallback(async()=>{$(null),N(!0);try{await g(ee()),await _()}catch(q){$(q instanceof Error?q.message:"Failed to finalize allocations")}finally{N(!1)}},[g,_,ee]);return{localAllocations:v,isSavingAllocations:T,isFinalizingAllocations:I,isEditingAppliedAllocations:U,error:z,monthLoading:d,onBudgetTotal:A,availableNow:D,currentDraftTotal:j,availableAfterApply:C,previousMonthIncome:f,allocationsFinalized:u?.allocations_finalized??!1,getAllocationAmount:te,handleAllocationChange:L,resetAllocationsToSaved:k,handleSaveAllocations:H,handleFinalizeAllocations:B,setIsEditingAppliedAllocations:G,setError:$}}function bN({budgetId:t,categories:e,categoryBalancesSnapshot:n,currentYear:i,currentMonth:a,saveCategoryBalancesSnapshot:l,recalculateCategoryBalancesMutation:u}){const[d,f]=O.useState({}),[g,_]=O.useState(!1),[v,E]=O.useState(null),T=O.useRef(null),w=O.useCallback(U=>!(!U||U.is_stale||U.computed_for_year!==i||U.computed_for_month!==a),[i,a]);O.useEffect(()=>{if(!t||Object.keys(e).length===0)return;const U=`${t}_${i}_${a}`;if(w(n)){const z={};Object.keys(e).forEach($=>{const J=n.balances[$];z[$]=J||{current:0,total:0}}),f(z),T.current=U;return}if(T.current===U)return;(async()=>{_(!0);try{const z=Object.keys(e),{current:$,total:J}=await Ip(t,z,i,a,n),te={};z.forEach(j=>{te[j]={current:$[j]??0,total:J[j]??0}}),f(te),T.current=U,await l(te,i,a)}catch(z){console.error("Error loading category balances:",z)}finally{_(!1)}})()},[t,e,i,a,n,w,l]);const I=O.useCallback(async()=>{if(!t||Object.keys(e).length===0)return null;const U=Object.keys(e),{total:G}=await Ip(t,U,i,a,null),z={};Object.entries(e).forEach(([J,te])=>{const j=te.balance,A=G[J]??0;Math.abs(j-A)>.01&&(z[J]={stored:j,calculated:A})});const $=Object.keys(z).length>0?z:null;return E($),$},[t,e,i,a]),N=O.useCallback(async()=>{if(!(!t||Object.keys(e).length===0)){_(!0);try{const U=Object.keys(e),{current:G,total:z}=await Ip(t,U,i,a,null),$={};Object.entries(e).forEach(([te,j])=>{$[te]={...j,balance:z[te]??0}});const J={};U.forEach(te=>{J[te]={current:G[te]??0,total:z[te]??0}}),await u($,J,i,a),f(J),E(null)}finally{_(!1)}}},[t,e,u,i,a]);return{categoryBalances:d,loadingBalances:g,categoryBalanceMismatch:v,checkCategoryBalanceMismatch:I,recalculateAndSaveCategoryBalances:N}}function EN({categories:t,categoryGroups:e,currentBudget:n,setCategoriesOptimistic:i,setCategoryGroupsOptimistic:a,saveCategories:l,saveCategoryGroups:u,setError:d}){const[f,g]=O.useState(null),[_,v]=O.useState(null),[E,T]=O.useState(null),[w,I]=O.useState(null);function N(D,C){g("category"),v(C),D.dataTransfer.effectAllowed="move"}function U(D,C,L){D.preventDefault(),f==="category"&&(C!==_&&T(C),I(L))}function G(D,C){D.preventDefault(),f==="category"?(I(C),T(null)):f==="group"&&C!==_&&T(C)}function z(){T(null)}function $(){I(null)}function J(){g(null),v(null),T(null),I(null)}async function te(D,C,L){if(D.preventDefault(),D.stopPropagation(),!_||f!=="category"){J();return}const k=t[_];if(!k)return;const ee=L==="ungrouped"?null:L,H=Object.entries(t).filter(([,F])=>(F.category_group_id||"ungrouped")===L),B={};Object.entries(t).forEach(([F,Q])=>{F!==_&&(B[F]=Q)});let q;if(C==="__group_end__"||H.length===0||!H.find(([F])=>F===C))q=(H.length>0?Math.max(...H.filter(([Q])=>Q!==_).map(([,Q])=>Q.sort_order)):-1)+1;else{const F=H.find(([Q])=>Q===C);F?(q=F[1].sort_order,Object.entries(B).forEach(([Q,W])=>{(W.category_group_id||"ungrouped")===L&&W.sort_order>=q&&(B[Q]={...W,sort_order:W.sort_order+1})})):q=0}if(B[_]={...k,category_group_id:ee,sort_order:q},i(B),J(),!!n)try{await l(B)}catch(F){d(F instanceof Error?F.message:"Failed to save changes")}}async function j(D,C){D.preventDefault(),f==="category"?await te(D,"__group_end__",C):f==="group"&&await R(D,C)}function A(D,C){D.stopPropagation(),g("group"),v(C),D.dataTransfer.effectAllowed="move"}async function R(D,C){if(D.preventDefault(),!_||f!=="group"||_===C){J();return}const L=e.findIndex(B=>B.id===_),k=[...e],[ee]=k.splice(L,1);if(C==="__end__")k.push(ee);else{const B=k.findIndex(q=>q.id===C);k.splice(B,0,ee)}const H=k.map((B,q)=>({...B,sort_order:q}));if(a(H),J(),!!n)try{await u(H)}catch(B){d(B instanceof Error?B.message:"Failed to save new order")}}return{dragType:f,draggedId:_,dragOverId:E,dragOverGroupId:w,setDragOverId:T,setDragOverGroupId:I,handleCategoryDragStart:N,handleCategoryDragOver:U,handleDragOverGroup:G,handleDragLeave:z,handleDragLeaveGroup:$,handleDragEnd:J,handleCategoryDrop:te,handleDropOnGroup:j,handleGroupDragStart:A,handleGroupDrop:R}}function SN(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=wn(),{budget:a,categories:l,categoryGroups:u,categoryBalancesSnapshot:d,saveCategories:f,saveCategoryGroups:g,saveCategoriesAndGroups:_,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:E,saveCategoryBalancesSnapshot:T,recalculateCategoryBalances:w,getOnBudgetTotal:I}=Kn(t,e),[N,U]=O.useState(null),{categoryBalances:G,loadingBalances:z,categoryBalanceMismatch:$,checkCategoryBalanceMismatch:J,recalculateAndSaveCategoryBalances:te}=bN({budgetId:t,categories:l,categoryBalancesSnapshot:d,currentYear:n,currentMonth:i,saveCategoryBalancesSnapshot:T,recalculateCategoryBalancesMutation:w}),j=EN({categories:l,categoryGroups:u,currentBudget:a,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:E,saveCategories:f,saveCategoryGroups:g,setError:U});async function A(F,Q){if(!a)return;const W=Q==="ungrouped"?null:Q,P=Object.values(l).filter(ve=>Q==="ungrouped"?!ve.category_group_id:ve.category_group_id===Q),X=P.length>0?Math.max(...P.map(ve=>ve.sort_order)):-1,he=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,re={name:F.name,description:F.description,category_group_id:W,sort_order:X+1,default_monthly_amount:F.default_monthly_amount,default_monthly_type:F.default_monthly_type,balance:0},ae={...l,[he]:re};v(ae);try{await f(ae)}catch(ve){v(l),U(ve instanceof Error?ve.message:"Failed to create category")}}async function R(F,Q){if(a)try{const W=l[F];if(!W)return;const P=W.category_group_id||"ungrouped",X=Q.category_group_id;let he=W.sort_order;if(P!==(X||"ungrouped")){const ae=Object.values(l).filter(ve=>(ve.category_group_id||"ungrouped")===(X||"ungrouped")).filter((ve,Ae,Ee)=>l[F]!==Ee[Ae]);he=ae.length>0?Math.max(...ae.map(ve=>ve.sort_order))+1:0}const re={...l,[F]:{...W,name:Q.name,description:Q.description,category_group_id:X,sort_order:he,default_monthly_amount:Q.default_monthly_amount,default_monthly_type:Q.default_monthly_type}};v(re),await f(re)}catch(W){U(W instanceof Error?W.message:"Failed to update category")}}async function D(F){if(confirm("Are you sure you want to delete this category?")&&a)try{const{[F]:Q,...W}=l;v(W),await f(W)}catch(Q){U(Q instanceof Error?Q.message:"Failed to delete category")}}async function C(F,Q){const W=l[F];if(!W)return;const P=W.category_group_id||"ungrouped",X=Object.entries(l).filter(([,Ee])=>(Ee.category_group_id||"ungrouped")===P).sort((Ee,Te)=>Ee[1].sort_order-Te[1].sort_order),he=X.findIndex(([Ee])=>Ee===F),re=Q==="up"?he-1:he+1;if(re<0||re>=X.length)return;const[ae,ve]=X[re],Ae={};if(Object.entries(l).forEach(([Ee,Te])=>{Ee===F?Ae[Ee]={...Te,sort_order:ve.sort_order}:Ee===ae?Ae[Ee]={...Te,sort_order:W.sort_order}:Ae[Ee]=Te}),v(Ae),!!a)try{await f(Ae)}catch(Ee){v(l),U(Ee instanceof Error?Ee.message:"Failed to move category")}}async function L(F){if(a)try{const Q=u.length>0?Math.max(...u.map(X=>X.sort_order)):-1,W={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:F.name,sort_order:Q+1},P=[...u,W];E(P),await g(P)}catch(Q){U(Q instanceof Error?Q.message:"Failed to create group")}}async function k(F,Q){if(a)try{const W=u.map(P=>P.id===F?{...P,name:Q.name}:P);E(W),await g(W)}catch(W){U(W instanceof Error?W.message:"Failed to update group")}}async function ee(F){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&a)try{const Q={};Object.entries(l).forEach(([P,X])=>{Q[P]=X.category_group_id===F?{...X,category_group_id:null}:X});const W=u.filter(P=>P.id!==F);v(Q),E(W),await _(Q,W)}catch(Q){U(Q instanceof Error?Q.message:"Failed to delete group")}}async function H(F,Q){const W=[...u].sort((ae,ve)=>ae.sort_order-ve.sort_order),P=W.findIndex(ae=>ae.id===F),X=Q==="up"?P-1:P+1;if(X<0||X>=W.length)return;const[he]=W.splice(P,1);W.splice(X,0,he);const re=W.map((ae,ve)=>({...ae,sort_order:ve}));if(E(re),!!a)try{await g(re)}catch(ae){E(u),U(ae instanceof Error?ae.message:"Failed to move group")}}const B=Object.entries(l).reduce((F,[Q,W])=>{const P=W.category_group_id||"ungrouped";return F[P]||(F[P]=[]),F[P].push([Q,W]),F},{}),q=[...u].sort((F,Q)=>F.sort_order-Q.sort_order);return{currentBudget:a,categories:l,categoryGroups:u,categoriesByGroup:B,sortedGroups:q,categoryBalances:G,loadingBalances:z,error:N,setError:U,getOnBudgetTotal:I,categoryBalanceMismatch:$,checkCategoryBalanceMismatch:J,recalculateAndSaveCategoryBalances:te,handleCreateCategory:A,handleUpdateCategory:R,handleDeleteCategory:D,handleMoveCategory:C,handleCreateGroup:L,handleUpdateGroup:k,handleDeleteGroup:ee,handleMoveGroup:H,dragType:j.dragType,draggedId:j.draggedId,dragOverId:j.dragOverId,dragOverGroupId:j.dragOverGroupId,setDragOverId:j.setDragOverId,setDragOverGroupId:j.setDragOverGroupId,handleCategoryDragStart:j.handleCategoryDragStart,handleCategoryDragOver:j.handleCategoryDragOver,handleDragOverGroup:j.handleDragOverGroup,handleDragLeave:j.handleDragLeave,handleDragLeaveGroup:j.handleDragLeaveGroup,handleDragEnd:j.handleDragEnd,handleCategoryDrop:j.handleCategoryDrop,handleDropOnGroup:j.handleDropOnGroup,handleGroupDragStart:j.handleGroupDragStart,handleGroupDrop:j.handleGroupDrop}}const _e={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15"},xN={maxWidth:"60rem",margin:"0 auto",padding:"2rem"},oh={marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},cu={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},wN={...cu,padding:"0.6rem 0.875rem",gap:"0.5rem"},TN={background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1rem 1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},AN={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},CN={display:"flex",flexDirection:"column",gap:"0.5rem"},RN={fontSize:"0.9rem",fontWeight:500},uu={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit"},DN={...uu,cursor:"pointer"},Ay={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},ST={...Ay,background:_e.primary,color:"white",border:"none"},IN={...ST,padding:"0.75rem 1.5rem",borderRadius:"8px"},ON={...Ay,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},jN={...Ay,background:"transparent",border:`1px solid ${_e.errorBorder}`,color:_e.error},MN={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},kN={display:"flex",gap:"0.5rem"},NN={display:"flex",gap:"0.25rem"},xT={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},PN={...xT,borderColor:_e.errorBorder,color:_e.error},Xo={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},Cy={display:"flex",flexDirection:"column",gap:"2px"},VN={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},wT={opacity:.4,cursor:"grab"},TT={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",transition:"opacity 0.15s"},LN={position:"relative",height:"2rem",marginTop:"-0.25rem"},UN={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",transition:"opacity 0.15s"},BN={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},zN={background:_e.errorBg,border:`1px solid ${_e.errorBorder}`,color:_e.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},FN={background:"transparent",border:"none",color:_e.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},df={opacity:.7,marginBottom:"1.5rem"},fl={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},Ry={fontWeight:500,fontSize:"1.1rem"},Fs={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function lh({children:t}){return m.jsx("div",{style:xN,children:t})}function ml({message:t,children:e,onDismiss:n,style:i}){return m.jsxs("div",{style:{...zN,...i},children:[m.jsx("span",{children:e??t}),n&&m.jsx("button",{onClick:n,style:FN,children:""})]})}const qN={primary:ST,"primary-large":IN,secondary:ON,danger:jN,small:MN};function ke({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:i,disabled:a,style:l,...u}){const d=qN[t],f=a||e;return m.jsx("button",{disabled:f,style:{...d,cursor:f?"not-allowed":"pointer",opacity:f?.7:1,...l},...u,children:e?n:i})}function Ua({children:t,onSubmit:e}){return m.jsx("form",{onSubmit:e,style:AN,children:t})}function Gt({label:t,htmlFor:e,children:n,hint:i}){return m.jsxs("div",{style:CN,children:[m.jsx("label",{htmlFor:e,style:RN,children:t}),n,i&&m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:i})]})}function zi(t){return m.jsx("input",{style:uu,...t})}function Ma({children:t,...e}){return m.jsx("select",{style:DN,...e,children:t})}function Dy({minHeight:t="6rem",style:e,...n}){return m.jsx("textarea",{style:{...uu,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function Ks({children:t}){return m.jsx("div",{style:VN,children:t})}function Mp(t){const n=t.replace(/[^\d.]/g,"").split("."),i=n[0]||"",a=n[1],l=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return a!==void 0?`$${l}.${a.slice(0,2)}`:l?`$${l}`:""}function GN(t){return t.replace(/[$,]/g,"")}function Iy({id:t,value:e,onChange:n,placeholder:i="$0.00",required:a,autoFocus:l}){const[u,d]=O.useState(()=>Mp(e)),f=O.useRef(null);O.useEffect(()=>{const _=Mp(e);GN(u)!==e&&d(_)},[e]);function g(_){const v=_.target.value;if(!v||v==="$"){d(""),n("");return}const T=v.replace(/[^\d.]/g,"").split(".");let w=T[0];T.length>1&&(w+="."+T.slice(1).join("").slice(0,2));const I=Mp(w);d(I),n(w)}return m.jsx("input",{ref:f,id:t,type:"text",inputMode:"decimal",value:u,onChange:g,placeholder:i,required:a,autoFocus:l,style:uu})}function HN(t,e){const n=t.toLowerCase(),i=e.toLowerCase();if(i.includes(n)){const d=i.indexOf(n);return{match:!0,score:d===0||/\s/.test(i[d-1])?100:90}}let a=0,l=0,u=0;for(let d=0;d<i.length&&a<n.length;d++)i[d]===n[a]?(a++,u++,l+=u*2):u=0;return a===n.length?{match:!0,score:l}:{match:!1,score:0}}function AT({id:t,value:e,onChange:n,payees:i,placeholder:a="Enter payee name"}){const[l,u]=O.useState(!1),[d,f]=O.useState(-1),g=O.useRef(null),_=O.useRef(null),v=e.trim()?i.map(w=>({payee:w,...HN(e,w)})).filter(w=>w.match).sort((w,I)=>I.score-w.score).slice(0,8).map(w=>w.payee):[];O.useEffect(()=>{function w(I){g.current&&!g.current.contains(I.target)&&u(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);function E(w){!l||v.length===0||(w.key==="ArrowDown"?(w.preventDefault(),f(I=>Math.min(I+1,v.length-1))):w.key==="ArrowUp"?(w.preventDefault(),f(I=>Math.max(I-1,-1))):w.key==="Enter"&&d>=0?(w.preventDefault(),n(v[d]),u(!1),f(-1)):w.key==="Escape"&&(u(!1),f(-1)))}function T(w){n(w),u(!1),f(-1),_.current?.focus()}return m.jsxs("div",{ref:g,style:{position:"relative"},children:[m.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:w=>{n(w.target.value),u(!0),f(-1)},onFocus:()=>u(!0),onKeyDown:E,placeholder:a,autoComplete:"off",style:uu}),l&&v.length>0&&m.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:v.map((w,I)=>m.jsx("div",{onClick:()=>T(w),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:I===d?`color-mix(in srgb, ${_e.primary} 20%, transparent)`:"transparent",borderBottom:I<v.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>f(I),children:w},w))})]})}function hf({children:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:u,onDrop:d,onEdit:f,onDelete:g,onMoveUp:_,onMoveDown:v,canMoveUp:E=!0,canMoveDown:T=!0}){const w=Qs(),I=_||v;return m.jsxs("div",{onDragOver:N=>{N.stopPropagation(),a(N)},onDragLeave:N=>{N.stopPropagation(),l()},onDrop:N=>{N.stopPropagation(),d(N)},style:{position:"relative"},children:[m.jsx("div",{style:{...TT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),m.jsxs("div",{style:{...w?wN:cu,opacity:e?.5:1},children:[m.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:w?"0.5rem":"0.75rem",minWidth:0},children:[m.jsx("span",{draggable:!0,onDragStart:i,onDragEnd:u,style:{...wT,fontSize:w?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),m.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),m.jsxs("div",{style:w?NN:kN,children:[w?m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:f,style:xT,title:"Edit","aria-label":"Edit",children:""}),m.jsx("button",{onClick:g,style:PN,title:"Delete","aria-label":"Delete",children:""})]}):m.jsxs(m.Fragment,{children:[m.jsx(ke,{variant:"secondary",onClick:f,children:"Edit"}),m.jsx(ke,{variant:"danger",onClick:g,children:"Delete"})]}),I&&m.jsxs("div",{style:Cy,children:[m.jsx("button",{onClick:N=>{N.stopPropagation(),_?.()},disabled:!E,style:{...Xo,opacity:E?.6:.2,cursor:E?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),m.jsx("button",{onClick:N=>{N.stopPropagation(),v?.()},disabled:!T,style:{...Xo,opacity:T?.6:.2,cursor:T?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function Oy({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i,label:a="Move to end"}){return m.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:LN,children:[m.jsx("div",{style:{...UN,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&m.jsx("span",{style:BN,children:a})]})}function Gn({children:t,style:e}){return m.jsx("div",{style:{...TN,...e},children:t})}function Fe(t){return`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function fn(t){return t>=0?_e.success:_e.danger}function kh({isOpen:t,onClose:e,title:n,children:i,maxWidth:a="28rem"}){return t?m.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:e,children:m.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:"100%",maxWidth:a,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:l=>l.stopPropagation(),children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[m.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),m.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),i]})}):null}const QN={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function KN(){const[t,e]=O.useState(!1),[n,i]=O.useState(""),[a,l]=O.useState("bug"),[u,d]=O.useState(!1),[f,g]=O.useState(null),_=O.useContext(Wc),E=La().get_current_firebase_user(),T=hr(),w=Bw();if(T.pathname.includes("/admin/feedback")||!_.is_logged_in)return null;async function N(U){if(U.preventDefault(),!(!n.trim()||!_.username||!E)){g(null);try{await w.submitFeedback.mutateAsync({userId:E.uid,userEmail:_.username,text:n.trim(),feedbackType:a,currentPath:T.pathname}),i(""),l("bug"),d(!0),setTimeout(()=>{d(!1),e(!1)},1500)}catch(G){g(G instanceof Error?G.message:"Failed to submit feedback")}}}return m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:()=>e(!0),style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:_e.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:U=>{U.currentTarget.style.transform="scale(1.1)",U.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:U=>{U.currentTarget.style.transform="scale(1)",U.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),m.jsx(kh,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:u?m.jsxs("div",{style:{textAlign:"center",padding:"2rem 0",color:_e.success},children:[m.jsx("span",{style:{fontSize:"2rem",display:"block",marginBottom:"0.5rem"},children:""}),"Feedback submitted!"]}):m.jsxs("form",{onSubmit:N,children:[m.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(U=>{const G=QN[U],z=a===U;return m.jsxs("button",{type:"button",onClick:()=>l(U),style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${G.color}`,borderRadius:"0.5rem",background:z?G.bgColor:"transparent",color:z?G.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:z?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:z?1:.5,boxShadow:z?`0 0 12px ${G.bgColor}`:"none",position:"relative"},children:[G.label,z&&m.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},U)})}),m.jsx(Dy,{value:n,onChange:U=>i(U.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),f&&m.jsx("p",{style:{color:_e.error,fontSize:"0.85rem",margin:"0.5rem 0"},children:f}),m.jsxs(Ks,{children:[m.jsx(ke,{type:"button",variant:"secondary",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),m.jsx(ke,{type:"submit",isLoading:w.submitFeedback.isPending,disabled:!n.trim(),children:"Submit"})]})]})})]})}function Ro({children:t,labelStyle:e,...n}){return m.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[m.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:_e.primary},...n}),t]})}function $N({title:t,count:e,children:n,defaultExpanded:i=!1}){const[a,l]=O.useState(i);return m.jsxs("div",{style:{marginTop:"2rem"},children:[m.jsxs("button",{onClick:()=>l(!a),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[m.jsx("span",{style:{transition:"transform 0.2s",transform:a?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),a&&n]})}function CT(t){const{tabs:e,activeTab:n,accentColor:i=_e.primary}=t,a=e.filter(f=>!f.hidden),l=f=>({flex:1,padding:"0.75rem 1rem",borderRadius:"8px",border:f?`2px solid ${i}`:"2px solid transparent",background:f?`color-mix(in srgb, ${i} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",cursor:"pointer",fontWeight:f?600:400,fontSize:"0.95rem",color:"inherit",transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem"}),u=f=>f?m.jsx("span",{style:{marginLeft:"0.5rem",fontSize:"0.7rem",background:f.color||_e.success,color:"white",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:f.text}):null,d=f=>m.jsxs(m.Fragment,{children:[f.icon&&m.jsx("span",{children:f.icon}),m.jsx("span",{children:f.label}),u(f.badge)]});return m.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:a.map(f=>{const g=n===f.id;return t.mode==="link"?m.jsx(Tt,{to:`${t.linkPrefix}/${f.id}`,style:l(g),children:d(f)},f.id):m.jsx("button",{onClick:()=>t.onTabChange(f.id),style:l(g),children:d(f)},f.id)})})}function _g(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function YN({onCreateNew:t}){const[e,n]=O.useState(""),[i,a]=O.useState(!1),[l,u]=O.useState(null);async function d(f){f.preventDefault(),a(!0),u(null);try{await t(e.trim()||void 0)}catch(g){u(g instanceof Error?g.message:"Failed to create budget"),a(!1)}}return m.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[m.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),m.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&m.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsx("span",{children:l}),m.jsx("button",{onClick:()=>u(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),m.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[m.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[m.jsx("span",{children:""})," Create Your Budget"]}),m.jsxs("form",{onSubmit:d,children:[m.jsxs("div",{style:{marginBottom:"1.5rem"},children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),m.jsx("input",{type:"text",value:e,onChange:f=>n(f.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),m.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),m.jsx("button",{type:"submit",disabled:i,style:{width:"100%",background:_e.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontWeight:600,opacity:i?.7:1,fontSize:"1rem"},children:i?"Creating...":"Create Budget"})]})]}),m.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function WN({invites:t,onAccept:e,onCreateNew:n}){const[i,a]=O.useState(null),[l,u]=O.useState(!1),[d,f]=O.useState(""),[g,_]=O.useState(!1),[v,E]=O.useState(null);async function T(I){a(I),E(null);try{await e(I)}catch(N){E(N instanceof Error?N.message:"Failed to accept invitation"),a(null)}}async function w(I){I.preventDefault(),_(!0),E(null);try{await n(d.trim()||void 0)}catch(N){E(N instanceof Error?N.message:"Failed to create new budget"),_(!1)}}return m.jsxs("div",{children:[m.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),m.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),v&&m.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsx("span",{children:v}),m.jsx("button",{onClick:()=>E(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),m.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[m.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[m.jsx("span",{children:""})," Budget Invitations"]}),m.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(I=>m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[m.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[m.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:I.budgetName}),I.ownerEmail&&m.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",I.ownerEmail]})]}),m.jsx("button",{onClick:()=>T(I.budgetId),disabled:i!==null||g,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null||g?"not-allowed":"pointer",fontWeight:500,opacity:i!==null||g?.7:1,fontSize:"0.9rem"},children:i===I.budgetId?"Joining...":"Accept & Join"})]},I.budgetId))})]}),m.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?m.jsxs("form",{onSubmit:w,children:[m.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),m.jsxs("div",{style:{marginBottom:"1rem"},children:[m.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),m.jsx("input",{type:"text",value:d,onChange:I=>f(I.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),m.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[m.jsx("button",{type:"submit",disabled:g||i!==null,style:{background:_e.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||i!==null?"not-allowed":"pointer",fontWeight:500,opacity:g||i!==null?.7:1,fontSize:"0.9rem"},children:g?"Creating...":"Create Budget"}),m.jsx("button",{type:"button",onClick:()=>{u(!1),f("")},disabled:g,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g?"not-allowed":"pointer",fontWeight:500,opacity:g?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):m.jsxs("div",{style:{textAlign:"center"},children:[m.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),m.jsx("button",{onClick:()=>u(!0),disabled:i!==null,style:{background:_e.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null?"not-allowed":"pointer",fontWeight:500,opacity:i!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function XN({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const i=O.useMemo(()=>[{id:"income",label:"Income",icon:""},{id:"allocations",label:"Allocations",icon:"",badge:n?{text:"Applied",color:_e.success}:void 0},{id:"spend",label:"Spend",icon:""},{id:"balances",label:"Balances",icon:""}],[n]);return m.jsx(CT,{mode:"button",tabs:i,activeTab:t,onTabChange:a=>e(a)})}function JN({isLoading:t,onPreviousMonth:e,onNextMonth:n,onRecalculateAll:i,isRecomputing:a}){const{currentYear:l,currentMonthNumber:u,isAdmin:d,selectedBudgetId:f,currentUserId:g}=wn(),{budget:_}=Kn(f,g),{month:v}=hl(f,l,u),[E,T]=O.useState(!1),w=O.useRef(null);O.useEffect(()=>{if(!E)return;function N(U){w.current&&!w.current.contains(U.target)&&T(!1)}return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[E]);function I(){if(!v||!_)return;const N={...v,_meta:{downloaded_at:new Date().toISOString(),budget_id:_.id,budget_name:_.name}},U=new Blob([JSON.stringify(N,null,2)],{type:"application/json"}),G=URL.createObjectURL(U),z=document.createElement("a");z.href=G,z.download=`month_${l}_${String(u).padStart(2,"0")}.json`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(G),T(!1)}return m.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[m.jsx("button",{onClick:e,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Previous month",children:""}),m.jsxs("div",{ref:w,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[m.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[m.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[ET[u-1]," ",l]}),m.jsx("button",{onClick:()=>T(!E),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:E?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),t&&m.jsxs(m.Fragment,{children:[m.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),m.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[m.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:_e.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),m.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),E&&m.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[m.jsxs("button",{onClick:()=>{i(),T(!1)},disabled:a||t,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:a||t?"not-allowed":"pointer",fontSize:"0.85rem",color:"inherit",opacity:a||t?.5:1,textAlign:"left",transition:"background 0.15s"},title:"Recalculate all totals and category balances for this month",children:[a?"":""," Recalculate All"]}),d&&v&&m.jsx("button",{onClick:I,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),m.jsx("button",{onClick:n,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Next month",children:""})]})}function sS({accounts:t,accountGroups:e,payees:n,initialData:i,defaultAccountId:a,defaultDate:l,onSubmit:u,onCancel:d,onDelete:f,submitLabel:g,isMobile:_}){const v=new Date().toISOString().split("T")[0],[E,T]=O.useState(i?.amount?.toString()||""),[w,I]=O.useState(i?.account_id||a||(t[0]?t[0][0]:"")),[N,U]=O.useState(i?.date||l||v),[G,z]=O.useState(i?.payee||""),[$,J]=O.useState(i?.description||""),te={},j=[];t.forEach(([D,C])=>{C.account_group_id?(te[C.account_group_id]||(te[C.account_group_id]=[]),te[C.account_group_id].push([D,C])):j.push([D,C])});function A(D){D.preventDefault();const C=parseFloat(E);isNaN(C)||C<=0||w&&N&&u(C,w,N,G.trim()||void 0,$.trim()||void 0)}const R=_?{display:"flex",flexDirection:"column",gap:"1rem"}:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"};return m.jsxs(Ua,{onSubmit:A,children:[m.jsxs("div",{style:R,children:[m.jsx(Gt,{label:"Amount",htmlFor:"income-amount",children:m.jsx(Iy,{id:"income-amount",value:E,onChange:T,placeholder:"$0.00",required:!0,autoFocus:!0})}),m.jsx(Gt,{label:"Date",htmlFor:"income-date",children:m.jsx(zi,{id:"income-date",type:"date",value:N,onChange:D=>U(D.target.value),required:!0})})]}),m.jsxs("div",{style:R,children:[m.jsx(Gt,{label:"Deposit To",htmlFor:"income-account",children:m.jsxs(Ma,{id:"income-account",value:w,onChange:D=>I(D.target.value),required:!0,children:[Object.entries(e).map(([D,C])=>{const L=te[D];return!L||L.length===0?null:m.jsx("optgroup",{label:C.name,children:L.map(([k,ee])=>m.jsx("option",{value:k,children:ee.nickname},k))},D)}),j.length>0&&m.jsx("optgroup",{label:"Other",children:j.map(([D,C])=>m.jsx("option",{value:D,children:C.nickname},D))})]})}),m.jsx(Gt,{label:"Payee",htmlFor:"income-payee",children:m.jsx(AT,{id:"income-payee",value:G,onChange:z,payees:n,placeholder:"e.g., Employer, Client name"})})]}),m.jsx(Gt,{label:"Description (optional)",htmlFor:"income-description",children:m.jsx(zi,{id:"income-description",value:$,onChange:D=>J(D.target.value),placeholder:"e.g., January paycheck, Project bonus"})}),m.jsxs(Ks,{children:[m.jsx(ke,{type:"submit",children:g}),m.jsx(ke,{type:"button",variant:"secondary",onClick:d,children:"Cancel"}),f&&m.jsx(ke,{type:"button",variant:"danger",onClick:f,style:{marginLeft:"auto"},children:" Delete"})]})]})}function ZN({income:t,accountName:e,accountGroupName:n,onEdit:i,onDelete:a,isMobile:l}){return m.jsxs("div",{onClick:l?i:void 0,style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:l?"0.875rem 1rem":"1rem 1.25rem",borderRadius:"8px",display:"flex",flexDirection:l?"column":"row",justifyContent:"space-between",alignItems:l?"stretch":"center",gap:l?"0.5rem":"1rem",cursor:l?"pointer":"default",transition:l?"background 0.15s":"none"},children:[m.jsxs("div",{style:{flex:1},children:[m.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"0.75rem",marginBottom:t.payee?"0.25rem":0},children:[t.date&&m.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,fontFamily:"monospace"},children:new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}),m.jsxs("span",{style:{fontSize:"1.15rem",fontWeight:600,color:_e.success},children:["+",Fe(t.amount)]})]}),t.payee&&m.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,marginBottom:"0.25rem"},children:t.payee}),m.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:[" ",e,n?` / ${n}`:""]}),t.description&&m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",opacity:.7},children:t.description})]}),!l&&m.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[m.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit",children:""}),m.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete",children:""})]})]})}function e4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=wn(),{accounts:a,accountGroups:l}=Kn(t,e),{month:u,isLoading:d,payees:f,addIncome:g,updateIncome:_,deleteIncome:v}=hl(t,n,i),E=Qs(),[T,w]=O.useState(null),[I,N]=O.useState(!1),[U,G]=O.useState(null);function z(ee){const H=ee.account_group_id?l[ee.account_group_id]:void 0;return H?.is_active!==void 0?H.is_active:ee.is_active!==!1}function $(ee){const H=ee.account_group_id?l[ee.account_group_id]:void 0;return H?.on_budget!==void 0?H.on_budget:ee.on_budget!==!1}const J=Object.entries(a).filter(([,ee])=>z(ee)&&$(ee)),te=J.filter(([,ee])=>ee.is_income_account),j=te.length>0?te:J,A=J.find(([,ee])=>ee.is_income_default),R=A?A[0]:void 0,D=u?.income.reduce((ee,H)=>ee+H.amount,0)||0;function C(ee,H,B,q,F){w(null),N(!1),g(ee,H,B,q,F).catch(Q=>{w(Q instanceof Error?Q.message:"Failed to add income")})}function L(ee,H,B,q,F,Q){w(null),G(null),_(ee,H,B,q,F,Q).catch(W=>{w(W instanceof Error?W.message:"Failed to update income")})}function k(ee){confirm("Are you sure you want to delete this income entry?")&&(w(null),v(ee).catch(H=>{w(H instanceof Error?H.message:"Failed to delete income")}))}return m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:d?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:d?"none":"auto"},children:[T&&m.jsx("div",{style:{background:`color-mix(in srgb, ${_e.error} 15%, transparent)`,border:`1px solid ${_e.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:_e.error},children:T}),m.jsxs("div",{style:{display:"flex",flexDirection:E?"column":"row",justifyContent:"space-between",alignItems:E?"stretch":"center",gap:E?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[m.jsxs("div",{children:[m.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:"Total"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.25rem",fontWeight:600,color:fn(D)},children:Fe(D)})]}),!I&&m.jsx(ke,{onClick:()=>N(!0),disabled:j.length===0,children:"+ Add Income"})]}),j.length===0&&m.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",m.jsx(Tt,{to:"/budget/accounts",style:{color:_e.primaryLight},children:"Manage accounts "})]}),I&&m.jsx("div",{style:{marginBottom:"1rem"},children:m.jsx(sS,{accounts:j,accountGroups:l,payees:f,defaultAccountId:R,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:C,onCancel:()=>N(!1),submitLabel:"Add Income",isMobile:E})}),m.jsxs("div",{style:Fs,children:[u?.income.slice().sort((ee,H)=>(ee.date||"").localeCompare(H.date||"")).map(ee=>U===ee.id?m.jsx(sS,{accounts:j,accountGroups:l,payees:f,initialData:ee,onSubmit:(H,B,q,F,Q)=>L(ee.id,H,B,q,F,Q),onCancel:()=>G(null),onDelete:()=>k(ee.id),submitLabel:"Save",isMobile:E},ee.id):m.jsx(ZN,{income:ee,accountName:a[ee.account_id]?.nickname||"Unknown Account",accountGroupName:a[ee.account_id]?.account_group_id?l[a[ee.account_id].account_group_id]?.name:void 0,onEdit:()=>G(ee.id),onDelete:()=>k(ee.id),isMobile:E},ee.id)),(!u?.income||u.income.length===0)&&!I&&m.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1rem"},children:"No income recorded for this month"})]})]})}function aS({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:u,defaultDate:d,onSubmit:f,onCancel:g,onDelete:_,submitLabel:v,isMobile:E}){const T=new Date().toISOString().split("T")[0],[w,I]=O.useState(l?.amount?.toString()||""),[N,U]=O.useState(l?.category_id||""),[G,z]=O.useState(l?.account_id||u||(t[0]?t[0][0]:"")),[$,J]=O.useState(l?.date||d||T),[te,j]=O.useState(l?.payee||""),[A,R]=O.useState(l?.description||""),D={},C=[];t.forEach(([q,F])=>{F.account_group_id?(D[F.account_group_id]||(D[F.account_group_id]=[]),D[F.account_group_id].push([q,F])):C.push([q,F])});const L={},k=[];Object.entries(n).forEach(([q,F])=>{F.category_group_id?(L[F.category_group_id]||(L[F.category_group_id]=[]),L[F.category_group_id].push([q,F])):k.push([q,F])}),Object.values(L).forEach(q=>{q.sort((F,Q)=>F[1].sort_order-Q[1].sort_order)}),k.sort((q,F)=>q[1].sort_order-F[1].sort_order);const ee=[...i].sort((q,F)=>q.sort_order-F.sort_order);function H(q){q.preventDefault();const F=parseFloat(w);isNaN(F)||F<=0||N&&G&&$&&f(F,N,G,$,te.trim()||void 0,A.trim()||void 0)}const B=E?{display:"flex",flexDirection:"column",gap:"1rem"}:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"};return m.jsxs(Ua,{onSubmit:H,children:[m.jsxs("div",{style:B,children:[m.jsx(Gt,{label:"Amount",htmlFor:"expense-amount",children:m.jsx(Iy,{id:"expense-amount",value:w,onChange:I,placeholder:"$0.00",required:!0,autoFocus:!0})}),m.jsx(Gt,{label:"Date",htmlFor:"expense-date",children:m.jsx(zi,{id:"expense-date",type:"date",value:$,onChange:q=>J(q.target.value),required:!0})})]}),m.jsxs("div",{style:B,children:[m.jsx(Gt,{label:"Category",htmlFor:"expense-category",children:m.jsxs(Ma,{id:"expense-category",value:N,onChange:q=>U(q.target.value),required:!0,children:[m.jsx("option",{value:"",children:"Select category..."}),ee.map(q=>{const F=L[q.id];return!F||F.length===0?null:m.jsx("optgroup",{label:q.name,children:F.map(([Q,W])=>m.jsx("option",{value:Q,children:W.name},Q))},q.id)}),k.length>0&&m.jsx("optgroup",{label:"Other",children:k.map(([q,F])=>m.jsx("option",{value:q,children:F.name},q))})]})}),m.jsx(Gt,{label:"Pay From",htmlFor:"expense-account",children:m.jsxs(Ma,{id:"expense-account",value:G,onChange:q=>z(q.target.value),required:!0,children:[Object.entries(e).map(([q,F])=>{const Q=D[q];return!Q||Q.length===0?null:m.jsx("optgroup",{label:F.name,children:Q.map(([W,P])=>m.jsx("option",{value:W,children:P.nickname},W))},q)}),C.length>0&&m.jsx("optgroup",{label:"Other",children:C.map(([q,F])=>m.jsx("option",{value:q,children:F.nickname},q))})]})})]}),m.jsx(Gt,{label:"Payee",htmlFor:"expense-payee",children:m.jsx(AT,{id:"expense-payee",value:te,onChange:j,payees:a,placeholder:"e.g., Grocery Store, Restaurant"})}),m.jsx(Gt,{label:"Description (optional)",htmlFor:"expense-description",children:m.jsx(zi,{id:"expense-description",value:A,onChange:q=>R(q.target.value),placeholder:"e.g., Weekly groceries, Dinner with friends"})}),m.jsxs(Ks,{children:[m.jsx(ke,{type:"submit",children:v}),m.jsx(ke,{type:"button",variant:"secondary",onClick:g,children:"Cancel"}),_&&m.jsx(ke,{type:"button",variant:"danger",onClick:_,style:{marginLeft:"auto"},children:" Delete"})]})]})}function t4({expense:t,categoryName:e,accountName:n,accountGroupName:i,onEdit:a,onDelete:l,isMobile:u}){return m.jsxs("div",{onClick:u?a:void 0,style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:u?"0.875rem 1rem":"1rem 1.25rem",borderRadius:"8px",display:"flex",flexDirection:u?"column":"row",justifyContent:"space-between",alignItems:u?"stretch":"center",gap:u?"0.5rem":"1rem",cursor:u?"pointer":"default",transition:u?"background 0.15s":"none"},children:[m.jsxs("div",{style:{flex:1},children:[m.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"0.75rem",marginBottom:t.payee?"0.25rem":0},children:[t.date&&m.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,fontFamily:"monospace"},children:new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}),m.jsxs("span",{style:{fontSize:"1.15rem",fontWeight:600,color:_e.error},children:["-",Fe(t.amount)]})]}),t.payee&&m.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,marginBottom:"0.25rem"},children:t.payee}),m.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center"},children:[m.jsx("div",{style:{fontSize:"0.85rem",background:`color-mix(in srgb, ${_e.primary} 20%, transparent)`,color:_e.primaryLight,padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:e}),m.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:[" ",n,i?` / ${i}`:""]})]}),t.description&&m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",opacity:.7},children:t.description})]}),!u&&m.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[m.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit",children:""}),m.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete",children:""})]})]})}function n4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=wn(),{accounts:a,accountGroups:l,categories:u,categoryGroups:d}=Kn(t,e),{month:f,isLoading:g,payees:_,addExpense:v,updateExpense:E,deleteExpense:T}=hl(t,n,i),w=Qs(),[I,N]=O.useState(null),[U,G]=O.useState(!1),[z,$]=O.useState(null);function J(B){const q=B.account_group_id?l[B.account_group_id]:void 0;return q?.is_active!==void 0?q.is_active:B.is_active!==!1}function te(B){const q=B.account_group_id?l[B.account_group_id]:void 0;return q?.on_budget!==void 0?q.on_budget:B.on_budget!==!1}const j=Object.entries(a).filter(([,B])=>J(B)&&te(B)),A=j.filter(([,B])=>B.is_outgo_account),R=A.length>0?A:j,D=j.find(([,B])=>B.is_outgo_default),C=D?D[0]:void 0,L=f?.expenses?.reduce((B,q)=>B+q.amount,0)||0;function k(B,q,F,Q,W,P){N(null),G(!1),v(B,q,F,Q,W,P).catch(X=>{N(X instanceof Error?X.message:"Failed to add expense")})}function ee(B,q,F,Q,W,P,X){N(null),$(null),E(B,q,F,Q,W,P,X).catch(he=>{N(he instanceof Error?he.message:"Failed to update expense")})}function H(B){confirm("Are you sure you want to delete this expense?")&&(N(null),T(B).catch(q=>{N(q instanceof Error?q.message:"Failed to delete expense")}))}return m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:g?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:g?"none":"auto"},children:[I&&m.jsx("div",{style:{background:`color-mix(in srgb, ${_e.error} 15%, transparent)`,border:`1px solid ${_e.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:_e.error},children:I}),m.jsxs("div",{style:{display:"flex",flexDirection:w?"column":"row",justifyContent:"space-between",alignItems:w?"stretch":"center",gap:w?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[m.jsxs("div",{children:[m.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:"Total Expenses"}),m.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.25rem",fontWeight:600,color:L>0?_e.error:"inherit"},children:[L>0?"-":"",Fe(L)]})]}),!U&&m.jsx(ke,{onClick:()=>G(!0),disabled:R.length===0||Object.keys(u).length===0,children:"+ Add Expense"})]}),R.length===0&&m.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",m.jsx(Tt,{to:"/budget/accounts",style:{color:_e.primaryLight},children:"Manage accounts "})]}),Object.keys(u).length===0&&m.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:["You need to create at least one category before adding expenses."," ",m.jsx(Tt,{to:"/budget/admin/categories",style:{color:_e.primaryLight},children:"Create categories "})]}),U&&m.jsx("div",{style:{marginBottom:"1rem"},children:m.jsx(aS,{accounts:R,accountGroups:l,categories:u,categoryGroups:d,payees:_,defaultAccountId:C,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:k,onCancel:()=>G(!1),submitLabel:"Add Expense",isMobile:w})}),m.jsxs("div",{style:Fs,children:[f?.expenses?.slice().sort((B,q)=>(B.date||"").localeCompare(q.date||"")).map(B=>z===B.id?m.jsx(aS,{accounts:R,accountGroups:l,categories:u,categoryGroups:d,payees:_,initialData:B,onSubmit:(q,F,Q,W,P,X)=>ee(B.id,q,F,Q,W,P,X),onCancel:()=>$(null),onDelete:()=>H(B.id),submitLabel:"Save",isMobile:w},B.id):m.jsx(t4,{expense:B,categoryName:u[B.category_id]?.name||"Unknown Category",accountName:a[B.account_id]?.nickname||"Unknown Account",accountGroupName:a[B.account_id]?.account_group_id?l[a[B.account_id].account_group_id]?.name:void 0,onEdit:()=>$(B.id),onDelete:()=>H(B.id),isMobile:w},B.id)),(!f?.expenses||f.expenses.length===0)&&!U&&m.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1rem"},children:"No expenses recorded for this month"})]})]})}function r4({category:t,value:e,onChange:n,previousMonthIncome:i,disabled:a}){const l=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,u=l?t.default_monthly_amount/100*i:0,d=l?u.toFixed(2):e;let f=null;return!l&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&(f=Fe(t.default_monthly_amount)),m.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",padding:"0.6rem 0.75rem",background:l?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",maxWidth:"100%",boxSizing:"border-box",opacity:l?.8:1},children:[m.jsxs("div",{style:{flex:"1 1 auto",minWidth:0,overflow:"hidden"},children:[m.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),l?m.jsxs("span",{style:{fontSize:"0.7rem",opacity:.6,display:"block",marginTop:"0.15rem",color:_e.primary},children:[t.default_monthly_amount,"% of prev month income"]}):f&&m.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5,display:"block",marginTop:"0.15rem"},children:["Suggested: ",f]})]}),m.jsx("div",{style:{flexShrink:0,width:"110px"},children:l?m.jsx("div",{style:{width:"100%",padding:"0.5rem 0.6rem",borderRadius:"6px",border:"1px dashed color-mix(in srgb, currentColor 15%, transparent)",background:"color-mix(in srgb, currentColor 3%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box",textAlign:"right",opacity:.9},title:"Auto-calculated from previous month's income",children:Fe(u)}):m.jsx("input",{type:"text",inputMode:"decimal",value:d?`$${d}`:"",onChange:g=>{const _=g.target.value.replace(/[^\d.]/g,"");n(_)},placeholder:"$0.00",disabled:a,style:{width:"100%",padding:"0.5rem 0.6rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box",opacity:a?.6:1,cursor:a?"not-allowed":"text"}})})]})}function i4(){const{selectedBudgetId:t,currentUserId:e}=wn(),{categories:n,categoryGroups:i}=Kn(t,e),{localAllocations:a,isSavingAllocations:l,isFinalizingAllocations:u,isEditingAppliedAllocations:d,error:f,monthLoading:g,onBudgetTotal:_,availableNow:v,currentDraftTotal:E,availableAfterApply:T,previousMonthIncome:w,allocationsFinalized:I,getAllocationAmount:N,handleAllocationChange:U,resetAllocationsToSaved:G,handleSaveAllocations:z,handleFinalizeAllocations:$,setIsEditingAppliedAllocations:J,setError:te}=vN(),j=Qs(),A=[...i].sort((C,L)=>C.sort_order-L.sort_order),R=O.useMemo(()=>{const C=Object.entries(n).reduce((L,[k,ee])=>{const H=ee.category_group_id||"ungrouped";return L[H]||(L[H]=[]),L[H].push([k,ee]),L},{});return Object.keys(C).forEach(L=>{C[L].sort((k,ee)=>k[1].sort_order-ee[1].sort_order)}),C},[n]),D=Object.values(n).some(C=>C.default_monthly_type==="percentage");return m.jsxs("div",{style:{opacity:g?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:g?"none":"auto"},children:[f&&m.jsx(ml,{message:f,onDismiss:()=>te(null)}),m.jsxs("div",{style:{display:"grid",gridTemplateColumns:j?"1fr 1fr":"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[m.jsxs(Gn,{children:[m.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"On-Budget Total"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:fn(_)},children:Fe(_)})]}),m.jsxs(Gn,{children:[m.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"Available Now"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:fn(v)},children:Fe(v)}),m.jsx("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.7rem",opacity:.5},children:"(applied allocations only)"})]}),m.jsxs(Gn,{children:[m.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"This Month's Draft"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:_e.primary},children:Fe(E)})]}),m.jsxs(Gn,{children:[m.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"After Apply"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:fn(T)},children:Fe(T)}),m.jsx("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.7rem",opacity:.5},children:"(if you apply draft)"})]})]}),D&&m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.6rem 1rem",marginBottom:"1rem",fontSize:"0.85rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[m.jsx("span",{style:{opacity:.6},children:""}),m.jsxs("span",{style:{opacity:.7},children:["Percentage allocations based on prev month income: ",m.jsx("strong",{style:{color:_e.primary},children:Fe(w)})]})]}),m.jsx(s4,{allocationsFinalized:I,isEditingAppliedAllocations:d,isSavingAllocations:l,isFinalizingAllocations:u,monthLoading:g,onCancel:G,onSave:z,onFinalize:$,onStartEdit:()=>J(!0)}),m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(n).length===0&&m.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",m.jsx(Tt,{to:"/budget/admin/categories",style:{color:_e.primaryLight},children:"Create categories "})]}),A.map(C=>{const L=R[C.id]||[];if(L.length===0)return null;const k=L.reduce((ee,[H,B])=>ee+N(H,B),0);return m.jsx(oS,{name:C.name,categories:L,groupTotal:k,localAllocations:a,previousMonthIncome:w,disabled:I&&!d,onAllocationChange:U},C.id)}),R.ungrouped?.length>0&&m.jsx(oS,{name:"Uncategorized",categories:R.ungrouped,groupTotal:R.ungrouped.reduce((C,[L,k])=>C+N(L,k),0),localAllocations:a,previousMonthIncome:w,disabled:I&&!d,onAllocationChange:U,isUngrouped:!0})]})]})}function s4({allocationsFinalized:t,isEditingAppliedAllocations:e,isSavingAllocations:n,isFinalizingAllocations:i,monthLoading:a,onCancel:l,onSave:u,onFinalize:d,onStartEdit:f}){const g=t?e?_e.primary:_e.success:_e.warning;return m.jsxs("div",{style:{background:`color-mix(in srgb, ${g} 12%, transparent)`,border:`1px solid ${g}`,borderRadius:"8px",padding:"0.75rem 1rem",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.75rem"},children:[m.jsxs("div",{children:[m.jsx("p",{style:{margin:0,fontWeight:600,color:g},children:t?e?" Editing Applied Allocations":" Allocations Applied":" Allocations Not Applied"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:t?e?"Make changes and save, or cancel to revert.":"Click Edit to make changes to allocations.":"Save and apply to update category balances."})]}),m.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t?e?m.jsxs(m.Fragment,{children:[m.jsx(ke,{onClick:l,disabled:n||a,variant:"secondary",children:"Cancel"}),m.jsx(ke,{onClick:u,disabled:n||a,children:n?" Saving...":" Save Changes"})]}):m.jsx(ke,{onClick:f,disabled:a,variant:"secondary",children:" Edit Allocations"}):m.jsxs(m.Fragment,{children:[m.jsx(ke,{onClick:u,disabled:n||a,variant:"secondary",children:n?" Saving...":" Save Draft"}),m.jsx(ke,{onClick:d,disabled:i||a,children:i?" Applying...":" Save & Apply"})]})})]})}function oS({name:t,categories:e,groupTotal:n,localAllocations:i,previousMonthIncome:a,disabled:l,onAllocationChange:u,isUngrouped:d}){return m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[m.jsxs("h3",{style:{...fl,margin:0,opacity:d?.7:1},children:[t,m.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),m.jsx("span",{style:{fontWeight:600,color:_e.primary},children:Fe(n)})]}),m.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:e.map(([f,g])=>m.jsx(r4,{category:g,value:i[f]||"",onChange:_=>u(f,_),previousMonthIncome:a,disabled:l},f))})]})}function a4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=wn(),{categories:a,categoryGroups:l}=Kn(t,e),{month:u,isLoading:d}=hl(t,n,i),f=Qs(),g=O.useMemo(()=>{if(u?.category_balances&&u.category_balances.length>0)return u.category_balances;const w=u?.previous_month_snapshot?.category_balances_end??{},I=[];return Object.entries(a).forEach(([N])=>{const U=w[N]??0;let G=0;if(u?.allocations_finalized&&u.allocations){const $=u.allocations.find(J=>J.category_id===N);$&&(G=$.amount)}let z=0;u?.expenses&&(z=u.expenses.filter($=>$.category_id===N).reduce(($,J)=>$+J.amount,0)),I.push({category_id:N,start_balance:U,allocated:G,spent:z,end_balance:U+G-z})}),I},[u,a]),_=w=>g.find(I=>I.category_id===w),v=O.useMemo(()=>g.reduce((w,I)=>({start:w.start+I.start_balance,allocated:w.allocated+I.allocated,spent:w.spent+I.spent,end:w.end+I.end_balance}),{start:0,allocated:0,spent:0,end:0}),[g]),E=[...l].sort((w,I)=>w.sort_order-I.sort_order),T=O.useMemo(()=>{const w=Object.entries(a).reduce((I,[N,U])=>{const G=U.category_group_id||"ungrouped";return I[G]||(I[G]=[]),I[G].push([N,U]),I},{});return Object.keys(w).forEach(I=>{w[I].sort((N,U)=>N[1].sort_order-U[1].sort_order)}),w},[a]);return m.jsxs("div",{style:{opacity:d?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:d?"none":"auto"},children:[m.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr 1fr":"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[m.jsxs(Gn,{children:[m.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"Start of Month"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:fn(v.start)},children:Fe(v.start)})]}),m.jsxs(Gn,{children:[m.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"Allocated"}),m.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:_e.success},children:["+",Fe(v.allocated)]})]}),m.jsxs(Gn,{children:[m.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"Spent"}),m.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:_e.error},children:["-",Fe(v.spent)]})]}),m.jsxs(Gn,{children:[m.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"End of Month"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:fn(v.end)},children:Fe(v.end)})]})]}),m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(a).length===0&&m.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",m.jsx(Tt,{to:"/budget/admin/categories",style:{color:_e.primaryLight},children:"Create categories "})]}),E.map(w=>{const I=T[w.id]||[];if(I.length===0)return null;const N=I.reduce((U,[G])=>{const z=_(G);return z?{start:U.start+z.start_balance,allocated:U.allocated+z.allocated,spent:U.spent+z.spent,end:U.end+z.end_balance}:U},{start:0,allocated:0,spent:0,end:0});return m.jsx(lS,{name:w.name,categories:I,groupEndBalance:N.end,getCategoryBalance:_,isMobile:f},w.id)}),T.ungrouped?.length>0&&(()=>{const w=T.ungrouped,I=w.reduce((N,[U])=>{const G=_(U);return G?{start:N.start+G.start_balance,allocated:N.allocated+G.allocated,spent:N.spent+G.spent,end:N.end+G.end_balance}:N},{start:0,allocated:0,spent:0,end:0});return m.jsx(lS,{name:"Uncategorized",categories:w,groupEndBalance:I.end,getCategoryBalance:_,isMobile:f,isUngrouped:!0},"ungrouped")})()]})]})}function lS({name:t,categories:e,groupEndBalance:n,getCategoryBalance:i,isMobile:a,isUngrouped:l}){return m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[m.jsxs("h3",{style:{...fl,margin:0,opacity:l?.7:1},children:[t,m.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),m.jsx("span",{style:{fontWeight:600,color:fn(n)},children:Fe(n)})]}),!a&&m.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[m.jsx("span",{children:"Category"}),m.jsx("span",{style:{textAlign:"right"},children:"Start"}),m.jsx("span",{style:{textAlign:"right"},children:"Allocated"}),m.jsx("span",{style:{textAlign:"right"},children:"Spent"}),m.jsx("span",{style:{textAlign:"right"},children:"End"})]}),m.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:e.map(([u,d])=>{const f=i(u);return f?a?m.jsx(o4,{category:d,balance:f},u):m.jsx(l4,{category:d,balance:f},u):null})})]})}function o4({category:t,balance:e}){return m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[m.jsx("span",{style:{fontWeight:500},children:t.name}),m.jsx("span",{style:{fontWeight:600,color:fn(e.end_balance)},children:Fe(e.end_balance)})]}),m.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.5rem",fontSize:"0.8rem"},children:[m.jsxs("div",{children:[m.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),m.jsx("span",{children:Fe(e.start_balance)})]}),m.jsxs("div",{children:[m.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),m.jsxs("span",{style:{color:e.allocated>0?_e.success:"inherit"},children:[e.allocated>0?"+":"",Fe(e.allocated)]})]}),m.jsxs("div",{children:[m.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),m.jsxs("span",{style:{color:e.spent>0?_e.error:"inherit"},children:[e.spent>0?"-":"",Fe(e.spent)]})]})]})]})}function l4({category:t,balance:e}){return m.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[m.jsx("span",{style:{fontWeight:500},children:t.name}),m.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:Fe(e.start_balance)}),m.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.allocated>0?_e.success:"inherit"},children:[e.allocated>0?"+":"",Fe(e.allocated)]}),m.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.spent>0?_e.error:"inherit"},children:[e.spent>0?"-":"",Fe(e.spent)]}),m.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:fn(e.end_balance)},children:Fe(e.end_balance)})]})}function c4({isOpen:t,onClose:e,results:n}){const{currentYear:i,currentMonthNumber:a}=wn(),l=n?.status==="done"||n?.status==="error";function u(){l&&e()}return m.jsx(kh,{isOpen:t,onClose:u,title:"Recalculate Monthly Data",children:m.jsxs("div",{style:{padding:"0.5rem 0"},children:[m.jsxs("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:["Recalculating all totals and balances for ",ET[a-1]," ",i]}),m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[m.jsx(Do,{status:n?.status==="pending"?"waiting":"complete",label:"Count income transactions",detail:n&&n.status!=="pending"?`Found ${n.incomeCount} transaction${n.incomeCount!==1?"s":""}`:void 0}),m.jsx(Do,{status:vc(n?.status,["income_counting"],"income_calculating"),label:"Calculate income total",detail:n?.newIncomeTotal!==void 0?Fe(n.newIncomeTotal):void 0}),m.jsx(Do,{status:vc(n?.status,["pending","income_counting","income_calculating"],"income_saving"),label:"Save income totals"}),m.jsx(Do,{status:vc(n?.status,["pending","income_counting","income_calculating","income_saving"],"expenses_counting"),label:"Count expense transactions",detail:n?.expenseCount!==void 0&&!["pending","income_counting","income_calculating","income_saving"].includes(n.status)?`Found ${n.expenseCount} expense${n.expenseCount!==1?"s":""} (${Fe(n.newExpenseTotal||0)})`:void 0}),m.jsx(Do,{status:vc(n?.status,["pending","income_counting","income_calculating","income_saving","expenses_counting"],"balances_calculating"),label:"Calculate category balances"}),m.jsx(Do,{status:n?.status==="error"?"error":vc(n?.status,["pending","income_counting","income_calculating","income_saving","expenses_counting","balances_calculating"],"balances_saving"),label:"Save category balances",detail:n?.status==="error"?n.error:void 0,isError:n?.status==="error"})]}),n?.status==="done"&&m.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${_e.success} 10%, transparent)`,border:`1px solid ${_e.success}`,borderRadius:"8px"},children:[m.jsx("p",{style:{margin:0,fontWeight:600,color:_e.success},children:" Recalculation complete!"}),m.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:["Income: ",Fe(n.newIncomeTotal||0),"  Expenses: ",Fe(n.newExpenseTotal||0),"  Category balances updated"]})]}),l&&m.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"flex-end"},children:m.jsx(ke,{onClick:e,children:"Done"})})]})})}function vc(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function Do({status:t,label:e,detail:n,isError:i}){const a=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[m.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:a}),m.jsxs("div",{style:{flex:1},children:[m.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:i?1:.6,color:i?_e.error:"inherit"},children:n})]})]})}const u4=["income","allocations","spend","balances"];function cS(t){const e=t.year?parseInt(t.year,10):null,n=t.month?parseInt(t.month,10):null,i=t.tab&&u4.includes(t.tab)?t.tab:null;return{year:e&&!isNaN(e)&&e>=2e3&&e<=2100?e:null,month:n&&!isNaN(n)&&n>=1&&n<=12?n:null,tab:i}}function uS(){const t=sC(),e=Lh(),{currentUserId:n,selectedBudgetId:i,currentYear:a,currentMonthNumber:l,setCurrentYear:u,setCurrentMonthNumber:d,goToPreviousMonth:f,goToNextMonth:g,hasPendingInvites:_,pendingInvites:v,needsFirstBudget:E}=wn(),{budget:T,isOwner:w,createBudget:I,acceptInvite:N}=Kn(i,n),{month:U,isLoading:G}=hl(i,a,l),[z,$]=O.useState(null),[J,te]=O.useState(!1),[j,A]=O.useState(!1),[R,D]=O.useState(null),[C,L]=O.useState(!1),[k,ee]=O.useState(()=>{const{tab:W}=cS(t);return W??"balances"});O.useEffect(()=>{if(C)return;const{year:W,month:P}=cS(t);W&&u(W),P&&d(P),L(!0)},[t,u,d,C]),O.useEffect(()=>{if(!C)return;const W=`/budget/${a}/${l}/${k}`,P=`/budget/${t.year}/${t.month}/${t.tab}`;W!==P&&e(W,{replace:!0})},[a,l,k,C,e,t]);async function H(W){try{await N(W)}catch(P){$(P instanceof Error?P.message:"Failed to accept invite")}}async function B(W){try{await I(W||"My Budget")}catch(P){$(P instanceof Error?P.message:"Failed to create budget")}}if(!T&&_)return m.jsxs(lh,{children:[m.jsx("nav",{style:oh,children:m.jsx(Tt,{to:"/",children:" Back to Home"})}),m.jsx(WN,{invites:v,onAccept:H,onCreateNew:B})]});if(!T&&E)return m.jsxs(lh,{children:[m.jsx("nav",{style:oh,children:m.jsx(Tt,{to:"/",children:" Back to Home"})}),m.jsx(YN,{onCreateNew:B})]});function q(){$(null),f()}function F(){$(null),g()}async function Q(){$(null),te(!0),A(!0),D({status:"pending"});try{await new Promise(ve=>setTimeout(ve,200));const W=U?.income.length||0,P=U?.total_income||0;D({status:"income_counting",incomeCount:W,oldIncomeTotal:P}),await new Promise(ve=>setTimeout(ve,200));const X=U?.income.reduce((ve,Ae)=>ve+Ae.amount,0)||0;D({status:"income_calculating",incomeCount:W,oldIncomeTotal:P,newIncomeTotal:X}),await new Promise(ve=>setTimeout(ve,150)),D({status:"income_saving",incomeCount:W,oldIncomeTotal:P,newIncomeTotal:X}),await new Promise(ve=>setTimeout(ve,200));const he=U?.expenses?.length||0,re=U?.total_expenses||0,ae=U?.expenses?.reduce((ve,Ae)=>ve+Ae.amount,0)||0;D({status:"expenses_counting",incomeCount:W,oldIncomeTotal:P,newIncomeTotal:X,expenseCount:he,oldExpenseTotal:re,newExpenseTotal:ae}),await new Promise(ve=>setTimeout(ve,200)),D({status:"balances_calculating",incomeCount:W,oldIncomeTotal:P,newIncomeTotal:X,expenseCount:he,oldExpenseTotal:re,newExpenseTotal:ae}),await new Promise(ve=>setTimeout(ve,150)),D({status:"balances_saving",incomeCount:W,oldIncomeTotal:P,newIncomeTotal:X,expenseCount:he,oldExpenseTotal:re,newExpenseTotal:ae}),D({status:"done",incomeCount:W,oldIncomeTotal:P,newIncomeTotal:X,expenseCount:he,oldExpenseTotal:re,newExpenseTotal:ae})}catch(W){D({status:"error",error:W instanceof Error?W.message:"Failed to recalculate"})}finally{te(!1)}}return m.jsxs(lh,{children:[m.jsxs("nav",{style:oh,children:[m.jsx(Tt,{to:"/",children:" Back to Home"}),m.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[m.jsx(Tt,{to:"/budget/analytics",style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 8%, transparent)",textDecoration:"none",fontSize:"1.25rem",transition:"background 0.15s"},title:"Analytics",children:""}),m.jsx(Tt,{to:"/budget/admin",style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 8%, transparent)",textDecoration:"none",fontSize:"1.25rem",transition:"background 0.15s"},title:w?"Admin Settings":"Budget Settings",children:""})]})]}),m.jsx(d4,{budgetName:T?.name,userCount:T?.user_ids.length,isOwner:w}),z&&m.jsx(ml,{message:z,onDismiss:()=>$(null)}),m.jsx(JN,{isLoading:G,onPreviousMonth:q,onNextMonth:F,onRecalculateAll:Q,isRecomputing:J}),m.jsx(XN,{activeTab:k,setActiveTab:ee,allocationsFinalized:U?.allocations_finalized}),k==="income"&&m.jsx(e4,{}),k==="allocations"&&m.jsx(i4,{}),k==="spend"&&m.jsx(n4,{}),k==="balances"&&m.jsx(a4,{}),m.jsx(c4,{isOpen:j,onClose:()=>{A(!1),D(null)},results:R})]})}function d4({budgetName:t,userCount:e,isOwner:n}){return m.jsxs(m.Fragment,{children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[m.jsx("h1",{style:{margin:0},children:"Budget"}),t&&m.jsx("span",{style:{background:`color-mix(in srgb, ${_e.primary} 15%, transparent)`,color:_e.primaryLight,padding:"0.25rem 0.75rem",borderRadius:"6px",fontSize:"0.85rem",fontWeight:500},children:t})]}),e!==void 0&&m.jsxs("p",{style:{opacity:.6,fontSize:"0.85rem",marginBottom:"1.5rem"},children:[e," user",e!==1?"s":""," ",n?" You are the owner":" Shared with you"]})]})}function h4(){return m.jsxs(lh,{children:[m.jsx("nav",{style:oh,children:m.jsx(Tt,{to:"/budget",children:" Back to Budget"})}),m.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[m.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),m.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),m.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),m.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),m.jsx(Tt,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:_e.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})]})}function Nh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,accountGroups:a,showGroupSelector:l=!1,showIncomeSettings:u=!1,hasExistingIncomeDefault:d=!1,hasExistingOutgoDefault:f=!1,currentGroupId:g}){const[_,v]=O.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),E=_.account_group_id||g,T=E?a.find(z=>z.id===E):null,w=T?.is_active!==void 0,I=T?.on_budget!==void 0;function N(z){z.preventDefault(),_.nickname.trim()&&e(_)}function U(z){v({..._,is_income_account:z,is_income_default:z?_.is_income_default:!1})}function G(z){v({..._,is_outgo_account:z,is_outgo_default:z?_.is_outgo_default:!1})}return m.jsxs(Ua,{onSubmit:N,children:[m.jsx(Gt,{label:"Account Nickname",htmlFor:"account-nickname",children:m.jsx(zi,{id:"account-nickname",type:"text",value:_.nickname,onChange:z=>v({..._,nickname:z.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&m.jsx(Gt,{label:"Account Type",htmlFor:"account-group",children:m.jsxs(Ma,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:z=>v({..._,account_group_id:z.target.value==="ungrouped"?null:z.target.value}),children:[m.jsx("option",{value:"ungrouped",children:"Ungrouped"}),a.map(z=>m.jsx("option",{value:z.id,children:z.name},z.id))]})}),u&&m.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[m.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[m.jsx(Ro,{id:"is-active",checked:w?T.is_active:_.is_active!==!1,onChange:z=>v({..._,is_active:z.target.checked}),disabled:w,children:m.jsx("span",{style:{opacity:w?.5:1},children:"Active account"})}),w&&m.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:_e.warning},children:['Set by account type "',T.name,'"']})]}),m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[m.jsx(Ro,{id:"on-budget",checked:I?T.on_budget:_.on_budget!==!1,onChange:z=>v({..._,on_budget:z.target.checked}),disabled:I,children:m.jsx("span",{style:{opacity:I?.5:1},children:"On budget (affects budget totals)"})}),I&&m.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:_e.warning},children:['Set by account type "',T.name,'"']})]})]}),m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[m.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),m.jsx(Ro,{id:"is-income-account",checked:_.is_income_account||!1,onChange:z=>U(z.target.checked),children:"Show in income deposit list"}),_.is_income_account&&m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[m.jsx(Ro,{id:"is-income-default",checked:_.is_income_default||!1,onChange:z=>v({..._,is_income_default:z.target.checked}),disabled:d&&!t?.is_income_default,children:"Default account for new income"}),d&&!t?.is_income_default&&m.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[m.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),m.jsx(Ro,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:z=>G(z.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[m.jsx(Ro,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:z=>v({..._,is_outgo_default:z.target.checked}),disabled:f&&!t?.is_outgo_default,children:"Default account for new expenses"}),f&&!t?.is_outgo_default&&m.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),m.jsxs(Ks,{children:[m.jsx(ke,{type:"submit",children:i}),m.jsx(ke,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function dS({label:t,value:e,onChange:n,trueLabel:i,falseLabel:a,undefinedLabel:l}){function u(){n(e===void 0?!0:e===!0?!1:void 0)}const d=e===!0?i:e===!1?a:l,f=e===!0?_e.success:e===!1?_e.warning:"inherit",g=e===!0?"":e===!1?"":"";return m.jsxs("button",{type:"button",onClick:u,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${f} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${f} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[m.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?f:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:g}),m.jsxs("span",{style:{flex:1},children:[m.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",m.jsx("span",{style:{fontWeight:500,color:f},children:d})]}),m.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function RT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=O.useState(t||{name:"",expected_balance:"positive"});function u(d){d.preventDefault(),a.name.trim()&&e(a)}return m.jsxs(Ua,{onSubmit:u,children:[m.jsx(Gt,{label:"Account Type Name",htmlFor:"group-name",children:m.jsx(zi,{id:"group-name",type:"text",value:a.name,onChange:d=>l({...a,name:d.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),m.jsx(Gt,{label:"Expected Balance",htmlFor:"expected-balance",children:m.jsxs(Ma,{id:"expected-balance",value:a.expected_balance,onChange:d=>l({...a,expected_balance:d.target.value}),children:[m.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),m.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),m.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),m.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[m.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",m.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),m.jsx(dS,{label:"Active status",value:a.is_active,onChange:d=>l({...a,is_active:d}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),m.jsx(dS,{label:"Budget status",value:a.on_budget,onChange:d=>l({...a,on_budget:d}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),m.jsxs(Ks,{children:[m.jsx(ke,{type:"submit",children:i}),m.jsx(ke,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function Io({icon:t,label:e,variant:n,title:i}){const l={success:{background:`color-mix(in srgb, ${_e.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${_e.success} 40%, transparent)`,color:_e.success,opacity:1},warning:{background:`color-mix(in srgb, ${_e.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${_e.warning} 35%, transparent)`,color:_e.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${_e.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${_e.success} 25%, transparent)`,color:_e.success,opacity:.7},expense:{background:`color-mix(in srgb, ${_e.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${_e.warning} 25%, transparent)`,color:_e.warning,opacity:.7}}[n];return m.jsxs("span",{title:i||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[m.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function DT({account:t,accountGroups:e}){const n=[],i=t.account_group_id?e.find(u=>u.id===t.account_group_id):null,a=i?.is_active!==void 0?i.is_active:t.is_active!==!1,l=i?.on_budget!==void 0?i.on_budget:t.on_budget!==!1;if(!a){const u=i?.is_active!==void 0;n.push(m.jsx(Io,{icon:"",label:u?"Inactive (type)":"Inactive",variant:"warning",title:u?`Set by "${i.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const u=i?.on_budget!==void 0;n.push(m.jsx(Io,{icon:"",label:u?"Off Budget (type)":"Off Budget",variant:"warning",title:u?`Set by "${i.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(m.jsx(Io,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(m.jsx(Io,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(m.jsx(Io,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(m.jsx(Io,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:m.jsx(m.Fragment,{children:n})}function f4({group:t}){const e=[];return t.is_active===!1?e.push(m.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${_e.warning} 20%, transparent)`,color:_e.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(m.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${_e.success} 20%, transparent)`,color:_e.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(m.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${_e.warning} 20%, transparent)`,color:_e.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(m.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${_e.success} 20%, transparent)`,color:_e.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:m.jsx(m.Fragment,{children:e})}function IT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return m.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[m.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&m.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function m4(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function p4(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function g4({group:t,groupIndex:e,totalGroups:n,accounts:i,allGroups:a,allAccounts:l,editingAccountId:u,editingGroupId:d,createForGroupId:f,setEditingAccountId:g,setEditingGroupId:_,setCreateForGroupId:v,dragType:E,draggedId:T,dragOverId:w,dragOverGroupId:I,setDragOverId:N,setDragOverGroupId:U,onAccountDragStart:G,onAccountDragOver:z,onAccountDrop:$,onGroupDragStart:J,onGroupDragOver:te,onGroupDrop:j,onDragLeave:A,onDragLeaveGroup:R,onDragEnd:D,onDropOnGroup:C,onCreateAccount:L,onUpdateAccount:k,onDeleteAccount:ee,onMoveAccount:H,onUpdateGroup:B,onDeleteGroup:q,onMoveGroup:F}){const Q=Qs(),W=[...i].sort((fe,ft)=>fe.sort_order-ft.sort_order),P=E==="group"&&T===t.id,X=E==="group"&&w===t.id,he=E==="account"&&I===t.id,ae=(T&&E==="account"?l[T]:null)&&Object.entries(l).find(([fe])=>fe===T)?.[1]&&Object.entries(l).find(([fe])=>fe===T)?.[1]?.account_group_id!==t.id,ve=E==="group"&&X&&T!==t.id,Ae=e>0,Ee=e<n-1,Te=W.reduce((fe,ft)=>fe+ft.balance,0);return m.jsxs("div",{children:[E==="group"&&!P&&m.jsxs("div",{onDragOver:fe=>{fe.preventDefault(),N(t.id)},onDragLeave:A,onDrop:fe=>j(fe,t.id),style:{position:"relative",height:ve?"2.5rem":"0.5rem",marginBottom:ve?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[m.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",opacity:ve?1:0,transition:"opacity 0.15s",boxShadow:ve?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),ve&&m.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),m.jsx("div",{draggable:d!==t.id,onDragStart:fe=>J(fe,t.id),onDragOver:fe=>te(fe,t.id),onDragLeave:R,onDragEnd:D,onDrop:fe=>C(fe,t.id),style:{background:P?"color-mix(in srgb, currentColor 3%, transparent)":he&&ae?`color-mix(in srgb, ${_e.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:P?.5:1,border:he&&ae?`2px dashed ${_e.primary}`:"2px solid transparent",cursor:d===t.id?"default":"grab",transition:"all 0.15s"},children:d===t.id?m.jsx(RT,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:fe=>B(t.id,fe),onCancel:()=>_(null),submitLabel:"Save"}):m.jsxs(m.Fragment,{children:[m.jsx(y4,{group:t,accountCount:W.length,groupTotal:Te,canMoveUp:Ae,canMoveDown:Ee,isMobile:Q,createForGroupId:f,onEdit:()=>_(t.id),onDelete:()=>q(t.id),onMoveUp:()=>F(t.id,"up"),onMoveDown:()=>F(t.id,"down"),onAddAccount:()=>v(t.id)}),Q&&m.jsx("div",{style:{marginBottom:"0.5rem"},children:m.jsx(ke,{variant:"small",onClick:()=>v(t.id),disabled:f!==null,children:"+ Account"})}),m.jsxs("div",{style:Fs,children:[W.map((fe,ft)=>u===fe.id?m.jsx(Nh,{initialData:{nickname:fe.nickname,account_group_id:fe.account_group_id,is_income_account:fe.is_income_account,is_income_default:fe.is_income_default,is_outgo_account:fe.is_outgo_account,is_outgo_default:fe.is_outgo_default,on_budget:fe.on_budget,is_active:fe.is_active},onSubmit:Be=>k(fe.id,Be),onCancel:()=>g(null),submitLabel:"Save",accountGroups:a,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:fe.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([Be,bn])=>bn.is_income_default&&Be!==fe.id),hasExistingOutgoDefault:Object.entries(l).some(([Be,bn])=>bn.is_outgo_default&&Be!==fe.id)},fe.id):m.jsx(hf,{isDragging:E==="account"&&T===fe.id,isDragOver:w===fe.id,onDragStart:Be=>{Be.stopPropagation(),G(Be,fe.id)},onDragOver:Be=>z(Be,fe.id,t.id),onDragLeave:A,onDragEnd:D,onDrop:Be=>$(Be,fe.id,t.id),onEdit:()=>g(fe.id),onDelete:()=>ee(fe.id),onMoveUp:()=>H(fe.id,"up"),onMoveDown:()=>H(fe.id,"down"),canMoveUp:ft>0,canMoveDown:ft<W.length-1,children:m.jsxs("div",{children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[m.jsx("span",{style:Ry,children:fe.nickname}),m.jsx(DT,{account:fe,accountGroups:a})]}),m.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:fn(fe.balance)},children:[Fe(fe.balance),m4(fe.balance,t.expected_balance)&&m.jsx("span",{title:p4(fe.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},fe.id)),W.length===0&&!f&&m.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),E==="account"&&W.length>0&&m.jsx(IT,{groupId:t.id,isActive:w===`__end__${t.id}`,onDragOver:fe=>{fe.preventDefault(),fe.stopPropagation(),N(`__end__${t.id}`),U(t.id)},onDragLeave:fe=>{fe.stopPropagation(),N(null)},onDrop:fe=>{fe.stopPropagation(),$(fe,"__group_end__",t.id)}}),f===t.id&&m.jsx(Nh,{initialData:{nickname:"",account_group_id:t.id},onSubmit:fe=>L(fe,t.id),onCancel:()=>v(null),submitLabel:"Create",accountGroups:a,showIncomeSettings:!0,currentGroupId:t.id})]}),f!==t.id&&m.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:m.jsx(ke,{variant:"small",onClick:()=>v(t.id),disabled:f!==null,children:"+ Add Account"})})]})})]})}function y4({group:t,accountCount:e,groupTotal:n,canMoveUp:i,canMoveDown:a,isMobile:l,createForGroupId:u,onEdit:d,onDelete:f,onMoveUp:g,onMoveDown:_,onAddAccount:v}){return m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[m.jsxs("h3",{style:{...fl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&m.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),m.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),m.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),m.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:fn(n),flexShrink:0},children:Fe(n)}),m.jsx(f4,{group:t})]}),m.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&m.jsx(ke,{variant:"small",onClick:v,disabled:u!==null,children:"+ Account"}),m.jsx("button",{onClick:d,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),m.jsx("button",{onClick:f,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),m.jsxs("div",{style:Cy,children:[m.jsx("button",{onClick:g,disabled:!i,style:{...Xo,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),m.jsx("button",{onClick:_,disabled:!a,style:{...Xo,opacity:a?.6:.2,cursor:a?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function _4({accounts:t,allGroups:e,allAccounts:n,hasGroups:i,editingAccountId:a,createForGroupId:l,setEditingAccountId:u,setCreateForGroupId:d,dragType:f,draggedId:g,dragOverId:_,dragOverGroupId:v,setDragOverId:E,setDragOverGroupId:T,onAccountDragStart:w,onAccountDragOver:I,onAccountDrop:N,onDragOverGroup:U,onDropOnGroup:G,onDragLeave:z,onDragLeaveGroup:$,onDragEnd:J,onCreateAccount:te,onUpdateAccount:j,onDeleteAccount:A,onMoveAccount:R}){const D=[...t].sort((H,B)=>H.sort_order-B.sort_order),C=f==="account"&&v==="ungrouped",k=(g&&f==="account"?n[g]:null)&&Object.entries(n).find(([H])=>H===g)?.[1]&&Object.entries(n).find(([H])=>H===g)?.[1]?.account_group_id!==null;if(D.length===0&&!l&&i&&f!=="account")return null;const ee=D.reduce((H,B)=>H+B.balance,0);return m.jsxs("div",{onDragOver:H=>U(H,"ungrouped"),onDragLeave:$,onDrop:H=>G(H,"ungrouped"),style:{background:C&&k?`color-mix(in srgb, ${_e.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:C&&k?`2px dashed ${_e.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[m.jsxs("h3",{style:{...fl,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",m.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",D.length,")"]}),D.length>0&&m.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:fn(ee)},children:Fe(ee)})]}),m.jsx(ke,{variant:"small",onClick:()=>d("ungrouped"),disabled:l!==null,children:"+ Account"})]}),m.jsxs("div",{style:Fs,children:[D.map((H,B)=>a===H.id?m.jsx(Nh,{initialData:{nickname:H.nickname,account_group_id:H.account_group_id,is_income_account:H.is_income_account,is_income_default:H.is_income_default,is_outgo_account:H.is_outgo_account,is_outgo_default:H.is_outgo_default,on_budget:H.on_budget,is_active:H.is_active},onSubmit:q=>j(H.id,q),onCancel:()=>u(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([q,F])=>F.is_income_default&&q!==H.id),hasExistingOutgoDefault:Object.entries(n).some(([q,F])=>F.is_outgo_default&&q!==H.id)},H.id):m.jsx(hf,{isDragging:f==="account"&&g===H.id,isDragOver:_===H.id,onDragStart:q=>w(q,H.id),onDragOver:q=>I(q,H.id,"ungrouped"),onDragLeave:z,onDragEnd:J,onDrop:q=>N(q,H.id,"ungrouped"),onEdit:()=>u(H.id),onDelete:()=>A(H.id),onMoveUp:()=>R(H.id,"up"),onMoveDown:()=>R(H.id,"down"),canMoveUp:B>0,canMoveDown:B<D.length-1,children:m.jsxs("div",{children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[m.jsx("span",{style:Ry,children:H.nickname}),m.jsx(DT,{account:H,accountGroups:e})]}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:fn(H.balance)},children:Fe(H.balance)})]})},H.id)),D.length===0&&f==="account"&&m.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),f==="account"&&D.length>0&&m.jsx(IT,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:H=>{H.preventDefault(),H.stopPropagation(),E("__end__ungrouped"),T("ungrouped")},onDragLeave:H=>{H.stopPropagation(),E(null)},onDrop:H=>{H.stopPropagation(),N(H,"__group_end__","ungrouped")}}),l==="ungrouped"&&m.jsx(Nh,{initialData:{nickname:"",account_group_id:null},onSubmit:H=>te(H,"ungrouped"),onCancel:()=>d(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&m.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:m.jsx(ke,{variant:"small",onClick:()=>d("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function v4(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:i,error:a,setError:l,handleCreateAccount:u,handleUpdateAccount:d,handleDeleteAccount:f,handleMoveAccount:g,handleCreateGroup:_,handleUpdateGroup:v,handleDeleteGroup:E,handleMoveGroup:T,reorderAccountsInGroup:w,reorderGroups:I}=_N(),N=Qs(),[U,G]=O.useState(null),[z,$]=O.useState(null),[J,te]=O.useState(null),[j,A]=O.useState(!1),[R,D]=O.useState(null),[C,L]=O.useState(null),[k,ee]=O.useState(null),[H,B]=O.useState(null);function q(Ee,Te){D("account"),L(Te),Ee.dataTransfer.effectAllowed="move"}function F(Ee,Te,fe){Ee.preventDefault(),R==="account"&&(Te!==C&&ee(Te),B(fe))}function Q(Ee,Te){Ee.preventDefault(),R==="account"?(B(Te),ee(null)):R==="group"&&Te!==C&&ee(Te)}function W(){ee(null)}function P(){B(null)}function X(){D(null),L(null),ee(null),B(null)}async function he(Ee,Te,fe){if(Ee.preventDefault(),Ee.stopPropagation(),!C||R!=="account"){X();return}await w(C,Te,fe),X()}async function re(Ee,Te){Ee.preventDefault(),R==="account"?await he(Ee,"__group_end__",Te):R==="group"&&await ve(Ee,Te)}function ae(Ee,Te){Ee.stopPropagation(),D("group"),L(Te),Ee.dataTransfer.effectAllowed="move"}async function ve(Ee,Te){if(Ee.preventDefault(),!C||R!=="group"||C===Te){X();return}await I(C,Te),X()}if(!i)return m.jsx("p",{children:"No budget found. Please log in."});const Ae=e.ungrouped||[];return m.jsxs("div",{children:[m.jsx("h2",{style:{marginTop:0},children:"Accounts"}),m.jsxs("p",{style:df,children:["Organize your financial accounts by type.",m.jsx("br",{}),m.jsx("span",{style:{fontSize:"0.9rem"},children:N?"Use  buttons to reorder items, or drag to move between types.":"Drag accounts between types, or use  buttons to reorder."})]}),a&&m.jsx(ml,{message:a,onDismiss:()=>l(null)}),m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(t).length===0&&n.length===0&&m.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((Ee,Te)=>m.jsx(g4,{group:Ee,groupIndex:Te,totalGroups:n.length,accounts:e[Ee.id]||[],allGroups:n,allAccounts:t,editingAccountId:U,editingGroupId:J,createForGroupId:z,setEditingAccountId:G,setEditingGroupId:te,setCreateForGroupId:$,dragType:R,draggedId:C,dragOverId:k,dragOverGroupId:H,setDragOverId:ee,setDragOverGroupId:B,onAccountDragStart:q,onAccountDragOver:F,onAccountDrop:he,onGroupDragStart:ae,onGroupDragOver:Q,onGroupDrop:ve,onDragLeave:W,onDragLeaveGroup:P,onDragEnd:X,onDropOnGroup:re,onCreateAccount:u,onUpdateAccount:(fe,ft)=>{d(fe,ft),G(null)},onDeleteAccount:f,onMoveAccount:g,onUpdateGroup:(fe,ft)=>{v(fe,ft),te(null)},onDeleteGroup:E,onMoveGroup:T},Ee.id)),R==="group"&&n.length>0&&m.jsx(Oy,{isActive:k==="__end__",onDragOver:Ee=>{Ee.preventDefault(),ee("__end__")},onDragLeave:W,onDrop:Ee=>ve(Ee,"__end__"),label:"Move account type to end"}),m.jsx(_4,{accounts:Ae,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:U,createForGroupId:z,setEditingAccountId:G,setCreateForGroupId:$,dragType:R,draggedId:C,dragOverId:k,dragOverGroupId:H,setDragOverId:ee,setDragOverGroupId:B,onAccountDragStart:q,onAccountDragOver:F,onAccountDrop:he,onDragOverGroup:Q,onDropOnGroup:re,onDragLeave:W,onDragLeaveGroup:P,onDragEnd:X,onCreateAccount:u,onUpdateAccount:(Ee,Te)=>{d(Ee,Te),G(null)},onDeleteAccount:f,onMoveAccount:g})]}),j?m.jsx(RT,{onSubmit:Ee=>{_(Ee),A(!1)},onCancel:()=>A(!1),submitLabel:"Create Account Type"}):m.jsx(ke,{variant:"primary-large",onClick:()=>A(!0),children:"+ Add Account Type"})]})}function Ph({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,categoryGroups:a=[],showGroupSelector:l=!1}){const[u,d]=O.useState(t||{name:"",category_group_id:null}),[f,g]=O.useState(t?.default_monthly_amount?.toString()||""),[_,v]=O.useState(t?.default_monthly_type||"fixed"),[E,T]=O.useState(!1);function w(I){if(I.preventDefault(),!u.name.trim())return;T(!0);const N=parseFloat(f),U=!isNaN(N)&&N>0;e({...u,description:u.description?.trim()||void 0,default_monthly_amount:U?N:void 0,default_monthly_type:U?_:void 0})}return m.jsxs(Ua,{onSubmit:w,children:[m.jsx(Gt,{label:"Category Name",htmlFor:"category-name",children:m.jsx(zi,{id:"category-name",type:"text",value:u.name,onChange:I=>d({...u,name:I.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),m.jsx(Gt,{label:"Description (optional)",htmlFor:"category-description",children:m.jsx(Dy,{id:"category-description",value:u.description||"",onChange:I=>d({...u,description:I.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&m.jsx(Gt,{label:"Category Group",htmlFor:"category-group",children:m.jsxs(Ma,{id:"category-group",value:u.category_group_id||"ungrouped",onChange:I=>d({...u,category_group_id:I.target.value==="ungrouped"?null:I.target.value}),children:[m.jsx("option",{value:"ungrouped",children:"Uncategorized"}),a.map(I=>m.jsx("option",{value:I.id,children:I.name},I.id))]})}),m.jsxs(Gt,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[m.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[m.jsxs(Ma,{id:"default-type",value:_,onChange:I=>v(I.target.value),style:{width:"auto",flex:"0 0 auto"},children:[m.jsx("option",{value:"fixed",children:"Fixed $"}),m.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?m.jsx(Iy,{id:"default-amount",value:f,onChange:g,placeholder:"$0.00"}):m.jsx(zi,{id:"default-amount",type:"number",value:f,onChange:I=>g(I.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&m.jsx("span",{style:{opacity:.6},children:"%"})]}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),m.jsxs(Ks,{children:[m.jsx(ke,{type:"submit",isLoading:E,children:i}),m.jsx(ke,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function OT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=O.useState(t||{name:""}),[u,d]=O.useState(!1);function f(g){g.preventDefault(),a.name.trim()&&(d(!0),e(a))}return m.jsxs(Ua,{onSubmit:f,children:[m.jsx(Gt,{label:"Group Name",htmlFor:"group-name",children:m.jsx(zi,{id:"group-name",type:"text",value:a.name,onChange:g=>l({...a,name:g.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),m.jsxs(Ks,{children:[m.jsx(ke,{type:"submit",isLoading:u,children:i}),m.jsx(ke,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function jT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return m.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[m.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&m.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function b4({group:t,groupIndex:e,groupCategories:n,sortedGroups:i,categoryGroups:a,categoryBalances:l,loadingBalances:u,dragType:d,draggedId:f,dragOverId:g,dragOverGroupId:_,editingCategoryId:v,setEditingCategoryId:E,createForGroupId:T,setCreateForGroupId:w,editingGroupId:I,setEditingGroupId:N,handleCreateCategory:U,handleUpdateCategory:G,handleDeleteCategory:z,handleMoveCategory:$,handleUpdateGroup:J,handleDeleteGroup:te,handleMoveGroup:j,handleCategoryDragStart:A,handleCategoryDragOver:R,handleDragOverGroup:D,handleDragLeave:C,handleDragLeaveGroup:L,handleDragEnd:k,handleCategoryDrop:ee,handleDropOnGroup:H,handleGroupDragStart:B,handleGroupDrop:q,setDragOverId:F,setDragOverGroupId:Q,isMobile:W,categories:P}){const X=d==="group"&&f===t.id,he=d==="group"&&g===t.id,re=d==="category"&&_===t.id,ae=f&&d==="category"?P[f]:null,ve=ae&&(ae.category_group_id||"ungrouped")!==t.id,Ae=d==="group"&&he&&f!==t.id,Ee=e>0,Te=e<i.length-1;return m.jsxs("div",{children:[d==="group"&&!X&&m.jsxs("div",{onDragOver:fe=>{fe.preventDefault(),F(t.id)},onDragLeave:C,onDrop:fe=>q(fe,t.id),style:{position:"relative",height:Ae?"2.5rem":"0.5rem",marginBottom:Ae?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[m.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",opacity:Ae?1:0,transition:"opacity 0.15s",boxShadow:Ae?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),Ae&&m.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),m.jsx("div",{onDragOver:fe=>D(fe,t.id),onDragLeave:L,onDrop:fe=>H(fe,t.id),style:{background:X?"color-mix(in srgb, currentColor 3%, transparent)":re&&ve?`color-mix(in srgb, ${_e.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:X?.5:1,border:re&&ve?`2px dashed ${_e.primary}`:"2px solid transparent",transition:"all 0.15s"},children:I===t.id?m.jsx(OT,{initialData:{name:t.name},onSubmit:fe=>J(t.id,fe),onCancel:()=>N(null),submitLabel:"Save"}):m.jsxs(m.Fragment,{children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:W?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:W?"wrap":"nowrap"},children:[m.jsxs("h3",{style:{...fl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!W&&m.jsx("span",{draggable:!0,onDragStart:fe=>B(fe,t.id),onDragEnd:k,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),m.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),m.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",n.length,")"]})]}),m.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!W&&m.jsx(ke,{variant:"small",onClick:()=>w(t.id),disabled:T!==null,children:"+ Category"}),m.jsx("button",{onClick:()=>N(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),m.jsx("button",{onClick:()=>te(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),m.jsxs("div",{style:Cy,children:[m.jsx("button",{onClick:()=>j(t.id,"up"),disabled:!Ee,style:{...Xo,opacity:Ee?.6:.2,cursor:Ee?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),m.jsx("button",{onClick:()=>j(t.id,"down"),disabled:!Te,style:{...Xo,opacity:Te?.6:.2,cursor:Te?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),W&&m.jsx("div",{style:{marginBottom:"0.5rem"},children:m.jsx(ke,{variant:"small",onClick:()=>w(t.id),disabled:T!==null,children:"+ Category"})}),m.jsxs("div",{style:Fs,children:[n.map(([fe,ft])=>v===fe?m.jsx(Ph,{initialData:{name:ft.name,description:ft.description,category_group_id:ft.category_group_id,default_monthly_amount:ft.default_monthly_amount,default_monthly_type:ft.default_monthly_type},onSubmit:Be=>G(fe,Be),onCancel:()=>E(null),submitLabel:"Save",categoryGroups:a,showGroupSelector:!0},fe):m.jsx(hf,{isDragging:d==="category"&&f===fe,isDragOver:g===fe,onDragStart:Be=>{Be.stopPropagation(),A(Be,fe)},onDragOver:Be=>R(Be,fe,t.id),onDragLeave:C,onDragEnd:k,onDrop:Be=>ee(Be,fe,t.id),onEdit:()=>E(fe),onDelete:()=>z(fe),onMoveUp:()=>$(fe,"up"),onMoveDown:()=>$(fe,"down"),canMoveUp:n.findIndex(([Be])=>Be===fe)>0,canMoveDown:n.findIndex(([Be])=>Be===fe)<n.length-1,children:m.jsx(MT,{category:ft,catId:fe,categoryBalances:l,loadingBalances:u})},fe)),n.length===0&&!T&&m.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),d==="category"&&n.length>0&&m.jsx(jT,{groupId:t.id,isActive:g===`__end__${t.id}`,onDragOver:fe=>{fe.preventDefault(),fe.stopPropagation(),F(`__end__${t.id}`),Q(t.id)},onDragLeave:fe=>{fe.stopPropagation(),F(null)},onDrop:fe=>{fe.stopPropagation(),ee(fe,"__group_end__",t.id)}}),T===t.id&&m.jsx(Ph,{initialData:{name:"",category_group_id:t.id},onSubmit:fe=>U(fe,t.id),onCancel:()=>w(null),submitLabel:"Create",categoryGroups:a})]}),T!==t.id&&m.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:m.jsx(ke,{variant:"small",onClick:()=>w(t.id),disabled:T!==null,children:"+ Add Category"})})]})})]})}function MT({category:t,catId:e,categoryBalances:n,loadingBalances:i}){const a=n[e]||{current:0,total:0};return m.jsxs("div",{children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[m.jsx("span",{style:Ry,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&m.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?m.jsxs(m.Fragment,{children:[m.jsxs("span",{style:{color:_e.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):m.jsxs(m.Fragment,{children:[m.jsx("span",{style:{color:_e.success,fontWeight:500},children:Fe(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),m.jsxs("div",{style:{marginTop:"0.25rem"},children:[m.jsxs("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:fn(a.current)},children:[i?"...":Fe(a.current),m.jsx("span",{style:{fontSize:"0.75rem",fontWeight:400,opacity:.6,marginLeft:"0.35rem"},children:"available now"})]}),m.jsxs("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.85rem",fontWeight:500,color:fn(a.total),opacity:.75},children:[i?"...":Fe(a.total),m.jsx("span",{style:{fontSize:"0.7rem",fontWeight:400,opacity:.7,marginLeft:"0.35rem"},children:"total allocated"})]})]})]})}function E4({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:i,dragType:a,draggedId:l,dragOverId:u,dragOverGroupId:d,editingCategoryId:f,setEditingCategoryId:g,createForGroupId:_,setCreateForGroupId:v,handleCreateCategory:E,handleUpdateCategory:T,handleDeleteCategory:w,handleMoveCategory:I,handleCategoryDragStart:N,handleCategoryDragOver:U,handleDragOverGroup:G,handleDragLeaveGroup:z,handleDragLeave:$,handleDragEnd:J,handleCategoryDrop:te,handleDropOnGroup:j,setDragOverId:A,setDragOverGroupId:R,categories:D,hasGroups:C}){const L=a==="category"&&d==="ungrouped",k=l&&a==="category"?D[l]:null,ee=k&&k.category_group_id!==null;return t.length===0&&!_&&C&&a!=="category"?null:m.jsxs("div",{onDragOver:H=>G(H,"ungrouped"),onDragLeave:z,onDrop:H=>j(H,"ungrouped"),style:{background:L&&ee?`color-mix(in srgb, ${_e.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:L&&ee?`2px dashed ${_e.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[m.jsxs("h3",{style:{...fl,margin:0,opacity:.7},children:["Uncategorized",m.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),m.jsx(ke,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Category"})]}),m.jsxs("div",{style:Fs,children:[t.map(([H,B])=>f===H?m.jsx(Ph,{initialData:{name:B.name,description:B.description,category_group_id:B.category_group_id,default_monthly_amount:B.default_monthly_amount,default_monthly_type:B.default_monthly_type},onSubmit:q=>T(H,q),onCancel:()=>g(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},H):m.jsx(hf,{isDragging:a==="category"&&l===H,isDragOver:u===H,onDragStart:q=>N(q,H),onDragOver:q=>U(q,H,"ungrouped"),onDragLeave:$,onDragEnd:J,onDrop:q=>te(q,H,"ungrouped"),onEdit:()=>g(H),onDelete:()=>w(H),onMoveUp:()=>I(H,"up"),onMoveDown:()=>I(H,"down"),canMoveUp:t.findIndex(([q])=>q===H)>0,canMoveDown:t.findIndex(([q])=>q===H)<t.length-1,children:m.jsx(MT,{category:B,catId:H,categoryBalances:n,loadingBalances:i})},H)),t.length===0&&a==="category"&&m.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),a==="category"&&t.length>0&&m.jsx(jT,{groupId:"ungrouped",isActive:u==="__end__ungrouped",onDragOver:H=>{H.preventDefault(),H.stopPropagation(),A("__end__ungrouped"),R("ungrouped")},onDragLeave:H=>{H.stopPropagation(),A(null)},onDrop:H=>{H.stopPropagation(),te(H,"__group_end__","ungrouped")}}),_==="ungrouped"&&m.jsx(Ph,{initialData:{name:"",category_group_id:null},onSubmit:H=>E(H,"ungrouped"),onCancel:()=>v(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&m.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:m.jsx(ke,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function S4(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:i,sortedGroups:a,categoryBalances:l,loadingBalances:u,error:d,setError:f,getOnBudgetTotal:g,categoryBalanceMismatch:_,checkCategoryBalanceMismatch:v,recalculateAndSaveCategoryBalances:E,handleCreateCategory:T,handleUpdateCategory:w,handleDeleteCategory:I,handleMoveCategory:N,handleCreateGroup:U,handleUpdateGroup:G,handleDeleteGroup:z,handleMoveGroup:$,dragType:J,draggedId:te,dragOverId:j,dragOverGroupId:A,setDragOverId:R,setDragOverGroupId:D,handleCategoryDragStart:C,handleCategoryDragOver:L,handleDragOverGroup:k,handleDragLeave:ee,handleDragLeaveGroup:H,handleDragEnd:B,handleCategoryDrop:q,handleDropOnGroup:F,handleGroupDragStart:Q,handleGroupDrop:W}=SN(),P=Qs(),[X,he]=O.useState(null),[re,ae]=O.useState(null),[ve,Ae]=O.useState(null),[Ee,Te]=O.useState(!1),[fe,ft]=O.useState(!1),[Be,bn]=O.useState(!1);return t?m.jsxs("div",{children:[m.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),m.jsxs("p",{style:df,children:["Organize your spending categories into groups.",m.jsx("br",{}),m.jsx("span",{style:{fontSize:"0.9rem"},children:P?"Use  buttons to reorder items, or drag to move between groups.":"Drag categories between groups, or use  buttons to reorder."})]}),d&&m.jsx(ml,{message:d,onDismiss:()=>f(null)}),_&&Object.keys(_).length>0&&m.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 15%, transparent)",border:"1px solid #f59e0b",borderRadius:"8px",padding:"1rem",marginBottom:"1rem",display:"flex",flexDirection:P?"column":"row",alignItems:P?"flex-start":"center",gap:"1rem"},children:[m.jsxs("div",{style:{flex:1},children:[m.jsx("p",{style:{margin:0,fontWeight:600,color:"#f59e0b"},children:" Category Balance Mismatch Detected"}),m.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.85rem",opacity:.9},children:[Object.keys(_).length," categor",Object.keys(_).length!==1?"ies have":"y has"," balances that don't match the sum of allocations minus expenses."]})]}),m.jsx("button",{onClick:async()=>{bn(!0);try{await E()}catch(Ze){f(Ze instanceof Error?Ze.message:"Failed to reconcile")}finally{bn(!1)}},disabled:Be,style:{background:"#f59e0b",color:"#000",border:"none",borderRadius:"6px",padding:"0.5rem 1rem",fontWeight:600,cursor:Be?"not-allowed":"pointer",opacity:Be?.7:1,whiteSpace:"nowrap"},children:Be?" Reconciling...":" Reconcile Now"})]}),!_&&m.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem",gap:"0.5rem"},children:[m.jsx("button",{onClick:async()=>{ft(!0);try{await v()}finally{ft(!1)}},disabled:fe,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.85rem",cursor:fe?"not-allowed":"pointer",opacity:fe?.6:1},title:"Check if category balances match allocation/expense history",children:fe?" Checking...":" Check Balances"}),m.jsx("button",{onClick:async()=>{bn(!0);try{await E()}catch(Ze){f(Ze instanceof Error?Ze.message:"Failed to reconcile")}finally{bn(!1)}},disabled:Be,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.85rem",cursor:Be?"not-allowed":"pointer",opacity:Be?.6:1},title:"Recalculate all category balances from allocation/expense history",children:Be?" Reconciling...":" Reconcile All"})]}),(()=>{const Ze=Object.values(l).reduce((bt,wt)=>bt+wt.current,0),kn=Object.values(l).reduce((bt,wt)=>bt+wt.total,0),$n=g()-Ze,li=g()-kn,Dr=Math.abs(kn-Ze)>.01;return m.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[m.jsxs(Gn,{style:{flex:1,minWidth:"120px"},children:[m.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Categories"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:Object.keys(e).length})]}),m.jsxs(Gn,{style:{flex:1,minWidth:"120px"},children:[m.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Groups"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:n.length})]}),m.jsxs(Gn,{style:{flex:1,minWidth:"120px"},children:[m.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"On-Budget"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:fn(g())},children:Fe(g())})]}),m.jsxs(Gn,{style:{flex:1,minWidth:"120px"},children:[m.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Allocated Now"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:_e.primary},children:u?"...":Fe(Ze)}),Dr&&m.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:u?"":`${Fe(kn)} total`})]}),m.jsxs(Gn,{style:{flex:1,minWidth:"120px"},children:[m.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Available Now"}),m.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:fn($n)},children:u?"...":Fe($n)}),Dr&&m.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:u?"":`${Fe(li)} after future`})]})]})})(),m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(e).length===0&&n.length===0&&m.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),a.map((Ze,kn)=>{const $n=(i[Ze.id]||[]).sort((li,Dr)=>li[1].sort_order-Dr[1].sort_order);return m.jsx(b4,{group:Ze,groupIndex:kn,groupCategories:$n,sortedGroups:a,categoryGroups:n,categoryBalances:l,loadingBalances:u,dragType:J,draggedId:te,dragOverId:j,dragOverGroupId:A,editingCategoryId:X,setEditingCategoryId:he,createForGroupId:re,setCreateForGroupId:ae,editingGroupId:ve,setEditingGroupId:Ae,handleCreateCategory:T,handleUpdateCategory:w,handleDeleteCategory:I,handleMoveCategory:N,handleUpdateGroup:G,handleDeleteGroup:z,handleMoveGroup:$,handleCategoryDragStart:C,handleCategoryDragOver:L,handleDragOverGroup:k,handleDragLeave:ee,handleDragLeaveGroup:H,handleDragEnd:B,handleCategoryDrop:q,handleDropOnGroup:F,handleGroupDragStart:Q,handleGroupDrop:W,setDragOverId:R,setDragOverGroupId:D,isMobile:P,categories:e},Ze.id)}),J==="group"&&a.length>0&&m.jsx(Oy,{isActive:j==="__end__",onDragOver:Ze=>{Ze.preventDefault(),R("__end__")},onDragLeave:ee,onDrop:Ze=>W(Ze,"__end__"),label:"Move group to end"}),m.jsx(E4,{ungroupedCategories:(i.ungrouped||[]).sort((Ze,kn)=>Ze[1].sort_order-kn[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:u,dragType:J,draggedId:te,dragOverId:j,dragOverGroupId:A,editingCategoryId:X,setEditingCategoryId:he,createForGroupId:re,setCreateForGroupId:ae,handleCreateCategory:T,handleUpdateCategory:w,handleDeleteCategory:I,handleMoveCategory:N,handleCategoryDragStart:C,handleCategoryDragOver:L,handleDragOverGroup:k,handleDragLeaveGroup:H,handleDragLeave:ee,handleDragEnd:B,handleCategoryDrop:q,handleDropOnGroup:F,setDragOverId:R,setDragOverGroupId:D,categories:e,hasGroups:n.length>0})]}),Ee?m.jsx(OT,{onSubmit:Ze=>{U(Ze),Te(!1)},onCancel:()=>Te(!1),submitLabel:"Create Group"}):m.jsx(ke,{variant:"primary-large",onClick:()=>Te(!0),children:"+ Add Category Group"})]}):m.jsx("p",{children:"No budget found. Please log in."})}function x4(){const{selectedBudgetId:t,currentUserId:e,isAdmin:n,isTest:i}=wn(),{budget:a,accounts:l,accountGroups:u,categories:d,categoryGroups:f,isOwner:g,isLoading:_}=Kn(t,e),v=hr(),E=v.pathname==="/budget/admin",T=O.useMemo(()=>{const j=v.pathname;return j.includes("/admin/accounts")?"accounts":j.includes("/admin/categories")?"categories":j.includes("/admin/users")?"users":j.includes("/admin/migration")?"migration":j.includes("/admin/feedback")?"feedback":j.includes("/admin/tests")?"tests":(j.includes("/admin/my-budgets"),"my-budgets")},[v.pathname]),w=T==="users",I=T==="migration",N=T==="feedback",U=T==="tests";O.useEffect(()=>{E||localStorage.setItem(iS,T)},[T,E]);function G(){const j=localStorage.getItem(iS);return!(j&&yN.includes(j))||j==="users"&&!g||(j==="migration"||j==="feedback")&&!n||j==="tests"&&!i?"my-budgets":j}const z=O.useMemo(()=>[{id:"my-budgets",label:"My Budgets",icon:""},{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!g},{id:"migration",label:"Migration",icon:"",hidden:!n},{id:"feedback",label:"Feedback",icon:"",hidden:!n},{id:"tests",label:"Tests",icon:"",hidden:!i}],[g,n,i]);if(_)return m.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:m.jsx("p",{children:"Loading..."})});const $=w,J=I||N,te=U;return!g&&$||!n&&J||!i&&te?m.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[m.jsx("nav",{style:{marginBottom:"1.5rem"},children:m.jsx(Tt,{to:"/budget",children:" Back to Budget"})}),m.jsx("h1",{children:"Access Denied"}),m.jsx("p",{style:{opacity:.7},children:te?"Only test users can access this section.":J?"Only administrators can access this section.":"Only the budget owner can access this section."}),m.jsx("p",{style:{marginTop:"1rem"},children:m.jsx(Tt,{to:"/budget/admin/my-budgets",style:{color:"#646cff"},children:"Go to My Budgets "})})]}):m.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[m.jsx("nav",{style:{marginBottom:"1.5rem"},children:m.jsx(Tt,{to:"/budget",children:" Back to Budget"})}),m.jsx("h1",{children:g?"Admin Settings":"Budget Settings"}),m.jsx("p",{style:{opacity:.7,marginBottom:"0.5rem"},children:g?"Manage your budget settings, users, and data migration.":"Manage your budgets, accounts, and categories."}),a&&m.jsxs("div",{style:{opacity:.6,marginBottom:"1.5rem",fontSize:"0.9rem",display:"flex",flexDirection:"column",gap:"0.25rem"},children:[m.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[m.jsx("span",{children:""}),m.jsxs("span",{children:["Budget Name: ",m.jsx("strong",{style:{opacity:1},children:a.name})]})]}),m.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[m.jsx("span",{children:""}),m.jsxs("span",{children:["Budget ID: ",m.jsx("code",{style:{opacity:1,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.1rem 0.4rem",borderRadius:"4px",fontSize:"0.85rem"},children:a.id})]})]}),m.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[m.jsx("span",{children:""}),m.jsxs("span",{children:["Budget Owner: ",m.jsx("strong",{style:{opacity:1},children:a.owner_email||a.owner_id})]})]}),n&&m.jsx("button",{onClick:()=>{const j={...a,accounts:l,account_groups:u,categories:d,category_groups:f,_meta:{downloaded_at:new Date().toISOString()}},A=new Blob([JSON.stringify(j,null,2)],{type:"application/json"}),R=URL.createObjectURL(A),D=document.createElement("a");D.href=R,D.download=`budget_${a.id}.json`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(R)},style:{marginTop:"0.5rem",display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",opacity:1,transition:"background 0.15s",alignSelf:"flex-start"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]}),m.jsx("div",{style:{borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",paddingBottom:"0.5rem",marginBottom:"0.5rem"},children:m.jsx(CT,{mode:"link",linkPrefix:"/budget/admin",tabs:z,activeTab:T})}),E?m.jsx(RS,{to:`/budget/admin/${G()}`,replace:!0}):m.jsx(Cg,{})]})}function w4(){const{selectedBudgetId:t,currentUserId:e}=wn(),{budget:n,budgetUserIds:i,acceptedUserIds:a,inviteUser:l,revokeUser:u}=Kn(t,e),[d,f]=O.useState(""),[g,_]=O.useState(!1),[v,E]=O.useState(null),[T,w]=O.useState(null);if(!n)return m.jsx("p",{children:"No budget found."});async function I(z){if(z.preventDefault(),!(!d.trim()||!n)){_(!0),E(null),w(null);try{await l(d.trim()),f(""),w("Invite sent! The user can now accept the invitation from their account.")}catch($){E($ instanceof Error?$.message:"Failed to invite user")}finally{_(!1)}}}async function N(z){if(!n)return;if(z===n.owner_id){E("Cannot revoke the budget owner");return}if(z===e){E("Cannot revoke yourself from the budget");return}const $=a.includes(z);if(confirm($?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){E(null),w(null);try{await u(z),w($?"User access revoked.":"Invitation cancelled.")}catch(te){E(te instanceof Error?te.message:"Failed to revoke user")}}}const U=i.filter(z=>a.includes(z)),G=i.filter(z=>!a.includes(z));return m.jsxs("div",{children:[m.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),m.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),v&&m.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsx("span",{children:v}),m.jsx("button",{onClick:()=>E(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),T&&m.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsx("span",{children:T}),m.jsx("button",{onClick:()=>w(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[m.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",U.length,")"]}),U.length===0?m.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):m.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:U.map(z=>{const $=z===n.owner_id,J=z===e;return m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[m.jsx("div",{style:{flex:1,minWidth:0},children:m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[m.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:z}),$&&m.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),J&&m.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!$&&!J&&m.jsx("button",{onClick:()=>N(z),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},z)})})]}),G.length>0&&m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[m.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",G.length,")"]}),m.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:G.map(z=>m.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[m.jsx("div",{style:{flex:1,minWidth:0},children:m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[m.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:z}),m.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),m.jsx("button",{onClick:()=>N(z),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},z))})]}),m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[m.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),m.jsxs("form",{onSubmit:I,style:{display:"flex",gap:"0.75rem"},children:[m.jsx("input",{type:"text",value:d,onChange:z=>f(z.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),m.jsx("button",{type:"submit",disabled:g||!d.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||!d.trim()?"not-allowed":"pointer",fontWeight:500,opacity:g||!d.trim()?.7:1,whiteSpace:"nowrap"},children:g?"Inviting...":"Send Invite"})]}),m.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),m.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}function hS({budget:t,isCurrent:e,isAccepting:n,isSwitching:i,isEditing:a,editName:l,isRenaming:u,onAccept:d,onSwitch:f,onStartEdit:g,onCancelEdit:_,onEditNameChange:v,onSaveEdit:E}){const T=e&&t.isOwner;return m.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:a?m.jsxs("form",{onSubmit:E,children:[m.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:m.jsx("input",{type:"text",value:l,onChange:w=>v(w.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),m.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[m.jsx("button",{type:"submit",disabled:u||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:u||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:u||!l.trim()?.7:1,fontSize:"0.8rem"},children:u?"Saving...":"Save"}),m.jsx("button",{type:"button",onClick:_,disabled:u,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:u?"not-allowed":"pointer",fontWeight:500,opacity:u?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[m.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[m.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&m.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&m.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&m.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),T&&m.jsx("button",{onClick:g,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),m.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),m.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?m.jsx("button",{onClick:d,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:m.jsx("button",{onClick:f,disabled:i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,fontSize:"0.85rem"},children:i?"Switching...":"Switch"})})]})})}const vg={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function kT({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,i=n&&n in vg?n:"bug",a=vg[i];return m.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:a.bgColor,color:a.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:a.label})}function T4({item:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:u,onDrop:d,onToggleDone:f,onTypeClick:g}){return m.jsxs("div",{onDragOver:_=>{_.stopPropagation(),a(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),d(_)},style:{position:"relative"},children:[m.jsx("div",{style:{...TT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),m.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:u,style:{...cu,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[m.jsx("span",{style:{...wT},children:""}),m.jsx("input",{type:"checkbox",checked:t.is_done,onChange:f,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:_e.primary,flexShrink:0}}),m.jsx(kT,{type:t.feedback_type,onClick:g})]}),m.jsxs("div",{style:{marginLeft:"3.25rem"},children:[m.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),m.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",_g(t.created_at)]})]})]})]})}function A4({item:t,onToggleDone:e,onTypeClick:n}){return m.jsxs("div",{style:{...cu,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[m.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[m.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:_e.primary,flexShrink:0}}),m.jsx(kT,{type:t.feedback_type,onClick:n})]}),m.jsxs("div",{style:{marginLeft:"2rem"},children:[m.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),m.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",_g(t.created_at)]}),t.completed_at&&m.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:_e.success},children:[" Completed: ",_g(t.completed_at)]})]})]})}function bg({noMargin:t}={}){return m.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:t?0:"0.5rem",verticalAlign:"middle"}})}function C4({title:t,description:e,isComplete:n,isMigrating:i,needsMigration:a,totalBudgetsToMigrate:l,budgetsToMigrateCategories:u,budgetsToMigrateAccounts:d,onRunMigration:f,onRefresh:g,isRefreshing:_,disabled:v,isUnknown:E,children:T}){const w=()=>E?{background:"rgba(100, 100, 100, 0.2)",color:"#9ca3af"}:n?{background:"rgba(34, 197, 94, 0.2)",color:"#4ade80"}:{background:"rgba(100, 108, 255, 0.2)",color:"#a5b4fc"},I=()=>E?"Unknown":n?"Complete":"Required",N=w();return m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[m.jsxs("h3",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[m.jsx("span",{style:{background:N.background,color:N.color,padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:I()}),t]}),g&&m.jsxs("button",{onClick:g,disabled:_||i,title:"Refresh status",style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.35rem 0.6rem",borderRadius:"6px",cursor:_||i?"not-allowed":"pointer",opacity:_||i?.5:.7,fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"0.3rem",minWidth:"85px",minHeight:"28px"},children:[m.jsx("span",{style:{width:"16px",height:"16px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:_?m.jsx(bg,{noMargin:!0}):""}),"Refresh"]})]}),m.jsx("p",{style:{opacity:.7,marginBottom:"1rem"},children:e}),i?m.jsxs("div",{style:{background:"rgba(100, 108, 255, 0.1)",border:"1px solid rgba(100, 108, 255, 0.3)",color:"#a5b4fc",padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:[m.jsx(bg,{})," Running migration across all budgets..."]}):E?m.jsx("div",{style:{background:"rgba(100, 100, 100, 0.1)",border:"1px solid rgba(100, 100, 100, 0.3)",color:"#9ca3af",padding:"0.75rem 1rem",borderRadius:"8px"},children:" Status unknown  click Refresh to check migration status"}):n?m.jsx("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px"},children:" All budgets are using the new map structure"}):a?m.jsxs(m.Fragment,{children:[m.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",color:"#fbbf24",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem"},children:[m.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",l," budget(s) needing migration:"]}),m.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[u>0&&m.jsxs("li",{children:[u," with categories to migrate"]}),d>0&&m.jsxs("li",{children:[d," with accounts to migrate"]})]})]}),m.jsx("button",{onClick:f,disabled:v,style:{background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:v?"not-allowed":"pointer",fontWeight:500,opacity:v?.7:1},children:"Migrate All Budgets"})]}):null,T]})}function R4({results:t}){return m.jsxs("div",{style:{marginTop:"1rem"},children:[m.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem"},children:"Migration Results:"}),m.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:t.map((e,n)=>m.jsx(D4,{result:e,isLast:n===t.length-1},n))})]})}function D4({result:t,isLast:e}){const n=t.error&&t.error!=="Already migrated",i=t.error==="Already migrated";return m.jsxs("div",{style:{padding:"0.5rem",marginBottom:e?0:"0.5rem",borderRadius:"4px",background:n?"rgba(220, 38, 38, 0.1)":i?"rgba(100, 100, 100, 0.1)":"rgba(34, 197, 94, 0.1)",border:n?"1px solid rgba(220, 38, 38, 0.3)":i?"1px solid rgba(100, 100, 100, 0.3)":"1px solid rgba(34, 197, 94, 0.3)"},children:[m.jsxs("div",{style:{fontWeight:500},children:[n?"":i?"":""," ",t.budgetName]}),n?m.jsxs("div",{style:{fontSize:"0.85rem",opacity:.8,color:"#f87171"},children:["Error: ",t.error]}):i?m.jsx("div",{style:{fontSize:"0.85rem",opacity:.6},children:"Already using map structure"}):m.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7},children:[t.categoriesMigrated>0&&`Migrated ${t.categoriesMigrated} categories`,t.categoriesMigrated>0&&(t.accountsMigrated>0||t.accountGroupsMigrated>0)&&", ",t.accountsMigrated>0&&`${t.accountsMigrated} accounts`,t.accountsMigrated>0&&t.accountGroupsMigrated>0&&", ",t.accountGroupsMigrated>0&&`${t.accountGroupsMigrated} account groups`,t.balancesCalculated&&" with calculated balances"]})]})}function I4(){const e=La().get_current_firebase_user(),n=kj(),[i,a]=O.useState(!1),[l,u]=O.useState(null),d=n.data!==void 0,f=n.isStale,g=n.data??{categoriesArrayMigrationNeeded:!1,accountsArrayMigrationNeeded:!1,budgetsToMigrateCategories:0,budgetsToMigrateAccounts:0,totalBudgetsChecked:0},_=n.isLoading,v=n.isFetching&&!n.isLoading,E=n.dataUpdatedAt?new Date(n.dataUpdatedAt).toLocaleString():null;async function T(z,$){const J={};$.forEach(te=>{J[te]=0});try{const te=await Oa("months",[{field:"budget_id",op:"==",value:z}]);for(const j of te.docs){const A=j.data;if(A.allocations_finalized&&A.allocations)for(const R of A.allocations)J[R.category_id]=(J[R.category_id]||0)+R.amount}}catch(te){console.error("Error calculating balances for budget:",z,te)}return J}async function w(){if(!e)return;a(!0),u(null);const z=[];try{const $=await Oa("budgets",[]);if($.docs.length===0){u([{budgetId:"",budgetName:"No budgets found",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"No budgets in system"}]),a(!1);return}for(const J of $.docs){const te=await I(J.id);z.push(te)}u(z),He.invalidateQueries({queryKey:["budget"]}),He.invalidateQueries({queryKey:["month"]}),He.invalidateQueries({queryKey:["adminMigration"]}),n.refetch()}catch($){u([{budgetId:"",budgetName:"Migration Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:$ instanceof Error?$.message:"Migration failed"}])}finally{a(!1)}}async function I(z){try{const{exists:$,data:J}=await Re("budgets",z);if(!$||!J)return{budgetId:z,budgetName:"Unknown",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Budget not found"};const te=J.name||"Unnamed Budget",j=Array.isArray(J.categories),A=Array.isArray(J.accounts),R=Array.isArray(J.account_groups);if(!j&&!A&&!R)return{budgetId:z,budgetName:te,categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Already migrated"};let D=J.categories,C=J.accounts,L=J.account_groups,k=0,ee=0,H=0,B=!1;if(j){const Q=J.categories,W={},P=[];for(const re of Q){const ae=re.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;P.push(ae),W[ae]={name:re.name,description:re.description,category_group_id:re.category_group_id??null,sort_order:re.sort_order??0,default_monthly_amount:re.default_monthly_amount,default_monthly_type:re.default_monthly_type,balance:0}}const X=await T(z,P);for(const re of P)W[re]&&(W[re].balance=X[re]||0);const he={};Object.entries(W).forEach(([re,ae])=>{he[re]={name:ae.name,category_group_id:ae.category_group_id??null,sort_order:ae.sort_order,balance:ae.balance},ae.description&&(he[re].description=ae.description),ae.default_monthly_amount!==void 0&&(he[re].default_monthly_amount=ae.default_monthly_amount),ae.default_monthly_type!==void 0&&(he[re].default_monthly_type=ae.default_monthly_type)}),D=he,k=Q.length,B=!0}if(A){const Q=J.accounts,W={};for(const P of Q){const X=P.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;W[X]={nickname:P.nickname,balance:P.balance??0,account_group_id:P.account_group_id??null,sort_order:P.sort_order??0},P.is_income_account!==void 0&&(W[X].is_income_account=P.is_income_account),P.is_income_default!==void 0&&(W[X].is_income_default=P.is_income_default),P.is_outgo_account!==void 0&&(W[X].is_outgo_account=P.is_outgo_account),P.is_outgo_default!==void 0&&(W[X].is_outgo_default=P.is_outgo_default),P.on_budget!==void 0&&(W[X].on_budget=P.on_budget),P.is_active!==void 0&&(W[X].is_active=P.is_active)}C=W,ee=Q.length}if(R){const Q=J.account_groups,W={};for(const P of Q){const X=P.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;W[X]={name:P.name,sort_order:P.sort_order??0},P.expected_balance!==void 0&&(W[X].expected_balance=P.expected_balance),P.on_budget!==void 0&&(W[X].on_budget=P.on_budget),P.is_active!==void 0&&(W[X].is_active=P.is_active)}if(A&&C){const P=C,X=J.account_groups,he={};X.forEach((re,ae)=>{const ve=re.id||String(ae),Ae=Object.keys(W)[ae];Ae&&(he[ve]=Ae)}),Object.entries(P).forEach(([re,ae])=>{ae.account_group_id&&he[ae.account_group_id]&&(P[re].account_group_id=he[ae.account_group_id])})}L=W,H=Q.length}const{category_balances:q,...F}=J;return await nt("budgets",z,{...F,categories:D,accounts:C,account_groups:L}),{budgetId:z,budgetName:te,categoriesMigrated:k,accountsMigrated:ee,accountGroupsMigrated:H,balancesCalculated:B}}catch($){return{budgetId:z,budgetName:"Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:$ instanceof Error?$.message:"Migration failed"}}}const N=g.categoriesArrayMigrationNeeded||g.accountsArrayMigrationNeeded,U=Math.max(g.budgetsToMigrateCategories,g.budgetsToMigrateAccounts),G=()=>{He.invalidateQueries({queryKey:["adminMigration"]}),n.refetch()};return _?m.jsxs("div",{children:[m.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),m.jsx("h2",{style:{marginTop:0},children:"Data Migrations"}),m.jsx("p",{style:{opacity:.7},children:"Checking migration status..."})]}):m.jsxs("div",{children:[m.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[m.jsx("h2",{style:{margin:0},children:"Data Migrations"}),m.jsxs("button",{onClick:G,disabled:v||i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:v||i?"not-allowed":"pointer",fontWeight:500,opacity:v||i?.7:1,display:"flex",alignItems:"center",gap:"0.4rem",minWidth:"130px",minHeight:"36px"},children:[m.jsx("span",{style:{width:"18px",height:"18px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:v?m.jsx(bg,{noMargin:!0}):""}),"Refresh All"]})]}),m.jsxs("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:["Run migrations to update your budget data structure. Status is cached and won't auto-refresh.",m.jsx("span",{style:{display:"block",fontSize:"0.85rem",marginTop:"0.25rem"},children:d?f?m.jsxs("span",{style:{color:"#fbbf24"},children:[" Status may be stale  Last checked: ",E]}):m.jsxs("span",{children:["Last checked: ",E]}):m.jsx("span",{style:{color:"#a5b4fc"},children:"Status: Unknown (click Refresh to check)"})})]}),m.jsx(C4,{title:"Migrate Data to Map Structure",description:"Converts categories, accounts, and account groups from array format to map structure. This improves performance and enables direct lookup by ID.",isComplete:d?!N:!1,isMigrating:i,needsMigration:d?N:!1,totalBudgetsToMigrate:U,budgetsToMigrateCategories:g.budgetsToMigrateCategories,budgetsToMigrateAccounts:g.budgetsToMigrateAccounts,onRunMigration:w,onRefresh:G,isRefreshing:v,disabled:!e,isUnknown:!d,children:l&&m.jsx(R4,{results:l})}),m.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:m.jsxs("p",{style:{margin:0,opacity:.7},children:[m.jsx("strong",{children:"Note:"})," This migration will process ",m.jsxs("strong",{children:["all ",d?g.totalBudgetsChecked:"?"," budgets"]})," in the system, not just the ones you own or are invited to."]})})]})}function O4(){const[t,e]=O.useState(null),[n,i]=O.useState(null),[a,l]=O.useState(null),[u,d]=O.useState(!1),[f,g]=O.useState(""),[_,v]=O.useState("bug"),[E,T]=O.useState(null),[w,I]=O.useState(null),N=O.useContext(Wc),G=La().get_current_firebase_user(),z=jj(),$=Bw(),J=z.data?.items||[];async function te(F){if(F.preventDefault(),!(!f.trim()||!N.username||!G)){e(null);try{await $.submitFeedback.mutateAsync({userId:G.uid,userEmail:N.username,text:f.trim(),feedbackType:_,currentPath:"/admin/feedback"}),g(""),v("bug"),d(!1)}catch(Q){e(Q instanceof Error?Q.message:"Failed to add feedback")}}}function j(F){F.is_done?A(F):T(F)}async function A(F){try{await $.toggleFeedback.mutateAsync({item:F})}catch(Q){e(Q instanceof Error?Q.message:"Failed to update feedback")}}function R(){E&&(A(E),T(null))}async function D(F){if(w){try{const W=J.filter(P=>P.doc_id===w.doc_id).map(P=>P.id===w.id?{id:P.id,text:P.text,created_at:P.created_at,is_done:P.is_done,completed_at:P.completed_at,sort_order:P.sort_order,feedback_type:F}:{id:P.id,text:P.text,created_at:P.created_at,is_done:P.is_done,completed_at:P.completed_at,sort_order:P.sort_order,feedback_type:P.feedback_type});await $.updateSortOrder.mutateAsync({docId:w.doc_id,items:W})}catch(Q){e(Q instanceof Error?Q.message:"Failed to update feedback type")}I(null)}}const C=J.filter(F=>!F.is_done).sort((F,Q)=>F.sort_order-Q.sort_order),L=J.filter(F=>F.is_done).sort((F,Q)=>{const W=F.completed_at?new Date(F.completed_at).getTime():0;return(Q.completed_at?new Date(Q.completed_at).getTime():0)-W});function k(F,Q){i(Q),F.dataTransfer.effectAllowed="move"}function ee(F,Q){F.preventDefault(),Q!==n&&l(Q)}function H(){l(null)}function B(){i(null),l(null)}async function q(F,Q){if(F.preventDefault(),!n||n===Q){B();return}const W=C.findIndex(ae=>ae.id===n),P=[...C],[X]=P.splice(W,1);if(Q==="__end__")P.push(X);else{const ae=P.findIndex(ve=>ve.id===Q);P.splice(ae,0,X)}const he=P.map((ae,ve)=>({...ae,sort_order:ve}));B();const re=new Map;for(const ae of he)re.has(ae.doc_id)||re.set(ae.doc_id,[]),re.get(ae.doc_id).push({id:ae.id,text:ae.text,created_at:ae.created_at,is_done:ae.is_done,completed_at:ae.completed_at,sort_order:ae.sort_order,feedback_type:ae.feedback_type});for(const ae of L)re.has(ae.doc_id)||re.set(ae.doc_id,[]),re.get(ae.doc_id).push({id:ae.id,text:ae.text,created_at:ae.created_at,is_done:ae.is_done,completed_at:ae.completed_at,sort_order:ae.sort_order,feedback_type:ae.feedback_type});try{for(const[ae,ve]of re)await $.updateSortOrder.mutateAsync({docId:ae,items:ve})}catch(ae){e(ae instanceof Error?ae.message:"Failed to save order")}}return z.isLoading?m.jsx("p",{children:"Loading feedback..."}):m.jsxs("div",{children:[m.jsx("h2",{style:{marginTop:0},children:"Feedback"}),m.jsx("p",{style:{...df,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&m.jsx(ml,{message:t,onDismiss:()=>e(null)}),m.jsxs("div",{style:Fs,children:[C.length===0&&!u&&m.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),C.map(F=>m.jsx(T4,{item:F,isDragging:n===F.id,isDragOver:a===F.id,onDragStart:Q=>k(Q,F.id),onDragOver:Q=>ee(Q,F.id),onDragLeave:H,onDragEnd:B,onDrop:Q=>q(Q,F.id),onToggleDone:()=>j(F),onTypeClick:()=>I(F)},F.id)),n&&C.length>0&&m.jsx(Oy,{isActive:a==="__end__",onDragOver:F=>ee(F,"__end__"),onDragLeave:H,onDrop:F=>q(F,"__end__")})]}),u?m.jsxs(Ua,{onSubmit:te,children:[m.jsx(fS,{selectedType:_,onSelect:v}),m.jsx(Dy,{value:f,onChange:F=>g(F.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),m.jsxs(Ks,{children:[m.jsx(ke,{type:"submit",isLoading:$.submitFeedback.isPending,disabled:!f.trim(),children:"Add Feedback"}),m.jsx(ke,{type:"button",variant:"secondary",onClick:()=>{d(!1),g(""),v("bug")},children:"Cancel"})]})]}):m.jsx(ke,{variant:"primary-large",onClick:()=>d(!0),children:"+ Add Feedback"}),L.length>0&&m.jsx($N,{title:"Completed",count:L.length,children:m.jsx("div",{style:{...Fs,marginTop:"0.5rem"},children:L.map(F=>m.jsx(A4,{item:F,onToggleDone:()=>j(F),onTypeClick:()=>I(F)},F.id))})}),m.jsxs(kh,{isOpen:E!==null,onClose:()=>T(null),title:"Mark as Complete",children:[m.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),E&&m.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',E.text,'"']}),m.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[m.jsx(ke,{variant:"secondary",onClick:()=>T(null),children:"Cancel"}),m.jsx(ke,{variant:"primary",onClick:R,children:"Mark Complete"})]})]}),m.jsxs(kh,{isOpen:w!==null,onClose:()=>I(null),title:"Change Feedback Type",children:[m.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),m.jsx(fS,{selectedType:w?.feedback_type||"bug",onSelect:D}),m.jsx(ke,{variant:"secondary",onClick:()=>I(null),style:{width:"100%"},children:"Cancel"})]})]})}function fS({selectedType:t,onSelect:e}){return m.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const i=vg[n],a=t==="feature"?"new_feature":t,l=a===n||!a&&n==="bug";return m.jsxs("button",{type:"button",onClick:()=>e(n),style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${i.color}`,borderRadius:"0.5rem",background:l?i.bgColor:"transparent",color:l?i.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${i.bgColor}`:"none",position:"relative"},children:[i.label,l&&m.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function j4(){const{currentUserId:t}=wn(),[e,n]=O.useState([]),[i,a]=O.useState(!1);function l(E,T){n(w=>w.map(I=>I.name===E?{...I,...T}:I))}async function u(){a(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await d("Read unauthorized budget",async()=>(await Re("budgets","unauthorized_budget_test_12345"),"Was able to read budget (unexpected)"),!0),await d("Read another user's document",async()=>(await Re("users","another_user_test_12345"),"Was able to read user document (unexpected)"),!0),await d("Read unauthorized budget month",async()=>(await Re("months","unauthorized_budget_test_12345_2024_01"),"Was able to read month document for unauthorized budget (unexpected)"),!0),await d("Toggle is_admin in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:T}=await Re("users",t),w=T?.permission_flags?.is_admin??!1;return await Kd("users",t,{"permission_flags.is_admin":!w}),`Was able to change is_admin from ${w} to ${!w} (SECURITY ISSUE!)`},!0),await d("Toggle is_test in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:T}=await Re("users",t),w=T?.permission_flags?.is_test??!1;return await Kd("users",t,{"permission_flags.is_test":!w}),`Was able to change is_test from ${w} to ${!w} (SECURITY ISSUE!)`},!0),await d("Read own user document",async()=>{if(!t)throw new Error("Not authenticated");const{exists:T}=await Re("users",t);if(T)return"Successfully read own document";throw new Error("Document does not exist")},!1),a(!1)}async function d(E,T,w){l(E,{status:"running",message:"Running..."});try{const I=await T();w?l(E,{status:"failed",message:` ${I}`}):l(E,{status:"passed",message:` ${I}`})}catch(I){const N=I instanceof Error?I.message:"Unknown error";w?l(E,{status:"passed",message:` Blocked as expected: ${N}`}):l(E,{status:"failed",message:` ${N}`})}}async function f(E){switch(e.find(w=>w.name===E)||n(w=>[...w,{name:E,status:"pending",message:"",expectedToFail:!0}]),a(!0),E){case"Read unauthorized budget":await d(E,async()=>(await Re("budgets","unauthorized_budget_test_12345"),"Was able to read budget (unexpected)"),!0);break;case"Read another user's document":await d(E,async()=>(await Re("users","another_user_test_12345"),"Was able to read user document (unexpected)"),!0);break;case"Read unauthorized budget month":await d(E,async()=>(await Re("months","unauthorized_budget_test_12345_2024_01"),"Was able to read month document for unauthorized budget (unexpected)"),!0);break;case"Toggle is_admin in own permission_flags":await d(E,async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Re("users",t),I=w?.permission_flags?.is_admin??!1;return await Kd("users",t,{"permission_flags.is_admin":!I}),`Was able to change is_admin from ${I} to ${!I} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await d(E,async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Re("users",t),I=w?.permission_flags?.is_test??!1;return await Kd("users",t,{"permission_flags.is_test":!I}),`Was able to change is_test from ${I} to ${!I} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await d(E,async()=>{if(!t)throw new Error("Not authenticated");const{exists:w}=await Re("users",t);if(w)return"Successfully read own document";throw new Error("Document does not exist")},!1);break}a(!1)}const g=e.filter(E=>E.status==="passed").length,_=e.filter(E=>E.status==="failed").length,v=e.length;return m.jsxs("div",{children:[m.jsx("p",{style:df,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),m.jsx("div",{style:{marginBottom:"1.5rem"},children:m.jsx(ke,{onClick:u,disabled:i,variant:"primary",children:i?"Running Tests...":"Run All Tests"})}),e.length>0&&m.jsx("div",{style:{marginBottom:"1.5rem"},children:m.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[m.jsxs("span",{children:["Total: ",m.jsx("strong",{children:v})]}),m.jsxs("span",{style:{color:_e.success},children:["Passed: ",m.jsx("strong",{children:g})]}),m.jsxs("span",{style:{color:_e.danger},children:["Failed: ",m.jsx("strong",{children:_})]})]})}),m.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[m.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),m.jsx(Oo,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(E=>E.name==="Read unauthorized budget"),onRun:()=>f("Read unauthorized budget"),disabled:i}),m.jsx(Oo,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(E=>E.name==="Read another user's document"),onRun:()=>f("Read another user's document"),disabled:i}),m.jsx(Oo,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(E=>E.name==="Read unauthorized budget month"),onRun:()=>f("Read unauthorized budget month"),disabled:i}),m.jsx(Oo,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(E=>E.name==="Toggle is_admin in own permission_flags"),onRun:()=>f("Toggle is_admin in own permission_flags"),disabled:i}),m.jsx(Oo,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(E=>E.name==="Toggle is_test in own permission_flags"),onRun:()=>f("Toggle is_test in own permission_flags"),disabled:i}),m.jsx(Oo,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(E=>E.name==="Read own user document"),onRun:()=>f("Read own user document"),disabled:i,expectedToSucceed:!0})]}),_>0&&m.jsxs(ml,{style:{marginTop:"1.5rem"},children:[" ",_," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function Oo({name:t,description:e,expectedBehavior:n,result:i,onRun:a,disabled:l,expectedToSucceed:u}){const d=i?.status==="passed"?_e.success:i?.status==="failed"?_e.danger:i?.status==="running"?_e.warning:"inherit";return m.jsxs("div",{style:{...cu,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[m.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[m.jsxs("div",{style:{flex:1},children:[m.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),m.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),m.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:u?_e.success:_e.warning},children:["Expected: ",n]})]}),m.jsx(ke,{onClick:a,disabled:l,variant:"secondary",style:{flexShrink:0},children:i?.status==="running"?"":"Run"})]}),i&&i.status!=="pending"&&m.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${d} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${d} 30%, transparent)`,fontSize:"0.85rem",color:d},children:i.message})]})}function M4(){const{selectedBudgetId:t,currentUserId:e,accessibleBudgets:n,loadAccessibleBudgets:i,switchToBudget:a,checkBudgetInvite:l,isInitialized:u}=wn(),{budget:d,renameBudget:f,acceptInvite:g,isLoading:_}=Kn(t,e),[v,E]=O.useState(null),[T,w]=O.useState(null),[I,N]=O.useState(null),[U,G]=O.useState(null),[z,$]=O.useState(null),[J,te]=O.useState(""),[j,A]=O.useState(!1),[R,D]=O.useState(""),[C,L]=O.useState(!1),[k,ee]=O.useState(null);async function H(re){if(re!==d?.id){E(re),N(null),G(null);try{await a(re),G("Switched to budget successfully!"),await i()}catch(ae){N(ae instanceof Error?ae.message:"Failed to switch budget")}finally{E(null)}}}async function B(re){w(re),N(null),G(null);try{await g(re),G("Invitation accepted! You now have access to this budget."),await i()}catch(ae){N(ae instanceof Error?ae.message:"Failed to accept invitation")}finally{w(null)}}async function q(re){if(re.preventDefault(),!!R.trim()){L(!0),N(null),ee(null);try{const ae=await l(R.trim());ae?ee(ae):N("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(ae){N(ae instanceof Error?ae.message:"Failed to check invitation")}finally{L(!1)}}}async function F(){if(k){w(k.budgetId),N(null);try{await g(k.budgetId),G(`Successfully joined "${k.budgetName}"!`),ee(null),D(""),await i()}catch(re){N(re instanceof Error?re.message:"Failed to accept invitation")}finally{w(null)}}}function Q(re,ae){te(ae),$(re)}function W(){$(null),te("")}async function P(re){if(re.preventDefault(),!(!J.trim()||!z)){A(!0),N(null),G(null);try{await f(J.trim()),G("Budget renamed successfully!"),$(null),await i()}catch(ae){N(ae instanceof Error?ae.message:"Failed to rename budget")}finally{A(!1)}}}const X=n.filter(re=>!re.isPending),he=n.filter(re=>re.isPending);return _||!u?m.jsx("p",{children:"Loading your budgets..."}):m.jsxs("div",{children:[m.jsx("h2",{style:{marginTop:0},children:"My Budgets"}),m.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Manage your budgets, switch between them, and accept new invitations."}),I&&m.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsx("span",{children:I}),m.jsx("button",{onClick:()=>N(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),U&&m.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m.jsx("span",{children:U}),m.jsx("button",{onClick:()=>G(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),he.length>0&&m.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[m.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[m.jsx("span",{children:""})," Pending Invitations (",he.length,")"]}),m.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:he.map(re=>m.jsx(hS,{budget:re,isCurrent:!1,isAccepting:T===re.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>B(re.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},re.id))})]}),m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[m.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[m.jsx("span",{children:""})," Your Budgets (",X.length,")"]}),X.length===0?m.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):m.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:X.map(re=>{const ae=re.id===d?.id,ve=z===re.id;return m.jsx(hS,{budget:re,isCurrent:ae,isAccepting:!1,isSwitching:v===re.id,isEditing:ve,editName:ve?J:"",isRenaming:j,onAccept:()=>{},onSwitch:()=>H(re.id),onStartEdit:()=>Q(re.id,re.name),onCancelEdit:W,onEditNameChange:te,onSaveEdit:P},re.id)})})]}),m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[m.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[m.jsx("span",{children:""})," Join Budget by ID"]}),m.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),k?m.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[m.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),m.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[m.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:k.budgetName}),k.ownerEmail&&m.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",k.ownerEmail]})]}),m.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[m.jsx("button",{onClick:F,disabled:T===k.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:T===k.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:T===k.budgetId?.7:1},children:T===k.budgetId?"Accepting...":"Accept Invitation"}),m.jsx("button",{onClick:()=>{ee(null),D("")},disabled:T===k.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:T===k.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:T===k.budgetId?.7:.8},children:"Cancel"})]})]}):m.jsxs("form",{onSubmit:q,style:{display:"flex",gap:"0.75rem"},children:[m.jsx("input",{type:"text",value:R,onChange:re=>D(re.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),m.jsx("button",{type:"submit",disabled:C||!R.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:C||!R.trim()?"not-allowed":"pointer",fontWeight:500,opacity:C||!R.trim()?.7:1,whiteSpace:"nowrap"},children:C?"Checking...":"Check Invite"})]})]}),e&&m.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[m.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),m.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:e})]})]})}function k4({children:t}){const e=O.useContext(Wc),n=hr();return e.is_auth_checked?e.is_logged_in?t?m.jsx(m.Fragment,{children:t}):m.jsx(Cg,{}):m.jsx(RS,{to:"/account",state:{from:n.pathname},replace:!0}):m.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:m.jsx("p",{children:"Loading..."})})}function N4(){const{selectedBudgetId:t,currentUserId:e,isInitialized:n}=wn(),{isLoading:i,error:a}=Kn(t,e);return n?a?(console.error("[BudgetLayout] Error:",a),m.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:m.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",a.message]})})):m.jsx("div",{style:{paddingBottom:"5rem"},children:m.jsx(Cg,{})}):m.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[m.jsx("p",{children:"Loading budget..."}),i&&m.jsx("p",{style:{opacity:.6},children:"Fetching data from server..."})]})}const P4={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function V4(){const[t,e]=O.useState(P4),n=La(),i=O.useRef(!1);return O.useEffect(function(){i.current||(i.current=!0,n.set_user_listener(a=>{e({is_logged_in:a!=null,is_auth_checked:!0,username:a?.email??"",set_user_context:e})}))},[n]),t.is_auth_checked?m.jsx(Wc.Provider,{value:t,children:m.jsx(ZR,{children:m.jsx(uN,{children:m.jsxs(GC,{children:[m.jsxs(bC,{children:[m.jsx(un,{path:"/",element:m.jsx(dN,{})}),m.jsx(un,{path:"/account",element:m.jsx(fN,{})}),m.jsx(un,{path:"/sql-test",element:m.jsx(hN,{})}),m.jsx(un,{path:"/budget",element:m.jsx(k4,{}),children:m.jsxs(un,{element:m.jsx(N4,{}),children:[m.jsx(un,{index:!0,element:m.jsx(uS,{})}),m.jsx(un,{path:":year/:month/:tab",element:m.jsx(uS,{})}),m.jsx(un,{path:"analytics",element:m.jsx(h4,{})}),m.jsxs(un,{path:"admin",element:m.jsx(x4,{}),children:[m.jsx(un,{path:"my-budgets",element:m.jsx(M4,{})}),m.jsx(un,{path:"accounts",element:m.jsx(v4,{})}),m.jsx(un,{path:"categories",element:m.jsx(S4,{})}),m.jsx(un,{path:"users",element:m.jsx(w4,{})}),m.jsx(un,{path:"migration",element:m.jsx(I4,{})}),m.jsx(un,{path:"feedback",element:m.jsx(O4,{})}),m.jsx(un,{path:"tests",element:m.jsx(j4,{})})]})]})})]}),m.jsx(KN,{})]})})})}):m.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:m.jsx("p",{children:"Loading..."})})}bA.createRoot(document.getElementById("root")).render(m.jsx(O.StrictMode,{children:m.jsx(V4,{})}));
