(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=n(o);fetch(o.href,c)}})();var Um={exports:{}},yc={};var cv;function Fw(){if(cv)return yc;cv=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(s,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var g in o)g!=="key"&&(c[g]=o[g])}else c=o;return o=c.ref,{$$typeof:i,type:s,key:d,ref:o!==void 0?o:null,props:c}}return yc.Fragment=e,yc.jsx=n,yc.jsxs=n,yc}var uv;function Hw(){return uv||(uv=1,Um.exports=Fw()),Um.exports}var f=Hw(),Bm={exports:{}},ct={};var dv;function qw(){if(dv)return ct;dv=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),x=Symbol.iterator;function D(V){return V===null||typeof V!="object"?null:(V=x&&V[x]||V["@@iterator"],typeof V=="function"?V:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,M={};function G(V,P,Q){this.props=V,this.context=P,this.refs=M,this.updater=Q||k}G.prototype.isReactComponent={},G.prototype.setState=function(V,P){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,P,"setState")},G.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function q(){}q.prototype=G.prototype;function ee(V,P,Q){this.props=V,this.context=P,this.refs=M,this.updater=Q||k}var Ce=ee.prototype=new q;Ce.constructor=ee,O(Ce,G.prototype),Ce.isPureReactComponent=!0;var Me=Array.isArray;function Se(){}var R={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function I(V,P,Q){var X=Q.ref;return{$$typeof:i,type:V,key:P,ref:X!==void 0?X:null,props:Q}}function L(V,P){return I(V.type,P,V.props)}function N(V){return typeof V=="object"&&V!==null&&V.$$typeof===i}function B(V){var P={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(Q){return P[Q]})}var j=/\/+/g;function Fe(V,P){return typeof V=="object"&&V!==null&&V.key!=null?B(""+V.key):P.toString(36)}function dt(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(Se,Se):(V.status="pending",V.then(function(P){V.status==="pending"&&(V.status="fulfilled",V.value=P)},function(P){V.status==="pending"&&(V.status="rejected",V.reason=P)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function se(V,P,Q,X,ne){var we=typeof V;(we==="undefined"||we==="boolean")&&(V=null);var ke=!1;if(V===null)ke=!0;else switch(we){case"bigint":case"string":case"number":ke=!0;break;case"object":switch(V.$$typeof){case i:case e:ke=!0;break;case b:return ke=V._init,se(ke(V._payload),P,Q,X,ne)}}if(ke)return ne=ne(V),ke=X===""?"."+Fe(V,0):X,Me(ne)?(Q="",ke!=null&&(Q=ke.replace(j,"$&/")+"/"),se(ne,P,Q,"",function(Ut){return Ut})):ne!=null&&(N(ne)&&(ne=L(ne,Q+(ne.key==null||V&&V.key===ne.key?"":(""+ne.key).replace(j,"$&/")+"/")+ke)),P.push(ne)),1;ke=0;var Qe=X===""?".":X+":";if(Me(V))for(var lt=0;lt<V.length;lt++)X=V[lt],we=Qe+Fe(X,lt),ke+=se(X,P,Q,we,ne);else if(lt=D(V),typeof lt=="function")for(V=lt.call(V),lt=0;!(X=V.next()).done;)X=X.value,we=Qe+Fe(X,lt++),ke+=se(X,P,Q,we,ne);else if(we==="object"){if(typeof V.then=="function")return se(dt(V),P,Q,X,ne);throw P=String(V),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.")}return ke}function $(V,P,Q){if(V==null)return V;var X=[],ne=0;return se(V,X,"","",function(we){return P.call(Q,we,ne++)}),X}function Ie(V){if(V._status===-1){var P=V._result;P=P(),P.then(function(Q){(V._status===0||V._status===-1)&&(V._status=1,V._result=Q)},function(Q){(V._status===0||V._status===-1)&&(V._status=2,V._result=Q)}),V._status===-1&&(V._status=0,V._result=P)}if(V._status===1)return V._result.default;throw V._result}var Ue=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var P=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(P))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},st={map:$,forEach:function(V,P,Q){$(V,function(){P.apply(this,arguments)},Q)},count:function(V){var P=0;return $(V,function(){P++}),P},toArray:function(V){return $(V,function(P){return P})||[]},only:function(V){if(!N(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return ct.Activity=S,ct.Children=st,ct.Component=G,ct.Fragment=n,ct.Profiler=o,ct.PureComponent=ee,ct.StrictMode=s,ct.Suspense=p,ct.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,ct.__COMPILER_RUNTIME={__proto__:null,c:function(V){return R.H.useMemoCache(V)}},ct.cache=function(V){return function(){return V.apply(null,arguments)}},ct.cacheSignal=function(){return null},ct.cloneElement=function(V,P,Q){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var X=O({},V.props),ne=V.key;if(P!=null)for(we in P.key!==void 0&&(ne=""+P.key),P)!C.call(P,we)||we==="key"||we==="__self"||we==="__source"||we==="ref"&&P.ref===void 0||(X[we]=P[we]);var we=arguments.length-2;if(we===1)X.children=Q;else if(1<we){for(var ke=Array(we),Qe=0;Qe<we;Qe++)ke[Qe]=arguments[Qe+2];X.children=ke}return I(V.type,ne,X)},ct.createContext=function(V){return V={$$typeof:d,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:c,_context:V},V},ct.createElement=function(V,P,Q){var X,ne={},we=null;if(P!=null)for(X in P.key!==void 0&&(we=""+P.key),P)C.call(P,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(ne[X]=P[X]);var ke=arguments.length-2;if(ke===1)ne.children=Q;else if(1<ke){for(var Qe=Array(ke),lt=0;lt<ke;lt++)Qe[lt]=arguments[lt+2];ne.children=Qe}if(V&&V.defaultProps)for(X in ke=V.defaultProps,ke)ne[X]===void 0&&(ne[X]=ke[X]);return I(V,we,ne)},ct.createRef=function(){return{current:null}},ct.forwardRef=function(V){return{$$typeof:g,render:V}},ct.isValidElement=N,ct.lazy=function(V){return{$$typeof:b,_payload:{_status:-1,_result:V},_init:Ie}},ct.memo=function(V,P){return{$$typeof:y,type:V,compare:P===void 0?null:P}},ct.startTransition=function(V){var P=R.T,Q={};R.T=Q;try{var X=V(),ne=R.S;ne!==null&&ne(Q,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(Se,Ue)}catch(we){Ue(we)}finally{P!==null&&Q.types!==null&&(P.types=Q.types),R.T=P}},ct.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},ct.use=function(V){return R.H.use(V)},ct.useActionState=function(V,P,Q){return R.H.useActionState(V,P,Q)},ct.useCallback=function(V,P){return R.H.useCallback(V,P)},ct.useContext=function(V){return R.H.useContext(V)},ct.useDebugValue=function(){},ct.useDeferredValue=function(V,P){return R.H.useDeferredValue(V,P)},ct.useEffect=function(V,P){return R.H.useEffect(V,P)},ct.useEffectEvent=function(V){return R.H.useEffectEvent(V)},ct.useId=function(){return R.H.useId()},ct.useImperativeHandle=function(V,P,Q){return R.H.useImperativeHandle(V,P,Q)},ct.useInsertionEffect=function(V,P){return R.H.useInsertionEffect(V,P)},ct.useLayoutEffect=function(V,P){return R.H.useLayoutEffect(V,P)},ct.useMemo=function(V,P){return R.H.useMemo(V,P)},ct.useOptimistic=function(V,P){return R.H.useOptimistic(V,P)},ct.useReducer=function(V,P,Q){return R.H.useReducer(V,P,Q)},ct.useRef=function(V){return R.H.useRef(V)},ct.useState=function(V){return R.H.useState(V)},ct.useSyncExternalStore=function(V,P,Q){return R.H.useSyncExternalStore(V,P,Q)},ct.useTransition=function(){return R.H.useTransition()},ct.version="19.2.3",ct}var hv;function zg(){return hv||(hv=1,Bm.exports=qw()),Bm.exports}var A=zg(),Fm={exports:{}},_c={},Hm={exports:{}},qm={};var fv;function Gw(){return fv||(fv=1,(function(i){function e(se,$){var Ie=se.length;se.push($);e:for(;0<Ie;){var Ue=Ie-1>>>1,st=se[Ue];if(0<o(st,$))se[Ue]=$,se[Ie]=st,Ie=Ue;else break e}}function n(se){return se.length===0?null:se[0]}function s(se){if(se.length===0)return null;var $=se[0],Ie=se.pop();if(Ie!==$){se[0]=Ie;e:for(var Ue=0,st=se.length,V=st>>>1;Ue<V;){var P=2*(Ue+1)-1,Q=se[P],X=P+1,ne=se[X];if(0>o(Q,Ie))X<st&&0>o(ne,Q)?(se[Ue]=ne,se[X]=Ie,Ue=X):(se[Ue]=Q,se[P]=Ie,Ue=P);else if(X<st&&0>o(ne,Ie))se[Ue]=ne,se[X]=Ie,Ue=X;else break e}}return $}function o(se,$){var Ie=se.sortIndex-$.sortIndex;return Ie!==0?Ie:se.id-$.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;i.unstable_now=function(){return c.now()}}else{var d=Date,g=d.now();i.unstable_now=function(){return d.now()-g}}var p=[],y=[],b=1,S=null,x=3,D=!1,k=!1,O=!1,M=!1,G=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;function Ce(se){for(var $=n(y);$!==null;){if($.callback===null)s(y);else if($.startTime<=se)s(y),$.sortIndex=$.expirationTime,e(p,$);else break;$=n(y)}}function Me(se){if(O=!1,Ce(se),!k)if(n(p)!==null)k=!0,Se||(Se=!0,B());else{var $=n(y);$!==null&&dt(Me,$.startTime-se)}}var Se=!1,R=-1,C=5,I=-1;function L(){return M?!0:!(i.unstable_now()-I<C)}function N(){if(M=!1,Se){var se=i.unstable_now();I=se;var $=!0;try{e:{k=!1,O&&(O=!1,q(R),R=-1),D=!0;var Ie=x;try{t:{for(Ce(se),S=n(p);S!==null&&!(S.expirationTime>se&&L());){var Ue=S.callback;if(typeof Ue=="function"){S.callback=null,x=S.priorityLevel;var st=Ue(S.expirationTime<=se);if(se=i.unstable_now(),typeof st=="function"){S.callback=st,Ce(se),$=!0;break t}S===n(p)&&s(p),Ce(se)}else s(p);S=n(p)}if(S!==null)$=!0;else{var V=n(y);V!==null&&dt(Me,V.startTime-se),$=!1}}break e}finally{S=null,x=Ie,D=!1}$=void 0}}finally{$?B():Se=!1}}}var B;if(typeof ee=="function")B=function(){ee(N)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,Fe=j.port2;j.port1.onmessage=N,B=function(){Fe.postMessage(null)}}else B=function(){G(N,0)};function dt(se,$){R=G(function(){se(i.unstable_now())},$)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(se){se.callback=null},i.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<se?Math.floor(1e3/se):5},i.unstable_getCurrentPriorityLevel=function(){return x},i.unstable_next=function(se){switch(x){case 1:case 2:case 3:var $=3;break;default:$=x}var Ie=x;x=$;try{return se()}finally{x=Ie}},i.unstable_requestPaint=function(){M=!0},i.unstable_runWithPriority=function(se,$){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var Ie=x;x=se;try{return $()}finally{x=Ie}},i.unstable_scheduleCallback=function(se,$,Ie){var Ue=i.unstable_now();switch(typeof Ie=="object"&&Ie!==null?(Ie=Ie.delay,Ie=typeof Ie=="number"&&0<Ie?Ue+Ie:Ue):Ie=Ue,se){case 1:var st=-1;break;case 2:st=250;break;case 5:st=1073741823;break;case 4:st=1e4;break;default:st=5e3}return st=Ie+st,se={id:b++,callback:$,priorityLevel:se,startTime:Ie,expirationTime:st,sortIndex:-1},Ie>Ue?(se.sortIndex=Ie,e(y,se),n(p)===null&&se===n(y)&&(O?(q(R),R=-1):O=!0,dt(Me,Ie-Ue))):(se.sortIndex=st,e(p,se),k||D||(k=!0,Se||(Se=!0,B()))),se},i.unstable_shouldYield=L,i.unstable_wrapCallback=function(se){var $=x;return function(){var Ie=x;x=$;try{return se.apply(this,arguments)}finally{x=Ie}}}})(qm)),qm}var mv;function $w(){return mv||(mv=1,Hm.exports=Gw()),Hm.exports}var Gm={exports:{}},nr={};var gv;function Yw(){if(gv)return nr;gv=1;var i=zg();function e(p){var y="https://react.dev/errors/"+p;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)y+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+p+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,y,b){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:S==null?null:""+S,children:p,containerInfo:y,implementation:b}}var d=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,y){if(p==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return nr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,nr.createPortal=function(p,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return c(p,y,null,b)},nr.flushSync=function(p){var y=d.T,b=s.p;try{if(d.T=null,s.p=2,p)return p()}finally{d.T=y,s.p=b,s.d.f()}},nr.preconnect=function(p,y){typeof p=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,s.d.C(p,y))},nr.prefetchDNS=function(p){typeof p=="string"&&s.d.D(p)},nr.preinit=function(p,y){if(typeof p=="string"&&y&&typeof y.as=="string"){var b=y.as,S=g(b,y.crossOrigin),x=typeof y.integrity=="string"?y.integrity:void 0,D=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;b==="style"?s.d.S(p,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:S,integrity:x,fetchPriority:D}):b==="script"&&s.d.X(p,{crossOrigin:S,integrity:x,fetchPriority:D,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},nr.preinitModule=function(p,y){if(typeof p=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var b=g(y.as,y.crossOrigin);s.d.M(p,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&s.d.M(p)},nr.preload=function(p,y){if(typeof p=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var b=y.as,S=g(b,y.crossOrigin);s.d.L(p,b,{crossOrigin:S,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},nr.preloadModule=function(p,y){if(typeof p=="string")if(y){var b=g(y.as,y.crossOrigin);s.d.m(p,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else s.d.m(p)},nr.requestFormReset=function(p){s.d.r(p)},nr.unstable_batchedUpdates=function(p,y){return p(y)},nr.useFormState=function(p,y,b){return d.H.useFormState(p,y,b)},nr.useFormStatus=function(){return d.H.useHostTransitionStatus()},nr.version="19.2.3",nr}var pv;function Qw(){if(pv)return Gm.exports;pv=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Gm.exports=Yw(),Gm.exports}var yv;function Kw(){if(yv)return _c;yv=1;var i=$w(),e=zg(),n=Qw();function s(t){var r="https://react.dev/errors/"+t;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function c(t){var r=t,a=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(a=r.return),t=r.return;while(t)}return r.tag===3?a:null}function d(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function g(t){if(t.tag===31){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function p(t){if(c(t)!==t)throw Error(s(188))}function y(t){var r=t.alternate;if(!r){if(r=c(t),r===null)throw Error(s(188));return r!==t?null:t}for(var a=t,l=r;;){var h=a.return;if(h===null)break;var m=h.alternate;if(m===null){if(l=h.return,l!==null){a=l;continue}break}if(h.child===m.child){for(m=h.child;m;){if(m===a)return p(h),t;if(m===l)return p(h),r;m=m.sibling}throw Error(s(188))}if(a.return!==l.return)a=h,l=m;else{for(var v=!1,T=h.child;T;){if(T===a){v=!0,a=h,l=m;break}if(T===l){v=!0,l=h,a=m;break}T=T.sibling}if(!v){for(T=m.child;T;){if(T===a){v=!0,a=m,l=h;break}if(T===l){v=!0,l=m,a=h;break}T=T.sibling}if(!v)throw Error(s(189))}}if(a.alternate!==l)throw Error(s(190))}if(a.tag!==3)throw Error(s(188));return a.stateNode.current===a?t:r}function b(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t;for(t=t.child;t!==null;){if(r=b(t),r!==null)return r;t=t.sibling}return null}var S=Object.assign,x=Symbol.for("react.element"),D=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),q=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),Ce=Symbol.for("react.forward_ref"),Me=Symbol.for("react.suspense"),Se=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),N=Symbol.iterator;function B(t){return t===null||typeof t!="object"?null:(t=N&&t[N]||t["@@iterator"],typeof t=="function"?t:null)}var j=Symbol.for("react.client.reference");function Fe(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===j?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case O:return"Fragment";case G:return"Profiler";case M:return"StrictMode";case Me:return"Suspense";case Se:return"SuspenseList";case I:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case k:return"Portal";case ee:return t.displayName||"Context";case q:return(t._context.displayName||"Context")+".Consumer";case Ce:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case R:return r=t.displayName||null,r!==null?r:Fe(t.type)||"Memo";case C:r=t._payload,t=t._init;try{return Fe(t(r))}catch{}}return null}var dt=Array.isArray,se=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ie={pending:!1,data:null,method:null,action:null},Ue=[],st=-1;function V(t){return{current:t}}function P(t){0>st||(t.current=Ue[st],Ue[st]=null,st--)}function Q(t,r){st++,Ue[st]=t.current,t.current=r}var X=V(null),ne=V(null),we=V(null),ke=V(null);function Qe(t,r){switch(Q(we,r),Q(ne,t),Q(X,null),r.nodeType){case 9:case 11:t=(t=r.documentElement)&&(t=t.namespaceURI)?j0(t):0;break;default:if(t=r.tagName,r=r.namespaceURI)r=j0(r),t=M0(r,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}P(X),Q(X,t)}function lt(){P(X),P(ne),P(we)}function Ut(t){t.memoizedState!==null&&Q(ke,t);var r=X.current,a=M0(r,t.type);r!==a&&(Q(ne,t),Q(X,a))}function bn(t){ne.current===t&&(P(X),P(ne)),ke.current===t&&(P(ke),fc._currentValue=Ie)}var Jt,Nn;function mn(t){if(Jt===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);Jt=r&&r[1]||"",Nn=-1<a.stack.indexOf(`
    at`)?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Jt+t+Nn}var Gn=!1;function kt(t,r){if(!t||Gn)return"";Gn=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(r){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(oe){var re=oe}Reflect.construct(t,[],ye)}else{try{ye.call()}catch(oe){re=oe}t.call(ye.prototype)}}else{try{throw Error()}catch(oe){re=oe}(ye=t())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(oe){if(oe&&re&&typeof oe.stack=="string")return[oe.stack,re.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=l.DetermineComponentFrameRoot(),v=m[0],T=m[1];if(v&&T){var U=v.split(`
`),Z=T.split(`
`);for(h=l=0;l<U.length&&!U[l].includes("DetermineComponentFrameRoot");)l++;for(;h<Z.length&&!Z[h].includes("DetermineComponentFrameRoot");)h++;if(l===U.length||h===Z.length)for(l=U.length-1,h=Z.length-1;1<=l&&0<=h&&U[l]!==Z[h];)h--;for(;1<=l&&0<=h;l--,h--)if(U[l]!==Z[h]){if(l!==1||h!==1)do if(l--,h--,0>h||U[l]!==Z[h]){var he=`
`+U[l].replace(" at new "," at ");return t.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",t.displayName)),he}while(1<=l&&0<=h);break}}}finally{Gn=!1,Error.prepareStackTrace=a}return(a=t?t.displayName||t.name:"")?mn(a):""}function Zt(t,r){switch(t.tag){case 26:case 27:case 5:return mn(t.type);case 16:return mn("Lazy");case 13:return t.child!==r&&r!==null?mn("Suspense Fallback"):mn("Suspense");case 19:return mn("SuspenseList");case 0:case 15:return kt(t.type,!1);case 11:return kt(t.type.render,!1);case 1:return kt(t.type,!0);case 31:return mn("Activity");default:return""}}function tt(t){try{var r="",a=null;do r+=Zt(t,a),a=t,t=t.return;while(t);return r}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var F=Object.prototype.hasOwnProperty,fe=i.unstable_scheduleCallback,z=i.unstable_cancelCallback,K=i.unstable_shouldYield,te=i.unstable_requestPaint,ue=i.unstable_now,Ae=i.unstable_getCurrentPriorityLevel,pe=i.unstable_ImmediatePriority,ve=i.unstable_UserBlockingPriority,Te=i.unstable_NormalPriority,Le=i.unstable_LowPriority,Re=i.unstable_IdlePriority,at=i.log,St=i.unstable_setDisableYieldValue,Ve=null,Xe=null;function gn(t){if(typeof at=="function"&&St(t),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(Ve,t)}catch{}}var Bt=Math.clz32?Math.clz32:ki,Wr=Math.log,Xr=Math.LN2;function ki(t){return t>>>=0,t===0?32:31-(Wr(t)/Xr|0)|0}var zn=256,En=262144,en=4194304;function $n(t){var r=t&42;if(r!==0)return r;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function or(t,r,a){var l=t.pendingLanes;if(l===0)return 0;var h=0,m=t.suspendedLanes,v=t.pingedLanes;t=t.warmLanes;var T=l&134217727;return T!==0?(l=T&~m,l!==0?h=$n(l):(v&=T,v!==0?h=$n(v):a||(a=T&~t,a!==0&&(h=$n(a))))):(T=l&~m,T!==0?h=$n(T):v!==0?h=$n(v):a||(a=l&~t,a!==0&&(h=$n(a)))),h===0?0:r!==0&&r!==h&&(r&m)===0&&(m=h&-h,a=r&-r,m>=a||m===32&&(a&4194048)!==0)?r:h}function lr(t,r){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&r)===0}function ge(t,r){switch(t){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ne(){var t=en;return en<<=1,(en&62914560)===0&&(en=4194304),t}function $e(t){for(var r=[],a=0;31>a;a++)r.push(t);return r}function We(t,r){t.pendingLanes|=r,r!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Pt(t,r,a,l,h,m){var v=t.pendingLanes;t.pendingLanes=a,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=a,t.entangledLanes&=a,t.errorRecoveryDisabledLanes&=a,t.shellSuspendCounter=0;var T=t.entanglements,U=t.expirationTimes,Z=t.hiddenUpdates;for(a=v&~a;0<a;){var he=31-Bt(a),ye=1<<he;T[he]=0,U[he]=-1;var re=Z[he];if(re!==null)for(Z[he]=null,he=0;he<re.length;he++){var oe=re[he];oe!==null&&(oe.lane&=-536870913)}a&=~ye}l!==0&&pn(t,l,0),m!==0&&h===0&&t.tag!==0&&(t.suspendedLanes|=m&~(v&~r))}function pn(t,r,a){t.pendingLanes|=r,t.suspendedLanes&=~r;var l=31-Bt(r);t.entangledLanes|=r,t.entanglements[l]=t.entanglements[l]|1073741824|a&261930}function fi(t,r){var a=t.entangledLanes|=r;for(t=t.entanglements;a;){var l=31-Bt(a),h=1<<l;h&r|t[l]&r&&(t[l]|=r),a&=~h}}function ya(t,r){var a=r&-r;return a=(a&42)!==0?1:Ni(a),(a&(t.suspendedLanes|r))!==0?0:a}function Ni(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Jr(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function fs(){var t=$.p;return t!==0?t:(t=window.event,t===void 0?32:nv(t.type))}function Sr(t,r){var a=$.p;try{return $.p=t,r()}finally{$.p=a}}var Tr=Math.random().toString(36).slice(2),yn="__reactFiber$"+Tr,Cn="__reactProps$"+Tr,kr="__reactContainer$"+Tr,ms="__reactEvents$"+Tr,le="__reactListeners$"+Tr,ie="__reactHandles$"+Tr,de="__reactResources$"+Tr,ce="__reactMarker$"+Tr;function De(t){delete t[yn],delete t[Cn],delete t[ms],delete t[le],delete t[ie]}function xe(t){var r=t[yn];if(r)return r;for(var a=t.parentNode;a;){if(r=a[kr]||a[yn]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(t=U0(t);t!==null;){if(a=t[yn])return a;t=U0(t)}return r}t=a,a=t.parentNode}return null}function Oe(t){if(t=t[yn]||t[kr]){var r=t.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return t}return null}function Be(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t.stateNode;throw Error(s(33))}function Pe(t){var r=t[de];return r||(r=t[de]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Ge(t){t[ce]=!0}var et=new Set,ft={};function _t(t,r){nn(t,r),nn(t+"Capture",r)}function nn(t,r){for(ft[t]=r,t=0;t<r.length;t++)et.add(r[t])}var Un=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),on={},Nt={};function Vn(t){return F.call(Nt,t)?!0:F.call(on,t)?!1:Un.test(t)?Nt[t]=!0:(on[t]=!0,!1)}function Ft(t,r,a){if(Vn(r))if(a===null)t.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":t.removeAttribute(r);return;case"boolean":var l=r.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){t.removeAttribute(r);return}}t.setAttribute(r,""+a)}}function Ot(t,r,a){if(a===null)t.removeAttribute(r);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttribute(r,""+a)}}function Wt(t,r,a,l){if(l===null)t.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttributeNS(r,a,""+l)}}function dn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function xr(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function gs(t,r,a){var l=Object.getOwnPropertyDescriptor(t.constructor.prototype,r);if(!t.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var h=l.get,m=l.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return h.call(this)},set:function(v){a=""+v,m.call(this,v)}}),Object.defineProperty(t,r,{enumerable:l.enumerable}),{getValue:function(){return a},setValue:function(v){a=""+v},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function Rt(t){if(!t._valueTracker){var r=xr(t)?"checked":"value";t._valueTracker=gs(t,r,""+t[r])}}function Zr(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var a=r.getValue(),l="";return t&&(l=xr(t)?t.checked?"true":"false":t.value),t=l,t!==a?(r.setValue(t),!0):!1}function mi(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var _a=/[\n"\\]/g;function hr(t){return t.replace(_a,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function ro(t,r,a,l,h,m,v,T){t.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?t.type=v:t.removeAttribute("type"),r!=null?v==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+dn(r)):t.value!==""+dn(r)&&(t.value=""+dn(r)):v!=="submit"&&v!=="reset"||t.removeAttribute("value"),r!=null?Al(t,v,dn(r)):a!=null?Al(t,v,dn(a)):l!=null&&t.removeAttribute("value"),h==null&&m!=null&&(t.defaultChecked=!!m),h!=null&&(t.checked=h&&typeof h!="function"&&typeof h!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?t.name=""+dn(T):t.removeAttribute("name")}function ou(t,r,a,l,h,m,v,T){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(t.type=m),r!=null||a!=null){if(!(m!=="submit"&&m!=="reset"||r!=null)){Rt(t);return}a=a!=null?""+dn(a):"",r=r!=null?""+dn(r):a,T||r===t.value||(t.value=r),t.defaultValue=r}l=l??h,l=typeof l!="function"&&typeof l!="symbol"&&!!l,t.checked=T?t.checked:!!l,t.defaultChecked=!!l,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(t.name=v),Rt(t)}function Al(t,r,a){r==="number"&&mi(t.ownerDocument)===t||t.defaultValue===""+a||(t.defaultValue=""+a)}function ps(t,r,a,l){if(t=t.options,r){r={};for(var h=0;h<a.length;h++)r["$"+a[h]]=!0;for(a=0;a<t.length;a++)h=r.hasOwnProperty("$"+t[a].value),t[a].selected!==h&&(t[a].selected=h),h&&l&&(t[a].defaultSelected=!0)}else{for(a=""+dn(a),r=null,h=0;h<t.length;h++){if(t[h].value===a){t[h].selected=!0,l&&(t[h].defaultSelected=!0);return}r!==null||t[h].disabled||(r=t[h])}r!==null&&(r.selected=!0)}}function lu(t,r,a){if(r!=null&&(r=""+dn(r),r!==t.value&&(t.value=r),a==null)){t.defaultValue!==r&&(t.defaultValue=r);return}t.defaultValue=a!=null?""+dn(a):""}function ys(t,r,a,l){if(r==null){if(l!=null){if(a!=null)throw Error(s(92));if(dt(l)){if(1<l.length)throw Error(s(93));l=l[0]}a=l}a==null&&(a=""),r=a}a=dn(r),t.defaultValue=a,l=t.textContent,l===a&&l!==""&&l!==null&&(t.value=l),Rt(t)}function fr(t,r){if(r){var a=t.firstChild;if(a&&a===t.lastChild&&a.nodeType===3){a.nodeValue=r;return}}t.textContent=r}var cu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Cl(t,r,a){var l=r.indexOf("--")===0;a==null||typeof a=="boolean"||a===""?l?t.setProperty(r,""):r==="float"?t.cssFloat="":t[r]="":l?t.setProperty(r,a):typeof a!="number"||a===0||cu.has(r)?r==="float"?t.cssFloat=a:t[r]=(""+a).trim():t[r]=a+"px"}function Rl(t,r,a){if(r!=null&&typeof r!="object")throw Error(s(62));if(t=t.style,a!=null){for(var l in a)!a.hasOwnProperty(l)||r!=null&&r.hasOwnProperty(l)||(l.indexOf("--")===0?t.setProperty(l,""):l==="float"?t.cssFloat="":t[l]="");for(var h in r)l=r[h],r.hasOwnProperty(h)&&a[h]!==l&&Cl(t,h,l)}else for(var m in r)r.hasOwnProperty(m)&&Cl(t,m,r[m])}function io(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),_s=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function so(t){return _s.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function ei(){}var Il=null;function Nr(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vs=null,gi=null;function va(t){var r=Oe(t);if(r&&(t=r.stateNode)){var a=t[Cn]||null;e:switch(t=r.stateNode,r.type){case"input":if(ro(t,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),r=a.name,a.type==="radio"&&r!=null){for(a=t;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+hr(""+r)+'"][type="radio"]'),r=0;r<a.length;r++){var l=a[r];if(l!==t&&l.form===t.form){var h=l[Cn]||null;if(!h)throw Error(s(90));ro(l,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(r=0;r<a.length;r++)l=a[r],l.form===t.form&&Zr(l)}break e;case"textarea":lu(t,a.value,a.defaultValue);break e;case"select":r=a.value,r!=null&&ps(t,!!a.multiple,r,!1)}}}var ao=!1;function bs(t,r,a){if(ao)return t(r,a);ao=!0;try{var l=t(r);return l}finally{if(ao=!1,(vs!==null||gi!==null)&&(rd(),vs&&(r=vs,t=gi,gi=vs=null,va(r),t)))for(r=0;r<t.length;r++)va(t[r])}}function ti(t,r){var a=t.stateNode;if(a===null)return null;var l=a[Cn]||null;if(l===null)return null;a=l[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(t=t.type,l=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!l;break e;default:t=!1}if(t)return null;if(a&&typeof a!="function")throw Error(s(231,r,typeof a));return a}var Vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ba=!1;if(Vr)try{var Gt={};Object.defineProperty(Gt,"passive",{get:function(){ba=!0}}),window.addEventListener("test",Gt,Gt),window.removeEventListener("test",Gt,Gt)}catch{ba=!1}var pi=null,Dl=null,Ea=null;function Ol(){if(Ea)return Ea;var t,r=Dl,a=r.length,l,h="value"in pi?pi.value:pi.textContent,m=h.length;for(t=0;t<a&&r[t]===h[t];t++);var v=a-t;for(l=1;l<=v&&r[a-l]===h[m-l];l++);return Ea=h.slice(t,1<l?1-l:void 0)}function Sa(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function Vi(){return!0}function ni(){return!1}function Yn(t){function r(a,l,h,m,v){this._reactName=a,this._targetInst=h,this.type=l,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var T in t)t.hasOwnProperty(T)&&(a=t[T],this[T]=a?a(m):m[T]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Vi:ni,this.isPropagationStopped=ni,this}return S(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Vi)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Vi)},persist:function(){},isPersistent:Vi}),r}var Li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yi=Yn(Li),Es=S({},Li,{view:0,detail:0}),jl=Yn(Es),Ss,oo,_i,lo=S({},Es,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ts,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==_i&&(_i&&t.type==="mousemove"?(Ss=t.screenX-_i.screenX,oo=t.screenY-_i.screenY):oo=Ss=0,_i=t),Ss)},movementY:function(t){return"movementY"in t?t.movementY:oo}}),Ml=Yn(lo),Ta=S({},lo,{dataTransfer:0}),du=Yn(Ta),hu=S({},Es,{relatedTarget:0}),xa=Yn(hu),kl=S({},Li,{animationName:0,elapsedTime:0,pseudoElement:0}),fu=Yn(kl),co=S({},Li,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),mu=Yn(co),gu=S({},Li,{data:0}),vi=Yn(gu),pu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_u={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vu(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=_u[t])?!!r[t]:!1}function Ts(){return vu}var cr=S({},Es,{key:function(t){if(t.key){var r=pu[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=Sa(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?yu[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ts,charCode:function(t){return t.type==="keypress"?Sa(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Sa(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),bu=Yn(cr),Eu=S({},lo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pi=Yn(Eu),u=S({},Es,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ts}),_=Yn(u),E=S({},Li,{propertyName:0,elapsedTime:0,pseudoElement:0}),w=Yn(E),W=S({},lo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ae=Yn(W),je=S({},Li,{newState:0,oldState:0}),mt=Yn(je),Sn=[9,13,27,32],Vt=Vr&&"CompositionEvent"in window,ln=null;Vr&&"documentMode"in document&&(ln=document.documentMode);var Lr=Vr&&"TextEvent"in window&&!ln,bi=Vr&&(!Vt||ln&&8<ln&&11>=ln),ri=" ",ii=!1;function wa(t,r){switch(t){case"keyup":return Sn.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uo(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ho=!1;function hx(t,r){switch(t){case"compositionend":return uo(r);case"keypress":return r.which!==32?null:(ii=!0,ri);case"textInput":return t=r.data,t===ri&&ii?null:t;default:return null}}function fx(t,r){if(ho)return t==="compositionend"||!Vt&&wa(t,r)?(t=Ol(),Ea=Dl=pi=null,ho=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return bi&&r.locale!=="ko"?null:r.data;default:return null}}var mx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hp(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!mx[t.type]:r==="textarea"}function qp(t,r,a,l){vs?gi?gi.push(l):gi=[l]:vs=l,r=ud(r,"onChange"),0<r.length&&(a=new yi("onChange","change",null,a,l),t.push({event:a,listeners:r}))}var Nl=null,Vl=null;function gx(t){A0(t,0)}function Su(t){var r=Be(t);if(Zr(r))return t}function Gp(t,r){if(t==="change")return r}var $p=!1;if(Vr){var $h;if(Vr){var Yh="oninput"in document;if(!Yh){var Yp=document.createElement("div");Yp.setAttribute("oninput","return;"),Yh=typeof Yp.oninput=="function"}$h=Yh}else $h=!1;$p=$h&&(!document.documentMode||9<document.documentMode)}function Qp(){Nl&&(Nl.detachEvent("onpropertychange",Kp),Vl=Nl=null)}function Kp(t){if(t.propertyName==="value"&&Su(Vl)){var r=[];qp(r,Vl,t,Nr(t)),bs(gx,r)}}function px(t,r,a){t==="focusin"?(Qp(),Nl=r,Vl=a,Nl.attachEvent("onpropertychange",Kp)):t==="focusout"&&Qp()}function yx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Su(Vl)}function _x(t,r){if(t==="click")return Su(r)}function vx(t,r){if(t==="input"||t==="change")return Su(r)}function bx(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var wr=typeof Object.is=="function"?Object.is:bx;function Ll(t,r){if(wr(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var a=Object.keys(t),l=Object.keys(r);if(a.length!==l.length)return!1;for(l=0;l<a.length;l++){var h=a[l];if(!F.call(r,h)||!wr(t[h],r[h]))return!1}return!0}function Wp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Xp(t,r){var a=Wp(t);t=0;for(var l;a;){if(a.nodeType===3){if(l=t+a.textContent.length,t<=r&&l>=r)return{node:a,offset:r-t};t=l}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Wp(a)}}function Jp(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?Jp(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function Zp(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var r=mi(t.document);r instanceof t.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)t=r.contentWindow;else break;r=mi(t.document)}return r}function Qh(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}var Ex=Vr&&"documentMode"in document&&11>=document.documentMode,fo=null,Kh=null,Pl=null,Wh=!1;function ey(t,r,a){var l=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Wh||fo==null||fo!==mi(l)||(l=fo,"selectionStart"in l&&Qh(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Pl&&Ll(Pl,l)||(Pl=l,l=ud(Kh,"onSelect"),0<l.length&&(r=new yi("onSelect","select",null,r,a),t.push({event:r,listeners:l}),r.target=fo)))}function Aa(t,r){var a={};return a[t.toLowerCase()]=r.toLowerCase(),a["Webkit"+t]="webkit"+r,a["Moz"+t]="moz"+r,a}var mo={animationend:Aa("Animation","AnimationEnd"),animationiteration:Aa("Animation","AnimationIteration"),animationstart:Aa("Animation","AnimationStart"),transitionrun:Aa("Transition","TransitionRun"),transitionstart:Aa("Transition","TransitionStart"),transitioncancel:Aa("Transition","TransitionCancel"),transitionend:Aa("Transition","TransitionEnd")},Xh={},ty={};Vr&&(ty=document.createElement("div").style,"AnimationEvent"in window||(delete mo.animationend.animation,delete mo.animationiteration.animation,delete mo.animationstart.animation),"TransitionEvent"in window||delete mo.transitionend.transition);function Ca(t){if(Xh[t])return Xh[t];if(!mo[t])return t;var r=mo[t],a;for(a in r)if(r.hasOwnProperty(a)&&a in ty)return Xh[t]=r[a];return t}var ny=Ca("animationend"),ry=Ca("animationiteration"),iy=Ca("animationstart"),Sx=Ca("transitionrun"),Tx=Ca("transitionstart"),xx=Ca("transitioncancel"),sy=Ca("transitionend"),ay=new Map,Jh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Jh.push("scrollEnd");function si(t,r){ay.set(t,r),_t(r,[t])}var Tu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Pr=[],go=0,Zh=0;function xu(){for(var t=go,r=Zh=go=0;r<t;){var a=Pr[r];Pr[r++]=null;var l=Pr[r];Pr[r++]=null;var h=Pr[r];Pr[r++]=null;var m=Pr[r];if(Pr[r++]=null,l!==null&&h!==null){var v=l.pending;v===null?h.next=h:(h.next=v.next,v.next=h),l.pending=h}m!==0&&oy(a,h,m)}}function wu(t,r,a,l){Pr[go++]=t,Pr[go++]=r,Pr[go++]=a,Pr[go++]=l,Zh|=l,t.lanes|=l,t=t.alternate,t!==null&&(t.lanes|=l)}function ef(t,r,a,l){return wu(t,r,a,l),Au(t)}function Ra(t,r){return wu(t,null,null,r),Au(t)}function oy(t,r,a){t.lanes|=a;var l=t.alternate;l!==null&&(l.lanes|=a);for(var h=!1,m=t.return;m!==null;)m.childLanes|=a,l=m.alternate,l!==null&&(l.childLanes|=a),m.tag===22&&(t=m.stateNode,t===null||t._visibility&1||(h=!0)),t=m,m=m.return;return t.tag===3?(m=t.stateNode,h&&r!==null&&(h=31-Bt(a),t=m.hiddenUpdates,l=t[h],l===null?t[h]=[r]:l.push(r),r.lane=a|536870912),m):null}function Au(t){if(50<ac)throw ac=0,um=null,Error(s(185));for(var r=t.return;r!==null;)t=r,r=t.return;return t.tag===3?t.stateNode:null}var po={};function wx(t,r,a,l){this.tag=t,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ar(t,r,a,l){return new wx(t,r,a,l)}function tf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function zi(t,r){var a=t.alternate;return a===null?(a=Ar(t.tag,r,t.key,t.mode),a.elementType=t.elementType,a.type=t.type,a.stateNode=t.stateNode,a.alternate=t,t.alternate=a):(a.pendingProps=r,a.type=t.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=t.flags&65011712,a.childLanes=t.childLanes,a.lanes=t.lanes,a.child=t.child,a.memoizedProps=t.memoizedProps,a.memoizedState=t.memoizedState,a.updateQueue=t.updateQueue,r=t.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=t.sibling,a.index=t.index,a.ref=t.ref,a.refCleanup=t.refCleanup,a}function ly(t,r){t.flags&=65011714;var a=t.alternate;return a===null?(t.childLanes=0,t.lanes=r,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=a.childLanes,t.lanes=a.lanes,t.child=a.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=a.memoizedProps,t.memoizedState=a.memoizedState,t.updateQueue=a.updateQueue,t.type=a.type,r=a.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t}function Cu(t,r,a,l,h,m){var v=0;if(l=t,typeof t=="function")tf(t)&&(v=1);else if(typeof t=="string")v=Dw(t,a,X.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case I:return t=Ar(31,a,r,h),t.elementType=I,t.lanes=m,t;case O:return Ia(a.children,h,m,r);case M:v=8,h|=24;break;case G:return t=Ar(12,a,r,h|2),t.elementType=G,t.lanes=m,t;case Me:return t=Ar(13,a,r,h),t.elementType=Me,t.lanes=m,t;case Se:return t=Ar(19,a,r,h),t.elementType=Se,t.lanes=m,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ee:v=10;break e;case q:v=9;break e;case Ce:v=11;break e;case R:v=14;break e;case C:v=16,l=null;break e}v=29,a=Error(s(130,t===null?"null":typeof t,"")),l=null}return r=Ar(v,a,r,h),r.elementType=t,r.type=l,r.lanes=m,r}function Ia(t,r,a,l){return t=Ar(7,t,l,r),t.lanes=a,t}function nf(t,r,a){return t=Ar(6,t,null,r),t.lanes=a,t}function cy(t){var r=Ar(18,null,null,0);return r.stateNode=t,r}function rf(t,r,a){return r=Ar(4,t.children!==null?t.children:[],t.key,r),r.lanes=a,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}var uy=new WeakMap;function zr(t,r){if(typeof t=="object"&&t!==null){var a=uy.get(t);return a!==void 0?a:(r={value:t,source:r,stack:tt(r)},uy.set(t,r),r)}return{value:t,source:r,stack:tt(r)}}var yo=[],_o=0,Ru=null,zl=0,Ur=[],Br=0,xs=null,Ei=1,Si="";function Ui(t,r){yo[_o++]=zl,yo[_o++]=Ru,Ru=t,zl=r}function dy(t,r,a){Ur[Br++]=Ei,Ur[Br++]=Si,Ur[Br++]=xs,xs=t;var l=Ei;t=Si;var h=32-Bt(l)-1;l&=~(1<<h),a+=1;var m=32-Bt(r)+h;if(30<m){var v=h-h%5;m=(l&(1<<v)-1).toString(32),l>>=v,h-=v,Ei=1<<32-Bt(r)+h|a<<h|l,Si=m+t}else Ei=1<<m|a<<h|l,Si=t}function sf(t){t.return!==null&&(Ui(t,1),dy(t,1,0))}function af(t){for(;t===Ru;)Ru=yo[--_o],yo[_o]=null,zl=yo[--_o],yo[_o]=null;for(;t===xs;)xs=Ur[--Br],Ur[Br]=null,Si=Ur[--Br],Ur[Br]=null,Ei=Ur[--Br],Ur[Br]=null}function hy(t,r){Ur[Br++]=Ei,Ur[Br++]=Si,Ur[Br++]=xs,Ei=r.id,Si=r.overflow,xs=t}var Qn=null,rn=null,It=!1,ws=null,Fr=!1,of=Error(s(519));function As(t){var r=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ul(zr(r,t)),of}function fy(t){var r=t.stateNode,a=t.type,l=t.memoizedProps;switch(r[yn]=t,r[Cn]=l,a){case"dialog":Et("cancel",r),Et("close",r);break;case"iframe":case"object":case"embed":Et("load",r);break;case"video":case"audio":for(a=0;a<lc.length;a++)Et(lc[a],r);break;case"source":Et("error",r);break;case"img":case"image":case"link":Et("error",r),Et("load",r);break;case"details":Et("toggle",r);break;case"input":Et("invalid",r),ou(r,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":Et("invalid",r);break;case"textarea":Et("invalid",r),ys(r,l.value,l.defaultValue,l.children)}a=l.children,typeof a!="string"&&typeof a!="number"&&typeof a!="bigint"||r.textContent===""+a||l.suppressHydrationWarning===!0||D0(r.textContent,a)?(l.popover!=null&&(Et("beforetoggle",r),Et("toggle",r)),l.onScroll!=null&&Et("scroll",r),l.onScrollEnd!=null&&Et("scrollend",r),l.onClick!=null&&(r.onclick=ei),r=!0):r=!1,r||As(t,!0)}function my(t){for(Qn=t.return;Qn;)switch(Qn.tag){case 5:case 31:case 13:Fr=!1;return;case 27:case 3:Fr=!0;return;default:Qn=Qn.return}}function vo(t){if(t!==Qn)return!1;if(!It)return my(t),It=!0,!1;var r=t.tag,a;if((a=r!==3&&r!==27)&&((a=r===5)&&(a=t.type,a=!(a!=="form"&&a!=="button")||wm(t.type,t.memoizedProps)),a=!a),a&&rn&&As(t),my(t),r===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));rn=z0(t)}else if(r===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(317));rn=z0(t)}else r===27?(r=rn,Us(t.type)?(t=Dm,Dm=null,rn=t):rn=r):rn=Qn?qr(t.stateNode.nextSibling):null;return!0}function Da(){rn=Qn=null,It=!1}function lf(){var t=ws;return t!==null&&(yr===null?yr=t:yr.push.apply(yr,t),ws=null),t}function Ul(t){ws===null?ws=[t]:ws.push(t)}var cf=V(null),Oa=null,Bi=null;function Cs(t,r,a){Q(cf,r._currentValue),r._currentValue=a}function Fi(t){t._currentValue=cf.current,P(cf)}function uf(t,r,a){for(;t!==null;){var l=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,l!==null&&(l.childLanes|=r)):l!==null&&(l.childLanes&r)!==r&&(l.childLanes|=r),t===a)break;t=t.return}}function df(t,r,a,l){var h=t.child;for(h!==null&&(h.return=t);h!==null;){var m=h.dependencies;if(m!==null){var v=h.child;m=m.firstContext;e:for(;m!==null;){var T=m;m=h;for(var U=0;U<r.length;U++)if(T.context===r[U]){m.lanes|=a,T=m.alternate,T!==null&&(T.lanes|=a),uf(m.return,a,t),l||(v=null);break e}m=T.next}}else if(h.tag===18){if(v=h.return,v===null)throw Error(s(341));v.lanes|=a,m=v.alternate,m!==null&&(m.lanes|=a),uf(v,a,t),v=null}else v=h.child;if(v!==null)v.return=h;else for(v=h;v!==null;){if(v===t){v=null;break}if(h=v.sibling,h!==null){h.return=v.return,v=h;break}v=v.return}h=v}}function bo(t,r,a,l){t=null;for(var h=r,m=!1;h!==null;){if(!m){if((h.flags&524288)!==0)m=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var v=h.alternate;if(v===null)throw Error(s(387));if(v=v.memoizedProps,v!==null){var T=h.type;wr(h.pendingProps.value,v.value)||(t!==null?t.push(T):t=[T])}}else if(h===ke.current){if(v=h.alternate,v===null)throw Error(s(387));v.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(t!==null?t.push(fc):t=[fc])}h=h.return}t!==null&&df(r,t,a,l),r.flags|=262144}function Iu(t){for(t=t.firstContext;t!==null;){if(!wr(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function ja(t){Oa=t,Bi=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Kn(t){return gy(Oa,t)}function Du(t,r){return Oa===null&&ja(t),gy(t,r)}function gy(t,r){var a=r._currentValue;if(r={context:r,memoizedValue:a,next:null},Bi===null){if(t===null)throw Error(s(308));Bi=r,t.dependencies={lanes:0,firstContext:r},t.flags|=524288}else Bi=Bi.next=r;return a}var Ax=typeof AbortController<"u"?AbortController:function(){var t=[],r=this.signal={aborted:!1,addEventListener:function(a,l){t.push(l)}};this.abort=function(){r.aborted=!0,t.forEach(function(a){return a()})}},Cx=i.unstable_scheduleCallback,Rx=i.unstable_NormalPriority,Rn={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hf(){return{controller:new Ax,data:new Map,refCount:0}}function Bl(t){t.refCount--,t.refCount===0&&Cx(Rx,function(){t.controller.abort()})}var Fl=null,ff=0,Eo=0,So=null;function Ix(t,r){if(Fl===null){var a=Fl=[];ff=0,Eo=pm(),So={status:"pending",value:void 0,then:function(l){a.push(l)}}}return ff++,r.then(py,py),r}function py(){if(--ff===0&&Fl!==null){So!==null&&(So.status="fulfilled");var t=Fl;Fl=null,Eo=0,So=null;for(var r=0;r<t.length;r++)(0,t[r])()}}function Dx(t,r){var a=[],l={status:"pending",value:null,reason:null,then:function(h){a.push(h)}};return t.then(function(){l.status="fulfilled",l.value=r;for(var h=0;h<a.length;h++)(0,a[h])(r)},function(h){for(l.status="rejected",l.reason=h,h=0;h<a.length;h++)(0,a[h])(void 0)}),l}var yy=se.S;se.S=function(t,r){e0=ue(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&Ix(t,r),yy!==null&&yy(t,r)};var Ma=V(null);function mf(){var t=Ma.current;return t!==null?t:Xt.pooledCache}function Ou(t,r){r===null?Q(Ma,Ma.current):Q(Ma,r.pool)}function _y(){var t=mf();return t===null?null:{parent:Rn._currentValue,pool:t}}var To=Error(s(460)),gf=Error(s(474)),ju=Error(s(542)),Mu={then:function(){}};function vy(t){return t=t.status,t==="fulfilled"||t==="rejected"}function by(t,r,a){switch(a=t[a],a===void 0?t.push(r):a!==r&&(r.then(ei,ei),r=a),r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,Sy(t),t;default:if(typeof r.status=="string")r.then(ei,ei);else{if(t=Xt,t!==null&&100<t.shellSuspendCounter)throw Error(s(482));t=r,t.status="pending",t.then(function(l){if(r.status==="pending"){var h=r;h.status="fulfilled",h.value=l}},function(l){if(r.status==="pending"){var h=r;h.status="rejected",h.reason=l}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,Sy(t),t}throw Na=r,To}}function ka(t){try{var r=t._init;return r(t._payload)}catch(a){throw a!==null&&typeof a=="object"&&typeof a.then=="function"?(Na=a,To):a}}var Na=null;function Ey(){if(Na===null)throw Error(s(459));var t=Na;return Na=null,t}function Sy(t){if(t===To||t===ju)throw Error(s(483))}var xo=null,Hl=0;function ku(t){var r=Hl;return Hl+=1,xo===null&&(xo=[]),by(xo,t,r)}function ql(t,r){r=r.props.ref,t.ref=r!==void 0?r:null}function Nu(t,r){throw r.$$typeof===x?Error(s(525)):(t=Object.prototype.toString.call(r),Error(s(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)))}function Ty(t){function r(Y,H){if(t){var J=Y.deletions;J===null?(Y.deletions=[H],Y.flags|=16):J.push(H)}}function a(Y,H){if(!t)return null;for(;H!==null;)r(Y,H),H=H.sibling;return null}function l(Y){for(var H=new Map;Y!==null;)Y.key!==null?H.set(Y.key,Y):H.set(Y.index,Y),Y=Y.sibling;return H}function h(Y,H){return Y=zi(Y,H),Y.index=0,Y.sibling=null,Y}function m(Y,H,J){return Y.index=J,t?(J=Y.alternate,J!==null?(J=J.index,J<H?(Y.flags|=67108866,H):J):(Y.flags|=67108866,H)):(Y.flags|=1048576,H)}function v(Y){return t&&Y.alternate===null&&(Y.flags|=67108866),Y}function T(Y,H,J,me){return H===null||H.tag!==6?(H=nf(J,Y.mode,me),H.return=Y,H):(H=h(H,J),H.return=Y,H)}function U(Y,H,J,me){var Je=J.type;return Je===O?he(Y,H,J.props.children,me,J.key):H!==null&&(H.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===C&&ka(Je)===H.type)?(H=h(H,J.props),ql(H,J),H.return=Y,H):(H=Cu(J.type,J.key,J.props,null,Y.mode,me),ql(H,J),H.return=Y,H)}function Z(Y,H,J,me){return H===null||H.tag!==4||H.stateNode.containerInfo!==J.containerInfo||H.stateNode.implementation!==J.implementation?(H=rf(J,Y.mode,me),H.return=Y,H):(H=h(H,J.children||[]),H.return=Y,H)}function he(Y,H,J,me,Je){return H===null||H.tag!==7?(H=Ia(J,Y.mode,me,Je),H.return=Y,H):(H=h(H,J),H.return=Y,H)}function ye(Y,H,J){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=nf(""+H,Y.mode,J),H.return=Y,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case D:return J=Cu(H.type,H.key,H.props,null,Y.mode,J),ql(J,H),J.return=Y,J;case k:return H=rf(H,Y.mode,J),H.return=Y,H;case C:return H=ka(H),ye(Y,H,J)}if(dt(H)||B(H))return H=Ia(H,Y.mode,J,null),H.return=Y,H;if(typeof H.then=="function")return ye(Y,ku(H),J);if(H.$$typeof===ee)return ye(Y,Du(Y,H),J);Nu(Y,H)}return null}function re(Y,H,J,me){var Je=H!==null?H.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return Je!==null?null:T(Y,H,""+J,me);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case D:return J.key===Je?U(Y,H,J,me):null;case k:return J.key===Je?Z(Y,H,J,me):null;case C:return J=ka(J),re(Y,H,J,me)}if(dt(J)||B(J))return Je!==null?null:he(Y,H,J,me,null);if(typeof J.then=="function")return re(Y,H,ku(J),me);if(J.$$typeof===ee)return re(Y,H,Du(Y,J),me);Nu(Y,J)}return null}function oe(Y,H,J,me,Je){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return Y=Y.get(J)||null,T(H,Y,""+me,Je);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case D:return Y=Y.get(me.key===null?J:me.key)||null,U(H,Y,me,Je);case k:return Y=Y.get(me.key===null?J:me.key)||null,Z(H,Y,me,Je);case C:return me=ka(me),oe(Y,H,J,me,Je)}if(dt(me)||B(me))return Y=Y.get(J)||null,he(H,Y,me,Je,null);if(typeof me.then=="function")return oe(Y,H,J,ku(me),Je);if(me.$$typeof===ee)return oe(Y,H,J,Du(H,me),Je);Nu(H,me)}return null}function qe(Y,H,J,me){for(var Je=null,jt=null,Ye=H,yt=H=0,xt=null;Ye!==null&&yt<J.length;yt++){Ye.index>yt?(xt=Ye,Ye=null):xt=Ye.sibling;var Mt=re(Y,Ye,J[yt],me);if(Mt===null){Ye===null&&(Ye=xt);break}t&&Ye&&Mt.alternate===null&&r(Y,Ye),H=m(Mt,H,yt),jt===null?Je=Mt:jt.sibling=Mt,jt=Mt,Ye=xt}if(yt===J.length)return a(Y,Ye),It&&Ui(Y,yt),Je;if(Ye===null){for(;yt<J.length;yt++)Ye=ye(Y,J[yt],me),Ye!==null&&(H=m(Ye,H,yt),jt===null?Je=Ye:jt.sibling=Ye,jt=Ye);return It&&Ui(Y,yt),Je}for(Ye=l(Ye);yt<J.length;yt++)xt=oe(Ye,Y,yt,J[yt],me),xt!==null&&(t&&xt.alternate!==null&&Ye.delete(xt.key===null?yt:xt.key),H=m(xt,H,yt),jt===null?Je=xt:jt.sibling=xt,jt=xt);return t&&Ye.forEach(function(Gs){return r(Y,Gs)}),It&&Ui(Y,yt),Je}function nt(Y,H,J,me){if(J==null)throw Error(s(151));for(var Je=null,jt=null,Ye=H,yt=H=0,xt=null,Mt=J.next();Ye!==null&&!Mt.done;yt++,Mt=J.next()){Ye.index>yt?(xt=Ye,Ye=null):xt=Ye.sibling;var Gs=re(Y,Ye,Mt.value,me);if(Gs===null){Ye===null&&(Ye=xt);break}t&&Ye&&Gs.alternate===null&&r(Y,Ye),H=m(Gs,H,yt),jt===null?Je=Gs:jt.sibling=Gs,jt=Gs,Ye=xt}if(Mt.done)return a(Y,Ye),It&&Ui(Y,yt),Je;if(Ye===null){for(;!Mt.done;yt++,Mt=J.next())Mt=ye(Y,Mt.value,me),Mt!==null&&(H=m(Mt,H,yt),jt===null?Je=Mt:jt.sibling=Mt,jt=Mt);return It&&Ui(Y,yt),Je}for(Ye=l(Ye);!Mt.done;yt++,Mt=J.next())Mt=oe(Ye,Y,yt,Mt.value,me),Mt!==null&&(t&&Mt.alternate!==null&&Ye.delete(Mt.key===null?yt:Mt.key),H=m(Mt,H,yt),jt===null?Je=Mt:jt.sibling=Mt,jt=Mt);return t&&Ye.forEach(function(Bw){return r(Y,Bw)}),It&&Ui(Y,yt),Je}function Qt(Y,H,J,me){if(typeof J=="object"&&J!==null&&J.type===O&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case D:e:{for(var Je=J.key;H!==null;){if(H.key===Je){if(Je=J.type,Je===O){if(H.tag===7){a(Y,H.sibling),me=h(H,J.props.children),me.return=Y,Y=me;break e}}else if(H.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===C&&ka(Je)===H.type){a(Y,H.sibling),me=h(H,J.props),ql(me,J),me.return=Y,Y=me;break e}a(Y,H);break}else r(Y,H);H=H.sibling}J.type===O?(me=Ia(J.props.children,Y.mode,me,J.key),me.return=Y,Y=me):(me=Cu(J.type,J.key,J.props,null,Y.mode,me),ql(me,J),me.return=Y,Y=me)}return v(Y);case k:e:{for(Je=J.key;H!==null;){if(H.key===Je)if(H.tag===4&&H.stateNode.containerInfo===J.containerInfo&&H.stateNode.implementation===J.implementation){a(Y,H.sibling),me=h(H,J.children||[]),me.return=Y,Y=me;break e}else{a(Y,H);break}else r(Y,H);H=H.sibling}me=rf(J,Y.mode,me),me.return=Y,Y=me}return v(Y);case C:return J=ka(J),Qt(Y,H,J,me)}if(dt(J))return qe(Y,H,J,me);if(B(J)){if(Je=B(J),typeof Je!="function")throw Error(s(150));return J=Je.call(J),nt(Y,H,J,me)}if(typeof J.then=="function")return Qt(Y,H,ku(J),me);if(J.$$typeof===ee)return Qt(Y,H,Du(Y,J),me);Nu(Y,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,H!==null&&H.tag===6?(a(Y,H.sibling),me=h(H,J),me.return=Y,Y=me):(a(Y,H),me=nf(J,Y.mode,me),me.return=Y,Y=me),v(Y)):a(Y,H)}return function(Y,H,J,me){try{Hl=0;var Je=Qt(Y,H,J,me);return xo=null,Je}catch(Ye){if(Ye===To||Ye===ju)throw Ye;var jt=Ar(29,Ye,null,Y.mode);return jt.lanes=me,jt.return=Y,jt}}}var Va=Ty(!0),xy=Ty(!1),Rs=!1;function pf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yf(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Is(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Ds(t,r,a){var l=t.updateQueue;if(l===null)return null;if(l=l.shared,(Lt&2)!==0){var h=l.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),l.pending=r,r=Au(t),oy(t,null,a),r}return wu(t,l,r,a),Au(t)}function Gl(t,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194048)!==0)){var l=r.lanes;l&=t.pendingLanes,a|=l,r.lanes=a,fi(t,a)}}function _f(t,r){var a=t.updateQueue,l=t.alternate;if(l!==null&&(l=l.updateQueue,a===l)){var h=null,m=null;if(a=a.firstBaseUpdate,a!==null){do{var v={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};m===null?h=m=v:m=m.next=v,a=a.next}while(a!==null);m===null?h=m=r:m=m.next=r}else h=m=r;a={baseState:l.baseState,firstBaseUpdate:h,lastBaseUpdate:m,shared:l.shared,callbacks:l.callbacks},t.updateQueue=a;return}t=a.lastBaseUpdate,t===null?a.firstBaseUpdate=r:t.next=r,a.lastBaseUpdate=r}var vf=!1;function $l(){if(vf){var t=So;if(t!==null)throw t}}function Yl(t,r,a,l){vf=!1;var h=t.updateQueue;Rs=!1;var m=h.firstBaseUpdate,v=h.lastBaseUpdate,T=h.shared.pending;if(T!==null){h.shared.pending=null;var U=T,Z=U.next;U.next=null,v===null?m=Z:v.next=Z,v=U;var he=t.alternate;he!==null&&(he=he.updateQueue,T=he.lastBaseUpdate,T!==v&&(T===null?he.firstBaseUpdate=Z:T.next=Z,he.lastBaseUpdate=U))}if(m!==null){var ye=h.baseState;v=0,he=Z=U=null,T=m;do{var re=T.lane&-536870913,oe=re!==T.lane;if(oe?(Tt&re)===re:(l&re)===re){re!==0&&re===Eo&&(vf=!0),he!==null&&(he=he.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var qe=t,nt=T;re=r;var Qt=a;switch(nt.tag){case 1:if(qe=nt.payload,typeof qe=="function"){ye=qe.call(Qt,ye,re);break e}ye=qe;break e;case 3:qe.flags=qe.flags&-65537|128;case 0:if(qe=nt.payload,re=typeof qe=="function"?qe.call(Qt,ye,re):qe,re==null)break e;ye=S({},ye,re);break e;case 2:Rs=!0}}re=T.callback,re!==null&&(t.flags|=64,oe&&(t.flags|=8192),oe=h.callbacks,oe===null?h.callbacks=[re]:oe.push(re))}else oe={lane:re,tag:T.tag,payload:T.payload,callback:T.callback,next:null},he===null?(Z=he=oe,U=ye):he=he.next=oe,v|=re;if(T=T.next,T===null){if(T=h.shared.pending,T===null)break;oe=T,T=oe.next,oe.next=null,h.lastBaseUpdate=oe,h.shared.pending=null}}while(!0);he===null&&(U=ye),h.baseState=U,h.firstBaseUpdate=Z,h.lastBaseUpdate=he,m===null&&(h.shared.lanes=0),Ns|=v,t.lanes=v,t.memoizedState=ye}}function wy(t,r){if(typeof t!="function")throw Error(s(191,t));t.call(r)}function Ay(t,r){var a=t.callbacks;if(a!==null)for(t.callbacks=null,t=0;t<a.length;t++)wy(a[t],r)}var wo=V(null),Vu=V(0);function Cy(t,r){t=Xi,Q(Vu,t),Q(wo,r),Xi=t|r.baseLanes}function bf(){Q(Vu,Xi),Q(wo,wo.current)}function Ef(){Xi=Vu.current,P(wo),P(Vu)}var Cr=V(null),Hr=null;function Os(t){var r=t.alternate;Q(Tn,Tn.current&1),Q(Cr,t),Hr===null&&(r===null||wo.current!==null||r.memoizedState!==null)&&(Hr=t)}function Sf(t){Q(Tn,Tn.current),Q(Cr,t),Hr===null&&(Hr=t)}function Ry(t){t.tag===22?(Q(Tn,Tn.current),Q(Cr,t),Hr===null&&(Hr=t)):js()}function js(){Q(Tn,Tn.current),Q(Cr,Cr.current)}function Rr(t){P(Cr),Hr===t&&(Hr=null),P(Tn)}var Tn=V(0);function Lu(t){for(var r=t;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||Rm(a)||Im(a)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Hi=0,gt=null,$t=null,In=null,Pu=!1,Ao=!1,La=!1,zu=0,Ql=0,Co=null,Ox=0;function _n(){throw Error(s(321))}function Tf(t,r){if(r===null)return!1;for(var a=0;a<r.length&&a<t.length;a++)if(!wr(t[a],r[a]))return!1;return!0}function xf(t,r,a,l,h,m){return Hi=m,gt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,se.H=t===null||t.memoizedState===null?d_:zf,La=!1,m=a(l,h),La=!1,Ao&&(m=Dy(r,a,l,h)),Iy(t),m}function Iy(t){se.H=Xl;var r=$t!==null&&$t.next!==null;if(Hi=0,In=$t=gt=null,Pu=!1,Ql=0,Co=null,r)throw Error(s(300));t===null||Dn||(t=t.dependencies,t!==null&&Iu(t)&&(Dn=!0))}function Dy(t,r,a,l){gt=t;var h=0;do{if(Ao&&(Co=null),Ql=0,Ao=!1,25<=h)throw Error(s(301));if(h+=1,In=$t=null,t.updateQueue!=null){var m=t.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}se.H=h_,m=r(a,l)}while(Ao);return m}function jx(){var t=se.H,r=t.useState()[0];return r=typeof r.then=="function"?Kl(r):r,t=t.useState()[0],($t!==null?$t.memoizedState:null)!==t&&(gt.flags|=1024),r}function wf(){var t=zu!==0;return zu=0,t}function Af(t,r,a){r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~a}function Cf(t){if(Pu){for(t=t.memoizedState;t!==null;){var r=t.queue;r!==null&&(r.pending=null),t=t.next}Pu=!1}Hi=0,In=$t=gt=null,Ao=!1,Ql=zu=0,Co=null}function ur(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return In===null?gt.memoizedState=In=t:In=In.next=t,In}function xn(){if($t===null){var t=gt.alternate;t=t!==null?t.memoizedState:null}else t=$t.next;var r=In===null?gt.memoizedState:In.next;if(r!==null)In=r,$t=t;else{if(t===null)throw gt.alternate===null?Error(s(467)):Error(s(310));$t=t,t={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},In===null?gt.memoizedState=In=t:In=In.next=t}return In}function Uu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Kl(t){var r=Ql;return Ql+=1,Co===null&&(Co=[]),t=by(Co,t,r),r=gt,(In===null?r.memoizedState:In.next)===null&&(r=r.alternate,se.H=r===null||r.memoizedState===null?d_:zf),t}function Bu(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Kl(t);if(t.$$typeof===ee)return Kn(t)}throw Error(s(438,String(t)))}function Rf(t){var r=null,a=gt.updateQueue;if(a!==null&&(r=a.memoCache),r==null){var l=gt.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(r={data:l.data.map(function(h){return h.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),a===null&&(a=Uu(),gt.updateQueue=a),a.memoCache=r,a=r.data[r.index],a===void 0)for(a=r.data[r.index]=Array(t),l=0;l<t;l++)a[l]=L;return r.index++,a}function qi(t,r){return typeof r=="function"?r(t):r}function Fu(t){var r=xn();return If(r,$t,t)}function If(t,r,a){var l=t.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=a;var h=t.baseQueue,m=l.pending;if(m!==null){if(h!==null){var v=h.next;h.next=m.next,m.next=v}r.baseQueue=h=m,l.pending=null}if(m=t.baseState,h===null)t.memoizedState=m;else{r=h.next;var T=v=null,U=null,Z=r,he=!1;do{var ye=Z.lane&-536870913;if(ye!==Z.lane?(Tt&ye)===ye:(Hi&ye)===ye){var re=Z.revertLane;if(re===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),ye===Eo&&(he=!0);else if((Hi&re)===re){Z=Z.next,re===Eo&&(he=!0);continue}else ye={lane:0,revertLane:Z.revertLane,gesture:null,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},U===null?(T=U=ye,v=m):U=U.next=ye,gt.lanes|=re,Ns|=re;ye=Z.action,La&&a(m,ye),m=Z.hasEagerState?Z.eagerState:a(m,ye)}else re={lane:ye,revertLane:Z.revertLane,gesture:Z.gesture,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},U===null?(T=U=re,v=m):U=U.next=re,gt.lanes|=ye,Ns|=ye;Z=Z.next}while(Z!==null&&Z!==r);if(U===null?v=m:U.next=T,!wr(m,t.memoizedState)&&(Dn=!0,he&&(a=So,a!==null)))throw a;t.memoizedState=m,t.baseState=v,t.baseQueue=U,l.lastRenderedState=m}return h===null&&(l.lanes=0),[t.memoizedState,l.dispatch]}function Df(t){var r=xn(),a=r.queue;if(a===null)throw Error(s(311));a.lastRenderedReducer=t;var l=a.dispatch,h=a.pending,m=r.memoizedState;if(h!==null){a.pending=null;var v=h=h.next;do m=t(m,v.action),v=v.next;while(v!==h);wr(m,r.memoizedState)||(Dn=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),a.lastRenderedState=m}return[m,l]}function Oy(t,r,a){var l=gt,h=xn(),m=It;if(m){if(a===void 0)throw Error(s(407));a=a()}else a=r();var v=!wr(($t||h).memoizedState,a);if(v&&(h.memoizedState=a,Dn=!0),h=h.queue,Mf(ky.bind(null,l,h,t),[t]),h.getSnapshot!==r||v||In!==null&&In.memoizedState.tag&1){if(l.flags|=2048,Ro(9,{destroy:void 0},My.bind(null,l,h,a,r),null),Xt===null)throw Error(s(349));m||(Hi&127)!==0||jy(l,r,a)}return a}function jy(t,r,a){t.flags|=16384,t={getSnapshot:r,value:a},r=gt.updateQueue,r===null?(r=Uu(),gt.updateQueue=r,r.stores=[t]):(a=r.stores,a===null?r.stores=[t]:a.push(t))}function My(t,r,a,l){r.value=a,r.getSnapshot=l,Ny(r)&&Vy(t)}function ky(t,r,a){return a(function(){Ny(r)&&Vy(t)})}function Ny(t){var r=t.getSnapshot;t=t.value;try{var a=r();return!wr(t,a)}catch{return!0}}function Vy(t){var r=Ra(t,2);r!==null&&_r(r,t,2)}function Of(t){var r=ur();if(typeof t=="function"){var a=t;if(t=a(),La){gn(!0);try{a()}finally{gn(!1)}}}return r.memoizedState=r.baseState=t,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:t},r}function Ly(t,r,a,l){return t.baseState=a,If(t,$t,typeof l=="function"?l:qi)}function Mx(t,r,a,l,h){if(Gu(t))throw Error(s(485));if(t=r.action,t!==null){var m={payload:h,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){m.listeners.push(v)}};se.T!==null?a(!0):m.isTransition=!1,l(m),a=r.pending,a===null?(m.next=r.pending=m,Py(r,m)):(m.next=a.next,r.pending=a.next=m)}}function Py(t,r){var a=r.action,l=r.payload,h=t.state;if(r.isTransition){var m=se.T,v={};se.T=v;try{var T=a(h,l),U=se.S;U!==null&&U(v,T),zy(t,r,T)}catch(Z){jf(t,r,Z)}finally{m!==null&&v.types!==null&&(m.types=v.types),se.T=m}}else try{m=a(h,l),zy(t,r,m)}catch(Z){jf(t,r,Z)}}function zy(t,r,a){a!==null&&typeof a=="object"&&typeof a.then=="function"?a.then(function(l){Uy(t,r,l)},function(l){return jf(t,r,l)}):Uy(t,r,a)}function Uy(t,r,a){r.status="fulfilled",r.value=a,By(r),t.state=a,r=t.pending,r!==null&&(a=r.next,a===r?t.pending=null:(a=a.next,r.next=a,Py(t,a)))}function jf(t,r,a){var l=t.pending;if(t.pending=null,l!==null){l=l.next;do r.status="rejected",r.reason=a,By(r),r=r.next;while(r!==l)}t.action=null}function By(t){t=t.listeners;for(var r=0;r<t.length;r++)(0,t[r])()}function Fy(t,r){return r}function Hy(t,r){if(It){var a=Xt.formState;if(a!==null){e:{var l=gt;if(It){if(rn){t:{for(var h=rn,m=Fr;h.nodeType!==8;){if(!m){h=null;break t}if(h=qr(h.nextSibling),h===null){h=null;break t}}m=h.data,h=m==="F!"||m==="F"?h:null}if(h){rn=qr(h.nextSibling),l=h.data==="F!";break e}}As(l)}l=!1}l&&(r=a[0])}}return a=ur(),a.memoizedState=a.baseState=r,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fy,lastRenderedState:r},a.queue=l,a=l_.bind(null,gt,l),l.dispatch=a,l=Of(!1),m=Pf.bind(null,gt,!1,l.queue),l=ur(),h={state:r,dispatch:null,action:t,pending:null},l.queue=h,a=Mx.bind(null,gt,h,m,a),h.dispatch=a,l.memoizedState=t,[r,a,!1]}function qy(t){var r=xn();return Gy(r,$t,t)}function Gy(t,r,a){if(r=If(t,r,Fy)[0],t=Fu(qi)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var l=Kl(r)}catch(v){throw v===To?ju:v}else l=r;r=xn();var h=r.queue,m=h.dispatch;return a!==r.memoizedState&&(gt.flags|=2048,Ro(9,{destroy:void 0},kx.bind(null,h,a),null)),[l,m,t]}function kx(t,r){t.action=r}function $y(t){var r=xn(),a=$t;if(a!==null)return Gy(r,a,t);xn(),r=r.memoizedState,a=xn();var l=a.queue.dispatch;return a.memoizedState=t,[r,l,!1]}function Ro(t,r,a,l){return t={tag:t,create:a,deps:l,inst:r,next:null},r=gt.updateQueue,r===null&&(r=Uu(),gt.updateQueue=r),a=r.lastEffect,a===null?r.lastEffect=t.next=t:(l=a.next,a.next=t,t.next=l,r.lastEffect=t),t}function Yy(){return xn().memoizedState}function Hu(t,r,a,l){var h=ur();gt.flags|=t,h.memoizedState=Ro(1|r,{destroy:void 0},a,l===void 0?null:l)}function qu(t,r,a,l){var h=xn();l=l===void 0?null:l;var m=h.memoizedState.inst;$t!==null&&l!==null&&Tf(l,$t.memoizedState.deps)?h.memoizedState=Ro(r,m,a,l):(gt.flags|=t,h.memoizedState=Ro(1|r,m,a,l))}function Qy(t,r){Hu(8390656,8,t,r)}function Mf(t,r){qu(2048,8,t,r)}function Nx(t){gt.flags|=4;var r=gt.updateQueue;if(r===null)r=Uu(),gt.updateQueue=r,r.events=[t];else{var a=r.events;a===null?r.events=[t]:a.push(t)}}function Ky(t){var r=xn().memoizedState;return Nx({ref:r,nextImpl:t}),function(){if((Lt&2)!==0)throw Error(s(440));return r.impl.apply(void 0,arguments)}}function Wy(t,r){return qu(4,2,t,r)}function Xy(t,r){return qu(4,4,t,r)}function Jy(t,r){if(typeof r=="function"){t=t();var a=r(t);return function(){typeof a=="function"?a():r(null)}}if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function Zy(t,r,a){a=a!=null?a.concat([t]):null,qu(4,4,Jy.bind(null,r,t),a)}function kf(){}function e_(t,r){var a=xn();r=r===void 0?null:r;var l=a.memoizedState;return r!==null&&Tf(r,l[1])?l[0]:(a.memoizedState=[t,r],t)}function t_(t,r){var a=xn();r=r===void 0?null:r;var l=a.memoizedState;if(r!==null&&Tf(r,l[1]))return l[0];if(l=t(),La){gn(!0);try{t()}finally{gn(!1)}}return a.memoizedState=[l,r],l}function Nf(t,r,a){return a===void 0||(Hi&1073741824)!==0&&(Tt&261930)===0?t.memoizedState=r:(t.memoizedState=a,t=n0(),gt.lanes|=t,Ns|=t,a)}function n_(t,r,a,l){return wr(a,r)?a:wo.current!==null?(t=Nf(t,a,l),wr(t,r)||(Dn=!0),t):(Hi&42)===0||(Hi&1073741824)!==0&&(Tt&261930)===0?(Dn=!0,t.memoizedState=a):(t=n0(),gt.lanes|=t,Ns|=t,r)}function r_(t,r,a,l,h){var m=$.p;$.p=m!==0&&8>m?m:8;var v=se.T,T={};se.T=T,Pf(t,!1,r,a);try{var U=h(),Z=se.S;if(Z!==null&&Z(T,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var he=Dx(U,l);Wl(t,r,he,Or(t))}else Wl(t,r,l,Or(t))}catch(ye){Wl(t,r,{then:function(){},status:"rejected",reason:ye},Or())}finally{$.p=m,v!==null&&T.types!==null&&(v.types=T.types),se.T=v}}function Vx(){}function Vf(t,r,a,l){if(t.tag!==5)throw Error(s(476));var h=i_(t).queue;r_(t,h,r,Ie,a===null?Vx:function(){return s_(t),a(l)})}function i_(t){var r=t.memoizedState;if(r!==null)return r;r={memoizedState:Ie,baseState:Ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:Ie},next:null};var a={};return r.next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:a},next:null},t.memoizedState=r,t=t.alternate,t!==null&&(t.memoizedState=r),r}function s_(t){var r=i_(t);r.next===null&&(r=t.alternate.memoizedState),Wl(t,r.next.queue,{},Or())}function Lf(){return Kn(fc)}function a_(){return xn().memoizedState}function o_(){return xn().memoizedState}function Lx(t){for(var r=t.return;r!==null;){switch(r.tag){case 24:case 3:var a=Or();t=Is(a);var l=Ds(r,t,a);l!==null&&(_r(l,r,a),Gl(l,r,a)),r={cache:hf()},t.payload=r;return}r=r.return}}function Px(t,r,a){var l=Or();a={lane:l,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},Gu(t)?c_(r,a):(a=ef(t,r,a,l),a!==null&&(_r(a,t,l),u_(a,r,l)))}function l_(t,r,a){var l=Or();Wl(t,r,a,l)}function Wl(t,r,a,l){var h={lane:l,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(Gu(t))c_(r,h);else{var m=t.alternate;if(t.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var v=r.lastRenderedState,T=m(v,a);if(h.hasEagerState=!0,h.eagerState=T,wr(T,v))return wu(t,r,h,0),Xt===null&&xu(),!1}catch{}if(a=ef(t,r,h,l),a!==null)return _r(a,t,l),u_(a,r,l),!0}return!1}function Pf(t,r,a,l){if(l={lane:2,revertLane:pm(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Gu(t)){if(r)throw Error(s(479))}else r=ef(t,a,l,2),r!==null&&_r(r,t,2)}function Gu(t){var r=t.alternate;return t===gt||r!==null&&r===gt}function c_(t,r){Ao=Pu=!0;var a=t.pending;a===null?r.next=r:(r.next=a.next,a.next=r),t.pending=r}function u_(t,r,a){if((a&4194048)!==0){var l=r.lanes;l&=t.pendingLanes,a|=l,r.lanes=a,fi(t,a)}}var Xl={readContext:Kn,use:Bu,useCallback:_n,useContext:_n,useEffect:_n,useImperativeHandle:_n,useLayoutEffect:_n,useInsertionEffect:_n,useMemo:_n,useReducer:_n,useRef:_n,useState:_n,useDebugValue:_n,useDeferredValue:_n,useTransition:_n,useSyncExternalStore:_n,useId:_n,useHostTransitionStatus:_n,useFormState:_n,useActionState:_n,useOptimistic:_n,useMemoCache:_n,useCacheRefresh:_n};Xl.useEffectEvent=_n;var d_={readContext:Kn,use:Bu,useCallback:function(t,r){return ur().memoizedState=[t,r===void 0?null:r],t},useContext:Kn,useEffect:Qy,useImperativeHandle:function(t,r,a){a=a!=null?a.concat([t]):null,Hu(4194308,4,Jy.bind(null,r,t),a)},useLayoutEffect:function(t,r){return Hu(4194308,4,t,r)},useInsertionEffect:function(t,r){Hu(4,2,t,r)},useMemo:function(t,r){var a=ur();r=r===void 0?null:r;var l=t();if(La){gn(!0);try{t()}finally{gn(!1)}}return a.memoizedState=[l,r],l},useReducer:function(t,r,a){var l=ur();if(a!==void 0){var h=a(r);if(La){gn(!0);try{a(r)}finally{gn(!1)}}}else h=r;return l.memoizedState=l.baseState=h,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:h},l.queue=t,t=t.dispatch=Px.bind(null,gt,t),[l.memoizedState,t]},useRef:function(t){var r=ur();return t={current:t},r.memoizedState=t},useState:function(t){t=Of(t);var r=t.queue,a=l_.bind(null,gt,r);return r.dispatch=a,[t.memoizedState,a]},useDebugValue:kf,useDeferredValue:function(t,r){var a=ur();return Nf(a,t,r)},useTransition:function(){var t=Of(!1);return t=r_.bind(null,gt,t.queue,!0,!1),ur().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,r,a){var l=gt,h=ur();if(It){if(a===void 0)throw Error(s(407));a=a()}else{if(a=r(),Xt===null)throw Error(s(349));(Tt&127)!==0||jy(l,r,a)}h.memoizedState=a;var m={value:a,getSnapshot:r};return h.queue=m,Qy(ky.bind(null,l,m,t),[t]),l.flags|=2048,Ro(9,{destroy:void 0},My.bind(null,l,m,a,r),null),a},useId:function(){var t=ur(),r=Xt.identifierPrefix;if(It){var a=Si,l=Ei;a=(l&~(1<<32-Bt(l)-1)).toString(32)+a,r="_"+r+"R_"+a,a=zu++,0<a&&(r+="H"+a.toString(32)),r+="_"}else a=Ox++,r="_"+r+"r_"+a.toString(32)+"_";return t.memoizedState=r},useHostTransitionStatus:Lf,useFormState:Hy,useActionState:Hy,useOptimistic:function(t){var r=ur();r.memoizedState=r.baseState=t;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=a,r=Pf.bind(null,gt,!0,a),a.dispatch=r,[t,r]},useMemoCache:Rf,useCacheRefresh:function(){return ur().memoizedState=Lx.bind(null,gt)},useEffectEvent:function(t){var r=ur(),a={impl:t};return r.memoizedState=a,function(){if((Lt&2)!==0)throw Error(s(440));return a.impl.apply(void 0,arguments)}}},zf={readContext:Kn,use:Bu,useCallback:e_,useContext:Kn,useEffect:Mf,useImperativeHandle:Zy,useInsertionEffect:Wy,useLayoutEffect:Xy,useMemo:t_,useReducer:Fu,useRef:Yy,useState:function(){return Fu(qi)},useDebugValue:kf,useDeferredValue:function(t,r){var a=xn();return n_(a,$t.memoizedState,t,r)},useTransition:function(){var t=Fu(qi)[0],r=xn().memoizedState;return[typeof t=="boolean"?t:Kl(t),r]},useSyncExternalStore:Oy,useId:a_,useHostTransitionStatus:Lf,useFormState:qy,useActionState:qy,useOptimistic:function(t,r){var a=xn();return Ly(a,$t,t,r)},useMemoCache:Rf,useCacheRefresh:o_};zf.useEffectEvent=Ky;var h_={readContext:Kn,use:Bu,useCallback:e_,useContext:Kn,useEffect:Mf,useImperativeHandle:Zy,useInsertionEffect:Wy,useLayoutEffect:Xy,useMemo:t_,useReducer:Df,useRef:Yy,useState:function(){return Df(qi)},useDebugValue:kf,useDeferredValue:function(t,r){var a=xn();return $t===null?Nf(a,t,r):n_(a,$t.memoizedState,t,r)},useTransition:function(){var t=Df(qi)[0],r=xn().memoizedState;return[typeof t=="boolean"?t:Kl(t),r]},useSyncExternalStore:Oy,useId:a_,useHostTransitionStatus:Lf,useFormState:$y,useActionState:$y,useOptimistic:function(t,r){var a=xn();return $t!==null?Ly(a,$t,t,r):(a.baseState=t,[t,a.queue.dispatch])},useMemoCache:Rf,useCacheRefresh:o_};h_.useEffectEvent=Ky;function Uf(t,r,a,l){r=t.memoizedState,a=a(l,r),a=a==null?r:S({},r,a),t.memoizedState=a,t.lanes===0&&(t.updateQueue.baseState=a)}var Bf={enqueueSetState:function(t,r,a){t=t._reactInternals;var l=Or(),h=Is(l);h.payload=r,a!=null&&(h.callback=a),r=Ds(t,h,l),r!==null&&(_r(r,t,l),Gl(r,t,l))},enqueueReplaceState:function(t,r,a){t=t._reactInternals;var l=Or(),h=Is(l);h.tag=1,h.payload=r,a!=null&&(h.callback=a),r=Ds(t,h,l),r!==null&&(_r(r,t,l),Gl(r,t,l))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var a=Or(),l=Is(a);l.tag=2,r!=null&&(l.callback=r),r=Ds(t,l,a),r!==null&&(_r(r,t,a),Gl(r,t,a))}};function f_(t,r,a,l,h,m,v){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(l,m,v):r.prototype&&r.prototype.isPureReactComponent?!Ll(a,l)||!Ll(h,m):!0}function m_(t,r,a,l){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,l),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,l),r.state!==t&&Bf.enqueueReplaceState(r,r.state,null)}function Pa(t,r){var a=r;if("ref"in r){a={};for(var l in r)l!=="ref"&&(a[l]=r[l])}if(t=t.defaultProps){a===r&&(a=S({},a));for(var h in t)a[h]===void 0&&(a[h]=t[h])}return a}function g_(t){Tu(t)}function p_(t){console.error(t)}function y_(t){Tu(t)}function $u(t,r){try{var a=t.onUncaughtError;a(r.value,{componentStack:r.stack})}catch(l){setTimeout(function(){throw l})}}function __(t,r,a){try{var l=t.onCaughtError;l(a.value,{componentStack:a.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Ff(t,r,a){return a=Is(a),a.tag=3,a.payload={element:null},a.callback=function(){$u(t,r)},a}function v_(t){return t=Is(t),t.tag=3,t}function b_(t,r,a,l){var h=a.type.getDerivedStateFromError;if(typeof h=="function"){var m=l.value;t.payload=function(){return h(m)},t.callback=function(){__(r,a,l)}}var v=a.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(t.callback=function(){__(r,a,l),typeof h!="function"&&(Vs===null?Vs=new Set([this]):Vs.add(this));var T=l.stack;this.componentDidCatch(l.value,{componentStack:T!==null?T:""})})}function zx(t,r,a,l,h){if(a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(r=a.alternate,r!==null&&bo(r,a,h,!0),a=Cr.current,a!==null){switch(a.tag){case 31:case 13:return Hr===null?id():a.alternate===null&&vn===0&&(vn=3),a.flags&=-257,a.flags|=65536,a.lanes=h,l===Mu?a.flags|=16384:(r=a.updateQueue,r===null?a.updateQueue=new Set([l]):r.add(l),fm(t,l,h)),!1;case 22:return a.flags|=65536,l===Mu?a.flags|=16384:(r=a.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([l])},a.updateQueue=r):(a=r.retryQueue,a===null?r.retryQueue=new Set([l]):a.add(l)),fm(t,l,h)),!1}throw Error(s(435,a.tag))}return fm(t,l,h),id(),!1}if(It)return r=Cr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=h,l!==of&&(t=Error(s(422),{cause:l}),Ul(zr(t,a)))):(l!==of&&(r=Error(s(423),{cause:l}),Ul(zr(r,a))),t=t.current.alternate,t.flags|=65536,h&=-h,t.lanes|=h,l=zr(l,a),h=Ff(t.stateNode,l,h),_f(t,h),vn!==4&&(vn=2)),!1;var m=Error(s(520),{cause:l});if(m=zr(m,a),sc===null?sc=[m]:sc.push(m),vn!==4&&(vn=2),r===null)return!0;l=zr(l,a),a=r;do{switch(a.tag){case 3:return a.flags|=65536,t=h&-h,a.lanes|=t,t=Ff(a.stateNode,l,t),_f(a,t),!1;case 1:if(r=a.type,m=a.stateNode,(a.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Vs===null||!Vs.has(m))))return a.flags|=65536,h&=-h,a.lanes|=h,h=v_(h),b_(h,t,a,l),_f(a,h),!1}a=a.return}while(a!==null);return!1}var Hf=Error(s(461)),Dn=!1;function Wn(t,r,a,l){r.child=t===null?xy(r,null,a,l):Va(r,t.child,a,l)}function E_(t,r,a,l,h){a=a.render;var m=r.ref;if("ref"in l){var v={};for(var T in l)T!=="ref"&&(v[T]=l[T])}else v=l;return ja(r),l=xf(t,r,a,v,m,h),T=wf(),t!==null&&!Dn?(Af(t,r,h),Gi(t,r,h)):(It&&T&&sf(r),r.flags|=1,Wn(t,r,l,h),r.child)}function S_(t,r,a,l,h){if(t===null){var m=a.type;return typeof m=="function"&&!tf(m)&&m.defaultProps===void 0&&a.compare===null?(r.tag=15,r.type=m,T_(t,r,m,l,h)):(t=Cu(a.type,null,l,r,r.mode,h),t.ref=r.ref,t.return=r,r.child=t)}if(m=t.child,!Xf(t,h)){var v=m.memoizedProps;if(a=a.compare,a=a!==null?a:Ll,a(v,l)&&t.ref===r.ref)return Gi(t,r,h)}return r.flags|=1,t=zi(m,l),t.ref=r.ref,t.return=r,r.child=t}function T_(t,r,a,l,h){if(t!==null){var m=t.memoizedProps;if(Ll(m,l)&&t.ref===r.ref)if(Dn=!1,r.pendingProps=l=m,Xf(t,h))(t.flags&131072)!==0&&(Dn=!0);else return r.lanes=t.lanes,Gi(t,r,h)}return qf(t,r,a,l,h)}function x_(t,r,a,l){var h=l.children,m=t!==null?t.memoizedState:null;if(t===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((r.flags&128)!==0){if(m=m!==null?m.baseLanes|a:a,t!==null){for(l=r.child=t.child,h=0;l!==null;)h=h|l.lanes|l.childLanes,l=l.sibling;l=h&~m}else l=0,r.child=null;return w_(t,r,m,a,l)}if((a&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},t!==null&&Ou(r,m!==null?m.cachePool:null),m!==null?Cy(r,m):bf(),Ry(r);else return l=r.lanes=536870912,w_(t,r,m!==null?m.baseLanes|a:a,a,l)}else m!==null?(Ou(r,m.cachePool),Cy(r,m),js(),r.memoizedState=null):(t!==null&&Ou(r,null),bf(),js());return Wn(t,r,h,a),r.child}function Jl(t,r){return t!==null&&t.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function w_(t,r,a,l,h){var m=mf();return m=m===null?null:{parent:Rn._currentValue,pool:m},r.memoizedState={baseLanes:a,cachePool:m},t!==null&&Ou(r,null),bf(),Ry(r),t!==null&&bo(t,r,l,!0),r.childLanes=h,null}function Yu(t,r){return r=Ku({mode:r.mode,children:r.children},t.mode),r.ref=t.ref,t.child=r,r.return=t,r}function A_(t,r,a){return Va(r,t.child,null,a),t=Yu(r,r.pendingProps),t.flags|=2,Rr(r),r.memoizedState=null,t}function Ux(t,r,a){var l=r.pendingProps,h=(r.flags&128)!==0;if(r.flags&=-129,t===null){if(It){if(l.mode==="hidden")return t=Yu(r,l),r.lanes=536870912,Jl(null,t);if(Sf(r),(t=rn)?(t=P0(t,Fr),t=t!==null&&t.data==="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:xs!==null?{id:Ei,overflow:Si}:null,retryLane:536870912,hydrationErrors:null},a=cy(t),a.return=r,r.child=a,Qn=r,rn=null)):t=null,t===null)throw As(r);return r.lanes=536870912,null}return Yu(r,l)}var m=t.memoizedState;if(m!==null){var v=m.dehydrated;if(Sf(r),h)if(r.flags&256)r.flags&=-257,r=A_(t,r,a);else if(r.memoizedState!==null)r.child=t.child,r.flags|=128,r=null;else throw Error(s(558));else if(Dn||bo(t,r,a,!1),h=(a&t.childLanes)!==0,Dn||h){if(l=Xt,l!==null&&(v=ya(l,a),v!==0&&v!==m.retryLane))throw m.retryLane=v,Ra(t,v),_r(l,t,v),Hf;id(),r=A_(t,r,a)}else t=m.treeContext,rn=qr(v.nextSibling),Qn=r,It=!0,ws=null,Fr=!1,t!==null&&hy(r,t),r=Yu(r,l),r.flags|=4096;return r}return t=zi(t.child,{mode:l.mode,children:l.children}),t.ref=r.ref,r.child=t,t.return=r,t}function Qu(t,r){var a=r.ref;if(a===null)t!==null&&t.ref!==null&&(r.flags|=4194816);else{if(typeof a!="function"&&typeof a!="object")throw Error(s(284));(t===null||t.ref!==a)&&(r.flags|=4194816)}}function qf(t,r,a,l,h){return ja(r),a=xf(t,r,a,l,void 0,h),l=wf(),t!==null&&!Dn?(Af(t,r,h),Gi(t,r,h)):(It&&l&&sf(r),r.flags|=1,Wn(t,r,a,h),r.child)}function C_(t,r,a,l,h,m){return ja(r),r.updateQueue=null,a=Dy(r,l,a,h),Iy(t),l=wf(),t!==null&&!Dn?(Af(t,r,m),Gi(t,r,m)):(It&&l&&sf(r),r.flags|=1,Wn(t,r,a,m),r.child)}function R_(t,r,a,l,h){if(ja(r),r.stateNode===null){var m=po,v=a.contextType;typeof v=="object"&&v!==null&&(m=Kn(v)),m=new a(l,m),r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Bf,r.stateNode=m,m._reactInternals=r,m=r.stateNode,m.props=l,m.state=r.memoizedState,m.refs={},pf(r),v=a.contextType,m.context=typeof v=="object"&&v!==null?Kn(v):po,m.state=r.memoizedState,v=a.getDerivedStateFromProps,typeof v=="function"&&(Uf(r,a,v,l),m.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(v=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),v!==m.state&&Bf.enqueueReplaceState(m,m.state,null),Yl(r,l,m,h),$l(),m.state=r.memoizedState),typeof m.componentDidMount=="function"&&(r.flags|=4194308),l=!0}else if(t===null){m=r.stateNode;var T=r.memoizedProps,U=Pa(a,T);m.props=U;var Z=m.context,he=a.contextType;v=po,typeof he=="object"&&he!==null&&(v=Kn(he));var ye=a.getDerivedStateFromProps;he=typeof ye=="function"||typeof m.getSnapshotBeforeUpdate=="function",T=r.pendingProps!==T,he||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(T||Z!==v)&&m_(r,m,l,v),Rs=!1;var re=r.memoizedState;m.state=re,Yl(r,l,m,h),$l(),Z=r.memoizedState,T||re!==Z||Rs?(typeof ye=="function"&&(Uf(r,a,ye,l),Z=r.memoizedState),(U=Rs||f_(r,a,U,l,re,Z,v))?(he||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(r.flags|=4194308)):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=l,r.memoizedState=Z),m.props=l,m.state=Z,m.context=v,l=U):(typeof m.componentDidMount=="function"&&(r.flags|=4194308),l=!1)}else{m=r.stateNode,yf(t,r),v=r.memoizedProps,he=Pa(a,v),m.props=he,ye=r.pendingProps,re=m.context,Z=a.contextType,U=po,typeof Z=="object"&&Z!==null&&(U=Kn(Z)),T=a.getDerivedStateFromProps,(Z=typeof T=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==ye||re!==U)&&m_(r,m,l,U),Rs=!1,re=r.memoizedState,m.state=re,Yl(r,l,m,h),$l();var oe=r.memoizedState;v!==ye||re!==oe||Rs||t!==null&&t.dependencies!==null&&Iu(t.dependencies)?(typeof T=="function"&&(Uf(r,a,T,l),oe=r.memoizedState),(he=Rs||f_(r,a,he,l,re,oe,U)||t!==null&&t.dependencies!==null&&Iu(t.dependencies))?(Z||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(l,oe,U),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(l,oe,U)),typeof m.componentDidUpdate=="function"&&(r.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===t.memoizedProps&&re===t.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===t.memoizedProps&&re===t.memoizedState||(r.flags|=1024),r.memoizedProps=l,r.memoizedState=oe),m.props=l,m.state=oe,m.context=U,l=he):(typeof m.componentDidUpdate!="function"||v===t.memoizedProps&&re===t.memoizedState||(r.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===t.memoizedProps&&re===t.memoizedState||(r.flags|=1024),l=!1)}return m=l,Qu(t,r),l=(r.flags&128)!==0,m||l?(m=r.stateNode,a=l&&typeof a.getDerivedStateFromError!="function"?null:m.render(),r.flags|=1,t!==null&&l?(r.child=Va(r,t.child,null,h),r.child=Va(r,null,a,h)):Wn(t,r,a,h),r.memoizedState=m.state,t=r.child):t=Gi(t,r,h),t}function I_(t,r,a,l){return Da(),r.flags|=256,Wn(t,r,a,l),r.child}var Gf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $f(t){return{baseLanes:t,cachePool:_y()}}function Yf(t,r,a){return t=t!==null?t.childLanes&~a:0,r&&(t|=Dr),t}function D_(t,r,a){var l=r.pendingProps,h=!1,m=(r.flags&128)!==0,v;if((v=m)||(v=t!==null&&t.memoizedState===null?!1:(Tn.current&2)!==0),v&&(h=!0,r.flags&=-129),v=(r.flags&32)!==0,r.flags&=-33,t===null){if(It){if(h?Os(r):js(),(t=rn)?(t=P0(t,Fr),t=t!==null&&t.data!=="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:xs!==null?{id:Ei,overflow:Si}:null,retryLane:536870912,hydrationErrors:null},a=cy(t),a.return=r,r.child=a,Qn=r,rn=null)):t=null,t===null)throw As(r);return Im(t)?r.lanes=32:r.lanes=536870912,null}var T=l.children;return l=l.fallback,h?(js(),h=r.mode,T=Ku({mode:"hidden",children:T},h),l=Ia(l,h,a,null),T.return=r,l.return=r,T.sibling=l,r.child=T,l=r.child,l.memoizedState=$f(a),l.childLanes=Yf(t,v,a),r.memoizedState=Gf,Jl(null,l)):(Os(r),Qf(r,T))}var U=t.memoizedState;if(U!==null&&(T=U.dehydrated,T!==null)){if(m)r.flags&256?(Os(r),r.flags&=-257,r=Kf(t,r,a)):r.memoizedState!==null?(js(),r.child=t.child,r.flags|=128,r=null):(js(),T=l.fallback,h=r.mode,l=Ku({mode:"visible",children:l.children},h),T=Ia(T,h,a,null),T.flags|=2,l.return=r,T.return=r,l.sibling=T,r.child=l,Va(r,t.child,null,a),l=r.child,l.memoizedState=$f(a),l.childLanes=Yf(t,v,a),r.memoizedState=Gf,r=Jl(null,l));else if(Os(r),Im(T)){if(v=T.nextSibling&&T.nextSibling.dataset,v)var Z=v.dgst;v=Z,l=Error(s(419)),l.stack="",l.digest=v,Ul({value:l,source:null,stack:null}),r=Kf(t,r,a)}else if(Dn||bo(t,r,a,!1),v=(a&t.childLanes)!==0,Dn||v){if(v=Xt,v!==null&&(l=ya(v,a),l!==0&&l!==U.retryLane))throw U.retryLane=l,Ra(t,l),_r(v,t,l),Hf;Rm(T)||id(),r=Kf(t,r,a)}else Rm(T)?(r.flags|=192,r.child=t.child,r=null):(t=U.treeContext,rn=qr(T.nextSibling),Qn=r,It=!0,ws=null,Fr=!1,t!==null&&hy(r,t),r=Qf(r,l.children),r.flags|=4096);return r}return h?(js(),T=l.fallback,h=r.mode,U=t.child,Z=U.sibling,l=zi(U,{mode:"hidden",children:l.children}),l.subtreeFlags=U.subtreeFlags&65011712,Z!==null?T=zi(Z,T):(T=Ia(T,h,a,null),T.flags|=2),T.return=r,l.return=r,l.sibling=T,r.child=l,Jl(null,l),l=r.child,T=t.child.memoizedState,T===null?T=$f(a):(h=T.cachePool,h!==null?(U=Rn._currentValue,h=h.parent!==U?{parent:U,pool:U}:h):h=_y(),T={baseLanes:T.baseLanes|a,cachePool:h}),l.memoizedState=T,l.childLanes=Yf(t,v,a),r.memoizedState=Gf,Jl(t.child,l)):(Os(r),a=t.child,t=a.sibling,a=zi(a,{mode:"visible",children:l.children}),a.return=r,a.sibling=null,t!==null&&(v=r.deletions,v===null?(r.deletions=[t],r.flags|=16):v.push(t)),r.child=a,r.memoizedState=null,a)}function Qf(t,r){return r=Ku({mode:"visible",children:r},t.mode),r.return=t,t.child=r}function Ku(t,r){return t=Ar(22,t,null,r),t.lanes=0,t}function Kf(t,r,a){return Va(r,t.child,null,a),t=Qf(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function O_(t,r,a){t.lanes|=r;var l=t.alternate;l!==null&&(l.lanes|=r),uf(t.return,r,a)}function Wf(t,r,a,l,h,m){var v=t.memoizedState;v===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:l,tail:a,tailMode:h,treeForkCount:m}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=l,v.tail=a,v.tailMode=h,v.treeForkCount=m)}function j_(t,r,a){var l=r.pendingProps,h=l.revealOrder,m=l.tail;l=l.children;var v=Tn.current,T=(v&2)!==0;if(T?(v=v&1|2,r.flags|=128):v&=1,Q(Tn,v),Wn(t,r,l,a),l=It?zl:0,!T&&t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&O_(t,a,r);else if(t.tag===19)O_(t,a,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(h){case"forwards":for(a=r.child,h=null;a!==null;)t=a.alternate,t!==null&&Lu(t)===null&&(h=a),a=a.sibling;a=h,a===null?(h=r.child,r.child=null):(h=a.sibling,a.sibling=null),Wf(r,!1,h,a,m,l);break;case"backwards":case"unstable_legacy-backwards":for(a=null,h=r.child,r.child=null;h!==null;){if(t=h.alternate,t!==null&&Lu(t)===null){r.child=h;break}t=h.sibling,h.sibling=a,a=h,h=t}Wf(r,!0,a,null,m,l);break;case"together":Wf(r,!1,null,null,void 0,l);break;default:r.memoizedState=null}return r.child}function Gi(t,r,a){if(t!==null&&(r.dependencies=t.dependencies),Ns|=r.lanes,(a&r.childLanes)===0)if(t!==null){if(bo(t,r,a,!1),(a&r.childLanes)===0)return null}else return null;if(t!==null&&r.child!==t.child)throw Error(s(153));if(r.child!==null){for(t=r.child,a=zi(t,t.pendingProps),r.child=a,a.return=r;t.sibling!==null;)t=t.sibling,a=a.sibling=zi(t,t.pendingProps),a.return=r;a.sibling=null}return r.child}function Xf(t,r){return(t.lanes&r)!==0?!0:(t=t.dependencies,!!(t!==null&&Iu(t)))}function Bx(t,r,a){switch(r.tag){case 3:Qe(r,r.stateNode.containerInfo),Cs(r,Rn,t.memoizedState.cache),Da();break;case 27:case 5:Ut(r);break;case 4:Qe(r,r.stateNode.containerInfo);break;case 10:Cs(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Sf(r),null;break;case 13:var l=r.memoizedState;if(l!==null)return l.dehydrated!==null?(Os(r),r.flags|=128,null):(a&r.child.childLanes)!==0?D_(t,r,a):(Os(r),t=Gi(t,r,a),t!==null?t.sibling:null);Os(r);break;case 19:var h=(t.flags&128)!==0;if(l=(a&r.childLanes)!==0,l||(bo(t,r,a,!1),l=(a&r.childLanes)!==0),h){if(l)return j_(t,r,a);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),Q(Tn,Tn.current),l)break;return null;case 22:return r.lanes=0,x_(t,r,a,r.pendingProps);case 24:Cs(r,Rn,t.memoizedState.cache)}return Gi(t,r,a)}function M_(t,r,a){if(t!==null)if(t.memoizedProps!==r.pendingProps)Dn=!0;else{if(!Xf(t,a)&&(r.flags&128)===0)return Dn=!1,Bx(t,r,a);Dn=(t.flags&131072)!==0}else Dn=!1,It&&(r.flags&1048576)!==0&&dy(r,zl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var l=r.pendingProps;if(t=ka(r.elementType),r.type=t,typeof t=="function")tf(t)?(l=Pa(t,l),r.tag=1,r=R_(null,r,t,l,a)):(r.tag=0,r=qf(null,r,t,l,a));else{if(t!=null){var h=t.$$typeof;if(h===Ce){r.tag=11,r=E_(null,r,t,l,a);break e}else if(h===R){r.tag=14,r=S_(null,r,t,l,a);break e}}throw r=Fe(t)||t,Error(s(306,r,""))}}return r;case 0:return qf(t,r,r.type,r.pendingProps,a);case 1:return l=r.type,h=Pa(l,r.pendingProps),R_(t,r,l,h,a);case 3:e:{if(Qe(r,r.stateNode.containerInfo),t===null)throw Error(s(387));l=r.pendingProps;var m=r.memoizedState;h=m.element,yf(t,r),Yl(r,l,null,a);var v=r.memoizedState;if(l=v.cache,Cs(r,Rn,l),l!==m.cache&&df(r,[Rn],a,!0),$l(),l=v.element,m.isDehydrated)if(m={element:l,isDehydrated:!1,cache:v.cache},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){r=I_(t,r,l,a);break e}else if(l!==h){h=zr(Error(s(424)),r),Ul(h),r=I_(t,r,l,a);break e}else for(t=r.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,rn=qr(t.firstChild),Qn=r,It=!0,ws=null,Fr=!0,a=xy(r,null,l,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Da(),l===h){r=Gi(t,r,a);break e}Wn(t,r,l,a)}r=r.child}return r;case 26:return Qu(t,r),t===null?(a=q0(r.type,null,r.pendingProps,null))?r.memoizedState=a:It||(a=r.type,t=r.pendingProps,l=dd(we.current).createElement(a),l[yn]=r,l[Cn]=t,Xn(l,a,t),Ge(l),r.stateNode=l):r.memoizedState=q0(r.type,t.memoizedProps,r.pendingProps,t.memoizedState),null;case 27:return Ut(r),t===null&&It&&(l=r.stateNode=B0(r.type,r.pendingProps,we.current),Qn=r,Fr=!0,h=rn,Us(r.type)?(Dm=h,rn=qr(l.firstChild)):rn=h),Wn(t,r,r.pendingProps.children,a),Qu(t,r),t===null&&(r.flags|=4194304),r.child;case 5:return t===null&&It&&((h=l=rn)&&(l=yw(l,r.type,r.pendingProps,Fr),l!==null?(r.stateNode=l,Qn=r,rn=qr(l.firstChild),Fr=!1,h=!0):h=!1),h||As(r)),Ut(r),h=r.type,m=r.pendingProps,v=t!==null?t.memoizedProps:null,l=m.children,wm(h,m)?l=null:v!==null&&wm(h,v)&&(r.flags|=32),r.memoizedState!==null&&(h=xf(t,r,jx,null,null,a),fc._currentValue=h),Qu(t,r),Wn(t,r,l,a),r.child;case 6:return t===null&&It&&((t=a=rn)&&(a=_w(a,r.pendingProps,Fr),a!==null?(r.stateNode=a,Qn=r,rn=null,t=!0):t=!1),t||As(r)),null;case 13:return D_(t,r,a);case 4:return Qe(r,r.stateNode.containerInfo),l=r.pendingProps,t===null?r.child=Va(r,null,l,a):Wn(t,r,l,a),r.child;case 11:return E_(t,r,r.type,r.pendingProps,a);case 7:return Wn(t,r,r.pendingProps,a),r.child;case 8:return Wn(t,r,r.pendingProps.children,a),r.child;case 12:return Wn(t,r,r.pendingProps.children,a),r.child;case 10:return l=r.pendingProps,Cs(r,r.type,l.value),Wn(t,r,l.children,a),r.child;case 9:return h=r.type._context,l=r.pendingProps.children,ja(r),h=Kn(h),l=l(h),r.flags|=1,Wn(t,r,l,a),r.child;case 14:return S_(t,r,r.type,r.pendingProps,a);case 15:return T_(t,r,r.type,r.pendingProps,a);case 19:return j_(t,r,a);case 31:return Ux(t,r,a);case 22:return x_(t,r,a,r.pendingProps);case 24:return ja(r),l=Kn(Rn),t===null?(h=mf(),h===null&&(h=Xt,m=hf(),h.pooledCache=m,m.refCount++,m!==null&&(h.pooledCacheLanes|=a),h=m),r.memoizedState={parent:l,cache:h},pf(r),Cs(r,Rn,h)):((t.lanes&a)!==0&&(yf(t,r),Yl(r,null,null,a),$l()),h=t.memoizedState,m=r.memoizedState,h.parent!==l?(h={parent:l,cache:l},r.memoizedState=h,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=h),Cs(r,Rn,l)):(l=m.cache,Cs(r,Rn,l),l!==h.cache&&df(r,[Rn],a,!0))),Wn(t,r,r.pendingProps.children,a),r.child;case 29:throw r.pendingProps}throw Error(s(156,r.tag))}function $i(t){t.flags|=4}function Jf(t,r,a,l,h){if((r=(t.mode&32)!==0)&&(r=!1),r){if(t.flags|=16777216,(h&335544128)===h)if(t.stateNode.complete)t.flags|=8192;else if(a0())t.flags|=8192;else throw Na=Mu,gf}else t.flags&=-16777217}function k_(t,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!K0(r))if(a0())t.flags|=8192;else throw Na=Mu,gf}function Wu(t,r){r!==null&&(t.flags|=4),t.flags&16384&&(r=t.tag!==22?Ne():536870912,t.lanes|=r,jo|=r)}function Zl(t,r){if(!It)switch(t.tailMode){case"hidden":r=t.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?t.tail=null:a.sibling=null;break;case"collapsed":a=t.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:l.sibling=null}}function sn(t){var r=t.alternate!==null&&t.alternate.child===t.child,a=0,l=0;if(r)for(var h=t.child;h!==null;)a|=h.lanes|h.childLanes,l|=h.subtreeFlags&65011712,l|=h.flags&65011712,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)a|=h.lanes|h.childLanes,l|=h.subtreeFlags,l|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=l,t.childLanes=a,r}function Fx(t,r,a){var l=r.pendingProps;switch(af(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sn(r),null;case 1:return sn(r),null;case 3:return a=r.stateNode,l=null,t!==null&&(l=t.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),Fi(Rn),lt(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(t===null||t.child===null)&&(vo(r)?$i(r):t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,lf())),sn(r),null;case 26:var h=r.type,m=r.memoizedState;return t===null?($i(r),m!==null?(sn(r),k_(r,m)):(sn(r),Jf(r,h,null,l,a))):m?m!==t.memoizedState?($i(r),sn(r),k_(r,m)):(sn(r),r.flags&=-16777217):(t=t.memoizedProps,t!==l&&$i(r),sn(r),Jf(r,h,t,l,a)),null;case 27:if(bn(r),a=we.current,h=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==l&&$i(r);else{if(!l){if(r.stateNode===null)throw Error(s(166));return sn(r),null}t=X.current,vo(r)?fy(r):(t=B0(h,l,a),r.stateNode=t,$i(r))}return sn(r),null;case 5:if(bn(r),h=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==l&&$i(r);else{if(!l){if(r.stateNode===null)throw Error(s(166));return sn(r),null}if(m=X.current,vo(r))fy(r);else{var v=dd(we.current);switch(m){case 1:m=v.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:m=v.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":m=v.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":m=v.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":m=v.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof l.is=="string"?v.createElement("select",{is:l.is}):v.createElement("select"),l.multiple?m.multiple=!0:l.size&&(m.size=l.size);break;default:m=typeof l.is=="string"?v.createElement(h,{is:l.is}):v.createElement(h)}}m[yn]=r,m[Cn]=l;e:for(v=r.child;v!==null;){if(v.tag===5||v.tag===6)m.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===r)break e;for(;v.sibling===null;){if(v.return===null||v.return===r)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}r.stateNode=m;e:switch(Xn(m,h,l),h){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&$i(r)}}return sn(r),Jf(r,r.type,t===null?null:t.memoizedProps,r.pendingProps,a),null;case 6:if(t&&r.stateNode!=null)t.memoizedProps!==l&&$i(r);else{if(typeof l!="string"&&r.stateNode===null)throw Error(s(166));if(t=we.current,vo(r)){if(t=r.stateNode,a=r.memoizedProps,l=null,h=Qn,h!==null)switch(h.tag){case 27:case 5:l=h.memoizedProps}t[yn]=r,t=!!(t.nodeValue===a||l!==null&&l.suppressHydrationWarning===!0||D0(t.nodeValue,a)),t||As(r,!0)}else t=dd(t).createTextNode(l),t[yn]=r,r.stateNode=t}return sn(r),null;case 31:if(a=r.memoizedState,t===null||t.memoizedState!==null){if(l=vo(r),a!==null){if(t===null){if(!l)throw Error(s(318));if(t=r.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(s(557));t[yn]=r}else Da(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;sn(r),t=!1}else a=lf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=a),t=!0;if(!t)return r.flags&256?(Rr(r),r):(Rr(r),null);if((r.flags&128)!==0)throw Error(s(558))}return sn(r),null;case 13:if(l=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(h=vo(r),l!==null&&l.dehydrated!==null){if(t===null){if(!h)throw Error(s(318));if(h=r.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(s(317));h[yn]=r}else Da(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;sn(r),h=!1}else h=lf(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=h),h=!0;if(!h)return r.flags&256?(Rr(r),r):(Rr(r),null)}return Rr(r),(r.flags&128)!==0?(r.lanes=a,r):(a=l!==null,t=t!==null&&t.memoizedState!==null,a&&(l=r.child,h=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(h=l.alternate.memoizedState.cachePool.pool),m=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),m!==h&&(l.flags|=2048)),a!==t&&a&&(r.child.flags|=8192),Wu(r,r.updateQueue),sn(r),null);case 4:return lt(),t===null&&bm(r.stateNode.containerInfo),sn(r),null;case 10:return Fi(r.type),sn(r),null;case 19:if(P(Tn),l=r.memoizedState,l===null)return sn(r),null;if(h=(r.flags&128)!==0,m=l.rendering,m===null)if(h)Zl(l,!1);else{if(vn!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(m=Lu(t),m!==null){for(r.flags|=128,Zl(l,!1),t=m.updateQueue,r.updateQueue=t,Wu(r,t),r.subtreeFlags=0,t=a,a=r.child;a!==null;)ly(a,t),a=a.sibling;return Q(Tn,Tn.current&1|2),It&&Ui(r,l.treeForkCount),r.child}t=t.sibling}l.tail!==null&&ue()>td&&(r.flags|=128,h=!0,Zl(l,!1),r.lanes=4194304)}else{if(!h)if(t=Lu(m),t!==null){if(r.flags|=128,h=!0,t=t.updateQueue,r.updateQueue=t,Wu(r,t),Zl(l,!0),l.tail===null&&l.tailMode==="hidden"&&!m.alternate&&!It)return sn(r),null}else 2*ue()-l.renderingStartTime>td&&a!==536870912&&(r.flags|=128,h=!0,Zl(l,!1),r.lanes=4194304);l.isBackwards?(m.sibling=r.child,r.child=m):(t=l.last,t!==null?t.sibling=m:r.child=m,l.last=m)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=ue(),t.sibling=null,a=Tn.current,Q(Tn,h?a&1|2:a&1),It&&Ui(r,l.treeForkCount),t):(sn(r),null);case 22:case 23:return Rr(r),Ef(),l=r.memoizedState!==null,t!==null?t.memoizedState!==null!==l&&(r.flags|=8192):l&&(r.flags|=8192),l?(a&536870912)!==0&&(r.flags&128)===0&&(sn(r),r.subtreeFlags&6&&(r.flags|=8192)):sn(r),a=r.updateQueue,a!==null&&Wu(r,a.retryQueue),a=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),l=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),l!==a&&(r.flags|=2048),t!==null&&P(Ma),null;case 24:return a=null,t!==null&&(a=t.memoizedState.cache),r.memoizedState.cache!==a&&(r.flags|=2048),Fi(Rn),sn(r),null;case 25:return null;case 30:return null}throw Error(s(156,r.tag))}function Hx(t,r){switch(af(r),r.tag){case 1:return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return Fi(Rn),lt(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 26:case 27:case 5:return bn(r),null;case 31:if(r.memoizedState!==null){if(Rr(r),r.alternate===null)throw Error(s(340));Da()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 13:if(Rr(r),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(s(340));Da()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return P(Tn),null;case 4:return lt(),null;case 10:return Fi(r.type),null;case 22:case 23:return Rr(r),Ef(),t!==null&&P(Ma),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 24:return Fi(Rn),null;case 25:return null;default:return null}}function N_(t,r){switch(af(r),r.tag){case 3:Fi(Rn),lt();break;case 26:case 27:case 5:bn(r);break;case 4:lt();break;case 31:r.memoizedState!==null&&Rr(r);break;case 13:Rr(r);break;case 19:P(Tn);break;case 10:Fi(r.type);break;case 22:case 23:Rr(r),Ef(),t!==null&&P(Ma);break;case 24:Fi(Rn)}}function ec(t,r){try{var a=r.updateQueue,l=a!==null?a.lastEffect:null;if(l!==null){var h=l.next;a=h;do{if((a.tag&t)===t){l=void 0;var m=a.create,v=a.inst;l=m(),v.destroy=l}a=a.next}while(a!==h)}}catch(T){qt(r,r.return,T)}}function Ms(t,r,a){try{var l=r.updateQueue,h=l!==null?l.lastEffect:null;if(h!==null){var m=h.next;l=m;do{if((l.tag&t)===t){var v=l.inst,T=v.destroy;if(T!==void 0){v.destroy=void 0,h=r;var U=a,Z=T;try{Z()}catch(he){qt(h,U,he)}}}l=l.next}while(l!==m)}}catch(he){qt(r,r.return,he)}}function V_(t){var r=t.updateQueue;if(r!==null){var a=t.stateNode;try{Ay(r,a)}catch(l){qt(t,t.return,l)}}}function L_(t,r,a){a.props=Pa(t.type,t.memoizedProps),a.state=t.memoizedState;try{a.componentWillUnmount()}catch(l){qt(t,r,l)}}function tc(t,r){try{var a=t.ref;if(a!==null){switch(t.tag){case 26:case 27:case 5:var l=t.stateNode;break;case 30:l=t.stateNode;break;default:l=t.stateNode}typeof a=="function"?t.refCleanup=a(l):a.current=l}}catch(h){qt(t,r,h)}}function Ti(t,r){var a=t.ref,l=t.refCleanup;if(a!==null)if(typeof l=="function")try{l()}catch(h){qt(t,r,h)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof a=="function")try{a(null)}catch(h){qt(t,r,h)}else a.current=null}function P_(t){var r=t.type,a=t.memoizedProps,l=t.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":a.autoFocus&&l.focus();break e;case"img":a.src?l.src=a.src:a.srcSet&&(l.srcset=a.srcSet)}}catch(h){qt(t,t.return,h)}}function Zf(t,r,a){try{var l=t.stateNode;dw(l,t.type,a,r),l[Cn]=r}catch(h){qt(t,t.return,h)}}function z_(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Us(t.type)||t.tag===4}function em(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||z_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Us(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function tm(t,r,a){var l=t.tag;if(l===5||l===6)t=t.stateNode,r?(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).insertBefore(t,r):(r=a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,r.appendChild(t),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=ei));else if(l!==4&&(l===27&&Us(t.type)&&(a=t.stateNode,r=null),t=t.child,t!==null))for(tm(t,r,a),t=t.sibling;t!==null;)tm(t,r,a),t=t.sibling}function Xu(t,r,a){var l=t.tag;if(l===5||l===6)t=t.stateNode,r?a.insertBefore(t,r):a.appendChild(t);else if(l!==4&&(l===27&&Us(t.type)&&(a=t.stateNode),t=t.child,t!==null))for(Xu(t,r,a),t=t.sibling;t!==null;)Xu(t,r,a),t=t.sibling}function U_(t){var r=t.stateNode,a=t.memoizedProps;try{for(var l=t.type,h=r.attributes;h.length;)r.removeAttributeNode(h[0]);Xn(r,l,a),r[yn]=t,r[Cn]=a}catch(m){qt(t,t.return,m)}}var Yi=!1,On=!1,nm=!1,B_=typeof WeakSet=="function"?WeakSet:Set,Bn=null;function qx(t,r){if(t=t.containerInfo,Tm=_d,t=Zp(t),Qh(t)){if("selectionStart"in t)var a={start:t.selectionStart,end:t.selectionEnd};else e:{a=(a=t.ownerDocument)&&a.defaultView||window;var l=a.getSelection&&a.getSelection();if(l&&l.rangeCount!==0){a=l.anchorNode;var h=l.anchorOffset,m=l.focusNode;l=l.focusOffset;try{a.nodeType,m.nodeType}catch{a=null;break e}var v=0,T=-1,U=-1,Z=0,he=0,ye=t,re=null;t:for(;;){for(var oe;ye!==a||h!==0&&ye.nodeType!==3||(T=v+h),ye!==m||l!==0&&ye.nodeType!==3||(U=v+l),ye.nodeType===3&&(v+=ye.nodeValue.length),(oe=ye.firstChild)!==null;)re=ye,ye=oe;for(;;){if(ye===t)break t;if(re===a&&++Z===h&&(T=v),re===m&&++he===l&&(U=v),(oe=ye.nextSibling)!==null)break;ye=re,re=ye.parentNode}ye=oe}a=T===-1||U===-1?null:{start:T,end:U}}else a=null}a=a||{start:0,end:0}}else a=null;for(xm={focusedElem:t,selectionRange:a},_d=!1,Bn=r;Bn!==null;)if(r=Bn,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,Bn=t;else for(;Bn!==null;){switch(r=Bn,m=r.alternate,t=r.flags,r.tag){case 0:if((t&4)!==0&&(t=r.updateQueue,t=t!==null?t.events:null,t!==null))for(a=0;a<t.length;a++)h=t[a],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&m!==null){t=void 0,a=r,h=m.memoizedProps,m=m.memoizedState,l=a.stateNode;try{var qe=Pa(a.type,h);t=l.getSnapshotBeforeUpdate(qe,m),l.__reactInternalSnapshotBeforeUpdate=t}catch(nt){qt(a,a.return,nt)}}break;case 3:if((t&1024)!==0){if(t=r.stateNode.containerInfo,a=t.nodeType,a===9)Cm(t);else if(a===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Cm(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(s(163))}if(t=r.sibling,t!==null){t.return=r.return,Bn=t;break}Bn=r.return}}function F_(t,r,a){var l=a.flags;switch(a.tag){case 0:case 11:case 15:Ki(t,a),l&4&&ec(5,a);break;case 1:if(Ki(t,a),l&4)if(t=a.stateNode,r===null)try{t.componentDidMount()}catch(v){qt(a,a.return,v)}else{var h=Pa(a.type,r.memoizedProps);r=r.memoizedState;try{t.componentDidUpdate(h,r,t.__reactInternalSnapshotBeforeUpdate)}catch(v){qt(a,a.return,v)}}l&64&&V_(a),l&512&&tc(a,a.return);break;case 3:if(Ki(t,a),l&64&&(t=a.updateQueue,t!==null)){if(r=null,a.child!==null)switch(a.child.tag){case 27:case 5:r=a.child.stateNode;break;case 1:r=a.child.stateNode}try{Ay(t,r)}catch(v){qt(a,a.return,v)}}break;case 27:r===null&&l&4&&U_(a);case 26:case 5:Ki(t,a),r===null&&l&4&&P_(a),l&512&&tc(a,a.return);break;case 12:Ki(t,a);break;case 31:Ki(t,a),l&4&&G_(t,a);break;case 13:Ki(t,a),l&4&&$_(t,a),l&64&&(t=a.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(a=Zx.bind(null,a),vw(t,a))));break;case 22:if(l=a.memoizedState!==null||Yi,!l){r=r!==null&&r.memoizedState!==null||On,h=Yi;var m=On;Yi=l,(On=r)&&!m?Wi(t,a,(a.subtreeFlags&8772)!==0):Ki(t,a),Yi=h,On=m}break;case 30:break;default:Ki(t,a)}}function H_(t){var r=t.alternate;r!==null&&(t.alternate=null,H_(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&De(r)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var cn=null,mr=!1;function Qi(t,r,a){for(a=a.child;a!==null;)q_(t,r,a),a=a.sibling}function q_(t,r,a){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(Ve,a)}catch{}switch(a.tag){case 26:On||Ti(a,r),Qi(t,r,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode,a.parentNode.removeChild(a));break;case 27:On||Ti(a,r);var l=cn,h=mr;Us(a.type)&&(cn=a.stateNode,mr=!1),Qi(t,r,a),uc(a.stateNode),cn=l,mr=h;break;case 5:On||Ti(a,r);case 6:if(l=cn,h=mr,cn=null,Qi(t,r,a),cn=l,mr=h,cn!==null)if(mr)try{(cn.nodeType===9?cn.body:cn.nodeName==="HTML"?cn.ownerDocument.body:cn).removeChild(a.stateNode)}catch(m){qt(a,r,m)}else try{cn.removeChild(a.stateNode)}catch(m){qt(a,r,m)}break;case 18:cn!==null&&(mr?(t=cn,V0(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,a.stateNode),Uo(t)):V0(cn,a.stateNode));break;case 4:l=cn,h=mr,cn=a.stateNode.containerInfo,mr=!0,Qi(t,r,a),cn=l,mr=h;break;case 0:case 11:case 14:case 15:Ms(2,a,r),On||Ms(4,a,r),Qi(t,r,a);break;case 1:On||(Ti(a,r),l=a.stateNode,typeof l.componentWillUnmount=="function"&&L_(a,r,l)),Qi(t,r,a);break;case 21:Qi(t,r,a);break;case 22:On=(l=On)||a.memoizedState!==null,Qi(t,r,a),On=l;break;default:Qi(t,r,a)}}function G_(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{Uo(t)}catch(a){qt(r,r.return,a)}}}function $_(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{Uo(t)}catch(a){qt(r,r.return,a)}}function Gx(t){switch(t.tag){case 31:case 13:case 19:var r=t.stateNode;return r===null&&(r=t.stateNode=new B_),r;case 22:return t=t.stateNode,r=t._retryCache,r===null&&(r=t._retryCache=new B_),r;default:throw Error(s(435,t.tag))}}function Ju(t,r){var a=Gx(t);r.forEach(function(l){if(!a.has(l)){a.add(l);var h=ew.bind(null,t,l);l.then(h,h)}})}function gr(t,r){var a=r.deletions;if(a!==null)for(var l=0;l<a.length;l++){var h=a[l],m=t,v=r,T=v;e:for(;T!==null;){switch(T.tag){case 27:if(Us(T.type)){cn=T.stateNode,mr=!1;break e}break;case 5:cn=T.stateNode,mr=!1;break e;case 3:case 4:cn=T.stateNode.containerInfo,mr=!0;break e}T=T.return}if(cn===null)throw Error(s(160));q_(m,v,h),cn=null,mr=!1,m=h.alternate,m!==null&&(m.return=null),h.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Y_(r,t),r=r.sibling}var ai=null;function Y_(t,r){var a=t.alternate,l=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:gr(r,t),pr(t),l&4&&(Ms(3,t,t.return),ec(3,t),Ms(5,t,t.return));break;case 1:gr(r,t),pr(t),l&512&&(On||a===null||Ti(a,a.return)),l&64&&Yi&&(t=t.updateQueue,t!==null&&(l=t.callbacks,l!==null&&(a=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=a===null?l:a.concat(l))));break;case 26:var h=ai;if(gr(r,t),pr(t),l&512&&(On||a===null||Ti(a,a.return)),l&4){var m=a!==null?a.memoizedState:null;if(l=t.memoizedState,a===null)if(l===null)if(t.stateNode===null){e:{l=t.type,a=t.memoizedProps,h=h.ownerDocument||h;t:switch(l){case"title":m=h.getElementsByTagName("title")[0],(!m||m[ce]||m[yn]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=h.createElement(l),h.head.insertBefore(m,h.querySelector("head > title"))),Xn(m,l,a),m[yn]=t,Ge(m),l=m;break e;case"link":var v=Y0("link","href",h).get(l+(a.href||""));if(v){for(var T=0;T<v.length;T++)if(m=v[T],m.getAttribute("href")===(a.href==null||a.href===""?null:a.href)&&m.getAttribute("rel")===(a.rel==null?null:a.rel)&&m.getAttribute("title")===(a.title==null?null:a.title)&&m.getAttribute("crossorigin")===(a.crossOrigin==null?null:a.crossOrigin)){v.splice(T,1);break t}}m=h.createElement(l),Xn(m,l,a),h.head.appendChild(m);break;case"meta":if(v=Y0("meta","content",h).get(l+(a.content||""))){for(T=0;T<v.length;T++)if(m=v[T],m.getAttribute("content")===(a.content==null?null:""+a.content)&&m.getAttribute("name")===(a.name==null?null:a.name)&&m.getAttribute("property")===(a.property==null?null:a.property)&&m.getAttribute("http-equiv")===(a.httpEquiv==null?null:a.httpEquiv)&&m.getAttribute("charset")===(a.charSet==null?null:a.charSet)){v.splice(T,1);break t}}m=h.createElement(l),Xn(m,l,a),h.head.appendChild(m);break;default:throw Error(s(468,l))}m[yn]=t,Ge(m),l=m}t.stateNode=l}else Q0(h,t.type,t.stateNode);else t.stateNode=$0(h,l,t.memoizedProps);else m!==l?(m===null?a.stateNode!==null&&(a=a.stateNode,a.parentNode.removeChild(a)):m.count--,l===null?Q0(h,t.type,t.stateNode):$0(h,l,t.memoizedProps)):l===null&&t.stateNode!==null&&Zf(t,t.memoizedProps,a.memoizedProps)}break;case 27:gr(r,t),pr(t),l&512&&(On||a===null||Ti(a,a.return)),a!==null&&l&4&&Zf(t,t.memoizedProps,a.memoizedProps);break;case 5:if(gr(r,t),pr(t),l&512&&(On||a===null||Ti(a,a.return)),t.flags&32){h=t.stateNode;try{fr(h,"")}catch(qe){qt(t,t.return,qe)}}l&4&&t.stateNode!=null&&(h=t.memoizedProps,Zf(t,h,a!==null?a.memoizedProps:h)),l&1024&&(nm=!0);break;case 6:if(gr(r,t),pr(t),l&4){if(t.stateNode===null)throw Error(s(162));l=t.memoizedProps,a=t.stateNode;try{a.nodeValue=l}catch(qe){qt(t,t.return,qe)}}break;case 3:if(md=null,h=ai,ai=hd(r.containerInfo),gr(r,t),ai=h,pr(t),l&4&&a!==null&&a.memoizedState.isDehydrated)try{Uo(r.containerInfo)}catch(qe){qt(t,t.return,qe)}nm&&(nm=!1,Q_(t));break;case 4:l=ai,ai=hd(t.stateNode.containerInfo),gr(r,t),pr(t),ai=l;break;case 12:gr(r,t),pr(t);break;case 31:gr(r,t),pr(t),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,Ju(t,l)));break;case 13:gr(r,t),pr(t),t.child.flags&8192&&t.memoizedState!==null!=(a!==null&&a.memoizedState!==null)&&(ed=ue()),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,Ju(t,l)));break;case 22:h=t.memoizedState!==null;var U=a!==null&&a.memoizedState!==null,Z=Yi,he=On;if(Yi=Z||h,On=he||U,gr(r,t),On=he,Yi=Z,pr(t),l&8192)e:for(r=t.stateNode,r._visibility=h?r._visibility&-2:r._visibility|1,h&&(a===null||U||Yi||On||za(t)),a=null,r=t;;){if(r.tag===5||r.tag===26){if(a===null){U=a=r;try{if(m=U.stateNode,h)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{T=U.stateNode;var ye=U.memoizedProps.style,re=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;T.style.display=re==null||typeof re=="boolean"?"":(""+re).trim()}}catch(qe){qt(U,U.return,qe)}}}else if(r.tag===6){if(a===null){U=r;try{U.stateNode.nodeValue=h?"":U.memoizedProps}catch(qe){qt(U,U.return,qe)}}}else if(r.tag===18){if(a===null){U=r;try{var oe=U.stateNode;h?L0(oe,!0):L0(U.stateNode,!1)}catch(qe){qt(U,U.return,qe)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;a===r&&(a=null),r=r.return}a===r&&(a=null),r.sibling.return=r.return,r=r.sibling}l&4&&(l=t.updateQueue,l!==null&&(a=l.retryQueue,a!==null&&(l.retryQueue=null,Ju(t,a))));break;case 19:gr(r,t),pr(t),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,Ju(t,l)));break;case 30:break;case 21:break;default:gr(r,t),pr(t)}}function pr(t){var r=t.flags;if(r&2){try{for(var a,l=t.return;l!==null;){if(z_(l)){a=l;break}l=l.return}if(a==null)throw Error(s(160));switch(a.tag){case 27:var h=a.stateNode,m=em(t);Xu(t,m,h);break;case 5:var v=a.stateNode;a.flags&32&&(fr(v,""),a.flags&=-33);var T=em(t);Xu(t,T,v);break;case 3:case 4:var U=a.stateNode.containerInfo,Z=em(t);tm(t,Z,U);break;default:throw Error(s(161))}}catch(he){qt(t,t.return,he)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function Q_(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var r=t;Q_(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),t=t.sibling}}function Ki(t,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)F_(t,r.alternate,r),r=r.sibling}function za(t){for(t=t.child;t!==null;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:Ms(4,r,r.return),za(r);break;case 1:Ti(r,r.return);var a=r.stateNode;typeof a.componentWillUnmount=="function"&&L_(r,r.return,a),za(r);break;case 27:uc(r.stateNode);case 26:case 5:Ti(r,r.return),za(r);break;case 22:r.memoizedState===null&&za(r);break;case 30:za(r);break;default:za(r)}t=t.sibling}}function Wi(t,r,a){for(a=a&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var l=r.alternate,h=t,m=r,v=m.flags;switch(m.tag){case 0:case 11:case 15:Wi(h,m,a),ec(4,m);break;case 1:if(Wi(h,m,a),l=m,h=l.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(Z){qt(l,l.return,Z)}if(l=m,h=l.updateQueue,h!==null){var T=l.stateNode;try{var U=h.shared.hiddenCallbacks;if(U!==null)for(h.shared.hiddenCallbacks=null,h=0;h<U.length;h++)wy(U[h],T)}catch(Z){qt(l,l.return,Z)}}a&&v&64&&V_(m),tc(m,m.return);break;case 27:U_(m);case 26:case 5:Wi(h,m,a),a&&l===null&&v&4&&P_(m),tc(m,m.return);break;case 12:Wi(h,m,a);break;case 31:Wi(h,m,a),a&&v&4&&G_(h,m);break;case 13:Wi(h,m,a),a&&v&4&&$_(h,m);break;case 22:m.memoizedState===null&&Wi(h,m,a),tc(m,m.return);break;case 30:break;default:Wi(h,m,a)}r=r.sibling}}function rm(t,r){var a=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(a=t.memoizedState.cachePool.pool),t=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(t=r.memoizedState.cachePool.pool),t!==a&&(t!=null&&t.refCount++,a!=null&&Bl(a))}function im(t,r){t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&Bl(t))}function oi(t,r,a,l){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)K_(t,r,a,l),r=r.sibling}function K_(t,r,a,l){var h=r.flags;switch(r.tag){case 0:case 11:case 15:oi(t,r,a,l),h&2048&&ec(9,r);break;case 1:oi(t,r,a,l);break;case 3:oi(t,r,a,l),h&2048&&(t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&Bl(t)));break;case 12:if(h&2048){oi(t,r,a,l),t=r.stateNode;try{var m=r.memoizedProps,v=m.id,T=m.onPostCommit;typeof T=="function"&&T(v,r.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(U){qt(r,r.return,U)}}else oi(t,r,a,l);break;case 31:oi(t,r,a,l);break;case 13:oi(t,r,a,l);break;case 23:break;case 22:m=r.stateNode,v=r.alternate,r.memoizedState!==null?m._visibility&2?oi(t,r,a,l):nc(t,r):m._visibility&2?oi(t,r,a,l):(m._visibility|=2,Io(t,r,a,l,(r.subtreeFlags&10256)!==0||!1)),h&2048&&rm(v,r);break;case 24:oi(t,r,a,l),h&2048&&im(r.alternate,r);break;default:oi(t,r,a,l)}}function Io(t,r,a,l,h){for(h=h&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var m=t,v=r,T=a,U=l,Z=v.flags;switch(v.tag){case 0:case 11:case 15:Io(m,v,T,U,h),ec(8,v);break;case 23:break;case 22:var he=v.stateNode;v.memoizedState!==null?he._visibility&2?Io(m,v,T,U,h):nc(m,v):(he._visibility|=2,Io(m,v,T,U,h)),h&&Z&2048&&rm(v.alternate,v);break;case 24:Io(m,v,T,U,h),h&&Z&2048&&im(v.alternate,v);break;default:Io(m,v,T,U,h)}r=r.sibling}}function nc(t,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var a=t,l=r,h=l.flags;switch(l.tag){case 22:nc(a,l),h&2048&&rm(l.alternate,l);break;case 24:nc(a,l),h&2048&&im(l.alternate,l);break;default:nc(a,l)}r=r.sibling}}var rc=8192;function Do(t,r,a){if(t.subtreeFlags&rc)for(t=t.child;t!==null;)W_(t,r,a),t=t.sibling}function W_(t,r,a){switch(t.tag){case 26:Do(t,r,a),t.flags&rc&&t.memoizedState!==null&&Ow(a,ai,t.memoizedState,t.memoizedProps);break;case 5:Do(t,r,a);break;case 3:case 4:var l=ai;ai=hd(t.stateNode.containerInfo),Do(t,r,a),ai=l;break;case 22:t.memoizedState===null&&(l=t.alternate,l!==null&&l.memoizedState!==null?(l=rc,rc=16777216,Do(t,r,a),rc=l):Do(t,r,a));break;default:Do(t,r,a)}}function X_(t){var r=t.alternate;if(r!==null&&(t=r.child,t!==null)){r.child=null;do r=t.sibling,t.sibling=null,t=r;while(t!==null)}}function ic(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var l=r[a];Bn=l,Z_(l,t)}X_(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)J_(t),t=t.sibling}function J_(t){switch(t.tag){case 0:case 11:case 15:ic(t),t.flags&2048&&Ms(9,t,t.return);break;case 3:ic(t);break;case 12:ic(t);break;case 22:var r=t.stateNode;t.memoizedState!==null&&r._visibility&2&&(t.return===null||t.return.tag!==13)?(r._visibility&=-3,Zu(t)):ic(t);break;default:ic(t)}}function Zu(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var a=0;a<r.length;a++){var l=r[a];Bn=l,Z_(l,t)}X_(t)}for(t=t.child;t!==null;){switch(r=t,r.tag){case 0:case 11:case 15:Ms(8,r,r.return),Zu(r);break;case 22:a=r.stateNode,a._visibility&2&&(a._visibility&=-3,Zu(r));break;default:Zu(r)}t=t.sibling}}function Z_(t,r){for(;Bn!==null;){var a=Bn;switch(a.tag){case 0:case 11:case 15:Ms(8,a,r);break;case 23:case 22:if(a.memoizedState!==null&&a.memoizedState.cachePool!==null){var l=a.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Bl(a.memoizedState.cache)}if(l=a.child,l!==null)l.return=a,Bn=l;else e:for(a=t;Bn!==null;){l=Bn;var h=l.sibling,m=l.return;if(H_(l),l===a){Bn=null;break e}if(h!==null){h.return=m,Bn=h;break e}Bn=m}}}var $x={getCacheForType:function(t){var r=Kn(Rn),a=r.data.get(t);return a===void 0&&(a=t(),r.data.set(t,a)),a},cacheSignal:function(){return Kn(Rn).controller.signal}},Yx=typeof WeakMap=="function"?WeakMap:Map,Lt=0,Xt=null,bt=null,Tt=0,Ht=0,Ir=null,ks=!1,Oo=!1,sm=!1,Xi=0,vn=0,Ns=0,Ua=0,am=0,Dr=0,jo=0,sc=null,yr=null,om=!1,ed=0,e0=0,td=1/0,nd=null,Vs=null,Ln=0,Ls=null,Mo=null,Ji=0,lm=0,cm=null,t0=null,ac=0,um=null;function Or(){return(Lt&2)!==0&&Tt!==0?Tt&-Tt:se.T!==null?pm():fs()}function n0(){if(Dr===0)if((Tt&536870912)===0||It){var t=En;En<<=1,(En&3932160)===0&&(En=262144),Dr=t}else Dr=536870912;return t=Cr.current,t!==null&&(t.flags|=32),Dr}function _r(t,r,a){(t===Xt&&(Ht===2||Ht===9)||t.cancelPendingCommit!==null)&&(ko(t,0),Ps(t,Tt,Dr,!1)),We(t,a),((Lt&2)===0||t!==Xt)&&(t===Xt&&((Lt&2)===0&&(Ua|=a),vn===4&&Ps(t,Tt,Dr,!1)),xi(t))}function r0(t,r,a){if((Lt&6)!==0)throw Error(s(327));var l=!a&&(r&127)===0&&(r&t.expiredLanes)===0||lr(t,r),h=l?Wx(t,r):hm(t,r,!0),m=l;do{if(h===0){Oo&&!l&&Ps(t,r,0,!1);break}else{if(a=t.current.alternate,m&&!Qx(a)){h=hm(t,r,!1),m=!1;continue}if(h===2){if(m=r,t.errorRecoveryDisabledLanes&m)var v=0;else v=t.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){r=v;e:{var T=t;h=sc;var U=T.current.memoizedState.isDehydrated;if(U&&(ko(T,v).flags|=256),v=hm(T,v,!1),v!==2){if(sm&&!U){T.errorRecoveryDisabledLanes|=m,Ua|=m,h=4;break e}m=yr,yr=h,m!==null&&(yr===null?yr=m:yr.push.apply(yr,m))}h=v}if(m=!1,h!==2)continue}}if(h===1){ko(t,0),Ps(t,r,0,!0);break}e:{switch(l=t,m=h,m){case 0:case 1:throw Error(s(345));case 4:if((r&4194048)!==r)break;case 6:Ps(l,r,Dr,!ks);break e;case 2:yr=null;break;case 3:case 5:break;default:throw Error(s(329))}if((r&62914560)===r&&(h=ed+300-ue(),10<h)){if(Ps(l,r,Dr,!ks),or(l,0,!0)!==0)break e;Ji=r,l.timeoutHandle=k0(i0.bind(null,l,a,yr,nd,om,r,Dr,Ua,jo,ks,m,"Throttled",-0,0),h);break e}i0(l,a,yr,nd,om,r,Dr,Ua,jo,ks,m,null,-0,0)}}break}while(!0);xi(t)}function i0(t,r,a,l,h,m,v,T,U,Z,he,ye,re,oe){if(t.timeoutHandle=-1,ye=r.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ei},W_(r,m,ye);var qe=(m&62914560)===m?ed-ue():(m&4194048)===m?e0-ue():0;if(qe=jw(ye,qe),qe!==null){Ji=m,t.cancelPendingCommit=qe(h0.bind(null,t,r,m,a,l,h,v,T,U,he,ye,null,re,oe)),Ps(t,m,v,!Z);return}}h0(t,r,m,a,l,h,v,T,U)}function Qx(t){for(var r=t;;){var a=r.tag;if((a===0||a===11||a===15)&&r.flags&16384&&(a=r.updateQueue,a!==null&&(a=a.stores,a!==null)))for(var l=0;l<a.length;l++){var h=a[l],m=h.getSnapshot;h=h.value;try{if(!wr(m(),h))return!1}catch{return!1}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ps(t,r,a,l){r&=~am,r&=~Ua,t.suspendedLanes|=r,t.pingedLanes&=~r,l&&(t.warmLanes|=r),l=t.expirationTimes;for(var h=r;0<h;){var m=31-Bt(h),v=1<<m;l[m]=-1,h&=~v}a!==0&&pn(t,a,r)}function rd(){return(Lt&6)===0?(oc(0),!1):!0}function dm(){if(bt!==null){if(Ht===0)var t=bt.return;else t=bt,Bi=Oa=null,Cf(t),xo=null,Hl=0,t=bt;for(;t!==null;)N_(t.alternate,t),t=t.return;bt=null}}function ko(t,r){var a=t.timeoutHandle;a!==-1&&(t.timeoutHandle=-1,mw(a)),a=t.cancelPendingCommit,a!==null&&(t.cancelPendingCommit=null,a()),Ji=0,dm(),Xt=t,bt=a=zi(t.current,null),Tt=r,Ht=0,Ir=null,ks=!1,Oo=lr(t,r),sm=!1,jo=Dr=am=Ua=Ns=vn=0,yr=sc=null,om=!1,(r&8)!==0&&(r|=r&32);var l=t.entangledLanes;if(l!==0)for(t=t.entanglements,l&=r;0<l;){var h=31-Bt(l),m=1<<h;r|=t[h],l&=~m}return Xi=r,xu(),a}function s0(t,r){gt=null,se.H=Xl,r===To||r===ju?(r=Ey(),Ht=3):r===gf?(r=Ey(),Ht=4):Ht=r===Hf?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ir=r,bt===null&&(vn=1,$u(t,zr(r,t.current)))}function a0(){var t=Cr.current;return t===null?!0:(Tt&4194048)===Tt?Hr===null:(Tt&62914560)===Tt||(Tt&536870912)!==0?t===Hr:!1}function o0(){var t=se.H;return se.H=Xl,t===null?Xl:t}function l0(){var t=se.A;return se.A=$x,t}function id(){vn=4,ks||(Tt&4194048)!==Tt&&Cr.current!==null||(Oo=!0),(Ns&134217727)===0&&(Ua&134217727)===0||Xt===null||Ps(Xt,Tt,Dr,!1)}function hm(t,r,a){var l=Lt;Lt|=2;var h=o0(),m=l0();(Xt!==t||Tt!==r)&&(nd=null,ko(t,r)),r=!1;var v=vn;e:do try{if(Ht!==0&&bt!==null){var T=bt,U=Ir;switch(Ht){case 8:dm(),v=6;break e;case 3:case 2:case 9:case 6:Cr.current===null&&(r=!0);var Z=Ht;if(Ht=0,Ir=null,No(t,T,U,Z),a&&Oo){v=0;break e}break;default:Z=Ht,Ht=0,Ir=null,No(t,T,U,Z)}}Kx(),v=vn;break}catch(he){s0(t,he)}while(!0);return r&&t.shellSuspendCounter++,Bi=Oa=null,Lt=l,se.H=h,se.A=m,bt===null&&(Xt=null,Tt=0,xu()),v}function Kx(){for(;bt!==null;)c0(bt)}function Wx(t,r){var a=Lt;Lt|=2;var l=o0(),h=l0();Xt!==t||Tt!==r?(nd=null,td=ue()+500,ko(t,r)):Oo=lr(t,r);e:do try{if(Ht!==0&&bt!==null){r=bt;var m=Ir;t:switch(Ht){case 1:Ht=0,Ir=null,No(t,r,m,1);break;case 2:case 9:if(vy(m)){Ht=0,Ir=null,u0(r);break}r=function(){Ht!==2&&Ht!==9||Xt!==t||(Ht=7),xi(t)},m.then(r,r);break e;case 3:Ht=7;break e;case 4:Ht=5;break e;case 7:vy(m)?(Ht=0,Ir=null,u0(r)):(Ht=0,Ir=null,No(t,r,m,7));break;case 5:var v=null;switch(bt.tag){case 26:v=bt.memoizedState;case 5:case 27:var T=bt;if(v?K0(v):T.stateNode.complete){Ht=0,Ir=null;var U=T.sibling;if(U!==null)bt=U;else{var Z=T.return;Z!==null?(bt=Z,sd(Z)):bt=null}break t}}Ht=0,Ir=null,No(t,r,m,5);break;case 6:Ht=0,Ir=null,No(t,r,m,6);break;case 8:dm(),vn=6;break e;default:throw Error(s(462))}}Xx();break}catch(he){s0(t,he)}while(!0);return Bi=Oa=null,se.H=l,se.A=h,Lt=a,bt!==null?0:(Xt=null,Tt=0,xu(),vn)}function Xx(){for(;bt!==null&&!K();)c0(bt)}function c0(t){var r=M_(t.alternate,t,Xi);t.memoizedProps=t.pendingProps,r===null?sd(t):bt=r}function u0(t){var r=t,a=r.alternate;switch(r.tag){case 15:case 0:r=C_(a,r,r.pendingProps,r.type,void 0,Tt);break;case 11:r=C_(a,r,r.pendingProps,r.type.render,r.ref,Tt);break;case 5:Cf(r);default:N_(a,r),r=bt=ly(r,Xi),r=M_(a,r,Xi)}t.memoizedProps=t.pendingProps,r===null?sd(t):bt=r}function No(t,r,a,l){Bi=Oa=null,Cf(r),xo=null,Hl=0;var h=r.return;try{if(zx(t,h,r,a,Tt)){vn=1,$u(t,zr(a,t.current)),bt=null;return}}catch(m){if(h!==null)throw bt=h,m;vn=1,$u(t,zr(a,t.current)),bt=null;return}r.flags&32768?(It||l===1?t=!0:Oo||(Tt&536870912)!==0?t=!1:(ks=t=!0,(l===2||l===9||l===3||l===6)&&(l=Cr.current,l!==null&&l.tag===13&&(l.flags|=16384))),d0(r,t)):sd(r)}function sd(t){var r=t;do{if((r.flags&32768)!==0){d0(r,ks);return}t=r.return;var a=Fx(r.alternate,r,Xi);if(a!==null){bt=a;return}if(r=r.sibling,r!==null){bt=r;return}bt=r=t}while(r!==null);vn===0&&(vn=5)}function d0(t,r){do{var a=Hx(t.alternate,t);if(a!==null){a.flags&=32767,bt=a;return}if(a=t.return,a!==null&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!r&&(t=t.sibling,t!==null)){bt=t;return}bt=t=a}while(t!==null);vn=6,bt=null}function h0(t,r,a,l,h,m,v,T,U){t.cancelPendingCommit=null;do ad();while(Ln!==0);if((Lt&6)!==0)throw Error(s(327));if(r!==null){if(r===t.current)throw Error(s(177));if(m=r.lanes|r.childLanes,m|=Zh,Pt(t,a,m,v,T,U),t===Xt&&(bt=Xt=null,Tt=0),Mo=r,Ls=t,Ji=a,lm=m,cm=h,t0=l,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,tw(Te,function(){return y0(),null})):(t.callbackNode=null,t.callbackPriority=0),l=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||l){l=se.T,se.T=null,h=$.p,$.p=2,v=Lt,Lt|=4;try{qx(t,r,a)}finally{Lt=v,$.p=h,se.T=l}}Ln=1,f0(),m0(),g0()}}function f0(){if(Ln===1){Ln=0;var t=Ls,r=Mo,a=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||a){a=se.T,se.T=null;var l=$.p;$.p=2;var h=Lt;Lt|=4;try{Y_(r,t);var m=xm,v=Zp(t.containerInfo),T=m.focusedElem,U=m.selectionRange;if(v!==T&&T&&T.ownerDocument&&Jp(T.ownerDocument.documentElement,T)){if(U!==null&&Qh(T)){var Z=U.start,he=U.end;if(he===void 0&&(he=Z),"selectionStart"in T)T.selectionStart=Z,T.selectionEnd=Math.min(he,T.value.length);else{var ye=T.ownerDocument||document,re=ye&&ye.defaultView||window;if(re.getSelection){var oe=re.getSelection(),qe=T.textContent.length,nt=Math.min(U.start,qe),Qt=U.end===void 0?nt:Math.min(U.end,qe);!oe.extend&&nt>Qt&&(v=Qt,Qt=nt,nt=v);var Y=Xp(T,nt),H=Xp(T,Qt);if(Y&&H&&(oe.rangeCount!==1||oe.anchorNode!==Y.node||oe.anchorOffset!==Y.offset||oe.focusNode!==H.node||oe.focusOffset!==H.offset)){var J=ye.createRange();J.setStart(Y.node,Y.offset),oe.removeAllRanges(),nt>Qt?(oe.addRange(J),oe.extend(H.node,H.offset)):(J.setEnd(H.node,H.offset),oe.addRange(J))}}}}for(ye=[],oe=T;oe=oe.parentNode;)oe.nodeType===1&&ye.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<ye.length;T++){var me=ye[T];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}_d=!!Tm,xm=Tm=null}finally{Lt=h,$.p=l,se.T=a}}t.current=r,Ln=2}}function m0(){if(Ln===2){Ln=0;var t=Ls,r=Mo,a=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||a){a=se.T,se.T=null;var l=$.p;$.p=2;var h=Lt;Lt|=4;try{F_(t,r.alternate,r)}finally{Lt=h,$.p=l,se.T=a}}Ln=3}}function g0(){if(Ln===4||Ln===3){Ln=0,te();var t=Ls,r=Mo,a=Ji,l=t0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Ln=5:(Ln=0,Mo=Ls=null,p0(t,t.pendingLanes));var h=t.pendingLanes;if(h===0&&(Vs=null),Jr(a),r=r.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(Ve,r,void 0,(r.current.flags&128)===128)}catch{}if(l!==null){r=se.T,h=$.p,$.p=2,se.T=null;try{for(var m=t.onRecoverableError,v=0;v<l.length;v++){var T=l[v];m(T.value,{componentStack:T.stack})}}finally{se.T=r,$.p=h}}(Ji&3)!==0&&ad(),xi(t),h=t.pendingLanes,(a&261930)!==0&&(h&42)!==0?t===um?ac++:(ac=0,um=t):ac=0,oc(0)}}function p0(t,r){(t.pooledCacheLanes&=r)===0&&(r=t.pooledCache,r!=null&&(t.pooledCache=null,Bl(r)))}function ad(){return f0(),m0(),g0(),y0()}function y0(){if(Ln!==5)return!1;var t=Ls,r=lm;lm=0;var a=Jr(Ji),l=se.T,h=$.p;try{$.p=32>a?32:a,se.T=null,a=cm,cm=null;var m=Ls,v=Ji;if(Ln=0,Mo=Ls=null,Ji=0,(Lt&6)!==0)throw Error(s(331));var T=Lt;if(Lt|=4,J_(m.current),K_(m,m.current,v,a),Lt=T,oc(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(Ve,m)}catch{}return!0}finally{$.p=h,se.T=l,p0(t,r)}}function _0(t,r,a){r=zr(a,r),r=Ff(t.stateNode,r,2),t=Ds(t,r,2),t!==null&&(We(t,2),xi(t))}function qt(t,r,a){if(t.tag===3)_0(t,t,a);else for(;r!==null;){if(r.tag===3){_0(r,t,a);break}else if(r.tag===1){var l=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Vs===null||!Vs.has(l))){t=zr(a,t),a=v_(2),l=Ds(r,a,2),l!==null&&(b_(a,l,r,t),We(l,2),xi(l));break}}r=r.return}}function fm(t,r,a){var l=t.pingCache;if(l===null){l=t.pingCache=new Yx;var h=new Set;l.set(r,h)}else h=l.get(r),h===void 0&&(h=new Set,l.set(r,h));h.has(a)||(sm=!0,h.add(a),t=Jx.bind(null,t,r,a),r.then(t,t))}function Jx(t,r,a){var l=t.pingCache;l!==null&&l.delete(r),t.pingedLanes|=t.suspendedLanes&a,t.warmLanes&=~a,Xt===t&&(Tt&a)===a&&(vn===4||vn===3&&(Tt&62914560)===Tt&&300>ue()-ed?(Lt&2)===0&&ko(t,0):am|=a,jo===Tt&&(jo=0)),xi(t)}function v0(t,r){r===0&&(r=Ne()),t=Ra(t,r),t!==null&&(We(t,r),xi(t))}function Zx(t){var r=t.memoizedState,a=0;r!==null&&(a=r.retryLane),v0(t,a)}function ew(t,r){var a=0;switch(t.tag){case 31:case 13:var l=t.stateNode,h=t.memoizedState;h!==null&&(a=h.retryLane);break;case 19:l=t.stateNode;break;case 22:l=t.stateNode._retryCache;break;default:throw Error(s(314))}l!==null&&l.delete(r),v0(t,a)}function tw(t,r){return fe(t,r)}var od=null,Vo=null,mm=!1,ld=!1,gm=!1,zs=0;function xi(t){t!==Vo&&t.next===null&&(Vo===null?od=Vo=t:Vo=Vo.next=t),ld=!0,mm||(mm=!0,rw())}function oc(t,r){if(!gm&&ld){gm=!0;do for(var a=!1,l=od;l!==null;){if(t!==0){var h=l.pendingLanes;if(h===0)var m=0;else{var v=l.suspendedLanes,T=l.pingedLanes;m=(1<<31-Bt(42|t)+1)-1,m&=h&~(v&~T),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(a=!0,T0(l,m))}else m=Tt,m=or(l,l===Xt?m:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(m&3)===0||lr(l,m)||(a=!0,T0(l,m));l=l.next}while(a);gm=!1}}function nw(){b0()}function b0(){ld=mm=!1;var t=0;zs!==0&&fw()&&(t=zs);for(var r=ue(),a=null,l=od;l!==null;){var h=l.next,m=E0(l,r);m===0?(l.next=null,a===null?od=h:a.next=h,h===null&&(Vo=a)):(a=l,(t!==0||(m&3)!==0)&&(ld=!0)),l=h}Ln!==0&&Ln!==5||oc(t),zs!==0&&(zs=0)}function E0(t,r){for(var a=t.suspendedLanes,l=t.pingedLanes,h=t.expirationTimes,m=t.pendingLanes&-62914561;0<m;){var v=31-Bt(m),T=1<<v,U=h[v];U===-1?((T&a)===0||(T&l)!==0)&&(h[v]=ge(T,r)):U<=r&&(t.expiredLanes|=T),m&=~T}if(r=Xt,a=Tt,a=or(t,t===r?a:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),l=t.callbackNode,a===0||t===r&&(Ht===2||Ht===9)||t.cancelPendingCommit!==null)return l!==null&&l!==null&&z(l),t.callbackNode=null,t.callbackPriority=0;if((a&3)===0||lr(t,a)){if(r=a&-a,r===t.callbackPriority)return r;switch(l!==null&&z(l),Jr(a)){case 2:case 8:a=ve;break;case 32:a=Te;break;case 268435456:a=Re;break;default:a=Te}return l=S0.bind(null,t),a=fe(a,l),t.callbackPriority=r,t.callbackNode=a,r}return l!==null&&l!==null&&z(l),t.callbackPriority=2,t.callbackNode=null,2}function S0(t,r){if(Ln!==0&&Ln!==5)return t.callbackNode=null,t.callbackPriority=0,null;var a=t.callbackNode;if(ad()&&t.callbackNode!==a)return null;var l=Tt;return l=or(t,t===Xt?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),l===0?null:(r0(t,l,r),E0(t,ue()),t.callbackNode!=null&&t.callbackNode===a?S0.bind(null,t):null)}function T0(t,r){if(ad())return null;r0(t,r,!0)}function rw(){gw(function(){(Lt&6)!==0?fe(pe,nw):b0()})}function pm(){if(zs===0){var t=Eo;t===0&&(t=zn,zn<<=1,(zn&261888)===0&&(zn=256)),zs=t}return zs}function x0(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:so(""+t)}function w0(t,r){var a=r.ownerDocument.createElement("input");return a.name=r.name,a.value=r.value,t.id&&a.setAttribute("form",t.id),r.parentNode.insertBefore(a,r),t=new FormData(t),a.parentNode.removeChild(a),t}function iw(t,r,a,l,h){if(r==="submit"&&a&&a.stateNode===h){var m=x0((h[Cn]||null).action),v=l.submitter;v&&(r=(r=v[Cn]||null)?x0(r.formAction):v.getAttribute("formAction"),r!==null&&(m=r,v=null));var T=new yi("action","action",null,l,h);t.push({event:T,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(zs!==0){var U=v?w0(h,v):new FormData(h);Vf(a,{pending:!0,data:U,method:h.method,action:m},null,U)}}else typeof m=="function"&&(T.preventDefault(),U=v?w0(h,v):new FormData(h),Vf(a,{pending:!0,data:U,method:h.method,action:m},m,U))},currentTarget:h}]})}}for(var ym=0;ym<Jh.length;ym++){var _m=Jh[ym],sw=_m.toLowerCase(),aw=_m[0].toUpperCase()+_m.slice(1);si(sw,"on"+aw)}si(ny,"onAnimationEnd"),si(ry,"onAnimationIteration"),si(iy,"onAnimationStart"),si("dblclick","onDoubleClick"),si("focusin","onFocus"),si("focusout","onBlur"),si(Sx,"onTransitionRun"),si(Tx,"onTransitionStart"),si(xx,"onTransitionCancel"),si(sy,"onTransitionEnd"),nn("onMouseEnter",["mouseout","mouseover"]),nn("onMouseLeave",["mouseout","mouseover"]),nn("onPointerEnter",["pointerout","pointerover"]),nn("onPointerLeave",["pointerout","pointerover"]),_t("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_t("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_t("onBeforeInput",["compositionend","keypress","textInput","paste"]),_t("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_t("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_t("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ow=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lc));function A0(t,r){r=(r&4)!==0;for(var a=0;a<t.length;a++){var l=t[a],h=l.event;l=l.listeners;e:{var m=void 0;if(r)for(var v=l.length-1;0<=v;v--){var T=l[v],U=T.instance,Z=T.currentTarget;if(T=T.listener,U!==m&&h.isPropagationStopped())break e;m=T,h.currentTarget=Z;try{m(h)}catch(he){Tu(he)}h.currentTarget=null,m=U}else for(v=0;v<l.length;v++){if(T=l[v],U=T.instance,Z=T.currentTarget,T=T.listener,U!==m&&h.isPropagationStopped())break e;m=T,h.currentTarget=Z;try{m(h)}catch(he){Tu(he)}h.currentTarget=null,m=U}}}}function Et(t,r){var a=r[ms];a===void 0&&(a=r[ms]=new Set);var l=t+"__bubble";a.has(l)||(C0(r,t,2,!1),a.add(l))}function vm(t,r,a){var l=0;r&&(l|=4),C0(a,t,l,r)}var cd="_reactListening"+Math.random().toString(36).slice(2);function bm(t){if(!t[cd]){t[cd]=!0,et.forEach(function(a){a!=="selectionchange"&&(ow.has(a)||vm(a,!1,t),vm(a,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[cd]||(r[cd]=!0,vm("selectionchange",!1,r))}}function C0(t,r,a,l){switch(nv(r)){case 2:var h=Nw;break;case 8:h=Vw;break;default:h=Nm}a=h.bind(null,r,a,t),h=void 0,!ba||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),l?h!==void 0?t.addEventListener(r,a,{capture:!0,passive:h}):t.addEventListener(r,a,!0):h!==void 0?t.addEventListener(r,a,{passive:h}):t.addEventListener(r,a,!1)}function Em(t,r,a,l,h){var m=l;if((r&1)===0&&(r&2)===0&&l!==null)e:for(;;){if(l===null)return;var v=l.tag;if(v===3||v===4){var T=l.stateNode.containerInfo;if(T===h)break;if(v===4)for(v=l.return;v!==null;){var U=v.tag;if((U===3||U===4)&&v.stateNode.containerInfo===h)return;v=v.return}for(;T!==null;){if(v=xe(T),v===null)return;if(U=v.tag,U===5||U===6||U===26||U===27){l=m=v;continue e}T=T.parentNode}}l=l.return}bs(function(){var Z=m,he=Nr(a),ye=[];e:{var re=ay.get(t);if(re!==void 0){var oe=yi,qe=t;switch(t){case"keypress":if(Sa(a)===0)break e;case"keydown":case"keyup":oe=bu;break;case"focusin":qe="focus",oe=xa;break;case"focusout":qe="blur",oe=xa;break;case"beforeblur":case"afterblur":oe=xa;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Ml;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=du;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=_;break;case ny:case ry:case iy:oe=fu;break;case sy:oe=w;break;case"scroll":case"scrollend":oe=jl;break;case"wheel":oe=ae;break;case"copy":case"cut":case"paste":oe=mu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=Pi;break;case"toggle":case"beforetoggle":oe=mt}var nt=(r&4)!==0,Qt=!nt&&(t==="scroll"||t==="scrollend"),Y=nt?re!==null?re+"Capture":null:re;nt=[];for(var H=Z,J;H!==null;){var me=H;if(J=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||J===null||Y===null||(me=ti(H,Y),me!=null&&nt.push(cc(H,me,J))),Qt)break;H=H.return}0<nt.length&&(re=new oe(re,qe,null,a,he),ye.push({event:re,listeners:nt}))}}if((r&7)===0){e:{if(re=t==="mouseover"||t==="pointerover",oe=t==="mouseout"||t==="pointerout",re&&a!==Il&&(qe=a.relatedTarget||a.fromElement)&&(xe(qe)||qe[kr]))break e;if((oe||re)&&(re=he.window===he?he:(re=he.ownerDocument)?re.defaultView||re.parentWindow:window,oe?(qe=a.relatedTarget||a.toElement,oe=Z,qe=qe?xe(qe):null,qe!==null&&(Qt=c(qe),nt=qe.tag,qe!==Qt||nt!==5&&nt!==27&&nt!==6)&&(qe=null)):(oe=null,qe=Z),oe!==qe)){if(nt=Ml,me="onMouseLeave",Y="onMouseEnter",H="mouse",(t==="pointerout"||t==="pointerover")&&(nt=Pi,me="onPointerLeave",Y="onPointerEnter",H="pointer"),Qt=oe==null?re:Be(oe),J=qe==null?re:Be(qe),re=new nt(me,H+"leave",oe,a,he),re.target=Qt,re.relatedTarget=J,me=null,xe(he)===Z&&(nt=new nt(Y,H+"enter",qe,a,he),nt.target=J,nt.relatedTarget=Qt,me=nt),Qt=me,oe&&qe)t:{for(nt=lw,Y=oe,H=qe,J=0,me=Y;me;me=nt(me))J++;me=0;for(var Je=H;Je;Je=nt(Je))me++;for(;0<J-me;)Y=nt(Y),J--;for(;0<me-J;)H=nt(H),me--;for(;J--;){if(Y===H||H!==null&&Y===H.alternate){nt=Y;break t}Y=nt(Y),H=nt(H)}nt=null}else nt=null;oe!==null&&R0(ye,re,oe,nt,!1),qe!==null&&Qt!==null&&R0(ye,Qt,qe,nt,!0)}}e:{if(re=Z?Be(Z):window,oe=re.nodeName&&re.nodeName.toLowerCase(),oe==="select"||oe==="input"&&re.type==="file")var jt=Gp;else if(Hp(re))if($p)jt=vx;else{jt=yx;var Ye=px}else oe=re.nodeName,!oe||oe.toLowerCase()!=="input"||re.type!=="checkbox"&&re.type!=="radio"?Z&&io(Z.elementType)&&(jt=Gp):jt=_x;if(jt&&(jt=jt(t,Z))){qp(ye,jt,a,he);break e}Ye&&Ye(t,re,Z),t==="focusout"&&Z&&re.type==="number"&&Z.memoizedProps.value!=null&&Al(re,"number",re.value)}switch(Ye=Z?Be(Z):window,t){case"focusin":(Hp(Ye)||Ye.contentEditable==="true")&&(fo=Ye,Kh=Z,Pl=null);break;case"focusout":Pl=Kh=fo=null;break;case"mousedown":Wh=!0;break;case"contextmenu":case"mouseup":case"dragend":Wh=!1,ey(ye,a,he);break;case"selectionchange":if(Ex)break;case"keydown":case"keyup":ey(ye,a,he)}var yt;if(Vt)e:{switch(t){case"compositionstart":var xt="onCompositionStart";break e;case"compositionend":xt="onCompositionEnd";break e;case"compositionupdate":xt="onCompositionUpdate";break e}xt=void 0}else ho?wa(t,a)&&(xt="onCompositionEnd"):t==="keydown"&&a.keyCode===229&&(xt="onCompositionStart");xt&&(bi&&a.locale!=="ko"&&(ho||xt!=="onCompositionStart"?xt==="onCompositionEnd"&&ho&&(yt=Ol()):(pi=he,Dl="value"in pi?pi.value:pi.textContent,ho=!0)),Ye=ud(Z,xt),0<Ye.length&&(xt=new vi(xt,t,null,a,he),ye.push({event:xt,listeners:Ye}),yt?xt.data=yt:(yt=uo(a),yt!==null&&(xt.data=yt)))),(yt=Lr?hx(t,a):fx(t,a))&&(xt=ud(Z,"onBeforeInput"),0<xt.length&&(Ye=new vi("onBeforeInput","beforeinput",null,a,he),ye.push({event:Ye,listeners:xt}),Ye.data=yt)),iw(ye,t,Z,a,he)}A0(ye,r)})}function cc(t,r,a){return{instance:t,listener:r,currentTarget:a}}function ud(t,r){for(var a=r+"Capture",l=[];t!==null;){var h=t,m=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||m===null||(h=ti(t,a),h!=null&&l.unshift(cc(t,h,m)),h=ti(t,r),h!=null&&l.push(cc(t,h,m))),t.tag===3)return l;t=t.return}return[]}function lw(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function R0(t,r,a,l,h){for(var m=r._reactName,v=[];a!==null&&a!==l;){var T=a,U=T.alternate,Z=T.stateNode;if(T=T.tag,U!==null&&U===l)break;T!==5&&T!==26&&T!==27||Z===null||(U=Z,h?(Z=ti(a,m),Z!=null&&v.unshift(cc(a,Z,U))):h||(Z=ti(a,m),Z!=null&&v.push(cc(a,Z,U)))),a=a.return}v.length!==0&&t.push({event:r,listeners:v})}var cw=/\r\n?/g,uw=/\u0000|\uFFFD/g;function I0(t){return(typeof t=="string"?t:""+t).replace(cw,`
`).replace(uw,"")}function D0(t,r){return r=I0(r),I0(t)===r}function Yt(t,r,a,l,h,m){switch(a){case"children":typeof l=="string"?r==="body"||r==="textarea"&&l===""||fr(t,l):(typeof l=="number"||typeof l=="bigint")&&r!=="body"&&fr(t,""+l);break;case"className":Ot(t,"class",l);break;case"tabIndex":Ot(t,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Ot(t,a,l);break;case"style":Rl(t,l,m);break;case"data":if(r!=="object"){Ot(t,"data",l);break}case"src":case"href":if(l===""&&(r!=="a"||a!=="href")){t.removeAttribute(a);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){t.removeAttribute(a);break}l=so(""+l),t.setAttribute(a,l);break;case"action":case"formAction":if(typeof l=="function"){t.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(a==="formAction"?(r!=="input"&&Yt(t,r,"name",h.name,h,null),Yt(t,r,"formEncType",h.formEncType,h,null),Yt(t,r,"formMethod",h.formMethod,h,null),Yt(t,r,"formTarget",h.formTarget,h,null)):(Yt(t,r,"encType",h.encType,h,null),Yt(t,r,"method",h.method,h,null),Yt(t,r,"target",h.target,h,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){t.removeAttribute(a);break}l=so(""+l),t.setAttribute(a,l);break;case"onClick":l!=null&&(t.onclick=ei);break;case"onScroll":l!=null&&Et("scroll",t);break;case"onScrollEnd":l!=null&&Et("scrollend",t);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(s(61));if(a=l.__html,a!=null){if(h.children!=null)throw Error(s(60));t.innerHTML=a}}break;case"multiple":t.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":t.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){t.removeAttribute("xlink:href");break}a=so(""+l),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(a,""+l):t.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(a,""):t.removeAttribute(a);break;case"capture":case"download":l===!0?t.setAttribute(a,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(a,l):t.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?t.setAttribute(a,l):t.removeAttribute(a);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?t.removeAttribute(a):t.setAttribute(a,l);break;case"popover":Et("beforetoggle",t),Et("toggle",t),Ft(t,"popover",l);break;case"xlinkActuate":Wt(t,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":Wt(t,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":Wt(t,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":Wt(t,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":Wt(t,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":Wt(t,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":Wt(t,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":Wt(t,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":Wt(t,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":Ft(t,"is",l);break;case"innerText":case"textContent":break;default:(!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(a=uu.get(a)||a,Ft(t,a,l))}}function Sm(t,r,a,l,h,m){switch(a){case"style":Rl(t,l,m);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(s(61));if(a=l.__html,a!=null){if(h.children!=null)throw Error(s(60));t.innerHTML=a}}break;case"children":typeof l=="string"?fr(t,l):(typeof l=="number"||typeof l=="bigint")&&fr(t,""+l);break;case"onScroll":l!=null&&Et("scroll",t);break;case"onScrollEnd":l!=null&&Et("scrollend",t);break;case"onClick":l!=null&&(t.onclick=ei);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ft.hasOwnProperty(a))e:{if(a[0]==="o"&&a[1]==="n"&&(h=a.endsWith("Capture"),r=a.slice(2,h?a.length-7:void 0),m=t[Cn]||null,m=m!=null?m[a]:null,typeof m=="function"&&t.removeEventListener(r,m,h),typeof l=="function")){typeof m!="function"&&m!==null&&(a in t?t[a]=null:t.hasAttribute(a)&&t.removeAttribute(a)),t.addEventListener(r,l,h);break e}a in t?t[a]=l:l===!0?t.setAttribute(a,""):Ft(t,a,l)}}}function Xn(t,r,a){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Et("error",t),Et("load",t);var l=!1,h=!1,m;for(m in a)if(a.hasOwnProperty(m)){var v=a[m];if(v!=null)switch(m){case"src":l=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:Yt(t,r,m,v,a,null)}}h&&Yt(t,r,"srcSet",a.srcSet,a,null),l&&Yt(t,r,"src",a.src,a,null);return;case"input":Et("invalid",t);var T=m=v=h=null,U=null,Z=null;for(l in a)if(a.hasOwnProperty(l)){var he=a[l];if(he!=null)switch(l){case"name":h=he;break;case"type":v=he;break;case"checked":U=he;break;case"defaultChecked":Z=he;break;case"value":m=he;break;case"defaultValue":T=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(s(137,r));break;default:Yt(t,r,l,he,a,null)}}ou(t,m,T,U,Z,v,h,!1);return;case"select":Et("invalid",t),l=v=m=null;for(h in a)if(a.hasOwnProperty(h)&&(T=a[h],T!=null))switch(h){case"value":m=T;break;case"defaultValue":v=T;break;case"multiple":l=T;default:Yt(t,r,h,T,a,null)}r=m,a=v,t.multiple=!!l,r!=null?ps(t,!!l,r,!1):a!=null&&ps(t,!!l,a,!0);return;case"textarea":Et("invalid",t),m=h=l=null;for(v in a)if(a.hasOwnProperty(v)&&(T=a[v],T!=null))switch(v){case"value":l=T;break;case"defaultValue":h=T;break;case"children":m=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(s(91));break;default:Yt(t,r,v,T,a,null)}ys(t,l,h,m);return;case"option":for(U in a)a.hasOwnProperty(U)&&(l=a[U],l!=null)&&(U==="selected"?t.selected=l&&typeof l!="function"&&typeof l!="symbol":Yt(t,r,U,l,a,null));return;case"dialog":Et("beforetoggle",t),Et("toggle",t),Et("cancel",t),Et("close",t);break;case"iframe":case"object":Et("load",t);break;case"video":case"audio":for(l=0;l<lc.length;l++)Et(lc[l],t);break;case"image":Et("error",t),Et("load",t);break;case"details":Et("toggle",t);break;case"embed":case"source":case"link":Et("error",t),Et("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in a)if(a.hasOwnProperty(Z)&&(l=a[Z],l!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,r));default:Yt(t,r,Z,l,a,null)}return;default:if(io(r)){for(he in a)a.hasOwnProperty(he)&&(l=a[he],l!==void 0&&Sm(t,r,he,l,a,void 0));return}}for(T in a)a.hasOwnProperty(T)&&(l=a[T],l!=null&&Yt(t,r,T,l,a,null))}function dw(t,r,a,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,m=null,v=null,T=null,U=null,Z=null,he=null;for(oe in a){var ye=a[oe];if(a.hasOwnProperty(oe)&&ye!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":U=ye;default:l.hasOwnProperty(oe)||Yt(t,r,oe,null,l,ye)}}for(var re in l){var oe=l[re];if(ye=a[re],l.hasOwnProperty(re)&&(oe!=null||ye!=null))switch(re){case"type":m=oe;break;case"name":h=oe;break;case"checked":Z=oe;break;case"defaultChecked":he=oe;break;case"value":v=oe;break;case"defaultValue":T=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(s(137,r));break;default:oe!==ye&&Yt(t,r,re,oe,l,ye)}}ro(t,v,T,U,Z,he,m,h);return;case"select":oe=v=T=re=null;for(m in a)if(U=a[m],a.hasOwnProperty(m)&&U!=null)switch(m){case"value":break;case"multiple":oe=U;default:l.hasOwnProperty(m)||Yt(t,r,m,null,l,U)}for(h in l)if(m=l[h],U=a[h],l.hasOwnProperty(h)&&(m!=null||U!=null))switch(h){case"value":re=m;break;case"defaultValue":T=m;break;case"multiple":v=m;default:m!==U&&Yt(t,r,h,m,l,U)}r=T,a=v,l=oe,re!=null?ps(t,!!a,re,!1):!!l!=!!a&&(r!=null?ps(t,!!a,r,!0):ps(t,!!a,a?[]:"",!1));return;case"textarea":oe=re=null;for(T in a)if(h=a[T],a.hasOwnProperty(T)&&h!=null&&!l.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:Yt(t,r,T,null,l,h)}for(v in l)if(h=l[v],m=a[v],l.hasOwnProperty(v)&&(h!=null||m!=null))switch(v){case"value":re=h;break;case"defaultValue":oe=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(s(91));break;default:h!==m&&Yt(t,r,v,h,l,m)}lu(t,re,oe);return;case"option":for(var qe in a)re=a[qe],a.hasOwnProperty(qe)&&re!=null&&!l.hasOwnProperty(qe)&&(qe==="selected"?t.selected=!1:Yt(t,r,qe,null,l,re));for(U in l)re=l[U],oe=a[U],l.hasOwnProperty(U)&&re!==oe&&(re!=null||oe!=null)&&(U==="selected"?t.selected=re&&typeof re!="function"&&typeof re!="symbol":Yt(t,r,U,re,l,oe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var nt in a)re=a[nt],a.hasOwnProperty(nt)&&re!=null&&!l.hasOwnProperty(nt)&&Yt(t,r,nt,null,l,re);for(Z in l)if(re=l[Z],oe=a[Z],l.hasOwnProperty(Z)&&re!==oe&&(re!=null||oe!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(s(137,r));break;default:Yt(t,r,Z,re,l,oe)}return;default:if(io(r)){for(var Qt in a)re=a[Qt],a.hasOwnProperty(Qt)&&re!==void 0&&!l.hasOwnProperty(Qt)&&Sm(t,r,Qt,void 0,l,re);for(he in l)re=l[he],oe=a[he],!l.hasOwnProperty(he)||re===oe||re===void 0&&oe===void 0||Sm(t,r,he,re,l,oe);return}}for(var Y in a)re=a[Y],a.hasOwnProperty(Y)&&re!=null&&!l.hasOwnProperty(Y)&&Yt(t,r,Y,null,l,re);for(ye in l)re=l[ye],oe=a[ye],!l.hasOwnProperty(ye)||re===oe||re==null&&oe==null||Yt(t,r,ye,re,l,oe)}function O0(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function hw(){if(typeof performance.getEntriesByType=="function"){for(var t=0,r=0,a=performance.getEntriesByType("resource"),l=0;l<a.length;l++){var h=a[l],m=h.transferSize,v=h.initiatorType,T=h.duration;if(m&&T&&O0(v)){for(v=0,T=h.responseEnd,l+=1;l<a.length;l++){var U=a[l],Z=U.startTime;if(Z>T)break;var he=U.transferSize,ye=U.initiatorType;he&&O0(ye)&&(U=U.responseEnd,v+=he*(U<T?1:(T-Z)/(U-Z)))}if(--l,r+=8*(m+v)/(h.duration/1e3),t++,10<t)break}}if(0<t)return r/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Tm=null,xm=null;function dd(t){return t.nodeType===9?t:t.ownerDocument}function j0(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function M0(t,r){if(t===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&r==="foreignObject"?0:t}function wm(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Am=null;function fw(){var t=window.event;return t&&t.type==="popstate"?t===Am?!1:(Am=t,!0):(Am=null,!1)}var k0=typeof setTimeout=="function"?setTimeout:void 0,mw=typeof clearTimeout=="function"?clearTimeout:void 0,N0=typeof Promise=="function"?Promise:void 0,gw=typeof queueMicrotask=="function"?queueMicrotask:typeof N0<"u"?function(t){return N0.resolve(null).then(t).catch(pw)}:k0;function pw(t){setTimeout(function(){throw t})}function Us(t){return t==="head"}function V0(t,r){var a=r,l=0;do{var h=a.nextSibling;if(t.removeChild(a),h&&h.nodeType===8)if(a=h.data,a==="/$"||a==="/&"){if(l===0){t.removeChild(h),Uo(r);return}l--}else if(a==="$"||a==="$?"||a==="$~"||a==="$!"||a==="&")l++;else if(a==="html")uc(t.ownerDocument.documentElement);else if(a==="head"){a=t.ownerDocument.head,uc(a);for(var m=a.firstChild;m;){var v=m.nextSibling,T=m.nodeName;m[ce]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&m.rel.toLowerCase()==="stylesheet"||a.removeChild(m),m=v}}else a==="body"&&uc(t.ownerDocument.body);a=h}while(a);Uo(r)}function L0(t,r){var a=t;t=0;do{var l=a.nextSibling;if(a.nodeType===1?r?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",a.getAttribute("style")===""&&a.removeAttribute("style")):a.nodeType===3&&(r?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),l&&l.nodeType===8)if(a=l.data,a==="/$"){if(t===0)break;t--}else a!=="$"&&a!=="$?"&&a!=="$~"&&a!=="$!"||t++;a=l}while(a)}function Cm(t){var r=t.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var a=r;switch(r=r.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Cm(a),De(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(a.rel.toLowerCase()==="stylesheet")continue}t.removeChild(a)}}function yw(t,r,a,l){for(;t.nodeType===1;){var h=a;if(t.nodeName.toLowerCase()!==r.toLowerCase()){if(!l&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(l){if(!t[ce])switch(r){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(m=t.getAttribute("rel"),m==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(m!==h.rel||t.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||t.getAttribute("title")!==(h.title==null?null:h.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(m=t.getAttribute("src"),(m!==(h.src==null?null:h.src)||t.getAttribute("type")!==(h.type==null?null:h.type)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&m&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(r==="input"&&t.type==="hidden"){var m=h.name==null?null:""+h.name;if(h.type==="hidden"&&t.getAttribute("name")===m)return t}else return t;if(t=qr(t.nextSibling),t===null)break}return null}function _w(t,r,a){if(r==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=qr(t.nextSibling),t===null))return null;return t}function P0(t,r){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=qr(t.nextSibling),t===null))return null;return t}function Rm(t){return t.data==="$?"||t.data==="$~"}function Im(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function vw(t,r){var a=t.ownerDocument;if(t.data==="$~")t._reactRetry=r;else if(t.data!=="$?"||a.readyState!=="loading")r();else{var l=function(){r(),a.removeEventListener("DOMContentLoaded",l)};a.addEventListener("DOMContentLoaded",l),t._reactRetry=l}}function qr(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return t}var Dm=null;function z0(t){t=t.nextSibling;for(var r=0;t;){if(t.nodeType===8){var a=t.data;if(a==="/$"||a==="/&"){if(r===0)return qr(t.nextSibling);r--}else a!=="$"&&a!=="$!"&&a!=="$?"&&a!=="$~"&&a!=="&"||r++}t=t.nextSibling}return null}function U0(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var a=t.data;if(a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"){if(r===0)return t;r--}else a!=="/$"&&a!=="/&"||r++}t=t.previousSibling}return null}function B0(t,r,a){switch(r=dd(a),t){case"html":if(t=r.documentElement,!t)throw Error(s(452));return t;case"head":if(t=r.head,!t)throw Error(s(453));return t;case"body":if(t=r.body,!t)throw Error(s(454));return t;default:throw Error(s(451))}}function uc(t){for(var r=t.attributes;r.length;)t.removeAttributeNode(r[0]);De(t)}var Gr=new Map,F0=new Set;function hd(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Zi=$.d;$.d={f:bw,r:Ew,D:Sw,C:Tw,L:xw,m:ww,X:Cw,S:Aw,M:Rw};function bw(){var t=Zi.f(),r=rd();return t||r}function Ew(t){var r=Oe(t);r!==null&&r.tag===5&&r.type==="form"?s_(r):Zi.r(t)}var Lo=typeof document>"u"?null:document;function H0(t,r,a){var l=Lo;if(l&&typeof r=="string"&&r){var h=hr(r);h='link[rel="'+t+'"][href="'+h+'"]',typeof a=="string"&&(h+='[crossorigin="'+a+'"]'),F0.has(h)||(F0.add(h),t={rel:t,crossOrigin:a,href:r},l.querySelector(h)===null&&(r=l.createElement("link"),Xn(r,"link",t),Ge(r),l.head.appendChild(r)))}}function Sw(t){Zi.D(t),H0("dns-prefetch",t,null)}function Tw(t,r){Zi.C(t,r),H0("preconnect",t,r)}function xw(t,r,a){Zi.L(t,r,a);var l=Lo;if(l&&t&&r){var h='link[rel="preload"][as="'+hr(r)+'"]';r==="image"&&a&&a.imageSrcSet?(h+='[imagesrcset="'+hr(a.imageSrcSet)+'"]',typeof a.imageSizes=="string"&&(h+='[imagesizes="'+hr(a.imageSizes)+'"]')):h+='[href="'+hr(t)+'"]';var m=h;switch(r){case"style":m=Po(t);break;case"script":m=zo(t)}Gr.has(m)||(t=S({rel:"preload",href:r==="image"&&a&&a.imageSrcSet?void 0:t,as:r},a),Gr.set(m,t),l.querySelector(h)!==null||r==="style"&&l.querySelector(dc(m))||r==="script"&&l.querySelector(hc(m))||(r=l.createElement("link"),Xn(r,"link",t),Ge(r),l.head.appendChild(r)))}}function ww(t,r){Zi.m(t,r);var a=Lo;if(a&&t){var l=r&&typeof r.as=="string"?r.as:"script",h='link[rel="modulepreload"][as="'+hr(l)+'"][href="'+hr(t)+'"]',m=h;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=zo(t)}if(!Gr.has(m)&&(t=S({rel:"modulepreload",href:t},r),Gr.set(m,t),a.querySelector(h)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(hc(m)))return}l=a.createElement("link"),Xn(l,"link",t),Ge(l),a.head.appendChild(l)}}}function Aw(t,r,a){Zi.S(t,r,a);var l=Lo;if(l&&t){var h=Pe(l).hoistableStyles,m=Po(t);r=r||"default";var v=h.get(m);if(!v){var T={loading:0,preload:null};if(v=l.querySelector(dc(m)))T.loading=5;else{t=S({rel:"stylesheet",href:t,"data-precedence":r},a),(a=Gr.get(m))&&Om(t,a);var U=v=l.createElement("link");Ge(U),Xn(U,"link",t),U._p=new Promise(function(Z,he){U.onload=Z,U.onerror=he}),U.addEventListener("load",function(){T.loading|=1}),U.addEventListener("error",function(){T.loading|=2}),T.loading|=4,fd(v,r,l)}v={type:"stylesheet",instance:v,count:1,state:T},h.set(m,v)}}}function Cw(t,r){Zi.X(t,r);var a=Lo;if(a&&t){var l=Pe(a).hoistableScripts,h=zo(t),m=l.get(h);m||(m=a.querySelector(hc(h)),m||(t=S({src:t,async:!0},r),(r=Gr.get(h))&&jm(t,r),m=a.createElement("script"),Ge(m),Xn(m,"link",t),a.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},l.set(h,m))}}function Rw(t,r){Zi.M(t,r);var a=Lo;if(a&&t){var l=Pe(a).hoistableScripts,h=zo(t),m=l.get(h);m||(m=a.querySelector(hc(h)),m||(t=S({src:t,async:!0,type:"module"},r),(r=Gr.get(h))&&jm(t,r),m=a.createElement("script"),Ge(m),Xn(m,"link",t),a.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},l.set(h,m))}}function q0(t,r,a,l){var h=(h=we.current)?hd(h):null;if(!h)throw Error(s(446));switch(t){case"meta":case"title":return null;case"style":return typeof a.precedence=="string"&&typeof a.href=="string"?(r=Po(a.href),a=Pe(h).hoistableStyles,l=a.get(r),l||(l={type:"style",instance:null,count:0,state:null},a.set(r,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(a.rel==="stylesheet"&&typeof a.href=="string"&&typeof a.precedence=="string"){t=Po(a.href);var m=Pe(h).hoistableStyles,v=m.get(t);if(v||(h=h.ownerDocument||h,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(t,v),(m=h.querySelector(dc(t)))&&!m._p&&(v.instance=m,v.state.loading=5),Gr.has(t)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Gr.set(t,a),m||Iw(h,t,a,v.state))),r&&l===null)throw Error(s(528,""));return v}if(r&&l!==null)throw Error(s(529,""));return null;case"script":return r=a.async,a=a.src,typeof a=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=zo(a),a=Pe(h).hoistableScripts,l=a.get(r),l||(l={type:"script",instance:null,count:0,state:null},a.set(r,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,t))}}function Po(t){return'href="'+hr(t)+'"'}function dc(t){return'link[rel="stylesheet"]['+t+"]"}function G0(t){return S({},t,{"data-precedence":t.precedence,precedence:null})}function Iw(t,r,a,l){t.querySelector('link[rel="preload"][as="style"]['+r+"]")?l.loading=1:(r=t.createElement("link"),l.preload=r,r.addEventListener("load",function(){return l.loading|=1}),r.addEventListener("error",function(){return l.loading|=2}),Xn(r,"link",a),Ge(r),t.head.appendChild(r))}function zo(t){return'[src="'+hr(t)+'"]'}function hc(t){return"script[async]"+t}function $0(t,r,a){if(r.count++,r.instance===null)switch(r.type){case"style":var l=t.querySelector('style[data-href~="'+hr(a.href)+'"]');if(l)return r.instance=l,Ge(l),l;var h=S({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return l=(t.ownerDocument||t).createElement("style"),Ge(l),Xn(l,"style",h),fd(l,a.precedence,t),r.instance=l;case"stylesheet":h=Po(a.href);var m=t.querySelector(dc(h));if(m)return r.state.loading|=4,r.instance=m,Ge(m),m;l=G0(a),(h=Gr.get(h))&&Om(l,h),m=(t.ownerDocument||t).createElement("link"),Ge(m);var v=m;return v._p=new Promise(function(T,U){v.onload=T,v.onerror=U}),Xn(m,"link",l),r.state.loading|=4,fd(m,a.precedence,t),r.instance=m;case"script":return m=zo(a.src),(h=t.querySelector(hc(m)))?(r.instance=h,Ge(h),h):(l=a,(h=Gr.get(m))&&(l=S({},a),jm(l,h)),t=t.ownerDocument||t,h=t.createElement("script"),Ge(h),Xn(h,"link",l),t.head.appendChild(h),r.instance=h);case"void":return null;default:throw Error(s(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(l=r.instance,r.state.loading|=4,fd(l,a.precedence,t));return r.instance}function fd(t,r,a){for(var l=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=l.length?l[l.length-1]:null,m=h,v=0;v<l.length;v++){var T=l[v];if(T.dataset.precedence===r)m=T;else if(m!==h)break}m?m.parentNode.insertBefore(t,m.nextSibling):(r=a.nodeType===9?a.head:a,r.insertBefore(t,r.firstChild))}function Om(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.title==null&&(t.title=r.title)}function jm(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.integrity==null&&(t.integrity=r.integrity)}var md=null;function Y0(t,r,a){if(md===null){var l=new Map,h=md=new Map;h.set(a,l)}else h=md,l=h.get(a),l||(l=new Map,h.set(a,l));if(l.has(t))return l;for(l.set(t,null),a=a.getElementsByTagName(t),h=0;h<a.length;h++){var m=a[h];if(!(m[ce]||m[yn]||t==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var v=m.getAttribute(r)||"";v=t+v;var T=l.get(v);T?T.push(m):l.set(v,[m])}}return l}function Q0(t,r,a){t=t.ownerDocument||t,t.head.insertBefore(a,r==="title"?t.querySelector("head > title"):null)}function Dw(t,r,a){if(a===1||r.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(t=r.disabled,typeof r.precedence=="string"&&t==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function K0(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function Ow(t,r,a,l){if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var h=Po(l.href),m=r.querySelector(dc(h));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(t.count++,t=gd.bind(t),r.then(t,t)),a.state.loading|=4,a.instance=m,Ge(m);return}m=r.ownerDocument||r,l=G0(l),(h=Gr.get(h))&&Om(l,h),m=m.createElement("link"),Ge(m);var v=m;v._p=new Promise(function(T,U){v.onload=T,v.onerror=U}),Xn(m,"link",l),a.instance=m}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(t.count++,a=gd.bind(t),r.addEventListener("load",a),r.addEventListener("error",a))}}var Mm=0;function jw(t,r){return t.stylesheets&&t.count===0&&yd(t,t.stylesheets),0<t.count||0<t.imgCount?function(a){var l=setTimeout(function(){if(t.stylesheets&&yd(t,t.stylesheets),t.unsuspend){var m=t.unsuspend;t.unsuspend=null,m()}},6e4+r);0<t.imgBytes&&Mm===0&&(Mm=62500*hw());var h=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&yd(t,t.stylesheets),t.unsuspend)){var m=t.unsuspend;t.unsuspend=null,m()}},(t.imgBytes>Mm?50:800)+r);return t.unsuspend=a,function(){t.unsuspend=null,clearTimeout(l),clearTimeout(h)}}:null}function gd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)yd(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var pd=null;function yd(t,r){t.stylesheets=null,t.unsuspend!==null&&(t.count++,pd=new Map,r.forEach(Mw,t),pd=null,gd.call(t))}function Mw(t,r){if(!(r.state.loading&4)){var a=pd.get(t);if(a)var l=a.get(null);else{a=new Map,pd.set(t,a);for(var h=t.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<h.length;m++){var v=h[m];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(a.set(v.dataset.precedence,v),l=v)}l&&a.set(null,l)}h=r.instance,v=h.getAttribute("data-precedence"),m=a.get(v)||l,m===l&&a.set(null,h),a.set(v,h),this.count++,l=gd.bind(this),h.addEventListener("load",l),h.addEventListener("error",l),m?m.parentNode.insertBefore(h,m.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(h,t.firstChild)),r.state.loading|=4}}var fc={$$typeof:ee,Provider:null,Consumer:null,_currentValue:Ie,_currentValue2:Ie,_threadCount:0};function kw(t,r,a,l,h,m,v,T,U){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$e(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$e(0),this.hiddenUpdates=$e(null),this.identifierPrefix=l,this.onUncaughtError=h,this.onCaughtError=m,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function W0(t,r,a,l,h,m,v,T,U,Z,he,ye){return t=new kw(t,r,a,v,U,Z,he,ye,T),r=1,m===!0&&(r|=24),m=Ar(3,null,null,r),t.current=m,m.stateNode=t,r=hf(),r.refCount++,t.pooledCache=r,r.refCount++,m.memoizedState={element:l,isDehydrated:a,cache:r},pf(m),t}function X0(t){return t?(t=po,t):po}function J0(t,r,a,l,h,m){h=X0(h),l.context===null?l.context=h:l.pendingContext=h,l=Is(r),l.payload={element:a},m=m===void 0?null:m,m!==null&&(l.callback=m),a=Ds(t,l,r),a!==null&&(_r(a,t,r),Gl(a,t,r))}function Z0(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var a=t.retryLane;t.retryLane=a!==0&&a<r?a:r}}function km(t,r){Z0(t,r),(t=t.alternate)&&Z0(t,r)}function ev(t){if(t.tag===13||t.tag===31){var r=Ra(t,67108864);r!==null&&_r(r,t,67108864),km(t,67108864)}}function tv(t){if(t.tag===13||t.tag===31){var r=Or();r=Ni(r);var a=Ra(t,r);a!==null&&_r(a,t,r),km(t,r)}}var _d=!0;function Nw(t,r,a,l){var h=se.T;se.T=null;var m=$.p;try{$.p=2,Nm(t,r,a,l)}finally{$.p=m,se.T=h}}function Vw(t,r,a,l){var h=se.T;se.T=null;var m=$.p;try{$.p=8,Nm(t,r,a,l)}finally{$.p=m,se.T=h}}function Nm(t,r,a,l){if(_d){var h=Vm(l);if(h===null)Em(t,r,l,vd,a),rv(t,l);else if(Pw(h,t,r,a,l))l.stopPropagation();else if(rv(t,l),r&4&&-1<Lw.indexOf(t)){for(;h!==null;){var m=Oe(h);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var v=$n(m.pendingLanes);if(v!==0){var T=m;for(T.pendingLanes|=2,T.entangledLanes|=2;v;){var U=1<<31-Bt(v);T.entanglements[1]|=U,v&=~U}xi(m),(Lt&6)===0&&(td=ue()+500,oc(0))}}break;case 31:case 13:T=Ra(m,2),T!==null&&_r(T,m,2),rd(),km(m,2)}if(m=Vm(l),m===null&&Em(t,r,l,vd,a),m===h)break;h=m}h!==null&&l.stopPropagation()}else Em(t,r,l,null,a)}}function Vm(t){return t=Nr(t),Lm(t)}var vd=null;function Lm(t){if(vd=null,t=xe(t),t!==null){var r=c(t);if(r===null)t=null;else{var a=r.tag;if(a===13){if(t=d(r),t!==null)return t;t=null}else if(a===31){if(t=g(r),t!==null)return t;t=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null)}}return vd=t,null}function nv(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ae()){case pe:return 2;case ve:return 8;case Te:case Le:return 32;case Re:return 268435456;default:return 32}default:return 32}}var Pm=!1,Bs=null,Fs=null,Hs=null,mc=new Map,gc=new Map,qs=[],Lw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rv(t,r){switch(t){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":Fs=null;break;case"mouseover":case"mouseout":Hs=null;break;case"pointerover":case"pointerout":mc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":gc.delete(r.pointerId)}}function pc(t,r,a,l,h,m){return t===null||t.nativeEvent!==m?(t={blockedOn:r,domEventName:a,eventSystemFlags:l,nativeEvent:m,targetContainers:[h]},r!==null&&(r=Oe(r),r!==null&&ev(r)),t):(t.eventSystemFlags|=l,r=t.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),t)}function Pw(t,r,a,l,h){switch(r){case"focusin":return Bs=pc(Bs,t,r,a,l,h),!0;case"dragenter":return Fs=pc(Fs,t,r,a,l,h),!0;case"mouseover":return Hs=pc(Hs,t,r,a,l,h),!0;case"pointerover":var m=h.pointerId;return mc.set(m,pc(mc.get(m)||null,t,r,a,l,h)),!0;case"gotpointercapture":return m=h.pointerId,gc.set(m,pc(gc.get(m)||null,t,r,a,l,h)),!0}return!1}function iv(t){var r=xe(t.target);if(r!==null){var a=c(r);if(a!==null){if(r=a.tag,r===13){if(r=d(a),r!==null){t.blockedOn=r,Sr(t.priority,function(){tv(a)});return}}else if(r===31){if(r=g(a),r!==null){t.blockedOn=r,Sr(t.priority,function(){tv(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){t.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}t.blockedOn=null}function bd(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var a=Vm(t.nativeEvent);if(a===null){a=t.nativeEvent;var l=new a.constructor(a.type,a);Il=l,a.target.dispatchEvent(l),Il=null}else return r=Oe(a),r!==null&&ev(r),t.blockedOn=a,!1;r.shift()}return!0}function sv(t,r,a){bd(t)&&a.delete(r)}function zw(){Pm=!1,Bs!==null&&bd(Bs)&&(Bs=null),Fs!==null&&bd(Fs)&&(Fs=null),Hs!==null&&bd(Hs)&&(Hs=null),mc.forEach(sv),gc.forEach(sv)}function Ed(t,r){t.blockedOn===r&&(t.blockedOn=null,Pm||(Pm=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zw)))}var Sd=null;function av(t){Sd!==t&&(Sd=t,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Sd===t&&(Sd=null);for(var r=0;r<t.length;r+=3){var a=t[r],l=t[r+1],h=t[r+2];if(typeof l!="function"){if(Lm(l||a)===null)continue;break}var m=Oe(a);m!==null&&(t.splice(r,3),r-=3,Vf(m,{pending:!0,data:h,method:a.method,action:l},l,h))}}))}function Uo(t){function r(U){return Ed(U,t)}Bs!==null&&Ed(Bs,t),Fs!==null&&Ed(Fs,t),Hs!==null&&Ed(Hs,t),mc.forEach(r),gc.forEach(r);for(var a=0;a<qs.length;a++){var l=qs[a];l.blockedOn===t&&(l.blockedOn=null)}for(;0<qs.length&&(a=qs[0],a.blockedOn===null);)iv(a),a.blockedOn===null&&qs.shift();if(a=(t.ownerDocument||t).$$reactFormReplay,a!=null)for(l=0;l<a.length;l+=3){var h=a[l],m=a[l+1],v=h[Cn]||null;if(typeof m=="function")v||av(a);else if(v){var T=null;if(m&&m.hasAttribute("formAction")){if(h=m,v=m[Cn]||null)T=v.formAction;else if(Lm(h)!==null)continue}else T=v.action;typeof T=="function"?a[l+1]=T:(a.splice(l,3),l-=3),av(a)}}}function ov(){function t(m){m.canIntercept&&m.info==="react-transition"&&m.intercept({handler:function(){return new Promise(function(v){return h=v})},focusReset:"manual",scroll:"manual"})}function r(){h!==null&&(h(),h=null),l||setTimeout(a,20)}function a(){if(!l&&!navigation.transition){var m=navigation.currentEntry;m&&m.url!=null&&navigation.navigate(m.url,{state:m.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,h=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(a,100),function(){l=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),h!==null&&(h(),h=null)}}}function zm(t){this._internalRoot=t}Td.prototype.render=zm.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(s(409));var a=r.current,l=Or();J0(a,l,t,r,null,null)},Td.prototype.unmount=zm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;J0(t.current,2,null,t,null,null),rd(),r[kr]=null}};function Td(t){this._internalRoot=t}Td.prototype.unstable_scheduleHydration=function(t){if(t){var r=fs();t={blockedOn:null,target:t,priority:r};for(var a=0;a<qs.length&&r!==0&&r<qs[a].priority;a++);qs.splice(a,0,t),a===0&&iv(t)}};var lv=e.version;if(lv!=="19.2.3")throw Error(s(527,lv,"19.2.3"));$.findDOMNode=function(t){var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(s(188)):(t=Object.keys(t).join(","),Error(s(268,t)));return t=y(r),t=t!==null?b(t):null,t=t===null?null:t.stateNode,t};var Uw={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:se,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xd.isDisabled&&xd.supportsFiber)try{Ve=xd.inject(Uw),Xe=xd}catch{}}return _c.createRoot=function(t,r){if(!o(t))throw Error(s(299));var a=!1,l="",h=g_,m=p_,v=y_;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onUncaughtError!==void 0&&(h=r.onUncaughtError),r.onCaughtError!==void 0&&(m=r.onCaughtError),r.onRecoverableError!==void 0&&(v=r.onRecoverableError)),r=W0(t,1,!1,null,null,a,l,null,h,m,v,ov),t[kr]=r.current,bm(t),new zm(r)},_c.hydrateRoot=function(t,r,a){if(!o(t))throw Error(s(299));var l=!1,h="",m=g_,v=p_,T=y_,U=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(v=a.onCaughtError),a.onRecoverableError!==void 0&&(T=a.onRecoverableError),a.formState!==void 0&&(U=a.formState)),r=W0(t,1,!0,r,a??null,l,h,U,m,v,T,ov),r.context=X0(null),a=r.current,l=Or(),l=Ni(l),h=Is(l),h.callback=null,Ds(a,h,l),a=l,r.current.lanes=a,We(r,a),xi(r),t[kr]=r.current,bm(t),new Td(r)},_c.version="19.2.3",_c}var _v;function Ww(){if(_v)return Fm.exports;_v=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Fm.exports=Kw(),Fm.exports}var Xw=Ww();var vv="popstate";function Jw(i={}){function e(s,o){let{pathname:c,search:d,hash:g}=s.location;return ug("",{pathname:c,search:d,hash:g},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(s,o){return typeof o=="string"?o:jc(o)}return e1(e,n,null,i)}function un(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Qr(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Zw(){return Math.random().toString(36).substring(2,10)}function bv(i,e){return{usr:i.state,key:i.key,idx:e}}function ug(i,e,n=null,s){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?hl(e):e,state:n,key:e&&e.key||s||Zw()}}function jc({pathname:i="/",search:e="",hash:n=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(i+=n.charAt(0)==="#"?n:"#"+n),i}function hl(i){let e={};if(i){let n=i.indexOf("#");n>=0&&(e.hash=i.substring(n),i=i.substring(0,n));let s=i.indexOf("?");s>=0&&(e.search=i.substring(s),i=i.substring(0,s)),i&&(e.pathname=i)}return e}function e1(i,e,n,s={}){let{window:o=document.defaultView,v5Compat:c=!1}=s,d=o.history,g="POP",p=null,y=b();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function b(){return(d.state||{idx:null}).idx}function S(){g="POP";let M=b(),G=M==null?null:M-y;y=M,p&&p({action:g,location:O.location,delta:G})}function x(M,G){g="PUSH";let q=ug(O.location,M,G);y=b()+1;let ee=bv(q,y),Ce=O.createHref(q);try{d.pushState(ee,"",Ce)}catch(Me){if(Me instanceof DOMException&&Me.name==="DataCloneError")throw Me;o.location.assign(Ce)}c&&p&&p({action:g,location:O.location,delta:1})}function D(M,G){g="REPLACE";let q=ug(O.location,M,G);y=b();let ee=bv(q,y),Ce=O.createHref(q);d.replaceState(ee,"",Ce),c&&p&&p({action:g,location:O.location,delta:0})}function k(M){return t1(M)}let O={get action(){return g},get location(){return i(o,d)},listen(M){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(vv,S),p=M,()=>{o.removeEventListener(vv,S),p=null}},createHref(M){return e(o,M)},createURL:k,encodeLocation(M){let G=k(M);return{pathname:G.pathname,search:G.search,hash:G.hash}},push:x,replace:D,go(M){return d.go(M)}};return O}function t1(i,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),un(n,"No window.location.(origin|href) available to create URL");let s=typeof i=="string"?i:jc(i);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=n+s),new URL(s,n)}function hE(i,e,n="/"){return n1(i,e,n,!1)}function n1(i,e,n,s){let o=typeof e=="string"?hl(e):e,c=ss(o.pathname||"/",n);if(c==null)return null;let d=fE(i);r1(d);let g=null;for(let p=0;g==null&&p<d.length;++p){let y=m1(c);g=h1(d[p],y,s)}return g}function fE(i,e=[],n=[],s="",o=!1){let c=(d,g,p=o,y)=>{let b={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:g,route:d};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(s)&&p)return;un(b.relativePath.startsWith(s),`Absolute route path "${b.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(s.length)}let S=rs([s,b.relativePath]),x=n.concat(b);d.children&&d.children.length>0&&(un(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${S}".`),fE(d.children,e,x,S,p)),!(d.path==null&&!d.index)&&e.push({path:S,score:u1(S,d.index),routesMeta:x})};return i.forEach((d,g)=>{if(d.path===""||!d.path?.includes("?"))c(d,g);else for(let p of mE(d.path))c(d,g,!0,p)}),e}function mE(i){let e=i.split("/");if(e.length===0)return[];let[n,...s]=e,o=n.endsWith("?"),c=n.replace(/\?$/,"");if(s.length===0)return o?[c,""]:[c];let d=mE(s.join("/")),g=[];return g.push(...d.map(p=>p===""?c:[c,p].join("/"))),o&&g.push(...d),g.map(p=>i.startsWith("/")&&p===""?"/":p)}function r1(i){i.sort((e,n)=>e.score!==n.score?n.score-e.score:d1(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var i1=/^:[\w-]+$/,s1=3,a1=2,o1=1,l1=10,c1=-2,Ev=i=>i==="*";function u1(i,e){let n=i.split("/"),s=n.length;return n.some(Ev)&&(s+=c1),e&&(s+=a1),n.filter(o=>!Ev(o)).reduce((o,c)=>o+(i1.test(c)?s1:c===""?o1:l1),s)}function d1(i,e){return i.length===e.length&&i.slice(0,-1).every((s,o)=>s===e[o])?i[i.length-1]-e[e.length-1]:0}function h1(i,e,n=!1){let{routesMeta:s}=i,o={},c="/",d=[];for(let g=0;g<s.length;++g){let p=s[g],y=g===s.length-1,b=c==="/"?e:e.slice(c.length)||"/",S=Qd({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},b),x=p.route;if(!S&&y&&n&&!s[s.length-1].route.index&&(S=Qd({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},b)),!S)return null;Object.assign(o,S.params),d.push({params:o,pathname:rs([c,S.pathname]),pathnameBase:_1(rs([c,S.pathnameBase])),route:x}),S.pathnameBase!=="/"&&(c=rs([c,S.pathnameBase]))}return d}function Qd(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[n,s]=f1(i.path,i.caseSensitive,i.end),o=e.match(n);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),g=o.slice(1);return{params:s.reduce((y,{paramName:b,isOptional:S},x)=>{if(b==="*"){let k=g[x]||"";d=c.slice(0,c.length-k.length).replace(/(.)\/+$/,"$1")}const D=g[x];return S&&!D?y[b]=void 0:y[b]=(D||"").replace(/%2F/g,"/"),y},{}),pathname:c,pathnameBase:d,pattern:i}}function f1(i,e=!1,n=!0){Qr(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let s=[],o="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,g,p)=>(s.push({paramName:g,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(s.push({paramName:"*"}),o+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":i!==""&&i!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),s]}function m1(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qr(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function ss(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=i.charAt(n);return s&&s!=="/"?null:i.slice(n)||"/"}var gE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,g1=i=>gE.test(i);function p1(i,e="/"){let{pathname:n,search:s="",hash:o=""}=typeof i=="string"?hl(i):i,c;if(n)if(g1(n))c=n;else{if(n.includes("//")){let d=n;n=n.replace(/\/\/+/g,"/"),Qr(!1,`Pathnames cannot have embedded double slashes - normalizing ${d} -> ${n}`)}n.startsWith("/")?c=Sv(n.substring(1),"/"):c=Sv(n,e)}else c=e;return{pathname:c,search:v1(s),hash:b1(o)}}function Sv(i,e){let n=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function $m(i,e,n,s){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function y1(i){return i.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Ug(i){let e=y1(i);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function Bg(i,e,n,s=!1){let o;typeof i=="string"?o=hl(i):(o={...i},un(!o.pathname||!o.pathname.includes("?"),$m("?","pathname","search",o)),un(!o.pathname||!o.pathname.includes("#"),$m("#","pathname","hash",o)),un(!o.search||!o.search.includes("#"),$m("#","search","hash",o)));let c=i===""||o.pathname==="",d=c?"/":o.pathname,g;if(d==null)g=n;else{let S=e.length-1;if(!s&&d.startsWith("..")){let x=d.split("/");for(;x[0]==="..";)x.shift(),S-=1;o.pathname=x.join("/")}g=S>=0?e[S]:"/"}let p=p1(o,g),y=d&&d!=="/"&&d.endsWith("/"),b=(c||d===".")&&n.endsWith("/");return!p.pathname.endsWith("/")&&(y||b)&&(p.pathname+="/"),p}var rs=i=>i.join("/").replace(/\/\/+/g,"/"),_1=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),v1=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,b1=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i,E1=class{constructor(i,e,n,s=!1){this.status=i,this.statusText=e||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function S1(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}function T1(i){return i.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var pE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function yE(i,e){let n=i;if(typeof n!="string"||!gE.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let s=n,o=!1;if(pE)try{let c=new URL(window.location.href),d=n.startsWith("//")?new URL(c.protocol+n):new URL(n),g=ss(d.pathname,e);d.origin===c.origin&&g!=null?n=g+d.search+d.hash:o=!0}catch{Qr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:o,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var _E=["POST","PUT","PATCH","DELETE"];new Set(_E);var x1=["GET",..._E];new Set(x1);var fl=A.createContext(null);fl.displayName="DataRouter";var vh=A.createContext(null);vh.displayName="DataRouterState";var w1=A.createContext(!1),vE=A.createContext({isTransitioning:!1});vE.displayName="ViewTransition";var A1=A.createContext(new Map);A1.displayName="Fetchers";var C1=A.createContext(null);C1.displayName="Await";var Mr=A.createContext(null);Mr.displayName="Navigation";var Fc=A.createContext(null);Fc.displayName="Location";var hi=A.createContext({outlet:null,matches:[],isDataRoute:!1});hi.displayName="Route";var Fg=A.createContext(null);Fg.displayName="RouteError";var bE="REACT_ROUTER_ERROR",R1="REDIRECT",I1="ROUTE_ERROR_RESPONSE";function D1(i){if(i.startsWith(`${bE}:${R1}:{`))try{let e=JSON.parse(i.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function O1(i){if(i.startsWith(`${bE}:${I1}:{`))try{let e=JSON.parse(i.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new E1(e.status,e.statusText,e.data)}catch{}}function j1(i,{relative:e}={}){un(ml(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=A.useContext(Mr),{hash:o,pathname:c,search:d}=Hc(i,{relative:e}),g=c;return n!=="/"&&(g=c==="/"?n:rs([n,c])),s.createHref({pathname:g,search:d,hash:o})}function ml(){return A.useContext(Fc)!=null}function Kr(){return un(ml(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(Fc).location}var EE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function SE(i){A.useContext(Mr).static||A.useLayoutEffect(i)}function Hg(){let{isDataRoute:i}=A.useContext(hi);return i?Y1():M1()}function M1(){un(ml(),"useNavigate() may be used only in the context of a <Router> component.");let i=A.useContext(fl),{basename:e,navigator:n}=A.useContext(Mr),{matches:s}=A.useContext(hi),{pathname:o}=Kr(),c=JSON.stringify(Ug(s)),d=A.useRef(!1);return SE(()=>{d.current=!0}),A.useCallback((p,y={})=>{if(Qr(d.current,EE),!d.current)return;if(typeof p=="number"){n.go(p);return}let b=Bg(p,JSON.parse(c),o,y.relative==="path");i==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:rs([e,b.pathname])),(y.replace?n.replace:n.push)(b,y.state,y)},[e,n,c,o,i])}var k1=A.createContext(null);function N1(i){let e=A.useContext(hi).outlet;return A.useMemo(()=>e&&A.createElement(k1.Provider,{value:i},e),[e,i])}function Hc(i,{relative:e}={}){let{matches:n}=A.useContext(hi),{pathname:s}=Kr(),o=JSON.stringify(Ug(n));return A.useMemo(()=>Bg(i,JSON.parse(o),s,e==="path"),[i,o,s,e])}function V1(i,e){return TE(i,e)}function TE(i,e,n,s,o){un(ml(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=A.useContext(Mr),{matches:d}=A.useContext(hi),g=d[d.length-1],p=g?g.params:{},y=g?g.pathname:"/",b=g?g.pathnameBase:"/",S=g&&g.route;{let q=S&&S.path||"";wE(y,!S||q.endsWith("*")||q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${q}"> to <Route path="${q==="/"?"*":`${q}/*`}">.`)}let x=Kr(),D;if(e){let q=typeof e=="string"?hl(e):e;un(b==="/"||q.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${q.pathname}" was given in the \`location\` prop.`),D=q}else D=x;let k=D.pathname||"/",O=k;if(b!=="/"){let q=b.replace(/^\//,"").split("/");O="/"+k.replace(/^\//,"").split("/").slice(q.length).join("/")}let M=hE(i,{pathname:O});Qr(S||M!=null,`No routes matched location "${D.pathname}${D.search}${D.hash}" `),Qr(M==null||M[M.length-1].route.element!==void 0||M[M.length-1].route.Component!==void 0||M[M.length-1].route.lazy!==void 0,`Matched leaf route at location "${D.pathname}${D.search}${D.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let G=B1(M&&M.map(q=>Object.assign({},q,{params:Object.assign({},p,q.params),pathname:rs([b,c.encodeLocation?c.encodeLocation(q.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:q.pathname]),pathnameBase:q.pathnameBase==="/"?b:rs([b,c.encodeLocation?c.encodeLocation(q.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:q.pathnameBase])})),d,n,s,o);return e&&G?A.createElement(Fc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...D},navigationType:"POP"}},G):G}function L1(){let i=$1(),e=S1(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),n=i instanceof Error?i.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},c={padding:"2px 4px",backgroundColor:s},d=null;return console.error("Error handled by React Router default ErrorBoundary:",i),d=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:c},"ErrorBoundary")," or"," ",A.createElement("code",{style:c},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:o},n):null,d)}var P1=A.createElement(L1,null),xE=class extends A.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){this.props.onError?this.props.onError(i,e):console.error("React Router caught the following error during render",i)}render(){let i=this.state.error;if(this.context&&typeof i=="object"&&i&&"digest"in i&&typeof i.digest=="string"){const n=O1(i.digest);n&&(i=n)}let e=i!==void 0?A.createElement(hi.Provider,{value:this.props.routeContext},A.createElement(Fg.Provider,{value:i,children:this.props.component})):this.props.children;return this.context?A.createElement(z1,{error:i},e):e}};xE.contextType=w1;var Ym=new WeakMap;function z1({children:i,error:e}){let{basename:n}=A.useContext(Mr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let s=D1(e.digest);if(s){let o=Ym.get(e);if(o)throw o;let c=yE(s.location,n);if(pE&&!Ym.get(e))if(c.isExternal||s.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:s.replace}));throw Ym.set(e,d),d}return A.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return i}function U1({routeContext:i,match:e,children:n}){let s=A.useContext(fl);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),A.createElement(hi.Provider,{value:i},n)}function B1(i,e=[],n=null,s=null,o=null){if(i==null){if(!n)return null;if(n.errors)i=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)i=n.matches;else return null}let c=i,d=n?.errors;if(d!=null){let b=c.findIndex(S=>S.route.id&&d?.[S.route.id]!==void 0);un(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,b+1))}let g=!1,p=-1;if(n)for(let b=0;b<c.length;b++){let S=c[b];if((S.route.HydrateFallback||S.route.hydrateFallbackElement)&&(p=b),S.route.id){let{loaderData:x,errors:D}=n,k=S.route.loader&&!x.hasOwnProperty(S.route.id)&&(!D||D[S.route.id]===void 0);if(S.route.lazy||k){g=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}let y=n&&s?(b,S)=>{s(b,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:T1(n.matches),errorInfo:S})}:void 0;return c.reduceRight((b,S,x)=>{let D,k=!1,O=null,M=null;n&&(D=d&&S.route.id?d[S.route.id]:void 0,O=S.route.errorElement||P1,g&&(p<0&&x===0?(wE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),k=!0,M=null):p===x&&(k=!0,M=S.route.hydrateFallbackElement||null)));let G=e.concat(c.slice(0,x+1)),q=()=>{let ee;return D?ee=O:k?ee=M:S.route.Component?ee=A.createElement(S.route.Component,null):S.route.element?ee=S.route.element:ee=b,A.createElement(U1,{match:S,routeContext:{outlet:b,matches:G,isDataRoute:n!=null},children:ee})};return n&&(S.route.ErrorBoundary||S.route.errorElement||x===0)?A.createElement(xE,{location:n.location,revalidation:n.revalidation,component:O,error:D,children:q(),routeContext:{outlet:null,matches:G,isDataRoute:!0},onError:y}):q()},null)}function qg(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function F1(i){let e=A.useContext(fl);return un(e,qg(i)),e}function H1(i){let e=A.useContext(vh);return un(e,qg(i)),e}function q1(i){let e=A.useContext(hi);return un(e,qg(i)),e}function Gg(i){let e=q1(i),n=e.matches[e.matches.length-1];return un(n.route.id,`${i} can only be used on routes that contain a unique "id"`),n.route.id}function G1(){return Gg("useRouteId")}function $1(){let i=A.useContext(Fg),e=H1("useRouteError"),n=Gg("useRouteError");return i!==void 0?i:e.errors?.[n]}function Y1(){let{router:i}=F1("useNavigate"),e=Gg("useNavigate"),n=A.useRef(!1);return SE(()=>{n.current=!0}),A.useCallback(async(o,c={})=>{Qr(n.current,EE),n.current&&(typeof o=="number"?await i.navigate(o):await i.navigate(o,{fromRouteId:e,...c}))},[i,e])}var Tv={};function wE(i,e,n){!e&&!Tv[i]&&(Tv[i]=!0,Qr(!1,n))}A.memo(Q1);function Q1({routes:i,future:e,state:n,onError:s}){return TE(i,void 0,n,s,e)}function AE({to:i,replace:e,state:n,relative:s}){un(ml(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=A.useContext(Mr);Qr(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=A.useContext(hi),{pathname:d}=Kr(),g=Hg(),p=Bg(i,Ug(c),d,s==="path"),y=JSON.stringify(p);return A.useEffect(()=>{g(JSON.parse(y),{replace:e,state:n,relative:s})},[g,y,s,e,n]),null}function $g(i){return N1(i.context)}function dr(i){un(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function K1({basename:i="/",children:e=null,location:n,navigationType:s="POP",navigator:o,static:c=!1,unstable_useTransitions:d}){un(!ml(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let g=i.replace(/^\/*/,"/"),p=A.useMemo(()=>({basename:g,navigator:o,static:c,unstable_useTransitions:d,future:{}}),[g,o,c,d]);typeof n=="string"&&(n=hl(n));let{pathname:y="/",search:b="",hash:S="",state:x=null,key:D="default"}=n,k=A.useMemo(()=>{let O=ss(y,g);return O==null?null:{location:{pathname:O,search:b,hash:S,state:x,key:D},navigationType:s}},[g,y,b,S,x,D,s]);return Qr(k!=null,`<Router basename="${g}"> is not able to match the URL "${y}${b}${S}" because it does not start with the basename, so the <Router> won't render anything.`),k==null?null:A.createElement(Mr.Provider,{value:p},A.createElement(Fc.Provider,{children:e,value:k}))}function W1({children:i,location:e}){return V1(dg(i),e)}function dg(i,e=[]){let n=[];return A.Children.forEach(i,(s,o)=>{if(!A.isValidElement(s))return;let c=[...e,o];if(s.type===A.Fragment){n.push.apply(n,dg(s.props.children,c));return}un(s.type===dr,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),un(!s.props.index||!s.props.children,"An index route cannot have child routes.");let d={id:s.props.id||c.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=dg(s.props.children,c)),n.push(d)}),n}var Vd="get",Ld="application/x-www-form-urlencoded";function bh(i){return typeof HTMLElement<"u"&&i instanceof HTMLElement}function X1(i){return bh(i)&&i.tagName.toLowerCase()==="button"}function J1(i){return bh(i)&&i.tagName.toLowerCase()==="form"}function Z1(i){return bh(i)&&i.tagName.toLowerCase()==="input"}function eA(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function tA(i,e){return i.button===0&&(!e||e==="_self")&&!eA(i)}var wd=null;function nA(){if(wd===null)try{new FormData(document.createElement("form"),0),wd=!1}catch{wd=!0}return wd}var rA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Qm(i){return i!=null&&!rA.has(i)?(Qr(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ld}"`),null):i}function iA(i,e){let n,s,o,c,d;if(J1(i)){let g=i.getAttribute("action");s=g?ss(g,e):null,n=i.getAttribute("method")||Vd,o=Qm(i.getAttribute("enctype"))||Ld,c=new FormData(i)}else if(X1(i)||Z1(i)&&(i.type==="submit"||i.type==="image")){let g=i.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=i.getAttribute("formaction")||g.getAttribute("action");if(s=p?ss(p,e):null,n=i.getAttribute("formmethod")||g.getAttribute("method")||Vd,o=Qm(i.getAttribute("formenctype"))||Qm(g.getAttribute("enctype"))||Ld,c=new FormData(g,i),!nA()){let{name:y,type:b,value:S}=i;if(b==="image"){let x=y?`${y}.`:"";c.append(`${x}x`,"0"),c.append(`${x}y`,"0")}else y&&c.append(y,S)}}else{if(bh(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Vd,s=null,o=Ld,d=i}return c&&o==="text/plain"&&(d=c,c=void 0),{action:s,method:n.toLowerCase(),encType:o,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Yg(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function sA(i,e,n){let s=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return s.pathname==="/"?s.pathname=`_root.${n}`:e&&ss(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function aA(i,e){if(i.id in e)return e[i.id];try{let n=await import(i.module);return e[i.id]=n,n}catch(n){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function oA(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function lA(i,e,n){let s=await Promise.all(i.map(async o=>{let c=e.routes[o.route.id];if(c){let d=await aA(c,n);return d.links?d.links():[]}return[]}));return hA(s.flat(1).filter(oA).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function xv(i,e,n,s,o,c){let d=(p,y)=>n[y]?p.route.id!==n[y].route.id:!0,g=(p,y)=>n[y].pathname!==p.pathname||n[y].route.path?.endsWith("*")&&n[y].params["*"]!==p.params["*"];return c==="assets"?e.filter((p,y)=>d(p,y)||g(p,y)):c==="data"?e.filter((p,y)=>{let b=s.routes[p.route.id];if(!b||!b.hasLoader)return!1;if(d(p,y)||g(p,y))return!0;if(p.route.shouldRevalidate){let S=p.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof S=="boolean")return S}return!0}):[]}function cA(i,e,{includeHydrateFallback:n}={}){return uA(i.map(s=>{let o=e.routes[s.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function uA(i){return[...new Set(i)]}function dA(i){let e={},n=Object.keys(i).sort();for(let s of n)e[s]=i[s];return e}function hA(i,e){let n=new Set;return new Set(e),i.reduce((s,o)=>{let c=JSON.stringify(dA(o));return n.has(c)||(n.add(c),s.push({key:c,link:o})),s},[])}function CE(){let i=A.useContext(fl);return Yg(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function fA(){let i=A.useContext(vh);return Yg(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var Qg=A.createContext(void 0);Qg.displayName="FrameworkContext";function RE(){let i=A.useContext(Qg);return Yg(i,"You must render this element inside a <HydratedRouter> element"),i}function mA(i,e){let n=A.useContext(Qg),[s,o]=A.useState(!1),[c,d]=A.useState(!1),{onFocus:g,onBlur:p,onMouseEnter:y,onMouseLeave:b,onTouchStart:S}=e,x=A.useRef(null);A.useEffect(()=>{if(i==="render"&&d(!0),i==="viewport"){let O=G=>{G.forEach(q=>{d(q.isIntersecting)})},M=new IntersectionObserver(O,{threshold:.5});return x.current&&M.observe(x.current),()=>{M.disconnect()}}},[i]),A.useEffect(()=>{if(s){let O=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(O)}}},[s]);let D=()=>{o(!0)},k=()=>{o(!1),d(!1)};return n?i!=="intent"?[c,x,{}]:[c,x,{onFocus:vc(g,D),onBlur:vc(p,k),onMouseEnter:vc(y,D),onMouseLeave:vc(b,k),onTouchStart:vc(S,D)}]:[!1,x,{}]}function vc(i,e){return n=>{i&&i(n),n.defaultPrevented||e(n)}}function gA({page:i,...e}){let{router:n}=CE(),s=A.useMemo(()=>hE(n.routes,i,n.basename),[n.routes,i,n.basename]);return s?A.createElement(yA,{page:i,matches:s,...e}):null}function pA(i){let{manifest:e,routeModules:n}=RE(),[s,o]=A.useState([]);return A.useEffect(()=>{let c=!1;return lA(i,e,n).then(d=>{c||o(d)}),()=>{c=!0}},[i,e,n]),s}function yA({page:i,matches:e,...n}){let s=Kr(),{manifest:o,routeModules:c}=RE(),{basename:d}=CE(),{loaderData:g,matches:p}=fA(),y=A.useMemo(()=>xv(i,e,p,o,s,"data"),[i,e,p,o,s]),b=A.useMemo(()=>xv(i,e,p,o,s,"assets"),[i,e,p,o,s]),S=A.useMemo(()=>{if(i===s.pathname+s.search+s.hash)return[];let k=new Set,O=!1;if(e.forEach(G=>{let q=o.routes[G.route.id];!q||!q.hasLoader||(!y.some(ee=>ee.route.id===G.route.id)&&G.route.id in g&&c[G.route.id]?.shouldRevalidate||q.hasClientLoader?O=!0:k.add(G.route.id))}),k.size===0)return[];let M=sA(i,d,"data");return O&&k.size>0&&M.searchParams.set("_routes",e.filter(G=>k.has(G.route.id)).map(G=>G.route.id).join(",")),[M.pathname+M.search]},[d,g,s,o,y,e,i,c]),x=A.useMemo(()=>cA(b,o),[b,o]),D=pA(b);return A.createElement(A.Fragment,null,S.map(k=>A.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...n})),x.map(k=>A.createElement("link",{key:k,rel:"modulepreload",href:k,...n})),D.map(({key:k,link:O})=>A.createElement("link",{key:k,nonce:n.nonce,...O})))}function _A(...i){return e=>{i.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var vA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{vA&&(window.__reactRouterVersion="7.11.0")}catch{}function bA({basename:i,children:e,unstable_useTransitions:n,window:s}){let o=A.useRef();o.current==null&&(o.current=Jw({window:s,v5Compat:!0}));let c=o.current,[d,g]=A.useState({action:c.action,location:c.location}),p=A.useCallback(y=>{n===!1?g(y):A.startTransition(()=>g(y))},[n]);return A.useLayoutEffect(()=>c.listen(p),[c,p]),A.createElement(K1,{basename:i,children:e,location:d.location,navigationType:d.action,navigator:c,unstable_useTransitions:n})}var IE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hn=A.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:o,reloadDocument:c,replace:d,state:g,target:p,to:y,preventScrollReset:b,viewTransition:S,unstable_defaultShouldRevalidate:x,...D},k){let{basename:O,unstable_useTransitions:M}=A.useContext(Mr),G=typeof y=="string"&&IE.test(y),q=yE(y,O);y=q.to;let ee=j1(y,{relative:o}),[Ce,Me,Se]=mA(s,D),R=xA(y,{replace:d,state:g,target:p,preventScrollReset:b,relative:o,viewTransition:S,unstable_defaultShouldRevalidate:x,unstable_useTransitions:M});function C(L){e&&e(L),L.defaultPrevented||R(L)}let I=A.createElement("a",{...D,...Se,href:q.absoluteURL||ee,onClick:q.isExternal||c?e:C,ref:_A(k,Me),target:p,"data-discover":!G&&n==="render"?"true":void 0});return Ce&&!G?A.createElement(A.Fragment,null,I,A.createElement(gA,{page:ee})):I});hn.displayName="Link";var EA=A.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:o=!1,style:c,to:d,viewTransition:g,children:p,...y},b){let S=Hc(d,{relative:y.relative}),x=Kr(),D=A.useContext(vh),{navigator:k,basename:O}=A.useContext(Mr),M=D!=null&&IA(S)&&g===!0,G=k.encodeLocation?k.encodeLocation(S).pathname:S.pathname,q=x.pathname,ee=D&&D.navigation&&D.navigation.location?D.navigation.location.pathname:null;n||(q=q.toLowerCase(),ee=ee?ee.toLowerCase():null,G=G.toLowerCase()),ee&&O&&(ee=ss(ee,O)||ee);const Ce=G!=="/"&&G.endsWith("/")?G.length-1:G.length;let Me=q===G||!o&&q.startsWith(G)&&q.charAt(Ce)==="/",Se=ee!=null&&(ee===G||!o&&ee.startsWith(G)&&ee.charAt(G.length)==="/"),R={isActive:Me,isPending:Se,isTransitioning:M},C=Me?e:void 0,I;typeof s=="function"?I=s(R):I=[s,Me?"active":null,Se?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let L=typeof c=="function"?c(R):c;return A.createElement(hn,{...y,"aria-current":C,className:I,ref:b,style:L,to:d,viewTransition:g},typeof p=="function"?p(R):p)});EA.displayName="NavLink";var SA=A.forwardRef(({discover:i="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:o,state:c,method:d=Vd,action:g,onSubmit:p,relative:y,preventScrollReset:b,viewTransition:S,unstable_defaultShouldRevalidate:x,...D},k)=>{let{unstable_useTransitions:O}=A.useContext(Mr),M=CA(),G=RA(g,{relative:y}),q=d.toLowerCase()==="get"?"get":"post",ee=typeof g=="string"&&IE.test(g),Ce=Me=>{if(p&&p(Me),Me.defaultPrevented)return;Me.preventDefault();let Se=Me.nativeEvent.submitter,R=Se?.getAttribute("formmethod")||d,C=()=>M(Se||Me.currentTarget,{fetcherKey:e,method:R,navigate:n,replace:o,state:c,relative:y,preventScrollReset:b,viewTransition:S,unstable_defaultShouldRevalidate:x});O&&n!==!1?A.startTransition(()=>C()):C()};return A.createElement("form",{ref:k,method:q,action:G,onSubmit:s?p:Ce,...D,"data-discover":!ee&&i==="render"?"true":void 0})});SA.displayName="Form";function TA(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function DE(i){let e=A.useContext(fl);return un(e,TA(i)),e}function xA(i,{target:e,replace:n,state:s,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:g,unstable_useTransitions:p}={}){let y=Hg(),b=Kr(),S=Hc(i,{relative:c});return A.useCallback(x=>{if(tA(x,e)){x.preventDefault();let D=n!==void 0?n:jc(b)===jc(S),k=()=>y(i,{replace:D,state:s,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:g});p?A.startTransition(()=>k()):k()}},[b,y,S,n,s,e,i,o,c,d,g,p])}var wA=0,AA=()=>`__${String(++wA)}__`;function CA(){let{router:i}=DE("useSubmit"),{basename:e}=A.useContext(Mr),n=G1(),s=i.fetch,o=i.navigate;return A.useCallback(async(c,d={})=>{let{action:g,method:p,encType:y,formData:b,body:S}=iA(c,e);if(d.navigate===!1){let x=d.fetcherKey||AA();await s(x,n,d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:S,formMethod:d.method||p,formEncType:d.encType||y,flushSync:d.flushSync})}else await o(d.action||g,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:b,body:S,formMethod:d.method||p,formEncType:d.encType||y,replace:d.replace,state:d.state,fromRouteId:n,flushSync:d.flushSync,viewTransition:d.viewTransition})},[s,o,e,n])}function RA(i,{relative:e}={}){let{basename:n}=A.useContext(Mr),s=A.useContext(hi);un(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),c={...Hc(i||".",{relative:e})},d=Kr();if(i==null){c.search=d.search;let g=new URLSearchParams(c.search),p=g.getAll("index");if(p.some(b=>b==="")){g.delete("index"),p.filter(S=>S).forEach(S=>g.append("index",S));let b=g.toString();c.search=b?`?${b}`:""}}return(!i||i===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(c.pathname=c.pathname==="/"?n:rs([n,c.pathname])),jc(c)}function IA(i,{relative:e}={}){let n=A.useContext(vE);un(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=DE("useViewTransitionState"),o=Hc(i,{relative:e});if(!n.isTransitioning)return!1;let c=ss(n.currentLocation.pathname,s)||n.currentLocation.pathname,d=ss(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Qd(o.pathname,d)!=null||Qd(o.pathname,c)!=null}const DA=function(){},OA={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:DA},qc=A.createContext(OA),jA=()=>{};var wv={};const OE=function(i){const e=[];let n=0;for(let s=0;s<i.length;s++){let o=i.charCodeAt(s);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&s+1<i.length&&(i.charCodeAt(s+1)&64512)===56320?(o=65536+((o&1023)<<10)+(i.charCodeAt(++s)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},MA=function(i){const e=[];let n=0,s=0;for(;n<i.length;){const o=i[n++];if(o<128)e[s++]=String.fromCharCode(o);else if(o>191&&o<224){const c=i[n++];e[s++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=i[n++],d=i[n++],g=i[n++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|g&63)-65536;e[s++]=String.fromCharCode(55296+(p>>10)),e[s++]=String.fromCharCode(56320+(p&1023))}else{const c=i[n++],d=i[n++];e[s++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},jE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let o=0;o<i.length;o+=3){const c=i[o],d=o+1<i.length,g=d?i[o+1]:0,p=o+2<i.length,y=p?i[o+2]:0,b=c>>2,S=(c&3)<<4|g>>4;let x=(g&15)<<2|y>>6,D=y&63;p||(D=64,d||(x=64)),s.push(n[b],n[S],n[x],n[D])}return s.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(OE(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):MA(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let o=0;o<i.length;){const c=n[i.charAt(o++)],g=o<i.length?n[i.charAt(o)]:0;++o;const y=o<i.length?n[i.charAt(o)]:64;++o;const S=o<i.length?n[i.charAt(o)]:64;if(++o,c==null||g==null||y==null||S==null)throw new kA;const x=c<<2|g>>4;if(s.push(x),y!==64){const D=g<<4&240|y>>2;if(s.push(D),S!==64){const k=y<<6&192|S;s.push(k)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class kA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const NA=function(i){const e=OE(i);return jE.encodeByteArray(e,!0)},Kd=function(i){return NA(i).replace(/\./g,"")},ME=function(i){try{return jE.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function VA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const LA=()=>VA().__FIREBASE_DEFAULTS__,PA=()=>{if(typeof process>"u"||typeof wv>"u")return;const i=wv.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},zA=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&ME(i[1]);return e&&JSON.parse(e)},Eh=()=>{try{return jA()||LA()||PA()||zA()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},kE=i=>Eh()?.emulatorHosts?.[i],UA=i=>{const e=kE(i);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},NE=()=>Eh()?.config,VE=i=>Eh()?.[`_${i}`];class BA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}function gl(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function LE(i){return(await fetch(i,{credentials:"include"})).ok}function FA(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",o=i.iat||0,c=i.sub||i.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${s}`,aud:s,iat:o,exp:o+3600,auth_time:o,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}},...i};return[Kd(JSON.stringify(n)),Kd(JSON.stringify(d)),""].join(".")}const Ac={};function HA(){const i={prod:[],emulator:[]};for(const e of Object.keys(Ac))Ac[e]?i.emulator.push(e):i.prod.push(e);return i}function qA(i){let e=document.getElementById(i),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),n=!0),{created:n,element:e}}let Av=!1;function PE(i,e){if(typeof window>"u"||typeof document>"u"||!gl(window.location.host)||Ac[i]===e||Ac[i]||Av)return;Ac[i]=e;function n(x){return`__firebase__banner__${x}`}const s="__firebase__banner",c=HA().prod.length>0;function d(){const x=document.getElementById(s);x&&x.remove()}function g(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function p(x,D){x.setAttribute("width","24"),x.setAttribute("id",D),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function y(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{Av=!0,d()},x}function b(x,D){x.setAttribute("id",D),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function S(){const x=qA(s),D=n("text"),k=document.getElementById(D)||document.createElement("span"),O=n("learnmore"),M=document.getElementById(O)||document.createElement("a"),G=n("preprendIcon"),q=document.getElementById(G)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const ee=x.element;g(ee),b(M,O);const Ce=y();p(q,G),ee.append(q,k,M,Ce),document.body.appendChild(ee)}c?(k.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",D)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",S):S()}function ar(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function GA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ar())}function $A(){const i=Eh()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function QA(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function KA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function WA(){const i=ar();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function XA(){return!$A()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function JA(){try{return typeof indexedDB=="object"}catch{return!1}}function ZA(){return new Promise((i,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(s);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(s),i(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(n){e(n)}})}const eC="FirebaseError";class ds extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=eC,Object.setPrototypeOf(this,ds.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gc.prototype.create)}}class Gc{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?tC(c,s):"Error",g=`${this.serviceName}: ${d} (${o}).`;return new ds(o,g,s)}}function tC(i,e){return i.replace(nC,(n,s)=>{const o=e[s];return o!=null?String(o):`<${s}?>`})}const nC=/\{\$([^}]+)}/g;function rC(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}function aa(i,e){if(i===e)return!0;const n=Object.keys(i),s=Object.keys(e);for(const o of n){if(!s.includes(o))return!1;const c=i[o],d=e[o];if(Cv(c)&&Cv(d)){if(!aa(c,d))return!1}else if(c!==d)return!1}for(const o of s)if(!n.includes(o))return!1;return!0}function Cv(i){return i!==null&&typeof i=="object"}function $c(i){const e=[];for(const[n,s]of Object.entries(i))Array.isArray(s)?s.forEach(o=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function bc(i){const e={};return i.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[o,c]=s.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function Ec(i){const e=i.indexOf("?");if(!e)return"";const n=i.indexOf("#",e);return i.substring(e,n>0?n:void 0)}function iC(i,e){const n=new sC(i,e);return n.subscribe.bind(n)}class sC{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let o;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");aC(e,["next","error","complete"])?o=e:o={next:e,error:n,complete:s},o.next===void 0&&(o.next=Km),o.error===void 0&&(o.error=Km),o.complete===void 0&&(o.complete=Km);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function aC(i,e){if(typeof i!="object"||i===null)return!1;for(const n of e)if(n in i&&typeof i[n]=="function")return!0;return!1}function Km(){}function qn(i){return i&&i._delegate?i._delegate:i}class $a{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ba="[DEFAULT]";class oC{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new BA;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:n});o&&s.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),s=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cC(e))try{this.getOrInitializeService({instanceIdentifier:Ba})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(n);try{const c=this.getOrInitializeService({instanceIdentifier:o});s.resolve(c)}catch{}}}}clearInstance(e=Ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ba){return this.instances.has(e)}getOptions(e=Ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[c,d]of this.instancesDeferred.entries()){const g=this.normalizeInstanceIdentifier(c);s===g&&d.resolve(o)}return o}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),o=this.onInitCallbacks.get(s)??new Set;o.add(e),this.onInitCallbacks.set(s,o);const c=this.instances.get(s);return c&&e(c,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const o of s)try{o(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:lC(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Ba){return this.component?this.component.multipleInstances?e:Ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lC(i){return i===Ba?void 0:i}function cC(i){return i.instantiationMode==="EAGER"}class uC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new oC(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var wt;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(wt||(wt={}));const dC={debug:wt.DEBUG,verbose:wt.VERBOSE,info:wt.INFO,warn:wt.WARN,error:wt.ERROR,silent:wt.SILENT},hC=wt.INFO,fC={[wt.DEBUG]:"log",[wt.VERBOSE]:"log",[wt.INFO]:"info",[wt.WARN]:"warn",[wt.ERROR]:"error"},mC=(i,e,...n)=>{if(e<i.logLevel)return;const s=new Date().toISOString(),o=fC[e];if(o)console[o](`[${s}]  ${i.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Kg{constructor(e){this.name=e,this._logLevel=hC,this._logHandler=mC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in wt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,wt.DEBUG,...e),this._logHandler(this,wt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,wt.VERBOSE,...e),this._logHandler(this,wt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,wt.INFO,...e),this._logHandler(this,wt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,wt.WARN,...e),this._logHandler(this,wt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,wt.ERROR,...e),this._logHandler(this,wt.ERROR,...e)}}const gC=(i,e)=>e.some(n=>i instanceof n);let Rv,Iv;function pC(){return Rv||(Rv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yC(){return Iv||(Iv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const zE=new WeakMap,hg=new WeakMap,UE=new WeakMap,Wm=new WeakMap,Wg=new WeakMap;function _C(i){const e=new Promise((n,s)=>{const o=()=>{i.removeEventListener("success",c),i.removeEventListener("error",d)},c=()=>{n(ea(i.result)),o()},d=()=>{s(i.error),o()};i.addEventListener("success",c),i.addEventListener("error",d)});return e.then(n=>{n instanceof IDBCursor&&zE.set(n,i)}).catch(()=>{}),Wg.set(e,i),e}function vC(i){if(hg.has(i))return;const e=new Promise((n,s)=>{const o=()=>{i.removeEventListener("complete",c),i.removeEventListener("error",d),i.removeEventListener("abort",d)},c=()=>{n(),o()},d=()=>{s(i.error||new DOMException("AbortError","AbortError")),o()};i.addEventListener("complete",c),i.addEventListener("error",d),i.addEventListener("abort",d)});hg.set(i,e)}let fg={get(i,e,n){if(i instanceof IDBTransaction){if(e==="done")return hg.get(i);if(e==="objectStoreNames")return i.objectStoreNames||UE.get(i);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ea(i[e])},set(i,e,n){return i[e]=n,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function bC(i){fg=i(fg)}function EC(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=i.call(Xm(this),e,...n);return UE.set(s,e.sort?e.sort():[e]),ea(s)}:yC().includes(i)?function(...e){return i.apply(Xm(this),e),ea(zE.get(this))}:function(...e){return ea(i.apply(Xm(this),e))}}function SC(i){return typeof i=="function"?EC(i):(i instanceof IDBTransaction&&vC(i),gC(i,pC())?new Proxy(i,fg):i)}function ea(i){if(i instanceof IDBRequest)return _C(i);if(Wm.has(i))return Wm.get(i);const e=SC(i);return e!==i&&(Wm.set(i,e),Wg.set(e,i)),e}const Xm=i=>Wg.get(i);function TC(i,e,{blocked:n,upgrade:s,blocking:o,terminated:c}={}){const d=indexedDB.open(i,e),g=ea(d);return s&&d.addEventListener("upgradeneeded",p=>{s(ea(d.result),p.oldVersion,p.newVersion,ea(d.transaction),p)}),n&&d.addEventListener("blocked",p=>n(p.oldVersion,p.newVersion,p)),g.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",y=>o(y.oldVersion,y.newVersion,y))}).catch(()=>{}),g}const xC=["get","getKey","getAll","getAllKeys","count"],wC=["put","add","delete","clear"],Jm=new Map;function Dv(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(Jm.get(e))return Jm.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,o=wC.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(o||xC.includes(n)))return;const c=async function(d,...g){const p=this.transaction(d,o?"readwrite":"readonly");let y=p.store;return s&&(y=y.index(g.shift())),(await Promise.all([y[n](...g),o&&p.done]))[0]};return Jm.set(e,c),c}bC(i=>({...i,get:(e,n,s)=>Dv(e,n)||i.get(e,n,s),has:(e,n)=>!!Dv(e,n)||i.has(e,n)}));class AC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(CC(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function CC(i){return i.getComponent()?.type==="VERSION"}const mg="@firebase/app",Ov="0.14.6";const as=new Kg("@firebase/app"),RC="@firebase/app-compat",IC="@firebase/analytics-compat",DC="@firebase/analytics",OC="@firebase/app-check-compat",jC="@firebase/app-check",MC="@firebase/auth",kC="@firebase/auth-compat",NC="@firebase/database",VC="@firebase/data-connect",LC="@firebase/database-compat",PC="@firebase/functions",zC="@firebase/functions-compat",UC="@firebase/installations",BC="@firebase/installations-compat",FC="@firebase/messaging",HC="@firebase/messaging-compat",qC="@firebase/performance",GC="@firebase/performance-compat",$C="@firebase/remote-config",YC="@firebase/remote-config-compat",QC="@firebase/storage",KC="@firebase/storage-compat",WC="@firebase/firestore",XC="@firebase/ai",JC="@firebase/firestore-compat",ZC="firebase",eR="12.6.0";const gg="[DEFAULT]",tR={[mg]:"fire-core",[RC]:"fire-core-compat",[DC]:"fire-analytics",[IC]:"fire-analytics-compat",[jC]:"fire-app-check",[OC]:"fire-app-check-compat",[MC]:"fire-auth",[kC]:"fire-auth-compat",[NC]:"fire-rtdb",[VC]:"fire-data-connect",[LC]:"fire-rtdb-compat",[PC]:"fire-fn",[zC]:"fire-fn-compat",[UC]:"fire-iid",[BC]:"fire-iid-compat",[FC]:"fire-fcm",[HC]:"fire-fcm-compat",[qC]:"fire-perf",[GC]:"fire-perf-compat",[$C]:"fire-rc",[YC]:"fire-rc-compat",[QC]:"fire-gcs",[KC]:"fire-gcs-compat",[WC]:"fire-fst",[JC]:"fire-fst-compat",[XC]:"fire-vertex","fire-js":"fire-js",[ZC]:"fire-js-all"};const Wd=new Map,nR=new Map,pg=new Map;function jv(i,e){try{i.container.addComponent(e)}catch(n){as.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,n)}}function tl(i){const e=i.name;if(pg.has(e))return as.debug(`There were multiple attempts to register component ${e}.`),!1;pg.set(e,i);for(const n of Wd.values())jv(n,i);for(const n of nR.values())jv(n,i);return!0}function Xg(i,e){const n=i.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),i.container.getProvider(e)}function li(i){return i==null?!1:i.settings!==void 0}const rR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ta=new Gc("app","Firebase",rR);class iR{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new $a("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ta.create("app-deleted",{appName:this._name})}}const pl=eR;function BE(i,e={}){let n=i;typeof e!="object"&&(e={name:e});const s={name:gg,automaticDataCollectionEnabled:!0,...e},o=s.name;if(typeof o!="string"||!o)throw ta.create("bad-app-name",{appName:String(o)});if(n||(n=NE()),!n)throw ta.create("no-options");const c=Wd.get(o);if(c){if(aa(n,c.options)&&aa(s,c.config))return c;throw ta.create("duplicate-app",{appName:o})}const d=new uC(o);for(const p of pg.values())d.addComponent(p);const g=new iR(n,s,d);return Wd.set(o,g),g}function FE(i=gg){const e=Wd.get(i);if(!e&&i===gg&&NE())return BE();if(!e)throw ta.create("no-app",{appName:i});return e}function na(i,e,n){let s=tR[i]??i;n&&(s+=`-${n}`);const o=s.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const d=[`Unable to register library "${s}" with version "${e}":`];o&&d.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),as.warn(d.join(" "));return}tl(new $a(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const sR="firebase-heartbeat-database",aR=1,Mc="firebase-heartbeat-store";let Zm=null;function HE(){return Zm||(Zm=TC(sR,aR,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Mc)}catch(n){console.warn(n)}}}}).catch(i=>{throw ta.create("idb-open",{originalErrorMessage:i.message})})),Zm}async function oR(i){try{const n=(await HE()).transaction(Mc),s=await n.objectStore(Mc).get(qE(i));return await n.done,s}catch(e){if(e instanceof ds)as.warn(e.message);else{const n=ta.create("idb-get",{originalErrorMessage:e?.message});as.warn(n.message)}}}async function Mv(i,e){try{const s=(await HE()).transaction(Mc,"readwrite");await s.objectStore(Mc).put(e,qE(i)),await s.done}catch(n){if(n instanceof ds)as.warn(n.message);else{const s=ta.create("idb-set",{originalErrorMessage:n?.message});as.warn(s.message)}}}function qE(i){return`${i.name}!${i.options.appId}`}const lR=1024,cR=30;class uR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new hR(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=kv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats.length>cR){const o=fR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){as.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=kv(),{heartbeatsToSend:n,unsentEntries:s}=dR(this._heartbeatsCache.heartbeats),o=Kd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return as.warn(e),""}}}function kv(){return new Date().toISOString().substring(0,10)}function dR(i,e=lR){const n=[];let s=i.slice();for(const o of i){const c=n.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),Nv(n)>e){c.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),Nv(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class hR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return JA()?ZA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await oR(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Mv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Mv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Nv(i){return Kd(JSON.stringify({version:2,heartbeats:i})).length}function fR(i){if(i.length===0)return-1;let e=0,n=i[0].date;for(let s=1;s<i.length;s++)i[s].date<n&&(n=i[s].date,e=s);return e}function mR(i){tl(new $a("platform-logger",e=>new AC(e),"PRIVATE")),tl(new $a("heartbeat",e=>new uR(e),"PRIVATE")),na(mg,Ov,i),na(mg,Ov,"esm2020"),na("fire-js","")}mR("");var Vv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ra,GE;(function(){var i;function e(R,C){function I(){}I.prototype=C.prototype,R.F=C.prototype,R.prototype=new I,R.prototype.constructor=R,R.D=function(L,N,B){for(var j=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)j[Fe-2]=arguments[Fe];return C.prototype[N].apply(L,j)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,n),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(R,C,I){I||(I=0);const L=Array(16);if(typeof C=="string")for(var N=0;N<16;++N)L[N]=C.charCodeAt(I++)|C.charCodeAt(I++)<<8|C.charCodeAt(I++)<<16|C.charCodeAt(I++)<<24;else for(N=0;N<16;++N)L[N]=C[I++]|C[I++]<<8|C[I++]<<16|C[I++]<<24;C=R.g[0],I=R.g[1],N=R.g[2];let B=R.g[3],j;j=C+(B^I&(N^B))+L[0]+3614090360&4294967295,C=I+(j<<7&4294967295|j>>>25),j=B+(N^C&(I^N))+L[1]+3905402710&4294967295,B=C+(j<<12&4294967295|j>>>20),j=N+(I^B&(C^I))+L[2]+606105819&4294967295,N=B+(j<<17&4294967295|j>>>15),j=I+(C^N&(B^C))+L[3]+3250441966&4294967295,I=N+(j<<22&4294967295|j>>>10),j=C+(B^I&(N^B))+L[4]+4118548399&4294967295,C=I+(j<<7&4294967295|j>>>25),j=B+(N^C&(I^N))+L[5]+1200080426&4294967295,B=C+(j<<12&4294967295|j>>>20),j=N+(I^B&(C^I))+L[6]+2821735955&4294967295,N=B+(j<<17&4294967295|j>>>15),j=I+(C^N&(B^C))+L[7]+4249261313&4294967295,I=N+(j<<22&4294967295|j>>>10),j=C+(B^I&(N^B))+L[8]+1770035416&4294967295,C=I+(j<<7&4294967295|j>>>25),j=B+(N^C&(I^N))+L[9]+2336552879&4294967295,B=C+(j<<12&4294967295|j>>>20),j=N+(I^B&(C^I))+L[10]+4294925233&4294967295,N=B+(j<<17&4294967295|j>>>15),j=I+(C^N&(B^C))+L[11]+2304563134&4294967295,I=N+(j<<22&4294967295|j>>>10),j=C+(B^I&(N^B))+L[12]+1804603682&4294967295,C=I+(j<<7&4294967295|j>>>25),j=B+(N^C&(I^N))+L[13]+4254626195&4294967295,B=C+(j<<12&4294967295|j>>>20),j=N+(I^B&(C^I))+L[14]+2792965006&4294967295,N=B+(j<<17&4294967295|j>>>15),j=I+(C^N&(B^C))+L[15]+1236535329&4294967295,I=N+(j<<22&4294967295|j>>>10),j=C+(N^B&(I^N))+L[1]+4129170786&4294967295,C=I+(j<<5&4294967295|j>>>27),j=B+(I^N&(C^I))+L[6]+3225465664&4294967295,B=C+(j<<9&4294967295|j>>>23),j=N+(C^I&(B^C))+L[11]+643717713&4294967295,N=B+(j<<14&4294967295|j>>>18),j=I+(B^C&(N^B))+L[0]+3921069994&4294967295,I=N+(j<<20&4294967295|j>>>12),j=C+(N^B&(I^N))+L[5]+3593408605&4294967295,C=I+(j<<5&4294967295|j>>>27),j=B+(I^N&(C^I))+L[10]+38016083&4294967295,B=C+(j<<9&4294967295|j>>>23),j=N+(C^I&(B^C))+L[15]+3634488961&4294967295,N=B+(j<<14&4294967295|j>>>18),j=I+(B^C&(N^B))+L[4]+3889429448&4294967295,I=N+(j<<20&4294967295|j>>>12),j=C+(N^B&(I^N))+L[9]+568446438&4294967295,C=I+(j<<5&4294967295|j>>>27),j=B+(I^N&(C^I))+L[14]+3275163606&4294967295,B=C+(j<<9&4294967295|j>>>23),j=N+(C^I&(B^C))+L[3]+4107603335&4294967295,N=B+(j<<14&4294967295|j>>>18),j=I+(B^C&(N^B))+L[8]+1163531501&4294967295,I=N+(j<<20&4294967295|j>>>12),j=C+(N^B&(I^N))+L[13]+2850285829&4294967295,C=I+(j<<5&4294967295|j>>>27),j=B+(I^N&(C^I))+L[2]+4243563512&4294967295,B=C+(j<<9&4294967295|j>>>23),j=N+(C^I&(B^C))+L[7]+1735328473&4294967295,N=B+(j<<14&4294967295|j>>>18),j=I+(B^C&(N^B))+L[12]+2368359562&4294967295,I=N+(j<<20&4294967295|j>>>12),j=C+(I^N^B)+L[5]+4294588738&4294967295,C=I+(j<<4&4294967295|j>>>28),j=B+(C^I^N)+L[8]+2272392833&4294967295,B=C+(j<<11&4294967295|j>>>21),j=N+(B^C^I)+L[11]+1839030562&4294967295,N=B+(j<<16&4294967295|j>>>16),j=I+(N^B^C)+L[14]+4259657740&4294967295,I=N+(j<<23&4294967295|j>>>9),j=C+(I^N^B)+L[1]+2763975236&4294967295,C=I+(j<<4&4294967295|j>>>28),j=B+(C^I^N)+L[4]+1272893353&4294967295,B=C+(j<<11&4294967295|j>>>21),j=N+(B^C^I)+L[7]+4139469664&4294967295,N=B+(j<<16&4294967295|j>>>16),j=I+(N^B^C)+L[10]+3200236656&4294967295,I=N+(j<<23&4294967295|j>>>9),j=C+(I^N^B)+L[13]+681279174&4294967295,C=I+(j<<4&4294967295|j>>>28),j=B+(C^I^N)+L[0]+3936430074&4294967295,B=C+(j<<11&4294967295|j>>>21),j=N+(B^C^I)+L[3]+3572445317&4294967295,N=B+(j<<16&4294967295|j>>>16),j=I+(N^B^C)+L[6]+76029189&4294967295,I=N+(j<<23&4294967295|j>>>9),j=C+(I^N^B)+L[9]+3654602809&4294967295,C=I+(j<<4&4294967295|j>>>28),j=B+(C^I^N)+L[12]+3873151461&4294967295,B=C+(j<<11&4294967295|j>>>21),j=N+(B^C^I)+L[15]+530742520&4294967295,N=B+(j<<16&4294967295|j>>>16),j=I+(N^B^C)+L[2]+3299628645&4294967295,I=N+(j<<23&4294967295|j>>>9),j=C+(N^(I|~B))+L[0]+4096336452&4294967295,C=I+(j<<6&4294967295|j>>>26),j=B+(I^(C|~N))+L[7]+1126891415&4294967295,B=C+(j<<10&4294967295|j>>>22),j=N+(C^(B|~I))+L[14]+2878612391&4294967295,N=B+(j<<15&4294967295|j>>>17),j=I+(B^(N|~C))+L[5]+4237533241&4294967295,I=N+(j<<21&4294967295|j>>>11),j=C+(N^(I|~B))+L[12]+1700485571&4294967295,C=I+(j<<6&4294967295|j>>>26),j=B+(I^(C|~N))+L[3]+2399980690&4294967295,B=C+(j<<10&4294967295|j>>>22),j=N+(C^(B|~I))+L[10]+4293915773&4294967295,N=B+(j<<15&4294967295|j>>>17),j=I+(B^(N|~C))+L[1]+2240044497&4294967295,I=N+(j<<21&4294967295|j>>>11),j=C+(N^(I|~B))+L[8]+1873313359&4294967295,C=I+(j<<6&4294967295|j>>>26),j=B+(I^(C|~N))+L[15]+4264355552&4294967295,B=C+(j<<10&4294967295|j>>>22),j=N+(C^(B|~I))+L[6]+2734768916&4294967295,N=B+(j<<15&4294967295|j>>>17),j=I+(B^(N|~C))+L[13]+1309151649&4294967295,I=N+(j<<21&4294967295|j>>>11),j=C+(N^(I|~B))+L[4]+4149444226&4294967295,C=I+(j<<6&4294967295|j>>>26),j=B+(I^(C|~N))+L[11]+3174756917&4294967295,B=C+(j<<10&4294967295|j>>>22),j=N+(C^(B|~I))+L[2]+718787259&4294967295,N=B+(j<<15&4294967295|j>>>17),j=I+(B^(N|~C))+L[9]+3951481745&4294967295,R.g[0]=R.g[0]+C&4294967295,R.g[1]=R.g[1]+(N+(j<<21&4294967295|j>>>11))&4294967295,R.g[2]=R.g[2]+N&4294967295,R.g[3]=R.g[3]+B&4294967295}s.prototype.v=function(R,C){C===void 0&&(C=R.length);const I=C-this.blockSize,L=this.C;let N=this.h,B=0;for(;B<C;){if(N==0)for(;B<=I;)o(this,R,B),B+=this.blockSize;if(typeof R=="string"){for(;B<C;)if(L[N++]=R.charCodeAt(B++),N==this.blockSize){o(this,L),N=0;break}}else for(;B<C;)if(L[N++]=R[B++],N==this.blockSize){o(this,L),N=0;break}}this.h=N,this.o+=C},s.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var C=1;C<R.length-8;++C)R[C]=0;C=this.o*8;for(var I=R.length-8;I<R.length;++I)R[I]=C&255,C/=256;for(this.v(R),R=Array(16),C=0,I=0;I<4;++I)for(let L=0;L<32;L+=8)R[C++]=this.g[I]>>>L&255;return R};function c(R,C){var I=g;return Object.prototype.hasOwnProperty.call(I,R)?I[R]:I[R]=C(R)}function d(R,C){this.h=C;const I=[];let L=!0;for(let N=R.length-1;N>=0;N--){const B=R[N]|0;L&&B==C||(I[N]=B,L=!1)}this.g=I}var g={};function p(R){return-128<=R&&R<128?c(R,function(C){return new d([C|0],C<0?-1:0)}):new d([R|0],R<0?-1:0)}function y(R){if(isNaN(R)||!isFinite(R))return S;if(R<0)return M(y(-R));const C=[];let I=1;for(let L=0;R>=I;L++)C[L]=R/I|0,I*=4294967296;return new d(C,0)}function b(R,C){if(R.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(R.charAt(0)=="-")return M(b(R.substring(1),C));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=y(Math.pow(C,8));let L=S;for(let B=0;B<R.length;B+=8){var N=Math.min(8,R.length-B);const j=parseInt(R.substring(B,B+N),C);N<8?(N=y(Math.pow(C,N)),L=L.j(N).add(y(j))):(L=L.j(I),L=L.add(y(j)))}return L}var S=p(0),x=p(1),D=p(16777216);i=d.prototype,i.m=function(){if(O(this))return-M(this).m();let R=0,C=1;for(let I=0;I<this.g.length;I++){const L=this.i(I);R+=(L>=0?L:4294967296+L)*C,C*=4294967296}return R},i.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(k(this))return"0";if(O(this))return"-"+M(this).toString(R);const C=y(Math.pow(R,6));var I=this;let L="";for(;;){const N=Ce(I,C).g;I=G(I,N.j(C));let B=((I.g.length>0?I.g[0]:I.h)>>>0).toString(R);if(I=N,k(I))return B+L;for(;B.length<6;)B="0"+B;L=B+L}},i.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function k(R){if(R.h!=0)return!1;for(let C=0;C<R.g.length;C++)if(R.g[C]!=0)return!1;return!0}function O(R){return R.h==-1}i.l=function(R){return R=G(this,R),O(R)?-1:k(R)?0:1};function M(R){const C=R.g.length,I=[];for(let L=0;L<C;L++)I[L]=~R.g[L];return new d(I,~R.h).add(x)}i.abs=function(){return O(this)?M(this):this},i.add=function(R){const C=Math.max(this.g.length,R.g.length),I=[];let L=0;for(let N=0;N<=C;N++){let B=L+(this.i(N)&65535)+(R.i(N)&65535),j=(B>>>16)+(this.i(N)>>>16)+(R.i(N)>>>16);L=j>>>16,B&=65535,j&=65535,I[N]=j<<16|B}return new d(I,I[I.length-1]&-2147483648?-1:0)};function G(R,C){return R.add(M(C))}i.j=function(R){if(k(this)||k(R))return S;if(O(this))return O(R)?M(this).j(M(R)):M(M(this).j(R));if(O(R))return M(this.j(M(R)));if(this.l(D)<0&&R.l(D)<0)return y(this.m()*R.m());const C=this.g.length+R.g.length,I=[];for(var L=0;L<2*C;L++)I[L]=0;for(L=0;L<this.g.length;L++)for(let N=0;N<R.g.length;N++){const B=this.i(L)>>>16,j=this.i(L)&65535,Fe=R.i(N)>>>16,dt=R.i(N)&65535;I[2*L+2*N]+=j*dt,q(I,2*L+2*N),I[2*L+2*N+1]+=B*dt,q(I,2*L+2*N+1),I[2*L+2*N+1]+=j*Fe,q(I,2*L+2*N+1),I[2*L+2*N+2]+=B*Fe,q(I,2*L+2*N+2)}for(R=0;R<C;R++)I[R]=I[2*R+1]<<16|I[2*R];for(R=C;R<2*C;R++)I[R]=0;return new d(I,0)};function q(R,C){for(;(R[C]&65535)!=R[C];)R[C+1]+=R[C]>>>16,R[C]&=65535,C++}function ee(R,C){this.g=R,this.h=C}function Ce(R,C){if(k(C))throw Error("division by zero");if(k(R))return new ee(S,S);if(O(R))return C=Ce(M(R),C),new ee(M(C.g),M(C.h));if(O(C))return C=Ce(R,M(C)),new ee(M(C.g),C.h);if(R.g.length>30){if(O(R)||O(C))throw Error("slowDivide_ only works with positive integers.");for(var I=x,L=C;L.l(R)<=0;)I=Me(I),L=Me(L);var N=Se(I,1),B=Se(L,1);for(L=Se(L,2),I=Se(I,2);!k(L);){var j=B.add(L);j.l(R)<=0&&(N=N.add(I),B=j),L=Se(L,1),I=Se(I,1)}return C=G(R,N.j(C)),new ee(N,C)}for(N=S;R.l(C)>=0;){for(I=Math.max(1,Math.floor(R.m()/C.m())),L=Math.ceil(Math.log(I)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),B=y(I),j=B.j(C);O(j)||j.l(R)>0;)I-=L,B=y(I),j=B.j(C);k(B)&&(B=x),N=N.add(B),R=G(R,j)}return new ee(N,R)}i.B=function(R){return Ce(this,R).h},i.and=function(R){const C=Math.max(this.g.length,R.g.length),I=[];for(let L=0;L<C;L++)I[L]=this.i(L)&R.i(L);return new d(I,this.h&R.h)},i.or=function(R){const C=Math.max(this.g.length,R.g.length),I=[];for(let L=0;L<C;L++)I[L]=this.i(L)|R.i(L);return new d(I,this.h|R.h)},i.xor=function(R){const C=Math.max(this.g.length,R.g.length),I=[];for(let L=0;L<C;L++)I[L]=this.i(L)^R.i(L);return new d(I,this.h^R.h)};function Me(R){const C=R.g.length+1,I=[];for(let L=0;L<C;L++)I[L]=R.i(L)<<1|R.i(L-1)>>>31;return new d(I,R.h)}function Se(R,C){const I=C>>5;C%=32;const L=R.g.length-I,N=[];for(let B=0;B<L;B++)N[B]=C>0?R.i(B+I)>>>C|R.i(B+I+1)<<32-C:R.i(B+I);return new d(N,R.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,GE=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=b,ra=d}).apply(typeof Vv<"u"?Vv:typeof self<"u"?self:typeof window<"u"?window:{});var Ad=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var $E,Sc,YE,Pd,yg,QE,KE,WE;(function(){var i,e=Object.defineProperty;function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ad=="object"&&Ad];for(var _=0;_<u.length;++_){var E=u[_];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var s=n(this);function o(u,_){if(_)e:{var E=s;u=u.split(".");for(var w=0;w<u.length-1;w++){var W=u[w];if(!(W in E))break e;E=E[W]}u=u[u.length-1],w=E[u],_=_(w),_!=w&&_!=null&&e(E,u,{configurable:!0,writable:!0,value:_})}}o("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(u){return u||function(_){var E=[],w;for(w in _)Object.prototype.hasOwnProperty.call(_,w)&&E.push([w,_[w]]);return E}});var c=c||{},d=this||self;function g(u){var _=typeof u;return _=="object"&&u!=null||_=="function"}function p(u,_,E){return u.call.apply(u.bind,arguments)}function y(u,_,E){return y=p,y.apply(null,arguments)}function b(u,_){var E=Array.prototype.slice.call(arguments,1);return function(){var w=E.slice();return w.push.apply(w,arguments),u.apply(this,w)}}function S(u,_){function E(){}E.prototype=_.prototype,u.Z=_.prototype,u.prototype=new E,u.prototype.constructor=u,u.Ob=function(w,W,ae){for(var je=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)je[mt-2]=arguments[mt];return _.prototype[W].apply(w,je)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function D(u){const _=u.length;if(_>0){const E=Array(_);for(let w=0;w<_;w++)E[w]=u[w];return E}return[]}function k(u,_){for(let w=1;w<arguments.length;w++){const W=arguments[w];var E=typeof W;if(E=E!="object"?E:W?Array.isArray(W)?"array":E:"null",E=="array"||E=="object"&&typeof W.length=="number"){E=u.length||0;const ae=W.length||0;u.length=E+ae;for(let je=0;je<ae;je++)u[E+je]=W[je]}else u.push(W)}}class O{constructor(_,E){this.i=_,this.j=E,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function M(u){d.setTimeout(()=>{throw u},0)}function G(){var u=R;let _=null;return u.g&&(_=u.g,u.g=u.g.next,u.g||(u.h=null),_.next=null),_}class q{constructor(){this.h=this.g=null}add(_,E){const w=ee.get();w.set(_,E),this.h?this.h.next=w:this.g=w,this.h=w}}var ee=new O(()=>new Ce,u=>u.reset());class Ce{constructor(){this.next=this.g=this.h=null}set(_,E){this.h=_,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let Me,Se=!1,R=new q,C=()=>{const u=Promise.resolve(void 0);Me=()=>{u.then(I)}};function I(){for(var u;u=G();){try{u.h.call(u.g)}catch(E){M(E)}var _=ee;_.j(u),_.h<100&&(_.h++,u.next=_.g,_.g=u)}Se=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(u,_){this.type=u,this.g=this.target=_,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var u=!1,_=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const E=()=>{};d.addEventListener("test",E,_),d.removeEventListener("test",E,_)}catch{}return u})();function j(u){return/^[\s\xa0]*$/.test(u)}function Fe(u,_){N.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,_)}S(Fe,N),Fe.prototype.init=function(u,_){const E=this.type=u.type,w=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=_,_=u.relatedTarget,_||(E=="mouseover"?_=u.fromElement:E=="mouseout"&&(_=u.toElement)),this.relatedTarget=_,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&Fe.Z.h.call(this)},Fe.prototype.h=function(){Fe.Z.h.call(this);const u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var dt="closure_listenable_"+(Math.random()*1e6|0),se=0;function $(u,_,E,w,W){this.listener=u,this.proxy=null,this.src=_,this.type=E,this.capture=!!w,this.ha=W,this.key=++se,this.da=this.fa=!1}function Ie(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Ue(u,_,E){for(const w in u)_.call(E,u[w],w,u)}function st(u,_){for(const E in u)_.call(void 0,u[E],E,u)}function V(u){const _={};for(const E in u)_[E]=u[E];return _}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(u,_){let E,w;for(let W=1;W<arguments.length;W++){w=arguments[W];for(E in w)u[E]=w[E];for(let ae=0;ae<P.length;ae++)E=P[ae],Object.prototype.hasOwnProperty.call(w,E)&&(u[E]=w[E])}}function X(u){this.src=u,this.g={},this.h=0}X.prototype.add=function(u,_,E,w,W){const ae=u.toString();u=this.g[ae],u||(u=this.g[ae]=[],this.h++);const je=we(u,_,w,W);return je>-1?(_=u[je],E||(_.fa=!1)):(_=new $(_,this.src,ae,!!w,W),_.fa=E,u.push(_)),_};function ne(u,_){const E=_.type;if(E in u.g){var w=u.g[E],W=Array.prototype.indexOf.call(w,_,void 0),ae;(ae=W>=0)&&Array.prototype.splice.call(w,W,1),ae&&(Ie(_),u.g[E].length==0&&(delete u.g[E],u.h--))}}function we(u,_,E,w){for(let W=0;W<u.length;++W){const ae=u[W];if(!ae.da&&ae.listener==_&&ae.capture==!!E&&ae.ha==w)return W}return-1}var ke="closure_lm_"+(Math.random()*1e6|0),Qe={};function lt(u,_,E,w,W){if(Array.isArray(_)){for(let ae=0;ae<_.length;ae++)lt(u,_[ae],E,w,W);return null}return E=tt(E),u&&u[dt]?u.J(_,E,g(w)?!!w.capture:!1,W):Ut(u,_,E,!1,w,W)}function Ut(u,_,E,w,W,ae){if(!_)throw Error("Invalid event type");const je=g(W)?!!W.capture:!!W;let mt=kt(u);if(mt||(u[ke]=mt=new X(u)),E=mt.add(_,E,w,je,ae),E.proxy)return E;if(w=bn(),E.proxy=w,w.src=u,w.listener=E,u.addEventListener)B||(W=je),W===void 0&&(W=!1),u.addEventListener(_.toString(),w,W);else if(u.attachEvent)u.attachEvent(mn(_.toString()),w);else if(u.addListener&&u.removeListener)u.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return E}function bn(){function u(E){return _.call(u.src,u.listener,E)}const _=Gn;return u}function Jt(u,_,E,w,W){if(Array.isArray(_))for(var ae=0;ae<_.length;ae++)Jt(u,_[ae],E,w,W);else w=g(w)?!!w.capture:!!w,E=tt(E),u&&u[dt]?(u=u.i,ae=String(_).toString(),ae in u.g&&(_=u.g[ae],E=we(_,E,w,W),E>-1&&(Ie(_[E]),Array.prototype.splice.call(_,E,1),_.length==0&&(delete u.g[ae],u.h--)))):u&&(u=kt(u))&&(_=u.g[_.toString()],u=-1,_&&(u=we(_,E,w,W)),(E=u>-1?_[u]:null)&&Nn(E))}function Nn(u){if(typeof u!="number"&&u&&!u.da){var _=u.src;if(_&&_[dt])ne(_.i,u);else{var E=u.type,w=u.proxy;_.removeEventListener?_.removeEventListener(E,w,u.capture):_.detachEvent?_.detachEvent(mn(E),w):_.addListener&&_.removeListener&&_.removeListener(w),(E=kt(_))?(ne(E,u),E.h==0&&(E.src=null,_[ke]=null)):Ie(u)}}}function mn(u){return u in Qe?Qe[u]:Qe[u]="on"+u}function Gn(u,_){if(u.da)u=!0;else{_=new Fe(_,this);const E=u.listener,w=u.ha||u.src;u.fa&&Nn(u),u=E.call(w,_)}return u}function kt(u){return u=u[ke],u instanceof X?u:null}var Zt="__closure_events_fn_"+(Math.random()*1e9>>>0);function tt(u){return typeof u=="function"?u:(u[Zt]||(u[Zt]=function(_){return u.handleEvent(_)}),u[Zt])}function F(){L.call(this),this.i=new X(this),this.M=this,this.G=null}S(F,L),F.prototype[dt]=!0,F.prototype.removeEventListener=function(u,_,E,w){Jt(this,u,_,E,w)};function fe(u,_){var E,w=u.G;if(w)for(E=[];w;w=w.G)E.push(w);if(u=u.M,w=_.type||_,typeof _=="string")_=new N(_,u);else if(_ instanceof N)_.target=_.target||u;else{var W=_;_=new N(w,u),Q(_,W)}W=!0;let ae,je;if(E)for(je=E.length-1;je>=0;je--)ae=_.g=E[je],W=z(ae,w,!0,_)&&W;if(ae=_.g=u,W=z(ae,w,!0,_)&&W,W=z(ae,w,!1,_)&&W,E)for(je=0;je<E.length;je++)ae=_.g=E[je],W=z(ae,w,!1,_)&&W}F.prototype.N=function(){if(F.Z.N.call(this),this.i){var u=this.i;for(const _ in u.g){const E=u.g[_];for(let w=0;w<E.length;w++)Ie(E[w]);delete u.g[_],u.h--}}this.G=null},F.prototype.J=function(u,_,E,w){return this.i.add(String(u),_,!1,E,w)},F.prototype.K=function(u,_,E,w){return this.i.add(String(u),_,!0,E,w)};function z(u,_,E,w){if(_=u.i.g[String(_)],!_)return!0;_=_.concat();let W=!0;for(let ae=0;ae<_.length;++ae){const je=_[ae];if(je&&!je.da&&je.capture==E){const mt=je.listener,Sn=je.ha||je.src;je.fa&&ne(u.i,je),W=mt.call(Sn,w)!==!1&&W}}return W&&!w.defaultPrevented}function K(u,_){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=y(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:d.setTimeout(u,_||0)}function te(u){u.g=K(()=>{u.g=null,u.i&&(u.i=!1,te(u))},u.l);const _=u.h;u.h=null,u.m.apply(null,_)}class ue extends L{constructor(_,E){super(),this.m=_,this.l=E,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:te(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ae(u){L.call(this),this.h=u,this.g={}}S(Ae,L);var pe=[];function ve(u){Ue(u.g,function(_,E){this.g.hasOwnProperty(E)&&Nn(_)},u),u.g={}}Ae.prototype.N=function(){Ae.Z.N.call(this),ve(this)},Ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Te=d.JSON.stringify,Le=d.JSON.parse,Re=class{stringify(u){return d.JSON.stringify(u,void 0)}parse(u){return d.JSON.parse(u,void 0)}};function at(){}function St(){}var Ve={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Xe(){N.call(this,"d")}S(Xe,N);function gn(){N.call(this,"c")}S(gn,N);var Bt={},Wr=null;function Xr(){return Wr=Wr||new F}Bt.Ia="serverreachability";function ki(u){N.call(this,Bt.Ia,u)}S(ki,N);function zn(u){const _=Xr();fe(_,new ki(_))}Bt.STAT_EVENT="statevent";function En(u,_){N.call(this,Bt.STAT_EVENT,u),this.stat=_}S(En,N);function en(u){const _=Xr();fe(_,new En(_,u))}Bt.Ja="timingevent";function $n(u,_){N.call(this,Bt.Ja,u),this.size=_}S($n,N);function or(u,_){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){u()},_)}function lr(){this.g=!0}lr.prototype.ua=function(){this.g=!1};function ge(u,_,E,w,W,ae){u.info(function(){if(u.g)if(ae){var je="",mt=ae.split("&");for(let Vt=0;Vt<mt.length;Vt++){var Sn=mt[Vt].split("=");if(Sn.length>1){const ln=Sn[0];Sn=Sn[1];const Lr=ln.split("_");je=Lr.length>=2&&Lr[1]=="type"?je+(ln+"="+Sn+"&"):je+(ln+"=redacted&")}}}else je=null;else je=ae;return"XMLHTTP REQ ("+w+") [attempt "+W+"]: "+_+`
`+E+`
`+je})}function Ne(u,_,E,w,W,ae,je){u.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+W+"]: "+_+`
`+E+`
`+ae+" "+je})}function $e(u,_,E,w){u.info(function(){return"XMLHTTP TEXT ("+_+"): "+Pt(u,E)+(w?" "+w:"")})}function We(u,_){u.info(function(){return"TIMEOUT: "+_})}lr.prototype.info=function(){};function Pt(u,_){if(!u.g)return _;if(!_)return null;try{const ae=JSON.parse(_);if(ae){for(u=0;u<ae.length;u++)if(Array.isArray(ae[u])){var E=ae[u];if(!(E.length<2)){var w=E[1];if(Array.isArray(w)&&!(w.length<1)){var W=w[0];if(W!="noop"&&W!="stop"&&W!="close")for(let je=1;je<w.length;je++)w[je]=""}}}}return Te(ae)}catch{return _}}var pn={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},fi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ya;function Ni(){}S(Ni,at),Ni.prototype.g=function(){return new XMLHttpRequest},ya=new Ni;function Jr(u){return encodeURIComponent(String(u))}function fs(u){var _=1;u=u.split(":");const E=[];for(;_>0&&u.length;)E.push(u.shift()),_--;return u.length&&E.push(u.join(":")),E}function Sr(u,_,E,w){this.j=u,this.i=_,this.l=E,this.S=w||1,this.V=new Ae(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Tr}function Tr(){this.i=null,this.g="",this.h=!1}var yn={},Cn={};function kr(u,_,E){u.M=1,u.A=Zr(Wt(_)),u.u=E,u.R=!0,ms(u,null)}function ms(u,_){u.F=Date.now(),ce(u),u.B=Wt(u.A);var E=u.B,w=u.S;Array.isArray(w)||(w=[String(w)]),io(E.i,"t",w),u.C=0,E=u.j.L,u.h=new Tr,u.g=_u(u.j,E?_:null,!u.u),u.P>0&&(u.O=new ue(y(u.Y,u,u.g),u.P)),_=u.V,E=u.g,w=u.ba;var W="readystatechange";Array.isArray(W)||(W&&(pe[0]=W.toString()),W=pe);for(let ae=0;ae<W.length;ae++){const je=lt(E,W[ae],w||_.handleEvent,!1,_.h||_);if(!je)break;_.g[je.key]=je}_=u.J?V(u.J):{},u.u?(u.v||(u.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,_)):(u.v="GET",u.g.ea(u.B,u.v,null,_)),zn(),ge(u.i,u.v,u.B,u.l,u.S,u.u)}Sr.prototype.ba=function(u){u=u.target;const _=this.O;_&&ni(u)==3?_.j():this.Y(u)},Sr.prototype.Y=function(u){try{if(u==this.g)e:{const mt=ni(this.g),Sn=this.g.ya(),Vt=this.g.ca();if(!(mt<3)&&(mt!=3||this.g&&(this.h.h||this.g.la()||Yn(this.g)))){this.K||mt!=4||Sn==7||(Sn==8||Vt<=0?zn(3):zn(2)),xe(this);var _=this.g.ca();this.X=_;var E=le(this);if(this.o=_==200,Ne(this.i,this.v,this.B,this.l,this.S,mt,_),this.o){if(this.U&&!this.L){t:{if(this.g){var w,W=this.g;if((w=W.g?W.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(w)){var ae=w;break t}}ae=null}if(u=ae)$e(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Pe(this,u);else{this.o=!1,this.m=3,en(12),Be(this),Oe(this);break e}}if(this.R){u=!0;let ln;for(;!this.K&&this.C<E.length;)if(ln=de(this,E),ln==Cn){mt==4&&(this.m=4,en(14),u=!1),$e(this.i,this.l,null,"[Incomplete Response]");break}else if(ln==yn){this.m=4,en(15),$e(this.i,this.l,E,"[Invalid Chunk]"),u=!1;break}else $e(this.i,this.l,ln,null),Pe(this,ln);if(ie(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||E.length!=0||this.h.h||(this.m=1,en(16),u=!1),this.o=this.o&&u,!u)$e(this.i,this.l,E,"[Invalid Chunked Response]"),Be(this),Oe(this);else if(E.length>0&&!this.W){this.W=!0;var je=this.j;je.g==this&&je.aa&&!je.P&&(je.j.info("Great, no buffering proxy detected. Bytes received: "+E.length),kl(je),je.P=!0,en(11))}}else $e(this.i,this.l,E,null),Pe(this,E);mt==4&&Be(this),this.o&&!this.K&&(mt==4?mu(this.j,this):(this.o=!1,ce(this)))}else Li(this.g),_==400&&E.indexOf("Unknown SID")>0?(this.m=3,en(12)):(this.m=0,en(13)),Be(this),Oe(this)}}}catch{}};function le(u){if(!ie(u))return u.g.la();const _=Yn(u.g);if(_==="")return"";let E="";const w=_.length,W=ni(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Be(u),Oe(u),"";u.h.i=new d.TextDecoder}for(let ae=0;ae<w;ae++)u.h.h=!0,E+=u.h.i.decode(_[ae],{stream:!(W&&ae==w-1)});return _.length=0,u.h.g+=E,u.C=0,u.h.g}function ie(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function de(u,_){var E=u.C,w=_.indexOf(`
`,E);return w==-1?Cn:(E=Number(_.substring(E,w)),isNaN(E)?yn:(w+=1,w+E>_.length?Cn:(_=_.slice(w,w+E),u.C=w+E,_)))}Sr.prototype.cancel=function(){this.K=!0,Be(this)};function ce(u){u.T=Date.now()+u.H,De(u,u.H)}function De(u,_){if(u.D!=null)throw Error("WatchDog timer not null");u.D=or(y(u.aa,u),_)}function xe(u){u.D&&(d.clearTimeout(u.D),u.D=null)}Sr.prototype.aa=function(){this.D=null;const u=Date.now();u-this.T>=0?(We(this.i,this.B),this.M!=2&&(zn(),en(17)),Be(this),this.m=2,Oe(this)):De(this,this.T-u)};function Oe(u){u.j.I==0||u.K||mu(u.j,u)}function Be(u){xe(u);var _=u.O;_&&typeof _.dispose=="function"&&_.dispose(),u.O=null,ve(u.V),u.g&&(_=u.g,u.g=null,_.abort(),_.dispose())}function Pe(u,_){try{var E=u.j;if(E.I!=0&&(E.g==u||nn(E.h,u))){if(!u.L&&nn(E.h,u)&&E.I==3){try{var w=E.Ba.g.parse(_)}catch{w=null}if(Array.isArray(w)&&w.length==3){var W=w;if(W[0]==0){e:if(!E.v){if(E.g)if(E.g.F+3e3<u.F)co(E),Ss(E);else break e;xa(E),en(18)}}else E.xa=W[1],0<E.xa-E.K&&W[2]<37500&&E.F&&E.A==0&&!E.C&&(E.C=or(y(E.Va,E),6e3));_t(E.h)<=1&&E.ta&&(E.ta=void 0)}else vi(E,11)}else if((u.L||E.g==u)&&co(E),!j(_))for(W=E.Ba.g.parse(_),_=0;_<W.length;_++){let Vt=W[_];const ln=Vt[0];if(!(ln<=E.K))if(E.K=ln,Vt=Vt[1],E.I==2)if(Vt[0]=="c"){E.M=Vt[1],E.ba=Vt[2];const Lr=Vt[3];Lr!=null&&(E.ka=Lr,E.j.info("VER="+E.ka));const bi=Vt[4];bi!=null&&(E.za=bi,E.j.info("SVER="+E.za));const ri=Vt[5];ri!=null&&typeof ri=="number"&&ri>0&&(w=1.5*ri,E.O=w,E.j.info("backChannelRequestTimeoutMs_="+w)),w=E;const ii=u.g;if(ii){const wa=ii.g?ii.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wa){var ae=w.h;ae.g||wa.indexOf("spdy")==-1&&wa.indexOf("quic")==-1&&wa.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(Un(ae,ae.h),ae.h=null))}if(w.G){const uo=ii.g?ii.g.getResponseHeader("X-HTTP-Session-Id"):null;uo&&(w.wa=uo,Rt(w.J,w.G,uo))}}E.I=3,E.l&&E.l.ra(),E.aa&&(E.T=Date.now()-u.F,E.j.info("Handshake RTT: "+E.T+"ms")),w=E;var je=u;if(w.na=yu(w,w.L?w.ba:null,w.W),je.L){on(w.h,je);var mt=je,Sn=w.O;Sn&&(mt.H=Sn),mt.D&&(xe(mt),ce(mt)),w.g=je}else hu(w);E.i.length>0&&_i(E)}else Vt[0]!="stop"&&Vt[0]!="close"||vi(E,7);else E.I==3&&(Vt[0]=="stop"||Vt[0]=="close"?Vt[0]=="stop"?vi(E,7):jl(E):Vt[0]!="noop"&&E.l&&E.l.qa(Vt),E.A=0)}}zn(4)}catch{}}var Ge=class{constructor(u,_){this.g=u,this.map=_}};function et(u){this.l=u||10,d.PerformanceNavigationTiming?(u=d.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ft(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function _t(u){return u.h?1:u.g?u.g.size:0}function nn(u,_){return u.h?u.h==_:u.g?u.g.has(_):!1}function Un(u,_){u.g?u.g.add(_):u.h=_}function on(u,_){u.h&&u.h==_?u.h=null:u.g&&u.g.has(_)&&u.g.delete(_)}et.prototype.cancel=function(){if(this.i=Nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Nt(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let _=u.i;for(const E of u.g.values())_=_.concat(E.G);return _}return D(u.i)}var Vn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ft(u,_){if(u){u=u.split("&");for(let E=0;E<u.length;E++){const w=u[E].indexOf("=");let W,ae=null;w>=0?(W=u[E].substring(0,w),ae=u[E].substring(w+1)):W=u[E],_(W,ae?decodeURIComponent(ae.replace(/\+/g," ")):"")}}}function Ot(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;u instanceof Ot?(this.l=u.l,dn(this,u.j),this.o=u.o,this.g=u.g,xr(this,u.u),this.h=u.h,gs(this,uu(u.i)),this.m=u.m):u&&(_=String(u).match(Vn))?(this.l=!1,dn(this,_[1]||"",!0),this.o=mi(_[2]||""),this.g=mi(_[3]||"",!0),xr(this,_[4]),this.h=mi(_[5]||"",!0),gs(this,_[6]||"",!0),this.m=mi(_[7]||"")):(this.l=!1,this.i=new ys(null,this.l))}Ot.prototype.toString=function(){const u=[];var _=this.j;_&&u.push(_a(_,ro,!0),":");var E=this.g;return(E||_=="file")&&(u.push("//"),(_=this.o)&&u.push(_a(_,ro,!0),"@"),u.push(Jr(E).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.u,E!=null&&u.push(":",String(E))),(E=this.h)&&(this.g&&E.charAt(0)!="/"&&u.push("/"),u.push(_a(E,E.charAt(0)=="/"?Al:ou,!0))),(E=this.i.toString())&&u.push("?",E),(E=this.m)&&u.push("#",_a(E,lu)),u.join("")},Ot.prototype.resolve=function(u){const _=Wt(this);let E=!!u.j;E?dn(_,u.j):E=!!u.o,E?_.o=u.o:E=!!u.g,E?_.g=u.g:E=u.u!=null;var w=u.h;if(E)xr(_,u.u);else if(E=!!u.h){if(w.charAt(0)!="/")if(this.g&&!this.h)w="/"+w;else{var W=_.h.lastIndexOf("/");W!=-1&&(w=_.h.slice(0,W+1)+w)}if(W=w,W==".."||W==".")w="";else if(W.indexOf("./")!=-1||W.indexOf("/.")!=-1){w=W.lastIndexOf("/",0)==0,W=W.split("/");const ae=[];for(let je=0;je<W.length;){const mt=W[je++];mt=="."?w&&je==W.length&&ae.push(""):mt==".."?((ae.length>1||ae.length==1&&ae[0]!="")&&ae.pop(),w&&je==W.length&&ae.push("")):(ae.push(mt),w=!0)}w=ae.join("/")}else w=W}return E?_.h=w:E=u.i.toString()!=="",E?gs(_,uu(u.i)):E=!!u.m,E&&(_.m=u.m),_};function Wt(u){return new Ot(u)}function dn(u,_,E){u.j=E?mi(_,!0):_,u.j&&(u.j=u.j.replace(/:$/,""))}function xr(u,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);u.u=_}else u.u=null}function gs(u,_,E){_ instanceof ys?(u.i=_,so(u.i,u.l)):(E||(_=_a(_,ps)),u.i=new ys(_,u.l))}function Rt(u,_,E){u.i.set(_,E)}function Zr(u){return Rt(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function mi(u,_){return u?_?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function _a(u,_,E){return typeof u=="string"?(u=encodeURI(u).replace(_,hr),E&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function hr(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var ro=/[#\/\?@]/g,ou=/[#\?:]/g,Al=/[#\?]/g,ps=/[#\?@]/g,lu=/#/g;function ys(u,_){this.h=this.g=null,this.i=u||null,this.j=!!_}function fr(u){u.g||(u.g=new Map,u.h=0,u.i&&Ft(u.i,function(_,E){u.add(decodeURIComponent(_.replace(/\+/g," ")),E)}))}i=ys.prototype,i.add=function(u,_){fr(this),this.i=null,u=_s(this,u);let E=this.g.get(u);return E||this.g.set(u,E=[]),E.push(_),this.h+=1,this};function cu(u,_){fr(u),_=_s(u,_),u.g.has(_)&&(u.i=null,u.h-=u.g.get(_).length,u.g.delete(_))}function Cl(u,_){return fr(u),_=_s(u,_),u.g.has(_)}i.forEach=function(u,_){fr(this),this.g.forEach(function(E,w){E.forEach(function(W){u.call(_,W,w,this)},this)},this)};function Rl(u,_){fr(u);let E=[];if(typeof _=="string")Cl(u,_)&&(E=E.concat(u.g.get(_s(u,_))));else for(u=Array.from(u.g.values()),_=0;_<u.length;_++)E=E.concat(u[_]);return E}i.set=function(u,_){return fr(this),this.i=null,u=_s(this,u),Cl(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[_]),this.h+=1,this},i.get=function(u,_){return u?(u=Rl(this,u),u.length>0?String(u[0]):_):_};function io(u,_,E){cu(u,_),E.length>0&&(u.i=null,u.g.set(_s(u,_),D(E)),u.h+=E.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],_=Array.from(this.g.keys());for(let w=0;w<_.length;w++){var E=_[w];const W=Jr(E);E=Rl(this,E);for(let ae=0;ae<E.length;ae++){let je=W;E[ae]!==""&&(je+="="+Jr(E[ae])),u.push(je)}}return this.i=u.join("&")};function uu(u){const _=new ys;return _.i=u.i,u.g&&(_.g=new Map(u.g),_.h=u.h),_}function _s(u,_){return _=String(_),u.j&&(_=_.toLowerCase()),_}function so(u,_){_&&!u.j&&(fr(u),u.i=null,u.g.forEach(function(E,w){const W=w.toLowerCase();w!=W&&(cu(this,w),io(this,W,E))},u)),u.j=_}function ei(u,_){const E=new lr;if(d.Image){const w=new Image;w.onload=b(Nr,E,"TestLoadImage: loaded",!0,_,w),w.onerror=b(Nr,E,"TestLoadImage: error",!1,_,w),w.onabort=b(Nr,E,"TestLoadImage: abort",!1,_,w),w.ontimeout=b(Nr,E,"TestLoadImage: timeout",!1,_,w),d.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=u}else _(!1)}function Il(u,_){const E=new lr,w=new AbortController,W=setTimeout(()=>{w.abort(),Nr(E,"TestPingServer: timeout",!1,_)},1e4);fetch(u,{signal:w.signal}).then(ae=>{clearTimeout(W),ae.ok?Nr(E,"TestPingServer: ok",!0,_):Nr(E,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(W),Nr(E,"TestPingServer: error",!1,_)})}function Nr(u,_,E,w,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),w(E)}catch{}}function vs(){this.g=new Re}function gi(u){this.i=u.Sb||null,this.h=u.ab||!1}S(gi,at),gi.prototype.g=function(){return new va(this.i,this.h)};function va(u,_){F.call(this),this.H=u,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}S(va,F),i=va.prototype,i.open=function(u,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=_,this.readyState=1,ti(this)},i.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(_.body=u),(this.H||d).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,bs(this)),this.readyState=0},i.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,ti(this)),this.g&&(this.readyState=3,ti(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ao(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function ao(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}i.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var _=u.value?u.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!u.done}))&&(this.response=this.responseText+=_)}u.done?bs(this):ti(this),this.readyState==3&&ao(this)}},i.Oa=function(u){this.g&&(this.response=this.responseText=u,bs(this))},i.Na=function(u){this.g&&(this.response=u,bs(this))},i.ga=function(){this.g&&bs(this)};function bs(u){u.readyState=4,u.l=null,u.j=null,u.B=null,ti(u)}i.setRequestHeader=function(u,_){this.A.append(u,_)},i.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],_=this.h.entries();for(var E=_.next();!E.done;)E=E.value,u.push(E[0]+": "+E[1]),E=_.next();return u.join(`\r
`)};function ti(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(va.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Vr(u){let _="";return Ue(u,function(E,w){_+=w,_+=":",_+=E,_+=`\r
`}),_}function ba(u,_,E){e:{for(w in E){var w=!1;break e}w=!0}w||(E=Vr(E),typeof u=="string"?E!=null&&Jr(E):Rt(u,_,E))}function Gt(u){F.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}S(Gt,F);var pi=/^https?$/i,Dl=["POST","PUT"];i=Gt.prototype,i.Fa=function(u){this.H=u},i.ea=function(u,_,E,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);_=_?_.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ya.g(),this.g.onreadystatechange=x(y(this.Ca,this));try{this.B=!0,this.g.open(_,String(u),!0),this.B=!1}catch(ae){Ea(this,ae);return}if(u=E||"",E=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var W in w)E.set(W,w[W]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const ae of w.keys())E.set(ae,w.get(ae));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(E.keys()).find(ae=>ae.toLowerCase()=="content-type"),W=d.FormData&&u instanceof d.FormData,!(Array.prototype.indexOf.call(Dl,_,void 0)>=0)||w||W||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,je]of E)this.g.setRequestHeader(ae,je);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(ae){Ea(this,ae)}};function Ea(u,_){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=_,u.o=5,Ol(u),Vi(u)}function Ol(u){u.A||(u.A=!0,fe(u,"complete"),fe(u,"error"))}i.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,fe(this,"complete"),fe(this,"abort"),Vi(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vi(this,!0)),Gt.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?Sa(this):this.Xa())},i.Xa=function(){Sa(this)};function Sa(u){if(u.h&&typeof c<"u"){if(u.v&&ni(u)==4)setTimeout(u.Ca.bind(u),0);else if(fe(u,"readystatechange"),ni(u)==4){u.h=!1;try{const ae=u.ca();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var E;if(!(E=_)){var w;if(w=ae===0){let je=String(u.D).match(Vn)[1]||null;!je&&d.self&&d.self.location&&(je=d.self.location.protocol.slice(0,-1)),w=!pi.test(je?je.toLowerCase():"")}E=w}if(E)fe(u,"complete"),fe(u,"success");else{u.o=6;try{var W=ni(u)>2?u.g.statusText:""}catch{W=""}u.l=W+" ["+u.ca()+"]",Ol(u)}}finally{Vi(u)}}}}function Vi(u,_){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);const E=u.g;u.g=null,_||fe(u,"ready");try{E.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function ni(u){return u.g?u.g.readyState:0}i.ca=function(){try{return ni(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(u){if(this.g){var _=this.g.responseText;return u&&_.indexOf(u)==0&&(_=_.substring(u.length)),Le(_)}};function Yn(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Li(u){const _={};u=(u.g&&ni(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<u.length;w++){if(j(u[w]))continue;var E=fs(u[w]);const W=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const ae=_[W]||[];_[W]=ae,ae.push(E)}st(_,function(w){return w.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function yi(u,_,E){return E&&E.internalChannelParams&&E.internalChannelParams[u]||_}function Es(u){this.za=0,this.i=[],this.j=new lr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=yi("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=yi("baseRetryDelayMs",5e3,u),this.Za=yi("retryDelaySeedMs",1e4,u),this.Ta=yi("forwardChannelMaxRetries",2,u),this.va=yi("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new et(u&&u.concurrentRequestLimit),this.Ba=new vs,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=Es.prototype,i.ka=8,i.I=1,i.connect=function(u,_,E,w){en(0),this.W=u,this.H=_||{},E&&w!==void 0&&(this.H.OSID=E,this.H.OAID=w),this.F=this.X,this.J=yu(this,null,this.W),_i(this)};function jl(u){if(oo(u),u.I==3){var _=u.V++,E=Wt(u.J);if(Rt(E,"SID",u.M),Rt(E,"RID",_),Rt(E,"TYPE","terminate"),Ta(u,E),_=new Sr(u,u.j,_),_.M=2,_.A=Zr(Wt(E)),E=!1,d.navigator&&d.navigator.sendBeacon)try{E=d.navigator.sendBeacon(_.A.toString(),"")}catch{}!E&&d.Image&&(new Image().src=_.A,E=!0),E||(_.g=_u(_.j,null),_.g.ea(_.A)),_.F=Date.now(),ce(_)}pu(u)}function Ss(u){u.g&&(kl(u),u.g.cancel(),u.g=null)}function oo(u){Ss(u),u.v&&(d.clearTimeout(u.v),u.v=null),co(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&d.clearTimeout(u.m),u.m=null)}function _i(u){if(!ft(u.h)&&!u.m){u.m=!0;var _=u.Ea;Me||C(),Se||(Me(),Se=!0),R.add(_,u),u.D=0}}function lo(u,_){return _t(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=_.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=or(y(u.Ea,u,_),gu(u,u.D)),u.D++,!0)}i.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;const W=new Sr(this,this.j,u);let ae=this.o;if(this.U&&(ae?(ae=V(ae),Q(ae,this.U)):ae=this.U),this.u!==null||this.R||(W.J=ae,ae=null),this.S)e:{for(var _=0,E=0;E<this.i.length;E++){t:{var w=this.i[E];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(_+=w,_>4096){_=E;break e}if(_===4096||E===this.i.length-1){_=E+1;break e}}_=1e3}else _=1e3;_=du(this,W,_),E=Wt(this.J),Rt(E,"RID",u),Rt(E,"CVER",22),this.G&&Rt(E,"X-HTTP-Session-Id",this.G),Ta(this,E),ae&&(this.R?_="headers="+Jr(Vr(ae))+"&"+_:this.u&&ba(E,this.u,ae)),Un(this.h,W),this.Ra&&Rt(E,"TYPE","init"),this.S?(Rt(E,"$req",_),Rt(E,"SID","null"),W.U=!0,kr(W,E,null)):kr(W,E,_),this.I=2}}else this.I==3&&(u?Ml(this,u):this.i.length==0||ft(this.h)||Ml(this))};function Ml(u,_){var E;_?E=_.l:E=u.V++;const w=Wt(u.J);Rt(w,"SID",u.M),Rt(w,"RID",E),Rt(w,"AID",u.K),Ta(u,w),u.u&&u.o&&ba(w,u.u,u.o),E=new Sr(u,u.j,E,u.D+1),u.u===null&&(E.J=u.o),_&&(u.i=_.G.concat(u.i)),_=du(u,E,1e3),E.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),Un(u.h,E),kr(E,w,_)}function Ta(u,_){u.H&&Ue(u.H,function(E,w){Rt(_,w,E)}),u.l&&Ue({},function(E,w){Rt(_,w,E)})}function du(u,_,E){E=Math.min(u.i.length,E);const w=u.l?y(u.l.Ka,u.l,u):null;e:{var W=u.i;let mt=-1;for(;;){const Sn=["count="+E];mt==-1?E>0?(mt=W[0].g,Sn.push("ofs="+mt)):mt=0:Sn.push("ofs="+mt);let Vt=!0;for(let ln=0;ln<E;ln++){var ae=W[ln].g;const Lr=W[ln].map;if(ae-=mt,ae<0)mt=Math.max(0,W[ln].g-100),Vt=!1;else try{ae="req"+ae+"_"||"";try{var je=Lr instanceof Map?Lr:Object.entries(Lr);for(const[bi,ri]of je){let ii=ri;g(ri)&&(ii=Te(ri)),Sn.push(ae+bi+"="+encodeURIComponent(ii))}}catch(bi){throw Sn.push(ae+"type="+encodeURIComponent("_badmap")),bi}}catch{w&&w(Lr)}}if(Vt){je=Sn.join("&");break e}}je=void 0}return u=u.i.splice(0,E),_.G=u,je}function hu(u){if(!u.g&&!u.v){u.Y=1;var _=u.Da;Me||C(),Se||(Me(),Se=!0),R.add(_,u),u.A=0}}function xa(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=or(y(u.Da,u),gu(u,u.A)),u.A++,!0)}i.Da=function(){if(this.v=null,fu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=or(y(this.Wa,this),u)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,en(10),Ss(this),fu(this))};function kl(u){u.B!=null&&(d.clearTimeout(u.B),u.B=null)}function fu(u){u.g=new Sr(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var _=Wt(u.na);Rt(_,"RID","rpc"),Rt(_,"SID",u.M),Rt(_,"AID",u.K),Rt(_,"CI",u.F?"0":"1"),!u.F&&u.ia&&Rt(_,"TO",u.ia),Rt(_,"TYPE","xmlhttp"),Ta(u,_),u.u&&u.o&&ba(_,u.u,u.o),u.O&&(u.g.H=u.O);var E=u.g;u=u.ba,E.M=1,E.A=Zr(Wt(_)),E.u=null,E.R=!0,ms(E,u)}i.Va=function(){this.C!=null&&(this.C=null,Ss(this),xa(this),en(19))};function co(u){u.C!=null&&(d.clearTimeout(u.C),u.C=null)}function mu(u,_){var E=null;if(u.g==_){co(u),kl(u),u.g=null;var w=2}else if(nn(u.h,_))E=_.G,on(u.h,_),w=1;else return;if(u.I!=0){if(_.o)if(w==1){E=_.u?_.u.length:0,_=Date.now()-_.F;var W=u.D;w=Xr(),fe(w,new $n(w,E)),_i(u)}else hu(u);else if(W=_.m,W==3||W==0&&_.X>0||!(w==1&&lo(u,_)||w==2&&xa(u)))switch(E&&E.length>0&&(_=u.h,_.i=_.i.concat(E)),W){case 1:vi(u,5);break;case 4:vi(u,10);break;case 3:vi(u,6);break;default:vi(u,2)}}}function gu(u,_){let E=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(E*=2),E*_}function vi(u,_){if(u.j.info("Error code "+_),_==2){var E=y(u.bb,u),w=u.Ua;const W=!w;w=new Ot(w||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||dn(w,"https"),Zr(w),W?ei(w.toString(),E):Il(w.toString(),E)}else en(2);u.I=0,u.l&&u.l.pa(_),pu(u),oo(u)}i.bb=function(u){u?(this.j.info("Successfully pinged google.com"),en(2)):(this.j.info("Failed to ping google.com"),en(1))};function pu(u){if(u.I=0,u.ja=[],u.l){const _=Nt(u.h);(_.length!=0||u.i.length!=0)&&(k(u.ja,_),k(u.ja,u.i),u.h.i.length=0,D(u.i),u.i.length=0),u.l.oa()}}function yu(u,_,E){var w=E instanceof Ot?Wt(E):new Ot(E);if(w.g!="")_&&(w.g=_+"."+w.g),xr(w,w.u);else{var W=d.location;w=W.protocol,_=_?_+"."+W.hostname:W.hostname,W=+W.port;const ae=new Ot(null);w&&dn(ae,w),_&&(ae.g=_),W&&xr(ae,W),E&&(ae.h=E),w=ae}return E=u.G,_=u.wa,E&&_&&Rt(w,E,_),Rt(w,"VER",u.ka),Ta(u,w),w}function _u(u,_,E){if(_&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=u.Aa&&!u.ma?new Gt(new gi({ab:E})):new Gt(u.ma),_.Fa(u.L),_}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function vu(){}i=vu.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function Ts(){}Ts.prototype.g=function(u,_){return new cr(u,_)};function cr(u,_){F.call(this),this.g=new Es(_),this.l=u,this.h=_&&_.messageUrlParams||null,u=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(u?u["X-WebChannel-Content-Type"]=_.messageContentType:u={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(u?u["X-WebChannel-Client-Profile"]=_.sa:u={"X-WebChannel-Client-Profile":_.sa}),this.g.U=u,(u=_&&_.Qb)&&!j(u)&&(this.g.u=u),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!j(_)&&(this.g.G=_,u=this.h,u!==null&&_ in u&&(u=this.h,_ in u&&delete u[_])),this.j=new Pi(this)}S(cr,F),cr.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},cr.prototype.close=function(){jl(this.g)},cr.prototype.o=function(u){var _=this.g;if(typeof u=="string"){var E={};E.__data__=u,u=E}else this.v&&(E={},E.__data__=Te(u),u=E);_.i.push(new Ge(_.Ya++,u)),_.I==3&&_i(_)},cr.prototype.N=function(){this.g.l=null,delete this.j,jl(this.g),delete this.g,cr.Z.N.call(this)};function bu(u){Xe.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var _=u.__sm__;if(_){e:{for(const E in _){u=E;break e}u=void 0}(this.i=u)&&(u=this.i,_=_!==null&&u in _?_[u]:void 0),this.data=_}else this.data=u}S(bu,Xe);function Eu(){gn.call(this),this.status=1}S(Eu,gn);function Pi(u){this.g=u}S(Pi,vu),Pi.prototype.ra=function(){fe(this.g,"a")},Pi.prototype.qa=function(u){fe(this.g,new bu(u))},Pi.prototype.pa=function(u){fe(this.g,new Eu)},Pi.prototype.oa=function(){fe(this.g,"b")},Ts.prototype.createWebChannel=Ts.prototype.g,cr.prototype.send=cr.prototype.o,cr.prototype.open=cr.prototype.m,cr.prototype.close=cr.prototype.close,WE=function(){return new Ts},KE=function(){return Xr()},QE=Bt,yg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},pn.NO_ERROR=0,pn.TIMEOUT=8,pn.HTTP_ERROR=6,Pd=pn,fi.COMPLETE="complete",YE=fi,St.EventType=Ve,Ve.OPEN="a",Ve.CLOSE="b",Ve.ERROR="c",Ve.MESSAGE="d",F.prototype.listen=F.prototype.J,Sc=St,Gt.prototype.listenOnce=Gt.prototype.K,Gt.prototype.getLastError=Gt.prototype.Ha,Gt.prototype.getLastErrorCode=Gt.prototype.ya,Gt.prototype.getStatus=Gt.prototype.ca,Gt.prototype.getResponseJson=Gt.prototype.La,Gt.prototype.getResponseText=Gt.prototype.la,Gt.prototype.send=Gt.prototype.ea,Gt.prototype.setWithCredentials=Gt.prototype.Fa,$E=Gt}).apply(typeof Ad<"u"?Ad:typeof self<"u"?self:typeof window<"u"?window:{});const Lv="@firebase/firestore",Pv="4.9.3";class ir{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ir.UNAUTHENTICATED=new ir(null),ir.GOOGLE_CREDENTIALS=new ir("google-credentials-uid"),ir.FIRST_PARTY=new ir("first-party-uid"),ir.MOCK_USER=new ir("mock-user");let yl="12.7.0";const Ya=new Kg("@firebase/firestore");function Go(){return Ya.logLevel}function He(i,...e){if(Ya.logLevel<=wt.DEBUG){const n=e.map(Jg);Ya.debug(`Firestore (${yl}): ${i}`,...n)}}function os(i,...e){if(Ya.logLevel<=wt.ERROR){const n=e.map(Jg);Ya.error(`Firestore (${yl}): ${i}`,...n)}}function nl(i,...e){if(Ya.logLevel<=wt.WARN){const n=e.map(Jg);Ya.warn(`Firestore (${yl}): ${i}`,...n)}}function Jg(i){if(typeof i=="string")return i;try{return(function(n){return JSON.stringify(n)})(i)}catch{return i}}function it(i,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,XE(i,s,n)}function XE(i,e,n){let s=`FIRESTORE (${yl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw os(s),new Error(s)}function zt(i,e,n,s){let o="Unexpected state";typeof n=="string"?o=n:s=n,i||XE(e,o,s)}function ut(i,e){return i}const _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ze extends ds{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class is{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class JE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(ir.UNAUTHENTICATED)))}shutdown(){}}class pR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class yR{constructor(e){this.t=e,this.currentUser=ir.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){zt(this.o===void 0,42304);let s=this.i;const o=p=>this.i!==s?(s=this.i,n(p)):Promise.resolve();let c=new is;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new is,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const p=c;e.enqueueRetryable((async()=>{await p.promise,await o(this.currentUser)}))},g=p=>{He("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((p=>g(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?g(p):(He("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new is)}}),0),d()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((s=>this.i!==e?(He("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(zt(typeof s.accessToken=="string",31837,{l:s}),new JE(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return zt(e===null||typeof e=="string",2055,{h:e}),new ir(e)}}class _R{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=ir.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class vR{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new _R(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(ir.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class zv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bR{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,li(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){zt(this.o===void 0,3512);const s=c=>{c.error!=null&&He("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,He("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?n(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>s(c)))};const o=c=>{He("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>o(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):He("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new zv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(zt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new zv(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function ER(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<i;s++)n[s]=Math.floor(256*Math.random());return n}class Zg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const o=ER(40);for(let c=0;c<o.length;++c)s.length<20&&o[c]<n&&(s+=e.charAt(o[c]%62))}return s}}function At(i,e){return i<e?-1:i>e?1:0}function _g(i,e){const n=Math.min(i.length,e.length);for(let s=0;s<n;s++){const o=i.charAt(s),c=e.charAt(s);if(o!==c)return eg(o)===eg(c)?At(o,c):eg(o)?1:-1}return At(i.length,e.length)}const SR=55296,TR=57343;function eg(i){const e=i.charCodeAt(0);return e>=SR&&e<=TR}function rl(i,e,n){return i.length===e.length&&i.every(((s,o)=>n(s,e[o])))}const Uv="__name__";class wi{constructor(e,n,s){n===void 0?n=0:n>e.length&&it(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&it(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return wi.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof wi?e.forEach((s=>{n.push(s)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let o=0;o<s;o++){const c=wi.compareSegments(e.get(o),n.get(o));if(c!==0)return c}return At(e.length,n.length)}static compareSegments(e,n){const s=wi.isNumericId(e),o=wi.isNumericId(n);return s&&!o?-1:!s&&o?1:s&&o?wi.extractNumericId(e).compare(wi.extractNumericId(n)):_g(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ra.fromString(e.substring(4,e.length-2))}}class tn extends wi{construct(e,n,s){return new tn(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new ze(_e.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter((o=>o.length>0)))}return new tn(n)}static emptyPath(){return new tn([])}}const xR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class er extends wi{construct(e,n,s){return new er(e,n,s)}static isValidIdentifier(e){return xR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),er.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Uv}static keyField(){return new er([Uv])}static fromServerFormat(e){const n=[];let s="",o=0;const c=()=>{if(s.length===0)throw new ze(_e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let d=!1;for(;o<e.length;){const g=e[o];if(g==="\\"){if(o+1===e.length)throw new ze(_e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new ze(_e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=p,o+=2}else g==="`"?(d=!d,o++):g!=="."||d?(s+=g,o++):(c(),o++)}if(c(),d)throw new ze(_e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new er(n)}static emptyPath(){return new er([])}}class Ze{constructor(e){this.path=e}static fromPath(e){return new Ze(tn.fromString(e))}static fromName(e){return new Ze(tn.fromString(e).popFirst(5))}static empty(){return new Ze(tn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return tn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ze(new tn(e.slice()))}}function ZE(i,e,n){if(!n)throw new ze(_e.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function wR(i,e,n,s){if(e===!0&&s===!0)throw new ze(_e.INVALID_ARGUMENT,`${i} and ${n} cannot be used together.`)}function Bv(i){if(!Ze.isDocumentKey(i))throw new ze(_e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function Fv(i){if(Ze.isDocumentKey(i))throw new ze(_e.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function eS(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function Sh(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":it(12329,{type:typeof i})}function ls(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new ze(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Sh(i);throw new ze(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return i}function kn(i,e){const n={typeString:i};return e&&(n.value=e),n}function Yc(i,e){if(!eS(i))throw new ze(_e.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const o=e[s].typeString,c="value"in e[s]?{value:e[s].value}:void 0;if(!(s in i)){n=`JSON missing required field: '${s}'`;break}const d=i[s];if(o&&typeof d!==o){n=`JSON field '${s}' must be a ${o}.`;break}if(c!==void 0&&d!==c.value){n=`Expected '${s}' field to equal '${c.value}'`;break}}if(n)throw new ze(_e.INVALID_ARGUMENT,n);return!0}const Hv=-62135596800,qv=1e6;class an{static now(){return an.fromMillis(Date.now())}static fromDate(e){return an.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*qv);return new an(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ze(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ze(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Hv)throw new ze(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ze(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/qv}_compareTo(e){return this.seconds===e.seconds?At(this.nanoseconds,e.nanoseconds):At(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:an._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yc(e,an._jsonSchema))return new an(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Hv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}an._jsonSchemaVersion="firestore/timestamp/1.0",an._jsonSchema={type:kn("string",an._jsonSchemaVersion),seconds:kn("number"),nanoseconds:kn("number")};class ot{static fromTimestamp(e){return new ot(e)}static min(){return new ot(new an(0,0))}static max(){return new ot(new an(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const kc=-1;function AR(i,e){const n=i.toTimestamp().seconds,s=i.toTimestamp().nanoseconds+1,o=ot.fromTimestamp(s===1e9?new an(n+1,0):new an(n,s));return new oa(o,Ze.empty(),e)}function CR(i){return new oa(i.readTime,i.key,kc)}class oa{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new oa(ot.min(),Ze.empty(),kc)}static max(){return new oa(ot.max(),Ze.empty(),kc)}}function RR(i,e){let n=i.readTime.compareTo(e.readTime);return n!==0?n:(n=Ze.comparator(i.documentKey,e.documentKey),n!==0?n:At(i.largestBatchId,e.largestBatchId))}const IR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class DR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function _l(i){if(i.code!==_e.FAILED_PRECONDITION||i.message!==IR)throw i;He("LocalStore","Unexpectedly lost primary lease")}class be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&it(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new be(((s,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(s,o)},this.catchCallback=c=>{this.wrapFailure(n,c).next(s,o)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof be?n:be.resolve(n)}catch(n){return be.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):be.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):be.reject(n)}static resolve(e){return new be(((n,s)=>{n(e)}))}static reject(e){return new be(((n,s)=>{s(e)}))}static waitFor(e){return new be(((n,s)=>{let o=0,c=0,d=!1;e.forEach((g=>{++o,g.next((()=>{++c,d&&c===o&&n()}),(p=>s(p)))})),d=!0,c===o&&n()}))}static or(e){let n=be.resolve(!1);for(const s of e)n=n.next((o=>o?be.resolve(o):s()));return n}static forEach(e,n){const s=[];return e.forEach(((o,c)=>{s.push(n.call(this,o,c))})),this.waitFor(s)}static mapArray(e,n){return new be(((s,o)=>{const c=e.length,d=new Array(c);let g=0;for(let p=0;p<c;p++){const y=p;n(e[y]).next((b=>{d[y]=b,++g,g===c&&s(d)}),(b=>o(b)))}}))}static doWhile(e,n){return new be(((s,o)=>{const c=()=>{e()===!0?n().next((()=>{c()}),o):s()};c()}))}}function OR(i){const e=i.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function vl(i){return i.name==="IndexedDbTransactionError"}class Th{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Th.ce=-1;const ep=-1;function xh(i){return i==null}function Xd(i){return i===0&&1/i==-1/0}function jR(i){return typeof i=="number"&&Number.isInteger(i)&&!Xd(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}const tS="";function MR(i){let e="";for(let n=0;n<i.length;n++)e.length>0&&(e=Gv(e)),e=kR(i.get(n),e);return Gv(e)}function kR(i,e){let n=e;const s=i.length;for(let o=0;o<s;o++){const c=i.charAt(o);switch(c){case"\0":n+="";break;case tS:n+="";break;default:n+=c}}return n}function Gv(i){return i+tS+""}function $v(i){let e=0;for(const n in i)Object.prototype.hasOwnProperty.call(i,n)&&e++;return e}function fa(i,e){for(const n in i)Object.prototype.hasOwnProperty.call(i,n)&&e(n,i[n])}function nS(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}class fn{constructor(e,n){this.comparator=e,this.root=n||Zn.EMPTY}insert(e,n){return new fn(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Zn.BLACK,null,null))}remove(e){return new fn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const o=this.comparator(e,s.key);if(o===0)return n+s.left.size;o<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,s)=>(e(n,s),!1)))}toString(){const e=[];return this.inorderTraversal(((n,s)=>(e.push(`${n}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cd(this.root,e,this.comparator,!0)}}class Cd{constructor(e,n,s,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=n?s(e.key,n):1,n&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zn{constructor(e,n,s,o,c){this.key=e,this.value=n,this.color=s??Zn.RED,this.left=o??Zn.EMPTY,this.right=c??Zn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,o,c){return new Zn(e??this.key,n??this.value,s??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let o=this;const c=s(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,n,s),null):c===0?o.copy(null,n,null,null,null):o.copy(null,null,null,null,o.right.insert(e,n,s)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Zn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,o=this;if(n(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,n),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),n(e,o.key)===0){if(o.right.isEmpty())return Zn.EMPTY;s=o.right.min(),o=o.copy(s.key,s.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,n))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw it(43730,{key:this.key,value:this.value});if(this.right.isRed())throw it(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw it(27949);return e+(this.isRed()?0:1)}}Zn.EMPTY=null,Zn.RED=!0,Zn.BLACK=!1;Zn.EMPTY=new class{constructor(){this.size=0}get key(){throw it(57766)}get value(){throw it(16141)}get color(){throw it(16727)}get left(){throw it(29726)}get right(){throw it(36894)}copy(e,n,s,o,c){return this}insert(e,n,s){return new Zn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Pn{constructor(e){this.comparator=e,this.data=new fn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,s)=>(e(n),!1)))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const o=s.getNext();if(this.comparator(o.key,e[1])>=0)return;n(o.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Yv(this.data.getIterator())}getIteratorFrom(e){return new Yv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((s=>{n=n.add(s)})),n}isEqual(e){if(!(e instanceof Pn)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const o=n.getNext().key,c=s.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Pn(this.comparator);return n.data=e,n}}class Yv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class jr{constructor(e){this.fields=e,e.sort(er.comparator)}static empty(){return new jr([])}unionWith(e){let n=new Pn(er.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new jr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return rl(this.fields,e.fields,((n,s)=>n.isEqual(s)))}}class rS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class tr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new rS("Invalid base64 string: "+c):c}})(e);return new tr(n)}static fromUint8Array(e){const n=(function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c})(e);return new tr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const s=new Uint8Array(n.length);for(let o=0;o<n.length;o++)s[o]=n.charCodeAt(o);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return At(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tr.EMPTY_BYTE_STRING=new tr("");const NR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function la(i){if(zt(!!i,39018),typeof i=="string"){let e=0;const n=NR.exec(i);if(zt(!!n,46558,{timestamp:i}),n[1]){let o=n[1];o=(o+"000000000").substr(0,9),e=Number(o)}const s=new Date(i);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:wn(i.seconds),nanos:wn(i.nanos)}}function wn(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function ca(i){return typeof i=="string"?tr.fromBase64String(i):tr.fromUint8Array(i)}const iS="server_timestamp",sS="__type__",aS="__previous_value__",oS="__local_write_time__";function tp(i){return(i?.mapValue?.fields||{})[sS]?.stringValue===iS}function wh(i){const e=i.mapValue.fields[aS];return tp(e)?wh(e):e}function Nc(i){const e=la(i.mapValue.fields[oS].timestampValue);return new an(e.seconds,e.nanos)}class VR{constructor(e,n,s,o,c,d,g,p,y,b){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=g,this.longPollingOptions=p,this.useFetchStreams=y,this.isUsingEmulator=b}}const Jd="(default)";class Vc{constructor(e,n){this.projectId=e,this.database=n||Jd}static empty(){return new Vc("","")}get isDefaultDatabase(){return this.database===Jd}isEqual(e){return e instanceof Vc&&e.projectId===this.projectId&&e.database===this.database}}const lS="__type__",LR="__max__",Rd={mapValue:{}},cS="__vector__",Zd="value";function ua(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?tp(i)?4:zR(i)?9007199254740991:PR(i)?10:11:it(28295,{value:i})}function Mi(i,e){if(i===e)return!0;const n=ua(i);if(n!==ua(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return Nc(i).isEqual(Nc(e));case 3:return(function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=la(o.timestampValue),g=la(c.timestampValue);return d.seconds===g.seconds&&d.nanos===g.nanos})(i,e);case 5:return i.stringValue===e.stringValue;case 6:return(function(o,c){return ca(o.bytesValue).isEqual(ca(c.bytesValue))})(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return(function(o,c){return wn(o.geoPointValue.latitude)===wn(c.geoPointValue.latitude)&&wn(o.geoPointValue.longitude)===wn(c.geoPointValue.longitude)})(i,e);case 2:return(function(o,c){if("integerValue"in o&&"integerValue"in c)return wn(o.integerValue)===wn(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=wn(o.doubleValue),g=wn(c.doubleValue);return d===g?Xd(d)===Xd(g):isNaN(d)&&isNaN(g)}return!1})(i,e);case 9:return rl(i.arrayValue.values||[],e.arrayValue.values||[],Mi);case 10:case 11:return(function(o,c){const d=o.mapValue.fields||{},g=c.mapValue.fields||{};if($v(d)!==$v(g))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(g[p]===void 0||!Mi(d[p],g[p])))return!1;return!0})(i,e);default:return it(52216,{left:i})}}function Lc(i,e){return(i.values||[]).find((n=>Mi(n,e)))!==void 0}function il(i,e){if(i===e)return 0;const n=ua(i),s=ua(e);if(n!==s)return At(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return At(i.booleanValue,e.booleanValue);case 2:return(function(c,d){const g=wn(c.integerValue||c.doubleValue),p=wn(d.integerValue||d.doubleValue);return g<p?-1:g>p?1:g===p?0:isNaN(g)?isNaN(p)?0:-1:1})(i,e);case 3:return Qv(i.timestampValue,e.timestampValue);case 4:return Qv(Nc(i),Nc(e));case 5:return _g(i.stringValue,e.stringValue);case 6:return(function(c,d){const g=ca(c),p=ca(d);return g.compareTo(p)})(i.bytesValue,e.bytesValue);case 7:return(function(c,d){const g=c.split("/"),p=d.split("/");for(let y=0;y<g.length&&y<p.length;y++){const b=At(g[y],p[y]);if(b!==0)return b}return At(g.length,p.length)})(i.referenceValue,e.referenceValue);case 8:return(function(c,d){const g=At(wn(c.latitude),wn(d.latitude));return g!==0?g:At(wn(c.longitude),wn(d.longitude))})(i.geoPointValue,e.geoPointValue);case 9:return Kv(i.arrayValue,e.arrayValue);case 10:return(function(c,d){const g=c.fields||{},p=d.fields||{},y=g[Zd]?.arrayValue,b=p[Zd]?.arrayValue,S=At(y?.values?.length||0,b?.values?.length||0);return S!==0?S:Kv(y,b)})(i.mapValue,e.mapValue);case 11:return(function(c,d){if(c===Rd.mapValue&&d===Rd.mapValue)return 0;if(c===Rd.mapValue)return 1;if(d===Rd.mapValue)return-1;const g=c.fields||{},p=Object.keys(g),y=d.fields||{},b=Object.keys(y);p.sort(),b.sort();for(let S=0;S<p.length&&S<b.length;++S){const x=_g(p[S],b[S]);if(x!==0)return x;const D=il(g[p[S]],y[b[S]]);if(D!==0)return D}return At(p.length,b.length)})(i.mapValue,e.mapValue);default:throw it(23264,{he:n})}}function Qv(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return At(i,e);const n=la(i),s=la(e),o=At(n.seconds,s.seconds);return o!==0?o:At(n.nanos,s.nanos)}function Kv(i,e){const n=i.values||[],s=e.values||[];for(let o=0;o<n.length&&o<s.length;++o){const c=il(n[o],s[o]);if(c)return c}return At(n.length,s.length)}function sl(i){return vg(i)}function vg(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(n){const s=la(n);return`time(${s.seconds},${s.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(n){return ca(n).toBase64()})(i.bytesValue):"referenceValue"in i?(function(n){return Ze.fromName(n).toString()})(i.referenceValue):"geoPointValue"in i?(function(n){return`geo(${n.latitude},${n.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(n){let s="[",o=!0;for(const c of n.values||[])o?o=!1:s+=",",s+=vg(c);return s+"]"})(i.arrayValue):"mapValue"in i?(function(n){const s=Object.keys(n.fields||{}).sort();let o="{",c=!0;for(const d of s)c?c=!1:o+=",",o+=`${d}:${vg(n.fields[d])}`;return o+"}"})(i.mapValue):it(61005,{value:i})}function zd(i){switch(ua(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wh(i);return e?16+zd(e):16;case 5:return 2*i.stringValue.length;case 6:return ca(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((o,c)=>o+zd(c)),0)})(i.arrayValue);case 10:case 11:return(function(s){let o=0;return fa(s.fields,((c,d)=>{o+=c.length+zd(d)})),o})(i.mapValue);default:throw it(13486,{value:i})}}function Wv(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function bg(i){return!!i&&"integerValue"in i}function np(i){return!!i&&"arrayValue"in i}function Xv(i){return!!i&&"nullValue"in i}function Jv(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function Ud(i){return!!i&&"mapValue"in i}function PR(i){return(i?.mapValue?.fields||{})[lS]?.stringValue===cS}function Cc(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return fa(i.mapValue.fields,((n,s)=>e.mapValue.fields[n]=Cc(s))),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(i.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Cc(i.arrayValue.values[n]);return e}return{...i}}function zR(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===LR}class br{constructor(e){this.value=e}static empty(){return new br({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Ud(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cc(n)}setAll(e){let n=er.emptyPath(),s={},o=[];e.forEach(((d,g)=>{if(!n.isImmediateParentOf(g)){const p=this.getFieldsMap(n);this.applyChanges(p,s,o),s={},o=[],n=g.popLast()}d?s[g.lastSegment()]=Cc(d):o.push(g.lastSegment())}));const c=this.getFieldsMap(n);this.applyChanges(c,s,o)}delete(e){const n=this.field(e.popLast());Ud(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let o=n.mapValue.fields[e.get(s)];Ud(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=o),n=o}return n.mapValue.fields}applyChanges(e,n,s){fa(n,((o,c)=>e[o]=c));for(const o of s)delete e[o]}clone(){return new br(Cc(this.value))}}function uS(i){const e=[];return fa(i.fields,((n,s)=>{const o=new er([n]);if(Ud(s)){const c=uS(s.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)})),new jr(e)}class sr{constructor(e,n,s,o,c,d,g){this.key=e,this.documentType=n,this.version=s,this.readTime=o,this.createTime=c,this.data=d,this.documentState=g}static newInvalidDocument(e){return new sr(e,0,ot.min(),ot.min(),ot.min(),br.empty(),0)}static newFoundDocument(e,n,s,o){return new sr(e,1,n,ot.min(),s,o,0)}static newNoDocument(e,n){return new sr(e,2,n,ot.min(),ot.min(),br.empty(),0)}static newUnknownDocument(e,n){return new sr(e,3,n,ot.min(),ot.min(),br.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=br.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=br.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ot.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof sr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new sr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class eh{constructor(e,n){this.position=e,this.inclusive=n}}function Zv(i,e,n){let s=0;for(let o=0;o<i.position.length;o++){const c=e[o],d=i.position[o];if(c.field.isKeyField()?s=Ze.comparator(Ze.fromName(d.referenceValue),n.key):s=il(d,n.data.field(c.field)),c.dir==="desc"&&(s*=-1),s!==0)break}return s}function eb(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let n=0;n<i.position.length;n++)if(!Mi(i.position[n],e.position[n]))return!1;return!0}class th{constructor(e,n="asc"){this.field=e,this.dir=n}}function UR(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}class dS{}class Mn extends dS{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new FR(e,n,s):n==="array-contains"?new GR(e,s):n==="in"?new $R(e,s):n==="not-in"?new YR(e,s):n==="array-contains-any"?new QR(e,s):new Mn(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new HR(e,s):new qR(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(il(n,this.value)):n!==null&&ua(this.value)===ua(n)&&this.matchesComparison(il(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return it(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ui extends dS{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new ui(e,n)}matches(e){return hS(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function hS(i){return i.op==="and"}function fS(i){return BR(i)&&hS(i)}function BR(i){for(const e of i.filters)if(e instanceof ui)return!1;return!0}function Eg(i){if(i instanceof Mn)return i.field.canonicalString()+i.op.toString()+sl(i.value);if(fS(i))return i.filters.map((e=>Eg(e))).join(",");{const e=i.filters.map((n=>Eg(n))).join(",");return`${i.op}(${e})`}}function mS(i,e){return i instanceof Mn?(function(s,o){return o instanceof Mn&&s.op===o.op&&s.field.isEqual(o.field)&&Mi(s.value,o.value)})(i,e):i instanceof ui?(function(s,o){return o instanceof ui&&s.op===o.op&&s.filters.length===o.filters.length?s.filters.reduce(((c,d,g)=>c&&mS(d,o.filters[g])),!0):!1})(i,e):void it(19439)}function gS(i){return i instanceof Mn?(function(n){return`${n.field.canonicalString()} ${n.op} ${sl(n.value)}`})(i):i instanceof ui?(function(n){return n.op.toString()+" {"+n.getFilters().map(gS).join(" ,")+"}"})(i):"Filter"}class FR extends Mn{constructor(e,n,s){super(e,n,s),this.key=Ze.fromName(s.referenceValue)}matches(e){const n=Ze.comparator(e.key,this.key);return this.matchesComparison(n)}}class HR extends Mn{constructor(e,n){super(e,"in",n),this.keys=pS("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class qR extends Mn{constructor(e,n){super(e,"not-in",n),this.keys=pS("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function pS(i,e){return(e.arrayValue?.values||[]).map((n=>Ze.fromName(n.referenceValue)))}class GR extends Mn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return np(n)&&Lc(n.arrayValue,this.value)}}class $R extends Mn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Lc(this.value.arrayValue,n)}}class YR extends Mn{constructor(e,n){super(e,"not-in",n)}matches(e){if(Lc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Lc(this.value.arrayValue,n)}}class QR extends Mn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!np(n)||!n.arrayValue.values)&&n.arrayValue.values.some((s=>Lc(this.value.arrayValue,s)))}}class KR{constructor(e,n=null,s=[],o=[],c=null,d=null,g=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=o,this.limit=c,this.startAt=d,this.endAt=g,this.Te=null}}function tb(i,e=null,n=[],s=[],o=null,c=null,d=null){return new KR(i,e,n,s,o,c,d)}function rp(i){const e=ut(i);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((s=>Eg(s))).join(","),n+="|ob:",n+=e.orderBy.map((s=>(function(c){return c.field.canonicalString()+c.dir})(s))).join(","),xh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((s=>sl(s))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((s=>sl(s))).join(",")),e.Te=n}return e.Te}function ip(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<i.orderBy.length;n++)if(!UR(i.orderBy[n],e.orderBy[n]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let n=0;n<i.filters.length;n++)if(!mS(i.filters[n],e.filters[n]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!eb(i.startAt,e.startAt)&&eb(i.endAt,e.endAt)}function Sg(i){return Ze.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}class Qc{constructor(e,n=null,s=[],o=[],c=null,d="F",g=null,p=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=o,this.limit=c,this.limitType=d,this.startAt=g,this.endAt=p,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function WR(i,e,n,s,o,c,d,g){return new Qc(i,e,n,s,o,c,d,g)}function sp(i){return new Qc(i)}function nb(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function yS(i){return i.collectionGroup!==null}function Rc(i){const e=ut(i);if(e.Ie===null){e.Ie=[];const n=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),n.add(c.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let g=new Pn(er.comparator);return d.filters.forEach((p=>{p.getFlattenedFilters().forEach((y=>{y.isInequality()&&(g=g.add(y.field))}))})),g})(e).forEach((c=>{n.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new th(c,s))})),n.has(er.keyField().canonicalString())||e.Ie.push(new th(er.keyField(),s))}return e.Ie}function Ai(i){const e=ut(i);return e.Ee||(e.Ee=XR(e,Rc(i))),e.Ee}function XR(i,e){if(i.limitType==="F")return tb(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map((o=>{const c=o.dir==="desc"?"asc":"desc";return new th(o.field,c)}));const n=i.endAt?new eh(i.endAt.position,i.endAt.inclusive):null,s=i.startAt?new eh(i.startAt.position,i.startAt.inclusive):null;return tb(i.path,i.collectionGroup,e,i.filters,i.limit,n,s)}}function Tg(i,e){const n=i.filters.concat([e]);return new Qc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),n,i.limit,i.limitType,i.startAt,i.endAt)}function xg(i,e,n){return new Qc(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,n,i.startAt,i.endAt)}function Ah(i,e){return ip(Ai(i),Ai(e))&&i.limitType===e.limitType}function _S(i){return`${rp(Ai(i))}|lt:${i.limitType}`}function $o(i){return`Query(target=${(function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map((o=>gS(o))).join(", ")}]`),xh(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map((o=>sl(o))).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map((o=>sl(o))).join(",")),`Target(${s})`})(Ai(i))}; limitType=${i.limitType})`}function Ch(i,e){return e.isFoundDocument()&&(function(s,o){const c=o.key.path;return s.collectionGroup!==null?o.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(c):Ze.isDocumentKey(s.path)?s.path.isEqual(c):s.path.isImmediateParentOf(c)})(i,e)&&(function(s,o){for(const c of Rc(s))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0})(i,e)&&(function(s,o){for(const c of s.filters)if(!c.matches(o))return!1;return!0})(i,e)&&(function(s,o){return!(s.startAt&&!(function(d,g,p){const y=Zv(d,g,p);return d.inclusive?y<=0:y<0})(s.startAt,Rc(s),o)||s.endAt&&!(function(d,g,p){const y=Zv(d,g,p);return d.inclusive?y>=0:y>0})(s.endAt,Rc(s),o))})(i,e)}function JR(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function vS(i){return(e,n)=>{let s=!1;for(const o of Rc(i)){const c=ZR(o,e,n);if(c!==0)return c;s=s||o.field.isKeyField()}return 0}}function ZR(i,e,n){const s=i.field.isKeyField()?Ze.comparator(e.key,n.key):(function(c,d,g){const p=d.data.field(c),y=g.data.field(c);return p!==null&&y!==null?il(p,y):it(42886)})(i.field,e,n);switch(i.dir){case"asc":return s;case"desc":return-1*s;default:return it(19790,{direction:i.dir})}}class Ja{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[o,c]of s)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),o=this.inner[s];if(o===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,n]);o.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return s.length===1?delete this.inner[n]:s.splice(o,1),this.innerSize--,!0;return!1}forEach(e){fa(this.inner,((n,s)=>{for(const[o,c]of s)e(o,c)}))}isEmpty(){return nS(this.inner)}size(){return this.innerSize}}const eI=new fn(Ze.comparator);function cs(){return eI}const bS=new fn(Ze.comparator);function Tc(...i){let e=bS;for(const n of i)e=e.insert(n.key,n);return e}function ES(i){let e=bS;return i.forEach(((n,s)=>e=e.insert(n,s.overlayedDocument))),e}function qa(){return Ic()}function SS(){return Ic()}function Ic(){return new Ja((i=>i.toString()),((i,e)=>i.isEqual(e)))}const tI=new fn(Ze.comparator),nI=new Pn(Ze.comparator);function Ct(...i){let e=nI;for(const n of i)e=e.add(n);return e}const rI=new Pn(At);function iI(){return rI}function ap(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xd(e)?"-0":e}}function TS(i){return{integerValue:""+i}}function sI(i,e){return jR(e)?TS(e):ap(i,e)}class Rh{constructor(){this._=void 0}}function aI(i,e,n){return i instanceof nh?(function(o,c){const d={fields:{[sS]:{stringValue:iS},[oS]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&tp(c)&&(c=wh(c)),c&&(d.fields[aS]=c),{mapValue:d}})(n,e):i instanceof al?wS(i,e):i instanceof Pc?AS(i,e):(function(o,c){const d=xS(o,c),g=rb(d)+rb(o.Ae);return bg(d)&&bg(o.Ae)?TS(g):ap(o.serializer,g)})(i,e)}function oI(i,e,n){return i instanceof al?wS(i,e):i instanceof Pc?AS(i,e):n}function xS(i,e){return i instanceof rh?(function(s){return bg(s)||(function(c){return!!c&&"doubleValue"in c})(s)})(e)?e:{integerValue:0}:null}class nh extends Rh{}class al extends Rh{constructor(e){super(),this.elements=e}}function wS(i,e){const n=CS(e);for(const s of i.elements)n.some((o=>Mi(o,s)))||n.push(s);return{arrayValue:{values:n}}}class Pc extends Rh{constructor(e){super(),this.elements=e}}function AS(i,e){let n=CS(e);for(const s of i.elements)n=n.filter((o=>!Mi(o,s)));return{arrayValue:{values:n}}}class rh extends Rh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function rb(i){return wn(i.integerValue||i.doubleValue)}function CS(i){return np(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}class lI{constructor(e,n){this.field=e,this.transform=n}}function cI(i,e){return i.field.isEqual(e.field)&&(function(s,o){return s instanceof al&&o instanceof al||s instanceof Pc&&o instanceof Pc?rl(s.elements,o.elements,Mi):s instanceof rh&&o instanceof rh?Mi(s.Ae,o.Ae):s instanceof nh&&o instanceof nh})(i.transform,e.transform)}class uI{constructor(e,n){this.version=e,this.transformResults=n}}class Ci{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ci}static exists(e){return new Ci(void 0,e)}static updateTime(e){return new Ci(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bd(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class Ih{}function RS(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new DS(i.key,Ci.none()):new Kc(i.key,i.data,Ci.none());{const n=i.data,s=br.empty();let o=new Pn(er.comparator);for(let c of e.fields)if(!o.has(c)){let d=n.field(c);d===null&&c.length>1&&(c=c.popLast(),d=n.field(c)),d===null?s.delete(c):s.set(c,d),o=o.add(c)}return new ma(i.key,s,new jr(o.toArray()),Ci.none())}}function dI(i,e,n){i instanceof Kc?(function(o,c,d){const g=o.value.clone(),p=sb(o.fieldTransforms,c,d.transformResults);g.setAll(p),c.convertToFoundDocument(d.version,g).setHasCommittedMutations()})(i,e,n):i instanceof ma?(function(o,c,d){if(!Bd(o.precondition,c))return void c.convertToUnknownDocument(d.version);const g=sb(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(IS(o)),p.setAll(g),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(i,e,n):(function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,n)}function Dc(i,e,n,s){return i instanceof Kc?(function(c,d,g,p){if(!Bd(c.precondition,d))return g;const y=c.value.clone(),b=ab(c.fieldTransforms,p,d);return y.setAll(b),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(i,e,n,s):i instanceof ma?(function(c,d,g,p){if(!Bd(c.precondition,d))return g;const y=ab(c.fieldTransforms,p,d),b=d.data;return b.setAll(IS(c)),b.setAll(y),d.convertToFoundDocument(d.version,b).setHasLocalMutations(),g===null?null:g.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((S=>S.field)))})(i,e,n,s):(function(c,d,g){return Bd(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):g})(i,e,n)}function hI(i,e){let n=null;for(const s of i.fieldTransforms){const o=e.data.field(s.field),c=xS(s.transform,o||null);c!=null&&(n===null&&(n=br.empty()),n.set(s.field,c))}return n||null}function ib(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!(function(s,o){return s===void 0&&o===void 0||!(!s||!o)&&rl(s,o,((c,d)=>cI(c,d)))})(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class Kc extends Ih{constructor(e,n,s,o=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class ma extends Ih{constructor(e,n,s,o,c=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function IS(i){const e=new Map;return i.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const s=i.data.field(n);e.set(n,s)}})),e}function sb(i,e,n){const s=new Map;zt(i.length===n.length,32656,{Re:n.length,Ve:i.length});for(let o=0;o<n.length;o++){const c=i[o],d=c.transform,g=e.data.field(c.field);s.set(c.field,oI(d,g,n[o]))}return s}function ab(i,e,n){const s=new Map;for(const o of i){const c=o.transform,d=n.data.field(o.field);s.set(o.field,aI(c,d,e))}return s}class DS extends Ih{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class fI extends Ih{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class mI{constructor(e,n,s,o){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=o}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&dI(c,e,s[o])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=Dc(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=Dc(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=SS();return this.mutations.forEach((o=>{const c=e.get(o.key),d=c.overlayedDocument;let g=this.applyToLocalView(d,c.mutatedFields);g=n.has(o.key)?null:g;const p=RS(d,g);p!==null&&s.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(ot.min())})),s}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Ct())}isEqual(e){return this.batchId===e.batchId&&rl(this.mutations,e.mutations,((n,s)=>ib(n,s)))&&rl(this.baseMutations,e.baseMutations,((n,s)=>ib(n,s)))}}class op{constructor(e,n,s,o){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=o}static from(e,n,s){zt(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let o=(function(){return tI})();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,s[d].version);return new op(e,n,s,o)}}class gI{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class pI{constructor(e,n){this.count=e,this.unchangedNames=n}}var jn,Dt;function yI(i){switch(i){case _e.OK:return it(64938);case _e.CANCELLED:case _e.UNKNOWN:case _e.DEADLINE_EXCEEDED:case _e.RESOURCE_EXHAUSTED:case _e.INTERNAL:case _e.UNAVAILABLE:case _e.UNAUTHENTICATED:return!1;case _e.INVALID_ARGUMENT:case _e.NOT_FOUND:case _e.ALREADY_EXISTS:case _e.PERMISSION_DENIED:case _e.FAILED_PRECONDITION:case _e.ABORTED:case _e.OUT_OF_RANGE:case _e.UNIMPLEMENTED:case _e.DATA_LOSS:return!0;default:return it(15467,{code:i})}}function OS(i){if(i===void 0)return os("GRPC error has no .code"),_e.UNKNOWN;switch(i){case jn.OK:return _e.OK;case jn.CANCELLED:return _e.CANCELLED;case jn.UNKNOWN:return _e.UNKNOWN;case jn.DEADLINE_EXCEEDED:return _e.DEADLINE_EXCEEDED;case jn.RESOURCE_EXHAUSTED:return _e.RESOURCE_EXHAUSTED;case jn.INTERNAL:return _e.INTERNAL;case jn.UNAVAILABLE:return _e.UNAVAILABLE;case jn.UNAUTHENTICATED:return _e.UNAUTHENTICATED;case jn.INVALID_ARGUMENT:return _e.INVALID_ARGUMENT;case jn.NOT_FOUND:return _e.NOT_FOUND;case jn.ALREADY_EXISTS:return _e.ALREADY_EXISTS;case jn.PERMISSION_DENIED:return _e.PERMISSION_DENIED;case jn.FAILED_PRECONDITION:return _e.FAILED_PRECONDITION;case jn.ABORTED:return _e.ABORTED;case jn.OUT_OF_RANGE:return _e.OUT_OF_RANGE;case jn.UNIMPLEMENTED:return _e.UNIMPLEMENTED;case jn.DATA_LOSS:return _e.DATA_LOSS;default:return it(39323,{code:i})}}(Dt=jn||(jn={}))[Dt.OK=0]="OK",Dt[Dt.CANCELLED=1]="CANCELLED",Dt[Dt.UNKNOWN=2]="UNKNOWN",Dt[Dt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Dt[Dt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Dt[Dt.NOT_FOUND=5]="NOT_FOUND",Dt[Dt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Dt[Dt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Dt[Dt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Dt[Dt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Dt[Dt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Dt[Dt.ABORTED=10]="ABORTED",Dt[Dt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Dt[Dt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Dt[Dt.INTERNAL=13]="INTERNAL",Dt[Dt.UNAVAILABLE=14]="UNAVAILABLE",Dt[Dt.DATA_LOSS=15]="DATA_LOSS";function _I(){return new TextEncoder}const vI=new ra([4294967295,4294967295],0);function ob(i){const e=_I().encode(i),n=new GE;return n.update(e),new Uint8Array(n.digest())}function lb(i){const e=new DataView(i.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new ra([n,s],0),new ra([o,c],0)]}class lp{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new xc(`Invalid padding: ${n}`);if(s<0)throw new xc(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new xc(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new xc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ra.fromNumber(this.ge)}ye(e,n,s){let o=e.add(n.multiply(ra.fromNumber(s)));return o.compare(vI)===1&&(o=new ra([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=ob(e),[s,o]=lb(n);for(let c=0;c<this.hashCount;c++){const d=this.ye(s,o,c);if(!this.we(d))return!1}return!0}static create(e,n,s){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new lp(c,o,n);return s.forEach((g=>d.insert(g))),d}insert(e){if(this.ge===0)return;const n=ob(e),[s,o]=lb(n);for(let c=0;c<this.hashCount;c++){const d=this.ye(s,o,c);this.Se(d)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class xc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Dh{constructor(e,n,s,o,c){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const o=new Map;return o.set(e,Wc.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new Dh(ot.min(),o,new fn(At),cs(),Ct())}}class Wc{constructor(e,n,s,o,c){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new Wc(s,n,Ct(),Ct(),Ct())}}class Fd{constructor(e,n,s,o){this.be=e,this.removedTargetIds=n,this.key=s,this.De=o}}class jS{constructor(e,n){this.targetId=e,this.Ce=n}}class MS{constructor(e,n,s=tr.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=o}}class cb{constructor(){this.ve=0,this.Fe=ub(),this.Me=tr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ct(),n=Ct(),s=Ct();return this.Fe.forEach(((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:n=n.add(o);break;case 1:s=s.add(o);break;default:it(38017,{changeType:c})}})),new Wc(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=ub()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,zt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class bI{constructor(e){this.Ge=e,this.ze=new Map,this.je=cs(),this.Je=Id(),this.He=Id(),this.Ye=new fn(At)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:it(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((s,o)=>{this.rt(o)&&n(o)}))}st(e){const n=e.targetId,s=e.Ce.count,o=this.ot(n);if(o){const c=o.target;if(Sg(c))if(s===0){const d=new Ze(c.path);this.et(n,d,sr.newNoDocument(d,ot.min()))}else zt(s===1,20013,{expectedCount:s});else{const d=this._t(n);if(d!==s){const g=this.ut(e),p=g?this.ct(g,e,d):1;if(p!==0){this.it(n);const y=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,y)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:o=0},hashCount:c=0}=n;let d,g;try{d=ca(s).toUint8Array()}catch(p){if(p instanceof rS)return nl("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{g=new lp(d,o,c)}catch(p){return nl(p instanceof xc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return g.ge===0?null:g}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let o=0;return s.forEach((c=>{const d=this.Ge.ht(),g=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(g)||(this.et(n,c,null),o++)})),o}Tt(e){const n=new Map;this.ze.forEach(((c,d)=>{const g=this.ot(d);if(g){if(c.current&&Sg(g.target)){const p=new Ze(g.target.path);this.It(p).has(d)||this.Et(d,p)||this.et(d,p,sr.newNoDocument(p,e))}c.Be&&(n.set(d,c.ke()),c.qe())}}));let s=Ct();this.He.forEach(((c,d)=>{let g=!0;d.forEachWhile((p=>{const y=this.ot(p);return!y||y.purpose==="TargetPurposeLimboResolution"||(g=!1,!1)})),g&&(s=s.add(c))})),this.je.forEach(((c,d)=>d.setReadTime(e)));const o=new Dh(e,n,this.Ye,this.je,s);return this.je=cs(),this.Je=Id(),this.He=Id(),this.Ye=new fn(At),o}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,n)?o.Qe(n,1):o.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new cb,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Pn(At),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Pn(At),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||He("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new cb),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Id(){return new fn(Ze.comparator)}function ub(){return new fn(Ze.comparator)}const EI={asc:"ASCENDING",desc:"DESCENDING"},SI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},TI={and:"AND",or:"OR"};class xI{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function wg(i,e){return i.useProto3Json||xh(e)?e:{value:e}}function ih(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kS(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function wI(i,e){return ih(i,e.toTimestamp())}function Ri(i){return zt(!!i,49232),ot.fromTimestamp((function(n){const s=la(n);return new an(s.seconds,s.nanos)})(i))}function cp(i,e){return Ag(i,e).canonicalString()}function Ag(i,e){const n=(function(o){return new tn(["projects",o.projectId,"databases",o.database])})(i).child("documents");return e===void 0?n:n.child(e)}function NS(i){const e=tn.fromString(i);return zt(US(e),10190,{key:e.toString()}),e}function Cg(i,e){return cp(i.databaseId,e.path)}function tg(i,e){const n=NS(e);if(n.get(1)!==i.databaseId.projectId)throw new ze(_e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+i.databaseId.projectId);if(n.get(3)!==i.databaseId.database)throw new ze(_e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+i.databaseId.database);return new Ze(LS(n))}function VS(i,e){return cp(i.databaseId,e)}function AI(i){const e=NS(i);return e.length===4?tn.emptyPath():LS(e)}function Rg(i){return new tn(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function LS(i){return zt(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function db(i,e,n){return{name:Cg(i,e),fields:n.value.mapValue.fields}}function CI(i,e){let n;if("targetChange"in e){e.targetChange;const s=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:it(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=(function(y,b){return y.useProto3Json?(zt(b===void 0||typeof b=="string",58123),tr.fromBase64String(b||"")):(zt(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),tr.fromUint8Array(b||new Uint8Array))})(i,e.targetChange.resumeToken),d=e.targetChange.cause,g=d&&(function(y){const b=y.code===void 0?_e.UNKNOWN:OS(y.code);return new ze(b,y.message||"")})(d);n=new MS(s,o,c,g||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const o=tg(i,s.document.name),c=Ri(s.document.updateTime),d=s.document.createTime?Ri(s.document.createTime):ot.min(),g=new br({mapValue:{fields:s.document.fields}}),p=sr.newFoundDocument(o,c,d,g),y=s.targetIds||[],b=s.removedTargetIds||[];n=new Fd(y,b,p.key,p)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const o=tg(i,s.document),c=s.readTime?Ri(s.readTime):ot.min(),d=sr.newNoDocument(o,c),g=s.removedTargetIds||[];n=new Fd([],g,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const o=tg(i,s.document),c=s.removedTargetIds||[];n=new Fd([],c,o,null)}else{if(!("filter"in e))return it(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:o=0,unchangedNames:c}=s,d=new pI(o,c),g=s.targetId;n=new jS(g,d)}}return n}function RI(i,e){let n;if(e instanceof Kc)n={update:db(i,e.key,e.value)};else if(e instanceof DS)n={delete:Cg(i,e.key)};else if(e instanceof ma)n={update:db(i,e.key,e.data),updateMask:LI(e.fieldMask)};else{if(!(e instanceof fI))return it(16599,{Vt:e.type});n={verify:Cg(i,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((s=>(function(c,d){const g=d.transform;if(g instanceof nh)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(g instanceof al)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:g.elements}};if(g instanceof Pc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:g.elements}};if(g instanceof rh)return{fieldPath:d.field.canonicalString(),increment:g.Ae};throw it(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(n.currentDocument=(function(o,c){return c.updateTime!==void 0?{updateTime:wI(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:it(27497)})(i,e.precondition)),n}function II(i,e){return i&&i.length>0?(zt(e!==void 0,14353),i.map((n=>(function(o,c){let d=o.updateTime?Ri(o.updateTime):Ri(c);return d.isEqual(ot.min())&&(d=Ri(c)),new uI(d,o.transformResults||[])})(n,e)))):[]}function DI(i,e){return{documents:[VS(i,e.path)]}}function OI(i,e){const n={structuredQuery:{}},s=e.path;let o;e.collectionGroup!==null?(o=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=VS(i,o);const c=(function(y){if(y.length!==0)return zS(ui.create(y,"and"))})(e.filters);c&&(n.structuredQuery.where=c);const d=(function(y){if(y.length!==0)return y.map((b=>(function(x){return{field:Yo(x.field),direction:kI(x.dir)}})(b)))})(e.orderBy);d&&(n.structuredQuery.orderBy=d);const g=wg(i,e.limit);return g!==null&&(n.structuredQuery.limit=g),e.startAt&&(n.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:n,parent:o}}function jI(i){let e=AI(i.parent);const n=i.structuredQuery,s=n.from?n.from.length:0;let o=null;if(s>0){zt(s===1,65062);const b=n.from[0];b.allDescendants?o=b.collectionId:e=e.child(b.collectionId)}let c=[];n.where&&(c=(function(S){const x=PS(S);return x instanceof ui&&fS(x)?x.getFilters():[x]})(n.where));let d=[];n.orderBy&&(d=(function(S){return S.map((x=>(function(k){return new th(Qo(k.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(x)))})(n.orderBy));let g=null;n.limit&&(g=(function(S){let x;return x=typeof S=="object"?S.value:S,xh(x)?null:x})(n.limit));let p=null;n.startAt&&(p=(function(S){const x=!!S.before,D=S.values||[];return new eh(D,x)})(n.startAt));let y=null;return n.endAt&&(y=(function(S){const x=!S.before,D=S.values||[];return new eh(D,x)})(n.endAt)),WR(e,o,d,c,g,"F",p,y)}function MI(i,e){const n=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return it(28987,{purpose:o})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function PS(i){return i.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=Qo(n.unaryFilter.field);return Mn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const o=Qo(n.unaryFilter.field);return Mn.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Qo(n.unaryFilter.field);return Mn.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Qo(n.unaryFilter.field);return Mn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return it(61313);default:return it(60726)}})(i):i.fieldFilter!==void 0?(function(n){return Mn.create(Qo(n.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return it(58110);default:return it(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(n){return ui.create(n.compositeFilter.filters.map((s=>PS(s))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return it(1026)}})(n.compositeFilter.op))})(i):it(30097,{filter:i})}function kI(i){return EI[i]}function NI(i){return SI[i]}function VI(i){return TI[i]}function Yo(i){return{fieldPath:i.canonicalString()}}function Qo(i){return er.fromServerFormat(i.fieldPath)}function zS(i){return i instanceof Mn?(function(n){if(n.op==="=="){if(Jv(n.value))return{unaryFilter:{field:Yo(n.field),op:"IS_NAN"}};if(Xv(n.value))return{unaryFilter:{field:Yo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Jv(n.value))return{unaryFilter:{field:Yo(n.field),op:"IS_NOT_NAN"}};if(Xv(n.value))return{unaryFilter:{field:Yo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yo(n.field),op:NI(n.op),value:n.value}}})(i):i instanceof ui?(function(n){const s=n.getFilters().map((o=>zS(o)));return s.length===1?s[0]:{compositeFilter:{op:VI(n.op),filters:s}}})(i):it(54877,{filter:i})}function LI(i){const e=[];return i.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function US(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}class Zs{constructor(e,n,s,o,c=ot.min(),d=ot.min(),g=tr.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=g,this.expectedCount=p}withSequenceNumber(e){return new Zs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Zs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class PI{constructor(e){this.yt=e}}function zI(i){const e=jI({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?xg(e,e.limit,"L"):e}class UI{constructor(){this.Cn=new BI}addToCollectionParentIndex(e,n){return this.Cn.add(n),be.resolve()}getCollectionParents(e,n){return be.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return be.resolve()}deleteFieldIndex(e,n){return be.resolve()}deleteAllFieldIndexes(e){return be.resolve()}createTargetIndexes(e,n){return be.resolve()}getDocumentsMatchingTarget(e,n){return be.resolve(null)}getIndexType(e,n){return be.resolve(0)}getFieldIndexes(e,n){return be.resolve([])}getNextCollectionGroupToUpdate(e){return be.resolve(null)}getMinOffset(e,n){return be.resolve(oa.min())}getMinOffsetFromCollectionGroup(e,n){return be.resolve(oa.min())}updateCollectionGroup(e,n,s){return be.resolve()}updateIndexEntries(e,n){return be.resolve()}}class BI{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),o=this.index[n]||new Pn(tn.comparator),c=!o.has(s);return this.index[n]=o.add(s),c}has(e){const n=e.lastSegment(),s=e.popLast(),o=this.index[n];return o&&o.has(s)}getEntries(e){return(this.index[e]||new Pn(tn.comparator)).toArray()}}const hb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},BS=41943040;class vr{static withCacheSize(e){return new vr(e,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}vr.DEFAULT_COLLECTION_PERCENTILE=10,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vr.DEFAULT=new vr(BS,vr.DEFAULT_COLLECTION_PERCENTILE,vr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vr.DISABLED=new vr(-1,0,0);class ol{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ol(0)}static cr(){return new ol(-1)}}const fb="LruGarbageCollector",FI=1048576;function mb([i,e],[n,s]){const o=At(i,n);return o===0?At(e,s):o}class HI{constructor(e){this.Ir=e,this.buffer=new Pn(mb),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();mb(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class qI{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){He(fb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){vl(n)?He(fb,"Ignoring IndexedDB error during garbage collection: ",n):await _l(n)}await this.Vr(3e5)}))}}class GI{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((s=>Math.floor(n/100*s)))}nthSequenceNumber(e,n){if(n===0)return be.resolve(Th.ce);const s=new HI(n);return this.mr.forEachTarget(e,(o=>s.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>s.Ar(o))))).next((()=>s.maxValue))}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(He("LruGarbageCollector","Garbage collection skipped; disabled"),be.resolve(hb)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(He("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hb):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,o,c,d,g,p,y;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((S=>(S>this.params.maximumSequenceNumbersToCollect?(He("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),o=this.params.maximumSequenceNumbersToCollect):o=S,d=Date.now(),this.nthSequenceNumber(e,o)))).next((S=>(s=S,g=Date.now(),this.removeTargets(e,s,n)))).next((S=>(c=S,p=Date.now(),this.removeOrphanedDocuments(e,s)))).next((S=>(y=Date.now(),Go()<=wt.DEBUG&&He("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-b}ms
	Determined least recently used ${o} in `+(g-d)+`ms
	Removed ${c} targets in `+(p-g)+`ms
	Removed ${S} documents in `+(y-p)+`ms
Total Duration: ${y-b}ms`),be.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:S}))))}}function $I(i,e){return new GI(i,e)}class YI{constructor(){this.changes=new Ja((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,sr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?be.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class QI{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class KI{constructor(e,n,s,o){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=o}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next((o=>(s=o,this.remoteDocumentCache.getEntry(e,n)))).next((o=>(s!==null&&Dc(s.mutation,o,jr.empty(),an.now()),o)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((s=>this.getLocalViewOfDocuments(e,s,Ct()).next((()=>s))))}getLocalViewOfDocuments(e,n,s=Ct()){const o=qa();return this.populateOverlays(e,o,n).next((()=>this.computeViews(e,n,o,s).next((c=>{let d=Tc();return c.forEach(((g,p)=>{d=d.insert(g,p.overlayedDocument)})),d}))))}getOverlayedDocuments(e,n){const s=qa();return this.populateOverlays(e,s,n).next((()=>this.computeViews(e,n,s,Ct())))}populateOverlays(e,n,s){const o=[];return s.forEach((c=>{n.has(c)||o.push(c)})),this.documentOverlayCache.getOverlays(e,o).next((c=>{c.forEach(((d,g)=>{n.set(d,g)}))}))}computeViews(e,n,s,o){let c=cs();const d=Ic(),g=(function(){return Ic()})();return n.forEach(((p,y)=>{const b=s.get(y.key);o.has(y.key)&&(b===void 0||b.mutation instanceof ma)?c=c.insert(y.key,y):b!==void 0?(d.set(y.key,b.mutation.getFieldMask()),Dc(b.mutation,y,b.mutation.getFieldMask(),an.now())):d.set(y.key,jr.empty())})),this.recalculateAndSaveOverlays(e,c).next((p=>(p.forEach(((y,b)=>d.set(y,b))),n.forEach(((y,b)=>g.set(y,new QI(b,d.get(y)??null)))),g)))}recalculateAndSaveOverlays(e,n){const s=Ic();let o=new fn(((d,g)=>d-g)),c=Ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((d=>{for(const g of d)g.keys().forEach((p=>{const y=n.get(p);if(y===null)return;let b=s.get(p)||jr.empty();b=g.applyToLocalView(y,b),s.set(p,b);const S=(o.get(g.batchId)||Ct()).add(p);o=o.insert(g.batchId,S)}))})).next((()=>{const d=[],g=o.getReverseIterator();for(;g.hasNext();){const p=g.getNext(),y=p.key,b=p.value,S=SS();b.forEach((x=>{if(!c.has(x)){const D=RS(n.get(x),s.get(x));D!==null&&S.set(x,D),c=c.add(x)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,S))}return be.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,n,s,o){return(function(d){return Ze.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yS(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,o):this.getDocumentsMatchingCollectionQuery(e,n,s,o)}getNextDocuments(e,n,s,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,o).next((c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,o-c.size):be.resolve(qa());let g=kc,p=c;return d.next((y=>be.forEach(y,((b,S)=>(g<S.largestBatchId&&(g=S.largestBatchId),c.get(b)?be.resolve():this.remoteDocumentCache.getEntry(e,b).next((x=>{p=p.insert(b,x)}))))).next((()=>this.populateOverlays(e,y,c))).next((()=>this.computeViews(e,p,y,Ct()))).next((b=>({batchId:g,changes:ES(b)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ze(n)).next((s=>{let o=Tc();return s.isFoundDocument()&&(o=o.insert(s.key,s)),o}))}getDocumentsMatchingCollectionGroupQuery(e,n,s,o){const c=n.collectionGroup;let d=Tc();return this.indexManager.getCollectionParents(e,c).next((g=>be.forEach(g,(p=>{const y=(function(S,x){return new Qc(x,null,S.explicitOrderBy.slice(),S.filters.slice(),S.limit,S.limitType,S.startAt,S.endAt)})(n,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,y,s,o).next((b=>{b.forEach(((S,x)=>{d=d.insert(S,x)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,n,s,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next((d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,c,o)))).next((d=>{c.forEach(((p,y)=>{const b=y.getKey();d.get(b)===null&&(d=d.insert(b,sr.newInvalidDocument(b)))}));let g=Tc();return d.forEach(((p,y)=>{const b=c.get(p);b!==void 0&&Dc(b.mutation,y,jr.empty(),an.now()),Ch(n,y)&&(g=g.insert(p,y))})),g}))}}class WI{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return be.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(o){return{id:o.id,version:o.version,createTime:Ri(o.createTime)}})(n)),be.resolve()}getNamedQuery(e,n){return be.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(o){return{name:o.name,query:zI(o.bundledQuery),readTime:Ri(o.readTime)}})(n)),be.resolve()}}class XI{constructor(){this.overlays=new fn(Ze.comparator),this.qr=new Map}getOverlay(e,n){return be.resolve(this.overlays.get(n))}getOverlays(e,n){const s=qa();return be.forEach(n,(o=>this.getOverlay(e,o).next((c=>{c!==null&&s.set(o,c)})))).next((()=>s))}saveOverlays(e,n,s){return s.forEach(((o,c)=>{this.St(e,n,c)})),be.resolve()}removeOverlaysForBatchId(e,n,s){const o=this.qr.get(s);return o!==void 0&&(o.forEach((c=>this.overlays=this.overlays.remove(c))),this.qr.delete(s)),be.resolve()}getOverlaysForCollection(e,n,s){const o=qa(),c=n.length+1,d=new Ze(n.child("")),g=this.overlays.getIteratorFrom(d);for(;g.hasNext();){const p=g.getNext().value,y=p.getKey();if(!n.isPrefixOf(y.path))break;y.path.length===c&&p.largestBatchId>s&&o.set(p.getKey(),p)}return be.resolve(o)}getOverlaysForCollectionGroup(e,n,s,o){let c=new fn(((y,b)=>y-b));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===n&&y.largestBatchId>s){let b=c.get(y.largestBatchId);b===null&&(b=qa(),c=c.insert(y.largestBatchId,b)),b.set(y.getKey(),y)}}const g=qa(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((y,b)=>g.set(y,b))),!(g.size()>=o)););return be.resolve(g)}St(e,n,s){const o=this.overlays.get(s.key);if(o!==null){const d=this.qr.get(o.largestBatchId).delete(s.key);this.qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new gI(n,s));let c=this.qr.get(n);c===void 0&&(c=Ct(),this.qr.set(n,c)),this.qr.set(n,c.add(s.key))}}class JI{constructor(){this.sessionToken=tr.EMPTY_BYTE_STRING}getSessionToken(e){return be.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,be.resolve()}}class up{constructor(){this.Qr=new Pn(Hn.$r),this.Ur=new Pn(Hn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new Hn(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach((s=>this.addReference(s,n)))}removeReference(e,n){this.Gr(new Hn(e,n))}zr(e,n){e.forEach((s=>this.removeReference(s,n)))}jr(e){const n=new Ze(new tn([])),s=new Hn(n,e),o=new Hn(n,e+1),c=[];return this.Ur.forEachInRange([s,o],(d=>{this.Gr(d),c.push(d.key)})),c}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Ze(new tn([])),s=new Hn(n,e),o=new Hn(n,e+1);let c=Ct();return this.Ur.forEachInRange([s,o],(d=>{c=c.add(d.key)})),c}containsKey(e){const n=new Hn(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class Hn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Ze.comparator(e.key,n.key)||At(e.Yr,n.Yr)}static Kr(e,n){return At(e.Yr,n.Yr)||Ze.comparator(e.key,n.key)}}class ZI{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Pn(Hn.$r)}checkEmpty(e){return be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,o){const c=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new mI(c,n,s,o);this.mutationQueue.push(d);for(const g of o)this.Zr=this.Zr.add(new Hn(g.key,c)),this.indexManager.addToCollectionParentIndex(e,g.key.path.popLast());return be.resolve(d)}lookupMutationBatch(e,n){return be.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,o=this.ei(s),c=o<0?0:o;return be.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return be.resolve(this.mutationQueue.length===0?ep:this.tr-1)}getAllMutationBatches(e){return be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Hn(n,0),o=new Hn(n,Number.POSITIVE_INFINITY),c=[];return this.Zr.forEachInRange([s,o],(d=>{const g=this.Xr(d.Yr);c.push(g)})),be.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Pn(At);return n.forEach((o=>{const c=new Hn(o,0),d=new Hn(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([c,d],(g=>{s=s.add(g.Yr)}))})),be.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,o=s.length+1;let c=s;Ze.isDocumentKey(c)||(c=c.child(""));const d=new Hn(new Ze(c),0);let g=new Pn(At);return this.Zr.forEachWhile((p=>{const y=p.key.path;return!!s.isPrefixOf(y)&&(y.length===o&&(g=g.add(p.Yr)),!0)}),d),be.resolve(this.ti(g))}ti(e){const n=[];return e.forEach((s=>{const o=this.Xr(s);o!==null&&n.push(o)})),n}removeMutationBatch(e,n){zt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return be.forEach(n.mutations,(o=>{const c=new Hn(o.key,n.batchId);return s=s.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=s}))}ir(e){}containsKey(e,n){const s=new Hn(n,0),o=this.Zr.firstAfterOrEqual(s);return be.resolve(n.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,be.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class e2{constructor(e){this.ri=e,this.docs=(function(){return new fn(Ze.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,o=this.docs.get(s),c=o?o.size:0,d=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return be.resolve(s?s.document.mutableCopy():sr.newInvalidDocument(n))}getEntries(e,n){let s=cs();return n.forEach((o=>{const c=this.docs.get(o);s=s.insert(o,c?c.document.mutableCopy():sr.newInvalidDocument(o))})),be.resolve(s)}getDocumentsMatchingQuery(e,n,s,o){let c=cs();const d=n.path,g=new Ze(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(g);for(;p.hasNext();){const{key:y,value:{document:b}}=p.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||RR(CR(b),s)<=0||(o.has(b.key)||Ch(n,b))&&(c=c.insert(b.key,b.mutableCopy()))}return be.resolve(c)}getAllFromCollectionGroup(e,n,s,o){it(9500)}ii(e,n){return be.forEach(this.docs,(s=>n(s)))}newChangeBuffer(e){return new t2(this)}getSize(e){return be.resolve(this.size)}}class t2 extends YI{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((s,o)=>{o.isValidDocument()?n.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(s)})),be.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class n2{constructor(e){this.persistence=e,this.si=new Ja((n=>rp(n)),ip),this.lastRemoteSnapshotVersion=ot.min(),this.highestTargetId=0,this.oi=0,this._i=new up,this.targetCount=0,this.ai=ol.ur()}forEachTarget(e,n){return this.si.forEach(((s,o)=>n(o))),be.resolve()}getLastRemoteSnapshotVersion(e){return be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return be.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),be.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),be.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new ol(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,be.resolve()}updateTargetData(e,n){return this.Pr(n),be.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,be.resolve()}removeTargets(e,n,s){let o=0;const c=[];return this.si.forEach(((d,g)=>{g.sequenceNumber<=n&&s.get(g.targetId)===null&&(this.si.delete(d),c.push(this.removeMatchingKeysForTargetId(e,g.targetId)),o++)})),be.waitFor(c).next((()=>o))}getTargetCount(e){return be.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return be.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),be.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const o=this.persistence.referenceDelegate,c=[];return o&&n.forEach((d=>{c.push(o.markPotentiallyOrphaned(e,d))})),be.waitFor(c)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),be.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return be.resolve(s)}containsKey(e,n){return be.resolve(this._i.containsKey(n))}}class FS{constructor(e,n){this.ui={},this.overlays={},this.ci=new Th(0),this.li=!1,this.li=!0,this.hi=new JI,this.referenceDelegate=e(this),this.Pi=new n2(this),this.indexManager=new UI,this.remoteDocumentCache=(function(o){return new e2(o)})((s=>this.referenceDelegate.Ti(s))),this.serializer=new PI(n),this.Ii=new WI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new XI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new ZI(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){He("MemoryPersistence","Starting transaction:",e);const o=new r2(this.ci.next());return this.referenceDelegate.Ei(),s(o).next((c=>this.referenceDelegate.di(o).next((()=>c)))).toPromise().then((c=>(o.raiseOnCommittedEvent(),c)))}Ai(e,n){return be.or(Object.values(this.ui).map((s=>()=>s.containsKey(e,n))))}}class r2 extends DR{constructor(e){super(),this.currentSequenceNumber=e}}class dp{constructor(e){this.persistence=e,this.Ri=new up,this.Vi=null}static mi(e){return new dp(e)}get fi(){if(this.Vi)return this.Vi;throw it(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),be.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),be.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),be.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((o=>this.fi.add(o.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next((o=>{o.forEach((c=>this.fi.add(c.toString())))})).next((()=>s.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return be.forEach(this.fi,(s=>{const o=Ze.fromPath(s);return this.gi(e,o).next((c=>{c||n.removeEntry(o,ot.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return be.or([()=>be.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class sh{constructor(e,n){this.persistence=e,this.pi=new Ja((s=>MR(s.path)),((s,o)=>s.isEqual(o))),this.garbageCollector=$I(this,n)}static mi(e,n){return new sh(e,n)}Ei(){}di(e){return be.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>n.next((o=>s+o))))}wr(e){let n=0;return this.pr(e,(s=>{n++})).next((()=>n))}pr(e,n){return be.forEach(this.pi,((s,o)=>this.br(e,s,o).next((c=>c?be.resolve():n(o)))))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ii(e,(d=>this.br(e,d,n).next((g=>{g||(s++,c.removeEntry(d,ot.min()))})))).next((()=>c.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),be.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),be.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),be.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),be.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=zd(e.data.value)),n}br(e,n,s){return be.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const o=this.pi.get(n);return be.resolve(o!==void 0&&o>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class hp{constructor(e,n,s,o){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=o}static As(e,n){let s=Ct(),o=Ct();for(const c of n.docChanges)switch(c.type){case 0:s=s.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new hp(e,n.fromCache,s,o)}}class i2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class s2{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return XA()?8:OR(ar())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,o){const c={result:null};return this.ys(e,n).next((d=>{c.result=d})).next((()=>{if(!c.result)return this.ws(e,n,o,s).next((d=>{c.result=d}))})).next((()=>{if(c.result)return;const d=new i2;return this.Ss(e,n,d).next((g=>{if(c.result=g,this.Vs)return this.bs(e,n,d,g.size)}))})).next((()=>c.result))}bs(e,n,s,o){return s.documentReadCount<this.fs?(Go()<=wt.DEBUG&&He("QueryEngine","SDK will not create cache indexes for query:",$o(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),be.resolve()):(Go()<=wt.DEBUG&&He("QueryEngine","Query:",$o(n),"scans",s.documentReadCount,"local documents and returns",o,"documents as results."),s.documentReadCount>this.gs*o?(Go()<=wt.DEBUG&&He("QueryEngine","The SDK decides to create cache indexes for query:",$o(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ai(n))):be.resolve())}ys(e,n){if(nb(n))return be.resolve(null);let s=Ai(n);return this.indexManager.getIndexType(e,s).next((o=>o===0?null:(n.limit!==null&&o===1&&(n=xg(n,null,"F"),s=Ai(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next((c=>{const d=Ct(...c);return this.ps.getDocuments(e,d).next((g=>this.indexManager.getMinOffset(e,s).next((p=>{const y=this.Ds(n,g);return this.Cs(n,y,d,p.readTime)?this.ys(e,xg(n,null,"F")):this.vs(e,y,n,p)}))))})))))}ws(e,n,s,o){return nb(n)||o.isEqual(ot.min())?be.resolve(null):this.ps.getDocuments(e,s).next((c=>{const d=this.Ds(n,c);return this.Cs(n,d,s,o)?be.resolve(null):(Go()<=wt.DEBUG&&He("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),$o(n)),this.vs(e,d,n,AR(o,kc)).next((g=>g)))}))}Ds(e,n){let s=new Pn(vS(e));return n.forEach(((o,c)=>{Ch(e,c)&&(s=s.add(c))})),s}Cs(e,n,s,o){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const c=e.limitType==="F"?n.last():n.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,n,s){return Go()<=wt.DEBUG&&He("QueryEngine","Using full collection scan to execute query:",$o(n)),this.ps.getDocumentsMatchingQuery(e,n,oa.min(),s)}vs(e,n,s,o){return this.ps.getDocumentsMatchingQuery(e,s,o).next((c=>(n.forEach((d=>{c=c.insert(d.key,d)})),c)))}}const fp="LocalStore",a2=3e8;class o2{constructor(e,n,s,o){this.persistence=e,this.Fs=n,this.serializer=o,this.Ms=new fn(At),this.xs=new Ja((c=>rp(c)),ip),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KI(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function l2(i,e,n,s){return new o2(i,e,n,s)}async function HS(i,e){const n=ut(i);return await n.persistence.runTransaction("Handle user change","readonly",(s=>{let o;return n.mutationQueue.getAllMutationBatches(s).next((c=>(o=c,n.Bs(e),n.mutationQueue.getAllMutationBatches(s)))).next((c=>{const d=[],g=[];let p=Ct();for(const y of o){d.push(y.batchId);for(const b of y.mutations)p=p.add(b.key)}for(const y of c){g.push(y.batchId);for(const b of y.mutations)p=p.add(b.key)}return n.localDocuments.getDocuments(s,p).next((y=>({Ls:y,removedBatchIds:d,addedBatchIds:g})))}))}))}function c2(i,e){const n=ut(i);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const o=e.batch.keys(),c=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(g,p,y,b){const S=y.batch,x=S.keys();let D=be.resolve();return x.forEach((k=>{D=D.next((()=>b.getEntry(p,k))).next((O=>{const M=y.docVersions.get(k);zt(M!==null,48541),O.version.compareTo(M)<0&&(S.applyToRemoteDocument(O,y),O.isValidDocument()&&(O.setReadTime(y.commitVersion),b.addEntry(O)))}))})),D.next((()=>g.mutationQueue.removeMutationBatch(p,S)))})(n,s,e,c).next((()=>c.apply(s))).next((()=>n.mutationQueue.performConsistencyCheck(s))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(s,o,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(g){let p=Ct();for(let y=0;y<g.mutationResults.length;++y)g.mutationResults[y].transformResults.length>0&&(p=p.add(g.batch.mutations[y].key));return p})(e)))).next((()=>n.localDocuments.getDocuments(s,o)))}))}function qS(i){const e=ut(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function u2(i,e){const n=ut(i),s=e.snapshotVersion;let o=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const d=n.Ns.newChangeBuffer({trackRemovals:!0});o=n.Ms;const g=[];e.targetChanges.forEach(((b,S)=>{const x=o.get(S);if(!x)return;g.push(n.Pi.removeMatchingKeys(c,b.removedDocuments,S).next((()=>n.Pi.addMatchingKeys(c,b.addedDocuments,S))));let D=x.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(S)!==null?D=D.withResumeToken(tr.EMPTY_BYTE_STRING,ot.min()).withLastLimboFreeSnapshotVersion(ot.min()):b.resumeToken.approximateByteSize()>0&&(D=D.withResumeToken(b.resumeToken,s)),o=o.insert(S,D),(function(O,M,G){return O.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=a2?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0})(x,D,b)&&g.push(n.Pi.updateTargetData(c,D))}));let p=cs(),y=Ct();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&g.push(n.persistence.referenceDelegate.updateLimboDocument(c,b))})),g.push(d2(c,d,e.documentUpdates).next((b=>{p=b.ks,y=b.qs}))),!s.isEqual(ot.min())){const b=n.Pi.getLastRemoteSnapshotVersion(c).next((S=>n.Pi.setTargetsMetadata(c,c.currentSequenceNumber,s)));g.push(b)}return be.waitFor(g).next((()=>d.apply(c))).next((()=>n.localDocuments.getLocalViewOfDocuments(c,p,y))).next((()=>p))})).then((c=>(n.Ms=o,c)))}function d2(i,e,n){let s=Ct(),o=Ct();return n.forEach((c=>s=s.add(c))),e.getEntries(i,s).next((c=>{let d=cs();return n.forEach(((g,p)=>{const y=c.get(g);p.isFoundDocument()!==y.isFoundDocument()&&(o=o.add(g)),p.isNoDocument()&&p.version.isEqual(ot.min())?(e.removeEntry(g,p.readTime),d=d.insert(g,p)):!y.isValidDocument()||p.version.compareTo(y.version)>0||p.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(p),d=d.insert(g,p)):He(fp,"Ignoring outdated watch update for ",g,". Current version:",y.version," Watch version:",p.version)})),{ks:d,qs:o}}))}function h2(i,e){const n=ut(i);return n.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=ep),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function f2(i,e){const n=ut(i);return n.persistence.runTransaction("Allocate target","readwrite",(s=>{let o;return n.Pi.getTargetData(s,e).next((c=>c?(o=c,be.resolve(o)):n.Pi.allocateTargetId(s).next((d=>(o=new Zs(e,d,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,o).next((()=>o)))))))})).then((s=>{const o=n.Ms.get(s.targetId);return(o===null||s.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s}))}async function Ig(i,e,n){const s=ut(i),o=s.Ms.get(e),c=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",c,(d=>s.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!vl(d))throw d;He(fp,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Ms=s.Ms.remove(e),s.xs.delete(o.target)}function gb(i,e,n){const s=ut(i);let o=ot.min(),c=Ct();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(p,y,b){const S=ut(p),x=S.xs.get(b);return x!==void 0?be.resolve(S.Ms.get(x)):S.Pi.getTargetData(y,b)})(s,d,Ai(e)).next((g=>{if(g)return o=g.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(d,g.targetId).next((p=>{c=p}))})).next((()=>s.Fs.getDocumentsMatchingQuery(d,e,n?o:ot.min(),n?c:Ct()))).next((g=>(m2(s,JR(e),g),{documents:g,Qs:c})))))}function m2(i,e,n){let s=i.Os.get(e)||ot.min();n.forEach(((o,c)=>{c.readTime.compareTo(s)>0&&(s=c.readTime)})),i.Os.set(e,s)}class pb{constructor(){this.activeTargetIds=iI()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class g2{constructor(){this.Mo=new pb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new pb,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class p2{Oo(e){}shutdown(){}}const yb="ConnectivityMonitor";class _b{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){He(yb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){He(yb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Dd=null;function Dg(){return Dd===null?Dd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Dd++,"0x"+Dd.toString(16)}const ng="RestConnection",y2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class _2{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${o}`,this.Wo=this.databaseId.database===Jd?`project_id=${s}`:`project_id=${s}&database_id=${o}`}Go(e,n,s,o,c){const d=Dg(),g=this.zo(e,n.toUriEncodedString());He(ng,`Sending RPC '${e}' ${d}:`,g,s);const p={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(p,o,c);const{host:y}=new URL(g),b=gl(y);return this.Jo(e,g,p,s,b).then((S=>(He(ng,`Received RPC '${e}' ${d}: `,S),S)),(S=>{throw nl(ng,`RPC '${e}' ${d} failed with error: `,S,"url: ",g,"request:",s),S}))}Ho(e,n,s,o,c,d){return this.Go(e,n,s,o,c)}jo(e,n,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+yl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((o,c)=>e[c]=o)),s&&s.headers.forEach(((o,c)=>e[c]=o))}zo(e,n){const s=y2[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}class v2{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const rr="WebChannelConnection";class b2 extends _2{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,o,c){const d=Dg();return new Promise(((g,p)=>{const y=new $E;y.setWithCredentials(!0),y.listenOnce(YE.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Pd.NO_ERROR:const S=y.getResponseJson();He(rr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(S)),g(S);break;case Pd.TIMEOUT:He(rr,`RPC '${e}' ${d} timed out`),p(new ze(_e.DEADLINE_EXCEEDED,"Request time out"));break;case Pd.HTTP_ERROR:const x=y.getStatus();if(He(rr,`RPC '${e}' ${d} failed with status:`,x,"response text:",y.getResponseText()),x>0){let D=y.getResponseJson();Array.isArray(D)&&(D=D[0]);const k=D?.error;if(k&&k.status&&k.message){const O=(function(G){const q=G.toLowerCase().replace(/_/g,"-");return Object.values(_e).indexOf(q)>=0?q:_e.UNKNOWN})(k.status);p(new ze(O,k.message))}else p(new ze(_e.UNKNOWN,"Server responded with status "+y.getStatus()))}else p(new ze(_e.UNAVAILABLE,"Connection failed."));break;default:it(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{He(rr,`RPC '${e}' ${d} completed.`)}}));const b=JSON.stringify(o);He(rr,`RPC '${e}' ${d} sending request:`,o),y.send(n,"POST",b,s,15)}))}T_(e,n,s){const o=Dg(),c=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=WE(),g=KE(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(p.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(p.useFetchStreams=!0),this.jo(p.initMessageHeaders,n,s),p.encodeInitMessageHeaders=!0;const b=c.join("");He(rr,`Creating RPC '${e}' stream ${o}: ${b}`,p);const S=d.createWebChannel(b,p);this.I_(S);let x=!1,D=!1;const k=new v2({Yo:M=>{D?He(rr,`Not sending because RPC '${e}' stream ${o} is closed:`,M):(x||(He(rr,`Opening RPC '${e}' stream ${o} transport.`),S.open(),x=!0),He(rr,`RPC '${e}' stream ${o} sending:`,M),S.send(M))},Zo:()=>S.close()}),O=(M,G,q)=>{M.listen(G,(ee=>{try{q(ee)}catch(Ce){setTimeout((()=>{throw Ce}),0)}}))};return O(S,Sc.EventType.OPEN,(()=>{D||(He(rr,`RPC '${e}' stream ${o} transport opened.`),k.o_())})),O(S,Sc.EventType.CLOSE,(()=>{D||(D=!0,He(rr,`RPC '${e}' stream ${o} transport closed`),k.a_(),this.E_(S))})),O(S,Sc.EventType.ERROR,(M=>{D||(D=!0,nl(rr,`RPC '${e}' stream ${o} transport errored. Name:`,M.name,"Message:",M.message),k.a_(new ze(_e.UNAVAILABLE,"The operation could not be completed")))})),O(S,Sc.EventType.MESSAGE,(M=>{if(!D){const G=M.data[0];zt(!!G,16349);const q=G,ee=q?.error||q[0]?.error;if(ee){He(rr,`RPC '${e}' stream ${o} received error:`,ee);const Ce=ee.status;let Me=(function(C){const I=jn[C];if(I!==void 0)return OS(I)})(Ce),Se=ee.message;Me===void 0&&(Me=_e.INTERNAL,Se="Unknown error status: "+Ce+" with message "+ee.message),D=!0,k.a_(new ze(Me,Se)),S.close()}else He(rr,`RPC '${e}' stream ${o} received:`,G),k.u_(G)}})),O(g,QE.STAT_EVENT,(M=>{M.stat===yg.PROXY?He(rr,`RPC '${e}' stream ${o} detected buffering proxy`):M.stat===yg.NOPROXY&&He(rr,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{k.__()}),0),k}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function rg(){return typeof document<"u"?document:null}function Oh(i){return new xI(i,!0)}class GS{constructor(e,n,s=1e3,o=1.5,c=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=o,this.R_=c,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),o=Math.max(0,n-s);o>0&&He("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const vb="PersistentStream";class $S{constructor(e,n,s,o,c,d,g,p){this.Mi=e,this.S_=s,this.b_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=g,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new GS(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===_e.RESOURCE_EXHAUSTED?(os(n.toString()),os("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===_e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,o])=>{this.D_===n&&this.G_(s,o)}),(s=>{e((()=>{const o=new ze(_e.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(o)}))}))}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{s((()=>this.listener.Xo()))})),this.stream.t_((()=>{s((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{s((()=>this.z_(o)))})),this.stream.onMessage((o=>{s((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return He(vb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(He(vb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class E2 extends $S{constructor(e,n,s,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,o,d),this.serializer=c}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=CI(this.serializer,e),s=(function(c){if(!("targetChange"in c))return ot.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?ot.min():d.readTime?Ri(d.readTime):ot.min()})(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=Rg(this.serializer),n.addTarget=(function(c,d){let g;const p=d.target;if(g=Sg(p)?{documents:DI(c,p)}:{query:OI(c,p).ft},g.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){g.resumeToken=kS(c,d.resumeToken);const y=wg(c,d.expectedCount);y!==null&&(g.expectedCount=y)}else if(d.snapshotVersion.compareTo(ot.min())>0){g.readTime=ih(c,d.snapshotVersion.toTimestamp());const y=wg(c,d.expectedCount);y!==null&&(g.expectedCount=y)}return g})(this.serializer,e);const s=MI(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=Rg(this.serializer),n.removeTarget=e,this.q_(n)}}class S2 extends $S{constructor(e,n,s,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,o,d),this.serializer=c}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return zt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,zt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){zt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=II(e.writeResults,e.commitTime),s=Ri(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=Rg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((s=>RI(this.serializer,s)))};this.q_(n)}}class T2{}class x2 extends T2{constructor(e,n,s,o){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new ze(_e.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Go(e,Ag(n,s),o,c,d))).catch((c=>{throw c.name==="FirebaseError"?(c.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new ze(_e.UNKNOWN,c.toString())}))}Ho(e,n,s,o,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,g])=>this.connection.Ho(e,Ag(n,s),o,d,g,c))).catch((d=>{throw d.name==="FirebaseError"?(d.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new ze(_e.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class w2{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(os(n),this.aa=!1):He("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Qa="RemoteStore";class A2{constructor(e,n,s,o,c){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=c,this.Aa.Oo((d=>{s.enqueueAndForget((async()=>{Za(this)&&(He(Qa,"Restarting streams for network reachability change."),await(async function(p){const y=ut(p);y.Ea.add(4),await Xc(y),y.Ra.set("Unknown"),y.Ea.delete(4),await jh(y)})(this))}))})),this.Ra=new w2(s,o)}}async function jh(i){if(Za(i))for(const e of i.da)await e(!0)}async function Xc(i){for(const e of i.da)await e(!1)}function YS(i,e){const n=ut(i);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),yp(n)?pp(n):bl(n).O_()&&gp(n,e))}function mp(i,e){const n=ut(i),s=bl(n);n.Ia.delete(e),s.O_()&&QS(n,e),n.Ia.size===0&&(s.O_()?s.L_():Za(n)&&n.Ra.set("Unknown"))}function gp(i,e){if(i.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ot.min())>0){const n=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}bl(i).Y_(e)}function QS(i,e){i.Va.Ue(e),bl(i).Z_(e)}function pp(i){i.Va=new bI({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),bl(i).start(),i.Ra.ua()}function yp(i){return Za(i)&&!bl(i).x_()&&i.Ia.size>0}function Za(i){return ut(i).Ea.size===0}function KS(i){i.Va=void 0}async function C2(i){i.Ra.set("Online")}async function R2(i){i.Ia.forEach(((e,n)=>{gp(i,e)}))}async function I2(i,e){KS(i),yp(i)?(i.Ra.ha(e),pp(i)):i.Ra.set("Unknown")}async function D2(i,e,n){if(i.Ra.set("Online"),e instanceof MS&&e.state===2&&e.cause)try{await(async function(o,c){const d=c.cause;for(const g of c.targetIds)o.Ia.has(g)&&(await o.remoteSyncer.rejectListen(g,d),o.Ia.delete(g),o.Va.removeTarget(g))})(i,e)}catch(s){He(Qa,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await ah(i,s)}else if(e instanceof Fd?i.Va.Ze(e):e instanceof jS?i.Va.st(e):i.Va.tt(e),!n.isEqual(ot.min()))try{const s=await qS(i.localStore);n.compareTo(s)>=0&&await(function(c,d){const g=c.Va.Tt(d);return g.targetChanges.forEach(((p,y)=>{if(p.resumeToken.approximateByteSize()>0){const b=c.Ia.get(y);b&&c.Ia.set(y,b.withResumeToken(p.resumeToken,d))}})),g.targetMismatches.forEach(((p,y)=>{const b=c.Ia.get(p);if(!b)return;c.Ia.set(p,b.withResumeToken(tr.EMPTY_BYTE_STRING,b.snapshotVersion)),QS(c,p);const S=new Zs(b.target,p,y,b.sequenceNumber);gp(c,S)})),c.remoteSyncer.applyRemoteEvent(g)})(i,n)}catch(s){He(Qa,"Failed to raise snapshot:",s),await ah(i,s)}}async function ah(i,e,n){if(!vl(e))throw e;i.Ea.add(1),await Xc(i),i.Ra.set("Offline"),n||(n=()=>qS(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{He(Qa,"Retrying IndexedDB access"),await n(),i.Ea.delete(1),await jh(i)}))}function WS(i,e){return e().catch((n=>ah(i,n,e)))}async function Mh(i){const e=ut(i),n=da(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ep;for(;O2(e);)try{const o=await h2(e.localStore,s);if(o===null){e.Ta.length===0&&n.L_();break}s=o.batchId,j2(e,o)}catch(o){await ah(e,o)}XS(e)&&JS(e)}function O2(i){return Za(i)&&i.Ta.length<10}function j2(i,e){i.Ta.push(e);const n=da(i);n.O_()&&n.X_&&n.ea(e.mutations)}function XS(i){return Za(i)&&!da(i).x_()&&i.Ta.length>0}function JS(i){da(i).start()}async function M2(i){da(i).ra()}async function k2(i){const e=da(i);for(const n of i.Ta)e.ea(n.mutations)}async function N2(i,e,n){const s=i.Ta.shift(),o=op.from(s,e,n);await WS(i,(()=>i.remoteSyncer.applySuccessfulWrite(o))),await Mh(i)}async function V2(i,e){e&&da(i).X_&&await(async function(s,o){if((function(d){return yI(d)&&d!==_e.ABORTED})(o.code)){const c=s.Ta.shift();da(s).B_(),await WS(s,(()=>s.remoteSyncer.rejectFailedWrite(c.batchId,o))),await Mh(s)}})(i,e),XS(i)&&JS(i)}async function bb(i,e){const n=ut(i);n.asyncQueue.verifyOperationInProgress(),He(Qa,"RemoteStore received new credentials");const s=Za(n);n.Ea.add(3),await Xc(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await jh(n)}async function L2(i,e){const n=ut(i);e?(n.Ea.delete(2),await jh(n)):e||(n.Ea.add(2),await Xc(n),n.Ra.set("Unknown"))}function bl(i){return i.ma||(i.ma=(function(n,s,o){const c=ut(n);return c.sa(),new E2(s,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(i.datastore,i.asyncQueue,{Xo:C2.bind(null,i),t_:R2.bind(null,i),r_:I2.bind(null,i),H_:D2.bind(null,i)}),i.da.push((async e=>{e?(i.ma.B_(),yp(i)?pp(i):i.Ra.set("Unknown")):(await i.ma.stop(),KS(i))}))),i.ma}function da(i){return i.fa||(i.fa=(function(n,s,o){const c=ut(n);return c.sa(),new S2(s,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(i.datastore,i.asyncQueue,{Xo:()=>Promise.resolve(),t_:M2.bind(null,i),r_:V2.bind(null,i),ta:k2.bind(null,i),na:N2.bind(null,i)}),i.da.push((async e=>{e?(i.fa.B_(),await Mh(i)):(await i.fa.stop(),i.Ta.length>0&&(He(Qa,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}class _p{constructor(e,n,s,o,c){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=o,this.removalCallback=c,this.deferred=new is,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,o,c){const d=Date.now()+s,g=new _p(e,n,d,o,c);return g.start(s),g}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ze(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vp(i,e){if(os("AsyncQueue",`${e}: ${i}`),vl(i))return new ze(_e.UNAVAILABLE,`${e}: ${i}`);throw i}class Wo{static emptySet(e){return new Wo(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||Ze.comparator(n.key,s.key):(n,s)=>Ze.comparator(n.key,s.key),this.keyedMap=Tc(),this.sortedSet=new fn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,s)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Wo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const o=n.getNext().key,c=s.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Wo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}class Eb{constructor(){this.ga=new fn(Ze.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):it(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,s)=>{e.push(s)})),e}}class ll{constructor(e,n,s,o,c,d,g,p,y){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=g,this.excludesMetadataChanges=p,this.hasCachedResults=y}static fromInitialDocuments(e,n,s,o,c){const d=[];return n.forEach((g=>{d.push({type:0,doc:g})})),new ll(e,n,Wo.emptySet(n),d,s,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ah(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let o=0;o<n.length;o++)if(n[o].type!==s[o].type||!n[o].doc.isEqual(s[o].doc))return!1;return!0}}class P2{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class z2{constructor(){this.queries=Sb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,s){const o=ut(n),c=o.queries;o.queries=Sb(),c.forEach(((d,g)=>{for(const p of g.Sa)p.onError(s)}))})(this,new ze(_e.ABORTED,"Firestore shutting down"))}}function Sb(){return new Ja((i=>_S(i)),Ah)}async function ZS(i,e){const n=ut(i);let s=3;const o=e.query;let c=n.queries.get(o);c?!c.ba()&&e.Da()&&(s=2):(c=new P2,s=e.Da()?0:1);try{switch(s){case 0:c.wa=await n.onListen(o,!0);break;case 1:c.wa=await n.onListen(o,!1);break;case 2:await n.onFirstRemoteStoreListen(o)}}catch(d){const g=vp(d,`Initialization of query '${$o(e.query)}' failed`);return void e.onError(g)}n.queries.set(o,c),c.Sa.push(e),e.va(n.onlineState),c.wa&&e.Fa(c.wa)&&bp(n)}async function eT(i,e){const n=ut(i),s=e.query;let o=3;const c=n.queries.get(s);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.Da()?0:1:!c.ba()&&e.Da()&&(o=2))}switch(o){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function U2(i,e){const n=ut(i);let s=!1;for(const o of e){const c=o.query,d=n.queries.get(c);if(d){for(const g of d.Sa)g.Fa(o)&&(s=!0);d.wa=o}}s&&bp(n)}function B2(i,e,n){const s=ut(i),o=s.queries.get(e);if(o)for(const c of o.Sa)c.onError(n);s.queries.delete(e)}function bp(i){i.Ca.forEach((e=>{e.next()}))}var Og,Tb;(Tb=Og||(Og={})).Ma="default",Tb.Cache="cache";class tT{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const o of e.docChanges)o.type!==3&&s.push(o);e=new ll(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=ll.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Og.Cache}}class nT{constructor(e){this.key=e}}class rT{constructor(e){this.key=e}}class F2{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ct(),this.mutatedKeys=Ct(),this.eu=vS(e),this.tu=new Wo(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new Eb,o=n?n.tu:this.tu;let c=n?n.mutatedKeys:this.mutatedKeys,d=o,g=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,y=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((b,S)=>{const x=o.get(b),D=Ch(this.query,S)?S:null,k=!!x&&this.mutatedKeys.has(x.key),O=!!D&&(D.hasLocalMutations||this.mutatedKeys.has(D.key)&&D.hasCommittedMutations);let M=!1;x&&D?x.data.isEqual(D.data)?k!==O&&(s.track({type:3,doc:D}),M=!0):this.su(x,D)||(s.track({type:2,doc:D}),M=!0,(p&&this.eu(D,p)>0||y&&this.eu(D,y)<0)&&(g=!0)):!x&&D?(s.track({type:0,doc:D}),M=!0):x&&!D&&(s.track({type:1,doc:x}),M=!0,(p||y)&&(g=!0)),M&&(D?(d=d.add(D),c=O?c.add(b):c.delete(b)):(d=d.delete(b),c=c.delete(b)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const b=this.query.limitType==="F"?d.last():d.first();d=d.delete(b.key),c=c.delete(b.key),s.track({type:1,doc:b})}return{tu:d,iu:s,Cs:g,mutatedKeys:c}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,o){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((b,S)=>(function(D,k){const O=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return it(20277,{Rt:M})}};return O(D)-O(k)})(b.type,S.type)||this.eu(b.doc,S.doc))),this.ou(s),o=o??!1;const g=n&&!o?this._u():[],p=this.Xa.size===0&&this.current&&!o?1:0,y=p!==this.Za;return this.Za=p,d.length!==0||y?{snapshot:new ll(this.query,e.tu,c,d,e.mutatedKeys,p===0,y,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:g}:{au:g}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Eb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ct(),this.tu.forEach((s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))}));const n=[];return e.forEach((s=>{this.Xa.has(s)||n.push(new rT(s))})),this.Xa.forEach((s=>{e.has(s)||n.push(new nT(s))})),n}cu(e){this.Ya=e.Qs,this.Xa=Ct();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return ll.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Ep="SyncEngine";class H2{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class q2{constructor(e){this.key=e,this.hu=!1}}class G2{constructor(e,n,s,o,c,d){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Ja((g=>_S(g)),Ah),this.Iu=new Map,this.Eu=new Set,this.du=new fn(Ze.comparator),this.Au=new Map,this.Ru=new up,this.Vu={},this.mu=new Map,this.fu=ol.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function $2(i,e,n=!0){const s=cT(i);let o;const c=s.Tu.get(e);return c?(s.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.lu()):o=await iT(s,e,n,!0),o}async function Y2(i,e){const n=cT(i);await iT(n,e,!0,!1)}async function iT(i,e,n,s){const o=await f2(i.localStore,Ai(e)),c=o.targetId,d=i.sharedClientState.addLocalQueryTarget(c,n);let g;return s&&(g=await Q2(i,e,c,d==="current",o.resumeToken)),i.isPrimaryClient&&n&&YS(i.remoteStore,o),g}async function Q2(i,e,n,s,o){i.pu=(S,x,D)=>(async function(O,M,G,q){let ee=M.view.ru(G);ee.Cs&&(ee=await gb(O.localStore,M.query,!1).then((({documents:R})=>M.view.ru(R,ee))));const Ce=q&&q.targetChanges.get(M.targetId),Me=q&&q.targetMismatches.get(M.targetId)!=null,Se=M.view.applyChanges(ee,O.isPrimaryClient,Ce,Me);return wb(O,M.targetId,Se.au),Se.snapshot})(i,S,x,D);const c=await gb(i.localStore,e,!0),d=new F2(e,c.Qs),g=d.ru(c.documents),p=Wc.createSynthesizedTargetChangeForCurrentChange(n,s&&i.onlineState!=="Offline",o),y=d.applyChanges(g,i.isPrimaryClient,p);wb(i,n,y.au);const b=new H2(e,n,d);return i.Tu.set(e,b),i.Iu.has(n)?i.Iu.get(n).push(e):i.Iu.set(n,[e]),y.snapshot}async function K2(i,e,n){const s=ut(i),o=s.Tu.get(e),c=s.Iu.get(o.targetId);if(c.length>1)return s.Iu.set(o.targetId,c.filter((d=>!Ah(d,e)))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(o.targetId),s.sharedClientState.isActiveQueryTarget(o.targetId)||await Ig(s.localStore,o.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(o.targetId),n&&mp(s.remoteStore,o.targetId),jg(s,o.targetId)})).catch(_l)):(jg(s,o.targetId),await Ig(s.localStore,o.targetId,!0))}async function W2(i,e){const n=ut(i),s=n.Tu.get(e),o=n.Iu.get(s.targetId);n.isPrimaryClient&&o.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),mp(n.remoteStore,s.targetId))}async function X2(i,e,n){const s=iD(i);try{const o=await(function(d,g){const p=ut(d),y=an.now(),b=g.reduce(((D,k)=>D.add(k.key)),Ct());let S,x;return p.persistence.runTransaction("Locally write mutations","readwrite",(D=>{let k=cs(),O=Ct();return p.Ns.getEntries(D,b).next((M=>{k=M,k.forEach(((G,q)=>{q.isValidDocument()||(O=O.add(G))}))})).next((()=>p.localDocuments.getOverlayedDocuments(D,k))).next((M=>{S=M;const G=[];for(const q of g){const ee=hI(q,S.get(q.key).overlayedDocument);ee!=null&&G.push(new ma(q.key,ee,uS(ee.value.mapValue),Ci.exists(!0)))}return p.mutationQueue.addMutationBatch(D,y,G,g)})).next((M=>{x=M;const G=M.applyToLocalDocumentSet(S,O);return p.documentOverlayCache.saveOverlays(D,M.batchId,G)}))})).then((()=>({batchId:x.batchId,changes:ES(S)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(o.batchId),(function(d,g,p){let y=d.Vu[d.currentUser.toKey()];y||(y=new fn(At)),y=y.insert(g,p),d.Vu[d.currentUser.toKey()]=y})(s,o.batchId,n),await Jc(s,o.changes),await Mh(s.remoteStore)}catch(o){const c=vp(o,"Failed to persist write");n.reject(c)}}async function sT(i,e){const n=ut(i);try{const s=await u2(n.localStore,e);e.targetChanges.forEach(((o,c)=>{const d=n.Au.get(c);d&&(zt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?zt(d.hu,14607):o.removedDocuments.size>0&&(zt(d.hu,42227),d.hu=!1))})),await Jc(n,s,e)}catch(s){await _l(s)}}function xb(i,e,n){const s=ut(i);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const o=[];s.Tu.forEach(((c,d)=>{const g=d.view.va(e);g.snapshot&&o.push(g.snapshot)})),(function(d,g){const p=ut(d);p.onlineState=g;let y=!1;p.queries.forEach(((b,S)=>{for(const x of S.Sa)x.va(g)&&(y=!0)})),y&&bp(p)})(s.eventManager,e),o.length&&s.Pu.H_(o),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function J2(i,e,n){const s=ut(i);s.sharedClientState.updateQueryState(e,"rejected",n);const o=s.Au.get(e),c=o&&o.key;if(c){let d=new fn(Ze.comparator);d=d.insert(c,sr.newNoDocument(c,ot.min()));const g=Ct().add(c),p=new Dh(ot.min(),new Map,new fn(At),d,g);await sT(s,p),s.du=s.du.remove(c),s.Au.delete(e),Sp(s)}else await Ig(s.localStore,e,!1).then((()=>jg(s,e,n))).catch(_l)}async function Z2(i,e){const n=ut(i),s=e.batch.batchId;try{const o=await c2(n.localStore,e);oT(n,s,null),aT(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Jc(n,o)}catch(o){await _l(o)}}async function eD(i,e,n){const s=ut(i);try{const o=await(function(d,g){const p=ut(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let b;return p.mutationQueue.lookupMutationBatch(y,g).next((S=>(zt(S!==null,37113),b=S.keys(),p.mutationQueue.removeMutationBatch(y,S)))).next((()=>p.mutationQueue.performConsistencyCheck(y))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(y,b,g))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,b))).next((()=>p.localDocuments.getDocuments(y,b)))}))})(s.localStore,e);oT(s,e,n),aT(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Jc(s,o)}catch(o){await _l(o)}}function aT(i,e){(i.mu.get(e)||[]).forEach((n=>{n.resolve()})),i.mu.delete(e)}function oT(i,e,n){const s=ut(i);let o=s.Vu[s.currentUser.toKey()];if(o){const c=o.get(e);c&&(n?c.reject(n):c.resolve(),o=o.remove(e)),s.Vu[s.currentUser.toKey()]=o}}function jg(i,e,n=null){i.sharedClientState.removeLocalQueryTarget(e);for(const s of i.Iu.get(e))i.Tu.delete(s),n&&i.Pu.yu(s,n);i.Iu.delete(e),i.isPrimaryClient&&i.Ru.jr(e).forEach((s=>{i.Ru.containsKey(s)||lT(i,s)}))}function lT(i,e){i.Eu.delete(e.path.canonicalString());const n=i.du.get(e);n!==null&&(mp(i.remoteStore,n),i.du=i.du.remove(e),i.Au.delete(n),Sp(i))}function wb(i,e,n){for(const s of n)s instanceof nT?(i.Ru.addReference(s.key,e),tD(i,s)):s instanceof rT?(He(Ep,"Document no longer in limbo: "+s.key),i.Ru.removeReference(s.key,e),i.Ru.containsKey(s.key)||lT(i,s.key)):it(19791,{wu:s})}function tD(i,e){const n=e.key,s=n.path.canonicalString();i.du.get(n)||i.Eu.has(s)||(He(Ep,"New document in limbo: "+n),i.Eu.add(s),Sp(i))}function Sp(i){for(;i.Eu.size>0&&i.du.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const n=new Ze(tn.fromString(e)),s=i.fu.next();i.Au.set(s,new q2(n)),i.du=i.du.insert(n,s),YS(i.remoteStore,new Zs(Ai(sp(n.path)),s,"TargetPurposeLimboResolution",Th.ce))}}async function Jc(i,e,n){const s=ut(i),o=[],c=[],d=[];s.Tu.isEmpty()||(s.Tu.forEach(((g,p)=>{d.push(s.pu(p,e,n).then((y=>{if((y||n)&&s.isPrimaryClient){const b=y?!y.fromCache:n?.targetChanges.get(p.targetId)?.current;s.sharedClientState.updateQueryState(p.targetId,b?"current":"not-current")}if(y){o.push(y);const b=hp.As(p.targetId,y);c.push(b)}})))})),await Promise.all(d),s.Pu.H_(o),await(async function(p,y){const b=ut(p);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(S=>be.forEach(y,(x=>be.forEach(x.Es,(D=>b.persistence.referenceDelegate.addReference(S,x.targetId,D))).next((()=>be.forEach(x.ds,(D=>b.persistence.referenceDelegate.removeReference(S,x.targetId,D)))))))))}catch(S){if(!vl(S))throw S;He(fp,"Failed to update sequence numbers: "+S)}for(const S of y){const x=S.targetId;if(!S.fromCache){const D=b.Ms.get(x),k=D.snapshotVersion,O=D.withLastLimboFreeSnapshotVersion(k);b.Ms=b.Ms.insert(x,O)}}})(s.localStore,c))}async function nD(i,e){const n=ut(i);if(!n.currentUser.isEqual(e)){He(Ep,"User change. New user:",e.toKey());const s=await HS(n.localStore,e);n.currentUser=e,(function(c,d){c.mu.forEach((g=>{g.forEach((p=>{p.reject(new ze(_e.CANCELLED,d))}))})),c.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Jc(n,s.Ls)}}function rD(i,e){const n=ut(i),s=n.Au.get(e);if(s&&s.hu)return Ct().add(s.key);{let o=Ct();const c=n.Iu.get(e);if(!c)return o;for(const d of c){const g=n.Tu.get(d);o=o.unionWith(g.view.nu)}return o}}function cT(i){const e=ut(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=sT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=J2.bind(null,e),e.Pu.H_=U2.bind(null,e.eventManager),e.Pu.yu=B2.bind(null,e.eventManager),e}function iD(i){const e=ut(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Z2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eD.bind(null,e),e}class oh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Oh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return l2(this.persistence,new s2,e.initialUser,this.serializer)}Cu(e){return new FS(dp.mi,this.serializer)}Du(e){return new g2}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}oh.provider={build:()=>new oh};class sD extends oh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){zt(this.persistence.referenceDelegate instanceof sh,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new qI(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?vr.withCacheSize(this.cacheSizeBytes):vr.DEFAULT;return new FS((s=>sh.mi(s,n)),this.serializer)}}class Mg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>xb(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=nD.bind(null,this.syncEngine),await L2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new z2})()}createDatastore(e){const n=Oh(e.databaseInfo.databaseId),s=(function(c){return new b2(c)})(e.databaseInfo);return(function(c,d,g,p){return new x2(c,d,g,p)})(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return(function(s,o,c,d,g){return new A2(s,o,c,d,g)})(this.localStore,this.datastore,e.asyncQueue,(n=>xb(this.syncEngine,n,0)),(function(){return _b.v()?new _b:new p2})())}createSyncEngine(e,n){return(function(o,c,d,g,p,y,b){const S=new G2(o,c,d,g,p,y);return b&&(S.gu=!0),S})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const s=ut(n);He(Qa,"RemoteStore shutting down."),s.Ea.add(5),await Xc(s),s.Aa.shutdown(),s.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Mg.provider={build:()=>new Mg};class uT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):os("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const ha="FirestoreClient";class aD{constructor(e,n,s,o,c){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=o,this.user=ir.UNAUTHENTICATED,this.clientId=Zg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(s,(async d=>{He(ha,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(He(ha,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new is;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=vp(n,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function ig(i,e){i.asyncQueue.verifyOperationInProgress(),He(ha,"Initializing OfflineComponentProvider");const n=i.configuration;await e.initialize(n);let s=n.initialUser;i.setCredentialChangeListener((async o=>{s.isEqual(o)||(await HS(e.localStore,o),s=o)})),e.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=e}async function Ab(i,e){i.asyncQueue.verifyOperationInProgress();const n=await oD(i);He(ha,"Initializing OnlineComponentProvider"),await e.initialize(n,i.configuration),i.setCredentialChangeListener((s=>bb(e.remoteStore,s))),i.setAppCheckTokenChangeListener(((s,o)=>bb(e.remoteStore,o))),i._onlineComponents=e}async function oD(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){He(ha,"Using user provided OfflineComponentProvider");try{await ig(i,i._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(o){return o.name==="FirebaseError"?o.code===_e.FAILED_PRECONDITION||o.code===_e.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(n))throw n;nl("Error using user provided cache. Falling back to memory cache: "+n),await ig(i,new oh)}}else He(ha,"Using default OfflineComponentProvider"),await ig(i,new sD(void 0));return i._offlineComponents}async function dT(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(He(ha,"Using user provided OnlineComponentProvider"),await Ab(i,i._uninitializedComponentsProvider._online)):(He(ha,"Using default OnlineComponentProvider"),await Ab(i,new Mg))),i._onlineComponents}function lD(i){return dT(i).then((e=>e.syncEngine))}async function hT(i){const e=await dT(i),n=e.eventManager;return n.onListen=$2.bind(null,e.syncEngine),n.onUnlisten=K2.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Y2.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=W2.bind(null,e.syncEngine),n}function cD(i,e,n={}){const s=new is;return i.asyncQueue.enqueueAndForget((async()=>(function(c,d,g,p,y){const b=new uT({next:x=>{b.Nu(),d.enqueueAndForget((()=>eT(c,S)));const D=x.docs.has(g);!D&&x.fromCache?y.reject(new ze(_e.UNAVAILABLE,"Failed to get document because the client is offline.")):D&&x.fromCache&&p&&p.source==="server"?y.reject(new ze(_e.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(x)},error:x=>y.reject(x)}),S=new tT(sp(g.path),b,{includeMetadataChanges:!0,qa:!0});return ZS(c,S)})(await hT(i),i.asyncQueue,e,n,s))),s.promise}function uD(i,e,n={}){const s=new is;return i.asyncQueue.enqueueAndForget((async()=>(function(c,d,g,p,y){const b=new uT({next:x=>{b.Nu(),d.enqueueAndForget((()=>eT(c,S))),x.fromCache&&p.source==="server"?y.reject(new ze(_e.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(x)},error:x=>y.reject(x)}),S=new tT(g,b,{includeMetadataChanges:!0,qa:!0});return ZS(c,S)})(await hT(i),i.asyncQueue,e,n,s))),s.promise}function fT(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}const Cb=new Map;const mT="firestore.googleapis.com",Rb=!0;class Ib{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ze(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=mT,this.ssl=Rb}else this.host=e.host,this.ssl=e.ssl??Rb;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=BS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<FI)throw new ze(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}wR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fT(e.experimentalLongPollingOptions??{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ze(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ze(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ze(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,o){return s.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kh{constructor(e,n,s,o){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ib({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ze(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ze(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ib(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new gR;switch(s.type){case"firstParty":return new vR(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new ze(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const s=Cb.get(n);s&&(He("ComponentProvider","Removing Datastore"),Cb.delete(n),s.terminate())})(this),Promise.resolve()}}function dD(i,e,n,s={}){i=ls(i,kh);const o=gl(e),c=i._getSettings(),d={...c,emulatorOptions:i._getEmulatorOptions()},g=`${e}:${n}`;o&&(LE(`https://${g}`),PE("Firestore",!0)),c.host!==mT&&c.host!==g&&nl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p={...c,host:g,ssl:o,emulatorOptions:s};if(!aa(p,d)&&(i._setSettings(p),s.mockUserToken)){let y,b;if(typeof s.mockUserToken=="string")y=s.mockUserToken,b=ir.MOCK_USER;else{y=FA(s.mockUserToken,i._app?.options.projectId);const S=s.mockUserToken.sub||s.mockUserToken.user_id;if(!S)throw new ze(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new ir(S)}i._authCredentials=new pR(new JE(y,b))}}class El{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new El(this.firestore,e,this._query)}}class An{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ia(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new An(this.firestore,e,this._key)}toJSON(){return{type:An._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if(Yc(n,An._jsonSchema))return new An(e,s||null,new Ze(tn.fromString(n.referencePath)))}}An._jsonSchemaVersion="firestore/documentReference/1.0",An._jsonSchema={type:kn("string",An._jsonSchemaVersion),referencePath:kn("string")};class ia extends El{constructor(e,n,s){super(e,n,sp(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new An(this.firestore,null,new Ze(e))}withConverter(e){return new ia(this.firestore,e,this._path)}}function Ys(i,e,...n){if(i=qn(i),ZE("collection","path",e),i instanceof kh){const s=tn.fromString(e,...n);return Fv(s),new ia(i,null,s)}{if(!(i instanceof An||i instanceof ia))throw new ze(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=i._path.child(tn.fromString(e,...n));return Fv(s),new ia(i.firestore,null,s)}}function Ke(i,e,...n){if(i=qn(i),arguments.length===1&&(e=Zg.newId()),ZE("doc","path",e),i instanceof kh){const s=tn.fromString(e,...n);return Bv(s),new An(i,null,new Ze(s))}{if(!(i instanceof An||i instanceof ia))throw new ze(_e.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=i._path.child(tn.fromString(e,...n));return Bv(s),new An(i.firestore,i instanceof ia?i.converter:null,new Ze(s))}}const Db="AsyncQueue";class Ob{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new GS(this,"async_queue_retry"),this._c=()=>{const s=rg();s&&He(Db,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=rg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=rg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new is;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!vl(e))throw e;He(Db,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((s=>{throw this.nc=s,this.rc=!1,os("INTERNAL UNHANDLED ERROR: ",jb(s)),s})).then((s=>(this.rc=!1,s))))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const o=_p.createAndSchedule(this,e,n,s,(c=>this.hc(c)));return this.tc.push(o),o}uc(){this.nc&&it(47125,{Pc:jb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,s)=>n.targetTimeMs-s.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function jb(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class Zc extends kh{constructor(e,n,s,o){super(e,n,s,o),this.type="firestore",this._queue=new Ob,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ob(e),this._firestoreClient=void 0,await e}}}function eo(i,e){const n=typeof i=="object"?i:FE(),s=typeof i=="string"?i:Jd,o=Xg(n,"firestore").getImmediate({identifier:s});if(!o._initialized){const c=UA("firestore");c&&dD(o,...c)}return o}function Tp(i){if(i._terminated)throw new ze(_e.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||hD(i),i._firestoreClient}function hD(i){const e=i._freezeSettings(),n=(function(o,c,d,g){return new VR(o,c,d,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,fT(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)})(i._databaseId,i._app?.options.appId||"",i._persistenceKey,e);i._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new aD(i._authCredentials,i._appCheckCredentials,i._queue,n,i._componentsProvider&&(function(o){const c=o?._online.build();return{_offline:o?._offline.build(c),_online:c}})(i._componentsProvider))}class $r{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $r(tr.fromBase64String(e))}catch(n){throw new ze(_e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new $r(tr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:$r._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yc(e,$r._jsonSchema))return $r.fromBase64String(e.bytes)}}$r._jsonSchemaVersion="firestore/bytes/1.0",$r._jsonSchema={type:kn("string",$r._jsonSchemaVersion),bytes:kn("string")};class Nh{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ze(_e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new er(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Vh{constructor(e){this._methodName=e}}class Ii{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ze(_e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ze(_e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return At(this._lat,e._lat)||At(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ii._jsonSchemaVersion}}static fromJSON(e){if(Yc(e,Ii._jsonSchema))return new Ii(e.latitude,e.longitude)}}Ii._jsonSchemaVersion="firestore/geoPoint/1.0",Ii._jsonSchema={type:kn("string",Ii._jsonSchemaVersion),latitude:kn("number"),longitude:kn("number")};class Di{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,o){if(s.length!==o.length)return!1;for(let c=0;c<s.length;++c)if(s[c]!==o[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Di._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yc(e,Di._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Di(e.vectorValues);throw new ze(_e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Di._jsonSchemaVersion="firestore/vectorValue/1.0",Di._jsonSchema={type:kn("string",Di._jsonSchemaVersion),vectorValues:kn("object")};const fD=/^__.*__$/;class mD{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new ma(e,this.data,this.fieldMask,n,this.fieldTransforms):new Kc(e,this.data,n,this.fieldTransforms)}}class gT{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new ma(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function pT(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it(40011,{Ac:i})}}class Lh{constructor(e,n,s,o,c,d){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=o,c===void 0&&this.Rc(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Lh({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){const n=this.path?.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return lh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(pT(this.Ac)&&fD.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class gD{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||Oh(e)}Cc(e,n,s,o=!1){return new Lh({Ac:e,methodName:n,Dc:s,path:er.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xp(i){const e=i._freezeSettings(),n=Oh(i._databaseId);return new gD(i._databaseId,!!e.ignoreUndefinedProperties,n)}function pD(i,e,n,s,o,c={}){const d=i.Cc(c.merge||c.mergeFields?2:0,e,n,o);Ap("Data must be an object, but it was:",d,s);const g=yT(s,d);let p,y;if(c.merge)p=new jr(d.fieldMask),y=d.fieldTransforms;else if(c.mergeFields){const b=[];for(const S of c.mergeFields){const x=kg(e,S,n);if(!d.contains(x))throw new ze(_e.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);vT(b,x)||b.push(x)}p=new jr(b),y=d.fieldTransforms.filter((S=>p.covers(S.field)))}else p=null,y=d.fieldTransforms;return new mD(new br(g),p,y)}class Ph extends Vh{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ph}}function yD(i,e,n){return new Lh({Ac:3,Dc:e.settings.Dc,methodName:i._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class wp extends Vh{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=yD(this,e,!0),s=this.vc.map((c=>Sl(c,n))),o=new al(s);return new lI(e.path,o)}isEqual(e){return e instanceof wp&&aa(this.vc,e.vc)}}function _D(i,e,n,s){const o=i.Cc(1,e,n);Ap("Data must be an object, but it was:",o,s);const c=[],d=br.empty();fa(s,((p,y)=>{const b=Cp(e,p,n);y=qn(y);const S=o.yc(b);if(y instanceof Ph)c.push(b);else{const x=Sl(y,S);x!=null&&(c.push(b),d.set(b,x))}}));const g=new jr(c);return new gT(d,g,o.fieldTransforms)}function vD(i,e,n,s,o,c){const d=i.Cc(1,e,n),g=[kg(e,s,n)],p=[o];if(c.length%2!=0)throw new ze(_e.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<c.length;x+=2)g.push(kg(e,c[x])),p.push(c[x+1]);const y=[],b=br.empty();for(let x=g.length-1;x>=0;--x)if(!vT(y,g[x])){const D=g[x];let k=p[x];k=qn(k);const O=d.yc(D);if(k instanceof Ph)y.push(D);else{const M=Sl(k,O);M!=null&&(y.push(D),b.set(D,M))}}const S=new jr(y);return new gT(b,S,d.fieldTransforms)}function bD(i,e,n,s=!1){return Sl(n,i.Cc(s?4:3,e))}function Sl(i,e){if(_T(i=qn(i)))return Ap("Unsupported field value:",e,i),yT(i,e);if(i instanceof Vh)return(function(s,o){if(!pT(o.Ac))throw o.Sc(`${s._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${s._methodName}() is not currently supported inside arrays`);const c=s._toFieldTransform(o);c&&o.fieldTransforms.push(c)})(i,e),null;if(i===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(s,o){const c=[];let d=0;for(const g of s){let p=Sl(g,o.wc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}})(i,e)}return(function(s,o){if((s=qn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return sI(o.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const c=an.fromDate(s);return{timestampValue:ih(o.serializer,c)}}if(s instanceof an){const c=new an(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:ih(o.serializer,c)}}if(s instanceof Ii)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof $r)return{bytesValue:kS(o.serializer,s._byteString)};if(s instanceof An){const c=o.databaseId,d=s.firestore._databaseId;if(!d.isEqual(c))throw o.Sc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:cp(s.firestore._databaseId||o.databaseId,s._key.path)}}if(s instanceof Di)return(function(d,g){return{mapValue:{fields:{[lS]:{stringValue:cS},[Zd]:{arrayValue:{values:d.toArray().map((y=>{if(typeof y!="number")throw g.Sc("VectorValues must only contain numeric values.");return ap(g.serializer,y)}))}}}}}})(s,o);throw o.Sc(`Unsupported field value: ${Sh(s)}`)})(i,e)}function yT(i,e){const n={};return nS(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fa(i,((s,o)=>{const c=Sl(o,e.mc(s));c!=null&&(n[s]=c)})),{mapValue:{fields:n}}}function _T(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof an||i instanceof Ii||i instanceof $r||i instanceof An||i instanceof Vh||i instanceof Di)}function Ap(i,e,n){if(!_T(n)||!eS(n)){const s=Sh(n);throw s==="an object"?e.Sc(i+" a custom object"):e.Sc(i+" "+s)}}function kg(i,e,n){if((e=qn(e))instanceof Nh)return e._internalPath;if(typeof e=="string")return Cp(i,e);throw lh("Field path arguments must be of type string or ",i,!1,void 0,n)}const ED=new RegExp("[~\\*/\\[\\]]");function Cp(i,e,n){if(e.search(ED)>=0)throw lh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,n);try{return new Nh(...e.split("."))._internalPath}catch{throw lh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,n)}}function lh(i,e,n,s,o){const c=s&&!s.isEmpty(),d=o!==void 0;let g=`Function ${e}() called with invalid data`;n&&(g+=" (via `toFirestore()`)"),g+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${s}`),d&&(p+=` in document ${o}`),p+=")"),new ze(_e.INVALID_ARGUMENT,g+i+p)}function vT(i,e){return i.some((n=>n.isEqual(e)))}class bT{constructor(e,n,s,o,c){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new An(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Rp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class SD extends bT{data(){return super.data()}}function Rp(i,e){return typeof e=="string"?Cp(i,e):e instanceof Nh?e._internalPath:e._delegate._internalPath}function TD(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new ze(_e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ip{}class xD extends Ip{}function Fa(i,e,...n){let s=[];e instanceof Ip&&s.push(e),s=s.concat(n),(function(c){const d=c.filter((p=>p instanceof Dp)).length,g=c.filter((p=>p instanceof zh)).length;if(d>1||d>0&&g>0)throw new ze(_e.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const o of s)i=o._apply(i);return i}class zh extends xD{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new zh(e,n,s)}_apply(e){const n=this._parse(e);return ET(e._query,n),new El(e.firestore,e.converter,Tg(e._query,n))}_parse(e){const n=xp(e.firestore);return(function(c,d,g,p,y,b,S){let x;if(y.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new ze(_e.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){kb(S,b);const k=[];for(const O of S)k.push(Mb(p,c,O));x={arrayValue:{values:k}}}else x=Mb(p,c,S)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||kb(S,b),x=bD(g,d,S,b==="in"||b==="not-in");return Mn.create(y,b,x)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ha(i,e,n){const s=e,o=Rp("where",i);return zh._create(o,s,n)}class Dp extends Ip{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Dp(e,n)}_parse(e){const n=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return n.length===1?n[0]:ui.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(o,c){let d=o;const g=c.getFlattenedFilters();for(const p of g)ET(d,p),d=Tg(d,p)})(e._query,n),new El(e.firestore,e.converter,Tg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Mb(i,e,n){if(typeof(n=qn(n))=="string"){if(n==="")throw new ze(_e.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yS(e)&&n.indexOf("/")!==-1)throw new ze(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(tn.fromString(n));if(!Ze.isDocumentKey(s))throw new ze(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Wv(i,new Ze(s))}if(n instanceof An)return Wv(i,n._key);throw new ze(_e.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sh(n)}.`)}function kb(i,e){if(!Array.isArray(i)||i.length===0)throw new ze(_e.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ET(i,e){const n=(function(o,c){for(const d of o)for(const g of d.getFlattenedFilters())if(c.indexOf(g.op)>=0)return g.op;return null})(i.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new ze(_e.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ze(_e.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class wD{convertValue(e,n="none"){switch(ua(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ca(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw it(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return fa(e,((o,c)=>{s[o]=this.convertValue(c,n)})),s}convertVectorValue(e){const n=e.fields?.[Zd].arrayValue?.values?.map((s=>wn(s.doubleValue)));return new Di(n)}convertGeoPoint(e){return new Ii(wn(e.latitude),wn(e.longitude))}convertArray(e,n){return(e.values||[]).map((s=>this.convertValue(s,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const s=wh(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(Nc(e));default:return null}}convertTimestamp(e){const n=la(e);return new an(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=tn.fromString(e);zt(US(s),9688,{name:e});const o=new Vc(s.get(1),s.get(3)),c=new Ze(s.popFirst(5));return o.isEqual(n)||os(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),c}}function AD(i,e,n){let s;return s=i?n&&(n.merge||n.mergeFields)?i.toFirestore(e,n):i.toFirestore(e):e,s}class wc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ga extends bT{constructor(e,n,s,o,c,d){super(e,n,s,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Hd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Rp("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ze(_e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ga._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ga._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ga._jsonSchema={type:kn("string",Ga._jsonSchemaVersion),bundleSource:kn("string","DocumentSnapshot"),bundleName:kn("string"),bundle:kn("string")};class Hd extends Ga{data(e={}){return super.data(e)}}class Xo{constructor(e,n,s,o){this._firestore=e,this._userDataWriter=n,this._snapshot=o,this.metadata=new wc(o.hasPendingWrites,o.fromCache),this.query=s}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((s=>{e.call(n,new Hd(this._firestore,this._userDataWriter,s.key,s,new wc(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ze(_e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((g=>{const p=new Hd(o._firestore,o._userDataWriter,g.doc.key,g.doc,new wc(o._snapshot.mutatedKeys.has(g.doc.key),o._snapshot.fromCache),o.query.converter);return g.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((g=>c||g.type!==3)).map((g=>{const p=new Hd(o._firestore,o._userDataWriter,g.doc.key,g.doc,new wc(o._snapshot.mutatedKeys.has(g.doc.key),o._snapshot.fromCache),o.query.converter);let y=-1,b=-1;return g.type!==0&&(y=d.indexOf(g.doc.key),d=d.delete(g.doc.key)),g.type!==1&&(d=d.add(g.doc),b=d.indexOf(g.doc.key)),{type:CD(g.type),doc:p,oldIndex:y,newIndex:b}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ze(_e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Zg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],o=[];return this.docs.forEach((c=>{c._document!==null&&(n.push(c._document),s.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function CD(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it(61501,{type:i})}}function ht(i){i=ls(i,An);const e=ls(i.firestore,Zc);return cD(Tp(e),i._key).then((n=>RD(e,i,n)))}Xo._jsonSchemaVersion="firestore/querySnapshot/1.0",Xo._jsonSchema={type:kn("string",Xo._jsonSchemaVersion),bundleSource:kn("string","QuerySnapshot"),bundleName:kn("string"),bundle:kn("string")};class ST extends wD{constructor(e){super(),this.firestore=e}convertBytes(e){return new $r(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new An(this.firestore,null,n)}}function Qs(i){i=ls(i,El);const e=ls(i.firestore,Zc),n=Tp(e),s=new ST(e);return TD(i._query),uD(n,i._query).then((o=>new Xo(e,s,i,o)))}function vt(i,e,n){i=ls(i,An);const s=ls(i.firestore,Zc),o=AD(i.converter,e,n);return TT(s,[pD(xp(s),"setDoc",i._key,o,i.converter!==null,n).toMutation(i._key,Ci.none())])}function Od(i,e,n,...s){i=ls(i,An);const o=ls(i.firestore,Zc),c=xp(o);let d;return d=typeof(e=qn(e))=="string"||e instanceof Nh?vD(c,"updateDoc",i._key,e,n,s):_D(c,"updateDoc",i._key,e),TT(o,[d.toMutation(i._key,Ci.exists(!0))])}function TT(i,e){return(function(s,o){const c=new is;return s.asyncQueue.enqueueAndForget((async()=>X2(await lD(s),o,c))),c.promise})(Tp(i),e)}function RD(i,e,n){const s=n.docs.get(e._key),o=new ST(i);return new Ga(i,o,e._key,s,new wc(n.hasPendingWrites,n.fromCache),e.converter)}function xT(...i){return new wp("arrayUnion",i)}(function(e,n=!0){(function(o){yl=o})(pl),tl(new $a("firestore",((s,{instanceIdentifier:o,options:c})=>{const d=s.getProvider("app").getImmediate(),g=new Zc(new yR(s.getProvider("auth-internal")),new bR(d,s.getProvider("app-check-internal")),(function(y,b){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new ze(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vc(y.options.projectId,b)})(d,o),d);return c={useFetchStreams:n,...c},g._setSettings(c),g}),"PUBLIC").setMultipleInstances(!0)),na(Lv,Pv,e),na(Lv,Pv,"esm2020")})();var ID="firebase",DD="12.7.0";na(ID,DD,"app");const OD={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},ga=BE(OD);function wT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const jD=wT,AT=new Gc("auth","Firebase",wT());const ch=new Kg("@firebase/auth");function MD(i,...e){ch.logLevel<=wt.WARN&&ch.warn(`Auth (${pl}): ${i}`,...e)}function qd(i,...e){ch.logLevel<=wt.ERROR&&ch.error(`Auth (${pl}): ${i}`,...e)}function di(i,...e){throw Op(i,...e)}function Oi(i,...e){return Op(i,...e)}function CT(i,e,n){const s={...jD(),[e]:n};return new Gc("auth","Firebase",s).create(e,{appName:i.name})}function sa(i){return CT(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Op(i,...e){if(typeof i!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=i.name),i._errorFactory.create(n,...s)}return AT.create(i,...e)}function rt(i,e,...n){if(!i)throw Op(e,...n)}function ts(i){const e="INTERNAL ASSERTION FAILED: "+i;throw qd(e),new Error(e)}function us(i,e){i||ts(e)}function Ng(){return typeof self<"u"&&self.location?.href||""}function kD(){return Nb()==="http:"||Nb()==="https:"}function Nb(){return typeof self<"u"&&self.location?.protocol||null}function ND(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(kD()||QA()||"connection"in navigator)?navigator.onLine:!0}function VD(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}class eu{constructor(e,n){this.shortDelay=e,this.longDelay=n,us(n>e,"Short delay should be less than long delay!"),this.isMobile=GA()||KA()}get(){return ND()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function jp(i,e){us(i.emulator,"Emulator should always be set here");const{url:n}=i.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class RT{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ts("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ts("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ts("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const LD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const PD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],zD=new eu(3e4,6e4);function to(i,e){return i.tenantId&&!e.tenantId?{...e,tenantId:i.tenantId}:e}async function pa(i,e,n,s,o={}){return IT(i,o,async()=>{let c={},d={};s&&(e==="GET"?d=s:c={body:JSON.stringify(s)});const g=$c({key:i.config.apiKey,...d}).slice(1),p=await i._getAdditionalHeaders();p["Content-Type"]="application/json",i.languageCode&&(p["X-Firebase-Locale"]=i.languageCode);const y={method:e,headers:p,...c};return YA()||(y.referrerPolicy="no-referrer"),i.emulatorConfig&&gl(i.emulatorConfig.host)&&(y.credentials="include"),RT.fetch()(await DT(i,i.config.apiHost,n,g),y)})}async function IT(i,e,n){i._canInitEmulator=!1;const s={...LD,...e};try{const o=new BD(i),c=await Promise.race([n(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw jd(i,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const g=c.ok?d.errorMessage:d.error.message,[p,y]=g.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw jd(i,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw jd(i,"email-already-in-use",d);if(p==="USER_DISABLED")throw jd(i,"user-disabled",d);const b=s[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw CT(i,b,y);di(i,b)}}catch(o){if(o instanceof ds)throw o;di(i,"network-request-failed",{message:String(o)})}}async function Uh(i,e,n,s,o={}){const c=await pa(i,e,n,s,o);return"mfaPendingCredential"in c&&di(i,"multi-factor-auth-required",{_serverResponse:c}),c}async function DT(i,e,n,s){const o=`${e}${n}?${s}`,c=i,d=c.config.emulator?jp(i.config,o):`${i.config.apiScheme}://${o}`;return PD.includes(n)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function UD(i){switch(i){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class BD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Oi(this.auth,"network-request-failed")),zD.get())})}}function jd(i,e,n){const s={appName:i.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const o=Oi(i,e,s);return o.customData._tokenResponse=n,o}function Vb(i){return i!==void 0&&i.enterprise!==void 0}class FD{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return UD(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function HD(i,e){return pa(i,"GET","/v2/recaptchaConfig",to(i,e))}async function qD(i,e){return pa(i,"POST","/v1/accounts:delete",e)}async function uh(i,e){return pa(i,"POST","/v1/accounts:lookup",e)}function Oc(i){if(i)try{const e=new Date(Number(i));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function GD(i,e=!1){const n=qn(i),s=await n.getIdToken(e),o=Mp(s);rt(o&&o.exp&&o.auth_time&&o.iat,n.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:s,authTime:Oc(sg(o.auth_time)),issuedAtTime:Oc(sg(o.iat)),expirationTime:Oc(sg(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function sg(i){return Number(i)*1e3}function Mp(i){const[e,n,s]=i.split(".");if(e===void 0||n===void 0||s===void 0)return qd("JWT malformed, contained fewer than 3 sections"),null;try{const o=ME(n);return o?JSON.parse(o):(qd("Failed to decode base64 JWT payload"),null)}catch(o){return qd("Caught error parsing JWT payload as JSON",o?.toString()),null}}function Lb(i){const e=Mp(i);return rt(e,"internal-error"),rt(typeof e.exp<"u","internal-error"),rt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function zc(i,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof ds&&$D(s)&&i.auth.currentUser===i&&await i.auth.signOut(),s}}function $D({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}class YD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Vg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oc(this.lastLoginAt),this.creationTime=Oc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function dh(i){const e=i.auth,n=await i.getIdToken(),s=await zc(i,uh(e,{idToken:n}));rt(s?.users.length,e,"internal-error");const o=s.users[0];i._notifyReloadListener(o);const c=o.providerUserInfo?.length?OT(o.providerUserInfo):[],d=KD(i.providerData,c),g=i.isAnonymous,p=!(i.email&&o.passwordHash)&&!d?.length,y=g?p:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new Vg(o.createdAt,o.lastLoginAt),isAnonymous:y};Object.assign(i,b)}async function QD(i){const e=qn(i);await dh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function KD(i,e){return[...i.filter(s=>!e.some(o=>o.providerId===s.providerId)),...e]}function OT(i){return i.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function WD(i,e){const n=await IT(i,{},async()=>{const s=$c({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=i.config,d=await DT(i,o,"/v1/token",`key=${c}`),g=await i._getAdditionalHeaders();g["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:g,body:s};return i.emulatorConfig&&gl(i.emulatorConfig.host)&&(p.credentials="include"),RT.fetch()(d,p)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function XD(i,e){return pa(i,"POST","/v2/accounts:revokeToken",to(i,e))}class Jo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){rt(e.idToken,"internal-error"),rt(typeof e.idToken<"u","internal-error"),rt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Lb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){rt(e.length!==0,"internal-error");const n=Lb(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(rt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:o,expiresIn:c}=await WD(e,n);this.updateTokensAndExpiration(s,o,Number(c))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:o,expirationTime:c}=n,d=new Jo;return s&&(rt(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),o&&(rt(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(rt(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Jo,this.toJSON())}_performRefresh(){return ts("not implemented")}}function $s(i,e){rt(typeof i=="string"||typeof i>"u","internal-error",{appName:e})}class ci{constructor({uid:e,auth:n,stsTokenManager:s,...o}){this.providerId="firebase",this.proactiveRefresh=new YD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Vg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await zc(this,this.stsTokenManager.getToken(this.auth,e));return rt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return GD(this,e)}reload(){return QD(this)}_assign(e){this!==e&&(rt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ci({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){rt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await dh(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(li(this.auth.app))return Promise.reject(sa(this.auth));const e=await this.getIdToken();return await zc(this,qD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,o=n.email??void 0,c=n.phoneNumber??void 0,d=n.photoURL??void 0,g=n.tenantId??void 0,p=n._redirectEventId??void 0,y=n.createdAt??void 0,b=n.lastLoginAt??void 0,{uid:S,emailVerified:x,isAnonymous:D,providerData:k,stsTokenManager:O}=n;rt(S&&O,e,"internal-error");const M=Jo.fromJSON(this.name,O);rt(typeof S=="string",e,"internal-error"),$s(s,e.name),$s(o,e.name),rt(typeof x=="boolean",e,"internal-error"),rt(typeof D=="boolean",e,"internal-error"),$s(c,e.name),$s(d,e.name),$s(g,e.name),$s(p,e.name),$s(y,e.name),$s(b,e.name);const G=new ci({uid:S,auth:e,email:o,emailVerified:x,displayName:s,isAnonymous:D,photoURL:d,phoneNumber:c,tenantId:g,stsTokenManager:M,createdAt:y,lastLoginAt:b});return k&&Array.isArray(k)&&(G.providerData=k.map(q=>({...q}))),p&&(G._redirectEventId=p),G}static async _fromIdTokenResponse(e,n,s=!1){const o=new Jo;o.updateFromServerResponse(n);const c=new ci({uid:n.localId,auth:e,stsTokenManager:o,isAnonymous:s});return await dh(c),c}static async _fromGetAccountInfoResponse(e,n,s){const o=n.users[0];rt(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?OT(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,g=new Jo;g.updateFromIdToken(s);const p=new ci({uid:o.localId,auth:e,stsTokenManager:g,isAnonymous:d}),y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Vg(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,y),p}}const Pb=new Map;function ns(i){us(i instanceof Function,"Expected a class definition");let e=Pb.get(i);return e?(us(e instanceof i,"Instance stored in cache mismatched with class"),e):(e=new i,Pb.set(i,e),e)}class jT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}jT.type="NONE";const zb=jT;function Gd(i,e,n){return`firebase:${i}:${e}:${n}`}class Zo{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:o,name:c}=this.auth;this.fullUserKey=Gd(this.userKey,o.apiKey,c),this.fullPersistenceKey=Gd("persistence",o.apiKey,c),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await uh(this.auth,{idToken:e}).catch(()=>{});return n?ci._fromGetAccountInfoResponse(this.auth,n,e):null}return ci._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new Zo(ns(zb),e,s);const o=(await Promise.all(n.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let c=o[0]||ns(zb);const d=Gd(s,e.config.apiKey,e.name);let g=null;for(const y of n)try{const b=await y._get(d);if(b){let S;if(typeof b=="string"){const x=await uh(e,{idToken:b}).catch(()=>{});if(!x)break;S=await ci._fromGetAccountInfoResponse(e,x,b)}else S=ci._fromJSON(e,b);y!==c&&(g=S),c=y;break}}catch{}const p=o.filter(y=>y._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new Zo(c,e,s):(c=p[0],g&&await c._set(d,g.toJSON()),await Promise.all(n.map(async y=>{if(y!==c)try{await y._remove(d)}catch{}})),new Zo(c,e,s))}}function Ub(i){const e=i.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(VT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(MT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(PT(e))return"Blackberry";if(zT(e))return"Webos";if(kT(e))return"Safari";if((e.includes("chrome/")||NT(e))&&!e.includes("edge/"))return"Chrome";if(LT(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=i.match(n);if(s?.length===2)return s[1]}return"Other"}function MT(i=ar()){return/firefox\//i.test(i)}function kT(i=ar()){const e=i.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function NT(i=ar()){return/crios\//i.test(i)}function VT(i=ar()){return/iemobile/i.test(i)}function LT(i=ar()){return/android/i.test(i)}function PT(i=ar()){return/blackberry/i.test(i)}function zT(i=ar()){return/webos/i.test(i)}function kp(i=ar()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function JD(i=ar()){return kp(i)&&!!window.navigator?.standalone}function ZD(){return WA()&&document.documentMode===10}function UT(i=ar()){return kp(i)||LT(i)||zT(i)||PT(i)||/windows phone/i.test(i)||VT(i)}function BT(i,e=[]){let n;switch(i){case"Browser":n=Ub(ar());break;case"Worker":n=`${Ub(ar())}-${i}`;break;default:n=i}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${pl}/${s}`}class e5{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=c=>new Promise((d,g)=>{try{const p=e(c);d(p)}catch(p){g(p)}});s.onAbort=n,this.queue.push(s);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const o of n)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s?.message})}}}async function t5(i,e={}){return pa(i,"GET","/v2/passwordPolicy",to(i,e))}const n5=6;class r5{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??n5,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),o&&(n.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let o=0;o<e.length;o++)s=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}class i5{constructor(e,n,s,o){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Bb(this),this.idTokenSubscription=new Bb(this),this.beforeStateQueue=new e5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=AT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ns(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Zo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await uh(this,{idToken:e}),s=await ci._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(li(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=this.redirectUser?._redirectEventId,d=s?._redirectEventId,g=await this.tryRedirectSignIn(e);(!c||c===d)&&g?.user&&(s=g.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return rt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await dh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=VD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(li(this.app))return Promise.reject(sa(this));const n=e?qn(e):null;return n&&rt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&rt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return li(this.app)?Promise.reject(sa(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return li(this.app)?Promise.reject(sa(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ns(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await t5(this),n=new r5(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Gc("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await XD(this,s)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ns(e)||this._popupRedirectResolver;rt(n,this,"argument-error"),this.redirectPersistenceManager=await Zo.create(this,[ns(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,o){if(this._deleted)return()=>{};const c=typeof n=="function"?n:n.next.bind(n);let d=!1;const g=this._isInitialized?Promise.resolve():this._initializationPromise;if(rt(g,this,"internal-error"),g.then(()=>{d||c(this.currentUser)}),typeof n=="function"){const p=e.addObserver(n,s,o);return()=>{d=!0,p()}}else{const p=e.addObserver(n);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return rt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=BT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){if(li(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&MD(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Tl(i){return qn(i)}class Bb{constructor(e){this.auth=e,this.observer=null,this.addObserver=iC(n=>this.observer=n)}get next(){return rt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Bh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function s5(i){Bh=i}function FT(i){return Bh.loadJS(i)}function a5(){return Bh.recaptchaEnterpriseScript}function o5(){return Bh.gapiScript}function l5(i){return`__${i}${Math.floor(Math.random()*1e6)}`}class c5{constructor(){this.enterprise=new u5}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class u5{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const d5="recaptcha-enterprise",HT="NO_RECAPTCHA";class h5{constructor(e){this.type=d5,this.auth=Tl(e)}async verify(e="verify",n=!1){async function s(c){if(!n){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,g)=>{HD(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)g(new Error("recaptcha Enterprise site key undefined"));else{const y=new FD(p);return c.tenantId==null?c._agentRecaptchaConfig=y:c._tenantRecaptchaConfigs[c.tenantId]=y,d(y.siteKey)}}).catch(p=>{g(p)})})}function o(c,d,g){const p=window.grecaptcha;Vb(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(y=>{d(y)}).catch(()=>{d(HT)})}):g(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new c5().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{s(this.auth).then(g=>{if(!n&&Vb(window.grecaptcha))o(g,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=a5();p.length!==0&&(p+=g),FT(p).then(()=>{o(g,c,d)}).catch(y=>{d(y)})}}).catch(g=>{d(g)})})}}async function Fb(i,e,n,s=!1,o=!1){const c=new h5(i);let d;if(o)d=HT;else try{d=await c.verify(n)}catch{d=await c.verify(n,!0)}const g={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in g){const p=g.phoneEnrollmentInfo.phoneNumber,y=g.phoneEnrollmentInfo.recaptchaToken;Object.assign(g,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in g){const p=g.phoneSignInInfo.recaptchaToken;Object.assign(g,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return g}return s?Object.assign(g,{captchaResp:d}):Object.assign(g,{captchaResponse:d}),Object.assign(g,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(g,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),g}async function Hb(i,e,n,s,o){if(i._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Fb(i,e,n,n==="getOobCode");return s(i,c)}else return s(i,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Fb(i,e,n,n==="getOobCode");return s(i,d)}else return Promise.reject(c)})}function f5(i,e){const n=Xg(i,"auth");if(n.isInitialized()){const o=n.getImmediate(),c=n.getOptions();if(aa(c,e??{}))return o;di(o,"already-initialized")}return n.initialize({options:e})}function m5(i,e){const n=e?.persistence||[],s=(Array.isArray(n)?n:[n]).map(ns);e?.errorMap&&i._updateErrorMap(e.errorMap),i._initializeWithPersistence(s,e?.popupRedirectResolver)}function g5(i,e,n){const s=Tl(i);rt(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const o=!1,c=qT(e),{host:d,port:g}=p5(e),p=g===null?"":`:${g}`,y={url:`${c}//${d}${p}/`},b=Object.freeze({host:d,port:g,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!s._canInitEmulator){rt(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),rt(aa(y,s.config.emulator)&&aa(b,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=y,s.emulatorConfig=b,s.settings.appVerificationDisabledForTesting=!0,gl(d)?(LE(`${c}//${d}${p}`),PE("Auth",!0)):y5()}function qT(i){const e=i.indexOf(":");return e<0?"":i.substr(0,e+1)}function p5(i){const e=qT(i),n=/(\/\/)?([^?#/]+)/.exec(i.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(s);if(o){const c=o[1];return{host:c,port:qb(s.substr(c.length+1))}}else{const[c,d]=s.split(":");return{host:c,port:qb(d)}}}function qb(i){if(!i)return null;const e=Number(i);return isNaN(e)?null:e}function y5(){function i(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}class Np{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ts("not implemented")}_getIdTokenResponse(e){return ts("not implemented")}_linkToIdToken(e,n){return ts("not implemented")}_getReauthenticationResolver(e){return ts("not implemented")}}async function _5(i,e){return pa(i,"POST","/v1/accounts:signUp",e)}async function v5(i,e){return Uh(i,"POST","/v1/accounts:signInWithPassword",to(i,e))}async function b5(i,e){return Uh(i,"POST","/v1/accounts:signInWithEmailLink",to(i,e))}async function E5(i,e){return Uh(i,"POST","/v1/accounts:signInWithEmailLink",to(i,e))}class Uc extends Np{constructor(e,n,s,o=null){super("password",s),this._email=e,this._password=n,this._tenantId=o}static _fromEmailAndPassword(e,n){return new Uc(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new Uc(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Hb(e,n,"signInWithPassword",v5);case"emailLink":return b5(e,{email:this._email,oobCode:this._password});default:di(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Hb(e,s,"signUpPassword",_5);case"emailLink":return E5(e,{idToken:n,email:this._email,oobCode:this._password});default:di(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function el(i,e){return Uh(i,"POST","/v1/accounts:signInWithIdp",to(i,e))}const S5="http://localhost";class Ka extends Np{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ka(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):di("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:o,...c}=n;if(!s||!o)return null;const d=new Ka(s,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const n=this.buildRequest();return el(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,el(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,el(e,n)}buildRequest(){const e={requestUri:S5,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=$c(n)}return e}}function T5(i){switch(i){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function x5(i){const e=bc(Ec(i)).link,n=e?bc(Ec(e)).deep_link_id:null,s=bc(Ec(i)).deep_link_id;return(s?bc(Ec(s)).link:null)||s||n||e||i}class Vp{constructor(e){const n=bc(Ec(e)),s=n.apiKey??null,o=n.oobCode??null,c=T5(n.mode??null);rt(s&&o&&c,"argument-error"),this.apiKey=s,this.operation=c,this.code=o,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=x5(e);try{return new Vp(n)}catch{return null}}}class xl{constructor(){this.providerId=xl.PROVIDER_ID}static credential(e,n){return Uc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=Vp.parseLink(n);return rt(s,"argument-error"),Uc._fromEmailAndCode(e,s.code,s.tenantId)}}xl.PROVIDER_ID="password";xl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";xl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class GT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class tu extends GT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ks extends tu{constructor(){super("facebook.com")}static credential(e){return Ka._fromParams({providerId:Ks.PROVIDER_ID,signInMethod:Ks.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ks.credentialFromTaggedObject(e)}static credentialFromError(e){return Ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ks.credential(e.oauthAccessToken)}catch{return null}}}Ks.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ks.PROVIDER_ID="facebook.com";class Ws extends tu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ka._fromParams({providerId:Ws.PROVIDER_ID,signInMethod:Ws.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ws.credentialFromTaggedObject(e)}static credentialFromError(e){return Ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Ws.credential(n,s)}catch{return null}}}Ws.GOOGLE_SIGN_IN_METHOD="google.com";Ws.PROVIDER_ID="google.com";class Xs extends tu{constructor(){super("github.com")}static credential(e){return Ka._fromParams({providerId:Xs.PROVIDER_ID,signInMethod:Xs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xs.credentialFromTaggedObject(e)}static credentialFromError(e){return Xs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xs.credential(e.oauthAccessToken)}catch{return null}}}Xs.GITHUB_SIGN_IN_METHOD="github.com";Xs.PROVIDER_ID="github.com";class Js extends tu{constructor(){super("twitter.com")}static credential(e,n){return Ka._fromParams({providerId:Js.PROVIDER_ID,signInMethod:Js.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Js.credentialFromTaggedObject(e)}static credentialFromError(e){return Js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return Js.credential(n,s)}catch{return null}}}Js.TWITTER_SIGN_IN_METHOD="twitter.com";Js.PROVIDER_ID="twitter.com";class cl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,o=!1){const c=await ci._fromIdTokenResponse(e,s,o),d=Gb(s);return new cl({user:c,providerId:d,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const o=Gb(s);return new cl({user:e,providerId:o,_tokenResponse:s,operationType:n})}}function Gb(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}class hh extends ds{constructor(e,n,s,o){super(n.code,n.message),this.operationType=s,this.user=o,Object.setPrototypeOf(this,hh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,o){return new hh(e,n,s,o)}}function $T(i,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(i):n._getIdTokenResponse(i)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?hh._fromErrorAndOperation(i,c,e,s):c})}async function w5(i,e,n=!1){const s=await zc(i,e._linkToIdToken(i.auth,await i.getIdToken()),n);return cl._forOperation(i,"link",s)}async function A5(i,e,n=!1){const{auth:s}=i;if(li(s.app))return Promise.reject(sa(s));const o="reauthenticate";try{const c=await zc(i,$T(s,o,e,i),n);rt(c.idToken,s,"internal-error");const d=Mp(c.idToken);rt(d,s,"internal-error");const{sub:g}=d;return rt(i.uid===g,s,"user-mismatch"),cl._forOperation(i,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&di(s,"user-mismatch"),c}}async function YT(i,e,n=!1){if(li(i.app))return Promise.reject(sa(i));const s="signIn",o=await $T(i,s,e),c=await cl._fromIdTokenResponse(i,s,o);return n||await i._updateCurrentUser(c.user),c}async function C5(i,e){return YT(Tl(i),e)}async function R5(i){const e=Tl(i);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function I5(i,e,n){return li(i.app)?Promise.reject(sa(i)):C5(qn(i),xl.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&R5(i),s})}function D5(i,e,n,s){return qn(i).onIdTokenChanged(e,n,s)}function O5(i,e,n){return qn(i).beforeAuthStateChanged(e,n)}function j5(i,e,n,s){return qn(i).onAuthStateChanged(e,n,s)}function M5(i){return qn(i).signOut()}const fh="__sak";class QT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(fh,"1"),this.storage.removeItem(fh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const k5=1e3,N5=10;class KT extends QT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=UT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),o=this.localCache[n];s!==o&&e(n,o,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((d,g,p)=>{this.notifyListeners(d,p)});return}const s=e.key;n?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(s);!n&&this.localCache[s]===d||this.notifyListeners(s,d)},c=this.storage.getItem(s);ZD()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,N5):o()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},k5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}KT.type="LOCAL";const V5=KT;class WT extends QT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}WT.type="SESSION";const XT=WT;function L5(i){return Promise.all(i.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class Fh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(o=>o.isListeningto(e));if(n)return n;const s=new Fh(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:o,data:c}=n.data,d=this.handlersMap[o];if(!d?.size)return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const g=Array.from(d).map(async y=>y(n.origin,c)),p=await L5(g);n.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:p})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Fh.receivers=[];function Lp(i="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return i+n}class P5{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((g,p)=>{const y=Lp("",20);o.port1.start();const b=setTimeout(()=>{p(new Error("unsupported_event"))},s);d={messageChannel:o,onMessage(S){const x=S;if(x.data.eventId===y)switch(x.data.status){case"ack":clearTimeout(b),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),g(x.data.response);break;default:clearTimeout(b),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:n},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}function ji(){return window}function z5(i){ji().location.href=i}function JT(){return typeof ji().WorkerGlobalScope<"u"&&typeof ji().importScripts=="function"}async function U5(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function B5(){return navigator?.serviceWorker?.controller||null}function F5(){return JT()?self:null}const ZT="firebaseLocalStorageDb",H5=1,mh="firebaseLocalStorage",ex="fbase_key";class nu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Hh(i,e){return i.transaction([mh],e?"readwrite":"readonly").objectStore(mh)}function q5(){const i=indexedDB.deleteDatabase(ZT);return new nu(i).toPromise()}function Lg(){const i=indexedDB.open(ZT,H5);return new Promise((e,n)=>{i.addEventListener("error",()=>{n(i.error)}),i.addEventListener("upgradeneeded",()=>{const s=i.result;try{s.createObjectStore(mh,{keyPath:ex})}catch(o){n(o)}}),i.addEventListener("success",async()=>{const s=i.result;s.objectStoreNames.contains(mh)?e(s):(s.close(),await q5(),e(await Lg()))})})}async function $b(i,e,n){const s=Hh(i,!0).put({[ex]:e,value:n});return new nu(s).toPromise()}async function G5(i,e){const n=Hh(i,!1).get(e),s=await new nu(n).toPromise();return s===void 0?null:s.value}function Yb(i,e){const n=Hh(i,!0).delete(e);return new nu(n).toPromise()}const $5=800,Y5=3;class tx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Lg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>Y5)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return JT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Fh._getInstance(F5()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await U5(),!this.activeServiceWorker)return;this.sender=new P5(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||B5()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Lg();return await $b(e,fh,"1"),await Yb(e,fh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>$b(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>G5(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Yb(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=Hh(o,!1).getAll();return new nu(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)s.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),n.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!s.has(o)&&(this.notifyListeners(o,null),n.push(o));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const o of Array.from(s))o(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$5)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}tx.type="LOCAL";const Q5=tx;new eu(3e4,6e4);function K5(i,e){return e?ns(e):(rt(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}class Pp extends Np{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return el(e,this._buildIdpRequest())}_linkToIdToken(e,n){return el(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return el(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function W5(i){return YT(i.auth,new Pp(i),i.bypassAuthState)}function X5(i){const{auth:e,user:n}=i;return rt(n,e,"internal-error"),A5(n,new Pp(i),i.bypassAuthState)}async function J5(i){const{auth:e,user:n}=i;return rt(n,e,"internal-error"),w5(n,new Pp(i),i.bypassAuthState)}class nx{constructor(e,n,s,o,c=!1){this.auth=e,this.resolver=s,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:o,tenantId:c,error:d,type:g}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:n,sessionId:s,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(g)(p))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return W5;case"linkViaPopup":case"linkViaRedirect":return J5;case"reauthViaPopup":case"reauthViaRedirect":return X5;default:di(this.auth,"internal-error")}}resolve(e){us(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){us(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Z5=new eu(2e3,1e4);class Ko extends nx{constructor(e,n,s,o,c){super(e,n,o,c),this.provider=s,this.authWindow=null,this.pollId=null,Ko.currentPopupAction&&Ko.currentPopupAction.cancel(),Ko.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return rt(e,this.auth,"internal-error"),e}async onExecution(){us(this.filter.length===1,"Popup operations only handle one event");const e=Lp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Oi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Oi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ko.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Oi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Z5.get())};e()}}Ko.currentPopupAction=null;const eO="pendingRedirect",$d=new Map;class tO extends nx{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=$d.get(this.auth._key());if(!e){try{const s=await nO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}$d.set(this.auth._key(),e)}return this.bypassAuthState||$d.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function nO(i,e){const n=sO(e),s=iO(i);if(!await s._isAvailable())return!1;const o=await s._get(n)==="true";return await s._remove(n),o}function rO(i,e){$d.set(i._key(),e)}function iO(i){return ns(i._redirectPersistence)}function sO(i){return Gd(eO,i.config.apiKey,i.name)}async function aO(i,e,n=!1){if(li(i.app))return Promise.reject(sa(i));const s=Tl(i),o=K5(s,e),d=await new tO(s,o,n).execute();return d&&!n&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}const oO=600*1e3;class lO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!cO(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!rx(e)){const s=e.error.code?.split("auth/")[1]||"internal-error";n.onError(Oi(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=oO&&this.cachedEventUids.clear(),this.cachedEventUids.has(Qb(e))}saveEventToCache(e){this.cachedEventUids.add(Qb(e)),this.lastProcessedEventTime=Date.now()}}function Qb(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(e=>e).join("-")}function rx({type:i,error:e}){return i==="unknown"&&e?.code==="auth/no-auth-event"}function cO(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rx(i);default:return!1}}async function uO(i,e={}){return pa(i,"GET","/v1/projects",e)}const dO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hO=/^https?/;async function fO(i){if(i.config.emulator)return;const{authorizedDomains:e}=await uO(i);for(const n of e)try{if(mO(n))return}catch{}di(i,"unauthorized-domain")}function mO(i){const e=Ng(),{protocol:n,hostname:s}=new URL(e);if(i.startsWith("chrome-extension://")){const d=new URL(i);return d.hostname===""&&s===""?n==="chrome-extension:"&&i.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&d.hostname===s}if(!hO.test(n))return!1;if(dO.test(i))return s===i;const o=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)}const gO=new eu(3e4,6e4);function Kb(){const i=ji().___jsl;if(i?.H){for(const e of Object.keys(i.H))if(i.H[e].r=i.H[e].r||[],i.H[e].L=i.H[e].L||[],i.H[e].r=[...i.H[e].L],i.CP)for(let n=0;n<i.CP.length;n++)i.CP[n]=null}}function pO(i){return new Promise((e,n)=>{function s(){Kb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Kb(),n(Oi(i,"network-request-failed"))},timeout:gO.get()})}if(ji().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ji().gapi?.load)s();else{const o=l5("iframefcb");return ji()[o]=()=>{gapi.load?s():n(Oi(i,"network-request-failed"))},FT(`${o5()}?onload=${o}`).catch(c=>n(c))}}).catch(e=>{throw Yd=null,e})}let Yd=null;function yO(i){return Yd=Yd||pO(i),Yd}const _O=new eu(5e3,15e3),vO="__/auth/iframe",bO="emulator/auth/iframe",EO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},SO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function TO(i){const e=i.config;rt(e.authDomain,i,"auth-domain-config-required");const n=e.emulator?jp(e,bO):`https://${i.config.authDomain}/${vO}`,s={apiKey:e.apiKey,appName:i.name,v:pl},o=SO.get(i.config.apiHost);o&&(s.eid=o);const c=i._getFrameworks();return c.length&&(s.fw=c.join(",")),`${n}?${$c(s).slice(1)}`}async function xO(i){const e=await yO(i),n=ji().gapi;return rt(n,i,"internal-error"),e.open({where:document.body,url:TO(i),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:EO,dontclear:!0},s=>new Promise(async(o,c)=>{await s.restyle({setHideOnLeave:!1});const d=Oi(i,"network-request-failed"),g=ji().setTimeout(()=>{c(d)},_O.get());function p(){ji().clearTimeout(g),o(s)}s.ping(p).then(p,()=>{c(d)})}))}const wO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},AO=500,CO=600,RO="_blank",IO="http://localhost";class Wb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function DO(i,e,n,s=AO,o=CO){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let g="";const p={...wO,width:s.toString(),height:o.toString(),top:c,left:d},y=ar().toLowerCase();n&&(g=NT(y)?RO:n),MT(y)&&(e=e||IO,p.scrollbars="yes");const b=Object.entries(p).reduce((x,[D,k])=>`${x}${D}=${k},`,"");if(JD(y)&&g!=="_self")return OO(e||"",g),new Wb(null);const S=window.open(e||"",g,b);rt(S,i,"popup-blocked");try{S.focus()}catch{}return new Wb(S)}function OO(i,e){const n=document.createElement("a");n.href=i,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}const jO="__/auth/handler",MO="emulator/auth/handler",kO=encodeURIComponent("fac");async function Xb(i,e,n,s,o,c){rt(i.config.authDomain,i,"auth-domain-config-required"),rt(i.config.apiKey,i,"invalid-api-key");const d={apiKey:i.config.apiKey,appName:i.name,authType:n,redirectUrl:s,v:pl,eventId:o};if(e instanceof GT){e.setDefaultLanguage(i.languageCode),d.providerId=e.providerId||"",rC(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,S]of Object.entries({}))d[b]=S}if(e instanceof tu){const b=e.getScopes().filter(S=>S!=="");b.length>0&&(d.scopes=b.join(","))}i.tenantId&&(d.tid=i.tenantId);const g=d;for(const b of Object.keys(g))g[b]===void 0&&delete g[b];const p=await i._getAppCheckToken(),y=p?`#${kO}=${encodeURIComponent(p)}`:"";return`${NO(i)}?${$c(g).slice(1)}${y}`}function NO({config:i}){return i.emulator?jp(i,MO):`https://${i.authDomain}/${jO}`}const ag="webStorageSupport";class VO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=XT,this._completeRedirectFn=aO,this._overrideRedirectResult=rO}async _openPopup(e,n,s,o){us(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const c=await Xb(e,n,s,Ng(),o);return DO(e,c,Lp())}async _openRedirect(e,n,s,o){await this._originValidation(e);const c=await Xb(e,n,s,Ng(),o);return z5(c),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:o,promise:c}=this.eventManagers[n];return o?Promise.resolve(o):(us(c,"If manager is not set, promise should be"),c)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await xO(e),s=new lO(e);return n.register("authEvent",o=>(rt(o?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ag,{type:ag},o=>{const c=o?.[0]?.[ag];c!==void 0&&n(!!c),di(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=fO(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return UT()||kT()||kp()}}const LO=VO;var Jb="@firebase/auth",Zb="1.12.0";class PO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e(s?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){rt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function zO(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function UO(i){tl(new $a("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:g}=s.options;rt(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const p={apiKey:d,authDomain:g,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:BT(i)},y=new i5(s,o,c,p);return m5(y,n),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),tl(new $a("auth-internal",e=>{const n=Tl(e.getProvider("auth").getImmediate());return(s=>new PO(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),na(Jb,Zb,zO(i)),na(Jb,Zb,"esm2020")}const BO=300,FO=VE("authIdTokenMaxAge")||BO;let eE=null;const HO=i=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>FO)return;const o=n?.token;eE!==o&&(eE=o,await fetch(i,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function qO(i=FE()){const e=Xg(i,"auth");if(e.isInitialized())return e.getImmediate();const n=f5(i,{popupRedirectResolver:LO,persistence:[Q5,V5,XT]}),s=VE("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(s,location.origin);if(location.origin===c.origin){const d=HO(c.toString());O5(n,d,()=>d(n.currentUser)),D5(n,g=>d(g))}}const o=kE("auth");return o&&g5(n,`http://${o}`),n}function GO(){return document.getElementsByTagName("head")?.[0]??document}s5({loadJS(i){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",i),s.onload=e,s.onerror=o=>{const c=Oi("internal-error");c.customData=o,n(c)},s.type="text/javascript",s.charset="UTF-8",GO().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});UO("Browser");function ru(){const i=qO(ga);async function e(){return!1}async function n(g,p){return I5(i,g,p)}function s(){return M5(i)}function o(g){j5(i,p=>{g(p)})}function c(){return i.currentUser}return{set_user_listener:o,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:s,get_current_firebase_user:c}}const ix=1,$O=3600*1e3,Fn={USER_DOC:i=>`cache_user_${i}`,BUDGET:i=>`cache_budget_${i}`,MONTH:(i,e,n)=>`cache_month_${i}_${e}_${n}`,PAYEES:i=>`cache_payees_${i}`,ACCESSIBLE_BUDGETS:i=>`cache_accessible_budgets_${i}`,CATEGORY_BALANCES:i=>`cache_category_balances_${i}`,LAST_REFRESH:"cache_last_refresh"};function Bo(i,e=$O){try{const n=localStorage.getItem(i);if(!n)return null;const s=JSON.parse(n);if(s.version!==ix)return localStorage.removeItem(i),null;const o=Date.now()-s.timestamp;return o>e?(console.log(`[Cache] ${i} is stale (${Math.round(o/1e3)}s old)`),null):(console.log(`[Cache] HIT: ${i} (${Math.round(o/1e3)}s old)`),s.data)}catch(n){return console.warn(`[Cache] Error reading ${i}:`,n),localStorage.removeItem(i),null}}function Jn(i,e){try{const n={data:e,timestamp:Date.now(),version:ix};localStorage.setItem(i,JSON.stringify(n)),console.log(`[Cache] SAVED: ${i}`)}catch(n){console.warn(`[Cache] Error saving ${i}:`,n),WO()}}function YO(i){localStorage.removeItem(i),console.log(`[Cache] REMOVED: ${i}`)}function QO(i){const e=[];for(let n=0;n<localStorage.length;n++){const s=localStorage.key(n);s?.includes(i)&&s.startsWith("cache_")&&e.push(s)}e.forEach(n=>localStorage.removeItem(n)),console.log(`[Cache] Cleared ${e.length} entries for budget ${i}`)}function KO(){const i=[];for(let e=0;e<localStorage.length;e++){const n=localStorage.key(e);n?.startsWith("cache_")&&i.push(n)}i.forEach(e=>localStorage.removeItem(e)),console.log(`[Cache] Cleared all ${i.length} cache entries`)}function WO(){const i=[];for(let n=0;n<localStorage.length;n++){const s=localStorage.key(n);if(s?.startsWith("cache_"))try{const o=localStorage.getItem(s);if(o){const c=JSON.parse(o);i.push({key:s,timestamp:c.timestamp||0})}}catch{s&&localStorage.removeItem(s)}}i.sort((n,s)=>n.timestamp-s.timestamp);const e=i.slice(0,Math.ceil(i.length/2));e.forEach(n=>localStorage.removeItem(n.key)),console.log(`[Cache] Cleared ${e.length} old entries to free space`)}function XO(){try{const i=localStorage.getItem(Fn.LAST_REFRESH);return i?parseInt(i,10):null}catch{return null}}function JO(){localStorage.setItem(Fn.LAST_REFRESH,Date.now().toString())}function ZO(){const i=[];let e=0;for(let n=0;n<localStorage.length;n++){const s=localStorage.key(n);if(s?.startsWith("cache_")){const o=localStorage.getItem(s)||"",c=o.length*2;e+=c;let d="unknown";try{const g=JSON.parse(o),p=Date.now()-g.timestamp;p<6e4?d=`${Math.round(p/1e3)}s`:p<36e5?d=`${Math.round(p/6e4)}m`:d=`${Math.round(p/36e5)}h`}catch{}i.push({key:s,size:c,age:d})}}return{count:i.length,totalSize:e,entries:i}}const sx=A.createContext({currentBudget:null,loading:!1,error:null,isOwner:!1,isAdmin:!1,isTest:!1,currentUserId:null,isInitialized:!1,accounts:{},accountGroups:{},categories:{},categoryGroups:[],budgetUserIds:[],acceptedUserIds:[],pendingInvites:[],hasPendingInvites:!1,needsFirstBudget:!1,accessibleBudgets:[],currentMonth:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,monthLoading:!1,previousMonthIncome:0,payees:[],lastRefreshTime:null,cacheStats:null,isUsingCache:!1,ensureBudgetLoaded:async()=>{},refreshBudget:async()=>{},forceRefreshFromFirebase:async()=>{},clearCache:()=>{},inviteUserToBudget:async()=>{},revokeUserFromBudget:async()=>{},checkBudgetInvite:async()=>null,acceptBudgetInvite:async()=>{},loadAccessibleBudgets:async()=>{},switchToBudget:async()=>{},createNewBudget:async()=>{},renameBudget:async()=>{},setAccounts:()=>{},setAccountGroups:()=>{},setCategories:()=>{},setCategoryGroups:()=>{},saveBudgetData:async()=>{},loadMonth:async()=>{},goToPreviousMonth:async()=>{},goToNextMonth:async()=>{},addIncome:async()=>{},updateIncome:async()=>{},deleteIncome:async()=>{},recomputeMonthTotals:async()=>{},recomputeAllBalances:async()=>{},checkBalanceMismatch:async()=>null,reconcileBalances:async()=>{},balanceMismatch:null,loadPayees:async()=>{},saveAllocations:async()=>{},finalizeAllocations:async()=>{},unfinalizeAllocations:async()=>{},getCategoryBalances:async()=>({}),getOnBudgetTotal:()=>0,getPreviousMonthIncome:async()=>0});function Md(i){const e={};return Object.entries(i).forEach(([n,s])=>{e[n]={nickname:s.nickname,balance:s.balance,account_group_id:s.account_group_id??null,sort_order:s.sort_order},s.is_income_account!==void 0&&(e[n].is_income_account=s.is_income_account),s.is_income_default!==void 0&&(e[n].is_income_default=s.is_income_default),s.is_outgo_account!==void 0&&(e[n].is_outgo_account=s.is_outgo_account),s.is_outgo_default!==void 0&&(e[n].is_outgo_default=s.is_outgo_default),s.on_budget!==void 0&&(e[n].on_budget=s.on_budget),s.is_active!==void 0&&(e[n].is_active=s.is_active)}),e}function ej({children:i}){const e=ru(),[n,s]=A.useState(null),[o,c]=A.useState(!1),[d,g]=A.useState(null),[p,y]=A.useState(!1),b=A.useRef(null),[S,x]=A.useState({}),[D,k]=A.useState({}),[O,M]=A.useState({}),[G,q]=A.useState([]),[ee,Ce]=A.useState([]),[Me,Se]=A.useState([]),[R,C]=A.useState([]),[I,L]=A.useState([]),[N,B]=A.useState(!1),[j,Fe]=A.useState(!1),[dt,se]=A.useState(!1),[$,Ie]=A.useState(null),[Ue,st]=A.useState(new Date().getFullYear()),[V,P]=A.useState(new Date().getMonth()+1),[Q,X]=A.useState(!1),[ne,we]=A.useState(0),[ke,Qe]=A.useState([]),[lt,Ut]=A.useState(null),[bn,Jt]=A.useState(()=>XO()),[Nn,mn]=A.useState(null),[Gn,kt]=A.useState(!1),Zt=A.useRef(!1),tt=eo(ga),F=e.get_current_firebase_user(),fe=A.useCallback(()=>{const le=ZO();mn({count:le.count,totalSize:le.totalSize})},[]);async function z(le=!1){if(!F)throw new Error("Not authenticated");const ie=Fn.USER_DOC(F.uid);if(!Zt.current&&!le){const ce=Bo(ie);if(ce)return kt(!0),ce}const de=Ke(tt,"users",F.uid);try{const ce=await ht(de);if(kt(!1),ce.exists()){const xe=ce.data();return Jn(ie,xe),xe}const De={uid:F.uid,email:F.email||null,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await vt(de,De),Jn(ie,De),De}catch(ce){throw console.error("[BudgetContext] Error getting/creating user doc:",ce),ce}}async function K(){if(!F){s(null),x({}),k({}),M({}),q([]),Ce([]),Se([]),C([]),L([]),B(!1),c(!1),y(!1),b.current=null;return}c(!0),g(null);try{let le=null,ie=!1;try{le=await z();const ce=le?.permission_flags;Fe(ce?.is_admin===!0),se(ce?.is_test===!0)}catch(ce){console.warn("[BudgetContext] Failed to get user doc, falling back to old approach:",ce),ie=!0,Fe(!1),se(!1)}const de=[];try{const ce=Ys(tt,"budgets"),De=Fa(ce,Ha("user_ids","array-contains",F.uid)),xe=await Qs(De);for(const Oe of xe.docs){const Be=Oe.data(),Pe=Be.user_ids?.includes(F.uid),Ge=Be.accepted_user_ids?.includes(F.uid),et=le?.budget_ids?.includes(Oe.id);Pe&&!Ge&&!et&&de.push({budgetId:Oe.id,budgetName:Be.name||"Unnamed Budget",ownerEmail:Be.owner_email||null})}}catch(ce){console.warn("[BudgetContext] Could not check for pending invites:",ce)}if(C(de),ie||le&&le.budget_ids.length===0){const ce=Ys(tt,"budgets"),De=Fa(ce,Ha("user_ids","array-contains",F.uid)),xe=await Qs(De);kt(!1);const Oe=xe.docs.filter(Be=>Be.data().accepted_user_ids?.includes(F.uid));if(Oe.length>0){const Be=Oe[0],Pe=Be.data();Jn(Fn.BUDGET(Be.id),Pe),await te(Be.id,Pe)}else de.length>0?(s(null),x({}),k({}),M({}),q([]),Ce([]),Se([]),B(!1)):(s(null),x({}),k({}),M({}),q([]),Ce([]),Se([]),B(!0))}else if(le&&le.budget_ids.length>0){const ce=le.budget_ids[0],De=Fn.BUDGET(ce);let xe=null;if(Zt.current||(xe=Bo(De)),xe)kt(!0),await te(ce,xe);else{const Oe=Ke(tt,"budgets",ce),Be=await ht(Oe);if(kt(!1),!Be.exists())throw new Error(`Budget ${ce} not found`);xe=Be.data(),Jn(De,xe),await te(ce,xe)}}b.current=F.uid,y(!0)}catch(le){console.error("[BudgetContext] Error loading budget:",le),g(le instanceof Error?le.message:"Failed to load budget")}finally{c(!1)}}async function te(le,ie){s({id:le,name:ie.name,user_ids:ie.user_ids||[],accepted_user_ids:ie.accepted_user_ids||[],owner_id:ie.owner_id||ie.user_ids?.[0]||F.uid,owner_email:ie.owner_email||null}),Ce(ie.user_ids||[]),Se(ie.accepted_user_ids||[]);const de={},ce=ie.accounts||{};Object.entries(ce).forEach(([Ge,et])=>{de[Ge]={nickname:et.nickname,balance:et.balance,account_group_id:et.account_group_id??null,sort_order:et.sort_order??0,is_income_account:et.is_income_account,is_income_default:et.is_income_default,is_outgo_account:et.is_outgo_account,is_outgo_default:et.is_outgo_default,on_budget:et.on_budget,is_active:et.is_active}}),x(de);const De={},xe=ie.account_groups||{};Object.entries(xe).forEach(([Ge,et])=>{De[Ge]={name:et.name,sort_order:et.sort_order??0,expected_balance:et.expected_balance??"positive",on_budget:et.on_budget,is_active:et.is_active}}),k(De);const Oe={},Be=ie.categories||{};Object.entries(Be).forEach(([Ge,et])=>{Oe[Ge]={name:et.name,description:et.description,category_group_id:et.category_group_id??null,sort_order:et.sort_order??0,default_monthly_amount:et.default_monthly_amount,default_monthly_type:et.default_monthly_type,balance:et.balance??0}}),M(Oe);const Pe=(ie.category_groups||[]).map(Ge=>({id:Ge.id,name:Ge.name,sort_order:Ge.sort_order??0}));Pe.sort((Ge,et)=>Ge.sort_order-et.sort_order),q(Pe)}async function ue(){F&&(p&&b.current===F.uid||await K())}async function Ae(le){if(!(!n||!F))try{const ie=Ke(tt,"budgets",n.id),de=await ht(ie);if(de.exists()){const ce=de.data();if(ce.user_ids?.includes(le))throw new Error("User is already invited to this budget");const De=[...ce.user_ids||[],le];await vt(ie,{...ce,user_ids:De}),s({...n,user_ids:De}),Ce(De)}}catch(ie){throw new Error(ie instanceof Error?ie.message:"Failed to invite user")}}async function pe(le){if(!(!n||!F))try{const ie=Ke(tt,"budgets",n.id),de=await ht(ie);if(de.exists()){const ce=de.data(),De=(ce.user_ids||[]).filter(Oe=>Oe!==le),xe=(ce.accepted_user_ids||[]).filter(Oe=>Oe!==le);await vt(ie,{...ce,user_ids:De,accepted_user_ids:xe}),s({...n,user_ids:De,accepted_user_ids:xe}),Ce(De),Se(xe)}}catch(ie){throw new Error(ie instanceof Error?ie.message:"Failed to revoke user access")}}async function ve(le){if(!F)return null;try{const ie=Ke(tt,"budgets",le),de=await ht(ie);if(!de.exists())return null;const ce=de.data();return!ce.user_ids?.includes(F.uid)||(await z()).budget_ids.includes(le)?null:{budgetId:de.id,budgetName:ce.name,ownerEmail:ce.owner_email||null}}catch{return null}}async function Te(le){if(F)try{const ie=Ke(tt,"budgets",le),de=await ht(ie);if(!de.exists())throw new Error("Budget not found");const ce=de.data();if(!ce.user_ids?.includes(F.uid))throw new Error("You have not been invited to this budget");const De=await z();if(De.budget_ids.includes(le))throw new Error("You have already accepted this invite");await vt(Ke(tt,"users",F.uid),{...De,budget_ids:[...De.budget_ids,le],updated_at:new Date().toISOString()});const xe=[...ce.accepted_user_ids||[],F.uid];await vt(ie,{...ce,accepted_user_ids:xe}),b.current=null,await K()}catch(ie){throw new Error(ie instanceof Error?ie.message:"Failed to accept invite")}}async function Le(){if(n)try{const le=Ke(tt,"budgets",n.id),ie=await ht(le);if(ie.exists()){const ce={...ie.data(),accounts:S,account_groups:D,categories:O,category_groups:G};await vt(le,ce),Jn(Fn.BUDGET(n.id),ce)}}catch(le){throw new Error(le instanceof Error?le.message:"Failed to save budget data")}}async function Re(){if(!F){L([]);return}try{const le=[];let ie=null;try{ie=await z()}catch{console.warn("[BudgetContext] Could not get user doc for accessible budgets")}const de=Ys(tt,"budgets"),ce=Fa(de,Ha("user_ids","array-contains",F.uid)),De=await Qs(ce);for(const xe of De.docs){const Oe=xe.data(),Be=Oe.accepted_user_ids?.includes(F.uid)||ie?.budget_ids?.includes(xe.id),Pe=Oe.owner_id===F.uid;le.push({id:xe.id,name:Oe.name||"Unnamed Budget",ownerEmail:Oe.owner_email||null,isOwner:Pe,isPending:!Be})}le.sort((xe,Oe)=>xe.isOwner!==Oe.isOwner?xe.isOwner?-1:1:xe.isPending!==Oe.isPending?xe.isPending?1:-1:xe.name.localeCompare(Oe.name)),L(le)}catch(le){console.error("[BudgetContext] Error loading accessible budgets:",le)}}async function at(le){if(F){c(!0),g(null);try{const ie=Ke(tt,"budgets",le),de=await ht(ie);if(!de.exists())throw new Error("Budget not found");const ce=de.data();if(!(ce.accepted_user_ids?.includes(F.uid)||ce.owner_id===F.uid))throw new Error("You do not have access to this budget. Please accept the invite first.");try{const xe=Ke(tt,"users",F.uid),Oe=await ht(xe);if(Oe.exists()){const Be=Oe.data(),Pe=[le,...Be.budget_ids.filter(Ge=>Ge!==le)];await vt(xe,{...Be,budget_ids:Pe,updated_at:new Date().toISOString()})}}catch(xe){console.warn("[BudgetContext] Could not update user doc primary budget:",xe)}await te(le,ce),b.current=F.uid}catch(ie){throw console.error("[BudgetContext] Error switching budget:",ie),g(ie instanceof Error?ie.message:"Failed to switch budget"),ie}finally{c(!1)}}}async function St(le){if(!F)return;const ie=le?.trim()||"My Budget";c(!0),g(null);try{const de=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,ce={id:de,name:ie,user_ids:[F.uid],accepted_user_ids:[F.uid],owner_id:F.uid,owner_email:F.email||null};await vt(Ke(tt,"budgets",de),{name:ce.name,user_ids:ce.user_ids,accepted_user_ids:ce.accepted_user_ids,owner_id:ce.owner_id,owner_email:ce.owner_email,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:new Date().toISOString()});try{const De=Ke(tt,"users",F.uid),xe=await ht(De);if(xe.exists()){const Oe=xe.data();await vt(De,{...Oe,budget_ids:[de,...Oe.budget_ids],updated_at:new Date().toISOString()})}else await vt(De,{uid:F.uid,email:F.email||null,budget_ids:[de],created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}catch(De){console.warn("[BudgetContext] Could not update user doc:",De)}s(ce),x({}),k({}),M({}),q([]),Ce([F.uid]),Se([F.uid]),C([]),B(!1),b.current=F.uid}catch(de){throw console.error("[BudgetContext] Error creating new budget:",de),g(de instanceof Error?de.message:"Failed to create new budget"),de}finally{c(!1)}}async function Ve(le){if(!F||!n)return;if(n.owner_id!==F.uid)throw new Error("Only the budget owner can rename the budget");const ie=le.trim();if(!ie)throw new Error("Budget name cannot be empty");try{const de=Ke(tt,"budgets",n.id),ce=await ht(de);if(!ce.exists())throw new Error("Budget not found");const De=ce.data();await vt(de,{...De,name:ie}),s({...n,name:ie})}catch(de){throw console.error("[BudgetContext] Error renaming budget:",de),new Error(de instanceof Error?de.message:"Failed to rename budget")}}function Xe(le,ie,de){const ce=de.toString().padStart(2,"0");return`${le}_${ie}_${ce}`}async function gn(le,ie,de){let ce=ie,De=de-1;De<1&&(De=12,ce-=1);try{const xe=Xe(le,ce,De),Oe=Ke(tt,"months",xe),Be=await ht(Oe);return Be.exists()&&Be.data().total_income||0}catch(xe){return console.error("[BudgetContext] Error getting previous month income:",xe),0}}const Bt=A.useCallback(async(le,ie,de=!1)=>{if(!(!n||!F)){X(!0);try{const ce=Fn.MONTH(n.id,le,ie),De=`prev_income_${n.id}_${le}_${ie}`;if(!Zt.current&&!de){const Be=Bo(ce),Pe=Bo(De);if(Be&&Pe!==null){kt(!0),st(le),P(ie),Ie(Be),we(Pe),X(!1);return}}const[xe,Oe]=await Promise.all([$n(n.id,le,ie),gn(n.id,le,ie)]);kt(!1),Jn(ce,xe),Jn(De,Oe),st(le),P(ie),Ie(xe),we(Oe)}catch(ce){throw console.error("[BudgetContext] Error loading month:",ce),new Error(ce instanceof Error?ce.message:"Failed to load month")}finally{X(!1)}}},[n?.id,F?.uid]);async function Wr(){let le=Ue,ie=V-1;ie<1&&(ie=12,le-=1),await Bt(le,ie)}async function Xr(){let le=Ue,ie=V+1;ie>12&&(ie=1,le+=1),await Bt(le,ie)}async function ki(le){if(!n||!le.trim())return;const ie=le.trim();if(!ke.includes(ie))try{const de=Ke(tt,"payees",n.id),ce=[...ke,ie].sort((De,xe)=>De.toLowerCase().localeCompare(xe.toLowerCase()));await vt(de,{budget_id:n.id,payees:ce,updated_at:new Date().toISOString()}),Jn(Fn.PAYEES(n.id),ce),Qe(ce)}catch(de){console.warn("[BudgetContext] Error saving payee:",de)}}const zn=A.useCallback(async(le=!1)=>{if(!n){Qe([]);return}const ie=Fn.PAYEES(n.id);if(!Zt.current&&!le){const de=Bo(ie);if(de){Qe(de);return}}try{const de=Ke(tt,"payees",n.id),ce=await ht(de);if(ce.exists()){const xe=ce.data().payees||[];Jn(ie,xe),Qe(xe)}else Qe([])}catch(de){console.warn("[BudgetContext] Error loading payees:",de),Qe([])}},[n?.id]);function En(le){return le.map(ie=>{const de={id:ie.id,amount:ie.amount,account_id:ie.account_id,date:ie.date,created_at:ie.created_at};return ie.payee&&(de.payee=ie.payee),ie.description&&(de.description=ie.description),de})}const en=A.useRef(new Map);async function $n(le,ie,de){const ce=Xe(le,ie,de),De=en.current.get(ce);if(De)return De;const xe=(async()=>{const Oe=Ke(tt,"months",ce),Be=await ht(Oe);if(Be.exists()){const Pe=Be.data(),Ge=Pe.income||[];return{budget_id:Pe.budget_id,year:Pe.year,month:Pe.month,income:Ge,total_income:Pe.total_income??Ge.reduce((et,ft)=>et+(ft.amount||0),0),allocations:Pe.allocations||[],allocations_finalized:Pe.allocations_finalized||!1,created_at:Pe.created_at,updated_at:Pe.updated_at||Pe.created_at}}else{const Pe=new Date().toISOString(),Ge={budget_id:le,year:ie,month:de,income:[],total_income:0,allocations:[],allocations_finalized:!1,created_at:Pe,updated_at:Pe};return await vt(Oe,Ge),Ge}})();en.current.set(ce,xe);try{return await xe}finally{en.current.delete(ce)}}async function or(le,ie,de,ce,De){if(!n||!F)throw new Error("No budget loaded");try{const[xe,Oe]=de.split("-").map(Number),Be={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:le,account_id:ie,date:de,created_at:new Date().toISOString()};ce?.trim()&&(Be.payee=ce.trim()),De&&(Be.description=De);const Pe=await $n(n.id,xe,Oe),Ge=Xe(n.id,xe,Oe),et=Ke(tt,"months",Ge),ft=[...Pe.income,Be],_t=ft.reduce((Vn,Ft)=>Vn+Ft.amount,0),nn={budget_id:Pe.budget_id,year:Pe.year,month:Pe.month,income:En(ft),total_income:_t,updated_at:new Date().toISOString()};Pe.created_at&&(nn.created_at=Pe.created_at),await vt(et,nn);const Un={...Pe,income:ft,total_income:_t,updated_at:new Date().toISOString()};Jn(Fn.MONTH(n.id,xe,Oe),Un),$&&xe===Ue&&Oe===V&&Ie({...$,income:ft,total_income:_t}),ce?.trim()&&await ki(ce);const on=Ke(tt,"budgets",n.id),Nt=await ht(on);if(Nt.exists()){const Vn=Nt.data(),Ft=Vn.accounts||{},Ot=Ft[ie];if(Ot){const Wt={...Ft,[ie]:{...Ot,balance:Ot.balance+le}},dn=Md(Wt),xr={...Vn,accounts:dn};await vt(on,xr),Jn(Fn.BUDGET(n.id),xr),x(Wt)}else console.warn("[BudgetContext] addIncome - target account not found:",ie)}else console.error("[BudgetContext] addIncome - budget document not found")}catch(xe){throw console.error("[BudgetContext] Error adding income:",xe),new Error(xe instanceof Error?xe.message:"Failed to add income")}}async function lr(le,ie,de,ce,De,xe){if(!n||!F||!$)throw new Error("No budget or month loaded");try{const Oe=$.income.find(nn=>nn.id===le);if(!Oe)throw new Error("Income transaction not found");const[Be,Pe]=ce.split("-").map(Number),Ge=Be!==Ue||Pe!==V,et={id:Oe.id,amount:ie,account_id:de,date:ce,created_at:Oe.created_at};if(De?.trim()&&(et.payee=De.trim()),xe&&(et.description=xe),Ge){const nn=Xe(n.id,Ue,V),Un=Ke(tt,"months",nn),on=$.income.filter(Rt=>Rt.id!==le),Nt=on.reduce((Rt,Zr)=>Rt+Zr.amount,0),Vn={budget_id:$.budget_id,year:$.year,month:$.month,income:En(on),total_income:Nt,updated_at:new Date().toISOString()};$.created_at&&(Vn.created_at=$.created_at),await vt(Un,Vn),Ie({...$,income:on,total_income:Nt});const Ft=await $n(n.id,Be,Pe),Ot=Xe(n.id,Be,Pe),Wt=Ke(tt,"months",Ot),dn=[...Ft.income,et],xr=dn.reduce((Rt,Zr)=>Rt+Zr.amount,0),gs={budget_id:Ft.budget_id,year:Ft.year,month:Ft.month,income:En(dn),total_income:xr,updated_at:new Date().toISOString()};Ft.created_at&&(gs.created_at=Ft.created_at),await vt(Wt,gs)}else{const nn=Xe(n.id,Ue,V),Un=Ke(tt,"months",nn),on=$.income.map(Ft=>Ft.id===le?et:Ft),Nt=on.reduce((Ft,Ot)=>Ft+Ot.amount,0),Vn={budget_id:$.budget_id,year:$.year,month:$.month,income:En(on),total_income:Nt,updated_at:new Date().toISOString()};$.created_at&&(Vn.created_at=$.created_at),await vt(Un,Vn),Ie({...$,income:on,total_income:Nt})}De?.trim()&&await ki(De);const ft=ie!==Oe.amount,_t=Oe.account_id!==de;if(ft||_t){const nn=Ke(tt,"budgets",n.id),Un=await ht(nn);if(Un.exists()){const on=Un.data(),Nt={...on.accounts||{}};if(_t)Nt[Oe.account_id]&&(Nt[Oe.account_id]={...Nt[Oe.account_id],balance:Nt[Oe.account_id].balance-Oe.amount}),Nt[de]&&(Nt[de]={...Nt[de],balance:Nt[de].balance+ie});else if(ft){const Ot=ie-Oe.amount;Nt[de]&&(Nt[de]={...Nt[de],balance:Nt[de].balance+Ot})}const Vn=Md(Nt),Ft={...on,accounts:Vn};await vt(nn,Ft),Jn(Fn.BUDGET(n.id),Ft),x(Nt)}}}catch(Oe){throw console.error("[BudgetContext] Error updating income:",Oe),new Error(Oe instanceof Error?Oe.message:"Failed to update income")}}async function ge(le){if(!n||!F||!$)throw new Error("No budget or month loaded");try{const ie=$.income.find(Ge=>Ge.id===le);if(!ie)throw new Error("Income transaction not found");const de=Xe(n.id,Ue,V),ce=Ke(tt,"months",de),De=$.income.filter(Ge=>Ge.id!==le),xe=De.reduce((Ge,et)=>Ge+et.amount,0),Oe={budget_id:$.budget_id,year:$.year,month:$.month,income:En(De),total_income:xe,updated_at:new Date().toISOString()};$.created_at&&(Oe.created_at=$.created_at),await vt(ce,Oe),Ie({...$,income:De,total_income:xe});const Be=Ke(tt,"budgets",n.id),Pe=await ht(Be);if(Pe.exists()){const Ge=Pe.data(),et={...Ge.accounts||{}};et[ie.account_id]&&(et[ie.account_id]={...et[ie.account_id],balance:et[ie.account_id].balance-ie.amount});const ft=Md(et),_t={...Ge,accounts:ft};await vt(Be,_t),Jn(Fn.BUDGET(n.id),_t),x(et)}}catch(ie){throw console.error("[BudgetContext] Error deleting income:",ie),new Error(ie instanceof Error?ie.message:"Failed to delete income")}}async function Ne(){if(!n||!F||!$)throw new Error("No budget or month loaded");try{const le=$.income.reduce((De,xe)=>De+xe.amount,0),ie=Xe(n.id,Ue,V),de=Ke(tt,"months",ie),ce={budget_id:$.budget_id,year:$.year,month:$.month,income:En($.income),total_income:le,updated_at:new Date().toISOString()};$.created_at&&(ce.created_at=$.created_at),$.account_balances_start&&(ce.account_balances_start=$.account_balances_start),$.account_balances_end&&(ce.account_balances_end=$.account_balances_end),await vt(de,ce),Ie({...$,total_income:le})}catch(le){throw console.error("[BudgetContext] Error recomputing month totals:",le),new Error(le instanceof Error?le.message:"Failed to recompute month totals")}}async function $e(){if(!n||!F)throw new Error("No budget loaded");try{const le=Fa(Ys(tt,"months"),Ha("budget_id","==",n.id)),ie=await Qs(le),de=[];ie.forEach(ft=>{const _t=ft.data();de.push({budget_id:_t.budget_id,year:_t.year,month:_t.month,income:_t.income||[],total_income:_t.total_income||0,account_balances_start:_t.account_balances_start,account_balances_end:_t.account_balances_end,created_at:_t.created_at,updated_at:_t.updated_at})}),de.sort((ft,_t)=>ft.year!==_t.year?ft.year-_t.year:ft.month-_t.month);const ce=Ke(tt,"budgets",n.id),De=await ht(ce);if(!De.exists())throw new Error("Budget document not found");const xe=De.data(),Oe=xe.accounts||{},Be=Object.keys(Oe);let Pe={};Be.forEach(ft=>{Pe[ft]=0});for(const ft of de){const _t={...Pe},nn=ft.income.reduce((Ot,Wt)=>Ot+Wt.amount,0),Un={};for(const Ot of ft.income)Un[Ot.account_id]=(Un[Ot.account_id]||0)+Ot.amount;const on={};Be.forEach(Ot=>{on[Ot]=_t[Ot]+(Un[Ot]||0)}),Pe={...on};const Nt=Xe(n.id,ft.year,ft.month),Vn=Ke(tt,"months",Nt),Ft={budget_id:ft.budget_id,year:ft.year,month:ft.month,income:En(ft.income),total_income:nn,account_balances_start:_t,account_balances_end:on,updated_at:new Date().toISOString()};ft.created_at&&(Ft.created_at=ft.created_at),await vt(Vn,Ft),ft.year===Ue&&ft.month===V&&Ie({...ft,total_income:nn,account_balances_start:_t,account_balances_end:on})}const Ge={};Object.entries(Oe).forEach(([ft,_t])=>{Ge[ft]={..._t,balance:Pe[ft]||0}});const et=Md(Ge);await vt(ce,{...xe,accounts:et}),x(Ge),Ut(null)}catch(le){throw console.error("[BudgetContext] Error recomputing all balances:",le),new Error(le instanceof Error?le.message:"Failed to recompute all balances")}}async function We(){if(!n||!F)return null;try{const le=Fa(Ys(tt,"months"),Ha("budget_id","==",n.id)),ie=await Qs(le),de={};Object.keys(S).forEach(xe=>{de[xe]=0}),ie.forEach(xe=>{const Be=xe.data().income||[];for(const Pe of Be)de[Pe.account_id]=(de[Pe.account_id]||0)+Pe.amount});const ce={};Object.entries(S).forEach(([xe,Oe])=>{const Be=Oe.balance,Pe=de[xe]||0;Math.abs(Be-Pe)>.001&&(ce[xe]={stored:Be,calculated:Pe})});const De=Object.keys(ce).length>0;return Ut(De?ce:null),De?ce:null}catch(le){return console.error("[BudgetContext] Error checking balance mismatch:",le),null}}async function Pt(){await $e()}function pn(le){return le.map(ie=>({category_id:ie.category_id,amount:ie.amount}))}async function fi(le){if(!n||!F||!$)throw new Error("No budget or month loaded");try{const ie=Xe(n.id,Ue,V),de=Ke(tt,"months",ie),ce={budget_id:$.budget_id,year:$.year,month:$.month,income:En($.income),total_income:$.total_income,allocations:pn(le),allocations_finalized:$.allocations_finalized||!1,updated_at:new Date().toISOString()};$.created_at&&(ce.created_at=$.created_at),$.account_balances_start&&(ce.account_balances_start=$.account_balances_start),$.account_balances_end&&(ce.account_balances_end=$.account_balances_end),await vt(de,ce);const De={...$,allocations:le};Ie(De),Jn(Fn.MONTH(n.id,Ue,V),De),$.allocations_finalized&&await fs()}catch(ie){throw console.error("[BudgetContext] Error saving allocations:",ie),new Error(ie instanceof Error?ie.message:"Failed to save allocations")}}async function ya(){if(!n||!F||!$)throw new Error("No budget or month loaded");try{const le=Xe(n.id,Ue,V),ie=Ke(tt,"months",le),de={budget_id:$.budget_id,year:$.year,month:$.month,income:En($.income),total_income:$.total_income,allocations:pn($.allocations||[]),allocations_finalized:!0,updated_at:new Date().toISOString()};$.created_at&&(de.created_at=$.created_at),$.account_balances_start&&(de.account_balances_start=$.account_balances_start),$.account_balances_end&&(de.account_balances_end=$.account_balances_end),await vt(ie,de);const ce={...$,allocations_finalized:!0};Ie(ce),Jn(Fn.MONTH(n.id,Ue,V),ce),await fs()}catch(le){throw console.error("[BudgetContext] Error finalizing allocations:",le),new Error(le instanceof Error?le.message:"Failed to finalize allocations")}}async function Ni(){if(!n||!F||!$)throw new Error("No budget or month loaded");try{const le=Xe(n.id,Ue,V),ie=Ke(tt,"months",le),de={budget_id:$.budget_id,year:$.year,month:$.month,income:En($.income),total_income:$.total_income,allocations:pn($.allocations||[]),allocations_finalized:!1,updated_at:new Date().toISOString()};$.created_at&&(de.created_at=$.created_at),$.account_balances_start&&(de.account_balances_start=$.account_balances_start),$.account_balances_end&&(de.account_balances_end=$.account_balances_end),await vt(ie,de);const ce={...$,allocations_finalized:!1};Ie(ce),Jn(Fn.MONTH(n.id,Ue,V),ce),await fs()}catch(le){throw console.error("[BudgetContext] Error unfinalizing allocations:",le),new Error(le instanceof Error?le.message:"Failed to unfinalize allocations")}}const Jr=A.useCallback(async()=>{if(!n)return{};const le={};return Object.entries(O).forEach(([ie,de])=>{le[ie]=de.balance}),le},[n?.id,O]);async function fs(){if(!n)return{};try{const le=Fa(Ys(tt,"months"),Ha("budget_id","==",n.id)),ie=await Qs(le),de={};Object.keys(O).forEach(Be=>{de[Be]=0}),ie.forEach(Be=>{const Pe=Be.data();if(Pe.allocations_finalized&&Pe.allocations)for(const Ge of Pe.allocations)de[Ge.category_id]=(de[Ge.category_id]||0)+Ge.amount});const ce={};Object.entries(O).forEach(([Be,Pe])=>{ce[Be]={...Pe,balance:de[Be]??0}});const De=Ke(tt,"budgets",n.id);await vt(De,{categories:ce},{merge:!0}),M(ce);const xe=Fn.BUDGET(n.id),Oe=Bo(xe);return Oe&&Jn(xe,{...Oe,categories:ce}),de}catch(le){return console.error("[BudgetContext] Error recalculating category balances:",le),{}}}function Sr(){return Object.entries(S).filter(([le,ie])=>{const de=ie.account_group_id?D[ie.account_group_id]:void 0,ce=de?.on_budget!==void 0?de.on_budget:ie.on_budget!==!1,De=de?.is_active!==void 0?de.is_active:ie.is_active!==!1;return ce&&De}).reduce((le,[ie,de])=>le+de.balance,0)}const Tr=A.useCallback(async()=>ne,[ne]),yn=!!(n&&F&&n.owner_id===F.uid),Cn=R.length>0;async function kr(){if(F){console.log("[BudgetContext] Force refreshing from Firebase..."),Zt.current=!0;try{n&&QO(n.id),YO(Fn.USER_DOC(F.uid)),b.current=null,y(!1),await K(),n&&$&&(await Bt(Ue,V,!0),await zn(!0)),JO(),Jt(Date.now()),fe(),console.log("[BudgetContext] Force refresh complete")}finally{Zt.current=!1}}}function ms(){KO(),Jt(null),fe(),console.log("[BudgetContext] Cache cleared")}return f.jsx(sx.Provider,{value:{currentBudget:n,loading:o,error:d,isOwner:yn,isAdmin:j,isTest:dt,currentUserId:F?.uid||null,isInitialized:p,accounts:S,accountGroups:D,categories:O,categoryGroups:G,budgetUserIds:ee,acceptedUserIds:Me,pendingInvites:R,hasPendingInvites:Cn,needsFirstBudget:N,accessibleBudgets:I,currentMonth:$,currentYear:Ue,currentMonthNumber:V,monthLoading:Q,previousMonthIncome:ne,payees:ke,lastRefreshTime:bn,cacheStats:Nn,isUsingCache:Gn,ensureBudgetLoaded:ue,refreshBudget:K,forceRefreshFromFirebase:kr,clearCache:ms,inviteUserToBudget:Ae,revokeUserFromBudget:pe,checkBudgetInvite:ve,acceptBudgetInvite:Te,loadAccessibleBudgets:Re,switchToBudget:at,createNewBudget:St,renameBudget:Ve,setAccounts:x,setAccountGroups:k,setCategories:M,setCategoryGroups:q,saveBudgetData:Le,loadMonth:Bt,goToPreviousMonth:Wr,goToNextMonth:Xr,addIncome:or,updateIncome:lr,deleteIncome:ge,recomputeMonthTotals:Ne,recomputeAllBalances:$e,checkBalanceMismatch:We,reconcileBalances:Pt,balanceMismatch:lt,loadPayees:zn,saveAllocations:fi,finalizeAllocations:ya,unfinalizeAllocations:Ni,getCategoryBalances:Jr,getOnBudgetTotal:Sr,getPreviousMonthIncome:Tr},children:i})}function hs(){return A.useContext(sx)}function tj(){return f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("h1",{children:"Welcome"}),f.jsx("nav",{children:f.jsxs("ul",{children:[f.jsx("li",{children:f.jsx(hn,{to:"/sql-test",children:"SQL Test"})}),f.jsx("li",{children:f.jsx(hn,{to:"/budget",children:"Budget"})}),f.jsx("li",{children:f.jsx(hn,{to:"/account",children:"Account"})})]})})]})}function nj(){return f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("nav",{children:f.jsx(hn,{to:"/",children:" Back to Home"})}),f.jsx("h1",{children:"SQL Test"}),f.jsx("h2",{children:"Setup"}),f.jsxs("h3",{children:["1. Open up your preferred web browser to ",f.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),f.jsxs("ul",{children:[f.jsx("li",{children:"This is a basic online sql query editor"}),f.jsxs("li",{children:["It will include three tables: ",f.jsx("b",{children:'"Customer"'}),", ",f.jsx("b",{children:'"Orders"'}),", and ",f.jsx("b",{children:'"Shippings"'})]})]}),f.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),f.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:f.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),f.jsx("h2",{children:"SQL Problems"}),f.jsx("p",{children:"Write queries in the online editor to answer these questions."}),f.jsx("h3",{children:"Question #1"}),f.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),f.jsx("h3",{children:"Question #2"}),f.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function rj(){const i=A.useContext(qc),e=ru(),[n,s]=A.useState(!1),o=Kr(),c=Hg(),d=o.state?.from||"/";A.useEffect(()=>{i.is_logged_in&&d!=="/"&&c(d,{replace:!0})},[i.is_logged_in,d,c]);function g(){s(!0),e.logout_firebase_user().then(function(){s(!1)})}return f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("h1",{children:"Account"}),i.is_logged_in?n?f.jsx("p",{children:"Logging Out..."}):f.jsxs(f.Fragment,{children:[f.jsxs("p",{children:["You are logged in as ",i.username]}),f.jsx("button",{onClick:g,style:{marginTop:"1rem"},children:"Logout"})]}):f.jsx(ij,{}),f.jsx("p",{children:f.jsx(hn,{to:"/",children:"Back to Home"})})]})}function ij(){const i=ru(),[e,n]=A.useState(""),[s,o]=A.useState(""),[c,d]=A.useState(!1),[g,p]=A.useState("");function y(x){n(x.target.value)}function b(x){o(x.target.value)}function S(x){x.preventDefault(),d(!0),p(""),i.login_firebase_user(e,s).then(function(){}).catch(function(){p("Incorrect login credentials")}).finally(function(){d(!1)})}return f.jsxs("form",{onSubmit:S,children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"username",children:"Email: "}),f.jsx("input",{id:"username",type:"email",value:e,onChange:y})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",children:"Password: "}),f.jsx("input",{id:"password",type:"password",value:s,onChange:b})]}),c?f.jsx("p",{children:"Logging in..."}):f.jsx("button",{children:"Login"}),g&&f.jsx("p",{style:{color:"red"},children:g})]})}const Ee={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15"},sj={maxWidth:"60rem",margin:"0 auto",padding:"2rem"},og={marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},iu={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},aj={...iu,padding:"0.6rem 0.875rem",gap:"0.5rem"},oj={background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1rem 1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},lj={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},cj={display:"flex",flexDirection:"column",gap:"0.5rem"},uj={fontSize:"0.9rem",fontWeight:500},su={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit"},dj={...su,cursor:"pointer"},zp={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},ax={...zp,background:Ee.primary,color:"white",border:"none"},hj={...ax,padding:"0.75rem 1.5rem",borderRadius:"8px"},fj={...zp,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},mj={...zp,background:"transparent",border:`1px solid ${Ee.errorBorder}`,color:Ee.error},gj={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},pj={display:"flex",gap:"0.5rem"},yj={display:"flex",gap:"0.25rem"},ox={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},_j={...ox,borderColor:Ee.errorBorder,color:Ee.error},ul={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},Up={display:"flex",flexDirection:"column",gap:"2px"},vj={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},lx={opacity:.4,cursor:"grab"},cx={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:Ee.primary,borderRadius:"2px",transition:"opacity 0.15s"},bj={position:"relative",height:"2rem",marginTop:"-0.25rem"},Ej={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:Ee.primary,borderRadius:"2px",transition:"opacity 0.15s"},Sj={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},Tj={background:Ee.errorBg,border:`1px solid ${Ee.errorBorder}`,color:Ee.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},xj={background:"transparent",border:"none",color:Ee.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},qh={opacity:.7,marginBottom:"1.5rem"},dl={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},gh={fontWeight:500,fontSize:"1.1rem"},Wa={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function lg({children:i}){return f.jsx("div",{style:sj,children:i})}function au({message:i,children:e,onDismiss:n,style:s}){return f.jsxs("div",{style:{...Tj,...s},children:[f.jsx("span",{children:e??i}),n&&f.jsx("button",{onClick:n,style:xj,children:""})]})}const wj={primary:ax,"primary-large":hj,secondary:fj,danger:mj,small:gj};function pt({variant:i="primary",isLoading:e,loadingText:n="Saving...",children:s,disabled:o,style:c,...d}){const g=wj[i],p=o||e;return f.jsx("button",{disabled:p,style:{...g,cursor:p?"not-allowed":"pointer",opacity:p?.7:1,...c},...d,children:e?n:s})}function wl({children:i,onSubmit:e}){return f.jsx("form",{onSubmit:e,style:lj,children:i})}function Er({label:i,htmlFor:e,children:n,hint:s}){return f.jsxs("div",{style:cj,children:[f.jsx("label",{htmlFor:e,style:uj,children:i}),n,s&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:s})]})}function Xa(i){return f.jsx("input",{style:su,...i})}function Bc({children:i,...e}){return f.jsx("select",{style:dj,...e,children:i})}function Bp({minHeight:i="6rem",style:e,...n}){return f.jsx("textarea",{style:{...su,width:"100%",minHeight:i,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function no({children:i}){return f.jsx("div",{style:vj,children:i})}function cg(i){const n=i.replace(/[^\d.]/g,"").split("."),s=n[0]||"",o=n[1],c=s.replace(/\B(?=(\d{3})+(?!\d))/g,",");return o!==void 0?`$${c}.${o.slice(0,2)}`:c?`$${c}`:""}function Aj(i){return i.replace(/[$,]/g,"")}function ux({id:i,value:e,onChange:n,placeholder:s="$0.00",required:o,autoFocus:c}){const[d,g]=A.useState(()=>cg(e)),p=A.useRef(null);A.useEffect(()=>{const b=cg(e);Aj(d)!==e&&g(b)},[e]);function y(b){const S=b.target.value;if(!S||S==="$"){g(""),n("");return}const D=S.replace(/[^\d.]/g,"").split(".");let k=D[0];D.length>1&&(k+="."+D.slice(1).join("").slice(0,2));const O=cg(k);g(O),n(k)}return f.jsx("input",{ref:p,id:i,type:"text",inputMode:"decimal",value:d,onChange:y,placeholder:s,required:o,autoFocus:c,style:su})}function Cj(i,e){const n=i.toLowerCase(),s=e.toLowerCase();if(s.includes(n)){const g=s.indexOf(n);return{match:!0,score:g===0||/\s/.test(s[g-1])?100:90}}let o=0,c=0,d=0;for(let g=0;g<s.length&&o<n.length;g++)s[g]===n[o]?(o++,d++,c+=d*2):d=0;return o===n.length?{match:!0,score:c}:{match:!1,score:0}}function Rj({id:i,value:e,onChange:n,payees:s,placeholder:o="Enter payee name"}){const[c,d]=A.useState(!1),[g,p]=A.useState(-1),y=A.useRef(null),b=A.useRef(null),S=e.trim()?s.map(k=>({payee:k,...Cj(e,k)})).filter(k=>k.match).sort((k,O)=>O.score-k.score).slice(0,8).map(k=>k.payee):[];A.useEffect(()=>{function k(O){y.current&&!y.current.contains(O.target)&&d(!1)}return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]);function x(k){!c||S.length===0||(k.key==="ArrowDown"?(k.preventDefault(),p(O=>Math.min(O+1,S.length-1))):k.key==="ArrowUp"?(k.preventDefault(),p(O=>Math.max(O-1,-1))):k.key==="Enter"&&g>=0?(k.preventDefault(),n(S[g]),d(!1),p(-1)):k.key==="Escape"&&(d(!1),p(-1)))}function D(k){n(k),d(!1),p(-1),b.current?.focus()}return f.jsxs("div",{ref:y,style:{position:"relative"},children:[f.jsx("input",{ref:b,id:i,type:"text",value:e,onChange:k=>{n(k.target.value),d(!0),p(-1)},onFocus:()=>d(!0),onKeyDown:x,placeholder:o,autoComplete:"off",style:su}),c&&S.length>0&&f.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:S.map((k,O)=>f.jsx("div",{onClick:()=>D(k),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:O===g?`color-mix(in srgb, ${Ee.primary} 20%, transparent)`:"transparent",borderBottom:O<S.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>p(O),children:k},k))})]})}const Ij=640;function Gh(i=Ij){const[e,n]=A.useState(()=>typeof window>"u"?!1:window.innerWidth<i);return A.useEffect(()=>{function s(){n(window.innerWidth<i)}return window.addEventListener("resize",s),s(),()=>window.removeEventListener("resize",s)},[i]),e}function ph({children:i,isDragging:e,isDragOver:n,onDragStart:s,onDragOver:o,onDragLeave:c,onDragEnd:d,onDrop:g,onEdit:p,onDelete:y,onMoveUp:b,onMoveDown:S,canMoveUp:x=!0,canMoveDown:D=!0}){const k=Gh(),O=b||S;return f.jsxs("div",{onDragOver:M=>{M.stopPropagation(),o(M)},onDragLeave:M=>{M.stopPropagation(),c()},onDrop:M=>{M.stopPropagation(),g(M)},style:{position:"relative"},children:[f.jsx("div",{style:{...cx,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),f.jsxs("div",{style:{...k?aj:iu,opacity:e?.5:1},children:[f.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:k?"0.5rem":"0.75rem",minWidth:0},children:[f.jsx("span",{draggable:!0,onDragStart:s,onDragEnd:d,style:{...lx,fontSize:k?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),f.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:i})]}),f.jsxs("div",{style:k?yj:pj,children:[k?f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:p,style:ox,title:"Edit","aria-label":"Edit",children:""}),f.jsx("button",{onClick:y,style:_j,title:"Delete","aria-label":"Delete",children:""})]}):f.jsxs(f.Fragment,{children:[f.jsx(pt,{variant:"secondary",onClick:p,children:"Edit"}),f.jsx(pt,{variant:"danger",onClick:y,children:"Delete"})]}),O&&f.jsxs("div",{style:Up,children:[f.jsx("button",{onClick:M=>{M.stopPropagation(),b?.()},disabled:!x,style:{...ul,opacity:x?.6:.2,cursor:x?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),f.jsx("button",{onClick:M=>{M.stopPropagation(),S?.()},disabled:!D,style:{...ul,opacity:D?.6:.2,cursor:D?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function Fp({isActive:i,onDragOver:e,onDragLeave:n,onDrop:s,label:o="Move to end"}){return f.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:s,style:bj,children:[f.jsx("div",{style:{...Ej,opacity:i?1:.3,boxShadow:i?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),i&&f.jsx("span",{style:Sj,children:o})]})}function es({children:i,style:e}){return f.jsx("div",{style:{...oj,...e},children:i})}function Kt(i){return`$${i.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function Yr(i){return i>=0?Ee.success:Ee.danger}function yh({isOpen:i,onClose:e,title:n,children:s,maxWidth:o="28rem"}){return i?f.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:e,children:f.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:"100%",maxWidth:o,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:c=>c.stopPropagation(),children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[f.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),f.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),s]})}):null}const Dj={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function Oj(){const[i,e]=A.useState(!1),[n,s]=A.useState(""),[o,c]=A.useState("bug"),[d,g]=A.useState(!1),[p,y]=A.useState(!1),[b,S]=A.useState(null),x=A.useContext(qc),D=Kr(),k=eo(ga);if(D.pathname.includes("/admin/feedback")||!x.is_logged_in)return null;async function M(G){if(G.preventDefault(),!(!n.trim()||!x.username)){g(!0),S(null);try{const q=x.username.replace(/[.@]/g,"_"),ee=Ke(k,"feedback",q),Ce={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:n.trim(),created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:o};(await ht(ee)).exists()?await vt(ee,{items:xT(Ce)},{merge:!0}):await vt(ee,{user_email:x.username,items:[Ce]}),s(""),c("bug"),y(!0),setTimeout(()=>{y(!1),e(!1)},1500)}catch(q){S(q instanceof Error?q.message:"Failed to submit feedback")}finally{g(!1)}}}return f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:()=>e(!0),style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:Ee.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:G=>{G.currentTarget.style.transform="scale(1.1)",G.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:G=>{G.currentTarget.style.transform="scale(1)",G.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),f.jsx(yh,{isOpen:i,onClose:()=>{e(!1),c("bug")},title:"Send Feedback",children:p?f.jsxs("div",{style:{textAlign:"center",padding:"2rem 0",color:Ee.success},children:[f.jsx("span",{style:{fontSize:"2rem",display:"block",marginBottom:"0.5rem"},children:""}),"Feedback submitted!"]}):f.jsxs("form",{onSubmit:M,children:[f.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(G=>{const q=Dj[G],ee=o===G;return f.jsxs("button",{type:"button",onClick:()=>c(G),style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${q.color}`,borderRadius:"0.5rem",background:ee?q.bgColor:"transparent",color:ee?q.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:ee?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:ee?1:.5,boxShadow:ee?`0 0 12px ${q.bgColor}`:"none",position:"relative"},children:[q.label,ee&&f.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},G)})}),f.jsx(Bp,{value:n,onChange:G=>s(G.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),b&&f.jsx("p",{style:{color:Ee.error,fontSize:"0.85rem",margin:"0.5rem 0"},children:b}),f.jsxs(no,{children:[f.jsx(pt,{type:"button",variant:"secondary",onClick:()=>{e(!1),c("bug")},children:"Cancel"}),f.jsx(pt,{type:"submit",isLoading:d,disabled:!n.trim(),children:"Submit"})]})]})})]})}function Fo({children:i,labelStyle:e,...n}){return f.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[f.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:Ee.primary},...n}),i]})}function jj({title:i,count:e,children:n,defaultExpanded:s=!1}){const[o,c]=A.useState(s);return f.jsxs("div",{style:{marginTop:"2rem"},children:[f.jsxs("button",{onClick:()=>c(!o),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[f.jsx("span",{style:{transition:"transform 0.2s",transform:o?"rotate(90deg)":"rotate(0deg)"},children:""}),i,e!==void 0&&` (${e})`]}),o&&n]})}function Pg(i){return new Date(i).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}const tE=["January","February","March","April","May","June","July","August","September","October","November","December"];function Mj(){const{currentBudget:i,isOwner:e,hasPendingInvites:n,pendingInvites:s,needsFirstBudget:o,acceptBudgetInvite:c,createNewBudget:d,accounts:g,accountGroups:p,categories:y,categoryGroups:b,currentMonth:S,currentYear:x,currentMonthNumber:D,monthLoading:k,loadMonth:O,goToPreviousMonth:M,goToNextMonth:G,addIncome:q,updateIncome:ee,deleteIncome:Ce,recomputeMonthTotals:Me,payees:Se,loadPayees:R,saveAllocations:C,finalizeAllocations:I,getOnBudgetTotal:L,previousMonthIncome:N}=hs(),B=Gh(),[j,Fe]=A.useState(null),[dt,se]=A.useState(!1),[$,Ie]=A.useState(null),[Ue,st]=A.useState(!1),[V,P]=A.useState(!1),[Q,X]=A.useState(!1),[ne,we]=A.useState(null),ke=A.useRef(null);A.useEffect(()=>{if(!V)return;function ge(Ne){ke.current&&!ke.current.contains(Ne.target)&&P(!1)}return document.addEventListener("mousedown",ge),()=>document.removeEventListener("mousedown",ge)},[V]);const[Qe,lt]=A.useState(()=>{const ge=localStorage.getItem("budget_active_tab");return ge==="income"||ge==="allocations"?ge:"income"});A.useEffect(()=>{localStorage.setItem("budget_active_tab",Qe)},[Qe]);const[Ut,bn]=A.useState({}),[Jt,Nn]=A.useState(!1),[mn,Gn]=A.useState(!1),[kt,Zt]=A.useState(!1),tt=A.useMemo(()=>Object.values(y).reduce((ge,Ne)=>ge+Ne.balance,0),[y]);A.useEffect(()=>{i&&!S&&!k&&O(x,D).catch(ge=>{Fe(ge instanceof Error?ge.message:"Failed to load month")})},[i,S,k,x,D,O]),A.useEffect(()=>{i&&R().catch(ge=>{console.warn("Failed to load payees:",ge)})},[i,R]),A.useEffect(()=>{if(!S)return;const ge={};Object.entries(y).forEach(([Ne,$e])=>{if($e.default_monthly_type==="percentage")return;const We=S.allocations?.find(Pt=>Pt.category_id===Ne);We?ge[Ne]=We.amount.toString():$e.default_monthly_amount!==void 0&&$e.default_monthly_amount>0?ge[Ne]=$e.default_monthly_amount.toString():ge[Ne]=""}),bn(ge)},[S?.year,S?.month,y]);function F(ge){const Ne=ge.account_group_id?p[ge.account_group_id]:void 0;return Ne?.is_active!==void 0?Ne.is_active:ge.is_active!==!1}function fe(ge){const Ne=ge.account_group_id?p[ge.account_group_id]:void 0;return Ne?.on_budget!==void 0?Ne.on_budget:ge.on_budget!==!1}const z=Object.entries(g).filter(([ge,Ne])=>F(Ne)&&fe(Ne)),K=z.filter(([ge,Ne])=>Ne.is_income_account),te=K.length>0?K:z,ue=z.find(([ge,Ne])=>Ne.is_income_default),Ae=ue?ue[0]:void 0;if(!i&&n)return f.jsxs(lg,{children:[f.jsx("nav",{style:og,children:f.jsx(hn,{to:"/",children:" Back to Home"})}),f.jsx(Vj,{invites:s,onAccept:c,onCreateNew:d})]});if(!i&&o)return f.jsxs(lg,{children:[f.jsx("nav",{style:og,children:f.jsx(hn,{to:"/",children:" Back to Home"})}),f.jsx(Nj,{onCreateNew:d})]});async function pe(){Fe(null),Zt(!1);try{await M()}catch(ge){Fe(ge instanceof Error?ge.message:"Failed to navigate")}}async function ve(){Fe(null),Zt(!1);try{await G()}catch(ge){Fe(ge instanceof Error?ge.message:"Failed to navigate")}}function Te(ge,Ne,$e,We,Pt){Fe(null),se(!1),q(ge,Ne,$e,We,Pt).catch(pn=>{Fe(pn instanceof Error?pn.message:"Failed to add income")})}function Le(ge,Ne,$e,We,Pt,pn){Fe(null),Ie(null),ee(ge,Ne,$e,We,Pt,pn).catch(fi=>{Fe(fi instanceof Error?fi.message:"Failed to update income")})}async function Re(){Fe(null),st(!0),X(!0),we({status:"pending"});try{await new Promise(We=>setTimeout(We,300));const ge=S?.income.length||0,Ne=S?.total_income||0;we({status:"counting",incomeCount:ge,oldTotal:Ne}),await new Promise(We=>setTimeout(We,300));const $e=S?.income.reduce((We,Pt)=>We+Pt.amount,0)||0;we({status:"calculating",incomeCount:ge,oldTotal:Ne,newTotal:$e}),await new Promise(We=>setTimeout(We,200)),we({status:"saving",incomeCount:ge,oldTotal:Ne,newTotal:$e}),await Me(),we({status:"done",incomeCount:ge,oldTotal:Ne,newTotal:$e})}catch(ge){we({status:"error",error:ge instanceof Error?ge.message:"Failed to recompute totals"})}finally{st(!1)}}function at(ge){confirm("Are you sure you want to delete this income entry?")&&(Fe(null),Ce(ge).catch(Ne=>{Fe(Ne instanceof Error?Ne.message:"Failed to delete income")}))}const St=S?.income.reduce((ge,Ne)=>ge+Ne.amount,0)||0;function Ve(ge,Ne){if(Ne.default_monthly_type==="percentage"&&Ne.default_monthly_amount!==void 0)return Ne.default_monthly_amount/100*N;const $e=Ut[ge],We=parseFloat($e||"0");return isNaN(We)?0:We}const Xe=A.useMemo(()=>Object.entries(y).reduce((ge,[Ne,$e])=>{if($e.default_monthly_type==="percentage"&&$e.default_monthly_amount!==void 0)return ge+$e.default_monthly_amount/100*N;const We=Ut[Ne],Pt=parseFloat(We||"0");return ge+(isNaN(Pt)?0:Pt)},0),[y,Ut,N]),gn=L(),Bt=S?.allocations_finalized?(S.allocations||[]).reduce((ge,Ne)=>ge+Ne.amount,0):0,Wr=gn-tt,Xr=A.useMemo(()=>Wr-Xe+Bt,[Wr,Xe,Bt]),ki=[...b].sort((ge,Ne)=>ge.sort_order-Ne.sort_order),zn=Object.entries(y).reduce((ge,[Ne,$e])=>{const We=$e.category_group_id||"ungrouped";return ge[We]||(ge[We]=[]),ge[We].push([Ne,$e]),ge},{});Object.keys(zn).forEach(ge=>{zn[ge].sort((Ne,$e)=>Ne[1].sort_order-$e[1].sort_order)});function En(ge,Ne){bn($e=>({...$e,[ge]:Ne}))}function en(){if(!S)return;const ge={};Object.entries(y).forEach(([Ne,$e])=>{if($e.default_monthly_type==="percentage")return;const We=S.allocations?.find(Pt=>Pt.category_id===Ne);We?ge[Ne]=We.amount.toString():$e.default_monthly_amount!==void 0&&$e.default_monthly_amount>0?ge[Ne]=$e.default_monthly_amount.toString():ge[Ne]=""}),bn(ge),Zt(!1)}function $n(){const ge=[];return Object.entries(y).forEach(([Ne,$e])=>{const We=Ve(Ne,$e);We>0&&ge.push({category_id:Ne,amount:We})}),ge}async function or(){Fe(null),Nn(!0);try{await C($n()),Zt(!1)}catch(ge){Fe(ge instanceof Error?ge.message:"Failed to save allocations")}finally{Nn(!1)}}async function lr(){Fe(null),Gn(!0);try{await C($n()),await I()}catch(ge){Fe(ge instanceof Error?ge.message:"Failed to finalize allocations")}finally{Gn(!1)}}return f.jsxs(lg,{children:[f.jsxs("nav",{style:og,children:[f.jsx(hn,{to:"/",children:" Back to Home"}),f.jsx(hn,{to:"/budget/admin",style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 8%, transparent)",textDecoration:"none",fontSize:"1.25rem",transition:"background 0.15s"},title:e?"Admin Settings":"Budget Settings",children:""})]}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[f.jsx("h1",{style:{margin:0},children:"Budget"}),i&&f.jsx("span",{style:{background:`color-mix(in srgb, ${Ee.primary} 15%, transparent)`,color:Ee.primaryLight,padding:"0.25rem 0.75rem",borderRadius:"6px",fontSize:"0.85rem",fontWeight:500},children:i.name})]}),i&&f.jsxs("p",{style:{opacity:.6,fontSize:"0.85rem",marginBottom:"1.5rem"},children:[i.user_ids.length," user",i.user_ids.length!==1?"s":""," ",e?" You are the owner":" Shared with you"]}),j&&f.jsx(au,{message:j,onDismiss:()=>Fe(null)}),f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[f.jsx("button",{onClick:pe,disabled:k,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:k?"not-allowed":"pointer",fontSize:"1.25rem",opacity:k?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Previous month",children:""}),f.jsxs("div",{ref:ke,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[f.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[tE[D-1]," ",x]}),f.jsx("button",{onClick:()=>P(!V),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:V?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),k&&f.jsxs(f.Fragment,{children:[f.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[f.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:Ee.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),f.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),V&&f.jsx("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"140px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:f.jsxs("button",{onClick:()=>{Re(),P(!1)},disabled:Ue||k,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:Ue||k?"not-allowed":"pointer",fontSize:"0.85rem",color:"inherit",opacity:Ue||k?.5:1,textAlign:"left",transition:"background 0.15s"},title:"Recompute totals from income transactions",children:[Ue?"":""," Recompute"]})})]}),f.jsx("button",{onClick:ve,disabled:k,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:k?"not-allowed":"pointer",fontSize:"1.25rem",opacity:k?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Next month",children:""})]}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem"},children:[f.jsx("button",{onClick:()=>lt("income"),style:{flex:1,padding:"0.75rem 1rem",borderRadius:"8px",border:Qe==="income"?`2px solid ${Ee.primary}`:"2px solid transparent",background:Qe==="income"?`color-mix(in srgb, ${Ee.primary} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",cursor:"pointer",fontWeight:Qe==="income"?600:400,fontSize:"0.95rem",color:"inherit",transition:"all 0.15s"},children:" Income"}),f.jsxs("button",{onClick:()=>lt("allocations"),style:{flex:1,padding:"0.75rem 1rem",borderRadius:"8px",border:Qe==="allocations"?`2px solid ${Ee.primary}`:"2px solid transparent",background:Qe==="allocations"?`color-mix(in srgb, ${Ee.primary} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",cursor:"pointer",fontWeight:Qe==="allocations"?600:400,fontSize:"0.95rem",color:"inherit",transition:"all 0.15s"},children:[" Allocations",S?.allocations_finalized&&f.jsx("span",{style:{marginLeft:"0.5rem",fontSize:"0.7rem",background:Ee.success,color:"white",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:"Applied"})]})]}),Qe==="income"&&f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:k?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:k?"none":"auto"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:B?"column":"row",justifyContent:"space-between",alignItems:B?"stretch":"center",gap:B?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("div",{children:[f.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:"Total"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.25rem",fontWeight:600,color:Yr(St)},children:Kt(St)})]}),!dt&&f.jsx(pt,{onClick:()=>se(!0),disabled:te.length===0,children:"+ Add Income"})]}),te.length===0&&f.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(g).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",f.jsx(hn,{to:"/budget/accounts",style:{color:Ee.primaryLight},children:"Manage accounts "})]}),dt&&f.jsx("div",{style:{marginBottom:"1rem"},children:f.jsx(rE,{accounts:te,accountGroups:p,payees:Se,defaultAccountId:Ae,defaultDate:`${x}-${String(D).padStart(2,"0")}-01`,onSubmit:(ge,Ne,$e,We,Pt)=>Te(ge,Ne,$e,We,Pt),onCancel:()=>se(!1),submitLabel:"Add Income",isMobile:B})}),f.jsxs("div",{style:Wa,children:[S?.income.slice().sort((ge,Ne)=>{const $e=ge.date||"",We=Ne.date||"";return $e.localeCompare(We)}).map(ge=>$===ge.id?f.jsx(rE,{accounts:te,accountGroups:p,payees:Se,initialData:ge,onSubmit:(Ne,$e,We,Pt,pn)=>Le(ge.id,Ne,$e,We,Pt,pn),onCancel:()=>Ie(null),onDelete:()=>at(ge.id),submitLabel:"Save",isMobile:B},ge.id):f.jsx(kj,{income:ge,accountName:g[ge.account_id]?.nickname||"Unknown Account",accountGroupName:g[ge.account_id]?.account_group_id?p[g[ge.account_id].account_group_id]?.name:void 0,onEdit:()=>Ie(ge.id),onDelete:()=>at(ge.id),isMobile:B},ge.id)),(!S?.income||S.income.length===0)&&!dt&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1rem"},children:"No income recorded for this month"})]})]}),Qe==="allocations"&&f.jsxs("div",{style:{opacity:k?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:k?"none":"auto"},children:[f.jsxs("div",{style:{display:"grid",gridTemplateColumns:B?"1fr 1fr":"repeat(4, 1fr)",gap:"1rem",marginBottom:"1.5rem"},children:[f.jsxs(es,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"On-Budget Total"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:Yr(gn)},children:Kt(gn)})]}),f.jsxs(es,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"Available Now"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:Yr(Wr)},children:Kt(Wr)}),f.jsx("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.7rem",opacity:.5},children:"(applied allocations only)"})]}),f.jsxs(es,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"This Month's Draft"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:Ee.primary},children:Kt(Xe)})]}),f.jsxs(es,{children:[f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.7},children:"After Apply"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.3rem",fontWeight:600,color:Yr(Xr)},children:Kt(Xr)}),f.jsx("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.7rem",opacity:.5},children:"(if you apply draft)"})]})]}),Object.values(y).some(ge=>ge.default_monthly_type==="percentage")&&f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.6rem 1rem",marginBottom:"1rem",fontSize:"0.85rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{style:{opacity:.6},children:""}),f.jsxs("span",{style:{opacity:.7},children:["Percentage allocations based on prev month income: ",f.jsx("strong",{style:{color:Ee.primary},children:Kt(N)})]})]}),f.jsxs("div",{style:{background:S?.allocations_finalized?kt?`color-mix(in srgb, ${Ee.primary} 12%, transparent)`:`color-mix(in srgb, ${Ee.success} 12%, transparent)`:`color-mix(in srgb, ${Ee.warning} 12%, transparent)`,border:`1px solid ${S?.allocations_finalized?kt?Ee.primary:Ee.success:Ee.warning}`,borderRadius:"8px",padding:"0.75rem 1rem",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.75rem"},children:[f.jsxs("div",{children:[f.jsx("p",{style:{margin:0,fontWeight:600,color:S?.allocations_finalized?kt?Ee.primary:Ee.success:Ee.warning},children:S?.allocations_finalized?kt?" Editing Applied Allocations":" Allocations Applied":" Allocations Not Applied"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:S?.allocations_finalized?kt?"Make changes and save, or cancel to revert.":"Click Edit to make changes to allocations.":"Save and apply to update category balances."})]}),f.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:S?.allocations_finalized?kt?f.jsxs(f.Fragment,{children:[f.jsx(pt,{onClick:en,disabled:Jt||k,variant:"secondary",children:"Cancel"}),f.jsx(pt,{onClick:or,disabled:Jt||k,children:Jt?" Saving...":" Save Changes"})]}):f.jsx(pt,{onClick:()=>Zt(!0),disabled:k,variant:"secondary",children:" Edit Allocations"}):f.jsxs(f.Fragment,{children:[f.jsx(pt,{onClick:or,disabled:Jt||k,variant:"secondary",children:Jt?" Saving...":" Save Draft"}),f.jsx(pt,{onClick:lr,disabled:mn||k,children:mn?" Applying...":" Save & Apply"})]})})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(y).length===0&&f.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",f.jsx(hn,{to:"/budget/admin/categories",style:{color:Ee.primaryLight},children:"Create categories "})]}),ki.map(ge=>{const Ne=zn[ge.id]||[];if(Ne.length===0)return null;const $e=Ne.reduce((We,[Pt,pn])=>We+Ve(Pt,pn),0);return f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("h3",{style:{...dl,margin:0},children:[ge.name,f.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",Ne.length,")"]})]}),f.jsx("span",{style:{fontWeight:600,color:Ee.primary},children:Kt($e)})]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:Ne.map(([We,Pt])=>f.jsx(nE,{catId:We,category:Pt,value:Ut[We]||"",onChange:pn=>En(We,pn),previousMonthIncome:N,disabled:S?.allocations_finalized&&!kt},We))})]},ge.id)}),(()=>{const ge=zn.ungrouped||[];if(ge.length===0)return null;const Ne=ge.reduce(($e,[We,Pt])=>$e+Ve(We,Pt),0);return f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("h3",{style:{...dl,margin:0,opacity:.7},children:["Uncategorized",f.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",ge.length,")"]})]}),f.jsx("span",{style:{fontWeight:600,color:Ee.primary},children:Kt(Ne)})]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:ge.map(([$e,We])=>f.jsx(nE,{catId:$e,category:We,value:Ut[$e]||"",onChange:Pt=>En($e,Pt),previousMonthIncome:N,disabled:S?.allocations_finalized&&!kt},$e))})]})})()]})]}),f.jsx(yh,{isOpen:Q,onClose:()=>{(ne?.status==="done"||ne?.status==="error")&&(X(!1),we(null))},title:"Recompute Monthly Totals",children:f.jsxs("div",{style:{padding:"0.5rem 0"},children:[f.jsxs("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:["Recalculating income totals for ",tE[D-1]," ",x]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[f.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:ne?.status==="pending"?"":""}),f.jsxs("div",{style:{flex:1},children:[f.jsx("p",{style:{margin:0,fontWeight:500},children:"Count income transactions"}),ne&&ne.status!=="pending"&&f.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:["Found ",ne.incomeCount," transaction",ne.incomeCount!==1?"s":""]})]})]}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[f.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:!ne||ne.status==="pending"||ne.status==="counting"?ne?.status==="counting"?"":"":""}),f.jsxs("div",{style:{flex:1},children:[f.jsx("p",{style:{margin:0,fontWeight:500},children:"Calculate new total"}),ne&&ne.newTotal!==void 0&&f.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:[Kt(ne.oldTotal||0),"  ",Kt(ne.newTotal),ne.oldTotal!==ne.newTotal&&f.jsxs("span",{style:{marginLeft:"0.5rem",color:ne.newTotal>(ne.oldTotal||0)?Ee.success:Ee.warning},children:["(",ne.newTotal>(ne.oldTotal||0)?"+":"",Kt(ne.newTotal-(ne.oldTotal||0)),")"]})]})]})]}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[f.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:!ne||["pending","counting","calculating"].includes(ne.status)?"":ne.status==="saving"?"":ne.status==="error"?"":""}),f.jsxs("div",{style:{flex:1},children:[f.jsx("p",{style:{margin:0,fontWeight:500},children:"Save to database"}),ne?.status==="done"&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:"Month document updated"}),ne?.status==="error"&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:Ee.error},children:ne.error})]})]})]}),ne?.status==="done"&&f.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${Ee.success} 10%, transparent)`,border:`1px solid ${Ee.success}`,borderRadius:"8px"},children:[f.jsx("p",{style:{margin:0,fontWeight:600,color:Ee.success},children:" Recompute complete!"}),ne.oldTotal!==ne.newTotal?f.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:["Total income updated from ",Kt(ne.oldTotal||0)," to ",Kt(ne.newTotal||0)]}):f.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:["Total income confirmed: ",Kt(ne.newTotal||0)," (no changes needed)"]})]}),(ne?.status==="done"||ne?.status==="error")&&f.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"flex-end"},children:f.jsx(pt,{onClick:()=>{X(!1),we(null)},children:"Done"})})]})})]})}function nE({catId:i,category:e,value:n,onChange:s,previousMonthIncome:o,disabled:c}){const d=e.default_monthly_type==="percentage"&&e.default_monthly_amount!==void 0&&e.default_monthly_amount>0,g=d?e.default_monthly_amount/100*o:0,p=d?g.toFixed(2):n;let y=null;return!d&&e.default_monthly_amount!==void 0&&e.default_monthly_amount>0&&(y=Kt(e.default_monthly_amount)),f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",padding:"0.6rem 0.75rem",background:d?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",maxWidth:"100%",boxSizing:"border-box",opacity:d?.8:1},children:[f.jsxs("div",{style:{flex:"1 1 auto",minWidth:0,overflow:"hidden"},children:[f.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),d?f.jsxs("span",{style:{fontSize:"0.7rem",opacity:.6,display:"block",marginTop:"0.15rem",color:Ee.primary},children:[e.default_monthly_amount,"% of prev month income"]}):y&&f.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5,display:"block",marginTop:"0.15rem"},children:["Suggested: ",y]})]}),f.jsx("div",{style:{flexShrink:0,width:"110px"},children:d?f.jsx("div",{style:{width:"100%",padding:"0.5rem 0.6rem",borderRadius:"6px",border:"1px dashed color-mix(in srgb, currentColor 15%, transparent)",background:"color-mix(in srgb, currentColor 3%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box",textAlign:"right",opacity:.9},title:"Auto-calculated from previous month's income",children:Kt(g)}):f.jsx("input",{type:"text",inputMode:"decimal",value:p?`$${p}`:"",onChange:b=>{const S=b.target.value.replace(/[^\d.]/g,"");s(S)},placeholder:"$0.00",disabled:c,style:{width:"100%",padding:"0.5rem 0.6rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box",opacity:c?.6:1,cursor:c?"not-allowed":"text"}})})]})}function rE({accounts:i,accountGroups:e,payees:n,initialData:s,defaultAccountId:o,defaultDate:c,onSubmit:d,onCancel:g,onDelete:p,submitLabel:y,isMobile:b}){const S=new Date().toISOString().split("T")[0],[x,D]=A.useState(s?.amount?.toString()||""),[k,O]=A.useState(s?.account_id||o||(i[0]?i[0][0]:"")),[M,G]=A.useState(s?.date||c||S),[q,ee]=A.useState(s?.payee||""),[Ce,Me]=A.useState(s?.description||""),Se={},R=[];i.forEach(([L,N])=>{N.account_group_id?(Se[N.account_group_id]||(Se[N.account_group_id]=[]),Se[N.account_group_id].push([L,N])):R.push([L,N])});function C(L){L.preventDefault();const N=parseFloat(x);isNaN(N)||N<=0||k&&M&&d(N,k,M,q.trim()||void 0,Ce.trim()||void 0)}const I=b?{display:"flex",flexDirection:"column",gap:"1rem"}:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"};return f.jsxs(wl,{onSubmit:C,children:[f.jsxs("div",{style:I,children:[f.jsx(Er,{label:"Amount",htmlFor:"income-amount",children:f.jsx(ux,{id:"income-amount",value:x,onChange:D,placeholder:"$0.00",required:!0,autoFocus:!0})}),f.jsx(Er,{label:"Date",htmlFor:"income-date",children:f.jsx(Xa,{id:"income-date",type:"date",value:M,onChange:L=>G(L.target.value),required:!0})})]}),f.jsxs("div",{style:I,children:[f.jsx(Er,{label:"Deposit To",htmlFor:"income-account",children:f.jsxs(Bc,{id:"income-account",value:k,onChange:L=>O(L.target.value),required:!0,children:[Object.entries(e).map(([L,N])=>{const B=Se[L];return!B||B.length===0?null:f.jsx("optgroup",{label:N.name,children:B.map(([j,Fe])=>f.jsx("option",{value:j,children:Fe.nickname},j))},L)}),R.length>0&&f.jsx("optgroup",{label:"Other",children:R.map(([L,N])=>f.jsx("option",{value:L,children:N.nickname},L))})]})}),f.jsx(Er,{label:"Payee",htmlFor:"income-payee",children:f.jsx(Rj,{id:"income-payee",value:q,onChange:ee,payees:n,placeholder:"e.g., Employer, Client name"})})]}),f.jsx(Er,{label:"Description (optional)",htmlFor:"income-description",children:f.jsx(Xa,{id:"income-description",value:Ce,onChange:L=>Me(L.target.value),placeholder:"e.g., January paycheck, Project bonus"})}),f.jsxs(no,{children:[f.jsx(pt,{type:"submit",children:y}),f.jsx(pt,{type:"button",variant:"secondary",onClick:g,children:"Cancel"}),p&&f.jsx(pt,{type:"button",variant:"danger",onClick:p,style:{marginLeft:"auto"},children:" Delete"})]})]})}function kj({income:i,accountName:e,accountGroupName:n,onEdit:s,onDelete:o,isMobile:c}){return f.jsxs("div",{onClick:c?s:void 0,style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:c?"0.875rem 1rem":"1rem 1.25rem",borderRadius:"8px",display:"flex",flexDirection:c?"column":"row",justifyContent:"space-between",alignItems:c?"stretch":"center",gap:c?"0.5rem":"1rem",cursor:c?"pointer":"default",transition:c?"background 0.15s":"none"},children:[f.jsxs("div",{style:{flex:1},children:[f.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"0.75rem",marginBottom:i.payee?"0.25rem":0},children:[i.date&&f.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,fontFamily:"monospace"},children:new Date(i.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}),f.jsxs("span",{style:{fontSize:"1.15rem",fontWeight:600,color:Ee.success},children:["+",Kt(i.amount)]})]}),i.payee&&f.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,marginBottom:"0.25rem"},children:i.payee}),f.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:[" ",e,n?` / ${n}`:""]}),i.description&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",opacity:.7},children:i.description})]}),!c&&f.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[f.jsx("button",{onClick:s,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit",children:""}),f.jsx("button",{onClick:o,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete",children:""})]})]})}function Nj({onCreateNew:i}){const[e,n]=A.useState(""),[s,o]=A.useState(!1),[c,d]=A.useState(null);async function g(p){p.preventDefault(),o(!0),d(null);try{await i(e.trim()||void 0)}catch(y){d(y instanceof Error?y.message:"Failed to create budget"),o(!1)}}return f.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[f.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),f.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),c&&f.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:c}),f.jsx("button",{onClick:()=>d(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[f.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""})," Create Your Budget"]}),f.jsxs("form",{onSubmit:g,children:[f.jsxs("div",{style:{marginBottom:"1.5rem"},children:[f.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),f.jsx("input",{type:"text",value:e,onChange:p=>n(p.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),f.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),f.jsx("button",{type:"submit",disabled:s,style:{width:"100%",background:Ee.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:s?"not-allowed":"pointer",fontWeight:600,opacity:s?.7:1,fontSize:"1rem"},children:s?"Creating...":"Create Budget"})]})]}),f.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function Vj({invites:i,onAccept:e,onCreateNew:n}){const[s,o]=A.useState(null),[c,d]=A.useState(!1),[g,p]=A.useState(""),[y,b]=A.useState(!1),[S,x]=A.useState(null);async function D(O){o(O),x(null);try{await e(O)}catch(M){x(M instanceof Error?M.message:"Failed to accept invitation"),o(null)}}async function k(O){O.preventDefault(),b(!0),x(null);try{await n(g.trim()||void 0)}catch(M){x(M instanceof Error?M.message:"Failed to create new budget"),b(!1)}}return f.jsxs("div",{children:[f.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),f.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",i.length===1?"a budget":"some budgets",". Choose one to get started!"]}),S&&f.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:S}),f.jsx("button",{onClick:()=>x(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[f.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""})," Budget Invitations"]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:i.map(O=>f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[f.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[f.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:O.budgetName}),O.ownerEmail&&f.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",O.ownerEmail]})]}),f.jsx("button",{onClick:()=>D(O.budgetId),disabled:s!==null||y,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:s!==null||y?"not-allowed":"pointer",fontWeight:500,opacity:s!==null||y?.7:1,fontSize:"0.9rem"},children:s===O.budgetId?"Joining...":"Accept & Join"})]},O.budgetId))})]}),f.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:c?f.jsxs("form",{onSubmit:k,children:[f.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),f.jsxs("div",{style:{marginBottom:"1rem"},children:[f.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),f.jsx("input",{type:"text",value:g,onChange:O=>p(O.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),f.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[f.jsx("button",{type:"submit",disabled:y||s!==null,style:{background:Ee.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:y||s!==null?"not-allowed":"pointer",fontWeight:500,opacity:y||s!==null?.7:1,fontSize:"0.9rem"},children:y?"Creating...":"Create Budget"}),f.jsx("button",{type:"button",onClick:()=>{d(!1),p("")},disabled:y,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:y?"not-allowed":"pointer",fontWeight:500,opacity:y?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),f.jsx("button",{onClick:()=>d(!0),disabled:s!==null,style:{background:Ee.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:s!==null?"not-allowed":"pointer",fontWeight:500,opacity:s!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function Lj(i,e){return!e||e==="any"||i===0?!1:e==="positive"&&i<0||e==="negative"&&i>0}function Pj(i,e){return!e||e==="any"||i===0?null:e==="positive"&&i<0?"Unexpected negative balance":e==="negative"&&i>0?"Unexpected positive balance (credit owed to you?)":null}function zj(){const{currentBudget:i,accounts:e,setAccounts:n,accountGroups:s,setAccountGroups:o,checkBalanceMismatch:c,reconcileBalances:d,balanceMismatch:g}=hs(),[p,y]=A.useState(null),[b,S]=A.useState(!1),[x,D]=A.useState(!1),k=Gh();A.useEffect(()=>{i&&Object.keys(e).length>0&&(D(!0),c().finally(()=>D(!1)))},[i?.id,Object.keys(e).length]);const[O,M]=A.useState(null),[G,q]=A.useState(null),[ee,Ce]=A.useState(null),[Me,Se]=A.useState(!1),[R,C]=A.useState(null),[I,L]=A.useState(null),[N,B]=A.useState(null),[j,Fe]=A.useState(null),dt=eo(ga);function se(z){const K={};return Object.entries(z).forEach(([te,ue])=>{K[te]={nickname:ue.nickname,balance:ue.balance,account_group_id:ue.account_group_id??null,sort_order:ue.sort_order},ue.is_income_account!==void 0&&(K[te].is_income_account=ue.is_income_account),ue.is_income_default!==void 0&&(K[te].is_income_default=ue.is_income_default),ue.is_outgo_account!==void 0&&(K[te].is_outgo_account=ue.is_outgo_account),ue.is_outgo_default!==void 0&&(K[te].is_outgo_default=ue.is_outgo_default),ue.on_budget!==void 0&&(K[te].on_budget=ue.on_budget),ue.is_active!==void 0&&(K[te].is_active=ue.is_active)}),K}function $(z){const K={};return Object.entries(z).forEach(([te,ue])=>{K[te]={name:ue.name,sort_order:ue.sort_order,expected_balance:ue.expected_balance||"positive"},ue.on_budget!==void 0&&(K[te].on_budget=ue.on_budget),ue.is_active!==void 0&&(K[te].is_active=ue.is_active)}),K}async function Ie(z){if(i)try{const K=Ke(dt,"budgets",i.id),te=await ht(K);if(te.exists()){const ue=te.data();await vt(K,{...ue,accounts:se(z)})}}catch(K){throw new Error(K instanceof Error?K.message:"Failed to save accounts")}}async function Ue(z){if(i)try{const K=Ke(dt,"budgets",i.id),te=await ht(K);if(te.exists()){const ue=te.data();await vt(K,{...ue,account_groups:$(z)})}}catch(K){throw new Error(K instanceof Error?K.message:"Failed to save account groups")}}async function st(z,K){if(i)try{const te=Ke(dt,"budgets",i.id),ue=await ht(te);if(ue.exists()){const Ae=ue.data();await vt(te,{...Ae,accounts:se(z),account_groups:$(K)})}}catch(te){throw new Error(te instanceof Error?te.message:"Failed to save changes")}}function V(z,K){if(!i)return;const te=Object.values(e).filter(Te=>K==="ungrouped"?!Te.account_group_id:Te.account_group_id===K),ue=te.length>0?Math.max(...te.map(Te=>Te.sort_order)):-1,Ae=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,pe={nickname:z.nickname,balance:0,account_group_id:K==="ungrouped"?null:K,sort_order:ue+1,is_income_account:z.is_income_account,is_income_default:z.is_income_default,is_outgo_account:z.is_outgo_account,is_outgo_default:z.is_outgo_default,on_budget:z.on_budget!==!1,is_active:z.is_active!==!1},ve={...e};z.is_income_default&&Object.keys(ve).forEach(Te=>{ve[Te]={...ve[Te],is_income_default:!1}}),z.is_outgo_default&&Object.keys(ve).forEach(Te=>{ve[Te]={...ve[Te],is_outgo_default:!1}}),ve[Ae]=pe,n(ve),q(null),Ie(ve).catch(Te=>{console.error("[Accounts] Error creating account:",Te),y(Te instanceof Error?Te.message:"Failed to create account. Changes may not persist.")})}function P(z,K){if(!i)return;const te=e[z];if(!te)return;const ue=te.account_group_id||"ungrouped",Ae=K.account_group_id;let pe=te.sort_order;if(ue!==(Ae||"ungrouped")){const Te=Object.values(e).filter(Le=>(Le.account_group_id||"ungrouped")===(Ae||"ungrouped"));pe=Te.length>0?Math.max(...Te.map(Le=>Le.sort_order))+1:0}const ve={};Object.entries(e).forEach(([Te,Le])=>{Te===z?ve[Te]={...Le,nickname:K.nickname,account_group_id:Ae,sort_order:pe,is_income_account:K.is_income_account,is_income_default:K.is_income_default,is_outgo_account:K.is_outgo_account,is_outgo_default:K.is_outgo_default,on_budget:K.on_budget!==!1,is_active:K.is_active!==!1}:(ve[Te]={...Le},K.is_income_default&&!te.is_income_default&&(ve[Te].is_income_default=!1),K.is_outgo_default&&!te.is_outgo_default&&(ve[Te].is_outgo_default=!1))}),n(ve),M(null),Ie(ve).catch(Te=>{console.error("[Accounts] Error saving account:",Te),y(Te instanceof Error?Te.message:"Failed to save account. Changes may not persist.")})}function Q(z){if(!confirm("Are you sure you want to delete this account?")||!i)return;const{[z]:K,...te}=e;n(te),Ie(te).catch(ue=>{console.error("[Accounts] Error deleting account:",ue),y(ue instanceof Error?ue.message:"Failed to delete account. Changes may not persist.")})}function X(z){if(!i)return;const K=Object.values(s).map(ve=>ve.sort_order),te=K.length>0?Math.max(...K):-1,ue=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Ae={name:z.name,sort_order:te+1,expected_balance:z.expected_balance,on_budget:z.on_budget,is_active:z.is_active},pe={...s,[ue]:Ae};o(pe),Se(!1),Ue(pe).catch(ve=>{console.error("[Accounts] Error creating group:",ve),y(ve instanceof Error?ve.message:"Failed to create account type. Changes may not persist.")})}function ne(z,K){if(!i)return;const te={...s,[z]:{...s[z],name:K.name,expected_balance:K.expected_balance,on_budget:K.on_budget,is_active:K.is_active}};o(te),Ce(null),Ue(te).catch(ue=>{console.error("[Accounts] Error updating group:",ue),y(ue instanceof Error?ue.message:"Failed to update account type. Changes may not persist.")})}function we(z){if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!i)return;const K={};Object.entries(e).forEach(([Ae,pe])=>{K[Ae]=pe.account_group_id===z?{...pe,account_group_id:null}:pe});const{[z]:te,...ue}=s;n(K),o(ue),st(K,ue).catch(Ae=>{console.error("[Accounts] Error deleting group:",Ae),y(Ae instanceof Error?Ae.message:"Failed to delete account type. Changes may not persist.")})}function ke(z,K){C("account"),L(K),z.dataTransfer.effectAllowed="move"}function Qe(z,K,te){z.preventDefault(),R==="account"&&(K!==I&&B(K),Fe(te))}function lt(z,K){z.preventDefault(),R==="account"?(Fe(K),B(null)):R==="group"&&K!==I&&B(K)}function Ut(){B(null)}function bn(){Fe(null)}function Jt(){C(null),L(null),B(null),Fe(null)}async function Nn(z,K,te){if(z.preventDefault(),z.stopPropagation(),!I||R!=="account"){Jt();return}const ue=e[I];if(!ue)return;const Ae=te==="ungrouped"?null:te,pe=Object.entries(e).filter(([,Le])=>(Le.account_group_id||"ungrouped")===te),ve={};Object.entries(e).forEach(([Le,Re])=>{Le!==I&&(ve[Le]={...Re})});let Te;if(K==="__group_end__"||pe.length===0||!pe.find(([Le])=>Le===K))Te=(pe.length>0?Math.max(...pe.filter(([Re])=>Re!==I).map(([,Re])=>Re.sort_order)):-1)+1;else{const Le=pe.find(([Re])=>Re===K);if(Le){const[,Re]=Le;Te=Re.sort_order,Object.entries(ve).forEach(([at,St])=>{(St.account_group_id||"ungrouped")===te&&St.sort_order>=Te&&(ve[at]={...St,sort_order:St.sort_order+1})})}else Te=0}if(ve[I]={...ue,account_group_id:Ae,sort_order:Te},n(ve),Jt(),!!i)try{await Ie(ve)}catch(Le){y(Le instanceof Error?Le.message:"Failed to save changes")}}async function mn(z,K){z.preventDefault(),R==="account"?await Nn(z,"__group_end__",K):R==="group"&&await kt(z,K)}function Gn(z,K){z.stopPropagation(),C("group"),L(K),z.dataTransfer.effectAllowed="move"}async function kt(z,K){if(z.preventDefault(),!I||R!=="group"||I===K){Jt();return}const te=Object.entries(s).sort(([,Te],[,Le])=>Te.sort_order-Le.sort_order),ue=te.findIndex(([Te])=>Te===I),Ae=[...te],[pe]=Ae.splice(ue,1);if(K==="__end__")Ae.push(pe);else{const Te=Ae.findIndex(([Le])=>Le===K);Ae.splice(Te,0,pe)}const ve={};if(Ae.forEach(([Te,Le],Re)=>{ve[Te]={...Le,sort_order:Re}}),o(ve),Jt(),!!i)try{await Ue(ve)}catch(Te){y(Te instanceof Error?Te.message:"Failed to save new order")}}async function Zt(z,K){const te=e[z];if(!te)return;const ue=te.account_group_id||"ungrouped",Ae=Object.entries(e).filter(([,at])=>(at.account_group_id||"ungrouped")===ue).sort(([,at],[,St])=>at.sort_order-St.sort_order),pe=Ae.findIndex(([at])=>at===z),ve=K==="up"?pe-1:pe+1;if(ve<0||ve>=Ae.length)return;const[Te,Le]=Ae[ve],Re={};if(Object.entries(e).forEach(([at,St])=>{at===z?Re[at]={...St,sort_order:Le.sort_order}:at===Te?Re[at]={...St,sort_order:te.sort_order}:Re[at]={...St}}),n(Re),!!i)try{await Ie(Re)}catch(at){n(e),y(at instanceof Error?at.message:"Failed to move account")}}async function tt(z,K){const te=Object.entries(s).sort(([,Te],[,Le])=>Te.sort_order-Le.sort_order),ue=te.findIndex(([Te])=>Te===z),Ae=K==="up"?ue-1:ue+1;if(Ae<0||Ae>=te.length)return;const[pe]=te.splice(ue,1);te.splice(Ae,0,pe);const ve={};if(te.forEach(([Te,Le],Re)=>{ve[Te]={...Le,sort_order:Re}}),o(ve),!!i)try{await Ue(ve)}catch(Te){o(s),y(Te instanceof Error?Te.message:"Failed to move account type")}}const F=Object.entries(e).reduce((z,[K,te])=>{const ue=te.account_group_id||"ungrouped";return z[ue]||(z[ue]=[]),z[ue].push({...te,id:K}),z},{}),fe=Object.entries(s).sort(([,z],[,K])=>z.sort_order-K.sort_order).map(([z,K])=>({...K,id:z}));return i?f.jsxs("div",{children:[f.jsx("h2",{style:{marginTop:0},children:"Accounts"}),f.jsxs("p",{style:qh,children:["Organize your financial accounts by type.",f.jsx("br",{}),f.jsx("span",{style:{fontSize:"0.9rem"},children:k?"Use  buttons to reorder items, or drag to move between types.":"Drag accounts between types, or use  buttons to reorder."})]}),p&&f.jsx(au,{message:p,onDismiss:()=>y(null)}),g&&Object.keys(g).length>0&&f.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 15%, transparent)",border:"1px solid #f59e0b",borderRadius:"8px",padding:"1rem",marginBottom:"1rem",display:"flex",flexDirection:k?"column":"row",alignItems:k?"flex-start":"center",gap:"1rem"},children:[f.jsxs("div",{style:{flex:1},children:[f.jsx("p",{style:{margin:0,fontWeight:600,color:"#f59e0b"},children:" Balance Mismatch Detected"}),f.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.85rem",opacity:.9},children:[Object.keys(g).length," account",Object.keys(g).length!==1?"s have":" has"," balances that don't match the calculated totals from income history."]}),f.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.8rem",opacity:.8},children:[Object.entries(g).slice(0,3).map(([z,{stored:K,calculated:te}])=>{const ue=e[z];return f.jsxs("li",{children:[ue?.nickname||"Unknown",": stored $",K.toFixed(2)," vs calculated $",te.toFixed(2)]},z)}),Object.keys(g).length>3&&f.jsxs("li",{children:["...and ",Object.keys(g).length-3," more"]})]})]}),f.jsx("button",{onClick:async()=>{S(!0);try{await d()}catch(z){y(z instanceof Error?z.message:"Failed to reconcile")}finally{S(!1)}},disabled:b,style:{background:"#f59e0b",color:"#000",border:"none",borderRadius:"6px",padding:"0.5rem 1rem",fontWeight:600,cursor:b?"not-allowed":"pointer",opacity:b?.7:1,whiteSpace:"nowrap"},children:b?" Reconciling...":" Reconcile Now"})]}),!g&&f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem",gap:"0.5rem"},children:[f.jsx("button",{onClick:async()=>{D(!0);try{await c()}finally{D(!1)}},disabled:x,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.85rem",cursor:x?"not-allowed":"pointer",opacity:x?.6:1},title:"Check if account balances match income history",children:x?" Checking...":" Check Balances"}),f.jsx("button",{onClick:async()=>{S(!0);try{await d()}catch(z){y(z instanceof Error?z.message:"Failed to reconcile")}finally{S(!1)}},disabled:b,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.85rem",cursor:b?"not-allowed":"pointer",opacity:b?.6:1},title:"Recalculate all account balances from income history",children:b?" Reconciling...":" Reconcile All"})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(e).length===0&&Object.keys(s).length===0&&f.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),fe.map((z,K)=>{const te=(F[z.id]||[]).sort((Ve,Xe)=>Ve.sort_order-Xe.sort_order),ue=R==="group"&&I===z.id,Ae=R==="group"&&N===z.id,pe=R==="account"&&j===z.id,ve=I&&R==="account"?e[I]:null,Te=ve&&(ve.account_group_id||"ungrouped")!==z.id,Le=R==="group"&&Ae&&I!==z.id,Re=K>0,at=K<fe.length-1,St=te.reduce((Ve,Xe)=>Ve+Xe.balance,0);return f.jsxs("div",{children:[R==="group"&&!ue&&f.jsxs("div",{onDragOver:Ve=>{Ve.preventDefault(),B(z.id)},onDragLeave:Ut,onDrop:Ve=>kt(Ve,z.id),style:{position:"relative",height:Le?"2.5rem":"0.5rem",marginBottom:Le?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[f.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:Ee.primary,borderRadius:"2px",opacity:Le?1:0,transition:"opacity 0.15s",boxShadow:Le?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),Le&&f.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),f.jsx("div",{draggable:ee!==z.id,onDragStart:Ve=>Gn(Ve,z.id),onDragOver:Ve=>{lt(Ve,z.id)},onDragLeave:bn,onDragEnd:Jt,onDrop:Ve=>mn(Ve,z.id),style:{background:ue?"color-mix(in srgb, currentColor 3%, transparent)":pe&&Te?`color-mix(in srgb, ${Ee.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:ue?.5:1,border:pe&&Te?`2px dashed ${Ee.primary}`:"2px solid transparent",cursor:ee===z.id?"default":"grab",transition:"all 0.15s"},children:ee===z.id?f.jsx(iE,{initialData:{name:z.name,expected_balance:z.expected_balance||"positive",on_budget:z.on_budget,is_active:z.is_active},onSubmit:Ve=>ne(z.id,Ve),onCancel:()=>Ce(null),submitLabel:"Save"}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:k?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:k?"wrap":"nowrap"},children:[f.jsxs("h3",{style:{...dl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!k&&f.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),f.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:z.name}),f.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",te.length,")"]}),f.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:Yr(St),flexShrink:0},children:Kt(St)}),f.jsx(Uj,{group:z})]}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!k&&f.jsx(pt,{variant:"small",onClick:()=>q(z.id),disabled:G!==null,children:"+ Account"}),f.jsx("button",{onClick:()=>Ce(z.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),f.jsx("button",{onClick:()=>we(z.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),f.jsxs("div",{style:Up,children:[f.jsx("button",{onClick:()=>tt(z.id,"up"),disabled:!Re,style:{...ul,opacity:Re?.6:.2,cursor:Re?"pointer":"default"},title:"Move account type up","aria-label":"Move account type up",children:""}),f.jsx("button",{onClick:()=>tt(z.id,"down"),disabled:!at,style:{...ul,opacity:at?.6:.2,cursor:at?"pointer":"default"},title:"Move account type down","aria-label":"Move account type down",children:""})]})]})]}),k&&f.jsx("div",{style:{marginBottom:"0.5rem"},children:f.jsx(pt,{variant:"small",onClick:()=>q(z.id),disabled:G!==null,children:"+ Account"})}),f.jsxs("div",{style:Wa,children:[te.map(Ve=>O===Ve.id?f.jsx(kd,{initialData:{nickname:Ve.nickname,account_group_id:Ve.account_group_id,is_income_account:Ve.is_income_account,is_income_default:Ve.is_income_default,is_outgo_account:Ve.is_outgo_account,is_outgo_default:Ve.is_outgo_default,on_budget:Ve.on_budget,is_active:Ve.is_active},onSubmit:Xe=>P(Ve.id,Xe),onCancel:()=>M(null),submitLabel:"Save",accountGroups:fe,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:Ve.account_group_id,hasExistingIncomeDefault:Object.entries(e).some(([Xe,gn])=>gn.is_income_default&&Xe!==Ve.id),hasExistingOutgoDefault:Object.entries(e).some(([Xe,gn])=>gn.is_outgo_default&&Xe!==Ve.id)},Ve.id):f.jsx(ph,{isDragging:R==="account"&&I===Ve.id,isDragOver:N===Ve.id,onDragStart:Xe=>{Xe.stopPropagation(),ke(Xe,Ve.id)},onDragOver:Xe=>Qe(Xe,Ve.id,z.id),onDragLeave:Ut,onDragEnd:Jt,onDrop:Xe=>Nn(Xe,Ve.id,z.id),onEdit:()=>M(Ve.id),onDelete:()=>Q(Ve.id),onMoveUp:()=>Zt(Ve.id,"up"),onMoveDown:()=>Zt(Ve.id,"down"),canMoveUp:te.findIndex(Xe=>Xe.id===Ve.id)>0,canMoveDown:te.findIndex(Xe=>Xe.id===Ve.id)<te.length-1,children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[f.jsx("span",{style:gh,children:Ve.nickname}),f.jsx(aE,{account:Ve,accountGroups:fe})]}),f.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:Yr(Ve.balance)},children:[Kt(Ve.balance),Lj(Ve.balance,z.expected_balance)&&f.jsx("span",{title:Pj(Ve.balance,z.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},Ve.id)),te.length===0&&!G&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),R==="account"&&te.length>0&&f.jsx(oE,{groupId:z.id,isActive:N===`__end__${z.id}`,onDragOver:Ve=>{Ve.preventDefault(),Ve.stopPropagation(),B(`__end__${z.id}`),Fe(z.id)},onDragLeave:Ve=>{Ve.stopPropagation(),B(null)},onDrop:Ve=>{Ve.stopPropagation(),Nn(Ve,"__group_end__",z.id)}}),G===z.id&&f.jsx(kd,{initialData:{nickname:"",account_group_id:z.id},onSubmit:Ve=>V(Ve,z.id),onCancel:()=>q(null),submitLabel:"Create",accountGroups:fe,showIncomeSettings:!0,currentGroupId:z.id})]}),G!==z.id&&f.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:f.jsx(pt,{variant:"small",onClick:()=>q(z.id),disabled:G!==null,children:"+ Add Account"})})]})})]},z.id)}),R==="group"&&fe.length>0&&f.jsx(Fp,{isActive:N==="__end__",onDragOver:z=>{z.preventDefault(),B("__end__")},onDragLeave:Ut,onDrop:z=>kt(z,"__end__"),label:"Move account type to end"}),(()=>{const z=(F.ungrouped||[]).sort((pe,ve)=>pe.sort_order-ve.sort_order),K=R==="account"&&j==="ungrouped",te=I&&R==="account"?e[I]:null,ue=te&&te.account_group_id!==null;if(z.length===0&&!G&&Object.keys(s).length>0&&R!=="account")return null;const Ae=z.reduce((pe,ve)=>pe+ve.balance,0);return f.jsxs("div",{onDragOver:pe=>lt(pe,"ungrouped"),onDragLeave:bn,onDrop:pe=>mn(pe,"ungrouped"),style:{background:K&&ue?`color-mix(in srgb, ${Ee.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:K&&ue?`2px dashed ${Ee.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("h3",{style:{...dl,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",f.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",z.length,")"]}),z.length>0&&f.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:Yr(Ae)},children:Kt(Ae)})]}),f.jsx(pt,{variant:"small",onClick:()=>q("ungrouped"),disabled:G!==null,children:"+ Account"})]}),f.jsxs("div",{style:Wa,children:[z.map(pe=>O===pe.id?f.jsx(kd,{initialData:{nickname:pe.nickname,account_group_id:pe.account_group_id,is_income_account:pe.is_income_account,is_income_default:pe.is_income_default,is_outgo_account:pe.is_outgo_account,is_outgo_default:pe.is_outgo_default,on_budget:pe.on_budget,is_active:pe.is_active},onSubmit:ve=>P(pe.id,ve),onCancel:()=>M(null),submitLabel:"Save",accountGroups:fe,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(e).some(([ve,Te])=>Te.is_income_default&&ve!==pe.id),hasExistingOutgoDefault:Object.entries(e).some(([ve,Te])=>Te.is_outgo_default&&ve!==pe.id)},pe.id):f.jsx(ph,{isDragging:R==="account"&&I===pe.id,isDragOver:N===pe.id,onDragStart:ve=>ke(ve,pe.id),onDragOver:ve=>Qe(ve,pe.id,"ungrouped"),onDragLeave:Ut,onDragEnd:Jt,onDrop:ve=>Nn(ve,pe.id,"ungrouped"),onEdit:()=>M(pe.id),onDelete:()=>Q(pe.id),onMoveUp:()=>Zt(pe.id,"up"),onMoveDown:()=>Zt(pe.id,"down"),canMoveUp:z.findIndex(ve=>ve.id===pe.id)>0,canMoveDown:z.findIndex(ve=>ve.id===pe.id)<z.length-1,children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[f.jsx("span",{style:gh,children:pe.nickname}),f.jsx(aE,{account:pe,accountGroups:fe})]}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:Yr(pe.balance)},children:Kt(pe.balance)})]})},pe.id)),z.length===0&&R==="account"&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),R==="account"&&z.length>0&&f.jsx(oE,{groupId:"ungrouped",isActive:N==="__end__ungrouped",onDragOver:pe=>{pe.preventDefault(),pe.stopPropagation(),B("__end__ungrouped"),Fe("ungrouped")},onDragLeave:pe=>{pe.stopPropagation(),B(null)},onDrop:pe=>{pe.stopPropagation(),Nn(pe,"__group_end__","ungrouped")}}),G==="ungrouped"&&f.jsx(kd,{initialData:{nickname:"",account_group_id:null},onSubmit:pe=>V(pe,"ungrouped"),onCancel:()=>q(null),submitLabel:"Create",accountGroups:fe,showIncomeSettings:!0,currentGroupId:null})]}),G!=="ungrouped"&&f.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:f.jsx(pt,{variant:"small",onClick:()=>q("ungrouped"),disabled:G!==null,children:"+ Add Account"})})]})})()]}),Me?f.jsx(iE,{onSubmit:X,onCancel:()=>Se(!1),submitLabel:"Create Account Type"}):f.jsx(pt,{variant:"primary-large",onClick:()=>Se(!0),children:"+ Add Account Type"})]}):f.jsx("p",{children:"No budget found. Please log in."})}function kd({initialData:i,onSubmit:e,onCancel:n,submitLabel:s,accountGroups:o,showGroupSelector:c=!1,showIncomeSettings:d=!1,hasExistingIncomeDefault:g=!1,hasExistingOutgoDefault:p=!1,currentGroupId:y}){const[b,S]=A.useState(i||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),x=b.account_group_id||y,D=x?o.find(ee=>ee.id===x):null,k=D?.is_active!==void 0,O=D?.on_budget!==void 0;function M(ee){ee.preventDefault(),b.nickname.trim()&&e(b)}function G(ee){S({...b,is_income_account:ee,is_income_default:ee?b.is_income_default:!1})}function q(ee){S({...b,is_outgo_account:ee,is_outgo_default:ee?b.is_outgo_default:!1})}return f.jsxs(wl,{onSubmit:M,children:[f.jsx(Er,{label:"Account Nickname",htmlFor:"account-nickname",children:f.jsx(Xa,{id:"account-nickname",type:"text",value:b.nickname,onChange:ee=>S({...b,nickname:ee.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),c&&f.jsx(Er,{label:"Account Type",htmlFor:"account-group",children:f.jsxs(Bc,{id:"account-group",value:b.account_group_id||"ungrouped",onChange:ee=>S({...b,account_group_id:ee.target.value==="ungrouped"?null:ee.target.value}),children:[f.jsx("option",{value:"ungrouped",children:"Ungrouped"}),o.map(ee=>f.jsx("option",{value:ee.id,children:ee.name},ee.id))]})}),d&&f.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[f.jsx(Fo,{id:"is-active",checked:k?D.is_active:b.is_active!==!1,onChange:ee=>S({...b,is_active:ee.target.checked}),disabled:k,children:f.jsx("span",{style:{opacity:k?.5:1},children:"Active account"})}),k&&f.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:Ee.warning},children:['Set by account type "',D.name,'"']})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[f.jsx(Fo,{id:"on-budget",checked:O?D.on_budget:b.on_budget!==!1,onChange:ee=>S({...b,on_budget:ee.target.checked}),disabled:O,children:f.jsx("span",{style:{opacity:O?.5:1},children:"On budget (affects budget totals)"})}),O&&f.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:Ee.warning},children:['Set by account type "',D.name,'"']})]})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),f.jsx(Fo,{id:"is-income-account",checked:b.is_income_account||!1,onChange:ee=>G(ee.target.checked),children:"Show in income deposit list"}),b.is_income_account&&f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[f.jsx(Fo,{id:"is-income-default",checked:b.is_income_default||!1,onChange:ee=>S({...b,is_income_default:ee.target.checked}),disabled:g&&!i?.is_income_default,children:"Default account for new income"}),g&&!i?.is_income_default&&f.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),f.jsx(Fo,{id:"is-outgo-account",checked:b.is_outgo_account||!1,onChange:ee=>q(ee.target.checked),children:"Show in expense account list"}),b.is_outgo_account&&f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[f.jsx(Fo,{id:"is-outgo-default",checked:b.is_outgo_default||!1,onChange:ee=>S({...b,is_outgo_default:ee.target.checked}),disabled:p&&!i?.is_outgo_default,children:"Default account for new expenses"}),p&&!i?.is_outgo_default&&f.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),f.jsxs(no,{children:[f.jsx(pt,{type:"submit",children:s}),f.jsx(pt,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function iE({initialData:i,onSubmit:e,onCancel:n,submitLabel:s}){const[o,c]=A.useState(i||{name:"",expected_balance:"positive"});function d(g){g.preventDefault(),o.name.trim()&&e(o)}return f.jsxs(wl,{onSubmit:d,children:[f.jsx(Er,{label:"Account Type Name",htmlFor:"group-name",children:f.jsx(Xa,{id:"group-name",type:"text",value:o.name,onChange:g=>c({...o,name:g.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),f.jsx(Er,{label:"Expected Balance",htmlFor:"expected-balance",children:f.jsxs(Bc,{id:"expected-balance",value:o.expected_balance,onChange:g=>c({...o,expected_balance:g.target.value}),children:[f.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),f.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),f.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),f.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",f.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),f.jsx(sE,{label:"Active status",value:o.is_active,onChange:g=>c({...o,is_active:g}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),f.jsx(sE,{label:"Budget status",value:o.on_budget,onChange:g=>c({...o,on_budget:g}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),f.jsxs(no,{children:[f.jsx(pt,{type:"submit",children:s}),f.jsx(pt,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function sE({label:i,value:e,onChange:n,trueLabel:s,falseLabel:o,undefinedLabel:c}){function d(){n(e===void 0?!0:e===!0?!1:void 0)}const g=e===!0?s:e===!1?o:c,p=e===!0?Ee.success:e===!1?Ee.warning:"inherit",y=e===!0?"":e===!1?"":"";return f.jsxs("button",{type:"button",onClick:d,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${p} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${p} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[f.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?p:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:y}),f.jsxs("span",{style:{flex:1},children:[f.jsxs("span",{style:{opacity:.7},children:[i,":"]})," ",f.jsx("span",{style:{fontWeight:500,color:p},children:g})]}),f.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function Uj({group:i}){const e=[];return i.is_active===!1?e.push(f.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${Ee.warning} 20%, transparent)`,color:Ee.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):i.is_active===!0&&e.push(f.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${Ee.success} 20%, transparent)`,color:Ee.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),i.on_budget===!1?e.push(f.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${Ee.warning} 20%, transparent)`,color:Ee.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):i.on_budget===!0&&e.push(f.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${Ee.success} 20%, transparent)`,color:Ee.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:f.jsx(f.Fragment,{children:e})}function Ho({icon:i,label:e,variant:n,title:s}){const c={success:{background:`color-mix(in srgb, ${Ee.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${Ee.success} 40%, transparent)`,color:Ee.success,opacity:1},warning:{background:`color-mix(in srgb, ${Ee.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${Ee.warning} 35%, transparent)`,color:Ee.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${Ee.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${Ee.success} 25%, transparent)`,color:Ee.success,opacity:.7},expense:{background:`color-mix(in srgb, ${Ee.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${Ee.warning} 25%, transparent)`,color:Ee.warning,opacity:.7}}[n];return f.jsxs("span",{title:s||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:c.background,border:c.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:c.color,opacity:c.opacity,whiteSpace:"nowrap"},children:[f.jsx("span",{style:{fontSize:"0.75rem"},children:i}),e]})}function aE({account:i,accountGroups:e}){const n=[],s=i.account_group_id?e.find(d=>d.id===i.account_group_id):null,o=s?.is_active!==void 0?s.is_active:i.is_active!==!1,c=s?.on_budget!==void 0?s.on_budget:i.on_budget!==!1;if(!o){const d=s?.is_active!==void 0;n.push(f.jsx(Ho,{icon:"",label:d?"Inactive (type)":"Inactive",variant:"warning",title:d?`Set by "${s.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!c){const d=s?.on_budget!==void 0;n.push(f.jsx(Ho,{icon:"",label:d?"Off Budget (type)":"Off Budget",variant:"warning",title:d?`Set by "${s.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return i.is_income_default?n.push(f.jsx(Ho,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):i.is_income_account&&n.push(f.jsx(Ho,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),i.is_outgo_default?n.push(f.jsx(Ho,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):i.is_outgo_account&&n.push(f.jsx(Ho,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:f.jsx(f.Fragment,{children:n})}function oE({isActive:i,onDragOver:e,onDragLeave:n,onDrop:s}){return f.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:s,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[f.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:Ee.primary,borderRadius:"2px",opacity:i?1:.3,transition:"opacity 0.15s",boxShadow:i?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),i&&f.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function Bj(){const{currentBudget:i,categories:e,setCategories:n,categoryGroups:s,setCategoryGroups:o,getCategoryBalances:c,getOnBudgetTotal:d}=hs(),[g,p]=A.useState(null),y=Gh(),[b,S]=A.useState({}),[x,D]=A.useState(!1),[k,O]=A.useState(null),[M,G]=A.useState(null),[q,ee]=A.useState(null),[Ce,Me]=A.useState(!1),[Se,R]=A.useState(null),[C,I]=A.useState(null),[L,N]=A.useState(null),[B,j]=A.useState(null),Fe=eo(ga);A.useEffect(()=>{i&&Object.keys(e).length>0&&(D(!0),c().then(F=>S(F)).catch(F=>console.warn("Failed to load category balances:",F)).finally(()=>D(!1)))},[i?.id,Object.keys(e).length,c]);function dt(F){const fe={};return Object.entries(F).forEach(([z,K])=>{fe[z]={name:K.name,category_group_id:K.category_group_id??null,sort_order:K.sort_order,balance:K.balance??0},K.description&&(fe[z].description=K.description),K.default_monthly_amount!==void 0&&(fe[z].default_monthly_amount=K.default_monthly_amount),K.default_monthly_type!==void 0&&(fe[z].default_monthly_type=K.default_monthly_type)}),fe}async function se(F){if(i)try{const fe=Ke(Fe,"budgets",i.id),z=await ht(fe);if(z.exists()){const K=z.data();await vt(fe,{...K,categories:dt(F)})}}catch(fe){throw new Error(fe instanceof Error?fe.message:"Failed to save categories")}}async function $(F){if(i)try{const fe=Ke(Fe,"budgets",i.id),z=await ht(fe);if(z.exists()){const K=z.data();await vt(fe,{...K,category_groups:F})}}catch(fe){throw new Error(fe instanceof Error?fe.message:"Failed to save category groups")}}async function Ie(F,fe){if(i)try{const z=Ke(Fe,"budgets",i.id),K=await ht(z);if(K.exists()){const te=K.data();await vt(z,{...te,categories:dt(F),category_groups:fe})}}catch(z){throw new Error(z instanceof Error?z.message:"Failed to save changes")}}async function Ue(F,fe){if(!i)return;const z=fe==="ungrouped"?null:fe,K=Object.values(e).filter(ve=>fe==="ungrouped"?!ve.category_group_id:ve.category_group_id===fe),te=K.length>0?Math.max(...K.map(ve=>ve.sort_order)):-1,ue=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Ae={name:F.name,description:F.description,category_group_id:z,sort_order:te+1,default_monthly_amount:F.default_monthly_amount,default_monthly_type:F.default_monthly_type,balance:0},pe={...e,[ue]:Ae};n(pe),G(null);try{await se(pe)}catch(ve){n(e),p(ve instanceof Error?ve.message:"Failed to create category")}}async function st(F,fe){if(i)try{const z=e[F];if(!z)return;const K=z.category_group_id||"ungrouped",te=fe.category_group_id;let ue=z.sort_order;if(K!==(te||"ungrouped")){const pe=Object.values(e).filter(ve=>(ve.category_group_id||"ungrouped")===(te||"ungrouped")).filter((ve,Te,Le)=>e[F]!==Le[Te]);ue=pe.length>0?Math.max(...pe.map(ve=>ve.sort_order))+1:0}const Ae={...e,[F]:{...z,name:fe.name,description:fe.description,category_group_id:te,sort_order:ue,default_monthly_amount:fe.default_monthly_amount,default_monthly_type:fe.default_monthly_type}};n(Ae),await se(Ae),O(null)}catch(z){p(z instanceof Error?z.message:"Failed to update category")}}async function V(F){if(confirm("Are you sure you want to delete this category?")&&i)try{const{[F]:fe,...z}=e;n(z),await se(z)}catch(fe){p(fe instanceof Error?fe.message:"Failed to delete category")}}async function P(F){if(i)try{const fe=s.length>0?Math.max(...s.map(te=>te.sort_order)):-1,z={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:F.name,sort_order:fe+1},K=[...s,z];o(K),await $(K),Me(!1)}catch(fe){p(fe instanceof Error?fe.message:"Failed to create group")}}async function Q(F,fe){if(i)try{const z=s.map(K=>K.id===F?{...K,name:fe.name}:K);o(z),await $(z),ee(null)}catch(z){p(z instanceof Error?z.message:"Failed to update group")}}async function X(F){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&i)try{const fe={};Object.entries(e).forEach(([K,te])=>{fe[K]=te.category_group_id===F?{...te,category_group_id:null}:te});const z=s.filter(K=>K.id!==F);n(fe),o(z),await Ie(fe,z)}catch(fe){p(fe instanceof Error?fe.message:"Failed to delete group")}}function ne(F,fe){R("category"),I(fe),F.dataTransfer.effectAllowed="move"}function we(F,fe,z){F.preventDefault(),Se==="category"&&(fe!==C&&N(fe),j(z))}function ke(F,fe){F.preventDefault(),Se==="category"?(j(fe),N(null)):Se==="group"&&fe!==C&&N(fe)}function Qe(){N(null)}function lt(){j(null)}function Ut(){R(null),I(null),N(null),j(null)}async function bn(F,fe,z){if(F.preventDefault(),F.stopPropagation(),!C||Se!=="category"){Ut();return}const K=e[C];if(!K)return;const te=z==="ungrouped"?null:z,ue=Object.entries(e).filter(([ve,Te])=>(Te.category_group_id||"ungrouped")===z),Ae={};Object.entries(e).forEach(([ve,Te])=>{ve!==C&&(Ae[ve]=Te)});let pe;if(fe==="__group_end__"||ue.length===0||!ue.find(([ve])=>ve===fe))pe=(ue.length>0?Math.max(...ue.filter(([Te])=>Te!==C).map(([Te,Le])=>Le.sort_order)):-1)+1;else{const ve=ue.find(([Te])=>Te===fe);ve?(pe=ve[1].sort_order,Object.entries(Ae).forEach(([Te,Le])=>{(Le.category_group_id||"ungrouped")===z&&Le.sort_order>=pe&&(Ae[Te]={...Le,sort_order:Le.sort_order+1})})):pe=0}if(Ae[C]={...K,category_group_id:te,sort_order:pe},n(Ae),Ut(),!!i)try{await se(Ae)}catch(ve){p(ve instanceof Error?ve.message:"Failed to save changes")}}async function Jt(F,fe){F.preventDefault(),Se==="category"?await bn(F,"__group_end__",fe):Se==="group"&&await mn(F,fe)}function Nn(F,fe){F.stopPropagation(),R("group"),I(fe),F.dataTransfer.effectAllowed="move"}async function mn(F,fe){if(F.preventDefault(),!C||Se!=="group"||C===fe){Ut();return}const z=s.findIndex(Ae=>Ae.id===C),K=[...s],[te]=K.splice(z,1);if(fe==="__end__")K.push(te);else{const Ae=K.findIndex(pe=>pe.id===fe);K.splice(Ae,0,te)}const ue=K.map((Ae,pe)=>({...Ae,sort_order:pe}));if(o(ue),Ut(),!!i)try{await $(ue)}catch(Ae){p(Ae instanceof Error?Ae.message:"Failed to save new order")}}async function Gn(F,fe){const z=e[F];if(!z)return;const K=z.category_group_id||"ungrouped",te=Object.entries(e).filter(([Le,Re])=>(Re.category_group_id||"ungrouped")===K).sort((Le,Re)=>Le[1].sort_order-Re[1].sort_order),ue=te.findIndex(([Le])=>Le===F),Ae=fe==="up"?ue-1:ue+1;if(Ae<0||Ae>=te.length)return;const[pe,ve]=te[Ae],Te={};if(Object.entries(e).forEach(([Le,Re])=>{Le===F?Te[Le]={...Re,sort_order:ve.sort_order}:Le===pe?Te[Le]={...Re,sort_order:z.sort_order}:Te[Le]=Re}),n(Te),!!i)try{await se(Te)}catch(Le){n(e),p(Le instanceof Error?Le.message:"Failed to move category")}}async function kt(F,fe){const z=[...s].sort((pe,ve)=>pe.sort_order-ve.sort_order),K=z.findIndex(pe=>pe.id===F),te=fe==="up"?K-1:K+1;if(te<0||te>=z.length)return;const[ue]=z.splice(K,1);z.splice(te,0,ue);const Ae=z.map((pe,ve)=>({...pe,sort_order:ve}));if(o(Ae),!!i)try{await $(Ae)}catch(pe){o(s),p(pe instanceof Error?pe.message:"Failed to move group")}}const Zt=Object.entries(e).reduce((F,[fe,z])=>{const K=z.category_group_id||"ungrouped";return F[K]||(F[K]=[]),F[K].push([fe,z]),F},{}),tt=[...s].sort((F,fe)=>F.sort_order-fe.sort_order);return i?f.jsxs("div",{children:[f.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),f.jsxs("p",{style:qh,children:["Organize your spending categories into groups.",f.jsx("br",{}),f.jsx("span",{style:{fontSize:"0.9rem"},children:y?"Use  buttons to reorder items, or drag to move between groups.":"Drag categories between groups, or use  buttons to reorder."})]}),g&&f.jsx(au,{message:g,onDismiss:()=>p(null)}),f.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[f.jsxs(es,{style:{flex:1,minWidth:"120px"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Categories"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:Object.keys(e).length})]}),f.jsxs(es,{style:{flex:1,minWidth:"120px"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Groups"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:s.length})]}),f.jsxs(es,{style:{flex:1,minWidth:"120px"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"On-Budget"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:Yr(d())},children:Kt(d())})]}),f.jsxs(es,{style:{flex:1,minWidth:"120px"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Allocated"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:Ee.primary},children:x?"...":Kt(Object.values(b).reduce((F,fe)=>F+fe,0))})]}),f.jsxs(es,{style:{flex:1,minWidth:"120px"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Available"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:Yr(d()-Object.values(b).reduce((F,fe)=>F+fe,0))},children:x?"...":Kt(d()-Object.values(b).reduce((F,fe)=>F+fe,0))})]})]}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(e).length===0&&s.length===0&&f.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),tt.map((F,fe)=>{const z=(Zt[F.id]||[]).sort((Re,at)=>Re[1].sort_order-at[1].sort_order),K=Se==="group"&&C===F.id,te=Se==="group"&&L===F.id,ue=Se==="category"&&B===F.id,Ae=C&&Se==="category"?e[C]:null,pe=Ae&&(Ae.category_group_id||"ungrouped")!==F.id,ve=Se==="group"&&te&&C!==F.id,Te=fe>0,Le=fe<tt.length-1;return f.jsxs("div",{children:[Se==="group"&&!K&&f.jsxs("div",{onDragOver:Re=>{Re.preventDefault(),N(F.id)},onDragLeave:Qe,onDrop:Re=>mn(Re,F.id),style:{position:"relative",height:ve?"2.5rem":"0.5rem",marginBottom:ve?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[f.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:Ee.primary,borderRadius:"2px",opacity:ve?1:0,transition:"opacity 0.15s",boxShadow:ve?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),ve&&f.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),f.jsx("div",{onDragOver:Re=>{ke(Re,F.id)},onDragLeave:lt,onDrop:Re=>Jt(Re,F.id),style:{background:K?"color-mix(in srgb, currentColor 3%, transparent)":ue&&pe?`color-mix(in srgb, ${Ee.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:K?.5:1,border:ue&&pe?`2px dashed ${Ee.primary}`:"2px solid transparent",transition:"all 0.15s"},children:q===F.id?f.jsx(lE,{initialData:{name:F.name},onSubmit:Re=>Q(F.id,Re),onCancel:()=>ee(null),submitLabel:"Save"}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:y?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:y?"wrap":"nowrap"},children:[f.jsxs("h3",{style:{...dl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!y&&f.jsx("span",{draggable:!0,onDragStart:Re=>Nn(Re,F.id),onDragEnd:Ut,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),f.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:F.name}),f.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",z.length,")"]})]}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!y&&f.jsx(pt,{variant:"small",onClick:()=>G(F.id),disabled:M!==null,children:"+ Category"}),f.jsx("button",{onClick:()=>ee(F.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),f.jsx("button",{onClick:()=>X(F.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),f.jsxs("div",{style:Up,children:[f.jsx("button",{onClick:()=>kt(F.id,"up"),disabled:!Te,style:{...ul,opacity:Te?.6:.2,cursor:Te?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),f.jsx("button",{onClick:()=>kt(F.id,"down"),disabled:!Le,style:{...ul,opacity:Le?.6:.2,cursor:Le?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),y&&f.jsx("div",{style:{marginBottom:"0.5rem"},children:f.jsx(pt,{variant:"small",onClick:()=>G(F.id),disabled:M!==null,children:"+ Category"})}),f.jsxs("div",{style:Wa,children:[z.map(([Re,at])=>k===Re?f.jsx(Nd,{initialData:{name:at.name,description:at.description,category_group_id:at.category_group_id,default_monthly_amount:at.default_monthly_amount,default_monthly_type:at.default_monthly_type},onSubmit:St=>st(Re,St),onCancel:()=>O(null),submitLabel:"Save",categoryGroups:s,showGroupSelector:!0},Re):f.jsx(ph,{isDragging:Se==="category"&&C===Re,isDragOver:L===Re,onDragStart:St=>{St.stopPropagation(),ne(St,Re)},onDragOver:St=>we(St,Re,F.id),onDragLeave:Qe,onDragEnd:Ut,onDrop:St=>bn(St,Re,F.id),onEdit:()=>O(Re),onDelete:()=>V(Re),onMoveUp:()=>Gn(Re,"up"),onMoveDown:()=>Gn(Re,"down"),canMoveUp:z.findIndex(([St])=>St===Re)>0,canMoveDown:z.findIndex(([St])=>St===Re)<z.length-1,children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[f.jsx("span",{style:gh,children:at.name}),at.default_monthly_amount!==void 0&&at.default_monthly_amount>0&&f.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",at.default_monthly_type==="percentage"?f.jsxs(f.Fragment,{children:[f.jsxs("span",{style:{color:Ee.success,fontWeight:500},children:[at.default_monthly_amount,"%"]})," of prev income"]}):f.jsxs(f.Fragment,{children:[f.jsx("span",{style:{color:Ee.success,fontWeight:500},children:Kt(at.default_monthly_amount)}),"/mo"]})]})]}),at.description&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:at.description}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1rem",fontWeight:600,color:Yr(b[Re]||0)},children:x?"...":Kt(b[Re]||0)})]})},Re)),z.length===0&&!M&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),Se==="category"&&z.length>0&&f.jsx(cE,{groupId:F.id,isActive:L===`__end__${F.id}`,onDragOver:Re=>{Re.preventDefault(),Re.stopPropagation(),N(`__end__${F.id}`),j(F.id)},onDragLeave:Re=>{Re.stopPropagation(),N(null)},onDrop:Re=>{Re.stopPropagation(),bn(Re,"__group_end__",F.id)}}),M===F.id&&f.jsx(Nd,{initialData:{name:"",category_group_id:F.id},onSubmit:Re=>Ue(Re,F.id),onCancel:()=>G(null),submitLabel:"Create",categoryGroups:s})]}),M!==F.id&&f.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:f.jsx(pt,{variant:"small",onClick:()=>G(F.id),disabled:M!==null,children:"+ Add Category"})})]})})]},F.id)}),Se==="group"&&tt.length>0&&f.jsx(Fp,{isActive:L==="__end__",onDragOver:F=>{F.preventDefault(),N("__end__")},onDragLeave:Qe,onDrop:F=>mn(F,"__end__"),label:"Move group to end"}),(()=>{const F=(Zt.ungrouped||[]).sort((te,ue)=>te[1].sort_order-ue[1].sort_order),fe=Se==="category"&&B==="ungrouped",z=C&&Se==="category"?e[C]:null,K=z&&z.category_group_id!==null;return F.length===0&&!M&&s.length>0&&Se!=="category"?null:f.jsxs("div",{onDragOver:te=>ke(te,"ungrouped"),onDragLeave:lt,onDrop:te=>Jt(te,"ungrouped"),style:{background:fe&&K?`color-mix(in srgb, ${Ee.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:fe&&K?`2px dashed ${Ee.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[f.jsxs("h3",{style:{...dl,margin:0,opacity:.7},children:["Uncategorized",f.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",F.length,")"]})]}),f.jsx(pt,{variant:"small",onClick:()=>G("ungrouped"),disabled:M!==null,children:"+ Category"})]}),f.jsxs("div",{style:Wa,children:[F.map(([te,ue])=>k===te?f.jsx(Nd,{initialData:{name:ue.name,description:ue.description,category_group_id:ue.category_group_id,default_monthly_amount:ue.default_monthly_amount,default_monthly_type:ue.default_monthly_type},onSubmit:Ae=>st(te,Ae),onCancel:()=>O(null),submitLabel:"Save",categoryGroups:s,showGroupSelector:!0},te):f.jsx(ph,{isDragging:Se==="category"&&C===te,isDragOver:L===te,onDragStart:Ae=>ne(Ae,te),onDragOver:Ae=>we(Ae,te,"ungrouped"),onDragLeave:Qe,onDragEnd:Ut,onDrop:Ae=>bn(Ae,te,"ungrouped"),onEdit:()=>O(te),onDelete:()=>V(te),onMoveUp:()=>Gn(te,"up"),onMoveDown:()=>Gn(te,"down"),canMoveUp:F.findIndex(([Ae])=>Ae===te)>0,canMoveDown:F.findIndex(([Ae])=>Ae===te)<F.length-1,children:f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[f.jsx("span",{style:gh,children:ue.name}),ue.default_monthly_amount!==void 0&&ue.default_monthly_amount>0&&f.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",ue.default_monthly_type==="percentage"?f.jsxs(f.Fragment,{children:[f.jsxs("span",{style:{color:Ee.success,fontWeight:500},children:[ue.default_monthly_amount,"%"]})," of prev income"]}):f.jsxs(f.Fragment,{children:[f.jsx("span",{style:{color:Ee.success,fontWeight:500},children:Kt(ue.default_monthly_amount)}),"/mo"]})]})]}),ue.description&&f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:ue.description}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1rem",fontWeight:600,color:Yr(b[te]||0)},children:x?"...":Kt(b[te]||0)})]})},te)),F.length===0&&Se==="category"&&f.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),Se==="category"&&F.length>0&&f.jsx(cE,{groupId:"ungrouped",isActive:L==="__end__ungrouped",onDragOver:te=>{te.preventDefault(),te.stopPropagation(),N("__end__ungrouped"),j("ungrouped")},onDragLeave:te=>{te.stopPropagation(),N(null)},onDrop:te=>{te.stopPropagation(),bn(te,"__group_end__","ungrouped")}}),M==="ungrouped"&&f.jsx(Nd,{initialData:{name:"",category_group_id:null},onSubmit:te=>Ue(te,"ungrouped"),onCancel:()=>G(null),submitLabel:"Create",categoryGroups:s})]}),M!=="ungrouped"&&f.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:f.jsx(pt,{variant:"small",onClick:()=>G("ungrouped"),disabled:M!==null,children:"+ Add Category"})})]})})()]}),Ce?f.jsx(lE,{onSubmit:P,onCancel:()=>Me(!1),submitLabel:"Create Group"}):f.jsx(pt,{variant:"primary-large",onClick:()=>Me(!0),children:"+ Add Category Group"})]}):f.jsx("p",{children:"No budget found. Please log in."})}function Nd({initialData:i,onSubmit:e,onCancel:n,submitLabel:s,categoryGroups:o=[],showGroupSelector:c=!1}){const[d,g]=A.useState(i||{name:"",category_group_id:null}),[p,y]=A.useState(i?.default_monthly_amount?.toString()||""),[b,S]=A.useState(i?.default_monthly_type||"fixed"),[x,D]=A.useState(!1);function k(O){if(O.preventDefault(),!d.name.trim())return;D(!0);const M=parseFloat(p),G=!isNaN(M)&&M>0;e({...d,description:d.description?.trim()||void 0,default_monthly_amount:G?M:void 0,default_monthly_type:G?b:void 0})}return f.jsxs(wl,{onSubmit:k,children:[f.jsx(Er,{label:"Category Name",htmlFor:"category-name",children:f.jsx(Xa,{id:"category-name",type:"text",value:d.name,onChange:O=>g({...d,name:O.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),f.jsx(Er,{label:"Description (optional)",htmlFor:"category-description",children:f.jsx(Bp,{id:"category-description",value:d.description||"",onChange:O=>g({...d,description:O.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),c&&f.jsx(Er,{label:"Category Group",htmlFor:"category-group",children:f.jsxs(Bc,{id:"category-group",value:d.category_group_id||"ungrouped",onChange:O=>g({...d,category_group_id:O.target.value==="ungrouped"?null:O.target.value}),children:[f.jsx("option",{value:"ungrouped",children:"Uncategorized"}),o.map(O=>f.jsx("option",{value:O.id,children:O.name},O.id))]})}),f.jsxs(Er,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[f.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[f.jsxs(Bc,{id:"default-type",value:b,onChange:O=>S(O.target.value),style:{width:"auto",flex:"0 0 auto"},children:[f.jsx("option",{value:"fixed",children:"Fixed $"}),f.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),b==="fixed"?f.jsx(ux,{id:"default-amount",value:p,onChange:y,placeholder:"$0.00"}):f.jsx(Xa,{id:"default-amount",type:"number",value:p,onChange:O=>y(O.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),b==="percentage"&&f.jsx("span",{style:{opacity:.6},children:"%"})]}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:b==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),f.jsxs(no,{children:[f.jsx(pt,{type:"submit",isLoading:x,children:s}),f.jsx(pt,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function lE({initialData:i,onSubmit:e,onCancel:n,submitLabel:s}){const[o,c]=A.useState(i||{name:""}),[d,g]=A.useState(!1);function p(y){y.preventDefault(),o.name.trim()&&(g(!0),e(o))}return f.jsxs(wl,{onSubmit:p,children:[f.jsx(Er,{label:"Group Name",htmlFor:"group-name",children:f.jsx(Xa,{id:"group-name",type:"text",value:o.name,onChange:y=>c({...o,name:y.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),f.jsxs(no,{children:[f.jsx(pt,{type:"submit",isLoading:d,children:s}),f.jsx(pt,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function cE({isActive:i,onDragOver:e,onDragLeave:n,onDrop:s}){return f.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:s,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[f.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:Ee.primary,borderRadius:"2px",opacity:i?1:.3,transition:"opacity 0.15s",boxShadow:i?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),i&&f.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}const uE="admin_active_tab",Fj=["my-budgets","accounts","categories","users","migration","feedback","tests"];function Hj(){const{currentBudget:i,loading:e,isOwner:n,isAdmin:s,isTest:o}=hs(),c=Kr(),d=c.pathname.includes("/admin/accounts"),g=c.pathname.includes("/admin/categories"),p=c.pathname.includes("/admin/users"),y=c.pathname.includes("/admin/migration"),b=c.pathname.includes("/admin/feedback"),S=c.pathname.includes("/admin/my-budgets"),x=c.pathname.includes("/admin/tests"),D=c.pathname==="/budget/admin";A.useEffect(()=>{if(D)return;let q="my-budgets";d?q="accounts":g?q="categories":p?q="users":y?q="migration":b?q="feedback":x&&(q="tests"),localStorage.setItem(uE,q)},[c.pathname,D,d,g,p,y,b,S,x]);function k(){const q=localStorage.getItem(uE);return!q||!Fj.includes(q)||q==="users"&&!n||(q==="migration"||q==="feedback")&&!s||q==="tests"&&!o?"my-budgets":q}if(e)return f.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:f.jsx("p",{children:"Loading..."})});const O=p,M=y||b,G=x;return!n&&O||!s&&M||!o&&G?f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("nav",{style:{marginBottom:"1.5rem"},children:f.jsx(hn,{to:"/budget",children:" Back to Budget"})}),f.jsx("h1",{children:"Access Denied"}),f.jsx("p",{style:{opacity:.7},children:G?"Only test users can access this section.":M?"Only administrators can access this section.":"Only the budget owner can access this section."}),f.jsx("p",{style:{marginTop:"1rem"},children:f.jsx(hn,{to:"/budget/admin/my-budgets",style:{color:"#646cff"},children:"Go to My Budgets "})})]}):f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("nav",{style:{marginBottom:"1.5rem"},children:f.jsx(hn,{to:"/budget",children:" Back to Budget"})}),f.jsx("h1",{children:n?"Admin Settings":"Budget Settings"}),f.jsx("p",{style:{opacity:.7,marginBottom:"0.5rem"},children:n?"Manage your budget settings, users, and data migration.":"Manage your budgets, accounts, and categories."}),i&&f.jsxs("div",{style:{opacity:.6,marginBottom:"1.5rem",fontSize:"0.9rem",display:"flex",flexDirection:"column",gap:"0.25rem"},children:[f.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""}),f.jsxs("span",{children:["Budget Name: ",f.jsx("strong",{style:{opacity:1},children:i.name})]})]}),f.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""}),f.jsxs("span",{children:["Budget ID: ",f.jsx("code",{style:{opacity:1,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.1rem 0.4rem",borderRadius:"4px",fontSize:"0.85rem"},children:i.id})]})]}),f.jsxs("p",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""}),f.jsxs("span",{children:["Budget Owner: ",f.jsx("strong",{style:{opacity:1},children:i.owner_email||i.owner_id})]})]})]}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"2rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",paddingBottom:"1rem",flexWrap:"wrap"},children:[f.jsx(hn,{to:"/budget/admin/my-budgets",style:{padding:"0.5rem 1rem",borderRadius:"6px",textDecoration:"none",color:"inherit",background:S?"color-mix(in srgb, #646cff 20%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:S?"1px solid #646cff":"1px solid transparent",fontWeight:S?500:400},children:" My Budgets"}),f.jsx(hn,{to:"/budget/admin/accounts",style:{padding:"0.5rem 1rem",borderRadius:"6px",textDecoration:"none",color:"inherit",background:d?"color-mix(in srgb, #646cff 20%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:d?"1px solid #646cff":"1px solid transparent",fontWeight:d?500:400},children:" Accounts"}),f.jsx(hn,{to:"/budget/admin/categories",style:{padding:"0.5rem 1rem",borderRadius:"6px",textDecoration:"none",color:"inherit",background:g?"color-mix(in srgb, #646cff 20%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:g?"1px solid #646cff":"1px solid transparent",fontWeight:g?500:400},children:" Categories"}),n&&f.jsx(hn,{to:"/budget/admin/users",style:{padding:"0.5rem 1rem",borderRadius:"6px",textDecoration:"none",color:"inherit",background:p?"color-mix(in srgb, #646cff 20%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:p?"1px solid #646cff":"1px solid transparent",fontWeight:p?500:400},children:" Users"}),s&&f.jsxs(f.Fragment,{children:[f.jsx(hn,{to:"/budget/admin/migration",style:{padding:"0.5rem 1rem",borderRadius:"6px",textDecoration:"none",color:"inherit",background:y?"color-mix(in srgb, #646cff 20%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:y?"1px solid #646cff":"1px solid transparent",fontWeight:y?500:400},children:" Migration"}),f.jsx(hn,{to:"/budget/admin/feedback",style:{padding:"0.5rem 1rem",borderRadius:"6px",textDecoration:"none",color:"inherit",background:b?"color-mix(in srgb, #646cff 20%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:b?"1px solid #646cff":"1px solid transparent",fontWeight:b?500:400},children:" Feedback"})]}),o&&f.jsx(hn,{to:"/budget/admin/tests",style:{padding:"0.5rem 1rem",borderRadius:"6px",textDecoration:"none",color:"inherit",background:x?"color-mix(in srgb, #ff6b6b 20%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:x?"1px solid #ff6b6b":"1px solid transparent",fontWeight:x?500:400},children:" Tests"})]}),D?f.jsx(AE,{to:`/budget/admin/${k()}`,replace:!0}):f.jsx($g,{})]})}function qj(){const{currentBudget:i,currentUserId:e,budgetUserIds:n,acceptedUserIds:s,inviteUserToBudget:o,revokeUserFromBudget:c}=hs(),[d,g]=A.useState(""),[p,y]=A.useState(!1),[b,S]=A.useState(null),[x,D]=A.useState(null);if(!i)return f.jsx("p",{children:"No budget found."});async function k(q){if(q.preventDefault(),!(!d.trim()||!i)){y(!0),S(null),D(null);try{await o(d.trim()),g(""),D("Invite sent! The user can now accept the invitation from their account.")}catch(ee){S(ee instanceof Error?ee.message:"Failed to invite user")}finally{y(!1)}}}async function O(q){if(!i)return;if(q===i.owner_id){S("Cannot revoke the budget owner");return}if(q===e){S("Cannot revoke yourself from the budget");return}const ee=s.includes(q);if(confirm(ee?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){S(null),D(null);try{await c(q),D(ee?"User access revoked.":"Invitation cancelled.")}catch(Me){S(Me instanceof Error?Me.message:"Failed to revoke user")}}}const M=n.filter(q=>s.includes(q)),G=n.filter(q=>!s.includes(q));return f.jsxs("div",{children:[f.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),f.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),b&&f.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:b}),f.jsx("button",{onClick:()=>S(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),x&&f.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:x}),f.jsx("button",{onClick:()=>D(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[f.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",M.length,")"]}),M.length===0?f.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:M.map(q=>{const ee=q===i.owner_id,Ce=q===e;return f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[f.jsx("div",{style:{flex:1,minWidth:0},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[f.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:q}),ee&&f.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),Ce&&f.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!ee&&!Ce&&f.jsx("button",{onClick:()=>O(q),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},q)})})]}),G.length>0&&f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[f.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",G.length,")"]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:G.map(q=>f.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[f.jsx("div",{style:{flex:1,minWidth:0},children:f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[f.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:q}),f.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),f.jsx("button",{onClick:()=>O(q),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},q))})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[f.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),f.jsxs("form",{onSubmit:k,style:{display:"flex",gap:"0.75rem"},children:[f.jsx("input",{type:"text",value:d,onChange:q=>g(q.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),f.jsx("button",{type:"submit",disabled:p||!d.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p||!d.trim()?"not-allowed":"pointer",fontWeight:500,opacity:p||!d.trim()?.7:1,whiteSpace:"nowrap"},children:p?"Inviting...":"Send Invite"})]}),f.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),f.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:i.id})]})]})}function Gj(){return f.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:"0.5rem",verticalAlign:"middle"}})}function $j(){const i=ru(),{currentBudget:e}=hs(),n=A.useRef(!1),[s,o]=A.useState({categoriesArrayMigrationNeeded:!1,accountsArrayMigrationNeeded:!1,budgetsToMigrateCategories:0,budgetsToMigrateAccounts:0,loading:!0}),[c,d]=A.useState(!1),[g,p]=A.useState(null),y=eo(ga),b=i.get_current_firebase_user();A.useEffect(()=>{async function O(){if(!b||n.current){o(M=>({...M,loading:!1}));return}n.current=!0;try{const M=Ke(y,"users",b.uid),G=await ht(M);if(!G.exists()){o({categoriesArrayMigrationNeeded:!1,accountsArrayMigrationNeeded:!1,budgetsToMigrateCategories:0,budgetsToMigrateAccounts:0,loading:!1});return}const ee=G.data().budget_ids||[];let Ce=0,Me=0;for(const Se of ee){const R=Ke(y,"budgets",Se),C=await ht(R);if(C.exists()){const I=C.data();Array.isArray(I.categories)&&Ce++,Array.isArray(I.accounts)&&Me++}}o({categoriesArrayMigrationNeeded:Ce>0,accountsArrayMigrationNeeded:Me>0,budgetsToMigrateCategories:Ce,budgetsToMigrateAccounts:Me,loading:!1})}catch(M){console.error("Error checking migration status:",M),o({categoriesArrayMigrationNeeded:!1,accountsArrayMigrationNeeded:!1,budgetsToMigrateCategories:0,budgetsToMigrateAccounts:0,loading:!1})}}O()},[b,y]);async function S(O,M){const G={};M.forEach(q=>{G[q]=0});try{const q=Fa(Ys(y,"months"),Ha("budget_id","==",O));(await Qs(q)).forEach(Ce=>{const Me=Ce.data();if(Me.allocations_finalized&&Me.allocations)for(const Se of Me.allocations)G[Se.category_id]=(G[Se.category_id]||0)+Se.amount})}catch(q){console.error("Error calculating balances for budget:",O,q)}return G}async function x(){if(!b)return;d(!0),p(null);const O=[];try{const M=Ke(y,"users",b.uid),G=await ht(M);if(!G.exists()){p([{budgetId:"",budgetName:"No user document found",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"User document not found"}]),d(!1);return}const ee=G.data().budget_ids||[];for(const Ce of ee)try{const Me=Ke(y,"budgets",Ce),Se=await ht(Me);if(!Se.exists()){O.push({budgetId:Ce,budgetName:"Unknown",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Budget not found"});continue}const R=Se.data(),C=R.name||"Unnamed Budget",I=Array.isArray(R.categories),L=Array.isArray(R.accounts),N=Array.isArray(R.account_groups);if(!I&&!L&&!N){O.push({budgetId:Ce,budgetName:C,categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Already migrated"});continue}let B=R.categories,j=R.accounts,Fe=R.account_groups,dt=0,se=0,$=0,Ie=!1;if(I){const V=R.categories,P={},Q=[];for(const we of V){const ke=we.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;Q.push(ke),P[ke]={name:we.name,description:we.description,category_group_id:we.category_group_id??null,sort_order:we.sort_order??0,default_monthly_amount:we.default_monthly_amount,default_monthly_type:we.default_monthly_type,balance:0}}const X=await S(Ce,Q);for(const we of Q)P[we]&&(P[we].balance=X[we]||0);const ne={};Object.entries(P).forEach(([we,ke])=>{ne[we]={name:ke.name,category_group_id:ke.category_group_id??null,sort_order:ke.sort_order,balance:ke.balance},ke.description&&(ne[we].description=ke.description),ke.default_monthly_amount!==void 0&&(ne[we].default_monthly_amount=ke.default_monthly_amount),ke.default_monthly_type!==void 0&&(ne[we].default_monthly_type=ke.default_monthly_type)}),B=ne,dt=V.length,Ie=!0}if(L){const V=R.accounts,P={};for(const Q of V){const X=Q.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;P[X]={nickname:Q.nickname,balance:Q.balance??0,account_group_id:Q.account_group_id??null,sort_order:Q.sort_order??0},Q.is_income_account!==void 0&&(P[X].is_income_account=Q.is_income_account),Q.is_income_default!==void 0&&(P[X].is_income_default=Q.is_income_default),Q.is_outgo_account!==void 0&&(P[X].is_outgo_account=Q.is_outgo_account),Q.is_outgo_default!==void 0&&(P[X].is_outgo_default=Q.is_outgo_default),Q.on_budget!==void 0&&(P[X].on_budget=Q.on_budget),Q.is_active!==void 0&&(P[X].is_active=Q.is_active)}j=P,se=V.length}if(N){const V=R.account_groups,P={};for(const Q of V){const X=Q.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;P[X]={name:Q.name,sort_order:Q.sort_order??0},Q.expected_balance!==void 0&&(P[X].expected_balance=Q.expected_balance),Q.on_budget!==void 0&&(P[X].on_budget=Q.on_budget),Q.is_active!==void 0&&(P[X].is_active=Q.is_active)}if(L&&j){const Q=j,X=R.account_groups,ne={};X.forEach((we,ke)=>{const Qe=we.id||String(ke),lt=Object.keys(P)[ke];lt&&(ne[Qe]=lt)}),Object.entries(Q).forEach(([we,ke])=>{ke.account_group_id&&ne[ke.account_group_id]&&(Q[we].account_group_id=ne[ke.account_group_id])})}Fe=P,$=V.length}const{category_balances:Ue,...st}=R;await vt(Me,{...st,categories:B,accounts:j,account_groups:Fe}),O.push({budgetId:Ce,budgetName:C,categoriesMigrated:dt,accountsMigrated:se,accountGroupsMigrated:$,balancesCalculated:Ie})}catch(Me){O.push({budgetId:Ce,budgetName:"Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:Me instanceof Error?Me.message:"Migration failed"})}p(O),o({categoriesArrayMigrationNeeded:!1,accountsArrayMigrationNeeded:!1,budgetsToMigrateCategories:0,budgetsToMigrateAccounts:0,loading:!1})}catch(M){p([{budgetId:"",budgetName:"Migration Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:M instanceof Error?M.message:"Migration failed"}])}finally{d(!1)}}const D=s.categoriesArrayMigrationNeeded||s.accountsArrayMigrationNeeded,k=Math.max(s.budgetsToMigrateCategories,s.budgetsToMigrateAccounts);return s.loading?f.jsxs("div",{children:[f.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),f.jsx("h2",{style:{marginTop:0},children:"Data Migrations"}),f.jsx("p",{style:{opacity:.7},children:"Checking migration status..."})]}):f.jsxs("div",{children:[f.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),f.jsx("h2",{style:{marginTop:0},children:"Data Migrations"}),f.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Run migrations to update your budget data structure."}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[f.jsxs("h3",{style:{marginTop:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{style:{background:D?"rgba(100, 108, 255, 0.2)":"rgba(34, 197, 94, 0.2)",color:D?"#a5b4fc":"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:D?"Required":"Complete"}),"Migrate Data to Map Structure"]}),f.jsx("p",{style:{opacity:.7,marginBottom:"1rem"},children:"Converts categories, accounts, and account groups from array format to map structure. This improves performance and enables direct lookup by ID."}),c?f.jsxs("div",{style:{background:"rgba(100, 108, 255, 0.1)",border:"1px solid rgba(100, 108, 255, 0.3)",color:"#a5b4fc",padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:[f.jsx(Gj,{})," Running migration across all budgets..."]}):D?f.jsxs(f.Fragment,{children:[f.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",color:"#fbbf24",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem"},children:[f.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",k," budget(s) needing migration:"]}),f.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[s.budgetsToMigrateCategories>0&&f.jsxs("li",{children:[s.budgetsToMigrateCategories," with categories to migrate"]}),s.budgetsToMigrateAccounts>0&&f.jsxs("li",{children:[s.budgetsToMigrateAccounts," with accounts to migrate"]})]})]}),f.jsx("button",{onClick:x,disabled:!b,style:{background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:b?"pointer":"not-allowed",fontWeight:500,opacity:b?1:.7},children:"Migrate All Budgets"})]}):f.jsx("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px"},children:" All budgets are using the new map structure"}),g&&f.jsxs("div",{style:{marginTop:"1rem"},children:[f.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem"},children:"Migration Results:"}),f.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:g.map((O,M)=>f.jsxs("div",{style:{padding:"0.5rem",marginBottom:M<g.length-1?"0.5rem":0,borderRadius:"4px",background:O.error&&O.error!=="Already migrated"?"rgba(220, 38, 38, 0.1)":O.error==="Already migrated"?"rgba(100, 100, 100, 0.1)":"rgba(34, 197, 94, 0.1)",border:O.error&&O.error!=="Already migrated"?"1px solid rgba(220, 38, 38, 0.3)":O.error==="Already migrated"?"1px solid rgba(100, 100, 100, 0.3)":"1px solid rgba(34, 197, 94, 0.3)"},children:[f.jsxs("div",{style:{fontWeight:500},children:[O.error&&O.error!=="Already migrated"?"":O.error==="Already migrated"?"":""," ",O.budgetName]}),O.error&&O.error!=="Already migrated"?f.jsxs("div",{style:{fontSize:"0.85rem",opacity:.8,color:"#f87171"},children:["Error: ",O.error]}):O.error==="Already migrated"?f.jsx("div",{style:{fontSize:"0.85rem",opacity:.6},children:"Already using map structure"}):f.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7},children:[O.categoriesMigrated>0&&`Migrated ${O.categoriesMigrated} categories`,O.categoriesMigrated>0&&(O.accountsMigrated>0||O.accountGroupsMigrated>0)&&", ",O.accountsMigrated>0&&`${O.accountsMigrated} accounts`,O.accountsMigrated>0&&O.accountGroupsMigrated>0&&", ",O.accountGroupsMigrated>0&&`${O.accountGroupsMigrated} account groups`,O.balancesCalculated&&" with calculated balances"]})]},M))})]})]}),e&&f.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:f.jsxs("p",{style:{margin:0,opacity:.7},children:[f.jsx("strong",{children:"Note:"}),' This migration will process all budgets you have access to, not just "',e.name,'". After migration, reload the page to see updated data.']})})]})}const _h={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function Yj(){const[i,e]=A.useState([]),[n,s]=A.useState(!0),[o,c]=A.useState(null),[d,g]=A.useState(null),[p,y]=A.useState(null),[b,S]=A.useState(!1),[x,D]=A.useState(""),[k,O]=A.useState("bug"),[M,G]=A.useState(!1),[q,ee]=A.useState(null),[Ce,Me]=A.useState(null),Se=A.useContext(qc),R=eo(ga);A.useEffect(()=>{C()},[]);async function C(){try{const P=Ys(R,"feedback"),Q=await Qs(P),X=[];Q.forEach(ne=>{const we=ne.data();we.items&&we.items.forEach(ke=>{X.push({...ke,user_email:we.user_email,doc_id:ne.id})})}),e(X)}catch(P){c(P instanceof Error?P.message:"Failed to load feedback")}finally{s(!1)}}async function I(P){if(P.preventDefault(),!(!x.trim()||!Se.username)){G(!0),c(null);try{const Q=Se.username.replace(/[.@]/g,"_"),X=Ke(R,"feedback",Q),ne={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:x.trim(),created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:k};(await ht(X)).exists()?await vt(X,{items:xT(ne)},{merge:!0}):await vt(X,{user_email:Se.username,items:[ne]}),e(ke=>[...ke,{...ne,user_email:Se.username,doc_id:Q}]),D(""),O("bug"),S(!1)}catch(Q){c(Q instanceof Error?Q.message:"Failed to add feedback")}finally{G(!1)}}}async function L(P){try{const Q=Ke(R,"feedback",P.doc_id),X=await ht(Q);if(X.exists()){const ne=X.data(),we=ne.items.map(ke=>ke.id===P.id?{id:P.id,text:P.text,created_at:P.created_at,is_done:P.is_done,completed_at:P.completed_at,sort_order:P.sort_order,feedback_type:P.feedback_type||"bug"}:ke);await vt(Q,{...ne,items:we})}}catch(Q){c(Q instanceof Error?Q.message:"Failed to update feedback")}}function N(P){P.is_done?B(P):ee(P)}async function B(P){const Q={...P,is_done:!P.is_done,completed_at:P.is_done?null:new Date().toISOString()};e(X=>X.map(ne=>ne.id===P.id?Q:ne)),await L(Q)}function j(){q&&(B(q),ee(null))}async function Fe(P){if(!Ce)return;const Q={...Ce,feedback_type:P};e(X=>X.map(ne=>ne.id===Ce.id?Q:ne)),Me(null),await L(Q)}const dt=i.filter(P=>!P.is_done).sort((P,Q)=>P.sort_order-Q.sort_order),se=i.filter(P=>P.is_done).sort((P,Q)=>{const X=P.completed_at?new Date(P.completed_at).getTime():0;return(Q.completed_at?new Date(Q.completed_at).getTime():0)-X});function $(P,Q){g(Q),P.dataTransfer.effectAllowed="move"}function Ie(P,Q){P.preventDefault(),Q!==d&&y(Q)}function Ue(){y(null)}function st(){g(null),y(null)}async function V(P,Q){if(P.preventDefault(),!d||d===Q){st();return}const X=dt.findIndex(Qe=>Qe.id===d),ne=[...dt],[we]=ne.splice(X,1);if(Q==="__end__")ne.push(we);else{const Qe=ne.findIndex(lt=>lt.id===Q);ne.splice(Qe,0,we)}const ke=ne.map((Qe,lt)=>({...Qe,sort_order:lt}));e(Qe=>[...Qe.filter(lt=>lt.is_done),...ke]),st();for(const Qe of ke)await L(Qe)}return n?f.jsx("p",{children:"Loading feedback..."}):f.jsxs("div",{children:[f.jsx("h2",{style:{marginTop:0},children:"Feedback"}),f.jsx("p",{style:{...qh,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),o&&f.jsx(au,{message:o,onDismiss:()=>c(null)}),f.jsxs("div",{style:Wa,children:[dt.length===0&&!b&&f.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),dt.map(P=>f.jsx(Qj,{item:P,isDragging:d===P.id,isDragOver:p===P.id,onDragStart:Q=>$(Q,P.id),onDragOver:Q=>Ie(Q,P.id),onDragLeave:Ue,onDragEnd:st,onDrop:Q=>V(Q,P.id),onToggleDone:()=>N(P),onTypeClick:()=>Me(P)},P.id)),d&&dt.length>0&&f.jsx(Fp,{isActive:p==="__end__",onDragOver:P=>Ie(P,"__end__"),onDragLeave:Ue,onDrop:P=>V(P,"__end__")})]}),b?f.jsxs(wl,{onSubmit:I,children:[f.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(P=>{const Q=_h[P],X=k===P;return f.jsxs("button",{type:"button",onClick:()=>O(P),style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${Q.color}`,borderRadius:"0.5rem",background:X?Q.bgColor:"transparent",color:X?Q.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:X?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:X?1:.5,boxShadow:X?`0 0 12px ${Q.bgColor}`:"none",position:"relative"},children:[Q.label,X&&f.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},P)})}),f.jsx(Bp,{value:x,onChange:P=>D(P.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),f.jsxs(no,{children:[f.jsx(pt,{type:"submit",isLoading:M,disabled:!x.trim(),children:"Add Feedback"}),f.jsx(pt,{type:"button",variant:"secondary",onClick:()=>{S(!1),D(""),O("bug")},children:"Cancel"})]})]}):f.jsx(pt,{variant:"primary-large",onClick:()=>S(!0),children:"+ Add Feedback"}),se.length>0&&f.jsx(jj,{title:"Completed",count:se.length,children:f.jsx("div",{style:{...Wa,marginTop:"0.5rem"},children:se.map(P=>f.jsxs("div",{style:{...iu,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[f.jsx("input",{type:"checkbox",checked:P.is_done,onChange:()=>N(P),style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:Ee.primary,flexShrink:0}}),f.jsx(dx,{type:P.feedback_type,onClick:()=>Me(P)})]}),f.jsxs("div",{style:{marginLeft:"2rem"},children:[f.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:P.text}),f.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[P.user_email,"  Created: ",Pg(P.created_at)]}),P.completed_at&&f.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:Ee.success},children:[" Completed: ",Pg(P.completed_at)]})]})]},P.id))})}),f.jsxs(yh,{isOpen:q!==null,onClose:()=>ee(null),title:"Mark as Complete",children:[f.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),q&&f.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',q.text,'"']}),f.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[f.jsx(pt,{variant:"secondary",onClick:()=>ee(null),children:"Cancel"}),f.jsx(pt,{variant:"primary",onClick:j,children:"Mark Complete"})]})]}),f.jsxs(yh,{isOpen:Ce!==null,onClose:()=>Me(null),title:"Change Feedback Type",children:[f.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),f.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(P=>{const Q=_h[P],X=Ce?.feedback_type==="feature"?"new_feature":Ce?.feedback_type,ne=X===P||!X&&P==="bug";return f.jsxs("button",{type:"button",onClick:()=>Fe(P),style:{flex:1,padding:"0.75rem 0.5rem",border:`2px solid ${Q.color}`,borderRadius:"0.5rem",background:ne?Q.bgColor:"transparent",color:ne?Q.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:ne?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:ne?1:.5,boxShadow:ne?`0 0 12px ${Q.bgColor}`:"none",position:"relative"},children:[Q.label,ne&&f.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},P)})}),f.jsx(pt,{variant:"secondary",onClick:()=>Me(null),style:{width:"100%"},children:"Cancel"})]})]})}function dx({type:i,onClick:e}){const n=i==="feature"?"new_feature":i,s=n&&n in _h?n:"bug",o=_h[s];return f.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:o.bgColor,color:o.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:c=>{c.currentTarget.style.opacity="0.8",c.currentTarget.style.transform="scale(1.05)"},onMouseLeave:c=>{c.currentTarget.style.opacity="1",c.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:o.label})}function Qj({item:i,isDragging:e,isDragOver:n,onDragStart:s,onDragOver:o,onDragLeave:c,onDragEnd:d,onDrop:g,onToggleDone:p,onTypeClick:y}){return f.jsxs("div",{onDragOver:b=>{b.stopPropagation(),o(b)},onDragLeave:b=>{b.stopPropagation(),c()},onDrop:b=>{b.stopPropagation(),g(b)},style:{position:"relative"},children:[f.jsx("div",{style:{...cx,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),f.jsxs("div",{draggable:!0,onDragStart:s,onDragEnd:d,style:{...iu,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[f.jsx("span",{style:{...lx},children:""}),f.jsx("input",{type:"checkbox",checked:i.is_done,onChange:p,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:Ee.primary,flexShrink:0}}),f.jsx(dx,{type:i.feedback_type,onClick:y})]}),f.jsxs("div",{style:{marginLeft:"3.25rem"},children:[f.jsx("p",{style:{margin:0,lineHeight:1.5},children:i.text}),f.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[i.user_email,"  ",Pg(i.created_at)]})]})]})]})}function Kj(){const{currentUserId:i}=hs(),[e,n]=A.useState([]),[s,o]=A.useState(!1),c=eo(ga);function d(D,k){n(O=>O.map(M=>M.name===D?{...M,...k}:M))}async function g(){o(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await p("Read unauthorized budget",async()=>{const O=Ke(c,"budgets","unauthorized_budget_test_12345");return await ht(O),"Was able to read budget (unexpected)"},!0),await p("Read another user's document",async()=>{const O=Ke(c,"users","another_user_test_12345");return await ht(O),"Was able to read user document (unexpected)"},!0),await p("Read unauthorized budget month",async()=>{const M=Ke(c,"months","unauthorized_budget_test_12345_2024_01");return await ht(M),"Was able to read month document for unauthorized budget (unexpected)"},!0),await p("Toggle is_admin in own permission_flags",async()=>{if(!i)throw new Error("Not authenticated");const k=Ke(c,"users",i),M=(await ht(k)).data()?.permission_flags?.is_admin??!1;return await Od(k,{"permission_flags.is_admin":!M}),`Was able to change is_admin from ${M} to ${!M} (SECURITY ISSUE!)`},!0),await p("Toggle is_test in own permission_flags",async()=>{if(!i)throw new Error("Not authenticated");const k=Ke(c,"users",i),M=(await ht(k)).data()?.permission_flags?.is_test??!1;return await Od(k,{"permission_flags.is_test":!M}),`Was able to change is_test from ${M} to ${!M} (SECURITY ISSUE!)`},!0),await p("Read own user document",async()=>{if(!i)throw new Error("Not authenticated");const k=Ke(c,"users",i);if((await ht(k)).exists())return"Successfully read own document";throw new Error("Document does not exist")},!1),o(!1)}async function p(D,k,O){d(D,{status:"running",message:"Running..."});try{const M=await k();O?d(D,{status:"failed",message:` ${M}`}):d(D,{status:"passed",message:` ${M}`})}catch(M){const G=M instanceof Error?M.message:"Unknown error";O?d(D,{status:"passed",message:` Blocked as expected: ${G}`}):d(D,{status:"failed",message:` ${G}`})}}async function y(D){switch(e.find(O=>O.name===D)||n(O=>[...O,{name:D,status:"pending",message:"",expectedToFail:!0}]),o(!0),D){case"Read unauthorized budget":await p(D,async()=>{const M=Ke(c,"budgets","unauthorized_budget_test_12345");return await ht(M),"Was able to read budget (unexpected)"},!0);break;case"Read another user's document":await p(D,async()=>{const M=Ke(c,"users","another_user_test_12345");return await ht(M),"Was able to read user document (unexpected)"},!0);break;case"Read unauthorized budget month":await p(D,async()=>{const G=Ke(c,"months","unauthorized_budget_test_12345_2024_01");return await ht(G),"Was able to read month document for unauthorized budget (unexpected)"},!0);break;case"Toggle is_admin in own permission_flags":await p(D,async()=>{if(!i)throw new Error("Not authenticated");const O=Ke(c,"users",i),G=(await ht(O)).data()?.permission_flags?.is_admin??!1;return await Od(O,{"permission_flags.is_admin":!G}),`Was able to change is_admin from ${G} to ${!G} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await p(D,async()=>{if(!i)throw new Error("Not authenticated");const O=Ke(c,"users",i),G=(await ht(O)).data()?.permission_flags?.is_test??!1;return await Od(O,{"permission_flags.is_test":!G}),`Was able to change is_test from ${G} to ${!G} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await p(D,async()=>{if(!i)throw new Error("Not authenticated");const O=Ke(c,"users",i);if((await ht(O)).exists())return"Successfully read own document";throw new Error("Document does not exist")},!1);break}o(!1)}const b=e.filter(D=>D.status==="passed").length,S=e.filter(D=>D.status==="failed").length,x=e.length;return f.jsxs("div",{children:[f.jsx("p",{style:qh,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),f.jsx("div",{style:{marginBottom:"1.5rem"},children:f.jsx(pt,{onClick:g,disabled:s,variant:"primary",children:s?"Running Tests...":"Run All Tests"})}),e.length>0&&f.jsx("div",{style:{marginBottom:"1.5rem"},children:f.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[f.jsxs("span",{children:["Total: ",f.jsx("strong",{children:x})]}),f.jsxs("span",{style:{color:Ee.success},children:["Passed: ",f.jsx("strong",{children:b})]}),f.jsxs("span",{style:{color:Ee.danger},children:["Failed: ",f.jsx("strong",{children:S})]})]})}),f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[f.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),f.jsx(qo,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(D=>D.name==="Read unauthorized budget"),onRun:()=>y("Read unauthorized budget"),disabled:s}),f.jsx(qo,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(D=>D.name==="Read another user's document"),onRun:()=>y("Read another user's document"),disabled:s}),f.jsx(qo,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(D=>D.name==="Read unauthorized budget month"),onRun:()=>y("Read unauthorized budget month"),disabled:s}),f.jsx(qo,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(D=>D.name==="Toggle is_admin in own permission_flags"),onRun:()=>y("Toggle is_admin in own permission_flags"),disabled:s}),f.jsx(qo,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(D=>D.name==="Toggle is_test in own permission_flags"),onRun:()=>y("Toggle is_test in own permission_flags"),disabled:s}),f.jsx(qo,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(D=>D.name==="Read own user document"),onRun:()=>y("Read own user document"),disabled:s,expectedToSucceed:!0})]}),S>0&&f.jsxs(au,{style:{marginTop:"1.5rem"},children:[" ",S," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function qo({name:i,description:e,expectedBehavior:n,result:s,onRun:o,disabled:c,expectedToSucceed:d}){const g=s?.status==="passed"?Ee.success:s?.status==="failed"?Ee.danger:s?.status==="running"?Ee.warning:"inherit";return f.jsxs("div",{style:{...iu,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[f.jsxs("div",{style:{flex:1},children:[f.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:i}),f.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),f.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:d?Ee.success:Ee.warning},children:["Expected: ",n]})]}),f.jsx(pt,{onClick:o,disabled:c,variant:"secondary",style:{flexShrink:0},children:s?.status==="running"?"":"Run"})]}),s&&s.status!=="pending"&&f.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${g} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${g} 30%, transparent)`,fontSize:"0.85rem",color:g},children:s.message})]})}function Wj(){const{currentBudget:i,currentUserId:e,accessibleBudgets:n,loadAccessibleBudgets:s,switchToBudget:o,acceptBudgetInvite:c,checkBudgetInvite:d,renameBudget:g,loading:p}=hs(),[y,b]=A.useState(!1),[S,x]=A.useState(null),[D,k]=A.useState(null),[O,M]=A.useState(null),[G,q]=A.useState(null),[ee,Ce]=A.useState(null),[Me,Se]=A.useState(""),[R,C]=A.useState(!1),[I,L]=A.useState(""),[N,B]=A.useState(!1),[j,Fe]=A.useState(null);A.useEffect(()=>{async function X(){b(!0),await s(),b(!1)}X()},[]);async function dt(X){if(X!==i?.id){x(X),M(null),q(null);try{await o(X),q("Switched to budget successfully!"),await s()}catch(ne){M(ne instanceof Error?ne.message:"Failed to switch budget")}finally{x(null)}}}async function se(X){k(X),M(null),q(null);try{await c(X),q("Invitation accepted! You now have access to this budget."),await s()}catch(ne){M(ne instanceof Error?ne.message:"Failed to accept invitation")}finally{k(null)}}async function $(X){if(X.preventDefault(),!!I.trim()){B(!0),M(null),Fe(null);try{const ne=await d(I.trim());ne?Fe(ne):M("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(ne){M(ne instanceof Error?ne.message:"Failed to check invitation")}finally{B(!1)}}}async function Ie(){if(j){k(j.budgetId),M(null);try{await c(j.budgetId),q(`Successfully joined "${j.budgetName}"!`),Fe(null),L(""),await s()}catch(X){M(X instanceof Error?X.message:"Failed to accept invitation")}finally{k(null)}}}function Ue(X,ne){Se(ne),Ce(X)}function st(){Ce(null),Se("")}async function V(X){if(X.preventDefault(),!(!Me.trim()||!ee)){C(!0),M(null),q(null);try{await g(Me.trim()),q("Budget renamed successfully!"),Ce(null),await s()}catch(ne){M(ne instanceof Error?ne.message:"Failed to rename budget")}finally{C(!1)}}}const P=n.filter(X=>!X.isPending),Q=n.filter(X=>X.isPending);return p||y?f.jsx("p",{children:"Loading your budgets..."}):f.jsxs("div",{children:[f.jsx("h2",{style:{marginTop:0},children:"My Budgets"}),f.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Manage your budgets, switch between them, and accept new invitations."}),O&&f.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:O}),f.jsx("button",{onClick:()=>M(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),G&&f.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("span",{children:G}),f.jsx("button",{onClick:()=>q(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),Q.length>0&&f.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[f.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""})," Pending Invitations (",Q.length,")"]}),f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:Q.map(X=>f.jsx(dE,{budget:X,isCurrent:!1,isAccepting:D===X.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>se(X.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},X.id))})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[f.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""})," Your Budgets (",P.length,")"]}),P.length===0?f.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):f.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:P.map(X=>{const ne=X.id===i?.id,we=ee===X.id;return f.jsx(dE,{budget:X,isCurrent:ne,isAccepting:!1,isSwitching:S===X.id,isEditing:we,editName:we?Me:"",isRenaming:R,onAccept:()=>{},onSwitch:()=>dt(X.id),onStartEdit:()=>Ue(X.id,X.name),onCancelEdit:st,onEditNameChange:Se,onSaveEdit:V},X.id)})})]}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[f.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("span",{children:""})," Join Budget by ID"]}),f.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),j?f.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[f.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),f.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[f.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:j.budgetName}),j.ownerEmail&&f.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",j.ownerEmail]})]}),f.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[f.jsx("button",{onClick:Ie,disabled:D===j.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:D===j.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:D===j.budgetId?.7:1},children:D===j.budgetId?"Accepting...":"Accept Invitation"}),f.jsx("button",{onClick:()=>{Fe(null),L("")},disabled:D===j.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:D===j.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:D===j.budgetId?.7:.8},children:"Cancel"})]})]}):f.jsxs("form",{onSubmit:$,style:{display:"flex",gap:"0.75rem"},children:[f.jsx("input",{type:"text",value:I,onChange:X=>L(X.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),f.jsx("button",{type:"submit",disabled:N||!I.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:N||!I.trim()?"not-allowed":"pointer",fontWeight:500,opacity:N||!I.trim()?.7:1,whiteSpace:"nowrap"},children:N?"Checking...":"Check Invite"})]})]}),e&&f.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[f.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),f.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:e})]})]})}function dE({budget:i,isCurrent:e,isAccepting:n,isSwitching:s,isEditing:o,editName:c,isRenaming:d,onAccept:g,onSwitch:p,onStartEdit:y,onCancelEdit:b,onEditNameChange:S,onSaveEdit:x}){const D=e&&i.isOwner;return f.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:o?f.jsxs("form",{onSubmit:x,children:[f.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:f.jsx("input",{type:"text",value:c,onChange:k=>S(k.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[f.jsx("button",{type:"submit",disabled:d||!c.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:d||!c.trim()?"not-allowed":"pointer",fontWeight:500,opacity:d||!c.trim()?.7:1,fontSize:"0.8rem"},children:d?"Saving...":"Save"}),f.jsx("button",{type:"button",onClick:b,disabled:d,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:d?"not-allowed":"pointer",fontWeight:500,opacity:d?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[f.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[f.jsx("span",{style:{fontWeight:600},children:i.name}),i.isOwner&&f.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&f.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),i.isPending&&f.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),D&&f.jsx("button",{onClick:y,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),f.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:i.ownerEmail?`Owner: ${i.ownerEmail}`:`ID: ${i.id}`})]}),f.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:i.isPending?f.jsx("button",{onClick:g,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:f.jsx("button",{onClick:p,disabled:s,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:s?"not-allowed":"pointer",fontWeight:500,opacity:s?.7:1,fontSize:"0.85rem"},children:s?"Switching...":"Switch"})})]})})}function Xj({children:i}){const e=A.useContext(qc),n=Kr();return e.is_auth_checked?e.is_logged_in?i?f.jsx(f.Fragment,{children:i}):f.jsx($g,{}):f.jsx(AE,{to:"/account",state:{from:n.pathname},replace:!0}):f.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:f.jsx("p",{children:"Loading..."})})}function Jj(){const{ensureBudgetLoaded:i,isInitialized:e,loading:n,error:s,isUsingCache:o,lastRefreshTime:c,forceRefreshFromFirebase:d,clearCache:g}=hs(),[p,y]=A.useState(!1),[b,S]=A.useState(!1),x=A.useRef(null);A.useEffect(()=>{if(!b)return;function O(M){x.current&&!x.current.contains(M.target)&&S(!1)}return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[b]),A.useEffect(()=>{i()},[]);async function D(){y(!0);try{await d()}finally{y(!1)}}function k(O){if(!O)return"Never";const M=Math.floor((Date.now()-O)/1e3);if(M<60)return`${M}s ago`;const G=Math.floor(M/60);if(G<60)return`${G}m ago`;const q=Math.floor(G/60);return q<24?`${q}h ago`:`${Math.floor(q/24)}d ago`}return e?s?(console.error("[BudgetLayout] Error:",s),f.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:f.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",s]})})):f.jsxs(f.Fragment,{children:[f.jsxs("div",{ref:x,style:{position:"fixed",bottom:"1.5rem",right:"5.5rem",zIndex:1e3,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[b&&f.jsxs("div",{style:{background:"rgba(30, 30, 35, 0.95)",backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"1rem",minWidth:"220px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)"},children:[f.jsxs("div",{style:{marginBottom:"0.75rem"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Data Source"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",fontWeight:500},children:o?f.jsx("span",{style:{color:Ee.warning},children:" From Cache"}):f.jsx("span",{style:{color:Ee.success},children:" From Firebase"})})]}),f.jsxs("div",{style:{marginBottom:"0.75rem"},children:[f.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Last Firebase Sync"}),f.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem"},children:k(c)})]}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[f.jsx("button",{onClick:D,disabled:p||n,style:{flex:1,background:Ee.primary,color:"white",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.8rem",fontWeight:500,cursor:p||n?"not-allowed":"pointer",opacity:p||n?.6:1,transition:"opacity 0.15s"},children:p?" Syncing...":" Sync Now"}),f.jsx("button",{onClick:()=>{g(),S(!1)},style:{background:"rgba(255, 255, 255, 0.1)",color:"inherit",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.8rem",cursor:"pointer",transition:"background 0.15s"},title:"Clear all cached data",children:""})]}),f.jsx("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.7rem",opacity:.5,lineHeight:1.4},children:'Data is cached locally to reduce Firebase reads. Click "Sync Now" to fetch fresh data.'})]}),f.jsxs("button",{onClick:()=>S(!b),style:{display:"flex",alignItems:"center",gap:"0.4rem",background:o?`color-mix(in srgb, ${Ee.warning} 20%, rgba(30, 30, 35, 0.9))`:"rgba(30, 30, 35, 0.9)",backdropFilter:"blur(8px)",border:o?`1px solid ${Ee.warning}`:"1px solid rgba(255, 255, 255, 0.15)",borderRadius:"20px",padding:"0.4rem 0.75rem",fontSize:"0.75rem",color:"inherit",cursor:"pointer",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.2)",transition:"all 0.15s"},title:o?"Data loaded from cache":"Data loaded from Firebase",children:[f.jsx("span",{children:o?"":""}),f.jsx("span",{style:{opacity:.8},children:o?"Cached":"Live"}),f.jsx("span",{style:{opacity:.5,fontSize:"0.65rem"},children:b?"":""})]})]}),f.jsx("div",{style:{paddingBottom:"5rem"},children:f.jsx($g,{})})]}):f.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[f.jsx("p",{children:"Loading budget..."}),n&&f.jsx("p",{style:{opacity:.6},children:"Fetching data from server..."})]})}const Zj={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function eM(){const[i,e]=A.useState(Zj),n=ru();return A.useEffect(function(){n.set_user_listener(s=>{e({is_logged_in:s!=null,is_auth_checked:!0,username:s?.email??"",set_user_context:e})})},[]),i.is_auth_checked?f.jsx(qc.Provider,{value:i,children:f.jsx(ej,{children:f.jsxs(bA,{children:[f.jsxs(W1,{children:[f.jsx(dr,{path:"/",element:f.jsx(tj,{})}),f.jsx(dr,{path:"/account",element:f.jsx(rj,{})}),f.jsx(dr,{path:"/sql-test",element:f.jsx(nj,{})}),f.jsx(dr,{path:"/budget",element:f.jsx(Xj,{}),children:f.jsxs(dr,{element:f.jsx(Jj,{}),children:[f.jsx(dr,{index:!0,element:f.jsx(Mj,{})}),f.jsxs(dr,{path:"admin",element:f.jsx(Hj,{}),children:[f.jsx(dr,{path:"my-budgets",element:f.jsx(Wj,{})}),f.jsx(dr,{path:"accounts",element:f.jsx(zj,{})}),f.jsx(dr,{path:"categories",element:f.jsx(Bj,{})}),f.jsx(dr,{path:"users",element:f.jsx(qj,{})}),f.jsx(dr,{path:"migration",element:f.jsx($j,{})}),f.jsx(dr,{path:"feedback",element:f.jsx(Yj,{})}),f.jsx(dr,{path:"tests",element:f.jsx(Kj,{})})]})]})})]}),f.jsx(Oj,{})]})})}):f.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:f.jsx("p",{children:"Loading..."})})}Xw.createRoot(document.getElementById("root")).render(f.jsx(A.StrictMode,{children:f.jsx(eM,{})}));
