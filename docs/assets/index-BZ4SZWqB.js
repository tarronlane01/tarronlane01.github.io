(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var fp={exports:{}},wc={};var ab;function mA(){if(ab)return wc;ab=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:t,type:i,key:c,ref:a!==void 0?a:null,props:l}}return wc.Fragment=e,wc.jsx=n,wc.jsxs=n,wc}var ob;function pA(){return ob||(ob=1,fp.exports=mA()),fp.exports}var h=pA(),mp={exports:{}},Le={};var lb;function gA(){if(lb)return Le;lb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),b=Symbol.iterator;function T(V){return V===null||typeof V!="object"?null:(V=b&&V[b]||V["@@iterator"],typeof V=="function"?V:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,I={};function P(V,q,ne){this.props=V,this.context=q,this.refs=I,this.updater=ne||w}P.prototype.isReactComponent={},P.prototype.setState=function(V,q){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,q,"setState")},P.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function G(){}G.prototype=P.prototype;function Q(V,q,ne){this.props=V,this.context=q,this.refs=I,this.updater=ne||w}var X=Q.prototype=new G;X.constructor=Q,A(X,P.prototype),X.isPureReactComponent=!0;var Z=Array.isArray;function oe(){}var O={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function R(V,q,ne){var ee=ne.ref;return{$$typeof:t,type:V,key:q,ref:ee!==void 0?ee:null,props:ne}}function N(V,q){return R(V.type,q,V.props)}function j(V){return typeof V=="object"&&V!==null&&V.$$typeof===t}function U(V){var q={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ne){return q[ne]})}var M=/\/+/g;function W(V,q){return typeof V=="object"&&V!==null&&V.key!=null?U(""+V.key):q.toString(36)}function H(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(oe,oe):(V.status="pending",V.then(function(q){V.status==="pending"&&(V.status="fulfilled",V.value=q)},function(q){V.status==="pending"&&(V.status="rejected",V.reason=q)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function B(V,q,ne,ee,ce){var be=typeof V;(be==="undefined"||be==="boolean")&&(V=null);var Ee=!1;if(V===null)Ee=!0;else switch(be){case"bigint":case"string":case"number":Ee=!0;break;case"object":switch(V.$$typeof){case t:case e:Ee=!0;break;case _:return Ee=V._init,B(Ee(V._payload),q,ne,ee,ce)}}if(Ee)return ce=ce(V),Ee=ee===""?"."+W(V,0):ee,Z(ce)?(ne="",Ee!=null&&(ne=Ee.replace(M,"$&/")+"/"),B(ce,q,ne,"",function(fe){return fe})):ce!=null&&(j(ce)&&(ce=N(ce,ne+(ce.key==null||V&&V.key===ce.key?"":(""+ce.key).replace(M,"$&/")+"/")+Ee)),q.push(ce)),1;Ee=0;var ve=ee===""?".":ee+":";if(Z(V))for(var Se=0;Se<V.length;Se++)ee=V[Se],be=ve+W(ee,Se),Ee+=B(ee,q,ne,be,ce);else if(Se=T(V),typeof Se=="function")for(V=Se.call(V),Se=0;!(ee=V.next()).done;)ee=ee.value,be=ve+W(ee,Se++),Ee+=B(ee,q,ne,be,ce);else if(be==="object"){if(typeof V.then=="function")return B(H(V),q,ne,ee,ce);throw q=String(V),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return Ee}function z(V,q,ne){if(V==null)return V;var ee=[],ce=0;return B(V,ee,"","",function(be){return q.call(ne,be,ce++)}),ee}function F(V){if(V._status===-1){var q=V._result;q=q(),q.then(function(ne){(V._status===0||V._status===-1)&&(V._status=1,V._result=ne)},function(ne){(V._status===0||V._status===-1)&&(V._status=2,V._result=ne)}),V._status===-1&&(V._status=0,V._result=q)}if(V._status===1)return V._result.default;throw V._result}var $=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},te={map:z,forEach:function(V,q,ne){z(V,function(){q.apply(this,arguments)},ne)},count:function(V){var q=0;return z(V,function(){q++}),q},toArray:function(V){return z(V,function(q){return q})||[]},only:function(V){if(!j(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Le.Activity=v,Le.Children=te,Le.Component=P,Le.Fragment=n,Le.Profiler=a,Le.PureComponent=Q,Le.StrictMode=i,Le.Suspense=f,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Le.__COMPILER_RUNTIME={__proto__:null,c:function(V){return O.H.useMemoCache(V)}},Le.cache=function(V){return function(){return V.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(V,q,ne){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var ee=A({},V.props),ce=V.key;if(q!=null)for(be in q.key!==void 0&&(ce=""+q.key),q)!C.call(q,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&q.ref===void 0||(ee[be]=q[be]);var be=arguments.length-2;if(be===1)ee.children=ne;else if(1<be){for(var Ee=Array(be),ve=0;ve<be;ve++)Ee[ve]=arguments[ve+2];ee.children=Ee}return R(V.type,ce,ee)},Le.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:l,_context:V},V},Le.createElement=function(V,q,ne){var ee,ce={},be=null;if(q!=null)for(ee in q.key!==void 0&&(be=""+q.key),q)C.call(q,ee)&&ee!=="key"&&ee!=="__self"&&ee!=="__source"&&(ce[ee]=q[ee]);var Ee=arguments.length-2;if(Ee===1)ce.children=ne;else if(1<Ee){for(var ve=Array(Ee),Se=0;Se<Ee;Se++)ve[Se]=arguments[Se+2];ce.children=ve}if(V&&V.defaultProps)for(ee in Ee=V.defaultProps,Ee)ce[ee]===void 0&&(ce[ee]=Ee[ee]);return R(V,be,ce)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(V){return{$$typeof:d,render:V}},Le.isValidElement=j,Le.lazy=function(V){return{$$typeof:_,_payload:{_status:-1,_result:V},_init:F}},Le.memo=function(V,q){return{$$typeof:p,type:V,compare:q===void 0?null:q}},Le.startTransition=function(V){var q=O.T,ne={};O.T=ne;try{var ee=V(),ce=O.S;ce!==null&&ce(ne,ee),typeof ee=="object"&&ee!==null&&typeof ee.then=="function"&&ee.then(oe,$)}catch(be){$(be)}finally{q!==null&&ne.types!==null&&(q.types=ne.types),O.T=q}},Le.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Le.use=function(V){return O.H.use(V)},Le.useActionState=function(V,q,ne){return O.H.useActionState(V,q,ne)},Le.useCallback=function(V,q){return O.H.useCallback(V,q)},Le.useContext=function(V){return O.H.useContext(V)},Le.useDebugValue=function(){},Le.useDeferredValue=function(V,q){return O.H.useDeferredValue(V,q)},Le.useEffect=function(V,q){return O.H.useEffect(V,q)},Le.useEffectEvent=function(V){return O.H.useEffectEvent(V)},Le.useId=function(){return O.H.useId()},Le.useImperativeHandle=function(V,q,ne){return O.H.useImperativeHandle(V,q,ne)},Le.useInsertionEffect=function(V,q){return O.H.useInsertionEffect(V,q)},Le.useLayoutEffect=function(V,q){return O.H.useLayoutEffect(V,q)},Le.useMemo=function(V,q){return O.H.useMemo(V,q)},Le.useOptimistic=function(V,q){return O.H.useOptimistic(V,q)},Le.useReducer=function(V,q,ne){return O.H.useReducer(V,q,ne)},Le.useRef=function(V){return O.H.useRef(V)},Le.useState=function(V){return O.H.useState(V)},Le.useSyncExternalStore=function(V,q,ne){return O.H.useSyncExternalStore(V,q,ne)},Le.useTransition=function(){return O.H.useTransition()},Le.version="19.2.3",Le}var cb;function Tg(){return cb||(cb=1,mp.exports=gA()),mp.exports}var D=Tg(),pp={exports:{}},Tc={},gp={exports:{}},yp={};var ub;function yA(){return ub||(ub=1,(function(t){function e(B,z){var F=B.length;B.push(z);e:for(;0<F;){var $=F-1>>>1,te=B[$];if(0<a(te,z))B[$]=z,B[F]=te,F=$;else break e}}function n(B){return B.length===0?null:B[0]}function i(B){if(B.length===0)return null;var z=B[0],F=B.pop();if(F!==z){B[0]=F;e:for(var $=0,te=B.length,V=te>>>1;$<V;){var q=2*($+1)-1,ne=B[q],ee=q+1,ce=B[ee];if(0>a(ne,F))ee<te&&0>a(ce,ne)?(B[$]=ce,B[ee]=F,$=ee):(B[$]=ne,B[q]=F,$=q);else if(ee<te&&0>a(ce,F))B[$]=ce,B[ee]=F,$=ee;else break e}}return z}function a(B,z){var F=B.sortIndex-z.sortIndex;return F!==0?F:B.id-z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var f=[],p=[],_=1,v=null,b=3,T=!1,w=!1,A=!1,I=!1,P=typeof setTimeout=="function"?setTimeout:null,G=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;function X(B){for(var z=n(p);z!==null;){if(z.callback===null)i(p);else if(z.startTime<=B)i(p),z.sortIndex=z.expirationTime,e(f,z);else break;z=n(p)}}function Z(B){if(A=!1,X(B),!w)if(n(f)!==null)w=!0,oe||(oe=!0,U());else{var z=n(p);z!==null&&H(Z,z.startTime-B)}}var oe=!1,O=-1,C=5,R=-1;function N(){return I?!0:!(t.unstable_now()-R<C)}function j(){if(I=!1,oe){var B=t.unstable_now();R=B;var z=!0;try{e:{w=!1,A&&(A=!1,G(O),O=-1),T=!0;var F=b;try{t:{for(X(B),v=n(f);v!==null&&!(v.expirationTime>B&&N());){var $=v.callback;if(typeof $=="function"){v.callback=null,b=v.priorityLevel;var te=$(v.expirationTime<=B);if(B=t.unstable_now(),typeof te=="function"){v.callback=te,X(B),z=!0;break t}v===n(f)&&i(f),X(B)}else i(f);v=n(f)}if(v!==null)z=!0;else{var V=n(p);V!==null&&H(Z,V.startTime-B),z=!1}}break e}finally{v=null,b=F,T=!1}z=void 0}}finally{z?U():oe=!1}}}var U;if(typeof Q=="function")U=function(){Q(j)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,W=M.port2;M.port1.onmessage=j,U=function(){W.postMessage(null)}}else U=function(){P(j,0)};function H(B,z){O=P(function(){B(t.unstable_now())},z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_next=function(B){switch(b){case 1:case 2:case 3:var z=3;break;default:z=b}var F=b;b=z;try{return B()}finally{b=F}},t.unstable_requestPaint=function(){I=!0},t.unstable_runWithPriority=function(B,z){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var F=b;b=B;try{return z()}finally{b=F}},t.unstable_scheduleCallback=function(B,z,F){var $=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?$+F:$):F=$,B){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=F+te,B={id:_++,callback:z,priorityLevel:B,startTime:F,expirationTime:te,sortIndex:-1},F>$?(B.sortIndex=F,e(p,B),n(f)===null&&B===n(p)&&(A?(G(O),O=-1):A=!0,H(Z,F-$))):(B.sortIndex=te,e(f,B),w||T||(w=!0,oe||(oe=!0,U()))),B},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(B){var z=b;return function(){var F=b;b=z;try{return B.apply(this,arguments)}finally{b=F}}}})(yp)),yp}var db;function _A(){return db||(db=1,gp.exports=yA()),gp.exports}var _p={exports:{}},_n={};var hb;function vA(){if(hb)return _n;hb=1;var t=Tg();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(f,p,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:f,containerInfo:p,implementation:_}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return _n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,_n.createPortal=function(f,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return l(f,p,null,_)},_n.flushSync=function(f){var p=c.T,_=i.p;try{if(c.T=null,i.p=2,f)return f()}finally{c.T=p,i.p=_,i.d.f()}},_n.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(f,p))},_n.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},_n.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var _=p.as,v=d(_,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,T=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;_==="style"?i.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:T}):_==="script"&&i.d.X(f,{crossOrigin:v,integrity:b,fetchPriority:T,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},_n.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var _=d(p.as,p.crossOrigin);i.d.M(f,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(f)},_n.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var _=p.as,v=d(_,p.crossOrigin);i.d.L(f,_,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},_n.preloadModule=function(f,p){if(typeof f=="string")if(p){var _=d(p.as,p.crossOrigin);i.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(f)},_n.requestFormReset=function(f){i.d.r(f)},_n.unstable_batchedUpdates=function(f,p){return f(p)},_n.useFormState=function(f,p,_){return c.H.useFormState(f,p,_)},_n.useFormStatus=function(){return c.H.useHostTransitionStatus()},_n.version="19.2.3",_n}var fb;function bA(){if(fb)return _p.exports;fb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),_p.exports=vA(),_p.exports}var mb;function EA(){if(mb)return Tc;mb=1;var t=_A(),e=Tg(),n=bA();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var s=r,o=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(o=s.return),r=s.return;while(r)}return s.tag===3?o:null}function c(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function d(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function f(r){if(l(r)!==r)throw Error(i(188))}function p(r){var s=r.alternate;if(!s){if(s=l(r),s===null)throw Error(i(188));return s!==r?null:r}for(var o=r,u=s;;){var g=o.return;if(g===null)break;var y=g.alternate;if(y===null){if(u=g.return,u!==null){o=u;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===o)return f(g),r;if(y===u)return f(g),s;y=y.sibling}throw Error(i(188))}if(o.return!==u.return)o=g,u=y;else{for(var x=!1,k=g.child;k;){if(k===o){x=!0,o=g,u=y;break}if(k===u){x=!0,u=g,o=y;break}k=k.sibling}if(!x){for(k=y.child;k;){if(k===o){x=!0,o=y,u=g;break}if(k===u){x=!0,u=y,o=g;break}k=k.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==u)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?r:s}function _(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=_(r),s!==null)return s;r=r.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),Q=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),N=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function U(r){return r===null||typeof r!="object"?null:(r=j&&r[j]||r["@@iterator"],typeof r=="function"?r:null)}var M=Symbol.for("react.client.reference");function W(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===M?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case A:return"Fragment";case P:return"Profiler";case I:return"StrictMode";case Z:return"Suspense";case oe:return"SuspenseList";case R:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case Q:return r.displayName||"Context";case G:return(r._context.displayName||"Context")+".Consumer";case X:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case O:return s=r.displayName||null,s!==null?s:W(r.type)||"Memo";case C:s=r._payload,r=r._init;try{return W(r(s))}catch{}}return null}var H=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},$=[],te=-1;function V(r){return{current:r}}function q(r){0>te||(r.current=$[te],$[te]=null,te--)}function ne(r,s){te++,$[te]=r.current,r.current=s}var ee=V(null),ce=V(null),be=V(null),Ee=V(null);function ve(r,s){switch(ne(be,s),ne(ce,r),ne(ee,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?Dv(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=Dv(s),r=Iv(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}q(ee),ne(ee,r)}function Se(){q(ee),q(ce),q(be)}function fe(r){r.memoizedState!==null&&ne(Ee,r);var s=ee.current,o=Iv(s,r.type);s!==o&&(ne(ce,r),ne(ee,o))}function Ze(r){ce.current===r&&(q(ee),q(ce)),Ee.current===r&&(q(Ee),bc._currentValue=F)}var Fe,on;function An(r){if(Fe===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Fe=s&&s[1]||"",on=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Fe+r+on}var jr=!1;function Or(r,s){if(!r||jr)return"";jr=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var pe=function(){throw Error()};if(Object.defineProperty(pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pe,[])}catch(de){var le=de}Reflect.construct(r,[],pe)}else{try{pe.call()}catch(de){le=de}r.call(pe.prototype)}}else{try{throw Error()}catch(de){le=de}(pe=r())&&typeof pe.catch=="function"&&pe.catch(function(){})}}catch(de){if(de&&le&&typeof de.stack=="string")return[de.stack,le.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),x=y[0],k=y[1];if(x&&k){var K=x.split(`
`),ae=k.split(`
`);for(g=u=0;u<K.length&&!K[u].includes("DetermineComponentFrameRoot");)u++;for(;g<ae.length&&!ae[g].includes("DetermineComponentFrameRoot");)g++;if(u===K.length||g===ae.length)for(u=K.length-1,g=ae.length-1;1<=u&&0<=g&&K[u]!==ae[g];)g--;for(;1<=u&&0<=g;u--,g--)if(K[u]!==ae[g]){if(u!==1||g!==1)do if(u--,g--,0>g||K[u]!==ae[g]){var he=`
`+K[u].replace(" at new "," at ");return r.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",r.displayName)),he}while(1<=u&&0<=g);break}}}finally{jr=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?An(o):""}function Ws(r,s){switch(r.tag){case 26:case 27:case 5:return An(r.type);case 16:return An("Lazy");case 13:return r.child!==s&&s!==null?An("Suspense Fallback"):An("Suspense");case 19:return An("SuspenseList");case 0:case 15:return Or(r.type,!1);case 11:return Or(r.type.render,!1);case 1:return Or(r.type,!0);case 31:return An("Activity");default:return""}}function Ct(r){try{var s="",o=null;do s+=Ws(r,o),o=r,r=r.return;while(r);return s}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var st=Object.prototype.hasOwnProperty,St=t.unstable_scheduleCallback,$n=t.unstable_cancelCallback,xl=t.unstable_shouldYield,hr=t.unstable_requestPaint,$t=t.unstable_now,Ys=t.unstable_getCurrentPriorityLevel,Sl=t.unstable_ImmediatePriority,wl=t.unstable_UserBlockingPriority,Qi=t.unstable_NormalPriority,gf=t.unstable_LowPriority,mu=t.unstable_IdlePriority,pu=t.log,gu=t.unstable_setDisableYieldValue,fr=null,ln=null;function Wn(r){if(typeof pu=="function"&&gu(r),ln&&typeof ln.setStrictMode=="function")try{ln.setStrictMode(fr,r)}catch{}}var It=Math.clz32?Math.clz32:_u,yu=Math.log,za=Math.LN2;function _u(r){return r>>>=0,r===0?32:31-(yu(r)/za|0)|0}var Mr=256,Xs=262144,Pt=4194304;function kr(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Nr(r,s,o){var u=r.pendingLanes;if(u===0)return 0;var g=0,y=r.suspendedLanes,x=r.pingedLanes;r=r.warmLanes;var k=u&134217727;return k!==0?(u=k&~y,u!==0?g=kr(u):(x&=k,x!==0?g=kr(x):o||(o=k&~r,o!==0&&(g=kr(o))))):(k=u&~y,k!==0?g=kr(k):x!==0?g=kr(x):o||(o=u&~r,o!==0&&(g=kr(o)))),g===0?0:s!==0&&s!==g&&(s&y)===0&&(y=g&-g,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:g}function mr(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function yf(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vu(){var r=Pt;return Pt<<=1,(Pt&62914560)===0&&(Pt=4194304),r}function Pr(r){for(var s=[],o=0;31>o;o++)s.push(r);return s}function Js(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function _f(r,s,o,u,g,y){var x=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var k=r.entanglements,K=r.expirationTimes,ae=r.hiddenUpdates;for(o=x&~o;0<o;){var he=31-It(o),pe=1<<he;k[he]=0,K[he]=-1;var le=ae[he];if(le!==null)for(ae[he]=null,he=0;he<le.length;he++){var de=le[he];de!==null&&(de.lane&=-536870913)}o&=~pe}u!==0&&Zs(r,u,0),y!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=y&~(x&~s))}function Zs(r,s,o){r.pendingLanes|=s,r.suspendedLanes&=~s;var u=31-It(s);r.entangledLanes|=s,r.entanglements[u]=r.entanglements[u]|1073741824|o&261930}function Tl(r,s){var o=r.entangledLanes|=s;for(r=r.entanglements;o;){var u=31-It(o),g=1<<u;g&s|r[u]&s&&(r[u]|=s),o&=~g}}function Al(r,s){var o=s&-s;return o=(o&42)!==0?1:ea(o),(o&(r.suspendedLanes|s))!==0?0:o}function ea(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function fi(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function bu(){var r=z.p;return r!==0?r:(r=window.event,r===void 0?32:Zv(r.type))}function pr(r,s){var o=z.p;try{return z.p=r,s()}finally{z.p=o}}var gr=Math.random().toString(36).slice(2),Lt="__reactFiber$"+gr,en="__reactProps$"+gr,Lr="__reactContainer$"+gr,Fa="__reactEvents$"+gr,vf="__reactListeners$"+gr,Eu="__reactHandles$"+gr,xu="__reactResources$"+gr,Vr="__reactMarker$"+gr;function qa(r){delete r[Lt],delete r[en],delete r[Fa],delete r[vf],delete r[Eu]}function Br(r){var s=r[Lt];if(s)return s;for(var o=r.parentNode;o;){if(s=o[Lr]||o[Lt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(r=Lv(r);r!==null;){if(o=r[Lt])return o;r=Lv(r)}return s}r=o,o=r.parentNode}return null}function Yn(r){if(r=r[Lt]||r[Lr]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function Ln(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function Ur(r){var s=r[xu];return s||(s=r[xu]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Vt(r){r[Vr]=!0}var Cl=new Set,Rl={};function zr(r,s){Fr(r,s),Fr(r+"Capture",s)}function Fr(r,s){for(Rl[r]=s,r=0;r<s.length;r++)Cl.add(s[r])}var Dl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Il={},jl={};function Su(r){return st.call(jl,r)?!0:st.call(Il,r)?!1:Dl.test(r)?jl[r]=!0:(Il[r]=!0,!1)}function Qa(r,s,o){if(Su(s))if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+o)}}function Vn(r,s,o){if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+o)}}function Bt(r,s,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(s,o,""+u)}}function tn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Gi(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ol(r,s,o){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,y=u.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return g.call(this)},set:function(x){o=""+x,y.call(this,x)}}),Object.defineProperty(r,s,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function ot(r){if(!r._valueTracker){var s=Gi(r)?"checked":"value";r._valueTracker=Ol(r,s,""+r[s])}}function ta(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var o=s.getValue(),u="";return r&&(u=Gi(r)?r.checked?"true":"false":r.value),r=u,r!==o?(s.setValue(r),!0):!1}function qr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var na=/[\n"\\]/g;function Cn(r){return r.replace(na,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ga(r,s,o,u,g,y,x,k){r.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?r.type=x:r.removeAttribute("type"),s!=null?x==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+tn(s)):r.value!==""+tn(s)&&(r.value=""+tn(s)):x!=="submit"&&x!=="reset"||r.removeAttribute("value"),s!=null?Ml(r,x,tn(s)):o!=null?Ml(r,x,tn(o)):u!=null&&r.removeAttribute("value"),g==null&&y!=null&&(r.defaultChecked=!!y),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?r.name=""+tn(k):r.removeAttribute("name")}function wu(r,s,o,u,g,y,x,k){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ot(r);return}o=o!=null?""+tn(o):"",s=s!=null?""+tn(s):o,k||s===r.value||(r.value=s),r.defaultValue=s}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=k?r.checked:!!u,r.defaultChecked=!!u,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(r.name=x),ot(r)}function Ml(r,s,o){s==="number"&&qr(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function Hi(r,s,o,u){if(r=r.options,s){s={};for(var g=0;g<o.length;g++)s["$"+o[g]]=!0;for(o=0;o<r.length;o++)g=s.hasOwnProperty("$"+r[o].value),r[o].selected!==g&&(r[o].selected=g),g&&u&&(r[o].defaultSelected=!0)}else{for(o=""+tn(o),s=null,g=0;g<r.length;g++){if(r[g].value===o){r[g].selected=!0,u&&(r[g].defaultSelected=!0);return}s!==null||r[g].disabled||(s=r[g])}s!==null&&(s.selected=!0)}}function Tu(r,s,o){if(s!=null&&(s=""+tn(s),s!==r.value&&(r.value=s),o==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=o!=null?""+tn(o):""}function Ki(r,s,o,u){if(s==null){if(u!=null){if(o!=null)throw Error(i(92));if(H(u)){if(1<u.length)throw Error(i(93));u=u[0]}o=u}o==null&&(o=""),s=o}o=tn(s),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u),ot(r)}function Rn(r,s){if(s){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=s;return}}r.textContent=s}var Au=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function kl(r,s,o){var u=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":u?r.setProperty(s,o):typeof o!="number"||o===0||Au.has(s)?s==="float"?r.cssFloat=o:r[s]=(""+o).trim():r[s]=o+"px"}function Nl(r,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var g in s)u=s[g],s.hasOwnProperty(g)&&o[g]!==u&&kl(r,g,u)}else for(var y in s)s.hasOwnProperty(y)&&kl(r,y,s[y])}function Ha(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$i=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ka(r){return $i.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function yr(){}var Pl=null;function Xn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Wi=null,Qr=null;function ra(r){var s=Yn(r);if(s&&(r=s.stateNode)){var o=r[en]||null;e:switch(r=s.stateNode,s.type){case"input":if(Ga(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Cn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var u=o[s];if(u!==r&&u.form===r.form){var g=u[en]||null;if(!g)throw Error(i(90));Ga(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<o.length;s++)u=o[s],u.form===r.form&&ta(u)}break e;case"textarea":Tu(r,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&Hi(r,!!o.multiple,s,!1)}}}var $a=!1;function Yi(r,s,o){if($a)return r(s,o);$a=!0;try{var u=r(s);return u}finally{if($a=!1,(Wi!==null||Qr!==null)&&(bd(),Wi&&(s=Wi,r=Qr,Qr=Wi=null,ra(s),r)))for(s=0;s<r.length;s++)ra(r[s])}}function _r(r,s){var o=r.stateNode;if(o===null)return null;var u=o[en]||null;if(u===null)return null;o=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var Jn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ia=!1;if(Jn)try{var ut={};Object.defineProperty(ut,"passive",{get:function(){ia=!0}}),window.addEventListener("test",ut,ut),window.removeEventListener("test",ut,ut)}catch{ia=!1}var Gr=null,Ll=null,sa=null;function Vl(){if(sa)return sa;var r,s=Ll,o=s.length,u,g="value"in Gr?Gr.value:Gr.textContent,y=g.length;for(r=0;r<o&&s[r]===g[r];r++);var x=o-r;for(u=1;u<=x&&s[o-u]===g[y-u];u++);return sa=g.slice(r,1<u?1-u:void 0)}function aa(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function mi(){return!0}function vr(){return!1}function cn(r){function s(o,u,g,y,x){this._reactName=o,this._targetInst=g,this.type=u,this.nativeEvent=y,this.target=x,this.currentTarget=null;for(var k in r)r.hasOwnProperty(k)&&(o=r[k],this[k]=o?o(y):y[k]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?mi:vr,this.isPropagationStopped=vr,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=mi)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=mi)},persist:function(){},isPersistent:mi}),s}var pi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hr=cn(pi),Xi=v({},pi,{view:0,detail:0}),Bl=cn(Xi),Ji,Wa,Kr,Ya=v({},Xi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zi,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Kr&&(Kr&&r.type==="mousemove"?(Ji=r.screenX-Kr.screenX,Wa=r.screenY-Kr.screenY):Wa=Ji=0,Kr=r),Ji)},movementY:function(r){return"movementY"in r?r.movementY:Wa}}),Ul=cn(Ya),oa=v({},Ya,{dataTransfer:0}),Ru=cn(oa),Du=v({},Xi,{relatedTarget:0}),la=cn(Du),zl=v({},pi,{animationName:0,elapsedTime:0,pseudoElement:0}),Iu=cn(zl),Xa=v({},pi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),ju=cn(Xa),Ou=v({},pi,{data:0}),$r=cn(Ou),Mu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ku={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pu(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=Nu[r])?!!s[r]:!1}function Zi(){return Pu}var Sn=v({},Xi,{key:function(r){if(r.key){var s=Mu[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=aa(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?ku[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zi,charCode:function(r){return r.type==="keypress"?aa(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?aa(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Lu=cn(Sn),Vu=v({},Ya,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gi=cn(Vu),m=v({},Xi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zi}),E=cn(m),S=v({},pi,{propertyName:0,elapsedTime:0,pseudoElement:0}),L=cn(S),re=v({},Ya,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),ue=cn(re),xe=v({},pi,{newState:0,oldState:0}),Be=cn(xe),jt=[9,13,27,32],nt=Jn&&"CompositionEvent"in window,bt=null;Jn&&"documentMode"in document&&(bt=document.documentMode);var Zn=Jn&&"TextEvent"in window&&!bt,Wr=Jn&&(!nt||bt&&8<bt&&11>=bt),br=" ",Er=!1;function ca(r,s){switch(r){case"keyup":return jt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ja(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Za=!1;function VT(r,s){switch(r){case"compositionend":return Ja(s);case"keypress":return s.which!==32?null:(Er=!0,br);case"textInput":return r=s.data,r===br&&Er?null:r;default:return null}}function BT(r,s){if(Za)return r==="compositionend"||!nt&&ca(r,s)?(r=Vl(),sa=Ll=Gr=null,Za=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Wr&&s.locale!=="ko"?null:s.data;default:return null}}var UT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uy(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!UT[r.type]:s==="textarea"}function zy(r,s,o,u){Wi?Qr?Qr.push(u):Qr=[u]:Wi=u,s=Cd(s,"onChange"),0<s.length&&(o=new Hr("onChange","change",null,o,u),r.push({event:o,listeners:s}))}var Fl=null,ql=null;function zT(r){Sv(r,0)}function Bu(r){var s=Ln(r);if(ta(s))return r}function Fy(r,s){if(r==="change")return s}var qy=!1;if(Jn){var bf;if(Jn){var Ef="oninput"in document;if(!Ef){var Qy=document.createElement("div");Qy.setAttribute("oninput","return;"),Ef=typeof Qy.oninput=="function"}bf=Ef}else bf=!1;qy=bf&&(!document.documentMode||9<document.documentMode)}function Gy(){Fl&&(Fl.detachEvent("onpropertychange",Hy),ql=Fl=null)}function Hy(r){if(r.propertyName==="value"&&Bu(ql)){var s=[];zy(s,ql,r,Xn(r)),Yi(zT,s)}}function FT(r,s,o){r==="focusin"?(Gy(),Fl=s,ql=o,Fl.attachEvent("onpropertychange",Hy)):r==="focusout"&&Gy()}function qT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Bu(ql)}function QT(r,s){if(r==="click")return Bu(s)}function GT(r,s){if(r==="input"||r==="change")return Bu(s)}function HT(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Bn=typeof Object.is=="function"?Object.is:HT;function Ql(r,s){if(Bn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var o=Object.keys(r),u=Object.keys(s);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var g=o[u];if(!st.call(s,g)||!Bn(r[g],s[g]))return!1}return!0}function Ky(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function $y(r,s){var o=Ky(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=s&&u>=s)return{node:o,offset:s-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Ky(o)}}function Wy(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?Wy(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function Yy(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=qr(r.document);s instanceof r.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)r=s.contentWindow;else break;s=qr(r.document)}return s}function xf(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var KT=Jn&&"documentMode"in document&&11>=document.documentMode,eo=null,Sf=null,Gl=null,wf=!1;function Xy(r,s,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;wf||eo==null||eo!==qr(u)||(u=eo,"selectionStart"in u&&xf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Gl&&Ql(Gl,u)||(Gl=u,u=Cd(Sf,"onSelect"),0<u.length&&(s=new Hr("onSelect","select",null,s,o),r.push({event:s,listeners:u}),s.target=eo)))}function ua(r,s){var o={};return o[r.toLowerCase()]=s.toLowerCase(),o["Webkit"+r]="webkit"+s,o["Moz"+r]="moz"+s,o}var to={animationend:ua("Animation","AnimationEnd"),animationiteration:ua("Animation","AnimationIteration"),animationstart:ua("Animation","AnimationStart"),transitionrun:ua("Transition","TransitionRun"),transitionstart:ua("Transition","TransitionStart"),transitioncancel:ua("Transition","TransitionCancel"),transitionend:ua("Transition","TransitionEnd")},Tf={},Jy={};Jn&&(Jy=document.createElement("div").style,"AnimationEvent"in window||(delete to.animationend.animation,delete to.animationiteration.animation,delete to.animationstart.animation),"TransitionEvent"in window||delete to.transitionend.transition);function da(r){if(Tf[r])return Tf[r];if(!to[r])return r;var s=to[r],o;for(o in s)if(s.hasOwnProperty(o)&&o in Jy)return Tf[r]=s[o];return r}var Zy=da("animationend"),e_=da("animationiteration"),t_=da("animationstart"),$T=da("transitionrun"),WT=da("transitionstart"),YT=da("transitioncancel"),n_=da("transitionend"),r_=new Map,Af="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Af.push("scrollEnd");function xr(r,s){r_.set(r,s),zr(s,[r])}var Uu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},er=[],no=0,Cf=0;function zu(){for(var r=no,s=Cf=no=0;s<r;){var o=er[s];er[s++]=null;var u=er[s];er[s++]=null;var g=er[s];er[s++]=null;var y=er[s];if(er[s++]=null,u!==null&&g!==null){var x=u.pending;x===null?g.next=g:(g.next=x.next,x.next=g),u.pending=g}y!==0&&i_(o,g,y)}}function Fu(r,s,o,u){er[no++]=r,er[no++]=s,er[no++]=o,er[no++]=u,Cf|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function Rf(r,s,o,u){return Fu(r,s,o,u),qu(r)}function ha(r,s){return Fu(r,null,null,s),qu(r)}function i_(r,s,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var g=!1,y=r.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(g=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,g&&s!==null&&(g=31-It(o),r=y.hiddenUpdates,u=r[g],u===null?r[g]=[s]:u.push(s),s.lane=o|536870912),y):null}function qu(r){if(50<fc)throw fc=0,Lm=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var ro={};function XT(r,s,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(r,s,o,u){return new XT(r,s,o,u)}function Df(r){return r=r.prototype,!(!r||!r.isReactComponent)}function yi(r,s){var o=r.alternate;return o===null?(o=Un(r.tag,s,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=s,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,s=r.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function s_(r,s){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,s=o.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function Qu(r,s,o,u,g,y){var x=0;if(u=r,typeof r=="function")Df(r)&&(x=1);else if(typeof r=="string")x=nA(r,o,ee.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case R:return r=Un(31,o,s,g),r.elementType=R,r.lanes=y,r;case A:return fa(o.children,g,y,s);case I:x=8,g|=24;break;case P:return r=Un(12,o,s,g|2),r.elementType=P,r.lanes=y,r;case Z:return r=Un(13,o,s,g),r.elementType=Z,r.lanes=y,r;case oe:return r=Un(19,o,s,g),r.elementType=oe,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Q:x=10;break e;case G:x=9;break e;case X:x=11;break e;case O:x=14;break e;case C:x=16,u=null;break e}x=29,o=Error(i(130,r===null?"null":typeof r,"")),u=null}return s=Un(x,o,s,g),s.elementType=r,s.type=u,s.lanes=y,s}function fa(r,s,o,u){return r=Un(7,r,u,s),r.lanes=o,r}function If(r,s,o){return r=Un(6,r,null,s),r.lanes=o,r}function a_(r){var s=Un(18,null,null,0);return s.stateNode=r,s}function jf(r,s,o){return s=Un(4,r.children!==null?r.children:[],r.key,s),s.lanes=o,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var o_=new WeakMap;function tr(r,s){if(typeof r=="object"&&r!==null){var o=o_.get(r);return o!==void 0?o:(s={value:r,source:s,stack:Ct(s)},o_.set(r,s),s)}return{value:r,source:s,stack:Ct(s)}}var io=[],so=0,Gu=null,Hl=0,nr=[],rr=0,es=null,Yr=1,Xr="";function _i(r,s){io[so++]=Hl,io[so++]=Gu,Gu=r,Hl=s}function l_(r,s,o){nr[rr++]=Yr,nr[rr++]=Xr,nr[rr++]=es,es=r;var u=Yr;r=Xr;var g=32-It(u)-1;u&=~(1<<g),o+=1;var y=32-It(s)+g;if(30<y){var x=g-g%5;y=(u&(1<<x)-1).toString(32),u>>=x,g-=x,Yr=1<<32-It(s)+g|o<<g|u,Xr=y+r}else Yr=1<<y|o<<g|u,Xr=r}function Of(r){r.return!==null&&(_i(r,1),l_(r,1,0))}function Mf(r){for(;r===Gu;)Gu=io[--so],io[so]=null,Hl=io[--so],io[so]=null;for(;r===es;)es=nr[--rr],nr[rr]=null,Xr=nr[--rr],nr[rr]=null,Yr=nr[--rr],nr[rr]=null}function c_(r,s){nr[rr++]=Yr,nr[rr++]=Xr,nr[rr++]=es,Yr=s.id,Xr=s.overflow,es=r}var un=null,yt=null,Xe=!1,ts=null,ir=!1,kf=Error(i(519));function ns(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Kl(tr(s,r)),kf}function u_(r){var s=r.stateNode,o=r.type,u=r.memoizedProps;switch(s[Lt]=r,s[en]=u,o){case"dialog":Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":case"embed":Ge("load",s);break;case"video":case"audio":for(o=0;o<pc.length;o++)Ge(pc[o],s);break;case"source":Ge("error",s);break;case"img":case"image":case"link":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"input":Ge("invalid",s),wu(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ge("invalid",s);break;case"textarea":Ge("invalid",s),Ki(s,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||u.suppressHydrationWarning===!0||Cv(s.textContent,o)?(u.popover!=null&&(Ge("beforetoggle",s),Ge("toggle",s)),u.onScroll!=null&&Ge("scroll",s),u.onScrollEnd!=null&&Ge("scrollend",s),u.onClick!=null&&(s.onclick=yr),s=!0):s=!1,s||ns(r,!0)}function d_(r){for(un=r.return;un;)switch(un.tag){case 5:case 31:case 13:ir=!1;return;case 27:case 3:ir=!0;return;default:un=un.return}}function ao(r){if(r!==un)return!1;if(!Xe)return d_(r),Xe=!0,!1;var s=r.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||Jm(r.type,r.memoizedProps)),o=!o),o&&yt&&ns(r),d_(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));yt=Pv(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));yt=Pv(r)}else s===27?(s=yt,gs(r.type)?(r=rp,rp=null,yt=r):yt=s):yt=un?ar(r.stateNode.nextSibling):null;return!0}function ma(){yt=un=null,Xe=!1}function Nf(){var r=ts;return r!==null&&(On===null?On=r:On.push.apply(On,r),ts=null),r}function Kl(r){ts===null?ts=[r]:ts.push(r)}var Pf=V(null),pa=null,vi=null;function rs(r,s,o){ne(Pf,s._currentValue),s._currentValue=o}function bi(r){r._currentValue=Pf.current,q(Pf)}function Lf(r,s,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),r===o)break;r=r.return}}function Vf(r,s,o,u){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var y=g.dependencies;if(y!==null){var x=g.child;y=y.firstContext;e:for(;y!==null;){var k=y;y=g;for(var K=0;K<s.length;K++)if(k.context===s[K]){y.lanes|=o,k=y.alternate,k!==null&&(k.lanes|=o),Lf(y.return,o,r),u||(x=null);break e}y=k.next}}else if(g.tag===18){if(x=g.return,x===null)throw Error(i(341));x.lanes|=o,y=x.alternate,y!==null&&(y.lanes|=o),Lf(x,o,r),x=null}else x=g.child;if(x!==null)x.return=g;else for(x=g;x!==null;){if(x===r){x=null;break}if(g=x.sibling,g!==null){g.return=x.return,x=g;break}x=x.return}g=x}}function oo(r,s,o,u){r=null;for(var g=s,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var x=g.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var k=g.type;Bn(g.pendingProps.value,x.value)||(r!==null?r.push(k):r=[k])}}else if(g===Ee.current){if(x=g.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(bc):r=[bc])}g=g.return}r!==null&&Vf(s,r,o,u),s.flags|=262144}function Hu(r){for(r=r.firstContext;r!==null;){if(!Bn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ga(r){pa=r,vi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function dn(r){return h_(pa,r)}function Ku(r,s){return pa===null&&ga(r),h_(r,s)}function h_(r,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},vi===null){if(r===null)throw Error(i(308));vi=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else vi=vi.next=s;return o}var JT=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){s.aborted=!0,r.forEach(function(o){return o()})}},ZT=t.unstable_scheduleCallback,e1=t.unstable_NormalPriority,Ut={$$typeof:Q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bf(){return{controller:new JT,data:new Map,refCount:0}}function $l(r){r.refCount--,r.refCount===0&&ZT(e1,function(){r.controller.abort()})}var Wl=null,Uf=0,lo=0,co=null;function t1(r,s){if(Wl===null){var o=Wl=[];Uf=0,lo=qm(),co={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Uf++,s.then(f_,f_),s}function f_(){if(--Uf===0&&Wl!==null){co!==null&&(co.status="fulfilled");var r=Wl;Wl=null,lo=0,co=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function n1(r,s){var o=[],u={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return r.then(function(){u.status="fulfilled",u.value=s;for(var g=0;g<o.length;g++)(0,o[g])(s)},function(g){for(u.status="rejected",u.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),u}var m_=B.S;B.S=function(r,s){X0=$t(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&t1(r,s),m_!==null&&m_(r,s)};var ya=V(null);function zf(){var r=ya.current;return r!==null?r:mt.pooledCache}function $u(r,s){s===null?ne(ya,ya.current):ne(ya,s.pool)}function p_(){var r=zf();return r===null?null:{parent:Ut._currentValue,pool:r}}var uo=Error(i(460)),Ff=Error(i(474)),Wu=Error(i(542)),Yu={then:function(){}};function g_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function y_(r,s,o){switch(o=r[o],o===void 0?r.push(s):o!==s&&(s.then(yr,yr),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,v_(r),r;default:if(typeof s.status=="string")s.then(yr,yr);else{if(r=mt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(u){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=u}},function(u){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,v_(r),r}throw va=s,uo}}function _a(r){try{var s=r._init;return s(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(va=o,uo):o}}var va=null;function __(){if(va===null)throw Error(i(459));var r=va;return va=null,r}function v_(r){if(r===uo||r===Wu)throw Error(i(483))}var ho=null,Yl=0;function Xu(r){var s=Yl;return Yl+=1,ho===null&&(ho=[]),y_(ho,r,s)}function Xl(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function Ju(r,s){throw s.$$typeof===b?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function b_(r){function s(J,Y){if(r){var se=J.deletions;se===null?(J.deletions=[Y],J.flags|=16):se.push(Y)}}function o(J,Y){if(!r)return null;for(;Y!==null;)s(J,Y),Y=Y.sibling;return null}function u(J){for(var Y=new Map;J!==null;)J.key!==null?Y.set(J.key,J):Y.set(J.index,J),J=J.sibling;return Y}function g(J,Y){return J=yi(J,Y),J.index=0,J.sibling=null,J}function y(J,Y,se){return J.index=se,r?(se=J.alternate,se!==null?(se=se.index,se<Y?(J.flags|=67108866,Y):se):(J.flags|=67108866,Y)):(J.flags|=1048576,Y)}function x(J){return r&&J.alternate===null&&(J.flags|=67108866),J}function k(J,Y,se,me){return Y===null||Y.tag!==6?(Y=If(se,J.mode,me),Y.return=J,Y):(Y=g(Y,se),Y.return=J,Y)}function K(J,Y,se,me){var De=se.type;return De===A?he(J,Y,se.props.children,me,se.key):Y!==null&&(Y.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===C&&_a(De)===Y.type)?(Y=g(Y,se.props),Xl(Y,se),Y.return=J,Y):(Y=Qu(se.type,se.key,se.props,null,J.mode,me),Xl(Y,se),Y.return=J,Y)}function ae(J,Y,se,me){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==se.containerInfo||Y.stateNode.implementation!==se.implementation?(Y=jf(se,J.mode,me),Y.return=J,Y):(Y=g(Y,se.children||[]),Y.return=J,Y)}function he(J,Y,se,me,De){return Y===null||Y.tag!==7?(Y=fa(se,J.mode,me,De),Y.return=J,Y):(Y=g(Y,se),Y.return=J,Y)}function pe(J,Y,se){if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Y=If(""+Y,J.mode,se),Y.return=J,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case T:return se=Qu(Y.type,Y.key,Y.props,null,J.mode,se),Xl(se,Y),se.return=J,se;case w:return Y=jf(Y,J.mode,se),Y.return=J,Y;case C:return Y=_a(Y),pe(J,Y,se)}if(H(Y)||U(Y))return Y=fa(Y,J.mode,se,null),Y.return=J,Y;if(typeof Y.then=="function")return pe(J,Xu(Y),se);if(Y.$$typeof===Q)return pe(J,Ku(J,Y),se);Ju(J,Y)}return null}function le(J,Y,se,me){var De=Y!==null?Y.key:null;if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return De!==null?null:k(J,Y,""+se,me);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case T:return se.key===De?K(J,Y,se,me):null;case w:return se.key===De?ae(J,Y,se,me):null;case C:return se=_a(se),le(J,Y,se,me)}if(H(se)||U(se))return De!==null?null:he(J,Y,se,me,null);if(typeof se.then=="function")return le(J,Y,Xu(se),me);if(se.$$typeof===Q)return le(J,Y,Ku(J,se),me);Ju(J,se)}return null}function de(J,Y,se,me,De){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return J=J.get(se)||null,k(Y,J,""+me,De);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case T:return J=J.get(me.key===null?se:me.key)||null,K(Y,J,me,De);case w:return J=J.get(me.key===null?se:me.key)||null,ae(Y,J,me,De);case C:return me=_a(me),de(J,Y,se,me,De)}if(H(me)||U(me))return J=J.get(se)||null,he(Y,J,me,De,null);if(typeof me.then=="function")return de(J,Y,se,Xu(me),De);if(me.$$typeof===Q)return de(J,Y,se,Ku(Y,me),De);Ju(Y,me)}return null}function Ae(J,Y,se,me){for(var De=null,et=null,Ce=Y,ze=Y=0,Ke=null;Ce!==null&&ze<se.length;ze++){Ce.index>ze?(Ke=Ce,Ce=null):Ke=Ce.sibling;var tt=le(J,Ce,se[ze],me);if(tt===null){Ce===null&&(Ce=Ke);break}r&&Ce&&tt.alternate===null&&s(J,Ce),Y=y(tt,Y,ze),et===null?De=tt:et.sibling=tt,et=tt,Ce=Ke}if(ze===se.length)return o(J,Ce),Xe&&_i(J,ze),De;if(Ce===null){for(;ze<se.length;ze++)Ce=pe(J,se[ze],me),Ce!==null&&(Y=y(Ce,Y,ze),et===null?De=Ce:et.sibling=Ce,et=Ce);return Xe&&_i(J,ze),De}for(Ce=u(Ce);ze<se.length;ze++)Ke=de(Ce,J,ze,se[ze],me),Ke!==null&&(r&&Ke.alternate!==null&&Ce.delete(Ke.key===null?ze:Ke.key),Y=y(Ke,Y,ze),et===null?De=Ke:et.sibling=Ke,et=Ke);return r&&Ce.forEach(function(Es){return s(J,Es)}),Xe&&_i(J,ze),De}function je(J,Y,se,me){if(se==null)throw Error(i(151));for(var De=null,et=null,Ce=Y,ze=Y=0,Ke=null,tt=se.next();Ce!==null&&!tt.done;ze++,tt=se.next()){Ce.index>ze?(Ke=Ce,Ce=null):Ke=Ce.sibling;var Es=le(J,Ce,tt.value,me);if(Es===null){Ce===null&&(Ce=Ke);break}r&&Ce&&Es.alternate===null&&s(J,Ce),Y=y(Es,Y,ze),et===null?De=Es:et.sibling=Es,et=Es,Ce=Ke}if(tt.done)return o(J,Ce),Xe&&_i(J,ze),De;if(Ce===null){for(;!tt.done;ze++,tt=se.next())tt=pe(J,tt.value,me),tt!==null&&(Y=y(tt,Y,ze),et===null?De=tt:et.sibling=tt,et=tt);return Xe&&_i(J,ze),De}for(Ce=u(Ce);!tt.done;ze++,tt=se.next())tt=de(Ce,J,ze,tt.value,me),tt!==null&&(r&&tt.alternate!==null&&Ce.delete(tt.key===null?ze:tt.key),Y=y(tt,Y,ze),et===null?De=tt:et.sibling=tt,et=tt);return r&&Ce.forEach(function(fA){return s(J,fA)}),Xe&&_i(J,ze),De}function ft(J,Y,se,me){if(typeof se=="object"&&se!==null&&se.type===A&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case T:e:{for(var De=se.key;Y!==null;){if(Y.key===De){if(De=se.type,De===A){if(Y.tag===7){o(J,Y.sibling),me=g(Y,se.props.children),me.return=J,J=me;break e}}else if(Y.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===C&&_a(De)===Y.type){o(J,Y.sibling),me=g(Y,se.props),Xl(me,se),me.return=J,J=me;break e}o(J,Y);break}else s(J,Y);Y=Y.sibling}se.type===A?(me=fa(se.props.children,J.mode,me,se.key),me.return=J,J=me):(me=Qu(se.type,se.key,se.props,null,J.mode,me),Xl(me,se),me.return=J,J=me)}return x(J);case w:e:{for(De=se.key;Y!==null;){if(Y.key===De)if(Y.tag===4&&Y.stateNode.containerInfo===se.containerInfo&&Y.stateNode.implementation===se.implementation){o(J,Y.sibling),me=g(Y,se.children||[]),me.return=J,J=me;break e}else{o(J,Y);break}else s(J,Y);Y=Y.sibling}me=jf(se,J.mode,me),me.return=J,J=me}return x(J);case C:return se=_a(se),ft(J,Y,se,me)}if(H(se))return Ae(J,Y,se,me);if(U(se)){if(De=U(se),typeof De!="function")throw Error(i(150));return se=De.call(se),je(J,Y,se,me)}if(typeof se.then=="function")return ft(J,Y,Xu(se),me);if(se.$$typeof===Q)return ft(J,Y,Ku(J,se),me);Ju(J,se)}return typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint"?(se=""+se,Y!==null&&Y.tag===6?(o(J,Y.sibling),me=g(Y,se),me.return=J,J=me):(o(J,Y),me=If(se,J.mode,me),me.return=J,J=me),x(J)):o(J,Y)}return function(J,Y,se,me){try{Yl=0;var De=ft(J,Y,se,me);return ho=null,De}catch(Ce){if(Ce===uo||Ce===Wu)throw Ce;var et=Un(29,Ce,null,J.mode);return et.lanes=me,et.return=J,et}}}var ba=b_(!0),E_=b_(!1),is=!1;function qf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Qf(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ss(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function as(r,s,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(rt&2)!==0){var g=u.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),u.pending=s,s=qu(r),i_(r,null,o),s}return Fu(r,u,s,o),qu(r)}function Jl(r,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var u=s.lanes;u&=r.pendingLanes,o|=u,s.lanes=o,Tl(r,o)}}function Gf(r,s){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var g=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?g=y=x:y=y.next=x,o=o.next}while(o!==null);y===null?g=y=s:y=y.next=s}else g=y=s;o={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=s:r.next=s,o.lastBaseUpdate=s}var Hf=!1;function Zl(){if(Hf){var r=co;if(r!==null)throw r}}function ec(r,s,o,u){Hf=!1;var g=r.updateQueue;is=!1;var y=g.firstBaseUpdate,x=g.lastBaseUpdate,k=g.shared.pending;if(k!==null){g.shared.pending=null;var K=k,ae=K.next;K.next=null,x===null?y=ae:x.next=ae,x=K;var he=r.alternate;he!==null&&(he=he.updateQueue,k=he.lastBaseUpdate,k!==x&&(k===null?he.firstBaseUpdate=ae:k.next=ae,he.lastBaseUpdate=K))}if(y!==null){var pe=g.baseState;x=0,he=ae=K=null,k=y;do{var le=k.lane&-536870913,de=le!==k.lane;if(de?(He&le)===le:(u&le)===le){le!==0&&le===lo&&(Hf=!0),he!==null&&(he=he.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Ae=r,je=k;le=s;var ft=o;switch(je.tag){case 1:if(Ae=je.payload,typeof Ae=="function"){pe=Ae.call(ft,pe,le);break e}pe=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=je.payload,le=typeof Ae=="function"?Ae.call(ft,pe,le):Ae,le==null)break e;pe=v({},pe,le);break e;case 2:is=!0}}le=k.callback,le!==null&&(r.flags|=64,de&&(r.flags|=8192),de=g.callbacks,de===null?g.callbacks=[le]:de.push(le))}else de={lane:le,tag:k.tag,payload:k.payload,callback:k.callback,next:null},he===null?(ae=he=de,K=pe):he=he.next=de,x|=le;if(k=k.next,k===null){if(k=g.shared.pending,k===null)break;de=k,k=de.next,de.next=null,g.lastBaseUpdate=de,g.shared.pending=null}}while(!0);he===null&&(K=pe),g.baseState=K,g.firstBaseUpdate=ae,g.lastBaseUpdate=he,y===null&&(g.shared.lanes=0),ds|=x,r.lanes=x,r.memoizedState=pe}}function x_(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function S_(r,s){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)x_(o[r],s)}var fo=V(null),Zu=V(0);function w_(r,s){r=Di,ne(Zu,r),ne(fo,s),Di=r|s.baseLanes}function Kf(){ne(Zu,Di),ne(fo,fo.current)}function $f(){Di=Zu.current,q(fo),q(Zu)}var zn=V(null),sr=null;function os(r){var s=r.alternate;ne(Ot,Ot.current&1),ne(zn,r),sr===null&&(s===null||fo.current!==null||s.memoizedState!==null)&&(sr=r)}function Wf(r){ne(Ot,Ot.current),ne(zn,r),sr===null&&(sr=r)}function T_(r){r.tag===22?(ne(Ot,Ot.current),ne(zn,r),sr===null&&(sr=r)):ls()}function ls(){ne(Ot,Ot.current),ne(zn,zn.current)}function Fn(r){q(zn),sr===r&&(sr=null),q(Ot)}var Ot=V(0);function ed(r){for(var s=r;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||tp(o)||np(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ei=0,Ue=null,dt=null,zt=null,td=!1,mo=!1,Ea=!1,nd=0,tc=0,po=null,r1=0;function Rt(){throw Error(i(321))}function Yf(r,s){if(s===null)return!1;for(var o=0;o<s.length&&o<r.length;o++)if(!Bn(r[o],s[o]))return!1;return!0}function Xf(r,s,o,u,g,y){return Ei=y,Ue=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,B.H=r===null||r.memoizedState===null?l0:hm,Ea=!1,y=o(u,g),Ea=!1,mo&&(y=C_(s,o,u,g)),A_(r),y}function A_(r){B.H=ic;var s=dt!==null&&dt.next!==null;if(Ei=0,zt=dt=Ue=null,td=!1,tc=0,po=null,s)throw Error(i(300));r===null||Ft||(r=r.dependencies,r!==null&&Hu(r)&&(Ft=!0))}function C_(r,s,o,u){Ue=r;var g=0;do{if(mo&&(po=null),tc=0,mo=!1,25<=g)throw Error(i(301));if(g+=1,zt=dt=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}B.H=c0,y=s(o,u)}while(mo);return y}function i1(){var r=B.H,s=r.useState()[0];return s=typeof s.then=="function"?nc(s):s,r=r.useState()[0],(dt!==null?dt.memoizedState:null)!==r&&(Ue.flags|=1024),s}function Jf(){var r=nd!==0;return nd=0,r}function Zf(r,s,o){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~o}function em(r){if(td){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}td=!1}Ei=0,zt=dt=Ue=null,mo=!1,tc=nd=0,po=null}function wn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?Ue.memoizedState=zt=r:zt=zt.next=r,zt}function Mt(){if(dt===null){var r=Ue.alternate;r=r!==null?r.memoizedState:null}else r=dt.next;var s=zt===null?Ue.memoizedState:zt.next;if(s!==null)zt=s,dt=r;else{if(r===null)throw Ue.alternate===null?Error(i(467)):Error(i(310));dt=r,r={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},zt===null?Ue.memoizedState=zt=r:zt=zt.next=r}return zt}function rd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function nc(r){var s=tc;return tc+=1,po===null&&(po=[]),r=y_(po,r,s),s=Ue,(zt===null?s.memoizedState:zt.next)===null&&(s=s.alternate,B.H=s===null||s.memoizedState===null?l0:hm),r}function id(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return nc(r);if(r.$$typeof===Q)return dn(r)}throw Error(i(438,String(r)))}function tm(r){var s=null,o=Ue.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var u=Ue.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=rd(),Ue.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(r),u=0;u<r;u++)o[u]=N;return s.index++,o}function xi(r,s){return typeof s=="function"?s(r):s}function sd(r){var s=Mt();return nm(s,dt,r)}function nm(r,s,o){var u=r.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=o;var g=r.baseQueue,y=u.pending;if(y!==null){if(g!==null){var x=g.next;g.next=y.next,y.next=x}s.baseQueue=g=y,u.pending=null}if(y=r.baseState,g===null)r.memoizedState=y;else{s=g.next;var k=x=null,K=null,ae=s,he=!1;do{var pe=ae.lane&-536870913;if(pe!==ae.lane?(He&pe)===pe:(Ei&pe)===pe){var le=ae.revertLane;if(le===0)K!==null&&(K=K.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),pe===lo&&(he=!0);else if((Ei&le)===le){ae=ae.next,le===lo&&(he=!0);continue}else pe={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},K===null?(k=K=pe,x=y):K=K.next=pe,Ue.lanes|=le,ds|=le;pe=ae.action,Ea&&o(y,pe),y=ae.hasEagerState?ae.eagerState:o(y,pe)}else le={lane:pe,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},K===null?(k=K=le,x=y):K=K.next=le,Ue.lanes|=pe,ds|=pe;ae=ae.next}while(ae!==null&&ae!==s);if(K===null?x=y:K.next=k,!Bn(y,r.memoizedState)&&(Ft=!0,he&&(o=co,o!==null)))throw o;r.memoizedState=y,r.baseState=x,r.baseQueue=K,u.lastRenderedState=y}return g===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function rm(r){var s=Mt(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var u=o.dispatch,g=o.pending,y=s.memoizedState;if(g!==null){o.pending=null;var x=g=g.next;do y=r(y,x.action),x=x.next;while(x!==g);Bn(y,s.memoizedState)||(Ft=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,u]}function R_(r,s,o){var u=Ue,g=Mt(),y=Xe;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var x=!Bn((dt||g).memoizedState,o);if(x&&(g.memoizedState=o,Ft=!0),g=g.queue,am(j_.bind(null,u,g,r),[r]),g.getSnapshot!==s||x||zt!==null&&zt.memoizedState.tag&1){if(u.flags|=2048,go(9,{destroy:void 0},I_.bind(null,u,g,o,s),null),mt===null)throw Error(i(349));y||(Ei&127)!==0||D_(u,s,o)}return o}function D_(r,s,o){r.flags|=16384,r={getSnapshot:s,value:o},s=Ue.updateQueue,s===null?(s=rd(),Ue.updateQueue=s,s.stores=[r]):(o=s.stores,o===null?s.stores=[r]:o.push(r))}function I_(r,s,o,u){s.value=o,s.getSnapshot=u,O_(s)&&M_(r)}function j_(r,s,o){return o(function(){O_(s)&&M_(r)})}function O_(r){var s=r.getSnapshot;r=r.value;try{var o=s();return!Bn(r,o)}catch{return!0}}function M_(r){var s=ha(r,2);s!==null&&Mn(s,r,2)}function im(r){var s=wn();if(typeof r=="function"){var o=r;if(r=o(),Ea){Wn(!0);try{o()}finally{Wn(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:r},s}function k_(r,s,o,u){return r.baseState=o,nm(r,dt,typeof u=="function"?u:xi)}function s1(r,s,o,u,g){if(ld(r))throw Error(i(485));if(r=s.action,r!==null){var y={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){y.listeners.push(x)}};B.T!==null?o(!0):y.isTransition=!1,u(y),o=s.pending,o===null?(y.next=s.pending=y,N_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function N_(r,s){var o=s.action,u=s.payload,g=r.state;if(s.isTransition){var y=B.T,x={};B.T=x;try{var k=o(g,u),K=B.S;K!==null&&K(x,k),P_(r,s,k)}catch(ae){sm(r,s,ae)}finally{y!==null&&x.types!==null&&(y.types=x.types),B.T=y}}else try{y=o(g,u),P_(r,s,y)}catch(ae){sm(r,s,ae)}}function P_(r,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){L_(r,s,u)},function(u){return sm(r,s,u)}):L_(r,s,o)}function L_(r,s,o){s.status="fulfilled",s.value=o,V_(s),r.state=o,s=r.pending,s!==null&&(o=s.next,o===s?r.pending=null:(o=o.next,s.next=o,N_(r,o)))}function sm(r,s,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=o,V_(s),s=s.next;while(s!==u)}r.action=null}function V_(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function B_(r,s){return s}function U_(r,s){if(Xe){var o=mt.formState;if(o!==null){e:{var u=Ue;if(Xe){if(yt){t:{for(var g=yt,y=ir;g.nodeType!==8;){if(!y){g=null;break t}if(g=ar(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){yt=ar(g.nextSibling),u=g.data==="F!";break e}}ns(u)}u=!1}u&&(s=o[0])}}return o=wn(),o.memoizedState=o.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:B_,lastRenderedState:s},o.queue=u,o=s0.bind(null,Ue,u),u.dispatch=o,u=im(!1),y=dm.bind(null,Ue,!1,u.queue),u=wn(),g={state:s,dispatch:null,action:r,pending:null},u.queue=g,o=s1.bind(null,Ue,g,y,o),g.dispatch=o,u.memoizedState=r,[s,o,!1]}function z_(r){var s=Mt();return F_(s,dt,r)}function F_(r,s,o){if(s=nm(r,s,B_)[0],r=sd(xi)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var u=nc(s)}catch(x){throw x===uo?Wu:x}else u=s;s=Mt();var g=s.queue,y=g.dispatch;return o!==s.memoizedState&&(Ue.flags|=2048,go(9,{destroy:void 0},a1.bind(null,g,o),null)),[u,y,r]}function a1(r,s){r.action=s}function q_(r){var s=Mt(),o=dt;if(o!==null)return F_(s,o,r);Mt(),s=s.memoizedState,o=Mt();var u=o.queue.dispatch;return o.memoizedState=r,[s,u,!1]}function go(r,s,o,u){return r={tag:r,create:o,deps:u,inst:s,next:null},s=Ue.updateQueue,s===null&&(s=rd(),Ue.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,s.lastEffect=r),r}function Q_(){return Mt().memoizedState}function ad(r,s,o,u){var g=wn();Ue.flags|=r,g.memoizedState=go(1|s,{destroy:void 0},o,u===void 0?null:u)}function od(r,s,o,u){var g=Mt();u=u===void 0?null:u;var y=g.memoizedState.inst;dt!==null&&u!==null&&Yf(u,dt.memoizedState.deps)?g.memoizedState=go(s,y,o,u):(Ue.flags|=r,g.memoizedState=go(1|s,y,o,u))}function G_(r,s){ad(8390656,8,r,s)}function am(r,s){od(2048,8,r,s)}function o1(r){Ue.flags|=4;var s=Ue.updateQueue;if(s===null)s=rd(),Ue.updateQueue=s,s.events=[r];else{var o=s.events;o===null?s.events=[r]:o.push(r)}}function H_(r){var s=Mt().memoizedState;return o1({ref:s,nextImpl:r}),function(){if((rt&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function K_(r,s){return od(4,2,r,s)}function $_(r,s){return od(4,4,r,s)}function W_(r,s){if(typeof s=="function"){r=r();var o=s(r);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function Y_(r,s,o){o=o!=null?o.concat([r]):null,od(4,4,W_.bind(null,s,r),o)}function om(){}function X_(r,s){var o=Mt();s=s===void 0?null:s;var u=o.memoizedState;return s!==null&&Yf(s,u[1])?u[0]:(o.memoizedState=[r,s],r)}function J_(r,s){var o=Mt();s=s===void 0?null:s;var u=o.memoizedState;if(s!==null&&Yf(s,u[1]))return u[0];if(u=r(),Ea){Wn(!0);try{r()}finally{Wn(!1)}}return o.memoizedState=[u,s],u}function lm(r,s,o){return o===void 0||(Ei&1073741824)!==0&&(He&261930)===0?r.memoizedState=s:(r.memoizedState=o,r=Z0(),Ue.lanes|=r,ds|=r,o)}function Z_(r,s,o,u){return Bn(o,s)?o:fo.current!==null?(r=lm(r,o,u),Bn(r,s)||(Ft=!0),r):(Ei&42)===0||(Ei&1073741824)!==0&&(He&261930)===0?(Ft=!0,r.memoizedState=o):(r=Z0(),Ue.lanes|=r,ds|=r,s)}function e0(r,s,o,u,g){var y=z.p;z.p=y!==0&&8>y?y:8;var x=B.T,k={};B.T=k,dm(r,!1,s,o);try{var K=g(),ae=B.S;if(ae!==null&&ae(k,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var he=n1(K,u);rc(r,s,he,Gn(r))}else rc(r,s,u,Gn(r))}catch(pe){rc(r,s,{then:function(){},status:"rejected",reason:pe},Gn())}finally{z.p=y,x!==null&&k.types!==null&&(x.types=k.types),B.T=x}}function l1(){}function cm(r,s,o,u){if(r.tag!==5)throw Error(i(476));var g=t0(r).queue;e0(r,g,s,F,o===null?l1:function(){return n0(r),o(u)})}function t0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:F},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:o},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function n0(r){var s=t0(r);s.next===null&&(s=r.alternate.memoizedState),rc(r,s.next.queue,{},Gn())}function um(){return dn(bc)}function r0(){return Mt().memoizedState}function i0(){return Mt().memoizedState}function c1(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var o=Gn();r=ss(o);var u=as(s,r,o);u!==null&&(Mn(u,s,o),Jl(u,s,o)),s={cache:Bf()},r.payload=s;return}s=s.return}}function u1(r,s,o){var u=Gn();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},ld(r)?a0(s,o):(o=Rf(r,s,o,u),o!==null&&(Mn(o,r,u),o0(o,s,u)))}function s0(r,s,o){var u=Gn();rc(r,s,o,u)}function rc(r,s,o,u){var g={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(ld(r))a0(s,g);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var x=s.lastRenderedState,k=y(x,o);if(g.hasEagerState=!0,g.eagerState=k,Bn(k,x))return Fu(r,s,g,0),mt===null&&zu(),!1}catch{}if(o=Rf(r,s,g,u),o!==null)return Mn(o,r,u),o0(o,s,u),!0}return!1}function dm(r,s,o,u){if(u={lane:2,revertLane:qm(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ld(r)){if(s)throw Error(i(479))}else s=Rf(r,o,u,2),s!==null&&Mn(s,r,2)}function ld(r){var s=r.alternate;return r===Ue||s!==null&&s===Ue}function a0(r,s){mo=td=!0;var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}function o0(r,s,o){if((o&4194048)!==0){var u=s.lanes;u&=r.pendingLanes,o|=u,s.lanes=o,Tl(r,o)}}var ic={readContext:dn,use:id,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useLayoutEffect:Rt,useInsertionEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useSyncExternalStore:Rt,useId:Rt,useHostTransitionStatus:Rt,useFormState:Rt,useActionState:Rt,useOptimistic:Rt,useMemoCache:Rt,useCacheRefresh:Rt};ic.useEffectEvent=Rt;var l0={readContext:dn,use:id,useCallback:function(r,s){return wn().memoizedState=[r,s===void 0?null:s],r},useContext:dn,useEffect:G_,useImperativeHandle:function(r,s,o){o=o!=null?o.concat([r]):null,ad(4194308,4,W_.bind(null,s,r),o)},useLayoutEffect:function(r,s){return ad(4194308,4,r,s)},useInsertionEffect:function(r,s){ad(4,2,r,s)},useMemo:function(r,s){var o=wn();s=s===void 0?null:s;var u=r();if(Ea){Wn(!0);try{r()}finally{Wn(!1)}}return o.memoizedState=[u,s],u},useReducer:function(r,s,o){var u=wn();if(o!==void 0){var g=o(s);if(Ea){Wn(!0);try{o(s)}finally{Wn(!1)}}}else g=s;return u.memoizedState=u.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},u.queue=r,r=r.dispatch=u1.bind(null,Ue,r),[u.memoizedState,r]},useRef:function(r){var s=wn();return r={current:r},s.memoizedState=r},useState:function(r){r=im(r);var s=r.queue,o=s0.bind(null,Ue,s);return s.dispatch=o,[r.memoizedState,o]},useDebugValue:om,useDeferredValue:function(r,s){var o=wn();return lm(o,r,s)},useTransition:function(){var r=im(!1);return r=e0.bind(null,Ue,r.queue,!0,!1),wn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,o){var u=Ue,g=wn();if(Xe){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),mt===null)throw Error(i(349));(He&127)!==0||D_(u,s,o)}g.memoizedState=o;var y={value:o,getSnapshot:s};return g.queue=y,G_(j_.bind(null,u,y,r),[r]),u.flags|=2048,go(9,{destroy:void 0},I_.bind(null,u,y,o,s),null),o},useId:function(){var r=wn(),s=mt.identifierPrefix;if(Xe){var o=Xr,u=Yr;o=(u&~(1<<32-It(u)-1)).toString(32)+o,s="_"+s+"R_"+o,o=nd++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=r1++,s="_"+s+"r_"+o.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:um,useFormState:U_,useActionState:U_,useOptimistic:function(r){var s=wn();s.memoizedState=s.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=dm.bind(null,Ue,!0,o),o.dispatch=s,[r,s]},useMemoCache:tm,useCacheRefresh:function(){return wn().memoizedState=c1.bind(null,Ue)},useEffectEvent:function(r){var s=wn(),o={impl:r};return s.memoizedState=o,function(){if((rt&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},hm={readContext:dn,use:id,useCallback:X_,useContext:dn,useEffect:am,useImperativeHandle:Y_,useInsertionEffect:K_,useLayoutEffect:$_,useMemo:J_,useReducer:sd,useRef:Q_,useState:function(){return sd(xi)},useDebugValue:om,useDeferredValue:function(r,s){var o=Mt();return Z_(o,dt.memoizedState,r,s)},useTransition:function(){var r=sd(xi)[0],s=Mt().memoizedState;return[typeof r=="boolean"?r:nc(r),s]},useSyncExternalStore:R_,useId:r0,useHostTransitionStatus:um,useFormState:z_,useActionState:z_,useOptimistic:function(r,s){var o=Mt();return k_(o,dt,r,s)},useMemoCache:tm,useCacheRefresh:i0};hm.useEffectEvent=H_;var c0={readContext:dn,use:id,useCallback:X_,useContext:dn,useEffect:am,useImperativeHandle:Y_,useInsertionEffect:K_,useLayoutEffect:$_,useMemo:J_,useReducer:rm,useRef:Q_,useState:function(){return rm(xi)},useDebugValue:om,useDeferredValue:function(r,s){var o=Mt();return dt===null?lm(o,r,s):Z_(o,dt.memoizedState,r,s)},useTransition:function(){var r=rm(xi)[0],s=Mt().memoizedState;return[typeof r=="boolean"?r:nc(r),s]},useSyncExternalStore:R_,useId:r0,useHostTransitionStatus:um,useFormState:q_,useActionState:q_,useOptimistic:function(r,s){var o=Mt();return dt!==null?k_(o,dt,r,s):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:tm,useCacheRefresh:i0};c0.useEffectEvent=H_;function fm(r,s,o,u){s=r.memoizedState,o=o(u,s),o=o==null?s:v({},s,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var mm={enqueueSetState:function(r,s,o){r=r._reactInternals;var u=Gn(),g=ss(u);g.payload=s,o!=null&&(g.callback=o),s=as(r,g,u),s!==null&&(Mn(s,r,u),Jl(s,r,u))},enqueueReplaceState:function(r,s,o){r=r._reactInternals;var u=Gn(),g=ss(u);g.tag=1,g.payload=s,o!=null&&(g.callback=o),s=as(r,g,u),s!==null&&(Mn(s,r,u),Jl(s,r,u))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var o=Gn(),u=ss(o);u.tag=2,s!=null&&(u.callback=s),s=as(r,u,o),s!==null&&(Mn(s,r,o),Jl(s,r,o))}};function u0(r,s,o,u,g,y,x){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,y,x):s.prototype&&s.prototype.isPureReactComponent?!Ql(o,u)||!Ql(g,y):!0}function d0(r,s,o,u){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,u),s.state!==r&&mm.enqueueReplaceState(s,s.state,null)}function xa(r,s){var o=s;if("ref"in s){o={};for(var u in s)u!=="ref"&&(o[u]=s[u])}if(r=r.defaultProps){o===s&&(o=v({},o));for(var g in r)o[g]===void 0&&(o[g]=r[g])}return o}function h0(r){Uu(r)}function f0(r){console.error(r)}function m0(r){Uu(r)}function cd(r,s){try{var o=r.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function p0(r,s,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function pm(r,s,o){return o=ss(o),o.tag=3,o.payload={element:null},o.callback=function(){cd(r,s)},o}function g0(r){return r=ss(r),r.tag=3,r}function y0(r,s,o,u){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;r.payload=function(){return g(y)},r.callback=function(){p0(s,o,u)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(r.callback=function(){p0(s,o,u),typeof g!="function"&&(hs===null?hs=new Set([this]):hs.add(this));var k=u.stack;this.componentDidCatch(u.value,{componentStack:k!==null?k:""})})}function d1(r,s,o,u,g){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=o.alternate,s!==null&&oo(s,o,g,!0),o=zn.current,o!==null){switch(o.tag){case 31:case 13:return sr===null?Ed():o.alternate===null&&Dt===0&&(Dt=3),o.flags&=-257,o.flags|=65536,o.lanes=g,u===Yu?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([u]):s.add(u),Um(r,u,g)),!1;case 22:return o.flags|=65536,u===Yu?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([u]):o.add(u)),Um(r,u,g)),!1}throw Error(i(435,o.tag))}return Um(r,u,g),Ed(),!1}if(Xe)return s=zn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,u!==kf&&(r=Error(i(422),{cause:u}),Kl(tr(r,o)))):(u!==kf&&(s=Error(i(423),{cause:u}),Kl(tr(s,o))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,u=tr(u,o),g=pm(r.stateNode,u,g),Gf(r,g),Dt!==4&&(Dt=2)),!1;var y=Error(i(520),{cause:u});if(y=tr(y,o),hc===null?hc=[y]:hc.push(y),Dt!==4&&(Dt=2),s===null)return!0;u=tr(u,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,r=g&-g,o.lanes|=r,r=pm(o.stateNode,u,r),Gf(o,r),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(hs===null||!hs.has(y))))return o.flags|=65536,g&=-g,o.lanes|=g,g=g0(g),y0(g,r,o,u),Gf(o,g),!1}o=o.return}while(o!==null);return!1}var gm=Error(i(461)),Ft=!1;function hn(r,s,o,u){s.child=r===null?E_(s,null,o,u):ba(s,r.child,o,u)}function _0(r,s,o,u,g){o=o.render;var y=s.ref;if("ref"in u){var x={};for(var k in u)k!=="ref"&&(x[k]=u[k])}else x=u;return ga(s),u=Xf(r,s,o,x,y,g),k=Jf(),r!==null&&!Ft?(Zf(r,s,g),Si(r,s,g)):(Xe&&k&&Of(s),s.flags|=1,hn(r,s,u,g),s.child)}function v0(r,s,o,u,g){if(r===null){var y=o.type;return typeof y=="function"&&!Df(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,b0(r,s,y,u,g)):(r=Qu(o.type,null,u,s,s.mode,g),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,!wm(r,g)){var x=y.memoizedProps;if(o=o.compare,o=o!==null?o:Ql,o(x,u)&&r.ref===s.ref)return Si(r,s,g)}return s.flags|=1,r=yi(y,u),r.ref=s.ref,r.return=s,s.child=r}function b0(r,s,o,u,g){if(r!==null){var y=r.memoizedProps;if(Ql(y,u)&&r.ref===s.ref)if(Ft=!1,s.pendingProps=u=y,wm(r,g))(r.flags&131072)!==0&&(Ft=!0);else return s.lanes=r.lanes,Si(r,s,g)}return ym(r,s,o,u,g)}function E0(r,s,o,u){var g=u.children,y=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(u=s.child=r.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~y}else u=0,s.child=null;return x0(r,s,y,o,u)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&$u(s,y!==null?y.cachePool:null),y!==null?w_(s,y):Kf(),T_(s);else return u=s.lanes=536870912,x0(r,s,y!==null?y.baseLanes|o:o,o,u)}else y!==null?($u(s,y.cachePool),w_(s,y),ls(),s.memoizedState=null):(r!==null&&$u(s,null),Kf(),ls());return hn(r,s,g,o),s.child}function sc(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function x0(r,s,o,u,g){var y=zf();return y=y===null?null:{parent:Ut._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},r!==null&&$u(s,null),Kf(),T_(s),r!==null&&oo(r,s,u,!0),s.childLanes=g,null}function ud(r,s){return s=hd({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function S0(r,s,o){return ba(s,r.child,null,o),r=ud(s,s.pendingProps),r.flags|=2,Fn(s),s.memoizedState=null,r}function h1(r,s,o){var u=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(Xe){if(u.mode==="hidden")return r=ud(s,u),s.lanes=536870912,sc(null,r);if(Wf(s),(r=yt)?(r=Nv(r,ir),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:es!==null?{id:Yr,overflow:Xr}:null,retryLane:536870912,hydrationErrors:null},o=a_(r),o.return=s,s.child=o,un=s,yt=null)):r=null,r===null)throw ns(s);return s.lanes=536870912,null}return ud(s,u)}var y=r.memoizedState;if(y!==null){var x=y.dehydrated;if(Wf(s),g)if(s.flags&256)s.flags&=-257,s=S0(r,s,o);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(Ft||oo(r,s,o,!1),g=(o&r.childLanes)!==0,Ft||g){if(u=mt,u!==null&&(x=Al(u,o),x!==0&&x!==y.retryLane))throw y.retryLane=x,ha(r,x),Mn(u,r,x),gm;Ed(),s=S0(r,s,o)}else r=y.treeContext,yt=ar(x.nextSibling),un=s,Xe=!0,ts=null,ir=!1,r!==null&&c_(s,r),s=ud(s,u),s.flags|=4096;return s}return r=yi(r.child,{mode:u.mode,children:u.children}),r.ref=s.ref,s.child=r,r.return=s,r}function dd(r,s){var o=s.ref;if(o===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(r===null||r.ref!==o)&&(s.flags|=4194816)}}function ym(r,s,o,u,g){return ga(s),o=Xf(r,s,o,u,void 0,g),u=Jf(),r!==null&&!Ft?(Zf(r,s,g),Si(r,s,g)):(Xe&&u&&Of(s),s.flags|=1,hn(r,s,o,g),s.child)}function w0(r,s,o,u,g,y){return ga(s),s.updateQueue=null,o=C_(s,u,o,g),A_(r),u=Jf(),r!==null&&!Ft?(Zf(r,s,y),Si(r,s,y)):(Xe&&u&&Of(s),s.flags|=1,hn(r,s,o,y),s.child)}function T0(r,s,o,u,g){if(ga(s),s.stateNode===null){var y=ro,x=o.contextType;typeof x=="object"&&x!==null&&(y=dn(x)),y=new o(u,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=mm,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=u,y.state=s.memoizedState,y.refs={},qf(s),x=o.contextType,y.context=typeof x=="object"&&x!==null?dn(x):ro,y.state=s.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(fm(s,o,x,u),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(x=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),x!==y.state&&mm.enqueueReplaceState(y,y.state,null),ec(s,u,y,g),Zl(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(r===null){y=s.stateNode;var k=s.memoizedProps,K=xa(o,k);y.props=K;var ae=y.context,he=o.contextType;x=ro,typeof he=="object"&&he!==null&&(x=dn(he));var pe=o.getDerivedStateFromProps;he=typeof pe=="function"||typeof y.getSnapshotBeforeUpdate=="function",k=s.pendingProps!==k,he||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(k||ae!==x)&&d0(s,y,u,x),is=!1;var le=s.memoizedState;y.state=le,ec(s,u,y,g),Zl(),ae=s.memoizedState,k||le!==ae||is?(typeof pe=="function"&&(fm(s,o,pe,u),ae=s.memoizedState),(K=is||u0(s,o,K,u,le,ae,x))?(he||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=ae),y.props=u,y.state=ae,y.context=x,u=K):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{y=s.stateNode,Qf(r,s),x=s.memoizedProps,he=xa(o,x),y.props=he,pe=s.pendingProps,le=y.context,ae=o.contextType,K=ro,typeof ae=="object"&&ae!==null&&(K=dn(ae)),k=o.getDerivedStateFromProps,(ae=typeof k=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(x!==pe||le!==K)&&d0(s,y,u,K),is=!1,le=s.memoizedState,y.state=le,ec(s,u,y,g),Zl();var de=s.memoizedState;x!==pe||le!==de||is||r!==null&&r.dependencies!==null&&Hu(r.dependencies)?(typeof k=="function"&&(fm(s,o,k,u),de=s.memoizedState),(he=is||u0(s,o,he,u,le,de,K)||r!==null&&r.dependencies!==null&&Hu(r.dependencies))?(ae||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,de,K),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,de,K)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||x===r.memoizedProps&&le===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&le===r.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=de),y.props=u,y.state=de,y.context=K,u=he):(typeof y.componentDidUpdate!="function"||x===r.memoizedProps&&le===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&le===r.memoizedState||(s.flags|=1024),u=!1)}return y=u,dd(r,s),u=(s.flags&128)!==0,y||u?(y=s.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,r!==null&&u?(s.child=ba(s,r.child,null,g),s.child=ba(s,null,o,g)):hn(r,s,o,g),s.memoizedState=y.state,r=s.child):r=Si(r,s,g),r}function A0(r,s,o,u){return ma(),s.flags|=256,hn(r,s,o,u),s.child}var _m={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vm(r){return{baseLanes:r,cachePool:p_()}}function bm(r,s,o){return r=r!==null?r.childLanes&~o:0,s&&(r|=Qn),r}function C0(r,s,o){var u=s.pendingProps,g=!1,y=(s.flags&128)!==0,x;if((x=y)||(x=r!==null&&r.memoizedState===null?!1:(Ot.current&2)!==0),x&&(g=!0,s.flags&=-129),x=(s.flags&32)!==0,s.flags&=-33,r===null){if(Xe){if(g?os(s):ls(),(r=yt)?(r=Nv(r,ir),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:es!==null?{id:Yr,overflow:Xr}:null,retryLane:536870912,hydrationErrors:null},o=a_(r),o.return=s,s.child=o,un=s,yt=null)):r=null,r===null)throw ns(s);return np(r)?s.lanes=32:s.lanes=536870912,null}var k=u.children;return u=u.fallback,g?(ls(),g=s.mode,k=hd({mode:"hidden",children:k},g),u=fa(u,g,o,null),k.return=s,u.return=s,k.sibling=u,s.child=k,u=s.child,u.memoizedState=vm(o),u.childLanes=bm(r,x,o),s.memoizedState=_m,sc(null,u)):(os(s),Em(s,k))}var K=r.memoizedState;if(K!==null&&(k=K.dehydrated,k!==null)){if(y)s.flags&256?(os(s),s.flags&=-257,s=xm(r,s,o)):s.memoizedState!==null?(ls(),s.child=r.child,s.flags|=128,s=null):(ls(),k=u.fallback,g=s.mode,u=hd({mode:"visible",children:u.children},g),k=fa(k,g,o,null),k.flags|=2,u.return=s,k.return=s,u.sibling=k,s.child=u,ba(s,r.child,null,o),u=s.child,u.memoizedState=vm(o),u.childLanes=bm(r,x,o),s.memoizedState=_m,s=sc(null,u));else if(os(s),np(k)){if(x=k.nextSibling&&k.nextSibling.dataset,x)var ae=x.dgst;x=ae,u=Error(i(419)),u.stack="",u.digest=x,Kl({value:u,source:null,stack:null}),s=xm(r,s,o)}else if(Ft||oo(r,s,o,!1),x=(o&r.childLanes)!==0,Ft||x){if(x=mt,x!==null&&(u=Al(x,o),u!==0&&u!==K.retryLane))throw K.retryLane=u,ha(r,u),Mn(x,r,u),gm;tp(k)||Ed(),s=xm(r,s,o)}else tp(k)?(s.flags|=192,s.child=r.child,s=null):(r=K.treeContext,yt=ar(k.nextSibling),un=s,Xe=!0,ts=null,ir=!1,r!==null&&c_(s,r),s=Em(s,u.children),s.flags|=4096);return s}return g?(ls(),k=u.fallback,g=s.mode,K=r.child,ae=K.sibling,u=yi(K,{mode:"hidden",children:u.children}),u.subtreeFlags=K.subtreeFlags&65011712,ae!==null?k=yi(ae,k):(k=fa(k,g,o,null),k.flags|=2),k.return=s,u.return=s,u.sibling=k,s.child=u,sc(null,u),u=s.child,k=r.child.memoizedState,k===null?k=vm(o):(g=k.cachePool,g!==null?(K=Ut._currentValue,g=g.parent!==K?{parent:K,pool:K}:g):g=p_(),k={baseLanes:k.baseLanes|o,cachePool:g}),u.memoizedState=k,u.childLanes=bm(r,x,o),s.memoizedState=_m,sc(r.child,u)):(os(s),o=r.child,r=o.sibling,o=yi(o,{mode:"visible",children:u.children}),o.return=s,o.sibling=null,r!==null&&(x=s.deletions,x===null?(s.deletions=[r],s.flags|=16):x.push(r)),s.child=o,s.memoizedState=null,o)}function Em(r,s){return s=hd({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function hd(r,s){return r=Un(22,r,null,s),r.lanes=0,r}function xm(r,s,o){return ba(s,r.child,null,o),r=Em(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function R0(r,s,o){r.lanes|=s;var u=r.alternate;u!==null&&(u.lanes|=s),Lf(r.return,s,o)}function Sm(r,s,o,u,g,y){var x=r.memoizedState;x===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:g,treeForkCount:y}:(x.isBackwards=s,x.rendering=null,x.renderingStartTime=0,x.last=u,x.tail=o,x.tailMode=g,x.treeForkCount=y)}function D0(r,s,o){var u=s.pendingProps,g=u.revealOrder,y=u.tail;u=u.children;var x=Ot.current,k=(x&2)!==0;if(k?(x=x&1|2,s.flags|=128):x&=1,ne(Ot,x),hn(r,s,u,o),u=Xe?Hl:0,!k&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&R0(r,o,s);else if(r.tag===19)R0(r,o,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(g){case"forwards":for(o=s.child,g=null;o!==null;)r=o.alternate,r!==null&&ed(r)===null&&(g=o),o=o.sibling;o=g,o===null?(g=s.child,s.child=null):(g=o.sibling,o.sibling=null),Sm(s,!1,g,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=s.child,s.child=null;g!==null;){if(r=g.alternate,r!==null&&ed(r)===null){s.child=g;break}r=g.sibling,g.sibling=o,o=g,g=r}Sm(s,!0,o,null,y,u);break;case"together":Sm(s,!1,null,null,void 0,u);break;default:s.memoizedState=null}return s.child}function Si(r,s,o){if(r!==null&&(s.dependencies=r.dependencies),ds|=s.lanes,(o&s.childLanes)===0)if(r!==null){if(oo(r,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,o=yi(r,r.pendingProps),s.child=o,o.return=s;r.sibling!==null;)r=r.sibling,o=o.sibling=yi(r,r.pendingProps),o.return=s;o.sibling=null}return s.child}function wm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&Hu(r)))}function f1(r,s,o){switch(s.tag){case 3:ve(s,s.stateNode.containerInfo),rs(s,Ut,r.memoizedState.cache),ma();break;case 27:case 5:fe(s);break;case 4:ve(s,s.stateNode.containerInfo);break;case 10:rs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Wf(s),null;break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(os(s),s.flags|=128,null):(o&s.child.childLanes)!==0?C0(r,s,o):(os(s),r=Si(r,s,o),r!==null?r.sibling:null);os(s);break;case 19:var g=(r.flags&128)!==0;if(u=(o&s.childLanes)!==0,u||(oo(r,s,o,!1),u=(o&s.childLanes)!==0),g){if(u)return D0(r,s,o);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),ne(Ot,Ot.current),u)break;return null;case 22:return s.lanes=0,E0(r,s,o,s.pendingProps);case 24:rs(s,Ut,r.memoizedState.cache)}return Si(r,s,o)}function I0(r,s,o){if(r!==null)if(r.memoizedProps!==s.pendingProps)Ft=!0;else{if(!wm(r,o)&&(s.flags&128)===0)return Ft=!1,f1(r,s,o);Ft=(r.flags&131072)!==0}else Ft=!1,Xe&&(s.flags&1048576)!==0&&l_(s,Hl,s.index);switch(s.lanes=0,s.tag){case 16:e:{var u=s.pendingProps;if(r=_a(s.elementType),s.type=r,typeof r=="function")Df(r)?(u=xa(r,u),s.tag=1,s=T0(null,s,r,u,o)):(s.tag=0,s=ym(null,s,r,u,o));else{if(r!=null){var g=r.$$typeof;if(g===X){s.tag=11,s=_0(null,s,r,u,o);break e}else if(g===O){s.tag=14,s=v0(null,s,r,u,o);break e}}throw s=W(r)||r,Error(i(306,s,""))}}return s;case 0:return ym(r,s,s.type,s.pendingProps,o);case 1:return u=s.type,g=xa(u,s.pendingProps),T0(r,s,u,g,o);case 3:e:{if(ve(s,s.stateNode.containerInfo),r===null)throw Error(i(387));u=s.pendingProps;var y=s.memoizedState;g=y.element,Qf(r,s),ec(s,u,null,o);var x=s.memoizedState;if(u=x.cache,rs(s,Ut,u),u!==y.cache&&Vf(s,[Ut],o,!0),Zl(),u=x.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:x.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=A0(r,s,u,o);break e}else if(u!==g){g=tr(Error(i(424)),s),Kl(g),s=A0(r,s,u,o);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,yt=ar(r.firstChild),un=s,Xe=!0,ts=null,ir=!0,o=E_(s,null,u,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ma(),u===g){s=Si(r,s,o);break e}hn(r,s,u,o)}s=s.child}return s;case 26:return dd(r,s),r===null?(o=zv(s.type,null,s.pendingProps,null))?s.memoizedState=o:Xe||(o=s.type,r=s.pendingProps,u=Rd(be.current).createElement(o),u[Lt]=s,u[en]=r,fn(u,o,r),Vt(u),s.stateNode=u):s.memoizedState=zv(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return fe(s),r===null&&Xe&&(u=s.stateNode=Vv(s.type,s.pendingProps,be.current),un=s,ir=!0,g=yt,gs(s.type)?(rp=g,yt=ar(u.firstChild)):yt=g),hn(r,s,s.pendingProps.children,o),dd(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&Xe&&((g=u=yt)&&(u=q1(u,s.type,s.pendingProps,ir),u!==null?(s.stateNode=u,un=s,yt=ar(u.firstChild),ir=!1,g=!0):g=!1),g||ns(s)),fe(s),g=s.type,y=s.pendingProps,x=r!==null?r.memoizedProps:null,u=y.children,Jm(g,y)?u=null:x!==null&&Jm(g,x)&&(s.flags|=32),s.memoizedState!==null&&(g=Xf(r,s,i1,null,null,o),bc._currentValue=g),dd(r,s),hn(r,s,u,o),s.child;case 6:return r===null&&Xe&&((r=o=yt)&&(o=Q1(o,s.pendingProps,ir),o!==null?(s.stateNode=o,un=s,yt=null,r=!0):r=!1),r||ns(s)),null;case 13:return C0(r,s,o);case 4:return ve(s,s.stateNode.containerInfo),u=s.pendingProps,r===null?s.child=ba(s,null,u,o):hn(r,s,u,o),s.child;case 11:return _0(r,s,s.type,s.pendingProps,o);case 7:return hn(r,s,s.pendingProps,o),s.child;case 8:return hn(r,s,s.pendingProps.children,o),s.child;case 12:return hn(r,s,s.pendingProps.children,o),s.child;case 10:return u=s.pendingProps,rs(s,s.type,u.value),hn(r,s,u.children,o),s.child;case 9:return g=s.type._context,u=s.pendingProps.children,ga(s),g=dn(g),u=u(g),s.flags|=1,hn(r,s,u,o),s.child;case 14:return v0(r,s,s.type,s.pendingProps,o);case 15:return b0(r,s,s.type,s.pendingProps,o);case 19:return D0(r,s,o);case 31:return h1(r,s,o);case 22:return E0(r,s,o,s.pendingProps);case 24:return ga(s),u=dn(Ut),r===null?(g=zf(),g===null&&(g=mt,y=Bf(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=o),g=y),s.memoizedState={parent:u,cache:g},qf(s),rs(s,Ut,g)):((r.lanes&o)!==0&&(Qf(r,s),ec(s,null,null,o),Zl()),g=r.memoizedState,y=s.memoizedState,g.parent!==u?(g={parent:u,cache:u},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),rs(s,Ut,u)):(u=y.cache,rs(s,Ut,u),u!==g.cache&&Vf(s,[Ut],o,!0))),hn(r,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function wi(r){r.flags|=4}function Tm(r,s,o,u,g){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(g&335544128)===g)if(r.stateNode.complete)r.flags|=8192;else if(rv())r.flags|=8192;else throw va=Yu,Ff}else r.flags&=-16777217}function j0(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Hv(s))if(rv())r.flags|=8192;else throw va=Yu,Ff}function fd(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?vu():536870912,r.lanes|=s,bo|=s)}function ac(r,s){if(!Xe)switch(r.tailMode){case"hidden":s=r.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function _t(r){var s=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(s)for(var g=r.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=u,r.childLanes=o,s}function m1(r,s,o){var u=s.pendingProps;switch(Mf(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(s),null;case 1:return _t(s),null;case 3:return o=s.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),bi(Ut),Se(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(ao(s)?wi(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Nf())),_t(s),null;case 26:var g=s.type,y=s.memoizedState;return r===null?(wi(s),y!==null?(_t(s),j0(s,y)):(_t(s),Tm(s,g,null,u,o))):y?y!==r.memoizedState?(wi(s),_t(s),j0(s,y)):(_t(s),s.flags&=-16777217):(r=r.memoizedProps,r!==u&&wi(s),_t(s),Tm(s,g,r,u,o)),null;case 27:if(Ze(s),o=be.current,g=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==u&&wi(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return _t(s),null}r=ee.current,ao(s)?u_(s):(r=Vv(g,u,o),s.stateNode=r,wi(s))}return _t(s),null;case 5:if(Ze(s),g=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==u&&wi(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return _t(s),null}if(y=ee.current,ao(s))u_(s);else{var x=Rd(be.current);switch(y){case 1:y=x.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=x.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=x.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=x.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=x.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?x.createElement("select",{is:u.is}):x.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?x.createElement(g,{is:u.is}):x.createElement(g)}}y[Lt]=s,y[en]=u;e:for(x=s.child;x!==null;){if(x.tag===5||x.tag===6)y.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===s)break e;for(;x.sibling===null;){if(x.return===null||x.return===s)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}s.stateNode=y;e:switch(fn(y,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&wi(s)}}return _t(s),Tm(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,o),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==u&&wi(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(i(166));if(r=be.current,ao(s)){if(r=s.stateNode,o=s.memoizedProps,u=null,g=un,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}r[Lt]=s,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Cv(r.nodeValue,o)),r||ns(s,!0)}else r=Rd(r).createTextNode(u),r[Lt]=s,s.stateNode=r}return _t(s),null;case 31:if(o=s.memoizedState,r===null||r.memoizedState!==null){if(u=ao(s),o!==null){if(r===null){if(!u)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Lt]=s}else ma(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;_t(s),r=!1}else o=Nf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return s.flags&256?(Fn(s),s):(Fn(s),null);if((s.flags&128)!==0)throw Error(i(558))}return _t(s),null;case 13:if(u=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=ao(s),u!==null&&u.dehydrated!==null){if(r===null){if(!g)throw Error(i(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[Lt]=s}else ma(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;_t(s),g=!1}else g=Nf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(Fn(s),s):(Fn(s),null)}return Fn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=u!==null,r=r!==null&&r.memoizedState!==null,o&&(u=s.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==g&&(u.flags|=2048)),o!==r&&o&&(s.child.flags|=8192),fd(s,s.updateQueue),_t(s),null);case 4:return Se(),r===null&&Km(s.stateNode.containerInfo),_t(s),null;case 10:return bi(s.type),_t(s),null;case 19:if(q(Ot),u=s.memoizedState,u===null)return _t(s),null;if(g=(s.flags&128)!==0,y=u.rendering,y===null)if(g)ac(u,!1);else{if(Dt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(y=ed(r),y!==null){for(s.flags|=128,ac(u,!1),r=y.updateQueue,s.updateQueue=r,fd(s,r),s.subtreeFlags=0,r=o,o=s.child;o!==null;)s_(o,r),o=o.sibling;return ne(Ot,Ot.current&1|2),Xe&&_i(s,u.treeForkCount),s.child}r=r.sibling}u.tail!==null&&$t()>_d&&(s.flags|=128,g=!0,ac(u,!1),s.lanes=4194304)}else{if(!g)if(r=ed(y),r!==null){if(s.flags|=128,g=!0,r=r.updateQueue,s.updateQueue=r,fd(s,r),ac(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!Xe)return _t(s),null}else 2*$t()-u.renderingStartTime>_d&&o!==536870912&&(s.flags|=128,g=!0,ac(u,!1),s.lanes=4194304);u.isBackwards?(y.sibling=s.child,s.child=y):(r=u.last,r!==null?r.sibling=y:s.child=y,u.last=y)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=$t(),r.sibling=null,o=Ot.current,ne(Ot,g?o&1|2:o&1),Xe&&_i(s,u.treeForkCount),r):(_t(s),null);case 22:case 23:return Fn(s),$f(),u=s.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?(o&536870912)!==0&&(s.flags&128)===0&&(_t(s),s.subtreeFlags&6&&(s.flags|=8192)):_t(s),o=s.updateQueue,o!==null&&fd(s,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==o&&(s.flags|=2048),r!==null&&q(ya),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),bi(Ut),_t(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function p1(r,s){switch(Mf(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return bi(Ut),Se(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return Ze(s),null;case 31:if(s.memoizedState!==null){if(Fn(s),s.alternate===null)throw Error(i(340));ma()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(Fn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));ma()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return q(Ot),null;case 4:return Se(),null;case 10:return bi(s.type),null;case 22:case 23:return Fn(s),$f(),r!==null&&q(ya),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return bi(Ut),null;case 25:return null;default:return null}}function O0(r,s){switch(Mf(s),s.tag){case 3:bi(Ut),Se();break;case 26:case 27:case 5:Ze(s);break;case 4:Se();break;case 31:s.memoizedState!==null&&Fn(s);break;case 13:Fn(s);break;case 19:q(Ot);break;case 10:bi(s.type);break;case 22:case 23:Fn(s),$f(),r!==null&&q(ya);break;case 24:bi(Ut)}}function oc(r,s){try{var o=s.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var g=u.next;o=g;do{if((o.tag&r)===r){u=void 0;var y=o.create,x=o.inst;u=y(),x.destroy=u}o=o.next}while(o!==g)}}catch(k){ct(s,s.return,k)}}function cs(r,s,o){try{var u=s.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var y=g.next;u=y;do{if((u.tag&r)===r){var x=u.inst,k=x.destroy;if(k!==void 0){x.destroy=void 0,g=s;var K=o,ae=k;try{ae()}catch(he){ct(g,K,he)}}}u=u.next}while(u!==y)}}catch(he){ct(s,s.return,he)}}function M0(r){var s=r.updateQueue;if(s!==null){var o=r.stateNode;try{S_(s,o)}catch(u){ct(r,r.return,u)}}}function k0(r,s,o){o.props=xa(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){ct(r,s,u)}}function lc(r,s){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(g){ct(r,s,g)}}function Jr(r,s){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(g){ct(r,s,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){ct(r,s,g)}else o.current=null}function N0(r){var s=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(g){ct(r,r.return,g)}}function Am(r,s,o){try{var u=r.stateNode;L1(u,r.type,o,s),u[en]=s}catch(g){ct(r,r.return,g)}}function P0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&gs(r.type)||r.tag===4}function Cm(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||P0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&gs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Rm(r,s,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(r),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=yr));else if(u!==4&&(u===27&&gs(r.type)&&(o=r.stateNode,s=null),r=r.child,r!==null))for(Rm(r,s,o),r=r.sibling;r!==null;)Rm(r,s,o),r=r.sibling}function md(r,s,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,s?o.insertBefore(r,s):o.appendChild(r);else if(u!==4&&(u===27&&gs(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(md(r,s,o),r=r.sibling;r!==null;)md(r,s,o),r=r.sibling}function L0(r){var s=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);fn(s,u,o),s[Lt]=r,s[en]=o}catch(y){ct(r,r.return,y)}}var Ti=!1,qt=!1,Dm=!1,V0=typeof WeakSet=="function"?WeakSet:Set,nn=null;function g1(r,s){if(r=r.containerInfo,Ym=Nd,r=Yy(r),xf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var g=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var x=0,k=-1,K=-1,ae=0,he=0,pe=r,le=null;t:for(;;){for(var de;pe!==o||g!==0&&pe.nodeType!==3||(k=x+g),pe!==y||u!==0&&pe.nodeType!==3||(K=x+u),pe.nodeType===3&&(x+=pe.nodeValue.length),(de=pe.firstChild)!==null;)le=pe,pe=de;for(;;){if(pe===r)break t;if(le===o&&++ae===g&&(k=x),le===y&&++he===u&&(K=x),(de=pe.nextSibling)!==null)break;pe=le,le=pe.parentNode}pe=de}o=k===-1||K===-1?null:{start:k,end:K}}else o=null}o=o||{start:0,end:0}}else o=null;for(Xm={focusedElem:r,selectionRange:o},Nd=!1,nn=s;nn!==null;)if(s=nn,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,nn=r;else for(;nn!==null;){switch(s=nn,y=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)g=r[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=s,g=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var Ae=xa(o.type,g);r=u.getSnapshotBeforeUpdate(Ae,y),u.__reactInternalSnapshotBeforeUpdate=r}catch(je){ct(o,o.return,je)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,o=r.nodeType,o===9)ep(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":ep(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,nn=r;break}nn=s.return}}function B0(r,s,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:Ci(r,o),u&4&&oc(5,o);break;case 1:if(Ci(r,o),u&4)if(r=o.stateNode,s===null)try{r.componentDidMount()}catch(x){ct(o,o.return,x)}else{var g=xa(o.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(g,s,r.__reactInternalSnapshotBeforeUpdate)}catch(x){ct(o,o.return,x)}}u&64&&M0(o),u&512&&lc(o,o.return);break;case 3:if(Ci(r,o),u&64&&(r=o.updateQueue,r!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{S_(r,s)}catch(x){ct(o,o.return,x)}}break;case 27:s===null&&u&4&&L0(o);case 26:case 5:Ci(r,o),s===null&&u&4&&N0(o),u&512&&lc(o,o.return);break;case 12:Ci(r,o);break;case 31:Ci(r,o),u&4&&F0(r,o);break;case 13:Ci(r,o),u&4&&q0(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=T1.bind(null,o),G1(r,o))));break;case 22:if(u=o.memoizedState!==null||Ti,!u){s=s!==null&&s.memoizedState!==null||qt,g=Ti;var y=qt;Ti=u,(qt=s)&&!y?Ri(r,o,(o.subtreeFlags&8772)!==0):Ci(r,o),Ti=g,qt=y}break;case 30:break;default:Ci(r,o)}}function U0(r){var s=r.alternate;s!==null&&(r.alternate=null,U0(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&qa(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Et=null,Dn=!1;function Ai(r,s,o){for(o=o.child;o!==null;)z0(r,s,o),o=o.sibling}function z0(r,s,o){if(ln&&typeof ln.onCommitFiberUnmount=="function")try{ln.onCommitFiberUnmount(fr,o)}catch{}switch(o.tag){case 26:qt||Jr(o,s),Ai(r,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:qt||Jr(o,s);var u=Et,g=Dn;gs(o.type)&&(Et=o.stateNode,Dn=!1),Ai(r,s,o),yc(o.stateNode),Et=u,Dn=g;break;case 5:qt||Jr(o,s);case 6:if(u=Et,g=Dn,Et=null,Ai(r,s,o),Et=u,Dn=g,Et!==null)if(Dn)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(o.stateNode)}catch(y){ct(o,s,y)}else try{Et.removeChild(o.stateNode)}catch(y){ct(o,s,y)}break;case 18:Et!==null&&(Dn?(r=Et,Mv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),Ro(r)):Mv(Et,o.stateNode));break;case 4:u=Et,g=Dn,Et=o.stateNode.containerInfo,Dn=!0,Ai(r,s,o),Et=u,Dn=g;break;case 0:case 11:case 14:case 15:cs(2,o,s),qt||cs(4,o,s),Ai(r,s,o);break;case 1:qt||(Jr(o,s),u=o.stateNode,typeof u.componentWillUnmount=="function"&&k0(o,s,u)),Ai(r,s,o);break;case 21:Ai(r,s,o);break;case 22:qt=(u=qt)||o.memoizedState!==null,Ai(r,s,o),qt=u;break;default:Ai(r,s,o)}}function F0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Ro(r)}catch(o){ct(s,s.return,o)}}}function q0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Ro(r)}catch(o){ct(s,s.return,o)}}function y1(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new V0),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new V0),s;default:throw Error(i(435,r.tag))}}function pd(r,s){var o=y1(r);s.forEach(function(u){if(!o.has(u)){o.add(u);var g=A1.bind(null,r,u);u.then(g,g)}})}function In(r,s){var o=s.deletions;if(o!==null)for(var u=0;u<o.length;u++){var g=o[u],y=r,x=s,k=x;e:for(;k!==null;){switch(k.tag){case 27:if(gs(k.type)){Et=k.stateNode,Dn=!1;break e}break;case 5:Et=k.stateNode,Dn=!1;break e;case 3:case 4:Et=k.stateNode.containerInfo,Dn=!0;break e}k=k.return}if(Et===null)throw Error(i(160));z0(y,x,g),Et=null,Dn=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Q0(s,r),s=s.sibling}var Sr=null;function Q0(r,s){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:In(s,r),jn(r),u&4&&(cs(3,r,r.return),oc(3,r),cs(5,r,r.return));break;case 1:In(s,r),jn(r),u&512&&(qt||o===null||Jr(o,o.return)),u&64&&Ti&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var g=Sr;if(In(s,r),jn(r),u&512&&(qt||o===null||Jr(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":y=g.getElementsByTagName("title")[0],(!y||y[Vr]||y[Lt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(u),g.head.insertBefore(y,g.querySelector("head > title"))),fn(y,u,o),y[Lt]=r,Vt(y),u=y;break e;case"link":var x=Qv("link","href",g).get(u+(o.href||""));if(x){for(var k=0;k<x.length;k++)if(y=x[k],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(k,1);break t}}y=g.createElement(u),fn(y,u,o),g.head.appendChild(y);break;case"meta":if(x=Qv("meta","content",g).get(u+(o.content||""))){for(k=0;k<x.length;k++)if(y=x[k],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(k,1);break t}}y=g.createElement(u),fn(y,u,o),g.head.appendChild(y);break;default:throw Error(i(468,u))}y[Lt]=r,Vt(y),u=y}r.stateNode=u}else Gv(g,r.type,r.stateNode);else r.stateNode=qv(g,u,r.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?Gv(g,r.type,r.stateNode):qv(g,u,r.memoizedProps)):u===null&&r.stateNode!==null&&Am(r,r.memoizedProps,o.memoizedProps)}break;case 27:In(s,r),jn(r),u&512&&(qt||o===null||Jr(o,o.return)),o!==null&&u&4&&Am(r,r.memoizedProps,o.memoizedProps);break;case 5:if(In(s,r),jn(r),u&512&&(qt||o===null||Jr(o,o.return)),r.flags&32){g=r.stateNode;try{Rn(g,"")}catch(Ae){ct(r,r.return,Ae)}}u&4&&r.stateNode!=null&&(g=r.memoizedProps,Am(r,g,o!==null?o.memoizedProps:g)),u&1024&&(Dm=!0);break;case 6:if(In(s,r),jn(r),u&4){if(r.stateNode===null)throw Error(i(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(Ae){ct(r,r.return,Ae)}}break;case 3:if(jd=null,g=Sr,Sr=Dd(s.containerInfo),In(s,r),Sr=g,jn(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Ro(s.containerInfo)}catch(Ae){ct(r,r.return,Ae)}Dm&&(Dm=!1,G0(r));break;case 4:u=Sr,Sr=Dd(r.stateNode.containerInfo),In(s,r),jn(r),Sr=u;break;case 12:In(s,r),jn(r);break;case 31:In(s,r),jn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,pd(r,u)));break;case 13:In(s,r),jn(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(yd=$t()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,pd(r,u)));break;case 22:g=r.memoizedState!==null;var K=o!==null&&o.memoizedState!==null,ae=Ti,he=qt;if(Ti=ae||g,qt=he||K,In(s,r),qt=he,Ti=ae,jn(r),u&8192)e:for(s=r.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(o===null||K||Ti||qt||Sa(r)),o=null,s=r;;){if(s.tag===5||s.tag===26){if(o===null){K=o=s;try{if(y=K.stateNode,g)x=y.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{k=K.stateNode;var pe=K.memoizedProps.style,le=pe!=null&&pe.hasOwnProperty("display")?pe.display:null;k.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(Ae){ct(K,K.return,Ae)}}}else if(s.tag===6){if(o===null){K=s;try{K.stateNode.nodeValue=g?"":K.memoizedProps}catch(Ae){ct(K,K.return,Ae)}}}else if(s.tag===18){if(o===null){K=s;try{var de=K.stateNode;g?kv(de,!0):kv(K.stateNode,!1)}catch(Ae){ct(K,K.return,Ae)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,pd(r,o))));break;case 19:In(s,r),jn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,pd(r,u)));break;case 30:break;case 21:break;default:In(s,r),jn(r)}}function jn(r){var s=r.flags;if(s&2){try{for(var o,u=r.return;u!==null;){if(P0(u)){o=u;break}u=u.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var g=o.stateNode,y=Cm(r);md(r,y,g);break;case 5:var x=o.stateNode;o.flags&32&&(Rn(x,""),o.flags&=-33);var k=Cm(r);md(r,k,x);break;case 3:case 4:var K=o.stateNode.containerInfo,ae=Cm(r);Rm(r,ae,K);break;default:throw Error(i(161))}}catch(he){ct(r,r.return,he)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function G0(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;G0(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Ci(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)B0(r,s.alternate,s),s=s.sibling}function Sa(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:cs(4,s,s.return),Sa(s);break;case 1:Jr(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&k0(s,s.return,o),Sa(s);break;case 27:yc(s.stateNode);case 26:case 5:Jr(s,s.return),Sa(s);break;case 22:s.memoizedState===null&&Sa(s);break;case 30:Sa(s);break;default:Sa(s)}r=r.sibling}}function Ri(r,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,g=r,y=s,x=y.flags;switch(y.tag){case 0:case 11:case 15:Ri(g,y,o),oc(4,y);break;case 1:if(Ri(g,y,o),u=y,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ae){ct(u,u.return,ae)}if(u=y,g=u.updateQueue,g!==null){var k=u.stateNode;try{var K=g.shared.hiddenCallbacks;if(K!==null)for(g.shared.hiddenCallbacks=null,g=0;g<K.length;g++)x_(K[g],k)}catch(ae){ct(u,u.return,ae)}}o&&x&64&&M0(y),lc(y,y.return);break;case 27:L0(y);case 26:case 5:Ri(g,y,o),o&&u===null&&x&4&&N0(y),lc(y,y.return);break;case 12:Ri(g,y,o);break;case 31:Ri(g,y,o),o&&x&4&&F0(g,y);break;case 13:Ri(g,y,o),o&&x&4&&q0(g,y);break;case 22:y.memoizedState===null&&Ri(g,y,o),lc(y,y.return);break;case 30:break;default:Ri(g,y,o)}s=s.sibling}}function Im(r,s){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&$l(o))}function jm(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&$l(r))}function wr(r,s,o,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)H0(r,s,o,u),s=s.sibling}function H0(r,s,o,u){var g=s.flags;switch(s.tag){case 0:case 11:case 15:wr(r,s,o,u),g&2048&&oc(9,s);break;case 1:wr(r,s,o,u);break;case 3:wr(r,s,o,u),g&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&$l(r)));break;case 12:if(g&2048){wr(r,s,o,u),r=s.stateNode;try{var y=s.memoizedProps,x=y.id,k=y.onPostCommit;typeof k=="function"&&k(x,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(K){ct(s,s.return,K)}}else wr(r,s,o,u);break;case 31:wr(r,s,o,u);break;case 13:wr(r,s,o,u);break;case 23:break;case 22:y=s.stateNode,x=s.alternate,s.memoizedState!==null?y._visibility&2?wr(r,s,o,u):cc(r,s):y._visibility&2?wr(r,s,o,u):(y._visibility|=2,yo(r,s,o,u,(s.subtreeFlags&10256)!==0||!1)),g&2048&&Im(x,s);break;case 24:wr(r,s,o,u),g&2048&&jm(s.alternate,s);break;default:wr(r,s,o,u)}}function yo(r,s,o,u,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=r,x=s,k=o,K=u,ae=x.flags;switch(x.tag){case 0:case 11:case 15:yo(y,x,k,K,g),oc(8,x);break;case 23:break;case 22:var he=x.stateNode;x.memoizedState!==null?he._visibility&2?yo(y,x,k,K,g):cc(y,x):(he._visibility|=2,yo(y,x,k,K,g)),g&&ae&2048&&Im(x.alternate,x);break;case 24:yo(y,x,k,K,g),g&&ae&2048&&jm(x.alternate,x);break;default:yo(y,x,k,K,g)}s=s.sibling}}function cc(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=r,u=s,g=u.flags;switch(u.tag){case 22:cc(o,u),g&2048&&Im(u.alternate,u);break;case 24:cc(o,u),g&2048&&jm(u.alternate,u);break;default:cc(o,u)}s=s.sibling}}var uc=8192;function _o(r,s,o){if(r.subtreeFlags&uc)for(r=r.child;r!==null;)K0(r,s,o),r=r.sibling}function K0(r,s,o){switch(r.tag){case 26:_o(r,s,o),r.flags&uc&&r.memoizedState!==null&&rA(o,Sr,r.memoizedState,r.memoizedProps);break;case 5:_o(r,s,o);break;case 3:case 4:var u=Sr;Sr=Dd(r.stateNode.containerInfo),_o(r,s,o),Sr=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=uc,uc=16777216,_o(r,s,o),uc=u):_o(r,s,o));break;default:_o(r,s,o)}}function $0(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function dc(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];nn=u,Y0(u,r)}$0(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)W0(r),r=r.sibling}function W0(r){switch(r.tag){case 0:case 11:case 15:dc(r),r.flags&2048&&cs(9,r,r.return);break;case 3:dc(r);break;case 12:dc(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,gd(r)):dc(r);break;default:dc(r)}}function gd(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];nn=u,Y0(u,r)}$0(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:cs(8,s,s.return),gd(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,gd(s));break;default:gd(s)}r=r.sibling}}function Y0(r,s){for(;nn!==null;){var o=nn;switch(o.tag){case 0:case 11:case 15:cs(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:$l(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,nn=u;else e:for(o=r;nn!==null;){u=nn;var g=u.sibling,y=u.return;if(U0(u),u===o){nn=null;break e}if(g!==null){g.return=y,nn=g;break e}nn=y}}}var _1={getCacheForType:function(r){var s=dn(Ut),o=s.data.get(r);return o===void 0&&(o=r(),s.data.set(r,o)),o},cacheSignal:function(){return dn(Ut).controller.signal}},v1=typeof WeakMap=="function"?WeakMap:Map,rt=0,mt=null,Qe=null,He=0,lt=0,qn=null,us=!1,vo=!1,Om=!1,Di=0,Dt=0,ds=0,wa=0,Mm=0,Qn=0,bo=0,hc=null,On=null,km=!1,yd=0,X0=0,_d=1/0,vd=null,hs=null,Wt=0,fs=null,Eo=null,Ii=0,Nm=0,Pm=null,J0=null,fc=0,Lm=null;function Gn(){return(rt&2)!==0&&He!==0?He&-He:B.T!==null?qm():bu()}function Z0(){if(Qn===0)if((He&536870912)===0||Xe){var r=Xs;Xs<<=1,(Xs&3932160)===0&&(Xs=262144),Qn=r}else Qn=536870912;return r=zn.current,r!==null&&(r.flags|=32),Qn}function Mn(r,s,o){(r===mt&&(lt===2||lt===9)||r.cancelPendingCommit!==null)&&(xo(r,0),ms(r,He,Qn,!1)),Js(r,o),((rt&2)===0||r!==mt)&&(r===mt&&((rt&2)===0&&(wa|=o),Dt===4&&ms(r,He,Qn,!1)),Zr(r))}function ev(r,s,o){if((rt&6)!==0)throw Error(i(327));var u=!o&&(s&127)===0&&(s&r.expiredLanes)===0||mr(r,s),g=u?x1(r,s):Bm(r,s,!0),y=u;do{if(g===0){vo&&!u&&ms(r,s,0,!1);break}else{if(o=r.current.alternate,y&&!b1(o)){g=Bm(r,s,!1),y=!1;continue}if(g===2){if(y=s,r.errorRecoveryDisabledLanes&y)var x=0;else x=r.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){s=x;e:{var k=r;g=hc;var K=k.current.memoizedState.isDehydrated;if(K&&(xo(k,x).flags|=256),x=Bm(k,x,!1),x!==2){if(Om&&!K){k.errorRecoveryDisabledLanes|=y,wa|=y,g=4;break e}y=On,On=g,y!==null&&(On===null?On=y:On.push.apply(On,y))}g=x}if(y=!1,g!==2)continue}}if(g===1){xo(r,0),ms(r,s,0,!0);break}e:{switch(u=r,y=g,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:ms(u,s,Qn,!us);break e;case 2:On=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(g=yd+300-$t(),10<g)){if(ms(u,s,Qn,!us),Nr(u,0,!0)!==0)break e;Ii=s,u.timeoutHandle=jv(tv.bind(null,u,o,On,vd,km,s,Qn,wa,bo,us,y,"Throttled",-0,0),g);break e}tv(u,o,On,vd,km,s,Qn,wa,bo,us,y,null,-0,0)}}break}while(!0);Zr(r)}function tv(r,s,o,u,g,y,x,k,K,ae,he,pe,le,de){if(r.timeoutHandle=-1,pe=s.subtreeFlags,pe&8192||(pe&16785408)===16785408){pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:yr},K0(s,y,pe);var Ae=(y&62914560)===y?yd-$t():(y&4194048)===y?X0-$t():0;if(Ae=iA(pe,Ae),Ae!==null){Ii=y,r.cancelPendingCommit=Ae(cv.bind(null,r,s,y,o,u,g,x,k,K,he,pe,null,le,de)),ms(r,y,x,!ae);return}}cv(r,s,y,o,u,g,x,k,K)}function b1(r){for(var s=r;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var g=o[u],y=g.getSnapshot;g=g.value;try{if(!Bn(y(),g))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ms(r,s,o,u){s&=~Mm,s&=~wa,r.suspendedLanes|=s,r.pingedLanes&=~s,u&&(r.warmLanes|=s),u=r.expirationTimes;for(var g=s;0<g;){var y=31-It(g),x=1<<y;u[y]=-1,g&=~x}o!==0&&Zs(r,o,s)}function bd(){return(rt&6)===0?(mc(0),!1):!0}function Vm(){if(Qe!==null){if(lt===0)var r=Qe.return;else r=Qe,vi=pa=null,em(r),ho=null,Yl=0,r=Qe;for(;r!==null;)O0(r.alternate,r),r=r.return;Qe=null}}function xo(r,s){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,U1(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),Ii=0,Vm(),mt=r,Qe=o=yi(r.current,null),He=s,lt=0,qn=null,us=!1,vo=mr(r,s),Om=!1,bo=Qn=Mm=wa=ds=Dt=0,On=hc=null,km=!1,(s&8)!==0&&(s|=s&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=s;0<u;){var g=31-It(u),y=1<<g;s|=r[g],u&=~y}return Di=s,zu(),o}function nv(r,s){Ue=null,B.H=ic,s===uo||s===Wu?(s=__(),lt=3):s===Ff?(s=__(),lt=4):lt=s===gm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,qn=s,Qe===null&&(Dt=1,cd(r,tr(s,r.current)))}function rv(){var r=zn.current;return r===null?!0:(He&4194048)===He?sr===null:(He&62914560)===He||(He&536870912)!==0?r===sr:!1}function iv(){var r=B.H;return B.H=ic,r===null?ic:r}function sv(){var r=B.A;return B.A=_1,r}function Ed(){Dt=4,us||(He&4194048)!==He&&zn.current!==null||(vo=!0),(ds&134217727)===0&&(wa&134217727)===0||mt===null||ms(mt,He,Qn,!1)}function Bm(r,s,o){var u=rt;rt|=2;var g=iv(),y=sv();(mt!==r||He!==s)&&(vd=null,xo(r,s)),s=!1;var x=Dt;e:do try{if(lt!==0&&Qe!==null){var k=Qe,K=qn;switch(lt){case 8:Vm(),x=6;break e;case 3:case 2:case 9:case 6:zn.current===null&&(s=!0);var ae=lt;if(lt=0,qn=null,So(r,k,K,ae),o&&vo){x=0;break e}break;default:ae=lt,lt=0,qn=null,So(r,k,K,ae)}}E1(),x=Dt;break}catch(he){nv(r,he)}while(!0);return s&&r.shellSuspendCounter++,vi=pa=null,rt=u,B.H=g,B.A=y,Qe===null&&(mt=null,He=0,zu()),x}function E1(){for(;Qe!==null;)av(Qe)}function x1(r,s){var o=rt;rt|=2;var u=iv(),g=sv();mt!==r||He!==s?(vd=null,_d=$t()+500,xo(r,s)):vo=mr(r,s);e:do try{if(lt!==0&&Qe!==null){s=Qe;var y=qn;t:switch(lt){case 1:lt=0,qn=null,So(r,s,y,1);break;case 2:case 9:if(g_(y)){lt=0,qn=null,ov(s);break}s=function(){lt!==2&&lt!==9||mt!==r||(lt=7),Zr(r)},y.then(s,s);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:g_(y)?(lt=0,qn=null,ov(s)):(lt=0,qn=null,So(r,s,y,7));break;case 5:var x=null;switch(Qe.tag){case 26:x=Qe.memoizedState;case 5:case 27:var k=Qe;if(x?Hv(x):k.stateNode.complete){lt=0,qn=null;var K=k.sibling;if(K!==null)Qe=K;else{var ae=k.return;ae!==null?(Qe=ae,xd(ae)):Qe=null}break t}}lt=0,qn=null,So(r,s,y,5);break;case 6:lt=0,qn=null,So(r,s,y,6);break;case 8:Vm(),Dt=6;break e;default:throw Error(i(462))}}S1();break}catch(he){nv(r,he)}while(!0);return vi=pa=null,B.H=u,B.A=g,rt=o,Qe!==null?0:(mt=null,He=0,zu(),Dt)}function S1(){for(;Qe!==null&&!xl();)av(Qe)}function av(r){var s=I0(r.alternate,r,Di);r.memoizedProps=r.pendingProps,s===null?xd(r):Qe=s}function ov(r){var s=r,o=s.alternate;switch(s.tag){case 15:case 0:s=w0(o,s,s.pendingProps,s.type,void 0,He);break;case 11:s=w0(o,s,s.pendingProps,s.type.render,s.ref,He);break;case 5:em(s);default:O0(o,s),s=Qe=s_(s,Di),s=I0(o,s,Di)}r.memoizedProps=r.pendingProps,s===null?xd(r):Qe=s}function So(r,s,o,u){vi=pa=null,em(s),ho=null,Yl=0;var g=s.return;try{if(d1(r,g,s,o,He)){Dt=1,cd(r,tr(o,r.current)),Qe=null;return}}catch(y){if(g!==null)throw Qe=g,y;Dt=1,cd(r,tr(o,r.current)),Qe=null;return}s.flags&32768?(Xe||u===1?r=!0:vo||(He&536870912)!==0?r=!1:(us=r=!0,(u===2||u===9||u===3||u===6)&&(u=zn.current,u!==null&&u.tag===13&&(u.flags|=16384))),lv(s,r)):xd(s)}function xd(r){var s=r;do{if((s.flags&32768)!==0){lv(s,us);return}r=s.return;var o=m1(s.alternate,s,Di);if(o!==null){Qe=o;return}if(s=s.sibling,s!==null){Qe=s;return}Qe=s=r}while(s!==null);Dt===0&&(Dt=5)}function lv(r,s){do{var o=p1(r.alternate,r);if(o!==null){o.flags&=32767,Qe=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(r=r.sibling,r!==null)){Qe=r;return}Qe=r=o}while(r!==null);Dt=6,Qe=null}function cv(r,s,o,u,g,y,x,k,K){r.cancelPendingCommit=null;do Sd();while(Wt!==0);if((rt&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=Cf,_f(r,o,y,x,k,K),r===mt&&(Qe=mt=null,He=0),Eo=s,fs=r,Ii=o,Nm=y,Pm=g,J0=u,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,C1(Qi,function(){return mv(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||u){u=B.T,B.T=null,g=z.p,z.p=2,x=rt,rt|=4;try{g1(r,s,o)}finally{rt=x,z.p=g,B.T=u}}Wt=1,uv(),dv(),hv()}}function uv(){if(Wt===1){Wt=0;var r=fs,s=Eo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=B.T,B.T=null;var u=z.p;z.p=2;var g=rt;rt|=4;try{Q0(s,r);var y=Xm,x=Yy(r.containerInfo),k=y.focusedElem,K=y.selectionRange;if(x!==k&&k&&k.ownerDocument&&Wy(k.ownerDocument.documentElement,k)){if(K!==null&&xf(k)){var ae=K.start,he=K.end;if(he===void 0&&(he=ae),"selectionStart"in k)k.selectionStart=ae,k.selectionEnd=Math.min(he,k.value.length);else{var pe=k.ownerDocument||document,le=pe&&pe.defaultView||window;if(le.getSelection){var de=le.getSelection(),Ae=k.textContent.length,je=Math.min(K.start,Ae),ft=K.end===void 0?je:Math.min(K.end,Ae);!de.extend&&je>ft&&(x=ft,ft=je,je=x);var J=$y(k,je),Y=$y(k,ft);if(J&&Y&&(de.rangeCount!==1||de.anchorNode!==J.node||de.anchorOffset!==J.offset||de.focusNode!==Y.node||de.focusOffset!==Y.offset)){var se=pe.createRange();se.setStart(J.node,J.offset),de.removeAllRanges(),je>ft?(de.addRange(se),de.extend(Y.node,Y.offset)):(se.setEnd(Y.node,Y.offset),de.addRange(se))}}}}for(pe=[],de=k;de=de.parentNode;)de.nodeType===1&&pe.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<pe.length;k++){var me=pe[k];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}Nd=!!Ym,Xm=Ym=null}finally{rt=g,z.p=u,B.T=o}}r.current=s,Wt=2}}function dv(){if(Wt===2){Wt=0;var r=fs,s=Eo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=B.T,B.T=null;var u=z.p;z.p=2;var g=rt;rt|=4;try{B0(r,s.alternate,s)}finally{rt=g,z.p=u,B.T=o}}Wt=3}}function hv(){if(Wt===4||Wt===3){Wt=0,hr();var r=fs,s=Eo,o=Ii,u=J0;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Wt=5:(Wt=0,Eo=fs=null,fv(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(hs=null),fi(o),s=s.stateNode,ln&&typeof ln.onCommitFiberRoot=="function")try{ln.onCommitFiberRoot(fr,s,void 0,(s.current.flags&128)===128)}catch{}if(u!==null){s=B.T,g=z.p,z.p=2,B.T=null;try{for(var y=r.onRecoverableError,x=0;x<u.length;x++){var k=u[x];y(k.value,{componentStack:k.stack})}}finally{B.T=s,z.p=g}}(Ii&3)!==0&&Sd(),Zr(r),g=r.pendingLanes,(o&261930)!==0&&(g&42)!==0?r===Lm?fc++:(fc=0,Lm=r):fc=0,mc(0)}}function fv(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,$l(s)))}function Sd(){return uv(),dv(),hv(),mv()}function mv(){if(Wt!==5)return!1;var r=fs,s=Nm;Nm=0;var o=fi(Ii),u=B.T,g=z.p;try{z.p=32>o?32:o,B.T=null,o=Pm,Pm=null;var y=fs,x=Ii;if(Wt=0,Eo=fs=null,Ii=0,(rt&6)!==0)throw Error(i(331));var k=rt;if(rt|=4,W0(y.current),H0(y,y.current,x,o),rt=k,mc(0,!1),ln&&typeof ln.onPostCommitFiberRoot=="function")try{ln.onPostCommitFiberRoot(fr,y)}catch{}return!0}finally{z.p=g,B.T=u,fv(r,s)}}function pv(r,s,o){s=tr(o,s),s=pm(r.stateNode,s,2),r=as(r,s,2),r!==null&&(Js(r,2),Zr(r))}function ct(r,s,o){if(r.tag===3)pv(r,r,o);else for(;s!==null;){if(s.tag===3){pv(s,r,o);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(hs===null||!hs.has(u))){r=tr(o,r),o=g0(2),u=as(s,o,2),u!==null&&(y0(o,u,s,r),Js(u,2),Zr(u));break}}s=s.return}}function Um(r,s,o){var u=r.pingCache;if(u===null){u=r.pingCache=new v1;var g=new Set;u.set(s,g)}else g=u.get(s),g===void 0&&(g=new Set,u.set(s,g));g.has(o)||(Om=!0,g.add(o),r=w1.bind(null,r,s,o),s.then(r,r))}function w1(r,s,o){var u=r.pingCache;u!==null&&u.delete(s),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,mt===r&&(He&o)===o&&(Dt===4||Dt===3&&(He&62914560)===He&&300>$t()-yd?(rt&2)===0&&xo(r,0):Mm|=o,bo===He&&(bo=0)),Zr(r)}function gv(r,s){s===0&&(s=vu()),r=ha(r,s),r!==null&&(Js(r,s),Zr(r))}function T1(r){var s=r.memoizedState,o=0;s!==null&&(o=s.retryLane),gv(r,o)}function A1(r,s){var o=0;switch(r.tag){case 31:case 13:var u=r.stateNode,g=r.memoizedState;g!==null&&(o=g.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(s),gv(r,o)}function C1(r,s){return St(r,s)}var wd=null,wo=null,zm=!1,Td=!1,Fm=!1,ps=0;function Zr(r){r!==wo&&r.next===null&&(wo===null?wd=wo=r:wo=wo.next=r),Td=!0,zm||(zm=!0,D1())}function mc(r,s){if(!Fm&&Td){Fm=!0;do for(var o=!1,u=wd;u!==null;){if(r!==0){var g=u.pendingLanes;if(g===0)var y=0;else{var x=u.suspendedLanes,k=u.pingedLanes;y=(1<<31-It(42|r)+1)-1,y&=g&~(x&~k),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,bv(u,y))}else y=He,y=Nr(u,u===mt?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||mr(u,y)||(o=!0,bv(u,y));u=u.next}while(o);Fm=!1}}function R1(){yv()}function yv(){Td=zm=!1;var r=0;ps!==0&&B1()&&(r=ps);for(var s=$t(),o=null,u=wd;u!==null;){var g=u.next,y=_v(u,s);y===0?(u.next=null,o===null?wd=g:o.next=g,g===null&&(wo=o)):(o=u,(r!==0||(y&3)!==0)&&(Td=!0)),u=g}Wt!==0&&Wt!==5||mc(r),ps!==0&&(ps=0)}function _v(r,s){for(var o=r.suspendedLanes,u=r.pingedLanes,g=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var x=31-It(y),k=1<<x,K=g[x];K===-1?((k&o)===0||(k&u)!==0)&&(g[x]=yf(k,s)):K<=s&&(r.expiredLanes|=k),y&=~k}if(s=mt,o=He,o=Nr(r,r===s?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===s&&(lt===2||lt===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&$n(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||mr(r,o)){if(s=o&-o,s===r.callbackPriority)return s;switch(u!==null&&$n(u),fi(o)){case 2:case 8:o=wl;break;case 32:o=Qi;break;case 268435456:o=mu;break;default:o=Qi}return u=vv.bind(null,r),o=St(o,u),r.callbackPriority=s,r.callbackNode=o,s}return u!==null&&u!==null&&$n(u),r.callbackPriority=2,r.callbackNode=null,2}function vv(r,s){if(Wt!==0&&Wt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(Sd()&&r.callbackNode!==o)return null;var u=He;return u=Nr(r,r===mt?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(ev(r,u,s),_v(r,$t()),r.callbackNode!=null&&r.callbackNode===o?vv.bind(null,r):null)}function bv(r,s){if(Sd())return null;ev(r,s,!0)}function D1(){z1(function(){(rt&6)!==0?St(Sl,R1):yv()})}function qm(){if(ps===0){var r=lo;r===0&&(r=Mr,Mr<<=1,(Mr&261888)===0&&(Mr=256)),ps=r}return ps}function Ev(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Ka(""+r)}function xv(r,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,r.id&&o.setAttribute("form",r.id),s.parentNode.insertBefore(o,s),r=new FormData(r),o.parentNode.removeChild(o),r}function I1(r,s,o,u,g){if(s==="submit"&&o&&o.stateNode===g){var y=Ev((g[en]||null).action),x=u.submitter;x&&(s=(s=x[en]||null)?Ev(s.formAction):x.getAttribute("formAction"),s!==null&&(y=s,x=null));var k=new Hr("action","action",null,u,g);r.push({event:k,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ps!==0){var K=x?xv(g,x):new FormData(g);cm(o,{pending:!0,data:K,method:g.method,action:y},null,K)}}else typeof y=="function"&&(k.preventDefault(),K=x?xv(g,x):new FormData(g),cm(o,{pending:!0,data:K,method:g.method,action:y},y,K))},currentTarget:g}]})}}for(var Qm=0;Qm<Af.length;Qm++){var Gm=Af[Qm],j1=Gm.toLowerCase(),O1=Gm[0].toUpperCase()+Gm.slice(1);xr(j1,"on"+O1)}xr(Zy,"onAnimationEnd"),xr(e_,"onAnimationIteration"),xr(t_,"onAnimationStart"),xr("dblclick","onDoubleClick"),xr("focusin","onFocus"),xr("focusout","onBlur"),xr($T,"onTransitionRun"),xr(WT,"onTransitionStart"),xr(YT,"onTransitionCancel"),xr(n_,"onTransitionEnd"),Fr("onMouseEnter",["mouseout","mouseover"]),Fr("onMouseLeave",["mouseout","mouseover"]),Fr("onPointerEnter",["pointerout","pointerover"]),Fr("onPointerLeave",["pointerout","pointerover"]),zr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),zr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),zr("onBeforeInput",["compositionend","keypress","textInput","paste"]),zr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),zr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),zr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pc));function Sv(r,s){s=(s&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],g=u.event;u=u.listeners;e:{var y=void 0;if(s)for(var x=u.length-1;0<=x;x--){var k=u[x],K=k.instance,ae=k.currentTarget;if(k=k.listener,K!==y&&g.isPropagationStopped())break e;y=k,g.currentTarget=ae;try{y(g)}catch(he){Uu(he)}g.currentTarget=null,y=K}else for(x=0;x<u.length;x++){if(k=u[x],K=k.instance,ae=k.currentTarget,k=k.listener,K!==y&&g.isPropagationStopped())break e;y=k,g.currentTarget=ae;try{y(g)}catch(he){Uu(he)}g.currentTarget=null,y=K}}}}function Ge(r,s){var o=s[Fa];o===void 0&&(o=s[Fa]=new Set);var u=r+"__bubble";o.has(u)||(wv(s,r,2,!1),o.add(u))}function Hm(r,s,o){var u=0;s&&(u|=4),wv(o,r,u,s)}var Ad="_reactListening"+Math.random().toString(36).slice(2);function Km(r){if(!r[Ad]){r[Ad]=!0,Cl.forEach(function(o){o!=="selectionchange"&&(M1.has(o)||Hm(o,!1,r),Hm(o,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Ad]||(s[Ad]=!0,Hm("selectionchange",!1,s))}}function wv(r,s,o,u){switch(Zv(s)){case 2:var g=oA;break;case 8:g=lA;break;default:g=lp}o=g.bind(null,s,o,r),g=void 0,!ia||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),u?g!==void 0?r.addEventListener(s,o,{capture:!0,passive:g}):r.addEventListener(s,o,!0):g!==void 0?r.addEventListener(s,o,{passive:g}):r.addEventListener(s,o,!1)}function $m(r,s,o,u,g){var y=u;if((s&1)===0&&(s&2)===0&&u!==null)e:for(;;){if(u===null)return;var x=u.tag;if(x===3||x===4){var k=u.stateNode.containerInfo;if(k===g)break;if(x===4)for(x=u.return;x!==null;){var K=x.tag;if((K===3||K===4)&&x.stateNode.containerInfo===g)return;x=x.return}for(;k!==null;){if(x=Br(k),x===null)return;if(K=x.tag,K===5||K===6||K===26||K===27){u=y=x;continue e}k=k.parentNode}}u=u.return}Yi(function(){var ae=y,he=Xn(o),pe=[];e:{var le=r_.get(r);if(le!==void 0){var de=Hr,Ae=r;switch(r){case"keypress":if(aa(o)===0)break e;case"keydown":case"keyup":de=Lu;break;case"focusin":Ae="focus",de=la;break;case"focusout":Ae="blur",de=la;break;case"beforeblur":case"afterblur":de=la;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=Ul;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=Ru;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=E;break;case Zy:case e_:case t_:de=Iu;break;case n_:de=L;break;case"scroll":case"scrollend":de=Bl;break;case"wheel":de=ue;break;case"copy":case"cut":case"paste":de=ju;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=gi;break;case"toggle":case"beforetoggle":de=Be}var je=(s&4)!==0,ft=!je&&(r==="scroll"||r==="scrollend"),J=je?le!==null?le+"Capture":null:le;je=[];for(var Y=ae,se;Y!==null;){var me=Y;if(se=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||se===null||J===null||(me=_r(Y,J),me!=null&&je.push(gc(Y,me,se))),ft)break;Y=Y.return}0<je.length&&(le=new de(le,Ae,null,o,he),pe.push({event:le,listeners:je}))}}if((s&7)===0){e:{if(le=r==="mouseover"||r==="pointerover",de=r==="mouseout"||r==="pointerout",le&&o!==Pl&&(Ae=o.relatedTarget||o.fromElement)&&(Br(Ae)||Ae[Lr]))break e;if((de||le)&&(le=he.window===he?he:(le=he.ownerDocument)?le.defaultView||le.parentWindow:window,de?(Ae=o.relatedTarget||o.toElement,de=ae,Ae=Ae?Br(Ae):null,Ae!==null&&(ft=l(Ae),je=Ae.tag,Ae!==ft||je!==5&&je!==27&&je!==6)&&(Ae=null)):(de=null,Ae=ae),de!==Ae)){if(je=Ul,me="onMouseLeave",J="onMouseEnter",Y="mouse",(r==="pointerout"||r==="pointerover")&&(je=gi,me="onPointerLeave",J="onPointerEnter",Y="pointer"),ft=de==null?le:Ln(de),se=Ae==null?le:Ln(Ae),le=new je(me,Y+"leave",de,o,he),le.target=ft,le.relatedTarget=se,me=null,Br(he)===ae&&(je=new je(J,Y+"enter",Ae,o,he),je.target=se,je.relatedTarget=ft,me=je),ft=me,de&&Ae)t:{for(je=k1,J=de,Y=Ae,se=0,me=J;me;me=je(me))se++;me=0;for(var De=Y;De;De=je(De))me++;for(;0<se-me;)J=je(J),se--;for(;0<me-se;)Y=je(Y),me--;for(;se--;){if(J===Y||Y!==null&&J===Y.alternate){je=J;break t}J=je(J),Y=je(Y)}je=null}else je=null;de!==null&&Tv(pe,le,de,je,!1),Ae!==null&&ft!==null&&Tv(pe,ft,Ae,je,!0)}}e:{if(le=ae?Ln(ae):window,de=le.nodeName&&le.nodeName.toLowerCase(),de==="select"||de==="input"&&le.type==="file")var et=Fy;else if(Uy(le))if(qy)et=GT;else{et=qT;var Ce=FT}else de=le.nodeName,!de||de.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?ae&&Ha(ae.elementType)&&(et=Fy):et=QT;if(et&&(et=et(r,ae))){zy(pe,et,o,he);break e}Ce&&Ce(r,le,ae),r==="focusout"&&ae&&le.type==="number"&&ae.memoizedProps.value!=null&&Ml(le,"number",le.value)}switch(Ce=ae?Ln(ae):window,r){case"focusin":(Uy(Ce)||Ce.contentEditable==="true")&&(eo=Ce,Sf=ae,Gl=null);break;case"focusout":Gl=Sf=eo=null;break;case"mousedown":wf=!0;break;case"contextmenu":case"mouseup":case"dragend":wf=!1,Xy(pe,o,he);break;case"selectionchange":if(KT)break;case"keydown":case"keyup":Xy(pe,o,he)}var ze;if(nt)e:{switch(r){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else Za?ca(r,o)&&(Ke="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ke="onCompositionStart");Ke&&(Wr&&o.locale!=="ko"&&(Za||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&Za&&(ze=Vl()):(Gr=he,Ll="value"in Gr?Gr.value:Gr.textContent,Za=!0)),Ce=Cd(ae,Ke),0<Ce.length&&(Ke=new $r(Ke,r,null,o,he),pe.push({event:Ke,listeners:Ce}),ze?Ke.data=ze:(ze=Ja(o),ze!==null&&(Ke.data=ze)))),(ze=Zn?VT(r,o):BT(r,o))&&(Ke=Cd(ae,"onBeforeInput"),0<Ke.length&&(Ce=new $r("onBeforeInput","beforeinput",null,o,he),pe.push({event:Ce,listeners:Ke}),Ce.data=ze)),I1(pe,r,ae,o,he)}Sv(pe,s)})}function gc(r,s,o){return{instance:r,listener:s,currentTarget:o}}function Cd(r,s){for(var o=s+"Capture",u=[];r!==null;){var g=r,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=_r(r,o),g!=null&&u.unshift(gc(r,g,y)),g=_r(r,s),g!=null&&u.push(gc(r,g,y))),r.tag===3)return u;r=r.return}return[]}function k1(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Tv(r,s,o,u,g){for(var y=s._reactName,x=[];o!==null&&o!==u;){var k=o,K=k.alternate,ae=k.stateNode;if(k=k.tag,K!==null&&K===u)break;k!==5&&k!==26&&k!==27||ae===null||(K=ae,g?(ae=_r(o,y),ae!=null&&x.unshift(gc(o,ae,K))):g||(ae=_r(o,y),ae!=null&&x.push(gc(o,ae,K)))),o=o.return}x.length!==0&&r.push({event:s,listeners:x})}var N1=/\r\n?/g,P1=/\u0000|\uFFFD/g;function Av(r){return(typeof r=="string"?r:""+r).replace(N1,`
`).replace(P1,"")}function Cv(r,s){return s=Av(s),Av(r)===s}function ht(r,s,o,u,g,y){switch(o){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||Rn(r,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&Rn(r,""+u);break;case"className":Vn(r,"class",u);break;case"tabIndex":Vn(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Vn(r,o,u);break;case"style":Nl(r,u,y);break;case"data":if(s!=="object"){Vn(r,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=Ka(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&ht(r,s,"name",g.name,g,null),ht(r,s,"formEncType",g.formEncType,g,null),ht(r,s,"formMethod",g.formMethod,g,null),ht(r,s,"formTarget",g.formTarget,g,null)):(ht(r,s,"encType",g.encType,g,null),ht(r,s,"method",g.method,g,null),ht(r,s,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=Ka(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=yr);break;case"onScroll":u!=null&&Ge("scroll",r);break;case"onScrollEnd":u!=null&&Ge("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=Ka(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":Ge("beforetoggle",r),Ge("toggle",r),Qa(r,"popover",u);break;case"xlinkActuate":Bt(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Bt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Bt(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Bt(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Bt(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Bt(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Bt(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Bt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Bt(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Qa(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Cu.get(o)||o,Qa(r,o,u))}}function Wm(r,s,o,u,g,y){switch(o){case"style":Nl(r,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"children":typeof u=="string"?Rn(r,u):(typeof u=="number"||typeof u=="bigint")&&Rn(r,""+u);break;case"onScroll":u!=null&&Ge("scroll",r);break;case"onScrollEnd":u!=null&&Ge("scrollend",r);break;case"onClick":u!=null&&(r.onclick=yr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Rl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),s=o.slice(2,g?o.length-7:void 0),y=r[en]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(s,y,g),typeof u=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(s,u,g);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):Qa(r,o,u)}}}function fn(r,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",r),Ge("load",r);var u=!1,g=!1,y;for(y in o)if(o.hasOwnProperty(y)){var x=o[y];if(x!=null)switch(y){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ht(r,s,y,x,o,null)}}g&&ht(r,s,"srcSet",o.srcSet,o,null),u&&ht(r,s,"src",o.src,o,null);return;case"input":Ge("invalid",r);var k=y=x=g=null,K=null,ae=null;for(u in o)if(o.hasOwnProperty(u)){var he=o[u];if(he!=null)switch(u){case"name":g=he;break;case"type":x=he;break;case"checked":K=he;break;case"defaultChecked":ae=he;break;case"value":y=he;break;case"defaultValue":k=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,s));break;default:ht(r,s,u,he,o,null)}}wu(r,y,k,K,ae,x,g,!1);return;case"select":Ge("invalid",r),u=x=y=null;for(g in o)if(o.hasOwnProperty(g)&&(k=o[g],k!=null))switch(g){case"value":y=k;break;case"defaultValue":x=k;break;case"multiple":u=k;default:ht(r,s,g,k,o,null)}s=y,o=x,r.multiple=!!u,s!=null?Hi(r,!!u,s,!1):o!=null&&Hi(r,!!u,o,!0);return;case"textarea":Ge("invalid",r),y=g=u=null;for(x in o)if(o.hasOwnProperty(x)&&(k=o[x],k!=null))switch(x){case"value":u=k;break;case"defaultValue":g=k;break;case"children":y=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(i(91));break;default:ht(r,s,x,k,o,null)}Ki(r,u,g,y);return;case"option":for(K in o)o.hasOwnProperty(K)&&(u=o[K],u!=null)&&(K==="selected"?r.selected=u&&typeof u!="function"&&typeof u!="symbol":ht(r,s,K,u,o,null));return;case"dialog":Ge("beforetoggle",r),Ge("toggle",r),Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":Ge("load",r);break;case"video":case"audio":for(u=0;u<pc.length;u++)Ge(pc[u],r);break;case"image":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"embed":case"source":case"link":Ge("error",r),Ge("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in o)if(o.hasOwnProperty(ae)&&(u=o[ae],u!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ht(r,s,ae,u,o,null)}return;default:if(Ha(s)){for(he in o)o.hasOwnProperty(he)&&(u=o[he],u!==void 0&&Wm(r,s,he,u,o,void 0));return}}for(k in o)o.hasOwnProperty(k)&&(u=o[k],u!=null&&ht(r,s,k,u,o,null))}function L1(r,s,o,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,x=null,k=null,K=null,ae=null,he=null;for(de in o){var pe=o[de];if(o.hasOwnProperty(de)&&pe!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":K=pe;default:u.hasOwnProperty(de)||ht(r,s,de,null,u,pe)}}for(var le in u){var de=u[le];if(pe=o[le],u.hasOwnProperty(le)&&(de!=null||pe!=null))switch(le){case"type":y=de;break;case"name":g=de;break;case"checked":ae=de;break;case"defaultChecked":he=de;break;case"value":x=de;break;case"defaultValue":k=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,s));break;default:de!==pe&&ht(r,s,le,de,u,pe)}}Ga(r,x,k,K,ae,he,y,g);return;case"select":de=x=k=le=null;for(y in o)if(K=o[y],o.hasOwnProperty(y)&&K!=null)switch(y){case"value":break;case"multiple":de=K;default:u.hasOwnProperty(y)||ht(r,s,y,null,u,K)}for(g in u)if(y=u[g],K=o[g],u.hasOwnProperty(g)&&(y!=null||K!=null))switch(g){case"value":le=y;break;case"defaultValue":k=y;break;case"multiple":x=y;default:y!==K&&ht(r,s,g,y,u,K)}s=k,o=x,u=de,le!=null?Hi(r,!!o,le,!1):!!u!=!!o&&(s!=null?Hi(r,!!o,s,!0):Hi(r,!!o,o?[]:"",!1));return;case"textarea":de=le=null;for(k in o)if(g=o[k],o.hasOwnProperty(k)&&g!=null&&!u.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:ht(r,s,k,null,u,g)}for(x in u)if(g=u[x],y=o[x],u.hasOwnProperty(x)&&(g!=null||y!=null))switch(x){case"value":le=g;break;case"defaultValue":de=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==y&&ht(r,s,x,g,u,y)}Tu(r,le,de);return;case"option":for(var Ae in o)le=o[Ae],o.hasOwnProperty(Ae)&&le!=null&&!u.hasOwnProperty(Ae)&&(Ae==="selected"?r.selected=!1:ht(r,s,Ae,null,u,le));for(K in u)le=u[K],de=o[K],u.hasOwnProperty(K)&&le!==de&&(le!=null||de!=null)&&(K==="selected"?r.selected=le&&typeof le!="function"&&typeof le!="symbol":ht(r,s,K,le,u,de));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var je in o)le=o[je],o.hasOwnProperty(je)&&le!=null&&!u.hasOwnProperty(je)&&ht(r,s,je,null,u,le);for(ae in u)if(le=u[ae],de=o[ae],u.hasOwnProperty(ae)&&le!==de&&(le!=null||de!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,s));break;default:ht(r,s,ae,le,u,de)}return;default:if(Ha(s)){for(var ft in o)le=o[ft],o.hasOwnProperty(ft)&&le!==void 0&&!u.hasOwnProperty(ft)&&Wm(r,s,ft,void 0,u,le);for(he in u)le=u[he],de=o[he],!u.hasOwnProperty(he)||le===de||le===void 0&&de===void 0||Wm(r,s,he,le,u,de);return}}for(var J in o)le=o[J],o.hasOwnProperty(J)&&le!=null&&!u.hasOwnProperty(J)&&ht(r,s,J,null,u,le);for(pe in u)le=u[pe],de=o[pe],!u.hasOwnProperty(pe)||le===de||le==null&&de==null||ht(r,s,pe,le,u,de)}function Rv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function V1(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var g=o[u],y=g.transferSize,x=g.initiatorType,k=g.duration;if(y&&k&&Rv(x)){for(x=0,k=g.responseEnd,u+=1;u<o.length;u++){var K=o[u],ae=K.startTime;if(ae>k)break;var he=K.transferSize,pe=K.initiatorType;he&&Rv(pe)&&(K=K.responseEnd,x+=he*(K<k?1:(k-ae)/(K-ae)))}if(--u,s+=8*(y+x)/(g.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Ym=null,Xm=null;function Rd(r){return r.nodeType===9?r:r.ownerDocument}function Dv(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Iv(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function Jm(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Zm=null;function B1(){var r=window.event;return r&&r.type==="popstate"?r===Zm?!1:(Zm=r,!0):(Zm=null,!1)}var jv=typeof setTimeout=="function"?setTimeout:void 0,U1=typeof clearTimeout=="function"?clearTimeout:void 0,Ov=typeof Promise=="function"?Promise:void 0,z1=typeof queueMicrotask=="function"?queueMicrotask:typeof Ov<"u"?function(r){return Ov.resolve(null).then(r).catch(F1)}:jv;function F1(r){setTimeout(function(){throw r})}function gs(r){return r==="head"}function Mv(r,s){var o=s,u=0;do{var g=o.nextSibling;if(r.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(u===0){r.removeChild(g),Ro(s);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")yc(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,yc(o);for(var y=o.firstChild;y;){var x=y.nextSibling,k=y.nodeName;y[Vr]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=x}}else o==="body"&&yc(r.ownerDocument.body);o=g}while(o);Ro(s)}function kv(r,s){var o=r;r=0;do{var u=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=u}while(o)}function ep(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":ep(o),qa(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function q1(r,s,o,u){for(;r.nodeType===1;){var g=o;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[Vr])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=ar(r.nextSibling),r===null)break}return null}function Q1(r,s,o){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=ar(r.nextSibling),r===null))return null;return r}function Nv(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=ar(r.nextSibling),r===null))return null;return r}function tp(r){return r.data==="$?"||r.data==="$~"}function np(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function G1(r,s){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||o.readyState!=="loading")s();else{var u=function(){s(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function ar(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var rp=null;function Pv(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(s===0)return ar(r.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}r=r.nextSibling}return null}function Lv(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return r;s--}else o!=="/$"&&o!=="/&"||s++}r=r.previousSibling}return null}function Vv(r,s,o){switch(s=Rd(o),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function yc(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);qa(r)}var or=new Map,Bv=new Set;function Dd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var ji=z.d;z.d={f:H1,r:K1,D:$1,C:W1,L:Y1,m:X1,X:Z1,S:J1,M:eA};function H1(){var r=ji.f(),s=bd();return r||s}function K1(r){var s=Yn(r);s!==null&&s.tag===5&&s.type==="form"?n0(s):ji.r(r)}var To=typeof document>"u"?null:document;function Uv(r,s,o){var u=To;if(u&&typeof s=="string"&&s){var g=Cn(s);g='link[rel="'+r+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),Bv.has(g)||(Bv.add(g),r={rel:r,crossOrigin:o,href:s},u.querySelector(g)===null&&(s=u.createElement("link"),fn(s,"link",r),Vt(s),u.head.appendChild(s)))}}function $1(r){ji.D(r),Uv("dns-prefetch",r,null)}function W1(r,s){ji.C(r,s),Uv("preconnect",r,s)}function Y1(r,s,o){ji.L(r,s,o);var u=To;if(u&&r&&s){var g='link[rel="preload"][as="'+Cn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+Cn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+Cn(o.imageSizes)+'"]')):g+='[href="'+Cn(r)+'"]';var y=g;switch(s){case"style":y=Ao(r);break;case"script":y=Co(r)}or.has(y)||(r=v({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:r,as:s},o),or.set(y,r),u.querySelector(g)!==null||s==="style"&&u.querySelector(_c(y))||s==="script"&&u.querySelector(vc(y))||(s=u.createElement("link"),fn(s,"link",r),Vt(s),u.head.appendChild(s)))}}function X1(r,s){ji.m(r,s);var o=To;if(o&&r){var u=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Cn(u)+'"][href="'+Cn(r)+'"]',y=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Co(r)}if(!or.has(y)&&(r=v({rel:"modulepreload",href:r},s),or.set(y,r),o.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(vc(y)))return}u=o.createElement("link"),fn(u,"link",r),Vt(u),o.head.appendChild(u)}}}function J1(r,s,o){ji.S(r,s,o);var u=To;if(u&&r){var g=Ur(u).hoistableStyles,y=Ao(r);s=s||"default";var x=g.get(y);if(!x){var k={loading:0,preload:null};if(x=u.querySelector(_c(y)))k.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":s},o),(o=or.get(y))&&ip(r,o);var K=x=u.createElement("link");Vt(K),fn(K,"link",r),K._p=new Promise(function(ae,he){K.onload=ae,K.onerror=he}),K.addEventListener("load",function(){k.loading|=1}),K.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Id(x,s,u)}x={type:"stylesheet",instance:x,count:1,state:k},g.set(y,x)}}}function Z1(r,s){ji.X(r,s);var o=To;if(o&&r){var u=Ur(o).hoistableScripts,g=Co(r),y=u.get(g);y||(y=o.querySelector(vc(g)),y||(r=v({src:r,async:!0},s),(s=or.get(g))&&sp(r,s),y=o.createElement("script"),Vt(y),fn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function eA(r,s){ji.M(r,s);var o=To;if(o&&r){var u=Ur(o).hoistableScripts,g=Co(r),y=u.get(g);y||(y=o.querySelector(vc(g)),y||(r=v({src:r,async:!0,type:"module"},s),(s=or.get(g))&&sp(r,s),y=o.createElement("script"),Vt(y),fn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function zv(r,s,o,u){var g=(g=be.current)?Dd(g):null;if(!g)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Ao(o.href),o=Ur(g).hoistableStyles,u=o.get(s),u||(u={type:"style",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=Ao(o.href);var y=Ur(g).hoistableStyles,x=y.get(r);if(x||(g=g.ownerDocument||g,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,x),(y=g.querySelector(_c(r)))&&!y._p&&(x.instance=y,x.state.loading=5),or.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},or.set(r,o),y||tA(g,r,o,x.state))),s&&u===null)throw Error(i(528,""));return x}if(s&&u!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Co(o),o=Ur(g).hoistableScripts,u=o.get(s),u||(u={type:"script",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Ao(r){return'href="'+Cn(r)+'"'}function _c(r){return'link[rel="stylesheet"]['+r+"]"}function Fv(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function tA(r,s,o,u){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=r.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),fn(s,"link",o),Vt(s),r.head.appendChild(s))}function Co(r){return'[src="'+Cn(r)+'"]'}function vc(r){return"script[async]"+r}function qv(r,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var u=r.querySelector('style[data-href~="'+Cn(o.href)+'"]');if(u)return s.instance=u,Vt(u),u;var g=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),Vt(u),fn(u,"style",g),Id(u,o.precedence,r),s.instance=u;case"stylesheet":g=Ao(o.href);var y=r.querySelector(_c(g));if(y)return s.state.loading|=4,s.instance=y,Vt(y),y;u=Fv(o),(g=or.get(g))&&ip(u,g),y=(r.ownerDocument||r).createElement("link"),Vt(y);var x=y;return x._p=new Promise(function(k,K){x.onload=k,x.onerror=K}),fn(y,"link",u),s.state.loading|=4,Id(y,o.precedence,r),s.instance=y;case"script":return y=Co(o.src),(g=r.querySelector(vc(y)))?(s.instance=g,Vt(g),g):(u=o,(g=or.get(y))&&(u=v({},o),sp(u,g)),r=r.ownerDocument||r,g=r.createElement("script"),Vt(g),fn(g,"link",u),r.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(u=s.instance,s.state.loading|=4,Id(u,o.precedence,r));return s.instance}function Id(r,s,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,y=g,x=0;x<u.length;x++){var k=u[x];if(k.dataset.precedence===s)y=k;else if(y!==g)break}y?y.parentNode.insertBefore(r,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(r,s.firstChild))}function ip(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function sp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var jd=null;function Qv(r,s,o){if(jd===null){var u=new Map,g=jd=new Map;g.set(o,u)}else g=jd,u=g.get(o),u||(u=new Map,g.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),g=0;g<o.length;g++){var y=o[g];if(!(y[Vr]||y[Lt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var x=y.getAttribute(s)||"";x=r+x;var k=u.get(x);k?k.push(y):u.set(x,[y])}}return u}function Gv(r,s,o){r=r.ownerDocument||r,r.head.insertBefore(o,s==="title"?r.querySelector("head > title"):null)}function nA(r,s,o){if(o===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Hv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function rA(r,s,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Ao(u.href),y=s.querySelector(_c(g));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=Od.bind(r),s.then(r,r)),o.state.loading|=4,o.instance=y,Vt(y);return}y=s.ownerDocument||s,u=Fv(u),(g=or.get(g))&&ip(u,g),y=y.createElement("link"),Vt(y);var x=y;x._p=new Promise(function(k,K){x.onload=k,x.onerror=K}),fn(y,"link",u),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=Od.bind(r),s.addEventListener("load",o),s.addEventListener("error",o))}}var ap=0;function iA(r,s){return r.stylesheets&&r.count===0&&kd(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var u=setTimeout(function(){if(r.stylesheets&&kd(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+s);0<r.imgBytes&&ap===0&&(ap=62500*V1());var g=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&kd(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>ap?50:800)+s);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function Od(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)kd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Md=null;function kd(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Md=new Map,s.forEach(sA,r),Md=null,Od.call(r))}function sA(r,s){if(!(s.state.loading&4)){var o=Md.get(r);if(o)var u=o.get(null);else{o=new Map,Md.set(r,o);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var x=g[y];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),u=x)}u&&o.set(null,u)}g=s.instance,x=g.getAttribute("data-precedence"),y=o.get(x)||u,y===u&&o.set(null,g),o.set(x,g),this.count++,u=Od.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),y?y.parentNode.insertBefore(g,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),s.state.loading|=4}}var bc={$$typeof:Q,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function aA(r,s,o,u,g,y,x,k,K){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pr(0),this.hiddenUpdates=Pr(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function Kv(r,s,o,u,g,y,x,k,K,ae,he,pe){return r=new aA(r,s,o,x,K,ae,he,pe,k),s=1,y===!0&&(s|=24),y=Un(3,null,null,s),r.current=y,y.stateNode=r,s=Bf(),s.refCount++,r.pooledCache=s,s.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:s},qf(y),r}function $v(r){return r?(r=ro,r):ro}function Wv(r,s,o,u,g,y){g=$v(g),u.context===null?u.context=g:u.pendingContext=g,u=ss(s),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=as(r,u,s),o!==null&&(Mn(o,r,s),Jl(o,r,s))}function Yv(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<s?o:s}}function op(r,s){Yv(r,s),(r=r.alternate)&&Yv(r,s)}function Xv(r){if(r.tag===13||r.tag===31){var s=ha(r,67108864);s!==null&&Mn(s,r,67108864),op(r,67108864)}}function Jv(r){if(r.tag===13||r.tag===31){var s=Gn();s=ea(s);var o=ha(r,s);o!==null&&Mn(o,r,s),op(r,s)}}var Nd=!0;function oA(r,s,o,u){var g=B.T;B.T=null;var y=z.p;try{z.p=2,lp(r,s,o,u)}finally{z.p=y,B.T=g}}function lA(r,s,o,u){var g=B.T;B.T=null;var y=z.p;try{z.p=8,lp(r,s,o,u)}finally{z.p=y,B.T=g}}function lp(r,s,o,u){if(Nd){var g=cp(u);if(g===null)$m(r,s,u,Pd,o),eb(r,u);else if(uA(g,r,s,o,u))u.stopPropagation();else if(eb(r,u),s&4&&-1<cA.indexOf(r)){for(;g!==null;){var y=Yn(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var x=kr(y.pendingLanes);if(x!==0){var k=y;for(k.pendingLanes|=2,k.entangledLanes|=2;x;){var K=1<<31-It(x);k.entanglements[1]|=K,x&=~K}Zr(y),(rt&6)===0&&(_d=$t()+500,mc(0))}}break;case 31:case 13:k=ha(y,2),k!==null&&Mn(k,y,2),bd(),op(y,2)}if(y=cp(u),y===null&&$m(r,s,u,Pd,o),y===g)break;g=y}g!==null&&u.stopPropagation()}else $m(r,s,u,null,o)}}function cp(r){return r=Xn(r),up(r)}var Pd=null;function up(r){if(Pd=null,r=Br(r),r!==null){var s=l(r);if(s===null)r=null;else{var o=s.tag;if(o===13){if(r=c(s),r!==null)return r;r=null}else if(o===31){if(r=d(s),r!==null)return r;r=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return Pd=r,null}function Zv(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ys()){case Sl:return 2;case wl:return 8;case Qi:case gf:return 32;case mu:return 268435456;default:return 32}default:return 32}}var dp=!1,ys=null,_s=null,vs=null,Ec=new Map,xc=new Map,bs=[],cA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function eb(r,s){switch(r){case"focusin":case"focusout":ys=null;break;case"dragenter":case"dragleave":_s=null;break;case"mouseover":case"mouseout":vs=null;break;case"pointerover":case"pointerout":Ec.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":xc.delete(s.pointerId)}}function Sc(r,s,o,u,g,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[g]},s!==null&&(s=Yn(s),s!==null&&Xv(s)),r):(r.eventSystemFlags|=u,s=r.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),r)}function uA(r,s,o,u,g){switch(s){case"focusin":return ys=Sc(ys,r,s,o,u,g),!0;case"dragenter":return _s=Sc(_s,r,s,o,u,g),!0;case"mouseover":return vs=Sc(vs,r,s,o,u,g),!0;case"pointerover":var y=g.pointerId;return Ec.set(y,Sc(Ec.get(y)||null,r,s,o,u,g)),!0;case"gotpointercapture":return y=g.pointerId,xc.set(y,Sc(xc.get(y)||null,r,s,o,u,g)),!0}return!1}function tb(r){var s=Br(r.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){r.blockedOn=s,pr(r.priority,function(){Jv(o)});return}}else if(s===31){if(s=d(o),s!==null){r.blockedOn=s,pr(r.priority,function(){Jv(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Ld(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var o=cp(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);Pl=u,o.target.dispatchEvent(u),Pl=null}else return s=Yn(o),s!==null&&Xv(s),r.blockedOn=o,!1;s.shift()}return!0}function nb(r,s,o){Ld(r)&&o.delete(s)}function dA(){dp=!1,ys!==null&&Ld(ys)&&(ys=null),_s!==null&&Ld(_s)&&(_s=null),vs!==null&&Ld(vs)&&(vs=null),Ec.forEach(nb),xc.forEach(nb)}function Vd(r,s){r.blockedOn===s&&(r.blockedOn=null,dp||(dp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,dA)))}var Bd=null;function rb(r){Bd!==r&&(Bd=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Bd===r&&(Bd=null);for(var s=0;s<r.length;s+=3){var o=r[s],u=r[s+1],g=r[s+2];if(typeof u!="function"){if(up(u||o)===null)continue;break}var y=Yn(o);y!==null&&(r.splice(s,3),s-=3,cm(y,{pending:!0,data:g,method:o.method,action:u},u,g))}}))}function Ro(r){function s(K){return Vd(K,r)}ys!==null&&Vd(ys,r),_s!==null&&Vd(_s,r),vs!==null&&Vd(vs,r),Ec.forEach(s),xc.forEach(s);for(var o=0;o<bs.length;o++){var u=bs[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<bs.length&&(o=bs[0],o.blockedOn===null);)tb(o),o.blockedOn===null&&bs.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var g=o[u],y=o[u+1],x=g[en]||null;if(typeof y=="function")x||rb(o);else if(x){var k=null;if(y&&y.hasAttribute("formAction")){if(g=y,x=y[en]||null)k=x.formAction;else if(up(g)!==null)continue}else k=x.action;typeof k=="function"?o[u+1]=k:(o.splice(u,3),u-=3),rb(o)}}}function ib(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(x){return g=x})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function hp(r){this._internalRoot=r}Ud.prototype.render=hp.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,u=Gn();Wv(o,u,r,s,null,null)},Ud.prototype.unmount=hp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;Wv(r.current,2,null,r,null,null),bd(),s[Lr]=null}};function Ud(r){this._internalRoot=r}Ud.prototype.unstable_scheduleHydration=function(r){if(r){var s=bu();r={blockedOn:null,target:r,priority:s};for(var o=0;o<bs.length&&s!==0&&s<bs[o].priority;o++);bs.splice(o,0,r),o===0&&tb(r)}};var sb=e.version;if(sb!=="19.2.3")throw Error(i(527,sb,"19.2.3"));z.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=p(s),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var hA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zd.isDisabled&&zd.supportsFiber)try{fr=zd.inject(hA),ln=zd}catch{}}return Tc.createRoot=function(r,s){if(!a(r))throw Error(i(299));var o=!1,u="",g=h0,y=f0,x=m0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(x=s.onRecoverableError)),s=Kv(r,1,!1,null,null,o,u,null,g,y,x,ib),r[Lr]=s.current,Km(r),new hp(s)},Tc.hydrateRoot=function(r,s,o){if(!a(r))throw Error(i(299));var u=!1,g="",y=h0,x=f0,k=m0,K=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(k=o.onRecoverableError),o.formState!==void 0&&(K=o.formState)),s=Kv(r,1,!0,s,o??null,u,g,K,y,x,k,ib),s.context=$v(null),o=s.current,u=Gn(),u=ea(u),g=ss(u),g.callback=null,as(o,g,u),o=u,s.current.lanes=o,Js(s,o),Zr(s),r[Lr]=s.current,Km(r),new Ud(s)},Tc.version="19.2.3",Tc}var pb;function xA(){if(pb)return pp.exports;pb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),pp.exports=EA(),pp.exports}var SA=xA();var gb="popstate";function wA(t={}){function e(i,a){let{pathname:l,search:c,hash:d}=i.location;return Bp("",{pathname:l,search:c,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:Uc(a)}return AA(e,n,null,t)}function xt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ur(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function TA(){return Math.random().toString(36).substring(2,10)}function yb(t,e){return{usr:t.state,key:t.key,idx:e}}function Bp(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?il(e):e,state:n,key:e&&e.key||i||TA()}}function Uc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function il(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function AA(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,d="POP",f=null,p=_();p==null&&(p=0,c.replaceState({...c.state,idx:p},""));function _(){return(c.state||{idx:null}).idx}function v(){d="POP";let I=_(),P=I==null?null:I-p;p=I,f&&f({action:d,location:A.location,delta:P})}function b(I,P){d="PUSH";let G=Bp(A.location,I,P);p=_()+1;let Q=yb(G,p),X=A.createHref(G);try{c.pushState(Q,"",X)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;a.location.assign(X)}l&&f&&f({action:d,location:A.location,delta:1})}function T(I,P){d="REPLACE";let G=Bp(A.location,I,P);p=_();let Q=yb(G,p),X=A.createHref(G);c.replaceState(Q,"",X),l&&f&&f({action:d,location:A.location,delta:0})}function w(I){return CA(I)}let A={get action(){return d},get location(){return t(a,c)},listen(I){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(gb,v),f=I,()=>{a.removeEventListener(gb,v),f=null}},createHref(I){return e(a,I)},createURL:w,encodeLocation(I){let P=w(I);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:b,replace:T,go(I){return c.go(I)}};return A}function CA(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),xt(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Uc(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function xx(t,e,n="/"){return RA(t,e,n,!1)}function RA(t,e,n,i){let a=typeof e=="string"?il(e):e,l=Li(a.pathname||"/",n);if(l==null)return null;let c=Sx(t);DA(c);let d=null;for(let f=0;d==null&&f<c.length;++f){let p=UA(l);d=VA(c[f],p,i)}return d}function Sx(t,e=[],n=[],i="",a=!1){let l=(c,d,f=a,p)=>{let _={relativePath:p===void 0?c.path||"":p,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&f)return;xt(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let v=Ni([i,_.relativePath]),b=n.concat(_);c.children&&c.children.length>0&&(xt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),Sx(c.children,e,b,v,f)),!(c.path==null&&!c.index)&&e.push({path:v,score:PA(v,c.index),routesMeta:b})};return t.forEach((c,d)=>{if(c.path===""||!c.path?.includes("?"))l(c,d);else for(let f of wx(c.path))l(c,d,!0,f)}),e}function wx(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=wx(i.join("/")),d=[];return d.push(...c.map(f=>f===""?l:[l,f].join("/"))),a&&d.push(...c),d.map(f=>t.startsWith("/")&&f===""?"/":f)}function DA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:LA(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var IA=/^:[\w-]+$/,jA=3,OA=2,MA=1,kA=10,NA=-2,_b=t=>t==="*";function PA(t,e){let n=t.split("/"),i=n.length;return n.some(_b)&&(i+=NA),e&&(i+=OA),n.filter(a=>!_b(a)).reduce((a,l)=>a+(IA.test(l)?jA:l===""?MA:kA),i)}function LA(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function VA(t,e,n=!1){let{routesMeta:i}=t,a={},l="/",c=[];for(let d=0;d<i.length;++d){let f=i[d],p=d===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",v=ch({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},_),b=f.route;if(!v&&p&&n&&!i[i.length-1].route.index&&(v=ch({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},_)),!v)return null;Object.assign(a,v.params),c.push({params:a,pathname:Ni([l,v.pathname]),pathnameBase:QA(Ni([l,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(l=Ni([l,v.pathnameBase]))}return c}function ch(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=BA(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:i.reduce((p,{paramName:_,isOptional:v},b)=>{if(_==="*"){let w=d[b]||"";c=l.slice(0,l.length-w.length).replace(/(.)\/+$/,"$1")}const T=d[b];return v&&!T?p[_]=void 0:p[_]=(T||"").replace(/%2F/g,"/"),p},{}),pathname:l,pathnameBase:c,pattern:t}}function BA(t,e=!1,n=!0){ur(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,f)=>(i.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function UA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ur(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Li(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var Tx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zA=t=>Tx.test(t);function FA(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?il(t):t,l;if(n)if(zA(n))l=n;else{if(n.includes("//")){let c=n;n=n.replace(/\/\/+/g,"/"),ur(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${n}`)}n.startsWith("/")?l=vb(n.substring(1),"/"):l=vb(n,e)}else l=e;return{pathname:l,search:GA(i),hash:HA(a)}}function vb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function vp(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function qA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Ag(t){let e=qA(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function Cg(t,e,n,i=!1){let a;typeof t=="string"?a=il(t):(a={...t},xt(!a.pathname||!a.pathname.includes("?"),vp("?","pathname","search",a)),xt(!a.pathname||!a.pathname.includes("#"),vp("#","pathname","hash",a)),xt(!a.search||!a.search.includes("#"),vp("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,d;if(c==null)d=n;else{let v=e.length-1;if(!i&&c.startsWith("..")){let b=c.split("/");for(;b[0]==="..";)b.shift(),v-=1;a.pathname=b.join("/")}d=v>=0?e[v]:"/"}let f=FA(a,d),p=c&&c!=="/"&&c.endsWith("/"),_=(l||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(p||_)&&(f.pathname+="/"),f}var Ni=t=>t.join("/").replace(/\/\/+/g,"/"),QA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),GA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,HA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,KA=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function $A(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function WA(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Ax=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Cx(t,e){let n=t;if(typeof n!="string"||!Tx.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if(Ax)try{let l=new URL(window.location.href),c=n.startsWith("//")?new URL(l.protocol+n):new URL(n),d=Li(c.pathname,e);c.origin===l.origin&&d!=null?n=d+c.search+c.hash:a=!0}catch{ur(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Rx=["POST","PUT","PATCH","DELETE"];new Set(Rx);var YA=["GET",...Rx];new Set(YA);var sl=D.createContext(null);sl.displayName="DataRouter";var Vh=D.createContext(null);Vh.displayName="DataRouterState";var XA=D.createContext(!1),Dx=D.createContext({isTransitioning:!1});Dx.displayName="ViewTransition";var JA=D.createContext(new Map);JA.displayName="Fetchers";var ZA=D.createContext(null);ZA.displayName="Await";var Kn=D.createContext(null);Kn.displayName="Navigation";var Yc=D.createContext(null);Yc.displayName="Location";var dr=D.createContext({outlet:null,matches:[],isDataRoute:!1});dr.displayName="Route";var Rg=D.createContext(null);Rg.displayName="RouteError";var Ix="REACT_ROUTER_ERROR",eC="REDIRECT",tC="ROUTE_ERROR_RESPONSE";function nC(t){if(t.startsWith(`${Ix}:${eC}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function rC(t){if(t.startsWith(`${Ix}:${tC}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new KA(e.status,e.statusText,e.data)}catch{}}function iC(t,{relative:e}={}){xt(al(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=D.useContext(Kn),{hash:a,pathname:l,search:c}=Xc(t,{relative:e}),d=l;return n!=="/"&&(d=l==="/"?n:Ni([n,l])),i.createHref({pathname:d,search:c,hash:a})}function al(){return D.useContext(Yc)!=null}function Pn(){return xt(al(),"useLocation() may be used only in the context of a <Router> component."),D.useContext(Yc).location}var jx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ox(t){D.useContext(Kn).static||D.useLayoutEffect(t)}function Bh(){let{isDataRoute:t}=D.useContext(dr);return t?bC():sC()}function sC(){xt(al(),"useNavigate() may be used only in the context of a <Router> component.");let t=D.useContext(sl),{basename:e,navigator:n}=D.useContext(Kn),{matches:i}=D.useContext(dr),{pathname:a}=Pn(),l=JSON.stringify(Ag(i)),c=D.useRef(!1);return Ox(()=>{c.current=!0}),D.useCallback((f,p={})=>{if(ur(c.current,jx),!c.current)return;if(typeof f=="number"){n.go(f);return}let _=Cg(f,JSON.parse(l),a,p.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:Ni([e,_.pathname])),(p.replace?n.replace:n.push)(_,p.state,p)},[e,n,l,a,t])}var aC=D.createContext(null);function oC(t){let e=D.useContext(dr).outlet;return D.useMemo(()=>e&&D.createElement(aC.Provider,{value:t},e),[e,t])}function lC(){let{matches:t}=D.useContext(dr),e=t[t.length-1];return e?e.params:{}}function Xc(t,{relative:e}={}){let{matches:n}=D.useContext(dr),{pathname:i}=Pn(),a=JSON.stringify(Ag(n));return D.useMemo(()=>Cg(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function cC(t,e){return Mx(t,e)}function Mx(t,e,n,i,a){xt(al(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=D.useContext(Kn),{matches:c}=D.useContext(dr),d=c[c.length-1],f=d?d.params:{},p=d?d.pathname:"/",_=d?d.pathnameBase:"/",v=d&&d.route;{let G=v&&v.path||"";Nx(p,!v||G.endsWith("*")||G.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${G}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${G}"> to <Route path="${G==="/"?"*":`${G}/*`}">.`)}let b=Pn(),T;if(e){let G=typeof e=="string"?il(e):e;xt(_==="/"||G.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${G.pathname}" was given in the \`location\` prop.`),T=G}else T=b;let w=T.pathname||"/",A=w;if(_!=="/"){let G=_.replace(/^\//,"").split("/");A="/"+w.replace(/^\//,"").split("/").slice(G.length).join("/")}let I=xx(t,{pathname:A});ur(v||I!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),ur(I==null||I[I.length-1].route.element!==void 0||I[I.length-1].route.Component!==void 0||I[I.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let P=mC(I&&I.map(G=>Object.assign({},G,{params:Object.assign({},f,G.params),pathname:Ni([_,l.encodeLocation?l.encodeLocation(G.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathname]),pathnameBase:G.pathnameBase==="/"?_:Ni([_,l.encodeLocation?l.encodeLocation(G.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:G.pathnameBase])})),c,n,i,a);return e&&P?D.createElement(Yc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},P):P}function uC(){let t=vC(),e=$A(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=D.createElement(D.Fragment,null,D.createElement("p",null," Hey developer "),D.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",D.createElement("code",{style:l},"ErrorBoundary")," or"," ",D.createElement("code",{style:l},"errorElement")," prop on your route.")),D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},e),n?D.createElement("pre",{style:a},n):null,c)}var dC=D.createElement(uC,null),kx=class extends D.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=rC(t.digest);n&&(t=n)}let e=t!==void 0?D.createElement(dr.Provider,{value:this.props.routeContext},D.createElement(Rg.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?D.createElement(hC,{error:t},e):e}};kx.contextType=XA;var bp=new WeakMap;function hC({children:t,error:e}){let{basename:n}=D.useContext(Kn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=nC(e.digest);if(i){let a=bp.get(e);if(a)throw a;let l=Cx(i.location,n);if(Ax&&!bp.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw bp.set(e,c),c}return D.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function fC({routeContext:t,match:e,children:n}){let i=D.useContext(sl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),D.createElement(dr.Provider,{value:t},n)}function mC(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=n?.errors;if(c!=null){let _=l.findIndex(v=>v.route.id&&c?.[v.route.id]!==void 0);xt(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let d=!1,f=-1;if(n)for(let _=0;_<l.length;_++){let v=l[_];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(f=_),v.route.id){let{loaderData:b,errors:T}=n,w=v.route.loader&&!b.hasOwnProperty(v.route.id)&&(!T||T[v.route.id]===void 0);if(v.route.lazy||w){d=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}let p=n&&i?(_,v)=>{i(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:WA(n.matches),errorInfo:v})}:void 0;return l.reduceRight((_,v,b)=>{let T,w=!1,A=null,I=null;n&&(T=c&&v.route.id?c[v.route.id]:void 0,A=v.route.errorElement||dC,d&&(f<0&&b===0?(Nx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,I=null):f===b&&(w=!0,I=v.route.hydrateFallbackElement||null)));let P=e.concat(l.slice(0,b+1)),G=()=>{let Q;return T?Q=A:w?Q=I:v.route.Component?Q=D.createElement(v.route.Component,null):v.route.element?Q=v.route.element:Q=_,D.createElement(fC,{match:v,routeContext:{outlet:_,matches:P,isDataRoute:n!=null},children:Q})};return n&&(v.route.ErrorBoundary||v.route.errorElement||b===0)?D.createElement(kx,{location:n.location,revalidation:n.revalidation,component:A,error:T,children:G(),routeContext:{outlet:null,matches:P,isDataRoute:!0},onError:p}):G()},null)}function Dg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pC(t){let e=D.useContext(sl);return xt(e,Dg(t)),e}function gC(t){let e=D.useContext(Vh);return xt(e,Dg(t)),e}function yC(t){let e=D.useContext(dr);return xt(e,Dg(t)),e}function Ig(t){let e=yC(t),n=e.matches[e.matches.length-1];return xt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function _C(){return Ig("useRouteId")}function vC(){let t=D.useContext(Rg),e=gC("useRouteError"),n=Ig("useRouteError");return t!==void 0?t:e.errors?.[n]}function bC(){let{router:t}=pC("useNavigate"),e=Ig("useNavigate"),n=D.useRef(!1);return Ox(()=>{n.current=!0}),D.useCallback(async(a,l={})=>{ur(n.current,jx),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var bb={};function Nx(t,e,n){!e&&!bb[t]&&(bb[t]=!0,ur(!1,n))}D.memo(EC);function EC({routes:t,future:e,state:n,onError:i}){return Mx(t,void 0,n,i,e)}function jg({to:t,replace:e,state:n,relative:i}){xt(al(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=D.useContext(Kn);ur(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=D.useContext(dr),{pathname:c}=Pn(),d=Bh(),f=Cg(t,Ag(l),c,i==="path"),p=JSON.stringify(f);return D.useEffect(()=>{d(JSON.parse(p),{replace:e,state:n,relative:i})},[d,p,i,e,n]),null}function Uh(t){return oC(t.context)}function Yt(t){xt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xC({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){xt(!al(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=t.replace(/^\/*/,"/"),f=D.useMemo(()=>({basename:d,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[d,a,l,c]);typeof n=="string"&&(n=il(n));let{pathname:p="/",search:_="",hash:v="",state:b=null,key:T="default"}=n,w=D.useMemo(()=>{let A=Li(p,d);return A==null?null:{location:{pathname:A,search:_,hash:v,state:b,key:T},navigationType:i}},[d,p,_,v,b,T,i]);return ur(w!=null,`<Router basename="${d}"> is not able to match the URL "${p}${_}${v}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:D.createElement(Kn.Provider,{value:f},D.createElement(Yc.Provider,{children:e,value:w}))}function SC({children:t,location:e}){return cC(Up(t),e)}function Up(t,e=[]){let n=[];return D.Children.forEach(t,(i,a)=>{if(!D.isValidElement(i))return;let l=[...e,a];if(i.type===D.Fragment){n.push.apply(n,Up(i.props.children,l));return}xt(i.type===Yt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Up(i.props.children,l)),n.push(c)}),n}var Xd="get",Jd="application/x-www-form-urlencoded";function zh(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function wC(t){return zh(t)&&t.tagName.toLowerCase()==="button"}function TC(t){return zh(t)&&t.tagName.toLowerCase()==="form"}function AC(t){return zh(t)&&t.tagName.toLowerCase()==="input"}function CC(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function RC(t,e){return t.button===0&&(!e||e==="_self")&&!CC(t)}var Fd=null;function DC(){if(Fd===null)try{new FormData(document.createElement("form"),0),Fd=!1}catch{Fd=!0}return Fd}var IC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ep(t){return t!=null&&!IC.has(t)?(ur(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jd}"`),null):t}function jC(t,e){let n,i,a,l,c;if(TC(t)){let d=t.getAttribute("action");i=d?Li(d,e):null,n=t.getAttribute("method")||Xd,a=Ep(t.getAttribute("enctype"))||Jd,l=new FormData(t)}else if(wC(t)||AC(t)&&(t.type==="submit"||t.type==="image")){let d=t.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||d.getAttribute("action");if(i=f?Li(f,e):null,n=t.getAttribute("formmethod")||d.getAttribute("method")||Xd,a=Ep(t.getAttribute("formenctype"))||Ep(d.getAttribute("enctype"))||Jd,l=new FormData(d,t),!DC()){let{name:p,type:_,value:v}=t;if(_==="image"){let b=p?`${p}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else p&&l.append(p,v)}}else{if(zh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Xd,i=null,a=Jd,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Og(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function OC(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Li(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function MC(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function kC(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function NC(t,e,n){let i=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let c=await MC(l,n);return c.links?c.links():[]}return[]}));return BC(i.flat(1).filter(kC).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Eb(t,e,n,i,a,l){let c=(f,p)=>n[p]?f.route.id!==n[p].route.id:!0,d=(f,p)=>n[p].pathname!==f.pathname||n[p].route.path?.endsWith("*")&&n[p].params["*"]!==f.params["*"];return l==="assets"?e.filter((f,p)=>c(f,p)||d(f,p)):l==="data"?e.filter((f,p)=>{let _=i.routes[f.route.id];if(!_||!_.hasLoader)return!1;if(c(f,p)||d(f,p))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function PC(t,e,{includeHydrateFallback:n}={}){return LC(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function LC(t){return[...new Set(t)]}function VC(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function BC(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let l=JSON.stringify(VC(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function Px(){let t=D.useContext(sl);return Og(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function UC(){let t=D.useContext(Vh);return Og(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Mg=D.createContext(void 0);Mg.displayName="FrameworkContext";function Lx(){let t=D.useContext(Mg);return Og(t,"You must render this element inside a <HydratedRouter> element"),t}function zC(t,e){let n=D.useContext(Mg),[i,a]=D.useState(!1),[l,c]=D.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:p,onMouseLeave:_,onTouchStart:v}=e,b=D.useRef(null);D.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let A=P=>{P.forEach(G=>{c(G.isIntersecting)})},I=new IntersectionObserver(A,{threshold:.5});return b.current&&I.observe(b.current),()=>{I.disconnect()}}},[t]),D.useEffect(()=>{if(i){let A=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(A)}}},[i]);let T=()=>{a(!0)},w=()=>{a(!1),c(!1)};return n?t!=="intent"?[l,b,{}]:[l,b,{onFocus:Ac(d,T),onBlur:Ac(f,w),onMouseEnter:Ac(p,T),onMouseLeave:Ac(_,w),onTouchStart:Ac(v,T)}]:[!1,b,{}]}function Ac(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function FC({page:t,...e}){let{router:n}=Px(),i=D.useMemo(()=>xx(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?D.createElement(QC,{page:t,matches:i,...e}):null}function qC(t){let{manifest:e,routeModules:n}=Lx(),[i,a]=D.useState([]);return D.useEffect(()=>{let l=!1;return NC(t,e,n).then(c=>{l||a(c)}),()=>{l=!0}},[t,e,n]),i}function QC({page:t,matches:e,...n}){let i=Pn(),{manifest:a,routeModules:l}=Lx(),{basename:c}=Px(),{loaderData:d,matches:f}=UC(),p=D.useMemo(()=>Eb(t,e,f,a,i,"data"),[t,e,f,a,i]),_=D.useMemo(()=>Eb(t,e,f,a,i,"assets"),[t,e,f,a,i]),v=D.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let w=new Set,A=!1;if(e.forEach(P=>{let G=a.routes[P.route.id];!G||!G.hasLoader||(!p.some(Q=>Q.route.id===P.route.id)&&P.route.id in d&&l[P.route.id]?.shouldRevalidate||G.hasClientLoader?A=!0:w.add(P.route.id))}),w.size===0)return[];let I=OC(t,c,"data");return A&&w.size>0&&I.searchParams.set("_routes",e.filter(P=>w.has(P.route.id)).map(P=>P.route.id).join(",")),[I.pathname+I.search]},[c,d,i,a,p,e,t,l]),b=D.useMemo(()=>PC(_,a),[_,a]),T=qC(_);return D.createElement(D.Fragment,null,v.map(w=>D.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...n})),b.map(w=>D.createElement("link",{key:w,rel:"modulepreload",href:w,...n})),T.map(({key:w,link:A})=>D.createElement("link",{key:w,nonce:n.nonce,...A})))}function GC(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var HC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{HC&&(window.__reactRouterVersion="7.11.0")}catch{}function KC({basename:t,children:e,unstable_useTransitions:n,window:i}){let a=D.useRef();a.current==null&&(a.current=wA({window:i,v5Compat:!0}));let l=a.current,[c,d]=D.useState({action:l.action,location:l.location}),f=D.useCallback(p=>{n===!1?d(p):D.startTransition(()=>d(p))},[n]);return D.useLayoutEffect(()=>l.listen(f),[l,f]),D.createElement(xC,{basename:t,children:e,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:n})}var Vx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wt=D.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,state:d,target:f,to:p,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...T},w){let{basename:A,unstable_useTransitions:I}=D.useContext(Kn),P=typeof p=="string"&&Vx.test(p),G=Cx(p,A);p=G.to;let Q=iC(p,{relative:a}),[X,Z,oe]=zC(i,T),O=XC(p,{replace:c,state:d,target:f,preventScrollReset:_,relative:a,viewTransition:v,unstable_defaultShouldRevalidate:b,unstable_useTransitions:I});function C(N){e&&e(N),N.defaultPrevented||O(N)}let R=D.createElement("a",{...T,...oe,href:G.absoluteURL||Q,onClick:G.isExternal||l?e:C,ref:GC(w,Z),target:f,"data-discover":!P&&n==="render"?"true":void 0});return X&&!P?D.createElement(D.Fragment,null,R,D.createElement(FC,{page:Q})):R});wt.displayName="Link";var $C=D.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:d,children:f,...p},_){let v=Xc(c,{relative:p.relative}),b=Pn(),T=D.useContext(Vh),{navigator:w,basename:A}=D.useContext(Kn),I=T!=null&&nR(v)&&d===!0,P=w.encodeLocation?w.encodeLocation(v).pathname:v.pathname,G=b.pathname,Q=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(G=G.toLowerCase(),Q=Q?Q.toLowerCase():null,P=P.toLowerCase()),Q&&A&&(Q=Li(Q,A)||Q);const X=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let Z=G===P||!a&&G.startsWith(P)&&G.charAt(X)==="/",oe=Q!=null&&(Q===P||!a&&Q.startsWith(P)&&Q.charAt(P.length)==="/"),O={isActive:Z,isPending:oe,isTransitioning:I},C=Z?e:void 0,R;typeof i=="function"?R=i(O):R=[i,Z?"active":null,oe?"pending":null,I?"transitioning":null].filter(Boolean).join(" ");let N=typeof l=="function"?l(O):l;return D.createElement(wt,{...p,"aria-current":C,className:R,ref:_,style:N,to:c,viewTransition:d},typeof f=="function"?f(O):f)});$C.displayName="NavLink";var WC=D.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:l,method:c=Xd,action:d,onSubmit:f,relative:p,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...T},w)=>{let{unstable_useTransitions:A}=D.useContext(Kn),I=eR(),P=tR(d,{relative:p}),G=c.toLowerCase()==="get"?"get":"post",Q=typeof d=="string"&&Vx.test(d),X=Z=>{if(f&&f(Z),Z.defaultPrevented)return;Z.preventDefault();let oe=Z.nativeEvent.submitter,O=oe?.getAttribute("formmethod")||c,C=()=>I(oe||Z.currentTarget,{fetcherKey:e,method:O,navigate:n,replace:a,state:l,relative:p,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b});A&&n!==!1?D.startTransition(()=>C()):C()};return D.createElement("form",{ref:w,method:G,action:P,onSubmit:i?f:X,...T,"data-discover":!Q&&t==="render"?"true":void 0})});WC.displayName="Form";function YC(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Bx(t){let e=D.useContext(sl);return xt(e,YC(t)),e}function XC(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:d,unstable_useTransitions:f}={}){let p=Bh(),_=Pn(),v=Xc(t,{relative:l});return D.useCallback(b=>{if(RC(b,e)){b.preventDefault();let T=n!==void 0?n:Uc(_)===Uc(v),w=()=>p(t,{replace:T,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:d});f?D.startTransition(()=>w()):w()}},[_,p,v,n,i,e,t,a,l,c,d,f])}var JC=0,ZC=()=>`__${String(++JC)}__`;function eR(){let{router:t}=Bx("useSubmit"),{basename:e}=D.useContext(Kn),n=_C(),i=t.fetch,a=t.navigate;return D.useCallback(async(l,c={})=>{let{action:d,method:f,encType:p,formData:_,body:v}=jC(l,e);if(c.navigate===!1){let b=c.fetcherKey||ZC();await i(b,n,c.action||d,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||f,formEncType:c.encType||p,flushSync:c.flushSync})}else await a(c.action||d,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||f,formEncType:c.encType||p,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,e,n])}function tR(t,{relative:e}={}){let{basename:n}=D.useContext(Kn),i=D.useContext(dr);xt(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...Xc(t||".",{relative:e})},c=Pn();if(t==null){l.search=c.search;let d=new URLSearchParams(l.search),f=d.getAll("index");if(f.some(_=>_==="")){d.delete("index"),f.filter(v=>v).forEach(v=>d.append("index",v));let _=d.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Ni([n,l.pathname])),Uc(l)}function nR(t,{relative:e}={}){let n=D.useContext(Dx);xt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Bx("useViewTransitionState"),a=Xc(t,{relative:e});if(!n.isTransitioning)return!1;let l=Li(n.currentLocation.pathname,i)||n.currentLocation.pathname,c=Li(n.nextLocation.pathname,i)||n.nextLocation.pathname;return ch(a.pathname,c)!=null||ch(a.pathname,l)!=null}const rR=function(){},iR={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:rR},Jc=D.createContext(iR);var ol=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},sR={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},aR=class{#e=sR;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Oi=new aR;function oR(t){setTimeout(t,0)}var Ra=typeof window>"u"||"Deno"in globalThis;function Xt(){}function lR(t,e){return typeof t=="function"?t(e):t}function zp(t){return typeof t=="number"&&t>=0&&t!==1/0}function Ux(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Rs(t,e){return typeof t=="function"?t(e):t}function lr(t,e){return typeof t=="function"?t(e):t}function xb(t,e){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:c,stale:d}=t;if(c){if(i){if(e.queryHash!==kg(c,e.options))return!1}else if(!zc(e.queryKey,c))return!1}if(n!=="all"){const f=e.isActive();if(n==="active"&&!f||n==="inactive"&&f)return!1}return!(typeof d=="boolean"&&e.isStale()!==d||a&&a!==e.state.fetchStatus||l&&!l(e))}function Sb(t,e){const{exact:n,status:i,predicate:a,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(Da(e.options.mutationKey)!==Da(l))return!1}else if(!zc(e.options.mutationKey,l))return!1}return!(i&&e.state.status!==i||a&&!a(e))}function kg(t,e){return(e?.queryKeyHashFn||Da)(t)}function Da(t){return JSON.stringify(t,(e,n)=>Fp(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function zc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>zc(t[n],e[n])):!1}var cR=Object.prototype.hasOwnProperty;function zx(t,e){if(t===e)return t;const n=wb(t)&&wb(e);if(!n&&!(Fp(t)&&Fp(e)))return e;const a=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),c=l.length,d=n?new Array(c):{};let f=0;for(let p=0;p<c;p++){const _=n?p:l[p],v=t[_],b=e[_];if(v===b){d[_]=v,(n?p<a:cR.call(t,_))&&f++;continue}if(v===null||b===null||typeof v!="object"||typeof b!="object"){d[_]=b;continue}const T=zx(v,b);d[_]=T,T===v&&f++}return a===c&&f===a?t:d}function uh(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function wb(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Fp(t){if(!Tb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Tb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Tb(t){return Object.prototype.toString.call(t)==="[object Object]"}function uR(t){return new Promise(e=>{Oi.setTimeout(e,t)})}function qp(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?zx(t,e):e}function dR(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function hR(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var Ng=Symbol();function Fx(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Ng?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function qx(t,e){return typeof t=="function"?t(...e):!!t}var fR=class extends ol{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!Ra&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Pg=new fR;function Qp(){let t,e;const n=new Promise((a,l)=>{t=a,e=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),e(a)},n}function mR(t){let e;if(t.then(n=>(e=n,n),Xt)?.catch(Xt),e!==void 0)return{data:e}}function Qx(t){return t}function pR(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function gR(t,e,n){const i=()=>{const a=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return a?.catch(Xt),a};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:i()},...t.meta&&{meta:t.meta}}}function yR(t){return t.state.isPaused}function _R(t){return t.state.status==="success"}function vR(t){return!0}function bR(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??yR,i=t.getMutationCache().getAll().flatMap(f=>n(f)?[pR(f)]:[]),a=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??_R,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??vR,c=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??Qx,d=t.getQueryCache().getAll().flatMap(f=>a(f)?[gR(f,c,l)]:[]);return{mutations:i,queries:d}}function ER(t,e,n){if(typeof e!="object"||e===null)return;const i=t.getMutationCache(),a=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??Qx,c=e.mutations||[],d=e.queries||[];c.forEach(({state:f,...p})=>{i.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...p},f)}),d.forEach(({queryKey:f,state:p,queryHash:_,meta:v,promise:b,dehydratedAt:T})=>{const w=b?mR(b):void 0,A=p.data===void 0?w?.data:p.data,I=A===void 0?A:l(A);let P=a.get(_);const G=P?.state.status==="pending",Q=P?.state.fetchStatus==="fetching";if(P){const X=w&&T!==void 0&&T>P.state.dataUpdatedAt;if(p.dataUpdatedAt>P.state.dataUpdatedAt||X){const{fetchStatus:Z,...oe}=p;P.setState({...oe,data:I})}}else P=a.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:f,queryHash:_,meta:v},{...p,data:I,fetchStatus:"idle",status:I!==void 0?"success":p.status});b&&!G&&!Q&&(T===void 0||T>P.state.dataUpdatedAt)&&P.fetch(void 0,{initialPromise:Promise.resolve(b).then(l)}).catch(Xt)})}var xR=oR;function SR(){let t=[],e=0,n=d=>{d()},i=d=>{d()},a=xR;const l=d=>{e?t.push(d):a(()=>{n(d)})},c=()=>{const d=t;t=[],d.length&&a(()=>{i(()=>{d.forEach(f=>{n(f)})})})};return{batch:d=>{let f;e++;try{f=d()}finally{e--,e||c()}return f},batchCalls:d=>(...f)=>{l(()=>{d(...f)})},schedule:l,setNotifyFunction:d=>{n=d},setBatchNotifyFunction:d=>{i=d},setScheduler:d=>{a=d}}}var Jt=SR(),wR=class extends ol{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!Ra&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},dh=new wR;function TR(t){return Math.min(1e3*2**t,3e4)}function Gx(t){return(t??"online")==="online"?dh.isOnline():!0}var Gp=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function Hx(t){let e=!1,n=0,i;const a=Qp(),l=()=>a.status!=="pending",c=A=>{if(!l()){const I=new Gp(A);b(I),t.onCancel?.(I)}},d=()=>{e=!0},f=()=>{e=!1},p=()=>Pg.isFocused()&&(t.networkMode==="always"||dh.isOnline())&&t.canRun(),_=()=>Gx(t.networkMode)&&t.canRun(),v=A=>{l()||(i?.(),a.resolve(A))},b=A=>{l()||(i?.(),a.reject(A))},T=()=>new Promise(A=>{i=I=>{(l()||p())&&A(I)},t.onPause?.()}).then(()=>{i=void 0,l()||t.onContinue?.()}),w=()=>{if(l())return;let A;const I=n===0?t.initialPromise:void 0;try{A=I??t.fn()}catch(P){A=Promise.reject(P)}Promise.resolve(A).then(v).catch(P=>{if(l())return;const G=t.retry??(Ra?0:3),Q=t.retryDelay??TR,X=typeof Q=="function"?Q(n,P):Q,Z=G===!0||typeof G=="number"&&n<G||typeof G=="function"&&G(n,P);if(e||!Z){b(P);return}n++,t.onFail?.(n,P),uR(X).then(()=>p()?void 0:T()).then(()=>{e?b(P):w()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(i?.(),a),cancelRetry:d,continueRetry:f,canStart:_,start:()=>(_()?w():T().then(w),a)}}var Kx=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),zp(this.gcTime)&&(this.#e=Oi.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Ra?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Oi.clearTimeout(this.#e),this.#e=void 0)}},AR=class extends Kx{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=Cb(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Cb(this.options);n.data!==void 0&&(this.setState(Ab(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const i=qp(this.state.data,e,this.options);return this.#s({data:i,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),i}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then(Xt).catch(Xt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>lr(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ng||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Rs(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!Ux(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const i=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(this.#o=!0,i.signal)})},l=()=>{const f=Fx(this.options,n),_=(()=>{const v={client:this.#i,queryKey:this.queryKey,meta:this.meta};return a(v),v})();return this.#o=!1,this.options.persister?this.options.persister(f,_,this):f(_)},d=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return a(f),f})();this.options.behavior?.onFetch(d,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==d.fetchOptions?.meta)&&this.#s({type:"fetch",meta:d.fetchOptions?.meta}),this.#r=Hx({initialPromise:n?.initialPromise,fn:d.fetchFn,onCancel:f=>{f instanceof Gp&&f.revert&&this.setState({...this.#t,fetchStatus:"idle"}),i.abort()},onFail:(f,p)=>{this.#s({type:"failed",failureCount:f,error:p})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0});try{const f=await this.#r.start();if(f===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(f),this.#n.config.onSuccess?.(f,this),this.#n.config.onSettled?.(f,this.state.error,this),f}catch(f){if(f instanceof Gp){if(f.silent)return this.#r.promise;if(f.revert){if(this.state.data===void 0)throw f;return this.state.data}}throw this.#s({type:"error",error:f}),this.#n.config.onError?.(f,this),this.#n.config.onSettled?.(this.state.data,f,this),f}finally{this.scheduleGc()}}#s(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...$x(i.data,this.options),fetchMeta:e.meta??null};case"success":const a={...i,...Ab(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const l=e.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),Jt.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function $x(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Gx(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Ab(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Cb(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var CR=class extends ol{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=Qp(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Rb(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Hp(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Hp(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#E(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof lr(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#x(),this.#t.setOptions(this.options),e._defaulted&&!uh(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&Db(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),i&&(this.#t!==n||lr(this.options.enabled,this.#t)!==lr(e.enabled,this.#t)||Rs(this.options.staleTime,this.#t)!==Rs(e.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||lr(this.options.enabled,this.#t)!==lr(e.enabled,this.#t)||a!==this.#l)&&this.#_(a)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return DR(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),e?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#x();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Xt)),e}#g(){this.#b();const t=Rs(this.options.staleTime,this.#t);if(Ra||this.#i.isStale||!zp(t))return;const n=Ux(this.#i.dataUpdatedAt,t)+1;this.#c=Oi.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#E(),this.#l=t,!(Ra||lr(this.options.enabled,this.#t)===!1||!zp(this.#l)||this.#l===0)&&(this.#u=Oi.setInterval(()=>{(this.options.refetchIntervalInBackground||Pg.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#b(){this.#c&&(Oi.clearTimeout(this.#c),this.#c=void 0)}#E(){this.#u&&(Oi.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,i=this.options,a=this.#i,l=this.#r,c=this.#a,f=t!==n?t.state:this.#n,{state:p}=t;let _={...p},v=!1,b;if(e._optimisticResults){const C=this.hasListeners(),R=!C&&Rb(t,e),N=C&&Db(t,n,e,i);(R||N)&&(_={..._,...$x(p.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:T,errorUpdatedAt:w,status:A}=_;b=_.data;let I=!1;if(e.placeholderData!==void 0&&b===void 0&&A==="pending"){let C;a?.isPlaceholderData&&e.placeholderData===c?.placeholderData?(C=a.data,I=!0):C=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,C!==void 0&&(A="success",b=qp(a?.data,C,e),v=!0)}if(e.select&&b!==void 0&&!I)if(a&&b===l?.data&&e.select===this.#p)b=this.#h;else try{this.#p=e.select,b=e.select(b),b=qp(a?.data,b,e),this.#h=b,this.#s=null}catch(C){this.#s=C}this.#s&&(T=this.#s,b=this.#h,w=Date.now(),A="error");const P=_.fetchStatus==="fetching",G=A==="pending",Q=A==="error",X=G&&P,Z=b!==void 0,O={status:A,fetchStatus:_.fetchStatus,isPending:G,isSuccess:A==="success",isError:Q,isInitialLoading:X,isLoading:X,data:b,dataUpdatedAt:_.dataUpdatedAt,error:T,errorUpdatedAt:w,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>f.dataUpdateCount||_.errorUpdateCount>f.errorUpdateCount,isFetching:P,isRefetching:P&&!G,isLoadingError:Q&&!Z,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:Q&&Z,isStale:Lg(t,e),refetch:this.refetch,promise:this.#o,isEnabled:lr(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const C=j=>{O.status==="error"?j.reject(O.error):O.data!==void 0&&j.resolve(O.data)},R=()=>{const j=this.#o=O.promise=Qp();C(j)},N=this.#o;switch(N.status){case"pending":t.queryHash===n.queryHash&&C(N);break;case"fulfilled":(O.status==="error"||O.data!==N.value)&&R();break;case"rejected":(O.status!=="error"||O.error!==N.reason)&&R();break}}return O}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),uh(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(c=>{const d=c;return this.#i[d]!==t[d]&&l.has(d)})};this.#S({listeners:n()})}#x(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#S(t){Jt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function RR(t,e){return lr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Rb(t,e){return RR(t,e)||t.state.data!==void 0&&Hp(t,e,e.refetchOnMount)}function Hp(t,e,n){if(lr(e.enabled,t)!==!1&&Rs(e.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&Lg(t,e)}return!1}function Db(t,e,n,i){return(t!==e||lr(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Lg(t,n)}function Lg(t,e){return lr(e.enabled,t)!==!1&&t.isStaleByTime(Rs(e.staleTime,t))}function DR(t,e){return!uh(t.getCurrentResult(),e)}function Ib(t){return{onFetch:(e,n)=>{const i=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],c=e.state.data?.pageParams||[];let d={pages:[],pageParams:[]},f=0;const p=async()=>{let _=!1;const v=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},b=Fx(e.options,e.fetchOptions),T=async(w,A,I)=>{if(_)return Promise.reject();if(A==null&&w.pages.length)return Promise.resolve(w);const G=(()=>{const oe={client:e.client,queryKey:e.queryKey,pageParam:A,direction:I?"backward":"forward",meta:e.options.meta};return v(oe),oe})(),Q=await b(G),{maxPages:X}=e.options,Z=I?hR:dR;return{pages:Z(w.pages,Q,X),pageParams:Z(w.pageParams,A,X)}};if(a&&l.length){const w=a==="backward",A=w?IR:jb,I={pages:l,pageParams:c},P=A(i,I);d=await T(I,P,w)}else{const w=t??l.length;do{const A=f===0?c[0]??i.initialPageParam:jb(i,d);if(f>0&&A==null)break;d=await T(d,A),f++}while(f<w)}return d};e.options.persister?e.fetchFn=()=>e.options.persister?.(p,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=p}}}function jb(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function IR(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var jR=class extends Kx{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||Wx(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=Hx({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(c,d)=>{this.#r({type:"failed",failureCount:c,error:d})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",l=!this.#i.canStart();try{if(a)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,i);const d=await this.options.onMutate?.(e,i);d!==this.state.context&&this.#r({type:"pending",context:d,variables:e,isPaused:l})}const c=await this.#i.start();return await this.#n.config.onSuccess?.(c,e,this.state.context,this,i),await this.options.onSuccess?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(c,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(c,null,e,this.state.context,i),this.#r({type:"success",data:c}),c}catch(c){try{throw await this.#n.config.onError?.(c,e,this.state.context,this,i),await this.options.onError?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(void 0,c,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,c,e,this.state.context,i),c}finally{this.#r({type:"error",error:c})}}finally{this.#n.runNext(this)}}#r(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Jt.batch(()=>{this.#t.forEach(i=>{i.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function Wx(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var OR=class extends ol{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const i=new jR({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){this.#e.add(t);const e=qd(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=qd(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=qd(t);if(typeof e=="string"){const i=this.#t.get(e)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const e=qd(t);return typeof e=="string"?this.#t.get(e)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Jt.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Sb(e,n))}findAll(t={}){return this.getAll().filter(e=>Sb(t,e))}notify(t){Jt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return Jt.batch(()=>Promise.all(t.map(e=>e.continue().catch(Xt))))}};function qd(t){return t.options.scope?.id}var MR=class extends ol{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),uh(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&Da(n.mutationKey)!==Da(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??Wx();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){Jt.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,i,a),this.#i.onSettled?.(e.data,null,n,i,a)):e?.type==="error"&&(this.#i.onError?.(e.error,n,i,a),this.#i.onSettled?.(void 0,e.error,n,i,a))}this.listeners.forEach(n=>{n(this.#t)})})}},kR=class extends ol{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const i=e.queryKey,a=e.queryHash??kg(i,e);let l=this.get(a);return l||(l=new AR({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Jt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>xb(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>xb(t,n)):e}notify(t){Jt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Jt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Jt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},NR=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new kR,this.#t=t.mutationCache||new OR,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=Pg.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=dh.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Rs(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(i.queryHash)?.state.data,c=lR(e,l);if(c!==void 0)return this.#e.build(this,i).setData(c,{...n,manual:!0})}setQueriesData(t,e,n){return Jt.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;Jt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return Jt.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=Jt.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then(Xt).catch(Xt)}invalidateQueries(t,e={}){return Jt.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=Jt.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(Xt)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(Xt)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Rs(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Xt).catch(Xt)}fetchInfiniteQuery(t){return t.behavior=Ib(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Xt).catch(Xt)}ensureInfiniteQueryData(t){return t.behavior=Ib(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return dh.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Da(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(i=>{zc(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Da(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(i=>{zc(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=kg(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ng&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Yx=D.createContext(void 0),hi=t=>{const e=D.useContext(Yx);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},PR=({client:t,children:e})=>(D.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),h.jsx(Yx.Provider,{value:t,children:e})),Xx=D.createContext(!1),LR=()=>D.useContext(Xx),VR=Xx.Provider;function BR(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var UR=D.createContext(BR()),zR=()=>D.useContext(UR),FR=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},qR=t=>{D.useEffect(()=>{t.clearReset()},[t])},QR=({result:t,errorResetBoundary:e,throwOnError:n,query:i,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||qx(n,[t.error,i])),GR=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},HR=(t,e)=>t.isLoading&&t.isFetching&&!e,KR=(t,e)=>t?.suspense&&e.isPending,Ob=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function $R(t,e,n){const i=LR(),a=zR(),l=hi(),c=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c),c._optimisticResults=i?"isRestoring":"optimistic",GR(c),FR(c,a),qR(a);const d=!l.getQueryCache().get(c.queryHash),[f]=D.useState(()=>new e(l,c)),p=f.getOptimisticResult(c),_=!i&&t.subscribed!==!1;if(D.useSyncExternalStore(D.useCallback(v=>{const b=_?f.subscribe(Jt.batchCalls(v)):Xt;return f.updateResult(),b},[f,_]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),D.useEffect(()=>{f.setOptions(c)},[c,f]),KR(c,p))throw Ob(c,f,a);if(QR({result:p,errorResetBoundary:a,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw p.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,p),c.experimental_prefetchInRender&&!Ra&&HR(p,i)&&(d?Ob(c,f,a):l.getQueryCache().get(c.queryHash)?.promise)?.catch(Xt).finally(()=>{f.updateResult()}),c.notifyOnChangeProps?p:f.trackResult(p)}function Na(t,e){return $R(t,CR)}function pt(t,e){const n=hi(),[i]=D.useState(()=>new MR(n,t));D.useEffect(()=>{i.setOptions(t)},[i,t]);const a=D.useSyncExternalStore(D.useCallback(c=>i.subscribe(Jt.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=D.useCallback((c,d)=>{i.mutate(c,d).catch(Xt)},[i]);if(a.error&&qx(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}function Kp(){}function WR(t,{interval:e=1e3,onError:n=Kp}={}){if(typeof t!="function")throw new Error("argument is not function.");let i=0,a=null,l=!1,c=!1;return async(...d)=>{if(a=d,!c){for(c=!0;l;)await new Promise(f=>Oi.setTimeout(f,e));for(;Date.now()<i;)await new Promise(f=>Oi.setTimeout(f,i-Date.now()));c=!1,l=!0;try{await t(...a)}catch(f){try{n(f)}catch{}}i=Date.now()+e,l=!1}}}var YR=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:i=JSON.stringify,deserialize:a=JSON.parse,retry:l})=>{if(t){const c=async d=>{try{const f=await i(d);await t.setItem(e,f);return}catch(f){return f}};return{persistClient:WR(async d=>{let f=d,p=await c(f),_=0;for(;p&&f;)_++,f=await l?.({persistedClient:f,error:p,errorCount:_}),f&&(p=await c(f))},{interval:n}),restoreClient:async()=>{const d=await t.getItem(e);if(d)return await a(d)},removeClient:()=>t.removeItem(e)}}return{persistClient:Kp,restoreClient:()=>Promise.resolve(void 0),removeClient:Kp}};const Oe=new NR({defaultOptions:{queries:{staleTime:300*1e3,gcTime:1440*60*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}});Oe.getQueryCache().subscribe(t=>{const e=t?.query;if(e&&t.type==="updated"){const{state:n}=e;n.status==="error"&&n.error&&console.error("[RQ] Query FAILED:",e.queryKey,n.error)}});const XR=YR({storage:typeof window<"u"?{getItem:t=>Promise.resolve(localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(localStorage.removeItem(t))}:void 0,key:"BUDGET_APP_QUERY_CACHE"}),ie={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};var JR=["added","removed","updated"];function Mb(t){return JR.includes(t)}async function ZR({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:i="",hydrateOptions:a}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const c=Date.now()-l.timestamp>n,d=l.buster!==i;if(c||d)return e.removeClient();ER(t,l.clientState,a)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function kb({queryClient:t,persister:e,buster:n="",dehydrateOptions:i}){const a={buster:n,timestamp:Date.now(),clientState:bR(t,i)};await e.persistClient(a)}function eD(t){const e=t.queryClient.getQueryCache().subscribe(i=>{Mb(i.type)&&kb(t)}),n=t.queryClient.getMutationCache().subscribe(i=>{Mb(i.type)&&kb(t)});return()=>{e(),n()}}var tD=({children:t,persistOptions:e,onSuccess:n,onError:i,...a})=>{const[l,c]=D.useState(!0),d=D.useRef({persistOptions:e,onSuccess:n,onError:i}),f=D.useRef(!1);return D.useEffect(()=>{d.current={persistOptions:e,onSuccess:n,onError:i}}),D.useEffect(()=>{const p={...d.current.persistOptions,queryClient:a.client};return f.current||(f.current=!0,ZR(p).then(()=>d.current.onSuccess?.()).catch(()=>d.current.onError?.()).finally(()=>{c(!1)})),l?void 0:eD(p)},[a.client,l]),h.jsx(PR,{...a,children:h.jsx(VR,{value:l,children:t})})};function nD({children:t}){return h.jsx(tD,{client:Oe,persistOptions:{persister:XR,maxAge:1440*60*1e3,buster:"v1"},children:t})}const rD=()=>{};var Nb={};const Jx=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},iD=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],c=t[n++],d=t[n++],f=((a&7)<<18|(l&63)<<12|(c&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const l=t[n++],c=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},Zx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],c=a+1<t.length,d=c?t[a+1]:0,f=a+2<t.length,p=f?t[a+2]:0,_=l>>2,v=(l&3)<<4|d>>4;let b=(d&15)<<2|p>>6,T=p&63;f||(T=64,c||(b=64)),i.push(n[_],n[v],n[b],n[T])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Jx(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):iD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],d=a<t.length?n[t.charAt(a)]:0;++a;const p=a<t.length?n[t.charAt(a)]:64;++a;const v=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||d==null||p==null||v==null)throw new sD;const b=l<<2|d>>4;if(i.push(b),p!==64){const T=d<<4&240|p>>2;if(i.push(T),v!==64){const w=p<<6&192|v;i.push(w)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class sD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aD=function(t){const e=Jx(t);return Zx.encodeByteArray(e,!0)},hh=function(t){return aD(t).replace(/\./g,"")},eS=function(t){try{return Zx.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function oD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const lD=()=>oD().__FIREBASE_DEFAULTS__,cD=()=>{if(typeof process>"u"||typeof Nb>"u")return;const t=Nb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},uD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&eS(t[1]);return e&&JSON.parse(e)},Fh=()=>{try{return rD()||lD()||cD()||uD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},tS=t=>Fh()?.emulatorHosts?.[t],dD=t=>{const e=tS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},nS=()=>Fh()?.config,rS=t=>Fh()?.[`_${t}`];class hD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function ll(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function iS(t){return(await fetch(t,{credentials:"include"})).ok}function fD(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[hh(JSON.stringify(n)),hh(JSON.stringify(c)),""].join(".")}const kc={};function mD(){const t={prod:[],emulator:[]};for(const e of Object.keys(kc))kc[e]?t.emulator.push(e):t.prod.push(e);return t}function pD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Pb=!1;function sS(t,e){if(typeof window>"u"||typeof document>"u"||!ll(window.location.host)||kc[t]===e||kc[t]||Pb)return;kc[t]=e;function n(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=mD().prod.length>0;function c(){const b=document.getElementById(i);b&&b.remove()}function d(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function f(b,T){b.setAttribute("width","24"),b.setAttribute("id",T),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function p(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{Pb=!0,c()},b}function _(b,T){b.setAttribute("id",T),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function v(){const b=pD(i),T=n("text"),w=document.getElementById(T)||document.createElement("span"),A=n("learnmore"),I=document.getElementById(A)||document.createElement("a"),P=n("preprendIcon"),G=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const Q=b.element;d(Q),_(I,A);const X=p();f(G,P),Q.append(G,w,I,X),document.body.appendChild(Q)}l?(w.innerText="Preview backend disconnected.",G.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(G.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function xn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xn())}function yD(){const t=Fh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _D(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function vD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function bD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ED(){const t=xn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function xD(){return!yD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SD(){try{return typeof indexedDB=="object"}catch{return!1}}function wD(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const TD="FirebaseError";class qi extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=TD,Object.setPrototypeOf(this,qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zc.prototype.create)}}class Zc{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?AD(l,i):"Error",d=`${this.serviceName}: ${c} (${a}).`;return new qi(a,d,i)}}function AD(t,e){return t.replace(CD,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const CD=/\{\$([^}]+)}/g;function RD(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ns(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],c=e[a];if(Lb(l)&&Lb(c)){if(!Ns(l,c))return!1}else if(l!==c)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function Lb(t){return t!==null&&typeof t=="object"}function eu(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Rc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Dc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function DD(t,e){const n=new ID(t,e);return n.subscribe.bind(n)}class ID{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");jD(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=xp),a.error===void 0&&(a.error=xp),a.complete===void 0&&(a.complete=xp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jD(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function xp(){}function sn(t){return t&&t._delegate?t._delegate:t}class Ia{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ta="[DEFAULT]";class OD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new hD;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kD(e))try{this.getOrInitializeService({instanceIdentifier:Ta})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=Ta){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ta){return this.instances.has(e)}getOptions(e=Ta){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);i===d&&c.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:MD(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ta){return this.component?this.component.multipleInstances?e:Ta:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function MD(t){return t===Ta?void 0:t}function kD(t){return t.instantiationMode==="EAGER"}class ND{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new OD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var $e;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})($e||($e={}));const PD={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},LD=$e.INFO,VD={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},BD=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=VD[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vg{constructor(e){this.name=e,this._logLevel=LD,this._logHandler=BD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const UD=(t,e)=>e.some(n=>t instanceof n);let Vb,Bb;function zD(){return Vb||(Vb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function FD(){return Bb||(Bb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aS=new WeakMap,$p=new WeakMap,oS=new WeakMap,Sp=new WeakMap,Bg=new WeakMap;function qD(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",c)},l=()=>{n(Ds(t.result)),a()},c=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",c)});return e.then(n=>{n instanceof IDBCursor&&aS.set(n,t)}).catch(()=>{}),Bg.set(e,t),e}function QD(t){if($p.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",c),t.removeEventListener("abort",c)},l=()=>{n(),a()},c=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",c),t.addEventListener("abort",c)});$p.set(t,e)}let Wp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return $p.get(t);if(e==="objectStoreNames")return t.objectStoreNames||oS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ds(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function GD(t){Wp=t(Wp)}function HD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(wp(this),e,...n);return oS.set(i,e.sort?e.sort():[e]),Ds(i)}:FD().includes(t)?function(...e){return t.apply(wp(this),e),Ds(aS.get(this))}:function(...e){return Ds(t.apply(wp(this),e))}}function KD(t){return typeof t=="function"?HD(t):(t instanceof IDBTransaction&&QD(t),UD(t,zD())?new Proxy(t,Wp):t)}function Ds(t){if(t instanceof IDBRequest)return qD(t);if(Sp.has(t))return Sp.get(t);const e=KD(t);return e!==t&&(Sp.set(t,e),Bg.set(e,t)),e}const wp=t=>Bg.get(t);function $D(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const c=indexedDB.open(t,e),d=Ds(c);return i&&c.addEventListener("upgradeneeded",f=>{i(Ds(c.result),f.oldVersion,f.newVersion,Ds(c.transaction),f)}),n&&c.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),d.then(f=>{l&&f.addEventListener("close",()=>l()),a&&f.addEventListener("versionchange",p=>a(p.oldVersion,p.newVersion,p))}).catch(()=>{}),d}const WD=["get","getKey","getAll","getAllKeys","count"],YD=["put","add","delete","clear"],Tp=new Map;function Ub(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Tp.get(e))return Tp.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=YD.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||WD.includes(n)))return;const l=async function(c,...d){const f=this.transaction(c,a?"readwrite":"readonly");let p=f.store;return i&&(p=p.index(d.shift())),(await Promise.all([p[n](...d),a&&f.done]))[0]};return Tp.set(e,l),l}GD(t=>({...t,get:(e,n,i)=>Ub(e,n)||t.get(e,n,i),has:(e,n)=>!!Ub(e,n)||t.has(e,n)}));class XD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(JD(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function JD(t){return t.getComponent()?.type==="VERSION"}const Yp="@firebase/app",zb="0.14.6";const Vi=new Vg("@firebase/app"),ZD="@firebase/app-compat",eI="@firebase/analytics-compat",tI="@firebase/analytics",nI="@firebase/app-check-compat",rI="@firebase/app-check",iI="@firebase/auth",sI="@firebase/auth-compat",aI="@firebase/database",oI="@firebase/data-connect",lI="@firebase/database-compat",cI="@firebase/functions",uI="@firebase/functions-compat",dI="@firebase/installations",hI="@firebase/installations-compat",fI="@firebase/messaging",mI="@firebase/messaging-compat",pI="@firebase/performance",gI="@firebase/performance-compat",yI="@firebase/remote-config",_I="@firebase/remote-config-compat",vI="@firebase/storage",bI="@firebase/storage-compat",EI="@firebase/firestore",xI="@firebase/ai",SI="@firebase/firestore-compat",wI="firebase",TI="12.6.0";const Xp="[DEFAULT]",AI={[Yp]:"fire-core",[ZD]:"fire-core-compat",[tI]:"fire-analytics",[eI]:"fire-analytics-compat",[rI]:"fire-app-check",[nI]:"fire-app-check-compat",[iI]:"fire-auth",[sI]:"fire-auth-compat",[aI]:"fire-rtdb",[oI]:"fire-data-connect",[lI]:"fire-rtdb-compat",[cI]:"fire-fn",[uI]:"fire-fn-compat",[dI]:"fire-iid",[hI]:"fire-iid-compat",[fI]:"fire-fcm",[mI]:"fire-fcm-compat",[pI]:"fire-perf",[gI]:"fire-perf-compat",[yI]:"fire-rc",[_I]:"fire-rc-compat",[vI]:"fire-gcs",[bI]:"fire-gcs-compat",[EI]:"fire-fst",[SI]:"fire-fst-compat",[xI]:"fire-vertex","fire-js":"fire-js",[wI]:"fire-js-all"};const fh=new Map,CI=new Map,Jp=new Map;function Fb(t,e){try{t.container.addComponent(e)}catch(n){Vi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function $o(t){const e=t.name;if(Jp.has(e))return Vi.debug(`There were multiple attempts to register component ${e}.`),!1;Jp.set(e,t);for(const n of fh.values())Fb(n,t);for(const n of CI.values())Fb(n,t);return!0}function Ug(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Tr(t){return t==null?!1:t.settings!==void 0}const RI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Is=new Zc("app","Firebase",RI);class DI{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ia("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Is.create("app-deleted",{appName:this._name})}}const cl=TI;function lS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:Xp,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Is.create("bad-app-name",{appName:String(a)});if(n||(n=nS()),!n)throw Is.create("no-options");const l=fh.get(a);if(l){if(Ns(n,l.options)&&Ns(i,l.config))return l;throw Is.create("duplicate-app",{appName:a})}const c=new ND(a);for(const f of Jp.values())c.addComponent(f);const d=new DI(n,i,c);return fh.set(a,d),d}function cS(t=Xp){const e=fh.get(t);if(!e&&t===Xp&&nS())return lS();if(!e)throw Is.create("no-app",{appName:t});return e}function js(t,e,n){let i=AI[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vi.warn(c.join(" "));return}$o(new Ia(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const II="firebase-heartbeat-database",jI=1,Fc="firebase-heartbeat-store";let Ap=null;function uS(){return Ap||(Ap=$D(II,jI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Fc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Is.create("idb-open",{originalErrorMessage:t.message})})),Ap}async function OI(t){try{const n=(await uS()).transaction(Fc),i=await n.objectStore(Fc).get(dS(t));return await n.done,i}catch(e){if(e instanceof qi)Vi.warn(e.message);else{const n=Is.create("idb-get",{originalErrorMessage:e?.message});Vi.warn(n.message)}}}async function qb(t,e){try{const i=(await uS()).transaction(Fc,"readwrite");await i.objectStore(Fc).put(e,dS(t)),await i.done}catch(n){if(n instanceof qi)Vi.warn(n.message);else{const i=Is.create("idb-set",{originalErrorMessage:n?.message});Vi.warn(i.message)}}}function dS(t){return`${t.name}!${t.options.appId}`}const MI=1024,kI=30;class NI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new LI(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Qb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>kI){const a=VI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Vi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Qb(),{heartbeatsToSend:n,unsentEntries:i}=PI(this._heartbeatsCache.heartbeats),a=hh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Vi.warn(e),""}}}function Qb(){return new Date().toISOString().substring(0,10)}function PI(t,e=MI){const n=[];let i=t.slice();for(const a of t){const l=n.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),Gb(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Gb(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class LI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return SD()?wD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await OI(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return qb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return qb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Gb(t){return hh(JSON.stringify({version:2,heartbeats:t})).length}function VI(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function BI(t){$o(new Ia("platform-logger",e=>new XD(e),"PRIVATE")),$o(new Ia("heartbeat",e=>new NI(e),"PRIVATE")),js(Yp,zb,t),js(Yp,zb,"esm2020"),js("fire-js","")}BI("");var Hb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Os,hS;(function(){var t;function e(O,C){function R(){}R.prototype=C.prototype,O.F=C.prototype,O.prototype=new R,O.prototype.constructor=O,O.D=function(N,j,U){for(var M=Array(arguments.length-2),W=2;W<arguments.length;W++)M[W-2]=arguments[W];return C.prototype[j].apply(N,M)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(O,C,R){R||(R=0);const N=Array(16);if(typeof C=="string")for(var j=0;j<16;++j)N[j]=C.charCodeAt(R++)|C.charCodeAt(R++)<<8|C.charCodeAt(R++)<<16|C.charCodeAt(R++)<<24;else for(j=0;j<16;++j)N[j]=C[R++]|C[R++]<<8|C[R++]<<16|C[R++]<<24;C=O.g[0],R=O.g[1],j=O.g[2];let U=O.g[3],M;M=C+(U^R&(j^U))+N[0]+3614090360&4294967295,C=R+(M<<7&4294967295|M>>>25),M=U+(j^C&(R^j))+N[1]+3905402710&4294967295,U=C+(M<<12&4294967295|M>>>20),M=j+(R^U&(C^R))+N[2]+606105819&4294967295,j=U+(M<<17&4294967295|M>>>15),M=R+(C^j&(U^C))+N[3]+3250441966&4294967295,R=j+(M<<22&4294967295|M>>>10),M=C+(U^R&(j^U))+N[4]+4118548399&4294967295,C=R+(M<<7&4294967295|M>>>25),M=U+(j^C&(R^j))+N[5]+1200080426&4294967295,U=C+(M<<12&4294967295|M>>>20),M=j+(R^U&(C^R))+N[6]+2821735955&4294967295,j=U+(M<<17&4294967295|M>>>15),M=R+(C^j&(U^C))+N[7]+4249261313&4294967295,R=j+(M<<22&4294967295|M>>>10),M=C+(U^R&(j^U))+N[8]+1770035416&4294967295,C=R+(M<<7&4294967295|M>>>25),M=U+(j^C&(R^j))+N[9]+2336552879&4294967295,U=C+(M<<12&4294967295|M>>>20),M=j+(R^U&(C^R))+N[10]+4294925233&4294967295,j=U+(M<<17&4294967295|M>>>15),M=R+(C^j&(U^C))+N[11]+2304563134&4294967295,R=j+(M<<22&4294967295|M>>>10),M=C+(U^R&(j^U))+N[12]+1804603682&4294967295,C=R+(M<<7&4294967295|M>>>25),M=U+(j^C&(R^j))+N[13]+4254626195&4294967295,U=C+(M<<12&4294967295|M>>>20),M=j+(R^U&(C^R))+N[14]+2792965006&4294967295,j=U+(M<<17&4294967295|M>>>15),M=R+(C^j&(U^C))+N[15]+1236535329&4294967295,R=j+(M<<22&4294967295|M>>>10),M=C+(j^U&(R^j))+N[1]+4129170786&4294967295,C=R+(M<<5&4294967295|M>>>27),M=U+(R^j&(C^R))+N[6]+3225465664&4294967295,U=C+(M<<9&4294967295|M>>>23),M=j+(C^R&(U^C))+N[11]+643717713&4294967295,j=U+(M<<14&4294967295|M>>>18),M=R+(U^C&(j^U))+N[0]+3921069994&4294967295,R=j+(M<<20&4294967295|M>>>12),M=C+(j^U&(R^j))+N[5]+3593408605&4294967295,C=R+(M<<5&4294967295|M>>>27),M=U+(R^j&(C^R))+N[10]+38016083&4294967295,U=C+(M<<9&4294967295|M>>>23),M=j+(C^R&(U^C))+N[15]+3634488961&4294967295,j=U+(M<<14&4294967295|M>>>18),M=R+(U^C&(j^U))+N[4]+3889429448&4294967295,R=j+(M<<20&4294967295|M>>>12),M=C+(j^U&(R^j))+N[9]+568446438&4294967295,C=R+(M<<5&4294967295|M>>>27),M=U+(R^j&(C^R))+N[14]+3275163606&4294967295,U=C+(M<<9&4294967295|M>>>23),M=j+(C^R&(U^C))+N[3]+4107603335&4294967295,j=U+(M<<14&4294967295|M>>>18),M=R+(U^C&(j^U))+N[8]+1163531501&4294967295,R=j+(M<<20&4294967295|M>>>12),M=C+(j^U&(R^j))+N[13]+2850285829&4294967295,C=R+(M<<5&4294967295|M>>>27),M=U+(R^j&(C^R))+N[2]+4243563512&4294967295,U=C+(M<<9&4294967295|M>>>23),M=j+(C^R&(U^C))+N[7]+1735328473&4294967295,j=U+(M<<14&4294967295|M>>>18),M=R+(U^C&(j^U))+N[12]+2368359562&4294967295,R=j+(M<<20&4294967295|M>>>12),M=C+(R^j^U)+N[5]+4294588738&4294967295,C=R+(M<<4&4294967295|M>>>28),M=U+(C^R^j)+N[8]+2272392833&4294967295,U=C+(M<<11&4294967295|M>>>21),M=j+(U^C^R)+N[11]+1839030562&4294967295,j=U+(M<<16&4294967295|M>>>16),M=R+(j^U^C)+N[14]+4259657740&4294967295,R=j+(M<<23&4294967295|M>>>9),M=C+(R^j^U)+N[1]+2763975236&4294967295,C=R+(M<<4&4294967295|M>>>28),M=U+(C^R^j)+N[4]+1272893353&4294967295,U=C+(M<<11&4294967295|M>>>21),M=j+(U^C^R)+N[7]+4139469664&4294967295,j=U+(M<<16&4294967295|M>>>16),M=R+(j^U^C)+N[10]+3200236656&4294967295,R=j+(M<<23&4294967295|M>>>9),M=C+(R^j^U)+N[13]+681279174&4294967295,C=R+(M<<4&4294967295|M>>>28),M=U+(C^R^j)+N[0]+3936430074&4294967295,U=C+(M<<11&4294967295|M>>>21),M=j+(U^C^R)+N[3]+3572445317&4294967295,j=U+(M<<16&4294967295|M>>>16),M=R+(j^U^C)+N[6]+76029189&4294967295,R=j+(M<<23&4294967295|M>>>9),M=C+(R^j^U)+N[9]+3654602809&4294967295,C=R+(M<<4&4294967295|M>>>28),M=U+(C^R^j)+N[12]+3873151461&4294967295,U=C+(M<<11&4294967295|M>>>21),M=j+(U^C^R)+N[15]+530742520&4294967295,j=U+(M<<16&4294967295|M>>>16),M=R+(j^U^C)+N[2]+3299628645&4294967295,R=j+(M<<23&4294967295|M>>>9),M=C+(j^(R|~U))+N[0]+4096336452&4294967295,C=R+(M<<6&4294967295|M>>>26),M=U+(R^(C|~j))+N[7]+1126891415&4294967295,U=C+(M<<10&4294967295|M>>>22),M=j+(C^(U|~R))+N[14]+2878612391&4294967295,j=U+(M<<15&4294967295|M>>>17),M=R+(U^(j|~C))+N[5]+4237533241&4294967295,R=j+(M<<21&4294967295|M>>>11),M=C+(j^(R|~U))+N[12]+1700485571&4294967295,C=R+(M<<6&4294967295|M>>>26),M=U+(R^(C|~j))+N[3]+2399980690&4294967295,U=C+(M<<10&4294967295|M>>>22),M=j+(C^(U|~R))+N[10]+4293915773&4294967295,j=U+(M<<15&4294967295|M>>>17),M=R+(U^(j|~C))+N[1]+2240044497&4294967295,R=j+(M<<21&4294967295|M>>>11),M=C+(j^(R|~U))+N[8]+1873313359&4294967295,C=R+(M<<6&4294967295|M>>>26),M=U+(R^(C|~j))+N[15]+4264355552&4294967295,U=C+(M<<10&4294967295|M>>>22),M=j+(C^(U|~R))+N[6]+2734768916&4294967295,j=U+(M<<15&4294967295|M>>>17),M=R+(U^(j|~C))+N[13]+1309151649&4294967295,R=j+(M<<21&4294967295|M>>>11),M=C+(j^(R|~U))+N[4]+4149444226&4294967295,C=R+(M<<6&4294967295|M>>>26),M=U+(R^(C|~j))+N[11]+3174756917&4294967295,U=C+(M<<10&4294967295|M>>>22),M=j+(C^(U|~R))+N[2]+718787259&4294967295,j=U+(M<<15&4294967295|M>>>17),M=R+(U^(j|~C))+N[9]+3951481745&4294967295,O.g[0]=O.g[0]+C&4294967295,O.g[1]=O.g[1]+(j+(M<<21&4294967295|M>>>11))&4294967295,O.g[2]=O.g[2]+j&4294967295,O.g[3]=O.g[3]+U&4294967295}i.prototype.v=function(O,C){C===void 0&&(C=O.length);const R=C-this.blockSize,N=this.C;let j=this.h,U=0;for(;U<C;){if(j==0)for(;U<=R;)a(this,O,U),U+=this.blockSize;if(typeof O=="string"){for(;U<C;)if(N[j++]=O.charCodeAt(U++),j==this.blockSize){a(this,N),j=0;break}}else for(;U<C;)if(N[j++]=O[U++],j==this.blockSize){a(this,N),j=0;break}}this.h=j,this.o+=C},i.prototype.A=function(){var O=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);O[0]=128;for(var C=1;C<O.length-8;++C)O[C]=0;C=this.o*8;for(var R=O.length-8;R<O.length;++R)O[R]=C&255,C/=256;for(this.v(O),O=Array(16),C=0,R=0;R<4;++R)for(let N=0;N<32;N+=8)O[C++]=this.g[R]>>>N&255;return O};function l(O,C){var R=d;return Object.prototype.hasOwnProperty.call(R,O)?R[O]:R[O]=C(O)}function c(O,C){this.h=C;const R=[];let N=!0;for(let j=O.length-1;j>=0;j--){const U=O[j]|0;N&&U==C||(R[j]=U,N=!1)}this.g=R}var d={};function f(O){return-128<=O&&O<128?l(O,function(C){return new c([C|0],C<0?-1:0)}):new c([O|0],O<0?-1:0)}function p(O){if(isNaN(O)||!isFinite(O))return v;if(O<0)return I(p(-O));const C=[];let R=1;for(let N=0;O>=R;N++)C[N]=O/R|0,R*=4294967296;return new c(C,0)}function _(O,C){if(O.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(O.charAt(0)=="-")return I(_(O.substring(1),C));if(O.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=p(Math.pow(C,8));let N=v;for(let U=0;U<O.length;U+=8){var j=Math.min(8,O.length-U);const M=parseInt(O.substring(U,U+j),C);j<8?(j=p(Math.pow(C,j)),N=N.j(j).add(p(M))):(N=N.j(R),N=N.add(p(M)))}return N}var v=f(0),b=f(1),T=f(16777216);t=c.prototype,t.m=function(){if(A(this))return-I(this).m();let O=0,C=1;for(let R=0;R<this.g.length;R++){const N=this.i(R);O+=(N>=0?N:4294967296+N)*C,C*=4294967296}return O},t.toString=function(O){if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(w(this))return"0";if(A(this))return"-"+I(this).toString(O);const C=p(Math.pow(O,6));var R=this;let N="";for(;;){const j=X(R,C).g;R=P(R,j.j(C));let U=((R.g.length>0?R.g[0]:R.h)>>>0).toString(O);if(R=j,w(R))return U+N;for(;U.length<6;)U="0"+U;N=U+N}},t.i=function(O){return O<0?0:O<this.g.length?this.g[O]:this.h};function w(O){if(O.h!=0)return!1;for(let C=0;C<O.g.length;C++)if(O.g[C]!=0)return!1;return!0}function A(O){return O.h==-1}t.l=function(O){return O=P(this,O),A(O)?-1:w(O)?0:1};function I(O){const C=O.g.length,R=[];for(let N=0;N<C;N++)R[N]=~O.g[N];return new c(R,~O.h).add(b)}t.abs=function(){return A(this)?I(this):this},t.add=function(O){const C=Math.max(this.g.length,O.g.length),R=[];let N=0;for(let j=0;j<=C;j++){let U=N+(this.i(j)&65535)+(O.i(j)&65535),M=(U>>>16)+(this.i(j)>>>16)+(O.i(j)>>>16);N=M>>>16,U&=65535,M&=65535,R[j]=M<<16|U}return new c(R,R[R.length-1]&-2147483648?-1:0)};function P(O,C){return O.add(I(C))}t.j=function(O){if(w(this)||w(O))return v;if(A(this))return A(O)?I(this).j(I(O)):I(I(this).j(O));if(A(O))return I(this.j(I(O)));if(this.l(T)<0&&O.l(T)<0)return p(this.m()*O.m());const C=this.g.length+O.g.length,R=[];for(var N=0;N<2*C;N++)R[N]=0;for(N=0;N<this.g.length;N++)for(let j=0;j<O.g.length;j++){const U=this.i(N)>>>16,M=this.i(N)&65535,W=O.i(j)>>>16,H=O.i(j)&65535;R[2*N+2*j]+=M*H,G(R,2*N+2*j),R[2*N+2*j+1]+=U*H,G(R,2*N+2*j+1),R[2*N+2*j+1]+=M*W,G(R,2*N+2*j+1),R[2*N+2*j+2]+=U*W,G(R,2*N+2*j+2)}for(O=0;O<C;O++)R[O]=R[2*O+1]<<16|R[2*O];for(O=C;O<2*C;O++)R[O]=0;return new c(R,0)};function G(O,C){for(;(O[C]&65535)!=O[C];)O[C+1]+=O[C]>>>16,O[C]&=65535,C++}function Q(O,C){this.g=O,this.h=C}function X(O,C){if(w(C))throw Error("division by zero");if(w(O))return new Q(v,v);if(A(O))return C=X(I(O),C),new Q(I(C.g),I(C.h));if(A(C))return C=X(O,I(C)),new Q(I(C.g),C.h);if(O.g.length>30){if(A(O)||A(C))throw Error("slowDivide_ only works with positive integers.");for(var R=b,N=C;N.l(O)<=0;)R=Z(R),N=Z(N);var j=oe(R,1),U=oe(N,1);for(N=oe(N,2),R=oe(R,2);!w(N);){var M=U.add(N);M.l(O)<=0&&(j=j.add(R),U=M),N=oe(N,1),R=oe(R,1)}return C=P(O,j.j(C)),new Q(j,C)}for(j=v;O.l(C)>=0;){for(R=Math.max(1,Math.floor(O.m()/C.m())),N=Math.ceil(Math.log(R)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),U=p(R),M=U.j(C);A(M)||M.l(O)>0;)R-=N,U=p(R),M=U.j(C);w(U)&&(U=b),j=j.add(U),O=P(O,M)}return new Q(j,O)}t.B=function(O){return X(this,O).h},t.and=function(O){const C=Math.max(this.g.length,O.g.length),R=[];for(let N=0;N<C;N++)R[N]=this.i(N)&O.i(N);return new c(R,this.h&O.h)},t.or=function(O){const C=Math.max(this.g.length,O.g.length),R=[];for(let N=0;N<C;N++)R[N]=this.i(N)|O.i(N);return new c(R,this.h|O.h)},t.xor=function(O){const C=Math.max(this.g.length,O.g.length),R=[];for(let N=0;N<C;N++)R[N]=this.i(N)^O.i(N);return new c(R,this.h^O.h)};function Z(O){const C=O.g.length+1,R=[];for(let N=0;N<C;N++)R[N]=O.i(N)<<1|O.i(N-1)>>>31;return new c(R,O.h)}function oe(O,C){const R=C>>5;C%=32;const N=O.g.length-R,j=[];for(let U=0;U<N;U++)j[U]=C>0?O.i(U+R)>>>C|O.i(U+R+1)<<32-C:O.i(U+R);return new c(j,O.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,hS=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=_,Os=c}).apply(typeof Hb<"u"?Hb:typeof self<"u"?self:typeof window<"u"?window:{});var Qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var fS,Ic,mS,Zd,Zp,pS,gS,yS;(function(){var t,e=Object.defineProperty;function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qd=="object"&&Qd];for(var E=0;E<m.length;++E){var S=m[E];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=n(this);function a(m,E){if(E)e:{var S=i;m=m.split(".");for(var L=0;L<m.length-1;L++){var re=m[L];if(!(re in S))break e;S=S[re]}m=m[m.length-1],L=S[m],E=E(L),E!=L&&E!=null&&e(S,m,{configurable:!0,writable:!0,value:E})}}a("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(m){return m||function(E){var S=[],L;for(L in E)Object.prototype.hasOwnProperty.call(E,L)&&S.push([L,E[L]]);return S}});var l=l||{},c=this||self;function d(m){var E=typeof m;return E=="object"&&m!=null||E=="function"}function f(m,E,S){return m.call.apply(m.bind,arguments)}function p(m,E,S){return p=f,p.apply(null,arguments)}function _(m,E){var S=Array.prototype.slice.call(arguments,1);return function(){var L=S.slice();return L.push.apply(L,arguments),m.apply(this,L)}}function v(m,E){function S(){}S.prototype=E.prototype,m.Z=E.prototype,m.prototype=new S,m.prototype.constructor=m,m.Ob=function(L,re,ue){for(var xe=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)xe[Be-2]=arguments[Be];return E.prototype[re].apply(L,xe)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function T(m){const E=m.length;if(E>0){const S=Array(E);for(let L=0;L<E;L++)S[L]=m[L];return S}return[]}function w(m,E){for(let L=1;L<arguments.length;L++){const re=arguments[L];var S=typeof re;if(S=S!="object"?S:re?Array.isArray(re)?"array":S:"null",S=="array"||S=="object"&&typeof re.length=="number"){S=m.length||0;const ue=re.length||0;m.length=S+ue;for(let xe=0;xe<ue;xe++)m[S+xe]=re[xe]}else m.push(re)}}class A{constructor(E,S){this.i=E,this.j=S,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function I(m){c.setTimeout(()=>{throw m},0)}function P(){var m=O;let E=null;return m.g&&(E=m.g,m.g=m.g.next,m.g||(m.h=null),E.next=null),E}class G{constructor(){this.h=this.g=null}add(E,S){const L=Q.get();L.set(E,S),this.h?this.h.next=L:this.g=L,this.h=L}}var Q=new A(()=>new X,m=>m.reset());class X{constructor(){this.next=this.g=this.h=null}set(E,S){this.h=E,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,oe=!1,O=new G,C=()=>{const m=Promise.resolve(void 0);Z=()=>{m.then(R)}};function R(){for(var m;m=P();){try{m.h.call(m.g)}catch(S){I(S)}var E=Q;E.j(m),E.h<100&&(E.h++,m.next=E.g,E.g=m)}oe=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(m,E){this.type=m,this.g=this.target=E,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var U=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var m=!1,E=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const S=()=>{};c.addEventListener("test",S,E),c.removeEventListener("test",S,E)}catch{}return m})();function M(m){return/^[\s\xa0]*$/.test(m)}function W(m,E){j.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,E)}v(W,j),W.prototype.init=function(m,E){const S=this.type=m.type,L=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=E,E=m.relatedTarget,E||(S=="mouseover"?E=m.fromElement:S=="mouseout"&&(E=m.toElement)),this.relatedTarget=E,L?(this.clientX=L.clientX!==void 0?L.clientX:L.pageX,this.clientY=L.clientY!==void 0?L.clientY:L.pageY,this.screenX=L.screenX||0,this.screenY=L.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&W.Z.h.call(this)},W.prototype.h=function(){W.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var H="closure_listenable_"+(Math.random()*1e6|0),B=0;function z(m,E,S,L,re){this.listener=m,this.proxy=null,this.src=E,this.type=S,this.capture=!!L,this.ha=re,this.key=++B,this.da=this.fa=!1}function F(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function $(m,E,S){for(const L in m)E.call(S,m[L],L,m)}function te(m,E){for(const S in m)E.call(void 0,m[S],S,m)}function V(m){const E={};for(const S in m)E[S]=m[S];return E}const q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ne(m,E){let S,L;for(let re=1;re<arguments.length;re++){L=arguments[re];for(S in L)m[S]=L[S];for(let ue=0;ue<q.length;ue++)S=q[ue],Object.prototype.hasOwnProperty.call(L,S)&&(m[S]=L[S])}}function ee(m){this.src=m,this.g={},this.h=0}ee.prototype.add=function(m,E,S,L,re){const ue=m.toString();m=this.g[ue],m||(m=this.g[ue]=[],this.h++);const xe=be(m,E,L,re);return xe>-1?(E=m[xe],S||(E.fa=!1)):(E=new z(E,this.src,ue,!!L,re),E.fa=S,m.push(E)),E};function ce(m,E){const S=E.type;if(S in m.g){var L=m.g[S],re=Array.prototype.indexOf.call(L,E,void 0),ue;(ue=re>=0)&&Array.prototype.splice.call(L,re,1),ue&&(F(E),m.g[S].length==0&&(delete m.g[S],m.h--))}}function be(m,E,S,L){for(let re=0;re<m.length;++re){const ue=m[re];if(!ue.da&&ue.listener==E&&ue.capture==!!S&&ue.ha==L)return re}return-1}var Ee="closure_lm_"+(Math.random()*1e6|0),ve={};function Se(m,E,S,L,re){if(Array.isArray(E)){for(let ue=0;ue<E.length;ue++)Se(m,E[ue],S,L,re);return null}return S=Ct(S),m&&m[H]?m.J(E,S,d(L)?!!L.capture:!1,re):fe(m,E,S,!1,L,re)}function fe(m,E,S,L,re,ue){if(!E)throw Error("Invalid event type");const xe=d(re)?!!re.capture:!!re;let Be=Or(m);if(Be||(m[Ee]=Be=new ee(m)),S=Be.add(E,S,L,xe,ue),S.proxy)return S;if(L=Ze(),S.proxy=L,L.src=m,L.listener=S,m.addEventListener)U||(re=xe),re===void 0&&(re=!1),m.addEventListener(E.toString(),L,re);else if(m.attachEvent)m.attachEvent(An(E.toString()),L);else if(m.addListener&&m.removeListener)m.addListener(L);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Ze(){function m(S){return E.call(m.src,m.listener,S)}const E=jr;return m}function Fe(m,E,S,L,re){if(Array.isArray(E))for(var ue=0;ue<E.length;ue++)Fe(m,E[ue],S,L,re);else L=d(L)?!!L.capture:!!L,S=Ct(S),m&&m[H]?(m=m.i,ue=String(E).toString(),ue in m.g&&(E=m.g[ue],S=be(E,S,L,re),S>-1&&(F(E[S]),Array.prototype.splice.call(E,S,1),E.length==0&&(delete m.g[ue],m.h--)))):m&&(m=Or(m))&&(E=m.g[E.toString()],m=-1,E&&(m=be(E,S,L,re)),(S=m>-1?E[m]:null)&&on(S))}function on(m){if(typeof m!="number"&&m&&!m.da){var E=m.src;if(E&&E[H])ce(E.i,m);else{var S=m.type,L=m.proxy;E.removeEventListener?E.removeEventListener(S,L,m.capture):E.detachEvent?E.detachEvent(An(S),L):E.addListener&&E.removeListener&&E.removeListener(L),(S=Or(E))?(ce(S,m),S.h==0&&(S.src=null,E[Ee]=null)):F(m)}}}function An(m){return m in ve?ve[m]:ve[m]="on"+m}function jr(m,E){if(m.da)m=!0;else{E=new W(E,this);const S=m.listener,L=m.ha||m.src;m.fa&&on(m),m=S.call(L,E)}return m}function Or(m){return m=m[Ee],m instanceof ee?m:null}var Ws="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ct(m){return typeof m=="function"?m:(m[Ws]||(m[Ws]=function(E){return m.handleEvent(E)}),m[Ws])}function st(){N.call(this),this.i=new ee(this),this.M=this,this.G=null}v(st,N),st.prototype[H]=!0,st.prototype.removeEventListener=function(m,E,S,L){Fe(this,m,E,S,L)};function St(m,E){var S,L=m.G;if(L)for(S=[];L;L=L.G)S.push(L);if(m=m.M,L=E.type||E,typeof E=="string")E=new j(E,m);else if(E instanceof j)E.target=E.target||m;else{var re=E;E=new j(L,m),ne(E,re)}re=!0;let ue,xe;if(S)for(xe=S.length-1;xe>=0;xe--)ue=E.g=S[xe],re=$n(ue,L,!0,E)&&re;if(ue=E.g=m,re=$n(ue,L,!0,E)&&re,re=$n(ue,L,!1,E)&&re,S)for(xe=0;xe<S.length;xe++)ue=E.g=S[xe],re=$n(ue,L,!1,E)&&re}st.prototype.N=function(){if(st.Z.N.call(this),this.i){var m=this.i;for(const E in m.g){const S=m.g[E];for(let L=0;L<S.length;L++)F(S[L]);delete m.g[E],m.h--}}this.G=null},st.prototype.J=function(m,E,S,L){return this.i.add(String(m),E,!1,S,L)},st.prototype.K=function(m,E,S,L){return this.i.add(String(m),E,!0,S,L)};function $n(m,E,S,L){if(E=m.i.g[String(E)],!E)return!0;E=E.concat();let re=!0;for(let ue=0;ue<E.length;++ue){const xe=E[ue];if(xe&&!xe.da&&xe.capture==S){const Be=xe.listener,jt=xe.ha||xe.src;xe.fa&&ce(m.i,xe),re=Be.call(jt,L)!==!1&&re}}return re&&!L.defaultPrevented}function xl(m,E){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=p(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:c.setTimeout(m,E||0)}function hr(m){m.g=xl(()=>{m.g=null,m.i&&(m.i=!1,hr(m))},m.l);const E=m.h;m.h=null,m.m.apply(null,E)}class $t extends N{constructor(E,S){super(),this.m=E,this.l=S,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:hr(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ys(m){N.call(this),this.h=m,this.g={}}v(Ys,N);var Sl=[];function wl(m){$(m.g,function(E,S){this.g.hasOwnProperty(S)&&on(E)},m),m.g={}}Ys.prototype.N=function(){Ys.Z.N.call(this),wl(this)},Ys.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Qi=c.JSON.stringify,gf=c.JSON.parse,mu=class{stringify(m){return c.JSON.stringify(m,void 0)}parse(m){return c.JSON.parse(m,void 0)}};function pu(){}function gu(){}var fr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ln(){j.call(this,"d")}v(ln,j);function Wn(){j.call(this,"c")}v(Wn,j);var It={},yu=null;function za(){return yu=yu||new st}It.Ia="serverreachability";function _u(m){j.call(this,It.Ia,m)}v(_u,j);function Mr(m){const E=za();St(E,new _u(E))}It.STAT_EVENT="statevent";function Xs(m,E){j.call(this,It.STAT_EVENT,m),this.stat=E}v(Xs,j);function Pt(m){const E=za();St(E,new Xs(E,m))}It.Ja="timingevent";function kr(m,E){j.call(this,It.Ja,m),this.size=E}v(kr,j);function Nr(m,E){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){m()},E)}function mr(){this.g=!0}mr.prototype.ua=function(){this.g=!1};function yf(m,E,S,L,re,ue){m.info(function(){if(m.g)if(ue){var xe="",Be=ue.split("&");for(let nt=0;nt<Be.length;nt++){var jt=Be[nt].split("=");if(jt.length>1){const bt=jt[0];jt=jt[1];const Zn=bt.split("_");xe=Zn.length>=2&&Zn[1]=="type"?xe+(bt+"="+jt+"&"):xe+(bt+"=redacted&")}}}else xe=null;else xe=ue;return"XMLHTTP REQ ("+L+") [attempt "+re+"]: "+E+`
`+S+`
`+xe})}function vu(m,E,S,L,re,ue,xe){m.info(function(){return"XMLHTTP RESP ("+L+") [ attempt "+re+"]: "+E+`
`+S+`
`+ue+" "+xe})}function Pr(m,E,S,L){m.info(function(){return"XMLHTTP TEXT ("+E+"): "+_f(m,S)+(L?" "+L:"")})}function Js(m,E){m.info(function(){return"TIMEOUT: "+E})}mr.prototype.info=function(){};function _f(m,E){if(!m.g)return E;if(!E)return null;try{const ue=JSON.parse(E);if(ue){for(m=0;m<ue.length;m++)if(Array.isArray(ue[m])){var S=ue[m];if(!(S.length<2)){var L=S[1];if(Array.isArray(L)&&!(L.length<1)){var re=L[0];if(re!="noop"&&re!="stop"&&re!="close")for(let xe=1;xe<L.length;xe++)L[xe]=""}}}}return Qi(ue)}catch{return E}}var Zs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Tl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Al;function ea(){}v(ea,pu),ea.prototype.g=function(){return new XMLHttpRequest},Al=new ea;function fi(m){return encodeURIComponent(String(m))}function bu(m){var E=1;m=m.split(":");const S=[];for(;E>0&&m.length;)S.push(m.shift()),E--;return m.length&&S.push(m.join(":")),S}function pr(m,E,S,L){this.j=m,this.i=E,this.l=S,this.S=L||1,this.V=new Ys(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new gr}function gr(){this.i=null,this.g="",this.h=!1}var Lt={},en={};function Lr(m,E,S){m.M=1,m.A=ta(Bt(E)),m.u=S,m.R=!0,Fa(m,null)}function Fa(m,E){m.F=Date.now(),Vr(m),m.B=Bt(m.A);var S=m.B,L=m.S;Array.isArray(L)||(L=[String(L)]),Ha(S.i,"t",L),m.C=0,S=m.j.L,m.h=new gr,m.g=Nu(m.j,S?E:null,!m.u),m.P>0&&(m.O=new $t(p(m.Y,m,m.g),m.P)),E=m.V,S=m.g,L=m.ba;var re="readystatechange";Array.isArray(re)||(re&&(Sl[0]=re.toString()),re=Sl);for(let ue=0;ue<re.length;ue++){const xe=Se(S,re[ue],L||E.handleEvent,!1,E.h||E);if(!xe)break;E.g[xe.key]=xe}E=m.J?V(m.J):{},m.u?(m.v||(m.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,E)):(m.v="GET",m.g.ea(m.B,m.v,null,E)),Mr(),yf(m.i,m.v,m.B,m.l,m.S,m.u)}pr.prototype.ba=function(m){m=m.target;const E=this.O;E&&vr(m)==3?E.j():this.Y(m)},pr.prototype.Y=function(m){try{if(m==this.g)e:{const Be=vr(this.g),jt=this.g.ya(),nt=this.g.ca();if(!(Be<3)&&(Be!=3||this.g&&(this.h.h||this.g.la()||cn(this.g)))){this.K||Be!=4||jt==7||(jt==8||nt<=0?Mr(3):Mr(2)),Br(this);var E=this.g.ca();this.X=E;var S=vf(this);if(this.o=E==200,vu(this.i,this.v,this.B,this.l,this.S,Be,E),this.o){if(this.U&&!this.L){t:{if(this.g){var L,re=this.g;if((L=re.g?re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(L)){var ue=L;break t}}ue=null}if(m=ue)Pr(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ur(this,m);else{this.o=!1,this.m=3,Pt(12),Ln(this),Yn(this);break e}}if(this.R){m=!0;let bt;for(;!this.K&&this.C<S.length;)if(bt=xu(this,S),bt==en){Be==4&&(this.m=4,Pt(14),m=!1),Pr(this.i,this.l,null,"[Incomplete Response]");break}else if(bt==Lt){this.m=4,Pt(15),Pr(this.i,this.l,S,"[Invalid Chunk]"),m=!1;break}else Pr(this.i,this.l,bt,null),Ur(this,bt);if(Eu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Be!=4||S.length!=0||this.h.h||(this.m=1,Pt(16),m=!1),this.o=this.o&&m,!m)Pr(this.i,this.l,S,"[Invalid Chunked Response]"),Ln(this),Yn(this);else if(S.length>0&&!this.W){this.W=!0;var xe=this.j;xe.g==this&&xe.aa&&!xe.P&&(xe.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),zl(xe),xe.P=!0,Pt(11))}}else Pr(this.i,this.l,S,null),Ur(this,S);Be==4&&Ln(this),this.o&&!this.K&&(Be==4?ju(this.j,this):(this.o=!1,Vr(this)))}else pi(this.g),E==400&&S.indexOf("Unknown SID")>0?(this.m=3,Pt(12)):(this.m=0,Pt(13)),Ln(this),Yn(this)}}}catch{}};function vf(m){if(!Eu(m))return m.g.la();const E=cn(m.g);if(E==="")return"";let S="";const L=E.length,re=vr(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Ln(m),Yn(m),"";m.h.i=new c.TextDecoder}for(let ue=0;ue<L;ue++)m.h.h=!0,S+=m.h.i.decode(E[ue],{stream:!(re&&ue==L-1)});return E.length=0,m.h.g+=S,m.C=0,m.h.g}function Eu(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function xu(m,E){var S=m.C,L=E.indexOf(`
`,S);return L==-1?en:(S=Number(E.substring(S,L)),isNaN(S)?Lt:(L+=1,L+S>E.length?en:(E=E.slice(L,L+S),m.C=L+S,E)))}pr.prototype.cancel=function(){this.K=!0,Ln(this)};function Vr(m){m.T=Date.now()+m.H,qa(m,m.H)}function qa(m,E){if(m.D!=null)throw Error("WatchDog timer not null");m.D=Nr(p(m.aa,m),E)}function Br(m){m.D&&(c.clearTimeout(m.D),m.D=null)}pr.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(Js(this.i,this.B),this.M!=2&&(Mr(),Pt(17)),Ln(this),this.m=2,Yn(this)):qa(this,this.T-m)};function Yn(m){m.j.I==0||m.K||ju(m.j,m)}function Ln(m){Br(m);var E=m.O;E&&typeof E.dispose=="function"&&E.dispose(),m.O=null,wl(m.V),m.g&&(E=m.g,m.g=null,E.abort(),E.dispose())}function Ur(m,E){try{var S=m.j;if(S.I!=0&&(S.g==m||Fr(S.h,m))){if(!m.L&&Fr(S.h,m)&&S.I==3){try{var L=S.Ba.g.parse(E)}catch{L=null}if(Array.isArray(L)&&L.length==3){var re=L;if(re[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<m.F)Xa(S),Ji(S);else break e;la(S),Pt(18)}}else S.xa=re[1],0<S.xa-S.K&&re[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=Nr(p(S.Va,S),6e3));zr(S.h)<=1&&S.ta&&(S.ta=void 0)}else $r(S,11)}else if((m.L||S.g==m)&&Xa(S),!M(E))for(re=S.Ba.g.parse(E),E=0;E<re.length;E++){let nt=re[E];const bt=nt[0];if(!(bt<=S.K))if(S.K=bt,nt=nt[1],S.I==2)if(nt[0]=="c"){S.M=nt[1],S.ba=nt[2];const Zn=nt[3];Zn!=null&&(S.ka=Zn,S.j.info("VER="+S.ka));const Wr=nt[4];Wr!=null&&(S.za=Wr,S.j.info("SVER="+S.za));const br=nt[5];br!=null&&typeof br=="number"&&br>0&&(L=1.5*br,S.O=L,S.j.info("backChannelRequestTimeoutMs_="+L)),L=S;const Er=m.g;if(Er){const ca=Er.g?Er.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ca){var ue=L.h;ue.g||ca.indexOf("spdy")==-1&&ca.indexOf("quic")==-1&&ca.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(Dl(ue,ue.h),ue.h=null))}if(L.G){const Ja=Er.g?Er.g.getResponseHeader("X-HTTP-Session-Id"):null;Ja&&(L.wa=Ja,ot(L.J,L.G,Ja))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-m.F,S.j.info("Handshake RTT: "+S.T+"ms")),L=S;var xe=m;if(L.na=ku(L,L.L?L.ba:null,L.W),xe.L){Il(L.h,xe);var Be=xe,jt=L.O;jt&&(Be.H=jt),Be.D&&(Br(Be),Vr(Be)),L.g=xe}else Du(L);S.i.length>0&&Kr(S)}else nt[0]!="stop"&&nt[0]!="close"||$r(S,7);else S.I==3&&(nt[0]=="stop"||nt[0]=="close"?nt[0]=="stop"?$r(S,7):Bl(S):nt[0]!="noop"&&S.l&&S.l.qa(nt),S.A=0)}}Mr(4)}catch{}}var Vt=class{constructor(m,E){this.g=m,this.map=E}};function Cl(m){this.l=m||10,c.PerformanceNavigationTiming?(m=c.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Rl(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function zr(m){return m.h?1:m.g?m.g.size:0}function Fr(m,E){return m.h?m.h==E:m.g?m.g.has(E):!1}function Dl(m,E){m.g?m.g.add(E):m.h=E}function Il(m,E){m.h&&m.h==E?m.h=null:m.g&&m.g.has(E)&&m.g.delete(E)}Cl.prototype.cancel=function(){if(this.i=jl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function jl(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let E=m.i;for(const S of m.g.values())E=E.concat(S.G);return E}return T(m.i)}var Su=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qa(m,E){if(m){m=m.split("&");for(let S=0;S<m.length;S++){const L=m[S].indexOf("=");let re,ue=null;L>=0?(re=m[S].substring(0,L),ue=m[S].substring(L+1)):re=m[S],E(re,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function Vn(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;m instanceof Vn?(this.l=m.l,tn(this,m.j),this.o=m.o,this.g=m.g,Gi(this,m.u),this.h=m.h,Ol(this,Cu(m.i)),this.m=m.m):m&&(E=String(m).match(Su))?(this.l=!1,tn(this,E[1]||"",!0),this.o=qr(E[2]||""),this.g=qr(E[3]||"",!0),Gi(this,E[4]),this.h=qr(E[5]||"",!0),Ol(this,E[6]||"",!0),this.m=qr(E[7]||"")):(this.l=!1,this.i=new Ki(null,this.l))}Vn.prototype.toString=function(){const m=[];var E=this.j;E&&m.push(na(E,Ga,!0),":");var S=this.g;return(S||E=="file")&&(m.push("//"),(E=this.o)&&m.push(na(E,Ga,!0),"@"),m.push(fi(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&m.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&m.push("/"),m.push(na(S,S.charAt(0)=="/"?Ml:wu,!0))),(S=this.i.toString())&&m.push("?",S),(S=this.m)&&m.push("#",na(S,Tu)),m.join("")},Vn.prototype.resolve=function(m){const E=Bt(this);let S=!!m.j;S?tn(E,m.j):S=!!m.o,S?E.o=m.o:S=!!m.g,S?E.g=m.g:S=m.u!=null;var L=m.h;if(S)Gi(E,m.u);else if(S=!!m.h){if(L.charAt(0)!="/")if(this.g&&!this.h)L="/"+L;else{var re=E.h.lastIndexOf("/");re!=-1&&(L=E.h.slice(0,re+1)+L)}if(re=L,re==".."||re==".")L="";else if(re.indexOf("./")!=-1||re.indexOf("/.")!=-1){L=re.lastIndexOf("/",0)==0,re=re.split("/");const ue=[];for(let xe=0;xe<re.length;){const Be=re[xe++];Be=="."?L&&xe==re.length&&ue.push(""):Be==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),L&&xe==re.length&&ue.push("")):(ue.push(Be),L=!0)}L=ue.join("/")}else L=re}return S?E.h=L:S=m.i.toString()!=="",S?Ol(E,Cu(m.i)):S=!!m.m,S&&(E.m=m.m),E};function Bt(m){return new Vn(m)}function tn(m,E,S){m.j=S?qr(E,!0):E,m.j&&(m.j=m.j.replace(/:$/,""))}function Gi(m,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);m.u=E}else m.u=null}function Ol(m,E,S){E instanceof Ki?(m.i=E,Ka(m.i,m.l)):(S||(E=na(E,Hi)),m.i=new Ki(E,m.l))}function ot(m,E,S){m.i.set(E,S)}function ta(m){return ot(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function qr(m,E){return m?E?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function na(m,E,S){return typeof m=="string"?(m=encodeURI(m).replace(E,Cn),S&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function Cn(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Ga=/[#\/\?@]/g,wu=/[#\?:]/g,Ml=/[#\?]/g,Hi=/[#\?@]/g,Tu=/#/g;function Ki(m,E){this.h=this.g=null,this.i=m||null,this.j=!!E}function Rn(m){m.g||(m.g=new Map,m.h=0,m.i&&Qa(m.i,function(E,S){m.add(decodeURIComponent(E.replace(/\+/g," ")),S)}))}t=Ki.prototype,t.add=function(m,E){Rn(this),this.i=null,m=$i(this,m);let S=this.g.get(m);return S||this.g.set(m,S=[]),S.push(E),this.h+=1,this};function Au(m,E){Rn(m),E=$i(m,E),m.g.has(E)&&(m.i=null,m.h-=m.g.get(E).length,m.g.delete(E))}function kl(m,E){return Rn(m),E=$i(m,E),m.g.has(E)}t.forEach=function(m,E){Rn(this),this.g.forEach(function(S,L){S.forEach(function(re){m.call(E,re,L,this)},this)},this)};function Nl(m,E){Rn(m);let S=[];if(typeof E=="string")kl(m,E)&&(S=S.concat(m.g.get($i(m,E))));else for(m=Array.from(m.g.values()),E=0;E<m.length;E++)S=S.concat(m[E]);return S}t.set=function(m,E){return Rn(this),this.i=null,m=$i(this,m),kl(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[E]),this.h+=1,this},t.get=function(m,E){return m?(m=Nl(this,m),m.length>0?String(m[0]):E):E};function Ha(m,E,S){Au(m,E),S.length>0&&(m.i=null,m.g.set($i(m,E),T(S)),m.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],E=Array.from(this.g.keys());for(let L=0;L<E.length;L++){var S=E[L];const re=fi(S);S=Nl(this,S);for(let ue=0;ue<S.length;ue++){let xe=re;S[ue]!==""&&(xe+="="+fi(S[ue])),m.push(xe)}}return this.i=m.join("&")};function Cu(m){const E=new Ki;return E.i=m.i,m.g&&(E.g=new Map(m.g),E.h=m.h),E}function $i(m,E){return E=String(E),m.j&&(E=E.toLowerCase()),E}function Ka(m,E){E&&!m.j&&(Rn(m),m.i=null,m.g.forEach(function(S,L){const re=L.toLowerCase();L!=re&&(Au(this,L),Ha(this,re,S))},m)),m.j=E}function yr(m,E){const S=new mr;if(c.Image){const L=new Image;L.onload=_(Xn,S,"TestLoadImage: loaded",!0,E,L),L.onerror=_(Xn,S,"TestLoadImage: error",!1,E,L),L.onabort=_(Xn,S,"TestLoadImage: abort",!1,E,L),L.ontimeout=_(Xn,S,"TestLoadImage: timeout",!1,E,L),c.setTimeout(function(){L.ontimeout&&L.ontimeout()},1e4),L.src=m}else E(!1)}function Pl(m,E){const S=new mr,L=new AbortController,re=setTimeout(()=>{L.abort(),Xn(S,"TestPingServer: timeout",!1,E)},1e4);fetch(m,{signal:L.signal}).then(ue=>{clearTimeout(re),ue.ok?Xn(S,"TestPingServer: ok",!0,E):Xn(S,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(re),Xn(S,"TestPingServer: error",!1,E)})}function Xn(m,E,S,L,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),L(S)}catch{}}function Wi(){this.g=new mu}function Qr(m){this.i=m.Sb||null,this.h=m.ab||!1}v(Qr,pu),Qr.prototype.g=function(){return new ra(this.i,this.h)};function ra(m,E){st.call(this),this.H=m,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(ra,st),t=ra.prototype,t.open=function(m,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=E,this.readyState=1,_r(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(E.body=m),(this.H||c).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Yi(this)),this.readyState=0},t.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,_r(this)),this.g&&(this.readyState=3,_r(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;$a(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function $a(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}t.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var E=m.value?m.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!m.done}))&&(this.response=this.responseText+=E)}m.done?Yi(this):_r(this),this.readyState==3&&$a(this)}},t.Oa=function(m){this.g&&(this.response=this.responseText=m,Yi(this))},t.Na=function(m){this.g&&(this.response=m,Yi(this))},t.ga=function(){this.g&&Yi(this)};function Yi(m){m.readyState=4,m.l=null,m.j=null,m.B=null,_r(m)}t.setRequestHeader=function(m,E){this.A.append(m,E)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],E=this.h.entries();for(var S=E.next();!S.done;)S=S.value,m.push(S[0]+": "+S[1]),S=E.next();return m.join(`\r
`)};function _r(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(ra.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Jn(m){let E="";return $(m,function(S,L){E+=L,E+=":",E+=S,E+=`\r
`}),E}function ia(m,E,S){e:{for(L in S){var L=!1;break e}L=!0}L||(S=Jn(S),typeof m=="string"?S!=null&&fi(S):ot(m,E,S))}function ut(m){st.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ut,st);var Gr=/^https?$/i,Ll=["POST","PUT"];t=ut.prototype,t.Fa=function(m){this.H=m},t.ea=function(m,E,S,L){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);E=E?E.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Al.g(),this.g.onreadystatechange=b(p(this.Ca,this));try{this.B=!0,this.g.open(E,String(m),!0),this.B=!1}catch(ue){sa(this,ue);return}if(m=S||"",S=new Map(this.headers),L)if(Object.getPrototypeOf(L)===Object.prototype)for(var re in L)S.set(re,L[re]);else if(typeof L.keys=="function"&&typeof L.get=="function")for(const ue of L.keys())S.set(ue,L.get(ue));else throw Error("Unknown input type for opt_headers: "+String(L));L=Array.from(S.keys()).find(ue=>ue.toLowerCase()=="content-type"),re=c.FormData&&m instanceof c.FormData,!(Array.prototype.indexOf.call(Ll,E,void 0)>=0)||L||re||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,xe]of S)this.g.setRequestHeader(ue,xe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(ue){sa(this,ue)}};function sa(m,E){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=E,m.o=5,Vl(m),mi(m)}function Vl(m){m.A||(m.A=!0,St(m,"complete"),St(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,St(this,"complete"),St(this,"abort"),mi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),mi(this,!0)),ut.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?aa(this):this.Xa())},t.Xa=function(){aa(this)};function aa(m){if(m.h&&typeof l<"u"){if(m.v&&vr(m)==4)setTimeout(m.Ca.bind(m),0);else if(St(m,"readystatechange"),vr(m)==4){m.h=!1;try{const ue=m.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var S;if(!(S=E)){var L;if(L=ue===0){let xe=String(m.D).match(Su)[1]||null;!xe&&c.self&&c.self.location&&(xe=c.self.location.protocol.slice(0,-1)),L=!Gr.test(xe?xe.toLowerCase():"")}S=L}if(S)St(m,"complete"),St(m,"success");else{m.o=6;try{var re=vr(m)>2?m.g.statusText:""}catch{re=""}m.l=re+" ["+m.ca()+"]",Vl(m)}}finally{mi(m)}}}}function mi(m,E){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const S=m.g;m.g=null,E||St(m,"ready");try{S.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function vr(m){return m.g?m.g.readyState:0}t.ca=function(){try{return vr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(m){if(this.g){var E=this.g.responseText;return m&&E.indexOf(m)==0&&(E=E.substring(m.length)),gf(E)}};function cn(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function pi(m){const E={};m=(m.g&&vr(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let L=0;L<m.length;L++){if(M(m[L]))continue;var S=bu(m[L]);const re=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const ue=E[re]||[];E[re]=ue,ue.push(S)}te(E,function(L){return L.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Hr(m,E,S){return S&&S.internalChannelParams&&S.internalChannelParams[m]||E}function Xi(m){this.za=0,this.i=[],this.j=new mr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Hr("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Hr("baseRetryDelayMs",5e3,m),this.Za=Hr("retryDelaySeedMs",1e4,m),this.Ta=Hr("forwardChannelMaxRetries",2,m),this.va=Hr("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Cl(m&&m.concurrentRequestLimit),this.Ba=new Wi,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Xi.prototype,t.ka=8,t.I=1,t.connect=function(m,E,S,L){Pt(0),this.W=m,this.H=E||{},S&&L!==void 0&&(this.H.OSID=S,this.H.OAID=L),this.F=this.X,this.J=ku(this,null,this.W),Kr(this)};function Bl(m){if(Wa(m),m.I==3){var E=m.V++,S=Bt(m.J);if(ot(S,"SID",m.M),ot(S,"RID",E),ot(S,"TYPE","terminate"),oa(m,S),E=new pr(m,m.j,E),E.M=2,E.A=ta(Bt(S)),S=!1,c.navigator&&c.navigator.sendBeacon)try{S=c.navigator.sendBeacon(E.A.toString(),"")}catch{}!S&&c.Image&&(new Image().src=E.A,S=!0),S||(E.g=Nu(E.j,null),E.g.ea(E.A)),E.F=Date.now(),Vr(E)}Mu(m)}function Ji(m){m.g&&(zl(m),m.g.cancel(),m.g=null)}function Wa(m){Ji(m),m.v&&(c.clearTimeout(m.v),m.v=null),Xa(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&c.clearTimeout(m.m),m.m=null)}function Kr(m){if(!Rl(m.h)&&!m.m){m.m=!0;var E=m.Ea;Z||C(),oe||(Z(),oe=!0),O.add(E,m),m.D=0}}function Ya(m,E){return zr(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=E.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=Nr(p(m.Ea,m,E),Ou(m,m.D)),m.D++,!0)}t.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const re=new pr(this,this.j,m);let ue=this.o;if(this.U&&(ue?(ue=V(ue),ne(ue,this.U)):ue=this.U),this.u!==null||this.R||(re.J=ue,ue=null),this.S)e:{for(var E=0,S=0;S<this.i.length;S++){t:{var L=this.i[S];if("__data__"in L.map&&(L=L.map.__data__,typeof L=="string")){L=L.length;break t}L=void 0}if(L===void 0)break;if(E+=L,E>4096){E=S;break e}if(E===4096||S===this.i.length-1){E=S+1;break e}}E=1e3}else E=1e3;E=Ru(this,re,E),S=Bt(this.J),ot(S,"RID",m),ot(S,"CVER",22),this.G&&ot(S,"X-HTTP-Session-Id",this.G),oa(this,S),ue&&(this.R?E="headers="+fi(Jn(ue))+"&"+E:this.u&&ia(S,this.u,ue)),Dl(this.h,re),this.Ra&&ot(S,"TYPE","init"),this.S?(ot(S,"$req",E),ot(S,"SID","null"),re.U=!0,Lr(re,S,null)):Lr(re,S,E),this.I=2}}else this.I==3&&(m?Ul(this,m):this.i.length==0||Rl(this.h)||Ul(this))};function Ul(m,E){var S;E?S=E.l:S=m.V++;const L=Bt(m.J);ot(L,"SID",m.M),ot(L,"RID",S),ot(L,"AID",m.K),oa(m,L),m.u&&m.o&&ia(L,m.u,m.o),S=new pr(m,m.j,S,m.D+1),m.u===null&&(S.J=m.o),E&&(m.i=E.G.concat(m.i)),E=Ru(m,S,1e3),S.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),Dl(m.h,S),Lr(S,L,E)}function oa(m,E){m.H&&$(m.H,function(S,L){ot(E,L,S)}),m.l&&$({},function(S,L){ot(E,L,S)})}function Ru(m,E,S){S=Math.min(m.i.length,S);const L=m.l?p(m.l.Ka,m.l,m):null;e:{var re=m.i;let Be=-1;for(;;){const jt=["count="+S];Be==-1?S>0?(Be=re[0].g,jt.push("ofs="+Be)):Be=0:jt.push("ofs="+Be);let nt=!0;for(let bt=0;bt<S;bt++){var ue=re[bt].g;const Zn=re[bt].map;if(ue-=Be,ue<0)Be=Math.max(0,re[bt].g-100),nt=!1;else try{ue="req"+ue+"_"||"";try{var xe=Zn instanceof Map?Zn:Object.entries(Zn);for(const[Wr,br]of xe){let Er=br;d(br)&&(Er=Qi(br)),jt.push(ue+Wr+"="+encodeURIComponent(Er))}}catch(Wr){throw jt.push(ue+"type="+encodeURIComponent("_badmap")),Wr}}catch{L&&L(Zn)}}if(nt){xe=jt.join("&");break e}}xe=void 0}return m=m.i.splice(0,S),E.G=m,xe}function Du(m){if(!m.g&&!m.v){m.Y=1;var E=m.Da;Z||C(),oe||(Z(),oe=!0),O.add(E,m),m.A=0}}function la(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=Nr(p(m.Da,m),Ou(m,m.A)),m.A++,!0)}t.Da=function(){if(this.v=null,Iu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=Nr(p(this.Wa,this),m)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Pt(10),Ji(this),Iu(this))};function zl(m){m.B!=null&&(c.clearTimeout(m.B),m.B=null)}function Iu(m){m.g=new pr(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var E=Bt(m.na);ot(E,"RID","rpc"),ot(E,"SID",m.M),ot(E,"AID",m.K),ot(E,"CI",m.F?"0":"1"),!m.F&&m.ia&&ot(E,"TO",m.ia),ot(E,"TYPE","xmlhttp"),oa(m,E),m.u&&m.o&&ia(E,m.u,m.o),m.O&&(m.g.H=m.O);var S=m.g;m=m.ba,S.M=1,S.A=ta(Bt(E)),S.u=null,S.R=!0,Fa(S,m)}t.Va=function(){this.C!=null&&(this.C=null,Ji(this),la(this),Pt(19))};function Xa(m){m.C!=null&&(c.clearTimeout(m.C),m.C=null)}function ju(m,E){var S=null;if(m.g==E){Xa(m),zl(m),m.g=null;var L=2}else if(Fr(m.h,E))S=E.G,Il(m.h,E),L=1;else return;if(m.I!=0){if(E.o)if(L==1){S=E.u?E.u.length:0,E=Date.now()-E.F;var re=m.D;L=za(),St(L,new kr(L,S)),Kr(m)}else Du(m);else if(re=E.m,re==3||re==0&&E.X>0||!(L==1&&Ya(m,E)||L==2&&la(m)))switch(S&&S.length>0&&(E=m.h,E.i=E.i.concat(S)),re){case 1:$r(m,5);break;case 4:$r(m,10);break;case 3:$r(m,6);break;default:$r(m,2)}}}function Ou(m,E){let S=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(S*=2),S*E}function $r(m,E){if(m.j.info("Error code "+E),E==2){var S=p(m.bb,m),L=m.Ua;const re=!L;L=new Vn(L||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||tn(L,"https"),ta(L),re?yr(L.toString(),S):Pl(L.toString(),S)}else Pt(2);m.I=0,m.l&&m.l.pa(E),Mu(m),Wa(m)}t.bb=function(m){m?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))};function Mu(m){if(m.I=0,m.ja=[],m.l){const E=jl(m.h);(E.length!=0||m.i.length!=0)&&(w(m.ja,E),w(m.ja,m.i),m.h.i.length=0,T(m.i),m.i.length=0),m.l.oa()}}function ku(m,E,S){var L=S instanceof Vn?Bt(S):new Vn(S);if(L.g!="")E&&(L.g=E+"."+L.g),Gi(L,L.u);else{var re=c.location;L=re.protocol,E=E?E+"."+re.hostname:re.hostname,re=+re.port;const ue=new Vn(null);L&&tn(ue,L),E&&(ue.g=E),re&&Gi(ue,re),S&&(ue.h=S),L=ue}return S=m.G,E=m.wa,S&&E&&ot(L,S,E),ot(L,"VER",m.ka),oa(m,L),L}function Nu(m,E,S){if(E&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=m.Aa&&!m.ma?new ut(new Qr({ab:S})):new ut(m.ma),E.Fa(m.L),E}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pu(){}t=Pu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Zi(){}Zi.prototype.g=function(m,E){return new Sn(m,E)};function Sn(m,E){st.call(this),this.g=new Xi(E),this.l=m,this.h=E&&E.messageUrlParams||null,m=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(m?m["X-WebChannel-Content-Type"]=E.messageContentType:m={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(m?m["X-WebChannel-Client-Profile"]=E.sa:m={"X-WebChannel-Client-Profile":E.sa}),this.g.U=m,(m=E&&E.Qb)&&!M(m)&&(this.g.u=m),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!M(E)&&(this.g.G=E,m=this.h,m!==null&&E in m&&(m=this.h,E in m&&delete m[E])),this.j=new gi(this)}v(Sn,st),Sn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Sn.prototype.close=function(){Bl(this.g)},Sn.prototype.o=function(m){var E=this.g;if(typeof m=="string"){var S={};S.__data__=m,m=S}else this.v&&(S={},S.__data__=Qi(m),m=S);E.i.push(new Vt(E.Ya++,m)),E.I==3&&Kr(E)},Sn.prototype.N=function(){this.g.l=null,delete this.j,Bl(this.g),delete this.g,Sn.Z.N.call(this)};function Lu(m){ln.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var E=m.__sm__;if(E){e:{for(const S in E){m=S;break e}m=void 0}(this.i=m)&&(m=this.i,E=E!==null&&m in E?E[m]:void 0),this.data=E}else this.data=m}v(Lu,ln);function Vu(){Wn.call(this),this.status=1}v(Vu,Wn);function gi(m){this.g=m}v(gi,Pu),gi.prototype.ra=function(){St(this.g,"a")},gi.prototype.qa=function(m){St(this.g,new Lu(m))},gi.prototype.pa=function(m){St(this.g,new Vu)},gi.prototype.oa=function(){St(this.g,"b")},Zi.prototype.createWebChannel=Zi.prototype.g,Sn.prototype.send=Sn.prototype.o,Sn.prototype.open=Sn.prototype.m,Sn.prototype.close=Sn.prototype.close,yS=function(){return new Zi},gS=function(){return za()},pS=It,Zp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Zs.NO_ERROR=0,Zs.TIMEOUT=8,Zs.HTTP_ERROR=6,Zd=Zs,Tl.COMPLETE="complete",mS=Tl,gu.EventType=fr,fr.OPEN="a",fr.CLOSE="b",fr.ERROR="c",fr.MESSAGE="d",st.prototype.listen=st.prototype.J,Ic=gu,ut.prototype.listenOnce=ut.prototype.K,ut.prototype.getLastError=ut.prototype.Ha,ut.prototype.getLastErrorCode=ut.prototype.ya,ut.prototype.getStatus=ut.prototype.ca,ut.prototype.getResponseJson=ut.prototype.La,ut.prototype.getResponseText=ut.prototype.la,ut.prototype.send=ut.prototype.ea,ut.prototype.setWithCredentials=ut.prototype.Fa,fS=ut}).apply(typeof Qd<"u"?Qd:typeof self<"u"?self:typeof window<"u"?window:{});const Kb="@firebase/firestore",$b="4.9.3";class bn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bn.UNAUTHENTICATED=new bn(null),bn.GOOGLE_CREDENTIALS=new bn("google-credentials-uid"),bn.FIRST_PARTY=new bn("first-party-uid"),bn.MOCK_USER=new bn("mock-user");let ul="12.7.0";const ja=new Vg("@firebase/firestore");function Mo(){return ja.logLevel}function Te(t,...e){if(ja.logLevel<=$e.DEBUG){const n=e.map(zg);ja.debug(`Firestore (${ul}): ${t}`,...n)}}function Bi(t,...e){if(ja.logLevel<=$e.ERROR){const n=e.map(zg);ja.error(`Firestore (${ul}): ${t}`,...n)}}function Wo(t,...e){if(ja.logLevel<=$e.WARN){const n=e.map(zg);ja.warn(`Firestore (${ul}): ${t}`,...n)}}function zg(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function ke(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,_S(t,i,n)}function _S(t,e,n){let i=`FIRESTORE (${ul}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Bi(i),new Error(i)}function at(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||_S(e,a,i)}function Ve(t,e){return t}const ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends qi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Pi{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class vS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class UI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(bn.UNAUTHENTICATED)))}shutdown(){}}class zI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class FI{constructor(e){this.t=e,this.currentUser=bn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){at(this.o===void 0,42304);let i=this.i;const a=f=>this.i!==i?(i=this.i,n(f)):Promise.resolve();let l=new Pi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Pi,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const f=l;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},d=f=>{Te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(Te("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Pi)}}),0),c()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(Te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(at(typeof i.accessToken=="string",31837,{l:i}),new vS(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return at(e===null||typeof e=="string",2055,{h:e}),new bn(e)}}class qI{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=bn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class QI{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new qI(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(bn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Wb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class GI{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Tr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){at(this.o===void 0,3512);const i=l=>{l.error!=null&&Te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Te("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{Te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Wb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(at(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Wb(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function HI(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class Fg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=HI(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function We(t,e){return t<e?-1:t>e?1:0}function eg(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return Cp(a)===Cp(l)?We(a,l):Cp(a)?1:-1}return We(t.length,e.length)}const KI=55296,$I=57343;function Cp(t){const e=t.charCodeAt(0);return e>=KI&&e<=$I}function Yo(t,e,n){return t.length===e.length&&t.every(((i,a)=>n(i,e[a])))}const Yb="__name__";class ei{constructor(e,n,i){n===void 0?n=0:n>e.length&&ke(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&ke(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return ei.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ei?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=ei.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return We(e.length,n.length)}static compareSegments(e,n){const i=ei.isNumericId(e),a=ei.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?ei.extractNumericId(e).compare(ei.extractNumericId(n)):eg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Os.fromString(e.substring(4,e.length-2))}}class gt extends ei{construct(e,n,i){return new gt(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new we(ge.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((a=>a.length>0)))}return new gt(n)}static emptyPath(){return new gt([])}}const WI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pn extends ei{construct(e,n,i){return new pn(e,n,i)}static isValidIdentifier(e){return WI.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Yb}static keyField(){return new pn([Yb])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new we(ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let c=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new we(ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new we(ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,a+=2}else d==="`"?(c=!c,a++):d!=="."||c?(i+=d,a++):(l(),a++)}if(l(),c)throw new we(ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pn(n)}static emptyPath(){return new pn([])}}class Ie{constructor(e){this.path=e}static fromPath(e){return new Ie(gt.fromString(e))}static fromName(e){return new Ie(gt.fromString(e).popFirst(5))}static empty(){return new Ie(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return gt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ie(new gt(e.slice()))}}function bS(t,e,n){if(!n)throw new we(ge.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function YI(t,e,n,i){if(e===!0&&i===!0)throw new we(ge.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Xb(t){if(!Ie.isDocumentKey(t))throw new we(ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Jb(t){if(Ie.isDocumentKey(t))throw new we(ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ES(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function qh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ke(12329,{type:typeof t})}function ui(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new we(ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=qh(t);throw new we(ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Kt(t,e){const n={typeString:t};return e&&(n.value=e),n}function tu(t,e){if(!ES(t))throw new we(ge.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const c=t[i];if(a&&typeof c!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new we(ge.INVALID_ARGUMENT,n);return!0}const Zb=-62135596800,eE=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*eE);return new vt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new we(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new we(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Zb)throw new we(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/eE}_compareTo(e){return this.seconds===e.seconds?We(this.nanoseconds,e.nanoseconds):We(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(tu(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Zb;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Kt("string",vt._jsonSchemaVersion),seconds:Kt("number"),nanoseconds:Kt("number")};class Pe{static fromTimestamp(e){return new Pe(e)}static min(){return new Pe(new vt(0,0))}static max(){return new Pe(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const qc=-1;function XI(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Pe.fromTimestamp(i===1e9?new vt(n+1,0):new vt(n,i));return new Ps(a,Ie.empty(),e)}function JI(t){return new Ps(t.readTime,t.key,qc)}class Ps{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Ps(Pe.min(),Ie.empty(),qc)}static max(){return new Ps(Pe.max(),Ie.empty(),qc)}}function ZI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ie.comparator(t.documentKey,e.documentKey),n!==0?n:We(t.largestBatchId,e.largestBatchId))}const e2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class t2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function dl(t){if(t.code!==ge.FAILED_PRECONDITION||t.message!==e2)throw t;Te("LocalStore","Unexpectedly lost primary lease")}class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ye(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof ye?n:ye.resolve(n)}catch(n){return ye.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):ye.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):ye.reject(n)}static resolve(e){return new ye(((n,i)=>{n(e)}))}static reject(e){return new ye(((n,i)=>{i(e)}))}static waitFor(e){return new ye(((n,i)=>{let a=0,l=0,c=!1;e.forEach((d=>{++a,d.next((()=>{++l,c&&l===a&&n()}),(f=>i(f)))})),c=!0,l===a&&n()}))}static or(e){let n=ye.resolve(!1);for(const i of e)n=n.next((a=>a?ye.resolve(a):i()));return n}static forEach(e,n){const i=[];return e.forEach(((a,l)=>{i.push(n.call(this,a,l))})),this.waitFor(i)}static mapArray(e,n){return new ye(((i,a)=>{const l=e.length,c=new Array(l);let d=0;for(let f=0;f<l;f++){const p=f;n(e[p]).next((_=>{c[p]=_,++d,d===l&&i(c)}),(_=>a(_)))}}))}static doWhile(e,n){return new ye(((i,a)=>{const l=()=>{e()===!0?n().next((()=>{l()}),a):i()};l()}))}}function n2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function hl(t){return t.name==="IndexedDbTransactionError"}class Qh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Qh.ce=-1;const qg=-1;function Gh(t){return t==null}function mh(t){return t===0&&1/t==-1/0}function r2(t){return typeof t=="number"&&Number.isInteger(t)&&!mh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const xS="";function i2(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=tE(e)),e=s2(t.get(n),e);return tE(e)}function s2(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case xS:n+="";break;default:n+=l}}return n}function tE(t){return t+xS+""}function nE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Qs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function SS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class At{constructor(e,n){this.comparator=e,this.root=n||mn.EMPTY}insert(e,n){return new At(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,mn.BLACK,null,null))}remove(e){return new At(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gd(this.root,e,this.comparator,!0)}}class Gd{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mn{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??mn.RED,this.left=a??mn.EMPTY,this.right=l??mn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new mn(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return mn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return mn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ke(27949);return e+(this.isRed()?0:1)}}mn.EMPTY=null,mn.RED=!0,mn.BLACK=!1;mn.EMPTY=new class{constructor(){this.size=0}get key(){throw ke(57766)}get value(){throw ke(16141)}get color(){throw ke(16727)}get left(){throw ke(29726)}get right(){throw ke(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new mn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Zt{constructor(e){this.comparator=e,this.data=new At(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new rE(this.data.getIterator())}getIteratorFrom(e){return new rE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof Zt)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Zt(this.comparator);return n.data=e,n}}class rE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Hn{constructor(e){this.fields=e,e.sort(pn.comparator)}static empty(){return new Hn([])}unionWith(e){let n=new Zt(pn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new Hn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Yo(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class wS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class yn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new wS("Invalid base64 string: "+l):l}})(e);return new yn(n)}static fromUint8Array(e){const n=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new yn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return We(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yn.EMPTY_BYTE_STRING=new yn("");const a2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ls(t){if(at(!!t,39018),typeof t=="string"){let e=0;const n=a2.exec(t);if(at(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:kt(t.seconds),nanos:kt(t.nanos)}}function kt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Vs(t){return typeof t=="string"?yn.fromBase64String(t):yn.fromUint8Array(t)}const TS="server_timestamp",AS="__type__",CS="__previous_value__",RS="__local_write_time__";function Qg(t){return(t?.mapValue?.fields||{})[AS]?.stringValue===TS}function Hh(t){const e=t.mapValue.fields[CS];return Qg(e)?Hh(e):e}function Qc(t){const e=Ls(t.mapValue.fields[RS].timestampValue);return new vt(e.seconds,e.nanos)}class o2{constructor(e,n,i,a,l,c,d,f,p,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=_}}const ph="(default)";class Gc{constructor(e,n){this.projectId=e,this.database=n||ph}static empty(){return new Gc("","")}get isDefaultDatabase(){return this.database===ph}isEqual(e){return e instanceof Gc&&e.projectId===this.projectId&&e.database===this.database}}const DS="__type__",l2="__max__",Hd={mapValue:{}},IS="__vector__",gh="value";function Bs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Qg(t)?4:u2(t)?9007199254740991:c2(t)?10:11:ke(28295,{value:t})}function di(t,e){if(t===e)return!0;const n=Bs(t);if(n!==Bs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qc(t).isEqual(Qc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=Ls(a.timestampValue),d=Ls(l.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return Vs(a.bytesValue).isEqual(Vs(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return kt(a.geoPointValue.latitude)===kt(l.geoPointValue.latitude)&&kt(a.geoPointValue.longitude)===kt(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return kt(a.integerValue)===kt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=kt(a.doubleValue),d=kt(l.doubleValue);return c===d?mh(c)===mh(d):isNaN(c)&&isNaN(d)}return!1})(t,e);case 9:return Yo(t.arrayValue.values||[],e.arrayValue.values||[],di);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},d=l.mapValue.fields||{};if(nE(c)!==nE(d))return!1;for(const f in c)if(c.hasOwnProperty(f)&&(d[f]===void 0||!di(c[f],d[f])))return!1;return!0})(t,e);default:return ke(52216,{left:t})}}function Hc(t,e){return(t.values||[]).find((n=>di(n,e)))!==void 0}function Xo(t,e){if(t===e)return 0;const n=Bs(t),i=Bs(e);if(n!==i)return We(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return We(t.booleanValue,e.booleanValue);case 2:return(function(l,c){const d=kt(l.integerValue||l.doubleValue),f=kt(c.integerValue||c.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(t,e);case 3:return iE(t.timestampValue,e.timestampValue);case 4:return iE(Qc(t),Qc(e));case 5:return eg(t.stringValue,e.stringValue);case 6:return(function(l,c){const d=Vs(l),f=Vs(c);return d.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(l,c){const d=l.split("/"),f=c.split("/");for(let p=0;p<d.length&&p<f.length;p++){const _=We(d[p],f[p]);if(_!==0)return _}return We(d.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,c){const d=We(kt(l.latitude),kt(c.latitude));return d!==0?d:We(kt(l.longitude),kt(c.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return sE(t.arrayValue,e.arrayValue);case 10:return(function(l,c){const d=l.fields||{},f=c.fields||{},p=d[gh]?.arrayValue,_=f[gh]?.arrayValue,v=We(p?.values?.length||0,_?.values?.length||0);return v!==0?v:sE(p,_)})(t.mapValue,e.mapValue);case 11:return(function(l,c){if(l===Hd.mapValue&&c===Hd.mapValue)return 0;if(l===Hd.mapValue)return 1;if(c===Hd.mapValue)return-1;const d=l.fields||{},f=Object.keys(d),p=c.fields||{},_=Object.keys(p);f.sort(),_.sort();for(let v=0;v<f.length&&v<_.length;++v){const b=eg(f[v],_[v]);if(b!==0)return b;const T=Xo(d[f[v]],p[_[v]]);if(T!==0)return T}return We(f.length,_.length)})(t.mapValue,e.mapValue);default:throw ke(23264,{he:n})}}function iE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return We(t,e);const n=Ls(t),i=Ls(e),a=We(n.seconds,i.seconds);return a!==0?a:We(n.nanos,i.nanos)}function sE(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=Xo(n[a],i[a]);if(l)return l}return We(n.length,i.length)}function Jo(t){return tg(t)}function tg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=Ls(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Vs(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return Ie.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=tg(l);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const c of i)l?l=!1:a+=",",a+=`${c}:${tg(n.fields[c])}`;return a+"}"})(t.mapValue):ke(61005,{value:t})}function eh(t){switch(Bs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hh(t);return e?16+eh(e):16;case 5:return 2*t.stringValue.length;case 6:return Vs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+eh(l)),0)})(t.arrayValue);case 10:case 11:return(function(i){let a=0;return Qs(i.fields,((l,c)=>{a+=l.length+eh(c)})),a})(t.mapValue);default:throw ke(13486,{value:t})}}function aE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ng(t){return!!t&&"integerValue"in t}function Gg(t){return!!t&&"arrayValue"in t}function oE(t){return!!t&&"nullValue"in t}function lE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function th(t){return!!t&&"mapValue"in t}function c2(t){return(t?.mapValue?.fields||{})[DS]?.stringValue===IS}function Nc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Qs(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=Nc(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Nc(t.arrayValue.values[n]);return e}return{...t}}function u2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===l2}class Nn{constructor(e){this.value=e}static empty(){return new Nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!th(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nc(n)}setAll(e){let n=pn.emptyPath(),i={},a=[];e.forEach(((c,d)=>{if(!n.isImmediateParentOf(d)){const f=this.getFieldsMap(n);this.applyChanges(f,i,a),i={},a=[],n=d.popLast()}c?i[d.lastSegment()]=Nc(c):a.push(d.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());th(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return di(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];th(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){Qs(n,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new Nn(Nc(this.value))}}function jS(t){const e=[];return Qs(t.fields,((n,i)=>{const a=new pn([n]);if(th(i)){const l=jS(i.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new Hn(e)}class En{constructor(e,n,i,a,l,c,d){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=c,this.documentState=d}static newInvalidDocument(e){return new En(e,0,Pe.min(),Pe.min(),Pe.min(),Nn.empty(),0)}static newFoundDocument(e,n,i,a){return new En(e,1,n,Pe.min(),i,a,0)}static newNoDocument(e,n){return new En(e,2,n,Pe.min(),Pe.min(),Nn.empty(),0)}static newUnknownDocument(e,n){return new En(e,3,n,Pe.min(),Pe.min(),Nn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof En&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new En(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class yh{constructor(e,n){this.position=e,this.inclusive=n}}function cE(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],c=t.position[a];if(l.field.isKeyField()?i=Ie.comparator(Ie.fromName(c.referenceValue),n.key):i=Xo(c,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function uE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!di(t.position[n],e.position[n]))return!1;return!0}class _h{constructor(e,n="asc"){this.field=e,this.dir=n}}function d2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class OS{}class Ht extends OS{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new f2(e,n,i):n==="array-contains"?new g2(e,i):n==="in"?new y2(e,i):n==="not-in"?new _2(e,i):n==="array-contains-any"?new v2(e,i):new Ht(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new m2(e,i):new p2(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Xo(n,this.value)):n!==null&&Bs(this.value)===Bs(n)&&this.matchesComparison(Xo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Dr extends OS{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Dr(e,n)}matches(e){return MS(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function MS(t){return t.op==="and"}function kS(t){return h2(t)&&MS(t)}function h2(t){for(const e of t.filters)if(e instanceof Dr)return!1;return!0}function rg(t){if(t instanceof Ht)return t.field.canonicalString()+t.op.toString()+Jo(t.value);if(kS(t))return t.filters.map((e=>rg(e))).join(",");{const e=t.filters.map((n=>rg(n))).join(",");return`${t.op}(${e})`}}function NS(t,e){return t instanceof Ht?(function(i,a){return a instanceof Ht&&i.op===a.op&&i.field.isEqual(a.field)&&di(i.value,a.value)})(t,e):t instanceof Dr?(function(i,a){return a instanceof Dr&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,c,d)=>l&&NS(c,a.filters[d])),!0):!1})(t,e):void ke(19439)}function PS(t){return t instanceof Ht?(function(n){return`${n.field.canonicalString()} ${n.op} ${Jo(n.value)}`})(t):t instanceof Dr?(function(n){return n.op.toString()+" {"+n.getFilters().map(PS).join(" ,")+"}"})(t):"Filter"}class f2 extends Ht{constructor(e,n,i){super(e,n,i),this.key=Ie.fromName(i.referenceValue)}matches(e){const n=Ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class m2 extends Ht{constructor(e,n){super(e,"in",n),this.keys=LS("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class p2 extends Ht{constructor(e,n){super(e,"not-in",n),this.keys=LS("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function LS(t,e){return(e.arrayValue?.values||[]).map((n=>Ie.fromName(n.referenceValue)))}class g2 extends Ht{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Gg(n)&&Hc(n.arrayValue,this.value)}}class y2 extends Ht{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Hc(this.value.arrayValue,n)}}class _2 extends Ht{constructor(e,n){super(e,"not-in",n)}matches(e){if(Hc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Hc(this.value.arrayValue,n)}}class v2 extends Ht{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Gg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>Hc(this.value.arrayValue,i)))}}class b2{constructor(e,n=null,i=[],a=[],l=null,c=null,d=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=c,this.endAt=d,this.Te=null}}function dE(t,e=null,n=[],i=[],a=null,l=null,c=null){return new b2(t,e,n,i,a,l,c)}function Hg(t){const e=Ve(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>rg(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),Gh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>Jo(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>Jo(i))).join(",")),e.Te=n}return e.Te}function Kg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!d2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!NS(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!uE(t.startAt,e.startAt)&&uE(t.endAt,e.endAt)}function ig(t){return Ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class nu{constructor(e,n=null,i=[],a=[],l=null,c="F",d=null,f=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=c,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function E2(t,e,n,i,a,l,c,d){return new nu(t,e,n,i,a,l,c,d)}function $g(t){return new nu(t)}function hE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function VS(t){return t.collectionGroup!==null}function Pc(t){const e=Ve(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new Zt(pn.comparator);return c.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(d=d.add(p.field))}))})),d})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new _h(l,i))})),n.has(pn.keyField().canonicalString())||e.Ie.push(new _h(pn.keyField(),i))}return e.Ie}function ri(t){const e=Ve(t);return e.Ee||(e.Ee=x2(e,Pc(t))),e.Ee}function x2(t,e){if(t.limitType==="F")return dE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new _h(a.field,l)}));const n=t.endAt?new yh(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new yh(t.startAt.position,t.startAt.inclusive):null;return dE(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function sg(t,e){const n=t.filters.concat([e]);return new nu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ag(t,e,n){return new nu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Kh(t,e){return Kg(ri(t),ri(e))&&t.limitType===e.limitType}function BS(t){return`${Hg(ri(t))}|lt:${t.limitType}`}function ko(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((a=>PS(a))).join(", ")}]`),Gh(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((a=>Jo(a))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((a=>Jo(a))).join(",")),`Target(${i})`})(ri(t))}; limitType=${t.limitType})`}function $h(t,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Ie.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(t,e)&&(function(i,a){for(const l of Pc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(i,a){return!(i.startAt&&!(function(c,d,f){const p=cE(c,d,f);return c.inclusive?p<=0:p<0})(i.startAt,Pc(i),a)||i.endAt&&!(function(c,d,f){const p=cE(c,d,f);return c.inclusive?p>=0:p>0})(i.endAt,Pc(i),a))})(t,e)}function S2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function US(t){return(e,n)=>{let i=!1;for(const a of Pc(t)){const l=w2(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function w2(t,e,n){const i=t.field.isKeyField()?Ie.comparator(e.key,n.key):(function(l,c,d){const f=c.data.field(l),p=d.data.field(l);return f!==null&&p!==null?Xo(f,p):ke(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return ke(19790,{direction:t.dir})}}class Pa{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Qs(this.inner,((n,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return SS(this.inner)}size(){return this.innerSize}}const T2=new At(Ie.comparator);function Ui(){return T2}const zS=new At(Ie.comparator);function jc(...t){let e=zS;for(const n of t)e=e.insert(n.key,n);return e}function FS(t){let e=zS;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function Aa(){return Lc()}function qS(){return Lc()}function Lc(){return new Pa((t=>t.toString()),((t,e)=>t.isEqual(e)))}const A2=new At(Ie.comparator),C2=new Zt(Ie.comparator);function Ye(...t){let e=C2;for(const n of t)e=e.add(n);return e}const R2=new Zt(We);function D2(){return R2}function Wg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mh(e)?"-0":e}}function QS(t){return{integerValue:""+t}}function I2(t,e){return r2(e)?QS(e):Wg(t,e)}class Wh{constructor(){this._=void 0}}function j2(t,e,n){return t instanceof vh?(function(a,l){const c={fields:{[AS]:{stringValue:TS},[RS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Qg(l)&&(l=Hh(l)),l&&(c.fields[CS]=l),{mapValue:c}})(n,e):t instanceof Zo?HS(t,e):t instanceof Kc?KS(t,e):(function(a,l){const c=GS(a,l),d=fE(c)+fE(a.Ae);return ng(c)&&ng(a.Ae)?QS(d):Wg(a.serializer,d)})(t,e)}function O2(t,e,n){return t instanceof Zo?HS(t,e):t instanceof Kc?KS(t,e):n}function GS(t,e){return t instanceof bh?(function(i){return ng(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class vh extends Wh{}class Zo extends Wh{constructor(e){super(),this.elements=e}}function HS(t,e){const n=$S(e);for(const i of t.elements)n.some((a=>di(a,i)))||n.push(i);return{arrayValue:{values:n}}}class Kc extends Wh{constructor(e){super(),this.elements=e}}function KS(t,e){let n=$S(e);for(const i of t.elements)n=n.filter((a=>!di(a,i)));return{arrayValue:{values:n}}}class bh extends Wh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function fE(t){return kt(t.integerValue||t.doubleValue)}function $S(t){return Gg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class M2{constructor(e,n){this.field=e,this.transform=n}}function k2(t,e){return t.field.isEqual(e.field)&&(function(i,a){return i instanceof Zo&&a instanceof Zo||i instanceof Kc&&a instanceof Kc?Yo(i.elements,a.elements,di):i instanceof bh&&a instanceof bh?di(i.Ae,a.Ae):i instanceof vh&&a instanceof vh})(t.transform,e.transform)}class N2{constructor(e,n){this.version=e,this.transformResults=n}}class Rr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Rr}static exists(e){return new Rr(void 0,e)}static updateTime(e){return new Rr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function nh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Yh{}function WS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Yg(t.key,Rr.none()):new ru(t.key,t.data,Rr.none());{const n=t.data,i=Nn.empty();let a=new Zt(pn.comparator);for(let l of e.fields)if(!a.has(l)){let c=n.field(l);c===null&&l.length>1&&(l=l.popLast(),c=n.field(l)),c===null?i.delete(l):i.set(l,c),a=a.add(l)}return new Gs(t.key,i,new Hn(a.toArray()),Rr.none())}}function P2(t,e,n){t instanceof ru?(function(a,l,c){const d=a.value.clone(),f=pE(a.fieldTransforms,l,c.transformResults);d.setAll(f),l.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(t,e,n):t instanceof Gs?(function(a,l,c){if(!nh(a.precondition,l))return void l.convertToUnknownDocument(c.version);const d=pE(a.fieldTransforms,l,c.transformResults),f=l.data;f.setAll(YS(a)),f.setAll(d),l.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(t,e,n):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,n)}function Vc(t,e,n,i){return t instanceof ru?(function(l,c,d,f){if(!nh(l.precondition,c))return d;const p=l.value.clone(),_=gE(l.fieldTransforms,f,c);return p.setAll(_),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(t,e,n,i):t instanceof Gs?(function(l,c,d,f){if(!nh(l.precondition,c))return d;const p=gE(l.fieldTransforms,f,c),_=c.data;return _.setAll(YS(l)),_.setAll(p),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,n,i):(function(l,c,d){return nh(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(t,e,n)}function L2(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=GS(i.transform,a||null);l!=null&&(n===null&&(n=Nn.empty()),n.set(i.field,l))}return n||null}function mE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&Yo(i,a,((l,c)=>k2(l,c)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ru extends Yh{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Gs extends Yh{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function YS(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function pE(t,e,n){const i=new Map;at(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],c=l.transform,d=e.data.field(l.field);i.set(l.field,O2(c,d,n[a]))}return i}function gE(t,e,n){const i=new Map;for(const a of t){const l=a.transform,c=n.data.field(a.field);i.set(a.field,j2(l,c,e))}return i}class Yg extends Yh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class V2 extends Yh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class B2{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&P2(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=Vc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=Vc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=qS();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let d=this.applyToLocalView(c,l.mutatedFields);d=n.has(a.key)?null:d;const f=WS(c,d);f!==null&&i.set(a.key,f),c.isValidDocument()||c.convertToNoDocument(Pe.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Ye())}isEqual(e){return this.batchId===e.batchId&&Yo(this.mutations,e.mutations,((n,i)=>mE(n,i)))&&Yo(this.baseMutations,e.baseMutations,((n,i)=>mE(n,i)))}}class Xg{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){at(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return A2})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,i[c].version);return new Xg(e,n,i,a)}}class U2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class z2{constructor(e,n){this.count=e,this.unchangedNames=n}}var Qt,Je;function F2(t){switch(t){case ge.OK:return ke(64938);case ge.CANCELLED:case ge.UNKNOWN:case ge.DEADLINE_EXCEEDED:case ge.RESOURCE_EXHAUSTED:case ge.INTERNAL:case ge.UNAVAILABLE:case ge.UNAUTHENTICATED:return!1;case ge.INVALID_ARGUMENT:case ge.NOT_FOUND:case ge.ALREADY_EXISTS:case ge.PERMISSION_DENIED:case ge.FAILED_PRECONDITION:case ge.ABORTED:case ge.OUT_OF_RANGE:case ge.UNIMPLEMENTED:case ge.DATA_LOSS:return!0;default:return ke(15467,{code:t})}}function XS(t){if(t===void 0)return Bi("GRPC error has no .code"),ge.UNKNOWN;switch(t){case Qt.OK:return ge.OK;case Qt.CANCELLED:return ge.CANCELLED;case Qt.UNKNOWN:return ge.UNKNOWN;case Qt.DEADLINE_EXCEEDED:return ge.DEADLINE_EXCEEDED;case Qt.RESOURCE_EXHAUSTED:return ge.RESOURCE_EXHAUSTED;case Qt.INTERNAL:return ge.INTERNAL;case Qt.UNAVAILABLE:return ge.UNAVAILABLE;case Qt.UNAUTHENTICATED:return ge.UNAUTHENTICATED;case Qt.INVALID_ARGUMENT:return ge.INVALID_ARGUMENT;case Qt.NOT_FOUND:return ge.NOT_FOUND;case Qt.ALREADY_EXISTS:return ge.ALREADY_EXISTS;case Qt.PERMISSION_DENIED:return ge.PERMISSION_DENIED;case Qt.FAILED_PRECONDITION:return ge.FAILED_PRECONDITION;case Qt.ABORTED:return ge.ABORTED;case Qt.OUT_OF_RANGE:return ge.OUT_OF_RANGE;case Qt.UNIMPLEMENTED:return ge.UNIMPLEMENTED;case Qt.DATA_LOSS:return ge.DATA_LOSS;default:return ke(39323,{code:t})}}(Je=Qt||(Qt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";function q2(){return new TextEncoder}const Q2=new Os([4294967295,4294967295],0);function yE(t){const e=q2().encode(t),n=new hS;return n.update(e),new Uint8Array(n.digest())}function _E(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Os([n,i],0),new Os([a,l],0)]}class Jg{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Oc(`Invalid padding: ${n}`);if(i<0)throw new Oc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Oc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Oc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Os.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(Os.fromNumber(i)));return a.compare(Q2)===1&&(a=new Os([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=yE(e),[i,a]=_E(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);if(!this.we(c))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new Jg(l,a,n);return i.forEach((d=>c.insert(d))),c}insert(e){if(this.ge===0)return;const n=yE(e),[i,a]=_E(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);this.Se(c)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Oc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Xh{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,iu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new Xh(Pe.min(),a,new At(We),Ui(),Ye())}}class iu{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new iu(i,n,Ye(),Ye(),Ye())}}class rh{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class JS{constructor(e,n){this.targetId=e,this.Ce=n}}class ZS{constructor(e,n,i=yn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class vE{constructor(){this.ve=0,this.Fe=bE(),this.Me=yn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ye(),n=Ye(),i=Ye();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:ke(38017,{changeType:l})}})),new iu(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=bE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,at(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class G2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ui(),this.Je=Kd(),this.He=Kd(),this.Ye=new At(We)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:ke(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(ig(l))if(i===0){const c=new Ie(l.path);this.et(n,c,En.newNoDocument(c,Pe.min()))}else at(i===1,20013,{expectedCount:i});else{const c=this._t(n);if(c!==i){const d=this.ut(e),f=d?this.ct(d,e,c):1;if(f!==0){this.it(n);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,p)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let c,d;try{c=Vs(i).toUint8Array()}catch(f){if(f instanceof wS)return Wo("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new Jg(c,a,l)}catch(f){return Wo(f instanceof Oc?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach((l=>{const c=this.Ge.ht(),d=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(n,l,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((l,c)=>{const d=this.ot(c);if(d){if(l.current&&ig(d.target)){const f=new Ie(d.target.path);this.It(f).has(c)||this.Et(c,f)||this.et(c,f,En.newNoDocument(f,e))}l.Be&&(n.set(c,l.ke()),l.qe())}}));let i=Ye();this.He.forEach(((l,c)=>{let d=!0;c.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new Xh(e,n,this.Ye,this.je,i);return this.je=Ui(),this.Je=Kd(),this.He=Kd(),this.Ye=new At(We),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new vE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Zt(We),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Zt(We),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Te("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new vE),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Kd(){return new At(Ie.comparator)}function bE(){return new At(Ie.comparator)}const H2={asc:"ASCENDING",desc:"DESCENDING"},K2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$2={and:"AND",or:"OR"};class W2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function og(t,e){return t.useProto3Json||Gh(e)?e:{value:e}}function Eh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ew(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Y2(t,e){return Eh(t,e.toTimestamp())}function ii(t){return at(!!t,49232),Pe.fromTimestamp((function(n){const i=Ls(n);return new vt(i.seconds,i.nanos)})(t))}function Zg(t,e){return lg(t,e).canonicalString()}function lg(t,e){const n=(function(a){return new gt(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function tw(t){const e=gt.fromString(t);return at(aw(e),10190,{key:e.toString()}),e}function cg(t,e){return Zg(t.databaseId,e.path)}function Rp(t,e){const n=tw(e);if(n.get(1)!==t.databaseId.projectId)throw new we(ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new we(ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ie(rw(n))}function nw(t,e){return Zg(t.databaseId,e)}function X2(t){const e=tw(t);return e.length===4?gt.emptyPath():rw(e)}function ug(t){return new gt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function rw(t){return at(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function EE(t,e,n){return{name:cg(t,e),fields:n.value.mapValue.fields}}function J2(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:ke(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(p,_){return p.useProto3Json?(at(_===void 0||typeof _=="string",58123),yn.fromBase64String(_||"")):(at(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),yn.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(p){const _=p.code===void 0?ge.UNKNOWN:XS(p.code);return new we(_,p.message||"")})(c);n=new ZS(i,a,l,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Rp(t,i.document.name),l=ii(i.document.updateTime),c=i.document.createTime?ii(i.document.createTime):Pe.min(),d=new Nn({mapValue:{fields:i.document.fields}}),f=En.newFoundDocument(a,l,c,d),p=i.targetIds||[],_=i.removedTargetIds||[];n=new rh(p,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Rp(t,i.document),l=i.readTime?ii(i.readTime):Pe.min(),c=En.newNoDocument(a,l),d=i.removedTargetIds||[];n=new rh([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Rp(t,i.document),l=i.removedTargetIds||[];n=new rh([],l,a,null)}else{if(!("filter"in e))return ke(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,c=new z2(a,l),d=i.targetId;n=new JS(d,c)}}return n}function Z2(t,e){let n;if(e instanceof ru)n={update:EE(t,e.key,e.value)};else if(e instanceof Yg)n={delete:cg(t,e.key)};else if(e instanceof Gs)n={update:EE(t,e.key,e.data),updateMask:lj(e.fieldMask)};else{if(!(e instanceof V2))return ke(16599,{Vt:e.type});n={verify:cg(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const d=c.transform;if(d instanceof vh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Zo)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Kc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof bh)return{fieldPath:c.field.canonicalString(),increment:d.Ae};throw ke(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:Y2(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:ke(27497)})(t,e.precondition)),n}function ej(t,e){return t&&t.length>0?(at(e!==void 0,14353),t.map((n=>(function(a,l){let c=a.updateTime?ii(a.updateTime):ii(l);return c.isEqual(Pe.min())&&(c=ii(l)),new N2(c,a.transformResults||[])})(n,e)))):[]}function tj(t,e){return{documents:[nw(t,e.path)]}}function nj(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=nw(t,a);const l=(function(p){if(p.length!==0)return sw(Dr.create(p,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const c=(function(p){if(p.length!==0)return p.map((_=>(function(b){return{field:No(b.field),direction:sj(b.dir)}})(_)))})(e.orderBy);c&&(n.structuredQuery.orderBy=c);const d=og(t,e.limit);return d!==null&&(n.structuredQuery.limit=d),e.startAt&&(n.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:n,parent:a}}function rj(t){let e=X2(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){at(i===1,65062);const _=n.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(v){const b=iw(v);return b instanceof Dr&&kS(b)?b.getFilters():[b]})(n.where));let c=[];n.orderBy&&(c=(function(v){return v.map((b=>(function(w){return new _h(Po(w.field),(function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(b)))})(n.orderBy));let d=null;n.limit&&(d=(function(v){let b;return b=typeof v=="object"?v.value:v,Gh(b)?null:b})(n.limit));let f=null;n.startAt&&(f=(function(v){const b=!!v.before,T=v.values||[];return new yh(T,b)})(n.startAt));let p=null;return n.endAt&&(p=(function(v){const b=!v.before,T=v.values||[];return new yh(T,b)})(n.endAt)),E2(e,a,c,l,d,"F",f,p)}function ij(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ke(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function iw(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Po(n.unaryFilter.field);return Ht.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=Po(n.unaryFilter.field);return Ht.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Po(n.unaryFilter.field);return Ht.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Po(n.unaryFilter.field);return Ht.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ke(61313);default:return ke(60726)}})(t):t.fieldFilter!==void 0?(function(n){return Ht.create(Po(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ke(58110);default:return ke(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Dr.create(n.compositeFilter.filters.map((i=>iw(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ke(1026)}})(n.compositeFilter.op))})(t):ke(30097,{filter:t})}function sj(t){return H2[t]}function aj(t){return K2[t]}function oj(t){return $2[t]}function No(t){return{fieldPath:t.canonicalString()}}function Po(t){return pn.fromServerFormat(t.fieldPath)}function sw(t){return t instanceof Ht?(function(n){if(n.op==="=="){if(lE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NAN"}};if(oE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(lE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NOT_NAN"}};if(oE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:No(n.field),op:aj(n.op),value:n.value}}})(t):t instanceof Dr?(function(n){const i=n.getFilters().map((a=>sw(a)));return i.length===1?i[0]:{compositeFilter:{op:oj(n.op),filters:i}}})(t):ke(54877,{filter:t})}function lj(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function aw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Cs{constructor(e,n,i,a,l=Pe.min(),c=Pe.min(),d=yn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new Cs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class cj{constructor(e){this.yt=e}}function uj(t){const e=rj({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ag(e,e.limit,"L"):e}class dj{constructor(){this.Cn=new hj}addToCollectionParentIndex(e,n){return this.Cn.add(n),ye.resolve()}getCollectionParents(e,n){return ye.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ye.resolve()}deleteFieldIndex(e,n){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,n){return ye.resolve()}getDocumentsMatchingTarget(e,n){return ye.resolve(null)}getIndexType(e,n){return ye.resolve(0)}getFieldIndexes(e,n){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,n){return ye.resolve(Ps.min())}getMinOffsetFromCollectionGroup(e,n){return ye.resolve(Ps.min())}updateCollectionGroup(e,n,i){return ye.resolve()}updateIndexEntries(e,n){return ye.resolve()}}class hj{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new Zt(gt.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new Zt(gt.comparator)).toArray()}}const xE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ow=41943040;class kn{static withCacheSize(e){return new kn(e,kn.DEFAULT_COLLECTION_PERCENTILE,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}kn.DEFAULT_COLLECTION_PERCENTILE=10,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kn.DEFAULT=new kn(ow,kn.DEFAULT_COLLECTION_PERCENTILE,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kn.DISABLED=new kn(-1,0,0);class el{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new el(0)}static cr(){return new el(-1)}}const SE="LruGarbageCollector",fj=1048576;function wE([t,e],[n,i]){const a=We(t,n);return a===0?We(e,i):a}class mj{constructor(e){this.Ir=e,this.buffer=new Zt(wE),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();wE(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class pj{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Te(SE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){hl(n)?Te(SE,"Ignoring IndexedDB error during garbage collection: ",n):await dl(n)}await this.Vr(3e5)}))}}class gj{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return ye.resolve(Qh.ce);const i=new mj(n);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Te("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve(xE)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Te("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xE):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,c,d,f,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,c=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(i=v,d=Date.now(),this.removeTargets(e,i,n)))).next((v=>(l=v,f=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(p=Date.now(),Mo()<=$e.DEBUG&&Te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${a} in `+(d-c)+`ms
	Removed ${l} targets in `+(f-d)+`ms
	Removed ${v} documents in `+(p-f)+`ms
Total Duration: ${p-_}ms`),ye.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:v}))))}}function yj(t,e){return new gj(t,e)}class _j{constructor(){this.changes=new Pa((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,En.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?ye.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class vj{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class bj{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(i!==null&&Vc(i.mutation,a,Hn.empty(),vt.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,Ye()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=Ye()){const a=Aa();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,i).next((l=>{let c=jc();return l.forEach(((d,f)=>{c=c.insert(d,f.overlayedDocument)})),c}))))}getOverlayedDocuments(e,n){const i=Aa();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,Ye())))}populateOverlays(e,n,i){const a=[];return i.forEach((l=>{n.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,d)=>{n.set(c,d)}))}))}computeViews(e,n,i,a){let l=Ui();const c=Lc(),d=(function(){return Lc()})();return n.forEach(((f,p)=>{const _=i.get(p.key);a.has(p.key)&&(_===void 0||_.mutation instanceof Gs)?l=l.insert(p.key,p):_!==void 0?(c.set(p.key,_.mutation.getFieldMask()),Vc(_.mutation,p,_.mutation.getFieldMask(),vt.now())):c.set(p.key,Hn.empty())})),this.recalculateAndSaveOverlays(e,l).next((f=>(f.forEach(((p,_)=>c.set(p,_))),n.forEach(((p,_)=>d.set(p,new vj(_,c.get(p)??null)))),d)))}recalculateAndSaveOverlays(e,n){const i=Lc();let a=new At(((c,d)=>c-d)),l=Ye();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((c=>{for(const d of c)d.keys().forEach((f=>{const p=n.get(f);if(p===null)return;let _=i.get(f)||Hn.empty();_=d.applyToLocalView(p,_),i.set(f,_);const v=(a.get(d.batchId)||Ye()).add(f);a=a.insert(d.batchId,v)}))})).next((()=>{const c=[],d=a.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),p=f.key,_=f.value,v=qS();_.forEach((b=>{if(!l.has(b)){const T=WS(n.get(b),i.get(b));T!==null&&v.set(b,T),l=l.add(b)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,v))}return ye.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,a){return(function(c){return Ie.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):VS(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):ye.resolve(Aa());let d=qc,f=l;return c.next((p=>ye.forEach(p,((_,v)=>(d<v.largestBatchId&&(d=v.largestBatchId),l.get(_)?ye.resolve():this.remoteDocumentCache.getEntry(e,_).next((b=>{f=f.insert(_,b)}))))).next((()=>this.populateOverlays(e,p,l))).next((()=>this.computeViews(e,f,p,Ye()))).next((_=>({batchId:d,changes:FS(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ie(n)).next((i=>{let a=jc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let c=jc();return this.indexManager.getCollectionParents(e,l).next((d=>ye.forEach(d,(f=>{const p=(function(v,b){return new nu(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,f.child(l));return this.getDocumentsMatchingCollectionQuery(e,p,i,a).next((_=>{_.forEach(((v,b)=>{c=c.insert(v,b)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a)))).next((c=>{l.forEach(((f,p)=>{const _=p.getKey();c.get(_)===null&&(c=c.insert(_,En.newInvalidDocument(_)))}));let d=jc();return c.forEach(((f,p)=>{const _=l.get(f);_!==void 0&&Vc(_.mutation,p,Hn.empty(),vt.now()),$h(n,p)&&(d=d.insert(f,p))})),d}))}}class Ej{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ye.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:ii(a.createTime)}})(n)),ye.resolve()}getNamedQuery(e,n){return ye.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:uj(a.bundledQuery),readTime:ii(a.readTime)}})(n)),ye.resolve()}}class xj{constructor(){this.overlays=new At(Ie.comparator),this.qr=new Map}getOverlay(e,n){return ye.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Aa();return ye.forEach(n,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((a,l)=>{this.St(e,n,l)})),ye.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),ye.resolve()}getOverlaysForCollection(e,n,i){const a=Aa(),l=n.length+1,c=new Ie(n.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const f=d.getNext().value,p=f.getKey();if(!n.isPrefixOf(p.path))break;p.path.length===l&&f.largestBatchId>i&&a.set(f.getKey(),f)}return ye.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new At(((p,_)=>p-_));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===n&&p.largestBatchId>i){let _=l.get(p.largestBatchId);_===null&&(_=Aa(),l=l.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const d=Aa(),f=l.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,_)=>d.set(p,_))),!(d.size()>=a)););return ye.resolve(d)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const c=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new U2(n,i));let l=this.qr.get(n);l===void 0&&(l=Ye(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}class Sj{constructor(){this.sessionToken=yn.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ye.resolve()}}class ey{constructor(){this.Qr=new Zt(rn.$r),this.Ur=new Zt(rn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new rn(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new rn(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new Ie(new gt([])),i=new rn(n,e),a=new rn(n,e+1),l=[];return this.Ur.forEachInRange([i,a],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Ie(new gt([])),i=new rn(n,e),a=new rn(n,e+1);let l=Ye();return this.Ur.forEachInRange([i,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const n=new rn(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class rn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Ie.comparator(e.key,n.key)||We(e.Yr,n.Yr)}static Kr(e,n){return We(e.Yr,n.Yr)||Ie.comparator(e.key,n.key)}}class wj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Zt(rn.$r)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new B2(l,n,i,a);this.mutationQueue.push(c);for(const d of a)this.Zr=this.Zr.add(new rn(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return ye.resolve(c)}lookupMutationBatch(e,n){return ye.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return ye.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?qg:this.tr-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new rn(n,0),a=new rn(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(c=>{const d=this.Xr(c.Yr);l.push(d)})),ye.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new Zt(We);return n.forEach((a=>{const l=new rn(a,0),c=new rn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(d=>{i=i.add(d.Yr)}))})),ye.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;Ie.isDocumentKey(l)||(l=l.child(""));const c=new rn(new Ie(l),0);let d=new Zt(We);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!i.isPrefixOf(p)&&(p.length===a&&(d=d.add(f.Yr)),!0)}),c),ye.resolve(this.ti(d))}ti(e){const n=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){at(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ye.forEach(n.mutations,(a=>{const l=new rn(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new rn(n,0),a=this.Zr.firstAfterOrEqual(i);return ye.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class Tj{constructor(e){this.ri=e,this.docs=(function(){return new At(Ie.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,c=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return ye.resolve(i?i.document.mutableCopy():En.newInvalidDocument(n))}getEntries(e,n){let i=Ui();return n.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():En.newInvalidDocument(a))})),ye.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=Ui();const c=n.path,d=new Ie(c.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:p,value:{document:_}}=f.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||ZI(JI(_),i)<=0||(a.has(_.key)||$h(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return ye.resolve(l)}getAllFromCollectionGroup(e,n,i,a){ke(9500)}ii(e,n){return ye.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new Aj(this)}getSize(e){return ye.resolve(this.size)}}class Aj extends _j{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),ye.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class Cj{constructor(e){this.persistence=e,this.si=new Pa((n=>Hg(n)),Kg),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.oi=0,this._i=new ey,this.targetCount=0,this.ai=el.ur()}forEachTarget(e,n){return this.si.forEach(((i,a)=>n(a))),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),ye.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new el(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ye.resolve()}updateTargetData(e,n){return this.Pr(n),ye.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach(((c,d)=>{d.sequenceNumber<=n&&i.get(d.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),ye.waitFor(l).next((()=>a))}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return ye.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),ye.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),ye.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ye.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return ye.resolve(i)}containsKey(e,n){return ye.resolve(this._i.containsKey(n))}}class lw{constructor(e,n){this.ui={},this.overlays={},this.ci=new Qh(0),this.li=!1,this.li=!0,this.hi=new Sj,this.referenceDelegate=e(this),this.Pi=new Cj(this),this.indexManager=new dj,this.remoteDocumentCache=(function(a){return new Tj(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new cj(n),this.Ii=new Ej(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new xj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new wj(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){Te("MemoryPersistence","Starting transaction:",e);const a=new Rj(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,n){return ye.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class Rj extends t2{constructor(e){super(),this.currentSequenceNumber=e}}class ty{constructor(e){this.persistence=e,this.Ri=new ey,this.Vi=null}static mi(e){return new ty(e)}get fi(){if(this.Vi)return this.Vi;throw ke(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),ye.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),ye.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ye.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.fi,(i=>{const a=Ie.fromPath(i);return this.gi(e,a).next((l=>{l||n.removeEntry(a,Pe.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return ye.or([()=>ye.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class xh{constructor(e,n){this.persistence=e,this.pi=new Pa((i=>i2(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=yj(this,n)}static mi(e,n){return new xh(e,n)}Ei(){}di(e){return ye.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((a=>i+a))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return ye.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?ye.resolve():n(a)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(c=>this.br(e,c,n).next((d=>{d||(i++,l.removeEntry(c,Pe.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ye.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ye.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ye.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=eh(e.data.value)),n}br(e,n,i){return ye.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return ye.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ny{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=Ye(),a=Ye();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new ny(e,n.fromCache,i,a)}}class Dj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Ij{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return xD()?8:n2(xn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,n,a,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new Dj;return this.Ss(e,n,c).next((d=>{if(l.result=d,this.Vs)return this.bs(e,n,c,d.size)}))})).next((()=>l.result))}bs(e,n,i,a){return i.documentReadCount<this.fs?(Mo()<=$e.DEBUG&&Te("QueryEngine","SDK will not create cache indexes for query:",ko(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ye.resolve()):(Mo()<=$e.DEBUG&&Te("QueryEngine","Query:",ko(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(Mo()<=$e.DEBUG&&Te("QueryEngine","The SDK decides to create cache indexes for query:",ko(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ri(n))):ye.resolve())}ys(e,n){if(hE(n))return ye.resolve(null);let i=ri(n);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=ag(n,null,"F"),i=ri(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=Ye(...l);return this.ps.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,i).next((f=>{const p=this.Ds(n,d);return this.Cs(n,p,c,f.readTime)?this.ys(e,ag(n,null,"F")):this.vs(e,p,n,f)}))))})))))}ws(e,n,i,a){return hE(n)||a.isEqual(Pe.min())?ye.resolve(null):this.ps.getDocuments(e,i).next((l=>{const c=this.Ds(n,l);return this.Cs(n,c,i,a)?ye.resolve(null):(Mo()<=$e.DEBUG&&Te("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),ko(n)),this.vs(e,c,n,XI(a,qc)).next((d=>d)))}))}Ds(e,n){let i=new Zt(US(e));return n.forEach(((a,l)=>{$h(e,l)&&(i=i.add(l))})),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return Mo()<=$e.DEBUG&&Te("QueryEngine","Using full collection scan to execute query:",ko(n)),this.ps.getDocumentsMatchingQuery(e,n,Ps.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(n.forEach((c=>{l=l.insert(c.key,c)})),l)))}}const ry="LocalStore",jj=3e8;class Oj{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new At(We),this.xs=new Pa((l=>Hg(l)),Kg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bj(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function Mj(t,e,n,i){return new Oj(t,e,n,i)}async function cw(t,e){const n=Ve(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],d=[];let f=Ye();for(const p of a){c.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}for(const p of l){d.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}return n.localDocuments.getDocuments(i,f).next((p=>({Ls:p,removedBatchIds:c,addedBatchIds:d})))}))}))}function kj(t,e){const n=Ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,f,p,_){const v=p.batch,b=v.keys();let T=ye.resolve();return b.forEach((w=>{T=T.next((()=>_.getEntry(f,w))).next((A=>{const I=p.docVersions.get(w);at(I!==null,48541),A.version.compareTo(I)<0&&(v.applyToRemoteDocument(A,p),A.isValidDocument()&&(A.setReadTime(p.commitVersion),_.addEntry(A)))}))})),T.next((()=>d.mutationQueue.removeMutationBatch(f,v)))})(n,i,e,l).next((()=>l.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let f=Ye();for(let p=0;p<d.mutationResults.length;++p)d.mutationResults[p].transformResults.length>0&&(f=f.add(d.batch.mutations[p].key));return f})(e)))).next((()=>n.localDocuments.getDocuments(i,a)))}))}function uw(t){const e=Ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function Nj(t,e){const n=Ve(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const d=[];e.targetChanges.forEach(((_,v)=>{const b=a.get(v);if(!b)return;d.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,v))));let T=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?T=T.withResumeToken(yn.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):_.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(_.resumeToken,i)),a=a.insert(v,T),(function(A,I,P){return A.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=jj?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0})(b,T,_)&&d.push(n.Pi.updateTargetData(l,T))}));let f=Ui(),p=Ye();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),d.push(Pj(l,c,e.documentUpdates).next((_=>{f=_.ks,p=_.qs}))),!i.isEqual(Pe.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));d.push(_)}return ye.waitFor(d).next((()=>c.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,f,p))).next((()=>f))})).then((l=>(n.Ms=a,l)))}function Pj(t,e,n){let i=Ye(),a=Ye();return n.forEach((l=>i=i.add(l))),e.getEntries(t,i).next((l=>{let c=Ui();return n.forEach(((d,f)=>{const p=l.get(d);f.isFoundDocument()!==p.isFoundDocument()&&(a=a.add(d)),f.isNoDocument()&&f.version.isEqual(Pe.min())?(e.removeEntry(d,f.readTime),c=c.insert(d,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),c=c.insert(d,f)):Te(ry,"Ignoring outdated watch update for ",d,". Current version:",p.version," Watch version:",f.version)})),{ks:c,qs:a}}))}function Lj(t,e){const n=Ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=qg),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Vj(t,e){const n=Ve(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return n.Pi.getTargetData(i,e).next((l=>l?(a=l,ye.resolve(a)):n.Pi.allocateTargetId(i).next((c=>(a=new Cs(e,c,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function dg(t,e,n){const i=Ve(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!hl(c))throw c;Te(ry,`Failed to update sequence numbers for target ${e}: ${c}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function TE(t,e,n){const i=Ve(t);let a=Pe.min(),l=Ye();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(f,p,_){const v=Ve(f),b=v.xs.get(_);return b!==void 0?ye.resolve(v.Ms.get(b)):v.Pi.getTargetData(p,_)})(i,c,ri(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(c,d.targetId).next((f=>{l=f}))})).next((()=>i.Fs.getDocumentsMatchingQuery(c,e,n?a:Pe.min(),n?l:Ye()))).next((d=>(Bj(i,S2(e),d),{documents:d,Qs:l})))))}function Bj(t,e,n){let i=t.Os.get(e)||Pe.min();n.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),t.Os.set(e,i)}class AE{constructor(){this.activeTargetIds=D2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Uj{constructor(){this.Mo=new AE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new AE,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class zj{Oo(e){}shutdown(){}}const CE="ConnectivityMonitor";class RE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Te(CE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Te(CE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let $d=null;function hg(){return $d===null?$d=(function(){return 268435456+Math.round(2147483648*Math.random())})():$d++,"0x"+$d.toString(16)}const Dp="RestConnection",Fj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class qj{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===ph?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const c=hg(),d=this.zo(e,n.toUriEncodedString());Te(Dp,`Sending RPC '${e}' ${c}:`,d,i);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,l);const{host:p}=new URL(d),_=ll(p);return this.Jo(e,d,f,i,_).then((v=>(Te(Dp,`Received RPC '${e}' ${c}: `,v),v)),(v=>{throw Wo(Dp,`RPC '${e}' ${c} failed with error: `,v,"url: ",d,"request:",i),v}))}Ho(e,n,i,a,l,c){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+ul})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,n){const i=Fj[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class Qj{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const vn="WebChannelConnection";class Gj extends qj{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const c=hg();return new Promise(((d,f)=>{const p=new fS;p.setWithCredentials(!0),p.listenOnce(mS.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Zd.NO_ERROR:const v=p.getResponseJson();Te(vn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(v)),d(v);break;case Zd.TIMEOUT:Te(vn,`RPC '${e}' ${c} timed out`),f(new we(ge.DEADLINE_EXCEEDED,"Request time out"));break;case Zd.HTTP_ERROR:const b=p.getStatus();if(Te(vn,`RPC '${e}' ${c} failed with status:`,b,"response text:",p.getResponseText()),b>0){let T=p.getResponseJson();Array.isArray(T)&&(T=T[0]);const w=T?.error;if(w&&w.status&&w.message){const A=(function(P){const G=P.toLowerCase().replace(/_/g,"-");return Object.values(ge).indexOf(G)>=0?G:ge.UNKNOWN})(w.status);f(new we(A,w.message))}else f(new we(ge.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new we(ge.UNAVAILABLE,"Connection failed."));break;default:ke(9055,{l_:e,streamId:c,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Te(vn,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(a);Te(vn,`RPC '${e}' ${c} sending request:`,a),p.send(n,"POST",_,i,15)}))}T_(e,n,i){const a=hg(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=yS(),d=gS(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,n,i),f.encodeInitMessageHeaders=!0;const _=l.join("");Te(vn,`Creating RPC '${e}' stream ${a}: ${_}`,f);const v=c.createWebChannel(_,f);this.I_(v);let b=!1,T=!1;const w=new Qj({Yo:I=>{T?Te(vn,`Not sending because RPC '${e}' stream ${a} is closed:`,I):(b||(Te(vn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),b=!0),Te(vn,`RPC '${e}' stream ${a} sending:`,I),v.send(I))},Zo:()=>v.close()}),A=(I,P,G)=>{I.listen(P,(Q=>{try{G(Q)}catch(X){setTimeout((()=>{throw X}),0)}}))};return A(v,Ic.EventType.OPEN,(()=>{T||(Te(vn,`RPC '${e}' stream ${a} transport opened.`),w.o_())})),A(v,Ic.EventType.CLOSE,(()=>{T||(T=!0,Te(vn,`RPC '${e}' stream ${a} transport closed`),w.a_(),this.E_(v))})),A(v,Ic.EventType.ERROR,(I=>{T||(T=!0,Wo(vn,`RPC '${e}' stream ${a} transport errored. Name:`,I.name,"Message:",I.message),w.a_(new we(ge.UNAVAILABLE,"The operation could not be completed")))})),A(v,Ic.EventType.MESSAGE,(I=>{if(!T){const P=I.data[0];at(!!P,16349);const G=P,Q=G?.error||G[0]?.error;if(Q){Te(vn,`RPC '${e}' stream ${a} received error:`,Q);const X=Q.status;let Z=(function(C){const R=Qt[C];if(R!==void 0)return XS(R)})(X),oe=Q.message;Z===void 0&&(Z=ge.INTERNAL,oe="Unknown error status: "+X+" with message "+Q.message),T=!0,w.a_(new we(Z,oe)),v.close()}else Te(vn,`RPC '${e}' stream ${a} received:`,P),w.u_(P)}})),A(d,pS.STAT_EVENT,(I=>{I.stat===Zp.PROXY?Te(vn,`RPC '${e}' stream ${a} detected buffering proxy`):I.stat===Zp.NOPROXY&&Te(vn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function Ip(){return typeof document<"u"?document:null}function Jh(t){return new W2(t,!0)}class dw{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&Te("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const DE="PersistentStream";class hw{constructor(e,n,i,a,l,c,d,f){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new dw(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===ge.RESOURCE_EXHAUSTED?(Bi(n.toString()),Bi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===n&&this.G_(i,a)}),(i=>{e((()=>{const a=new we(ge.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Te(DE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Te(DE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Hj extends hw{constructor(e,n,i,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=J2(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Pe.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Pe.min():c.readTime?ii(c.readTime):Pe.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=ug(this.serializer),n.addTarget=(function(l,c){let d;const f=c.target;if(d=ig(f)?{documents:tj(l,f)}:{query:nj(l,f).ft},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=ew(l,c.resumeToken);const p=og(l,c.expectedCount);p!==null&&(d.expectedCount=p)}else if(c.snapshotVersion.compareTo(Pe.min())>0){d.readTime=Eh(l,c.snapshotVersion.toTimestamp());const p=og(l,c.expectedCount);p!==null&&(d.expectedCount=p)}return d})(this.serializer,e);const i=ij(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=ug(this.serializer),n.removeTarget=e,this.q_(n)}}class Kj extends hw{constructor(e,n,i,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return at(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,at(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){at(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=ej(e.writeResults,e.commitTime),i=ii(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=ug(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>Z2(this.serializer,i)))};this.q_(n)}}class $j{}class Wj extends $j{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new we(ge.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,lg(n,i),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new we(ge.UNKNOWN,l.toString())}))}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Ho(e,lg(n,i),a,c,d,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new we(ge.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Yj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Bi(n),this.aa=!1):Te("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Oa="RemoteStore";class Xj{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{i.enqueueAndForget((async()=>{La(this)&&(Te(Oa,"Restarting streams for network reachability change."),await(async function(f){const p=Ve(f);p.Ea.add(4),await su(p),p.Ra.set("Unknown"),p.Ea.delete(4),await Zh(p)})(this))}))})),this.Ra=new Yj(i,a)}}async function Zh(t){if(La(t))for(const e of t.da)await e(!0)}async function su(t){for(const e of t.da)await e(!1)}function fw(t,e){const n=Ve(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),oy(n)?ay(n):fl(n).O_()&&sy(n,e))}function iy(t,e){const n=Ve(t),i=fl(n);n.Ia.delete(e),i.O_()&&mw(n,e),n.Ia.size===0&&(i.O_()?i.L_():La(n)&&n.Ra.set("Unknown"))}function sy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}fl(t).Y_(e)}function mw(t,e){t.Va.Ue(e),fl(t).Z_(e)}function ay(t){t.Va=new G2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),fl(t).start(),t.Ra.ua()}function oy(t){return La(t)&&!fl(t).x_()&&t.Ia.size>0}function La(t){return Ve(t).Ea.size===0}function pw(t){t.Va=void 0}async function Jj(t){t.Ra.set("Online")}async function Zj(t){t.Ia.forEach(((e,n)=>{sy(t,e)}))}async function e5(t,e){pw(t),oy(t)?(t.Ra.ha(e),ay(t)):t.Ra.set("Unknown")}async function t5(t,e,n){if(t.Ra.set("Online"),e instanceof ZS&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const d of l.targetIds)a.Ia.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.Ia.delete(d),a.Va.removeTarget(d))})(t,e)}catch(i){Te(Oa,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Sh(t,i)}else if(e instanceof rh?t.Va.Ze(e):e instanceof JS?t.Va.st(e):t.Va.tt(e),!n.isEqual(Pe.min()))try{const i=await uw(t.localStore);n.compareTo(i)>=0&&await(function(l,c){const d=l.Va.Tt(c);return d.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const _=l.Ia.get(p);_&&l.Ia.set(p,_.withResumeToken(f.resumeToken,c))}})),d.targetMismatches.forEach(((f,p)=>{const _=l.Ia.get(f);if(!_)return;l.Ia.set(f,_.withResumeToken(yn.EMPTY_BYTE_STRING,_.snapshotVersion)),mw(l,f);const v=new Cs(_.target,f,p,_.sequenceNumber);sy(l,v)})),l.remoteSyncer.applyRemoteEvent(d)})(t,n)}catch(i){Te(Oa,"Failed to raise snapshot:",i),await Sh(t,i)}}async function Sh(t,e,n){if(!hl(e))throw e;t.Ea.add(1),await su(t),t.Ra.set("Offline"),n||(n=()=>uw(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Te(Oa,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Zh(t)}))}function gw(t,e){return e().catch((n=>Sh(t,n,e)))}async function ef(t){const e=Ve(t),n=Us(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:qg;for(;n5(e);)try{const a=await Lj(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,r5(e,a)}catch(a){await Sh(e,a)}yw(e)&&_w(e)}function n5(t){return La(t)&&t.Ta.length<10}function r5(t,e){t.Ta.push(e);const n=Us(t);n.O_()&&n.X_&&n.ea(e.mutations)}function yw(t){return La(t)&&!Us(t).x_()&&t.Ta.length>0}function _w(t){Us(t).start()}async function i5(t){Us(t).ra()}async function s5(t){const e=Us(t);for(const n of t.Ta)e.ea(n.mutations)}async function a5(t,e,n){const i=t.Ta.shift(),a=Xg.from(i,e,n);await gw(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await ef(t)}async function o5(t,e){e&&Us(t).X_&&await(async function(i,a){if((function(c){return F2(c)&&c!==ge.ABORTED})(a.code)){const l=i.Ta.shift();Us(i).B_(),await gw(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await ef(i)}})(t,e),yw(t)&&_w(t)}async function IE(t,e){const n=Ve(t);n.asyncQueue.verifyOperationInProgress(),Te(Oa,"RemoteStore received new credentials");const i=La(n);n.Ea.add(3),await su(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Zh(n)}async function l5(t,e){const n=Ve(t);e?(n.Ea.delete(2),await Zh(n)):e||(n.Ea.add(2),await su(n),n.Ra.set("Unknown"))}function fl(t){return t.ma||(t.ma=(function(n,i,a){const l=Ve(n);return l.sa(),new Hj(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:Jj.bind(null,t),t_:Zj.bind(null,t),r_:e5.bind(null,t),H_:t5.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),oy(t)?ay(t):t.Ra.set("Unknown")):(await t.ma.stop(),pw(t))}))),t.ma}function Us(t){return t.fa||(t.fa=(function(n,i,a){const l=Ve(n);return l.sa(),new Kj(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:i5.bind(null,t),r_:o5.bind(null,t),ta:s5.bind(null,t),na:a5.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await ef(t)):(await t.fa.stop(),t.Ta.length>0&&(Te(Oa,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class ly{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Pi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const c=Date.now()+i,d=new ly(e,n,c,a,l);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cy(t,e){if(Bi("AsyncQueue",`${e}: ${t}`),hl(t))return new we(ge.UNAVAILABLE,`${e}: ${t}`);throw t}class Vo{static emptySet(e){return new Vo(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||Ie.comparator(n.key,i.key):(n,i)=>Ie.comparator(n.key,i.key),this.keyedMap=jc(),this.sortedSet=new At(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Vo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Vo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class jE{constructor(){this.ga=new At(Ie.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ke(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class tl{constructor(e,n,i,a,l,c,d,f,p){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,n,i,a,l){const c=[];return n.forEach((d=>{c.push({type:0,doc:d})})),new tl(e,n,Vo.emptySet(n),c,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}class c5{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class u5{constructor(){this.queries=OE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=Ve(n),l=a.queries;a.queries=OE(),l.forEach(((c,d)=>{for(const f of d.Sa)f.onError(i)}))})(this,new we(ge.ABORTED,"Firestore shutting down"))}}function OE(){return new Pa((t=>BS(t)),Kh)}async function vw(t,e){const n=Ve(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new c5,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(c){const d=cy(c,`Initialization of query '${ko(e.query)}' failed`);return void e.onError(d)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&uy(n)}async function bw(t,e){const n=Ve(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function d5(t,e){const n=Ve(t);let i=!1;for(const a of e){const l=a.query,c=n.queries.get(l);if(c){for(const d of c.Sa)d.Fa(a)&&(i=!0);c.wa=a}}i&&uy(n)}function h5(t,e,n){const i=Ve(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function uy(t){t.Ca.forEach((e=>{e.next()}))}var fg,ME;(ME=fg||(fg={})).Ma="default",ME.Cache="cache";class Ew{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new tl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=tl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==fg.Cache}}class xw{constructor(e){this.key=e}}class Sw{constructor(e){this.key=e}}class f5{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ye(),this.mutatedKeys=Ye(),this.eu=US(e),this.tu=new Vo(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new jE,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,c=a,d=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,p=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,v)=>{const b=a.get(_),T=$h(this.query,v)?v:null,w=!!b&&this.mutatedKeys.has(b.key),A=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let I=!1;b&&T?b.data.isEqual(T.data)?w!==A&&(i.track({type:3,doc:T}),I=!0):this.su(b,T)||(i.track({type:2,doc:T}),I=!0,(f&&this.eu(T,f)>0||p&&this.eu(T,p)<0)&&(d=!0)):!b&&T?(i.track({type:0,doc:T}),I=!0):b&&!T&&(i.track({type:1,doc:b}),I=!0,(f||p)&&(d=!0)),I&&(T?(c=c.add(T),l=A?l.add(_):l.delete(_)):(c=c.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:c,iu:i,Cs:d,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,v)=>(function(T,w){const A=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ke(20277,{Rt:I})}};return A(T)-A(w)})(_.type,v.type)||this.eu(_.doc,v.doc))),this.ou(i),a=a??!1;const d=n&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,p=f!==this.Za;return this.Za=f,c.length!==0||p?{snapshot:new tl(this.query,e.tu,l,c,e.mutatedKeys,f===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new jE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ye(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new Sw(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new xw(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=Ye();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return tl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const dy="SyncEngine";class m5{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class p5{constructor(e){this.key=e,this.hu=!1}}class g5{constructor(e,n,i,a,l,c){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Pa((d=>BS(d)),Kh),this.Iu=new Map,this.Eu=new Set,this.du=new At(Ie.comparator),this.Au=new Map,this.Ru=new ey,this.Vu={},this.mu=new Map,this.fu=el.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function y5(t,e,n=!0){const i=Dw(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await ww(i,e,n,!0),a}async function _5(t,e){const n=Dw(t);await ww(n,e,!0,!1)}async function ww(t,e,n,i){const a=await Vj(t.localStore,ri(e)),l=a.targetId,c=t.sharedClientState.addLocalQueryTarget(l,n);let d;return i&&(d=await v5(t,e,l,c==="current",a.resumeToken)),t.isPrimaryClient&&n&&fw(t.remoteStore,a),d}async function v5(t,e,n,i,a){t.pu=(v,b,T)=>(async function(A,I,P,G){let Q=I.view.ru(P);Q.Cs&&(Q=await TE(A.localStore,I.query,!1).then((({documents:O})=>I.view.ru(O,Q))));const X=G&&G.targetChanges.get(I.targetId),Z=G&&G.targetMismatches.get(I.targetId)!=null,oe=I.view.applyChanges(Q,A.isPrimaryClient,X,Z);return NE(A,I.targetId,oe.au),oe.snapshot})(t,v,b,T);const l=await TE(t.localStore,e,!0),c=new f5(e,l.Qs),d=c.ru(l.documents),f=iu.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),p=c.applyChanges(d,t.isPrimaryClient,f);NE(t,n,p.au);const _=new m5(e,n,c);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),p.snapshot}async function b5(t,e,n){const i=Ve(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((c=>!Kh(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await dg(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&iy(i.remoteStore,a.targetId),mg(i,a.targetId)})).catch(dl)):(mg(i,a.targetId),await dg(i.localStore,a.targetId,!0))}async function E5(t,e){const n=Ve(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),iy(n.remoteStore,i.targetId))}async function x5(t,e,n){const i=D5(t);try{const a=await(function(c,d){const f=Ve(c),p=vt.now(),_=d.reduce(((T,w)=>T.add(w.key)),Ye());let v,b;return f.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let w=Ui(),A=Ye();return f.Ns.getEntries(T,_).next((I=>{w=I,w.forEach(((P,G)=>{G.isValidDocument()||(A=A.add(P))}))})).next((()=>f.localDocuments.getOverlayedDocuments(T,w))).next((I=>{v=I;const P=[];for(const G of d){const Q=L2(G,v.get(G.key).overlayedDocument);Q!=null&&P.push(new Gs(G.key,Q,jS(Q.value.mapValue),Rr.exists(!0)))}return f.mutationQueue.addMutationBatch(T,p,P,d)})).next((I=>{b=I;const P=I.applyToLocalDocumentSet(v,A);return f.documentOverlayCache.saveOverlays(T,I.batchId,P)}))})).then((()=>({batchId:b.batchId,changes:FS(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(c,d,f){let p=c.Vu[c.currentUser.toKey()];p||(p=new At(We)),p=p.insert(d,f),c.Vu[c.currentUser.toKey()]=p})(i,a.batchId,n),await au(i,a.changes),await ef(i.remoteStore)}catch(a){const l=cy(a,"Failed to persist write");n.reject(l)}}async function Tw(t,e){const n=Ve(t);try{const i=await Nj(n.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=n.Au.get(l);c&&(at(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?at(c.hu,14607):a.removedDocuments.size>0&&(at(c.hu,42227),c.hu=!1))})),await au(n,i,e)}catch(i){await dl(i)}}function kE(t,e,n){const i=Ve(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach(((l,c)=>{const d=c.view.va(e);d.snapshot&&a.push(d.snapshot)})),(function(c,d){const f=Ve(c);f.onlineState=d;let p=!1;f.queries.forEach(((_,v)=>{for(const b of v.Sa)b.va(d)&&(p=!0)})),p&&uy(f)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function S5(t,e,n){const i=Ve(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let c=new At(Ie.comparator);c=c.insert(l,En.newNoDocument(l,Pe.min()));const d=Ye().add(l),f=new Xh(Pe.min(),new Map,new At(We),c,d);await Tw(i,f),i.du=i.du.remove(l),i.Au.delete(e),hy(i)}else await dg(i.localStore,e,!1).then((()=>mg(i,e,n))).catch(dl)}async function w5(t,e){const n=Ve(t),i=e.batch.batchId;try{const a=await kj(n.localStore,e);Cw(n,i,null),Aw(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await au(n,a)}catch(a){await dl(a)}}async function T5(t,e,n){const i=Ve(t);try{const a=await(function(c,d){const f=Ve(c);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let _;return f.mutationQueue.lookupMutationBatch(p,d).next((v=>(at(v!==null,37113),_=v.keys(),f.mutationQueue.removeMutationBatch(p,v)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,_,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_))).next((()=>f.localDocuments.getDocuments(p,_)))}))})(i.localStore,e);Cw(i,e,n),Aw(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await au(i,a)}catch(a){await dl(a)}}function Aw(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Cw(t,e,n){const i=Ve(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function mg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||Rw(t,i)}))}function Rw(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(iy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),hy(t))}function NE(t,e,n){for(const i of n)i instanceof xw?(t.Ru.addReference(i.key,e),A5(t,i)):i instanceof Sw?(Te(dy,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||Rw(t,i.key)):ke(19791,{wu:i})}function A5(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(Te(dy,"New document in limbo: "+n),t.Eu.add(i),hy(t))}function hy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Ie(gt.fromString(e)),i=t.fu.next();t.Au.set(i,new p5(n)),t.du=t.du.insert(n,i),fw(t.remoteStore,new Cs(ri($g(n.path)),i,"TargetPurposeLimboResolution",Qh.ce))}}async function au(t,e,n){const i=Ve(t),a=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,f)=>{c.push(i.pu(f,e,n).then((p=>{if((p||n)&&i.isPrimaryClient){const _=p?!p.fromCache:n?.targetChanges.get(f.targetId)?.current;i.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(p){a.push(p);const _=ny.As(f.targetId,p);l.push(_)}})))})),await Promise.all(c),i.Pu.H_(a),await(async function(f,p){const _=Ve(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ye.forEach(p,(b=>ye.forEach(b.Es,(T=>_.persistence.referenceDelegate.addReference(v,b.targetId,T))).next((()=>ye.forEach(b.ds,(T=>_.persistence.referenceDelegate.removeReference(v,b.targetId,T)))))))))}catch(v){if(!hl(v))throw v;Te(ry,"Failed to update sequence numbers: "+v)}for(const v of p){const b=v.targetId;if(!v.fromCache){const T=_.Ms.get(b),w=T.snapshotVersion,A=T.withLastLimboFreeSnapshotVersion(w);_.Ms=_.Ms.insert(b,A)}}})(i.localStore,l))}async function C5(t,e){const n=Ve(t);if(!n.currentUser.isEqual(e)){Te(dy,"User change. New user:",e.toKey());const i=await cw(n.localStore,e);n.currentUser=e,(function(l,c){l.mu.forEach((d=>{d.forEach((f=>{f.reject(new we(ge.CANCELLED,c))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await au(n,i.Ls)}}function R5(t,e){const n=Ve(t),i=n.Au.get(e);if(i&&i.hu)return Ye().add(i.key);{let a=Ye();const l=n.Iu.get(e);if(!l)return a;for(const c of l){const d=n.Tu.get(c);a=a.unionWith(d.view.nu)}return a}}function Dw(t){const e=Ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Tw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=R5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=S5.bind(null,e),e.Pu.H_=d5.bind(null,e.eventManager),e.Pu.yu=h5.bind(null,e.eventManager),e}function D5(t){const e=Ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=w5.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=T5.bind(null,e),e}class wh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Jh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return Mj(this.persistence,new Ij,e.initialUser,this.serializer)}Cu(e){return new lw(ty.mi,this.serializer)}Du(e){return new Uj}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wh.provider={build:()=>new wh};class I5 extends wh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){at(this.persistence.referenceDelegate instanceof xh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new pj(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?kn.withCacheSize(this.cacheSizeBytes):kn.DEFAULT;return new lw((i=>xh.mi(i,n)),this.serializer)}}class pg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>kE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=C5.bind(null,this.syncEngine),await l5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new u5})()}createDatastore(e){const n=Jh(e.databaseInfo.databaseId),i=(function(l){return new Gj(l)})(e.databaseInfo);return(function(l,c,d,f){return new Wj(l,c,d,f)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,a,l,c,d){return new Xj(i,a,l,c,d)})(this.localStore,this.datastore,e.asyncQueue,(n=>kE(this.syncEngine,n,0)),(function(){return RE.v()?new RE:new zj})())}createSyncEngine(e,n){return(function(a,l,c,d,f,p,_){const v=new g5(a,l,c,d,f,p);return _&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Ve(n);Te(Oa,"RemoteStore shutting down."),i.Ea.add(5),await su(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}pg.provider={build:()=>new pg};class Iw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Bi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const zs="FirestoreClient";class j5{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=bn.UNAUTHENTICATED,this.clientId=Fg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{Te(zs,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Te(zs,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Pi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=cy(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function jp(t,e){t.asyncQueue.verifyOperationInProgress(),Te(zs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async a=>{i.isEqual(a)||(await cw(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function PE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await O5(t);Te(zs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>IE(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,a)=>IE(e.remoteStore,a))),t._onlineComponents=e}async function O5(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Te(zs,"Using user provided OfflineComponentProvider");try{await jp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ge.FAILED_PRECONDITION||a.code===ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;Wo("Error using user provided cache. Falling back to memory cache: "+n),await jp(t,new wh)}}else Te(zs,"Using default OfflineComponentProvider"),await jp(t,new I5(void 0));return t._offlineComponents}async function jw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Te(zs,"Using user provided OnlineComponentProvider"),await PE(t,t._uninitializedComponentsProvider._online)):(Te(zs,"Using default OnlineComponentProvider"),await PE(t,new pg))),t._onlineComponents}function M5(t){return jw(t).then((e=>e.syncEngine))}async function Ow(t){const e=await jw(t),n=e.eventManager;return n.onListen=y5.bind(null,e.syncEngine),n.onUnlisten=b5.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=_5.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=E5.bind(null,e.syncEngine),n}function k5(t,e,n={}){const i=new Pi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,f,p){const _=new Iw({next:b=>{_.Nu(),c.enqueueAndForget((()=>bw(l,v)));const T=b.docs.has(d);!T&&b.fromCache?p.reject(new we(ge.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&b.fromCache&&f&&f.source==="server"?p.reject(new we(ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(b)},error:b=>p.reject(b)}),v=new Ew($g(d.path),_,{includeMetadataChanges:!0,qa:!0});return vw(l,v)})(await Ow(t),t.asyncQueue,e,n,i))),i.promise}function N5(t,e,n={}){const i=new Pi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,f,p){const _=new Iw({next:b=>{_.Nu(),c.enqueueAndForget((()=>bw(l,v))),b.fromCache&&f.source==="server"?p.reject(new we(ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(b)},error:b=>p.reject(b)}),v=new Ew(d,_,{includeMetadataChanges:!0,qa:!0});return vw(l,v)})(await Ow(t),t.asyncQueue,e,n,i))),i.promise}function Mw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const LE=new Map;const kw="firestore.googleapis.com",VE=!0;class BE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new we(ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=kw,this.ssl=VE}else this.host=e.host,this.ssl=e.ssl??VE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=ow;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<fj)throw new we(ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}YI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Mw(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new we(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new we(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new we(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tf{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new BE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new BE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new UI;switch(i.type){case"firstParty":return new QI(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new we(ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=LE.get(n);i&&(Te("ComponentProvider","Removing Datastore"),LE.delete(n),i.terminate())})(this),Promise.resolve()}}function P5(t,e,n,i={}){t=ui(t,tf);const a=ll(e),l=t._getSettings(),c={...l,emulatorOptions:t._getEmulatorOptions()},d=`${e}:${n}`;a&&(iS(`https://${d}`),sS("Firestore",!0)),l.host!==kw&&l.host!==d&&Wo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...l,host:d,ssl:a,emulatorOptions:i};if(!Ns(f,c)&&(t._setSettings(f),i.mockUserToken)){let p,_;if(typeof i.mockUserToken=="string")p=i.mockUserToken,_=bn.MOCK_USER;else{p=fD(i.mockUserToken,t._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new we(ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new bn(v)}t._authCredentials=new zI(new vS(p,_))}}class ml{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new ml(this.firestore,e,this._query)}}class Nt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ms(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nt(this.firestore,e,this._key)}toJSON(){return{type:Nt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(tu(n,Nt._jsonSchema))return new Nt(e,i||null,new Ie(gt.fromString(n.referencePath)))}}Nt._jsonSchemaVersion="firestore/documentReference/1.0",Nt._jsonSchema={type:Kt("string",Nt._jsonSchemaVersion),referencePath:Kt("string")};class Ms extends ml{constructor(e,n,i){super(e,n,$g(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nt(this.firestore,null,new Ie(e))}withConverter(e){return new Ms(this.firestore,e,this._path)}}function L5(t,e,...n){if(t=sn(t),bS("collection","path",e),t instanceof tf){const i=gt.fromString(e,...n);return Jb(i),new Ms(t,null,i)}{if(!(t instanceof Nt||t instanceof Ms))throw new we(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(gt.fromString(e,...n));return Jb(i),new Ms(t.firestore,null,i)}}function nf(t,e,...n){if(t=sn(t),arguments.length===1&&(e=Fg.newId()),bS("doc","path",e),t instanceof tf){const i=gt.fromString(e,...n);return Xb(i),new Nt(t,null,new Ie(i))}{if(!(t instanceof Nt||t instanceof Ms))throw new we(ge.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(gt.fromString(e,...n));return Xb(i),new Nt(t.firestore,t instanceof Ms?t.converter:null,new Ie(i))}}const UE="AsyncQueue";class zE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new dw(this,"async_queue_retry"),this._c=()=>{const i=Ip();i&&Te(UE,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Ip();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Ip();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Pi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!hl(e))throw e;Te(UE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Bi("INTERNAL UNHANDLED ERROR: ",FE(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=ly.createAndSchedule(this,e,n,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&ke(47125,{Pc:FE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function FE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class pl extends tf{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new zE,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new zE(e),this._firestoreClient=void 0,await e}}}function V5(t,e){const n=typeof t=="object"?t:cS(),i=typeof t=="string"?t:ph,a=Ug(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=dD("firestore");l&&P5(a,...l)}return a}function fy(t){if(t._terminated)throw new we(ge.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||B5(t),t._firestoreClient}function B5(t){const e=t._freezeSettings(),n=(function(a,l,c,d){return new o2(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Mw(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new j5(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(t._componentsProvider))}class cr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cr(yn.fromBase64String(e))}catch(n){throw new we(ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new cr(yn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:cr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(tu(e,cr._jsonSchema))return cr.fromBase64String(e.bytes)}}cr._jsonSchemaVersion="firestore/bytes/1.0",cr._jsonSchema={type:Kt("string",cr._jsonSchemaVersion),bytes:Kt("string")};class rf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new we(ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class sf{constructor(e){this._methodName=e}}class si{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new we(ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new we(ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return We(this._lat,e._lat)||We(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:si._jsonSchemaVersion}}static fromJSON(e){if(tu(e,si._jsonSchema))return new si(e.latitude,e.longitude)}}si._jsonSchemaVersion="firestore/geoPoint/1.0",si._jsonSchema={type:Kt("string",si._jsonSchemaVersion),latitude:Kt("number"),longitude:Kt("number")};class ai{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ai._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(tu(e,ai._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new ai(e.vectorValues);throw new we(ge.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ai._jsonSchemaVersion="firestore/vectorValue/1.0",ai._jsonSchema={type:Kt("string",ai._jsonSchemaVersion),vectorValues:Kt("object")};const U5=/^__.*__$/;class z5{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new Gs(e,this.data,this.fieldMask,n,this.fieldTransforms):new ru(e,this.data,n,this.fieldTransforms)}}class Nw{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new Gs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Pw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ke(40011,{Ac:t})}}class af{constructor(e,n,i,a,l,c){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new af({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Th(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Pw(this.Ac)&&U5.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class F5{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||Jh(e)}Cc(e,n,i,a=!1){return new af({Ac:e,methodName:n,Dc:i,path:pn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function my(t){const e=t._freezeSettings(),n=Jh(t._databaseId);return new F5(t._databaseId,!!e.ignoreUndefinedProperties,n)}function q5(t,e,n,i,a,l={}){const c=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);gy("Data must be an object, but it was:",c,i);const d=Lw(i,c);let f,p;if(l.merge)f=new Hn(c.fieldMask),p=c.fieldTransforms;else if(l.mergeFields){const _=[];for(const v of l.mergeFields){const b=gg(e,v,n);if(!c.contains(b))throw new we(ge.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);Bw(_,b)||_.push(b)}f=new Hn(_),p=c.fieldTransforms.filter((v=>f.covers(v.field)))}else f=null,p=c.fieldTransforms;return new z5(new Nn(d),f,p)}class of extends sf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof of}}function Q5(t,e,n){return new af({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class py extends sf{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=Q5(this,e,!0),i=this.vc.map((l=>gl(l,n))),a=new Zo(i);return new M2(e.path,a)}isEqual(e){return e instanceof py&&Ns(this.vc,e.vc)}}function G5(t,e,n,i){const a=t.Cc(1,e,n);gy("Data must be an object, but it was:",a,i);const l=[],c=Nn.empty();Qs(i,((f,p)=>{const _=yy(e,f,n);p=sn(p);const v=a.yc(_);if(p instanceof of)l.push(_);else{const b=gl(p,v);b!=null&&(l.push(_),c.set(_,b))}}));const d=new Hn(l);return new Nw(c,d,a.fieldTransforms)}function H5(t,e,n,i,a,l){const c=t.Cc(1,e,n),d=[gg(e,i,n)],f=[a];if(l.length%2!=0)throw new we(ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<l.length;b+=2)d.push(gg(e,l[b])),f.push(l[b+1]);const p=[],_=Nn.empty();for(let b=d.length-1;b>=0;--b)if(!Bw(p,d[b])){const T=d[b];let w=f[b];w=sn(w);const A=c.yc(T);if(w instanceof of)p.push(T);else{const I=gl(w,A);I!=null&&(p.push(T),_.set(T,I))}}const v=new Hn(p);return new Nw(_,v,c.fieldTransforms)}function K5(t,e,n,i=!1){return gl(n,t.Cc(i?4:3,e))}function gl(t,e){if(Vw(t=sn(t)))return gy("Unsupported field value:",e,t),Lw(t,e);if(t instanceof sf)return(function(i,a){if(!Pw(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let c=0;for(const d of i){let f=gl(d,a.wc(c));f==null&&(f={nullValue:"NULL_VALUE"}),l.push(f),c++}return{arrayValue:{values:l}}})(t,e)}return(function(i,a){if((i=sn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return I2(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=vt.fromDate(i);return{timestampValue:Eh(a.serializer,l)}}if(i instanceof vt){const l=new vt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Eh(a.serializer,l)}}if(i instanceof si)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof cr)return{bytesValue:ew(a.serializer,i._byteString)};if(i instanceof Nt){const l=a.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw a.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Zg(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof ai)return(function(c,d){return{mapValue:{fields:{[DS]:{stringValue:IS},[gh]:{arrayValue:{values:c.toArray().map((p=>{if(typeof p!="number")throw d.Sc("VectorValues must only contain numeric values.");return Wg(d.serializer,p)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${qh(i)}`)})(t,e)}function Lw(t,e){const n={};return SS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qs(t,((i,a)=>{const l=gl(a,e.mc(i));l!=null&&(n[i]=l)})),{mapValue:{fields:n}}}function Vw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vt||t instanceof si||t instanceof cr||t instanceof Nt||t instanceof sf||t instanceof ai)}function gy(t,e,n){if(!Vw(n)||!ES(n)){const i=qh(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function gg(t,e,n){if((e=sn(e))instanceof rf)return e._internalPath;if(typeof e=="string")return yy(t,e);throw Th("Field path arguments must be of type string or ",t,!1,void 0,n)}const $5=new RegExp("[~\\*/\\[\\]]");function yy(t,e,n){if(e.search($5)>=0)throw Th(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new rf(...e.split("."))._internalPath}catch{throw Th(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Th(t,e,n,i,a){const l=i&&!i.isEmpty(),c=a!==void 0;let d=`Function ${e}() called with invalid data`;n&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(l||c)&&(f+=" (found",l&&(f+=` in field ${i}`),c&&(f+=` in document ${a}`),f+=")"),new we(ge.INVALID_ARGUMENT,d+t+f)}function Bw(t,e){return t.some((n=>n.isEqual(e)))}class Uw{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Nt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new W5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(_y("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class W5 extends Uw{data(){return super.data()}}function _y(t,e){return typeof e=="string"?yy(t,e):e instanceof rf?e._internalPath:e._delegate._internalPath}function Y5(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new we(ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vy{}class X5 extends vy{}function J5(t,e,...n){let i=[];e instanceof vy&&i.push(e),i=i.concat(n),(function(l){const c=l.filter((f=>f instanceof by)).length,d=l.filter((f=>f instanceof lf)).length;if(c>1||c>0&&d>0)throw new we(ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)t=a._apply(t);return t}class lf extends X5{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new lf(e,n,i)}_apply(e){const n=this._parse(e);return zw(e._query,n),new ml(e.firestore,e.converter,sg(e._query,n))}_parse(e){const n=my(e.firestore);return(function(l,c,d,f,p,_,v){let b;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new we(ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){QE(v,_);const w=[];for(const A of v)w.push(qE(f,l,A));b={arrayValue:{values:w}}}else b=qE(f,l,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||QE(v,_),b=K5(d,c,v,_==="in"||_==="not-in");return Ht.create(p,_,b)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Z5(t,e,n){const i=e,a=_y("where",t);return lf._create(a,i,n)}class by extends vy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new by(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Dr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,l){let c=a;const d=l.getFlattenedFilters();for(const f of d)zw(c,f),c=sg(c,f)})(e._query,n),new ml(e.firestore,e.converter,sg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function qE(t,e,n){if(typeof(n=sn(n))=="string"){if(n==="")throw new we(ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!VS(e)&&n.indexOf("/")!==-1)throw new we(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(gt.fromString(n));if(!Ie.isDocumentKey(i))throw new we(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return aE(t,new Ie(i))}if(n instanceof Nt)return aE(t,n._key);throw new we(ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${qh(n)}.`)}function QE(t,e){if(!Array.isArray(t)||t.length===0)throw new we(ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function zw(t,e){const n=(function(a,l){for(const c of a)for(const d of c.getFlattenedFilters())if(l.indexOf(d.op)>=0)return d.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new we(ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new we(ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class eO{convertValue(e,n="none"){switch(Bs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Vs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ke(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return Qs(e,((a,l)=>{i[a]=this.convertValue(l,n)})),i}convertVectorValue(e){const n=e.fields?.[gh].arrayValue?.values?.map((i=>kt(i.doubleValue)));return new ai(n)}convertGeoPoint(e){return new si(kt(e.latitude),kt(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Hh(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Qc(e));default:return null}}convertTimestamp(e){const n=Ls(e);return new vt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=gt.fromString(e);at(aw(i),9688,{name:e});const a=new Gc(i.get(1),i.get(3)),l=new Ie(i.popFirst(5));return a.isEqual(n)||Bi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function tO(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Mc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ca extends Uw{constructor(e,n,i,a,l,c){super(e,n,i,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ih(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(_y("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new we(ge.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ca._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ca._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ca._jsonSchema={type:Kt("string",Ca._jsonSchemaVersion),bundleSource:Kt("string","DocumentSnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class ih extends Ca{data(e={}){return super.data(e)}}class Bo{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Mc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new ih(this._firestore,this._userDataWriter,i.key,i,new Mc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new we(ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((d=>{const f=new ih(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Mc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const f=new ih(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Mc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let p=-1,_=-1;return d.type!==0&&(p=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),_=c.indexOf(d.doc.key)),{type:nO(d.type),doc:f,oldIndex:p,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new we(ge.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Fg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function nO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ke(61501,{type:t})}}function rO(t){t=ui(t,Nt);const e=ui(t.firestore,pl);return k5(fy(e),t._key).then((n=>lO(e,t,n)))}Bo._jsonSchemaVersion="firestore/querySnapshot/1.0",Bo._jsonSchema={type:Kt("string",Bo._jsonSchemaVersion),bundleSource:Kt("string","QuerySnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class Fw extends eO{constructor(e){super(),this.firestore=e}convertBytes(e){return new cr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Nt(this.firestore,null,n)}}function iO(t){t=ui(t,ml);const e=ui(t.firestore,pl),n=fy(e),i=new Fw(e);return Y5(t._query),N5(n,t._query).then((a=>new Bo(e,i,t,a)))}function sO(t,e,n){t=ui(t,Nt);const i=ui(t.firestore,pl),a=tO(t.converter,e,n);return Ey(i,[q5(my(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,Rr.none())])}function aO(t,e,n,...i){t=ui(t,Nt);const a=ui(t.firestore,pl),l=my(a);let c;return c=typeof(e=sn(e))=="string"||e instanceof rf?H5(l,"updateDoc",t._key,e,n,i):G5(l,"updateDoc",t._key,e),Ey(a,[c.toMutation(t._key,Rr.exists(!0))])}function oO(t){return Ey(ui(t.firestore,pl),[new Yg(t._key,Rr.none())])}function Ey(t,e){return(function(i,a){const l=new Pi;return i.asyncQueue.enqueueAndForget((async()=>x5(await M5(i),a,l))),l.promise})(fy(t),e)}function lO(t,e,n){const i=n.docs.get(e._key),a=new Fw(t);return new Ca(t,a,e._key,i,new Mc(n.hasPendingWrites,n.fromCache),e.converter)}function cO(...t){return new py("arrayUnion",t)}(function(e,n=!0){(function(a){ul=a})(cl),$o(new Ia("firestore",((i,{instanceIdentifier:a,options:l})=>{const c=i.getProvider("app").getImmediate(),d=new pl(new FI(i.getProvider("auth-internal")),new GI(c,i.getProvider("app-check-internal")),(function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new we(ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gc(p.options.projectId,_)})(c,a),c);return l={useFetchStreams:n,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),js(Kb,$b,e),js(Kb,$b,"esm2020")})();var uO="firebase",dO="12.7.0";js(uO,dO,"app");const hO={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},qw=lS(hO);function ou(t,e,n,i=1){{let a=e;if(e.startsWith("budgets/"))a="budgets";else if(e.startsWith("months/")){const c=e.replace("months/","").split("_");if(c.length>=2){const d=c[c.length-1];a=`months/${c[c.length-2]}/${d}`}}console.log(`[Firebase] ${t}(${i}): ${a}  ${n}`)}}function lu(){return V5(qw)}function Ah(t){const e={};for(const[n,i]of Object.entries(t))i!==void 0&&(i!==null&&typeof i=="object"&&!Array.isArray(i)?e[n]=Ah(i):Array.isArray(i)?e[n]=i.map(a=>a!==null&&typeof a=="object"?Ah(a):a):e[n]=i);return e}async function Re(t,e,n){const i=nf(lu(),t,e),a=`${t}/${e}`;ou("READ",a,n);const l=await rO(i);return{exists:l.exists(),data:l.exists()?l.data():null,ref:i}}async function it(t,e,n,i,a){const l=nf(lu(),t,e),c=Ah(n),d=`${t}/${e}`;return ou("WRITE",d,i),sO(l,c,a??{})}async function Wd(t,e,n,i){const a=nf(lu(),t,e),l=Ah(n),c=`${t}/${e}`;return ou("UPDATE",c,i),aO(a,l)}async function fO(t,e,n){const i=nf(lu(),t,e),a=`${t}/${e}`;return ou("DELETE",a,n),oO(i)}async function Fs(t,e,n){const i=lu(),a=L5(i,t);let l;if(n&&n.length>0){const f=n.map(p=>Z5(p.field,p.op,p.value));l=J5(a,...f)}else l=a;const c=await iO(l);let d=t;if(n&&n.length>0){const f=n.map(p=>`${p.field} ${p.op} ${JSON.stringify(p.value)}`).join(", ");d+=` WHERE ${f}`}return ou("QUERY",d,e,c.docs.length),{docs:c.docs.map(f=>({id:f.id,data:f.data()}))}}function yg(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname,balance:i.balance,account_group_id:i.account_group_id??null,sort_order:i.sort_order},i.is_income_account!==void 0&&(e[n].is_income_account=i.is_income_account),i.is_income_default!==void 0&&(e[n].is_income_default=i.is_income_default),i.is_outgo_account!==void 0&&(e[n].is_outgo_account=i.is_outgo_account),i.is_outgo_default!==void 0&&(e[n].is_outgo_default=i.is_outgo_default),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function mO(t){return t.map(e=>{const n={id:e.id,amount:e.amount,account_id:e.account_id,date:e.date,created_at:e.created_at};return e.payee&&(n.payee=e.payee),e.description&&(n.description=e.description),n})}function pO(t){return t.map(e=>({category_id:e.category_id,amount:e.amount}))}function gO(t){return t.map(e=>{const n={id:e.id,amount:e.amount,category_id:e.category_id,account_id:e.account_id,date:e.date,created_at:e.created_at};return e.payee&&(n.payee=e.payee),e.description&&(n.description=e.description),n})}function yO(t){return t.map(e=>({category_id:e.category_id,start_balance:e.start_balance,allocated:e.allocated,spent:e.spent,end_balance:e.end_balance}))}function Tt(t,e,n){const i=n.toString().padStart(2,"0");return`${t}_${e}_${i}`}function _O(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname,balance:i.balance,account_group_id:i.account_group_id??null,sort_order:i.sort_order??0,is_income_account:i.is_income_account,is_income_default:i.is_income_default,is_outgo_account:i.is_outgo_account,is_outgo_default:i.is_outgo_default,on_budget:i.on_budget,is_active:i.is_active}}),e}function vO(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order??0,expected_balance:i.expected_balance??"positive",on_budget:i.on_budget,is_active:i.is_active}}),e}function bO(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,description:i.description,category_group_id:i.category_group_id??null,sort_order:i.sort_order??0,default_monthly_amount:i.default_monthly_amount,default_monthly_type:i.default_monthly_type,balance:i.balance??0}}),e}function EO(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,i)=>n.sort_order-i.sort_order),e}function xO(t){return!t||typeof t.computed_at!="string"||typeof t.computed_for_year!="number"||typeof t.computed_for_month!="number"||typeof t.is_stale!="boolean"||!t.balances?null:{computed_at:t.computed_at,computed_for_year:t.computed_for_year,computed_for_month:t.computed_for_month,is_stale:t.is_stale,balances:t.balances}}async function SO(t){const{exists:e,data:n}=await Re("budgets",t,"loading budget data (cache miss or stale)");if(!e||!n)throw new Error(`Budget ${t} not found`);return{budget:{id:t,name:n.name,user_ids:n.user_ids||[],accepted_user_ids:n.accepted_user_ids||[],owner_id:n.owner_id||n.user_ids?.[0]||"",owner_email:n.owner_email||null},accounts:_O(n.accounts),accountGroups:vO(n.account_groups),categories:bO(n.categories),categoryGroups:EO(n.category_groups),categoryBalancesSnapshot:xO(n.category_balances_snapshot)}}function wO(t,e){return Na({queryKey:t?ie.budget(t):["budget","none"],queryFn:()=>SO(t),enabled:!!t&&e?.enabled!==!1})}function cf(t,e,n,i){const a=(t.income||[]).map(p=>({id:p.id,amount:p.amount,account_id:p.account_id,date:p.date,payee:p.payee,description:p.description,created_at:p.created_at})),l=(t.expenses||[]).map(p=>({id:p.id,amount:p.amount,category_id:p.category_id,account_id:p.account_id,date:p.date,payee:p.payee,description:p.description,created_at:p.created_at})),c=(t.allocations||[]).map(p=>({category_id:p.category_id,amount:p.amount})),d=(t.category_balances||[]).map(p=>({category_id:p.category_id,start_balance:p.start_balance,allocated:p.allocated,spent:p.spent,end_balance:p.end_balance}));let f;return t.previous_month_snapshot&&(f={total_income:t.previous_month_snapshot.total_income??0,account_balances_end:t.previous_month_snapshot.account_balances_end??{},category_balances_end:t.previous_month_snapshot.category_balances_end??{},snapshot_taken_at:t.previous_month_snapshot.snapshot_taken_at}),{budget_id:e,year:n,month:i,income:a,total_income:t.total_income??a.reduce((p,_)=>p+_.amount,0),expenses:l,total_expenses:t.total_expenses??l.reduce((p,_)=>p+_.amount,0),allocations:c,allocations_finalized:t.allocations_finalized||!1,account_balances_start:t.account_balances_start,account_balances_end:t.account_balances_end,category_balances:d,category_balances_stale:t.category_balances_stale??!1,previous_month_snapshot:f,previous_month_snapshot_stale:t.previous_month_snapshot_stale??!1,created_at:t.created_at,updated_at:t.updated_at||t.created_at}}function Qw(t,e){let n=t,i=e-1;return i<1&&(i=12,n-=1),{prevYear:n,prevMonth:i}}function _g(t){const e={};return t.category_balances&&t.category_balances.forEach(n=>{e[n.category_id]=n.end_balance}),{total_income:t.total_income??0,account_balances_end:t.account_balances_end??{},category_balances_end:e,snapshot_taken_at:new Date().toISOString()}}async function TO(t,e,n){const i=Tt(t,e,n),{exists:a,data:l}=await Re("months",i,"loading month document (cache miss or stale)");if(a&&l){const d=cf(l,t,e,n);return d.previous_month_snapshot_stale===!0||d.previous_month_snapshot===void 0&&n!==1?await AO(t,e,n,d):d}return await CO(t,e,n)}async function AO(t,e,n,i){const{prevYear:a,prevMonth:l}=Qw(e,n),c=Tt(t,e,n);let d=null;const f=Oe.getQueryData(ie.month(t,a,l));if(f)d=f.month;else{const b=Tt(t,a,l),{exists:T,data:w}=await Re("months",b,"fetching previous month to rebuild stale snapshot (not in cache)");T&&w&&(d=cf(w,t,a,l),Oe.setQueryData(ie.month(t,a,l),{month:d}))}const p=d?_g(d):{total_income:0,account_balances_end:{},category_balances_end:{},snapshot_taken_at:new Date().toISOString()},_={...i,previous_month_snapshot:p,previous_month_snapshot_stale:!1,updated_at:new Date().toISOString()},v={budget_id:_.budget_id,year:_.year,month:_.month,income:_.income??[],total_income:_.total_income??0,expenses:_.expenses??[],total_expenses:_.total_expenses??0,allocations:_.allocations??[],allocations_finalized:_.allocations_finalized??!1,category_balances:_.category_balances??[],previous_month_snapshot:p,previous_month_snapshot_stale:!1,created_at:_.created_at??new Date().toISOString(),updated_at:_.updated_at};return _.account_balances_start!==void 0&&(v.account_balances_start=_.account_balances_start),_.account_balances_end!==void 0&&(v.account_balances_end=_.account_balances_end),await it("months",c,v,"saving month with fresh snapshot rebuilt from previous month"),_}async function CO(t,e,n){const i=new Date().toISOString(),a=Tt(t,e,n);let l;if(n>1||e>new Date().getFullYear()-10){const{prevYear:f,prevMonth:p}=Qw(e,n),_=Oe.getQueryData(ie.month(t,f,p));if(_)l=_g(_.month);else{const v=Tt(t,f,p),{exists:b,data:T}=await Re("months",v,"fetching previous month to create snapshot for new month (not in cache)");if(b&&T){const w=cf(T,t,f,p);l=_g(w),Oe.setQueryData(ie.month(t,f,p),{month:w})}}}const c={budget_id:t,year:e,month:n,income:[],total_income:0,expenses:[],total_expenses:0,allocations:[],allocations_finalized:!1,category_balances:[],previous_month_snapshot:l,previous_month_snapshot_stale:!1,created_at:i,updated_at:i},d={budget_id:t,year:e,month:n,income:[],total_income:0,expenses:[],total_expenses:0,allocations:[],allocations_finalized:!1,category_balances:[],previous_month_snapshot_stale:!1,created_at:i,updated_at:i};return l&&(d.previous_month_snapshot=l),await it("months",a,d,"creating new month document (first time viewing this month)"),c}function RO(t,e,n,i){return Na({queryKey:t?ie.month(t,e,n):["month","none"],queryFn:async()=>({month:await TO(t,e,n)}),enabled:!!t&&i?.enabled!==!1})}function ni(t,e,n){let i=e,a=n+1;a>12&&(a=1,i+=1);const l=ie.month(t,i,a),c=Oe.getQueryData(l);c&&!c.month.previous_month_snapshot_stale&&Oe.setQueryData(l,{month:{...c.month,previous_month_snapshot_stale:!0}})}async function DO(t,e,n){let i=e,a=n+1;a>12&&(a=1,i+=1);const l=ie.month(t,i,a),c=Tt(t,i,a);try{const d=await Oe.fetchQuery({queryKey:l,queryFn:async()=>{const{exists:f,data:p}=await Re("months",c,"checking if next month exists to mark its snapshot stale");if(!f||!p)throw new Error("MONTH_NOT_EXISTS");return{month:p}}});if(d.month.previous_month_snapshot_stale)return;await it("months",c,{...d.month,previous_month_snapshot_stale:!0,updated_at:new Date().toISOString()},"marking next month snapshot as stale (previous month was edited)"),Oe.setQueryData(l,{month:{...d.month,previous_month_snapshot_stale:!0}})}catch(d){if(d instanceof Error&&d.message==="MONTH_NOT_EXISTS")return;throw d}}async function IO(t){const{exists:e,data:n}=await Re("payees",t,"loading payees for autocomplete (cache miss or stale)");return e&&n?n.payees||[]:[]}function jO(t,e){return Na({queryKey:t?ie.payees(t):["payees","none"],queryFn:()=>IO(t),enabled:!!t&&e?.enabled!==!1})}async function OO(t,e){const{exists:n,data:i}=await Re("users",t,"loading user profile (cache miss or stale)");if(n&&i)return i;const a={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await it("users",t,a,"creating new user document (first login)"),a}function MO(t,e,n){return Na({queryKey:t?ie.user(t):["user","none"],queryFn:()=>OO(t,e),enabled:!!t&&n?.enabled!==!1})}async function kO(t,e){const n=await Fs("budgets","loading budgets user has access to (cache miss or stale)",[{field:"user_ids",op:"array-contains",value:t}]),i=[],a=[];for(const l of n.docs){const c=l.data;c.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(l.id)?i.push({id:l.id,name:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null,isOwner:c.owner_id===t,isPending:!1}):a.push({budgetId:l.id,budgetName:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null})}return{budgets:i,pendingInvites:a}}function NO(t,e,n){return Na({queryKey:t?ie.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?kO(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}async function PO(){const t=await Fs("feedback","admin loading all feedback (cache miss or stale)"),e=[];for(const n of t.docs){const i=n.data.items||[],a=n.data.user_email||n.id;i.forEach(l=>{e.push({...l,doc_id:n.id,user_email:a})})}return{items:e}}function LO(t){return Na({queryKey:ie.feedback(),queryFn:PO,enabled:t?.enabled!==!1,staleTime:60*1e3})}function VO(){const t=new Date,e=t.getFullYear();let i=t.getMonth()+1+2,a=e;return i>12&&(i-=12,a+=1),{year:a,month:i}}function BO(t,e,n){return t>n.year||t===n.year&&e>n.month}async function UO(){const t=await Fs("budgets","settings checking migration status for all budgets");let e=0,n=0,i=0;for(const d of t.docs){const f=d.data;if(Array.isArray(f.categories)&&e++,Array.isArray(f.accounts)&&n++,f.categories&&typeof f.categories=="object"&&!Array.isArray(f.categories)){const p=f.categories;Object.values(p).some(v=>v.balance===void 0)&&i++}}const a=VO(),l=await Fs("months","settings checking for future months to clean up"),c=[];for(const d of l.docs){const{budget_id:f,year:p,month:_}=d.data;BO(p,_,a)&&c.push({docId:d.id,budgetId:f,year:p,month:_})}return c.sort((d,f)=>d.year!==f.year?d.year-f.year:d.month-f.month),{categoriesArrayMigrationNeeded:e>0,accountsArrayMigrationNeeded:n>0,budgetsToMigrateCategories:e,budgetsToMigrateAccounts:n,budgetsNeedingCategoryBalance:i,totalBudgetsChecked:t.docs.length,futureMonthsToDelete:c,futureMonthsCount:c.length}}function zO(){return Na({queryKey:["settingsMigration","all"],queryFn:async()=>UO(),enabled:!1,staleTime:300*1e3,refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1})}function FO(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order},i.expected_balance!==void 0&&(e[n].expected_balance=i.expected_balance),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function qO(){const t=hi(),e=pt({mutationFn:async({budgetId:a,accounts:l})=>{const{exists:c,data:d}=await Re("budgets",a,"PRE-EDIT-READ");if(!c||!d)throw new Error("Budget not found");const f=yg(l);return await it("budgets",a,{...d,accounts:f},"saving updated accounts (user edited account settings)"),l},onMutate:async({budgetId:a,accounts:l})=>{await t.cancelQueries({queryKey:ie.budget(a)});const c=t.getQueryData(ie.budget(a));return c&&t.setQueryData(ie.budget(a),{...c,accounts:l}),{previousData:c}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(ie.budget(l));c&&t.setQueryData(ie.budget(l),{...c,accounts:a})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(ie.budget(l),c.previousData)}}),n=pt({mutationFn:async({budgetId:a,accountGroups:l})=>{const{exists:c,data:d}=await Re("budgets",a,"PRE-EDIT-READ");if(!c||!d)throw new Error("Budget not found");const f=FO(l);return await it("budgets",a,{...d,account_groups:f},"saving updated account groups (user edited group settings)"),l},onMutate:async({budgetId:a,accountGroups:l})=>{await t.cancelQueries({queryKey:ie.budget(a)});const c=t.getQueryData(ie.budget(a));return c&&t.setQueryData(ie.budget(a),{...c,accountGroups:l}),{previousData:c}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(ie.budget(l));c&&t.setQueryData(ie.budget(l),{...c,accountGroups:a})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(ie.budget(l),c.previousData)}}),i=pt({mutationFn:async({budgetId:a,accountId:l,delta:c})=>{const{exists:d,data:f}=await Re("budgets",a,"PRE-EDIT-READ");if(!d||!f)throw new Error("Budget not found");const p=f.accounts||{};if(!p[l])throw new Error("Account not found");const _={...p,[l]:{...p[l],balance:p[l].balance+c}};return await it("budgets",a,{...f,accounts:yg(_)},"saving updated account balance"),_},onMutate:async({budgetId:a,accountId:l,delta:c})=>{await t.cancelQueries({queryKey:ie.budget(a)});const d=t.getQueryData(ie.budget(a));if(d&&d.accounts[l]){const f={...d.accounts,[l]:{...d.accounts[l],balance:d.accounts[l].balance+c}};t.setQueryData(ie.budget(a),{...d,accounts:f})}return{previousData:d}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(ie.budget(l));c&&t.setQueryData(ie.budget(l),{...c,accounts:a})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(ie.budget(l),c.previousData)}});return{updateAccounts:e,updateAccountGroups:n,updateAccountBalance:i}}function GE(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,category_group_id:i.category_group_id??null,sort_order:i.sort_order,balance:i.balance??0},i.description!==void 0&&(e[n].description=i.description),i.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=i.default_monthly_amount),i.default_monthly_type!==void 0&&(e[n].default_monthly_type=i.default_monthly_type)}),e}function QO(){const t=hi(),e=pt({mutationFn:async({budgetId:l,categories:c})=>{const{exists:d,data:f}=await Re("budgets",l,"PRE-EDIT-READ");if(!d||!f)throw new Error("Budget not found");const p=GE(c);return await it("budgets",l,{...f,categories:p},"saving updated categories (user edited category settings)"),c},onMutate:async({budgetId:l,categories:c})=>{await t.cancelQueries({queryKey:ie.budget(l)});const d=t.getQueryData(ie.budget(l));return d&&t.setQueryData(ie.budget(l),{...d,categories:c}),{previousData:d}},onSuccess:(l,{budgetId:c})=>{const d=t.getQueryData(ie.budget(c));d&&t.setQueryData(ie.budget(c),{...d,categories:l})},onError:(l,{budgetId:c},d)=>{d?.previousData&&t.setQueryData(ie.budget(c),d.previousData)}}),n=pt({mutationFn:async({budgetId:l,categoryGroups:c})=>{const{exists:d,data:f}=await Re("budgets",l,"PRE-EDIT-READ");if(!d||!f)throw new Error("Budget not found");return await it("budgets",l,{...f,category_groups:c},"saving updated category groups (user edited group settings)"),c},onMutate:async({budgetId:l,categoryGroups:c})=>{await t.cancelQueries({queryKey:ie.budget(l)});const d=t.getQueryData(ie.budget(l));return d&&t.setQueryData(ie.budget(l),{...d,categoryGroups:c}),{previousData:d}},onSuccess:(l,{budgetId:c})=>{const d=t.getQueryData(ie.budget(c));d&&t.setQueryData(ie.budget(c),{...d,categoryGroups:l})},onError:(l,{budgetId:c},d)=>{d?.previousData&&t.setQueryData(ie.budget(c),d.previousData)}}),i=pt({mutationFn:async({budgetId:l,balances:c,year:d,month:f})=>{const p={computed_at:new Date().toISOString(),computed_for_year:d,computed_for_month:f,is_stale:!1,balances:c},{exists:_,data:v}=await Re("budgets",l,"PRE-EDIT-READ");if(!_||!v)throw new Error("Budget not found");return await it("budgets",l,{...v,category_balances_snapshot:p},"saving category balances snapshot (caching computed balances)"),p},onMutate:async({budgetId:l,balances:c,year:d,month:f})=>{await t.cancelQueries({queryKey:ie.budget(l)});const p=t.getQueryData(ie.budget(l)),_={computed_at:new Date().toISOString(),computed_for_year:d,computed_for_month:f,is_stale:!1,balances:c};return p&&t.setQueryData(ie.budget(l),{...p,categoryBalancesSnapshot:_}),{previousData:p}},onSuccess:(l,{budgetId:c})=>{const d=t.getQueryData(ie.budget(c));d&&t.setQueryData(ie.budget(c),{...d,categoryBalancesSnapshot:l})},onError:(l,{budgetId:c},d)=>{d?.previousData&&t.setQueryData(ie.budget(c),d.previousData)}}),a=pt({mutationFn:async({budgetId:l,categories:c,balances:d,year:f,month:p})=>{const _={computed_at:new Date().toISOString(),computed_for_year:f,computed_for_month:p,is_stale:!1,balances:d},{exists:v,data:b}=await Re("budgets",l,"PRE-EDIT-READ");if(!v||!b)throw new Error("Budget not found");return await it("budgets",l,{...b,categories:GE(c),category_balances_snapshot:_},"saving recalculated category balances and snapshot (user triggered recalculation)"),{categories:c,snapshot:_}},onMutate:async({budgetId:l,categories:c,balances:d,year:f,month:p})=>{await t.cancelQueries({queryKey:ie.budget(l)});const _=t.getQueryData(ie.budget(l)),v={computed_at:new Date().toISOString(),computed_for_year:f,computed_for_month:p,is_stale:!1,balances:d};return _&&t.setQueryData(ie.budget(l),{..._,categories:c,categoryBalancesSnapshot:v}),{previousData:_}},onSuccess:({categories:l,snapshot:c},{budgetId:d})=>{const f=t.getQueryData(ie.budget(d));f&&t.setQueryData(ie.budget(d),{...f,categories:l,categoryBalancesSnapshot:c})},onError:(l,{budgetId:c},d)=>{d?.previousData&&t.setQueryData(ie.budget(c),d.previousData)}});return{updateCategories:e,updateCategoryGroups:n,saveCategoryBalancesSnapshot:i,recalculateCategoryBalances:a}}function GO(){const t=hi(),e=qO(),n=QO(),i=pt({mutationFn:async({budgetId:a,newName:l})=>{const{exists:c,data:d}=await Re("budgets",a,"PRE-EDIT-READ");if(!c||!d)throw new Error("Budget not found");return await it("budgets",a,{...d,name:l.trim()},`renaming budget to "${l.trim()}"`),l.trim()},onMutate:async({budgetId:a,newName:l})=>{await t.cancelQueries({queryKey:ie.budget(a)});const c=t.getQueryData(ie.budget(a));return c&&t.setQueryData(ie.budget(a),{...c,budget:{...c.budget,name:l.trim()}}),{previousData:c}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(ie.budget(l));c&&t.setQueryData(ie.budget(l),{...c,budget:{...c.budget,name:a}})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(ie.budget(l),c.previousData)}});return{updateAccounts:e.updateAccounts,updateAccountGroups:e.updateAccountGroups,updateAccountBalance:e.updateAccountBalance,updateCategories:n.updateCategories,updateCategoryGroups:n.updateCategoryGroups,saveCategoryBalancesSnapshot:n.saveCategoryBalancesSnapshot,recalculateCategoryBalances:n.recalculateCategoryBalances,renameBudget:i}}async function Ar(t,e){const n=Tt(t,e.year,e.month),i={budget_id:e.budget_id,year:e.year,month:e.month,income:mO(e.income),total_income:e.total_income,updated_at:new Date().toISOString()};e.created_at&&(i.created_at=e.created_at),e.expenses&&(i.expenses=gO(e.expenses)),e.total_expenses!==void 0&&(i.total_expenses=e.total_expenses),e.allocations&&(i.allocations=pO(e.allocations)),e.allocations_finalized!==void 0&&(i.allocations_finalized=e.allocations_finalized),e.category_balances&&(i.category_balances=yO(e.category_balances)),e.category_balances_stale!==void 0&&(i.category_balances_stale=e.category_balances_stale),e.account_balances_start&&(i.account_balances_start=e.account_balances_start),e.account_balances_end&&(i.account_balances_end=e.account_balances_end),e.previous_month_snapshot&&(i.previous_month_snapshot=e.previous_month_snapshot),e.previous_month_snapshot_stale!==void 0&&(i.previous_month_snapshot_stale=e.previous_month_snapshot_stale),await it("months",n,i,"saveMonthToFirestore: saving month document after mutation"),await DO(t,e.year,e.month)}async function ti(t,e,n){const{exists:i,data:a}=await Re("budgets",t,`reading budget to update account balance (delta: ${n})`);if(!i||!a)return null;const l=a.accounts||{};if(!l[e])return null;const c={...l,[e]:{...l[e],balance:l[e].balance+n}};return await it("budgets",t,{...a,accounts:yg(c)},"saving updated account balance after income/expense change"),c}async function Ch(t,e,n){const i=e.trim();if(!i||n.includes(i))return null;const a=[...n,i].sort((l,c)=>l.toLowerCase().localeCompare(c.toLowerCase()));return await it("payees",t,{budget_id:t,payees:a,updated_at:new Date().toISOString()},`adding new payee "${i}" to autocomplete list`),a}function Op(t,e,n,i){const a=t.previous_month_snapshot?.category_balances_end??{},l=t.expenses??[];return e.map(c=>{const d=a[c]??0;let f=0;if(i){const _=n.find(v=>v.category_id===c);_&&(f=_.amount)}const p=l.filter(_=>_.category_id===c).reduce((_,v)=>_+v.amount,0);return{category_id:c,start_balance:d,allocated:f,spent:p,end_balance:d+f-p}})}function Mp(t){const e=ie.budget(t),n=Oe.getQueryData(e);n?.categoryBalancesSnapshot&&!n.categoryBalancesSnapshot.is_stale&&Oe.setQueryData(e,{...n,categoryBalancesSnapshot:{...n.categoryBalancesSnapshot,is_stale:!0}})}async function Uo(t){try{const e=ie.budget(t),n=Oe.getQueryData(e);if(n?.categoryBalancesSnapshot?.is_stale)return;const{exists:i,data:a}=await Re("budgets",t,"checking if budget category snapshot needs stale flag");i&&a&&a.category_balances_snapshot&&!a.category_balances_snapshot.is_stale&&(await it("budgets",t,{...a,category_balances_snapshot:{...a.category_balances_snapshot,is_stale:!0}},"marking budget category balances snapshot as stale (expense or allocation changed)"),n&&Oe.setQueryData(e,{...n,categoryBalancesSnapshot:n.categoryBalancesSnapshot?{...n.categoryBalancesSnapshot,is_stale:!0}:null}))}catch(e){console.error("Error marking category balances snapshot stale in Firestore:",e)}}function zo(t,e,n){const i=ie.month(t,e,n),a=Oe.getQueryData(i);a?.month&&!a.month.category_balances_stale&&Oe.setQueryData(i,{...a,month:{...a.month,category_balances_stale:!0}})}async function kp(t,e,n){const i=ie.month(t,e,n),a=Tt(t,e,n);try{const l=await Oe.fetchQuery({queryKey:i,queryFn:async()=>{const{exists:c,data:d}=await Re("months",a,`checking if ${e}/${n} category balances need stale flag`);if(!c||!d)throw new Error("MONTH_NOT_EXISTS");return{month:d}}});if(l.month.category_balances_stale)return;await it("months",a,{...l.month,category_balances_stale:!0},`marking ${e}/${n} category balances as stale`),Oe.setQueryData(i,{month:{...l.month,category_balances_stale:!0}})}catch(l){if(l instanceof Error&&l.message==="MONTH_NOT_EXISTS")return;console.error("Error marking month category balances stale in Firestore:",l)}}function Fo(t,e,n){const a=Oe.getQueryCache().findAll({predicate:l=>{const c=l.queryKey;return c[0]==="month"&&c[1]===t}});for(const l of a){const c=l.queryKey,d=c[2],f=c[3];if(d>e||d===e&&f>n){const _=Oe.getQueryData(c);_?.month&&!_.month.category_balances_stale&&Oe.setQueryData(c,{..._,month:{..._.month,category_balances_stale:!0}})}}}async function qo(t,e,n){try{const a=Oe.getQueryCache().findAll({predicate:f=>{const p=f.queryKey;return p[0]==="month"&&p[1]===t}});let l=!1,c=!1;for(const f of a){const p=f.queryKey,_=p[2],v=p[3];if(_>e||_===e&&v>n){c=!0;const T=Oe.getQueryData(p);if(T?.month&&!T.month.category_balances_stale){l=!0;break}}}if(c&&!l)return;const d=await Fs("months",`finding months >= ${e} to mark category balances stale`,[{field:"budget_id",op:"==",value:t},{field:"year",op:">=",value:e}]);for(const f of d.docs){const p=f.data.year,_=f.data.month;if((p>e||p===e&&_>n)&&!f.data.category_balances_stale){await it("months",f.id,{...f.data,budget_id:t,category_balances_stale:!0},`marking ${p}/${_} category balances as stale (earlier month was edited)`);const b=ie.month(t,p,_),T=Oe.getQueryData(b);T&&Oe.setQueryData(b,{month:{...T.month,category_balances_stale:!0}})}}}catch(i){console.error("Error marking future months category balances stale in Firestore:",i)}}function HO(){const t=hi(),e=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,amount:f,accountId:p,date:_,payee:v,description:b}=a,T=Tt(l,c,d),{exists:w,data:A}=await Re("months",T,"PRE-EDIT-READ");if(!w||!A)throw new Error("Month data not found in Firestore");const I={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:f,account_id:p,date:_,created_at:new Date().toISOString()};v?.trim()&&(I.payee=v.trim()),b&&(I.description=b);const P=[...A.income||[],I],G={...A,income:P,total_income:P.reduce((Z,oe)=>Z+oe.amount,0),updated_at:new Date().toISOString()};await Ar(l,G);const Q=await ti(l,p,f);let X=null;if(v?.trim()){const{data:Z}=await Re("payees",l,"checking existing payees to see if new payee should be added"),oe=Z?.payees||[];X=await Ch(l,v,oe)}return{updatedMonth:G,newIncome:I,updatedAccounts:Q,updatedPayees:X}},onMutate:async a=>{const{budgetId:l,year:c,month:d,amount:f,accountId:p,date:_,payee:v,description:b}=a,T=ie.month(l,c,d),w=ie.budget(l);await t.cancelQueries({queryKey:T}),await t.cancelQueries({queryKey:w});const A=t.getQueryData(T),I=t.getQueryData(w);if(A){const P={id:`income_optimistic_${Date.now()}`,amount:f,account_id:p,date:_,created_at:new Date().toISOString()};v?.trim()&&(P.payee=v.trim()),b&&(P.description=b);const G=[...A.month.income,P];t.setQueryData(T,{...A,month:{...A.month,income:G,total_income:G.reduce((Q,X)=>Q+X.amount,0)}})}return I&&I.accounts[p]&&t.setQueryData(w,{...I,accounts:{...I.accounts,[p]:{...I.accounts[p],balance:I.accounts[p].balance+f}}}),ni(l,c,d),{previousMonth:A,previousBudget:I}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ie.month(c,d,f),_=ie.budget(c),v=ie.payees(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const b=t.getQueryData(_);b&&t.setQueryData(_,{...b,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ie.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ie.budget(d),c.previousBudget)}}),n=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,incomeId:f,amount:p,accountId:_,date:v,payee:b,description:T,oldAmount:w,oldAccountId:A}=a,I=Tt(l,c,d),{exists:P,data:G}=await Re("months",I,"PRE-EDIT-READ");if(!P||!G)throw new Error("Month data not found in Firestore");const Q={id:f,amount:p,account_id:_,date:v,created_at:(G.income||[]).find(C=>C.id===f)?.created_at||new Date().toISOString()};b?.trim()&&(Q.payee=b.trim()),T&&(Q.description=T);const X=(G.income||[]).map(C=>C.id===f?Q:C),Z={...G,income:X,total_income:X.reduce((C,R)=>C+R.amount,0),updated_at:new Date().toISOString()};await Ar(l,Z);let oe=null;_!==A?(await ti(l,A,-w),oe=await ti(l,_,p)):p!==w&&(oe=await ti(l,_,p-w));let O=null;if(b?.trim()){const{data:C}=await Re("payees",l,"checking existing payees to see if new payee should be added"),R=C?.payees||[];O=await Ch(l,b,R)}return{updatedMonth:Z,updatedAccounts:oe,updatedPayees:O}},onMutate:async a=>{const{budgetId:l,year:c,month:d,incomeId:f,amount:p,accountId:_,date:v,payee:b,description:T,oldAmount:w,oldAccountId:A}=a,I=ie.month(l,c,d),P=ie.budget(l);await t.cancelQueries({queryKey:I}),await t.cancelQueries({queryKey:P});const G=t.getQueryData(I),Q=t.getQueryData(P);if(G){const X={id:f,amount:p,account_id:_,date:v,created_at:G.month.income.find(oe=>oe.id===f)?.created_at||new Date().toISOString()};b?.trim()&&(X.payee=b.trim()),T&&(X.description=T);const Z=G.month.income.map(oe=>oe.id===f?X:oe);t.setQueryData(I,{...G,month:{...G.month,income:Z,total_income:Z.reduce((oe,O)=>oe+O.amount,0)}})}if(Q){const X={...Q.accounts};_!==A?(X[A]&&(X[A]={...X[A],balance:X[A].balance-w}),X[_]&&(X[_]={...X[_],balance:X[_].balance+p})):p!==w&&X[_]&&(X[_]={...X[_],balance:X[_].balance+(p-w)}),t.setQueryData(P,{...Q,accounts:X})}return ni(l,c,d),{previousMonth:G,previousBudget:Q}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ie.month(c,d,f),_=ie.budget(c),v=ie.payees(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const b=t.getQueryData(_);b&&t.setQueryData(_,{...b,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ie.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ie.budget(d),c.previousBudget)}}),i=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,incomeId:f,amount:p,accountId:_}=a,v=Tt(l,c,d),{exists:b,data:T}=await Re("months",v,"PRE-EDIT-READ");if(!b||!T)throw new Error("Month data not found in Firestore");const w=(T.income||[]).filter(P=>P.id!==f),A={...T,income:w,total_income:w.reduce((P,G)=>P+G.amount,0),updated_at:new Date().toISOString()};await Ar(l,A);const I=await ti(l,_,-p);return{updatedMonth:A,updatedAccounts:I}},onMutate:async a=>{const{budgetId:l,year:c,month:d,incomeId:f,amount:p,accountId:_}=a,v=ie.month(l,c,d),b=ie.budget(l);await t.cancelQueries({queryKey:v}),await t.cancelQueries({queryKey:b});const T=t.getQueryData(v),w=t.getQueryData(b);if(T){const A=T.month.income.filter(I=>I.id!==f);t.setQueryData(v,{...T,month:{...T.month,income:A,total_income:A.reduce((I,P)=>I+P.amount,0)}})}return w&&w.accounts[_]&&t.setQueryData(b,{...w,accounts:{...w.accounts,[_]:{...w.accounts[_],balance:w.accounts[_].balance-p}}}),ni(l,c,d),{previousMonth:T,previousBudget:w}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ie.month(c,d,f),_=ie.budget(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const v=t.getQueryData(_);v&&t.setQueryData(_,{...v,accounts:a.updatedAccounts})}},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ie.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ie.budget(d),c.previousBudget)}});return{addIncome:e,updateIncome:n,deleteIncome:i}}function KO(){const t=hi(),e=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,amount:f,categoryId:p,accountId:_,date:v,payee:b,description:T}=a,w=Tt(l,c,d),{exists:A,data:I}=await Re("months",w,"PRE-EDIT-READ");if(!A||!I)throw new Error("Month data not found in Firestore");const P={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:f,category_id:p,account_id:_,date:v,created_at:new Date().toISOString()};b?.trim()&&(P.payee=b.trim()),T&&(P.description=T);const G=[...I.expenses||[],P],Q={...I,expenses:G,total_expenses:G.reduce((oe,O)=>oe+O.amount,0),updated_at:new Date().toISOString()};await Ar(l,Q);const X=await ti(l,_,-f);let Z=null;if(b?.trim()){const{data:oe}=await Re("payees",l,"checking existing payees to see if new payee should be added"),O=oe?.payees||[];Z=await Ch(l,b,O)}return await Uo(l),await kp(l,c,d),await qo(l,c,d),{updatedMonth:Q,newExpense:P,updatedAccounts:X,updatedPayees:Z}},onMutate:async a=>{const{budgetId:l,year:c,month:d,amount:f,categoryId:p,accountId:_,date:v,payee:b,description:T}=a,w=ie.month(l,c,d),A=ie.budget(l);await t.cancelQueries({queryKey:w}),await t.cancelQueries({queryKey:A});const I=t.getQueryData(w),P=t.getQueryData(A);if(I){const G={id:`expense_optimistic_${Date.now()}`,amount:f,category_id:p,account_id:_,date:v,created_at:new Date().toISOString()};b?.trim()&&(G.payee=b.trim()),T&&(G.description=T);const Q=[...I.month.expenses||[],G];t.setQueryData(w,{...I,month:{...I.month,expenses:Q,total_expenses:Q.reduce((X,Z)=>X+Z.amount,0)}})}return P&&P.accounts[_]&&t.setQueryData(A,{...P,accounts:{...P.accounts,[_]:{...P.accounts[_],balance:P.accounts[_].balance-f}}}),ni(l,c,d),Mp(l),zo(l,c,d),Fo(l,c,d),{previousMonth:I,previousBudget:P}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ie.month(c,d,f),_=ie.budget(c),v=ie.payees(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const b=t.getQueryData(_);b&&t.setQueryData(_,{...b,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ie.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ie.budget(d),c.previousBudget)}}),n=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,expenseId:f,amount:p,categoryId:_,accountId:v,date:b,payee:T,description:w,oldAmount:A,oldAccountId:I}=a,P=Tt(l,c,d),{exists:G,data:Q}=await Re("months",P,"PRE-EDIT-READ");if(!G||!Q)throw new Error("Month data not found in Firestore");const X={id:f,amount:p,category_id:_,account_id:v,date:b,created_at:Q.expenses?.find(R=>R.id===f)?.created_at||new Date().toISOString()};T?.trim()&&(X.payee=T.trim()),w&&(X.description=w);const Z=(Q.expenses||[]).map(R=>R.id===f?X:R),oe={...Q,expenses:Z,total_expenses:Z.reduce((R,N)=>R+N.amount,0),updated_at:new Date().toISOString()};await Ar(l,oe);let O=null;v!==I?(await ti(l,I,A),O=await ti(l,v,-p)):p!==A&&(O=await ti(l,v,A-p));let C=null;if(T?.trim()){const{data:R}=await Re("payees",l,"checking existing payees to see if new payee should be added"),N=R?.payees||[];C=await Ch(l,T,N)}return await Uo(l),await kp(l,c,d),await qo(l,c,d),{updatedMonth:oe,updatedAccounts:O,updatedPayees:C}},onMutate:async a=>{const{budgetId:l,year:c,month:d,expenseId:f,amount:p,categoryId:_,accountId:v,date:b,payee:T,description:w,oldAmount:A,oldAccountId:I}=a,P=ie.month(l,c,d),G=ie.budget(l);await t.cancelQueries({queryKey:P}),await t.cancelQueries({queryKey:G});const Q=t.getQueryData(P),X=t.getQueryData(G);if(Q){const Z={id:f,amount:p,category_id:_,account_id:v,date:b,created_at:Q.month.expenses?.find(O=>O.id===f)?.created_at||new Date().toISOString()};T?.trim()&&(Z.payee=T.trim()),w&&(Z.description=w);const oe=(Q.month.expenses||[]).map(O=>O.id===f?Z:O);t.setQueryData(P,{...Q,month:{...Q.month,expenses:oe,total_expenses:oe.reduce((O,C)=>O+C.amount,0)}})}if(X){const Z={...X.accounts};v!==I?(Z[I]&&(Z[I]={...Z[I],balance:Z[I].balance+A}),Z[v]&&(Z[v]={...Z[v],balance:Z[v].balance-p})):p!==A&&Z[v]&&(Z[v]={...Z[v],balance:Z[v].balance+(A-p)}),t.setQueryData(G,{...X,accounts:Z})}return ni(l,c,d),Mp(l),zo(l,c,d),Fo(l,c,d),{previousMonth:Q,previousBudget:X}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ie.month(c,d,f),_=ie.budget(c),v=ie.payees(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const b=t.getQueryData(_);b&&t.setQueryData(_,{...b,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ie.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ie.budget(d),c.previousBudget)}}),i=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,expenseId:f,amount:p,accountId:_}=a,v=Tt(l,c,d),{exists:b,data:T}=await Re("months",v,"PRE-EDIT-READ");if(!b||!T)throw new Error("Month data not found in Firestore");const w=(T.expenses||[]).filter(P=>P.id!==f),A={...T,expenses:w,total_expenses:w.reduce((P,G)=>P+G.amount,0),updated_at:new Date().toISOString()};await Ar(l,A);const I=await ti(l,_,p);return await Uo(l),await kp(l,c,d),await qo(l,c,d),{updatedMonth:A,updatedAccounts:I}},onMutate:async a=>{const{budgetId:l,year:c,month:d,expenseId:f,amount:p,accountId:_}=a,v=ie.month(l,c,d),b=ie.budget(l);await t.cancelQueries({queryKey:v}),await t.cancelQueries({queryKey:b});const T=t.getQueryData(v),w=t.getQueryData(b);if(T){const A=(T.month.expenses||[]).filter(I=>I.id!==f);t.setQueryData(v,{...T,month:{...T.month,expenses:A,total_expenses:A.reduce((I,P)=>I+P.amount,0)}})}return w&&w.accounts[_]&&t.setQueryData(b,{...w,accounts:{...w.accounts,[_]:{...w.accounts[_],balance:w.accounts[_].balance+p}}}),ni(l,c,d),Mp(l),zo(l,c,d),Fo(l,c,d),{previousMonth:T,previousBudget:w}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ie.month(c,d,f),_=ie.budget(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const v=t.getQueryData(_);v&&t.setQueryData(_,{...v,accounts:a.updatedAccounts})}},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ie.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ie.budget(d),c.previousBudget)}});return{addExpense:e,updateExpense:n,deleteExpense:i}}function $O(){const t=hi(),e=pt({mutationFn:async l=>{const{budgetId:c,year:d,month:f,allocations:p}=l,_=Tt(c,d,f),{exists:v,data:b}=await Re("months",_,"PRE-EDIT-READ");if(!v||!b)throw new Error("Month data not found in Firestore");const T={...b,allocations:p,updated_at:new Date().toISOString()};return await Ar(c,T),{updatedMonth:T}},onMutate:async l=>{const{budgetId:c,year:d,month:f,allocations:p}=l,_=ie.month(c,d,f);await t.cancelQueries({queryKey:_});const v=t.getQueryData(_);return v&&t.setQueryData(_,{...v,month:{...v.month,allocations:p}}),ni(c,d,f),{previousMonth:v}},onSuccess:(l,c)=>{const{budgetId:d,year:f,month:p}=c;t.setQueryData(ie.month(d,f,p),{month:l.updatedMonth})},onError:(l,c,d)=>{d?.previousMonth&&t.setQueryData(ie.month(c.budgetId,c.year,c.month),d.previousMonth)}}),n=pt({mutationFn:async l=>{const{budgetId:c,year:d,month:f,allocations:p}=l,_=Tt(c,d,f),{exists:v,data:b}=await Re("months",_,"PRE-EDIT-READ");if(!v||!b)throw new Error("Month data not found in Firestore");const T=b.category_balances?.map(I=>I.category_id)??Object.keys(b.previous_month_snapshot?.category_balances_end??{}),w=T.length>0?Op(b,T,p,!0):b.category_balances,A={...b,allocations:p,allocations_finalized:!0,category_balances:w,category_balances_stale:!1,updated_at:new Date().toISOString()};return await Ar(c,A),await Uo(c),await qo(c,d,f),{updatedMonth:A}},onMutate:async l=>{const{budgetId:c,year:d,month:f,allocations:p}=l,_=ie.month(c,d,f),v=ie.budget(c);await t.cancelQueries({queryKey:_}),await t.cancelQueries({queryKey:v});const b=t.getQueryData(_),T=t.getQueryData(v);if(b&&t.setQueryData(_,{...b,month:{...b.month,allocations:p,allocations_finalized:!0}}),T){const w=b?.month?.allocations_finalized?b.month.allocations||[]:[],A={};for(const P of p)A[P.category_id]=(A[P.category_id]||0)+P.amount;for(const P of w)A[P.category_id]=(A[P.category_id]||0)-P.amount;const I={};Object.entries(T.categories).forEach(([P,G])=>{I[P]={...G,balance:G.balance+(A[P]||0)}}),t.setQueryData(v,{...T,categories:I,categoryBalancesSnapshot:T.categoryBalancesSnapshot?{...T.categoryBalancesSnapshot,is_stale:!0}:null})}return ni(c,d,f),zo(c,d,f),Fo(c,d,f),{previousMonth:b,previousBudget:T}},onSuccess:(l,c)=>{const{budgetId:d,year:f,month:p}=c,_=ie.month(d,f,p);t.setQueryData(_,{month:l.updatedMonth})},onError:(l,c,d)=>{d?.previousMonth&&t.setQueryData(ie.month(c.budgetId,c.year,c.month),d.previousMonth),d?.previousBudget&&t.setQueryData(ie.budget(c.budgetId),d.previousBudget)}}),i=pt({mutationFn:async l=>{const{budgetId:c,year:d,month:f}=l,p=Tt(c,d,f),{exists:_,data:v}=await Re("months",p,"PRE-EDIT-READ");if(!_||!v)throw new Error("Month data not found in Firestore");const b=v.category_balances?.map(A=>A.category_id)??Object.keys(v.previous_month_snapshot?.category_balances_end??{}),T=b.length>0?Op(v,b,v.allocations??[],!1):v.category_balances,w={...v,allocations_finalized:!1,category_balances:T,category_balances_stale:!1,updated_at:new Date().toISOString()};return await Ar(c,w),await Uo(c),await qo(c,d,f),{updatedMonth:w}},onMutate:async l=>{const{budgetId:c,year:d,month:f}=l,p=ie.month(c,d,f),_=ie.budget(c);await t.cancelQueries({queryKey:p}),await t.cancelQueries({queryKey:_});const v=t.getQueryData(p),b=t.getQueryData(_);if(v&&t.setQueryData(p,{...v,month:{...v.month,allocations_finalized:!1}}),b&&v?.month?.allocations_finalized){const T=v.month.allocations||[],w={};for(const I of T)w[I.category_id]=(w[I.category_id]||0)-I.amount;const A={};Object.entries(b.categories).forEach(([I,P])=>{A[I]={...P,balance:P.balance+(w[I]||0)}}),t.setQueryData(_,{...b,categories:A,categoryBalancesSnapshot:b.categoryBalancesSnapshot?{...b.categoryBalancesSnapshot,is_stale:!0}:null})}return ni(c,d,f),zo(c,d,f),Fo(c,d,f),{previousMonth:v,previousBudget:b}},onSuccess:(l,c)=>{const{budgetId:d,year:f,month:p}=c;t.setQueryData(ie.month(d,f,p),{month:l.updatedMonth})},onError:(l,c,d)=>{d?.previousMonth&&t.setQueryData(ie.month(c.budgetId,c.year,c.month),d.previousMonth),d?.previousBudget&&t.setQueryData(ie.budget(c.budgetId),d.previousBudget)}}),a=pt({mutationFn:async l=>{const{budgetId:c,year:d,month:f}=l,p=Tt(c,d,f),{exists:_,data:v}=await Re("months",p,"PRE-EDIT-READ");if(!_||!v)throw new Error("Month data not found in Firestore");const b=v.category_balances?.map(A=>A.category_id)??Object.keys(v.previous_month_snapshot?.category_balances_end??{}),T=b.length>0?Op(v,b,[],!1):v.category_balances,w={...v,allocations:[],allocations_finalized:!1,category_balances:T,category_balances_stale:!1,updated_at:new Date().toISOString()};return await Ar(c,w),await Uo(c),await qo(c,d,f),{updatedMonth:w}},onMutate:async l=>{const{budgetId:c,year:d,month:f}=l,p=ie.month(c,d,f),_=ie.budget(c);await t.cancelQueries({queryKey:p}),await t.cancelQueries({queryKey:_});const v=t.getQueryData(p),b=t.getQueryData(_);if(v&&t.setQueryData(p,{...v,month:{...v.month,allocations:[],allocations_finalized:!1}}),b&&v?.month?.allocations_finalized){const T=v.month.allocations||[],w={};for(const I of T)w[I.category_id]=(w[I.category_id]||0)-I.amount;const A={};Object.entries(b.categories).forEach(([I,P])=>{A[I]={...P,balance:P.balance+(w[I]||0)}}),t.setQueryData(_,{...b,categories:A,categoryBalancesSnapshot:b.categoryBalancesSnapshot?{...b.categoryBalancesSnapshot,is_stale:!0}:null})}return ni(c,d,f),zo(c,d,f),Fo(c,d,f),{previousMonth:v,previousBudget:b}},onSuccess:(l,c)=>{const{budgetId:d,year:f,month:p}=c;t.setQueryData(ie.month(d,f,p),{month:l.updatedMonth})},onError:(l,c,d)=>{d?.previousMonth&&t.setQueryData(ie.month(c.budgetId,c.year,c.month),d.previousMonth),d?.previousBudget&&t.setQueryData(ie.budget(c.budgetId),d.previousBudget)}});return{saveAllocations:e,finalizeAllocations:n,unfinalizeAllocations:i,deleteAllocations:a}}function WO(){const{addIncome:t,updateIncome:e,deleteIncome:n}=HO(),{addExpense:i,updateExpense:a,deleteExpense:l}=KO(),{saveAllocations:c,finalizeAllocations:d,unfinalizeAllocations:f,deleteAllocations:p}=$O();return{addIncome:t,updateIncome:e,deleteIncome:n,addExpense:i,updateExpense:a,deleteExpense:l,saveAllocations:c,finalizeAllocations:d,unfinalizeAllocations:f,deleteAllocations:p}}function YO(){const t=hi(),e=pt({mutationFn:async({name:d,userId:f,userEmail:p})=>{const _=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,v=new Date().toISOString(),b={name:d.trim()||"My Budget",user_ids:[f],accepted_user_ids:[f],owner_id:f,owner_email:p,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:v,updated_at:v};await it("budgets",_,b,"creating new budget document");const{exists:T,data:w}=await Re("users",f,"reading user document to add new budget to their list");return T&&w?await it("users",f,{...w,budget_ids:[_,...w.budget_ids],updated_at:v},"adding new budget to user's budget list"):await it("users",f,{uid:f,email:p,budget_ids:[_],created_at:v,updated_at:v},"creating new user document with first budget"),{budgetId:_,budget:{id:_,...b}}},onSuccess:(d,{userId:f})=>{t.invalidateQueries({queryKey:ie.user(f)}),t.invalidateQueries({queryKey:ie.accessibleBudgets(f)})}}),n=pt({mutationFn:async({budgetId:d,userId:f})=>{const p=new Date().toISOString(),{exists:_,data:v}=await Re("budgets",d,"verifying user was invited to this budget");if(!_||!v)throw new Error("Budget not found");if(!v.user_ids?.includes(f))throw new Error("You have not been invited to this budget");const{data:b}=await Re("users",f,"PRE-EDIT-READ");if(b?.budget_ids?.includes(d))throw new Error("You have already accepted this invite");return await it("users",f,{...b||{uid:f,email:null},budget_ids:[d,...b?.budget_ids||[]],updated_at:p},"adding accepted budget to user's budget list"),await it("budgets",d,{...v,accepted_user_ids:[...v.accepted_user_ids||[],f]},"marking user as accepted in budget's accepted_user_ids"),{budgetId:d}},onSuccess:(d,{userId:f})=>{t.invalidateQueries({queryKey:ie.user(f)}),t.invalidateQueries({queryKey:ie.accessibleBudgets(f)}),t.invalidateQueries({queryKey:ie.budget(d.budgetId)})}}),i=pt({mutationFn:async({budgetId:d,userId:f})=>{const{exists:p,data:_}=await Re("budgets",d,"PRE-EDIT-READ");if(!p||!_)throw new Error("Budget not found");if(_.user_ids?.includes(f))throw new Error("User is already invited");return await it("budgets",d,{..._,user_ids:[..._.user_ids||[],f]},"adding user to budget's invited users list"),{budgetId:d}},onMutate:async({budgetId:d,userId:f})=>{await t.cancelQueries({queryKey:ie.budget(d)});const p=t.getQueryData(ie.budget(d));return p&&t.setQueryData(ie.budget(d),{...p,budget:{...p.budget,user_ids:[...p.budget.user_ids,f]}}),{previousData:p}},onError:(d,{budgetId:f},p)=>{p?.previousData&&t.setQueryData(ie.budget(f),p.previousData)},onSettled:(d,f,{budgetId:p})=>{t.invalidateQueries({queryKey:ie.budget(p)})}}),a=pt({mutationFn:async({budgetId:d,userId:f})=>{const{exists:p,data:_}=await Re("budgets",d,"PRE-EDIT-READ");if(!p||!_)throw new Error("Budget not found");return await it("budgets",d,{..._,user_ids:(_.user_ids||[]).filter(v=>v!==f),accepted_user_ids:(_.accepted_user_ids||[]).filter(v=>v!==f)},"removing user from budget's access lists"),{budgetId:d}},onMutate:async({budgetId:d,userId:f})=>{await t.cancelQueries({queryKey:ie.budget(d)});const p=t.getQueryData(ie.budget(d));return p&&t.setQueryData(ie.budget(d),{...p,budget:{...p.budget,user_ids:p.budget.user_ids.filter(_=>_!==f),accepted_user_ids:p.budget.accepted_user_ids.filter(_=>_!==f)}}),{previousData:p}},onError:(d,{budgetId:f},p)=>{p?.previousData&&t.setQueryData(ie.budget(f),p.previousData)},onSettled:(d,f,{budgetId:p})=>{t.invalidateQueries({queryKey:ie.budget(p)})}}),l=pt({mutationFn:async({budgetId:d,userId:f})=>{const{exists:p,data:_}=await Re("users",f,"PRE-EDIT-READ");if(!p||!_)throw new Error("User document not found");const v=[d,..._.budget_ids.filter(b=>b!==d)];return await it("users",f,{..._,budget_ids:v,updated_at:new Date().toISOString()},"reordering budget list to make selected budget active"),{budgetId:d}},onMutate:async({budgetId:d,userId:f})=>{await t.cancelQueries({queryKey:ie.user(f)});const p=t.getQueryData(ie.user(f));return p&&t.setQueryData(ie.user(f),{...p,budget_ids:[d,...p.budget_ids.filter(_=>_!==d)]}),{previousData:p}},onError:(d,{userId:f},p)=>{p?.previousData&&t.setQueryData(ie.user(f),p.previousData)},onSettled:(d,f,{userId:p})=>{t.invalidateQueries({queryKey:ie.user(p)})}}),c=pt({mutationFn:async({budgetId:d,userId:f,userBudgetIds:p})=>{const{exists:_,data:v}=await Re("budgets",d,"checking if user has pending invite for this budget");return!_||!v||!v.user_ids?.includes(f)||p.includes(d)?null:{budgetId:d,budgetName:v.name,ownerEmail:v.owner_email||null}}});return{createBudget:e,acceptInvite:n,inviteUser:i,revokeUser:a,switchBudget:l,checkInvite:c}}function Gw(){const t=hi(),e=pt({mutationFn:async({userId:a,userEmail:l,text:c,feedbackType:d,currentPath:f})=>{const p=l||a,_={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`[${d.toUpperCase()}] ${c}

(Submitted from: ${f})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:d},{exists:v}=await Re("feedback",p,"checking if user has existing feedback document");return v?await it("feedback",p,{items:cO(_),user_email:l,updated_at:new Date().toISOString()},"adding new feedback item to existing document",{merge:!0}):await it("feedback",p,{items:[_],user_email:l,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},"creating new feedback document for user"),{feedbackItem:_}},onSuccess:()=>{t.invalidateQueries({queryKey:ie.feedback()})}}),n=pt({mutationFn:async({item:a})=>{const{exists:l,data:c}=await Re("feedback",a.doc_id,"PRE-EDIT-READ");if(!l||!c)throw new Error("Feedback document not found");const f=(c.items||[]).map(p=>p.id===a.id?{...p,is_done:!p.is_done,completed_at:p.is_done?null:new Date().toISOString()}:p);return await it("feedback",a.doc_id,{...c,items:f,updated_at:new Date().toISOString()},`marking feedback item as ${a.is_done?"not done":"done"}`),{itemId:a.id,isDone:!a.is_done}},onSuccess:()=>{t.invalidateQueries({queryKey:ie.feedback()})}}),i=pt({mutationFn:async({docId:a,items:l})=>{const{exists:c,data:d}=await Re("feedback",a,"PRE-EDIT-READ");if(!c||!d)throw new Error("Feedback document not found");return await it("feedback",a,{...d,items:l,updated_at:new Date().toISOString()},"saving reordered feedback items"),{docId:a}},onSuccess:()=>{t.invalidateQueries({queryKey:ie.feedback()})}});return{submitFeedback:e,toggleFeedback:n,updateSortOrder:i}}async function XO(t,e){return Oe.fetchQuery({queryKey:["budgetInvite",t,e],queryFn:async()=>{const{exists:n,data:i}=await Re("budgets",t,"checking if user has pending invite for budget");return!n||!i?null:{isInvited:i.user_ids?.includes(e)??!1,hasAccepted:i.accepted_user_ids?.includes(e)??!1,budgetName:i.name||"Unnamed Budget",ownerEmail:i.owner_email||null}},staleTime:60*1e3})}async function vg(t,e,n){const i=Tt(t,e,n),a=Oe.getQueryData(ie.month(t,e,n));if(a?.month)return{year:a.month.year,month:a.month.month,category_balances:a.month.category_balances,category_balances_stale:a.month.category_balances_stale,allocations_finalized:a.month.allocations_finalized,allocations:a.month.allocations,expenses:a.month.expenses};const{exists:l,data:c}=await Re("months",i,`fetching month for balance calculation (not in cache, walking ${e}/${n})`);if(!l||!c)return null;const d=cf(c,t,e,n);return Oe.setQueryData(ie.month(t,e,n),{month:d}),{year:d.year,month:d.month,category_balances:d.category_balances,category_balances_stale:d.category_balances_stale,allocations_finalized:d.allocations_finalized,allocations:d.allocations,expenses:d.expenses}}function JO(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function ZO(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}async function eM(t,e,n,i){const a={};e.forEach(b=>{a[b]=0});const l=await vg(t,n,i);if(l?.category_balances&&!l.category_balances_stale){for(const b of l.category_balances)e.includes(b.category_id)&&(a[b.category_id]=b.end_balance);return a}const c={};e.forEach(b=>{c[b]=0});const d=[];l&&d.push(l);let f=n,p=i,_=!1;const v=120;for(let b=0;b<v&&!_;b++){const T=JO(f,p);f=T.year,p=T.month;const w=await vg(t,f,p);if(!w)_=!0;else if(w.category_balances&&!w.category_balances_stale){_=!0;for(const A of w.category_balances)e.includes(A.category_id)&&(c[A.category_id]=A.end_balance)}else d.push(w)}d.reverse(),Object.assign(a,c);for(const b of d){if(b.allocations_finalized&&b.allocations)for(const T of b.allocations)e.includes(T.category_id)&&(a[T.category_id]=(a[T.category_id]||0)+T.amount);if(b.expenses)for(const T of b.expenses)e.includes(T.category_id)&&(a[T.category_id]=(a[T.category_id]||0)-T.amount)}return a}async function tM(t,e,n,i,a){const l={...n};let c=i,d=a;const f=24;for(let p=0;p<f;p++){const _=ZO(c,d);c=_.year,d=_.month;const v=await vg(t,c,d);if(!v)break;if(v.allocations_finalized&&v.allocations)for(const b of v.allocations)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)+b.amount);if(v.expenses)for(const b of v.expenses)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)-b.amount)}return l}async function Np(t,e,n,i,a){const l=await eM(t,e,n,i);let c;return a&&!a.is_stale&&a.computed_for_year===n&&a.computed_for_month===i?(c={},e.forEach(f=>{c[f]=a.balances[f]?.total??l[f]??0})):c=await tM(t,e,l,n,i),{current:l,total:c}}function Hw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const nM=Hw,Kw=new Zc("auth","Firebase",Hw());const Rh=new Vg("@firebase/auth");function rM(t,...e){Rh.logLevel<=$e.WARN&&Rh.warn(`Auth (${cl}): ${t}`,...e)}function sh(t,...e){Rh.logLevel<=$e.ERROR&&Rh.error(`Auth (${cl}): ${t}`,...e)}function Ir(t,...e){throw xy(t,...e)}function oi(t,...e){return xy(t,...e)}function $w(t,e,n){const i={...nM(),[e]:n};return new Zc("auth","Firebase",i).create(e,{appName:t.name})}function ks(t){return $w(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function xy(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return Kw.create(t,...e)}function Me(t,e,...n){if(!t)throw xy(e,...n)}function Mi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw sh(e),new Error(e)}function zi(t,e){t||Mi(e)}function bg(){return typeof self<"u"&&self.location?.href||""}function iM(){return HE()==="http:"||HE()==="https:"}function HE(){return typeof self<"u"&&self.location?.protocol||null}function sM(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(iM()||vD()||"connection"in navigator)?navigator.onLine:!0}function aM(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class cu{constructor(e,n){this.shortDelay=e,this.longDelay=n,zi(n>e,"Short delay should be less than long delay!"),this.isMobile=gD()||bD()}get(){return sM()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Sy(t,e){zi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Ww{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Mi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Mi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Mi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const oM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const lM=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],cM=new cu(3e4,6e4);function Va(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Hs(t,e,n,i,a={}){return Yw(t,a,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const d=eu({key:t.config.apiKey,...c}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const p={method:e,headers:f,...l};return _D()||(p.referrerPolicy="no-referrer"),t.emulatorConfig&&ll(t.emulatorConfig.host)&&(p.credentials="include"),Ww.fetch()(await Xw(t,t.config.apiHost,n,d),p)})}async function Yw(t,e,n){t._canInitEmulator=!1;const i={...oM,...e};try{const a=new dM(t),l=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Yd(t,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const d=l.ok?c.errorMessage:c.error.message,[f,p]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yd(t,"credential-already-in-use",c);if(f==="EMAIL_EXISTS")throw Yd(t,"email-already-in-use",c);if(f==="USER_DISABLED")throw Yd(t,"user-disabled",c);const _=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw $w(t,_,p);Ir(t,_)}}catch(a){if(a instanceof qi)throw a;Ir(t,"network-request-failed",{message:String(a)})}}async function uf(t,e,n,i,a={}){const l=await Hs(t,e,n,i,a);return"mfaPendingCredential"in l&&Ir(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function Xw(t,e,n,i){const a=`${e}${n}?${i}`,l=t,c=l.config.emulator?Sy(t.config,a):`${t.config.apiScheme}://${a}`;return lM.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function uM(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class dM{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(oi(this.auth,"network-request-failed")),cM.get())})}}function Yd(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=oi(t,e,i);return a.customData._tokenResponse=n,a}function KE(t){return t!==void 0&&t.enterprise!==void 0}class hM{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return uM(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function fM(t,e){return Hs(t,"GET","/v2/recaptchaConfig",Va(t,e))}async function mM(t,e){return Hs(t,"POST","/v1/accounts:delete",e)}async function Dh(t,e){return Hs(t,"POST","/v1/accounts:lookup",e)}function Bc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function pM(t,e=!1){const n=sn(t),i=await n.getIdToken(e),a=wy(i);Me(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l?.sign_in_provider;return{claims:a,token:i,authTime:Bc(Pp(a.auth_time)),issuedAtTime:Bc(Pp(a.iat)),expirationTime:Bc(Pp(a.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Pp(t){return Number(t)*1e3}function wy(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return sh("JWT malformed, contained fewer than 3 sections"),null;try{const a=eS(n);return a?JSON.parse(a):(sh("Failed to decode base64 JWT payload"),null)}catch(a){return sh("Caught error parsing JWT payload as JSON",a?.toString()),null}}function $E(t){const e=wy(t);return Me(e,"internal-error"),Me(typeof e.exp<"u","internal-error"),Me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function $c(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof qi&&gM(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function gM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class yM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Eg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bc(this.lastLoginAt),this.creationTime=Bc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ih(t){const e=t.auth,n=await t.getIdToken(),i=await $c(t,Dh(e,{idToken:n}));Me(i?.users.length,e,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=a.providerUserInfo?.length?Jw(a.providerUserInfo):[],c=vM(t.providerData,l),d=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!c?.length,p=d?f:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Eg(a.createdAt,a.lastLoginAt),isAnonymous:p};Object.assign(t,_)}async function _M(t){const e=sn(t);await Ih(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function vM(t,e){return[...t.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function Jw(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function bM(t,e){const n=await Yw(t,{},async()=>{const i=eu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,c=await Xw(t,a,"/v1/token",`key=${l}`),d=await t._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:i};return t.emulatorConfig&&ll(t.emulatorConfig.host)&&(f.credentials="include"),Ww.fetch()(c,f)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function EM(t,e){return Hs(t,"POST","/v2/accounts:revokeToken",Va(t,e))}class Qo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Me(e.idToken,"internal-error"),Me(typeof e.idToken<"u","internal-error"),Me(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$E(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Me(e.length!==0,"internal-error");const n=$E(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:a,expiresIn:l}=await bM(e,n);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:a,expirationTime:l}=n,c=new Qo;return i&&(Me(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),a&&(Me(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Me(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qo,this.toJSON())}_performRefresh(){return Mi("not implemented")}}function xs(t,e){Me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Cr{constructor({uid:e,auth:n,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new yM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Eg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await $c(this,this.stsTokenManager.getToken(this.auth,e));return Me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return pM(this,e)}reload(){return _M(this)}_assign(e){this!==e&&(Me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Cr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Ih(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Tr(this.auth.app))return Promise.reject(ks(this.auth));const e=await this.getIdToken();return await $c(this,mM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,a=n.email??void 0,l=n.phoneNumber??void 0,c=n.photoURL??void 0,d=n.tenantId??void 0,f=n._redirectEventId??void 0,p=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:v,emailVerified:b,isAnonymous:T,providerData:w,stsTokenManager:A}=n;Me(v&&A,e,"internal-error");const I=Qo.fromJSON(this.name,A);Me(typeof v=="string",e,"internal-error"),xs(i,e.name),xs(a,e.name),Me(typeof b=="boolean",e,"internal-error"),Me(typeof T=="boolean",e,"internal-error"),xs(l,e.name),xs(c,e.name),xs(d,e.name),xs(f,e.name),xs(p,e.name),xs(_,e.name);const P=new Cr({uid:v,auth:e,email:a,emailVerified:b,displayName:i,isAnonymous:T,photoURL:c,phoneNumber:l,tenantId:d,stsTokenManager:I,createdAt:p,lastLoginAt:_});return w&&Array.isArray(w)&&(P.providerData=w.map(G=>({...G}))),f&&(P._redirectEventId=f),P}static async _fromIdTokenResponse(e,n,i=!1){const a=new Qo;a.updateFromServerResponse(n);const l=new Cr({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Ih(l),l}static async _fromGetAccountInfoResponse(e,n,i){const a=n.users[0];Me(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?Jw(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!l?.length,d=new Qo;d.updateFromIdToken(i);const f=new Cr({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:c}),p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Eg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(f,p),f}}const WE=new Map;function ki(t){zi(t instanceof Function,"Expected a class definition");let e=WE.get(t);return e?(zi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,WE.set(t,e),e)}class Zw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Zw.type="NONE";const YE=Zw;function ah(t,e,n){return`firebase:${t}:${e}:${n}`}class Go{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=ah(this.userKey,a.apiKey,l),this.fullPersistenceKey=ah("persistence",a.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Dh(this.auth,{idToken:e}).catch(()=>{});return n?Cr._fromGetAccountInfoResponse(this.auth,n,e):null}return Cr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Go(ki(YE),e,i);const a=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let l=a[0]||ki(YE);const c=ah(i,e.config.apiKey,e.name);let d=null;for(const p of n)try{const _=await p._get(c);if(_){let v;if(typeof _=="string"){const b=await Dh(e,{idToken:_}).catch(()=>{});if(!b)break;v=await Cr._fromGetAccountInfoResponse(e,b,_)}else v=Cr._fromJSON(e,_);p!==l&&(d=v),l=p;break}}catch{}const f=a.filter(p=>p._shouldAllowMigration);return!l._shouldAllowMigration||!f.length?new Go(l,e,i):(l=f[0],d&&await l._set(c,d.toJSON()),await Promise.all(n.map(async p=>{if(p!==l)try{await p._remove(c)}catch{}})),new Go(l,e,i))}}function XE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(eT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sT(e))return"Blackberry";if(aT(e))return"Webos";if(tT(e))return"Safari";if((e.includes("chrome/")||nT(e))&&!e.includes("edge/"))return"Chrome";if(iT(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function eT(t=xn()){return/firefox\//i.test(t)}function tT(t=xn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nT(t=xn()){return/crios\//i.test(t)}function rT(t=xn()){return/iemobile/i.test(t)}function iT(t=xn()){return/android/i.test(t)}function sT(t=xn()){return/blackberry/i.test(t)}function aT(t=xn()){return/webos/i.test(t)}function Ty(t=xn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function xM(t=xn()){return Ty(t)&&!!window.navigator?.standalone}function SM(){return ED()&&document.documentMode===10}function oT(t=xn()){return Ty(t)||iT(t)||aT(t)||sT(t)||/windows phone/i.test(t)||rT(t)}function lT(t,e=[]){let n;switch(t){case"Browser":n=XE(xn());break;case"Worker":n=`${XE(xn())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${cl}/${i}`}class wM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=l=>new Promise((c,d)=>{try{const f=e(l);c(f)}catch(f){d(f)}});i.onAbort=n,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function TM(t,e={}){return Hs(t,"GET","/v2/passwordPolicy",Va(t,e))}const AM=6;class CM{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??AM,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class RM{constructor(e,n,i,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new JE(this),this.idTokenSubscription=new JE(this),this.beforeStateQueue=new wM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Kw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ki(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Go.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Dh(this,{idToken:e}),i=await Cr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Tr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,c=i?._redirectEventId,d=await this.tryRedirectSignIn(e);(!l||l===c)&&d?.user&&(i=d.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ih(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=aM()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Tr(this.app))return Promise.reject(ks(this));const n=e?sn(e):null;return n&&Me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Tr(this.app)?Promise.reject(ks(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Tr(this.app)?Promise.reject(ks(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ki(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await TM(this),n=new CM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Zc("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await EM(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ki(e)||this._popupRedirectResolver;Me(n,this,"argument-error"),this.redirectPersistenceManager=await Go.create(this,[ki(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,a){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(d,this,"internal-error"),d.then(()=>{c||l(this.currentUser)}),typeof n=="function"){const f=e.addObserver(n,i,a);return()=>{c=!0,f()}}else{const f=e.addObserver(n);return()=>{c=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Tr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&rM(`Error while retrieving App Check token: ${e.error}`),e?.token}}function yl(t){return sn(t)}class JE{constructor(e){this.auth=e,this.observer=null,this.addObserver=DD(n=>this.observer=n)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let df={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function DM(t){df=t}function cT(t){return df.loadJS(t)}function IM(){return df.recaptchaEnterpriseScript}function jM(){return df.gapiScript}function OM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class MM{constructor(){this.enterprise=new kM}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class kM{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const NM="recaptcha-enterprise",uT="NO_RECAPTCHA";class PM{constructor(e){this.type=NM,this.auth=yl(e)}async verify(e="verify",n=!1){async function i(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,d)=>{fM(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const p=new hM(f);return l.tenantId==null?l._agentRecaptchaConfig=p:l._tenantRecaptchaConfigs[l.tenantId]=p,c(p.siteKey)}}).catch(f=>{d(f)})})}function a(l,c,d){const f=window.grecaptcha;KE(f)?f.enterprise.ready(()=>{f.enterprise.execute(l,{action:e}).then(p=>{c(p)}).catch(()=>{c(uT)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new MM().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(d=>{if(!n&&KE(window.grecaptcha))a(d,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let f=IM();f.length!==0&&(f+=d),cT(f).then(()=>{a(d,l,c)}).catch(p=>{c(p)})}}).catch(d=>{c(d)})})}}async function ZE(t,e,n,i=!1,a=!1){const l=new PM(t);let c;if(a)c=uT;else try{c=await l.verify(n)}catch{c=await l.verify(n,!0)}const d={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const f=d.phoneEnrollmentInfo.phoneNumber,p=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const f=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function ex(t,e,n,i,a){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await ZE(t,e,n,n==="getOobCode");return i(t,l)}else return i(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await ZE(t,e,n,n==="getOobCode");return i(t,c)}else return Promise.reject(l)})}function LM(t,e){const n=Ug(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),l=n.getOptions();if(Ns(l,e??{}))return a;Ir(a,"already-initialized")}return n.initialize({options:e})}function VM(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(ki);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function BM(t,e,n){const i=yl(t);Me(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=dT(e),{host:c,port:d}=UM(e),f=d===null?"":`:${d}`,p={url:`${l}//${c}${f}/`},_=Object.freeze({host:c,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Me(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Me(Ns(p,i.config.emulator)&&Ns(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,ll(c)?(iS(`${l}//${c}${f}`),sS("Auth",!0)):zM()}function dT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function UM(t){const e=dT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:tx(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:tx(c)}}}function tx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function zM(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Ay{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Mi("not implemented")}_getIdTokenResponse(e){return Mi("not implemented")}_linkToIdToken(e,n){return Mi("not implemented")}_getReauthenticationResolver(e){return Mi("not implemented")}}async function FM(t,e){return Hs(t,"POST","/v1/accounts:signUp",e)}async function qM(t,e){return uf(t,"POST","/v1/accounts:signInWithPassword",Va(t,e))}async function QM(t,e){return uf(t,"POST","/v1/accounts:signInWithEmailLink",Va(t,e))}async function GM(t,e){return uf(t,"POST","/v1/accounts:signInWithEmailLink",Va(t,e))}class Wc extends Ay{constructor(e,n,i,a=null){super("password",i),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new Wc(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new Wc(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ex(e,n,"signInWithPassword",qM);case"emailLink":return QM(e,{email:this._email,oobCode:this._password});default:Ir(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ex(e,i,"signUpPassword",FM);case"emailLink":return GM(e,{idToken:n,email:this._email,oobCode:this._password});default:Ir(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ho(t,e){return uf(t,"POST","/v1/accounts:signInWithIdp",Va(t,e))}const HM="http://localhost";class Ma extends Ay{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ma(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ir("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=n;if(!i||!a)return null;const c=new Ma(i,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const n=this.buildRequest();return Ho(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,Ho(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ho(e,n)}buildRequest(){const e={requestUri:HM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=eu(n)}return e}}function KM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function $M(t){const e=Rc(Dc(t)).link,n=e?Rc(Dc(e)).deep_link_id:null,i=Rc(Dc(t)).deep_link_id;return(i?Rc(Dc(i)).link:null)||i||n||e||t}class Cy{constructor(e){const n=Rc(Dc(e)),i=n.apiKey??null,a=n.oobCode??null,l=KM(n.mode??null);Me(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=$M(e);try{return new Cy(n)}catch{return null}}}class _l{constructor(){this.providerId=_l.PROVIDER_ID}static credential(e,n){return Wc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Cy.parseLink(n);return Me(i,"argument-error"),Wc._fromEmailAndCode(e,i.code,i.tenantId)}}_l.PROVIDER_ID="password";_l.EMAIL_PASSWORD_SIGN_IN_METHOD="password";_l.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class hT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class uu extends hT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ss extends uu{constructor(){super("facebook.com")}static credential(e){return Ma._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ss.credentialFromTaggedObject(e)}static credentialFromError(e){return Ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ss.credential(e.oauthAccessToken)}catch{return null}}}Ss.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ss.PROVIDER_ID="facebook.com";class ws extends uu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ma._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return ws.credential(n,i)}catch{return null}}}ws.GOOGLE_SIGN_IN_METHOD="google.com";ws.PROVIDER_ID="google.com";class Ts extends uu{constructor(){super("github.com")}static credential(e){return Ma._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.GITHUB_SIGN_IN_METHOD="github.com";Ts.PROVIDER_ID="github.com";class As extends uu{constructor(){super("twitter.com")}static credential(e,n){return Ma._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return As.credential(n,i)}catch{return null}}}As.TWITTER_SIGN_IN_METHOD="twitter.com";As.PROVIDER_ID="twitter.com";class nl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,a=!1){const l=await Cr._fromIdTokenResponse(e,i,a),c=nx(i);return new nl({user:l,providerId:c,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const a=nx(i);return new nl({user:e,providerId:a,_tokenResponse:i,operationType:n})}}function nx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class jh extends qi{constructor(e,n,i,a){super(n.code,n.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,jh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,a){return new jh(e,n,i,a)}}function fT(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?jh._fromErrorAndOperation(t,l,e,i):l})}async function WM(t,e,n=!1){const i=await $c(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return nl._forOperation(t,"link",i)}async function YM(t,e,n=!1){const{auth:i}=t;if(Tr(i.app))return Promise.reject(ks(i));const a="reauthenticate";try{const l=await $c(t,fT(i,a,e,t),n);Me(l.idToken,i,"internal-error");const c=wy(l.idToken);Me(c,i,"internal-error");const{sub:d}=c;return Me(t.uid===d,i,"user-mismatch"),nl._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Ir(i,"user-mismatch"),l}}async function mT(t,e,n=!1){if(Tr(t.app))return Promise.reject(ks(t));const i="signIn",a=await fT(t,i,e),l=await nl._fromIdTokenResponse(t,i,a);return n||await t._updateCurrentUser(l.user),l}async function XM(t,e){return mT(yl(t),e)}async function JM(t){const e=yl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function ZM(t,e,n){return Tr(t.app)?Promise.reject(ks(t)):XM(sn(t),_l.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&JM(t),i})}function ek(t,e,n,i){return sn(t).onIdTokenChanged(e,n,i)}function tk(t,e,n){return sn(t).beforeAuthStateChanged(e,n)}function nk(t,e,n,i){return sn(t).onAuthStateChanged(e,n,i)}function rk(t){return sn(t).signOut()}const Oh="__sak";class pT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Oh,"1"),this.storage.removeItem(Oh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const ik=1e3,sk=10;class gT extends pT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=oT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),a=this.localCache[n];i!==a&&e(n,a,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((c,d,f)=>{this.notifyListeners(c,f)});return}const i=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(i);!n&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);SM()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,sk):a()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},ik)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}gT.type="LOCAL";const ak=gT;class yT extends pT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}yT.type="SESSION";const _T=yT;function ok(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class hf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const i=new hf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:a,data:l}=n.data,c=this.handlersMap[a];if(!c?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const d=Array.from(c).map(async p=>p(n.origin,l)),f=await ok(d);n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:f})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}hf.receivers=[];function Ry(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class lk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((d,f)=>{const p=Ry("",20);a.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},i);c={messageChannel:a,onMessage(v){const b=v;if(b.data.eventId===p)switch(b.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(b.data.response);break;default:clearTimeout(_),clearTimeout(l),f(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:n},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function li(){return window}function ck(t){li().location.href=t}function vT(){return typeof li().WorkerGlobalScope<"u"&&typeof li().importScripts=="function"}async function uk(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function dk(){return navigator?.serviceWorker?.controller||null}function hk(){return vT()?self:null}const bT="firebaseLocalStorageDb",fk=1,Mh="firebaseLocalStorage",ET="fbase_key";class du{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function ff(t,e){return t.transaction([Mh],e?"readwrite":"readonly").objectStore(Mh)}function mk(){const t=indexedDB.deleteDatabase(bT);return new du(t).toPromise()}function xg(){const t=indexedDB.open(bT,fk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Mh,{keyPath:ET})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Mh)?e(i):(i.close(),await mk(),e(await xg()))})})}async function rx(t,e,n){const i=ff(t,!0).put({[ET]:e,value:n});return new du(i).toPromise()}async function pk(t,e){const n=ff(t,!1).get(e),i=await new du(n).toPromise();return i===void 0?null:i.value}function ix(t,e){const n=ff(t,!0).delete(e);return new du(n).toPromise()}const gk=800,yk=3;class xT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await xg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>yk)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return vT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=hf._getInstance(hk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await uk(),!this.activeServiceWorker)return;this.sender=new lk(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||dk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await xg();return await rx(e,Oh,"1"),await ix(e,Oh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>rx(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>pk(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ix(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=ff(a,!1).getAll();return new du(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),gk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}xT.type="LOCAL";const _k=xT;new cu(3e4,6e4);function vk(t,e){return e?ki(e):(Me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Dy extends Ay{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ho(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ho(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ho(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function bk(t){return mT(t.auth,new Dy(t),t.bypassAuthState)}function Ek(t){const{auth:e,user:n}=t;return Me(n,e,"internal-error"),YM(n,new Dy(t),t.bypassAuthState)}async function xk(t){const{auth:e,user:n}=t;return Me(n,e,"internal-error"),WM(n,new Dy(t),t.bypassAuthState)}class ST{constructor(e,n,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:a,tenantId:l,error:c,type:d}=e;if(c){this.reject(c);return}const f={auth:this.auth,requestUri:n,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return bk;case"linkViaPopup":case"linkViaRedirect":return xk;case"reauthViaPopup":case"reauthViaRedirect":return Ek;default:Ir(this.auth,"internal-error")}}resolve(e){zi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){zi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Sk=new cu(2e3,1e4);class Lo extends ST{constructor(e,n,i,a,l){super(e,n,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Lo.currentPopupAction&&Lo.currentPopupAction.cancel(),Lo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Me(e,this.auth,"internal-error"),e}async onExecution(){zi(this.filter.length===1,"Popup operations only handle one event");const e=Ry();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(oi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(oi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Lo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(oi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Sk.get())};e()}}Lo.currentPopupAction=null;const wk="pendingRedirect",oh=new Map;class Tk extends ST{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=oh.get(this.auth._key());if(!e){try{const i=await Ak(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}oh.set(this.auth._key(),e)}return this.bypassAuthState||oh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Ak(t,e){const n=Dk(e),i=Rk(t);if(!await i._isAvailable())return!1;const a=await i._get(n)==="true";return await i._remove(n),a}function Ck(t,e){oh.set(t._key(),e)}function Rk(t){return ki(t._redirectPersistence)}function Dk(t){return ah(wk,t.config.apiKey,t.name)}async function Ik(t,e,n=!1){if(Tr(t.app))return Promise.reject(ks(t));const i=yl(t),a=vk(i,e),c=await new Tk(i,a,n).execute();return c&&!n&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}const jk=600*1e3;class Ok{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Mk(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!wT(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(oi(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jk&&this.cachedEventUids.clear(),this.cachedEventUids.has(sx(e))}saveEventToCache(e){this.cachedEventUids.add(sx(e)),this.lastProcessedEventTime=Date.now()}}function sx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function wT({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function Mk(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wT(t);default:return!1}}async function kk(t,e={}){return Hs(t,"GET","/v1/projects",e)}const Nk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Pk=/^https?/;async function Lk(t){if(t.config.emulator)return;const{authorizedDomains:e}=await kk(t);for(const n of e)try{if(Vk(n))return}catch{}Ir(t,"unauthorized-domain")}function Vk(t){const e=bg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&c.hostname===i}if(!Pk.test(n))return!1;if(Nk.test(t))return i===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const Bk=new cu(3e4,6e4);function ax(){const t=li().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Uk(t){return new Promise((e,n)=>{function i(){ax(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ax(),n(oi(t,"network-request-failed"))},timeout:Bk.get()})}if(li().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(li().gapi?.load)i();else{const a=OM("iframefcb");return li()[a]=()=>{gapi.load?i():n(oi(t,"network-request-failed"))},cT(`${jM()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw lh=null,e})}let lh=null;function zk(t){return lh=lh||Uk(t),lh}const Fk=new cu(5e3,15e3),qk="__/auth/iframe",Qk="emulator/auth/iframe",Gk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Hk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Kk(t){const e=t.config;Me(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Sy(e,Qk):`https://${t.config.authDomain}/${qk}`,i={apiKey:e.apiKey,appName:t.name,v:cl},a=Hk.get(t.config.apiHost);a&&(i.eid=a);const l=t._getFrameworks();return l.length&&(i.fw=l.join(",")),`${n}?${eu(i).slice(1)}`}async function $k(t){const e=await zk(t),n=li().gapi;return Me(n,t,"internal-error"),e.open({where:document.body,url:Kk(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Gk,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const c=oi(t,"network-request-failed"),d=li().setTimeout(()=>{l(c)},Fk.get());function f(){li().clearTimeout(d),a(i)}i.ping(f).then(f,()=>{l(c)})}))}const Wk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Yk=500,Xk=600,Jk="_blank",Zk="http://localhost";class ox{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function eN(t,e,n,i=Yk,a=Xk){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const f={...Wk,width:i.toString(),height:a.toString(),top:l,left:c},p=xn().toLowerCase();n&&(d=nT(p)?Jk:n),eT(p)&&(e=e||Zk,f.scrollbars="yes");const _=Object.entries(f).reduce((b,[T,w])=>`${b}${T}=${w},`,"");if(xM(p)&&d!=="_self")return tN(e||"",d),new ox(null);const v=window.open(e||"",d,_);Me(v,t,"popup-blocked");try{v.focus()}catch{}return new ox(v)}function tN(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const nN="__/auth/handler",rN="emulator/auth/handler",iN=encodeURIComponent("fac");async function lx(t,e,n,i,a,l){Me(t.config.authDomain,t,"auth-domain-config-required"),Me(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:cl,eventId:a};if(e instanceof hT){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",RD(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))c[_]=v}if(e instanceof uu){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(c.scopes=_.join(","))}t.tenantId&&(c.tid=t.tenantId);const d=c;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const f=await t._getAppCheckToken(),p=f?`#${iN}=${encodeURIComponent(f)}`:"";return`${sN(t)}?${eu(d).slice(1)}${p}`}function sN({config:t}){return t.emulator?Sy(t,rN):`https://${t.authDomain}/${nN}`}const Lp="webStorageSupport";class aN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_T,this._completeRedirectFn=Ik,this._overrideRedirectResult=Ck}async _openPopup(e,n,i,a){zi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await lx(e,n,i,bg(),a);return eN(e,l,Ry())}async _openRedirect(e,n,i,a){await this._originValidation(e);const l=await lx(e,n,i,bg(),a);return ck(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:l}=this.eventManagers[n];return a?Promise.resolve(a):(zi(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await $k(e),i=new Ok(e);return n.register("authEvent",a=>(Me(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Lp,{type:Lp},a=>{const l=a?.[0]?.[Lp];l!==void 0&&n(!!l),Ir(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Lk(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return oT()||tT()||Ty()}}const oN=aN;var cx="@firebase/auth",ux="1.12.0";class lN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function cN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function uN(t){$o(new Ia("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=i.options;Me(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:c,authDomain:d,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lT(t)},p=new RM(i,a,l,f);return VM(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),$o(new Ia("auth-internal",e=>{const n=yl(e.getProvider("auth").getImmediate());return(i=>new lN(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),js(cx,ux,cN(t)),js(cx,ux,"esm2020")}const dN=300,hN=rS("authIdTokenMaxAge")||dN;let dx=null;const fN=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>hN)return;const a=n?.token;dx!==a&&(dx=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function mN(t=cS()){const e=Ug(t,"auth");if(e.isInitialized())return e.getImmediate();const n=LM(t,{popupRedirectResolver:oN,persistence:[_k,ak,_T]}),i=rS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=fN(l.toString());tk(n,c,()=>c(n.currentUser)),ek(n,d=>c(d))}}const a=tS("auth");return a&&BM(n,`http://${a}`),n}function pN(){return document.getElementsByTagName("head")?.[0]??document}DM({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=a=>{const l=oi("internal-error");l.customData=a,n(l)},i.type="text/javascript",i.charset="UTF-8",pN().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});uN("Browser");function Ba(){const t=mN(qw);async function e(){return!1}async function n(d,f){return ZM(t,d,f)}function i(){return rk(t)}function a(d){nk(t,f=>{d(f)})}function l(){return t.currentUser}return{set_user_listener:a,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:i,get_current_firebase_user:l}}const gN={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,lastActiveTab:"balances",lastSettingsTab:"accounts",lastAdminTab:"budget",setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},setLastActiveTab:()=>{},setLastSettingsTab:()=>{},setLastAdminTab:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},TT=D.createContext(gN);function yN({children:t}){const n=Ba().get_current_firebase_user(),[i,a]=D.useState(null),[l,c]=D.useState(new Date().getFullYear()),[d,f]=D.useState(new Date().getMonth()+1),[p,_]=D.useState("balances"),[v,b]=D.useState("accounts"),[T,w]=D.useState("budget"),[A,I]=D.useState(!1),[P,G]=D.useState(!1),Q=MO(n?.uid||null,n?.email||null),X=NO(n?.uid||null,Q.data||null,{enabled:!!n?.uid&&!!Q.data}),Z=Q.data?.permission_flags?.is_admin===!0,oe=Q.data?.permission_flags?.is_test===!0,O=X.data?.pendingInvites||[],C=X.data?.budgets||[],R=O.length>0;D.useEffect(()=>{if(!n||A||Q.isLoading||X.isLoading)return;const z=Q.data,F=X.data;!z&&!Q.isError||(z&&z.budget_ids.length>0?(a(z.budget_ids[0]),G(!1)):F?.pendingInvites&&F.pendingInvites.length>0?G(!1):G(!0),I(!0))},[n,A,Q.data,Q.isLoading,Q.isError,X.data,X.isLoading]);const N=D.useCallback(()=>{f(z=>z===1?(c(F=>F-1),12):z-1)},[]),j=D.useCallback(()=>{f(z=>z===12?(c(F=>F+1),1):z+1)},[]),U=D.useCallback(async()=>{await X.refetch()},[X]),M=D.useCallback(z=>{a(z)},[]),W=D.useCallback(async z=>{if(!n)return null;try{const F=await XO(z,n.uid);return F&&F.isInvited&&!F.hasAccepted?{budgetId:z,budgetName:F.budgetName,ownerEmail:F.ownerEmail}:null}catch(F){return console.error("[BudgetContext] Error checking budget invite:",F),null}},[n]),H=D.useCallback(()=>{Oe.clear(),localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),B={currentUserId:n?.uid||null,selectedBudgetId:i,currentYear:l,currentMonthNumber:d,lastActiveTab:p,lastSettingsTab:v,lastAdminTab:T,setSelectedBudgetId:a,setCurrentYear:c,setCurrentMonthNumber:f,setLastActiveTab:_,setLastSettingsTab:b,setLastAdminTab:w,isInitialized:A,needsFirstBudget:P,goToPreviousMonth:N,goToNextMonth:j,pendingInvites:O,hasPendingInvites:R,accessibleBudgets:C,isAdmin:Z,isTest:oe,loadAccessibleBudgets:U,switchToBudget:M,checkBudgetInvite:W,clearCache:H};return h.jsx(TT.Provider,{value:B,children:t})}function an(){const t=D.useContext(TT);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}function _N(){return h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx("nav",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:h.jsx(wt,{to:"/",style:{display:"flex",alignItems:"center"},title:"Tarron Lane Home",children:h.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane Home",style:{width:"2rem",height:"2rem"}})})}),h.jsx("h1",{children:"Tarron Lane Homepage"}),h.jsx("nav",{children:h.jsxs("ul",{children:[h.jsx("li",{children:h.jsx(wt,{to:"/sql-test",children:"SQL Test"})}),h.jsx("li",{children:h.jsx(wt,{to:"/budget",children:"Budget"})}),h.jsx("li",{children:h.jsx(wt,{to:"/account",children:"Account"})})]})})]})}const vN={mobile:640},bN=vN.mobile,Iy=["January","February","March","April","May","June","July","August","September","October","November","December"],_e={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15"},EN={maxWidth:"60rem",margin:"0 auto",padding:"2rem"},hu={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},xN={...hu,padding:"0.6rem 0.875rem",gap:"0.5rem"},SN={background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1rem 1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},wN={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},TN={display:"flex",flexDirection:"column",gap:"0.5rem"},AN={fontSize:"0.9rem",fontWeight:500},fu={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit"},CN={...fu,cursor:"pointer"},jy={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},AT={...jy,background:_e.primary,color:"white",border:"none"},RN={...AT,padding:"0.75rem 1.5rem",borderRadius:"8px"},DN={...jy,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},IN={...jy,background:"transparent",border:`1px solid ${_e.errorBorder}`,color:_e.error},jN={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},ON={display:"flex",gap:"0.5rem"},MN={display:"flex",gap:"0.25rem"},CT={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},kN={...CT,borderColor:_e.errorBorder,color:_e.error},rl={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},Oy={display:"flex",flexDirection:"column",gap:"2px"},NN={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},RT={opacity:.4,cursor:"grab"},DT={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",transition:"opacity 0.15s"},PN={position:"relative",height:"2rem",marginTop:"-0.25rem"},LN={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",transition:"opacity 0.15s"},VN={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},BN={background:_e.errorBg,border:`1px solid ${_e.errorBorder}`,color:_e.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},UN={background:"transparent",border:"none",color:_e.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},mf={opacity:.7,marginBottom:"1.5rem"},vl={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},My={fontWeight:500,fontSize:"1.1rem"},qs={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function Ko({children:t}){return h.jsx("div",{style:EN,children:t})}function bl({message:t,children:e,onDismiss:n,style:i}){return h.jsxs("div",{style:{...BN,...i},children:[h.jsx("span",{children:e??t}),n&&h.jsx("button",{onClick:n,style:UN,children:""})]})}const zN={primary:AT,"primary-large":RN,secondary:DN,danger:IN,small:jN};function Ne({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:i,disabled:a,style:l,...c}){const d=zN[t],f=a||e;return h.jsx("button",{disabled:f,style:{...d,cursor:f?"not-allowed":"pointer",opacity:f?.7:1,...l},...c,children:e?n:i})}function Ua({children:t,onSubmit:e}){return h.jsx("form",{onSubmit:e,style:wN,children:t})}function Gt({label:t,htmlFor:e,children:n,hint:i}){return h.jsxs("div",{style:TN,children:[h.jsx("label",{htmlFor:e,style:AN,children:t}),n,i&&h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:i})]})}function Fi(t){return h.jsx("input",{style:fu,...t})}function ka({children:t,...e}){return h.jsx("select",{style:CN,...e,children:t})}function ky({minHeight:t="6rem",style:e,...n}){return h.jsx("textarea",{style:{...fu,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function Ks({children:t}){return h.jsx("div",{style:NN,children:t})}function Vp(t){const n=t.replace(/[^\d.]/g,"").split("."),i=n[0]||"",a=n[1],l=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return a!==void 0?`$${l}.${a.slice(0,2)}`:l?`$${l}`:""}function FN(t){return t.replace(/[$,]/g,"")}function Ny({id:t,value:e,onChange:n,placeholder:i="$0.00",required:a,autoFocus:l}){const[c,d]=D.useState(()=>Vp(e)),f=D.useRef(null);D.useEffect(()=>{const _=Vp(e);FN(c)!==e&&d(_)},[e]);function p(_){const v=_.target.value;if(!v||v==="$"){d(""),n("");return}const T=v.replace(/[^\d.]/g,"").split(".");let w=T[0];T.length>1&&(w+="."+T.slice(1).join("").slice(0,2));const A=Vp(w);d(A),n(w)}return h.jsx("input",{ref:f,id:t,type:"text",inputMode:"decimal",value:c,onChange:p,placeholder:i,required:a,autoFocus:l,style:fu})}function qN(t,e){const n=t.toLowerCase(),i=e.toLowerCase();if(i.includes(n)){const d=i.indexOf(n);return{match:!0,score:d===0||/\s/.test(i[d-1])?100:90}}let a=0,l=0,c=0;for(let d=0;d<i.length&&a<n.length;d++)i[d]===n[a]?(a++,c++,l+=c*2):c=0;return a===n.length?{match:!0,score:l}:{match:!1,score:0}}function IT({id:t,value:e,onChange:n,payees:i,placeholder:a="Enter payee name"}){const[l,c]=D.useState(!1),[d,f]=D.useState(-1),p=D.useRef(null),_=D.useRef(null),v=e.trim()?i.map(w=>({payee:w,...qN(e,w)})).filter(w=>w.match).sort((w,A)=>A.score-w.score).slice(0,8).map(w=>w.payee):[];D.useEffect(()=>{function w(A){p.current&&!p.current.contains(A.target)&&c(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);function b(w){!l||v.length===0||(w.key==="ArrowDown"?(w.preventDefault(),f(A=>Math.min(A+1,v.length-1))):w.key==="ArrowUp"?(w.preventDefault(),f(A=>Math.max(A-1,-1))):w.key==="Enter"&&d>=0?(w.preventDefault(),n(v[d]),c(!1),f(-1)):w.key==="Escape"&&(c(!1),f(-1)))}function T(w){n(w),c(!1),f(-1),_.current?.focus()}return h.jsxs("div",{ref:p,style:{position:"relative"},children:[h.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:w=>{n(w.target.value),c(!0),f(-1)},onFocus:()=>c(!0),onKeyDown:b,placeholder:a,autoComplete:"off",style:fu}),l&&v.length>0&&h.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:v.map((w,A)=>h.jsx("div",{onClick:()=>T(w),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:A===d?`color-mix(in srgb, ${_e.primary} 20%, transparent)`:"transparent",borderBottom:A<v.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>f(A),children:w},w))})]})}function $s(t=bN){const[e,n]=D.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return D.useEffect(()=>{function i(){n(window.innerWidth<t)}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[t]),e}function pf({children:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:d,onEdit:f,onDelete:p,onMoveUp:_,onMoveDown:v,canMoveUp:b=!0,canMoveDown:T=!0}){const w=$s(),A=_||v;return h.jsxs("div",{onDragOver:I=>{I.stopPropagation(),a(I)},onDragLeave:I=>{I.stopPropagation(),l()},onDrop:I=>{I.stopPropagation(),d(I)},style:{position:"relative"},children:[h.jsx("div",{style:{...DT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),h.jsxs("div",{style:{...w?xN:hu,opacity:e?.5:1},children:[h.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:w?"0.5rem":"0.75rem",minWidth:0},children:[h.jsx("span",{draggable:!0,onDragStart:i,onDragEnd:c,style:{...RT,fontSize:w?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),h.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),h.jsxs("div",{style:w?MN:ON,children:[w?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:f,style:CT,title:"Edit","aria-label":"Edit",children:""}),h.jsx("button",{onClick:p,style:kN,title:"Delete","aria-label":"Delete",children:""})]}):h.jsxs(h.Fragment,{children:[h.jsx(Ne,{variant:"secondary",onClick:f,children:"Edit"}),h.jsx(Ne,{variant:"danger",onClick:p,children:"Delete"})]}),A&&h.jsxs("div",{style:Oy,children:[h.jsx("button",{onClick:I=>{I.stopPropagation(),_?.()},disabled:!b,style:{...rl,opacity:b?.6:.2,cursor:b?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),h.jsx("button",{onClick:I=>{I.stopPropagation(),v?.()},disabled:!T,style:{...rl,opacity:T?.6:.2,cursor:T?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function Py({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i,label:a="Move to end"}){return h.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:PN,children:[h.jsx("div",{style:{...LN,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&h.jsx("span",{style:VN,children:a})]})}function Cc({children:t,style:e}){return h.jsx("div",{style:{...SN,...e},children:t})}function qe(t){return`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function gn(t){return t>=0?_e.success:_e.danger}function kh({isOpen:t,onClose:e,title:n,children:i,width:a="28rem"}){return t?h.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:e,children:h.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:a,maxWidth:"calc(100vw - 2rem)",flexShrink:0,boxSizing:"border-box",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:l=>l.stopPropagation(),children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[h.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),h.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),i]})}):null}const QN={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function GN(){const[t,e]=D.useState(!1),[n,i]=D.useState(""),[a,l]=D.useState("bug"),[c,d]=D.useState(!1),[f,p]=D.useState(null),_=D.useContext(Jc),b=Ba().get_current_firebase_user(),T=Pn(),w=Gw();if(T.pathname.includes("/settings/feedback")||!_.is_logged_in)return null;async function I(P){if(P.preventDefault(),!(!n.trim()||!_.username||!b)){p(null);try{await w.submitFeedback.mutateAsync({userId:b.uid,userEmail:_.username,text:n.trim(),feedbackType:a,currentPath:T.pathname}),i(""),l("bug"),d(!0),setTimeout(()=>{d(!1),e(!1)},1500)}catch(G){p(G instanceof Error?G.message:"Failed to submit feedback")}}}return h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>e(!0),style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:_e.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:P=>{P.currentTarget.style.transform="scale(1.1)",P.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:P=>{P.currentTarget.style.transform="scale(1)",P.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),h.jsx(kh,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:c?h.jsxs("div",{style:{textAlign:"center",padding:"2rem 0",color:_e.success},children:[h.jsx("span",{style:{fontSize:"2rem",display:"block",marginBottom:"0.5rem"},children:""}),"Feedback submitted!"]}):h.jsxs("form",{onSubmit:I,children:[h.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(P=>{const G=QN[P],Q=a===P;return h.jsxs("button",{type:"button",onClick:()=>l(P),style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${G.color}`,borderRadius:"0.5rem",background:Q?G.bgColor:"transparent",color:Q?G.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:Q?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:Q?1:.5,boxShadow:Q?`0 0 12px ${G.bgColor}`:"none",position:"relative"},children:[G.label,Q&&h.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},P)})}),h.jsx(ky,{value:n,onChange:P=>i(P.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),f&&h.jsx("p",{style:{color:_e.error,fontSize:"0.85rem",margin:"0.5rem 0"},children:f}),h.jsxs(Ks,{children:[h.jsx(Ne,{type:"button",variant:"secondary",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),h.jsx(Ne,{type:"submit",isLoading:w.submitFeedback.isPending,disabled:!n.trim(),children:"Submit"})]})]})})]})}function Do({children:t,labelStyle:e,...n}){return h.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[h.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:_e.primary},...n}),t]})}function HN({title:t,count:e,children:n,defaultExpanded:i=!1}){const[a,l]=D.useState(i);return h.jsxs("div",{style:{marginTop:"2rem"},children:[h.jsxs("button",{onClick:()=>l(!a),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[h.jsx("span",{style:{transition:"transform 0.2s",transform:a?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),a&&n]})}const KN=t=>{switch(t){case 2:return 220;case 3:return 320;case 4:return 420;case 5:return 520;case 6:return 620;default:return t*100+20}},$N=t=>t<=4?2:t<=6?3:Math.ceil(t/2);function Ly(t){const{tabs:e,activeTab:n}=t,i=e.filter(v=>!v.hidden),a=i.length,l=KN(a),c=$N(a),d=Math.floor(100/c),f=`tab-nav-${a}`,p=v=>({flex:"1 1 0",padding:"0.6rem 0.5rem",border:"none",borderRadius:0,background:"transparent",cursor:"pointer",fontWeight:v?600:400,fontSize:"0.9rem",color:"inherit",opacity:v?1:.5,transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem",position:"relative",boxSizing:"border-box",outline:"none"}),_=(v,b)=>h.jsxs(h.Fragment,{children:[h.jsx("span",{children:v.label}),v.checkmark&&h.jsx("span",{style:{color:_e.success,fontWeight:600},children:""}),b&&h.jsx("span",{style:{position:"absolute",bottom:"-1px",left:"15%",right:"15%",height:"3px",background:"white",borderRadius:"2px"}})]});return h.jsxs(h.Fragment,{children:[h.jsx("style",{children:`
        .${f} {
          display: flex;
          flex-wrap: wrap;
          margin-bottom: 1.5rem;
          border-bottom: 1px solid color-mix(in srgb, currentColor 15%, transparent);
        }
        .${f} > button,
        .${f} > a {
          border: none !important;
          border-radius: 0 !important;
          outline: none !important;
        }
        .${f} > button:hover,
        .${f} > button:focus,
        .${f} > a:hover,
        .${f} > a:focus {
          border: none !important;
          border-color: transparent !important;
        }
        @media (max-width: ${l}px) {
          .${f} > * {
            flex: 1 1 ${d}% !important;
            min-width: ${d}% !important;
          }
        }
      `}),h.jsx("div",{className:f,children:i.map(v=>{const b=n===v.id;return t.mode==="link"?h.jsx(wt,{to:`${t.linkPrefix}/${v.id}`,style:p(b),children:_(v,b)},v.id):h.jsx("button",{onClick:()=>t.onTabChange(v.id),style:p(b),children:_(v,b)},v.id)})})]})}function Vy({items:t}){const[e,n]=D.useState(!1),i=D.useRef(null),l=Pn().pathname;D.useEffect(()=>{function d(f){i.current&&!i.current.contains(f.target)&&n(!1)}if(e)return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[e]),D.useEffect(()=>{function d(f){f.key==="Escape"&&n(!1)}if(e)return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[e]);const c=t.filter(d=>d.hidden?!1:d.to?d.to==="/budget"||d.to==="/account"?l!==d.to:!l.startsWith(d.to):!0);return h.jsxs("div",{ref:i,style:{position:"relative"},children:[h.jsx("button",{onClick:()=>n(!e),style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:e?"color-mix(in srgb, currentColor 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:"none",cursor:"pointer",fontSize:"1.25rem",color:"inherit",transition:"background 0.15s",lineHeight:1},title:"Menu","aria-expanded":e,"aria-haspopup":"true",children:""}),e&&h.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",minWidth:"180px",background:"#1a1a2e",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",zIndex:1e3,overflow:"hidden"},children:c.map((d,f)=>{if(d.divider)return h.jsx("div",{style:{height:"1px",background:"color-mix(in srgb, currentColor 15%, transparent)",margin:"0.25rem 0"}},f);const p=h.jsxs(h.Fragment,{children:[d.icon&&h.jsx("span",{style:{width:"1.5rem",textAlign:"center"},children:d.icon}),h.jsx("span",{children:d.label})]}),_={display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",fontSize:"0.95rem",color:"inherit",textDecoration:"none",cursor:"pointer",transition:"background 0.15s",background:"transparent",border:"none",width:"100%",textAlign:"left"},v={background:"color-mix(in srgb, currentColor 10%, transparent)"};return d.to?h.jsx(wt,{to:d.to,style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",onClick:()=>n(!1),children:p},f):h.jsx("button",{onClick:()=>{d.onClick?.(),n(!1)},style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",children:p},f)})})]})}function ci({title:t,showBackArrow:e=!1,hideMenu:n=!1}){const{isAdmin:i}=an(),a=[{label:"Budget",icon:"",to:"/budget"},{label:"Analytics",icon:"",to:"/budget/analytics"},...i?[{label:"Admin",icon:"",to:"/budget/admin"}]:[],{label:"Budget Settings",icon:"",to:"/budget/settings"},{label:"Switch Budgets",icon:"",to:"/budget/my-budgets"},{divider:!0,label:""},{label:"Exit Budget App",icon:"",to:"/"}];return h.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[e?h.jsx(wt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none"},title:"Back to Home",children:""}):h.jsx(wt,{to:"/budget",title:"Budget Home",children:h.jsx("img",{src:"/budget-icon.svg",alt:"Budget",style:{width:"1.5rem",height:"1.5rem"}})}),h.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem",textAlign:"center"},children:t}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:!n&&h.jsx(Vy,{items:a})})]})}const WN="900px";function YN({children:t,style:e}){return h.jsx("div",{style:{width:"100%",maxWidth:WN,marginLeft:"auto",marginRight:"auto",...e},children:t})}function Sg(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function XN(){return h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[h.jsx("div",{style:{display:"flex",alignItems:"center"},children:h.jsx(wt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),h.jsxs(wt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[h.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),h.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"SQL Test"})]}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:h.jsx(Vy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),h.jsx("h1",{children:"SQL Test"}),h.jsx("h2",{children:"Setup"}),h.jsxs("h3",{children:["1. Open up your preferred web browser to ",h.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),h.jsxs("ul",{children:[h.jsx("li",{children:"This is a basic online sql query editor"}),h.jsxs("li",{children:["It will include three tables: ",h.jsx("b",{children:'"Customer"'}),", ",h.jsx("b",{children:'"Orders"'}),", and ",h.jsx("b",{children:'"Shippings"'})]})]}),h.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),h.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:h.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),h.jsx("h2",{children:"SQL Problems"}),h.jsx("p",{children:"Write queries in the online editor to answer these questions."}),h.jsx("h3",{children:"Question #1"}),h.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),h.jsx("h3",{children:"Question #2"}),h.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function JN(){const t=D.useContext(Jc),e=Ba(),[n,i]=D.useState(!1),a=Pn(),l=Bh(),c=a.state?.from||"/";D.useEffect(()=>{t.is_logged_in&&c!=="/"&&l(c,{replace:!0})},[t.is_logged_in,c,l]);function d(){i(!0),e.logout_firebase_user().then(function(){i(!1)})}return h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[h.jsx("div",{style:{display:"flex",alignItems:"center"},children:h.jsx(wt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),h.jsxs(wt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[h.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),h.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"Account"})]}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:h.jsx(Vy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),h.jsx("h1",{children:"Account"}),t.is_logged_in?n?h.jsx("p",{children:"Logging Out..."}):h.jsxs(h.Fragment,{children:[h.jsxs("p",{children:["You are logged in as ",t.username]}),h.jsx("button",{onClick:d,style:{marginTop:"1rem"},children:"Logout"})]}):h.jsx(ZN,{})]})}function ZN(){const t=Ba(),[e,n]=D.useState(""),[i,a]=D.useState(""),[l,c]=D.useState(!1),[d,f]=D.useState("");function p(b){n(b.target.value)}function _(b){a(b.target.value)}function v(b){b.preventDefault(),c(!0),f(""),t.login_firebase_user(e,i).then(function(){}).catch(function(){f("Incorrect login credentials")}).finally(function(){c(!1)})}return h.jsxs("form",{onSubmit:v,children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"username",children:"Email: "}),h.jsx("input",{id:"username",type:"email",value:e,onChange:p})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"password",children:"Password: "}),h.jsx("input",{id:"password",type:"password",value:i,onChange:_})]}),l?h.jsx("p",{children:"Logging in..."}):h.jsx("button",{children:"Login"}),d&&h.jsx("p",{style:{color:"red"},children:d})]})}function Tn(t,e){const n=wO(t),i=GO(),a=YO(),l=n.data,c=l?.budget||null,d=D.useMemo(()=>l?.accounts||{},[l?.accounts]),f=D.useMemo(()=>l?.accountGroups||{},[l?.accountGroups]),p=D.useMemo(()=>l?.categories||{},[l?.categories]),_=D.useMemo(()=>l?.categoryGroups||[],[l?.categoryGroups]),v=l?.categoryBalancesSnapshot||null,b=c?.owner_id===e,T=D.useMemo(()=>c?.user_ids||[],[c?.user_ids]),w=D.useMemo(()=>c?.accepted_user_ids||[],[c?.accepted_user_ids]),A=D.useCallback(async $=>{if(!t)throw new Error("No budget selected");await i.updateAccounts.mutateAsync({budgetId:t,accounts:$})},[t,i.updateAccounts]),I=D.useCallback(async $=>{if(!t)throw new Error("No budget selected");await i.updateAccountGroups.mutateAsync({budgetId:t,accountGroups:$})},[t,i.updateAccountGroups]),P=D.useCallback(async $=>{if(!t)throw new Error("No budget selected");await i.updateCategories.mutateAsync({budgetId:t,categories:$})},[t,i.updateCategories]),G=D.useCallback(async $=>{if(!t)throw new Error("No budget selected");await i.updateCategoryGroups.mutateAsync({budgetId:t,categoryGroups:$})},[t,i.updateCategoryGroups]),Q=D.useCallback(async($,te)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.updateAccounts.mutateAsync({budgetId:t,accounts:$}),i.updateAccountGroups.mutateAsync({budgetId:t,accountGroups:te})])},[t,i]),X=D.useCallback(async($,te)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.updateCategories.mutateAsync({budgetId:t,categories:$}),i.updateCategoryGroups.mutateAsync({budgetId:t,categoryGroups:te})])},[t,i]),Z=D.useCallback(async $=>{if(!t)throw new Error("No budget selected");await i.renameBudget.mutateAsync({budgetId:t,newName:$})},[t,i.renameBudget]),oe=D.useCallback(async $=>{if(!e)throw new Error("Not authenticated");return await a.createBudget.mutateAsync({name:$.trim()||"My Budget",userId:e,userEmail:null})},[e,a.createBudget]),O=D.useCallback(async $=>{if(!t)throw new Error("No budget selected");await a.inviteUser.mutateAsync({budgetId:t,userId:$})},[t,a.inviteUser]),C=D.useCallback(async $=>{if(!t)throw new Error("No budget selected");await a.revokeUser.mutateAsync({budgetId:t,userId:$})},[t,a.revokeUser]),R=D.useCallback(async $=>{if(!e)throw new Error("Not authenticated");await a.acceptInvite.mutateAsync({budgetId:$,userId:e})},[e,a.acceptInvite]),N=D.useCallback(async($,te,V)=>{if(!t)throw new Error("No budget selected");await i.saveCategoryBalancesSnapshot.mutateAsync({budgetId:t,balances:$,year:te,month:V})},[t,i.saveCategoryBalancesSnapshot]),j=D.useCallback(async($,te,V,q)=>{if(!t)throw new Error("No budget selected");await i.recalculateCategoryBalances.mutateAsync({budgetId:t,categories:$,balances:te,year:V,month:q})},[t,i.recalculateCategoryBalances]),U=D.useCallback($=>{if(!t)return;const te=Oe.getQueryData(ie.budget(t));te&&Oe.setQueryData(ie.budget(t),{...te,accounts:$})},[t]),M=D.useCallback($=>{if(!t)return;const te=Oe.getQueryData(ie.budget(t));te&&Oe.setQueryData(ie.budget(t),{...te,accountGroups:$})},[t]),W=D.useCallback($=>{if(!t)return;const te=Oe.getQueryData(ie.budget(t));te&&Oe.setQueryData(ie.budget(t),{...te,categories:$})},[t]),H=D.useCallback($=>{if(!t)return;const te=Oe.getQueryData(ie.budget(t));te&&Oe.setQueryData(ie.budget(t),{...te,categoryGroups:$})},[t]),B=D.useCallback($=>{if(!t)return;const te=Oe.getQueryData(ie.budget(t));te&&Oe.setQueryData(ie.budget(t),{...te,categoryBalancesSnapshot:$})},[t]),z=D.useCallback(async()=>{t&&await Oe.invalidateQueries({queryKey:ie.budget(t)})},[t]),F=D.useCallback(()=>Object.entries(d).filter(([,$])=>{const te=$.account_group_id?f[$.account_group_id]:void 0,V=te?.on_budget!==void 0?te.on_budget:$.on_budget!==!1,q=te?.is_active!==void 0?te.is_active:$.is_active!==!1;return V&&q}).reduce(($,[,te])=>$+te.balance,0),[d,f]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:c,accounts:d,accountGroups:f,categories:p,categoryGroups:_,categoryBalancesSnapshot:v,isOwner:b,budgetUserIds:T,acceptedUserIds:w,saveAccounts:A,saveAccountGroups:I,saveCategories:P,saveCategoryGroups:G,saveAccountsAndGroups:Q,saveCategoriesAndGroups:X,renameBudget:Z,createBudget:oe,inviteUser:O,revokeUser:C,acceptInvite:R,saveCategoryBalancesSnapshot:N,recalculateCategoryBalances:j,setAccountsOptimistic:U,setAccountGroupsOptimistic:M,setCategoriesOptimistic:W,setCategoryGroupsOptimistic:H,setCategoryBalancesSnapshotOptimistic:B,refreshBudget:z,getOnBudgetTotal:F}}function El(t,e,n){const i=RO(t,e,n,{enabled:!!t}),a=jO(t,{enabled:!!t}),l=WO(),c=i.data?.month||null,d=c?.income||[],f=c?.expenses||[],p=c?.allocations||[],_=c?.category_balances||[],v=c?.total_income||0,b=c?.total_expenses||0,T=c?.allocations_finalized||!1,w=D.useMemo(()=>{if(c?.previous_month_snapshot?.total_income!==void 0)return c.previous_month_snapshot.total_income;if(!t)return 0;let j=e,U=n-1;return U<1&&(U=12,j-=1),Oe.getQueryData(ie.month(t,j,U))?.month?.total_income||0},[c,t,e,n]),A=a.data||[],I=D.useCallback(async(j,U,M,W,H)=>{if(!t)throw new Error("No budget selected");const[B,z]=M.split("-").map(Number);await l.addIncome.mutateAsync({budgetId:t,year:B,month:z,amount:j,accountId:U,date:M,payee:W,description:H})},[t,l.addIncome]),P=D.useCallback(async(j,U,M,W,H,B)=>{if(!t||!c)throw new Error("No budget or month loaded");const z=c.income.find(F=>F.id===j);if(!z)throw new Error("Income not found");await l.updateIncome.mutateAsync({budgetId:t,year:e,month:n,incomeId:j,amount:U,accountId:M,date:W,payee:H,description:B,oldAmount:z.amount,oldAccountId:z.account_id})},[t,c,e,n,l.updateIncome]),G=D.useCallback(async j=>{if(!t||!c)throw new Error("No budget or month loaded");const U=c.income.find(M=>M.id===j);if(!U)throw new Error("Income not found");await l.deleteIncome.mutateAsync({budgetId:t,year:e,month:n,incomeId:j,amount:U.amount,accountId:U.account_id})},[t,c,e,n,l.deleteIncome]),Q=D.useCallback(async(j,U,M,W,H,B)=>{if(!t)throw new Error("No budget selected");const[z,F]=W.split("-").map(Number);await l.addExpense.mutateAsync({budgetId:t,year:z,month:F,amount:j,categoryId:U,accountId:M,date:W,payee:H,description:B})},[t,l.addExpense]),X=D.useCallback(async(j,U,M,W,H,B,z)=>{if(!t||!c)throw new Error("No budget or month loaded");const F=c.expenses?.find($=>$.id===j);if(!F)throw new Error("Expense not found");await l.updateExpense.mutateAsync({budgetId:t,year:e,month:n,expenseId:j,amount:U,categoryId:M,accountId:W,date:H,payee:B,description:z,oldAmount:F.amount,oldAccountId:F.account_id})},[t,c,e,n,l.updateExpense]),Z=D.useCallback(async j=>{if(!t||!c)throw new Error("No budget or month loaded");const U=c.expenses?.find(M=>M.id===j);if(!U)throw new Error("Expense not found");await l.deleteExpense.mutateAsync({budgetId:t,year:e,month:n,expenseId:j,amount:U.amount,accountId:U.account_id})},[t,c,e,n,l.deleteExpense]),oe=D.useCallback(async j=>{if(!t)throw new Error("No budget selected");await l.saveAllocations.mutateAsync({budgetId:t,year:e,month:n,allocations:j})},[t,e,n,l.saveAllocations]),O=D.useCallback(async j=>{if(!t)throw new Error("No budget selected");await l.finalizeAllocations.mutateAsync({budgetId:t,year:e,month:n,allocations:j})},[t,e,n,l.finalizeAllocations]),C=D.useCallback(async()=>{if(!t)throw new Error("No budget selected");await l.unfinalizeAllocations.mutateAsync({budgetId:t,year:e,month:n})},[t,e,n,l.unfinalizeAllocations]),R=D.useCallback(async()=>{if(!t)throw new Error("No budget selected");await l.deleteAllocations.mutateAsync({budgetId:t,year:e,month:n})},[t,e,n,l.deleteAllocations]),N=D.useCallback(async()=>{t&&await Oe.invalidateQueries({queryKey:ie.month(t,e,n)})},[t,e,n]);return{isLoading:i.isLoading,isFetching:i.isFetching,error:i.error,month:c,income:d,expenses:f,allocations:p,categoryBalances:_,totalIncome:v,totalExpenses:b,allocationsFinalized:T,previousMonthIncome:w,payees:A,payeesLoading:a.isLoading,addIncome:I,updateIncome:P,deleteIncome:G,addExpense:Q,updateExpense:X,deleteExpense:Z,saveAllocations:oe,finalizeAllocations:O,unfinalizeAllocations:C,deleteAllocations:R,refreshMonth:N}}function e6(){const{selectedBudgetId:t,currentUserId:e}=an(),{budget:n,accounts:i,accountGroups:a,saveAccounts:l,saveAccountGroups:c,saveAccountsAndGroups:d,setAccountsOptimistic:f,setAccountGroupsOptimistic:p}=Tn(t,e),[_,v]=D.useState(null),b=D.useMemo(()=>Object.entries(i).reduce((C,[R,N])=>{const j=N.account_group_id||"ungrouped";return C[j]||(C[j]=[]),C[j].push({...N,id:R}),C},{}),[i]),T=D.useMemo(()=>Object.entries(a).sort(([,C],[,R])=>C.sort_order-R.sort_order).map(([C,R])=>({...R,id:C})),[a]),w=D.useCallback((C,R)=>{if(!n)return;const N=Object.values(i).filter(H=>R==="ungrouped"?!H.account_group_id:H.account_group_id===R),j=N.length>0?Math.max(...N.map(H=>H.sort_order)):-1,U=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,M={nickname:C.nickname,balance:0,account_group_id:R==="ungrouped"?null:R,sort_order:j+1,is_income_account:C.is_income_account,is_income_default:C.is_income_default,is_outgo_account:C.is_outgo_account,is_outgo_default:C.is_outgo_default,on_budget:C.on_budget!==!1,is_active:C.is_active!==!1},W={...i};C.is_income_default&&Object.keys(W).forEach(H=>{W[H]={...W[H],is_income_default:!1}}),C.is_outgo_default&&Object.keys(W).forEach(H=>{W[H]={...W[H],is_outgo_default:!1}}),W[U]=M,f(W),l(W).catch(H=>{console.error("[useAccountHandlers] Error creating account:",H),v(H instanceof Error?H.message:"Failed to create account.")})},[n,i,f,l]),A=D.useCallback((C,R)=>{if(!n)return;const N=i[C];if(!N)return;const j=N.account_group_id||"ungrouped",U=R.account_group_id;let M=N.sort_order;if(j!==(U||"ungrouped")){const H=Object.values(i).filter(B=>(B.account_group_id||"ungrouped")===(U||"ungrouped"));M=H.length>0?Math.max(...H.map(B=>B.sort_order))+1:0}const W={};Object.entries(i).forEach(([H,B])=>{H===C?W[H]={...B,nickname:R.nickname,account_group_id:U,sort_order:M,is_income_account:R.is_income_account,is_income_default:R.is_income_default,is_outgo_account:R.is_outgo_account,is_outgo_default:R.is_outgo_default,on_budget:R.on_budget!==!1,is_active:R.is_active!==!1}:(W[H]={...B},R.is_income_default&&!N.is_income_default&&(W[H].is_income_default=!1),R.is_outgo_default&&!N.is_outgo_default&&(W[H].is_outgo_default=!1))}),f(W),l(W).catch(H=>{console.error("[useAccountHandlers] Error saving account:",H),v(H instanceof Error?H.message:"Failed to save account.")})},[n,i,f,l]),I=D.useCallback(C=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[C]:R,...N}=i;f(N),l(N).catch(j=>{console.error("[useAccountHandlers] Error deleting account:",j),v(j instanceof Error?j.message:"Failed to delete account.")})},[n,i,f,l]),P=D.useCallback(async(C,R)=>{const N=i[C];if(!N)return;const j=N.account_group_id||"ungrouped",U=Object.entries(i).filter(([,F])=>(F.account_group_id||"ungrouped")===j).sort(([,F],[,$])=>F.sort_order-$.sort_order),M=U.findIndex(([F])=>F===C),W=R==="up"?M-1:M+1;if(W<0||W>=U.length)return;const[H,B]=U[W],z={};if(Object.entries(i).forEach(([F,$])=>{F===C?z[F]={...$,sort_order:B.sort_order}:F===H?z[F]={...$,sort_order:N.sort_order}:z[F]={...$}}),f(z),!!n)try{await l(z)}catch(F){f(i),v(F instanceof Error?F.message:"Failed to move account")}},[n,i,f,l]),G=D.useCallback(C=>{if(!n)return;const R=Object.values(a).map(W=>W.sort_order),N=R.length>0?Math.max(...R):-1,j=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,U={name:C.name,sort_order:N+1,expected_balance:C.expected_balance,on_budget:C.on_budget,is_active:C.is_active},M={...a,[j]:U};p(M),c(M).catch(W=>{console.error("[useAccountHandlers] Error creating group:",W),v(W instanceof Error?W.message:"Failed to create account type.")})},[n,a,p,c]),Q=D.useCallback((C,R)=>{if(!n)return;const N={...a,[C]:{...a[C],name:R.name,expected_balance:R.expected_balance,on_budget:R.on_budget,is_active:R.is_active}};p(N),c(N).catch(j=>{console.error("[useAccountHandlers] Error updating group:",j),v(j instanceof Error?j.message:"Failed to update account type.")})},[n,a,p,c]),X=D.useCallback(C=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const R={};Object.entries(i).forEach(([U,M])=>{R[U]=M.account_group_id===C?{...M,account_group_id:null}:M});const{[C]:N,...j}=a;f(R),p(j),d(R,j).catch(U=>{console.error("[useAccountHandlers] Error deleting group:",U),v(U instanceof Error?U.message:"Failed to delete account type.")})},[n,i,a,f,p,d]),Z=D.useCallback(async(C,R)=>{const N=Object.entries(a).sort(([,H],[,B])=>H.sort_order-B.sort_order),j=N.findIndex(([H])=>H===C),U=R==="up"?j-1:j+1;if(U<0||U>=N.length)return;const[M]=N.splice(j,1);N.splice(U,0,M);const W={};if(N.forEach(([H,B],z)=>{W[H]={...B,sort_order:z}}),p(W),!!n)try{await c(W)}catch(H){p(a),v(H instanceof Error?H.message:"Failed to move account type")}},[n,a,p,c]),oe=D.useCallback(async(C,R,N)=>{const j=i[C];if(!j)return;const U=N==="ungrouped"?null:N,M=Object.entries(i).filter(([,B])=>(B.account_group_id||"ungrouped")===N),W={};Object.entries(i).forEach(([B,z])=>{B!==C&&(W[B]={...z})});let H;if(R==="__group_end__"||M.length===0||!M.find(([B])=>B===R))H=(M.length>0?Math.max(...M.filter(([z])=>z!==C).map(([,z])=>z.sort_order)):-1)+1;else{const B=M.find(([z])=>z===R);if(B){const[,z]=B;H=z.sort_order,Object.entries(W).forEach(([F,$])=>{($.account_group_id||"ungrouped")===N&&$.sort_order>=H&&(W[F]={...$,sort_order:$.sort_order+1})})}else H=0}if(W[C]={...j,account_group_id:U,sort_order:H},f(W),!!n)try{await l(W)}catch(B){v(B instanceof Error?B.message:"Failed to save changes")}},[n,i,f,l]),O=D.useCallback(async(C,R)=>{if(C===R)return;const N=Object.entries(a).sort(([,H],[,B])=>H.sort_order-B.sort_order),j=N.findIndex(([H])=>H===C),U=[...N],[M]=U.splice(j,1);if(R==="__end__")U.push(M);else{const H=U.findIndex(([B])=>B===R);U.splice(H,0,M)}const W={};if(U.forEach(([H,B],z)=>{W[H]={...B,sort_order:z}}),p(W),!!n)try{await c(W)}catch(H){v(H instanceof Error?H.message:"Failed to save new order")}},[n,a,p,c]);return{accounts:i,accountGroups:a,accountsByGroup:b,sortedGroups:T,currentBudget:n,error:_,setError:v,handleCreateAccount:w,handleUpdateAccount:A,handleDeleteAccount:I,handleMoveAccount:P,handleCreateGroup:G,handleUpdateGroup:Q,handleDeleteGroup:X,handleMoveGroup:Z,reorderAccountsInGroup:oe,reorderGroups:O}}function t6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=an(),{categories:a,categoryBalancesSnapshot:l,getOnBudgetTotal:c}=Tn(t,e),{month:d,isLoading:f,previousMonthIncome:p,saveAllocations:_,finalizeAllocations:v,deleteAllocations:b}=El(t,n,i),[T,w]=D.useState({}),[A,I]=D.useState(!1),[P,G]=D.useState(!1),[Q,X]=D.useState(!1),[Z,oe]=D.useState(!1),[O,C]=D.useState(null),R=D.useMemo(()=>l&&!l.is_stale?Object.values(l.balances).reduce((q,ne)=>q+(ne?.current??0),0):Object.values(a).reduce((q,ne)=>q+ne.balance,0),[a,l]);D.useEffect(()=>{if(!d)return;const q={};Object.entries(a).forEach(([ne,ee])=>{if(ee.default_monthly_type==="percentage")return;const ce=d.allocations?.find(be=>be.category_id===ne);ce?q[ne]=ce.amount.toString():ee.default_monthly_amount!==void 0&&ee.default_monthly_amount>0?q[ne]=ee.default_monthly_amount.toString():q[ne]=""}),w(q)},[d,a]);const N=D.useCallback((q,ne)=>{if(ne.default_monthly_type==="percentage"&&ne.default_monthly_amount!==void 0)return ne.default_monthly_amount/100*p;const ee=T[q],ce=parseFloat(ee||"0");return isNaN(ce)?0:ce},[T,p]),j=D.useMemo(()=>Object.entries(a).reduce((q,[ne,ee])=>q+N(ne,ee),0),[a,N]),U=c(),M=d?.allocations_finalized?(d.allocations||[]).reduce((q,ne)=>q+ne.amount,0):0,W=U-R,H=D.useMemo(()=>W-j+M,[W,j,M]),B=D.useCallback((q,ne)=>{w(ee=>({...ee,[q]:ne}))},[]),z=D.useCallback(()=>{if(!d)return;const q={};Object.entries(a).forEach(([ne,ee])=>{if(ee.default_monthly_type==="percentage")return;const ce=d.allocations?.find(be=>be.category_id===ne);ce?q[ne]=ce.amount.toString():ee.default_monthly_amount!==void 0&&ee.default_monthly_amount>0?q[ne]=ee.default_monthly_amount.toString():q[ne]=""}),w(q),oe(!1)},[d,a]),F=D.useCallback(()=>{const q=[];return Object.entries(a).forEach(([ne,ee])=>{const ce=N(ne,ee);ce>0&&q.push({category_id:ne,amount:ce})}),q},[a,N]),$=D.useCallback(async()=>{C(null),I(!0);try{await _(F()),oe(!1)}catch(q){C(q instanceof Error?q.message:"Failed to save allocations")}finally{I(!1)}},[_,F]),te=D.useCallback(async()=>{C(null),G(!0);try{await v(F())}catch(q){C(q instanceof Error?q.message:"Failed to finalize allocations")}finally{G(!1)}},[v,F]),V=D.useCallback(async()=>{C(null),X(!0);try{await b();const q={};Object.entries(a).forEach(([ne,ee])=>{ee.default_monthly_type!=="percentage"&&(ee.default_monthly_amount!==void 0&&ee.default_monthly_amount>0?q[ne]=ee.default_monthly_amount.toString():q[ne]="")}),w(q),oe(!1)}catch(q){C(q instanceof Error?q.message:"Failed to delete allocations")}finally{X(!1)}},[b,a]);return{localAllocations:T,isSavingAllocations:A,isFinalizingAllocations:P,isDeletingAllocations:Q,isEditingAppliedAllocations:Z,error:O,monthLoading:f,onBudgetTotal:U,availableNow:W,currentDraftTotal:j,availableAfterApply:H,previousMonthIncome:p,allocationsFinalized:d?.allocations_finalized??!1,getAllocationAmount:N,handleAllocationChange:B,resetAllocationsToSaved:z,handleSaveAllocations:$,handleFinalizeAllocations:te,handleDeleteAllocations:V,setIsEditingAppliedAllocations:oe,setError:C}}function n6({budgetId:t,categories:e,categoryBalancesSnapshot:n,currentYear:i,currentMonth:a,saveCategoryBalancesSnapshot:l,recalculateCategoryBalancesMutation:c}){const[d,f]=D.useState({}),[p,_]=D.useState(!1),[v,b]=D.useState(null),T=D.useRef(null),w=D.useCallback(P=>!(!P||P.is_stale||P.computed_for_year!==i||P.computed_for_month!==a),[i,a]);D.useEffect(()=>{if(!t||Object.keys(e).length===0)return;const P=`${t}_${i}_${a}`;if(T.current===P)return;if(w(n)){const Q={};Object.keys(e).forEach(X=>{const Z=n.balances[X];Q[X]=Z||{current:0,total:0}}),f(Q),T.current=P;return}(async()=>{_(!0);try{const Q=Object.keys(e),{current:X,total:Z}=await Np(t,Q,i,a,n),oe={};Q.forEach(O=>{oe[O]={current:X[O]??0,total:Z[O]??0}}),f(oe),T.current=P,await l(oe,i,a)}catch(Q){console.error("Error loading category balances:",Q)}finally{_(!1)}})()},[t,e,i,a,n,w,l]);const A=D.useCallback(async()=>{if(!t||Object.keys(e).length===0)return null;const P=Object.keys(e),{total:G}=await Np(t,P,i,a,null),Q={};Object.entries(e).forEach(([Z,oe])=>{const O=oe.balance,C=G[Z]??0;Math.abs(O-C)>.01&&(Q[Z]={stored:O,calculated:C})});const X=Object.keys(Q).length>0?Q:null;return b(X),X},[t,e,i,a]),I=D.useCallback(async()=>{if(!(!t||Object.keys(e).length===0)){_(!0);try{const P=Object.keys(e),{current:G,total:Q}=await Np(t,P,i,a,null),X={};Object.entries(e).forEach(([oe,O])=>{X[oe]={...O,balance:Q[oe]??0}});const Z={};P.forEach(oe=>{Z[oe]={current:G[oe]??0,total:Q[oe]??0}}),await c(X,Z,i,a),f(Z),b(null)}finally{_(!1)}}},[t,e,c,i,a]);return{categoryBalances:d,loadingBalances:p,categoryBalanceMismatch:v,checkCategoryBalanceMismatch:A,recalculateAndSaveCategoryBalances:I}}function r6({categories:t,categoryGroups:e,currentBudget:n,setCategoriesOptimistic:i,setCategoryGroupsOptimistic:a,saveCategories:l,saveCategoryGroups:c,setError:d}){const[f,p]=D.useState(null),[_,v]=D.useState(null),[b,T]=D.useState(null),[w,A]=D.useState(null);function I(N,j){p("category"),v(j),N.dataTransfer.effectAllowed="move"}function P(N,j,U){N.preventDefault(),f==="category"&&(j!==_&&T(j),A(U))}function G(N,j){N.preventDefault(),f==="category"?(A(j),T(null)):f==="group"&&j!==_&&T(j)}function Q(){T(null)}function X(){A(null)}function Z(){p(null),v(null),T(null),A(null)}async function oe(N,j,U){if(N.preventDefault(),N.stopPropagation(),!_||f!=="category"){Z();return}const M=t[_];if(!M)return;const W=U==="ungrouped"?null:U,H=Object.entries(t).filter(([,F])=>(F.category_group_id||"ungrouped")===U),B={};Object.entries(t).forEach(([F,$])=>{F!==_&&(B[F]=$)});let z;if(j==="__group_end__"||H.length===0||!H.find(([F])=>F===j))z=(H.length>0?Math.max(...H.filter(([$])=>$!==_).map(([,$])=>$.sort_order)):-1)+1;else{const F=H.find(([$])=>$===j);F?(z=F[1].sort_order,Object.entries(B).forEach(([$,te])=>{(te.category_group_id||"ungrouped")===U&&te.sort_order>=z&&(B[$]={...te,sort_order:te.sort_order+1})})):z=0}if(B[_]={...M,category_group_id:W,sort_order:z},i(B),Z(),!!n)try{await l(B)}catch(F){d(F instanceof Error?F.message:"Failed to save changes")}}async function O(N,j){N.preventDefault(),f==="category"?await oe(N,"__group_end__",j):f==="group"&&await R(N,j)}function C(N,j){N.stopPropagation(),p("group"),v(j),N.dataTransfer.effectAllowed="move"}async function R(N,j){if(N.preventDefault(),!_||f!=="group"||_===j){Z();return}const U=e.findIndex(B=>B.id===_),M=[...e],[W]=M.splice(U,1);if(j==="__end__")M.push(W);else{const B=M.findIndex(z=>z.id===j);M.splice(B,0,W)}const H=M.map((B,z)=>({...B,sort_order:z}));if(a(H),Z(),!!n)try{await c(H)}catch(B){d(B instanceof Error?B.message:"Failed to save new order")}}return{dragType:f,draggedId:_,dragOverId:b,dragOverGroupId:w,setDragOverId:T,setDragOverGroupId:A,handleCategoryDragStart:I,handleCategoryDragOver:P,handleDragOverGroup:G,handleDragLeave:Q,handleDragLeaveGroup:X,handleDragEnd:Z,handleCategoryDrop:oe,handleDropOnGroup:O,handleGroupDragStart:C,handleGroupDrop:R}}function i6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=an(),{budget:a,categories:l,categoryGroups:c,categoryBalancesSnapshot:d,saveCategories:f,saveCategoryGroups:p,saveCategoriesAndGroups:_,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:b,saveCategoryBalancesSnapshot:T,recalculateCategoryBalances:w,getOnBudgetTotal:A}=Tn(t,e),[I,P]=D.useState(null),{categoryBalances:G,loadingBalances:Q,categoryBalanceMismatch:X,checkCategoryBalanceMismatch:Z,recalculateAndSaveCategoryBalances:oe}=n6({budgetId:t,categories:l,categoryBalancesSnapshot:d,currentYear:n,currentMonth:i,saveCategoryBalancesSnapshot:T,recalculateCategoryBalancesMutation:w}),O=r6({categories:l,categoryGroups:c,currentBudget:a,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:b,saveCategories:f,saveCategoryGroups:p,setError:P});async function C(F,$){if(!a)return;const te=$==="ungrouped"?null:$,V=Object.values(l).filter(be=>$==="ungrouped"?!be.category_group_id:be.category_group_id===$),q=V.length>0?Math.max(...V.map(be=>be.sort_order)):-1,ne=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,ee={name:F.name,description:F.description,category_group_id:te,sort_order:q+1,default_monthly_amount:F.default_monthly_amount,default_monthly_type:F.default_monthly_type,balance:0},ce={...l,[ne]:ee};v(ce);try{await f(ce)}catch(be){v(l),P(be instanceof Error?be.message:"Failed to create category")}}async function R(F,$){if(a)try{const te=l[F];if(!te)return;const V=te.category_group_id||"ungrouped",q=$.category_group_id;let ne=te.sort_order;if(V!==(q||"ungrouped")){const ce=Object.values(l).filter(be=>(be.category_group_id||"ungrouped")===(q||"ungrouped")).filter((be,Ee,ve)=>l[F]!==ve[Ee]);ne=ce.length>0?Math.max(...ce.map(be=>be.sort_order))+1:0}const ee={...l,[F]:{...te,name:$.name,description:$.description,category_group_id:q,sort_order:ne,default_monthly_amount:$.default_monthly_amount,default_monthly_type:$.default_monthly_type}};v(ee),await f(ee)}catch(te){P(te instanceof Error?te.message:"Failed to update category")}}async function N(F){if(confirm("Are you sure you want to delete this category?")&&a)try{const{[F]:$,...te}=l;v(te),await f(te)}catch($){P($ instanceof Error?$.message:"Failed to delete category")}}async function j(F,$){const te=l[F];if(!te)return;const V=te.category_group_id||"ungrouped",q=Object.entries(l).filter(([,ve])=>(ve.category_group_id||"ungrouped")===V).sort((ve,Se)=>ve[1].sort_order-Se[1].sort_order),ne=q.findIndex(([ve])=>ve===F),ee=$==="up"?ne-1:ne+1;if(ee<0||ee>=q.length)return;const[ce,be]=q[ee],Ee={};if(Object.entries(l).forEach(([ve,Se])=>{ve===F?Ee[ve]={...Se,sort_order:be.sort_order}:ve===ce?Ee[ve]={...Se,sort_order:te.sort_order}:Ee[ve]=Se}),v(Ee),!!a)try{await f(Ee)}catch(ve){v(l),P(ve instanceof Error?ve.message:"Failed to move category")}}async function U(F){if(a)try{const $=c.length>0?Math.max(...c.map(q=>q.sort_order)):-1,te={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:F.name,sort_order:$+1},V=[...c,te];b(V),await p(V)}catch($){P($ instanceof Error?$.message:"Failed to create group")}}async function M(F,$){if(a)try{const te=c.map(V=>V.id===F?{...V,name:$.name}:V);b(te),await p(te)}catch(te){P(te instanceof Error?te.message:"Failed to update group")}}async function W(F){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&a)try{const $={};Object.entries(l).forEach(([V,q])=>{$[V]=q.category_group_id===F?{...q,category_group_id:null}:q});const te=c.filter(V=>V.id!==F);v($),b(te),await _($,te)}catch($){P($ instanceof Error?$.message:"Failed to delete group")}}async function H(F,$){const te=[...c].sort((ce,be)=>ce.sort_order-be.sort_order),V=te.findIndex(ce=>ce.id===F),q=$==="up"?V-1:V+1;if(q<0||q>=te.length)return;const[ne]=te.splice(V,1);te.splice(q,0,ne);const ee=te.map((ce,be)=>({...ce,sort_order:be}));if(b(ee),!!a)try{await p(ee)}catch(ce){b(c),P(ce instanceof Error?ce.message:"Failed to move group")}}const B=Object.entries(l).reduce((F,[$,te])=>{const V=te.category_group_id||"ungrouped";return F[V]||(F[V]=[]),F[V].push([$,te]),F},{}),z=[...c].sort((F,$)=>F.sort_order-$.sort_order);return{currentBudget:a,categories:l,categoryGroups:c,categoriesByGroup:B,sortedGroups:z,categoryBalances:G,loadingBalances:Q,error:I,setError:P,getOnBudgetTotal:A,categoryBalanceMismatch:X,checkCategoryBalanceMismatch:Z,recalculateAndSaveCategoryBalances:oe,handleCreateCategory:C,handleUpdateCategory:R,handleDeleteCategory:N,handleMoveCategory:j,handleCreateGroup:U,handleUpdateGroup:M,handleDeleteGroup:W,handleMoveGroup:H,dragType:O.dragType,draggedId:O.draggedId,dragOverId:O.dragOverId,dragOverGroupId:O.dragOverGroupId,setDragOverId:O.setDragOverId,setDragOverGroupId:O.setDragOverGroupId,handleCategoryDragStart:O.handleCategoryDragStart,handleCategoryDragOver:O.handleCategoryDragOver,handleDragOverGroup:O.handleDragOverGroup,handleDragLeave:O.handleDragLeave,handleDragLeaveGroup:O.handleDragLeaveGroup,handleDragEnd:O.handleDragEnd,handleCategoryDrop:O.handleCategoryDrop,handleDropOnGroup:O.handleDropOnGroup,handleGroupDragStart:O.handleGroupDragStart,handleGroupDrop:O.handleGroupDrop}}function s6({currentUser:t,futureMonthsToDelete:e,onRefetch:n}){const[i,a]=D.useState(!1),[l,c]=D.useState(null),[d,f]=D.useState(!1),[p,_]=D.useState(null);async function v(A,I){const P={};I.forEach(G=>{P[G]=0});try{const G=await Fs("months",`settings migration: calculating category balances for budget ${A}`,[{field:"budget_id",op:"==",value:A}]);for(const Q of G.docs){const X=Q.data;if(X.allocations_finalized&&X.allocations)for(const Z of X.allocations)P[Z.category_id]=(P[Z.category_id]||0)+Z.amount}}catch(G){console.error("Error calculating balances for budget:",A,G)}return P}async function b(A){try{const{exists:I,data:P}=await Re("budgets",A,"settings migration: reading budget to check if migration needed");if(!I||!P)return{budgetId:A,budgetName:"Unknown",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Budget not found"};const G=P.name||"Unnamed Budget",Q=Array.isArray(P.categories),X=Array.isArray(P.accounts),Z=Array.isArray(P.account_groups);if(!Q&&!X&&!Z)return{budgetId:A,budgetName:G,categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Already migrated"};let oe=P.categories,O=P.accounts,C=P.account_groups,R=0,N=0,j=0,U=!1;if(Q){const H=P.categories,B={},z=[];for(const te of H){const V=te.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;z.push(V),B[V]={name:te.name,description:te.description,category_group_id:te.category_group_id??null,sort_order:te.sort_order??0,default_monthly_amount:te.default_monthly_amount,default_monthly_type:te.default_monthly_type,balance:0}}const F=await v(A,z);for(const te of z)B[te]&&(B[te].balance=F[te]||0);const $={};Object.entries(B).forEach(([te,V])=>{$[te]={name:V.name,category_group_id:V.category_group_id??null,sort_order:V.sort_order,balance:V.balance},V.description&&($[te].description=V.description),V.default_monthly_amount!==void 0&&($[te].default_monthly_amount=V.default_monthly_amount),V.default_monthly_type!==void 0&&($[te].default_monthly_type=V.default_monthly_type)}),oe=$,R=H.length,U=!0}if(X){const H=P.accounts,B={};for(const z of H){const F=z.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;B[F]={nickname:z.nickname,balance:z.balance??0,account_group_id:z.account_group_id??null,sort_order:z.sort_order??0},z.is_income_account!==void 0&&(B[F].is_income_account=z.is_income_account),z.is_income_default!==void 0&&(B[F].is_income_default=z.is_income_default),z.is_outgo_account!==void 0&&(B[F].is_outgo_account=z.is_outgo_account),z.is_outgo_default!==void 0&&(B[F].is_outgo_default=z.is_outgo_default),z.on_budget!==void 0&&(B[F].on_budget=z.on_budget),z.is_active!==void 0&&(B[F].is_active=z.is_active)}O=B,N=H.length}if(Z){const H=P.account_groups,B={};for(const z of H){const F=z.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;B[F]={name:z.name,sort_order:z.sort_order??0},z.expected_balance!==void 0&&(B[F].expected_balance=z.expected_balance),z.on_budget!==void 0&&(B[F].on_budget=z.on_budget),z.is_active!==void 0&&(B[F].is_active=z.is_active)}if(X&&O){const z=O,F=P.account_groups,$={};F.forEach((te,V)=>{const q=te.id||String(V),ne=Object.keys(B)[V];ne&&($[q]=ne)}),Object.entries(z).forEach(([te,V])=>{V.account_group_id&&$[V.account_group_id]&&(z[te].account_group_id=$[V.account_group_id])})}C=B,j=H.length}const{category_balances:M,...W}=P;return await it("budgets",A,{...W,categories:oe,accounts:O,account_groups:C},`settings migration: saving migrated budget data (categories: ${R}, accounts: ${N}, groups: ${j})`),{budgetId:A,budgetName:G,categoriesMigrated:R,accountsMigrated:N,accountGroupsMigrated:j,balancesCalculated:U}}catch(I){return{budgetId:A,budgetName:"Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:I instanceof Error?I.message:"Migration failed"}}}async function T(){if(!t)return;a(!0),c(null);const A=[];try{const I=await Fs("budgets","settings migration: listing all budgets in system to migrate");if(I.docs.length===0){c([{budgetId:"",budgetName:"No budgets found",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"No budgets in system"}]),a(!1);return}for(const P of I.docs){const G=await b(P.id);A.push(G)}c(A),Oe.invalidateQueries({queryKey:["budget"]}),Oe.invalidateQueries({queryKey:["month"]}),Oe.invalidateQueries({queryKey:["settingsMigration"]}),n()}catch(I){c([{budgetId:"",budgetName:"Migration Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:I instanceof Error?I.message:"Migration failed"}])}finally{a(!1)}}async function w(){if(!t||e.length===0)return;f(!0),_(null);let A=0;const I=[];for(const P of e)try{await fO("months",P.docId,`settings cleanup: deleting future month ${P.year}-${P.month}`),A++}catch(G){I.push(`Failed to delete ${P.docId}: ${G instanceof Error?G.message:"Unknown error"}`)}_({deleted:A,errors:I}),f(!1),Oe.invalidateQueries({queryKey:["settingsMigration"]}),Oe.invalidateQueries({queryKey:["month"]}),n()}return{isMigrating:i,migrationResults:l,isCleaningFutureMonths:d,futureMonthsCleanupResult:p,runMigration:T,cleanupFutureMonths:w}}function a6({onCreateNew:t}){const[e,n]=D.useState(""),[i,a]=D.useState(!1),[l,c]=D.useState(null);async function d(f){f.preventDefault(),a(!0),c(null);try{await t(e.trim()||void 0)}catch(p){c(p instanceof Error?p.message:"Failed to create budget"),a(!1)}}return h.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[h.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),h.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&h.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:l}),h.jsx("button",{onClick:()=>c(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[h.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""})," Create Your Budget"]}),h.jsxs("form",{onSubmit:d,children:[h.jsxs("div",{style:{marginBottom:"1.5rem"},children:[h.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),h.jsx("input",{type:"text",value:e,onChange:f=>n(f.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),h.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),h.jsx("button",{type:"submit",disabled:i,style:{width:"100%",background:_e.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontWeight:600,opacity:i?.7:1,fontSize:"1rem"},children:i?"Creating...":"Create Budget"})]})]}),h.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function o6({invites:t,onAccept:e,onCreateNew:n}){const[i,a]=D.useState(null),[l,c]=D.useState(!1),[d,f]=D.useState(""),[p,_]=D.useState(!1),[v,b]=D.useState(null);async function T(A){a(A),b(null);try{await e(A)}catch(I){b(I instanceof Error?I.message:"Failed to accept invitation"),a(null)}}async function w(A){A.preventDefault(),_(!0),b(null);try{await n(d.trim()||void 0)}catch(I){b(I instanceof Error?I.message:"Failed to create new budget"),_(!1)}}return h.jsxs("div",{children:[h.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),h.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),v&&h.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:v}),h.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[h.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""})," Budget Invitations"]}),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(A=>h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[h.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[h.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:A.budgetName}),A.ownerEmail&&h.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",A.ownerEmail]})]}),h.jsx("button",{onClick:()=>T(A.budgetId),disabled:i!==null||p,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null||p?"not-allowed":"pointer",fontWeight:500,opacity:i!==null||p?.7:1,fontSize:"0.9rem"},children:i===A.budgetId?"Joining...":"Accept & Join"})]},A.budgetId))})]}),h.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?h.jsxs("form",{onSubmit:w,children:[h.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),h.jsxs("div",{style:{marginBottom:"1rem"},children:[h.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),h.jsx("input",{type:"text",value:d,onChange:A=>f(A.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),h.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[h.jsx("button",{type:"submit",disabled:p||i!==null,style:{background:_e.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p||i!==null?"not-allowed":"pointer",fontWeight:500,opacity:p||i!==null?.7:1,fontSize:"0.9rem"},children:p?"Creating...":"Create Budget"}),h.jsx("button",{type:"button",onClick:()=>{c(!1),f("")},disabled:p,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p?"not-allowed":"pointer",fontWeight:500,opacity:p?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):h.jsxs("div",{style:{textAlign:"center"},children:[h.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),h.jsx("button",{onClick:()=>c(!0),disabled:i!==null,style:{background:_e.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null?"not-allowed":"pointer",fontWeight:500,opacity:i!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function l6({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const i=D.useMemo(()=>[{id:"income",label:"Income"},{id:"allocations",label:"Allocations",checkmark:n},{id:"spend",label:"Spend"},{id:"balances",label:"Balances"}],[n]);return h.jsx(Ly,{mode:"button",tabs:i,activeTab:t,onTabChange:a=>e(a)})}function c6({isOpen:t,onClose:e,onProceed:n,results:i}){const a=!i||i.status==="confirming",l=i&&!["confirming","done","error"].includes(i.status),c=a||i?.status==="done"||i?.status==="error";function d(){c&&e()}return h.jsx(kh,{isOpen:t,onClose:d,title:"Recalculate Balances",width:"540px",children:h.jsxs("div",{style:{padding:"0.5rem 0"},children:[a&&h.jsxs(h.Fragment,{children:[h.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",lineHeight:1.5},children:["This will recalculate category balances and account balances from the ",h.jsx("strong",{children:"current month forward"}),"."]}),h.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Use this if your data seems out of sync or after fixing bugs. Past months will not be modified."}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginBottom:"1.5rem"},children:[h.jsx(Io,{status:"waiting",label:"Find all months to process"}),h.jsx(Io,{status:"waiting",label:"Process months"}),h.jsx(Io,{status:"waiting",label:"Update budget totals"})]}),h.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[h.jsx(Ne,{variant:"secondary",onClick:e,children:"Cancel"}),h.jsx(Ne,{onClick:n,children:"Proceed"})]})]}),!a&&h.jsxs(h.Fragment,{children:[h.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Recalculating category balances and account balances..."}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[h.jsx(Io,{status:i?.status==="pending"?"waiting":"complete",label:"Find all months to process",detail:i&&i.status!=="pending"?`Found ${i.monthsFound||0} month${i.monthsFound!==1?"s":""}`:void 0}),h.jsx(Io,{status:hx(i?.status,["pending","finding_months"],"processing_months"),label:"Process months",detail:i?.status==="processing_months"?`Processing: ${i.currentMonthLabel} (${(i.currentMonthIndex||0)+1}/${i.monthsFound||0})`:i?.monthsProcessed!==void 0?`Processed ${i.monthsProcessed} month${i.monthsProcessed!==1?"s":""}`:void 0}),h.jsx(Io,{status:i?.status==="error"?"error":hx(i?.status,["pending","finding_months","processing_months"],"updating_budget"),label:"Update budget totals",detail:i?.status==="error"?i.error:void 0,isError:i?.status==="error"})]}),i?.status==="done"&&h.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${_e.success} 10%, transparent)`,border:`1px solid ${_e.success}`,borderRadius:"8px",textAlign:"center"},children:[h.jsx("p",{style:{margin:0,fontWeight:600,color:_e.success},children:" Recalculation complete!"}),h.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:[i.monthsProcessed," month",i.monthsProcessed!==1?"s":""," processed",h.jsx("br",{}),"Total Income: ",qe(i.totalIncomeRecalculated||0),h.jsx("br",{}),"Total Expenses: ",qe(i.totalExpensesRecalculated||0)]})]}),(i?.status==="done"||i?.status==="error")&&h.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"center"},children:h.jsx(Ne,{onClick:e,children:"Done"})}),l&&h.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"Please wait, do not close this window..."})]})]})})}function hx(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function Io({status:t,label:e,detail:n,isError:i}){const a=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[h.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:a}),h.jsxs("div",{style:{flex:1},children:[h.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:i?1:.6,color:i?_e.error:"inherit"},children:n})]})]})}function By({isDisabled:t}){const{selectedBudgetId:e,currentUserId:n,currentYear:i,currentMonthNumber:a}=an(),{categories:l,accounts:c,recalculateCategoryBalances:d,saveAccounts:f}=Tn(e,n),[p,_]=D.useState(!1),[v,b]=D.useState(!1),[T,w]=D.useState(null);function A(){b(!0),w({status:"confirming"})}async function I(){if(e){_(!0),w({status:"pending"});try{w({status:"finding_months"});const Q=(await Fs("months","recalculate: finding all months for budget",[{field:"budget_id",op:"==",value:e}])).docs.map(q=>({id:q.id,...q.data})).sort((q,ne)=>q.year!==ne.year?q.year-ne.year:q.month-ne.month),X=new Date,Z=i||X.getFullYear(),oe=a||X.getMonth()+1,O=Q.filter(q=>q.year>Z||q.year===Z&&q.month>=oe),C=Q.filter(q=>q.year<Z||q.year===Z&&q.month<oe),R=C.length>0?C[C.length-1]:null,N=Object.keys(l);w({status:"finding_months",monthsFound:O.length}),await new Promise(q=>setTimeout(q,100));const j={};if(R){const q=Tt(e,R.year,R.month),{exists:ne,data:ee}=await Re("months",q,"recalculate: reading previous month for starting balances");if(ne&&ee?.category_balances)for(const ce of ee.category_balances)j[ce.category_id]=ce.end_balance??0}N.forEach(q=>{j[q]===void 0&&(j[q]=0)});let U=0,M=0;for(let q=0;q<O.length;q++){const ne=O[q],ee=`${Iy[ne.month-1]} ${ne.year}`;w({status:"processing_months",monthsFound:O.length,currentMonthIndex:q,currentMonthLabel:ee});const ce=Tt(e,ne.year,ne.month),{exists:be,data:Ee}=await Re("months",ce,`recalculate: reading full month data for ${ee}`);if(!be||!Ee){console.warn(`Month ${ee} not found, skipping`);continue}const ve=Ee.income||[],Se=Ee.expenses||[],fe=Ee.allocations||[],Ze=Ee.allocations_finalized||!1,Fe=ve.reduce((Ct,st)=>Ct+st.amount,0),on=Se.reduce((Ct,st)=>Ct+st.amount,0);U+=Fe,M+=on;const An=N.map(Ct=>{const st=j[Ct]??0;let St=0;if(Ze&&fe.length>0){const hr=fe.find($t=>$t.category_id===Ct);hr&&(St=hr.amount)}let $n=0;Se.length>0&&($n=Se.filter(hr=>hr.category_id===Ct).reduce((hr,$t)=>hr+$t.amount,0));const xl=st+St-$n;return{category_id:Ct,start_balance:st,allocated:St,spent:$n,end_balance:xl}});An.forEach(Ct=>{j[Ct.category_id]=Ct.end_balance});let jr=Ee.previous_month_snapshot;const Or=q===0?R:O[q-1];if(Or){const Ct={};An.forEach(st=>{Ct[st.category_id]=st.start_balance}),jr={...jr||{},total_income:Or.total_income||0,account_balances_end:jr?.account_balances_end||{},category_balances_end:Ct,snapshot_taken_at:new Date().toISOString()}}const Ws={budget_id:e,year:ne.year,month:ne.month,income:ve,total_income:Fe,expenses:Se,total_expenses:on,allocations:fe,allocations_finalized:Ze,category_balances:An,category_balances_stale:!1,previous_month_snapshot:jr,previous_month_snapshot_stale:!1,account_balances_start:Ee.account_balances_start,account_balances_end:Ee.account_balances_end,created_at:Ee.created_at||new Date().toISOString(),updated_at:new Date().toISOString()};await Ar(e,Ws),await new Promise(Ct=>setTimeout(Ct,50))}const W={};Object.keys(c).forEach(q=>{W[q]=0});for(const q of Q){const ne=Tt(e,q.year,q.month),{exists:ee,data:ce}=await Re("months",ne,`recalculate: reading month ${q.year}/${q.month} for account balances`);if(!ee||!ce)continue;const be=ce.income||[],Ee=ce.expenses||[];for(const ve of be)ve.account_id&&W[ve.account_id]!==void 0&&(W[ve.account_id]+=ve.amount);for(const ve of Ee)ve.account_id&&W[ve.account_id]!==void 0&&(W[ve.account_id]-=ve.amount)}const H={};Object.entries(c).forEach(([q,ne])=>{H[q]={...ne,balance:W[q]??0}}),await f(H),w({status:"updating_budget",monthsFound:O.length,monthsProcessed:O.length,totalIncomeRecalculated:U,totalExpensesRecalculated:M});const B=O.findIndex(q=>q.year===i&&q.month===a),z={},F={};if(R){const q=Tt(e,R.year,R.month),{exists:ne,data:ee}=await Re("months",q,"recalculate: reading previous month for current balance calculation");if(ne&&ee?.category_balances)for(const ce of ee.category_balances)F[ce.category_id]=ce.end_balance??0}N.forEach(q=>{F[q]===void 0&&(F[q]=0)});for(let q=0;q<=B&&q<O.length;q++){const ne=O[q];N.forEach(ee=>{const ce=F[ee]??0;let be=0;if(ne.allocations_finalized&&ne.allocations){const ve=ne.allocations.find(Se=>Se.category_id===ee);ve&&(be=ve.amount)}let Ee=0;ne.expenses&&(Ee=ne.expenses.filter(ve=>ve.category_id===ee).reduce((ve,Se)=>ve+Se.amount,0)),F[ee]=ce+be-Ee})}N.forEach(q=>{z[q]=F[q]??0});const $={...j},te={};Object.entries(l).forEach(([q,ne])=>{te[q]={...ne,balance:$[q]??0}});const V={};N.forEach(q=>{V[q]={current:z[q]??0,total:$[q]??0}}),await d(te,V,i,a);for(const q of O)Oe.invalidateQueries({queryKey:ie.month(e,q.year,q.month)});w({status:"done",monthsFound:O.length,monthsProcessed:O.length,totalIncomeRecalculated:U,totalExpensesRecalculated:M})}catch(G){console.error("Recalculate error:",G),w({status:"error",error:G instanceof Error?G.message:"Failed to recalculate"})}finally{_(!1)}}}function P(){b(!1),w(null)}return h.jsxs(h.Fragment,{children:[h.jsxs("button",{onClick:A,disabled:t||p,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:t||p?"not-allowed":"pointer",opacity:t||p?.5:1,fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},title:"Recalculate balances from this month forward",children:[p?"":""," Recalculate"]}),h.jsx(c6,{isOpen:v,onClose:P,onProceed:I,results:T})]})}function u6({isLoading:t,onPreviousMonth:e,onNextMonth:n}){const{currentYear:i,currentMonthNumber:a,isAdmin:l,selectedBudgetId:c,currentUserId:d}=an(),{budget:f}=Tn(c,d),{month:p}=El(c,i,a),[_,v]=D.useState(!1),b=D.useRef(null);D.useEffect(()=>{if(!_)return;function w(A){b.current&&!b.current.contains(A.target)&&v(!1)}return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[_]);function T(){if(!p||!f)return;const w={...p,_meta:{downloaded_at:new Date().toISOString(),budget_id:f.id,budget_name:f.name}},A=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),I=URL.createObjectURL(A),P=document.createElement("a");P.href=I,P.download=`month_${i}_${String(a).padStart(2,"0")}.json`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(I),v(!1)}return h.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[h.jsx("button",{onClick:e,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Previous month",children:""}),h.jsxs("div",{ref:b,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[h.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[Iy[a-1]," ",i]}),h.jsx("button",{onClick:()=>v(!_),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:_?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),t&&h.jsxs(h.Fragment,{children:[h.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),h.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[h.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:_e.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),h.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),_&&h.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[h.jsx(By,{isDisabled:t}),l&&p&&h.jsx("button",{onClick:T,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),h.jsx("button",{onClick:n,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Next month",children:""})]})}function fx({accounts:t,accountGroups:e,payees:n,initialData:i,defaultAccountId:a,defaultDate:l,onSubmit:c,onCancel:d,onDelete:f,submitLabel:p,isMobile:_}){const v=new Date().toISOString().split("T")[0],[b,T]=D.useState(i?.amount?.toString()||""),[w,A]=D.useState(i?.account_id||a||(t[0]?t[0][0]:"")),[I,P]=D.useState(i?.date||l||v),[G,Q]=D.useState(i?.payee||""),[X,Z]=D.useState(i?.description||""),oe={},O=[];t.forEach(([N,j])=>{j.account_group_id?(oe[j.account_group_id]||(oe[j.account_group_id]=[]),oe[j.account_group_id].push([N,j])):O.push([N,j])});function C(N){N.preventDefault();const j=parseFloat(b);isNaN(j)||j<=0||w&&I&&c(j,w,I,G.trim()||void 0,X.trim()||void 0)}const R=_?{display:"flex",flexDirection:"column",gap:"1rem"}:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"};return h.jsxs(Ua,{onSubmit:C,children:[h.jsxs("div",{style:R,children:[h.jsx(Gt,{label:"Amount",htmlFor:"income-amount",children:h.jsx(Ny,{id:"income-amount",value:b,onChange:T,placeholder:"$0.00",required:!0,autoFocus:!0})}),h.jsx(Gt,{label:"Date",htmlFor:"income-date",children:h.jsx(Fi,{id:"income-date",type:"date",value:I,onChange:N=>P(N.target.value),required:!0})})]}),h.jsxs("div",{style:R,children:[h.jsx(Gt,{label:"Deposit To",htmlFor:"income-account",children:h.jsxs(ka,{id:"income-account",value:w,onChange:N=>A(N.target.value),required:!0,children:[Object.entries(e).map(([N,j])=>{const U=oe[N];return!U||U.length===0?null:h.jsx("optgroup",{label:j.name,children:U.map(([M,W])=>h.jsx("option",{value:M,children:W.nickname},M))},N)}),O.length>0&&h.jsx("optgroup",{label:"Other",children:O.map(([N,j])=>h.jsx("option",{value:N,children:j.nickname},N))})]})}),h.jsx(Gt,{label:"Payee",htmlFor:"income-payee",children:h.jsx(IT,{id:"income-payee",value:G,onChange:Q,payees:n,placeholder:"e.g., Employer, Client name"})})]}),h.jsx(Gt,{label:"Description (optional)",htmlFor:"income-description",children:h.jsx(Fi,{id:"income-description",value:X,onChange:N=>Z(N.target.value),placeholder:"e.g., January paycheck, Project bonus"})}),h.jsxs(Ks,{children:[h.jsx(Ne,{type:"submit",children:p}),h.jsx(Ne,{type:"button",variant:"secondary",onClick:d,children:"Cancel"}),f&&h.jsx(Ne,{type:"button",variant:"danger",onClick:f,style:{marginLeft:"auto"},children:" Delete"})]})]})}function d6({income:t,accountName:e,accountGroupName:n,onEdit:i,onDelete:a,isMobile:l}){return h.jsxs("div",{onClick:l?i:void 0,style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:l?"0.875rem 1rem":"1rem 1.25rem",borderRadius:"8px",display:"flex",flexDirection:l?"column":"row",justifyContent:"space-between",alignItems:l?"stretch":"center",gap:l?"0.5rem":"1rem",cursor:l?"pointer":"default",transition:l?"background 0.15s":"none"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"0.75rem",marginBottom:t.payee?"0.25rem":0},children:[t.date&&h.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,fontFamily:"monospace"},children:new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}),h.jsxs("span",{style:{fontSize:"1.15rem",fontWeight:600,color:_e.success},children:["+",qe(t.amount)]})]}),t.payee&&h.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,marginBottom:"0.25rem"},children:t.payee}),h.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:[" ",e,n?` / ${n}`:""]}),t.description&&h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",opacity:.7},children:t.description})]}),!l&&h.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[h.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit",children:""}),h.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete",children:""})]})]})}function h6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=an(),{accounts:a,accountGroups:l}=Tn(t,e),{month:c,isLoading:d,payees:f,addIncome:p,updateIncome:_,deleteIncome:v}=El(t,n,i),b=$s(),[T,w]=D.useState(null),[A,I]=D.useState(!1),[P,G]=D.useState(null);function Q(W){const H=W.account_group_id?l[W.account_group_id]:void 0;return H?.is_active!==void 0?H.is_active:W.is_active!==!1}function X(W){const H=W.account_group_id?l[W.account_group_id]:void 0;return H?.on_budget!==void 0?H.on_budget:W.on_budget!==!1}const Z=Object.entries(a).filter(([,W])=>Q(W)&&X(W)),oe=Z.filter(([,W])=>W.is_income_account),O=oe.length>0?oe:Z,C=Z.find(([,W])=>W.is_income_default),R=C?C[0]:void 0,N=c?.income.reduce((W,H)=>W+H.amount,0)||0;function j(W,H,B,z,F){w(null),I(!1),p(W,H,B,z,F).catch($=>{w($ instanceof Error?$.message:"Failed to add income")})}function U(W,H,B,z,F,$){w(null),G(null),_(W,H,B,z,F,$).catch(te=>{w(te instanceof Error?te.message:"Failed to update income")})}function M(W){confirm("Are you sure you want to delete this income entry?")&&(w(null),v(W).catch(H=>{w(H instanceof Error?H.message:"Failed to delete income")}))}return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:d?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:d?"none":"auto"},children:[T&&h.jsx("div",{style:{background:`color-mix(in srgb, ${_e.error} 15%, transparent)`,border:`1px solid ${_e.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:_e.error},children:T}),h.jsxs("div",{style:{display:"flex",flexDirection:b?"column":"row",justifyContent:"space-between",alignItems:b?"stretch":"center",gap:b?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("div",{children:[h.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:"Total"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.25rem",fontWeight:600,color:gn(N)},children:qe(N)})]}),!A&&h.jsx(Ne,{onClick:()=>I(!0),disabled:O.length===0,children:"+ Add Income"})]}),O.length===0&&h.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",h.jsx(wt,{to:"/budget/accounts",style:{color:_e.primaryLight},children:"Manage accounts "})]}),A&&h.jsx("div",{style:{marginBottom:"1rem"},children:h.jsx(fx,{accounts:O,accountGroups:l,payees:f,defaultAccountId:R,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:j,onCancel:()=>I(!1),submitLabel:"Add Income",isMobile:b})}),h.jsxs("div",{style:qs,children:[c?.income.slice().sort((W,H)=>(W.date||"").localeCompare(H.date||"")).map(W=>P===W.id?h.jsx(fx,{accounts:O,accountGroups:l,payees:f,initialData:W,onSubmit:(H,B,z,F,$)=>U(W.id,H,B,z,F,$),onCancel:()=>G(null),onDelete:()=>M(W.id),submitLabel:"Save",isMobile:b},W.id):h.jsx(d6,{income:W,accountName:a[W.account_id]?.nickname||"Unknown Account",accountGroupName:a[W.account_id]?.account_group_id?l[a[W.account_id].account_group_id]?.name:void 0,onEdit:()=>G(W.id),onDelete:()=>M(W.id),isMobile:b},W.id)),(!c?.income||c.income.length===0)&&!A&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1rem"},children:"No income recorded for this month"})]})]})}function mx({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:c,defaultDate:d,onSubmit:f,onCancel:p,onDelete:_,submitLabel:v,isMobile:b}){const T=new Date().toISOString().split("T")[0],[w,A]=D.useState(l?.amount?.toString()||""),[I,P]=D.useState(l?.category_id||""),[G,Q]=D.useState(l?.account_id||c||(t[0]?t[0][0]:"")),[X,Z]=D.useState(l?.date||d||T),[oe,O]=D.useState(l?.payee||""),[C,R]=D.useState(l?.description||""),N={},j=[];t.forEach(([z,F])=>{F.account_group_id?(N[F.account_group_id]||(N[F.account_group_id]=[]),N[F.account_group_id].push([z,F])):j.push([z,F])});const U={},M=[];Object.entries(n).forEach(([z,F])=>{F.category_group_id?(U[F.category_group_id]||(U[F.category_group_id]=[]),U[F.category_group_id].push([z,F])):M.push([z,F])}),Object.values(U).forEach(z=>{z.sort((F,$)=>F[1].sort_order-$[1].sort_order)}),M.sort((z,F)=>z[1].sort_order-F[1].sort_order);const W=[...i].sort((z,F)=>z.sort_order-F.sort_order);function H(z){z.preventDefault();const F=parseFloat(w);isNaN(F)||F<=0||I&&G&&X&&f(F,I,G,X,oe.trim()||void 0,C.trim()||void 0)}const B=b?{display:"flex",flexDirection:"column",gap:"1rem"}:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"};return h.jsxs(Ua,{onSubmit:H,children:[h.jsxs("div",{style:B,children:[h.jsx(Gt,{label:"Amount",htmlFor:"expense-amount",children:h.jsx(Ny,{id:"expense-amount",value:w,onChange:A,placeholder:"$0.00",required:!0,autoFocus:!0})}),h.jsx(Gt,{label:"Date",htmlFor:"expense-date",children:h.jsx(Fi,{id:"expense-date",type:"date",value:X,onChange:z=>Z(z.target.value),required:!0})})]}),h.jsxs("div",{style:B,children:[h.jsx(Gt,{label:"Category",htmlFor:"expense-category",children:h.jsxs(ka,{id:"expense-category",value:I,onChange:z=>P(z.target.value),required:!0,children:[h.jsx("option",{value:"",children:"Select category..."}),W.map(z=>{const F=U[z.id];return!F||F.length===0?null:h.jsx("optgroup",{label:z.name,children:F.map(([$,te])=>h.jsx("option",{value:$,children:te.name},$))},z.id)}),M.length>0&&h.jsx("optgroup",{label:"Other",children:M.map(([z,F])=>h.jsx("option",{value:z,children:F.name},z))})]})}),h.jsx(Gt,{label:"Pay From",htmlFor:"expense-account",children:h.jsxs(ka,{id:"expense-account",value:G,onChange:z=>Q(z.target.value),required:!0,children:[Object.entries(e).map(([z,F])=>{const $=N[z];return!$||$.length===0?null:h.jsx("optgroup",{label:F.name,children:$.map(([te,V])=>h.jsx("option",{value:te,children:V.nickname},te))},z)}),j.length>0&&h.jsx("optgroup",{label:"Other",children:j.map(([z,F])=>h.jsx("option",{value:z,children:F.nickname},z))})]})})]}),h.jsx(Gt,{label:"Payee",htmlFor:"expense-payee",children:h.jsx(IT,{id:"expense-payee",value:oe,onChange:O,payees:a,placeholder:"e.g., Grocery Store, Restaurant"})}),h.jsx(Gt,{label:"Description (optional)",htmlFor:"expense-description",children:h.jsx(Fi,{id:"expense-description",value:C,onChange:z=>R(z.target.value),placeholder:"e.g., Weekly groceries, Dinner with friends"})}),h.jsxs(Ks,{children:[h.jsx(Ne,{type:"submit",children:v}),h.jsx(Ne,{type:"button",variant:"secondary",onClick:p,children:"Cancel"}),_&&h.jsx(Ne,{type:"button",variant:"danger",onClick:_,style:{marginLeft:"auto"},children:" Delete"})]})]})}function f6({expense:t,categoryName:e,accountName:n,accountGroupName:i,onEdit:a,onDelete:l,isMobile:c}){return h.jsxs("div",{onClick:c?a:void 0,style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:c?"0.875rem 1rem":"1rem 1.25rem",borderRadius:"8px",display:"flex",flexDirection:c?"column":"row",justifyContent:"space-between",alignItems:c?"stretch":"center",gap:c?"0.5rem":"1rem",cursor:c?"pointer":"default",transition:c?"background 0.15s":"none"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"0.75rem",marginBottom:t.payee?"0.25rem":0},children:[t.date&&h.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,fontFamily:"monospace"},children:new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}),h.jsxs("span",{style:{fontSize:"1.15rem",fontWeight:600,color:_e.error},children:["-",qe(t.amount)]})]}),t.payee&&h.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,marginBottom:"0.25rem"},children:t.payee}),h.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center"},children:[h.jsx("div",{style:{fontSize:"0.85rem",background:`color-mix(in srgb, ${_e.primary} 20%, transparent)`,color:_e.primaryLight,padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:e}),h.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:[" ",n,i?` / ${i}`:""]})]}),t.description&&h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",opacity:.7},children:t.description})]}),!c&&h.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[h.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit",children:""}),h.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete",children:""})]})]})}function m6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=an(),{accounts:a,accountGroups:l,categories:c,categoryGroups:d}=Tn(t,e),{month:f,isLoading:p,payees:_,addExpense:v,updateExpense:b,deleteExpense:T}=El(t,n,i),w=$s(),[A,I]=D.useState(null),[P,G]=D.useState(!1),[Q,X]=D.useState(null);function Z(B){const z=B.account_group_id?l[B.account_group_id]:void 0;return z?.is_active!==void 0?z.is_active:B.is_active!==!1}function oe(B){const z=B.account_group_id?l[B.account_group_id]:void 0;return z?.on_budget!==void 0?z.on_budget:B.on_budget!==!1}const O=Object.entries(a).filter(([,B])=>Z(B)&&oe(B)),C=O.filter(([,B])=>B.is_outgo_account),R=C.length>0?C:O,N=O.find(([,B])=>B.is_outgo_default),j=N?N[0]:void 0,U=f?.expenses?.reduce((B,z)=>B+z.amount,0)||0;function M(B,z,F,$,te,V){I(null),G(!1),v(B,z,F,$,te,V).catch(q=>{I(q instanceof Error?q.message:"Failed to add expense")})}function W(B,z,F,$,te,V,q){I(null),X(null),b(B,z,F,$,te,V,q).catch(ne=>{I(ne instanceof Error?ne.message:"Failed to update expense")})}function H(B){confirm("Are you sure you want to delete this expense?")&&(I(null),T(B).catch(z=>{I(z instanceof Error?z.message:"Failed to delete expense")}))}return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:p?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:p?"none":"auto"},children:[A&&h.jsx("div",{style:{background:`color-mix(in srgb, ${_e.error} 15%, transparent)`,border:`1px solid ${_e.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:_e.error},children:A}),h.jsxs("div",{style:{display:"flex",flexDirection:w?"column":"row",justifyContent:"space-between",alignItems:w?"stretch":"center",gap:w?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("div",{children:[h.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:"Total Expenses"}),h.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.25rem",fontWeight:600,color:U>0?_e.error:"inherit"},children:[U>0?"-":"",qe(U)]})]}),!P&&h.jsx(Ne,{onClick:()=>G(!0),disabled:R.length===0||Object.keys(c).length===0,children:"+ Add Expense"})]}),R.length===0&&h.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",h.jsx(wt,{to:"/budget/accounts",style:{color:_e.primaryLight},children:"Manage accounts "})]}),Object.keys(c).length===0&&h.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:["You need to create at least one category before adding expenses."," ",h.jsx(wt,{to:"/budget/settings/categories",style:{color:_e.primaryLight},children:"Create categories "})]}),P&&h.jsx("div",{style:{marginBottom:"1rem"},children:h.jsx(mx,{accounts:R,accountGroups:l,categories:c,categoryGroups:d,payees:_,defaultAccountId:j,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:M,onCancel:()=>G(!1),submitLabel:"Add Expense",isMobile:w})}),h.jsxs("div",{style:qs,children:[f?.expenses?.slice().sort((B,z)=>(B.date||"").localeCompare(z.date||"")).map(B=>Q===B.id?h.jsx(mx,{accounts:R,accountGroups:l,categories:c,categoryGroups:d,payees:_,initialData:B,onSubmit:(z,F,$,te,V,q)=>W(B.id,z,F,$,te,V,q),onCancel:()=>X(null),onDelete:()=>H(B.id),submitLabel:"Save",isMobile:w},B.id):h.jsx(f6,{expense:B,categoryName:c[B.category_id]?.name||"Unknown Category",accountName:a[B.account_id]?.nickname||"Unknown Account",accountGroupName:a[B.account_id]?.account_group_id?l[a[B.account_id].account_group_id]?.name:void 0,onEdit:()=>X(B.id),onDelete:()=>H(B.id),isMobile:w},B.id)),(!f?.expenses||f.expenses.length===0)&&!P&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1rem"},children:"No expenses recorded for this month"})]})]})}function p6({category:t,value:e,onChange:n,previousMonthIncome:i,disabled:a}){const l=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,c=l?t.default_monthly_amount/100*i:0,d=l?c.toFixed(2):e;let f=null;return!l&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&(f=qe(t.default_monthly_amount)),h.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",padding:"0.6rem 0.75rem",background:l?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",maxWidth:"100%",boxSizing:"border-box",opacity:l?.8:1},children:[h.jsxs("div",{style:{flex:"1 1 auto",minWidth:0,overflow:"hidden"},children:[h.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),l?h.jsxs("span",{style:{fontSize:"0.7rem",opacity:.6,display:"block",marginTop:"0.15rem",color:_e.primary},children:[t.default_monthly_amount,"% of prev month income"]}):f&&h.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5,display:"block",marginTop:"0.15rem"},children:["Suggested: ",f]})]}),h.jsx("div",{style:{flexShrink:0,width:"110px"},children:l?h.jsx("div",{style:{width:"100%",padding:"0.5rem 0.6rem",borderRadius:"6px",border:"1px dashed color-mix(in srgb, currentColor 15%, transparent)",background:"color-mix(in srgb, currentColor 3%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box",textAlign:"right",opacity:.9},title:"Auto-calculated from previous month's income",children:qe(c)}):h.jsx("input",{type:"text",inputMode:"decimal",value:d?`$${d}`:"",onChange:p=>{const _=p.target.value.replace(/[^\d.]/g,"");n(_)},placeholder:"$0.00",disabled:a,style:{width:"100%",padding:"0.5rem 0.6rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box",opacity:a?.6:1,cursor:a?"not-allowed":"text"}})})]})}function g6(){const{selectedBudgetId:t,currentUserId:e}=an(),{categories:n,categoryGroups:i}=Tn(t,e),{localAllocations:a,isSavingAllocations:l,isFinalizingAllocations:c,isDeletingAllocations:d,isEditingAppliedAllocations:f,error:p,monthLoading:_,onBudgetTotal:v,availableNow:b,currentDraftTotal:T,availableAfterApply:w,previousMonthIncome:A,allocationsFinalized:I,getAllocationAmount:P,handleAllocationChange:G,resetAllocationsToSaved:Q,handleSaveAllocations:X,handleFinalizeAllocations:Z,handleDeleteAllocations:oe,setIsEditingAppliedAllocations:O,setError:C}=t6(),R=$s(),N=[...i].sort((M,W)=>M.sort_order-W.sort_order),j=D.useMemo(()=>{const M=Object.entries(n).reduce((W,[H,B])=>{const z=B.category_group_id||"ungrouped";return W[z]||(W[z]=[]),W[z].push([H,B]),W},{});return Object.keys(M).forEach(W=>{M[W].sort((H,B)=>H[1].sort_order-B[1].sort_order)}),M},[n]),U=Object.values(n).some(M=>M.default_monthly_type==="percentage");return h.jsxs("div",{style:{opacity:_?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:_?"none":"auto"},children:[p&&h.jsx(bl,{message:p,onDismiss:()=>C(null)}),h.jsxs("div",{style:{display:"flex",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",marginBottom:"1.5rem",overflow:"hidden",flexDirection:R?"column":"row"},children:[h.jsxs("div",{style:{flex:1,padding:"0.75rem 1rem",borderRight:R?"none":"1px solid color-mix(in srgb, currentColor 10%, transparent)",borderBottom:R?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"On-Budget Total"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:gn(v)},children:qe(v)})]}),h.jsxs("div",{style:{flex:1,padding:"0.75rem 1rem",borderRight:R?"none":"1px solid color-mix(in srgb, currentColor 10%, transparent)",borderBottom:R?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Available Now"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:gn(b)},children:qe(b)}),h.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.65rem",opacity:.5},children:"applied only"})]}),h.jsxs("div",{style:{flex:1,padding:"0.75rem 1rem",borderRight:R?"none":"1px solid color-mix(in srgb, currentColor 10%, transparent)",borderBottom:R?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Draft Total"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:_e.primary},children:qe(T)})]}),h.jsxs("div",{style:{flex:1,padding:"0.75rem 1rem",textAlign:"center"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"After Apply"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:gn(w)},children:qe(w)}),h.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.65rem",opacity:.5},children:"if applied"})]})]}),U&&h.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.6rem 1rem",marginBottom:"1rem",fontSize:"0.85rem"},children:h.jsxs("span",{style:{opacity:.7},children:["Percentage allocations based on prev month income: ",h.jsx("strong",{style:{color:_e.primary},children:qe(A)})]})}),h.jsx(y6,{allocationsFinalized:I,isEditingAppliedAllocations:f,isSavingAllocations:l,isFinalizingAllocations:c,isDeletingAllocations:d,monthLoading:_,onCancel:Q,onSave:X,onFinalize:Z,onDelete:oe,onStartEdit:()=>O(!0)}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(n).length===0&&h.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",h.jsx(wt,{to:"/budget/settings/categories",style:{color:_e.primaryLight},children:"Create categories "})]}),N.map(M=>{const W=j[M.id]||[];if(W.length===0)return null;const H=W.reduce((B,[z,F])=>B+P(z,F),0);return h.jsx(px,{name:M.name,categories:W,groupTotal:H,localAllocations:a,previousMonthIncome:A,disabled:I&&!f,onAllocationChange:G},M.id)}),j.ungrouped?.length>0&&h.jsx(px,{name:"Uncategorized",categories:j.ungrouped,groupTotal:j.ungrouped.reduce((M,[W,H])=>M+P(W,H),0),localAllocations:a,previousMonthIncome:A,disabled:I&&!f,onAllocationChange:G,isUngrouped:!0})]})]})}function y6({allocationsFinalized:t,isEditingAppliedAllocations:e,isSavingAllocations:n,isFinalizingAllocations:i,isDeletingAllocations:a,monthLoading:l,onCancel:c,onSave:d,onFinalize:f,onDelete:p,onStartEdit:_}){const v=t?e?_e.primary:_e.success:_e.warning;return h.jsxs("div",{style:{background:`color-mix(in srgb, ${v} 12%, transparent)`,border:`1px solid ${v}`,borderRadius:"8px",padding:"0.75rem 1rem",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.75rem"},children:[h.jsxs("div",{children:[h.jsx("p",{style:{margin:0,fontWeight:600,color:v},children:t?e?" Editing Applied Allocations":" Allocations Applied":" Allocations Not Applied"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:t?e?"Make changes and save, or cancel to revert.":"Click Edit to make changes to allocations.":"Save and apply to update category balances."})]}),h.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:t?e?h.jsxs(h.Fragment,{children:[h.jsx(Ne,{onClick:c,disabled:n||a||l,variant:"secondary",children:"Cancel"}),h.jsx(Ne,{onClick:d,disabled:n||a||l,children:n?" Saving...":" Save Changes"})]}):h.jsxs(h.Fragment,{children:[h.jsx(Ne,{onClick:_,disabled:a||l,variant:"secondary",children:" Edit Allocations"}),h.jsx(Ne,{onClick:p,disabled:a||l,variant:"danger",children:a?" Deleting...":" Delete Allocations"})]}):h.jsxs(h.Fragment,{children:[h.jsx(Ne,{onClick:d,disabled:n||l,variant:"secondary",children:n?" Saving...":" Save Draft"}),h.jsx(Ne,{onClick:f,disabled:i||l,children:i?" Applying...":" Save & Apply"})]})})]})}function px({name:t,categories:e,groupTotal:n,localAllocations:i,previousMonthIncome:a,disabled:l,onAllocationChange:c,isUngrouped:d}){return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("h3",{style:{...vl,margin:0,opacity:d?.7:1},children:[t,h.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),h.jsx("span",{style:{fontWeight:600,color:_e.primary},children:qe(n)})]}),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:e.map(([f,p])=>h.jsx(p6,{category:p,value:i[f]||"",onChange:_=>c(f,_),previousMonthIncome:a,disabled:l},f))})]})}function _6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=an(),{categories:a,categoryGroups:l}=Tn(t,e),{month:c,isLoading:d}=El(t,n,i),f=$s(),p=D.useMemo(()=>{if(c?.category_balances&&c.category_balances.length>0)return c.category_balances;const w=c?.previous_month_snapshot?.category_balances_end??{},A=[];return Object.entries(a).forEach(([I])=>{const P=w[I]??0;let G=0;if(c?.allocations_finalized&&c.allocations){const X=c.allocations.find(Z=>Z.category_id===I);X&&(G=X.amount)}let Q=0;c?.expenses&&(Q=c.expenses.filter(X=>X.category_id===I).reduce((X,Z)=>X+Z.amount,0)),A.push({category_id:I,start_balance:P,allocated:G,spent:Q,end_balance:P+G-Q})}),A},[c,a]),_=w=>p.find(A=>A.category_id===w),v=D.useMemo(()=>p.reduce((w,A)=>({start:w.start+A.start_balance,allocated:w.allocated+A.allocated,spent:w.spent+A.spent,end:w.end+A.end_balance}),{start:0,allocated:0,spent:0,end:0}),[p]),b=[...l].sort((w,A)=>w.sort_order-A.sort_order),T=D.useMemo(()=>{const w=Object.entries(a).reduce((A,[I,P])=>{const G=P.category_group_id||"ungrouped";return A[G]||(A[G]=[]),A[G].push([I,P]),A},{});return Object.keys(w).forEach(A=>{w[A].sort((I,P)=>I[1].sort_order-P[1].sort_order)}),w},[a]);return h.jsxs("div",{style:{opacity:d?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:d?"none":"auto"},children:[h.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr 1fr":"repeat(4, 1fr)",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",marginBottom:"1.5rem",overflow:"hidden"},children:[h.jsxs("div",{style:{padding:"0.75rem 1rem",borderRight:"1px solid color-mix(in srgb, currentColor 10%, transparent)",borderBottom:f?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center",order:1},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Start of Month"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:gn(v.start)},children:qe(v.start)})]}),h.jsxs("div",{style:{padding:"0.75rem 1rem",borderRight:"1px solid color-mix(in srgb, currentColor 10%, transparent)",textAlign:"center",order:f?3:2},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Allocated"}),h.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:_e.success},children:["+",qe(v.allocated)]})]}),h.jsxs("div",{style:{padding:"0.75rem 1rem",borderRight:f?"none":"1px solid color-mix(in srgb, currentColor 10%, transparent)",textAlign:"center",order:f?4:3},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Spent"}),h.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:_e.error},children:["-",qe(v.spent)]})]}),h.jsxs("div",{style:{padding:"0.75rem 1rem",borderBottom:f?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center",order:f?2:4},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"End of Month"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:gn(v.end)},children:qe(v.end)})]})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(a).length===0&&h.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",h.jsx(wt,{to:"/budget/settings/categories",style:{color:_e.primaryLight},children:"Create categories "})]}),b.map(w=>{const A=T[w.id]||[];if(A.length===0)return null;const I=A.reduce((P,[G])=>{const Q=_(G);return Q?{start:P.start+Q.start_balance,allocated:P.allocated+Q.allocated,spent:P.spent+Q.spent,end:P.end+Q.end_balance}:P},{start:0,allocated:0,spent:0,end:0});return h.jsx(gx,{name:w.name,categories:A,groupEndBalance:I.end,getCategoryBalance:_,isMobile:f},w.id)}),T.ungrouped?.length>0&&(()=>{const w=T.ungrouped,A=w.reduce((I,[P])=>{const G=_(P);return G?{start:I.start+G.start_balance,allocated:I.allocated+G.allocated,spent:I.spent+G.spent,end:I.end+G.end_balance}:I},{start:0,allocated:0,spent:0,end:0});return h.jsx(gx,{name:"Uncategorized",categories:w,groupEndBalance:A.end,getCategoryBalance:_,isMobile:f,isUngrouped:!0},"ungrouped")})()]})]})}function gx({name:t,categories:e,groupEndBalance:n,getCategoryBalance:i,isMobile:a,isUngrouped:l}){return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("h3",{style:{...vl,margin:0,opacity:l?.7:1},children:[t,h.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),h.jsx("span",{style:{fontWeight:600,color:gn(n)},children:qe(n)})]}),!a&&h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[h.jsx("span",{children:"Category"}),h.jsx("span",{style:{textAlign:"right"},children:"Start"}),h.jsx("span",{style:{textAlign:"right"},children:"Allocated"}),h.jsx("span",{style:{textAlign:"right"},children:"Spent"}),h.jsx("span",{style:{textAlign:"right"},children:"End"})]}),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:e.map(([c,d])=>{const f=i(c);return f?a?h.jsx(v6,{category:d,balance:f},c):h.jsx(b6,{category:d,balance:f},c):null})})]})}function v6({category:t,balance:e}){return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[h.jsx("span",{style:{fontWeight:500},children:t.name}),h.jsx("span",{style:{fontWeight:600,color:gn(e.end_balance)},children:qe(e.end_balance)})]}),h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.5rem",fontSize:"0.8rem"},children:[h.jsxs("div",{children:[h.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),h.jsx("span",{children:qe(e.start_balance)})]}),h.jsxs("div",{children:[h.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),h.jsxs("span",{style:{color:e.allocated>0?_e.success:"inherit"},children:[e.allocated>0?"+":"",qe(e.allocated)]})]}),h.jsxs("div",{children:[h.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),h.jsxs("span",{style:{color:e.spent>0?_e.error:"inherit"},children:[e.spent>0?"-":"",qe(e.spent)]})]})]})]})}function b6({category:t,balance:e}){return h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[h.jsx("span",{style:{fontWeight:500},children:t.name}),h.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:qe(e.start_balance)}),h.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.allocated>0?_e.success:"inherit"},children:[e.allocated>0?"+":"",qe(e.allocated)]}),h.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.spent>0?_e.error:"inherit"},children:[e.spent>0?"-":"",qe(e.spent)]}),h.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:gn(e.end_balance)},children:qe(e.end_balance)})]})}const E6=["income","allocations","spend","balances"];function yx(t){const e=t.year?parseInt(t.year,10):null,n=t.month?parseInt(t.month,10):null,i=t.tab&&E6.includes(t.tab)?t.tab:null;return{year:e&&!isNaN(e)&&e>=2e3&&e<=2100?e:null,month:n&&!isNaN(n)&&n>=1&&n<=12?n:null,tab:i}}function _x(){const t=lC(),e=Bh(),{currentUserId:n,selectedBudgetId:i,currentYear:a,currentMonthNumber:l,lastActiveTab:c,setCurrentYear:d,setCurrentMonthNumber:f,setLastActiveTab:p,goToPreviousMonth:_,goToNextMonth:v,hasPendingInvites:b,pendingInvites:T,needsFirstBudget:w}=an(),{budget:A,createBudget:I,acceptInvite:P}=Tn(i,n),{month:G,isLoading:Q}=El(i,a,l),[X,Z]=D.useState(null),oe=D.useRef(!1),[O,C]=D.useState(()=>{const{tab:W}=yx(t);return W??c}),R=W=>{C(W),p(W)};D.useEffect(()=>{if(oe.current)return;const{year:W,month:H}=yx(t);W&&d(W),H&&f(H),oe.current=!0},[t,d,f]),D.useEffect(()=>{if(!oe.current)return;const W=`/budget/${a}/${l}/${O}`,H=`/budget/${t.year}/${t.month}/${t.tab}`;W!==H&&e(W,{replace:!0})},[a,l,O,e,t]);async function N(W){try{await P(W)}catch(H){Z(H instanceof Error?H.message:"Failed to accept invite")}}async function j(W){try{await I(W||"My Budget")}catch(H){Z(H instanceof Error?H.message:"Failed to create budget")}}if(!A&&b)return h.jsxs(Ko,{children:[h.jsx(ci,{title:"Budget",showBackArrow:!0,hideMenu:!0}),h.jsx(o6,{invites:T,onAccept:N,onCreateNew:j})]});if(!A&&w)return h.jsxs(Ko,{children:[h.jsx(ci,{title:"Budget",showBackArrow:!0,hideMenu:!0}),h.jsx(a6,{onCreateNew:j})]});function U(){Z(null),_()}function M(){Z(null),v()}return h.jsxs(Ko,{children:[h.jsx(ci,{title:A?.name||"Budget"}),h.jsxs(YN,{children:[X&&h.jsx(bl,{message:X,onDismiss:()=>Z(null)}),h.jsx(u6,{isLoading:Q,onPreviousMonth:U,onNextMonth:M}),h.jsx(l6,{activeTab:O,setActiveTab:R,allocationsFinalized:G?.allocations_finalized}),O==="income"&&h.jsx(h6,{}),O==="allocations"&&h.jsx(g6,{}),O==="spend"&&h.jsx(m6,{}),O==="balances"&&h.jsx(_6,{})]})]})}function x6(){return h.jsxs(Ko,{children:[h.jsx(ci,{title:"Analytics"}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[h.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),h.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),h.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),h.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),h.jsx(wt,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:_e.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})]})}function Nh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,accountGroups:a,showGroupSelector:l=!1,showIncomeSettings:c=!1,hasExistingIncomeDefault:d=!1,hasExistingOutgoDefault:f=!1,currentGroupId:p}){const[_,v]=D.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),b=_.account_group_id||p,T=b?a.find(Q=>Q.id===b):null,w=T?.is_active!==void 0,A=T?.on_budget!==void 0;function I(Q){Q.preventDefault(),_.nickname.trim()&&e(_)}function P(Q){v({..._,is_income_account:Q,is_income_default:Q?_.is_income_default:!1})}function G(Q){v({..._,is_outgo_account:Q,is_outgo_default:Q?_.is_outgo_default:!1})}return h.jsxs(Ua,{onSubmit:I,children:[h.jsx(Gt,{label:"Account Nickname",htmlFor:"account-nickname",children:h.jsx(Fi,{id:"account-nickname",type:"text",value:_.nickname,onChange:Q=>v({..._,nickname:Q.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&h.jsx(Gt,{label:"Account Type",htmlFor:"account-group",children:h.jsxs(ka,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:Q=>v({..._,account_group_id:Q.target.value==="ungrouped"?null:Q.target.value}),children:[h.jsx("option",{value:"ungrouped",children:"Ungrouped"}),a.map(Q=>h.jsx("option",{value:Q.id,children:Q.name},Q.id))]})}),c&&h.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[h.jsx(Do,{id:"is-active",checked:w?T.is_active:_.is_active!==!1,onChange:Q=>v({..._,is_active:Q.target.checked}),disabled:w,children:h.jsx("span",{style:{opacity:w?.5:1},children:"Active account"})}),w&&h.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:_e.warning},children:['Set by account type "',T.name,'"']})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[h.jsx(Do,{id:"on-budget",checked:A?T.on_budget:_.on_budget!==!1,onChange:Q=>v({..._,on_budget:Q.target.checked}),disabled:A,children:h.jsx("span",{style:{opacity:A?.5:1},children:"On budget (affects budget totals)"})}),A&&h.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:_e.warning},children:['Set by account type "',T.name,'"']})]})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),h.jsx(Do,{id:"is-income-account",checked:_.is_income_account||!1,onChange:Q=>P(Q.target.checked),children:"Show in income deposit list"}),_.is_income_account&&h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[h.jsx(Do,{id:"is-income-default",checked:_.is_income_default||!1,onChange:Q=>v({..._,is_income_default:Q.target.checked}),disabled:d&&!t?.is_income_default,children:"Default account for new income"}),d&&!t?.is_income_default&&h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),h.jsx(Do,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:Q=>G(Q.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[h.jsx(Do,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:Q=>v({..._,is_outgo_default:Q.target.checked}),disabled:f&&!t?.is_outgo_default,children:"Default account for new expenses"}),f&&!t?.is_outgo_default&&h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),h.jsxs(Ks,{children:[h.jsx(Ne,{type:"submit",children:i}),h.jsx(Ne,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function vx({label:t,value:e,onChange:n,trueLabel:i,falseLabel:a,undefinedLabel:l}){function c(){n(e===void 0?!0:e===!0?!1:void 0)}const d=e===!0?i:e===!1?a:l,f=e===!0?_e.success:e===!1?_e.warning:"inherit",p=e===!0?"":e===!1?"":"";return h.jsxs("button",{type:"button",onClick:c,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${f} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${f} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[h.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?f:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:p}),h.jsxs("span",{style:{flex:1},children:[h.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",h.jsx("span",{style:{fontWeight:500,color:f},children:d})]}),h.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function jT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=D.useState(t||{name:"",expected_balance:"positive"});function c(d){d.preventDefault(),a.name.trim()&&e(a)}return h.jsxs(Ua,{onSubmit:c,children:[h.jsx(Gt,{label:"Account Type Name",htmlFor:"group-name",children:h.jsx(Fi,{id:"group-name",type:"text",value:a.name,onChange:d=>l({...a,name:d.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),h.jsx(Gt,{label:"Expected Balance",htmlFor:"expected-balance",children:h.jsxs(ka,{id:"expected-balance",value:a.expected_balance,onChange:d=>l({...a,expected_balance:d.target.value}),children:[h.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),h.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),h.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),h.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",h.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),h.jsx(vx,{label:"Active status",value:a.is_active,onChange:d=>l({...a,is_active:d}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),h.jsx(vx,{label:"Budget status",value:a.on_budget,onChange:d=>l({...a,on_budget:d}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),h.jsxs(Ks,{children:[h.jsx(Ne,{type:"submit",children:i}),h.jsx(Ne,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function jo({icon:t,label:e,variant:n,title:i}){const l={success:{background:`color-mix(in srgb, ${_e.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${_e.success} 40%, transparent)`,color:_e.success,opacity:1},warning:{background:`color-mix(in srgb, ${_e.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${_e.warning} 35%, transparent)`,color:_e.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${_e.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${_e.success} 25%, transparent)`,color:_e.success,opacity:.7},expense:{background:`color-mix(in srgb, ${_e.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${_e.warning} 25%, transparent)`,color:_e.warning,opacity:.7}}[n];return h.jsxs("span",{title:i||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[h.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function OT({account:t,accountGroups:e}){const n=[],i=t.account_group_id?e.find(c=>c.id===t.account_group_id):null,a=i?.is_active!==void 0?i.is_active:t.is_active!==!1,l=i?.on_budget!==void 0?i.on_budget:t.on_budget!==!1;if(!a){const c=i?.is_active!==void 0;n.push(h.jsx(jo,{icon:"",label:c?"Inactive (type)":"Inactive",variant:"warning",title:c?`Set by "${i.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const c=i?.on_budget!==void 0;n.push(h.jsx(jo,{icon:"",label:c?"Off Budget (type)":"Off Budget",variant:"warning",title:c?`Set by "${i.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(h.jsx(jo,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(h.jsx(jo,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(h.jsx(jo,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(h.jsx(jo,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:h.jsx(h.Fragment,{children:n})}function S6({group:t}){const e=[];return t.is_active===!1?e.push(h.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${_e.warning} 20%, transparent)`,color:_e.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(h.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${_e.success} 20%, transparent)`,color:_e.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(h.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${_e.warning} 20%, transparent)`,color:_e.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(h.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${_e.success} 20%, transparent)`,color:_e.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:h.jsx(h.Fragment,{children:e})}function MT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return h.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[h.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&h.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function w6(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function T6(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function A6({group:t,groupIndex:e,totalGroups:n,accounts:i,allGroups:a,allAccounts:l,editingAccountId:c,editingGroupId:d,createForGroupId:f,setEditingAccountId:p,setEditingGroupId:_,setCreateForGroupId:v,dragType:b,draggedId:T,dragOverId:w,dragOverGroupId:A,setDragOverId:I,setDragOverGroupId:P,onAccountDragStart:G,onAccountDragOver:Q,onAccountDrop:X,onGroupDragStart:Z,onGroupDragOver:oe,onGroupDrop:O,onDragLeave:C,onDragLeaveGroup:R,onDragEnd:N,onDropOnGroup:j,onCreateAccount:U,onUpdateAccount:M,onDeleteAccount:W,onMoveAccount:H,onUpdateGroup:B,onDeleteGroup:z,onMoveGroup:F}){const $=$s(),te=[...i].sort((fe,Ze)=>fe.sort_order-Ze.sort_order),V=b==="group"&&T===t.id,q=b==="group"&&w===t.id,ne=b==="account"&&A===t.id,ce=(T&&b==="account"?l[T]:null)&&Object.entries(l).find(([fe])=>fe===T)?.[1]&&Object.entries(l).find(([fe])=>fe===T)?.[1]?.account_group_id!==t.id,be=b==="group"&&q&&T!==t.id,Ee=e>0,ve=e<n-1,Se=te.reduce((fe,Ze)=>fe+Ze.balance,0);return h.jsxs("div",{children:[b==="group"&&!V&&h.jsxs("div",{onDragOver:fe=>{fe.preventDefault(),I(t.id)},onDragLeave:C,onDrop:fe=>O(fe,t.id),style:{position:"relative",height:be?"2.5rem":"0.5rem",marginBottom:be?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[h.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",opacity:be?1:0,transition:"opacity 0.15s",boxShadow:be?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),be&&h.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),h.jsx("div",{draggable:d!==t.id,onDragStart:fe=>Z(fe,t.id),onDragOver:fe=>oe(fe,t.id),onDragLeave:R,onDragEnd:N,onDrop:fe=>j(fe,t.id),style:{background:V?"color-mix(in srgb, currentColor 3%, transparent)":ne&&ce?`color-mix(in srgb, ${_e.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:V?.5:1,border:ne&&ce?`2px dashed ${_e.primary}`:"2px solid transparent",cursor:d===t.id?"default":"grab",transition:"all 0.15s"},children:d===t.id?h.jsx(jT,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:fe=>B(t.id,fe),onCancel:()=>_(null),submitLabel:"Save"}):h.jsxs(h.Fragment,{children:[h.jsx(C6,{group:t,accountCount:te.length,groupTotal:Se,canMoveUp:Ee,canMoveDown:ve,isMobile:$,createForGroupId:f,onEdit:()=>_(t.id),onDelete:()=>z(t.id),onMoveUp:()=>F(t.id,"up"),onMoveDown:()=>F(t.id,"down"),onAddAccount:()=>v(t.id)}),$&&h.jsx("div",{style:{marginBottom:"0.5rem"},children:h.jsx(Ne,{variant:"small",onClick:()=>v(t.id),disabled:f!==null,children:"+ Account"})}),h.jsxs("div",{style:qs,children:[te.map((fe,Ze)=>c===fe.id?h.jsx(Nh,{initialData:{nickname:fe.nickname,account_group_id:fe.account_group_id,is_income_account:fe.is_income_account,is_income_default:fe.is_income_default,is_outgo_account:fe.is_outgo_account,is_outgo_default:fe.is_outgo_default,on_budget:fe.on_budget,is_active:fe.is_active},onSubmit:Fe=>M(fe.id,Fe),onCancel:()=>p(null),submitLabel:"Save",accountGroups:a,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:fe.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([Fe,on])=>on.is_income_default&&Fe!==fe.id),hasExistingOutgoDefault:Object.entries(l).some(([Fe,on])=>on.is_outgo_default&&Fe!==fe.id)},fe.id):h.jsx(pf,{isDragging:b==="account"&&T===fe.id,isDragOver:w===fe.id,onDragStart:Fe=>{Fe.stopPropagation(),G(Fe,fe.id)},onDragOver:Fe=>Q(Fe,fe.id,t.id),onDragLeave:C,onDragEnd:N,onDrop:Fe=>X(Fe,fe.id,t.id),onEdit:()=>p(fe.id),onDelete:()=>W(fe.id),onMoveUp:()=>H(fe.id,"up"),onMoveDown:()=>H(fe.id,"down"),canMoveUp:Ze>0,canMoveDown:Ze<te.length-1,children:h.jsxs("div",{children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[h.jsx("span",{style:My,children:fe.nickname}),h.jsx(OT,{account:fe,accountGroups:a})]}),h.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:gn(fe.balance)},children:[qe(fe.balance),w6(fe.balance,t.expected_balance)&&h.jsx("span",{title:T6(fe.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},fe.id)),te.length===0&&!f&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),b==="account"&&te.length>0&&h.jsx(MT,{groupId:t.id,isActive:w===`__end__${t.id}`,onDragOver:fe=>{fe.preventDefault(),fe.stopPropagation(),I(`__end__${t.id}`),P(t.id)},onDragLeave:fe=>{fe.stopPropagation(),I(null)},onDrop:fe=>{fe.stopPropagation(),X(fe,"__group_end__",t.id)}}),f===t.id&&h.jsx(Nh,{initialData:{nickname:"",account_group_id:t.id},onSubmit:fe=>U(fe,t.id),onCancel:()=>v(null),submitLabel:"Create",accountGroups:a,showIncomeSettings:!0,currentGroupId:t.id})]}),f!==t.id&&h.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:h.jsx(Ne,{variant:"small",onClick:()=>v(t.id),disabled:f!==null,children:"+ Add Account"})})]})})]})}function C6({group:t,accountCount:e,groupTotal:n,canMoveUp:i,canMoveDown:a,isMobile:l,createForGroupId:c,onEdit:d,onDelete:f,onMoveUp:p,onMoveDown:_,onAddAccount:v}){return h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[h.jsxs("h3",{style:{...vl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&h.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),h.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),h.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),h.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:gn(n),flexShrink:0},children:qe(n)}),h.jsx(S6,{group:t})]}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&h.jsx(Ne,{variant:"small",onClick:v,disabled:c!==null,children:"+ Account"}),h.jsx("button",{onClick:d,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),h.jsx("button",{onClick:f,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),h.jsxs("div",{style:Oy,children:[h.jsx("button",{onClick:p,disabled:!i,style:{...rl,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),h.jsx("button",{onClick:_,disabled:!a,style:{...rl,opacity:a?.6:.2,cursor:a?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function R6({accounts:t,allGroups:e,allAccounts:n,hasGroups:i,editingAccountId:a,createForGroupId:l,setEditingAccountId:c,setCreateForGroupId:d,dragType:f,draggedId:p,dragOverId:_,dragOverGroupId:v,setDragOverId:b,setDragOverGroupId:T,onAccountDragStart:w,onAccountDragOver:A,onAccountDrop:I,onDragOverGroup:P,onDropOnGroup:G,onDragLeave:Q,onDragLeaveGroup:X,onDragEnd:Z,onCreateAccount:oe,onUpdateAccount:O,onDeleteAccount:C,onMoveAccount:R}){const N=[...t].sort((H,B)=>H.sort_order-B.sort_order),j=f==="account"&&v==="ungrouped",M=(p&&f==="account"?n[p]:null)&&Object.entries(n).find(([H])=>H===p)?.[1]&&Object.entries(n).find(([H])=>H===p)?.[1]?.account_group_id!==null;if(N.length===0&&!l&&i&&f!=="account")return null;const W=N.reduce((H,B)=>H+B.balance,0);return h.jsxs("div",{onDragOver:H=>P(H,"ungrouped"),onDragLeave:X,onDrop:H=>G(H,"ungrouped"),style:{background:j&&M?`color-mix(in srgb, ${_e.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:j&&M?`2px dashed ${_e.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("h3",{style:{...vl,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",h.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",N.length,")"]}),N.length>0&&h.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:gn(W)},children:qe(W)})]}),h.jsx(Ne,{variant:"small",onClick:()=>d("ungrouped"),disabled:l!==null,children:"+ Account"})]}),h.jsxs("div",{style:qs,children:[N.map((H,B)=>a===H.id?h.jsx(Nh,{initialData:{nickname:H.nickname,account_group_id:H.account_group_id,is_income_account:H.is_income_account,is_income_default:H.is_income_default,is_outgo_account:H.is_outgo_account,is_outgo_default:H.is_outgo_default,on_budget:H.on_budget,is_active:H.is_active},onSubmit:z=>O(H.id,z),onCancel:()=>c(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([z,F])=>F.is_income_default&&z!==H.id),hasExistingOutgoDefault:Object.entries(n).some(([z,F])=>F.is_outgo_default&&z!==H.id)},H.id):h.jsx(pf,{isDragging:f==="account"&&p===H.id,isDragOver:_===H.id,onDragStart:z=>w(z,H.id),onDragOver:z=>A(z,H.id,"ungrouped"),onDragLeave:Q,onDragEnd:Z,onDrop:z=>I(z,H.id,"ungrouped"),onEdit:()=>c(H.id),onDelete:()=>C(H.id),onMoveUp:()=>R(H.id,"up"),onMoveDown:()=>R(H.id,"down"),canMoveUp:B>0,canMoveDown:B<N.length-1,children:h.jsxs("div",{children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[h.jsx("span",{style:My,children:H.nickname}),h.jsx(OT,{account:H,accountGroups:e})]}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:gn(H.balance)},children:qe(H.balance)})]})},H.id)),N.length===0&&f==="account"&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),f==="account"&&N.length>0&&h.jsx(MT,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:H=>{H.preventDefault(),H.stopPropagation(),b("__end__ungrouped"),T("ungrouped")},onDragLeave:H=>{H.stopPropagation(),b(null)},onDrop:H=>{H.stopPropagation(),I(H,"__group_end__","ungrouped")}}),l==="ungrouped"&&h.jsx(Nh,{initialData:{nickname:"",account_group_id:null},onSubmit:H=>oe(H,"ungrouped"),onCancel:()=>d(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&h.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:h.jsx(Ne,{variant:"small",onClick:()=>d("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function D6(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:i,error:a,setError:l,handleCreateAccount:c,handleUpdateAccount:d,handleDeleteAccount:f,handleMoveAccount:p,handleCreateGroup:_,handleUpdateGroup:v,handleDeleteGroup:b,handleMoveGroup:T,reorderAccountsInGroup:w,reorderGroups:A}=e6(),I=$s(),[P,G]=D.useState(null),[Q,X]=D.useState(null),[Z,oe]=D.useState(null),[O,C]=D.useState(!1),[R,N]=D.useState(null),[j,U]=D.useState(null),[M,W]=D.useState(null),[H,B]=D.useState(null);function z(ve,Se){N("account"),U(Se),ve.dataTransfer.effectAllowed="move"}function F(ve,Se,fe){ve.preventDefault(),R==="account"&&(Se!==j&&W(Se),B(fe))}function $(ve,Se){ve.preventDefault(),R==="account"?(B(Se),W(null)):R==="group"&&Se!==j&&W(Se)}function te(){W(null)}function V(){B(null)}function q(){N(null),U(null),W(null),B(null)}async function ne(ve,Se,fe){if(ve.preventDefault(),ve.stopPropagation(),!j||R!=="account"){q();return}await w(j,Se,fe),q()}async function ee(ve,Se){ve.preventDefault(),R==="account"?await ne(ve,"__group_end__",Se):R==="group"&&await be(ve,Se)}function ce(ve,Se){ve.stopPropagation(),N("group"),U(Se),ve.dataTransfer.effectAllowed="move"}async function be(ve,Se){if(ve.preventDefault(),!j||R!=="group"||j===Se){q();return}await A(j,Se),q()}if(!i)return h.jsx("p",{children:"No budget found. Please log in."});const Ee=e.ungrouped||[];return h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Accounts"}),h.jsxs("p",{style:mf,children:["Organize your financial accounts by type.",h.jsx("br",{}),h.jsx("span",{style:{fontSize:"0.9rem"},children:I?"Use  buttons to reorder items, or drag to move between types.":"Drag accounts between types, or use  buttons to reorder."})]}),a&&h.jsx(bl,{message:a,onDismiss:()=>l(null)}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:h.jsx(By,{})}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(t).length===0&&n.length===0&&h.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((ve,Se)=>h.jsx(A6,{group:ve,groupIndex:Se,totalGroups:n.length,accounts:e[ve.id]||[],allGroups:n,allAccounts:t,editingAccountId:P,editingGroupId:Z,createForGroupId:Q,setEditingAccountId:G,setEditingGroupId:oe,setCreateForGroupId:X,dragType:R,draggedId:j,dragOverId:M,dragOverGroupId:H,setDragOverId:W,setDragOverGroupId:B,onAccountDragStart:z,onAccountDragOver:F,onAccountDrop:ne,onGroupDragStart:ce,onGroupDragOver:$,onGroupDrop:be,onDragLeave:te,onDragLeaveGroup:V,onDragEnd:q,onDropOnGroup:ee,onCreateAccount:c,onUpdateAccount:(fe,Ze)=>{d(fe,Ze),G(null)},onDeleteAccount:f,onMoveAccount:p,onUpdateGroup:(fe,Ze)=>{v(fe,Ze),oe(null)},onDeleteGroup:b,onMoveGroup:T},ve.id)),R==="group"&&n.length>0&&h.jsx(Py,{isActive:M==="__end__",onDragOver:ve=>{ve.preventDefault(),W("__end__")},onDragLeave:te,onDrop:ve=>be(ve,"__end__"),label:"Move account type to end"}),h.jsx(R6,{accounts:Ee,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:P,createForGroupId:Q,setEditingAccountId:G,setCreateForGroupId:X,dragType:R,draggedId:j,dragOverId:M,dragOverGroupId:H,setDragOverId:W,setDragOverGroupId:B,onAccountDragStart:z,onAccountDragOver:F,onAccountDrop:ne,onDragOverGroup:$,onDropOnGroup:ee,onDragLeave:te,onDragLeaveGroup:V,onDragEnd:q,onCreateAccount:c,onUpdateAccount:(ve,Se)=>{d(ve,Se),G(null)},onDeleteAccount:f,onMoveAccount:p})]}),O?h.jsx(jT,{onSubmit:ve=>{_(ve),C(!1)},onCancel:()=>C(!1),submitLabel:"Create Account Type"}):h.jsx(Ne,{variant:"primary-large",onClick:()=>C(!0),children:"+ Add Account Type"})]})}function Ph({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,categoryGroups:a=[],showGroupSelector:l=!1}){const[c,d]=D.useState(t||{name:"",category_group_id:null}),[f,p]=D.useState(t?.default_monthly_amount?.toString()||""),[_,v]=D.useState(t?.default_monthly_type||"fixed"),[b,T]=D.useState(!1);function w(A){if(A.preventDefault(),!c.name.trim())return;T(!0);const I=parseFloat(f),P=!isNaN(I)&&I>0;e({...c,description:c.description?.trim()||void 0,default_monthly_amount:P?I:void 0,default_monthly_type:P?_:void 0})}return h.jsxs(Ua,{onSubmit:w,children:[h.jsx(Gt,{label:"Category Name",htmlFor:"category-name",children:h.jsx(Fi,{id:"category-name",type:"text",value:c.name,onChange:A=>d({...c,name:A.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),h.jsx(Gt,{label:"Description (optional)",htmlFor:"category-description",children:h.jsx(ky,{id:"category-description",value:c.description||"",onChange:A=>d({...c,description:A.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&h.jsx(Gt,{label:"Category Group",htmlFor:"category-group",children:h.jsxs(ka,{id:"category-group",value:c.category_group_id||"ungrouped",onChange:A=>d({...c,category_group_id:A.target.value==="ungrouped"?null:A.target.value}),children:[h.jsx("option",{value:"ungrouped",children:"Uncategorized"}),a.map(A=>h.jsx("option",{value:A.id,children:A.name},A.id))]})}),h.jsxs(Gt,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[h.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[h.jsxs(ka,{id:"default-type",value:_,onChange:A=>v(A.target.value),style:{width:"auto",flex:"0 0 auto"},children:[h.jsx("option",{value:"fixed",children:"Fixed $"}),h.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?h.jsx(Ny,{id:"default-amount",value:f,onChange:p,placeholder:"$0.00"}):h.jsx(Fi,{id:"default-amount",type:"number",value:f,onChange:A=>p(A.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&h.jsx("span",{style:{opacity:.6},children:"%"})]}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),h.jsxs(Ks,{children:[h.jsx(Ne,{type:"submit",isLoading:b,children:i}),h.jsx(Ne,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function kT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=D.useState(t||{name:""}),[c,d]=D.useState(!1);function f(p){p.preventDefault(),a.name.trim()&&(d(!0),e(a))}return h.jsxs(Ua,{onSubmit:f,children:[h.jsx(Gt,{label:"Group Name",htmlFor:"group-name",children:h.jsx(Fi,{id:"group-name",type:"text",value:a.name,onChange:p=>l({...a,name:p.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),h.jsxs(Ks,{children:[h.jsx(Ne,{type:"submit",isLoading:c,children:i}),h.jsx(Ne,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function NT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return h.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[h.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&h.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function I6({group:t,groupIndex:e,groupCategories:n,sortedGroups:i,categoryGroups:a,categoryBalances:l,loadingBalances:c,dragType:d,draggedId:f,dragOverId:p,dragOverGroupId:_,editingCategoryId:v,setEditingCategoryId:b,createForGroupId:T,setCreateForGroupId:w,editingGroupId:A,setEditingGroupId:I,handleCreateCategory:P,handleUpdateCategory:G,handleDeleteCategory:Q,handleMoveCategory:X,handleUpdateGroup:Z,handleDeleteGroup:oe,handleMoveGroup:O,handleCategoryDragStart:C,handleCategoryDragOver:R,handleDragOverGroup:N,handleDragLeave:j,handleDragLeaveGroup:U,handleDragEnd:M,handleCategoryDrop:W,handleDropOnGroup:H,handleGroupDragStart:B,handleGroupDrop:z,setDragOverId:F,setDragOverGroupId:$,isMobile:te,categories:V}){const q=d==="group"&&f===t.id,ne=d==="group"&&p===t.id,ee=d==="category"&&_===t.id,ce=f&&d==="category"?V[f]:null,be=ce&&(ce.category_group_id||"ungrouped")!==t.id,Ee=d==="group"&&ne&&f!==t.id,ve=e>0,Se=e<i.length-1;return h.jsxs("div",{children:[d==="group"&&!q&&h.jsxs("div",{onDragOver:fe=>{fe.preventDefault(),F(t.id)},onDragLeave:j,onDrop:fe=>z(fe,t.id),style:{position:"relative",height:Ee?"2.5rem":"0.5rem",marginBottom:Ee?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[h.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:_e.primary,borderRadius:"2px",opacity:Ee?1:0,transition:"opacity 0.15s",boxShadow:Ee?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),Ee&&h.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),h.jsx("div",{onDragOver:fe=>N(fe,t.id),onDragLeave:U,onDrop:fe=>H(fe,t.id),style:{background:q?"color-mix(in srgb, currentColor 3%, transparent)":ee&&be?`color-mix(in srgb, ${_e.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:q?.5:1,border:ee&&be?`2px dashed ${_e.primary}`:"2px solid transparent",transition:"all 0.15s"},children:A===t.id?h.jsx(kT,{initialData:{name:t.name},onSubmit:fe=>Z(t.id,fe),onCancel:()=>I(null),submitLabel:"Save"}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:te?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:te?"wrap":"nowrap"},children:[h.jsxs("h3",{style:{...vl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!te&&h.jsx("span",{draggable:!0,onDragStart:fe=>B(fe,t.id),onDragEnd:M,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),h.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),h.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",n.length,")"]})]}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!te&&h.jsx(Ne,{variant:"small",onClick:()=>w(t.id),disabled:T!==null,children:"+ Category"}),h.jsx("button",{onClick:()=>I(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),h.jsx("button",{onClick:()=>oe(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),h.jsxs("div",{style:Oy,children:[h.jsx("button",{onClick:()=>O(t.id,"up"),disabled:!ve,style:{...rl,opacity:ve?.6:.2,cursor:ve?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),h.jsx("button",{onClick:()=>O(t.id,"down"),disabled:!Se,style:{...rl,opacity:Se?.6:.2,cursor:Se?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),te&&h.jsx("div",{style:{marginBottom:"0.5rem"},children:h.jsx(Ne,{variant:"small",onClick:()=>w(t.id),disabled:T!==null,children:"+ Category"})}),h.jsxs("div",{style:qs,children:[n.map(([fe,Ze])=>v===fe?h.jsx(Ph,{initialData:{name:Ze.name,description:Ze.description,category_group_id:Ze.category_group_id,default_monthly_amount:Ze.default_monthly_amount,default_monthly_type:Ze.default_monthly_type},onSubmit:Fe=>G(fe,Fe),onCancel:()=>b(null),submitLabel:"Save",categoryGroups:a,showGroupSelector:!0},fe):h.jsx(pf,{isDragging:d==="category"&&f===fe,isDragOver:p===fe,onDragStart:Fe=>{Fe.stopPropagation(),C(Fe,fe)},onDragOver:Fe=>R(Fe,fe,t.id),onDragLeave:j,onDragEnd:M,onDrop:Fe=>W(Fe,fe,t.id),onEdit:()=>b(fe),onDelete:()=>Q(fe),onMoveUp:()=>X(fe,"up"),onMoveDown:()=>X(fe,"down"),canMoveUp:n.findIndex(([Fe])=>Fe===fe)>0,canMoveDown:n.findIndex(([Fe])=>Fe===fe)<n.length-1,children:h.jsx(PT,{category:Ze,catId:fe,categoryBalances:l,loadingBalances:c})},fe)),n.length===0&&!T&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),d==="category"&&n.length>0&&h.jsx(NT,{groupId:t.id,isActive:p===`__end__${t.id}`,onDragOver:fe=>{fe.preventDefault(),fe.stopPropagation(),F(`__end__${t.id}`),$(t.id)},onDragLeave:fe=>{fe.stopPropagation(),F(null)},onDrop:fe=>{fe.stopPropagation(),W(fe,"__group_end__",t.id)}}),T===t.id&&h.jsx(Ph,{initialData:{name:"",category_group_id:t.id},onSubmit:fe=>P(fe,t.id),onCancel:()=>w(null),submitLabel:"Create",categoryGroups:a})]}),T!==t.id&&h.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:h.jsx(Ne,{variant:"small",onClick:()=>w(t.id),disabled:T!==null,children:"+ Add Category"})})]})})]})}function PT({category:t,catId:e,categoryBalances:n,loadingBalances:i}){const a=n[e]||{current:0,total:0};return h.jsxs("div",{children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[h.jsx("span",{style:My,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&h.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?h.jsxs(h.Fragment,{children:[h.jsxs("span",{style:{color:_e.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):h.jsxs(h.Fragment,{children:[h.jsx("span",{style:{color:_e.success,fontWeight:500},children:qe(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),h.jsxs("div",{style:{marginTop:"0.25rem"},children:[h.jsxs("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:gn(a.current)},children:[i?"...":qe(a.current),h.jsx("span",{style:{fontSize:"0.75rem",fontWeight:400,opacity:.6,marginLeft:"0.35rem"},children:"available now"})]}),h.jsxs("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.85rem",fontWeight:500,color:gn(a.total),opacity:.75},children:[i?"...":qe(a.total),h.jsx("span",{style:{fontSize:"0.7rem",fontWeight:400,opacity:.7,marginLeft:"0.35rem"},children:"total allocated"})]})]})]})}function j6({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:i,dragType:a,draggedId:l,dragOverId:c,dragOverGroupId:d,editingCategoryId:f,setEditingCategoryId:p,createForGroupId:_,setCreateForGroupId:v,handleCreateCategory:b,handleUpdateCategory:T,handleDeleteCategory:w,handleMoveCategory:A,handleCategoryDragStart:I,handleCategoryDragOver:P,handleDragOverGroup:G,handleDragLeaveGroup:Q,handleDragLeave:X,handleDragEnd:Z,handleCategoryDrop:oe,handleDropOnGroup:O,setDragOverId:C,setDragOverGroupId:R,categories:N,hasGroups:j}){const U=a==="category"&&d==="ungrouped",M=l&&a==="category"?N[l]:null,W=M&&M.category_group_id!==null;return t.length===0&&!_&&j&&a!=="category"?null:h.jsxs("div",{onDragOver:H=>G(H,"ungrouped"),onDragLeave:Q,onDrop:H=>O(H,"ungrouped"),style:{background:U&&W?`color-mix(in srgb, ${_e.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:U&&W?`2px dashed ${_e.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("h3",{style:{...vl,margin:0,opacity:.7},children:["Uncategorized",h.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),h.jsx(Ne,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Category"})]}),h.jsxs("div",{style:qs,children:[t.map(([H,B])=>f===H?h.jsx(Ph,{initialData:{name:B.name,description:B.description,category_group_id:B.category_group_id,default_monthly_amount:B.default_monthly_amount,default_monthly_type:B.default_monthly_type},onSubmit:z=>T(H,z),onCancel:()=>p(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},H):h.jsx(pf,{isDragging:a==="category"&&l===H,isDragOver:c===H,onDragStart:z=>I(z,H),onDragOver:z=>P(z,H,"ungrouped"),onDragLeave:X,onDragEnd:Z,onDrop:z=>oe(z,H,"ungrouped"),onEdit:()=>p(H),onDelete:()=>w(H),onMoveUp:()=>A(H,"up"),onMoveDown:()=>A(H,"down"),canMoveUp:t.findIndex(([z])=>z===H)>0,canMoveDown:t.findIndex(([z])=>z===H)<t.length-1,children:h.jsx(PT,{category:B,catId:H,categoryBalances:n,loadingBalances:i})},H)),t.length===0&&a==="category"&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),a==="category"&&t.length>0&&h.jsx(NT,{groupId:"ungrouped",isActive:c==="__end__ungrouped",onDragOver:H=>{H.preventDefault(),H.stopPropagation(),C("__end__ungrouped"),R("ungrouped")},onDragLeave:H=>{H.stopPropagation(),C(null)},onDrop:H=>{H.stopPropagation(),oe(H,"__group_end__","ungrouped")}}),_==="ungrouped"&&h.jsx(Ph,{initialData:{name:"",category_group_id:null},onSubmit:H=>b(H,"ungrouped"),onCancel:()=>v(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&h.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:h.jsx(Ne,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function O6(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:i,sortedGroups:a,categoryBalances:l,loadingBalances:c,error:d,setError:f,getOnBudgetTotal:p,handleCreateCategory:_,handleUpdateCategory:v,handleDeleteCategory:b,handleMoveCategory:T,handleCreateGroup:w,handleUpdateGroup:A,handleDeleteGroup:I,handleMoveGroup:P,dragType:G,draggedId:Q,dragOverId:X,dragOverGroupId:Z,setDragOverId:oe,setDragOverGroupId:O,handleCategoryDragStart:C,handleCategoryDragOver:R,handleDragOverGroup:N,handleDragLeave:j,handleDragLeaveGroup:U,handleDragEnd:M,handleCategoryDrop:W,handleDropOnGroup:H,handleGroupDragStart:B,handleGroupDrop:z}=i6(),F=$s(),[$,te]=D.useState(null),[V,q]=D.useState(null),[ne,ee]=D.useState(null),[ce,be]=D.useState(!1);return t?h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),h.jsxs("p",{style:mf,children:["Organize your spending categories into groups.",h.jsx("br",{}),h.jsx("span",{style:{fontSize:"0.9rem"},children:F?"Use  buttons to reorder items, or drag to move between groups.":"Drag categories between groups, or use  buttons to reorder."})]}),d&&h.jsx(bl,{message:d,onDismiss:()=>f(null)}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:h.jsx(By,{})}),(()=>{const Ee=Object.values(l).reduce((Fe,on)=>Fe+on.current,0),ve=Object.values(l).reduce((Fe,on)=>Fe+on.total,0),Se=p()-Ee,fe=p()-ve,Ze=Math.abs(ve-Ee)>.01;return h.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[h.jsxs(Cc,{style:{flex:1,minWidth:"120px"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Categories"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:Object.keys(e).length})]}),h.jsxs(Cc,{style:{flex:1,minWidth:"120px"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Groups"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:n.length})]}),h.jsxs(Cc,{style:{flex:1,minWidth:"120px"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"On-Budget"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:gn(p())},children:qe(p())})]}),h.jsxs(Cc,{style:{flex:1,minWidth:"120px"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Allocated Now"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:_e.primary},children:c?"...":qe(Ee)}),Ze&&h.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:c?"":`${qe(ve)} total`})]}),h.jsxs(Cc,{style:{flex:1,minWidth:"120px"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Available Now"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:gn(Se)},children:c?"...":qe(Se)}),Ze&&h.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:c?"":`${qe(fe)} after future`})]})]})})(),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(e).length===0&&n.length===0&&h.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),a.map((Ee,ve)=>{const Se=(i[Ee.id]||[]).sort((fe,Ze)=>fe[1].sort_order-Ze[1].sort_order);return h.jsx(I6,{group:Ee,groupIndex:ve,groupCategories:Se,sortedGroups:a,categoryGroups:n,categoryBalances:l,loadingBalances:c,dragType:G,draggedId:Q,dragOverId:X,dragOverGroupId:Z,editingCategoryId:$,setEditingCategoryId:te,createForGroupId:V,setCreateForGroupId:q,editingGroupId:ne,setEditingGroupId:ee,handleCreateCategory:_,handleUpdateCategory:v,handleDeleteCategory:b,handleMoveCategory:T,handleUpdateGroup:A,handleDeleteGroup:I,handleMoveGroup:P,handleCategoryDragStart:C,handleCategoryDragOver:R,handleDragOverGroup:N,handleDragLeave:j,handleDragLeaveGroup:U,handleDragEnd:M,handleCategoryDrop:W,handleDropOnGroup:H,handleGroupDragStart:B,handleGroupDrop:z,setDragOverId:oe,setDragOverGroupId:O,isMobile:F,categories:e},Ee.id)}),G==="group"&&a.length>0&&h.jsx(Py,{isActive:X==="__end__",onDragOver:Ee=>{Ee.preventDefault(),oe("__end__")},onDragLeave:j,onDrop:Ee=>z(Ee,"__end__"),label:"Move group to end"}),h.jsx(j6,{ungroupedCategories:(i.ungrouped||[]).sort((Ee,ve)=>Ee[1].sort_order-ve[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:c,dragType:G,draggedId:Q,dragOverId:X,dragOverGroupId:Z,editingCategoryId:$,setEditingCategoryId:te,createForGroupId:V,setCreateForGroupId:q,handleCreateCategory:_,handleUpdateCategory:v,handleDeleteCategory:b,handleMoveCategory:T,handleCategoryDragStart:C,handleCategoryDragOver:R,handleDragOverGroup:N,handleDragLeaveGroup:U,handleDragLeave:j,handleDragEnd:M,handleCategoryDrop:W,handleDropOnGroup:H,setDragOverId:oe,setDragOverGroupId:O,categories:e,hasGroups:n.length>0})]}),ce?h.jsx(kT,{onSubmit:Ee=>{w(Ee),be(!1)},onCancel:()=>be(!1),submitLabel:"Create Group"}):h.jsx(Ne,{variant:"primary-large",onClick:()=>be(!0),children:"+ Add Category Group"})]}):h.jsx("p",{children:"No budget found. Please log in."})}const M6=["accounts","categories","users"];function k6(){const{selectedBudgetId:t,currentUserId:e,lastSettingsTab:n,setLastSettingsTab:i}=an(),{isOwner:a,isLoading:l}=Tn(t,e),c=Pn(),d=c.pathname==="/budget/settings",f=D.useMemo(()=>{const T=c.pathname;return T.includes("/settings/accounts")?"accounts":T.includes("/settings/categories")?"categories":T.includes("/settings/users")?"users":"accounts"},[c.pathname]),p=f==="users";D.useEffect(()=>{d||i(f)},[f,d,i]);function _(){return!M6.includes(n)||n==="users"&&!a?"accounts":n}const v=D.useMemo(()=>[{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!a}],[a]);return l?h.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:h.jsx("p",{children:"Loading..."})}):!a&&p?h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx(ci,{title:"Budget Settings"}),h.jsx("h1",{children:"Access Denied"}),h.jsx("p",{style:{opacity:.7},children:"Only the budget owner can access this section."}),h.jsx("p",{style:{marginTop:"1rem"},children:h.jsx(wt,{to:"/budget/settings/accounts",style:{color:"#646cff"},children:"Go to Accounts "})})]}):h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx(ci,{title:"Budget Settings"}),h.jsx(Ly,{mode:"link",linkPrefix:"/budget/settings",tabs:v,activeTab:f}),d?h.jsx(jg,{to:`/budget/settings/${_()}`,replace:!0}):h.jsx(Uh,{})]})}function N6(){const{selectedBudgetId:t,currentUserId:e}=an(),{budget:n,budgetUserIds:i,acceptedUserIds:a,inviteUser:l,revokeUser:c}=Tn(t,e),[d,f]=D.useState(""),[p,_]=D.useState(!1),[v,b]=D.useState(null),[T,w]=D.useState(null);if(!n)return h.jsx("p",{children:"No budget found."});async function A(Q){if(Q.preventDefault(),!(!d.trim()||!n)){_(!0),b(null),w(null);try{await l(d.trim()),f(""),w("Invite sent! The user can now accept the invitation from their account.")}catch(X){b(X instanceof Error?X.message:"Failed to invite user")}finally{_(!1)}}}async function I(Q){if(!n)return;if(Q===n.owner_id){b("Cannot revoke the budget owner");return}if(Q===e){b("Cannot revoke yourself from the budget");return}const X=a.includes(Q);if(confirm(X?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){b(null),w(null);try{await c(Q),w(X?"User access revoked.":"Invitation cancelled.")}catch(oe){b(oe instanceof Error?oe.message:"Failed to revoke user")}}}const P=i.filter(Q=>a.includes(Q)),G=i.filter(Q=>!a.includes(Q));return h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),h.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),v&&h.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:v}),h.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),T&&h.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:T}),h.jsx("button",{onClick:()=>w(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[h.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",P.length,")"]}),P.length===0?h.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:P.map(Q=>{const X=Q===n.owner_id,Z=Q===e;return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[h.jsx("div",{style:{flex:1,minWidth:0},children:h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[h.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:Q}),X&&h.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),Z&&h.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!X&&!Z&&h.jsx("button",{onClick:()=>I(Q),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},Q)})})]}),G.length>0&&h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[h.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",G.length,")"]}),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:G.map(Q=>h.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[h.jsx("div",{style:{flex:1,minWidth:0},children:h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[h.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:Q}),h.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),h.jsx("button",{onClick:()=>I(Q),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},Q))})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[h.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),h.jsxs("form",{onSubmit:A,style:{display:"flex",gap:"0.75rem"},children:[h.jsx("input",{type:"text",value:d,onChange:Q=>f(Q.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),h.jsx("button",{type:"submit",disabled:p||!d.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p||!d.trim()?"not-allowed":"pointer",fontWeight:500,opacity:p||!d.trim()?.7:1,whiteSpace:"nowrap"},children:p?"Inviting...":"Send Invite"})]}),h.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),h.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}const P6=["budget","feedback","migration","tests"];function L6(){const{isAdmin:t,isTest:e,lastAdminTab:n,setLastAdminTab:i}=an(),a=Pn(),l=a.pathname==="/budget/admin",c=D.useMemo(()=>{const _=a.pathname;return _.includes("/admin/budget")?"budget":_.includes("/admin/feedback")?"feedback":_.includes("/admin/migration")?"migration":_.includes("/admin/tests")?"tests":"budget"},[a.pathname]),d=c==="tests";D.useEffect(()=>{l||i(c)},[c,l,i]);function f(){return!P6.includes(n)||n==="tests"&&!e?"budget":n}const p=D.useMemo(()=>[{id:"budget",label:"Budget",icon:""},{id:"feedback",label:"Feedback",icon:""},{id:"migration",label:"Migration",icon:""},{id:"tests",label:"Tests",icon:"",hidden:!e}],[e]);return t?!e&&d?h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx(ci,{title:"Budget Admin"}),h.jsx("h1",{children:"Access Denied"}),h.jsx("p",{style:{opacity:.7},children:"Only test users can access this section."}),h.jsx("p",{style:{marginTop:"1rem"},children:h.jsx(wt,{to:"/budget/admin/budget",style:{color:"#646cff"},children:"Go to Admin "})})]}):h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx(ci,{title:"Budget Admin"}),h.jsx(Ly,{mode:"link",linkPrefix:"/budget/admin",tabs:p,activeTab:c}),l?h.jsx(jg,{to:`/budget/admin/${f()}`,replace:!0}):h.jsx(Uh,{})]}):h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx(ci,{title:"Budget Admin"}),h.jsx("h1",{children:"Access Denied"}),h.jsx("p",{style:{opacity:.7},children:"Only administrators can access this section."}),h.jsx("p",{style:{marginTop:"1rem"},children:h.jsx(wt,{to:"/budget",style:{color:"#646cff"},children:"Go to Budget "})})]})}function V6(){const{selectedBudgetId:t,currentUserId:e,isAdmin:n}=an(),{budget:i,accounts:a,accountGroups:l,categories:c,categoryGroups:d,isOwner:f,isLoading:p}=Tn(t,e);return p?h.jsx("p",{children:"Loading budget info..."}):i?h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Budget Summary"}),h.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Information about the currently selected budget."}),h.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",fontSize:"0.95rem"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""}),h.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Name:"}),h.jsx("strong",{children:i.name})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""}),h.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"ID:"}),h.jsx("code",{style:{background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:i.id})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""}),h.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Owner:"}),h.jsx("strong",{children:i.owner_email||i.owner_id})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""}),h.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Users:"}),h.jsxs("span",{children:[i.user_ids.length," user",i.user_ids.length!==1?"s":"",h.jsxs("span",{style:{opacity:.7},children:["  ",f?"You are the owner":"Shared with you"]})]})]})]})}),n&&h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[h.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem"},children:"Admin Tools"}),h.jsx("button",{onClick:()=>{const _={...i,accounts:a,account_groups:l,categories:c,category_groups:d,_meta:{downloaded_at:new Date().toISOString()}},v=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),b=URL.createObjectURL(v),T=document.createElement("a");T.href=b,T.download=`budget_${i.id}.json`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(b)},style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",transition:"background 0.15s"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]})]}):h.jsx("p",{style:{opacity:.7},children:"No budget selected."})}function bx({budget:t,isCurrent:e,isAccepting:n,isSwitching:i,isEditing:a,editName:l,isRenaming:c,onAccept:d,onSwitch:f,onStartEdit:p,onCancelEdit:_,onEditNameChange:v,onSaveEdit:b}){const T=e&&t.isOwner;return h.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:a?h.jsxs("form",{onSubmit:b,children:[h.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:h.jsx("input",{type:"text",value:l,onChange:w=>v(w.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[h.jsx("button",{type:"submit",disabled:c||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:c||!l.trim()?.7:1,fontSize:"0.8rem"},children:c?"Saving...":"Save"}),h.jsx("button",{type:"button",onClick:_,disabled:c,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c?"not-allowed":"pointer",fontWeight:500,opacity:c?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[h.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[h.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&h.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&h.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&h.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),T&&h.jsx("button",{onClick:p,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),h.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),h.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?h.jsx("button",{onClick:d,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:h.jsx("button",{onClick:f,disabled:i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,fontSize:"0.85rem"},children:i?"Switching...":"Switch"})})]})})}const wg={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function LT({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,i=n&&n in wg?n:"bug",a=wg[i];return h.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:a.bgColor,color:a.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:a.label})}function B6({item:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:d,onToggleDone:f,onTypeClick:p}){return h.jsxs("div",{onDragOver:_=>{_.stopPropagation(),a(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),d(_)},style:{position:"relative"},children:[h.jsx("div",{style:{...DT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),h.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:c,style:{...hu,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[h.jsx("span",{style:{...RT},children:""}),h.jsx("input",{type:"checkbox",checked:t.is_done,onChange:f,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:_e.primary,flexShrink:0}}),h.jsx(LT,{type:t.feedback_type,onClick:p})]}),h.jsxs("div",{style:{marginLeft:"3.25rem"},children:[h.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),h.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",Sg(t.created_at)]})]})]})]})}function U6({item:t,onToggleDone:e,onTypeClick:n}){return h.jsxs("div",{style:{...hu,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[h.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:_e.primary,flexShrink:0}}),h.jsx(LT,{type:t.feedback_type,onClick:n})]}),h.jsxs("div",{style:{marginLeft:"2rem"},children:[h.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),h.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",Sg(t.created_at)]}),t.completed_at&&h.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:_e.success},children:[" Completed: ",Sg(t.completed_at)]})]})]})}function Lh({noMargin:t}={}){return h.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:t?0:"0.5rem",verticalAlign:"middle"}})}function z6({title:t,description:e,isComplete:n,isMigrating:i,needsMigration:a,totalBudgetsToMigrate:l,budgetsToMigrateCategories:c,budgetsToMigrateAccounts:d,onRunMigration:f,onRefresh:p,isRefreshing:_,disabled:v,isUnknown:b,children:T}){const w=()=>b?{background:"rgba(100, 100, 100, 0.2)",color:"#9ca3af"}:n?{background:"rgba(34, 197, 94, 0.2)",color:"#4ade80"}:{background:"rgba(100, 108, 255, 0.2)",color:"#a5b4fc"},A=()=>b?"Unknown":n?"Complete":"Required",I=w();return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[h.jsxs("h3",{style:{margin:0,display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{style:{background:I.background,color:I.color,padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:A()}),t]}),p&&h.jsxs("button",{onClick:p,disabled:_||i,title:"Refresh status",style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.35rem 0.6rem",borderRadius:"6px",cursor:_||i?"not-allowed":"pointer",opacity:_||i?.5:.7,fontSize:"0.8rem",display:"flex",alignItems:"center",gap:"0.3rem",minWidth:"85px",minHeight:"28px"},children:[h.jsx("span",{style:{width:"16px",height:"16px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:_?h.jsx(Lh,{noMargin:!0}):""}),"Refresh"]})]}),h.jsx("p",{style:{opacity:.7,marginBottom:"1rem"},children:e}),i?h.jsxs("div",{style:{background:"rgba(100, 108, 255, 0.1)",border:"1px solid rgba(100, 108, 255, 0.3)",color:"#a5b4fc",padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:[h.jsx(Lh,{})," Running migration across all budgets..."]}):b?h.jsx("div",{style:{background:"rgba(100, 100, 100, 0.1)",border:"1px solid rgba(100, 100, 100, 0.3)",color:"#9ca3af",padding:"0.75rem 1rem",borderRadius:"8px"},children:" Status unknown  click Refresh to check migration status"}):n?h.jsx("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px"},children:" All budgets are using the new map structure"}):a?h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",color:"#fbbf24",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem"},children:[h.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",l," budget(s) needing migration:"]}),h.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[c>0&&h.jsxs("li",{children:[c," with categories to migrate"]}),d>0&&h.jsxs("li",{children:[d," with accounts to migrate"]})]})]}),h.jsx("button",{onClick:f,disabled:v,style:{background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:v?"not-allowed":"pointer",fontWeight:500,opacity:v?.7:1},children:"Migrate All Budgets"})]}):null,T]})}function F6({results:t}){return h.jsxs("div",{style:{marginTop:"1rem"},children:[h.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem"},children:"Migration Results:"}),h.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:t.map((e,n)=>h.jsx(q6,{result:e,isLast:n===t.length-1},n))})]})}function q6({result:t,isLast:e}){const n=t.error&&t.error!=="Already migrated",i=t.error==="Already migrated";return h.jsxs("div",{style:{padding:"0.5rem",marginBottom:e?0:"0.5rem",borderRadius:"4px",background:n?"rgba(220, 38, 38, 0.1)":i?"rgba(100, 100, 100, 0.1)":"rgba(34, 197, 94, 0.1)",border:n?"1px solid rgba(220, 38, 38, 0.3)":i?"1px solid rgba(100, 100, 100, 0.3)":"1px solid rgba(34, 197, 94, 0.3)"},children:[h.jsxs("div",{style:{fontWeight:500},children:[n?"":i?"":""," ",t.budgetName]}),n?h.jsxs("div",{style:{fontSize:"0.85rem",opacity:.8,color:"#f87171"},children:["Error: ",t.error]}):i?h.jsx("div",{style:{fontSize:"0.85rem",opacity:.6},children:"Already using map structure"}):h.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7},children:[t.categoriesMigrated>0&&`Migrated ${t.categoriesMigrated} categories`,t.categoriesMigrated>0&&(t.accountsMigrated>0||t.accountGroupsMigrated>0)&&", ",t.accountsMigrated>0&&`${t.accountsMigrated} accounts`,t.accountsMigrated>0&&t.accountGroupsMigrated>0&&", ",t.accountGroupsMigrated>0&&`${t.accountGroupsMigrated} account groups`,t.balancesCalculated&&" with calculated balances"]})]})}function Q6({hasData:t,futureMonthsCount:e,futureMonthsToDelete:n,isCleaningFutureMonths:i,onCleanup:a,disabled:l,cleanupResult:c}){return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[h.jsxs("div",{children:[h.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:" Clean Up Future Months"}),h.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.9rem"},children:"Deletes month documents that are more than 2 months in the future. These can be created accidentally when navigating too far ahead."})]}),t&&e===0&&h.jsx("span",{style:{color:"#22c55e",fontWeight:600},children:" Clean"})]}),t?e>0?h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 15%, transparent)",border:"1px solid #f59e0b",borderRadius:"8px",padding:"1rem",marginTop:"1rem"},children:[h.jsxs("p",{style:{margin:"0 0 0.5rem 0",fontWeight:600,color:"#f59e0b"},children:[" Found ",e," month",e!==1?"s":""," to delete"]}),h.jsxs("ul",{style:{margin:"0.5rem 0",paddingLeft:"1.5rem",fontSize:"0.85rem",opacity:.9},children:[n.slice(0,10).map(d=>h.jsxs("li",{children:[Iy[d.month-1]," ",d.year," (budget: ",d.budgetId.slice(0,8),"...)"]},d.docId)),e>10&&h.jsxs("li",{style:{opacity:.7},children:["...and ",e-10," more"]})]})]}),h.jsx("button",{onClick:a,disabled:i||l,style:{marginTop:"1rem",background:"#ef4444",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,display:"flex",alignItems:"center",gap:"0.4rem"},children:i?h.jsxs(h.Fragment,{children:[h.jsx(Lh,{noMargin:!0})," Deleting..."]}):` Delete ${e} Future Month${e!==1?"s":""}`})]}):h.jsx("p",{style:{margin:"1rem 0 0 0",opacity:.7,fontSize:"0.9rem"},children:"No future months found beyond 2 months from now."}):h.jsx("p",{style:{opacity:.6,fontSize:"0.9rem",margin:"1rem 0 0 0"},children:'Click "Refresh All" to check for future months.'}),c&&h.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:c.errors.length>0?"color-mix(in srgb, #f59e0b 10%, transparent)":"color-mix(in srgb, #22c55e 10%, transparent)",border:`1px solid ${c.errors.length>0?"#f59e0b":"#22c55e"}`,borderRadius:"8px"},children:[h.jsxs("p",{style:{margin:0,fontWeight:600},children:[c.errors.length>0?"":""," Deleted ",c.deleted," month",c.deleted!==1?"s":"",c.errors.length>0&&` (${c.errors.length} error${c.errors.length!==1?"s":""})`]}),c.errors.length>0&&h.jsx("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem",color:"#f59e0b"},children:c.errors.map((d,f)=>h.jsx("li",{children:d},f))})]})]})}function G6(){const e=Ba().get_current_firebase_user(),n=zO(),i=n.data!==void 0,a=n.isStale,l=n.data??{categoriesArrayMigrationNeeded:!1,accountsArrayMigrationNeeded:!1,budgetsToMigrateCategories:0,budgetsToMigrateAccounts:0,budgetsNeedingCategoryBalance:0,totalBudgetsChecked:0,futureMonthsToDelete:[],futureMonthsCount:0},c=n.isLoading,d=n.isFetching&&!n.isLoading,f=n.dataUpdatedAt?new Date(n.dataUpdatedAt).toLocaleString():null,p=()=>{Oe.invalidateQueries({queryKey:["settingsMigration"]}),n.refetch()},{isMigrating:_,migrationResults:v,isCleaningFutureMonths:b,futureMonthsCleanupResult:T,runMigration:w,cleanupFutureMonths:A}=s6({currentUser:e,futureMonthsToDelete:l.futureMonthsToDelete,onRefetch:p}),I=l.categoriesArrayMigrationNeeded||l.accountsArrayMigrationNeeded,P=Math.max(l.budgetsToMigrateCategories,l.budgetsToMigrateAccounts);return c?h.jsxs("div",{children:[h.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),h.jsx("h2",{style:{marginTop:0},children:"Data Migrations"}),h.jsx("p",{style:{opacity:.7},children:"Checking migration status..."})]}):h.jsxs("div",{children:[h.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[h.jsx("h2",{style:{margin:0},children:"Data Migrations"}),h.jsxs("button",{onClick:p,disabled:d||_,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:d||_?"not-allowed":"pointer",fontWeight:500,opacity:d||_?.7:1,display:"flex",alignItems:"center",gap:"0.4rem",minWidth:"130px",minHeight:"36px"},children:[h.jsx("span",{style:{width:"18px",height:"18px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:d?h.jsx(Lh,{noMargin:!0}):""}),"Refresh All"]})]}),h.jsxs("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:["Run migrations to update your budget data structure. Status is cached and won't auto-refresh.",h.jsx("span",{style:{display:"block",fontSize:"0.85rem",marginTop:"0.25rem"},children:i?a?h.jsxs("span",{style:{color:"#fbbf24"},children:[" Status may be stale  Last checked: ",f]}):h.jsxs("span",{children:["Last checked: ",f]}):h.jsx("span",{style:{color:"#a5b4fc"},children:"Status: Unknown (click Refresh to check)"})})]}),h.jsx(z6,{title:"Migrate Data to Map Structure",description:"Converts categories, accounts, and account groups from array format to map structure. This improves performance and enables direct lookup by ID.",isComplete:i?!I:!1,isMigrating:_,needsMigration:i?I:!1,totalBudgetsToMigrate:P,budgetsToMigrateCategories:l.budgetsToMigrateCategories,budgetsToMigrateAccounts:l.budgetsToMigrateAccounts,onRunMigration:w,onRefresh:p,isRefreshing:d,disabled:!e,isUnknown:!i,children:v&&h.jsx(F6,{results:v})}),h.jsx(Q6,{hasData:i,futureMonthsCount:l.futureMonthsCount,futureMonthsToDelete:l.futureMonthsToDelete,isCleaningFutureMonths:b,onCleanup:A,disabled:!e,cleanupResult:T}),h.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:h.jsxs("p",{style:{margin:0,opacity:.7},children:[h.jsx("strong",{children:"Note:"})," This migration will process ",h.jsxs("strong",{children:["all ",i?l.totalBudgetsChecked:"?"," budgets"]})," in the system, not just the ones you own or are invited to."]})})]})}function H6(){const[t,e]=D.useState(null),[n,i]=D.useState(null),[a,l]=D.useState(null),[c,d]=D.useState(!1),[f,p]=D.useState(""),[_,v]=D.useState("bug"),[b,T]=D.useState(null),[w,A]=D.useState(null),I=D.useContext(Jc),G=Ba().get_current_firebase_user(),Q=LO(),X=Gw(),Z=Q.data?.items||[];async function oe(F){if(F.preventDefault(),!(!f.trim()||!I.username||!G)){e(null);try{await X.submitFeedback.mutateAsync({userId:G.uid,userEmail:I.username,text:f.trim(),feedbackType:_,currentPath:"/settings/feedback"}),p(""),v("bug"),d(!1)}catch($){e($ instanceof Error?$.message:"Failed to add feedback")}}}function O(F){F.is_done?C(F):T(F)}async function C(F){try{await X.toggleFeedback.mutateAsync({item:F})}catch($){e($ instanceof Error?$.message:"Failed to update feedback")}}function R(){b&&(C(b),T(null))}async function N(F){if(w){try{const te=Z.filter(V=>V.doc_id===w.doc_id).map(V=>V.id===w.id?{id:V.id,text:V.text,created_at:V.created_at,is_done:V.is_done,completed_at:V.completed_at,sort_order:V.sort_order,feedback_type:F}:{id:V.id,text:V.text,created_at:V.created_at,is_done:V.is_done,completed_at:V.completed_at,sort_order:V.sort_order,feedback_type:V.feedback_type});await X.updateSortOrder.mutateAsync({docId:w.doc_id,items:te})}catch($){e($ instanceof Error?$.message:"Failed to update feedback type")}A(null)}}const j=Z.filter(F=>!F.is_done).sort((F,$)=>F.sort_order-$.sort_order),U=Z.filter(F=>F.is_done).sort((F,$)=>{const te=F.completed_at?new Date(F.completed_at).getTime():0;return($.completed_at?new Date($.completed_at).getTime():0)-te});function M(F,$){i($),F.dataTransfer.effectAllowed="move"}function W(F,$){F.preventDefault(),$!==n&&l($)}function H(){l(null)}function B(){i(null),l(null)}async function z(F,$){if(F.preventDefault(),!n||n===$){B();return}const te=j.findIndex(ce=>ce.id===n),V=[...j],[q]=V.splice(te,1);if($==="__end__")V.push(q);else{const ce=V.findIndex(be=>be.id===$);V.splice(ce,0,q)}const ne=V.map((ce,be)=>({...ce,sort_order:be}));B();const ee=new Map;for(const ce of ne)ee.has(ce.doc_id)||ee.set(ce.doc_id,[]),ee.get(ce.doc_id).push({id:ce.id,text:ce.text,created_at:ce.created_at,is_done:ce.is_done,completed_at:ce.completed_at,sort_order:ce.sort_order,feedback_type:ce.feedback_type});for(const ce of U)ee.has(ce.doc_id)||ee.set(ce.doc_id,[]),ee.get(ce.doc_id).push({id:ce.id,text:ce.text,created_at:ce.created_at,is_done:ce.is_done,completed_at:ce.completed_at,sort_order:ce.sort_order,feedback_type:ce.feedback_type});try{for(const[ce,be]of ee)await X.updateSortOrder.mutateAsync({docId:ce,items:be})}catch(ce){e(ce instanceof Error?ce.message:"Failed to save order")}}return Q.isLoading?h.jsx("p",{children:"Loading feedback..."}):h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Feedback"}),h.jsx("p",{style:{...mf,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&h.jsx(bl,{message:t,onDismiss:()=>e(null)}),h.jsxs("div",{style:qs,children:[j.length===0&&!c&&h.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),j.map(F=>h.jsx(B6,{item:F,isDragging:n===F.id,isDragOver:a===F.id,onDragStart:$=>M($,F.id),onDragOver:$=>W($,F.id),onDragLeave:H,onDragEnd:B,onDrop:$=>z($,F.id),onToggleDone:()=>O(F),onTypeClick:()=>A(F)},F.id)),n&&j.length>0&&h.jsx(Py,{isActive:a==="__end__",onDragOver:F=>W(F,"__end__"),onDragLeave:H,onDrop:F=>z(F,"__end__")})]}),c?h.jsxs(Ua,{onSubmit:oe,children:[h.jsx(Ex,{selectedType:_,onSelect:v}),h.jsx(ky,{value:f,onChange:F=>p(F.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),h.jsxs(Ks,{children:[h.jsx(Ne,{type:"submit",isLoading:X.submitFeedback.isPending,disabled:!f.trim(),children:"Add Feedback"}),h.jsx(Ne,{type:"button",variant:"secondary",onClick:()=>{d(!1),p(""),v("bug")},children:"Cancel"})]})]}):h.jsx(Ne,{variant:"primary-large",onClick:()=>d(!0),children:"+ Add Feedback"}),U.length>0&&h.jsx(HN,{title:"Completed",count:U.length,children:h.jsx("div",{style:{...qs,marginTop:"0.5rem"},children:U.map(F=>h.jsx(U6,{item:F,onToggleDone:()=>O(F),onTypeClick:()=>A(F)},F.id))})}),h.jsxs(kh,{isOpen:b!==null,onClose:()=>T(null),title:"Mark as Complete",children:[h.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),b&&h.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',b.text,'"']}),h.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[h.jsx(Ne,{variant:"secondary",onClick:()=>T(null),children:"Cancel"}),h.jsx(Ne,{variant:"primary",onClick:R,children:"Mark Complete"})]})]}),h.jsxs(kh,{isOpen:w!==null,onClose:()=>A(null),title:"Change Feedback Type",children:[h.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),h.jsx(Ex,{selectedType:w?.feedback_type||"bug",onSelect:N}),h.jsx(Ne,{variant:"secondary",onClick:()=>A(null),style:{width:"100%"},children:"Cancel"})]})]})}function Ex({selectedType:t,onSelect:e}){return h.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const i=wg[n],a=t==="feature"?"new_feature":t,l=a===n||!a&&n==="bug";return h.jsxs("button",{type:"button",onClick:()=>e(n),style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${i.color}`,borderRadius:"0.5rem",background:l?i.bgColor:"transparent",color:l?i.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${i.bgColor}`:"none",position:"relative"},children:[i.label,l&&h.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function K6(){const{currentUserId:t}=an(),[e,n]=D.useState([]),[i,a]=D.useState(!1);function l(b,T){n(w=>w.map(A=>A.name===b?{...A,...T}:A))}async function c(){a(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await d("Read unauthorized budget",async()=>(await Re("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0),await d("Read another user's document",async()=>(await Re("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0),await d("Read unauthorized budget month",async()=>(await Re("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0),await d("Toggle is_admin in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:T}=await Re("users",t,"security test: reading own user to get current is_admin value"),w=T?.permission_flags?.is_admin??!1;return await Wd("users",t,{"permission_flags.is_admin":!w},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${w} to ${!w} (SECURITY ISSUE!)`},!0),await d("Toggle is_test in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:T}=await Re("users",t,"security test: reading own user to get current is_test value"),w=T?.permission_flags?.is_test??!1;return await Wd("users",t,{"permission_flags.is_test":!w},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${w} to ${!w} (SECURITY ISSUE!)`},!0),await d("Read own user document",async()=>{if(!t)throw new Error("Not authenticated");const{exists:T}=await Re("users",t,"security test: reading own user document (should succeed)");if(T)return"Successfully read own document";throw new Error("Document does not exist")},!1),a(!1)}async function d(b,T,w){l(b,{status:"running",message:"Running..."});try{const A=await T();w?l(b,{status:"failed",message:` ${A}`}):l(b,{status:"passed",message:` ${A}`})}catch(A){const I=A instanceof Error?A.message:"Unknown error";w?l(b,{status:"passed",message:` Blocked as expected: ${I}`}):l(b,{status:"failed",message:` ${I}`})}}async function f(b){switch(e.find(w=>w.name===b)||n(w=>[...w,{name:b,status:"pending",message:"",expectedToFail:!0}]),a(!0),b){case"Read unauthorized budget":await d(b,async()=>(await Re("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0);break;case"Read another user's document":await d(b,async()=>(await Re("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0);break;case"Read unauthorized budget month":await d(b,async()=>(await Re("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0);break;case"Toggle is_admin in own permission_flags":await d(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Re("users",t,"security test: reading own user to get current is_admin value"),A=w?.permission_flags?.is_admin??!1;return await Wd("users",t,{"permission_flags.is_admin":!A},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${A} to ${!A} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await d(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Re("users",t,"security test: reading own user to get current is_test value"),A=w?.permission_flags?.is_test??!1;return await Wd("users",t,{"permission_flags.is_test":!A},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${A} to ${!A} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await d(b,async()=>{if(!t)throw new Error("Not authenticated");const{exists:w}=await Re("users",t,"security test: reading own user document (should succeed)");if(w)return"Successfully read own document";throw new Error("Document does not exist")},!1);break}a(!1)}const p=e.filter(b=>b.status==="passed").length,_=e.filter(b=>b.status==="failed").length,v=e.length;return h.jsxs("div",{children:[h.jsx("p",{style:mf,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),h.jsx("div",{style:{marginBottom:"1.5rem"},children:h.jsx(Ne,{onClick:c,disabled:i,variant:"primary",children:i?"Running Tests...":"Run All Tests"})}),e.length>0&&h.jsx("div",{style:{marginBottom:"1.5rem"},children:h.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[h.jsxs("span",{children:["Total: ",h.jsx("strong",{children:v})]}),h.jsxs("span",{style:{color:_e.success},children:["Passed: ",h.jsx("strong",{children:p})]}),h.jsxs("span",{style:{color:_e.danger},children:["Failed: ",h.jsx("strong",{children:_})]})]})}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[h.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),h.jsx(Oo,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read unauthorized budget"),onRun:()=>f("Read unauthorized budget"),disabled:i}),h.jsx(Oo,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read another user's document"),onRun:()=>f("Read another user's document"),disabled:i}),h.jsx(Oo,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(b=>b.name==="Read unauthorized budget month"),onRun:()=>f("Read unauthorized budget month"),disabled:i}),h.jsx(Oo,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_admin in own permission_flags"),onRun:()=>f("Toggle is_admin in own permission_flags"),disabled:i}),h.jsx(Oo,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_test in own permission_flags"),onRun:()=>f("Toggle is_test in own permission_flags"),disabled:i}),h.jsx(Oo,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(b=>b.name==="Read own user document"),onRun:()=>f("Read own user document"),disabled:i,expectedToSucceed:!0})]}),_>0&&h.jsxs(bl,{style:{marginTop:"1.5rem"},children:[" ",_," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function Oo({name:t,description:e,expectedBehavior:n,result:i,onRun:a,disabled:l,expectedToSucceed:c}){const d=i?.status==="passed"?_e.success:i?.status==="failed"?_e.danger:i?.status==="running"?_e.warning:"inherit";return h.jsxs("div",{style:{...hu,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),h.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),h.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:c?_e.success:_e.warning},children:["Expected: ",n]})]}),h.jsx(Ne,{onClick:a,disabled:l,variant:"secondary",style:{flexShrink:0},children:i?.status==="running"?"":"Run"})]}),i&&i.status!=="pending"&&h.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${d} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${d} 30%, transparent)`,fontSize:"0.85rem",color:d},children:i.message})]})}function $6(){const{selectedBudgetId:t,currentUserId:e,accessibleBudgets:n,loadAccessibleBudgets:i,switchToBudget:a,checkBudgetInvite:l,isInitialized:c}=an(),{budget:d,renameBudget:f,acceptInvite:p,isLoading:_}=Tn(t,e),[v,b]=D.useState(null),[T,w]=D.useState(null),[A,I]=D.useState(null),[P,G]=D.useState(null),[Q,X]=D.useState(null),[Z,oe]=D.useState(""),[O,C]=D.useState(!1),[R,N]=D.useState(""),[j,U]=D.useState(!1),[M,W]=D.useState(null);async function H(ee){if(ee!==d?.id){b(ee),I(null),G(null);try{await a(ee),G("Switched to budget successfully!"),await i()}catch(ce){I(ce instanceof Error?ce.message:"Failed to switch budget")}finally{b(null)}}}async function B(ee){w(ee),I(null),G(null);try{await p(ee),G("Invitation accepted! You now have access to this budget."),await i()}catch(ce){I(ce instanceof Error?ce.message:"Failed to accept invitation")}finally{w(null)}}async function z(ee){if(ee.preventDefault(),!!R.trim()){U(!0),I(null),W(null);try{const ce=await l(R.trim());ce?W(ce):I("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(ce){I(ce instanceof Error?ce.message:"Failed to check invitation")}finally{U(!1)}}}async function F(){if(M){w(M.budgetId),I(null);try{await p(M.budgetId),G(`Successfully joined "${M.budgetName}"!`),W(null),N(""),await i()}catch(ee){I(ee instanceof Error?ee.message:"Failed to accept invitation")}finally{w(null)}}}function $(ee,ce){oe(ce),X(ee)}function te(){X(null),oe("")}async function V(ee){if(ee.preventDefault(),!(!Z.trim()||!Q)){C(!0),I(null),G(null);try{await f(Z.trim()),G("Budget renamed successfully!"),X(null),await i()}catch(ce){I(ce instanceof Error?ce.message:"Failed to rename budget")}finally{C(!1)}}}const q=n.filter(ee=>!ee.isPending),ne=n.filter(ee=>ee.isPending);return _||!c?h.jsx(Ko,{children:h.jsx("p",{children:"Loading your budgets..."})}):h.jsxs(Ko,{children:[h.jsx(ci,{title:"My Budgets"}),h.jsx("h1",{children:"My Budgets"}),h.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Switch between budgets, accept invitations, or join a budget by ID."}),A&&h.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:A}),h.jsx("button",{onClick:()=>I(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),P&&h.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:P}),h.jsx("button",{onClick:()=>G(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),ne.length>0&&h.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[h.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""})," Pending Invitations (",ne.length,")"]}),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:ne.map(ee=>h.jsx(bx,{budget:ee,isCurrent:!1,isAccepting:T===ee.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>B(ee.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},ee.id))})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[h.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""})," Your Budgets (",q.length,")"]}),q.length===0?h.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:q.map(ee=>{const ce=ee.id===d?.id,be=Q===ee.id;return h.jsx(bx,{budget:ee,isCurrent:ce,isAccepting:!1,isSwitching:v===ee.id,isEditing:be,editName:be?Z:"",isRenaming:O,onAccept:()=>{},onSwitch:()=>H(ee.id),onStartEdit:()=>$(ee.id,ee.name),onCancelEdit:te,onEditNameChange:oe,onSaveEdit:V},ee.id)})})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[h.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""})," Join Budget by ID"]}),h.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),M?h.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[h.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[h.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:M.budgetName}),M.ownerEmail&&h.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",M.ownerEmail]})]}),h.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[h.jsx("button",{onClick:F,disabled:T===M.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:T===M.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:T===M.budgetId?.7:1},children:T===M.budgetId?"Accepting...":"Accept Invitation"}),h.jsx("button",{onClick:()=>{W(null),N("")},disabled:T===M.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:T===M.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:T===M.budgetId?.7:.8},children:"Cancel"})]})]}):h.jsxs("form",{onSubmit:z,style:{display:"flex",gap:"0.75rem"},children:[h.jsx("input",{type:"text",value:R,onChange:ee=>N(ee.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),h.jsx("button",{type:"submit",disabled:j||!R.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:j||!R.trim()?"not-allowed":"pointer",fontWeight:500,opacity:j||!R.trim()?.7:1,whiteSpace:"nowrap"},children:j?"Checking...":"Check Invite"})]})]}),e&&h.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[h.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),h.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:e})]})]})}function W6({children:t}){const e=D.useContext(Jc),n=Pn();return e.is_auth_checked?e.is_logged_in?t?h.jsx(h.Fragment,{children:t}):h.jsx(Uh,{}):h.jsx(jg,{to:"/account",state:{from:n.pathname},replace:!0}):h.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:h.jsx("p",{children:"Loading..."})})}function Y6(){const{selectedBudgetId:t,currentUserId:e,isInitialized:n}=an(),{isLoading:i,error:a}=Tn(t,e);return n?a?(console.error("[BudgetLayout] Error:",a),h.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:h.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",a.message]})})):h.jsx("div",{style:{paddingBottom:"5rem"},children:h.jsx(Uh,{})}):h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx("p",{children:"Loading budget..."}),i&&h.jsx("p",{style:{opacity:.6},children:"Fetching data from server..."})]})}const X6={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function J6(){const[t,e]=D.useState(X6),n=Ba(),i=D.useRef(!1);return D.useEffect(function(){i.current||(i.current=!0,n.set_user_listener(a=>{e({is_logged_in:a!=null,is_auth_checked:!0,username:a?.email??"",set_user_context:e})}))},[n]),t.is_auth_checked?h.jsx(Jc.Provider,{value:t,children:h.jsx(nD,{children:h.jsx(yN,{children:h.jsxs(KC,{children:[h.jsxs(SC,{children:[h.jsx(Yt,{path:"/",element:h.jsx(_N,{})}),h.jsx(Yt,{path:"/account",element:h.jsx(JN,{})}),h.jsx(Yt,{path:"/sql-test",element:h.jsx(XN,{})}),h.jsx(Yt,{path:"/budget",element:h.jsx(W6,{}),children:h.jsxs(Yt,{element:h.jsx(Y6,{}),children:[h.jsx(Yt,{index:!0,element:h.jsx(_x,{})}),h.jsx(Yt,{path:":year/:month/:tab",element:h.jsx(_x,{})}),h.jsx(Yt,{path:"analytics",element:h.jsx(x6,{})}),h.jsx(Yt,{path:"my-budgets",element:h.jsx($6,{})}),h.jsxs(Yt,{path:"settings",element:h.jsx(k6,{}),children:[h.jsx(Yt,{path:"accounts",element:h.jsx(D6,{})}),h.jsx(Yt,{path:"categories",element:h.jsx(O6,{})}),h.jsx(Yt,{path:"users",element:h.jsx(N6,{})})]}),h.jsxs(Yt,{path:"admin",element:h.jsx(L6,{}),children:[h.jsx(Yt,{path:"budget",element:h.jsx(V6,{})}),h.jsx(Yt,{path:"feedback",element:h.jsx(H6,{})}),h.jsx(Yt,{path:"migration",element:h.jsx(G6,{})}),h.jsx(Yt,{path:"tests",element:h.jsx(K6,{})})]})]})})]}),h.jsx(GN,{})]})})})}):h.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:h.jsx("p",{children:"Loading..."})})}SA.createRoot(document.getElementById("root")).render(h.jsx(D.StrictMode,{children:h.jsx(J6,{})}));
