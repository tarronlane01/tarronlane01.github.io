(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var gp={exports:{}},Tc={};var db;function wA(){if(db)return Tc;db=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var d in a)d!=="key"&&(l[d]=a[d])}else l=a;return a=l.ref,{$$typeof:t,type:i,key:c,ref:a!==void 0?a:null,props:l}}return Tc.Fragment=e,Tc.jsx=n,Tc.jsxs=n,Tc}var hb;function TA(){return hb||(hb=1,gp.exports=wA()),gp.exports}var h=TA(),yp={exports:{}},Ve={};var fb;function AA(){if(fb)return Ve;fb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),b=Symbol.iterator;function T(L){return L===null||typeof L!="object"?null:(L=b&&L[b]||L["@@iterator"],typeof L=="function"?L:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,R={};function z(L,G,ce){this.props=L,this.context=G,this.refs=R,this.updater=ce||S}z.prototype.isReactComponent={},z.prototype.setState=function(L,G){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,G,"setState")},z.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function F(){}F.prototype=z.prototype;function U(L,G,ce){this.props=L,this.context=G,this.refs=R,this.updater=ce||S}var X=U.prototype=new F;X.constructor=U,A(X,z.prototype),X.isPureReactComponent=!0;var Z=Array.isArray;function oe(){}var M={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function D(L,G,ce){var J=ce.ref;return{$$typeof:t,type:L,key:G,ref:J!==void 0?J:null,props:ce}}function N(L,G){return D(L.type,G,L.props)}function j(L){return typeof L=="object"&&L!==null&&L.$$typeof===t}function B(L){var G={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(ce){return G[ce]})}var O=/\/+/g;function Y(L,G){return typeof L=="object"&&L!==null&&L.key!=null?B(""+L.key):G.toString(36)}function q(L){switch(L.status){case"fulfilled":return L.value;case"rejected":throw L.reason;default:switch(typeof L.status=="string"?L.then(oe,oe):(L.status="pending",L.then(function(G){L.status==="pending"&&(L.status="fulfilled",L.value=G)},function(G){L.status==="pending"&&(L.status="rejected",L.reason=G)})),L.status){case"fulfilled":return L.value;case"rejected":throw L.reason}}throw L}function P(L,G,ce,J,ie){var _e=typeof L;(_e==="undefined"||_e==="boolean")&&(L=null);var Ee=!1;if(L===null)Ee=!0;else switch(_e){case"bigint":case"string":case"number":Ee=!0;break;case"object":switch(L.$$typeof){case t:case e:Ee=!0;break;case _:return Ee=L._init,P(Ee(L._payload),G,ce,J,ie)}}if(Ee)return ie=ie(L),Ee=J===""?"."+Y(L,0):J,Z(ie)?(ce="",Ee!=null&&(ce=Ee.replace(O,"$&/")+"/"),P(ie,G,ce,"",function(he){return he})):ie!=null&&(j(ie)&&(ie=N(ie,ce+(ie.key==null||L&&L.key===ie.key?"":(""+ie.key).replace(O,"$&/")+"/")+Ee)),G.push(ie)),1;Ee=0;var be=J===""?".":J+":";if(Z(L))for(var xe=0;xe<L.length;xe++)J=L[xe],_e=be+Y(J,xe),Ee+=P(J,G,ce,_e,ie);else if(xe=T(L),typeof xe=="function")for(L=xe.call(L),xe=0;!(J=L.next()).done;)J=J.value,_e=be+Y(J,xe++),Ee+=P(J,G,ce,_e,ie);else if(_e==="object"){if(typeof L.then=="function")return P(q(L),G,ce,J,ie);throw G=String(L),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return Ee}function Q(L,G,ce){if(L==null)return L;var J=[],ie=0;return P(L,J,"","",function(_e){return G.call(ce,_e,ie++)}),J}function H(L){if(L._status===-1){var G=L._result;G=G(),G.then(function(ce){(L._status===0||L._status===-1)&&(L._status=1,L._result=ce)},function(ce){(L._status===0||L._status===-1)&&(L._status=2,L._result=ce)}),L._status===-1&&(L._status=0,L._result=G)}if(L._status===1)return L._result.default;throw L._result}var K=typeof reportError=="function"?reportError:function(L){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof L=="object"&&L!==null&&typeof L.message=="string"?String(L.message):String(L),error:L});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",L);return}console.error(L)},te={map:Q,forEach:function(L,G,ce){Q(L,function(){G.apply(this,arguments)},ce)},count:function(L){var G=0;return Q(L,function(){G++}),G},toArray:function(L){return Q(L,function(G){return G})||[]},only:function(L){if(!j(L))throw Error("React.Children.only expected to receive a single React element child.");return L}};return Ve.Activity=v,Ve.Children=te,Ve.Component=z,Ve.Fragment=n,Ve.Profiler=a,Ve.PureComponent=U,Ve.StrictMode=i,Ve.Suspense=f,Ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Ve.__COMPILER_RUNTIME={__proto__:null,c:function(L){return M.H.useMemoCache(L)}},Ve.cache=function(L){return function(){return L.apply(null,arguments)}},Ve.cacheSignal=function(){return null},Ve.cloneElement=function(L,G,ce){if(L==null)throw Error("The argument must be a React element, but you passed "+L+".");var J=A({},L.props),ie=L.key;if(G!=null)for(_e in G.key!==void 0&&(ie=""+G.key),G)!C.call(G,_e)||_e==="key"||_e==="__self"||_e==="__source"||_e==="ref"&&G.ref===void 0||(J[_e]=G[_e]);var _e=arguments.length-2;if(_e===1)J.children=ce;else if(1<_e){for(var Ee=Array(_e),be=0;be<_e;be++)Ee[be]=arguments[be+2];J.children=Ee}return D(L.type,ie,J)},Ve.createContext=function(L){return L={$$typeof:c,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null},L.Provider=L,L.Consumer={$$typeof:l,_context:L},L},Ve.createElement=function(L,G,ce){var J,ie={},_e=null;if(G!=null)for(J in G.key!==void 0&&(_e=""+G.key),G)C.call(G,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(ie[J]=G[J]);var Ee=arguments.length-2;if(Ee===1)ie.children=ce;else if(1<Ee){for(var be=Array(Ee),xe=0;xe<Ee;xe++)be[xe]=arguments[xe+2];ie.children=be}if(L&&L.defaultProps)for(J in Ee=L.defaultProps,Ee)ie[J]===void 0&&(ie[J]=Ee[J]);return D(L,_e,ie)},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(L){return{$$typeof:d,render:L}},Ve.isValidElement=j,Ve.lazy=function(L){return{$$typeof:_,_payload:{_status:-1,_result:L},_init:H}},Ve.memo=function(L,G){return{$$typeof:p,type:L,compare:G===void 0?null:G}},Ve.startTransition=function(L){var G=M.T,ce={};M.T=ce;try{var J=L(),ie=M.S;ie!==null&&ie(ce,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(oe,K)}catch(_e){K(_e)}finally{G!==null&&ce.types!==null&&(G.types=ce.types),M.T=G}},Ve.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},Ve.use=function(L){return M.H.use(L)},Ve.useActionState=function(L,G,ce){return M.H.useActionState(L,G,ce)},Ve.useCallback=function(L,G){return M.H.useCallback(L,G)},Ve.useContext=function(L){return M.H.useContext(L)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(L,G){return M.H.useDeferredValue(L,G)},Ve.useEffect=function(L,G){return M.H.useEffect(L,G)},Ve.useEffectEvent=function(L){return M.H.useEffectEvent(L)},Ve.useId=function(){return M.H.useId()},Ve.useImperativeHandle=function(L,G,ce){return M.H.useImperativeHandle(L,G,ce)},Ve.useInsertionEffect=function(L,G){return M.H.useInsertionEffect(L,G)},Ve.useLayoutEffect=function(L,G){return M.H.useLayoutEffect(L,G)},Ve.useMemo=function(L,G){return M.H.useMemo(L,G)},Ve.useOptimistic=function(L,G){return M.H.useOptimistic(L,G)},Ve.useReducer=function(L,G,ce){return M.H.useReducer(L,G,ce)},Ve.useRef=function(L){return M.H.useRef(L)},Ve.useState=function(L){return M.H.useState(L)},Ve.useSyncExternalStore=function(L,G,ce){return M.H.useSyncExternalStore(L,G,ce)},Ve.useTransition=function(){return M.H.useTransition()},Ve.version="19.2.3",Ve}var mb;function Dg(){return mb||(mb=1,yp.exports=AA()),yp.exports}var I=Dg(),_p={exports:{}},Ac={},vp={exports:{}},bp={};var pb;function CA(){return pb||(pb=1,(function(t){function e(P,Q){var H=P.length;P.push(Q);e:for(;0<H;){var K=H-1>>>1,te=P[K];if(0<a(te,Q))P[K]=Q,P[H]=te,H=K;else break e}}function n(P){return P.length===0?null:P[0]}function i(P){if(P.length===0)return null;var Q=P[0],H=P.pop();if(H!==Q){P[0]=H;e:for(var K=0,te=P.length,L=te>>>1;K<L;){var G=2*(K+1)-1,ce=P[G],J=G+1,ie=P[J];if(0>a(ce,H))J<te&&0>a(ie,ce)?(P[K]=ie,P[J]=H,K=J):(P[K]=ce,P[G]=H,K=G);else if(J<te&&0>a(ie,H))P[K]=ie,P[J]=H,K=J;else break e}}return Q}function a(P,Q){var H=P.sortIndex-Q.sortIndex;return H!==0?H:P.id-Q.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var f=[],p=[],_=1,v=null,b=3,T=!1,S=!1,A=!1,R=!1,z=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;function X(P){for(var Q=n(p);Q!==null;){if(Q.callback===null)i(p);else if(Q.startTime<=P)i(p),Q.sortIndex=Q.expirationTime,e(f,Q);else break;Q=n(p)}}function Z(P){if(A=!1,X(P),!S)if(n(f)!==null)S=!0,oe||(oe=!0,B());else{var Q=n(p);Q!==null&&q(Z,Q.startTime-P)}}var oe=!1,M=-1,C=5,D=-1;function N(){return R?!0:!(t.unstable_now()-D<C)}function j(){if(R=!1,oe){var P=t.unstable_now();D=P;var Q=!0;try{e:{S=!1,A&&(A=!1,F(M),M=-1),T=!0;var H=b;try{t:{for(X(P),v=n(f);v!==null&&!(v.expirationTime>P&&N());){var K=v.callback;if(typeof K=="function"){v.callback=null,b=v.priorityLevel;var te=K(v.expirationTime<=P);if(P=t.unstable_now(),typeof te=="function"){v.callback=te,X(P),Q=!0;break t}v===n(f)&&i(f),X(P)}else i(f);v=n(f)}if(v!==null)Q=!0;else{var L=n(p);L!==null&&q(Z,L.startTime-P),Q=!1}}break e}finally{v=null,b=H,T=!1}Q=void 0}}finally{Q?B():oe=!1}}}var B;if(typeof U=="function")B=function(){U(j)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,Y=O.port2;O.port1.onmessage=j,B=function(){Y.postMessage(null)}}else B=function(){z(j,0)};function q(P,Q){M=z(function(){P(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_next=function(P){switch(b){case 1:case 2:case 3:var Q=3;break;default:Q=b}var H=b;b=Q;try{return P()}finally{b=H}},t.unstable_requestPaint=function(){R=!0},t.unstable_runWithPriority=function(P,Q){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var H=b;b=P;try{return Q()}finally{b=H}},t.unstable_scheduleCallback=function(P,Q,H){var K=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?K+H:K):H=K,P){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=H+te,P={id:_++,callback:Q,priorityLevel:P,startTime:H,expirationTime:te,sortIndex:-1},H>K?(P.sortIndex=H,e(p,P),n(f)===null&&P===n(p)&&(A?(F(M),M=-1):A=!0,q(Z,H-K))):(P.sortIndex=te,e(f,P),S||T||(S=!0,oe||(oe=!0,B()))),P},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(P){var Q=b;return function(){var H=b;b=Q;try{return P.apply(this,arguments)}finally{b=H}}}})(bp)),bp}var gb;function RA(){return gb||(gb=1,vp.exports=CA()),vp.exports}var Ep={exports:{}},vn={};var yb;function DA(){if(yb)return vn;yb=1;var t=Dg();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(f,p,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:f,containerInfo:p,implementation:_}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,vn.createPortal=function(f,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return l(f,p,null,_)},vn.flushSync=function(f){var p=c.T,_=i.p;try{if(c.T=null,i.p=2,f)return f()}finally{c.T=p,i.p=_,i.d.f()}},vn.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(f,p))},vn.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},vn.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var _=p.as,v=d(_,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,T=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;_==="style"?i.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:T}):_==="script"&&i.d.X(f,{crossOrigin:v,integrity:b,fetchPriority:T,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},vn.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var _=d(p.as,p.crossOrigin);i.d.M(f,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(f)},vn.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var _=p.as,v=d(_,p.crossOrigin);i.d.L(f,_,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},vn.preloadModule=function(f,p){if(typeof f=="string")if(p){var _=d(p.as,p.crossOrigin);i.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(f)},vn.requestFormReset=function(f){i.d.r(f)},vn.unstable_batchedUpdates=function(f,p){return f(p)},vn.useFormState=function(f,p,_){return c.H.useFormState(f,p,_)},vn.useFormStatus=function(){return c.H.useHostTransitionStatus()},vn.version="19.2.3",vn}var _b;function IA(){if(_b)return Ep.exports;_b=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Ep.exports=DA(),Ep.exports}var vb;function jA(){if(vb)return Ac;vb=1;var t=RA(),e=Dg(),n=IA();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var s=r,o=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(o=s.return),r=s.return;while(r)}return s.tag===3?o:null}function c(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function d(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function f(r){if(l(r)!==r)throw Error(i(188))}function p(r){var s=r.alternate;if(!s){if(s=l(r),s===null)throw Error(i(188));return s!==r?null:r}for(var o=r,u=s;;){var g=o.return;if(g===null)break;var y=g.alternate;if(y===null){if(u=g.return,u!==null){o=u;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===o)return f(g),r;if(y===u)return f(g),s;y=y.sibling}throw Error(i(188))}if(o.return!==u.return)o=g,u=y;else{for(var x=!1,k=g.child;k;){if(k===o){x=!0,o=g,u=y;break}if(k===u){x=!0,u=g,o=y;break}k=k.sibling}if(!x){for(k=y.child;k;){if(k===o){x=!0,o=y,u=g;break}if(k===u){x=!0,u=y,o=g;break}k=k.sibling}if(!x)throw Error(i(189))}}if(o.alternate!==u)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?r:s}function _(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=_(r),s!==null)return s;r=r.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),U=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),N=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function B(r){return r===null||typeof r!="object"?null:(r=j&&r[j]||r["@@iterator"],typeof r=="function"?r:null)}var O=Symbol.for("react.client.reference");function Y(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===O?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case A:return"Fragment";case z:return"Profiler";case R:return"StrictMode";case Z:return"Suspense";case oe:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case S:return"Portal";case U:return r.displayName||"Context";case F:return(r._context.displayName||"Context")+".Consumer";case X:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case M:return s=r.displayName||null,s!==null?s:Y(r.type)||"Memo";case C:s=r._payload,r=r._init;try{return Y(r(s))}catch{}}return null}var q=Array.isArray,P=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H={pending:!1,data:null,method:null,action:null},K=[],te=-1;function L(r){return{current:r}}function G(r){0>te||(r.current=K[te],K[te]=null,te--)}function ce(r,s){te++,K[te]=r.current,r.current=s}var J=L(null),ie=L(null),_e=L(null),Ee=L(null);function be(r,s){switch(ce(_e,s),ce(ie,r),ce(J,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?kv(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=kv(s),r=Nv(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}G(J),ce(J,r)}function xe(){G(J),G(ie),G(_e)}function he(r){r.memoizedState!==null&&ce(Ee,r);var s=J.current,o=Nv(s,r.type);s!==o&&(ce(ie,r),ce(J,o))}function nt(r){ie.current===r&&(G(J),G(ie)),Ee.current===r&&(G(Ee),Ec._currentValue=H)}var Fe,ln;function en(r){if(Fe===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Fe=s&&s[1]||"",ln=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Fe+r+ln}var Or=!1;function Mr(r,s){if(!r||Or)return"";Or=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var pe=function(){throw Error()};if(Object.defineProperty(pe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pe,[])}catch(de){var le=de}Reflect.construct(r,[],pe)}else{try{pe.call()}catch(de){le=de}r.call(pe.prototype)}}else{try{throw Error()}catch(de){le=de}(pe=r())&&typeof pe.catch=="function"&&pe.catch(function(){})}}catch(de){if(de&&le&&typeof de.stack=="string")return[de.stack,le.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),x=y[0],k=y[1];if(x&&k){var $=x.split(`
`),ae=k.split(`
`);for(g=u=0;u<$.length&&!$[u].includes("DetermineComponentFrameRoot");)u++;for(;g<ae.length&&!ae[g].includes("DetermineComponentFrameRoot");)g++;if(u===$.length||g===ae.length)for(u=$.length-1,g=ae.length-1;1<=u&&0<=g&&$[u]!==ae[g];)g--;for(;1<=u&&0<=g;u--,g--)if($[u]!==ae[g]){if(u!==1||g!==1)do if(u--,g--,0>g||$[u]!==ae[g]){var fe=`
`+$[u].replace(" at new "," at ");return r.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",r.displayName)),fe}while(1<=u&&0<=g);break}}}finally{Or=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?en(o):""}function Ws(r,s){switch(r.tag){case 26:case 27:case 5:return en(r.type);case 16:return en("Lazy");case 13:return r.child!==s&&s!==null?en("Suspense Fallback"):en("Suspense");case 19:return en("SuspenseList");case 0:case 15:return Mr(r.type,!1);case 11:return Mr(r.type.render,!1);case 1:return Mr(r.type,!0);case 31:return en("Activity");default:return""}}function Ct(r){try{var s="",o=null;do s+=Ws(r,o),o=r,r=r.return;while(r);return s}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var st=Object.prototype.hasOwnProperty,St=t.unstable_scheduleCallback,Yn=t.unstable_cancelCallback,Sl=t.unstable_shouldYield,fr=t.unstable_requestPaint,Yt=t.unstable_now,Xs=t.unstable_getCurrentPriorityLevel,wl=t.unstable_ImmediatePriority,Tl=t.unstable_UserBlockingPriority,Hi=t.unstable_NormalPriority,vf=t.unstable_LowPriority,gu=t.unstable_IdlePriority,yu=t.log,_u=t.unstable_setDisableYieldValue,mr=null,cn=null;function Wn(r){if(typeof yu=="function"&&_u(r),cn&&typeof cn.setStrictMode=="function")try{cn.setStrictMode(mr,r)}catch{}}var It=Math.clz32?Math.clz32:bu,vu=Math.log,Ua=Math.LN2;function bu(r){return r>>>=0,r===0?32:31-(vu(r)/Ua|0)|0}var kr=256,Js=262144,Pt=4194304;function Nr(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Pr(r,s,o){var u=r.pendingLanes;if(u===0)return 0;var g=0,y=r.suspendedLanes,x=r.pingedLanes;r=r.warmLanes;var k=u&134217727;return k!==0?(u=k&~y,u!==0?g=Nr(u):(x&=k,x!==0?g=Nr(x):o||(o=k&~r,o!==0&&(g=Nr(o))))):(k=u&~y,k!==0?g=Nr(k):x!==0?g=Nr(x):o||(o=u&~r,o!==0&&(g=Nr(o)))),g===0?0:s!==0&&s!==g&&(s&y)===0&&(y=g&-g,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:g}function pr(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function bf(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Eu(){var r=Pt;return Pt<<=1,(Pt&62914560)===0&&(Pt=4194304),r}function Vr(r){for(var s=[],o=0;31>o;o++)s.push(r);return s}function Zs(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Ef(r,s,o,u,g,y){var x=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var k=r.entanglements,$=r.expirationTimes,ae=r.hiddenUpdates;for(o=x&~o;0<o;){var fe=31-It(o),pe=1<<fe;k[fe]=0,$[fe]=-1;var le=ae[fe];if(le!==null)for(ae[fe]=null,fe=0;fe<le.length;fe++){var de=le[fe];de!==null&&(de.lane&=-536870913)}o&=~pe}u!==0&&ea(r,u,0),y!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=y&~(x&~s))}function ea(r,s,o){r.pendingLanes|=s,r.suspendedLanes&=~s;var u=31-It(s);r.entangledLanes|=s,r.entanglements[u]=r.entanglements[u]|1073741824|o&261930}function Al(r,s){var o=r.entangledLanes|=s;for(r=r.entanglements;o;){var u=31-It(o),g=1<<u;g&s|r[u]&s&&(r[u]|=s),o&=~g}}function Cl(r,s){var o=s&-s;return o=(o&42)!==0?1:ta(o),(o&(r.suspendedLanes|s))!==0?0:o}function ta(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function mi(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function xu(){var r=Q.p;return r!==0?r:(r=window.event,r===void 0?32:ib(r.type))}function gr(r,s){var o=Q.p;try{return Q.p=r,s()}finally{Q.p=o}}var yr=Math.random().toString(36).slice(2),Vt="__reactFiber$"+yr,tn="__reactProps$"+yr,Lr="__reactContainer$"+yr,Fa="__reactEvents$"+yr,xf="__reactListeners$"+yr,Su="__reactHandles$"+yr,wu="__reactResources$"+yr,Br="__reactMarker$"+yr;function qa(r){delete r[Vt],delete r[tn],delete r[Fa],delete r[xf],delete r[Su]}function zr(r){var s=r[Vt];if(s)return s;for(var o=r.parentNode;o;){if(s=o[Lr]||o[Vt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(r=Fv(r);r!==null;){if(o=r[Vt])return o;r=Fv(r)}return s}r=o,o=r.parentNode}return null}function Xn(r){if(r=r[Vt]||r[Lr]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function Ln(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function Ur(r){var s=r[wu];return s||(s=r[wu]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Lt(r){r[Br]=!0}var Rl=new Set,Dl={};function Fr(r,s){qr(r,s),qr(r+"Capture",s)}function qr(r,s){for(Dl[r]=s,r=0;r<s.length;r++)Rl.add(s[r])}var Il=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),jl={},Ol={};function Tu(r){return st.call(Ol,r)?!0:st.call(jl,r)?!1:Il.test(r)?Ol[r]=!0:(jl[r]=!0,!1)}function Qa(r,s,o){if(Tu(s))if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+o)}}function Bn(r,s,o){if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+o)}}function Bt(r,s,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(s,o,""+u)}}function nn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function $i(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ml(r,s,o){var u=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,y=u.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return g.call(this)},set:function(x){o=""+x,y.call(this,x)}}),Object.defineProperty(r,s,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(x){o=""+x},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function ot(r){if(!r._valueTracker){var s=$i(r)?"checked":"value";r._valueTracker=Ml(r,s,""+r[s])}}function na(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var o=s.getValue(),u="";return r&&(u=$i(r)?r.checked?"true":"false":r.value),r=u,r!==o?(s.setValue(r),!0):!1}function Qr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var ra=/[\n"\\]/g;function Cn(r){return r.replace(ra,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ga(r,s,o,u,g,y,x,k){r.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?r.type=x:r.removeAttribute("type"),s!=null?x==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+nn(s)):r.value!==""+nn(s)&&(r.value=""+nn(s)):x!=="submit"&&x!=="reset"||r.removeAttribute("value"),s!=null?kl(r,x,nn(s)):o!=null?kl(r,x,nn(o)):u!=null&&r.removeAttribute("value"),g==null&&y!=null&&(r.defaultChecked=!!y),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?r.name=""+nn(k):r.removeAttribute("name")}function Au(r,s,o,u,g,y,x,k){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ot(r);return}o=o!=null?""+nn(o):"",s=s!=null?""+nn(s):o,k||s===r.value||(r.value=s),r.defaultValue=s}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=k?r.checked:!!u,r.defaultChecked=!!u,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(r.name=x),ot(r)}function kl(r,s,o){s==="number"&&Qr(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function Ki(r,s,o,u){if(r=r.options,s){s={};for(var g=0;g<o.length;g++)s["$"+o[g]]=!0;for(o=0;o<r.length;o++)g=s.hasOwnProperty("$"+r[o].value),r[o].selected!==g&&(r[o].selected=g),g&&u&&(r[o].defaultSelected=!0)}else{for(o=""+nn(o),s=null,g=0;g<r.length;g++){if(r[g].value===o){r[g].selected=!0,u&&(r[g].defaultSelected=!0);return}s!==null||r[g].disabled||(s=r[g])}s!==null&&(s.selected=!0)}}function Cu(r,s,o){if(s!=null&&(s=""+nn(s),s!==r.value&&(r.value=s),o==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=o!=null?""+nn(o):""}function Yi(r,s,o,u){if(s==null){if(u!=null){if(o!=null)throw Error(i(92));if(q(u)){if(1<u.length)throw Error(i(93));u=u[0]}o=u}o==null&&(o=""),s=o}o=nn(s),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u),ot(r)}function Rn(r,s){if(s){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=s;return}}r.textContent=s}var Ru=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nl(r,s,o){var u=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":u?r.setProperty(s,o):typeof o!="number"||o===0||Ru.has(s)?s==="float"?r.cssFloat=o:r[s]=(""+o).trim():r[s]=o+"px"}function Pl(r,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var g in s)u=s[g],s.hasOwnProperty(g)&&o[g]!==u&&Nl(r,g,u)}else for(var y in s)s.hasOwnProperty(y)&&Nl(r,y,s[y])}function Ha(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Du=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Wi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $a(r){return Wi.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function _r(){}var Vl=null;function Jn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Xi=null,Gr=null;function ia(r){var s=Xn(r);if(s&&(r=s.stateNode)){var o=r[tn]||null;e:switch(r=s.stateNode,s.type){case"input":if(Ga(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Cn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var u=o[s];if(u!==r&&u.form===r.form){var g=u[tn]||null;if(!g)throw Error(i(90));Ga(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<o.length;s++)u=o[s],u.form===r.form&&na(u)}break e;case"textarea":Cu(r,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&Ki(r,!!o.multiple,s,!1)}}}var Ka=!1;function Ji(r,s,o){if(Ka)return r(s,o);Ka=!0;try{var u=r(s);return u}finally{if(Ka=!1,(Xi!==null||Gr!==null)&&(xd(),Xi&&(s=Xi,r=Gr,Gr=Xi=null,ia(s),r)))for(s=0;s<r.length;s++)ia(r[s])}}function vr(r,s){var o=r.stateNode;if(o===null)return null;var u=o[tn]||null;if(u===null)return null;o=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sa=!1;if(Zn)try{var ut={};Object.defineProperty(ut,"passive",{get:function(){sa=!0}}),window.addEventListener("test",ut,ut),window.removeEventListener("test",ut,ut)}catch{sa=!1}var Hr=null,Ll=null,aa=null;function Bl(){if(aa)return aa;var r,s=Ll,o=s.length,u,g="value"in Hr?Hr.value:Hr.textContent,y=g.length;for(r=0;r<o&&s[r]===g[r];r++);var x=o-r;for(u=1;u<=x&&s[o-u]===g[y-u];u++);return aa=g.slice(r,1<u?1-u:void 0)}function oa(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function pi(){return!0}function br(){return!1}function un(r){function s(o,u,g,y,x){this._reactName=o,this._targetInst=g,this.type=u,this.nativeEvent=y,this.target=x,this.currentTarget=null;for(var k in r)r.hasOwnProperty(k)&&(o=r[k],this[k]=o?o(y):y[k]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?pi:br,this.isPropagationStopped=br,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=pi)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=pi)},persist:function(){},isPersistent:pi}),s}var gi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$r=un(gi),Zi=v({},gi,{view:0,detail:0}),zl=un(Zi),es,Ya,Kr,Wa=v({},Zi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ts,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Kr&&(Kr&&r.type==="mousemove"?(es=r.screenX-Kr.screenX,Ya=r.screenY-Kr.screenY):Ya=es=0,Kr=r),es)},movementY:function(r){return"movementY"in r?r.movementY:Ya}}),Ul=un(Wa),la=v({},Wa,{dataTransfer:0}),Iu=un(la),ju=v({},Zi,{relatedTarget:0}),ca=un(ju),Fl=v({},gi,{animationName:0,elapsedTime:0,pseudoElement:0}),Ou=un(Fl),Xa=v({},gi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Mu=un(Xa),ku=v({},gi,{data:0}),Yr=un(ku),Nu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Pu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lu(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=Vu[r])?!!s[r]:!1}function ts(){return Lu}var wn=v({},Zi,{key:function(r){if(r.key){var s=Nu[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=oa(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Pu[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ts,charCode:function(r){return r.type==="keypress"?oa(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?oa(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Bu=un(wn),zu=v({},Wa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yi=un(zu),m=v({},Zi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ts}),E=un(m),w=v({},gi,{propertyName:0,elapsedTime:0,pseudoElement:0}),V=un(w),re=v({},Wa,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),ue=un(re),Se=v({},gi,{newState:0,oldState:0}),Be=un(Se),jt=[9,13,27,32],rt=Zn&&"CompositionEvent"in window,bt=null;Zn&&"documentMode"in document&&(bt=document.documentMode);var er=Zn&&"TextEvent"in window&&!bt,Wr=Zn&&(!rt||bt&&8<bt&&11>=bt),Er=" ",xr=!1;function ua(r,s){switch(r){case"keyup":return jt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ja(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Za=!1;function KT(r,s){switch(r){case"compositionend":return Ja(s);case"keypress":return s.which!==32?null:(xr=!0,Er);case"textInput":return r=s.data,r===Er&&xr?null:r;default:return null}}function YT(r,s){if(Za)return r==="compositionend"||!rt&&ua(r,s)?(r=Bl(),aa=Ll=Hr=null,Za=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Wr&&s.locale!=="ko"?null:s.data;default:return null}}var WT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gy(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!WT[r.type]:s==="textarea"}function Hy(r,s,o,u){Xi?Gr?Gr.push(u):Gr=[u]:Xi=u,s=Dd(s,"onChange"),0<s.length&&(o=new $r("onChange","change",null,o,u),r.push({event:o,listeners:s}))}var ql=null,Ql=null;function XT(r){Rv(r,0)}function Uu(r){var s=Ln(r);if(na(s))return r}function $y(r,s){if(r==="change")return s}var Ky=!1;if(Zn){var Sf;if(Zn){var wf="oninput"in document;if(!wf){var Yy=document.createElement("div");Yy.setAttribute("oninput","return;"),wf=typeof Yy.oninput=="function"}Sf=wf}else Sf=!1;Ky=Sf&&(!document.documentMode||9<document.documentMode)}function Wy(){ql&&(ql.detachEvent("onpropertychange",Xy),Ql=ql=null)}function Xy(r){if(r.propertyName==="value"&&Uu(Ql)){var s=[];Hy(s,Ql,r,Jn(r)),Ji(XT,s)}}function JT(r,s,o){r==="focusin"?(Wy(),ql=s,Ql=o,ql.attachEvent("onpropertychange",Xy)):r==="focusout"&&Wy()}function ZT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Uu(Ql)}function e1(r,s){if(r==="click")return Uu(s)}function t1(r,s){if(r==="input"||r==="change")return Uu(s)}function n1(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var zn=typeof Object.is=="function"?Object.is:n1;function Gl(r,s){if(zn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var o=Object.keys(r),u=Object.keys(s);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var g=o[u];if(!st.call(s,g)||!zn(r[g],s[g]))return!1}return!0}function Jy(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Zy(r,s){var o=Jy(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=s&&u>=s)return{node:o,offset:s-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Jy(o)}}function e_(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?e_(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function t_(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=Qr(r.document);s instanceof r.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)r=s.contentWindow;else break;s=Qr(r.document)}return s}function Tf(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var r1=Zn&&"documentMode"in document&&11>=document.documentMode,eo=null,Af=null,Hl=null,Cf=!1;function n_(r,s,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Cf||eo==null||eo!==Qr(u)||(u=eo,"selectionStart"in u&&Tf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Hl&&Gl(Hl,u)||(Hl=u,u=Dd(Af,"onSelect"),0<u.length&&(s=new $r("onSelect","select",null,s,o),r.push({event:s,listeners:u}),s.target=eo)))}function da(r,s){var o={};return o[r.toLowerCase()]=s.toLowerCase(),o["Webkit"+r]="webkit"+s,o["Moz"+r]="moz"+s,o}var to={animationend:da("Animation","AnimationEnd"),animationiteration:da("Animation","AnimationIteration"),animationstart:da("Animation","AnimationStart"),transitionrun:da("Transition","TransitionRun"),transitionstart:da("Transition","TransitionStart"),transitioncancel:da("Transition","TransitionCancel"),transitionend:da("Transition","TransitionEnd")},Rf={},r_={};Zn&&(r_=document.createElement("div").style,"AnimationEvent"in window||(delete to.animationend.animation,delete to.animationiteration.animation,delete to.animationstart.animation),"TransitionEvent"in window||delete to.transitionend.transition);function ha(r){if(Rf[r])return Rf[r];if(!to[r])return r;var s=to[r],o;for(o in s)if(s.hasOwnProperty(o)&&o in r_)return Rf[r]=s[o];return r}var i_=ha("animationend"),s_=ha("animationiteration"),a_=ha("animationstart"),i1=ha("transitionrun"),s1=ha("transitionstart"),a1=ha("transitioncancel"),o_=ha("transitionend"),l_=new Map,Df="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Df.push("scrollEnd");function Sr(r,s){l_.set(r,s),Fr(s,[r])}var Fu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},tr=[],no=0,If=0;function qu(){for(var r=no,s=If=no=0;s<r;){var o=tr[s];tr[s++]=null;var u=tr[s];tr[s++]=null;var g=tr[s];tr[s++]=null;var y=tr[s];if(tr[s++]=null,u!==null&&g!==null){var x=u.pending;x===null?g.next=g:(g.next=x.next,x.next=g),u.pending=g}y!==0&&c_(o,g,y)}}function Qu(r,s,o,u){tr[no++]=r,tr[no++]=s,tr[no++]=o,tr[no++]=u,If|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function jf(r,s,o,u){return Qu(r,s,o,u),Gu(r)}function fa(r,s){return Qu(r,null,null,s),Gu(r)}function c_(r,s,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var g=!1,y=r.return;y!==null;)y.childLanes|=o,u=y.alternate,u!==null&&(u.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(g=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,g&&s!==null&&(g=31-It(o),r=y.hiddenUpdates,u=r[g],u===null?r[g]=[s]:u.push(s),s.lane=o|536870912),y):null}function Gu(r){if(50<mc)throw mc=0,zm=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var ro={};function o1(r,s,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(r,s,o,u){return new o1(r,s,o,u)}function Of(r){return r=r.prototype,!(!r||!r.isReactComponent)}function _i(r,s){var o=r.alternate;return o===null?(o=Un(r.tag,s,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=s,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,s=r.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function u_(r,s){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,s=o.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function Hu(r,s,o,u,g,y){var x=0;if(u=r,typeof r=="function")Of(r)&&(x=1);else if(typeof r=="string")x=hA(r,o,J.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case D:return r=Un(31,o,s,g),r.elementType=D,r.lanes=y,r;case A:return ma(o.children,g,y,s);case R:x=8,g|=24;break;case z:return r=Un(12,o,s,g|2),r.elementType=z,r.lanes=y,r;case Z:return r=Un(13,o,s,g),r.elementType=Z,r.lanes=y,r;case oe:return r=Un(19,o,s,g),r.elementType=oe,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case U:x=10;break e;case F:x=9;break e;case X:x=11;break e;case M:x=14;break e;case C:x=16,u=null;break e}x=29,o=Error(i(130,r===null?"null":typeof r,"")),u=null}return s=Un(x,o,s,g),s.elementType=r,s.type=u,s.lanes=y,s}function ma(r,s,o,u){return r=Un(7,r,u,s),r.lanes=o,r}function Mf(r,s,o){return r=Un(6,r,null,s),r.lanes=o,r}function d_(r){var s=Un(18,null,null,0);return s.stateNode=r,s}function kf(r,s,o){return s=Un(4,r.children!==null?r.children:[],r.key,s),s.lanes=o,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var h_=new WeakMap;function nr(r,s){if(typeof r=="object"&&r!==null){var o=h_.get(r);return o!==void 0?o:(s={value:r,source:s,stack:Ct(s)},h_.set(r,s),s)}return{value:r,source:s,stack:Ct(s)}}var io=[],so=0,$u=null,$l=0,rr=[],ir=0,ns=null,Xr=1,Jr="";function vi(r,s){io[so++]=$l,io[so++]=$u,$u=r,$l=s}function f_(r,s,o){rr[ir++]=Xr,rr[ir++]=Jr,rr[ir++]=ns,ns=r;var u=Xr;r=Jr;var g=32-It(u)-1;u&=~(1<<g),o+=1;var y=32-It(s)+g;if(30<y){var x=g-g%5;y=(u&(1<<x)-1).toString(32),u>>=x,g-=x,Xr=1<<32-It(s)+g|o<<g|u,Jr=y+r}else Xr=1<<y|o<<g|u,Jr=r}function Nf(r){r.return!==null&&(vi(r,1),f_(r,1,0))}function Pf(r){for(;r===$u;)$u=io[--so],io[so]=null,$l=io[--so],io[so]=null;for(;r===ns;)ns=rr[--ir],rr[ir]=null,Jr=rr[--ir],rr[ir]=null,Xr=rr[--ir],rr[ir]=null}function m_(r,s){rr[ir++]=Xr,rr[ir++]=Jr,rr[ir++]=ns,Xr=s.id,Jr=s.overflow,ns=r}var dn=null,yt=null,Xe=!1,rs=null,sr=!1,Vf=Error(i(519));function is(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Kl(nr(s,r)),Vf}function p_(r){var s=r.stateNode,o=r.type,u=r.memoizedProps;switch(s[Vt]=r,s[tn]=u,o){case"dialog":Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":case"embed":Ge("load",s);break;case"video":case"audio":for(o=0;o<gc.length;o++)Ge(gc[o],s);break;case"source":Ge("error",s);break;case"img":case"image":case"link":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"input":Ge("invalid",s),Au(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ge("invalid",s);break;case"textarea":Ge("invalid",s),Yi(s,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||u.suppressHydrationWarning===!0||Ov(s.textContent,o)?(u.popover!=null&&(Ge("beforetoggle",s),Ge("toggle",s)),u.onScroll!=null&&Ge("scroll",s),u.onScrollEnd!=null&&Ge("scrollend",s),u.onClick!=null&&(s.onclick=_r),s=!0):s=!1,s||is(r,!0)}function g_(r){for(dn=r.return;dn;)switch(dn.tag){case 5:case 31:case 13:sr=!1;return;case 27:case 3:sr=!0;return;default:dn=dn.return}}function ao(r){if(r!==dn)return!1;if(!Xe)return g_(r),Xe=!0,!1;var s=r.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||tp(r.type,r.memoizedProps)),o=!o),o&&yt&&is(r),g_(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));yt=Uv(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));yt=Uv(r)}else s===27?(s=yt,_s(r.type)?(r=ap,ap=null,yt=r):yt=s):yt=dn?or(r.stateNode.nextSibling):null;return!0}function pa(){yt=dn=null,Xe=!1}function Lf(){var r=rs;return r!==null&&(On===null?On=r:On.push.apply(On,r),rs=null),r}function Kl(r){rs===null?rs=[r]:rs.push(r)}var Bf=L(null),ga=null,bi=null;function ss(r,s,o){ce(Bf,s._currentValue),s._currentValue=o}function Ei(r){r._currentValue=Bf.current,G(Bf)}function zf(r,s,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),r===o)break;r=r.return}}function Uf(r,s,o,u){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var y=g.dependencies;if(y!==null){var x=g.child;y=y.firstContext;e:for(;y!==null;){var k=y;y=g;for(var $=0;$<s.length;$++)if(k.context===s[$]){y.lanes|=o,k=y.alternate,k!==null&&(k.lanes|=o),zf(y.return,o,r),u||(x=null);break e}y=k.next}}else if(g.tag===18){if(x=g.return,x===null)throw Error(i(341));x.lanes|=o,y=x.alternate,y!==null&&(y.lanes|=o),zf(x,o,r),x=null}else x=g.child;if(x!==null)x.return=g;else for(x=g;x!==null;){if(x===r){x=null;break}if(g=x.sibling,g!==null){g.return=x.return,x=g;break}x=x.return}g=x}}function oo(r,s,o,u){r=null;for(var g=s,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var x=g.alternate;if(x===null)throw Error(i(387));if(x=x.memoizedProps,x!==null){var k=g.type;zn(g.pendingProps.value,x.value)||(r!==null?r.push(k):r=[k])}}else if(g===Ee.current){if(x=g.alternate,x===null)throw Error(i(387));x.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(Ec):r=[Ec])}g=g.return}r!==null&&Uf(s,r,o,u),s.flags|=262144}function Ku(r){for(r=r.firstContext;r!==null;){if(!zn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ya(r){ga=r,bi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function hn(r){return y_(ga,r)}function Yu(r,s){return ga===null&&ya(r),y_(r,s)}function y_(r,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},bi===null){if(r===null)throw Error(i(308));bi=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else bi=bi.next=s;return o}var l1=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){s.aborted=!0,r.forEach(function(o){return o()})}},c1=t.unstable_scheduleCallback,u1=t.unstable_NormalPriority,zt={$$typeof:U,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ff(){return{controller:new l1,data:new Map,refCount:0}}function Yl(r){r.refCount--,r.refCount===0&&c1(u1,function(){r.controller.abort()})}var Wl=null,qf=0,lo=0,co=null;function d1(r,s){if(Wl===null){var o=Wl=[];qf=0,lo=Hm(),co={status:"pending",value:void 0,then:function(u){o.push(u)}}}return qf++,s.then(__,__),s}function __(){if(--qf===0&&Wl!==null){co!==null&&(co.status="fulfilled");var r=Wl;Wl=null,lo=0,co=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function h1(r,s){var o=[],u={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return r.then(function(){u.status="fulfilled",u.value=s;for(var g=0;g<o.length;g++)(0,o[g])(s)},function(g){for(u.status="rejected",u.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),u}var v_=P.S;P.S=function(r,s){nv=Yt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&d1(r,s),v_!==null&&v_(r,s)};var _a=L(null);function Qf(){var r=_a.current;return r!==null?r:mt.pooledCache}function Wu(r,s){s===null?ce(_a,_a.current):ce(_a,s.pool)}function b_(){var r=Qf();return r===null?null:{parent:zt._currentValue,pool:r}}var uo=Error(i(460)),Gf=Error(i(474)),Xu=Error(i(542)),Ju={then:function(){}};function E_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function x_(r,s,o){switch(o=r[o],o===void 0?r.push(s):o!==s&&(s.then(_r,_r),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,w_(r),r;default:if(typeof s.status=="string")s.then(_r,_r);else{if(r=mt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(u){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=u}},function(u){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,w_(r),r}throw ba=s,uo}}function va(r){try{var s=r._init;return s(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ba=o,uo):o}}var ba=null;function S_(){if(ba===null)throw Error(i(459));var r=ba;return ba=null,r}function w_(r){if(r===uo||r===Xu)throw Error(i(483))}var ho=null,Xl=0;function Zu(r){var s=Xl;return Xl+=1,ho===null&&(ho=[]),x_(ho,r,s)}function Jl(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function ed(r,s){throw s.$$typeof===b?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function T_(r){function s(ee,W){if(r){var se=ee.deletions;se===null?(ee.deletions=[W],ee.flags|=16):se.push(W)}}function o(ee,W){if(!r)return null;for(;W!==null;)s(ee,W),W=W.sibling;return null}function u(ee){for(var W=new Map;ee!==null;)ee.key!==null?W.set(ee.key,ee):W.set(ee.index,ee),ee=ee.sibling;return W}function g(ee,W){return ee=_i(ee,W),ee.index=0,ee.sibling=null,ee}function y(ee,W,se){return ee.index=se,r?(se=ee.alternate,se!==null?(se=se.index,se<W?(ee.flags|=67108866,W):se):(ee.flags|=67108866,W)):(ee.flags|=1048576,W)}function x(ee){return r&&ee.alternate===null&&(ee.flags|=67108866),ee}function k(ee,W,se,me){return W===null||W.tag!==6?(W=Mf(se,ee.mode,me),W.return=ee,W):(W=g(W,se),W.return=ee,W)}function $(ee,W,se,me){var De=se.type;return De===A?fe(ee,W,se.props.children,me,se.key):W!==null&&(W.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===C&&va(De)===W.type)?(W=g(W,se.props),Jl(W,se),W.return=ee,W):(W=Hu(se.type,se.key,se.props,null,ee.mode,me),Jl(W,se),W.return=ee,W)}function ae(ee,W,se,me){return W===null||W.tag!==4||W.stateNode.containerInfo!==se.containerInfo||W.stateNode.implementation!==se.implementation?(W=kf(se,ee.mode,me),W.return=ee,W):(W=g(W,se.children||[]),W.return=ee,W)}function fe(ee,W,se,me,De){return W===null||W.tag!==7?(W=ma(se,ee.mode,me,De),W.return=ee,W):(W=g(W,se),W.return=ee,W)}function pe(ee,W,se){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Mf(""+W,ee.mode,se),W.return=ee,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case T:return se=Hu(W.type,W.key,W.props,null,ee.mode,se),Jl(se,W),se.return=ee,se;case S:return W=kf(W,ee.mode,se),W.return=ee,W;case C:return W=va(W),pe(ee,W,se)}if(q(W)||B(W))return W=ma(W,ee.mode,se,null),W.return=ee,W;if(typeof W.then=="function")return pe(ee,Zu(W),se);if(W.$$typeof===U)return pe(ee,Yu(ee,W),se);ed(ee,W)}return null}function le(ee,W,se,me){var De=W!==null?W.key:null;if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return De!==null?null:k(ee,W,""+se,me);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case T:return se.key===De?$(ee,W,se,me):null;case S:return se.key===De?ae(ee,W,se,me):null;case C:return se=va(se),le(ee,W,se,me)}if(q(se)||B(se))return De!==null?null:fe(ee,W,se,me,null);if(typeof se.then=="function")return le(ee,W,Zu(se),me);if(se.$$typeof===U)return le(ee,W,Yu(ee,se),me);ed(ee,se)}return null}function de(ee,W,se,me,De){if(typeof me=="string"&&me!==""||typeof me=="number"||typeof me=="bigint")return ee=ee.get(se)||null,k(W,ee,""+me,De);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case T:return ee=ee.get(me.key===null?se:me.key)||null,$(W,ee,me,De);case S:return ee=ee.get(me.key===null?se:me.key)||null,ae(W,ee,me,De);case C:return me=va(me),de(ee,W,se,me,De)}if(q(me)||B(me))return ee=ee.get(se)||null,fe(W,ee,me,De,null);if(typeof me.then=="function")return de(ee,W,se,Zu(me),De);if(me.$$typeof===U)return de(ee,W,se,Yu(W,me),De);ed(W,me)}return null}function Ae(ee,W,se,me){for(var De=null,et=null,Re=W,Ue=W=0,$e=null;Re!==null&&Ue<se.length;Ue++){Re.index>Ue?($e=Re,Re=null):$e=Re.sibling;var tt=le(ee,Re,se[Ue],me);if(tt===null){Re===null&&(Re=$e);break}r&&Re&&tt.alternate===null&&s(ee,Re),W=y(tt,W,Ue),et===null?De=tt:et.sibling=tt,et=tt,Re=$e}if(Ue===se.length)return o(ee,Re),Xe&&vi(ee,Ue),De;if(Re===null){for(;Ue<se.length;Ue++)Re=pe(ee,se[Ue],me),Re!==null&&(W=y(Re,W,Ue),et===null?De=Re:et.sibling=Re,et=Re);return Xe&&vi(ee,Ue),De}for(Re=u(Re);Ue<se.length;Ue++)$e=de(Re,ee,Ue,se[Ue],me),$e!==null&&(r&&$e.alternate!==null&&Re.delete($e.key===null?Ue:$e.key),W=y($e,W,Ue),et===null?De=$e:et.sibling=$e,et=$e);return r&&Re.forEach(function(Ss){return s(ee,Ss)}),Xe&&vi(ee,Ue),De}function je(ee,W,se,me){if(se==null)throw Error(i(151));for(var De=null,et=null,Re=W,Ue=W=0,$e=null,tt=se.next();Re!==null&&!tt.done;Ue++,tt=se.next()){Re.index>Ue?($e=Re,Re=null):$e=Re.sibling;var Ss=le(ee,Re,tt.value,me);if(Ss===null){Re===null&&(Re=$e);break}r&&Re&&Ss.alternate===null&&s(ee,Re),W=y(Ss,W,Ue),et===null?De=Ss:et.sibling=Ss,et=Ss,Re=$e}if(tt.done)return o(ee,Re),Xe&&vi(ee,Ue),De;if(Re===null){for(;!tt.done;Ue++,tt=se.next())tt=pe(ee,tt.value,me),tt!==null&&(W=y(tt,W,Ue),et===null?De=tt:et.sibling=tt,et=tt);return Xe&&vi(ee,Ue),De}for(Re=u(Re);!tt.done;Ue++,tt=se.next())tt=de(Re,ee,Ue,tt.value,me),tt!==null&&(r&&tt.alternate!==null&&Re.delete(tt.key===null?Ue:tt.key),W=y(tt,W,Ue),et===null?De=tt:et.sibling=tt,et=tt);return r&&Re.forEach(function(SA){return s(ee,SA)}),Xe&&vi(ee,Ue),De}function ft(ee,W,se,me){if(typeof se=="object"&&se!==null&&se.type===A&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case T:e:{for(var De=se.key;W!==null;){if(W.key===De){if(De=se.type,De===A){if(W.tag===7){o(ee,W.sibling),me=g(W,se.props.children),me.return=ee,ee=me;break e}}else if(W.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===C&&va(De)===W.type){o(ee,W.sibling),me=g(W,se.props),Jl(me,se),me.return=ee,ee=me;break e}o(ee,W);break}else s(ee,W);W=W.sibling}se.type===A?(me=ma(se.props.children,ee.mode,me,se.key),me.return=ee,ee=me):(me=Hu(se.type,se.key,se.props,null,ee.mode,me),Jl(me,se),me.return=ee,ee=me)}return x(ee);case S:e:{for(De=se.key;W!==null;){if(W.key===De)if(W.tag===4&&W.stateNode.containerInfo===se.containerInfo&&W.stateNode.implementation===se.implementation){o(ee,W.sibling),me=g(W,se.children||[]),me.return=ee,ee=me;break e}else{o(ee,W);break}else s(ee,W);W=W.sibling}me=kf(se,ee.mode,me),me.return=ee,ee=me}return x(ee);case C:return se=va(se),ft(ee,W,se,me)}if(q(se))return Ae(ee,W,se,me);if(B(se)){if(De=B(se),typeof De!="function")throw Error(i(150));return se=De.call(se),je(ee,W,se,me)}if(typeof se.then=="function")return ft(ee,W,Zu(se),me);if(se.$$typeof===U)return ft(ee,W,Yu(ee,se),me);ed(ee,se)}return typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint"?(se=""+se,W!==null&&W.tag===6?(o(ee,W.sibling),me=g(W,se),me.return=ee,ee=me):(o(ee,W),me=Mf(se,ee.mode,me),me.return=ee,ee=me),x(ee)):o(ee,W)}return function(ee,W,se,me){try{Xl=0;var De=ft(ee,W,se,me);return ho=null,De}catch(Re){if(Re===uo||Re===Xu)throw Re;var et=Un(29,Re,null,ee.mode);return et.lanes=me,et.return=ee,et}}}var Ea=T_(!0),A_=T_(!1),as=!1;function Hf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $f(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function os(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ls(r,s,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(it&2)!==0){var g=u.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),u.pending=s,s=Gu(r),c_(r,null,o),s}return Qu(r,u,s,o),Gu(r)}function Zl(r,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var u=s.lanes;u&=r.pendingLanes,o|=u,s.lanes=o,Al(r,o)}}function Kf(r,s){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var g=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var x={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?g=y=x:y=y.next=x,o=o.next}while(o!==null);y===null?g=y=s:y=y.next=s}else g=y=s;o={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=s:r.next=s,o.lastBaseUpdate=s}var Yf=!1;function ec(){if(Yf){var r=co;if(r!==null)throw r}}function tc(r,s,o,u){Yf=!1;var g=r.updateQueue;as=!1;var y=g.firstBaseUpdate,x=g.lastBaseUpdate,k=g.shared.pending;if(k!==null){g.shared.pending=null;var $=k,ae=$.next;$.next=null,x===null?y=ae:x.next=ae,x=$;var fe=r.alternate;fe!==null&&(fe=fe.updateQueue,k=fe.lastBaseUpdate,k!==x&&(k===null?fe.firstBaseUpdate=ae:k.next=ae,fe.lastBaseUpdate=$))}if(y!==null){var pe=g.baseState;x=0,fe=ae=$=null,k=y;do{var le=k.lane&-536870913,de=le!==k.lane;if(de?(He&le)===le:(u&le)===le){le!==0&&le===lo&&(Yf=!0),fe!==null&&(fe=fe.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Ae=r,je=k;le=s;var ft=o;switch(je.tag){case 1:if(Ae=je.payload,typeof Ae=="function"){pe=Ae.call(ft,pe,le);break e}pe=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=je.payload,le=typeof Ae=="function"?Ae.call(ft,pe,le):Ae,le==null)break e;pe=v({},pe,le);break e;case 2:as=!0}}le=k.callback,le!==null&&(r.flags|=64,de&&(r.flags|=8192),de=g.callbacks,de===null?g.callbacks=[le]:de.push(le))}else de={lane:le,tag:k.tag,payload:k.payload,callback:k.callback,next:null},fe===null?(ae=fe=de,$=pe):fe=fe.next=de,x|=le;if(k=k.next,k===null){if(k=g.shared.pending,k===null)break;de=k,k=de.next,de.next=null,g.lastBaseUpdate=de,g.shared.pending=null}}while(!0);fe===null&&($=pe),g.baseState=$,g.firstBaseUpdate=ae,g.lastBaseUpdate=fe,y===null&&(g.shared.lanes=0),fs|=x,r.lanes=x,r.memoizedState=pe}}function C_(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function R_(r,s){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)C_(o[r],s)}var fo=L(null),td=L(0);function D_(r,s){r=Ii,ce(td,r),ce(fo,s),Ii=r|s.baseLanes}function Wf(){ce(td,Ii),ce(fo,fo.current)}function Xf(){Ii=td.current,G(fo),G(td)}var Fn=L(null),ar=null;function cs(r){var s=r.alternate;ce(Ot,Ot.current&1),ce(Fn,r),ar===null&&(s===null||fo.current!==null||s.memoizedState!==null)&&(ar=r)}function Jf(r){ce(Ot,Ot.current),ce(Fn,r),ar===null&&(ar=r)}function I_(r){r.tag===22?(ce(Ot,Ot.current),ce(Fn,r),ar===null&&(ar=r)):us()}function us(){ce(Ot,Ot.current),ce(Fn,Fn.current)}function qn(r){G(Fn),ar===r&&(ar=null),G(Ot)}var Ot=L(0);function nd(r){for(var s=r;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ip(o)||sp(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var xi=0,ze=null,dt=null,Ut=null,rd=!1,mo=!1,xa=!1,id=0,nc=0,po=null,f1=0;function Rt(){throw Error(i(321))}function Zf(r,s){if(s===null)return!1;for(var o=0;o<s.length&&o<r.length;o++)if(!zn(r[o],s[o]))return!1;return!0}function em(r,s,o,u,g,y){return xi=y,ze=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,P.H=r===null||r.memoizedState===null?f0:pm,xa=!1,y=o(u,g),xa=!1,mo&&(y=O_(s,o,u,g)),j_(r),y}function j_(r){P.H=sc;var s=dt!==null&&dt.next!==null;if(xi=0,Ut=dt=ze=null,rd=!1,nc=0,po=null,s)throw Error(i(300));r===null||Ft||(r=r.dependencies,r!==null&&Ku(r)&&(Ft=!0))}function O_(r,s,o,u){ze=r;var g=0;do{if(mo&&(po=null),nc=0,mo=!1,25<=g)throw Error(i(301));if(g+=1,Ut=dt=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}P.H=m0,y=s(o,u)}while(mo);return y}function m1(){var r=P.H,s=r.useState()[0];return s=typeof s.then=="function"?rc(s):s,r=r.useState()[0],(dt!==null?dt.memoizedState:null)!==r&&(ze.flags|=1024),s}function tm(){var r=id!==0;return id=0,r}function nm(r,s,o){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~o}function rm(r){if(rd){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}rd=!1}xi=0,Ut=dt=ze=null,mo=!1,nc=id=0,po=null}function Tn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?ze.memoizedState=Ut=r:Ut=Ut.next=r,Ut}function Mt(){if(dt===null){var r=ze.alternate;r=r!==null?r.memoizedState:null}else r=dt.next;var s=Ut===null?ze.memoizedState:Ut.next;if(s!==null)Ut=s,dt=r;else{if(r===null)throw ze.alternate===null?Error(i(467)):Error(i(310));dt=r,r={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},Ut===null?ze.memoizedState=Ut=r:Ut=Ut.next=r}return Ut}function sd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rc(r){var s=nc;return nc+=1,po===null&&(po=[]),r=x_(po,r,s),s=ze,(Ut===null?s.memoizedState:Ut.next)===null&&(s=s.alternate,P.H=s===null||s.memoizedState===null?f0:pm),r}function ad(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return rc(r);if(r.$$typeof===U)return hn(r)}throw Error(i(438,String(r)))}function im(r){var s=null,o=ze.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var u=ze.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=sd(),ze.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(r),u=0;u<r;u++)o[u]=N;return s.index++,o}function Si(r,s){return typeof s=="function"?s(r):s}function od(r){var s=Mt();return sm(s,dt,r)}function sm(r,s,o){var u=r.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=o;var g=r.baseQueue,y=u.pending;if(y!==null){if(g!==null){var x=g.next;g.next=y.next,y.next=x}s.baseQueue=g=y,u.pending=null}if(y=r.baseState,g===null)r.memoizedState=y;else{s=g.next;var k=x=null,$=null,ae=s,fe=!1;do{var pe=ae.lane&-536870913;if(pe!==ae.lane?(He&pe)===pe:(xi&pe)===pe){var le=ae.revertLane;if(le===0)$!==null&&($=$.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),pe===lo&&(fe=!0);else if((xi&le)===le){ae=ae.next,le===lo&&(fe=!0);continue}else pe={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},$===null?(k=$=pe,x=y):$=$.next=pe,ze.lanes|=le,fs|=le;pe=ae.action,xa&&o(y,pe),y=ae.hasEagerState?ae.eagerState:o(y,pe)}else le={lane:pe,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},$===null?(k=$=le,x=y):$=$.next=le,ze.lanes|=pe,fs|=pe;ae=ae.next}while(ae!==null&&ae!==s);if($===null?x=y:$.next=k,!zn(y,r.memoizedState)&&(Ft=!0,fe&&(o=co,o!==null)))throw o;r.memoizedState=y,r.baseState=x,r.baseQueue=$,u.lastRenderedState=y}return g===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function am(r){var s=Mt(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var u=o.dispatch,g=o.pending,y=s.memoizedState;if(g!==null){o.pending=null;var x=g=g.next;do y=r(y,x.action),x=x.next;while(x!==g);zn(y,s.memoizedState)||(Ft=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,u]}function M_(r,s,o){var u=ze,g=Mt(),y=Xe;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var x=!zn((dt||g).memoizedState,o);if(x&&(g.memoizedState=o,Ft=!0),g=g.queue,cm(P_.bind(null,u,g,r),[r]),g.getSnapshot!==s||x||Ut!==null&&Ut.memoizedState.tag&1){if(u.flags|=2048,go(9,{destroy:void 0},N_.bind(null,u,g,o,s),null),mt===null)throw Error(i(349));y||(xi&127)!==0||k_(u,s,o)}return o}function k_(r,s,o){r.flags|=16384,r={getSnapshot:s,value:o},s=ze.updateQueue,s===null?(s=sd(),ze.updateQueue=s,s.stores=[r]):(o=s.stores,o===null?s.stores=[r]:o.push(r))}function N_(r,s,o,u){s.value=o,s.getSnapshot=u,V_(s)&&L_(r)}function P_(r,s,o){return o(function(){V_(s)&&L_(r)})}function V_(r){var s=r.getSnapshot;r=r.value;try{var o=s();return!zn(r,o)}catch{return!0}}function L_(r){var s=fa(r,2);s!==null&&Mn(s,r,2)}function om(r){var s=Tn();if(typeof r=="function"){var o=r;if(r=o(),xa){Wn(!0);try{o()}finally{Wn(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Si,lastRenderedState:r},s}function B_(r,s,o,u){return r.baseState=o,sm(r,dt,typeof u=="function"?u:Si)}function p1(r,s,o,u,g){if(ud(r))throw Error(i(485));if(r=s.action,r!==null){var y={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){y.listeners.push(x)}};P.T!==null?o(!0):y.isTransition=!1,u(y),o=s.pending,o===null?(y.next=s.pending=y,z_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function z_(r,s){var o=s.action,u=s.payload,g=r.state;if(s.isTransition){var y=P.T,x={};P.T=x;try{var k=o(g,u),$=P.S;$!==null&&$(x,k),U_(r,s,k)}catch(ae){lm(r,s,ae)}finally{y!==null&&x.types!==null&&(y.types=x.types),P.T=y}}else try{y=o(g,u),U_(r,s,y)}catch(ae){lm(r,s,ae)}}function U_(r,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){F_(r,s,u)},function(u){return lm(r,s,u)}):F_(r,s,o)}function F_(r,s,o){s.status="fulfilled",s.value=o,q_(s),r.state=o,s=r.pending,s!==null&&(o=s.next,o===s?r.pending=null:(o=o.next,s.next=o,z_(r,o)))}function lm(r,s,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=o,q_(s),s=s.next;while(s!==u)}r.action=null}function q_(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function Q_(r,s){return s}function G_(r,s){if(Xe){var o=mt.formState;if(o!==null){e:{var u=ze;if(Xe){if(yt){t:{for(var g=yt,y=sr;g.nodeType!==8;){if(!y){g=null;break t}if(g=or(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){yt=or(g.nextSibling),u=g.data==="F!";break e}}is(u)}u=!1}u&&(s=o[0])}}return o=Tn(),o.memoizedState=o.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Q_,lastRenderedState:s},o.queue=u,o=u0.bind(null,ze,u),u.dispatch=o,u=om(!1),y=mm.bind(null,ze,!1,u.queue),u=Tn(),g={state:s,dispatch:null,action:r,pending:null},u.queue=g,o=p1.bind(null,ze,g,y,o),g.dispatch=o,u.memoizedState=r,[s,o,!1]}function H_(r){var s=Mt();return $_(s,dt,r)}function $_(r,s,o){if(s=sm(r,s,Q_)[0],r=od(Si)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var u=rc(s)}catch(x){throw x===uo?Xu:x}else u=s;s=Mt();var g=s.queue,y=g.dispatch;return o!==s.memoizedState&&(ze.flags|=2048,go(9,{destroy:void 0},g1.bind(null,g,o),null)),[u,y,r]}function g1(r,s){r.action=s}function K_(r){var s=Mt(),o=dt;if(o!==null)return $_(s,o,r);Mt(),s=s.memoizedState,o=Mt();var u=o.queue.dispatch;return o.memoizedState=r,[s,u,!1]}function go(r,s,o,u){return r={tag:r,create:o,deps:u,inst:s,next:null},s=ze.updateQueue,s===null&&(s=sd(),ze.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,s.lastEffect=r),r}function Y_(){return Mt().memoizedState}function ld(r,s,o,u){var g=Tn();ze.flags|=r,g.memoizedState=go(1|s,{destroy:void 0},o,u===void 0?null:u)}function cd(r,s,o,u){var g=Mt();u=u===void 0?null:u;var y=g.memoizedState.inst;dt!==null&&u!==null&&Zf(u,dt.memoizedState.deps)?g.memoizedState=go(s,y,o,u):(ze.flags|=r,g.memoizedState=go(1|s,y,o,u))}function W_(r,s){ld(8390656,8,r,s)}function cm(r,s){cd(2048,8,r,s)}function y1(r){ze.flags|=4;var s=ze.updateQueue;if(s===null)s=sd(),ze.updateQueue=s,s.events=[r];else{var o=s.events;o===null?s.events=[r]:o.push(r)}}function X_(r){var s=Mt().memoizedState;return y1({ref:s,nextImpl:r}),function(){if((it&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function J_(r,s){return cd(4,2,r,s)}function Z_(r,s){return cd(4,4,r,s)}function e0(r,s){if(typeof s=="function"){r=r();var o=s(r);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function t0(r,s,o){o=o!=null?o.concat([r]):null,cd(4,4,e0.bind(null,s,r),o)}function um(){}function n0(r,s){var o=Mt();s=s===void 0?null:s;var u=o.memoizedState;return s!==null&&Zf(s,u[1])?u[0]:(o.memoizedState=[r,s],r)}function r0(r,s){var o=Mt();s=s===void 0?null:s;var u=o.memoizedState;if(s!==null&&Zf(s,u[1]))return u[0];if(u=r(),xa){Wn(!0);try{r()}finally{Wn(!1)}}return o.memoizedState=[u,s],u}function dm(r,s,o){return o===void 0||(xi&1073741824)!==0&&(He&261930)===0?r.memoizedState=s:(r.memoizedState=o,r=iv(),ze.lanes|=r,fs|=r,o)}function i0(r,s,o,u){return zn(o,s)?o:fo.current!==null?(r=dm(r,o,u),zn(r,s)||(Ft=!0),r):(xi&42)===0||(xi&1073741824)!==0&&(He&261930)===0?(Ft=!0,r.memoizedState=o):(r=iv(),ze.lanes|=r,fs|=r,s)}function s0(r,s,o,u,g){var y=Q.p;Q.p=y!==0&&8>y?y:8;var x=P.T,k={};P.T=k,mm(r,!1,s,o);try{var $=g(),ae=P.S;if(ae!==null&&ae(k,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var fe=h1($,u);ic(r,s,fe,Hn(r))}else ic(r,s,u,Hn(r))}catch(pe){ic(r,s,{then:function(){},status:"rejected",reason:pe},Hn())}finally{Q.p=y,x!==null&&k.types!==null&&(x.types=k.types),P.T=x}}function _1(){}function hm(r,s,o,u){if(r.tag!==5)throw Error(i(476));var g=a0(r).queue;s0(r,g,s,H,o===null?_1:function(){return o0(r),o(u)})}function a0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:H,baseState:H,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Si,lastRenderedState:H},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Si,lastRenderedState:o},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function o0(r){var s=a0(r);s.next===null&&(s=r.alternate.memoizedState),ic(r,s.next.queue,{},Hn())}function fm(){return hn(Ec)}function l0(){return Mt().memoizedState}function c0(){return Mt().memoizedState}function v1(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var o=Hn();r=os(o);var u=ls(s,r,o);u!==null&&(Mn(u,s,o),Zl(u,s,o)),s={cache:Ff()},r.payload=s;return}s=s.return}}function b1(r,s,o){var u=Hn();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},ud(r)?d0(s,o):(o=jf(r,s,o,u),o!==null&&(Mn(o,r,u),h0(o,s,u)))}function u0(r,s,o){var u=Hn();ic(r,s,o,u)}function ic(r,s,o,u){var g={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(ud(r))d0(s,g);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var x=s.lastRenderedState,k=y(x,o);if(g.hasEagerState=!0,g.eagerState=k,zn(k,x))return Qu(r,s,g,0),mt===null&&qu(),!1}catch{}if(o=jf(r,s,g,u),o!==null)return Mn(o,r,u),h0(o,s,u),!0}return!1}function mm(r,s,o,u){if(u={lane:2,revertLane:Hm(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ud(r)){if(s)throw Error(i(479))}else s=jf(r,o,u,2),s!==null&&Mn(s,r,2)}function ud(r){var s=r.alternate;return r===ze||s!==null&&s===ze}function d0(r,s){mo=rd=!0;var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}function h0(r,s,o){if((o&4194048)!==0){var u=s.lanes;u&=r.pendingLanes,o|=u,s.lanes=o,Al(r,o)}}var sc={readContext:hn,use:ad,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useLayoutEffect:Rt,useInsertionEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useSyncExternalStore:Rt,useId:Rt,useHostTransitionStatus:Rt,useFormState:Rt,useActionState:Rt,useOptimistic:Rt,useMemoCache:Rt,useCacheRefresh:Rt};sc.useEffectEvent=Rt;var f0={readContext:hn,use:ad,useCallback:function(r,s){return Tn().memoizedState=[r,s===void 0?null:s],r},useContext:hn,useEffect:W_,useImperativeHandle:function(r,s,o){o=o!=null?o.concat([r]):null,ld(4194308,4,e0.bind(null,s,r),o)},useLayoutEffect:function(r,s){return ld(4194308,4,r,s)},useInsertionEffect:function(r,s){ld(4,2,r,s)},useMemo:function(r,s){var o=Tn();s=s===void 0?null:s;var u=r();if(xa){Wn(!0);try{r()}finally{Wn(!1)}}return o.memoizedState=[u,s],u},useReducer:function(r,s,o){var u=Tn();if(o!==void 0){var g=o(s);if(xa){Wn(!0);try{o(s)}finally{Wn(!1)}}}else g=s;return u.memoizedState=u.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},u.queue=r,r=r.dispatch=b1.bind(null,ze,r),[u.memoizedState,r]},useRef:function(r){var s=Tn();return r={current:r},s.memoizedState=r},useState:function(r){r=om(r);var s=r.queue,o=u0.bind(null,ze,s);return s.dispatch=o,[r.memoizedState,o]},useDebugValue:um,useDeferredValue:function(r,s){var o=Tn();return dm(o,r,s)},useTransition:function(){var r=om(!1);return r=s0.bind(null,ze,r.queue,!0,!1),Tn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,o){var u=ze,g=Tn();if(Xe){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),mt===null)throw Error(i(349));(He&127)!==0||k_(u,s,o)}g.memoizedState=o;var y={value:o,getSnapshot:s};return g.queue=y,W_(P_.bind(null,u,y,r),[r]),u.flags|=2048,go(9,{destroy:void 0},N_.bind(null,u,y,o,s),null),o},useId:function(){var r=Tn(),s=mt.identifierPrefix;if(Xe){var o=Jr,u=Xr;o=(u&~(1<<32-It(u)-1)).toString(32)+o,s="_"+s+"R_"+o,o=id++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=f1++,s="_"+s+"r_"+o.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:fm,useFormState:G_,useActionState:G_,useOptimistic:function(r){var s=Tn();s.memoizedState=s.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=mm.bind(null,ze,!0,o),o.dispatch=s,[r,s]},useMemoCache:im,useCacheRefresh:function(){return Tn().memoizedState=v1.bind(null,ze)},useEffectEvent:function(r){var s=Tn(),o={impl:r};return s.memoizedState=o,function(){if((it&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},pm={readContext:hn,use:ad,useCallback:n0,useContext:hn,useEffect:cm,useImperativeHandle:t0,useInsertionEffect:J_,useLayoutEffect:Z_,useMemo:r0,useReducer:od,useRef:Y_,useState:function(){return od(Si)},useDebugValue:um,useDeferredValue:function(r,s){var o=Mt();return i0(o,dt.memoizedState,r,s)},useTransition:function(){var r=od(Si)[0],s=Mt().memoizedState;return[typeof r=="boolean"?r:rc(r),s]},useSyncExternalStore:M_,useId:l0,useHostTransitionStatus:fm,useFormState:H_,useActionState:H_,useOptimistic:function(r,s){var o=Mt();return B_(o,dt,r,s)},useMemoCache:im,useCacheRefresh:c0};pm.useEffectEvent=X_;var m0={readContext:hn,use:ad,useCallback:n0,useContext:hn,useEffect:cm,useImperativeHandle:t0,useInsertionEffect:J_,useLayoutEffect:Z_,useMemo:r0,useReducer:am,useRef:Y_,useState:function(){return am(Si)},useDebugValue:um,useDeferredValue:function(r,s){var o=Mt();return dt===null?dm(o,r,s):i0(o,dt.memoizedState,r,s)},useTransition:function(){var r=am(Si)[0],s=Mt().memoizedState;return[typeof r=="boolean"?r:rc(r),s]},useSyncExternalStore:M_,useId:l0,useHostTransitionStatus:fm,useFormState:K_,useActionState:K_,useOptimistic:function(r,s){var o=Mt();return dt!==null?B_(o,dt,r,s):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:im,useCacheRefresh:c0};m0.useEffectEvent=X_;function gm(r,s,o,u){s=r.memoizedState,o=o(u,s),o=o==null?s:v({},s,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var ym={enqueueSetState:function(r,s,o){r=r._reactInternals;var u=Hn(),g=os(u);g.payload=s,o!=null&&(g.callback=o),s=ls(r,g,u),s!==null&&(Mn(s,r,u),Zl(s,r,u))},enqueueReplaceState:function(r,s,o){r=r._reactInternals;var u=Hn(),g=os(u);g.tag=1,g.payload=s,o!=null&&(g.callback=o),s=ls(r,g,u),s!==null&&(Mn(s,r,u),Zl(s,r,u))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var o=Hn(),u=os(o);u.tag=2,s!=null&&(u.callback=s),s=ls(r,u,o),s!==null&&(Mn(s,r,o),Zl(s,r,o))}};function p0(r,s,o,u,g,y,x){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,y,x):s.prototype&&s.prototype.isPureReactComponent?!Gl(o,u)||!Gl(g,y):!0}function g0(r,s,o,u){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,u),s.state!==r&&ym.enqueueReplaceState(s,s.state,null)}function Sa(r,s){var o=s;if("ref"in s){o={};for(var u in s)u!=="ref"&&(o[u]=s[u])}if(r=r.defaultProps){o===s&&(o=v({},o));for(var g in r)o[g]===void 0&&(o[g]=r[g])}return o}function y0(r){Fu(r)}function _0(r){console.error(r)}function v0(r){Fu(r)}function dd(r,s){try{var o=r.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function b0(r,s,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function _m(r,s,o){return o=os(o),o.tag=3,o.payload={element:null},o.callback=function(){dd(r,s)},o}function E0(r){return r=os(r),r.tag=3,r}function x0(r,s,o,u){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;r.payload=function(){return g(y)},r.callback=function(){b0(s,o,u)}}var x=o.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(r.callback=function(){b0(s,o,u),typeof g!="function"&&(ms===null?ms=new Set([this]):ms.add(this));var k=u.stack;this.componentDidCatch(u.value,{componentStack:k!==null?k:""})})}function E1(r,s,o,u,g){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=o.alternate,s!==null&&oo(s,o,g,!0),o=Fn.current,o!==null){switch(o.tag){case 31:case 13:return ar===null?Sd():o.alternate===null&&Dt===0&&(Dt=3),o.flags&=-257,o.flags|=65536,o.lanes=g,u===Ju?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([u]):s.add(u),qm(r,u,g)),!1;case 22:return o.flags|=65536,u===Ju?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([u]):o.add(u)),qm(r,u,g)),!1}throw Error(i(435,o.tag))}return qm(r,u,g),Sd(),!1}if(Xe)return s=Fn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,u!==Vf&&(r=Error(i(422),{cause:u}),Kl(nr(r,o)))):(u!==Vf&&(s=Error(i(423),{cause:u}),Kl(nr(s,o))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,u=nr(u,o),g=_m(r.stateNode,u,g),Kf(r,g),Dt!==4&&(Dt=2)),!1;var y=Error(i(520),{cause:u});if(y=nr(y,o),fc===null?fc=[y]:fc.push(y),Dt!==4&&(Dt=2),s===null)return!0;u=nr(u,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,r=g&-g,o.lanes|=r,r=_m(o.stateNode,u,r),Kf(o,r),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ms===null||!ms.has(y))))return o.flags|=65536,g&=-g,o.lanes|=g,g=E0(g),x0(g,r,o,u),Kf(o,g),!1}o=o.return}while(o!==null);return!1}var vm=Error(i(461)),Ft=!1;function fn(r,s,o,u){s.child=r===null?A_(s,null,o,u):Ea(s,r.child,o,u)}function S0(r,s,o,u,g){o=o.render;var y=s.ref;if("ref"in u){var x={};for(var k in u)k!=="ref"&&(x[k]=u[k])}else x=u;return ya(s),u=em(r,s,o,x,y,g),k=tm(),r!==null&&!Ft?(nm(r,s,g),wi(r,s,g)):(Xe&&k&&Nf(s),s.flags|=1,fn(r,s,u,g),s.child)}function w0(r,s,o,u,g){if(r===null){var y=o.type;return typeof y=="function"&&!Of(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,T0(r,s,y,u,g)):(r=Hu(o.type,null,u,s,s.mode,g),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,!Cm(r,g)){var x=y.memoizedProps;if(o=o.compare,o=o!==null?o:Gl,o(x,u)&&r.ref===s.ref)return wi(r,s,g)}return s.flags|=1,r=_i(y,u),r.ref=s.ref,r.return=s,s.child=r}function T0(r,s,o,u,g){if(r!==null){var y=r.memoizedProps;if(Gl(y,u)&&r.ref===s.ref)if(Ft=!1,s.pendingProps=u=y,Cm(r,g))(r.flags&131072)!==0&&(Ft=!0);else return s.lanes=r.lanes,wi(r,s,g)}return bm(r,s,o,u,g)}function A0(r,s,o,u){var g=u.children,y=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(u=s.child=r.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~y}else u=0,s.child=null;return C0(r,s,y,o,u)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&Wu(s,y!==null?y.cachePool:null),y!==null?D_(s,y):Wf(),I_(s);else return u=s.lanes=536870912,C0(r,s,y!==null?y.baseLanes|o:o,o,u)}else y!==null?(Wu(s,y.cachePool),D_(s,y),us(),s.memoizedState=null):(r!==null&&Wu(s,null),Wf(),us());return fn(r,s,g,o),s.child}function ac(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function C0(r,s,o,u,g){var y=Qf();return y=y===null?null:{parent:zt._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},r!==null&&Wu(s,null),Wf(),I_(s),r!==null&&oo(r,s,u,!0),s.childLanes=g,null}function hd(r,s){return s=md({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function R0(r,s,o){return Ea(s,r.child,null,o),r=hd(s,s.pendingProps),r.flags|=2,qn(s),s.memoizedState=null,r}function x1(r,s,o){var u=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(Xe){if(u.mode==="hidden")return r=hd(s,u),s.lanes=536870912,ac(null,r);if(Jf(s),(r=yt)?(r=zv(r,sr),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:ns!==null?{id:Xr,overflow:Jr}:null,retryLane:536870912,hydrationErrors:null},o=d_(r),o.return=s,s.child=o,dn=s,yt=null)):r=null,r===null)throw is(s);return s.lanes=536870912,null}return hd(s,u)}var y=r.memoizedState;if(y!==null){var x=y.dehydrated;if(Jf(s),g)if(s.flags&256)s.flags&=-257,s=R0(r,s,o);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(Ft||oo(r,s,o,!1),g=(o&r.childLanes)!==0,Ft||g){if(u=mt,u!==null&&(x=Cl(u,o),x!==0&&x!==y.retryLane))throw y.retryLane=x,fa(r,x),Mn(u,r,x),vm;Sd(),s=R0(r,s,o)}else r=y.treeContext,yt=or(x.nextSibling),dn=s,Xe=!0,rs=null,sr=!1,r!==null&&m_(s,r),s=hd(s,u),s.flags|=4096;return s}return r=_i(r.child,{mode:u.mode,children:u.children}),r.ref=s.ref,s.child=r,r.return=s,r}function fd(r,s){var o=s.ref;if(o===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(r===null||r.ref!==o)&&(s.flags|=4194816)}}function bm(r,s,o,u,g){return ya(s),o=em(r,s,o,u,void 0,g),u=tm(),r!==null&&!Ft?(nm(r,s,g),wi(r,s,g)):(Xe&&u&&Nf(s),s.flags|=1,fn(r,s,o,g),s.child)}function D0(r,s,o,u,g,y){return ya(s),s.updateQueue=null,o=O_(s,u,o,g),j_(r),u=tm(),r!==null&&!Ft?(nm(r,s,y),wi(r,s,y)):(Xe&&u&&Nf(s),s.flags|=1,fn(r,s,o,y),s.child)}function I0(r,s,o,u,g){if(ya(s),s.stateNode===null){var y=ro,x=o.contextType;typeof x=="object"&&x!==null&&(y=hn(x)),y=new o(u,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=ym,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=u,y.state=s.memoizedState,y.refs={},Hf(s),x=o.contextType,y.context=typeof x=="object"&&x!==null?hn(x):ro,y.state=s.memoizedState,x=o.getDerivedStateFromProps,typeof x=="function"&&(gm(s,o,x,u),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(x=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),x!==y.state&&ym.enqueueReplaceState(y,y.state,null),tc(s,u,y,g),ec(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(r===null){y=s.stateNode;var k=s.memoizedProps,$=Sa(o,k);y.props=$;var ae=y.context,fe=o.contextType;x=ro,typeof fe=="object"&&fe!==null&&(x=hn(fe));var pe=o.getDerivedStateFromProps;fe=typeof pe=="function"||typeof y.getSnapshotBeforeUpdate=="function",k=s.pendingProps!==k,fe||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(k||ae!==x)&&g0(s,y,u,x),as=!1;var le=s.memoizedState;y.state=le,tc(s,u,y,g),ec(),ae=s.memoizedState,k||le!==ae||as?(typeof pe=="function"&&(gm(s,o,pe,u),ae=s.memoizedState),($=as||p0(s,o,$,u,le,ae,x))?(fe||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=ae),y.props=u,y.state=ae,y.context=x,u=$):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{y=s.stateNode,$f(r,s),x=s.memoizedProps,fe=Sa(o,x),y.props=fe,pe=s.pendingProps,le=y.context,ae=o.contextType,$=ro,typeof ae=="object"&&ae!==null&&($=hn(ae)),k=o.getDerivedStateFromProps,(ae=typeof k=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(x!==pe||le!==$)&&g0(s,y,u,$),as=!1,le=s.memoizedState,y.state=le,tc(s,u,y,g),ec();var de=s.memoizedState;x!==pe||le!==de||as||r!==null&&r.dependencies!==null&&Ku(r.dependencies)?(typeof k=="function"&&(gm(s,o,k,u),de=s.memoizedState),(fe=as||p0(s,o,fe,u,le,de,$)||r!==null&&r.dependencies!==null&&Ku(r.dependencies))?(ae||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,de,$),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,de,$)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||x===r.memoizedProps&&le===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&le===r.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=de),y.props=u,y.state=de,y.context=$,u=fe):(typeof y.componentDidUpdate!="function"||x===r.memoizedProps&&le===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||x===r.memoizedProps&&le===r.memoizedState||(s.flags|=1024),u=!1)}return y=u,fd(r,s),u=(s.flags&128)!==0,y||u?(y=s.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,r!==null&&u?(s.child=Ea(s,r.child,null,g),s.child=Ea(s,null,o,g)):fn(r,s,o,g),s.memoizedState=y.state,r=s.child):r=wi(r,s,g),r}function j0(r,s,o,u){return pa(),s.flags|=256,fn(r,s,o,u),s.child}var Em={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xm(r){return{baseLanes:r,cachePool:b_()}}function Sm(r,s,o){return r=r!==null?r.childLanes&~o:0,s&&(r|=Gn),r}function O0(r,s,o){var u=s.pendingProps,g=!1,y=(s.flags&128)!==0,x;if((x=y)||(x=r!==null&&r.memoizedState===null?!1:(Ot.current&2)!==0),x&&(g=!0,s.flags&=-129),x=(s.flags&32)!==0,s.flags&=-33,r===null){if(Xe){if(g?cs(s):us(),(r=yt)?(r=zv(r,sr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:ns!==null?{id:Xr,overflow:Jr}:null,retryLane:536870912,hydrationErrors:null},o=d_(r),o.return=s,s.child=o,dn=s,yt=null)):r=null,r===null)throw is(s);return sp(r)?s.lanes=32:s.lanes=536870912,null}var k=u.children;return u=u.fallback,g?(us(),g=s.mode,k=md({mode:"hidden",children:k},g),u=ma(u,g,o,null),k.return=s,u.return=s,k.sibling=u,s.child=k,u=s.child,u.memoizedState=xm(o),u.childLanes=Sm(r,x,o),s.memoizedState=Em,ac(null,u)):(cs(s),wm(s,k))}var $=r.memoizedState;if($!==null&&(k=$.dehydrated,k!==null)){if(y)s.flags&256?(cs(s),s.flags&=-257,s=Tm(r,s,o)):s.memoizedState!==null?(us(),s.child=r.child,s.flags|=128,s=null):(us(),k=u.fallback,g=s.mode,u=md({mode:"visible",children:u.children},g),k=ma(k,g,o,null),k.flags|=2,u.return=s,k.return=s,u.sibling=k,s.child=u,Ea(s,r.child,null,o),u=s.child,u.memoizedState=xm(o),u.childLanes=Sm(r,x,o),s.memoizedState=Em,s=ac(null,u));else if(cs(s),sp(k)){if(x=k.nextSibling&&k.nextSibling.dataset,x)var ae=x.dgst;x=ae,u=Error(i(419)),u.stack="",u.digest=x,Kl({value:u,source:null,stack:null}),s=Tm(r,s,o)}else if(Ft||oo(r,s,o,!1),x=(o&r.childLanes)!==0,Ft||x){if(x=mt,x!==null&&(u=Cl(x,o),u!==0&&u!==$.retryLane))throw $.retryLane=u,fa(r,u),Mn(x,r,u),vm;ip(k)||Sd(),s=Tm(r,s,o)}else ip(k)?(s.flags|=192,s.child=r.child,s=null):(r=$.treeContext,yt=or(k.nextSibling),dn=s,Xe=!0,rs=null,sr=!1,r!==null&&m_(s,r),s=wm(s,u.children),s.flags|=4096);return s}return g?(us(),k=u.fallback,g=s.mode,$=r.child,ae=$.sibling,u=_i($,{mode:"hidden",children:u.children}),u.subtreeFlags=$.subtreeFlags&65011712,ae!==null?k=_i(ae,k):(k=ma(k,g,o,null),k.flags|=2),k.return=s,u.return=s,u.sibling=k,s.child=u,ac(null,u),u=s.child,k=r.child.memoizedState,k===null?k=xm(o):(g=k.cachePool,g!==null?($=zt._currentValue,g=g.parent!==$?{parent:$,pool:$}:g):g=b_(),k={baseLanes:k.baseLanes|o,cachePool:g}),u.memoizedState=k,u.childLanes=Sm(r,x,o),s.memoizedState=Em,ac(r.child,u)):(cs(s),o=r.child,r=o.sibling,o=_i(o,{mode:"visible",children:u.children}),o.return=s,o.sibling=null,r!==null&&(x=s.deletions,x===null?(s.deletions=[r],s.flags|=16):x.push(r)),s.child=o,s.memoizedState=null,o)}function wm(r,s){return s=md({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function md(r,s){return r=Un(22,r,null,s),r.lanes=0,r}function Tm(r,s,o){return Ea(s,r.child,null,o),r=wm(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function M0(r,s,o){r.lanes|=s;var u=r.alternate;u!==null&&(u.lanes|=s),zf(r.return,s,o)}function Am(r,s,o,u,g,y){var x=r.memoizedState;x===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:g,treeForkCount:y}:(x.isBackwards=s,x.rendering=null,x.renderingStartTime=0,x.last=u,x.tail=o,x.tailMode=g,x.treeForkCount=y)}function k0(r,s,o){var u=s.pendingProps,g=u.revealOrder,y=u.tail;u=u.children;var x=Ot.current,k=(x&2)!==0;if(k?(x=x&1|2,s.flags|=128):x&=1,ce(Ot,x),fn(r,s,u,o),u=Xe?$l:0,!k&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&M0(r,o,s);else if(r.tag===19)M0(r,o,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(g){case"forwards":for(o=s.child,g=null;o!==null;)r=o.alternate,r!==null&&nd(r)===null&&(g=o),o=o.sibling;o=g,o===null?(g=s.child,s.child=null):(g=o.sibling,o.sibling=null),Am(s,!1,g,o,y,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=s.child,s.child=null;g!==null;){if(r=g.alternate,r!==null&&nd(r)===null){s.child=g;break}r=g.sibling,g.sibling=o,o=g,g=r}Am(s,!0,o,null,y,u);break;case"together":Am(s,!1,null,null,void 0,u);break;default:s.memoizedState=null}return s.child}function wi(r,s,o){if(r!==null&&(s.dependencies=r.dependencies),fs|=s.lanes,(o&s.childLanes)===0)if(r!==null){if(oo(r,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,o=_i(r,r.pendingProps),s.child=o,o.return=s;r.sibling!==null;)r=r.sibling,o=o.sibling=_i(r,r.pendingProps),o.return=s;o.sibling=null}return s.child}function Cm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&Ku(r)))}function S1(r,s,o){switch(s.tag){case 3:be(s,s.stateNode.containerInfo),ss(s,zt,r.memoizedState.cache),pa();break;case 27:case 5:he(s);break;case 4:be(s,s.stateNode.containerInfo);break;case 10:ss(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Jf(s),null;break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(cs(s),s.flags|=128,null):(o&s.child.childLanes)!==0?O0(r,s,o):(cs(s),r=wi(r,s,o),r!==null?r.sibling:null);cs(s);break;case 19:var g=(r.flags&128)!==0;if(u=(o&s.childLanes)!==0,u||(oo(r,s,o,!1),u=(o&s.childLanes)!==0),g){if(u)return k0(r,s,o);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),ce(Ot,Ot.current),u)break;return null;case 22:return s.lanes=0,A0(r,s,o,s.pendingProps);case 24:ss(s,zt,r.memoizedState.cache)}return wi(r,s,o)}function N0(r,s,o){if(r!==null)if(r.memoizedProps!==s.pendingProps)Ft=!0;else{if(!Cm(r,o)&&(s.flags&128)===0)return Ft=!1,S1(r,s,o);Ft=(r.flags&131072)!==0}else Ft=!1,Xe&&(s.flags&1048576)!==0&&f_(s,$l,s.index);switch(s.lanes=0,s.tag){case 16:e:{var u=s.pendingProps;if(r=va(s.elementType),s.type=r,typeof r=="function")Of(r)?(u=Sa(r,u),s.tag=1,s=I0(null,s,r,u,o)):(s.tag=0,s=bm(null,s,r,u,o));else{if(r!=null){var g=r.$$typeof;if(g===X){s.tag=11,s=S0(null,s,r,u,o);break e}else if(g===M){s.tag=14,s=w0(null,s,r,u,o);break e}}throw s=Y(r)||r,Error(i(306,s,""))}}return s;case 0:return bm(r,s,s.type,s.pendingProps,o);case 1:return u=s.type,g=Sa(u,s.pendingProps),I0(r,s,u,g,o);case 3:e:{if(be(s,s.stateNode.containerInfo),r===null)throw Error(i(387));u=s.pendingProps;var y=s.memoizedState;g=y.element,$f(r,s),tc(s,u,null,o);var x=s.memoizedState;if(u=x.cache,ss(s,zt,u),u!==y.cache&&Uf(s,[zt],o,!0),ec(),u=x.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:x.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=j0(r,s,u,o);break e}else if(u!==g){g=nr(Error(i(424)),s),Kl(g),s=j0(r,s,u,o);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,yt=or(r.firstChild),dn=s,Xe=!0,rs=null,sr=!0,o=A_(s,null,u,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(pa(),u===g){s=wi(r,s,o);break e}fn(r,s,u,o)}s=s.child}return s;case 26:return fd(r,s),r===null?(o=Hv(s.type,null,s.pendingProps,null))?s.memoizedState=o:Xe||(o=s.type,r=s.pendingProps,u=Id(_e.current).createElement(o),u[Vt]=s,u[tn]=r,mn(u,o,r),Lt(u),s.stateNode=u):s.memoizedState=Hv(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return he(s),r===null&&Xe&&(u=s.stateNode=qv(s.type,s.pendingProps,_e.current),dn=s,sr=!0,g=yt,_s(s.type)?(ap=g,yt=or(u.firstChild)):yt=g),fn(r,s,s.pendingProps.children,o),fd(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&Xe&&((g=u=yt)&&(u=Z1(u,s.type,s.pendingProps,sr),u!==null?(s.stateNode=u,dn=s,yt=or(u.firstChild),sr=!1,g=!0):g=!1),g||is(s)),he(s),g=s.type,y=s.pendingProps,x=r!==null?r.memoizedProps:null,u=y.children,tp(g,y)?u=null:x!==null&&tp(g,x)&&(s.flags|=32),s.memoizedState!==null&&(g=em(r,s,m1,null,null,o),Ec._currentValue=g),fd(r,s),fn(r,s,u,o),s.child;case 6:return r===null&&Xe&&((r=o=yt)&&(o=eA(o,s.pendingProps,sr),o!==null?(s.stateNode=o,dn=s,yt=null,r=!0):r=!1),r||is(s)),null;case 13:return O0(r,s,o);case 4:return be(s,s.stateNode.containerInfo),u=s.pendingProps,r===null?s.child=Ea(s,null,u,o):fn(r,s,u,o),s.child;case 11:return S0(r,s,s.type,s.pendingProps,o);case 7:return fn(r,s,s.pendingProps,o),s.child;case 8:return fn(r,s,s.pendingProps.children,o),s.child;case 12:return fn(r,s,s.pendingProps.children,o),s.child;case 10:return u=s.pendingProps,ss(s,s.type,u.value),fn(r,s,u.children,o),s.child;case 9:return g=s.type._context,u=s.pendingProps.children,ya(s),g=hn(g),u=u(g),s.flags|=1,fn(r,s,u,o),s.child;case 14:return w0(r,s,s.type,s.pendingProps,o);case 15:return T0(r,s,s.type,s.pendingProps,o);case 19:return k0(r,s,o);case 31:return x1(r,s,o);case 22:return A0(r,s,o,s.pendingProps);case 24:return ya(s),u=hn(zt),r===null?(g=Qf(),g===null&&(g=mt,y=Ff(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=o),g=y),s.memoizedState={parent:u,cache:g},Hf(s),ss(s,zt,g)):((r.lanes&o)!==0&&($f(r,s),tc(s,null,null,o),ec()),g=r.memoizedState,y=s.memoizedState,g.parent!==u?(g={parent:u,cache:u},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),ss(s,zt,u)):(u=y.cache,ss(s,zt,u),u!==g.cache&&Uf(s,[zt],o,!0))),fn(r,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Ti(r){r.flags|=4}function Rm(r,s,o,u,g){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(g&335544128)===g)if(r.stateNode.complete)r.flags|=8192;else if(lv())r.flags|=8192;else throw ba=Ju,Gf}else r.flags&=-16777217}function P0(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Xv(s))if(lv())r.flags|=8192;else throw ba=Ju,Gf}function pd(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?Eu():536870912,r.lanes|=s,bo|=s)}function oc(r,s){if(!Xe)switch(r.tailMode){case"hidden":s=r.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function _t(r){var s=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(s)for(var g=r.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)o|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=u,r.childLanes=o,s}function w1(r,s,o){var u=s.pendingProps;switch(Pf(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _t(s),null;case 1:return _t(s),null;case 3:return o=s.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),Ei(zt),xe(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(ao(s)?Ti(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Lf())),_t(s),null;case 26:var g=s.type,y=s.memoizedState;return r===null?(Ti(s),y!==null?(_t(s),P0(s,y)):(_t(s),Rm(s,g,null,u,o))):y?y!==r.memoizedState?(Ti(s),_t(s),P0(s,y)):(_t(s),s.flags&=-16777217):(r=r.memoizedProps,r!==u&&Ti(s),_t(s),Rm(s,g,r,u,o)),null;case 27:if(nt(s),o=_e.current,g=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==u&&Ti(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return _t(s),null}r=J.current,ao(s)?p_(s):(r=qv(g,u,o),s.stateNode=r,Ti(s))}return _t(s),null;case 5:if(nt(s),g=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==u&&Ti(s);else{if(!u){if(s.stateNode===null)throw Error(i(166));return _t(s),null}if(y=J.current,ao(s))p_(s);else{var x=Id(_e.current);switch(y){case 1:y=x.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=x.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=x.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=x.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=x.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?x.createElement("select",{is:u.is}):x.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?x.createElement(g,{is:u.is}):x.createElement(g)}}y[Vt]=s,y[tn]=u;e:for(x=s.child;x!==null;){if(x.tag===5||x.tag===6)y.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===s)break e;for(;x.sibling===null;){if(x.return===null||x.return===s)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}s.stateNode=y;e:switch(mn(y,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Ti(s)}}return _t(s),Rm(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,o),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==u&&Ti(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(i(166));if(r=_e.current,ao(s)){if(r=s.stateNode,o=s.memoizedProps,u=null,g=dn,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}r[Vt]=s,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Ov(r.nodeValue,o)),r||is(s,!0)}else r=Id(r).createTextNode(u),r[Vt]=s,s.stateNode=r}return _t(s),null;case 31:if(o=s.memoizedState,r===null||r.memoizedState!==null){if(u=ao(s),o!==null){if(r===null){if(!u)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Vt]=s}else pa(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;_t(s),r=!1}else o=Lf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return s.flags&256?(qn(s),s):(qn(s),null);if((s.flags&128)!==0)throw Error(i(558))}return _t(s),null;case 13:if(u=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=ao(s),u!==null&&u.dehydrated!==null){if(r===null){if(!g)throw Error(i(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[Vt]=s}else pa(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;_t(s),g=!1}else g=Lf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(qn(s),s):(qn(s),null)}return qn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=u!==null,r=r!==null&&r.memoizedState!==null,o&&(u=s.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==g&&(u.flags|=2048)),o!==r&&o&&(s.child.flags|=8192),pd(s,s.updateQueue),_t(s),null);case 4:return xe(),r===null&&Wm(s.stateNode.containerInfo),_t(s),null;case 10:return Ei(s.type),_t(s),null;case 19:if(G(Ot),u=s.memoizedState,u===null)return _t(s),null;if(g=(s.flags&128)!==0,y=u.rendering,y===null)if(g)oc(u,!1);else{if(Dt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(y=nd(r),y!==null){for(s.flags|=128,oc(u,!1),r=y.updateQueue,s.updateQueue=r,pd(s,r),s.subtreeFlags=0,r=o,o=s.child;o!==null;)u_(o,r),o=o.sibling;return ce(Ot,Ot.current&1|2),Xe&&vi(s,u.treeForkCount),s.child}r=r.sibling}u.tail!==null&&Yt()>bd&&(s.flags|=128,g=!0,oc(u,!1),s.lanes=4194304)}else{if(!g)if(r=nd(y),r!==null){if(s.flags|=128,g=!0,r=r.updateQueue,s.updateQueue=r,pd(s,r),oc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!Xe)return _t(s),null}else 2*Yt()-u.renderingStartTime>bd&&o!==536870912&&(s.flags|=128,g=!0,oc(u,!1),s.lanes=4194304);u.isBackwards?(y.sibling=s.child,s.child=y):(r=u.last,r!==null?r.sibling=y:s.child=y,u.last=y)}return u.tail!==null?(r=u.tail,u.rendering=r,u.tail=r.sibling,u.renderingStartTime=Yt(),r.sibling=null,o=Ot.current,ce(Ot,g?o&1|2:o&1),Xe&&vi(s,u.treeForkCount),r):(_t(s),null);case 22:case 23:return qn(s),Xf(),u=s.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?(o&536870912)!==0&&(s.flags&128)===0&&(_t(s),s.subtreeFlags&6&&(s.flags|=8192)):_t(s),o=s.updateQueue,o!==null&&pd(s,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==o&&(s.flags|=2048),r!==null&&G(_a),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Ei(zt),_t(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function T1(r,s){switch(Pf(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Ei(zt),xe(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return nt(s),null;case 31:if(s.memoizedState!==null){if(qn(s),s.alternate===null)throw Error(i(340));pa()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(qn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));pa()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return G(Ot),null;case 4:return xe(),null;case 10:return Ei(s.type),null;case 22:case 23:return qn(s),Xf(),r!==null&&G(_a),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return Ei(zt),null;case 25:return null;default:return null}}function V0(r,s){switch(Pf(s),s.tag){case 3:Ei(zt),xe();break;case 26:case 27:case 5:nt(s);break;case 4:xe();break;case 31:s.memoizedState!==null&&qn(s);break;case 13:qn(s);break;case 19:G(Ot);break;case 10:Ei(s.type);break;case 22:case 23:qn(s),Xf(),r!==null&&G(_a);break;case 24:Ei(zt)}}function lc(r,s){try{var o=s.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var g=u.next;o=g;do{if((o.tag&r)===r){u=void 0;var y=o.create,x=o.inst;u=y(),x.destroy=u}o=o.next}while(o!==g)}}catch(k){ct(s,s.return,k)}}function ds(r,s,o){try{var u=s.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var y=g.next;u=y;do{if((u.tag&r)===r){var x=u.inst,k=x.destroy;if(k!==void 0){x.destroy=void 0,g=s;var $=o,ae=k;try{ae()}catch(fe){ct(g,$,fe)}}}u=u.next}while(u!==y)}}catch(fe){ct(s,s.return,fe)}}function L0(r){var s=r.updateQueue;if(s!==null){var o=r.stateNode;try{R_(s,o)}catch(u){ct(r,r.return,u)}}}function B0(r,s,o){o.props=Sa(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){ct(r,s,u)}}function cc(r,s){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(g){ct(r,s,g)}}function Zr(r,s){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(g){ct(r,s,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){ct(r,s,g)}else o.current=null}function z0(r){var s=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(g){ct(r,r.return,g)}}function Dm(r,s,o){try{var u=r.stateNode;$1(u,r.type,o,s),u[tn]=s}catch(g){ct(r,r.return,g)}}function U0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&_s(r.type)||r.tag===4}function Im(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||U0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&_s(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function jm(r,s,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(r),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=_r));else if(u!==4&&(u===27&&_s(r.type)&&(o=r.stateNode,s=null),r=r.child,r!==null))for(jm(r,s,o),r=r.sibling;r!==null;)jm(r,s,o),r=r.sibling}function gd(r,s,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,s?o.insertBefore(r,s):o.appendChild(r);else if(u!==4&&(u===27&&_s(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(gd(r,s,o),r=r.sibling;r!==null;)gd(r,s,o),r=r.sibling}function F0(r){var s=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);mn(s,u,o),s[Vt]=r,s[tn]=o}catch(y){ct(r,r.return,y)}}var Ai=!1,qt=!1,Om=!1,q0=typeof WeakSet=="function"?WeakSet:Set,rn=null;function A1(r,s){if(r=r.containerInfo,Zm=Vd,r=t_(r),Tf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var g=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var x=0,k=-1,$=-1,ae=0,fe=0,pe=r,le=null;t:for(;;){for(var de;pe!==o||g!==0&&pe.nodeType!==3||(k=x+g),pe!==y||u!==0&&pe.nodeType!==3||($=x+u),pe.nodeType===3&&(x+=pe.nodeValue.length),(de=pe.firstChild)!==null;)le=pe,pe=de;for(;;){if(pe===r)break t;if(le===o&&++ae===g&&(k=x),le===y&&++fe===u&&($=x),(de=pe.nextSibling)!==null)break;pe=le,le=pe.parentNode}pe=de}o=k===-1||$===-1?null:{start:k,end:$}}else o=null}o=o||{start:0,end:0}}else o=null;for(ep={focusedElem:r,selectionRange:o},Vd=!1,rn=s;rn!==null;)if(s=rn,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,rn=r;else for(;rn!==null;){switch(s=rn,y=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)g=r[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=s,g=y.memoizedProps,y=y.memoizedState,u=o.stateNode;try{var Ae=Sa(o.type,g);r=u.getSnapshotBeforeUpdate(Ae,y),u.__reactInternalSnapshotBeforeUpdate=r}catch(je){ct(o,o.return,je)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,o=r.nodeType,o===9)rp(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":rp(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,rn=r;break}rn=s.return}}function Q0(r,s,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:Ri(r,o),u&4&&lc(5,o);break;case 1:if(Ri(r,o),u&4)if(r=o.stateNode,s===null)try{r.componentDidMount()}catch(x){ct(o,o.return,x)}else{var g=Sa(o.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(g,s,r.__reactInternalSnapshotBeforeUpdate)}catch(x){ct(o,o.return,x)}}u&64&&L0(o),u&512&&cc(o,o.return);break;case 3:if(Ri(r,o),u&64&&(r=o.updateQueue,r!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{R_(r,s)}catch(x){ct(o,o.return,x)}}break;case 27:s===null&&u&4&&F0(o);case 26:case 5:Ri(r,o),s===null&&u&4&&z0(o),u&512&&cc(o,o.return);break;case 12:Ri(r,o);break;case 31:Ri(r,o),u&4&&$0(r,o);break;case 13:Ri(r,o),u&4&&K0(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=N1.bind(null,o),tA(r,o))));break;case 22:if(u=o.memoizedState!==null||Ai,!u){s=s!==null&&s.memoizedState!==null||qt,g=Ai;var y=qt;Ai=u,(qt=s)&&!y?Di(r,o,(o.subtreeFlags&8772)!==0):Ri(r,o),Ai=g,qt=y}break;case 30:break;default:Ri(r,o)}}function G0(r){var s=r.alternate;s!==null&&(r.alternate=null,G0(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&qa(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Et=null,Dn=!1;function Ci(r,s,o){for(o=o.child;o!==null;)H0(r,s,o),o=o.sibling}function H0(r,s,o){if(cn&&typeof cn.onCommitFiberUnmount=="function")try{cn.onCommitFiberUnmount(mr,o)}catch{}switch(o.tag){case 26:qt||Zr(o,s),Ci(r,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:qt||Zr(o,s);var u=Et,g=Dn;_s(o.type)&&(Et=o.stateNode,Dn=!1),Ci(r,s,o),_c(o.stateNode),Et=u,Dn=g;break;case 5:qt||Zr(o,s);case 6:if(u=Et,g=Dn,Et=null,Ci(r,s,o),Et=u,Dn=g,Et!==null)if(Dn)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(o.stateNode)}catch(y){ct(o,s,y)}else try{Et.removeChild(o.stateNode)}catch(y){ct(o,s,y)}break;case 18:Et!==null&&(Dn?(r=Et,Lv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),Ro(r)):Lv(Et,o.stateNode));break;case 4:u=Et,g=Dn,Et=o.stateNode.containerInfo,Dn=!0,Ci(r,s,o),Et=u,Dn=g;break;case 0:case 11:case 14:case 15:ds(2,o,s),qt||ds(4,o,s),Ci(r,s,o);break;case 1:qt||(Zr(o,s),u=o.stateNode,typeof u.componentWillUnmount=="function"&&B0(o,s,u)),Ci(r,s,o);break;case 21:Ci(r,s,o);break;case 22:qt=(u=qt)||o.memoizedState!==null,Ci(r,s,o),qt=u;break;default:Ci(r,s,o)}}function $0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Ro(r)}catch(o){ct(s,s.return,o)}}}function K0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Ro(r)}catch(o){ct(s,s.return,o)}}function C1(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new q0),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new q0),s;default:throw Error(i(435,r.tag))}}function yd(r,s){var o=C1(r);s.forEach(function(u){if(!o.has(u)){o.add(u);var g=P1.bind(null,r,u);u.then(g,g)}})}function In(r,s){var o=s.deletions;if(o!==null)for(var u=0;u<o.length;u++){var g=o[u],y=r,x=s,k=x;e:for(;k!==null;){switch(k.tag){case 27:if(_s(k.type)){Et=k.stateNode,Dn=!1;break e}break;case 5:Et=k.stateNode,Dn=!1;break e;case 3:case 4:Et=k.stateNode.containerInfo,Dn=!0;break e}k=k.return}if(Et===null)throw Error(i(160));H0(y,x,g),Et=null,Dn=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Y0(s,r),s=s.sibling}var wr=null;function Y0(r,s){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:In(s,r),jn(r),u&4&&(ds(3,r,r.return),lc(3,r),ds(5,r,r.return));break;case 1:In(s,r),jn(r),u&512&&(qt||o===null||Zr(o,o.return)),u&64&&Ai&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var g=wr;if(In(s,r),jn(r),u&512&&(qt||o===null||Zr(o,o.return)),u&4){var y=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":y=g.getElementsByTagName("title")[0],(!y||y[Br]||y[Vt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(u),g.head.insertBefore(y,g.querySelector("head > title"))),mn(y,u,o),y[Vt]=r,Lt(y),u=y;break e;case"link":var x=Yv("link","href",g).get(u+(o.href||""));if(x){for(var k=0;k<x.length;k++)if(y=x[k],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){x.splice(k,1);break t}}y=g.createElement(u),mn(y,u,o),g.head.appendChild(y);break;case"meta":if(x=Yv("meta","content",g).get(u+(o.content||""))){for(k=0;k<x.length;k++)if(y=x[k],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){x.splice(k,1);break t}}y=g.createElement(u),mn(y,u,o),g.head.appendChild(y);break;default:throw Error(i(468,u))}y[Vt]=r,Lt(y),u=y}r.stateNode=u}else Wv(g,r.type,r.stateNode);else r.stateNode=Kv(g,u,r.memoizedProps);else y!==u?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,u===null?Wv(g,r.type,r.stateNode):Kv(g,u,r.memoizedProps)):u===null&&r.stateNode!==null&&Dm(r,r.memoizedProps,o.memoizedProps)}break;case 27:In(s,r),jn(r),u&512&&(qt||o===null||Zr(o,o.return)),o!==null&&u&4&&Dm(r,r.memoizedProps,o.memoizedProps);break;case 5:if(In(s,r),jn(r),u&512&&(qt||o===null||Zr(o,o.return)),r.flags&32){g=r.stateNode;try{Rn(g,"")}catch(Ae){ct(r,r.return,Ae)}}u&4&&r.stateNode!=null&&(g=r.memoizedProps,Dm(r,g,o!==null?o.memoizedProps:g)),u&1024&&(Om=!0);break;case 6:if(In(s,r),jn(r),u&4){if(r.stateNode===null)throw Error(i(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(Ae){ct(r,r.return,Ae)}}break;case 3:if(Md=null,g=wr,wr=jd(s.containerInfo),In(s,r),wr=g,jn(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Ro(s.containerInfo)}catch(Ae){ct(r,r.return,Ae)}Om&&(Om=!1,W0(r));break;case 4:u=wr,wr=jd(r.stateNode.containerInfo),In(s,r),jn(r),wr=u;break;case 12:In(s,r),jn(r);break;case 31:In(s,r),jn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,yd(r,u)));break;case 13:In(s,r),jn(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(vd=Yt()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,yd(r,u)));break;case 22:g=r.memoizedState!==null;var $=o!==null&&o.memoizedState!==null,ae=Ai,fe=qt;if(Ai=ae||g,qt=fe||$,In(s,r),qt=fe,Ai=ae,jn(r),u&8192)e:for(s=r.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(o===null||$||Ai||qt||wa(r)),o=null,s=r;;){if(s.tag===5||s.tag===26){if(o===null){$=o=s;try{if(y=$.stateNode,g)x=y.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{k=$.stateNode;var pe=$.memoizedProps.style,le=pe!=null&&pe.hasOwnProperty("display")?pe.display:null;k.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(Ae){ct($,$.return,Ae)}}}else if(s.tag===6){if(o===null){$=s;try{$.stateNode.nodeValue=g?"":$.memoizedProps}catch(Ae){ct($,$.return,Ae)}}}else if(s.tag===18){if(o===null){$=s;try{var de=$.stateNode;g?Bv(de,!0):Bv($.stateNode,!1)}catch(Ae){ct($,$.return,Ae)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,yd(r,o))));break;case 19:In(s,r),jn(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,yd(r,u)));break;case 30:break;case 21:break;default:In(s,r),jn(r)}}function jn(r){var s=r.flags;if(s&2){try{for(var o,u=r.return;u!==null;){if(U0(u)){o=u;break}u=u.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var g=o.stateNode,y=Im(r);gd(r,y,g);break;case 5:var x=o.stateNode;o.flags&32&&(Rn(x,""),o.flags&=-33);var k=Im(r);gd(r,k,x);break;case 3:case 4:var $=o.stateNode.containerInfo,ae=Im(r);jm(r,ae,$);break;default:throw Error(i(161))}}catch(fe){ct(r,r.return,fe)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function W0(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;W0(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Ri(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Q0(r,s.alternate,s),s=s.sibling}function wa(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:ds(4,s,s.return),wa(s);break;case 1:Zr(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&B0(s,s.return,o),wa(s);break;case 27:_c(s.stateNode);case 26:case 5:Zr(s,s.return),wa(s);break;case 22:s.memoizedState===null&&wa(s);break;case 30:wa(s);break;default:wa(s)}r=r.sibling}}function Di(r,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,g=r,y=s,x=y.flags;switch(y.tag){case 0:case 11:case 15:Di(g,y,o),lc(4,y);break;case 1:if(Di(g,y,o),u=y,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ae){ct(u,u.return,ae)}if(u=y,g=u.updateQueue,g!==null){var k=u.stateNode;try{var $=g.shared.hiddenCallbacks;if($!==null)for(g.shared.hiddenCallbacks=null,g=0;g<$.length;g++)C_($[g],k)}catch(ae){ct(u,u.return,ae)}}o&&x&64&&L0(y),cc(y,y.return);break;case 27:F0(y);case 26:case 5:Di(g,y,o),o&&u===null&&x&4&&z0(y),cc(y,y.return);break;case 12:Di(g,y,o);break;case 31:Di(g,y,o),o&&x&4&&$0(g,y);break;case 13:Di(g,y,o),o&&x&4&&K0(g,y);break;case 22:y.memoizedState===null&&Di(g,y,o),cc(y,y.return);break;case 30:break;default:Di(g,y,o)}s=s.sibling}}function Mm(r,s){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&Yl(o))}function km(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Yl(r))}function Tr(r,s,o,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)X0(r,s,o,u),s=s.sibling}function X0(r,s,o,u){var g=s.flags;switch(s.tag){case 0:case 11:case 15:Tr(r,s,o,u),g&2048&&lc(9,s);break;case 1:Tr(r,s,o,u);break;case 3:Tr(r,s,o,u),g&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Yl(r)));break;case 12:if(g&2048){Tr(r,s,o,u),r=s.stateNode;try{var y=s.memoizedProps,x=y.id,k=y.onPostCommit;typeof k=="function"&&k(x,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch($){ct(s,s.return,$)}}else Tr(r,s,o,u);break;case 31:Tr(r,s,o,u);break;case 13:Tr(r,s,o,u);break;case 23:break;case 22:y=s.stateNode,x=s.alternate,s.memoizedState!==null?y._visibility&2?Tr(r,s,o,u):uc(r,s):y._visibility&2?Tr(r,s,o,u):(y._visibility|=2,yo(r,s,o,u,(s.subtreeFlags&10256)!==0||!1)),g&2048&&Mm(x,s);break;case 24:Tr(r,s,o,u),g&2048&&km(s.alternate,s);break;default:Tr(r,s,o,u)}}function yo(r,s,o,u,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=r,x=s,k=o,$=u,ae=x.flags;switch(x.tag){case 0:case 11:case 15:yo(y,x,k,$,g),lc(8,x);break;case 23:break;case 22:var fe=x.stateNode;x.memoizedState!==null?fe._visibility&2?yo(y,x,k,$,g):uc(y,x):(fe._visibility|=2,yo(y,x,k,$,g)),g&&ae&2048&&Mm(x.alternate,x);break;case 24:yo(y,x,k,$,g),g&&ae&2048&&km(x.alternate,x);break;default:yo(y,x,k,$,g)}s=s.sibling}}function uc(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=r,u=s,g=u.flags;switch(u.tag){case 22:uc(o,u),g&2048&&Mm(u.alternate,u);break;case 24:uc(o,u),g&2048&&km(u.alternate,u);break;default:uc(o,u)}s=s.sibling}}var dc=8192;function _o(r,s,o){if(r.subtreeFlags&dc)for(r=r.child;r!==null;)J0(r,s,o),r=r.sibling}function J0(r,s,o){switch(r.tag){case 26:_o(r,s,o),r.flags&dc&&r.memoizedState!==null&&fA(o,wr,r.memoizedState,r.memoizedProps);break;case 5:_o(r,s,o);break;case 3:case 4:var u=wr;wr=jd(r.stateNode.containerInfo),_o(r,s,o),wr=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=dc,dc=16777216,_o(r,s,o),dc=u):_o(r,s,o));break;default:_o(r,s,o)}}function Z0(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function hc(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];rn=u,tv(u,r)}Z0(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)ev(r),r=r.sibling}function ev(r){switch(r.tag){case 0:case 11:case 15:hc(r),r.flags&2048&&ds(9,r,r.return);break;case 3:hc(r);break;case 12:hc(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,_d(r)):hc(r);break;default:hc(r)}}function _d(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];rn=u,tv(u,r)}Z0(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:ds(8,s,s.return),_d(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,_d(s));break;default:_d(s)}r=r.sibling}}function tv(r,s){for(;rn!==null;){var o=rn;switch(o.tag){case 0:case 11:case 15:ds(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Yl(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,rn=u;else e:for(o=r;rn!==null;){u=rn;var g=u.sibling,y=u.return;if(G0(u),u===o){rn=null;break e}if(g!==null){g.return=y,rn=g;break e}rn=y}}}var R1={getCacheForType:function(r){var s=hn(zt),o=s.data.get(r);return o===void 0&&(o=r(),s.data.set(r,o)),o},cacheSignal:function(){return hn(zt).controller.signal}},D1=typeof WeakMap=="function"?WeakMap:Map,it=0,mt=null,Qe=null,He=0,lt=0,Qn=null,hs=!1,vo=!1,Nm=!1,Ii=0,Dt=0,fs=0,Ta=0,Pm=0,Gn=0,bo=0,fc=null,On=null,Vm=!1,vd=0,nv=0,bd=1/0,Ed=null,ms=null,Wt=0,ps=null,Eo=null,ji=0,Lm=0,Bm=null,rv=null,mc=0,zm=null;function Hn(){return(it&2)!==0&&He!==0?He&-He:P.T!==null?Hm():xu()}function iv(){if(Gn===0)if((He&536870912)===0||Xe){var r=Js;Js<<=1,(Js&3932160)===0&&(Js=262144),Gn=r}else Gn=536870912;return r=Fn.current,r!==null&&(r.flags|=32),Gn}function Mn(r,s,o){(r===mt&&(lt===2||lt===9)||r.cancelPendingCommit!==null)&&(xo(r,0),gs(r,He,Gn,!1)),Zs(r,o),((it&2)===0||r!==mt)&&(r===mt&&((it&2)===0&&(Ta|=o),Dt===4&&gs(r,He,Gn,!1)),ei(r))}function sv(r,s,o){if((it&6)!==0)throw Error(i(327));var u=!o&&(s&127)===0&&(s&r.expiredLanes)===0||pr(r,s),g=u?O1(r,s):Fm(r,s,!0),y=u;do{if(g===0){vo&&!u&&gs(r,s,0,!1);break}else{if(o=r.current.alternate,y&&!I1(o)){g=Fm(r,s,!1),y=!1;continue}if(g===2){if(y=s,r.errorRecoveryDisabledLanes&y)var x=0;else x=r.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){s=x;e:{var k=r;g=fc;var $=k.current.memoizedState.isDehydrated;if($&&(xo(k,x).flags|=256),x=Fm(k,x,!1),x!==2){if(Nm&&!$){k.errorRecoveryDisabledLanes|=y,Ta|=y,g=4;break e}y=On,On=g,y!==null&&(On===null?On=y:On.push.apply(On,y))}g=x}if(y=!1,g!==2)continue}}if(g===1){xo(r,0),gs(r,s,0,!0);break}e:{switch(u=r,y=g,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:gs(u,s,Gn,!hs);break e;case 2:On=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(g=vd+300-Yt(),10<g)){if(gs(u,s,Gn,!hs),Pr(u,0,!0)!==0)break e;ji=s,u.timeoutHandle=Pv(av.bind(null,u,o,On,Ed,Vm,s,Gn,Ta,bo,hs,y,"Throttled",-0,0),g);break e}av(u,o,On,Ed,Vm,s,Gn,Ta,bo,hs,y,null,-0,0)}}break}while(!0);ei(r)}function av(r,s,o,u,g,y,x,k,$,ae,fe,pe,le,de){if(r.timeoutHandle=-1,pe=s.subtreeFlags,pe&8192||(pe&16785408)===16785408){pe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_r},J0(s,y,pe);var Ae=(y&62914560)===y?vd-Yt():(y&4194048)===y?nv-Yt():0;if(Ae=mA(pe,Ae),Ae!==null){ji=y,r.cancelPendingCommit=Ae(mv.bind(null,r,s,y,o,u,g,x,k,$,fe,pe,null,le,de)),gs(r,y,x,!ae);return}}mv(r,s,y,o,u,g,x,k,$)}function I1(r){for(var s=r;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var g=o[u],y=g.getSnapshot;g=g.value;try{if(!zn(y(),g))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function gs(r,s,o,u){s&=~Pm,s&=~Ta,r.suspendedLanes|=s,r.pingedLanes&=~s,u&&(r.warmLanes|=s),u=r.expirationTimes;for(var g=s;0<g;){var y=31-It(g),x=1<<y;u[y]=-1,g&=~x}o!==0&&ea(r,o,s)}function xd(){return(it&6)===0?(pc(0),!1):!0}function Um(){if(Qe!==null){if(lt===0)var r=Qe.return;else r=Qe,bi=ga=null,rm(r),ho=null,Xl=0,r=Qe;for(;r!==null;)V0(r.alternate,r),r=r.return;Qe=null}}function xo(r,s){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,W1(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),ji=0,Um(),mt=r,Qe=o=_i(r.current,null),He=s,lt=0,Qn=null,hs=!1,vo=pr(r,s),Nm=!1,bo=Gn=Pm=Ta=fs=Dt=0,On=fc=null,Vm=!1,(s&8)!==0&&(s|=s&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=s;0<u;){var g=31-It(u),y=1<<g;s|=r[g],u&=~y}return Ii=s,qu(),o}function ov(r,s){ze=null,P.H=sc,s===uo||s===Xu?(s=S_(),lt=3):s===Gf?(s=S_(),lt=4):lt=s===vm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Qn=s,Qe===null&&(Dt=1,dd(r,nr(s,r.current)))}function lv(){var r=Fn.current;return r===null?!0:(He&4194048)===He?ar===null:(He&62914560)===He||(He&536870912)!==0?r===ar:!1}function cv(){var r=P.H;return P.H=sc,r===null?sc:r}function uv(){var r=P.A;return P.A=R1,r}function Sd(){Dt=4,hs||(He&4194048)!==He&&Fn.current!==null||(vo=!0),(fs&134217727)===0&&(Ta&134217727)===0||mt===null||gs(mt,He,Gn,!1)}function Fm(r,s,o){var u=it;it|=2;var g=cv(),y=uv();(mt!==r||He!==s)&&(Ed=null,xo(r,s)),s=!1;var x=Dt;e:do try{if(lt!==0&&Qe!==null){var k=Qe,$=Qn;switch(lt){case 8:Um(),x=6;break e;case 3:case 2:case 9:case 6:Fn.current===null&&(s=!0);var ae=lt;if(lt=0,Qn=null,So(r,k,$,ae),o&&vo){x=0;break e}break;default:ae=lt,lt=0,Qn=null,So(r,k,$,ae)}}j1(),x=Dt;break}catch(fe){ov(r,fe)}while(!0);return s&&r.shellSuspendCounter++,bi=ga=null,it=u,P.H=g,P.A=y,Qe===null&&(mt=null,He=0,qu()),x}function j1(){for(;Qe!==null;)dv(Qe)}function O1(r,s){var o=it;it|=2;var u=cv(),g=uv();mt!==r||He!==s?(Ed=null,bd=Yt()+500,xo(r,s)):vo=pr(r,s);e:do try{if(lt!==0&&Qe!==null){s=Qe;var y=Qn;t:switch(lt){case 1:lt=0,Qn=null,So(r,s,y,1);break;case 2:case 9:if(E_(y)){lt=0,Qn=null,hv(s);break}s=function(){lt!==2&&lt!==9||mt!==r||(lt=7),ei(r)},y.then(s,s);break e;case 3:lt=7;break e;case 4:lt=5;break e;case 7:E_(y)?(lt=0,Qn=null,hv(s)):(lt=0,Qn=null,So(r,s,y,7));break;case 5:var x=null;switch(Qe.tag){case 26:x=Qe.memoizedState;case 5:case 27:var k=Qe;if(x?Xv(x):k.stateNode.complete){lt=0,Qn=null;var $=k.sibling;if($!==null)Qe=$;else{var ae=k.return;ae!==null?(Qe=ae,wd(ae)):Qe=null}break t}}lt=0,Qn=null,So(r,s,y,5);break;case 6:lt=0,Qn=null,So(r,s,y,6);break;case 8:Um(),Dt=6;break e;default:throw Error(i(462))}}M1();break}catch(fe){ov(r,fe)}while(!0);return bi=ga=null,P.H=u,P.A=g,it=o,Qe!==null?0:(mt=null,He=0,qu(),Dt)}function M1(){for(;Qe!==null&&!Sl();)dv(Qe)}function dv(r){var s=N0(r.alternate,r,Ii);r.memoizedProps=r.pendingProps,s===null?wd(r):Qe=s}function hv(r){var s=r,o=s.alternate;switch(s.tag){case 15:case 0:s=D0(o,s,s.pendingProps,s.type,void 0,He);break;case 11:s=D0(o,s,s.pendingProps,s.type.render,s.ref,He);break;case 5:rm(s);default:V0(o,s),s=Qe=u_(s,Ii),s=N0(o,s,Ii)}r.memoizedProps=r.pendingProps,s===null?wd(r):Qe=s}function So(r,s,o,u){bi=ga=null,rm(s),ho=null,Xl=0;var g=s.return;try{if(E1(r,g,s,o,He)){Dt=1,dd(r,nr(o,r.current)),Qe=null;return}}catch(y){if(g!==null)throw Qe=g,y;Dt=1,dd(r,nr(o,r.current)),Qe=null;return}s.flags&32768?(Xe||u===1?r=!0:vo||(He&536870912)!==0?r=!1:(hs=r=!0,(u===2||u===9||u===3||u===6)&&(u=Fn.current,u!==null&&u.tag===13&&(u.flags|=16384))),fv(s,r)):wd(s)}function wd(r){var s=r;do{if((s.flags&32768)!==0){fv(s,hs);return}r=s.return;var o=w1(s.alternate,s,Ii);if(o!==null){Qe=o;return}if(s=s.sibling,s!==null){Qe=s;return}Qe=s=r}while(s!==null);Dt===0&&(Dt=5)}function fv(r,s){do{var o=T1(r.alternate,r);if(o!==null){o.flags&=32767,Qe=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(r=r.sibling,r!==null)){Qe=r;return}Qe=r=o}while(r!==null);Dt=6,Qe=null}function mv(r,s,o,u,g,y,x,k,$){r.cancelPendingCommit=null;do Td();while(Wt!==0);if((it&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=If,Ef(r,o,y,x,k,$),r===mt&&(Qe=mt=null,He=0),Eo=s,ps=r,ji=o,Lm=y,Bm=g,rv=u,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,V1(Hi,function(){return vv(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||u){u=P.T,P.T=null,g=Q.p,Q.p=2,x=it,it|=4;try{A1(r,s,o)}finally{it=x,Q.p=g,P.T=u}}Wt=1,pv(),gv(),yv()}}function pv(){if(Wt===1){Wt=0;var r=ps,s=Eo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=P.T,P.T=null;var u=Q.p;Q.p=2;var g=it;it|=4;try{Y0(s,r);var y=ep,x=t_(r.containerInfo),k=y.focusedElem,$=y.selectionRange;if(x!==k&&k&&k.ownerDocument&&e_(k.ownerDocument.documentElement,k)){if($!==null&&Tf(k)){var ae=$.start,fe=$.end;if(fe===void 0&&(fe=ae),"selectionStart"in k)k.selectionStart=ae,k.selectionEnd=Math.min(fe,k.value.length);else{var pe=k.ownerDocument||document,le=pe&&pe.defaultView||window;if(le.getSelection){var de=le.getSelection(),Ae=k.textContent.length,je=Math.min($.start,Ae),ft=$.end===void 0?je:Math.min($.end,Ae);!de.extend&&je>ft&&(x=ft,ft=je,je=x);var ee=Zy(k,je),W=Zy(k,ft);if(ee&&W&&(de.rangeCount!==1||de.anchorNode!==ee.node||de.anchorOffset!==ee.offset||de.focusNode!==W.node||de.focusOffset!==W.offset)){var se=pe.createRange();se.setStart(ee.node,ee.offset),de.removeAllRanges(),je>ft?(de.addRange(se),de.extend(W.node,W.offset)):(se.setEnd(W.node,W.offset),de.addRange(se))}}}}for(pe=[],de=k;de=de.parentNode;)de.nodeType===1&&pe.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<pe.length;k++){var me=pe[k];me.element.scrollLeft=me.left,me.element.scrollTop=me.top}}Vd=!!Zm,ep=Zm=null}finally{it=g,Q.p=u,P.T=o}}r.current=s,Wt=2}}function gv(){if(Wt===2){Wt=0;var r=ps,s=Eo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=P.T,P.T=null;var u=Q.p;Q.p=2;var g=it;it|=4;try{Q0(r,s.alternate,s)}finally{it=g,Q.p=u,P.T=o}}Wt=3}}function yv(){if(Wt===4||Wt===3){Wt=0,fr();var r=ps,s=Eo,o=ji,u=rv;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Wt=5:(Wt=0,Eo=ps=null,_v(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(ms=null),mi(o),s=s.stateNode,cn&&typeof cn.onCommitFiberRoot=="function")try{cn.onCommitFiberRoot(mr,s,void 0,(s.current.flags&128)===128)}catch{}if(u!==null){s=P.T,g=Q.p,Q.p=2,P.T=null;try{for(var y=r.onRecoverableError,x=0;x<u.length;x++){var k=u[x];y(k.value,{componentStack:k.stack})}}finally{P.T=s,Q.p=g}}(ji&3)!==0&&Td(),ei(r),g=r.pendingLanes,(o&261930)!==0&&(g&42)!==0?r===zm?mc++:(mc=0,zm=r):mc=0,pc(0)}}function _v(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,Yl(s)))}function Td(){return pv(),gv(),yv(),vv()}function vv(){if(Wt!==5)return!1;var r=ps,s=Lm;Lm=0;var o=mi(ji),u=P.T,g=Q.p;try{Q.p=32>o?32:o,P.T=null,o=Bm,Bm=null;var y=ps,x=ji;if(Wt=0,Eo=ps=null,ji=0,(it&6)!==0)throw Error(i(331));var k=it;if(it|=4,ev(y.current),X0(y,y.current,x,o),it=k,pc(0,!1),cn&&typeof cn.onPostCommitFiberRoot=="function")try{cn.onPostCommitFiberRoot(mr,y)}catch{}return!0}finally{Q.p=g,P.T=u,_v(r,s)}}function bv(r,s,o){s=nr(o,s),s=_m(r.stateNode,s,2),r=ls(r,s,2),r!==null&&(Zs(r,2),ei(r))}function ct(r,s,o){if(r.tag===3)bv(r,r,o);else for(;s!==null;){if(s.tag===3){bv(s,r,o);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ms===null||!ms.has(u))){r=nr(o,r),o=E0(2),u=ls(s,o,2),u!==null&&(x0(o,u,s,r),Zs(u,2),ei(u));break}}s=s.return}}function qm(r,s,o){var u=r.pingCache;if(u===null){u=r.pingCache=new D1;var g=new Set;u.set(s,g)}else g=u.get(s),g===void 0&&(g=new Set,u.set(s,g));g.has(o)||(Nm=!0,g.add(o),r=k1.bind(null,r,s,o),s.then(r,r))}function k1(r,s,o){var u=r.pingCache;u!==null&&u.delete(s),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,mt===r&&(He&o)===o&&(Dt===4||Dt===3&&(He&62914560)===He&&300>Yt()-vd?(it&2)===0&&xo(r,0):Pm|=o,bo===He&&(bo=0)),ei(r)}function Ev(r,s){s===0&&(s=Eu()),r=fa(r,s),r!==null&&(Zs(r,s),ei(r))}function N1(r){var s=r.memoizedState,o=0;s!==null&&(o=s.retryLane),Ev(r,o)}function P1(r,s){var o=0;switch(r.tag){case 31:case 13:var u=r.stateNode,g=r.memoizedState;g!==null&&(o=g.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(i(314))}u!==null&&u.delete(s),Ev(r,o)}function V1(r,s){return St(r,s)}var Ad=null,wo=null,Qm=!1,Cd=!1,Gm=!1,ys=0;function ei(r){r!==wo&&r.next===null&&(wo===null?Ad=wo=r:wo=wo.next=r),Cd=!0,Qm||(Qm=!0,B1())}function pc(r,s){if(!Gm&&Cd){Gm=!0;do for(var o=!1,u=Ad;u!==null;){if(r!==0){var g=u.pendingLanes;if(g===0)var y=0;else{var x=u.suspendedLanes,k=u.pingedLanes;y=(1<<31-It(42|r)+1)-1,y&=g&~(x&~k),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,Tv(u,y))}else y=He,y=Pr(u,u===mt?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||pr(u,y)||(o=!0,Tv(u,y));u=u.next}while(o);Gm=!1}}function L1(){xv()}function xv(){Cd=Qm=!1;var r=0;ys!==0&&Y1()&&(r=ys);for(var s=Yt(),o=null,u=Ad;u!==null;){var g=u.next,y=Sv(u,s);y===0?(u.next=null,o===null?Ad=g:o.next=g,g===null&&(wo=o)):(o=u,(r!==0||(y&3)!==0)&&(Cd=!0)),u=g}Wt!==0&&Wt!==5||pc(r),ys!==0&&(ys=0)}function Sv(r,s){for(var o=r.suspendedLanes,u=r.pingedLanes,g=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var x=31-It(y),k=1<<x,$=g[x];$===-1?((k&o)===0||(k&u)!==0)&&(g[x]=bf(k,s)):$<=s&&(r.expiredLanes|=k),y&=~k}if(s=mt,o=He,o=Pr(r,r===s?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===s&&(lt===2||lt===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&Yn(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||pr(r,o)){if(s=o&-o,s===r.callbackPriority)return s;switch(u!==null&&Yn(u),mi(o)){case 2:case 8:o=Tl;break;case 32:o=Hi;break;case 268435456:o=gu;break;default:o=Hi}return u=wv.bind(null,r),o=St(o,u),r.callbackPriority=s,r.callbackNode=o,s}return u!==null&&u!==null&&Yn(u),r.callbackPriority=2,r.callbackNode=null,2}function wv(r,s){if(Wt!==0&&Wt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(Td()&&r.callbackNode!==o)return null;var u=He;return u=Pr(r,r===mt?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(sv(r,u,s),Sv(r,Yt()),r.callbackNode!=null&&r.callbackNode===o?wv.bind(null,r):null)}function Tv(r,s){if(Td())return null;sv(r,s,!0)}function B1(){X1(function(){(it&6)!==0?St(wl,L1):xv()})}function Hm(){if(ys===0){var r=lo;r===0&&(r=kr,kr<<=1,(kr&261888)===0&&(kr=256)),ys=r}return ys}function Av(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:$a(""+r)}function Cv(r,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,r.id&&o.setAttribute("form",r.id),s.parentNode.insertBefore(o,s),r=new FormData(r),o.parentNode.removeChild(o),r}function z1(r,s,o,u,g){if(s==="submit"&&o&&o.stateNode===g){var y=Av((g[tn]||null).action),x=u.submitter;x&&(s=(s=x[tn]||null)?Av(s.formAction):x.getAttribute("formAction"),s!==null&&(y=s,x=null));var k=new $r("action","action",null,u,g);r.push({event:k,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ys!==0){var $=x?Cv(g,x):new FormData(g);hm(o,{pending:!0,data:$,method:g.method,action:y},null,$)}}else typeof y=="function"&&(k.preventDefault(),$=x?Cv(g,x):new FormData(g),hm(o,{pending:!0,data:$,method:g.method,action:y},y,$))},currentTarget:g}]})}}for(var $m=0;$m<Df.length;$m++){var Km=Df[$m],U1=Km.toLowerCase(),F1=Km[0].toUpperCase()+Km.slice(1);Sr(U1,"on"+F1)}Sr(i_,"onAnimationEnd"),Sr(s_,"onAnimationIteration"),Sr(a_,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(i1,"onTransitionRun"),Sr(s1,"onTransitionStart"),Sr(a1,"onTransitionCancel"),Sr(o_,"onTransitionEnd"),qr("onMouseEnter",["mouseout","mouseover"]),qr("onMouseLeave",["mouseout","mouseover"]),qr("onPointerEnter",["pointerout","pointerover"]),qr("onPointerLeave",["pointerout","pointerover"]),Fr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Fr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Fr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Fr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Fr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Fr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),q1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gc));function Rv(r,s){s=(s&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],g=u.event;u=u.listeners;e:{var y=void 0;if(s)for(var x=u.length-1;0<=x;x--){var k=u[x],$=k.instance,ae=k.currentTarget;if(k=k.listener,$!==y&&g.isPropagationStopped())break e;y=k,g.currentTarget=ae;try{y(g)}catch(fe){Fu(fe)}g.currentTarget=null,y=$}else for(x=0;x<u.length;x++){if(k=u[x],$=k.instance,ae=k.currentTarget,k=k.listener,$!==y&&g.isPropagationStopped())break e;y=k,g.currentTarget=ae;try{y(g)}catch(fe){Fu(fe)}g.currentTarget=null,y=$}}}}function Ge(r,s){var o=s[Fa];o===void 0&&(o=s[Fa]=new Set);var u=r+"__bubble";o.has(u)||(Dv(s,r,2,!1),o.add(u))}function Ym(r,s,o){var u=0;s&&(u|=4),Dv(o,r,u,s)}var Rd="_reactListening"+Math.random().toString(36).slice(2);function Wm(r){if(!r[Rd]){r[Rd]=!0,Rl.forEach(function(o){o!=="selectionchange"&&(q1.has(o)||Ym(o,!1,r),Ym(o,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Rd]||(s[Rd]=!0,Ym("selectionchange",!1,s))}}function Dv(r,s,o,u){switch(ib(s)){case 2:var g=yA;break;case 8:g=_A;break;default:g=dp}o=g.bind(null,s,o,r),g=void 0,!sa||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),u?g!==void 0?r.addEventListener(s,o,{capture:!0,passive:g}):r.addEventListener(s,o,!0):g!==void 0?r.addEventListener(s,o,{passive:g}):r.addEventListener(s,o,!1)}function Xm(r,s,o,u,g){var y=u;if((s&1)===0&&(s&2)===0&&u!==null)e:for(;;){if(u===null)return;var x=u.tag;if(x===3||x===4){var k=u.stateNode.containerInfo;if(k===g)break;if(x===4)for(x=u.return;x!==null;){var $=x.tag;if(($===3||$===4)&&x.stateNode.containerInfo===g)return;x=x.return}for(;k!==null;){if(x=zr(k),x===null)return;if($=x.tag,$===5||$===6||$===26||$===27){u=y=x;continue e}k=k.parentNode}}u=u.return}Ji(function(){var ae=y,fe=Jn(o),pe=[];e:{var le=l_.get(r);if(le!==void 0){var de=$r,Ae=r;switch(r){case"keypress":if(oa(o)===0)break e;case"keydown":case"keyup":de=Bu;break;case"focusin":Ae="focus",de=ca;break;case"focusout":Ae="blur",de=ca;break;case"beforeblur":case"afterblur":de=ca;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=Ul;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=Iu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=E;break;case i_:case s_:case a_:de=Ou;break;case o_:de=V;break;case"scroll":case"scrollend":de=zl;break;case"wheel":de=ue;break;case"copy":case"cut":case"paste":de=Mu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=yi;break;case"toggle":case"beforetoggle":de=Be}var je=(s&4)!==0,ft=!je&&(r==="scroll"||r==="scrollend"),ee=je?le!==null?le+"Capture":null:le;je=[];for(var W=ae,se;W!==null;){var me=W;if(se=me.stateNode,me=me.tag,me!==5&&me!==26&&me!==27||se===null||ee===null||(me=vr(W,ee),me!=null&&je.push(yc(W,me,se))),ft)break;W=W.return}0<je.length&&(le=new de(le,Ae,null,o,fe),pe.push({event:le,listeners:je}))}}if((s&7)===0){e:{if(le=r==="mouseover"||r==="pointerover",de=r==="mouseout"||r==="pointerout",le&&o!==Vl&&(Ae=o.relatedTarget||o.fromElement)&&(zr(Ae)||Ae[Lr]))break e;if((de||le)&&(le=fe.window===fe?fe:(le=fe.ownerDocument)?le.defaultView||le.parentWindow:window,de?(Ae=o.relatedTarget||o.toElement,de=ae,Ae=Ae?zr(Ae):null,Ae!==null&&(ft=l(Ae),je=Ae.tag,Ae!==ft||je!==5&&je!==27&&je!==6)&&(Ae=null)):(de=null,Ae=ae),de!==Ae)){if(je=Ul,me="onMouseLeave",ee="onMouseEnter",W="mouse",(r==="pointerout"||r==="pointerover")&&(je=yi,me="onPointerLeave",ee="onPointerEnter",W="pointer"),ft=de==null?le:Ln(de),se=Ae==null?le:Ln(Ae),le=new je(me,W+"leave",de,o,fe),le.target=ft,le.relatedTarget=se,me=null,zr(fe)===ae&&(je=new je(ee,W+"enter",Ae,o,fe),je.target=se,je.relatedTarget=ft,me=je),ft=me,de&&Ae)t:{for(je=Q1,ee=de,W=Ae,se=0,me=ee;me;me=je(me))se++;me=0;for(var De=W;De;De=je(De))me++;for(;0<se-me;)ee=je(ee),se--;for(;0<me-se;)W=je(W),me--;for(;se--;){if(ee===W||W!==null&&ee===W.alternate){je=ee;break t}ee=je(ee),W=je(W)}je=null}else je=null;de!==null&&Iv(pe,le,de,je,!1),Ae!==null&&ft!==null&&Iv(pe,ft,Ae,je,!0)}}e:{if(le=ae?Ln(ae):window,de=le.nodeName&&le.nodeName.toLowerCase(),de==="select"||de==="input"&&le.type==="file")var et=$y;else if(Gy(le))if(Ky)et=t1;else{et=ZT;var Re=JT}else de=le.nodeName,!de||de.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?ae&&Ha(ae.elementType)&&(et=$y):et=e1;if(et&&(et=et(r,ae))){Hy(pe,et,o,fe);break e}Re&&Re(r,le,ae),r==="focusout"&&ae&&le.type==="number"&&ae.memoizedProps.value!=null&&kl(le,"number",le.value)}switch(Re=ae?Ln(ae):window,r){case"focusin":(Gy(Re)||Re.contentEditable==="true")&&(eo=Re,Af=ae,Hl=null);break;case"focusout":Hl=Af=eo=null;break;case"mousedown":Cf=!0;break;case"contextmenu":case"mouseup":case"dragend":Cf=!1,n_(pe,o,fe);break;case"selectionchange":if(r1)break;case"keydown":case"keyup":n_(pe,o,fe)}var Ue;if(rt)e:{switch(r){case"compositionstart":var $e="onCompositionStart";break e;case"compositionend":$e="onCompositionEnd";break e;case"compositionupdate":$e="onCompositionUpdate";break e}$e=void 0}else Za?ua(r,o)&&($e="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&($e="onCompositionStart");$e&&(Wr&&o.locale!=="ko"&&(Za||$e!=="onCompositionStart"?$e==="onCompositionEnd"&&Za&&(Ue=Bl()):(Hr=fe,Ll="value"in Hr?Hr.value:Hr.textContent,Za=!0)),Re=Dd(ae,$e),0<Re.length&&($e=new Yr($e,r,null,o,fe),pe.push({event:$e,listeners:Re}),Ue?$e.data=Ue:(Ue=Ja(o),Ue!==null&&($e.data=Ue)))),(Ue=er?KT(r,o):YT(r,o))&&($e=Dd(ae,"onBeforeInput"),0<$e.length&&(Re=new Yr("onBeforeInput","beforeinput",null,o,fe),pe.push({event:Re,listeners:$e}),Re.data=Ue)),z1(pe,r,ae,o,fe)}Rv(pe,s)})}function yc(r,s,o){return{instance:r,listener:s,currentTarget:o}}function Dd(r,s){for(var o=s+"Capture",u=[];r!==null;){var g=r,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=vr(r,o),g!=null&&u.unshift(yc(r,g,y)),g=vr(r,s),g!=null&&u.push(yc(r,g,y))),r.tag===3)return u;r=r.return}return[]}function Q1(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Iv(r,s,o,u,g){for(var y=s._reactName,x=[];o!==null&&o!==u;){var k=o,$=k.alternate,ae=k.stateNode;if(k=k.tag,$!==null&&$===u)break;k!==5&&k!==26&&k!==27||ae===null||($=ae,g?(ae=vr(o,y),ae!=null&&x.unshift(yc(o,ae,$))):g||(ae=vr(o,y),ae!=null&&x.push(yc(o,ae,$)))),o=o.return}x.length!==0&&r.push({event:s,listeners:x})}var G1=/\r\n?/g,H1=/\u0000|\uFFFD/g;function jv(r){return(typeof r=="string"?r:""+r).replace(G1,`
`).replace(H1,"")}function Ov(r,s){return s=jv(s),jv(r)===s}function ht(r,s,o,u,g,y){switch(o){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||Rn(r,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&Rn(r,""+u);break;case"className":Bn(r,"class",u);break;case"tabIndex":Bn(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Bn(r,o,u);break;case"style":Pl(r,u,y);break;case"data":if(s!=="object"){Bn(r,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=$a(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&ht(r,s,"name",g.name,g,null),ht(r,s,"formEncType",g.formEncType,g,null),ht(r,s,"formMethod",g.formMethod,g,null),ht(r,s,"formTarget",g.formTarget,g,null)):(ht(r,s,"encType",g.encType,g,null),ht(r,s,"method",g.method,g,null),ht(r,s,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=$a(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=_r);break;case"onScroll":u!=null&&Ge("scroll",r);break;case"onScrollEnd":u!=null&&Ge("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=$a(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":Ge("beforetoggle",r),Ge("toggle",r),Qa(r,"popover",u);break;case"xlinkActuate":Bt(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Bt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Bt(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Bt(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Bt(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Bt(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Bt(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Bt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Bt(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Qa(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Du.get(o)||o,Qa(r,o,u))}}function Jm(r,s,o,u,g,y){switch(o){case"style":Pl(r,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(i(61));if(o=u.__html,o!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"children":typeof u=="string"?Rn(r,u):(typeof u=="number"||typeof u=="bigint")&&Rn(r,""+u);break;case"onScroll":u!=null&&Ge("scroll",r);break;case"onScrollEnd":u!=null&&Ge("scrollend",r);break;case"onClick":u!=null&&(r.onclick=_r);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Dl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),s=o.slice(2,g?o.length-7:void 0),y=r[tn]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(s,y,g),typeof u=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(s,u,g);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):Qa(r,o,u)}}}function mn(r,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",r),Ge("load",r);var u=!1,g=!1,y;for(y in o)if(o.hasOwnProperty(y)){var x=o[y];if(x!=null)switch(y){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ht(r,s,y,x,o,null)}}g&&ht(r,s,"srcSet",o.srcSet,o,null),u&&ht(r,s,"src",o.src,o,null);return;case"input":Ge("invalid",r);var k=y=x=g=null,$=null,ae=null;for(u in o)if(o.hasOwnProperty(u)){var fe=o[u];if(fe!=null)switch(u){case"name":g=fe;break;case"type":x=fe;break;case"checked":$=fe;break;case"defaultChecked":ae=fe;break;case"value":y=fe;break;case"defaultValue":k=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,s));break;default:ht(r,s,u,fe,o,null)}}Au(r,y,k,$,ae,x,g,!1);return;case"select":Ge("invalid",r),u=x=y=null;for(g in o)if(o.hasOwnProperty(g)&&(k=o[g],k!=null))switch(g){case"value":y=k;break;case"defaultValue":x=k;break;case"multiple":u=k;default:ht(r,s,g,k,o,null)}s=y,o=x,r.multiple=!!u,s!=null?Ki(r,!!u,s,!1):o!=null&&Ki(r,!!u,o,!0);return;case"textarea":Ge("invalid",r),y=g=u=null;for(x in o)if(o.hasOwnProperty(x)&&(k=o[x],k!=null))switch(x){case"value":u=k;break;case"defaultValue":g=k;break;case"children":y=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(i(91));break;default:ht(r,s,x,k,o,null)}Yi(r,u,g,y);return;case"option":for($ in o)o.hasOwnProperty($)&&(u=o[$],u!=null)&&($==="selected"?r.selected=u&&typeof u!="function"&&typeof u!="symbol":ht(r,s,$,u,o,null));return;case"dialog":Ge("beforetoggle",r),Ge("toggle",r),Ge("cancel",r),Ge("close",r);break;case"iframe":case"object":Ge("load",r);break;case"video":case"audio":for(u=0;u<gc.length;u++)Ge(gc[u],r);break;case"image":Ge("error",r),Ge("load",r);break;case"details":Ge("toggle",r);break;case"embed":case"source":case"link":Ge("error",r),Ge("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in o)if(o.hasOwnProperty(ae)&&(u=o[ae],u!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ht(r,s,ae,u,o,null)}return;default:if(Ha(s)){for(fe in o)o.hasOwnProperty(fe)&&(u=o[fe],u!==void 0&&Jm(r,s,fe,u,o,void 0));return}}for(k in o)o.hasOwnProperty(k)&&(u=o[k],u!=null&&ht(r,s,k,u,o,null))}function $1(r,s,o,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,x=null,k=null,$=null,ae=null,fe=null;for(de in o){var pe=o[de];if(o.hasOwnProperty(de)&&pe!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":$=pe;default:u.hasOwnProperty(de)||ht(r,s,de,null,u,pe)}}for(var le in u){var de=u[le];if(pe=o[le],u.hasOwnProperty(le)&&(de!=null||pe!=null))switch(le){case"type":y=de;break;case"name":g=de;break;case"checked":ae=de;break;case"defaultChecked":fe=de;break;case"value":x=de;break;case"defaultValue":k=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,s));break;default:de!==pe&&ht(r,s,le,de,u,pe)}}Ga(r,x,k,$,ae,fe,y,g);return;case"select":de=x=k=le=null;for(y in o)if($=o[y],o.hasOwnProperty(y)&&$!=null)switch(y){case"value":break;case"multiple":de=$;default:u.hasOwnProperty(y)||ht(r,s,y,null,u,$)}for(g in u)if(y=u[g],$=o[g],u.hasOwnProperty(g)&&(y!=null||$!=null))switch(g){case"value":le=y;break;case"defaultValue":k=y;break;case"multiple":x=y;default:y!==$&&ht(r,s,g,y,u,$)}s=k,o=x,u=de,le!=null?Ki(r,!!o,le,!1):!!u!=!!o&&(s!=null?Ki(r,!!o,s,!0):Ki(r,!!o,o?[]:"",!1));return;case"textarea":de=le=null;for(k in o)if(g=o[k],o.hasOwnProperty(k)&&g!=null&&!u.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:ht(r,s,k,null,u,g)}for(x in u)if(g=u[x],y=o[x],u.hasOwnProperty(x)&&(g!=null||y!=null))switch(x){case"value":le=g;break;case"defaultValue":de=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==y&&ht(r,s,x,g,u,y)}Cu(r,le,de);return;case"option":for(var Ae in o)le=o[Ae],o.hasOwnProperty(Ae)&&le!=null&&!u.hasOwnProperty(Ae)&&(Ae==="selected"?r.selected=!1:ht(r,s,Ae,null,u,le));for($ in u)le=u[$],de=o[$],u.hasOwnProperty($)&&le!==de&&(le!=null||de!=null)&&($==="selected"?r.selected=le&&typeof le!="function"&&typeof le!="symbol":ht(r,s,$,le,u,de));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var je in o)le=o[je],o.hasOwnProperty(je)&&le!=null&&!u.hasOwnProperty(je)&&ht(r,s,je,null,u,le);for(ae in u)if(le=u[ae],de=o[ae],u.hasOwnProperty(ae)&&le!==de&&(le!=null||de!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,s));break;default:ht(r,s,ae,le,u,de)}return;default:if(Ha(s)){for(var ft in o)le=o[ft],o.hasOwnProperty(ft)&&le!==void 0&&!u.hasOwnProperty(ft)&&Jm(r,s,ft,void 0,u,le);for(fe in u)le=u[fe],de=o[fe],!u.hasOwnProperty(fe)||le===de||le===void 0&&de===void 0||Jm(r,s,fe,le,u,de);return}}for(var ee in o)le=o[ee],o.hasOwnProperty(ee)&&le!=null&&!u.hasOwnProperty(ee)&&ht(r,s,ee,null,u,le);for(pe in u)le=u[pe],de=o[pe],!u.hasOwnProperty(pe)||le===de||le==null&&de==null||ht(r,s,pe,le,u,de)}function Mv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function K1(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var g=o[u],y=g.transferSize,x=g.initiatorType,k=g.duration;if(y&&k&&Mv(x)){for(x=0,k=g.responseEnd,u+=1;u<o.length;u++){var $=o[u],ae=$.startTime;if(ae>k)break;var fe=$.transferSize,pe=$.initiatorType;fe&&Mv(pe)&&($=$.responseEnd,x+=fe*($<k?1:(k-ae)/($-ae)))}if(--u,s+=8*(y+x)/(g.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Zm=null,ep=null;function Id(r){return r.nodeType===9?r:r.ownerDocument}function kv(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Nv(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function tp(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var np=null;function Y1(){var r=window.event;return r&&r.type==="popstate"?r===np?!1:(np=r,!0):(np=null,!1)}var Pv=typeof setTimeout=="function"?setTimeout:void 0,W1=typeof clearTimeout=="function"?clearTimeout:void 0,Vv=typeof Promise=="function"?Promise:void 0,X1=typeof queueMicrotask=="function"?queueMicrotask:typeof Vv<"u"?function(r){return Vv.resolve(null).then(r).catch(J1)}:Pv;function J1(r){setTimeout(function(){throw r})}function _s(r){return r==="head"}function Lv(r,s){var o=s,u=0;do{var g=o.nextSibling;if(r.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(u===0){r.removeChild(g),Ro(s);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")_c(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,_c(o);for(var y=o.firstChild;y;){var x=y.nextSibling,k=y.nodeName;y[Br]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=x}}else o==="body"&&_c(r.ownerDocument.body);o=g}while(o);Ro(s)}function Bv(r,s){var o=r;r=0;do{var u=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=u}while(o)}function rp(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":rp(o),qa(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function Z1(r,s,o,u){for(;r.nodeType===1;){var g=o;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[Br])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=or(r.nextSibling),r===null)break}return null}function eA(r,s,o){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=or(r.nextSibling),r===null))return null;return r}function zv(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=or(r.nextSibling),r===null))return null;return r}function ip(r){return r.data==="$?"||r.data==="$~"}function sp(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function tA(r,s){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||o.readyState!=="loading")s();else{var u=function(){s(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function or(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var ap=null;function Uv(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(s===0)return or(r.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}r=r.nextSibling}return null}function Fv(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return r;s--}else o!=="/$"&&o!=="/&"||s++}r=r.previousSibling}return null}function qv(r,s,o){switch(s=Id(o),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function _c(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);qa(r)}var lr=new Map,Qv=new Set;function jd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Oi=Q.d;Q.d={f:nA,r:rA,D:iA,C:sA,L:aA,m:oA,X:cA,S:lA,M:uA};function nA(){var r=Oi.f(),s=xd();return r||s}function rA(r){var s=Xn(r);s!==null&&s.tag===5&&s.type==="form"?o0(s):Oi.r(r)}var To=typeof document>"u"?null:document;function Gv(r,s,o){var u=To;if(u&&typeof s=="string"&&s){var g=Cn(s);g='link[rel="'+r+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),Qv.has(g)||(Qv.add(g),r={rel:r,crossOrigin:o,href:s},u.querySelector(g)===null&&(s=u.createElement("link"),mn(s,"link",r),Lt(s),u.head.appendChild(s)))}}function iA(r){Oi.D(r),Gv("dns-prefetch",r,null)}function sA(r,s){Oi.C(r,s),Gv("preconnect",r,s)}function aA(r,s,o){Oi.L(r,s,o);var u=To;if(u&&r&&s){var g='link[rel="preload"][as="'+Cn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+Cn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+Cn(o.imageSizes)+'"]')):g+='[href="'+Cn(r)+'"]';var y=g;switch(s){case"style":y=Ao(r);break;case"script":y=Co(r)}lr.has(y)||(r=v({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:r,as:s},o),lr.set(y,r),u.querySelector(g)!==null||s==="style"&&u.querySelector(vc(y))||s==="script"&&u.querySelector(bc(y))||(s=u.createElement("link"),mn(s,"link",r),Lt(s),u.head.appendChild(s)))}}function oA(r,s){Oi.m(r,s);var o=To;if(o&&r){var u=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Cn(u)+'"][href="'+Cn(r)+'"]',y=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Co(r)}if(!lr.has(y)&&(r=v({rel:"modulepreload",href:r},s),lr.set(y,r),o.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(bc(y)))return}u=o.createElement("link"),mn(u,"link",r),Lt(u),o.head.appendChild(u)}}}function lA(r,s,o){Oi.S(r,s,o);var u=To;if(u&&r){var g=Ur(u).hoistableStyles,y=Ao(r);s=s||"default";var x=g.get(y);if(!x){var k={loading:0,preload:null};if(x=u.querySelector(vc(y)))k.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":s},o),(o=lr.get(y))&&op(r,o);var $=x=u.createElement("link");Lt($),mn($,"link",r),$._p=new Promise(function(ae,fe){$.onload=ae,$.onerror=fe}),$.addEventListener("load",function(){k.loading|=1}),$.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Od(x,s,u)}x={type:"stylesheet",instance:x,count:1,state:k},g.set(y,x)}}}function cA(r,s){Oi.X(r,s);var o=To;if(o&&r){var u=Ur(o).hoistableScripts,g=Co(r),y=u.get(g);y||(y=o.querySelector(bc(g)),y||(r=v({src:r,async:!0},s),(s=lr.get(g))&&lp(r,s),y=o.createElement("script"),Lt(y),mn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function uA(r,s){Oi.M(r,s);var o=To;if(o&&r){var u=Ur(o).hoistableScripts,g=Co(r),y=u.get(g);y||(y=o.querySelector(bc(g)),y||(r=v({src:r,async:!0,type:"module"},s),(s=lr.get(g))&&lp(r,s),y=o.createElement("script"),Lt(y),mn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function Hv(r,s,o,u){var g=(g=_e.current)?jd(g):null;if(!g)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Ao(o.href),o=Ur(g).hoistableStyles,u=o.get(s),u||(u={type:"style",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=Ao(o.href);var y=Ur(g).hoistableStyles,x=y.get(r);if(x||(g=g.ownerDocument||g,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,x),(y=g.querySelector(vc(r)))&&!y._p&&(x.instance=y,x.state.loading=5),lr.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},lr.set(r,o),y||dA(g,r,o,x.state))),s&&u===null)throw Error(i(528,""));return x}if(s&&u!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Co(o),o=Ur(g).hoistableScripts,u=o.get(s),u||(u={type:"script",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Ao(r){return'href="'+Cn(r)+'"'}function vc(r){return'link[rel="stylesheet"]['+r+"]"}function $v(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function dA(r,s,o,u){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=r.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),mn(s,"link",o),Lt(s),r.head.appendChild(s))}function Co(r){return'[src="'+Cn(r)+'"]'}function bc(r){return"script[async]"+r}function Kv(r,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var u=r.querySelector('style[data-href~="'+Cn(o.href)+'"]');if(u)return s.instance=u,Lt(u),u;var g=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),Lt(u),mn(u,"style",g),Od(u,o.precedence,r),s.instance=u;case"stylesheet":g=Ao(o.href);var y=r.querySelector(vc(g));if(y)return s.state.loading|=4,s.instance=y,Lt(y),y;u=$v(o),(g=lr.get(g))&&op(u,g),y=(r.ownerDocument||r).createElement("link"),Lt(y);var x=y;return x._p=new Promise(function(k,$){x.onload=k,x.onerror=$}),mn(y,"link",u),s.state.loading|=4,Od(y,o.precedence,r),s.instance=y;case"script":return y=Co(o.src),(g=r.querySelector(bc(y)))?(s.instance=g,Lt(g),g):(u=o,(g=lr.get(y))&&(u=v({},o),lp(u,g)),r=r.ownerDocument||r,g=r.createElement("script"),Lt(g),mn(g,"link",u),r.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(u=s.instance,s.state.loading|=4,Od(u,o.precedence,r));return s.instance}function Od(r,s,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,y=g,x=0;x<u.length;x++){var k=u[x];if(k.dataset.precedence===s)y=k;else if(y!==g)break}y?y.parentNode.insertBefore(r,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(r,s.firstChild))}function op(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function lp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var Md=null;function Yv(r,s,o){if(Md===null){var u=new Map,g=Md=new Map;g.set(o,u)}else g=Md,u=g.get(o),u||(u=new Map,g.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),g=0;g<o.length;g++){var y=o[g];if(!(y[Br]||y[Vt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var x=y.getAttribute(s)||"";x=r+x;var k=u.get(x);k?k.push(y):u.set(x,[y])}}return u}function Wv(r,s,o){r=r.ownerDocument||r,r.head.insertBefore(o,s==="title"?r.querySelector("head > title"):null)}function hA(r,s,o){if(o===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Xv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function fA(r,s,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Ao(u.href),y=s.querySelector(vc(g));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=kd.bind(r),s.then(r,r)),o.state.loading|=4,o.instance=y,Lt(y);return}y=s.ownerDocument||s,u=$v(u),(g=lr.get(g))&&op(u,g),y=y.createElement("link"),Lt(y);var x=y;x._p=new Promise(function(k,$){x.onload=k,x.onerror=$}),mn(y,"link",u),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=kd.bind(r),s.addEventListener("load",o),s.addEventListener("error",o))}}var cp=0;function mA(r,s){return r.stylesheets&&r.count===0&&Pd(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var u=setTimeout(function(){if(r.stylesheets&&Pd(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+s);0<r.imgBytes&&cp===0&&(cp=62500*K1());var g=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Pd(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>cp?50:800)+s);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function kd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Pd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Nd=null;function Pd(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Nd=new Map,s.forEach(pA,r),Nd=null,kd.call(r))}function pA(r,s){if(!(s.state.loading&4)){var o=Nd.get(r);if(o)var u=o.get(null);else{o=new Map,Nd.set(r,o);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var x=g[y];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(o.set(x.dataset.precedence,x),u=x)}u&&o.set(null,u)}g=s.instance,x=g.getAttribute("data-precedence"),y=o.get(x)||u,y===u&&o.set(null,g),o.set(x,g),this.count++,u=kd.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),y?y.parentNode.insertBefore(g,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),s.state.loading|=4}}var Ec={$$typeof:U,Provider:null,Consumer:null,_currentValue:H,_currentValue2:H,_threadCount:0};function gA(r,s,o,u,g,y,x,k,$){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Vr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vr(0),this.hiddenUpdates=Vr(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=$,this.incompleteTransitions=new Map}function Jv(r,s,o,u,g,y,x,k,$,ae,fe,pe){return r=new gA(r,s,o,x,$,ae,fe,pe,k),s=1,y===!0&&(s|=24),y=Un(3,null,null,s),r.current=y,y.stateNode=r,s=Ff(),s.refCount++,r.pooledCache=s,s.refCount++,y.memoizedState={element:u,isDehydrated:o,cache:s},Hf(y),r}function Zv(r){return r?(r=ro,r):ro}function eb(r,s,o,u,g,y){g=Zv(g),u.context===null?u.context=g:u.pendingContext=g,u=os(s),u.payload={element:o},y=y===void 0?null:y,y!==null&&(u.callback=y),o=ls(r,u,s),o!==null&&(Mn(o,r,s),Zl(o,r,s))}function tb(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<s?o:s}}function up(r,s){tb(r,s),(r=r.alternate)&&tb(r,s)}function nb(r){if(r.tag===13||r.tag===31){var s=fa(r,67108864);s!==null&&Mn(s,r,67108864),up(r,67108864)}}function rb(r){if(r.tag===13||r.tag===31){var s=Hn();s=ta(s);var o=fa(r,s);o!==null&&Mn(o,r,s),up(r,s)}}var Vd=!0;function yA(r,s,o,u){var g=P.T;P.T=null;var y=Q.p;try{Q.p=2,dp(r,s,o,u)}finally{Q.p=y,P.T=g}}function _A(r,s,o,u){var g=P.T;P.T=null;var y=Q.p;try{Q.p=8,dp(r,s,o,u)}finally{Q.p=y,P.T=g}}function dp(r,s,o,u){if(Vd){var g=hp(u);if(g===null)Xm(r,s,u,Ld,o),sb(r,u);else if(bA(g,r,s,o,u))u.stopPropagation();else if(sb(r,u),s&4&&-1<vA.indexOf(r)){for(;g!==null;){var y=Xn(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var x=Nr(y.pendingLanes);if(x!==0){var k=y;for(k.pendingLanes|=2,k.entangledLanes|=2;x;){var $=1<<31-It(x);k.entanglements[1]|=$,x&=~$}ei(y),(it&6)===0&&(bd=Yt()+500,pc(0))}}break;case 31:case 13:k=fa(y,2),k!==null&&Mn(k,y,2),xd(),up(y,2)}if(y=hp(u),y===null&&Xm(r,s,u,Ld,o),y===g)break;g=y}g!==null&&u.stopPropagation()}else Xm(r,s,u,null,o)}}function hp(r){return r=Jn(r),fp(r)}var Ld=null;function fp(r){if(Ld=null,r=zr(r),r!==null){var s=l(r);if(s===null)r=null;else{var o=s.tag;if(o===13){if(r=c(s),r!==null)return r;r=null}else if(o===31){if(r=d(s),r!==null)return r;r=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return Ld=r,null}function ib(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xs()){case wl:return 2;case Tl:return 8;case Hi:case vf:return 32;case gu:return 268435456;default:return 32}default:return 32}}var mp=!1,vs=null,bs=null,Es=null,xc=new Map,Sc=new Map,xs=[],vA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function sb(r,s){switch(r){case"focusin":case"focusout":vs=null;break;case"dragenter":case"dragleave":bs=null;break;case"mouseover":case"mouseout":Es=null;break;case"pointerover":case"pointerout":xc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sc.delete(s.pointerId)}}function wc(r,s,o,u,g,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:o,eventSystemFlags:u,nativeEvent:y,targetContainers:[g]},s!==null&&(s=Xn(s),s!==null&&nb(s)),r):(r.eventSystemFlags|=u,s=r.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),r)}function bA(r,s,o,u,g){switch(s){case"focusin":return vs=wc(vs,r,s,o,u,g),!0;case"dragenter":return bs=wc(bs,r,s,o,u,g),!0;case"mouseover":return Es=wc(Es,r,s,o,u,g),!0;case"pointerover":var y=g.pointerId;return xc.set(y,wc(xc.get(y)||null,r,s,o,u,g)),!0;case"gotpointercapture":return y=g.pointerId,Sc.set(y,wc(Sc.get(y)||null,r,s,o,u,g)),!0}return!1}function ab(r){var s=zr(r.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){r.blockedOn=s,gr(r.priority,function(){rb(o)});return}}else if(s===31){if(s=d(o),s!==null){r.blockedOn=s,gr(r.priority,function(){rb(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Bd(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var o=hp(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);Vl=u,o.target.dispatchEvent(u),Vl=null}else return s=Xn(o),s!==null&&nb(s),r.blockedOn=o,!1;s.shift()}return!0}function ob(r,s,o){Bd(r)&&o.delete(s)}function EA(){mp=!1,vs!==null&&Bd(vs)&&(vs=null),bs!==null&&Bd(bs)&&(bs=null),Es!==null&&Bd(Es)&&(Es=null),xc.forEach(ob),Sc.forEach(ob)}function zd(r,s){r.blockedOn===s&&(r.blockedOn=null,mp||(mp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,EA)))}var Ud=null;function lb(r){Ud!==r&&(Ud=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Ud===r&&(Ud=null);for(var s=0;s<r.length;s+=3){var o=r[s],u=r[s+1],g=r[s+2];if(typeof u!="function"){if(fp(u||o)===null)continue;break}var y=Xn(o);y!==null&&(r.splice(s,3),s-=3,hm(y,{pending:!0,data:g,method:o.method,action:u},u,g))}}))}function Ro(r){function s($){return zd($,r)}vs!==null&&zd(vs,r),bs!==null&&zd(bs,r),Es!==null&&zd(Es,r),xc.forEach(s),Sc.forEach(s);for(var o=0;o<xs.length;o++){var u=xs[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<xs.length&&(o=xs[0],o.blockedOn===null);)ab(o),o.blockedOn===null&&xs.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var g=o[u],y=o[u+1],x=g[tn]||null;if(typeof y=="function")x||lb(o);else if(x){var k=null;if(y&&y.hasAttribute("formAction")){if(g=y,x=y[tn]||null)k=x.formAction;else if(fp(g)!==null)continue}else k=x.action;typeof k=="function"?o[u+1]=k:(o.splice(u,3),u-=3),lb(o)}}}function cb(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(x){return g=x})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function pp(r){this._internalRoot=r}Fd.prototype.render=pp.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,u=Hn();eb(o,u,r,s,null,null)},Fd.prototype.unmount=pp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;eb(r.current,2,null,r,null,null),xd(),s[Lr]=null}};function Fd(r){this._internalRoot=r}Fd.prototype.unstable_scheduleHydration=function(r){if(r){var s=xu();r={blockedOn:null,target:r,priority:s};for(var o=0;o<xs.length&&s!==0&&s<xs[o].priority;o++);xs.splice(o,0,r),o===0&&ab(r)}};var ub=e.version;if(ub!=="19.2.3")throw Error(i(527,ub,"19.2.3"));Q.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=p(s),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var xA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qd.isDisabled&&qd.supportsFiber)try{mr=qd.inject(xA),cn=qd}catch{}}return Ac.createRoot=function(r,s){if(!a(r))throw Error(i(299));var o=!1,u="",g=y0,y=_0,x=v0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(x=s.onRecoverableError)),s=Jv(r,1,!1,null,null,o,u,null,g,y,x,cb),r[Lr]=s.current,Wm(r),new pp(s)},Ac.hydrateRoot=function(r,s,o){if(!a(r))throw Error(i(299));var u=!1,g="",y=y0,x=_0,k=v0,$=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(x=o.onCaughtError),o.onRecoverableError!==void 0&&(k=o.onRecoverableError),o.formState!==void 0&&($=o.formState)),s=Jv(r,1,!0,s,o??null,u,g,$,y,x,k,cb),s.context=Zv(null),o=s.current,u=Hn(),u=ta(u),g=os(u),g.callback=null,ls(o,g,u),o=u,s.current.lanes=o,Zs(s,o),ei(s),r[Lr]=s.current,Wm(r),new Fd(s)},Ac.version="19.2.3",Ac}var bb;function OA(){if(bb)return _p.exports;bb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),_p.exports=jA(),_p.exports}var MA=OA();var Eb="popstate";function kA(t={}){function e(i,a){let{pathname:l,search:c,hash:d}=i.location;return qp("",{pathname:l,search:c,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:Uc(a)}return PA(e,n,null,t)}function xt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function dr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function NA(){return Math.random().toString(36).substring(2,10)}function xb(t,e){return{usr:t.state,key:t.key,idx:e}}function qp(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?il(e):e,state:n,key:e&&e.key||i||NA()}}function Uc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function il(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function PA(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,d="POP",f=null,p=_();p==null&&(p=0,c.replaceState({...c.state,idx:p},""));function _(){return(c.state||{idx:null}).idx}function v(){d="POP";let R=_(),z=R==null?null:R-p;p=R,f&&f({action:d,location:A.location,delta:z})}function b(R,z){d="PUSH";let F=qp(A.location,R,z);p=_()+1;let U=xb(F,p),X=A.createHref(F);try{c.pushState(U,"",X)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;a.location.assign(X)}l&&f&&f({action:d,location:A.location,delta:1})}function T(R,z){d="REPLACE";let F=qp(A.location,R,z);p=_();let U=xb(F,p),X=A.createHref(F);c.replaceState(U,"",X),l&&f&&f({action:d,location:A.location,delta:0})}function S(R){return VA(R)}let A={get action(){return d},get location(){return t(a,c)},listen(R){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Eb,v),f=R,()=>{a.removeEventListener(Eb,v),f=null}},createHref(R){return e(a,R)},createURL:S,encodeLocation(R){let z=S(R);return{pathname:z.pathname,search:z.search,hash:z.hash}},push:b,replace:T,go(R){return c.go(R)}};return A}function VA(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),xt(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Uc(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function Ix(t,e,n="/"){return LA(t,e,n,!1)}function LA(t,e,n,i){let a=typeof e=="string"?il(e):e,l=Bi(a.pathname||"/",n);if(l==null)return null;let c=jx(t);BA(c);let d=null;for(let f=0;d==null&&f<c.length;++f){let p=WA(l);d=KA(c[f],p,i)}return d}function jx(t,e=[],n=[],i="",a=!1){let l=(c,d,f=a,p)=>{let _={relativePath:p===void 0?c.path||"":p,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&f)return;xt(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let v=Pi([i,_.relativePath]),b=n.concat(_);c.children&&c.children.length>0&&(xt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),jx(c.children,e,b,v,f)),!(c.path==null&&!c.index)&&e.push({path:v,score:HA(v,c.index),routesMeta:b})};return t.forEach((c,d)=>{if(c.path===""||!c.path?.includes("?"))l(c,d);else for(let f of Ox(c.path))l(c,d,!0,f)}),e}function Ox(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=Ox(i.join("/")),d=[];return d.push(...c.map(f=>f===""?l:[l,f].join("/"))),a&&d.push(...c),d.map(f=>t.startsWith("/")&&f===""?"/":f)}function BA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:$A(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var zA=/^:[\w-]+$/,UA=3,FA=2,qA=1,QA=10,GA=-2,Sb=t=>t==="*";function HA(t,e){let n=t.split("/"),i=n.length;return n.some(Sb)&&(i+=GA),e&&(i+=FA),n.filter(a=>!Sb(a)).reduce((a,l)=>a+(zA.test(l)?UA:l===""?qA:QA),i)}function $A(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function KA(t,e,n=!1){let{routesMeta:i}=t,a={},l="/",c=[];for(let d=0;d<i.length;++d){let f=i[d],p=d===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",v=hh({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},_),b=f.route;if(!v&&p&&n&&!i[i.length-1].route.index&&(v=hh({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},_)),!v)return null;Object.assign(a,v.params),c.push({params:a,pathname:Pi([l,v.pathname]),pathnameBase:eC(Pi([l,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(l=Pi([l,v.pathnameBase]))}return c}function hh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=YA(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:i.reduce((p,{paramName:_,isOptional:v},b)=>{if(_==="*"){let S=d[b]||"";c=l.slice(0,l.length-S.length).replace(/(.)\/+$/,"$1")}const T=d[b];return v&&!T?p[_]=void 0:p[_]=(T||"").replace(/%2F/g,"/"),p},{}),pathname:l,pathnameBase:c,pattern:t}}function YA(t,e=!1,n=!0){dr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,f)=>(i.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function WA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return dr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Bi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var Mx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,XA=t=>Mx.test(t);function JA(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?il(t):t,l;if(n)if(XA(n))l=n;else{if(n.includes("//")){let c=n;n=n.replace(/\/\/+/g,"/"),dr(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${n}`)}n.startsWith("/")?l=wb(n.substring(1),"/"):l=wb(n,e)}else l=e;return{pathname:l,search:tC(i),hash:nC(a)}}function wb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function xp(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ZA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Ig(t){let e=ZA(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function jg(t,e,n,i=!1){let a;typeof t=="string"?a=il(t):(a={...t},xt(!a.pathname||!a.pathname.includes("?"),xp("?","pathname","search",a)),xt(!a.pathname||!a.pathname.includes("#"),xp("#","pathname","hash",a)),xt(!a.search||!a.search.includes("#"),xp("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,d;if(c==null)d=n;else{let v=e.length-1;if(!i&&c.startsWith("..")){let b=c.split("/");for(;b[0]==="..";)b.shift(),v-=1;a.pathname=b.join("/")}d=v>=0?e[v]:"/"}let f=JA(a,d),p=c&&c!=="/"&&c.endsWith("/"),_=(l||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(p||_)&&(f.pathname+="/"),f}var Pi=t=>t.join("/").replace(/\/\/+/g,"/"),eC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),tC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,nC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,rC=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function iC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function sC(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var kx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Nx(t,e){let n=t;if(typeof n!="string"||!Mx.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if(kx)try{let l=new URL(window.location.href),c=n.startsWith("//")?new URL(l.protocol+n):new URL(n),d=Bi(c.pathname,e);c.origin===l.origin&&d!=null?n=d+c.search+c.hash:a=!0}catch{dr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Px=["POST","PUT","PATCH","DELETE"];new Set(Px);var aC=["GET",...Px];new Set(aC);var sl=I.createContext(null);sl.displayName="DataRouter";var zh=I.createContext(null);zh.displayName="DataRouterState";var oC=I.createContext(!1),Vx=I.createContext({isTransitioning:!1});Vx.displayName="ViewTransition";var lC=I.createContext(new Map);lC.displayName="Fetchers";var cC=I.createContext(null);cC.displayName="Await";var Kn=I.createContext(null);Kn.displayName="Navigation";var Jc=I.createContext(null);Jc.displayName="Location";var hr=I.createContext({outlet:null,matches:[],isDataRoute:!1});hr.displayName="Route";var Og=I.createContext(null);Og.displayName="RouteError";var Lx="REACT_ROUTER_ERROR",uC="REDIRECT",dC="ROUTE_ERROR_RESPONSE";function hC(t){if(t.startsWith(`${Lx}:${uC}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function fC(t){if(t.startsWith(`${Lx}:${dC}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new rC(e.status,e.statusText,e.data)}catch{}}function mC(t,{relative:e}={}){xt(al(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=I.useContext(Kn),{hash:a,pathname:l,search:c}=Zc(t,{relative:e}),d=l;return n!=="/"&&(d=l==="/"?n:Pi([n,l])),i.createHref({pathname:d,search:c,hash:a})}function al(){return I.useContext(Jc)!=null}function Vn(){return xt(al(),"useLocation() may be used only in the context of a <Router> component."),I.useContext(Jc).location}var Bx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function zx(t){I.useContext(Kn).static||I.useLayoutEffect(t)}function Uh(){let{isDataRoute:t}=I.useContext(hr);return t?IC():pC()}function pC(){xt(al(),"useNavigate() may be used only in the context of a <Router> component.");let t=I.useContext(sl),{basename:e,navigator:n}=I.useContext(Kn),{matches:i}=I.useContext(hr),{pathname:a}=Vn(),l=JSON.stringify(Ig(i)),c=I.useRef(!1);return zx(()=>{c.current=!0}),I.useCallback((f,p={})=>{if(dr(c.current,Bx),!c.current)return;if(typeof f=="number"){n.go(f);return}let _=jg(f,JSON.parse(l),a,p.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:Pi([e,_.pathname])),(p.replace?n.replace:n.push)(_,p.state,p)},[e,n,l,a,t])}var gC=I.createContext(null);function yC(t){let e=I.useContext(hr).outlet;return I.useMemo(()=>e&&I.createElement(gC.Provider,{value:t},e),[e,t])}function _C(){let{matches:t}=I.useContext(hr),e=t[t.length-1];return e?e.params:{}}function Zc(t,{relative:e}={}){let{matches:n}=I.useContext(hr),{pathname:i}=Vn(),a=JSON.stringify(Ig(n));return I.useMemo(()=>jg(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function vC(t,e){return Ux(t,e)}function Ux(t,e,n,i,a){xt(al(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=I.useContext(Kn),{matches:c}=I.useContext(hr),d=c[c.length-1],f=d?d.params:{},p=d?d.pathname:"/",_=d?d.pathnameBase:"/",v=d&&d.route;{let F=v&&v.path||"";qx(p,!v||F.endsWith("*")||F.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${F}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${F}"> to <Route path="${F==="/"?"*":`${F}/*`}">.`)}let b=Vn(),T;if(e){let F=typeof e=="string"?il(e):e;xt(_==="/"||F.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${F.pathname}" was given in the \`location\` prop.`),T=F}else T=b;let S=T.pathname||"/",A=S;if(_!=="/"){let F=_.replace(/^\//,"").split("/");A="/"+S.replace(/^\//,"").split("/").slice(F.length).join("/")}let R=Ix(t,{pathname:A});dr(v||R!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),dr(R==null||R[R.length-1].route.element!==void 0||R[R.length-1].route.Component!==void 0||R[R.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let z=wC(R&&R.map(F=>Object.assign({},F,{params:Object.assign({},f,F.params),pathname:Pi([_,l.encodeLocation?l.encodeLocation(F.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:F.pathname]),pathnameBase:F.pathnameBase==="/"?_:Pi([_,l.encodeLocation?l.encodeLocation(F.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:F.pathnameBase])})),c,n,i,a);return e&&z?I.createElement(Jc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},z):z}function bC(){let t=DC(),e=iC(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=I.createElement(I.Fragment,null,I.createElement("p",null," Hey developer "),I.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",I.createElement("code",{style:l},"ErrorBoundary")," or"," ",I.createElement("code",{style:l},"errorElement")," prop on your route.")),I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},e),n?I.createElement("pre",{style:a},n):null,c)}var EC=I.createElement(bC,null),Fx=class extends I.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=fC(t.digest);n&&(t=n)}let e=t!==void 0?I.createElement(hr.Provider,{value:this.props.routeContext},I.createElement(Og.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?I.createElement(xC,{error:t},e):e}};Fx.contextType=oC;var Sp=new WeakMap;function xC({children:t,error:e}){let{basename:n}=I.useContext(Kn);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=hC(e.digest);if(i){let a=Sp.get(e);if(a)throw a;let l=Nx(i.location,n);if(kx&&!Sp.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw Sp.set(e,c),c}return I.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function SC({routeContext:t,match:e,children:n}){let i=I.useContext(sl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),I.createElement(hr.Provider,{value:t},n)}function wC(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=n?.errors;if(c!=null){let _=l.findIndex(v=>v.route.id&&c?.[v.route.id]!==void 0);xt(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let d=!1,f=-1;if(n)for(let _=0;_<l.length;_++){let v=l[_];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(f=_),v.route.id){let{loaderData:b,errors:T}=n,S=v.route.loader&&!b.hasOwnProperty(v.route.id)&&(!T||T[v.route.id]===void 0);if(v.route.lazy||S){d=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}let p=n&&i?(_,v)=>{i(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:sC(n.matches),errorInfo:v})}:void 0;return l.reduceRight((_,v,b)=>{let T,S=!1,A=null,R=null;n&&(T=c&&v.route.id?c[v.route.id]:void 0,A=v.route.errorElement||EC,d&&(f<0&&b===0?(qx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,R=null):f===b&&(S=!0,R=v.route.hydrateFallbackElement||null)));let z=e.concat(l.slice(0,b+1)),F=()=>{let U;return T?U=A:S?U=R:v.route.Component?U=I.createElement(v.route.Component,null):v.route.element?U=v.route.element:U=_,I.createElement(SC,{match:v,routeContext:{outlet:_,matches:z,isDataRoute:n!=null},children:U})};return n&&(v.route.ErrorBoundary||v.route.errorElement||b===0)?I.createElement(Fx,{location:n.location,revalidation:n.revalidation,component:A,error:T,children:F(),routeContext:{outlet:null,matches:z,isDataRoute:!0},onError:p}):F()},null)}function Mg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function TC(t){let e=I.useContext(sl);return xt(e,Mg(t)),e}function AC(t){let e=I.useContext(zh);return xt(e,Mg(t)),e}function CC(t){let e=I.useContext(hr);return xt(e,Mg(t)),e}function kg(t){let e=CC(t),n=e.matches[e.matches.length-1];return xt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function RC(){return kg("useRouteId")}function DC(){let t=I.useContext(Og),e=AC("useRouteError"),n=kg("useRouteError");return t!==void 0?t:e.errors?.[n]}function IC(){let{router:t}=TC("useNavigate"),e=kg("useNavigate"),n=I.useRef(!1);return zx(()=>{n.current=!0}),I.useCallback(async(a,l={})=>{dr(n.current,Bx),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var Tb={};function qx(t,e,n){!e&&!Tb[t]&&(Tb[t]=!0,dr(!1,n))}I.memo(jC);function jC({routes:t,future:e,state:n,onError:i}){return Ux(t,void 0,n,i,e)}function Fh({to:t,replace:e,state:n,relative:i}){xt(al(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=I.useContext(Kn);dr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=I.useContext(hr),{pathname:c}=Vn(),d=Uh(),f=jg(t,Ig(l),c,i==="path"),p=JSON.stringify(f);return I.useEffect(()=>{d(JSON.parse(p),{replace:e,state:n,relative:i})},[d,p,i,e,n]),null}function qh(t){return yC(t.context)}function Qt(t){xt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function OC({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){xt(!al(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=t.replace(/^\/*/,"/"),f=I.useMemo(()=>({basename:d,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[d,a,l,c]);typeof n=="string"&&(n=il(n));let{pathname:p="/",search:_="",hash:v="",state:b=null,key:T="default"}=n,S=I.useMemo(()=>{let A=Bi(p,d);return A==null?null:{location:{pathname:A,search:_,hash:v,state:b,key:T},navigationType:i}},[d,p,_,v,b,T,i]);return dr(S!=null,`<Router basename="${d}"> is not able to match the URL "${p}${_}${v}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:I.createElement(Kn.Provider,{value:f},I.createElement(Jc.Provider,{children:e,value:S}))}function MC({children:t,location:e}){return vC(Qp(t),e)}function Qp(t,e=[]){let n=[];return I.Children.forEach(t,(i,a)=>{if(!I.isValidElement(i))return;let l=[...e,a];if(i.type===I.Fragment){n.push.apply(n,Qp(i.props.children,l));return}xt(i.type===Qt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),xt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Qp(i.props.children,l)),n.push(c)}),n}var Zd="get",eh="application/x-www-form-urlencoded";function Qh(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function kC(t){return Qh(t)&&t.tagName.toLowerCase()==="button"}function NC(t){return Qh(t)&&t.tagName.toLowerCase()==="form"}function PC(t){return Qh(t)&&t.tagName.toLowerCase()==="input"}function VC(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function LC(t,e){return t.button===0&&(!e||e==="_self")&&!VC(t)}var Qd=null;function BC(){if(Qd===null)try{new FormData(document.createElement("form"),0),Qd=!1}catch{Qd=!0}return Qd}var zC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function wp(t){return t!=null&&!zC.has(t)?(dr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${eh}"`),null):t}function UC(t,e){let n,i,a,l,c;if(NC(t)){let d=t.getAttribute("action");i=d?Bi(d,e):null,n=t.getAttribute("method")||Zd,a=wp(t.getAttribute("enctype"))||eh,l=new FormData(t)}else if(kC(t)||PC(t)&&(t.type==="submit"||t.type==="image")){let d=t.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||d.getAttribute("action");if(i=f?Bi(f,e):null,n=t.getAttribute("formmethod")||d.getAttribute("method")||Zd,a=wp(t.getAttribute("formenctype"))||wp(d.getAttribute("enctype"))||eh,l=new FormData(d,t),!BC()){let{name:p,type:_,value:v}=t;if(_==="image"){let b=p?`${p}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else p&&l.append(p,v)}}else{if(Qh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Zd,i=null,a=eh,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ng(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function FC(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Bi(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function qC(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function QC(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function GC(t,e,n){let i=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let c=await qC(l,n);return c.links?c.links():[]}return[]}));return YC(i.flat(1).filter(QC).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Ab(t,e,n,i,a,l){let c=(f,p)=>n[p]?f.route.id!==n[p].route.id:!0,d=(f,p)=>n[p].pathname!==f.pathname||n[p].route.path?.endsWith("*")&&n[p].params["*"]!==f.params["*"];return l==="assets"?e.filter((f,p)=>c(f,p)||d(f,p)):l==="data"?e.filter((f,p)=>{let _=i.routes[f.route.id];if(!_||!_.hasLoader)return!1;if(c(f,p)||d(f,p))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function HC(t,e,{includeHydrateFallback:n}={}){return $C(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function $C(t){return[...new Set(t)]}function KC(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function YC(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let l=JSON.stringify(KC(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function Qx(){let t=I.useContext(sl);return Ng(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function WC(){let t=I.useContext(zh);return Ng(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Pg=I.createContext(void 0);Pg.displayName="FrameworkContext";function Gx(){let t=I.useContext(Pg);return Ng(t,"You must render this element inside a <HydratedRouter> element"),t}function XC(t,e){let n=I.useContext(Pg),[i,a]=I.useState(!1),[l,c]=I.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:p,onMouseLeave:_,onTouchStart:v}=e,b=I.useRef(null);I.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let A=z=>{z.forEach(F=>{c(F.isIntersecting)})},R=new IntersectionObserver(A,{threshold:.5});return b.current&&R.observe(b.current),()=>{R.disconnect()}}},[t]),I.useEffect(()=>{if(i){let A=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(A)}}},[i]);let T=()=>{a(!0)},S=()=>{a(!1),c(!1)};return n?t!=="intent"?[l,b,{}]:[l,b,{onFocus:Cc(d,T),onBlur:Cc(f,S),onMouseEnter:Cc(p,T),onMouseLeave:Cc(_,S),onTouchStart:Cc(v,T)}]:[!1,b,{}]}function Cc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function JC({page:t,...e}){let{router:n}=Qx(),i=I.useMemo(()=>Ix(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?I.createElement(eR,{page:t,matches:i,...e}):null}function ZC(t){let{manifest:e,routeModules:n}=Gx(),[i,a]=I.useState([]);return I.useEffect(()=>{let l=!1;return GC(t,e,n).then(c=>{l||a(c)}),()=>{l=!0}},[t,e,n]),i}function eR({page:t,matches:e,...n}){let i=Vn(),{manifest:a,routeModules:l}=Gx(),{basename:c}=Qx(),{loaderData:d,matches:f}=WC(),p=I.useMemo(()=>Ab(t,e,f,a,i,"data"),[t,e,f,a,i]),_=I.useMemo(()=>Ab(t,e,f,a,i,"assets"),[t,e,f,a,i]),v=I.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let S=new Set,A=!1;if(e.forEach(z=>{let F=a.routes[z.route.id];!F||!F.hasLoader||(!p.some(U=>U.route.id===z.route.id)&&z.route.id in d&&l[z.route.id]?.shouldRevalidate||F.hasClientLoader?A=!0:S.add(z.route.id))}),S.size===0)return[];let R=FC(t,c,"data");return A&&S.size>0&&R.searchParams.set("_routes",e.filter(z=>S.has(z.route.id)).map(z=>z.route.id).join(",")),[R.pathname+R.search]},[c,d,i,a,p,e,t,l]),b=I.useMemo(()=>HC(_,a),[_,a]),T=ZC(_);return I.createElement(I.Fragment,null,v.map(S=>I.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...n})),b.map(S=>I.createElement("link",{key:S,rel:"modulepreload",href:S,...n})),T.map(({key:S,link:A})=>I.createElement("link",{key:S,nonce:n.nonce,...A})))}function tR(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var nR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{nR&&(window.__reactRouterVersion="7.11.0")}catch{}function rR({basename:t,children:e,unstable_useTransitions:n,window:i}){let a=I.useRef();a.current==null&&(a.current=kA({window:i,v5Compat:!0}));let l=a.current,[c,d]=I.useState({action:l.action,location:l.location}),f=I.useCallback(p=>{n===!1?d(p):I.startTransition(()=>d(p))},[n]);return I.useLayoutEffect(()=>l.listen(f),[l,f]),I.createElement(OC,{basename:t,children:e,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:n})}var Hx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wt=I.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,state:d,target:f,to:p,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...T},S){let{basename:A,unstable_useTransitions:R}=I.useContext(Kn),z=typeof p=="string"&&Hx.test(p),F=Nx(p,A);p=F.to;let U=mC(p,{relative:a}),[X,Z,oe]=XC(i,T),M=oR(p,{replace:c,state:d,target:f,preventScrollReset:_,relative:a,viewTransition:v,unstable_defaultShouldRevalidate:b,unstable_useTransitions:R});function C(N){e&&e(N),N.defaultPrevented||M(N)}let D=I.createElement("a",{...T,...oe,href:F.absoluteURL||U,onClick:F.isExternal||l?e:C,ref:tR(S,Z),target:f,"data-discover":!z&&n==="render"?"true":void 0});return X&&!z?I.createElement(I.Fragment,null,D,I.createElement(JC,{page:U})):D});wt.displayName="Link";var iR=I.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:d,children:f,...p},_){let v=Zc(c,{relative:p.relative}),b=Vn(),T=I.useContext(zh),{navigator:S,basename:A}=I.useContext(Kn),R=T!=null&&hR(v)&&d===!0,z=S.encodeLocation?S.encodeLocation(v).pathname:v.pathname,F=b.pathname,U=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(F=F.toLowerCase(),U=U?U.toLowerCase():null,z=z.toLowerCase()),U&&A&&(U=Bi(U,A)||U);const X=z!=="/"&&z.endsWith("/")?z.length-1:z.length;let Z=F===z||!a&&F.startsWith(z)&&F.charAt(X)==="/",oe=U!=null&&(U===z||!a&&U.startsWith(z)&&U.charAt(z.length)==="/"),M={isActive:Z,isPending:oe,isTransitioning:R},C=Z?e:void 0,D;typeof i=="function"?D=i(M):D=[i,Z?"active":null,oe?"pending":null,R?"transitioning":null].filter(Boolean).join(" ");let N=typeof l=="function"?l(M):l;return I.createElement(wt,{...p,"aria-current":C,className:D,ref:_,style:N,to:c,viewTransition:d},typeof f=="function"?f(M):f)});iR.displayName="NavLink";var sR=I.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:l,method:c=Zd,action:d,onSubmit:f,relative:p,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...T},S)=>{let{unstable_useTransitions:A}=I.useContext(Kn),R=uR(),z=dR(d,{relative:p}),F=c.toLowerCase()==="get"?"get":"post",U=typeof d=="string"&&Hx.test(d),X=Z=>{if(f&&f(Z),Z.defaultPrevented)return;Z.preventDefault();let oe=Z.nativeEvent.submitter,M=oe?.getAttribute("formmethod")||c,C=()=>R(oe||Z.currentTarget,{fetcherKey:e,method:M,navigate:n,replace:a,state:l,relative:p,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b});A&&n!==!1?I.startTransition(()=>C()):C()};return I.createElement("form",{ref:S,method:F,action:z,onSubmit:i?f:X,...T,"data-discover":!U&&t==="render"?"true":void 0})});sR.displayName="Form";function aR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $x(t){let e=I.useContext(sl);return xt(e,aR(t)),e}function oR(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:d,unstable_useTransitions:f}={}){let p=Uh(),_=Vn(),v=Zc(t,{relative:l});return I.useCallback(b=>{if(LC(b,e)){b.preventDefault();let T=n!==void 0?n:Uc(_)===Uc(v),S=()=>p(t,{replace:T,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:d});f?I.startTransition(()=>S()):S()}},[_,p,v,n,i,e,t,a,l,c,d,f])}var lR=0,cR=()=>`__${String(++lR)}__`;function uR(){let{router:t}=$x("useSubmit"),{basename:e}=I.useContext(Kn),n=RC(),i=t.fetch,a=t.navigate;return I.useCallback(async(l,c={})=>{let{action:d,method:f,encType:p,formData:_,body:v}=UC(l,e);if(c.navigate===!1){let b=c.fetcherKey||cR();await i(b,n,c.action||d,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||f,formEncType:c.encType||p,flushSync:c.flushSync})}else await a(c.action||d,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:v,formMethod:c.method||f,formEncType:c.encType||p,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,e,n])}function dR(t,{relative:e}={}){let{basename:n}=I.useContext(Kn),i=I.useContext(hr);xt(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...Zc(t||".",{relative:e})},c=Vn();if(t==null){l.search=c.search;let d=new URLSearchParams(l.search),f=d.getAll("index");if(f.some(_=>_==="")){d.delete("index"),f.filter(v=>v).forEach(v=>d.append("index",v));let _=d.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Pi([n,l.pathname])),Uc(l)}function hR(t,{relative:e}={}){let n=I.useContext(Vx);xt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=$x("useViewTransitionState"),a=Zc(t,{relative:e});if(!n.isTransitioning)return!1;let l=Bi(n.currentLocation.pathname,i)||n.currentLocation.pathname,c=Bi(n.nextLocation.pathname,i)||n.nextLocation.pathname;return hh(a.pathname,c)!=null||hh(a.pathname,l)!=null}const fR=function(){},mR={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:fR},eu=I.createContext(mR);var ol=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},pR={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},gR=class{#e=pR;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Mi=new gR;function yR(t){setTimeout(t,0)}var Da=typeof window>"u"||"Deno"in globalThis;function Xt(){}function _R(t,e){return typeof t=="function"?t(e):t}function Gp(t){return typeof t=="number"&&t>=0&&t!==1/0}function Kx(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Is(t,e){return typeof t=="function"?t(e):t}function cr(t,e){return typeof t=="function"?t(e):t}function Cb(t,e){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:c,stale:d}=t;if(c){if(i){if(e.queryHash!==Vg(c,e.options))return!1}else if(!Fc(e.queryKey,c))return!1}if(n!=="all"){const f=e.isActive();if(n==="active"&&!f||n==="inactive"&&f)return!1}return!(typeof d=="boolean"&&e.isStale()!==d||a&&a!==e.state.fetchStatus||l&&!l(e))}function Rb(t,e){const{exact:n,status:i,predicate:a,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(Ia(e.options.mutationKey)!==Ia(l))return!1}else if(!Fc(e.options.mutationKey,l))return!1}return!(i&&e.state.status!==i||a&&!a(e))}function Vg(t,e){return(e?.queryKeyHashFn||Ia)(t)}function Ia(t){return JSON.stringify(t,(e,n)=>Hp(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function Fc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Fc(t[n],e[n])):!1}var vR=Object.prototype.hasOwnProperty;function Yx(t,e){if(t===e)return t;const n=Db(t)&&Db(e);if(!n&&!(Hp(t)&&Hp(e)))return e;const a=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),c=l.length,d=n?new Array(c):{};let f=0;for(let p=0;p<c;p++){const _=n?p:l[p],v=t[_],b=e[_];if(v===b){d[_]=v,(n?p<a:vR.call(t,_))&&f++;continue}if(v===null||b===null||typeof v!="object"||typeof b!="object"){d[_]=b;continue}const T=Yx(v,b);d[_]=T,T===v&&f++}return a===c&&f===a?t:d}function fh(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Db(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Hp(t){if(!Ib(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Ib(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Ib(t){return Object.prototype.toString.call(t)==="[object Object]"}function bR(t){return new Promise(e=>{Mi.setTimeout(e,t)})}function $p(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Yx(t,e):e}function ER(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function xR(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var Lg=Symbol();function Wx(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Lg?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Xx(t,e){return typeof t=="function"?t(...e):!!t}var SR=class extends ol{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!Da&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Bg=new SR;function Kp(){let t,e;const n=new Promise((a,l)=>{t=a,e=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),e(a)},n}function wR(t){let e;if(t.then(n=>(e=n,n),Xt)?.catch(Xt),e!==void 0)return{data:e}}function Jx(t){return t}function TR(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function AR(t,e,n){const i=()=>{const a=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return a?.catch(Xt),a};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:i()},...t.meta&&{meta:t.meta}}}function CR(t){return t.state.isPaused}function RR(t){return t.state.status==="success"}function DR(t){return!0}function IR(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??CR,i=t.getMutationCache().getAll().flatMap(f=>n(f)?[TR(f)]:[]),a=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??RR,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??DR,c=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??Jx,d=t.getQueryCache().getAll().flatMap(f=>a(f)?[AR(f,c,l)]:[]);return{mutations:i,queries:d}}function jR(t,e,n){if(typeof e!="object"||e===null)return;const i=t.getMutationCache(),a=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??Jx,c=e.mutations||[],d=e.queries||[];c.forEach(({state:f,...p})=>{i.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...p},f)}),d.forEach(({queryKey:f,state:p,queryHash:_,meta:v,promise:b,dehydratedAt:T})=>{const S=b?wR(b):void 0,A=p.data===void 0?S?.data:p.data,R=A===void 0?A:l(A);let z=a.get(_);const F=z?.state.status==="pending",U=z?.state.fetchStatus==="fetching";if(z){const X=S&&T!==void 0&&T>z.state.dataUpdatedAt;if(p.dataUpdatedAt>z.state.dataUpdatedAt||X){const{fetchStatus:Z,...oe}=p;z.setState({...oe,data:R})}}else z=a.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:f,queryHash:_,meta:v},{...p,data:R,fetchStatus:"idle",status:R!==void 0?"success":p.status});b&&!F&&!U&&(T===void 0||T>z.state.dataUpdatedAt)&&z.fetch(void 0,{initialPromise:Promise.resolve(b).then(l)}).catch(Xt)})}var OR=yR;function MR(){let t=[],e=0,n=d=>{d()},i=d=>{d()},a=OR;const l=d=>{e?t.push(d):a(()=>{n(d)})},c=()=>{const d=t;t=[],d.length&&a(()=>{i(()=>{d.forEach(f=>{n(f)})})})};return{batch:d=>{let f;e++;try{f=d()}finally{e--,e||c()}return f},batchCalls:d=>(...f)=>{l(()=>{d(...f)})},schedule:l,setNotifyFunction:d=>{n=d},setBatchNotifyFunction:d=>{i=d},setScheduler:d=>{a=d}}}var Jt=MR(),kR=class extends ol{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!Da&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},mh=new kR;function NR(t){return Math.min(1e3*2**t,3e4)}function Zx(t){return(t??"online")==="online"?mh.isOnline():!0}var Yp=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function eS(t){let e=!1,n=0,i;const a=Kp(),l=()=>a.status!=="pending",c=A=>{if(!l()){const R=new Yp(A);b(R),t.onCancel?.(R)}},d=()=>{e=!0},f=()=>{e=!1},p=()=>Bg.isFocused()&&(t.networkMode==="always"||mh.isOnline())&&t.canRun(),_=()=>Zx(t.networkMode)&&t.canRun(),v=A=>{l()||(i?.(),a.resolve(A))},b=A=>{l()||(i?.(),a.reject(A))},T=()=>new Promise(A=>{i=R=>{(l()||p())&&A(R)},t.onPause?.()}).then(()=>{i=void 0,l()||t.onContinue?.()}),S=()=>{if(l())return;let A;const R=n===0?t.initialPromise:void 0;try{A=R??t.fn()}catch(z){A=Promise.reject(z)}Promise.resolve(A).then(v).catch(z=>{if(l())return;const F=t.retry??(Da?0:3),U=t.retryDelay??NR,X=typeof U=="function"?U(n,z):U,Z=F===!0||typeof F=="number"&&n<F||typeof F=="function"&&F(n,z);if(e||!Z){b(z);return}n++,t.onFail?.(n,z),bR(X).then(()=>p()?void 0:T()).then(()=>{e?b(z):S()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(i?.(),a),cancelRetry:d,continueRetry:f,canStart:_,start:()=>(_()?S():T().then(S),a)}}var tS=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Gp(this.gcTime)&&(this.#e=Mi.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Da?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Mi.clearTimeout(this.#e),this.#e=void 0)}},PR=class extends tS{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=Ob(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Ob(this.options);n.data!==void 0&&(this.setState(jb(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const i=$p(this.state.data,e,this.options);return this.#s({data:i,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),i}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then(Xt).catch(Xt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>cr(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Lg||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Is(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!Kx(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const i=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(this.#o=!0,i.signal)})},l=()=>{const f=Wx(this.options,n),_=(()=>{const v={client:this.#i,queryKey:this.queryKey,meta:this.meta};return a(v),v})();return this.#o=!1,this.options.persister?this.options.persister(f,_,this):f(_)},d=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return a(f),f})();this.options.behavior?.onFetch(d,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==d.fetchOptions?.meta)&&this.#s({type:"fetch",meta:d.fetchOptions?.meta}),this.#r=eS({initialPromise:n?.initialPromise,fn:d.fetchFn,onCancel:f=>{f instanceof Yp&&f.revert&&this.setState({...this.#t,fetchStatus:"idle"}),i.abort()},onFail:(f,p)=>{this.#s({type:"failed",failureCount:f,error:p})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0});try{const f=await this.#r.start();if(f===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(f),this.#n.config.onSuccess?.(f,this),this.#n.config.onSettled?.(f,this.state.error,this),f}catch(f){if(f instanceof Yp){if(f.silent)return this.#r.promise;if(f.revert){if(this.state.data===void 0)throw f;return this.state.data}}throw this.#s({type:"error",error:f}),this.#n.config.onError?.(f,this),this.#n.config.onSettled?.(this.state.data,f,this),f}finally{this.scheduleGc()}}#s(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...nS(i.data,this.options),fetchMeta:e.meta??null};case"success":const a={...i,...jb(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const l=e.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),Jt.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function nS(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Zx(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function jb(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Ob(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var VR=class extends ol{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=Kp(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Mb(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Wp(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Wp(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#E(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof cr(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#x(),this.#t.setOptions(this.options),e._defaulted&&!fh(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&kb(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),i&&(this.#t!==n||cr(this.options.enabled,this.#t)!==cr(e.enabled,this.#t)||Is(this.options.staleTime,this.#t)!==Is(e.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||cr(this.options.enabled,this.#t)!==cr(e.enabled,this.#t)||a!==this.#l)&&this.#_(a)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return BR(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),e?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#x();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Xt)),e}#g(){this.#b();const t=Is(this.options.staleTime,this.#t);if(Da||this.#i.isStale||!Gp(t))return;const n=Kx(this.#i.dataUpdatedAt,t)+1;this.#c=Mi.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#E(),this.#l=t,!(Da||cr(this.options.enabled,this.#t)===!1||!Gp(this.#l)||this.#l===0)&&(this.#u=Mi.setInterval(()=>{(this.options.refetchIntervalInBackground||Bg.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#b(){this.#c&&(Mi.clearTimeout(this.#c),this.#c=void 0)}#E(){this.#u&&(Mi.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,i=this.options,a=this.#i,l=this.#r,c=this.#a,f=t!==n?t.state:this.#n,{state:p}=t;let _={...p},v=!1,b;if(e._optimisticResults){const C=this.hasListeners(),D=!C&&Mb(t,e),N=C&&kb(t,n,e,i);(D||N)&&(_={..._,...nS(p.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:T,errorUpdatedAt:S,status:A}=_;b=_.data;let R=!1;if(e.placeholderData!==void 0&&b===void 0&&A==="pending"){let C;a?.isPlaceholderData&&e.placeholderData===c?.placeholderData?(C=a.data,R=!0):C=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,C!==void 0&&(A="success",b=$p(a?.data,C,e),v=!0)}if(e.select&&b!==void 0&&!R)if(a&&b===l?.data&&e.select===this.#p)b=this.#h;else try{this.#p=e.select,b=e.select(b),b=$p(a?.data,b,e),this.#h=b,this.#s=null}catch(C){this.#s=C}this.#s&&(T=this.#s,b=this.#h,S=Date.now(),A="error");const z=_.fetchStatus==="fetching",F=A==="pending",U=A==="error",X=F&&z,Z=b!==void 0,M={status:A,fetchStatus:_.fetchStatus,isPending:F,isSuccess:A==="success",isError:U,isInitialLoading:X,isLoading:X,data:b,dataUpdatedAt:_.dataUpdatedAt,error:T,errorUpdatedAt:S,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>f.dataUpdateCount||_.errorUpdateCount>f.errorUpdateCount,isFetching:z,isRefetching:z&&!F,isLoadingError:U&&!Z,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:U&&Z,isStale:zg(t,e),refetch:this.refetch,promise:this.#o,isEnabled:cr(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const C=j=>{M.status==="error"?j.reject(M.error):M.data!==void 0&&j.resolve(M.data)},D=()=>{const j=this.#o=M.promise=Kp();C(j)},N=this.#o;switch(N.status){case"pending":t.queryHash===n.queryHash&&C(N);break;case"fulfilled":(M.status==="error"||M.data!==N.value)&&D();break;case"rejected":(M.status!=="error"||M.error!==N.reason)&&D();break}}return M}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),fh(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(c=>{const d=c;return this.#i[d]!==t[d]&&l.has(d)})};this.#S({listeners:n()})}#x(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#S(t){Jt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function LR(t,e){return cr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Mb(t,e){return LR(t,e)||t.state.data!==void 0&&Wp(t,e,e.refetchOnMount)}function Wp(t,e,n){if(cr(e.enabled,t)!==!1&&Is(e.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&zg(t,e)}return!1}function kb(t,e,n,i){return(t!==e||cr(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&zg(t,n)}function zg(t,e){return cr(e.enabled,t)!==!1&&t.isStaleByTime(Is(e.staleTime,t))}function BR(t,e){return!fh(t.getCurrentResult(),e)}function Nb(t){return{onFetch:(e,n)=>{const i=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],c=e.state.data?.pageParams||[];let d={pages:[],pageParams:[]},f=0;const p=async()=>{let _=!1;const v=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},b=Wx(e.options,e.fetchOptions),T=async(S,A,R)=>{if(_)return Promise.reject();if(A==null&&S.pages.length)return Promise.resolve(S);const F=(()=>{const oe={client:e.client,queryKey:e.queryKey,pageParam:A,direction:R?"backward":"forward",meta:e.options.meta};return v(oe),oe})(),U=await b(F),{maxPages:X}=e.options,Z=R?xR:ER;return{pages:Z(S.pages,U,X),pageParams:Z(S.pageParams,A,X)}};if(a&&l.length){const S=a==="backward",A=S?zR:Pb,R={pages:l,pageParams:c},z=A(i,R);d=await T(R,z,S)}else{const S=t??l.length;do{const A=f===0?c[0]??i.initialPageParam:Pb(i,d);if(f>0&&A==null)break;d=await T(d,A),f++}while(f<S)}return d};e.options.persister?e.fetchFn=()=>e.options.persister?.(p,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=p}}}function Pb(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function zR(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var UR=class extends tS{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||rS(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=eS({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(c,d)=>{this.#r({type:"failed",failureCount:c,error:d})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",l=!this.#i.canStart();try{if(a)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,i);const d=await this.options.onMutate?.(e,i);d!==this.state.context&&this.#r({type:"pending",context:d,variables:e,isPaused:l})}const c=await this.#i.start();return await this.#n.config.onSuccess?.(c,e,this.state.context,this,i),await this.options.onSuccess?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(c,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(c,null,e,this.state.context,i),this.#r({type:"success",data:c}),c}catch(c){try{throw await this.#n.config.onError?.(c,e,this.state.context,this,i),await this.options.onError?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(void 0,c,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,c,e,this.state.context,i),c}finally{this.#r({type:"error",error:c})}}finally{this.#n.runNext(this)}}#r(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Jt.batch(()=>{this.#t.forEach(i=>{i.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function rS(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var FR=class extends ol{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const i=new UR({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){this.#e.add(t);const e=Gd(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Gd(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Gd(t);if(typeof e=="string"){const i=this.#t.get(e)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const e=Gd(t);return typeof e=="string"?this.#t.get(e)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Jt.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Rb(e,n))}findAll(t={}){return this.getAll().filter(e=>Rb(t,e))}notify(t){Jt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return Jt.batch(()=>Promise.all(t.map(e=>e.continue().catch(Xt))))}};function Gd(t){return t.options.scope?.id}var qR=class extends ol{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),fh(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&Ia(n.mutationKey)!==Ia(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??rS();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){Jt.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,i,a),this.#i.onSettled?.(e.data,null,n,i,a)):e?.type==="error"&&(this.#i.onError?.(e.error,n,i,a),this.#i.onSettled?.(void 0,e.error,n,i,a))}this.listeners.forEach(n=>{n(this.#t)})})}},QR=class extends ol{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const i=e.queryKey,a=e.queryHash??Vg(i,e);let l=this.get(a);return l||(l=new PR({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Jt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Cb(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>Cb(t,n)):e}notify(t){Jt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Jt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Jt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},GR=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new QR,this.#t=t.mutationCache||new FR,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=Bg.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=mh.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Is(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(i.queryHash)?.state.data,c=_R(e,l);if(c!==void 0)return this.#e.build(this,i).setData(c,{...n,manual:!0})}setQueriesData(t,e,n){return Jt.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;Jt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return Jt.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=Jt.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then(Xt).catch(Xt)}invalidateQueries(t,e={}){return Jt.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=Jt.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(Xt)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(Xt)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Is(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Xt).catch(Xt)}fetchInfiniteQuery(t){return t.behavior=Nb(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Xt).catch(Xt)}ensureInfiniteQueryData(t){return t.behavior=Nb(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return mh.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Ia(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(i=>{Fc(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Ia(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(i=>{Fc(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Vg(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Lg&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},iS=I.createContext(void 0),fi=t=>{const e=I.useContext(iS);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},HR=({client:t,children:e})=>(I.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),h.jsx(iS.Provider,{value:t,children:e})),sS=I.createContext(!1),$R=()=>I.useContext(sS),KR=sS.Provider;function YR(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var WR=I.createContext(YR()),XR=()=>I.useContext(WR),JR=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},ZR=t=>{I.useEffect(()=>{t.clearReset()},[t])},eD=({result:t,errorResetBoundary:e,throwOnError:n,query:i,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||Xx(n,[t.error,i])),tD=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},nD=(t,e)=>t.isLoading&&t.isFetching&&!e,rD=(t,e)=>t?.suspense&&e.isPending,Vb=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function iD(t,e,n){const i=$R(),a=XR(),l=fi(),c=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c),c._optimisticResults=i?"isRestoring":"optimistic",tD(c),JR(c,a),ZR(a);const d=!l.getQueryCache().get(c.queryHash),[f]=I.useState(()=>new e(l,c)),p=f.getOptimisticResult(c),_=!i&&t.subscribed!==!1;if(I.useSyncExternalStore(I.useCallback(v=>{const b=_?f.subscribe(Jt.batchCalls(v)):Xt;return f.updateResult(),b},[f,_]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),I.useEffect(()=>{f.setOptions(c)},[c,f]),rD(c,p))throw Vb(c,f,a);if(eD({result:p,errorResetBoundary:a,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw p.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,p),c.experimental_prefetchInRender&&!Da&&nD(p,i)&&(d?Vb(c,f,a):l.getQueryCache().get(c.queryHash)?.promise)?.catch(Xt).finally(()=>{f.updateResult()}),c.notifyOnChangeProps?p:f.trackResult(p)}function ll(t,e){return iD(t,VR)}function pt(t,e){const n=fi(),[i]=I.useState(()=>new qR(n,t));I.useEffect(()=>{i.setOptions(t)},[i,t]);const a=I.useSyncExternalStore(I.useCallback(c=>i.subscribe(Jt.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=I.useCallback((c,d)=>{i.mutate(c,d).catch(Xt)},[i]);if(a.error&&Xx(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}function Xp(){}function sD(t,{interval:e=1e3,onError:n=Xp}={}){if(typeof t!="function")throw new Error("argument is not function.");let i=0,a=null,l=!1,c=!1;return async(...d)=>{if(a=d,!c){for(c=!0;l;)await new Promise(f=>Mi.setTimeout(f,e));for(;Date.now()<i;)await new Promise(f=>Mi.setTimeout(f,i-Date.now()));c=!1,l=!0;try{await t(...a)}catch(f){try{n(f)}catch{}}i=Date.now()+e,l=!1}}}var aD=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:i=JSON.stringify,deserialize:a=JSON.parse,retry:l})=>{if(t){const c=async d=>{try{const f=await i(d);await t.setItem(e,f);return}catch(f){return f}};return{persistClient:sD(async d=>{let f=d,p=await c(f),_=0;for(;p&&f;)_++,f=await l?.({persistedClient:f,error:p,errorCount:_}),f&&(p=await c(f))},{interval:n}),restoreClient:async()=>{const d=await t.getItem(e);if(d)return await a(d)},removeClient:()=>t.removeItem(e)}}return{persistClient:Xp,restoreClient:()=>Promise.resolve(void 0),removeClient:Xp}};const Ne=new GR({defaultOptions:{queries:{staleTime:300*1e3,gcTime:1440*60*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}});Ne.getQueryCache().subscribe(t=>{const e=t?.query;if(e&&t.type==="updated"){const{state:n}=e;n.status==="error"&&n.error&&console.error("[RQ] Query FAILED:",e.queryKey,n.error)}});const oD=aD({storage:typeof window<"u"?{getItem:t=>Promise.resolve(localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(localStorage.removeItem(t))}:void 0,key:"BUDGET_APP_QUERY_CACHE"}),ne={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};var lD=["added","removed","updated"];function Lb(t){return lD.includes(t)}async function cD({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:i="",hydrateOptions:a}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const c=Date.now()-l.timestamp>n,d=l.buster!==i;if(c||d)return e.removeClient();jR(t,l.clientState,a)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function Bb({queryClient:t,persister:e,buster:n="",dehydrateOptions:i}){const a={buster:n,timestamp:Date.now(),clientState:IR(t,i)};await e.persistClient(a)}function uD(t){const e=t.queryClient.getQueryCache().subscribe(i=>{Lb(i.type)&&Bb(t)}),n=t.queryClient.getMutationCache().subscribe(i=>{Lb(i.type)&&Bb(t)});return()=>{e(),n()}}var dD=({children:t,persistOptions:e,onSuccess:n,onError:i,...a})=>{const[l,c]=I.useState(!0),d=I.useRef({persistOptions:e,onSuccess:n,onError:i}),f=I.useRef(!1);return I.useEffect(()=>{d.current={persistOptions:e,onSuccess:n,onError:i}}),I.useEffect(()=>{const p={...d.current.persistOptions,queryClient:a.client};return f.current||(f.current=!0,cD(p).then(()=>d.current.onSuccess?.()).catch(()=>d.current.onError?.()).finally(()=>{c(!1)})),l?void 0:uD(p)},[a.client,l]),h.jsx(HR,{...a,children:h.jsx(KR,{value:l,children:t})})};function hD({children:t}){return h.jsx(dD,{client:Ne,persistOptions:{persister:oD,maxAge:1440*60*1e3,buster:"v1"},children:t})}const fD=()=>{};var zb={};const aS=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},mD=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],c=t[n++],d=t[n++],f=((a&7)<<18|(l&63)<<12|(c&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const l=t[n++],c=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},oS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],c=a+1<t.length,d=c?t[a+1]:0,f=a+2<t.length,p=f?t[a+2]:0,_=l>>2,v=(l&3)<<4|d>>4;let b=(d&15)<<2|p>>6,T=p&63;f||(T=64,c||(b=64)),i.push(n[_],n[v],n[b],n[T])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(aS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):mD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],d=a<t.length?n[t.charAt(a)]:0;++a;const p=a<t.length?n[t.charAt(a)]:64;++a;const v=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||d==null||p==null||v==null)throw new pD;const b=l<<2|d>>4;if(i.push(b),p!==64){const T=d<<4&240|p>>2;if(i.push(T),v!==64){const S=p<<6&192|v;i.push(S)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class pD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gD=function(t){const e=aS(t);return oS.encodeByteArray(e,!0)},ph=function(t){return gD(t).replace(/\./g,"")},lS=function(t){try{return oS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function yD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const _D=()=>yD().__FIREBASE_DEFAULTS__,vD=()=>{if(typeof process>"u"||typeof zb>"u")return;const t=zb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},bD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&lS(t[1]);return e&&JSON.parse(e)},Gh=()=>{try{return fD()||_D()||vD()||bD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},cS=t=>Gh()?.emulatorHosts?.[t],ED=t=>{const e=cS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},uS=()=>Gh()?.config,dS=t=>Gh()?.[`_${t}`];class xD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function cl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hS(t){return(await fetch(t,{credentials:"include"})).ok}function SD(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[ph(JSON.stringify(n)),ph(JSON.stringify(c)),""].join(".")}const Nc={};function wD(){const t={prod:[],emulator:[]};for(const e of Object.keys(Nc))Nc[e]?t.emulator.push(e):t.prod.push(e);return t}function TD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Ub=!1;function fS(t,e){if(typeof window>"u"||typeof document>"u"||!cl(window.location.host)||Nc[t]===e||Nc[t]||Ub)return;Nc[t]=e;function n(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=wD().prod.length>0;function c(){const b=document.getElementById(i);b&&b.remove()}function d(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function f(b,T){b.setAttribute("width","24"),b.setAttribute("id",T),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function p(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{Ub=!0,c()},b}function _(b,T){b.setAttribute("id",T),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function v(){const b=TD(i),T=n("text"),S=document.getElementById(T)||document.createElement("span"),A=n("learnmore"),R=document.getElementById(A)||document.createElement("a"),z=n("preprendIcon"),F=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const U=b.element;d(U),_(R,A);const X=p();f(F,z),U.append(F,S,R,X),document.body.appendChild(U)}l?(S.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function Sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function AD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Sn())}function CD(){const t=Gh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function RD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function DD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function ID(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jD(){const t=Sn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function OD(){return!CD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function MD(){try{return typeof indexedDB=="object"}catch{return!1}}function kD(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const ND="FirebaseError";class Gi extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=ND,Object.setPrototypeOf(this,Gi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,tu.prototype.create)}}class tu{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?PD(l,i):"Error",d=`${this.serviceName}: ${c} (${a}).`;return new Gi(a,d,i)}}function PD(t,e){return t.replace(VD,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const VD=/\{\$([^}]+)}/g;function LD(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Vs(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],c=e[a];if(Fb(l)&&Fb(c)){if(!Vs(l,c))return!1}else if(l!==c)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function Fb(t){return t!==null&&typeof t=="object"}function nu(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Dc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Ic(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function BD(t,e){const n=new zD(t,e);return n.subscribe.bind(n)}class zD{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");UD(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=Tp),a.error===void 0&&(a.error=Tp),a.complete===void 0&&(a.complete=Tp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function UD(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Tp(){}function an(t){return t&&t._delegate?t._delegate:t}class ja{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Aa="[DEFAULT]";class FD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new xD;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(QD(e))try{this.getOrInitializeService({instanceIdentifier:Aa})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=Aa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Aa){return this.instances.has(e)}getOptions(e=Aa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);i===d&&c.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:qD(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Aa){return this.component?this.component.multipleInstances?e:Aa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qD(t){return t===Aa?void 0:t}function QD(t){return t.instantiationMode==="EAGER"}class GD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new FD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Ke;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ke||(Ke={}));const HD={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},$D=Ke.INFO,KD={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},YD=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=KD[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ug{constructor(e){this.name=e,this._logLevel=$D,this._logHandler=YD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?HD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const WD=(t,e)=>e.some(n=>t instanceof n);let qb,Qb;function XD(){return qb||(qb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JD(){return Qb||(Qb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mS=new WeakMap,Jp=new WeakMap,pS=new WeakMap,Ap=new WeakMap,Fg=new WeakMap;function ZD(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",c)},l=()=>{n(js(t.result)),a()},c=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",c)});return e.then(n=>{n instanceof IDBCursor&&mS.set(n,t)}).catch(()=>{}),Fg.set(e,t),e}function eI(t){if(Jp.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",c),t.removeEventListener("abort",c)},l=()=>{n(),a()},c=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",c),t.addEventListener("abort",c)});Jp.set(t,e)}let Zp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Jp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||pS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return js(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tI(t){Zp=t(Zp)}function nI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(Cp(this),e,...n);return pS.set(i,e.sort?e.sort():[e]),js(i)}:JD().includes(t)?function(...e){return t.apply(Cp(this),e),js(mS.get(this))}:function(...e){return js(t.apply(Cp(this),e))}}function rI(t){return typeof t=="function"?nI(t):(t instanceof IDBTransaction&&eI(t),WD(t,XD())?new Proxy(t,Zp):t)}function js(t){if(t instanceof IDBRequest)return ZD(t);if(Ap.has(t))return Ap.get(t);const e=rI(t);return e!==t&&(Ap.set(t,e),Fg.set(e,t)),e}const Cp=t=>Fg.get(t);function iI(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const c=indexedDB.open(t,e),d=js(c);return i&&c.addEventListener("upgradeneeded",f=>{i(js(c.result),f.oldVersion,f.newVersion,js(c.transaction),f)}),n&&c.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),d.then(f=>{l&&f.addEventListener("close",()=>l()),a&&f.addEventListener("versionchange",p=>a(p.oldVersion,p.newVersion,p))}).catch(()=>{}),d}const sI=["get","getKey","getAll","getAllKeys","count"],aI=["put","add","delete","clear"],Rp=new Map;function Gb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Rp.get(e))return Rp.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=aI.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||sI.includes(n)))return;const l=async function(c,...d){const f=this.transaction(c,a?"readwrite":"readonly");let p=f.store;return i&&(p=p.index(d.shift())),(await Promise.all([p[n](...d),a&&f.done]))[0]};return Rp.set(e,l),l}tI(t=>({...t,get:(e,n,i)=>Gb(e,n)||t.get(e,n,i),has:(e,n)=>!!Gb(e,n)||t.has(e,n)}));class oI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lI(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function lI(t){return t.getComponent()?.type==="VERSION"}const eg="@firebase/app",Hb="0.14.6";const zi=new Ug("@firebase/app"),cI="@firebase/app-compat",uI="@firebase/analytics-compat",dI="@firebase/analytics",hI="@firebase/app-check-compat",fI="@firebase/app-check",mI="@firebase/auth",pI="@firebase/auth-compat",gI="@firebase/database",yI="@firebase/data-connect",_I="@firebase/database-compat",vI="@firebase/functions",bI="@firebase/functions-compat",EI="@firebase/installations",xI="@firebase/installations-compat",SI="@firebase/messaging",wI="@firebase/messaging-compat",TI="@firebase/performance",AI="@firebase/performance-compat",CI="@firebase/remote-config",RI="@firebase/remote-config-compat",DI="@firebase/storage",II="@firebase/storage-compat",jI="@firebase/firestore",OI="@firebase/ai",MI="@firebase/firestore-compat",kI="firebase",NI="12.6.0";const tg="[DEFAULT]",PI={[eg]:"fire-core",[cI]:"fire-core-compat",[dI]:"fire-analytics",[uI]:"fire-analytics-compat",[fI]:"fire-app-check",[hI]:"fire-app-check-compat",[mI]:"fire-auth",[pI]:"fire-auth-compat",[gI]:"fire-rtdb",[yI]:"fire-data-connect",[_I]:"fire-rtdb-compat",[vI]:"fire-fn",[bI]:"fire-fn-compat",[EI]:"fire-iid",[xI]:"fire-iid-compat",[SI]:"fire-fcm",[wI]:"fire-fcm-compat",[TI]:"fire-perf",[AI]:"fire-perf-compat",[CI]:"fire-rc",[RI]:"fire-rc-compat",[DI]:"fire-gcs",[II]:"fire-gcs-compat",[jI]:"fire-fst",[MI]:"fire-fst-compat",[OI]:"fire-vertex","fire-js":"fire-js",[kI]:"fire-js-all"};const gh=new Map,VI=new Map,ng=new Map;function $b(t,e){try{t.container.addComponent(e)}catch(n){zi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ko(t){const e=t.name;if(ng.has(e))return zi.debug(`There were multiple attempts to register component ${e}.`),!1;ng.set(e,t);for(const n of gh.values())$b(n,t);for(const n of VI.values())$b(n,t);return!0}function qg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Ar(t){return t==null?!1:t.settings!==void 0}const LI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Os=new tu("app","Firebase",LI);class BI{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ja("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Os.create("app-deleted",{appName:this._name})}}const ul=NI;function gS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:tg,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw Os.create("bad-app-name",{appName:String(a)});if(n||(n=uS()),!n)throw Os.create("no-options");const l=gh.get(a);if(l){if(Vs(n,l.options)&&Vs(i,l.config))return l;throw Os.create("duplicate-app",{appName:a})}const c=new GD(a);for(const f of ng.values())c.addComponent(f);const d=new BI(n,i,c);return gh.set(a,d),d}function yS(t=tg){const e=gh.get(t);if(!e&&t===tg&&uS())return gS();if(!e)throw Os.create("no-app",{appName:t});return e}function Ms(t,e,n){let i=PI[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zi.warn(c.join(" "));return}Ko(new ja(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const zI="firebase-heartbeat-database",UI=1,qc="firebase-heartbeat-store";let Dp=null;function _S(){return Dp||(Dp=iI(zI,UI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(qc)}catch(n){console.warn(n)}}}}).catch(t=>{throw Os.create("idb-open",{originalErrorMessage:t.message})})),Dp}async function FI(t){try{const n=(await _S()).transaction(qc),i=await n.objectStore(qc).get(vS(t));return await n.done,i}catch(e){if(e instanceof Gi)zi.warn(e.message);else{const n=Os.create("idb-get",{originalErrorMessage:e?.message});zi.warn(n.message)}}}async function Kb(t,e){try{const i=(await _S()).transaction(qc,"readwrite");await i.objectStore(qc).put(e,vS(t)),await i.done}catch(n){if(n instanceof Gi)zi.warn(n.message);else{const i=Os.create("idb-set",{originalErrorMessage:n?.message});zi.warn(i.message)}}}function vS(t){return`${t.name}!${t.options.appId}`}const qI=1024,QI=30;class GI{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new $I(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Yb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>QI){const a=KI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){zi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Yb(),{heartbeatsToSend:n,unsentEntries:i}=HI(this._heartbeatsCache.heartbeats),a=ph(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return zi.warn(e),""}}}function Yb(){return new Date().toISOString().substring(0,10)}function HI(t,e=qI){const n=[];let i=t.slice();for(const a of t){const l=n.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),Wb(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Wb(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class $I{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return MD()?kD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await FI(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Kb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Kb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Wb(t){return ph(JSON.stringify({version:2,heartbeats:t})).length}function KI(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function YI(t){Ko(new ja("platform-logger",e=>new oI(e),"PRIVATE")),Ko(new ja("heartbeat",e=>new GI(e),"PRIVATE")),Ms(eg,Hb,t),Ms(eg,Hb,"esm2020"),Ms("fire-js","")}YI("");var Xb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ks,bS;(function(){var t;function e(M,C){function D(){}D.prototype=C.prototype,M.F=C.prototype,M.prototype=new D,M.prototype.constructor=M,M.D=function(N,j,B){for(var O=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)O[Y-2]=arguments[Y];return C.prototype[j].apply(N,O)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(M,C,D){D||(D=0);const N=Array(16);if(typeof C=="string")for(var j=0;j<16;++j)N[j]=C.charCodeAt(D++)|C.charCodeAt(D++)<<8|C.charCodeAt(D++)<<16|C.charCodeAt(D++)<<24;else for(j=0;j<16;++j)N[j]=C[D++]|C[D++]<<8|C[D++]<<16|C[D++]<<24;C=M.g[0],D=M.g[1],j=M.g[2];let B=M.g[3],O;O=C+(B^D&(j^B))+N[0]+3614090360&4294967295,C=D+(O<<7&4294967295|O>>>25),O=B+(j^C&(D^j))+N[1]+3905402710&4294967295,B=C+(O<<12&4294967295|O>>>20),O=j+(D^B&(C^D))+N[2]+606105819&4294967295,j=B+(O<<17&4294967295|O>>>15),O=D+(C^j&(B^C))+N[3]+3250441966&4294967295,D=j+(O<<22&4294967295|O>>>10),O=C+(B^D&(j^B))+N[4]+4118548399&4294967295,C=D+(O<<7&4294967295|O>>>25),O=B+(j^C&(D^j))+N[5]+1200080426&4294967295,B=C+(O<<12&4294967295|O>>>20),O=j+(D^B&(C^D))+N[6]+2821735955&4294967295,j=B+(O<<17&4294967295|O>>>15),O=D+(C^j&(B^C))+N[7]+4249261313&4294967295,D=j+(O<<22&4294967295|O>>>10),O=C+(B^D&(j^B))+N[8]+1770035416&4294967295,C=D+(O<<7&4294967295|O>>>25),O=B+(j^C&(D^j))+N[9]+2336552879&4294967295,B=C+(O<<12&4294967295|O>>>20),O=j+(D^B&(C^D))+N[10]+4294925233&4294967295,j=B+(O<<17&4294967295|O>>>15),O=D+(C^j&(B^C))+N[11]+2304563134&4294967295,D=j+(O<<22&4294967295|O>>>10),O=C+(B^D&(j^B))+N[12]+1804603682&4294967295,C=D+(O<<7&4294967295|O>>>25),O=B+(j^C&(D^j))+N[13]+4254626195&4294967295,B=C+(O<<12&4294967295|O>>>20),O=j+(D^B&(C^D))+N[14]+2792965006&4294967295,j=B+(O<<17&4294967295|O>>>15),O=D+(C^j&(B^C))+N[15]+1236535329&4294967295,D=j+(O<<22&4294967295|O>>>10),O=C+(j^B&(D^j))+N[1]+4129170786&4294967295,C=D+(O<<5&4294967295|O>>>27),O=B+(D^j&(C^D))+N[6]+3225465664&4294967295,B=C+(O<<9&4294967295|O>>>23),O=j+(C^D&(B^C))+N[11]+643717713&4294967295,j=B+(O<<14&4294967295|O>>>18),O=D+(B^C&(j^B))+N[0]+3921069994&4294967295,D=j+(O<<20&4294967295|O>>>12),O=C+(j^B&(D^j))+N[5]+3593408605&4294967295,C=D+(O<<5&4294967295|O>>>27),O=B+(D^j&(C^D))+N[10]+38016083&4294967295,B=C+(O<<9&4294967295|O>>>23),O=j+(C^D&(B^C))+N[15]+3634488961&4294967295,j=B+(O<<14&4294967295|O>>>18),O=D+(B^C&(j^B))+N[4]+3889429448&4294967295,D=j+(O<<20&4294967295|O>>>12),O=C+(j^B&(D^j))+N[9]+568446438&4294967295,C=D+(O<<5&4294967295|O>>>27),O=B+(D^j&(C^D))+N[14]+3275163606&4294967295,B=C+(O<<9&4294967295|O>>>23),O=j+(C^D&(B^C))+N[3]+4107603335&4294967295,j=B+(O<<14&4294967295|O>>>18),O=D+(B^C&(j^B))+N[8]+1163531501&4294967295,D=j+(O<<20&4294967295|O>>>12),O=C+(j^B&(D^j))+N[13]+2850285829&4294967295,C=D+(O<<5&4294967295|O>>>27),O=B+(D^j&(C^D))+N[2]+4243563512&4294967295,B=C+(O<<9&4294967295|O>>>23),O=j+(C^D&(B^C))+N[7]+1735328473&4294967295,j=B+(O<<14&4294967295|O>>>18),O=D+(B^C&(j^B))+N[12]+2368359562&4294967295,D=j+(O<<20&4294967295|O>>>12),O=C+(D^j^B)+N[5]+4294588738&4294967295,C=D+(O<<4&4294967295|O>>>28),O=B+(C^D^j)+N[8]+2272392833&4294967295,B=C+(O<<11&4294967295|O>>>21),O=j+(B^C^D)+N[11]+1839030562&4294967295,j=B+(O<<16&4294967295|O>>>16),O=D+(j^B^C)+N[14]+4259657740&4294967295,D=j+(O<<23&4294967295|O>>>9),O=C+(D^j^B)+N[1]+2763975236&4294967295,C=D+(O<<4&4294967295|O>>>28),O=B+(C^D^j)+N[4]+1272893353&4294967295,B=C+(O<<11&4294967295|O>>>21),O=j+(B^C^D)+N[7]+4139469664&4294967295,j=B+(O<<16&4294967295|O>>>16),O=D+(j^B^C)+N[10]+3200236656&4294967295,D=j+(O<<23&4294967295|O>>>9),O=C+(D^j^B)+N[13]+681279174&4294967295,C=D+(O<<4&4294967295|O>>>28),O=B+(C^D^j)+N[0]+3936430074&4294967295,B=C+(O<<11&4294967295|O>>>21),O=j+(B^C^D)+N[3]+3572445317&4294967295,j=B+(O<<16&4294967295|O>>>16),O=D+(j^B^C)+N[6]+76029189&4294967295,D=j+(O<<23&4294967295|O>>>9),O=C+(D^j^B)+N[9]+3654602809&4294967295,C=D+(O<<4&4294967295|O>>>28),O=B+(C^D^j)+N[12]+3873151461&4294967295,B=C+(O<<11&4294967295|O>>>21),O=j+(B^C^D)+N[15]+530742520&4294967295,j=B+(O<<16&4294967295|O>>>16),O=D+(j^B^C)+N[2]+3299628645&4294967295,D=j+(O<<23&4294967295|O>>>9),O=C+(j^(D|~B))+N[0]+4096336452&4294967295,C=D+(O<<6&4294967295|O>>>26),O=B+(D^(C|~j))+N[7]+1126891415&4294967295,B=C+(O<<10&4294967295|O>>>22),O=j+(C^(B|~D))+N[14]+2878612391&4294967295,j=B+(O<<15&4294967295|O>>>17),O=D+(B^(j|~C))+N[5]+4237533241&4294967295,D=j+(O<<21&4294967295|O>>>11),O=C+(j^(D|~B))+N[12]+1700485571&4294967295,C=D+(O<<6&4294967295|O>>>26),O=B+(D^(C|~j))+N[3]+2399980690&4294967295,B=C+(O<<10&4294967295|O>>>22),O=j+(C^(B|~D))+N[10]+4293915773&4294967295,j=B+(O<<15&4294967295|O>>>17),O=D+(B^(j|~C))+N[1]+2240044497&4294967295,D=j+(O<<21&4294967295|O>>>11),O=C+(j^(D|~B))+N[8]+1873313359&4294967295,C=D+(O<<6&4294967295|O>>>26),O=B+(D^(C|~j))+N[15]+4264355552&4294967295,B=C+(O<<10&4294967295|O>>>22),O=j+(C^(B|~D))+N[6]+2734768916&4294967295,j=B+(O<<15&4294967295|O>>>17),O=D+(B^(j|~C))+N[13]+1309151649&4294967295,D=j+(O<<21&4294967295|O>>>11),O=C+(j^(D|~B))+N[4]+4149444226&4294967295,C=D+(O<<6&4294967295|O>>>26),O=B+(D^(C|~j))+N[11]+3174756917&4294967295,B=C+(O<<10&4294967295|O>>>22),O=j+(C^(B|~D))+N[2]+718787259&4294967295,j=B+(O<<15&4294967295|O>>>17),O=D+(B^(j|~C))+N[9]+3951481745&4294967295,M.g[0]=M.g[0]+C&4294967295,M.g[1]=M.g[1]+(j+(O<<21&4294967295|O>>>11))&4294967295,M.g[2]=M.g[2]+j&4294967295,M.g[3]=M.g[3]+B&4294967295}i.prototype.v=function(M,C){C===void 0&&(C=M.length);const D=C-this.blockSize,N=this.C;let j=this.h,B=0;for(;B<C;){if(j==0)for(;B<=D;)a(this,M,B),B+=this.blockSize;if(typeof M=="string"){for(;B<C;)if(N[j++]=M.charCodeAt(B++),j==this.blockSize){a(this,N),j=0;break}}else for(;B<C;)if(N[j++]=M[B++],j==this.blockSize){a(this,N),j=0;break}}this.h=j,this.o+=C},i.prototype.A=function(){var M=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);M[0]=128;for(var C=1;C<M.length-8;++C)M[C]=0;C=this.o*8;for(var D=M.length-8;D<M.length;++D)M[D]=C&255,C/=256;for(this.v(M),M=Array(16),C=0,D=0;D<4;++D)for(let N=0;N<32;N+=8)M[C++]=this.g[D]>>>N&255;return M};function l(M,C){var D=d;return Object.prototype.hasOwnProperty.call(D,M)?D[M]:D[M]=C(M)}function c(M,C){this.h=C;const D=[];let N=!0;for(let j=M.length-1;j>=0;j--){const B=M[j]|0;N&&B==C||(D[j]=B,N=!1)}this.g=D}var d={};function f(M){return-128<=M&&M<128?l(M,function(C){return new c([C|0],C<0?-1:0)}):new c([M|0],M<0?-1:0)}function p(M){if(isNaN(M)||!isFinite(M))return v;if(M<0)return R(p(-M));const C=[];let D=1;for(let N=0;M>=D;N++)C[N]=M/D|0,D*=4294967296;return new c(C,0)}function _(M,C){if(M.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(M.charAt(0)=="-")return R(_(M.substring(1),C));if(M.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=p(Math.pow(C,8));let N=v;for(let B=0;B<M.length;B+=8){var j=Math.min(8,M.length-B);const O=parseInt(M.substring(B,B+j),C);j<8?(j=p(Math.pow(C,j)),N=N.j(j).add(p(O))):(N=N.j(D),N=N.add(p(O)))}return N}var v=f(0),b=f(1),T=f(16777216);t=c.prototype,t.m=function(){if(A(this))return-R(this).m();let M=0,C=1;for(let D=0;D<this.g.length;D++){const N=this.i(D);M+=(N>=0?N:4294967296+N)*C,C*=4294967296}return M},t.toString=function(M){if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(S(this))return"0";if(A(this))return"-"+R(this).toString(M);const C=p(Math.pow(M,6));var D=this;let N="";for(;;){const j=X(D,C).g;D=z(D,j.j(C));let B=((D.g.length>0?D.g[0]:D.h)>>>0).toString(M);if(D=j,S(D))return B+N;for(;B.length<6;)B="0"+B;N=B+N}},t.i=function(M){return M<0?0:M<this.g.length?this.g[M]:this.h};function S(M){if(M.h!=0)return!1;for(let C=0;C<M.g.length;C++)if(M.g[C]!=0)return!1;return!0}function A(M){return M.h==-1}t.l=function(M){return M=z(this,M),A(M)?-1:S(M)?0:1};function R(M){const C=M.g.length,D=[];for(let N=0;N<C;N++)D[N]=~M.g[N];return new c(D,~M.h).add(b)}t.abs=function(){return A(this)?R(this):this},t.add=function(M){const C=Math.max(this.g.length,M.g.length),D=[];let N=0;for(let j=0;j<=C;j++){let B=N+(this.i(j)&65535)+(M.i(j)&65535),O=(B>>>16)+(this.i(j)>>>16)+(M.i(j)>>>16);N=O>>>16,B&=65535,O&=65535,D[j]=O<<16|B}return new c(D,D[D.length-1]&-2147483648?-1:0)};function z(M,C){return M.add(R(C))}t.j=function(M){if(S(this)||S(M))return v;if(A(this))return A(M)?R(this).j(R(M)):R(R(this).j(M));if(A(M))return R(this.j(R(M)));if(this.l(T)<0&&M.l(T)<0)return p(this.m()*M.m());const C=this.g.length+M.g.length,D=[];for(var N=0;N<2*C;N++)D[N]=0;for(N=0;N<this.g.length;N++)for(let j=0;j<M.g.length;j++){const B=this.i(N)>>>16,O=this.i(N)&65535,Y=M.i(j)>>>16,q=M.i(j)&65535;D[2*N+2*j]+=O*q,F(D,2*N+2*j),D[2*N+2*j+1]+=B*q,F(D,2*N+2*j+1),D[2*N+2*j+1]+=O*Y,F(D,2*N+2*j+1),D[2*N+2*j+2]+=B*Y,F(D,2*N+2*j+2)}for(M=0;M<C;M++)D[M]=D[2*M+1]<<16|D[2*M];for(M=C;M<2*C;M++)D[M]=0;return new c(D,0)};function F(M,C){for(;(M[C]&65535)!=M[C];)M[C+1]+=M[C]>>>16,M[C]&=65535,C++}function U(M,C){this.g=M,this.h=C}function X(M,C){if(S(C))throw Error("division by zero");if(S(M))return new U(v,v);if(A(M))return C=X(R(M),C),new U(R(C.g),R(C.h));if(A(C))return C=X(M,R(C)),new U(R(C.g),C.h);if(M.g.length>30){if(A(M)||A(C))throw Error("slowDivide_ only works with positive integers.");for(var D=b,N=C;N.l(M)<=0;)D=Z(D),N=Z(N);var j=oe(D,1),B=oe(N,1);for(N=oe(N,2),D=oe(D,2);!S(N);){var O=B.add(N);O.l(M)<=0&&(j=j.add(D),B=O),N=oe(N,1),D=oe(D,1)}return C=z(M,j.j(C)),new U(j,C)}for(j=v;M.l(C)>=0;){for(D=Math.max(1,Math.floor(M.m()/C.m())),N=Math.ceil(Math.log(D)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),B=p(D),O=B.j(C);A(O)||O.l(M)>0;)D-=N,B=p(D),O=B.j(C);S(B)&&(B=b),j=j.add(B),M=z(M,O)}return new U(j,M)}t.B=function(M){return X(this,M).h},t.and=function(M){const C=Math.max(this.g.length,M.g.length),D=[];for(let N=0;N<C;N++)D[N]=this.i(N)&M.i(N);return new c(D,this.h&M.h)},t.or=function(M){const C=Math.max(this.g.length,M.g.length),D=[];for(let N=0;N<C;N++)D[N]=this.i(N)|M.i(N);return new c(D,this.h|M.h)},t.xor=function(M){const C=Math.max(this.g.length,M.g.length),D=[];for(let N=0;N<C;N++)D[N]=this.i(N)^M.i(N);return new c(D,this.h^M.h)};function Z(M){const C=M.g.length+1,D=[];for(let N=0;N<C;N++)D[N]=M.i(N)<<1|M.i(N-1)>>>31;return new c(D,M.h)}function oe(M,C){const D=C>>5;C%=32;const N=M.g.length-D,j=[];for(let B=0;B<N;B++)j[B]=C>0?M.i(B+D)>>>C|M.i(B+D+1)<<32-C:M.i(B+D);return new c(j,M.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,bS=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=_,ks=c}).apply(typeof Xb<"u"?Xb:typeof self<"u"?self:typeof window<"u"?window:{});var Hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ES,jc,xS,th,rg,SS,wS,TS;(function(){var t,e=Object.defineProperty;function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof Hd=="object"&&Hd];for(var E=0;E<m.length;++E){var w=m[E];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var i=n(this);function a(m,E){if(E)e:{var w=i;m=m.split(".");for(var V=0;V<m.length-1;V++){var re=m[V];if(!(re in w))break e;w=w[re]}m=m[m.length-1],V=w[m],E=E(V),E!=V&&E!=null&&e(w,m,{configurable:!0,writable:!0,value:E})}}a("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(m){return m||function(E){var w=[],V;for(V in E)Object.prototype.hasOwnProperty.call(E,V)&&w.push([V,E[V]]);return w}});var l=l||{},c=this||self;function d(m){var E=typeof m;return E=="object"&&m!=null||E=="function"}function f(m,E,w){return m.call.apply(m.bind,arguments)}function p(m,E,w){return p=f,p.apply(null,arguments)}function _(m,E){var w=Array.prototype.slice.call(arguments,1);return function(){var V=w.slice();return V.push.apply(V,arguments),m.apply(this,V)}}function v(m,E){function w(){}w.prototype=E.prototype,m.Z=E.prototype,m.prototype=new w,m.prototype.constructor=m,m.Ob=function(V,re,ue){for(var Se=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)Se[Be-2]=arguments[Be];return E.prototype[re].apply(V,Se)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function T(m){const E=m.length;if(E>0){const w=Array(E);for(let V=0;V<E;V++)w[V]=m[V];return w}return[]}function S(m,E){for(let V=1;V<arguments.length;V++){const re=arguments[V];var w=typeof re;if(w=w!="object"?w:re?Array.isArray(re)?"array":w:"null",w=="array"||w=="object"&&typeof re.length=="number"){w=m.length||0;const ue=re.length||0;m.length=w+ue;for(let Se=0;Se<ue;Se++)m[w+Se]=re[Se]}else m.push(re)}}class A{constructor(E,w){this.i=E,this.j=w,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function R(m){c.setTimeout(()=>{throw m},0)}function z(){var m=M;let E=null;return m.g&&(E=m.g,m.g=m.g.next,m.g||(m.h=null),E.next=null),E}class F{constructor(){this.h=this.g=null}add(E,w){const V=U.get();V.set(E,w),this.h?this.h.next=V:this.g=V,this.h=V}}var U=new A(()=>new X,m=>m.reset());class X{constructor(){this.next=this.g=this.h=null}set(E,w){this.h=E,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let Z,oe=!1,M=new F,C=()=>{const m=Promise.resolve(void 0);Z=()=>{m.then(D)}};function D(){for(var m;m=z();){try{m.h.call(m.g)}catch(w){R(w)}var E=U;E.j(m),E.h<100&&(E.h++,m.next=E.g,E.g=m)}oe=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(m,E){this.type=m,this.g=this.target=E,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var B=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var m=!1,E=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const w=()=>{};c.addEventListener("test",w,E),c.removeEventListener("test",w,E)}catch{}return m})();function O(m){return/^[\s\xa0]*$/.test(m)}function Y(m,E){j.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,E)}v(Y,j),Y.prototype.init=function(m,E){const w=this.type=m.type,V=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=E,E=m.relatedTarget,E||(w=="mouseover"?E=m.fromElement:w=="mouseout"&&(E=m.toElement)),this.relatedTarget=E,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&Y.Z.h.call(this)},Y.prototype.h=function(){Y.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var q="closure_listenable_"+(Math.random()*1e6|0),P=0;function Q(m,E,w,V,re){this.listener=m,this.proxy=null,this.src=E,this.type=w,this.capture=!!V,this.ha=re,this.key=++P,this.da=this.fa=!1}function H(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function K(m,E,w){for(const V in m)E.call(w,m[V],V,m)}function te(m,E){for(const w in m)E.call(void 0,m[w],w,m)}function L(m){const E={};for(const w in m)E[w]=m[w];return E}const G="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ce(m,E){let w,V;for(let re=1;re<arguments.length;re++){V=arguments[re];for(w in V)m[w]=V[w];for(let ue=0;ue<G.length;ue++)w=G[ue],Object.prototype.hasOwnProperty.call(V,w)&&(m[w]=V[w])}}function J(m){this.src=m,this.g={},this.h=0}J.prototype.add=function(m,E,w,V,re){const ue=m.toString();m=this.g[ue],m||(m=this.g[ue]=[],this.h++);const Se=_e(m,E,V,re);return Se>-1?(E=m[Se],w||(E.fa=!1)):(E=new Q(E,this.src,ue,!!V,re),E.fa=w,m.push(E)),E};function ie(m,E){const w=E.type;if(w in m.g){var V=m.g[w],re=Array.prototype.indexOf.call(V,E,void 0),ue;(ue=re>=0)&&Array.prototype.splice.call(V,re,1),ue&&(H(E),m.g[w].length==0&&(delete m.g[w],m.h--))}}function _e(m,E,w,V){for(let re=0;re<m.length;++re){const ue=m[re];if(!ue.da&&ue.listener==E&&ue.capture==!!w&&ue.ha==V)return re}return-1}var Ee="closure_lm_"+(Math.random()*1e6|0),be={};function xe(m,E,w,V,re){if(Array.isArray(E)){for(let ue=0;ue<E.length;ue++)xe(m,E[ue],w,V,re);return null}return w=Ct(w),m&&m[q]?m.J(E,w,d(V)?!!V.capture:!1,re):he(m,E,w,!1,V,re)}function he(m,E,w,V,re,ue){if(!E)throw Error("Invalid event type");const Se=d(re)?!!re.capture:!!re;let Be=Mr(m);if(Be||(m[Ee]=Be=new J(m)),w=Be.add(E,w,V,Se,ue),w.proxy)return w;if(V=nt(),w.proxy=V,V.src=m,V.listener=w,m.addEventListener)B||(re=Se),re===void 0&&(re=!1),m.addEventListener(E.toString(),V,re);else if(m.attachEvent)m.attachEvent(en(E.toString()),V);else if(m.addListener&&m.removeListener)m.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return w}function nt(){function m(w){return E.call(m.src,m.listener,w)}const E=Or;return m}function Fe(m,E,w,V,re){if(Array.isArray(E))for(var ue=0;ue<E.length;ue++)Fe(m,E[ue],w,V,re);else V=d(V)?!!V.capture:!!V,w=Ct(w),m&&m[q]?(m=m.i,ue=String(E).toString(),ue in m.g&&(E=m.g[ue],w=_e(E,w,V,re),w>-1&&(H(E[w]),Array.prototype.splice.call(E,w,1),E.length==0&&(delete m.g[ue],m.h--)))):m&&(m=Mr(m))&&(E=m.g[E.toString()],m=-1,E&&(m=_e(E,w,V,re)),(w=m>-1?E[m]:null)&&ln(w))}function ln(m){if(typeof m!="number"&&m&&!m.da){var E=m.src;if(E&&E[q])ie(E.i,m);else{var w=m.type,V=m.proxy;E.removeEventListener?E.removeEventListener(w,V,m.capture):E.detachEvent?E.detachEvent(en(w),V):E.addListener&&E.removeListener&&E.removeListener(V),(w=Mr(E))?(ie(w,m),w.h==0&&(w.src=null,E[Ee]=null)):H(m)}}}function en(m){return m in be?be[m]:be[m]="on"+m}function Or(m,E){if(m.da)m=!0;else{E=new Y(E,this);const w=m.listener,V=m.ha||m.src;m.fa&&ln(m),m=w.call(V,E)}return m}function Mr(m){return m=m[Ee],m instanceof J?m:null}var Ws="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ct(m){return typeof m=="function"?m:(m[Ws]||(m[Ws]=function(E){return m.handleEvent(E)}),m[Ws])}function st(){N.call(this),this.i=new J(this),this.M=this,this.G=null}v(st,N),st.prototype[q]=!0,st.prototype.removeEventListener=function(m,E,w,V){Fe(this,m,E,w,V)};function St(m,E){var w,V=m.G;if(V)for(w=[];V;V=V.G)w.push(V);if(m=m.M,V=E.type||E,typeof E=="string")E=new j(E,m);else if(E instanceof j)E.target=E.target||m;else{var re=E;E=new j(V,m),ce(E,re)}re=!0;let ue,Se;if(w)for(Se=w.length-1;Se>=0;Se--)ue=E.g=w[Se],re=Yn(ue,V,!0,E)&&re;if(ue=E.g=m,re=Yn(ue,V,!0,E)&&re,re=Yn(ue,V,!1,E)&&re,w)for(Se=0;Se<w.length;Se++)ue=E.g=w[Se],re=Yn(ue,V,!1,E)&&re}st.prototype.N=function(){if(st.Z.N.call(this),this.i){var m=this.i;for(const E in m.g){const w=m.g[E];for(let V=0;V<w.length;V++)H(w[V]);delete m.g[E],m.h--}}this.G=null},st.prototype.J=function(m,E,w,V){return this.i.add(String(m),E,!1,w,V)},st.prototype.K=function(m,E,w,V){return this.i.add(String(m),E,!0,w,V)};function Yn(m,E,w,V){if(E=m.i.g[String(E)],!E)return!0;E=E.concat();let re=!0;for(let ue=0;ue<E.length;++ue){const Se=E[ue];if(Se&&!Se.da&&Se.capture==w){const Be=Se.listener,jt=Se.ha||Se.src;Se.fa&&ie(m.i,Se),re=Be.call(jt,V)!==!1&&re}}return re&&!V.defaultPrevented}function Sl(m,E){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=p(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:c.setTimeout(m,E||0)}function fr(m){m.g=Sl(()=>{m.g=null,m.i&&(m.i=!1,fr(m))},m.l);const E=m.h;m.h=null,m.m.apply(null,E)}class Yt extends N{constructor(E,w){super(),this.m=E,this.l=w,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:fr(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xs(m){N.call(this),this.h=m,this.g={}}v(Xs,N);var wl=[];function Tl(m){K(m.g,function(E,w){this.g.hasOwnProperty(w)&&ln(E)},m),m.g={}}Xs.prototype.N=function(){Xs.Z.N.call(this),Tl(this)},Xs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Hi=c.JSON.stringify,vf=c.JSON.parse,gu=class{stringify(m){return c.JSON.stringify(m,void 0)}parse(m){return c.JSON.parse(m,void 0)}};function yu(){}function _u(){}var mr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function cn(){j.call(this,"d")}v(cn,j);function Wn(){j.call(this,"c")}v(Wn,j);var It={},vu=null;function Ua(){return vu=vu||new st}It.Ia="serverreachability";function bu(m){j.call(this,It.Ia,m)}v(bu,j);function kr(m){const E=Ua();St(E,new bu(E))}It.STAT_EVENT="statevent";function Js(m,E){j.call(this,It.STAT_EVENT,m),this.stat=E}v(Js,j);function Pt(m){const E=Ua();St(E,new Js(E,m))}It.Ja="timingevent";function Nr(m,E){j.call(this,It.Ja,m),this.size=E}v(Nr,j);function Pr(m,E){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){m()},E)}function pr(){this.g=!0}pr.prototype.ua=function(){this.g=!1};function bf(m,E,w,V,re,ue){m.info(function(){if(m.g)if(ue){var Se="",Be=ue.split("&");for(let rt=0;rt<Be.length;rt++){var jt=Be[rt].split("=");if(jt.length>1){const bt=jt[0];jt=jt[1];const er=bt.split("_");Se=er.length>=2&&er[1]=="type"?Se+(bt+"="+jt+"&"):Se+(bt+"=redacted&")}}}else Se=null;else Se=ue;return"XMLHTTP REQ ("+V+") [attempt "+re+"]: "+E+`
`+w+`
`+Se})}function Eu(m,E,w,V,re,ue,Se){m.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+re+"]: "+E+`
`+w+`
`+ue+" "+Se})}function Vr(m,E,w,V){m.info(function(){return"XMLHTTP TEXT ("+E+"): "+Ef(m,w)+(V?" "+V:"")})}function Zs(m,E){m.info(function(){return"TIMEOUT: "+E})}pr.prototype.info=function(){};function Ef(m,E){if(!m.g)return E;if(!E)return null;try{const ue=JSON.parse(E);if(ue){for(m=0;m<ue.length;m++)if(Array.isArray(ue[m])){var w=ue[m];if(!(w.length<2)){var V=w[1];if(Array.isArray(V)&&!(V.length<1)){var re=V[0];if(re!="noop"&&re!="stop"&&re!="close")for(let Se=1;Se<V.length;Se++)V[Se]=""}}}}return Hi(ue)}catch{return E}}var ea={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Al={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Cl;function ta(){}v(ta,yu),ta.prototype.g=function(){return new XMLHttpRequest},Cl=new ta;function mi(m){return encodeURIComponent(String(m))}function xu(m){var E=1;m=m.split(":");const w=[];for(;E>0&&m.length;)w.push(m.shift()),E--;return m.length&&w.push(m.join(":")),w}function gr(m,E,w,V){this.j=m,this.i=E,this.l=w,this.S=V||1,this.V=new Xs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new yr}function yr(){this.i=null,this.g="",this.h=!1}var Vt={},tn={};function Lr(m,E,w){m.M=1,m.A=na(Bt(E)),m.u=w,m.R=!0,Fa(m,null)}function Fa(m,E){m.F=Date.now(),Br(m),m.B=Bt(m.A);var w=m.B,V=m.S;Array.isArray(V)||(V=[String(V)]),Ha(w.i,"t",V),m.C=0,w=m.j.L,m.h=new yr,m.g=Vu(m.j,w?E:null,!m.u),m.P>0&&(m.O=new Yt(p(m.Y,m,m.g),m.P)),E=m.V,w=m.g,V=m.ba;var re="readystatechange";Array.isArray(re)||(re&&(wl[0]=re.toString()),re=wl);for(let ue=0;ue<re.length;ue++){const Se=xe(w,re[ue],V||E.handleEvent,!1,E.h||E);if(!Se)break;E.g[Se.key]=Se}E=m.J?L(m.J):{},m.u?(m.v||(m.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,E)):(m.v="GET",m.g.ea(m.B,m.v,null,E)),kr(),bf(m.i,m.v,m.B,m.l,m.S,m.u)}gr.prototype.ba=function(m){m=m.target;const E=this.O;E&&br(m)==3?E.j():this.Y(m)},gr.prototype.Y=function(m){try{if(m==this.g)e:{const Be=br(this.g),jt=this.g.ya(),rt=this.g.ca();if(!(Be<3)&&(Be!=3||this.g&&(this.h.h||this.g.la()||un(this.g)))){this.K||Be!=4||jt==7||(jt==8||rt<=0?kr(3):kr(2)),zr(this);var E=this.g.ca();this.X=E;var w=xf(this);if(this.o=E==200,Eu(this.i,this.v,this.B,this.l,this.S,Be,E),this.o){if(this.U&&!this.L){t:{if(this.g){var V,re=this.g;if((V=re.g?re.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(V)){var ue=V;break t}}ue=null}if(m=ue)Vr(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ur(this,m);else{this.o=!1,this.m=3,Pt(12),Ln(this),Xn(this);break e}}if(this.R){m=!0;let bt;for(;!this.K&&this.C<w.length;)if(bt=wu(this,w),bt==tn){Be==4&&(this.m=4,Pt(14),m=!1),Vr(this.i,this.l,null,"[Incomplete Response]");break}else if(bt==Vt){this.m=4,Pt(15),Vr(this.i,this.l,w,"[Invalid Chunk]"),m=!1;break}else Vr(this.i,this.l,bt,null),Ur(this,bt);if(Su(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Be!=4||w.length!=0||this.h.h||(this.m=1,Pt(16),m=!1),this.o=this.o&&m,!m)Vr(this.i,this.l,w,"[Invalid Chunked Response]"),Ln(this),Xn(this);else if(w.length>0&&!this.W){this.W=!0;var Se=this.j;Se.g==this&&Se.aa&&!Se.P&&(Se.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Fl(Se),Se.P=!0,Pt(11))}}else Vr(this.i,this.l,w,null),Ur(this,w);Be==4&&Ln(this),this.o&&!this.K&&(Be==4?Mu(this.j,this):(this.o=!1,Br(this)))}else gi(this.g),E==400&&w.indexOf("Unknown SID")>0?(this.m=3,Pt(12)):(this.m=0,Pt(13)),Ln(this),Xn(this)}}}catch{}};function xf(m){if(!Su(m))return m.g.la();const E=un(m.g);if(E==="")return"";let w="";const V=E.length,re=br(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Ln(m),Xn(m),"";m.h.i=new c.TextDecoder}for(let ue=0;ue<V;ue++)m.h.h=!0,w+=m.h.i.decode(E[ue],{stream:!(re&&ue==V-1)});return E.length=0,m.h.g+=w,m.C=0,m.h.g}function Su(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function wu(m,E){var w=m.C,V=E.indexOf(`
`,w);return V==-1?tn:(w=Number(E.substring(w,V)),isNaN(w)?Vt:(V+=1,V+w>E.length?tn:(E=E.slice(V,V+w),m.C=V+w,E)))}gr.prototype.cancel=function(){this.K=!0,Ln(this)};function Br(m){m.T=Date.now()+m.H,qa(m,m.H)}function qa(m,E){if(m.D!=null)throw Error("WatchDog timer not null");m.D=Pr(p(m.aa,m),E)}function zr(m){m.D&&(c.clearTimeout(m.D),m.D=null)}gr.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(Zs(this.i,this.B),this.M!=2&&(kr(),Pt(17)),Ln(this),this.m=2,Xn(this)):qa(this,this.T-m)};function Xn(m){m.j.I==0||m.K||Mu(m.j,m)}function Ln(m){zr(m);var E=m.O;E&&typeof E.dispose=="function"&&E.dispose(),m.O=null,Tl(m.V),m.g&&(E=m.g,m.g=null,E.abort(),E.dispose())}function Ur(m,E){try{var w=m.j;if(w.I!=0&&(w.g==m||qr(w.h,m))){if(!m.L&&qr(w.h,m)&&w.I==3){try{var V=w.Ba.g.parse(E)}catch{V=null}if(Array.isArray(V)&&V.length==3){var re=V;if(re[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<m.F)Xa(w),es(w);else break e;ca(w),Pt(18)}}else w.xa=re[1],0<w.xa-w.K&&re[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=Pr(p(w.Va,w),6e3));Fr(w.h)<=1&&w.ta&&(w.ta=void 0)}else Yr(w,11)}else if((m.L||w.g==m)&&Xa(w),!O(E))for(re=w.Ba.g.parse(E),E=0;E<re.length;E++){let rt=re[E];const bt=rt[0];if(!(bt<=w.K))if(w.K=bt,rt=rt[1],w.I==2)if(rt[0]=="c"){w.M=rt[1],w.ba=rt[2];const er=rt[3];er!=null&&(w.ka=er,w.j.info("VER="+w.ka));const Wr=rt[4];Wr!=null&&(w.za=Wr,w.j.info("SVER="+w.za));const Er=rt[5];Er!=null&&typeof Er=="number"&&Er>0&&(V=1.5*Er,w.O=V,w.j.info("backChannelRequestTimeoutMs_="+V)),V=w;const xr=m.g;if(xr){const ua=xr.g?xr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ua){var ue=V.h;ue.g||ua.indexOf("spdy")==-1&&ua.indexOf("quic")==-1&&ua.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(Il(ue,ue.h),ue.h=null))}if(V.G){const Ja=xr.g?xr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ja&&(V.wa=Ja,ot(V.J,V.G,Ja))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-m.F,w.j.info("Handshake RTT: "+w.T+"ms")),V=w;var Se=m;if(V.na=Pu(V,V.L?V.ba:null,V.W),Se.L){jl(V.h,Se);var Be=Se,jt=V.O;jt&&(Be.H=jt),Be.D&&(zr(Be),Br(Be)),V.g=Se}else ju(V);w.i.length>0&&Kr(w)}else rt[0]!="stop"&&rt[0]!="close"||Yr(w,7);else w.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?Yr(w,7):zl(w):rt[0]!="noop"&&w.l&&w.l.qa(rt),w.A=0)}}kr(4)}catch{}}var Lt=class{constructor(m,E){this.g=m,this.map=E}};function Rl(m){this.l=m||10,c.PerformanceNavigationTiming?(m=c.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Dl(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function Fr(m){return m.h?1:m.g?m.g.size:0}function qr(m,E){return m.h?m.h==E:m.g?m.g.has(E):!1}function Il(m,E){m.g?m.g.add(E):m.h=E}function jl(m,E){m.h&&m.h==E?m.h=null:m.g&&m.g.has(E)&&m.g.delete(E)}Rl.prototype.cancel=function(){if(this.i=Ol(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Ol(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let E=m.i;for(const w of m.g.values())E=E.concat(w.G);return E}return T(m.i)}var Tu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qa(m,E){if(m){m=m.split("&");for(let w=0;w<m.length;w++){const V=m[w].indexOf("=");let re,ue=null;V>=0?(re=m[w].substring(0,V),ue=m[w].substring(V+1)):re=m[w],E(re,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function Bn(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;m instanceof Bn?(this.l=m.l,nn(this,m.j),this.o=m.o,this.g=m.g,$i(this,m.u),this.h=m.h,Ml(this,Du(m.i)),this.m=m.m):m&&(E=String(m).match(Tu))?(this.l=!1,nn(this,E[1]||"",!0),this.o=Qr(E[2]||""),this.g=Qr(E[3]||"",!0),$i(this,E[4]),this.h=Qr(E[5]||"",!0),Ml(this,E[6]||"",!0),this.m=Qr(E[7]||"")):(this.l=!1,this.i=new Yi(null,this.l))}Bn.prototype.toString=function(){const m=[];var E=this.j;E&&m.push(ra(E,Ga,!0),":");var w=this.g;return(w||E=="file")&&(m.push("//"),(E=this.o)&&m.push(ra(E,Ga,!0),"@"),m.push(mi(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&m.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&m.push("/"),m.push(ra(w,w.charAt(0)=="/"?kl:Au,!0))),(w=this.i.toString())&&m.push("?",w),(w=this.m)&&m.push("#",ra(w,Cu)),m.join("")},Bn.prototype.resolve=function(m){const E=Bt(this);let w=!!m.j;w?nn(E,m.j):w=!!m.o,w?E.o=m.o:w=!!m.g,w?E.g=m.g:w=m.u!=null;var V=m.h;if(w)$i(E,m.u);else if(w=!!m.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var re=E.h.lastIndexOf("/");re!=-1&&(V=E.h.slice(0,re+1)+V)}if(re=V,re==".."||re==".")V="";else if(re.indexOf("./")!=-1||re.indexOf("/.")!=-1){V=re.lastIndexOf("/",0)==0,re=re.split("/");const ue=[];for(let Se=0;Se<re.length;){const Be=re[Se++];Be=="."?V&&Se==re.length&&ue.push(""):Be==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),V&&Se==re.length&&ue.push("")):(ue.push(Be),V=!0)}V=ue.join("/")}else V=re}return w?E.h=V:w=m.i.toString()!=="",w?Ml(E,Du(m.i)):w=!!m.m,w&&(E.m=m.m),E};function Bt(m){return new Bn(m)}function nn(m,E,w){m.j=w?Qr(E,!0):E,m.j&&(m.j=m.j.replace(/:$/,""))}function $i(m,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);m.u=E}else m.u=null}function Ml(m,E,w){E instanceof Yi?(m.i=E,$a(m.i,m.l)):(w||(E=ra(E,Ki)),m.i=new Yi(E,m.l))}function ot(m,E,w){m.i.set(E,w)}function na(m){return ot(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Qr(m,E){return m?E?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function ra(m,E,w){return typeof m=="string"?(m=encodeURI(m).replace(E,Cn),w&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function Cn(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Ga=/[#\/\?@]/g,Au=/[#\?:]/g,kl=/[#\?]/g,Ki=/[#\?@]/g,Cu=/#/g;function Yi(m,E){this.h=this.g=null,this.i=m||null,this.j=!!E}function Rn(m){m.g||(m.g=new Map,m.h=0,m.i&&Qa(m.i,function(E,w){m.add(decodeURIComponent(E.replace(/\+/g," ")),w)}))}t=Yi.prototype,t.add=function(m,E){Rn(this),this.i=null,m=Wi(this,m);let w=this.g.get(m);return w||this.g.set(m,w=[]),w.push(E),this.h+=1,this};function Ru(m,E){Rn(m),E=Wi(m,E),m.g.has(E)&&(m.i=null,m.h-=m.g.get(E).length,m.g.delete(E))}function Nl(m,E){return Rn(m),E=Wi(m,E),m.g.has(E)}t.forEach=function(m,E){Rn(this),this.g.forEach(function(w,V){w.forEach(function(re){m.call(E,re,V,this)},this)},this)};function Pl(m,E){Rn(m);let w=[];if(typeof E=="string")Nl(m,E)&&(w=w.concat(m.g.get(Wi(m,E))));else for(m=Array.from(m.g.values()),E=0;E<m.length;E++)w=w.concat(m[E]);return w}t.set=function(m,E){return Rn(this),this.i=null,m=Wi(this,m),Nl(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[E]),this.h+=1,this},t.get=function(m,E){return m?(m=Pl(this,m),m.length>0?String(m[0]):E):E};function Ha(m,E,w){Ru(m,E),w.length>0&&(m.i=null,m.g.set(Wi(m,E),T(w)),m.h+=w.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],E=Array.from(this.g.keys());for(let V=0;V<E.length;V++){var w=E[V];const re=mi(w);w=Pl(this,w);for(let ue=0;ue<w.length;ue++){let Se=re;w[ue]!==""&&(Se+="="+mi(w[ue])),m.push(Se)}}return this.i=m.join("&")};function Du(m){const E=new Yi;return E.i=m.i,m.g&&(E.g=new Map(m.g),E.h=m.h),E}function Wi(m,E){return E=String(E),m.j&&(E=E.toLowerCase()),E}function $a(m,E){E&&!m.j&&(Rn(m),m.i=null,m.g.forEach(function(w,V){const re=V.toLowerCase();V!=re&&(Ru(this,V),Ha(this,re,w))},m)),m.j=E}function _r(m,E){const w=new pr;if(c.Image){const V=new Image;V.onload=_(Jn,w,"TestLoadImage: loaded",!0,E,V),V.onerror=_(Jn,w,"TestLoadImage: error",!1,E,V),V.onabort=_(Jn,w,"TestLoadImage: abort",!1,E,V),V.ontimeout=_(Jn,w,"TestLoadImage: timeout",!1,E,V),c.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=m}else E(!1)}function Vl(m,E){const w=new pr,V=new AbortController,re=setTimeout(()=>{V.abort(),Jn(w,"TestPingServer: timeout",!1,E)},1e4);fetch(m,{signal:V.signal}).then(ue=>{clearTimeout(re),ue.ok?Jn(w,"TestPingServer: ok",!0,E):Jn(w,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(re),Jn(w,"TestPingServer: error",!1,E)})}function Jn(m,E,w,V,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),V(w)}catch{}}function Xi(){this.g=new gu}function Gr(m){this.i=m.Sb||null,this.h=m.ab||!1}v(Gr,yu),Gr.prototype.g=function(){return new ia(this.i,this.h)};function ia(m,E){st.call(this),this.H=m,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(ia,st),t=ia.prototype,t.open=function(m,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=E,this.readyState=1,vr(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(E.body=m),(this.H||c).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ji(this)),this.readyState=0},t.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,vr(this)),this.g&&(this.readyState=3,vr(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ka(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ka(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}t.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var E=m.value?m.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!m.done}))&&(this.response=this.responseText+=E)}m.done?Ji(this):vr(this),this.readyState==3&&Ka(this)}},t.Oa=function(m){this.g&&(this.response=this.responseText=m,Ji(this))},t.Na=function(m){this.g&&(this.response=m,Ji(this))},t.ga=function(){this.g&&Ji(this)};function Ji(m){m.readyState=4,m.l=null,m.j=null,m.B=null,vr(m)}t.setRequestHeader=function(m,E){this.A.append(m,E)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],E=this.h.entries();for(var w=E.next();!w.done;)w=w.value,m.push(w[0]+": "+w[1]),w=E.next();return m.join(`\r
`)};function vr(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(ia.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Zn(m){let E="";return K(m,function(w,V){E+=V,E+=":",E+=w,E+=`\r
`}),E}function sa(m,E,w){e:{for(V in w){var V=!1;break e}V=!0}V||(w=Zn(w),typeof m=="string"?w!=null&&mi(w):ot(m,E,w))}function ut(m){st.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ut,st);var Hr=/^https?$/i,Ll=["POST","PUT"];t=ut.prototype,t.Fa=function(m){this.H=m},t.ea=function(m,E,w,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);E=E?E.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Cl.g(),this.g.onreadystatechange=b(p(this.Ca,this));try{this.B=!0,this.g.open(E,String(m),!0),this.B=!1}catch(ue){aa(this,ue);return}if(m=w||"",w=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var re in V)w.set(re,V[re]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const ue of V.keys())w.set(ue,V.get(ue));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(w.keys()).find(ue=>ue.toLowerCase()=="content-type"),re=c.FormData&&m instanceof c.FormData,!(Array.prototype.indexOf.call(Ll,E,void 0)>=0)||V||re||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,Se]of w)this.g.setRequestHeader(ue,Se);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(ue){aa(this,ue)}};function aa(m,E){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=E,m.o=5,Bl(m),pi(m)}function Bl(m){m.A||(m.A=!0,St(m,"complete"),St(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,St(this,"complete"),St(this,"abort"),pi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),pi(this,!0)),ut.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?oa(this):this.Xa())},t.Xa=function(){oa(this)};function oa(m){if(m.h&&typeof l<"u"){if(m.v&&br(m)==4)setTimeout(m.Ca.bind(m),0);else if(St(m,"readystatechange"),br(m)==4){m.h=!1;try{const ue=m.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var w;if(!(w=E)){var V;if(V=ue===0){let Se=String(m.D).match(Tu)[1]||null;!Se&&c.self&&c.self.location&&(Se=c.self.location.protocol.slice(0,-1)),V=!Hr.test(Se?Se.toLowerCase():"")}w=V}if(w)St(m,"complete"),St(m,"success");else{m.o=6;try{var re=br(m)>2?m.g.statusText:""}catch{re=""}m.l=re+" ["+m.ca()+"]",Bl(m)}}finally{pi(m)}}}}function pi(m,E){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const w=m.g;m.g=null,E||St(m,"ready");try{w.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function br(m){return m.g?m.g.readyState:0}t.ca=function(){try{return br(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(m){if(this.g){var E=this.g.responseText;return m&&E.indexOf(m)==0&&(E=E.substring(m.length)),vf(E)}};function un(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function gi(m){const E={};m=(m.g&&br(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<m.length;V++){if(O(m[V]))continue;var w=xu(m[V]);const re=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const ue=E[re]||[];E[re]=ue,ue.push(w)}te(E,function(V){return V.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function $r(m,E,w){return w&&w.internalChannelParams&&w.internalChannelParams[m]||E}function Zi(m){this.za=0,this.i=[],this.j=new pr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=$r("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=$r("baseRetryDelayMs",5e3,m),this.Za=$r("retryDelaySeedMs",1e4,m),this.Ta=$r("forwardChannelMaxRetries",2,m),this.va=$r("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Rl(m&&m.concurrentRequestLimit),this.Ba=new Xi,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Zi.prototype,t.ka=8,t.I=1,t.connect=function(m,E,w,V){Pt(0),this.W=m,this.H=E||{},w&&V!==void 0&&(this.H.OSID=w,this.H.OAID=V),this.F=this.X,this.J=Pu(this,null,this.W),Kr(this)};function zl(m){if(Ya(m),m.I==3){var E=m.V++,w=Bt(m.J);if(ot(w,"SID",m.M),ot(w,"RID",E),ot(w,"TYPE","terminate"),la(m,w),E=new gr(m,m.j,E),E.M=2,E.A=na(Bt(w)),w=!1,c.navigator&&c.navigator.sendBeacon)try{w=c.navigator.sendBeacon(E.A.toString(),"")}catch{}!w&&c.Image&&(new Image().src=E.A,w=!0),w||(E.g=Vu(E.j,null),E.g.ea(E.A)),E.F=Date.now(),Br(E)}Nu(m)}function es(m){m.g&&(Fl(m),m.g.cancel(),m.g=null)}function Ya(m){es(m),m.v&&(c.clearTimeout(m.v),m.v=null),Xa(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&c.clearTimeout(m.m),m.m=null)}function Kr(m){if(!Dl(m.h)&&!m.m){m.m=!0;var E=m.Ea;Z||C(),oe||(Z(),oe=!0),M.add(E,m),m.D=0}}function Wa(m,E){return Fr(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=E.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=Pr(p(m.Ea,m,E),ku(m,m.D)),m.D++,!0)}t.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const re=new gr(this,this.j,m);let ue=this.o;if(this.U&&(ue?(ue=L(ue),ce(ue,this.U)):ue=this.U),this.u!==null||this.R||(re.J=ue,ue=null),this.S)e:{for(var E=0,w=0;w<this.i.length;w++){t:{var V=this.i[w];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(E+=V,E>4096){E=w;break e}if(E===4096||w===this.i.length-1){E=w+1;break e}}E=1e3}else E=1e3;E=Iu(this,re,E),w=Bt(this.J),ot(w,"RID",m),ot(w,"CVER",22),this.G&&ot(w,"X-HTTP-Session-Id",this.G),la(this,w),ue&&(this.R?E="headers="+mi(Zn(ue))+"&"+E:this.u&&sa(w,this.u,ue)),Il(this.h,re),this.Ra&&ot(w,"TYPE","init"),this.S?(ot(w,"$req",E),ot(w,"SID","null"),re.U=!0,Lr(re,w,null)):Lr(re,w,E),this.I=2}}else this.I==3&&(m?Ul(this,m):this.i.length==0||Dl(this.h)||Ul(this))};function Ul(m,E){var w;E?w=E.l:w=m.V++;const V=Bt(m.J);ot(V,"SID",m.M),ot(V,"RID",w),ot(V,"AID",m.K),la(m,V),m.u&&m.o&&sa(V,m.u,m.o),w=new gr(m,m.j,w,m.D+1),m.u===null&&(w.J=m.o),E&&(m.i=E.G.concat(m.i)),E=Iu(m,w,1e3),w.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),Il(m.h,w),Lr(w,V,E)}function la(m,E){m.H&&K(m.H,function(w,V){ot(E,V,w)}),m.l&&K({},function(w,V){ot(E,V,w)})}function Iu(m,E,w){w=Math.min(m.i.length,w);const V=m.l?p(m.l.Ka,m.l,m):null;e:{var re=m.i;let Be=-1;for(;;){const jt=["count="+w];Be==-1?w>0?(Be=re[0].g,jt.push("ofs="+Be)):Be=0:jt.push("ofs="+Be);let rt=!0;for(let bt=0;bt<w;bt++){var ue=re[bt].g;const er=re[bt].map;if(ue-=Be,ue<0)Be=Math.max(0,re[bt].g-100),rt=!1;else try{ue="req"+ue+"_"||"";try{var Se=er instanceof Map?er:Object.entries(er);for(const[Wr,Er]of Se){let xr=Er;d(Er)&&(xr=Hi(Er)),jt.push(ue+Wr+"="+encodeURIComponent(xr))}}catch(Wr){throw jt.push(ue+"type="+encodeURIComponent("_badmap")),Wr}}catch{V&&V(er)}}if(rt){Se=jt.join("&");break e}}Se=void 0}return m=m.i.splice(0,w),E.G=m,Se}function ju(m){if(!m.g&&!m.v){m.Y=1;var E=m.Da;Z||C(),oe||(Z(),oe=!0),M.add(E,m),m.A=0}}function ca(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=Pr(p(m.Da,m),ku(m,m.A)),m.A++,!0)}t.Da=function(){if(this.v=null,Ou(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=Pr(p(this.Wa,this),m)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Pt(10),es(this),Ou(this))};function Fl(m){m.B!=null&&(c.clearTimeout(m.B),m.B=null)}function Ou(m){m.g=new gr(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var E=Bt(m.na);ot(E,"RID","rpc"),ot(E,"SID",m.M),ot(E,"AID",m.K),ot(E,"CI",m.F?"0":"1"),!m.F&&m.ia&&ot(E,"TO",m.ia),ot(E,"TYPE","xmlhttp"),la(m,E),m.u&&m.o&&sa(E,m.u,m.o),m.O&&(m.g.H=m.O);var w=m.g;m=m.ba,w.M=1,w.A=na(Bt(E)),w.u=null,w.R=!0,Fa(w,m)}t.Va=function(){this.C!=null&&(this.C=null,es(this),ca(this),Pt(19))};function Xa(m){m.C!=null&&(c.clearTimeout(m.C),m.C=null)}function Mu(m,E){var w=null;if(m.g==E){Xa(m),Fl(m),m.g=null;var V=2}else if(qr(m.h,E))w=E.G,jl(m.h,E),V=1;else return;if(m.I!=0){if(E.o)if(V==1){w=E.u?E.u.length:0,E=Date.now()-E.F;var re=m.D;V=Ua(),St(V,new Nr(V,w)),Kr(m)}else ju(m);else if(re=E.m,re==3||re==0&&E.X>0||!(V==1&&Wa(m,E)||V==2&&ca(m)))switch(w&&w.length>0&&(E=m.h,E.i=E.i.concat(w)),re){case 1:Yr(m,5);break;case 4:Yr(m,10);break;case 3:Yr(m,6);break;default:Yr(m,2)}}}function ku(m,E){let w=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(w*=2),w*E}function Yr(m,E){if(m.j.info("Error code "+E),E==2){var w=p(m.bb,m),V=m.Ua;const re=!V;V=new Bn(V||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||nn(V,"https"),na(V),re?_r(V.toString(),w):Vl(V.toString(),w)}else Pt(2);m.I=0,m.l&&m.l.pa(E),Nu(m),Ya(m)}t.bb=function(m){m?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))};function Nu(m){if(m.I=0,m.ja=[],m.l){const E=Ol(m.h);(E.length!=0||m.i.length!=0)&&(S(m.ja,E),S(m.ja,m.i),m.h.i.length=0,T(m.i),m.i.length=0),m.l.oa()}}function Pu(m,E,w){var V=w instanceof Bn?Bt(w):new Bn(w);if(V.g!="")E&&(V.g=E+"."+V.g),$i(V,V.u);else{var re=c.location;V=re.protocol,E=E?E+"."+re.hostname:re.hostname,re=+re.port;const ue=new Bn(null);V&&nn(ue,V),E&&(ue.g=E),re&&$i(ue,re),w&&(ue.h=w),V=ue}return w=m.G,E=m.wa,w&&E&&ot(V,w,E),ot(V,"VER",m.ka),la(m,V),V}function Vu(m,E,w){if(E&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=m.Aa&&!m.ma?new ut(new Gr({ab:w})):new ut(m.ma),E.Fa(m.L),E}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Lu(){}t=Lu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ts(){}ts.prototype.g=function(m,E){return new wn(m,E)};function wn(m,E){st.call(this),this.g=new Zi(E),this.l=m,this.h=E&&E.messageUrlParams||null,m=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(m?m["X-WebChannel-Content-Type"]=E.messageContentType:m={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(m?m["X-WebChannel-Client-Profile"]=E.sa:m={"X-WebChannel-Client-Profile":E.sa}),this.g.U=m,(m=E&&E.Qb)&&!O(m)&&(this.g.u=m),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!O(E)&&(this.g.G=E,m=this.h,m!==null&&E in m&&(m=this.h,E in m&&delete m[E])),this.j=new yi(this)}v(wn,st),wn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){zl(this.g)},wn.prototype.o=function(m){var E=this.g;if(typeof m=="string"){var w={};w.__data__=m,m=w}else this.v&&(w={},w.__data__=Hi(m),m=w);E.i.push(new Lt(E.Ya++,m)),E.I==3&&Kr(E)},wn.prototype.N=function(){this.g.l=null,delete this.j,zl(this.g),delete this.g,wn.Z.N.call(this)};function Bu(m){cn.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var E=m.__sm__;if(E){e:{for(const w in E){m=w;break e}m=void 0}(this.i=m)&&(m=this.i,E=E!==null&&m in E?E[m]:void 0),this.data=E}else this.data=m}v(Bu,cn);function zu(){Wn.call(this),this.status=1}v(zu,Wn);function yi(m){this.g=m}v(yi,Lu),yi.prototype.ra=function(){St(this.g,"a")},yi.prototype.qa=function(m){St(this.g,new Bu(m))},yi.prototype.pa=function(m){St(this.g,new zu)},yi.prototype.oa=function(){St(this.g,"b")},ts.prototype.createWebChannel=ts.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,TS=function(){return new ts},wS=function(){return Ua()},SS=It,rg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ea.NO_ERROR=0,ea.TIMEOUT=8,ea.HTTP_ERROR=6,th=ea,Al.COMPLETE="complete",xS=Al,_u.EventType=mr,mr.OPEN="a",mr.CLOSE="b",mr.ERROR="c",mr.MESSAGE="d",st.prototype.listen=st.prototype.J,jc=_u,ut.prototype.listenOnce=ut.prototype.K,ut.prototype.getLastError=ut.prototype.Ha,ut.prototype.getLastErrorCode=ut.prototype.ya,ut.prototype.getStatus=ut.prototype.ca,ut.prototype.getResponseJson=ut.prototype.La,ut.prototype.getResponseText=ut.prototype.la,ut.prototype.send=ut.prototype.ea,ut.prototype.setWithCredentials=ut.prototype.Fa,ES=ut}).apply(typeof Hd<"u"?Hd:typeof self<"u"?self:typeof window<"u"?window:{});const Jb="@firebase/firestore",Zb="4.9.3";class En{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}En.UNAUTHENTICATED=new En(null),En.GOOGLE_CREDENTIALS=new En("google-credentials-uid"),En.FIRST_PARTY=new En("first-party-uid"),En.MOCK_USER=new En("mock-user");let dl="12.7.0";const Oa=new Ug("@firebase/firestore");function Mo(){return Oa.logLevel}function Te(t,...e){if(Oa.logLevel<=Ke.DEBUG){const n=e.map(Qg);Oa.debug(`Firestore (${dl}): ${t}`,...n)}}function Ui(t,...e){if(Oa.logLevel<=Ke.ERROR){const n=e.map(Qg);Oa.error(`Firestore (${dl}): ${t}`,...n)}}function Yo(t,...e){if(Oa.logLevel<=Ke.WARN){const n=e.map(Qg);Oa.warn(`Firestore (${dl}): ${t}`,...n)}}function Qg(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Me(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,AS(t,i,n)}function AS(t,e,n){let i=`FIRESTORE (${dl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Ui(i),new Error(i)}function at(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||AS(e,a,i)}function Le(t,e){return t}const ge={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends Gi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Vi{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class CS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class WI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(En.UNAUTHENTICATED)))}shutdown(){}}class XI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class JI{constructor(e){this.t=e,this.currentUser=En.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){at(this.o===void 0,42304);let i=this.i;const a=f=>this.i!==i?(i=this.i,n(f)):Promise.resolve();let l=new Vi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Vi,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const f=l;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},d=f=>{Te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(Te("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Vi)}}),0),c()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(Te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(at(typeof i.accessToken=="string",31837,{l:i}),new CS(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return at(e===null||typeof e=="string",2055,{h:e}),new En(e)}}class ZI{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=En.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class e2{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new ZI(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(En.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class eE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class t2{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ar(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){at(this.o===void 0,3512);const i=l=>{l.error!=null&&Te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Te("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{Te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new eE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(at(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new eE(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function n2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class Gg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=n2(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function Ye(t,e){return t<e?-1:t>e?1:0}function ig(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return Ip(a)===Ip(l)?Ye(a,l):Ip(a)?1:-1}return Ye(t.length,e.length)}const r2=55296,i2=57343;function Ip(t){const e=t.charCodeAt(0);return e>=r2&&e<=i2}function Wo(t,e,n){return t.length===e.length&&t.every(((i,a)=>n(i,e[a])))}const tE="__name__";class ti{constructor(e,n,i){n===void 0?n=0:n>e.length&&Me(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Me(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return ti.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ti?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=ti.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return Ye(e.length,n.length)}static compareSegments(e,n){const i=ti.isNumericId(e),a=ti.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?ti.extractNumericId(e).compare(ti.extractNumericId(n)):ig(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ks.fromString(e.substring(4,e.length-2))}}class gt extends ti{construct(e,n,i){return new gt(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new we(ge.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((a=>a.length>0)))}return new gt(n)}static emptyPath(){return new gt([])}}const s2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gn extends ti{construct(e,n,i){return new gn(e,n,i)}static isValidIdentifier(e){return s2.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===tE}static keyField(){return new gn([tE])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new we(ge.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let c=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new we(ge.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new we(ge.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,a+=2}else d==="`"?(c=!c,a++):d!=="."||c?(i+=d,a++):(l(),a++)}if(l(),c)throw new we(ge.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gn(n)}static emptyPath(){return new gn([])}}class Ie{constructor(e){this.path=e}static fromPath(e){return new Ie(gt.fromString(e))}static fromName(e){return new Ie(gt.fromString(e).popFirst(5))}static empty(){return new Ie(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return gt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ie(new gt(e.slice()))}}function RS(t,e,n){if(!n)throw new we(ge.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function a2(t,e,n,i){if(e===!0&&i===!0)throw new we(ge.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function nE(t){if(!Ie.isDocumentKey(t))throw new we(ge.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function rE(t){if(Ie.isDocumentKey(t))throw new we(ge.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function DS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Hh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Me(12329,{type:typeof t})}function di(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new we(ge.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Hh(t);throw new we(ge.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Kt(t,e){const n={typeString:t};return e&&(n.value=e),n}function ru(t,e){if(!DS(t))throw new we(ge.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const c=t[i];if(a&&typeof c!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new we(ge.INVALID_ARGUMENT,n);return!0}const iE=-62135596800,sE=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*sE);return new vt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new we(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new we(ge.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<iE)throw new we(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(ge.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/sE}_compareTo(e){return this.seconds===e.seconds?Ye(this.nanoseconds,e.nanoseconds):Ye(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ru(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-iE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Kt("string",vt._jsonSchemaVersion),seconds:Kt("number"),nanoseconds:Kt("number")};class Pe{static fromTimestamp(e){return new Pe(e)}static min(){return new Pe(new vt(0,0))}static max(){return new Pe(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Qc=-1;function o2(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Pe.fromTimestamp(i===1e9?new vt(n+1,0):new vt(n,i));return new Ls(a,Ie.empty(),e)}function l2(t){return new Ls(t.readTime,t.key,Qc)}class Ls{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Ls(Pe.min(),Ie.empty(),Qc)}static max(){return new Ls(Pe.max(),Ie.empty(),Qc)}}function c2(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ie.comparator(t.documentKey,e.documentKey),n!==0?n:Ye(t.largestBatchId,e.largestBatchId))}const u2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class d2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function hl(t){if(t.code!==ge.FAILED_PRECONDITION||t.message!==u2)throw t;Te("LocalStore","Unexpectedly lost primary lease")}class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ye(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof ye?n:ye.resolve(n)}catch(n){return ye.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):ye.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):ye.reject(n)}static resolve(e){return new ye(((n,i)=>{n(e)}))}static reject(e){return new ye(((n,i)=>{i(e)}))}static waitFor(e){return new ye(((n,i)=>{let a=0,l=0,c=!1;e.forEach((d=>{++a,d.next((()=>{++l,c&&l===a&&n()}),(f=>i(f)))})),c=!0,l===a&&n()}))}static or(e){let n=ye.resolve(!1);for(const i of e)n=n.next((a=>a?ye.resolve(a):i()));return n}static forEach(e,n){const i=[];return e.forEach(((a,l)=>{i.push(n.call(this,a,l))})),this.waitFor(i)}static mapArray(e,n){return new ye(((i,a)=>{const l=e.length,c=new Array(l);let d=0;for(let f=0;f<l;f++){const p=f;n(e[p]).next((_=>{c[p]=_,++d,d===l&&i(c)}),(_=>a(_)))}}))}static doWhile(e,n){return new ye(((i,a)=>{const l=()=>{e()===!0?n().next((()=>{l()}),a):i()};l()}))}}function h2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function fl(t){return t.name==="IndexedDbTransactionError"}class $h{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}$h.ce=-1;const Hg=-1;function Kh(t){return t==null}function yh(t){return t===0&&1/t==-1/0}function f2(t){return typeof t=="number"&&Number.isInteger(t)&&!yh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const IS="";function m2(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=aE(e)),e=p2(t.get(n),e);return aE(e)}function p2(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case IS:n+="";break;default:n+=l}}return n}function aE(t){return t+IS+""}function oE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Gs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class At{constructor(e,n){this.comparator=e,this.root=n||pn.EMPTY}insert(e,n){return new At(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,pn.BLACK,null,null))}remove(e){return new At(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $d(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $d(this.root,e,this.comparator,!1)}getReverseIterator(){return new $d(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $d(this.root,e,this.comparator,!0)}}class $d{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pn{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??pn.RED,this.left=a??pn.EMPTY,this.right=l??pn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new pn(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return pn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return pn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Me(27949);return e+(this.isRed()?0:1)}}pn.EMPTY=null,pn.RED=!0,pn.BLACK=!1;pn.EMPTY=new class{constructor(){this.size=0}get key(){throw Me(57766)}get value(){throw Me(16141)}get color(){throw Me(16727)}get left(){throw Me(29726)}get right(){throw Me(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new pn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Zt{constructor(e){this.comparator=e,this.data=new At(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new lE(this.data.getIterator())}getIteratorFrom(e){return new lE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof Zt)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new Zt(this.comparator);return n.data=e,n}}class lE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class $n{constructor(e){this.fields=e,e.sort(gn.comparator)}static empty(){return new $n([])}unionWith(e){let n=new Zt(gn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new $n(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Wo(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class OS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class _n{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new OS("Invalid base64 string: "+l):l}})(e);return new _n(n)}static fromUint8Array(e){const n=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new _n(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ye(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const g2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bs(t){if(at(!!t,39018),typeof t=="string"){let e=0;const n=g2.exec(t);if(at(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:kt(t.seconds),nanos:kt(t.nanos)}}function kt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function zs(t){return typeof t=="string"?_n.fromBase64String(t):_n.fromUint8Array(t)}const MS="server_timestamp",kS="__type__",NS="__previous_value__",PS="__local_write_time__";function $g(t){return(t?.mapValue?.fields||{})[kS]?.stringValue===MS}function Yh(t){const e=t.mapValue.fields[NS];return $g(e)?Yh(e):e}function Gc(t){const e=Bs(t.mapValue.fields[PS].timestampValue);return new vt(e.seconds,e.nanos)}class y2{constructor(e,n,i,a,l,c,d,f,p,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=_}}const _h="(default)";class Hc{constructor(e,n){this.projectId=e,this.database=n||_h}static empty(){return new Hc("","")}get isDefaultDatabase(){return this.database===_h}isEqual(e){return e instanceof Hc&&e.projectId===this.projectId&&e.database===this.database}}const VS="__type__",_2="__max__",Kd={mapValue:{}},LS="__vector__",vh="value";function Us(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?$g(t)?4:b2(t)?9007199254740991:v2(t)?10:11:Me(28295,{value:t})}function hi(t,e){if(t===e)return!0;const n=Us(t);if(n!==Us(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Gc(t).isEqual(Gc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=Bs(a.timestampValue),d=Bs(l.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return zs(a.bytesValue).isEqual(zs(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return kt(a.geoPointValue.latitude)===kt(l.geoPointValue.latitude)&&kt(a.geoPointValue.longitude)===kt(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return kt(a.integerValue)===kt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=kt(a.doubleValue),d=kt(l.doubleValue);return c===d?yh(c)===yh(d):isNaN(c)&&isNaN(d)}return!1})(t,e);case 9:return Wo(t.arrayValue.values||[],e.arrayValue.values||[],hi);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},d=l.mapValue.fields||{};if(oE(c)!==oE(d))return!1;for(const f in c)if(c.hasOwnProperty(f)&&(d[f]===void 0||!hi(c[f],d[f])))return!1;return!0})(t,e);default:return Me(52216,{left:t})}}function $c(t,e){return(t.values||[]).find((n=>hi(n,e)))!==void 0}function Xo(t,e){if(t===e)return 0;const n=Us(t),i=Us(e);if(n!==i)return Ye(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ye(t.booleanValue,e.booleanValue);case 2:return(function(l,c){const d=kt(l.integerValue||l.doubleValue),f=kt(c.integerValue||c.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(t,e);case 3:return cE(t.timestampValue,e.timestampValue);case 4:return cE(Gc(t),Gc(e));case 5:return ig(t.stringValue,e.stringValue);case 6:return(function(l,c){const d=zs(l),f=zs(c);return d.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(l,c){const d=l.split("/"),f=c.split("/");for(let p=0;p<d.length&&p<f.length;p++){const _=Ye(d[p],f[p]);if(_!==0)return _}return Ye(d.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,c){const d=Ye(kt(l.latitude),kt(c.latitude));return d!==0?d:Ye(kt(l.longitude),kt(c.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return uE(t.arrayValue,e.arrayValue);case 10:return(function(l,c){const d=l.fields||{},f=c.fields||{},p=d[vh]?.arrayValue,_=f[vh]?.arrayValue,v=Ye(p?.values?.length||0,_?.values?.length||0);return v!==0?v:uE(p,_)})(t.mapValue,e.mapValue);case 11:return(function(l,c){if(l===Kd.mapValue&&c===Kd.mapValue)return 0;if(l===Kd.mapValue)return 1;if(c===Kd.mapValue)return-1;const d=l.fields||{},f=Object.keys(d),p=c.fields||{},_=Object.keys(p);f.sort(),_.sort();for(let v=0;v<f.length&&v<_.length;++v){const b=ig(f[v],_[v]);if(b!==0)return b;const T=Xo(d[f[v]],p[_[v]]);if(T!==0)return T}return Ye(f.length,_.length)})(t.mapValue,e.mapValue);default:throw Me(23264,{he:n})}}function cE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ye(t,e);const n=Bs(t),i=Bs(e),a=Ye(n.seconds,i.seconds);return a!==0?a:Ye(n.nanos,i.nanos)}function uE(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=Xo(n[a],i[a]);if(l)return l}return Ye(n.length,i.length)}function Jo(t){return sg(t)}function sg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=Bs(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return zs(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return Ie.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=sg(l);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const c of i)l?l=!1:a+=",",a+=`${c}:${sg(n.fields[c])}`;return a+"}"})(t.mapValue):Me(61005,{value:t})}function nh(t){switch(Us(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Yh(t);return e?16+nh(e):16;case 5:return 2*t.stringValue.length;case 6:return zs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+nh(l)),0)})(t.arrayValue);case 10:case 11:return(function(i){let a=0;return Gs(i.fields,((l,c)=>{a+=l.length+nh(c)})),a})(t.mapValue);default:throw Me(13486,{value:t})}}function dE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ag(t){return!!t&&"integerValue"in t}function Kg(t){return!!t&&"arrayValue"in t}function hE(t){return!!t&&"nullValue"in t}function fE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rh(t){return!!t&&"mapValue"in t}function v2(t){return(t?.mapValue?.fields||{})[VS]?.stringValue===LS}function Pc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Gs(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=Pc(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Pc(t.arrayValue.values[n]);return e}return{...t}}function b2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===_2}class Nn{constructor(e){this.value=e}static empty(){return new Nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!rh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pc(n)}setAll(e){let n=gn.emptyPath(),i={},a=[];e.forEach(((c,d)=>{if(!n.isImmediateParentOf(d)){const f=this.getFieldsMap(n);this.applyChanges(f,i,a),i={},a=[],n=d.popLast()}c?i[d.lastSegment()]=Pc(c):a.push(d.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());rh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return hi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];rh(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){Gs(n,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new Nn(Pc(this.value))}}function BS(t){const e=[];return Gs(t.fields,((n,i)=>{const a=new gn([n]);if(rh(i)){const l=BS(i.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new $n(e)}class xn{constructor(e,n,i,a,l,c,d){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=c,this.documentState=d}static newInvalidDocument(e){return new xn(e,0,Pe.min(),Pe.min(),Pe.min(),Nn.empty(),0)}static newFoundDocument(e,n,i,a){return new xn(e,1,n,Pe.min(),i,a,0)}static newNoDocument(e,n){return new xn(e,2,n,Pe.min(),Pe.min(),Nn.empty(),0)}static newUnknownDocument(e,n){return new xn(e,3,n,Pe.min(),Pe.min(),Nn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class bh{constructor(e,n){this.position=e,this.inclusive=n}}function mE(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],c=t.position[a];if(l.field.isKeyField()?i=Ie.comparator(Ie.fromName(c.referenceValue),n.key):i=Xo(c,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function pE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!hi(t.position[n],e.position[n]))return!1;return!0}class Eh{constructor(e,n="asc"){this.field=e,this.dir=n}}function E2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class zS{}class $t extends zS{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new S2(e,n,i):n==="array-contains"?new A2(e,i):n==="in"?new C2(e,i):n==="not-in"?new R2(e,i):n==="array-contains-any"?new D2(e,i):new $t(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new w2(e,i):new T2(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Xo(n,this.value)):n!==null&&Us(this.value)===Us(n)&&this.matchesComparison(Xo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ir extends zS{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ir(e,n)}matches(e){return US(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function US(t){return t.op==="and"}function FS(t){return x2(t)&&US(t)}function x2(t){for(const e of t.filters)if(e instanceof Ir)return!1;return!0}function og(t){if(t instanceof $t)return t.field.canonicalString()+t.op.toString()+Jo(t.value);if(FS(t))return t.filters.map((e=>og(e))).join(",");{const e=t.filters.map((n=>og(n))).join(",");return`${t.op}(${e})`}}function qS(t,e){return t instanceof $t?(function(i,a){return a instanceof $t&&i.op===a.op&&i.field.isEqual(a.field)&&hi(i.value,a.value)})(t,e):t instanceof Ir?(function(i,a){return a instanceof Ir&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,c,d)=>l&&qS(c,a.filters[d])),!0):!1})(t,e):void Me(19439)}function QS(t){return t instanceof $t?(function(n){return`${n.field.canonicalString()} ${n.op} ${Jo(n.value)}`})(t):t instanceof Ir?(function(n){return n.op.toString()+" {"+n.getFilters().map(QS).join(" ,")+"}"})(t):"Filter"}class S2 extends $t{constructor(e,n,i){super(e,n,i),this.key=Ie.fromName(i.referenceValue)}matches(e){const n=Ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class w2 extends $t{constructor(e,n){super(e,"in",n),this.keys=GS("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class T2 extends $t{constructor(e,n){super(e,"not-in",n),this.keys=GS("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function GS(t,e){return(e.arrayValue?.values||[]).map((n=>Ie.fromName(n.referenceValue)))}class A2 extends $t{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Kg(n)&&$c(n.arrayValue,this.value)}}class C2 extends $t{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&$c(this.value.arrayValue,n)}}class R2 extends $t{constructor(e,n){super(e,"not-in",n)}matches(e){if($c(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!$c(this.value.arrayValue,n)}}class D2 extends $t{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Kg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>$c(this.value.arrayValue,i)))}}class I2{constructor(e,n=null,i=[],a=[],l=null,c=null,d=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=c,this.endAt=d,this.Te=null}}function gE(t,e=null,n=[],i=[],a=null,l=null,c=null){return new I2(t,e,n,i,a,l,c)}function Yg(t){const e=Le(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>og(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),Kh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>Jo(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>Jo(i))).join(",")),e.Te=n}return e.Te}function Wg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!E2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!qS(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!pE(t.startAt,e.startAt)&&pE(t.endAt,e.endAt)}function lg(t){return Ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class iu{constructor(e,n=null,i=[],a=[],l=null,c="F",d=null,f=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=c,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function j2(t,e,n,i,a,l,c,d){return new iu(t,e,n,i,a,l,c,d)}function Xg(t){return new iu(t)}function yE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function HS(t){return t.collectionGroup!==null}function Vc(t){const e=Le(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new Zt(gn.comparator);return c.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(d=d.add(p.field))}))})),d})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Eh(l,i))})),n.has(gn.keyField().canonicalString())||e.Ie.push(new Eh(gn.keyField(),i))}return e.Ie}function ri(t){const e=Le(t);return e.Ee||(e.Ee=O2(e,Vc(t))),e.Ee}function O2(t,e){if(t.limitType==="F")return gE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Eh(a.field,l)}));const n=t.endAt?new bh(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new bh(t.startAt.position,t.startAt.inclusive):null;return gE(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function cg(t,e){const n=t.filters.concat([e]);return new iu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ug(t,e,n){return new iu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Wh(t,e){return Wg(ri(t),ri(e))&&t.limitType===e.limitType}function $S(t){return`${Yg(ri(t))}|lt:${t.limitType}`}function ko(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((a=>QS(a))).join(", ")}]`),Kh(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((a=>Jo(a))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((a=>Jo(a))).join(",")),`Target(${i})`})(ri(t))}; limitType=${t.limitType})`}function Xh(t,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Ie.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(t,e)&&(function(i,a){for(const l of Vc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(i,a){return!(i.startAt&&!(function(c,d,f){const p=mE(c,d,f);return c.inclusive?p<=0:p<0})(i.startAt,Vc(i),a)||i.endAt&&!(function(c,d,f){const p=mE(c,d,f);return c.inclusive?p>=0:p>0})(i.endAt,Vc(i),a))})(t,e)}function M2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function KS(t){return(e,n)=>{let i=!1;for(const a of Vc(t)){const l=k2(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function k2(t,e,n){const i=t.field.isKeyField()?Ie.comparator(e.key,n.key):(function(l,c,d){const f=c.data.field(l),p=d.data.field(l);return f!==null&&p!==null?Xo(f,p):Me(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Me(19790,{direction:t.dir})}}class Pa{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Gs(this.inner,((n,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return jS(this.inner)}size(){return this.innerSize}}const N2=new At(Ie.comparator);function Fi(){return N2}const YS=new At(Ie.comparator);function Oc(...t){let e=YS;for(const n of t)e=e.insert(n.key,n);return e}function WS(t){let e=YS;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function Ca(){return Lc()}function XS(){return Lc()}function Lc(){return new Pa((t=>t.toString()),((t,e)=>t.isEqual(e)))}const P2=new At(Ie.comparator),V2=new Zt(Ie.comparator);function We(...t){let e=V2;for(const n of t)e=e.add(n);return e}const L2=new Zt(Ye);function B2(){return L2}function Jg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yh(e)?"-0":e}}function JS(t){return{integerValue:""+t}}function z2(t,e){return f2(e)?JS(e):Jg(t,e)}class Jh{constructor(){this._=void 0}}function U2(t,e,n){return t instanceof xh?(function(a,l){const c={fields:{[kS]:{stringValue:MS},[PS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&$g(l)&&(l=Yh(l)),l&&(c.fields[NS]=l),{mapValue:c}})(n,e):t instanceof Zo?ew(t,e):t instanceof Kc?tw(t,e):(function(a,l){const c=ZS(a,l),d=_E(c)+_E(a.Ae);return ag(c)&&ag(a.Ae)?JS(d):Jg(a.serializer,d)})(t,e)}function F2(t,e,n){return t instanceof Zo?ew(t,e):t instanceof Kc?tw(t,e):n}function ZS(t,e){return t instanceof Sh?(function(i){return ag(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class xh extends Jh{}class Zo extends Jh{constructor(e){super(),this.elements=e}}function ew(t,e){const n=nw(e);for(const i of t.elements)n.some((a=>hi(a,i)))||n.push(i);return{arrayValue:{values:n}}}class Kc extends Jh{constructor(e){super(),this.elements=e}}function tw(t,e){let n=nw(e);for(const i of t.elements)n=n.filter((a=>!hi(a,i)));return{arrayValue:{values:n}}}class Sh extends Jh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function _E(t){return kt(t.integerValue||t.doubleValue)}function nw(t){return Kg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class q2{constructor(e,n){this.field=e,this.transform=n}}function Q2(t,e){return t.field.isEqual(e.field)&&(function(i,a){return i instanceof Zo&&a instanceof Zo||i instanceof Kc&&a instanceof Kc?Wo(i.elements,a.elements,hi):i instanceof Sh&&a instanceof Sh?hi(i.Ae,a.Ae):i instanceof xh&&a instanceof xh})(t.transform,e.transform)}class G2{constructor(e,n){this.version=e,this.transformResults=n}}class Dr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Dr}static exists(e){return new Dr(void 0,e)}static updateTime(e){return new Dr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ih(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Zh{}function rw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Zg(t.key,Dr.none()):new su(t.key,t.data,Dr.none());{const n=t.data,i=Nn.empty();let a=new Zt(gn.comparator);for(let l of e.fields)if(!a.has(l)){let c=n.field(l);c===null&&l.length>1&&(l=l.popLast(),c=n.field(l)),c===null?i.delete(l):i.set(l,c),a=a.add(l)}return new Hs(t.key,i,new $n(a.toArray()),Dr.none())}}function H2(t,e,n){t instanceof su?(function(a,l,c){const d=a.value.clone(),f=bE(a.fieldTransforms,l,c.transformResults);d.setAll(f),l.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(t,e,n):t instanceof Hs?(function(a,l,c){if(!ih(a.precondition,l))return void l.convertToUnknownDocument(c.version);const d=bE(a.fieldTransforms,l,c.transformResults),f=l.data;f.setAll(iw(a)),f.setAll(d),l.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(t,e,n):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,n)}function Bc(t,e,n,i){return t instanceof su?(function(l,c,d,f){if(!ih(l.precondition,c))return d;const p=l.value.clone(),_=EE(l.fieldTransforms,f,c);return p.setAll(_),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(t,e,n,i):t instanceof Hs?(function(l,c,d,f){if(!ih(l.precondition,c))return d;const p=EE(l.fieldTransforms,f,c),_=c.data;return _.setAll(iw(l)),_.setAll(p),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,n,i):(function(l,c,d){return ih(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(t,e,n)}function $2(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=ZS(i.transform,a||null);l!=null&&(n===null&&(n=Nn.empty()),n.set(i.field,l))}return n||null}function vE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&Wo(i,a,((l,c)=>Q2(l,c)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class su extends Zh{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Hs extends Zh{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function iw(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function bE(t,e,n){const i=new Map;at(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],c=l.transform,d=e.data.field(l.field);i.set(l.field,F2(c,d,n[a]))}return i}function EE(t,e,n){const i=new Map;for(const a of t){const l=a.transform,c=n.data.field(a.field);i.set(a.field,U2(l,c,e))}return i}class Zg extends Zh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class K2 extends Zh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Y2{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&H2(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=Bc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=Bc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=XS();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let d=this.applyToLocalView(c,l.mutatedFields);d=n.has(a.key)?null:d;const f=rw(c,d);f!==null&&i.set(a.key,f),c.isValidDocument()||c.convertToNoDocument(Pe.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),We())}isEqual(e){return this.batchId===e.batchId&&Wo(this.mutations,e.mutations,((n,i)=>vE(n,i)))&&Wo(this.baseMutations,e.baseMutations,((n,i)=>vE(n,i)))}}class ey{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){at(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return P2})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,i[c].version);return new ey(e,n,i,a)}}class W2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class X2{constructor(e,n){this.count=e,this.unchangedNames=n}}var Gt,Je;function J2(t){switch(t){case ge.OK:return Me(64938);case ge.CANCELLED:case ge.UNKNOWN:case ge.DEADLINE_EXCEEDED:case ge.RESOURCE_EXHAUSTED:case ge.INTERNAL:case ge.UNAVAILABLE:case ge.UNAUTHENTICATED:return!1;case ge.INVALID_ARGUMENT:case ge.NOT_FOUND:case ge.ALREADY_EXISTS:case ge.PERMISSION_DENIED:case ge.FAILED_PRECONDITION:case ge.ABORTED:case ge.OUT_OF_RANGE:case ge.UNIMPLEMENTED:case ge.DATA_LOSS:return!0;default:return Me(15467,{code:t})}}function sw(t){if(t===void 0)return Ui("GRPC error has no .code"),ge.UNKNOWN;switch(t){case Gt.OK:return ge.OK;case Gt.CANCELLED:return ge.CANCELLED;case Gt.UNKNOWN:return ge.UNKNOWN;case Gt.DEADLINE_EXCEEDED:return ge.DEADLINE_EXCEEDED;case Gt.RESOURCE_EXHAUSTED:return ge.RESOURCE_EXHAUSTED;case Gt.INTERNAL:return ge.INTERNAL;case Gt.UNAVAILABLE:return ge.UNAVAILABLE;case Gt.UNAUTHENTICATED:return ge.UNAUTHENTICATED;case Gt.INVALID_ARGUMENT:return ge.INVALID_ARGUMENT;case Gt.NOT_FOUND:return ge.NOT_FOUND;case Gt.ALREADY_EXISTS:return ge.ALREADY_EXISTS;case Gt.PERMISSION_DENIED:return ge.PERMISSION_DENIED;case Gt.FAILED_PRECONDITION:return ge.FAILED_PRECONDITION;case Gt.ABORTED:return ge.ABORTED;case Gt.OUT_OF_RANGE:return ge.OUT_OF_RANGE;case Gt.UNIMPLEMENTED:return ge.UNIMPLEMENTED;case Gt.DATA_LOSS:return ge.DATA_LOSS;default:return Me(39323,{code:t})}}(Je=Gt||(Gt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";function Z2(){return new TextEncoder}const ej=new ks([4294967295,4294967295],0);function xE(t){const e=Z2().encode(t),n=new bS;return n.update(e),new Uint8Array(n.digest())}function SE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ks([n,i],0),new ks([a,l],0)]}class ty{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Mc(`Invalid padding: ${n}`);if(i<0)throw new Mc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Mc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Mc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ks.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(ks.fromNumber(i)));return a.compare(ej)===1&&(a=new ks([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=xE(e),[i,a]=SE(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);if(!this.we(c))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new ty(l,a,n);return i.forEach((d=>c.insert(d))),c}insert(e){if(this.ge===0)return;const n=xE(e),[i,a]=SE(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);this.Se(c)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Mc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ef{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,au.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new ef(Pe.min(),a,new At(Ye),Fi(),We())}}class au{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new au(i,n,We(),We(),We())}}class sh{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class aw{constructor(e,n){this.targetId=e,this.Ce=n}}class ow{constructor(e,n,i=_n.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class wE{constructor(){this.ve=0,this.Fe=TE(),this.Me=_n.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=We(),n=We(),i=We();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:Me(38017,{changeType:l})}})),new au(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=TE()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,at(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class tj{constructor(e){this.Ge=e,this.ze=new Map,this.je=Fi(),this.Je=Yd(),this.He=Yd(),this.Ye=new At(Ye)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Me(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(lg(l))if(i===0){const c=new Ie(l.path);this.et(n,c,xn.newNoDocument(c,Pe.min()))}else at(i===1,20013,{expectedCount:i});else{const c=this._t(n);if(c!==i){const d=this.ut(e),f=d?this.ct(d,e,c):1;if(f!==0){this.it(n);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,p)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let c,d;try{c=zs(i).toUint8Array()}catch(f){if(f instanceof OS)return Yo("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new ty(c,a,l)}catch(f){return Yo(f instanceof Mc?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach((l=>{const c=this.Ge.ht(),d=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(n,l,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((l,c)=>{const d=this.ot(c);if(d){if(l.current&&lg(d.target)){const f=new Ie(d.target.path);this.It(f).has(c)||this.Et(c,f)||this.et(c,f,xn.newNoDocument(f,e))}l.Be&&(n.set(c,l.ke()),l.qe())}}));let i=We();this.He.forEach(((l,c)=>{let d=!0;c.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new ef(e,n,this.Ye,this.je,i);return this.je=Fi(),this.Je=Yd(),this.He=Yd(),this.Ye=new At(Ye),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new wE,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Zt(Ye),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Zt(Ye),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Te("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new wE),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Yd(){return new At(Ie.comparator)}function TE(){return new At(Ie.comparator)}const nj={asc:"ASCENDING",desc:"DESCENDING"},rj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ij={and:"AND",or:"OR"};class sj{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function dg(t,e){return t.useProto3Json||Kh(e)?e:{value:e}}function wh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function lw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function aj(t,e){return wh(t,e.toTimestamp())}function ii(t){return at(!!t,49232),Pe.fromTimestamp((function(n){const i=Bs(n);return new vt(i.seconds,i.nanos)})(t))}function ny(t,e){return hg(t,e).canonicalString()}function hg(t,e){const n=(function(a){return new gt(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function cw(t){const e=gt.fromString(t);return at(mw(e),10190,{key:e.toString()}),e}function fg(t,e){return ny(t.databaseId,e.path)}function jp(t,e){const n=cw(e);if(n.get(1)!==t.databaseId.projectId)throw new we(ge.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new we(ge.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ie(dw(n))}function uw(t,e){return ny(t.databaseId,e)}function oj(t){const e=cw(t);return e.length===4?gt.emptyPath():dw(e)}function mg(t){return new gt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function dw(t){return at(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function AE(t,e,n){return{name:fg(t,e),fields:n.value.mapValue.fields}}function lj(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Me(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(p,_){return p.useProto3Json?(at(_===void 0||typeof _=="string",58123),_n.fromBase64String(_||"")):(at(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),_n.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(p){const _=p.code===void 0?ge.UNKNOWN:sw(p.code);return new we(_,p.message||"")})(c);n=new ow(i,a,l,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=jp(t,i.document.name),l=ii(i.document.updateTime),c=i.document.createTime?ii(i.document.createTime):Pe.min(),d=new Nn({mapValue:{fields:i.document.fields}}),f=xn.newFoundDocument(a,l,c,d),p=i.targetIds||[],_=i.removedTargetIds||[];n=new sh(p,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=jp(t,i.document),l=i.readTime?ii(i.readTime):Pe.min(),c=xn.newNoDocument(a,l),d=i.removedTargetIds||[];n=new sh([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=jp(t,i.document),l=i.removedTargetIds||[];n=new sh([],l,a,null)}else{if(!("filter"in e))return Me(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,c=new X2(a,l),d=i.targetId;n=new aw(d,c)}}return n}function cj(t,e){let n;if(e instanceof su)n={update:AE(t,e.key,e.value)};else if(e instanceof Zg)n={delete:fg(t,e.key)};else if(e instanceof Hs)n={update:AE(t,e.key,e.data),updateMask:_j(e.fieldMask)};else{if(!(e instanceof K2))return Me(16599,{Vt:e.type});n={verify:fg(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const d=c.transform;if(d instanceof xh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Zo)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Kc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Sh)return{fieldPath:c.field.canonicalString(),increment:d.Ae};throw Me(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:aj(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Me(27497)})(t,e.precondition)),n}function uj(t,e){return t&&t.length>0?(at(e!==void 0,14353),t.map((n=>(function(a,l){let c=a.updateTime?ii(a.updateTime):ii(l);return c.isEqual(Pe.min())&&(c=ii(l)),new G2(c,a.transformResults||[])})(n,e)))):[]}function dj(t,e){return{documents:[uw(t,e.path)]}}function hj(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=uw(t,a);const l=(function(p){if(p.length!==0)return fw(Ir.create(p,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const c=(function(p){if(p.length!==0)return p.map((_=>(function(b){return{field:No(b.field),direction:pj(b.dir)}})(_)))})(e.orderBy);c&&(n.structuredQuery.orderBy=c);const d=dg(t,e.limit);return d!==null&&(n.structuredQuery.limit=d),e.startAt&&(n.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:n,parent:a}}function fj(t){let e=oj(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){at(i===1,65062);const _=n.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(v){const b=hw(v);return b instanceof Ir&&FS(b)?b.getFilters():[b]})(n.where));let c=[];n.orderBy&&(c=(function(v){return v.map((b=>(function(S){return new Eh(Po(S.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(S.direction))})(b)))})(n.orderBy));let d=null;n.limit&&(d=(function(v){let b;return b=typeof v=="object"?v.value:v,Kh(b)?null:b})(n.limit));let f=null;n.startAt&&(f=(function(v){const b=!!v.before,T=v.values||[];return new bh(T,b)})(n.startAt));let p=null;return n.endAt&&(p=(function(v){const b=!v.before,T=v.values||[];return new bh(T,b)})(n.endAt)),j2(e,a,c,l,d,"F",f,p)}function mj(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Me(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function hw(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Po(n.unaryFilter.field);return $t.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=Po(n.unaryFilter.field);return $t.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Po(n.unaryFilter.field);return $t.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Po(n.unaryFilter.field);return $t.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Me(61313);default:return Me(60726)}})(t):t.fieldFilter!==void 0?(function(n){return $t.create(Po(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Me(58110);default:return Me(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Ir.create(n.compositeFilter.filters.map((i=>hw(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Me(1026)}})(n.compositeFilter.op))})(t):Me(30097,{filter:t})}function pj(t){return nj[t]}function gj(t){return rj[t]}function yj(t){return ij[t]}function No(t){return{fieldPath:t.canonicalString()}}function Po(t){return gn.fromServerFormat(t.fieldPath)}function fw(t){return t instanceof $t?(function(n){if(n.op==="=="){if(fE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NAN"}};if(hE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(fE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NOT_NAN"}};if(hE(n.value))return{unaryFilter:{field:No(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:No(n.field),op:gj(n.op),value:n.value}}})(t):t instanceof Ir?(function(n){const i=n.getFilters().map((a=>fw(a)));return i.length===1?i[0]:{compositeFilter:{op:yj(n.op),filters:i}}})(t):Me(54877,{filter:t})}function _j(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function mw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Ds{constructor(e,n,i,a,l=Pe.min(),c=Pe.min(),d=_n.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new Ds(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class vj{constructor(e){this.yt=e}}function bj(t){const e=fj({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ug(e,e.limit,"L"):e}class Ej{constructor(){this.Cn=new xj}addToCollectionParentIndex(e,n){return this.Cn.add(n),ye.resolve()}getCollectionParents(e,n){return ye.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ye.resolve()}deleteFieldIndex(e,n){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,n){return ye.resolve()}getDocumentsMatchingTarget(e,n){return ye.resolve(null)}getIndexType(e,n){return ye.resolve(0)}getFieldIndexes(e,n){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,n){return ye.resolve(Ls.min())}getMinOffsetFromCollectionGroup(e,n){return ye.resolve(Ls.min())}updateCollectionGroup(e,n,i){return ye.resolve()}updateIndexEntries(e,n){return ye.resolve()}}class xj{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new Zt(gt.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new Zt(gt.comparator)).toArray()}}const CE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pw=41943040;class kn{static withCacheSize(e){return new kn(e,kn.DEFAULT_COLLECTION_PERCENTILE,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}kn.DEFAULT_COLLECTION_PERCENTILE=10,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kn.DEFAULT=new kn(pw,kn.DEFAULT_COLLECTION_PERCENTILE,kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kn.DISABLED=new kn(-1,0,0);class el{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new el(0)}static cr(){return new el(-1)}}const RE="LruGarbageCollector",Sj=1048576;function DE([t,e],[n,i]){const a=Ye(t,n);return a===0?Ye(e,i):a}class wj{constructor(e){this.Ir=e,this.buffer=new Zt(DE),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();DE(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Tj{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Te(RE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){fl(n)?Te(RE,"Ignoring IndexedDB error during garbage collection: ",n):await hl(n)}await this.Vr(3e5)}))}}class Aj{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return ye.resolve($h.ce);const i=new wj(n);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Te("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve(CE)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Te("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),CE):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,c,d,f,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,c=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(i=v,d=Date.now(),this.removeTargets(e,i,n)))).next((v=>(l=v,f=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(p=Date.now(),Mo()<=Ke.DEBUG&&Te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${a} in `+(d-c)+`ms
	Removed ${l} targets in `+(f-d)+`ms
	Removed ${v} documents in `+(p-f)+`ms
Total Duration: ${p-_}ms`),ye.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:v}))))}}function Cj(t,e){return new Aj(t,e)}class Rj{constructor(){this.changes=new Pa((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,xn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?ye.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Dj{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class Ij{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(i!==null&&Bc(i.mutation,a,$n.empty(),vt.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,We()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=We()){const a=Ca();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,i).next((l=>{let c=Oc();return l.forEach(((d,f)=>{c=c.insert(d,f.overlayedDocument)})),c}))))}getOverlayedDocuments(e,n){const i=Ca();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,We())))}populateOverlays(e,n,i){const a=[];return i.forEach((l=>{n.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,d)=>{n.set(c,d)}))}))}computeViews(e,n,i,a){let l=Fi();const c=Lc(),d=(function(){return Lc()})();return n.forEach(((f,p)=>{const _=i.get(p.key);a.has(p.key)&&(_===void 0||_.mutation instanceof Hs)?l=l.insert(p.key,p):_!==void 0?(c.set(p.key,_.mutation.getFieldMask()),Bc(_.mutation,p,_.mutation.getFieldMask(),vt.now())):c.set(p.key,$n.empty())})),this.recalculateAndSaveOverlays(e,l).next((f=>(f.forEach(((p,_)=>c.set(p,_))),n.forEach(((p,_)=>d.set(p,new Dj(_,c.get(p)??null)))),d)))}recalculateAndSaveOverlays(e,n){const i=Lc();let a=new At(((c,d)=>c-d)),l=We();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((c=>{for(const d of c)d.keys().forEach((f=>{const p=n.get(f);if(p===null)return;let _=i.get(f)||$n.empty();_=d.applyToLocalView(p,_),i.set(f,_);const v=(a.get(d.batchId)||We()).add(f);a=a.insert(d.batchId,v)}))})).next((()=>{const c=[],d=a.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),p=f.key,_=f.value,v=XS();_.forEach((b=>{if(!l.has(b)){const T=rw(n.get(b),i.get(b));T!==null&&v.set(b,T),l=l.add(b)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,v))}return ye.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,a){return(function(c){return Ie.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):HS(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):ye.resolve(Ca());let d=Qc,f=l;return c.next((p=>ye.forEach(p,((_,v)=>(d<v.largestBatchId&&(d=v.largestBatchId),l.get(_)?ye.resolve():this.remoteDocumentCache.getEntry(e,_).next((b=>{f=f.insert(_,b)}))))).next((()=>this.populateOverlays(e,p,l))).next((()=>this.computeViews(e,f,p,We()))).next((_=>({batchId:d,changes:WS(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ie(n)).next((i=>{let a=Oc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let c=Oc();return this.indexManager.getCollectionParents(e,l).next((d=>ye.forEach(d,(f=>{const p=(function(v,b){return new iu(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,f.child(l));return this.getDocumentsMatchingCollectionQuery(e,p,i,a).next((_=>{_.forEach(((v,b)=>{c=c.insert(v,b)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a)))).next((c=>{l.forEach(((f,p)=>{const _=p.getKey();c.get(_)===null&&(c=c.insert(_,xn.newInvalidDocument(_)))}));let d=Oc();return c.forEach(((f,p)=>{const _=l.get(f);_!==void 0&&Bc(_.mutation,p,$n.empty(),vt.now()),Xh(n,p)&&(d=d.insert(f,p))})),d}))}}class jj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ye.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:ii(a.createTime)}})(n)),ye.resolve()}getNamedQuery(e,n){return ye.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:bj(a.bundledQuery),readTime:ii(a.readTime)}})(n)),ye.resolve()}}class Oj{constructor(){this.overlays=new At(Ie.comparator),this.qr=new Map}getOverlay(e,n){return ye.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Ca();return ye.forEach(n,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((a,l)=>{this.St(e,n,l)})),ye.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),ye.resolve()}getOverlaysForCollection(e,n,i){const a=Ca(),l=n.length+1,c=new Ie(n.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const f=d.getNext().value,p=f.getKey();if(!n.isPrefixOf(p.path))break;p.path.length===l&&f.largestBatchId>i&&a.set(f.getKey(),f)}return ye.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new At(((p,_)=>p-_));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===n&&p.largestBatchId>i){let _=l.get(p.largestBatchId);_===null&&(_=Ca(),l=l.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const d=Ca(),f=l.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,_)=>d.set(p,_))),!(d.size()>=a)););return ye.resolve(d)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const c=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new W2(n,i));let l=this.qr.get(n);l===void 0&&(l=We(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}class Mj{constructor(){this.sessionToken=_n.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ye.resolve()}}class ry{constructor(){this.Qr=new Zt(sn.$r),this.Ur=new Zt(sn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new sn(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new sn(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new Ie(new gt([])),i=new sn(n,e),a=new sn(n,e+1),l=[];return this.Ur.forEachInRange([i,a],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Ie(new gt([])),i=new sn(n,e),a=new sn(n,e+1);let l=We();return this.Ur.forEachInRange([i,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const n=new sn(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class sn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Ie.comparator(e.key,n.key)||Ye(e.Yr,n.Yr)}static Kr(e,n){return Ye(e.Yr,n.Yr)||Ie.comparator(e.key,n.key)}}class kj{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Zt(sn.$r)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new Y2(l,n,i,a);this.mutationQueue.push(c);for(const d of a)this.Zr=this.Zr.add(new sn(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return ye.resolve(c)}lookupMutationBatch(e,n){return ye.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return ye.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?Hg:this.tr-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new sn(n,0),a=new sn(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(c=>{const d=this.Xr(c.Yr);l.push(d)})),ye.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new Zt(Ye);return n.forEach((a=>{const l=new sn(a,0),c=new sn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(d=>{i=i.add(d.Yr)}))})),ye.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;Ie.isDocumentKey(l)||(l=l.child(""));const c=new sn(new Ie(l),0);let d=new Zt(Ye);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!i.isPrefixOf(p)&&(p.length===a&&(d=d.add(f.Yr)),!0)}),c),ye.resolve(this.ti(d))}ti(e){const n=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){at(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ye.forEach(n.mutations,(a=>{const l=new sn(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new sn(n,0),a=this.Zr.firstAfterOrEqual(i);return ye.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class Nj{constructor(e){this.ri=e,this.docs=(function(){return new At(Ie.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,c=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return ye.resolve(i?i.document.mutableCopy():xn.newInvalidDocument(n))}getEntries(e,n){let i=Fi();return n.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():xn.newInvalidDocument(a))})),ye.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=Fi();const c=n.path,d=new Ie(c.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:p,value:{document:_}}=f.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||c2(l2(_),i)<=0||(a.has(_.key)||Xh(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return ye.resolve(l)}getAllFromCollectionGroup(e,n,i,a){Me(9500)}ii(e,n){return ye.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new Pj(this)}getSize(e){return ye.resolve(this.size)}}class Pj extends Rj{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),ye.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class Vj{constructor(e){this.persistence=e,this.si=new Pa((n=>Yg(n)),Wg),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.oi=0,this._i=new ry,this.targetCount=0,this.ai=el.ur()}forEachTarget(e,n){return this.si.forEach(((i,a)=>n(a))),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),ye.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new el(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ye.resolve()}updateTargetData(e,n){return this.Pr(n),ye.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach(((c,d)=>{d.sequenceNumber<=n&&i.get(d.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),ye.waitFor(l).next((()=>a))}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return ye.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),ye.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),ye.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ye.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return ye.resolve(i)}containsKey(e,n){return ye.resolve(this._i.containsKey(n))}}class gw{constructor(e,n){this.ui={},this.overlays={},this.ci=new $h(0),this.li=!1,this.li=!0,this.hi=new Mj,this.referenceDelegate=e(this),this.Pi=new Vj(this),this.indexManager=new Ej,this.remoteDocumentCache=(function(a){return new Nj(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new vj(n),this.Ii=new jj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Oj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new kj(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){Te("MemoryPersistence","Starting transaction:",e);const a=new Lj(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,n){return ye.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class Lj extends d2{constructor(e){super(),this.currentSequenceNumber=e}}class iy{constructor(e){this.persistence=e,this.Ri=new ry,this.Vi=null}static mi(e){return new iy(e)}get fi(){if(this.Vi)return this.Vi;throw Me(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),ye.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),ye.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ye.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.fi,(i=>{const a=Ie.fromPath(i);return this.gi(e,a).next((l=>{l||n.removeEntry(a,Pe.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return ye.or([()=>ye.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Th{constructor(e,n){this.persistence=e,this.pi=new Pa((i=>m2(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=Cj(this,n)}static mi(e,n){return new Th(e,n)}Ei(){}di(e){return ye.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((a=>i+a))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return ye.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?ye.resolve():n(a)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(c=>this.br(e,c,n).next((d=>{d||(i++,l.removeEntry(c,Pe.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ye.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ye.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ye.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=nh(e.data.value)),n}br(e,n,i){return ye.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return ye.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class sy{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=We(),a=We();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new sy(e,n.fromCache,i,a)}}class Bj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class zj{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return OD()?8:h2(Sn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,n,a,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new Bj;return this.Ss(e,n,c).next((d=>{if(l.result=d,this.Vs)return this.bs(e,n,c,d.size)}))})).next((()=>l.result))}bs(e,n,i,a){return i.documentReadCount<this.fs?(Mo()<=Ke.DEBUG&&Te("QueryEngine","SDK will not create cache indexes for query:",ko(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ye.resolve()):(Mo()<=Ke.DEBUG&&Te("QueryEngine","Query:",ko(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(Mo()<=Ke.DEBUG&&Te("QueryEngine","The SDK decides to create cache indexes for query:",ko(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ri(n))):ye.resolve())}ys(e,n){if(yE(n))return ye.resolve(null);let i=ri(n);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=ug(n,null,"F"),i=ri(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=We(...l);return this.ps.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,i).next((f=>{const p=this.Ds(n,d);return this.Cs(n,p,c,f.readTime)?this.ys(e,ug(n,null,"F")):this.vs(e,p,n,f)}))))})))))}ws(e,n,i,a){return yE(n)||a.isEqual(Pe.min())?ye.resolve(null):this.ps.getDocuments(e,i).next((l=>{const c=this.Ds(n,l);return this.Cs(n,c,i,a)?ye.resolve(null):(Mo()<=Ke.DEBUG&&Te("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),ko(n)),this.vs(e,c,n,o2(a,Qc)).next((d=>d)))}))}Ds(e,n){let i=new Zt(KS(e));return n.forEach(((a,l)=>{Xh(e,l)&&(i=i.add(l))})),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return Mo()<=Ke.DEBUG&&Te("QueryEngine","Using full collection scan to execute query:",ko(n)),this.ps.getDocumentsMatchingQuery(e,n,Ls.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(n.forEach((c=>{l=l.insert(c.key,c)})),l)))}}const ay="LocalStore",Uj=3e8;class Fj{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new At(Ye),this.xs=new Pa((l=>Yg(l)),Wg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ij(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function qj(t,e,n,i){return new Fj(t,e,n,i)}async function yw(t,e){const n=Le(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],d=[];let f=We();for(const p of a){c.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}for(const p of l){d.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}return n.localDocuments.getDocuments(i,f).next((p=>({Ls:p,removedBatchIds:c,addedBatchIds:d})))}))}))}function Qj(t,e){const n=Le(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,f,p,_){const v=p.batch,b=v.keys();let T=ye.resolve();return b.forEach((S=>{T=T.next((()=>_.getEntry(f,S))).next((A=>{const R=p.docVersions.get(S);at(R!==null,48541),A.version.compareTo(R)<0&&(v.applyToRemoteDocument(A,p),A.isValidDocument()&&(A.setReadTime(p.commitVersion),_.addEntry(A)))}))})),T.next((()=>d.mutationQueue.removeMutationBatch(f,v)))})(n,i,e,l).next((()=>l.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let f=We();for(let p=0;p<d.mutationResults.length;++p)d.mutationResults[p].transformResults.length>0&&(f=f.add(d.batch.mutations[p].key));return f})(e)))).next((()=>n.localDocuments.getDocuments(i,a)))}))}function _w(t){const e=Le(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function Gj(t,e){const n=Le(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const d=[];e.targetChanges.forEach(((_,v)=>{const b=a.get(v);if(!b)return;d.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,v))));let T=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?T=T.withResumeToken(_n.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):_.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(_.resumeToken,i)),a=a.insert(v,T),(function(A,R,z){return A.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=Uj?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0})(b,T,_)&&d.push(n.Pi.updateTargetData(l,T))}));let f=Fi(),p=We();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),d.push(Hj(l,c,e.documentUpdates).next((_=>{f=_.ks,p=_.qs}))),!i.isEqual(Pe.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));d.push(_)}return ye.waitFor(d).next((()=>c.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,f,p))).next((()=>f))})).then((l=>(n.Ms=a,l)))}function Hj(t,e,n){let i=We(),a=We();return n.forEach((l=>i=i.add(l))),e.getEntries(t,i).next((l=>{let c=Fi();return n.forEach(((d,f)=>{const p=l.get(d);f.isFoundDocument()!==p.isFoundDocument()&&(a=a.add(d)),f.isNoDocument()&&f.version.isEqual(Pe.min())?(e.removeEntry(d,f.readTime),c=c.insert(d,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),c=c.insert(d,f)):Te(ay,"Ignoring outdated watch update for ",d,". Current version:",p.version," Watch version:",f.version)})),{ks:c,qs:a}}))}function $j(t,e){const n=Le(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Hg),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Kj(t,e){const n=Le(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return n.Pi.getTargetData(i,e).next((l=>l?(a=l,ye.resolve(a)):n.Pi.allocateTargetId(i).next((c=>(a=new Ds(e,c,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function pg(t,e,n){const i=Le(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!fl(c))throw c;Te(ay,`Failed to update sequence numbers for target ${e}: ${c}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function IE(t,e,n){const i=Le(t);let a=Pe.min(),l=We();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(f,p,_){const v=Le(f),b=v.xs.get(_);return b!==void 0?ye.resolve(v.Ms.get(b)):v.Pi.getTargetData(p,_)})(i,c,ri(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(c,d.targetId).next((f=>{l=f}))})).next((()=>i.Fs.getDocumentsMatchingQuery(c,e,n?a:Pe.min(),n?l:We()))).next((d=>(Yj(i,M2(e),d),{documents:d,Qs:l})))))}function Yj(t,e,n){let i=t.Os.get(e)||Pe.min();n.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),t.Os.set(e,i)}class jE{constructor(){this.activeTargetIds=B2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Wj{constructor(){this.Mo=new jE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new jE,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Xj{Oo(e){}shutdown(){}}const OE="ConnectivityMonitor";class ME{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Te(OE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Te(OE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Wd=null;function gg(){return Wd===null?Wd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Wd++,"0x"+Wd.toString(16)}const Op="RestConnection",Jj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Zj{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===_h?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const c=gg(),d=this.zo(e,n.toUriEncodedString());Te(Op,`Sending RPC '${e}' ${c}:`,d,i);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,l);const{host:p}=new URL(d),_=cl(p);return this.Jo(e,d,f,i,_).then((v=>(Te(Op,`Received RPC '${e}' ${c}: `,v),v)),(v=>{throw Yo(Op,`RPC '${e}' ${c} failed with error: `,v,"url: ",d,"request:",i),v}))}Ho(e,n,i,a,l,c){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+dl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,n){const i=Jj[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class eO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const bn="WebChannelConnection";class tO extends Zj{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const c=gg();return new Promise(((d,f)=>{const p=new ES;p.setWithCredentials(!0),p.listenOnce(xS.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case th.NO_ERROR:const v=p.getResponseJson();Te(bn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(v)),d(v);break;case th.TIMEOUT:Te(bn,`RPC '${e}' ${c} timed out`),f(new we(ge.DEADLINE_EXCEEDED,"Request time out"));break;case th.HTTP_ERROR:const b=p.getStatus();if(Te(bn,`RPC '${e}' ${c} failed with status:`,b,"response text:",p.getResponseText()),b>0){let T=p.getResponseJson();Array.isArray(T)&&(T=T[0]);const S=T?.error;if(S&&S.status&&S.message){const A=(function(z){const F=z.toLowerCase().replace(/_/g,"-");return Object.values(ge).indexOf(F)>=0?F:ge.UNKNOWN})(S.status);f(new we(A,S.message))}else f(new we(ge.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new we(ge.UNAVAILABLE,"Connection failed."));break;default:Me(9055,{l_:e,streamId:c,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Te(bn,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(a);Te(bn,`RPC '${e}' ${c} sending request:`,a),p.send(n,"POST",_,i,15)}))}T_(e,n,i){const a=gg(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=TS(),d=wS(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,n,i),f.encodeInitMessageHeaders=!0;const _=l.join("");Te(bn,`Creating RPC '${e}' stream ${a}: ${_}`,f);const v=c.createWebChannel(_,f);this.I_(v);let b=!1,T=!1;const S=new eO({Yo:R=>{T?Te(bn,`Not sending because RPC '${e}' stream ${a} is closed:`,R):(b||(Te(bn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),b=!0),Te(bn,`RPC '${e}' stream ${a} sending:`,R),v.send(R))},Zo:()=>v.close()}),A=(R,z,F)=>{R.listen(z,(U=>{try{F(U)}catch(X){setTimeout((()=>{throw X}),0)}}))};return A(v,jc.EventType.OPEN,(()=>{T||(Te(bn,`RPC '${e}' stream ${a} transport opened.`),S.o_())})),A(v,jc.EventType.CLOSE,(()=>{T||(T=!0,Te(bn,`RPC '${e}' stream ${a} transport closed`),S.a_(),this.E_(v))})),A(v,jc.EventType.ERROR,(R=>{T||(T=!0,Yo(bn,`RPC '${e}' stream ${a} transport errored. Name:`,R.name,"Message:",R.message),S.a_(new we(ge.UNAVAILABLE,"The operation could not be completed")))})),A(v,jc.EventType.MESSAGE,(R=>{if(!T){const z=R.data[0];at(!!z,16349);const F=z,U=F?.error||F[0]?.error;if(U){Te(bn,`RPC '${e}' stream ${a} received error:`,U);const X=U.status;let Z=(function(C){const D=Gt[C];if(D!==void 0)return sw(D)})(X),oe=U.message;Z===void 0&&(Z=ge.INTERNAL,oe="Unknown error status: "+X+" with message "+U.message),T=!0,S.a_(new we(Z,oe)),v.close()}else Te(bn,`RPC '${e}' stream ${a} received:`,z),S.u_(z)}})),A(d,SS.STAT_EVENT,(R=>{R.stat===rg.PROXY?Te(bn,`RPC '${e}' stream ${a} detected buffering proxy`):R.stat===rg.NOPROXY&&Te(bn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{S.__()}),0),S}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function Mp(){return typeof document<"u"?document:null}function tf(t){return new sj(t,!0)}class vw{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&Te("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const kE="PersistentStream";class bw{constructor(e,n,i,a,l,c,d,f){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vw(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===ge.RESOURCE_EXHAUSTED?(Ui(n.toString()),Ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===ge.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===n&&this.G_(i,a)}),(i=>{e((()=>{const a=new we(ge.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Te(kE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Te(kE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class nO extends bw{constructor(e,n,i,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=lj(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Pe.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Pe.min():c.readTime?ii(c.readTime):Pe.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=mg(this.serializer),n.addTarget=(function(l,c){let d;const f=c.target;if(d=lg(f)?{documents:dj(l,f)}:{query:hj(l,f).ft},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=lw(l,c.resumeToken);const p=dg(l,c.expectedCount);p!==null&&(d.expectedCount=p)}else if(c.snapshotVersion.compareTo(Pe.min())>0){d.readTime=wh(l,c.snapshotVersion.toTimestamp());const p=dg(l,c.expectedCount);p!==null&&(d.expectedCount=p)}return d})(this.serializer,e);const i=mj(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=mg(this.serializer),n.removeTarget=e,this.q_(n)}}class rO extends bw{constructor(e,n,i,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return at(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,at(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){at(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=uj(e.writeResults,e.commitTime),i=ii(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=mg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>cj(this.serializer,i)))};this.q_(n)}}class iO{}class sO extends iO{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new we(ge.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,hg(n,i),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new we(ge.UNKNOWN,l.toString())}))}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Ho(e,hg(n,i),a,c,d,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ge.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new we(ge.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class aO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ui(n),this.aa=!1):Te("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ma="RemoteStore";class oO{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{i.enqueueAndForget((async()=>{Va(this)&&(Te(Ma,"Restarting streams for network reachability change."),await(async function(f){const p=Le(f);p.Ea.add(4),await ou(p),p.Ra.set("Unknown"),p.Ea.delete(4),await nf(p)})(this))}))})),this.Ra=new aO(i,a)}}async function nf(t){if(Va(t))for(const e of t.da)await e(!0)}async function ou(t){for(const e of t.da)await e(!1)}function Ew(t,e){const n=Le(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),uy(n)?cy(n):ml(n).O_()&&ly(n,e))}function oy(t,e){const n=Le(t),i=ml(n);n.Ia.delete(e),i.O_()&&xw(n,e),n.Ia.size===0&&(i.O_()?i.L_():Va(n)&&n.Ra.set("Unknown"))}function ly(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ml(t).Y_(e)}function xw(t,e){t.Va.Ue(e),ml(t).Z_(e)}function cy(t){t.Va=new tj({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ml(t).start(),t.Ra.ua()}function uy(t){return Va(t)&&!ml(t).x_()&&t.Ia.size>0}function Va(t){return Le(t).Ea.size===0}function Sw(t){t.Va=void 0}async function lO(t){t.Ra.set("Online")}async function cO(t){t.Ia.forEach(((e,n)=>{ly(t,e)}))}async function uO(t,e){Sw(t),uy(t)?(t.Ra.ha(e),cy(t)):t.Ra.set("Unknown")}async function dO(t,e,n){if(t.Ra.set("Online"),e instanceof ow&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const d of l.targetIds)a.Ia.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.Ia.delete(d),a.Va.removeTarget(d))})(t,e)}catch(i){Te(Ma,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Ah(t,i)}else if(e instanceof sh?t.Va.Ze(e):e instanceof aw?t.Va.st(e):t.Va.tt(e),!n.isEqual(Pe.min()))try{const i=await _w(t.localStore);n.compareTo(i)>=0&&await(function(l,c){const d=l.Va.Tt(c);return d.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const _=l.Ia.get(p);_&&l.Ia.set(p,_.withResumeToken(f.resumeToken,c))}})),d.targetMismatches.forEach(((f,p)=>{const _=l.Ia.get(f);if(!_)return;l.Ia.set(f,_.withResumeToken(_n.EMPTY_BYTE_STRING,_.snapshotVersion)),xw(l,f);const v=new Ds(_.target,f,p,_.sequenceNumber);ly(l,v)})),l.remoteSyncer.applyRemoteEvent(d)})(t,n)}catch(i){Te(Ma,"Failed to raise snapshot:",i),await Ah(t,i)}}async function Ah(t,e,n){if(!fl(e))throw e;t.Ea.add(1),await ou(t),t.Ra.set("Offline"),n||(n=()=>_w(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Te(Ma,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await nf(t)}))}function ww(t,e){return e().catch((n=>Ah(t,n,e)))}async function rf(t){const e=Le(t),n=Fs(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Hg;for(;hO(e);)try{const a=await $j(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,fO(e,a)}catch(a){await Ah(e,a)}Tw(e)&&Aw(e)}function hO(t){return Va(t)&&t.Ta.length<10}function fO(t,e){t.Ta.push(e);const n=Fs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Tw(t){return Va(t)&&!Fs(t).x_()&&t.Ta.length>0}function Aw(t){Fs(t).start()}async function mO(t){Fs(t).ra()}async function pO(t){const e=Fs(t);for(const n of t.Ta)e.ea(n.mutations)}async function gO(t,e,n){const i=t.Ta.shift(),a=ey.from(i,e,n);await ww(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await rf(t)}async function yO(t,e){e&&Fs(t).X_&&await(async function(i,a){if((function(c){return J2(c)&&c!==ge.ABORTED})(a.code)){const l=i.Ta.shift();Fs(i).B_(),await ww(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await rf(i)}})(t,e),Tw(t)&&Aw(t)}async function NE(t,e){const n=Le(t);n.asyncQueue.verifyOperationInProgress(),Te(Ma,"RemoteStore received new credentials");const i=Va(n);n.Ea.add(3),await ou(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await nf(n)}async function _O(t,e){const n=Le(t);e?(n.Ea.delete(2),await nf(n)):e||(n.Ea.add(2),await ou(n),n.Ra.set("Unknown"))}function ml(t){return t.ma||(t.ma=(function(n,i,a){const l=Le(n);return l.sa(),new nO(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:lO.bind(null,t),t_:cO.bind(null,t),r_:uO.bind(null,t),H_:dO.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),uy(t)?cy(t):t.Ra.set("Unknown")):(await t.ma.stop(),Sw(t))}))),t.ma}function Fs(t){return t.fa||(t.fa=(function(n,i,a){const l=Le(n);return l.sa(),new rO(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:mO.bind(null,t),r_:yO.bind(null,t),ta:pO.bind(null,t),na:gO.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await rf(t)):(await t.fa.stop(),t.Ta.length>0&&(Te(Ma,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class dy{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Vi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const c=Date.now()+i,d=new dy(e,n,c,a,l);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(ge.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hy(t,e){if(Ui("AsyncQueue",`${e}: ${t}`),fl(t))return new we(ge.UNAVAILABLE,`${e}: ${t}`);throw t}class Lo{static emptySet(e){return new Lo(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||Ie.comparator(n.key,i.key):(n,i)=>Ie.comparator(n.key,i.key),this.keyedMap=Oc(),this.sortedSet=new At(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Lo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Lo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class PE{constructor(){this.ga=new At(Ie.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Me(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class tl{constructor(e,n,i,a,l,c,d,f,p){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,n,i,a,l){const c=[];return n.forEach((d=>{c.push({type:0,doc:d})})),new tl(e,n,Lo.emptySet(n),c,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}class vO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class bO{constructor(){this.queries=VE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=Le(n),l=a.queries;a.queries=VE(),l.forEach(((c,d)=>{for(const f of d.Sa)f.onError(i)}))})(this,new we(ge.ABORTED,"Firestore shutting down"))}}function VE(){return new Pa((t=>$S(t)),Wh)}async function Cw(t,e){const n=Le(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new vO,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(c){const d=hy(c,`Initialization of query '${ko(e.query)}' failed`);return void e.onError(d)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&fy(n)}async function Rw(t,e){const n=Le(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function EO(t,e){const n=Le(t);let i=!1;for(const a of e){const l=a.query,c=n.queries.get(l);if(c){for(const d of c.Sa)d.Fa(a)&&(i=!0);c.wa=a}}i&&fy(n)}function xO(t,e,n){const i=Le(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function fy(t){t.Ca.forEach((e=>{e.next()}))}var yg,LE;(LE=yg||(yg={})).Ma="default",LE.Cache="cache";class Dw{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new tl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=tl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==yg.Cache}}class Iw{constructor(e){this.key=e}}class jw{constructor(e){this.key=e}}class SO{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=We(),this.mutatedKeys=We(),this.eu=KS(e),this.tu=new Lo(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new PE,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,c=a,d=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,p=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,v)=>{const b=a.get(_),T=Xh(this.query,v)?v:null,S=!!b&&this.mutatedKeys.has(b.key),A=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let R=!1;b&&T?b.data.isEqual(T.data)?S!==A&&(i.track({type:3,doc:T}),R=!0):this.su(b,T)||(i.track({type:2,doc:T}),R=!0,(f&&this.eu(T,f)>0||p&&this.eu(T,p)<0)&&(d=!0)):!b&&T?(i.track({type:0,doc:T}),R=!0):b&&!T&&(i.track({type:1,doc:b}),R=!0,(f||p)&&(d=!0)),R&&(T?(c=c.add(T),l=A?l.add(_):l.delete(_)):(c=c.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:c,iu:i,Cs:d,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,v)=>(function(T,S){const A=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Me(20277,{Rt:R})}};return A(T)-A(S)})(_.type,v.type)||this.eu(_.doc,v.doc))),this.ou(i),a=a??!1;const d=n&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,p=f!==this.Za;return this.Za=f,c.length!==0||p?{snapshot:new tl(this.query,e.tu,l,c,e.mutatedKeys,f===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new PE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=We(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new jw(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new Iw(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=We();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return tl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const my="SyncEngine";class wO{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class TO{constructor(e){this.key=e,this.hu=!1}}class AO{constructor(e,n,i,a,l,c){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Pa((d=>$S(d)),Wh),this.Iu=new Map,this.Eu=new Set,this.du=new At(Ie.comparator),this.Au=new Map,this.Ru=new ry,this.Vu={},this.mu=new Map,this.fu=el.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function CO(t,e,n=!0){const i=Vw(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await Ow(i,e,n,!0),a}async function RO(t,e){const n=Vw(t);await Ow(n,e,!0,!1)}async function Ow(t,e,n,i){const a=await Kj(t.localStore,ri(e)),l=a.targetId,c=t.sharedClientState.addLocalQueryTarget(l,n);let d;return i&&(d=await DO(t,e,l,c==="current",a.resumeToken)),t.isPrimaryClient&&n&&Ew(t.remoteStore,a),d}async function DO(t,e,n,i,a){t.pu=(v,b,T)=>(async function(A,R,z,F){let U=R.view.ru(z);U.Cs&&(U=await IE(A.localStore,R.query,!1).then((({documents:M})=>R.view.ru(M,U))));const X=F&&F.targetChanges.get(R.targetId),Z=F&&F.targetMismatches.get(R.targetId)!=null,oe=R.view.applyChanges(U,A.isPrimaryClient,X,Z);return zE(A,R.targetId,oe.au),oe.snapshot})(t,v,b,T);const l=await IE(t.localStore,e,!0),c=new SO(e,l.Qs),d=c.ru(l.documents),f=au.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),p=c.applyChanges(d,t.isPrimaryClient,f);zE(t,n,p.au);const _=new wO(e,n,c);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),p.snapshot}async function IO(t,e,n){const i=Le(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((c=>!Wh(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await pg(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&oy(i.remoteStore,a.targetId),_g(i,a.targetId)})).catch(hl)):(_g(i,a.targetId),await pg(i.localStore,a.targetId,!0))}async function jO(t,e){const n=Le(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),oy(n.remoteStore,i.targetId))}async function OO(t,e,n){const i=BO(t);try{const a=await(function(c,d){const f=Le(c),p=vt.now(),_=d.reduce(((T,S)=>T.add(S.key)),We());let v,b;return f.persistence.runTransaction("Locally write mutations","readwrite",(T=>{let S=Fi(),A=We();return f.Ns.getEntries(T,_).next((R=>{S=R,S.forEach(((z,F)=>{F.isValidDocument()||(A=A.add(z))}))})).next((()=>f.localDocuments.getOverlayedDocuments(T,S))).next((R=>{v=R;const z=[];for(const F of d){const U=$2(F,v.get(F.key).overlayedDocument);U!=null&&z.push(new Hs(F.key,U,BS(U.value.mapValue),Dr.exists(!0)))}return f.mutationQueue.addMutationBatch(T,p,z,d)})).next((R=>{b=R;const z=R.applyToLocalDocumentSet(v,A);return f.documentOverlayCache.saveOverlays(T,R.batchId,z)}))})).then((()=>({batchId:b.batchId,changes:WS(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(c,d,f){let p=c.Vu[c.currentUser.toKey()];p||(p=new At(Ye)),p=p.insert(d,f),c.Vu[c.currentUser.toKey()]=p})(i,a.batchId,n),await lu(i,a.changes),await rf(i.remoteStore)}catch(a){const l=hy(a,"Failed to persist write");n.reject(l)}}async function Mw(t,e){const n=Le(t);try{const i=await Gj(n.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=n.Au.get(l);c&&(at(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?at(c.hu,14607):a.removedDocuments.size>0&&(at(c.hu,42227),c.hu=!1))})),await lu(n,i,e)}catch(i){await hl(i)}}function BE(t,e,n){const i=Le(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach(((l,c)=>{const d=c.view.va(e);d.snapshot&&a.push(d.snapshot)})),(function(c,d){const f=Le(c);f.onlineState=d;let p=!1;f.queries.forEach(((_,v)=>{for(const b of v.Sa)b.va(d)&&(p=!0)})),p&&fy(f)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function MO(t,e,n){const i=Le(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let c=new At(Ie.comparator);c=c.insert(l,xn.newNoDocument(l,Pe.min()));const d=We().add(l),f=new ef(Pe.min(),new Map,new At(Ye),c,d);await Mw(i,f),i.du=i.du.remove(l),i.Au.delete(e),py(i)}else await pg(i.localStore,e,!1).then((()=>_g(i,e,n))).catch(hl)}async function kO(t,e){const n=Le(t),i=e.batch.batchId;try{const a=await Qj(n.localStore,e);Nw(n,i,null),kw(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await lu(n,a)}catch(a){await hl(a)}}async function NO(t,e,n){const i=Le(t);try{const a=await(function(c,d){const f=Le(c);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let _;return f.mutationQueue.lookupMutationBatch(p,d).next((v=>(at(v!==null,37113),_=v.keys(),f.mutationQueue.removeMutationBatch(p,v)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,_,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_))).next((()=>f.localDocuments.getDocuments(p,_)))}))})(i.localStore,e);Nw(i,e,n),kw(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await lu(i,a)}catch(a){await hl(a)}}function kw(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Nw(t,e,n){const i=Le(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function _g(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||Pw(t,i)}))}function Pw(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(oy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),py(t))}function zE(t,e,n){for(const i of n)i instanceof Iw?(t.Ru.addReference(i.key,e),PO(t,i)):i instanceof jw?(Te(my,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||Pw(t,i.key)):Me(19791,{wu:i})}function PO(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(Te(my,"New document in limbo: "+n),t.Eu.add(i),py(t))}function py(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Ie(gt.fromString(e)),i=t.fu.next();t.Au.set(i,new TO(n)),t.du=t.du.insert(n,i),Ew(t.remoteStore,new Ds(ri(Xg(n.path)),i,"TargetPurposeLimboResolution",$h.ce))}}async function lu(t,e,n){const i=Le(t),a=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,f)=>{c.push(i.pu(f,e,n).then((p=>{if((p||n)&&i.isPrimaryClient){const _=p?!p.fromCache:n?.targetChanges.get(f.targetId)?.current;i.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(p){a.push(p);const _=sy.As(f.targetId,p);l.push(_)}})))})),await Promise.all(c),i.Pu.H_(a),await(async function(f,p){const _=Le(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ye.forEach(p,(b=>ye.forEach(b.Es,(T=>_.persistence.referenceDelegate.addReference(v,b.targetId,T))).next((()=>ye.forEach(b.ds,(T=>_.persistence.referenceDelegate.removeReference(v,b.targetId,T)))))))))}catch(v){if(!fl(v))throw v;Te(ay,"Failed to update sequence numbers: "+v)}for(const v of p){const b=v.targetId;if(!v.fromCache){const T=_.Ms.get(b),S=T.snapshotVersion,A=T.withLastLimboFreeSnapshotVersion(S);_.Ms=_.Ms.insert(b,A)}}})(i.localStore,l))}async function VO(t,e){const n=Le(t);if(!n.currentUser.isEqual(e)){Te(my,"User change. New user:",e.toKey());const i=await yw(n.localStore,e);n.currentUser=e,(function(l,c){l.mu.forEach((d=>{d.forEach((f=>{f.reject(new we(ge.CANCELLED,c))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await lu(n,i.Ls)}}function LO(t,e){const n=Le(t),i=n.Au.get(e);if(i&&i.hu)return We().add(i.key);{let a=We();const l=n.Iu.get(e);if(!l)return a;for(const c of l){const d=n.Tu.get(c);a=a.unionWith(d.view.nu)}return a}}function Vw(t){const e=Le(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Mw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=LO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MO.bind(null,e),e.Pu.H_=EO.bind(null,e.eventManager),e.Pu.yu=xO.bind(null,e.eventManager),e}function BO(t){const e=Le(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NO.bind(null,e),e}class Ch{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=tf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return qj(this.persistence,new zj,e.initialUser,this.serializer)}Cu(e){return new gw(iy.mi,this.serializer)}Du(e){return new Wj}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ch.provider={build:()=>new Ch};class zO extends Ch{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){at(this.persistence.referenceDelegate instanceof Th,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new Tj(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?kn.withCacheSize(this.cacheSizeBytes):kn.DEFAULT;return new gw((i=>Th.mi(i,n)),this.serializer)}}class vg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>BE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=VO.bind(null,this.syncEngine),await _O(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new bO})()}createDatastore(e){const n=tf(e.databaseInfo.databaseId),i=(function(l){return new tO(l)})(e.databaseInfo);return(function(l,c,d,f){return new sO(l,c,d,f)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,a,l,c,d){return new oO(i,a,l,c,d)})(this.localStore,this.datastore,e.asyncQueue,(n=>BE(this.syncEngine,n,0)),(function(){return ME.v()?new ME:new Xj})())}createSyncEngine(e,n){return(function(a,l,c,d,f,p,_){const v=new AO(a,l,c,d,f,p);return _&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Le(n);Te(Ma,"RemoteStore shutting down."),i.Ea.add(5),await ou(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}vg.provider={build:()=>new vg};class Lw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ui("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const qs="FirestoreClient";class UO{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=En.UNAUTHENTICATED,this.clientId=Gg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{Te(qs,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Te(qs,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Vi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=hy(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function kp(t,e){t.asyncQueue.verifyOperationInProgress(),Te(qs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async a=>{i.isEqual(a)||(await yw(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function UE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await FO(t);Te(qs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>NE(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,a)=>NE(e.remoteStore,a))),t._onlineComponents=e}async function FO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Te(qs,"Using user provided OfflineComponentProvider");try{await kp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ge.FAILED_PRECONDITION||a.code===ge.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;Yo("Error using user provided cache. Falling back to memory cache: "+n),await kp(t,new Ch)}}else Te(qs,"Using default OfflineComponentProvider"),await kp(t,new zO(void 0));return t._offlineComponents}async function Bw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Te(qs,"Using user provided OnlineComponentProvider"),await UE(t,t._uninitializedComponentsProvider._online)):(Te(qs,"Using default OnlineComponentProvider"),await UE(t,new vg))),t._onlineComponents}function qO(t){return Bw(t).then((e=>e.syncEngine))}async function zw(t){const e=await Bw(t),n=e.eventManager;return n.onListen=CO.bind(null,e.syncEngine),n.onUnlisten=IO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=RO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=jO.bind(null,e.syncEngine),n}function QO(t,e,n={}){const i=new Vi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,f,p){const _=new Lw({next:b=>{_.Nu(),c.enqueueAndForget((()=>Rw(l,v)));const T=b.docs.has(d);!T&&b.fromCache?p.reject(new we(ge.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&b.fromCache&&f&&f.source==="server"?p.reject(new we(ge.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(b)},error:b=>p.reject(b)}),v=new Dw(Xg(d.path),_,{includeMetadataChanges:!0,qa:!0});return Cw(l,v)})(await zw(t),t.asyncQueue,e,n,i))),i.promise}function GO(t,e,n={}){const i=new Vi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,f,p){const _=new Lw({next:b=>{_.Nu(),c.enqueueAndForget((()=>Rw(l,v))),b.fromCache&&f.source==="server"?p.reject(new we(ge.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(b)},error:b=>p.reject(b)}),v=new Dw(d,_,{includeMetadataChanges:!0,qa:!0});return Cw(l,v)})(await zw(t),t.asyncQueue,e,n,i))),i.promise}function Uw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const FE=new Map;const Fw="firestore.googleapis.com",qE=!0;class QE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new we(ge.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Fw,this.ssl=qE}else this.host=e.host,this.ssl=e.ssl??qE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=pw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Sj)throw new we(ge.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}a2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Uw(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new we(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new we(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new we(ge.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sf{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new QE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(ge.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(ge.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new QE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new WI;switch(i.type){case"firstParty":return new e2(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new we(ge.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=FE.get(n);i&&(Te("ComponentProvider","Removing Datastore"),FE.delete(n),i.terminate())})(this),Promise.resolve()}}function HO(t,e,n,i={}){t=di(t,sf);const a=cl(e),l=t._getSettings(),c={...l,emulatorOptions:t._getEmulatorOptions()},d=`${e}:${n}`;a&&(hS(`https://${d}`),fS("Firestore",!0)),l.host!==Fw&&l.host!==d&&Yo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...l,host:d,ssl:a,emulatorOptions:i};if(!Vs(f,c)&&(t._setSettings(f),i.mockUserToken)){let p,_;if(typeof i.mockUserToken=="string")p=i.mockUserToken,_=En.MOCK_USER;else{p=SD(i.mockUserToken,t._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new we(ge.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new En(v)}t._authCredentials=new XI(new CS(p,_))}}class pl{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new pl(this.firestore,e,this._query)}}class Nt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ns(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nt(this.firestore,e,this._key)}toJSON(){return{type:Nt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(ru(n,Nt._jsonSchema))return new Nt(e,i||null,new Ie(gt.fromString(n.referencePath)))}}Nt._jsonSchemaVersion="firestore/documentReference/1.0",Nt._jsonSchema={type:Kt("string",Nt._jsonSchemaVersion),referencePath:Kt("string")};class Ns extends pl{constructor(e,n,i){super(e,n,Xg(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nt(this.firestore,null,new Ie(e))}withConverter(e){return new Ns(this.firestore,e,this._path)}}function $O(t,e,...n){if(t=an(t),RS("collection","path",e),t instanceof sf){const i=gt.fromString(e,...n);return rE(i),new Ns(t,null,i)}{if(!(t instanceof Nt||t instanceof Ns))throw new we(ge.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(gt.fromString(e,...n));return rE(i),new Ns(t.firestore,null,i)}}function af(t,e,...n){if(t=an(t),arguments.length===1&&(e=Gg.newId()),RS("doc","path",e),t instanceof sf){const i=gt.fromString(e,...n);return nE(i),new Nt(t,null,new Ie(i))}{if(!(t instanceof Nt||t instanceof Ns))throw new we(ge.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(gt.fromString(e,...n));return nE(i),new Nt(t.firestore,t instanceof Ns?t.converter:null,new Ie(i))}}const GE="AsyncQueue";class HE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vw(this,"async_queue_retry"),this._c=()=>{const i=Mp();i&&Te(GE,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Mp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Mp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Vi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!fl(e))throw e;Te(GE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ui("INTERNAL UNHANDLED ERROR: ",$E(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=dy.createAndSchedule(this,e,n,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Me(47125,{Pc:$E(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function $E(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class gl extends sf{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new HE,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new HE(e),this._firestoreClient=void 0,await e}}}function KO(t,e){const n=typeof t=="object"?t:yS(),i=typeof t=="string"?t:_h,a=qg(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=ED("firestore");l&&HO(a,...l)}return a}function gy(t){if(t._terminated)throw new we(ge.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||YO(t),t._firestoreClient}function YO(t){const e=t._freezeSettings(),n=(function(a,l,c,d){return new y2(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Uw(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new UO(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(t._componentsProvider))}class ur{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ur(_n.fromBase64String(e))}catch(n){throw new we(ge.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ur(_n.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ur._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ru(e,ur._jsonSchema))return ur.fromBase64String(e.bytes)}}ur._jsonSchemaVersion="firestore/bytes/1.0",ur._jsonSchema={type:Kt("string",ur._jsonSchemaVersion),bytes:Kt("string")};class of{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new we(ge.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class lf{constructor(e){this._methodName=e}}class si{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new we(ge.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new we(ge.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ye(this._lat,e._lat)||Ye(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:si._jsonSchemaVersion}}static fromJSON(e){if(ru(e,si._jsonSchema))return new si(e.latitude,e.longitude)}}si._jsonSchemaVersion="firestore/geoPoint/1.0",si._jsonSchema={type:Kt("string",si._jsonSchemaVersion),latitude:Kt("number"),longitude:Kt("number")};class ai{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ai._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ru(e,ai._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new ai(e.vectorValues);throw new we(ge.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ai._jsonSchemaVersion="firestore/vectorValue/1.0",ai._jsonSchema={type:Kt("string",ai._jsonSchemaVersion),vectorValues:Kt("object")};const WO=/^__.*__$/;class XO{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new Hs(e,this.data,this.fieldMask,n,this.fieldTransforms):new su(e,this.data,n,this.fieldTransforms)}}class qw{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new Hs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Qw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Me(40011,{Ac:t})}}class cf{constructor(e,n,i,a,l,c){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new cf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Rh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Qw(this.Ac)&&WO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class JO{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||tf(e)}Cc(e,n,i,a=!1){return new cf({Ac:e,methodName:n,Dc:i,path:gn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function yy(t){const e=t._freezeSettings(),n=tf(t._databaseId);return new JO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ZO(t,e,n,i,a,l={}){const c=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);vy("Data must be an object, but it was:",c,i);const d=Gw(i,c);let f,p;if(l.merge)f=new $n(c.fieldMask),p=c.fieldTransforms;else if(l.mergeFields){const _=[];for(const v of l.mergeFields){const b=bg(e,v,n);if(!c.contains(b))throw new we(ge.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);$w(_,b)||_.push(b)}f=new $n(_),p=c.fieldTransforms.filter((v=>f.covers(v.field)))}else f=null,p=c.fieldTransforms;return new XO(new Nn(d),f,p)}class uf extends lf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof uf}}function e5(t,e,n){return new cf({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class _y extends lf{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=e5(this,e,!0),i=this.vc.map((l=>yl(l,n))),a=new Zo(i);return new q2(e.path,a)}isEqual(e){return e instanceof _y&&Vs(this.vc,e.vc)}}function t5(t,e,n,i){const a=t.Cc(1,e,n);vy("Data must be an object, but it was:",a,i);const l=[],c=Nn.empty();Gs(i,((f,p)=>{const _=by(e,f,n);p=an(p);const v=a.yc(_);if(p instanceof uf)l.push(_);else{const b=yl(p,v);b!=null&&(l.push(_),c.set(_,b))}}));const d=new $n(l);return new qw(c,d,a.fieldTransforms)}function n5(t,e,n,i,a,l){const c=t.Cc(1,e,n),d=[bg(e,i,n)],f=[a];if(l.length%2!=0)throw new we(ge.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<l.length;b+=2)d.push(bg(e,l[b])),f.push(l[b+1]);const p=[],_=Nn.empty();for(let b=d.length-1;b>=0;--b)if(!$w(p,d[b])){const T=d[b];let S=f[b];S=an(S);const A=c.yc(T);if(S instanceof uf)p.push(T);else{const R=yl(S,A);R!=null&&(p.push(T),_.set(T,R))}}const v=new $n(p);return new qw(_,v,c.fieldTransforms)}function r5(t,e,n,i=!1){return yl(n,t.Cc(i?4:3,e))}function yl(t,e){if(Hw(t=an(t)))return vy("Unsupported field value:",e,t),Gw(t,e);if(t instanceof lf)return(function(i,a){if(!Qw(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let c=0;for(const d of i){let f=yl(d,a.wc(c));f==null&&(f={nullValue:"NULL_VALUE"}),l.push(f),c++}return{arrayValue:{values:l}}})(t,e)}return(function(i,a){if((i=an(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return z2(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=vt.fromDate(i);return{timestampValue:wh(a.serializer,l)}}if(i instanceof vt){const l=new vt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:wh(a.serializer,l)}}if(i instanceof si)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ur)return{bytesValue:lw(a.serializer,i._byteString)};if(i instanceof Nt){const l=a.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw a.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:ny(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof ai)return(function(c,d){return{mapValue:{fields:{[VS]:{stringValue:LS},[vh]:{arrayValue:{values:c.toArray().map((p=>{if(typeof p!="number")throw d.Sc("VectorValues must only contain numeric values.");return Jg(d.serializer,p)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${Hh(i)}`)})(t,e)}function Gw(t,e){const n={};return jS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gs(t,((i,a)=>{const l=yl(a,e.mc(i));l!=null&&(n[i]=l)})),{mapValue:{fields:n}}}function Hw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vt||t instanceof si||t instanceof ur||t instanceof Nt||t instanceof lf||t instanceof ai)}function vy(t,e,n){if(!Hw(n)||!DS(n)){const i=Hh(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function bg(t,e,n){if((e=an(e))instanceof of)return e._internalPath;if(typeof e=="string")return by(t,e);throw Rh("Field path arguments must be of type string or ",t,!1,void 0,n)}const i5=new RegExp("[~\\*/\\[\\]]");function by(t,e,n){if(e.search(i5)>=0)throw Rh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new of(...e.split("."))._internalPath}catch{throw Rh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Rh(t,e,n,i,a){const l=i&&!i.isEmpty(),c=a!==void 0;let d=`Function ${e}() called with invalid data`;n&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(l||c)&&(f+=" (found",l&&(f+=` in field ${i}`),c&&(f+=` in document ${a}`),f+=")"),new we(ge.INVALID_ARGUMENT,d+t+f)}function $w(t,e){return t.some((n=>n.isEqual(e)))}class Kw{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Nt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new s5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ey("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class s5 extends Kw{data(){return super.data()}}function Ey(t,e){return typeof e=="string"?by(t,e):e instanceof of?e._internalPath:e._delegate._internalPath}function a5(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new we(ge.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xy{}class o5 extends xy{}function l5(t,e,...n){let i=[];e instanceof xy&&i.push(e),i=i.concat(n),(function(l){const c=l.filter((f=>f instanceof Sy)).length,d=l.filter((f=>f instanceof df)).length;if(c>1||c>0&&d>0)throw new we(ge.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)t=a._apply(t);return t}class df extends o5{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new df(e,n,i)}_apply(e){const n=this._parse(e);return Yw(e._query,n),new pl(e.firestore,e.converter,cg(e._query,n))}_parse(e){const n=yy(e.firestore);return(function(l,c,d,f,p,_,v){let b;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new we(ge.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){YE(v,_);const S=[];for(const A of v)S.push(KE(f,l,A));b={arrayValue:{values:S}}}else b=KE(f,l,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||YE(v,_),b=r5(d,c,v,_==="in"||_==="not-in");return $t.create(p,_,b)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function c5(t,e,n){const i=e,a=Ey("where",t);return df._create(a,i,n)}class Sy extends xy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Sy(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Ir.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,l){let c=a;const d=l.getFlattenedFilters();for(const f of d)Yw(c,f),c=cg(c,f)})(e._query,n),new pl(e.firestore,e.converter,cg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function KE(t,e,n){if(typeof(n=an(n))=="string"){if(n==="")throw new we(ge.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!HS(e)&&n.indexOf("/")!==-1)throw new we(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(gt.fromString(n));if(!Ie.isDocumentKey(i))throw new we(ge.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return dE(t,new Ie(i))}if(n instanceof Nt)return dE(t,n._key);throw new we(ge.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hh(n)}.`)}function YE(t,e){if(!Array.isArray(t)||t.length===0)throw new we(ge.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Yw(t,e){const n=(function(a,l){for(const c of a)for(const d of c.getFlattenedFilters())if(l.indexOf(d.op)>=0)return d.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new we(ge.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new we(ge.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class u5{convertValue(e,n="none"){switch(Us(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(zs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Me(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return Gs(e,((a,l)=>{i[a]=this.convertValue(l,n)})),i}convertVectorValue(e){const n=e.fields?.[vh].arrayValue?.values?.map((i=>kt(i.doubleValue)));return new ai(n)}convertGeoPoint(e){return new si(kt(e.latitude),kt(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Yh(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Gc(e));default:return null}}convertTimestamp(e){const n=Bs(e);return new vt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=gt.fromString(e);at(mw(i),9688,{name:e});const a=new Hc(i.get(1),i.get(3)),l=new Ie(i.popFirst(5));return a.isEqual(n)||Ui(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function d5(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class kc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ra extends Kw{constructor(e,n,i,a,l,c){super(e,n,i,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ah(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(Ey("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new we(ge.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ra._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ra._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ra._jsonSchema={type:Kt("string",Ra._jsonSchemaVersion),bundleSource:Kt("string","DocumentSnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class ah extends Ra{data(e={}){return super.data(e)}}class Bo{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new kc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new ah(this._firestore,this._userDataWriter,i.key,i,new kc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new we(ge.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((d=>{const f=new ah(a._firestore,a._userDataWriter,d.doc.key,d.doc,new kc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const f=new ah(a._firestore,a._userDataWriter,d.doc.key,d.doc,new kc(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let p=-1,_=-1;return d.type!==0&&(p=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),_=c.indexOf(d.doc.key)),{type:h5(d.type),doc:f,oldIndex:p,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new we(ge.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Gg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function h5(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Me(61501,{type:t})}}function f5(t){t=di(t,Nt);const e=di(t.firestore,gl);return QO(gy(e),t._key).then((n=>_5(e,t,n)))}Bo._jsonSchemaVersion="firestore/querySnapshot/1.0",Bo._jsonSchema={type:Kt("string",Bo._jsonSchemaVersion),bundleSource:Kt("string","QuerySnapshot"),bundleName:Kt("string"),bundle:Kt("string")};class Ww extends u5{constructor(e){super(),this.firestore=e}convertBytes(e){return new ur(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Nt(this.firestore,null,n)}}function m5(t){t=di(t,pl);const e=di(t.firestore,gl),n=gy(e),i=new Ww(e);return a5(t._query),GO(n,t._query).then((a=>new Bo(e,i,t,a)))}function p5(t,e,n){t=di(t,Nt);const i=di(t.firestore,gl),a=d5(t.converter,e,n);return wy(i,[ZO(yy(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,Dr.none())])}function g5(t,e,n,...i){t=di(t,Nt);const a=di(t.firestore,gl),l=yy(a);let c;return c=typeof(e=an(e))=="string"||e instanceof of?n5(l,"updateDoc",t._key,e,n,i):t5(l,"updateDoc",t._key,e),wy(a,[c.toMutation(t._key,Dr.exists(!0))])}function y5(t){return wy(di(t.firestore,gl),[new Zg(t._key,Dr.none())])}function wy(t,e){return(function(i,a){const l=new Vi;return i.asyncQueue.enqueueAndForget((async()=>OO(await qO(i),a,l))),l.promise})(gy(t),e)}function _5(t,e,n){const i=n.docs.get(e._key),a=new Ww(t);return new Ra(t,a,e._key,i,new kc(n.hasPendingWrites,n.fromCache),e.converter)}function v5(...t){return new _y("arrayUnion",t)}(function(e,n=!0){(function(a){dl=a})(ul),Ko(new ja("firestore",((i,{instanceIdentifier:a,options:l})=>{const c=i.getProvider("app").getImmediate(),d=new gl(new JI(i.getProvider("auth-internal")),new t2(c,i.getProvider("app-check-internal")),(function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new we(ge.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hc(p.options.projectId,_)})(c,a),c);return l={useFetchStreams:n,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),Ms(Jb,Zb,e),Ms(Jb,Zb,"esm2020")})();var b5="firebase",E5="12.7.0";Ms(b5,E5,"app");const x5={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},Xw=gS(x5);function cu(t,e,n,i=1){{let a=e;if(e.startsWith("budgets/"))a="budgets";else if(e.startsWith("months/")){const c=e.replace("months/","").split("_");if(c.length>=2){const d=c[c.length-1];a=`months/${c[c.length-2]}/${d}`}}console.log(`[Firebase] ${t}(${i}): ${a}  ${n}`)}}function uu(){return KO(Xw)}function WE(t){return t===null||typeof t!="object"?!1:"_methodName"in t}function Dh(t){const e={};for(const[n,i]of Object.entries(t))i!==void 0&&(WE(i)?e[n]=i:i!==null&&typeof i=="object"&&!Array.isArray(i)?e[n]=Dh(i):Array.isArray(i)?e[n]=i.map(a=>a!==null&&typeof a=="object"&&!WE(a)?Dh(a):a):e[n]=i);return e}async function Ce(t,e,n){const i=af(uu(),t,e),a=`${t}/${e}`;cu("READ",a,n);const l=await f5(i);return{exists:l.exists(),data:l.exists()?l.data():null,ref:i}}async function Ze(t,e,n,i,a){const l=af(uu(),t,e),c=Dh(n),d=`${t}/${e}`;return cu("WRITE",d,i),p5(l,c,a??{})}async function Xd(t,e,n,i){const a=af(uu(),t,e),l=Dh(n),c=`${t}/${e}`;return cu("UPDATE",c,i),g5(a,l)}async function Jw(t,e,n){const i=af(uu(),t,e),a=`${t}/${e}`;return cu("DELETE",a,n),y5(i)}async function oi(t,e,n){const i=uu(),a=$O(i,t);let l;if(n&&n.length>0){const f=n.map(p=>c5(p.field,p.op,p.value));l=l5(a,...f)}else l=a;const c=await m5(l);let d=t;if(n&&n.length>0){const f=n.map(p=>`${p.field} ${p.op} ${JSON.stringify(p.value)}`).join(", ");d+=` WHERE ${f}`}return cu("QUERY",d,e,c.docs.length),{docs:c.docs.map(f=>({id:f.id,data:f.data()}))}}function Eg(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname,balance:i.balance,account_group_id:i.account_group_id??null,sort_order:i.sort_order},i.is_income_account!==void 0&&(e[n].is_income_account=i.is_income_account),i.is_income_default!==void 0&&(e[n].is_income_default=i.is_income_default),i.is_outgo_account!==void 0&&(e[n].is_outgo_account=i.is_outgo_account),i.is_outgo_default!==void 0&&(e[n].is_outgo_default=i.is_outgo_default),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function S5(t){return t.map(e=>{const n={id:e.id,amount:e.amount,account_id:e.account_id,date:e.date,created_at:e.created_at};return e.payee&&(n.payee=e.payee),e.description&&(n.description=e.description),n})}function w5(t){return t.map(e=>({category_id:e.category_id,amount:e.amount}))}function T5(t){return t.map(e=>{const n={id:e.id,amount:e.amount,category_id:e.category_id,account_id:e.account_id,date:e.date,created_at:e.created_at};return e.payee&&(n.payee=e.payee),e.description&&(n.description=e.description),n})}function A5(t){return t.map(e=>({category_id:e.category_id,start_balance:e.start_balance,allocated:e.allocated,spent:e.spent,end_balance:e.end_balance}))}function Tt(t,e,n){const i=n.toString().padStart(2,"0");return`${t}_${e}_${i}`}function C5(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname,balance:i.balance,account_group_id:i.account_group_id??null,sort_order:i.sort_order??0,is_income_account:i.is_income_account,is_income_default:i.is_income_default,is_outgo_account:i.is_outgo_account,is_outgo_default:i.is_outgo_default,on_budget:i.on_budget,is_active:i.is_active}}),e}function R5(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order??0,expected_balance:i.expected_balance??"positive",on_budget:i.on_budget,is_active:i.is_active}}),e}function D5(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,description:i.description,category_group_id:i.category_group_id??null,sort_order:i.sort_order??0,default_monthly_amount:i.default_monthly_amount,default_monthly_type:i.default_monthly_type,balance:i.balance??0}}),e}function I5(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,i)=>n.sort_order-i.sort_order),e}function j5(t){return!t||typeof t.computed_at!="string"||typeof t.computed_for_year!="number"||typeof t.computed_for_month!="number"||typeof t.is_stale!="boolean"||!t.balances?null:{computed_at:t.computed_at,computed_for_year:t.computed_for_year,computed_for_month:t.computed_for_month,is_stale:t.is_stale,balances:t.balances}}async function O5(t){const{exists:e,data:n}=await Ce("budgets",t,"loading budget data (cache miss or stale)");if(!e||!n)throw new Error(`Budget ${t} not found`);return{budget:{id:t,name:n.name,user_ids:n.user_ids||[],accepted_user_ids:n.accepted_user_ids||[],owner_id:n.owner_id||n.user_ids?.[0]||"",owner_email:n.owner_email||null},accounts:C5(n.accounts),accountGroups:R5(n.account_groups),categories:D5(n.categories),categoryGroups:I5(n.category_groups),categoryBalancesSnapshot:j5(n.category_balances_snapshot)}}function M5(t,e){return ll({queryKey:t?ne.budget(t):["budget","none"],queryFn:()=>O5(t),enabled:!!t&&e?.enabled!==!1})}function Li(t,e,n){let i=e,a=n+1;a>12&&(a=1,i+=1);const l=ne.month(t,i,a),c=Ne.getQueryData(l);c&&!c.month.previous_month_snapshot_stale&&Ne.setQueryData(l,{month:{...c.month,previous_month_snapshot_stale:!0}})}async function k5(t,e,n){let i=e,a=n+1;a>12&&(a=1,i+=1);const l=ne.month(t,i,a),c=Tt(t,i,a);let d=null;const f=Ne.getQueryData(l);if(f?.month)d=f.month;else{const{exists:p,data:_}=await Ce("months",c,"checking if next month exists to mark its snapshot stale");if(!p||!_)return;d=_,Ne.setQueryData(l,{month:d})}d.previous_month_snapshot_stale||(await Ze("months",c,{...d,previous_month_snapshot_stale:!0,updated_at:new Date().toISOString()},"marking next month snapshot as stale (previous month was edited)"),Ne.setQueryData(l,{month:{...d,previous_month_snapshot_stale:!0}}))}function hf(t,e,n,i){const a=(t.income||[]).map(p=>({id:p.id,amount:p.amount,account_id:p.account_id,date:p.date,payee:p.payee,description:p.description,created_at:p.created_at})),l=(t.expenses||[]).map(p=>({id:p.id,amount:p.amount,category_id:p.category_id,account_id:p.account_id,date:p.date,payee:p.payee,description:p.description,created_at:p.created_at})),c=(t.allocations||[]).map(p=>({category_id:p.category_id,amount:p.amount})),d=(t.category_balances||[]).map(p=>({category_id:p.category_id,start_balance:p.start_balance,allocated:p.allocated,spent:p.spent,end_balance:p.end_balance}));let f;return t.previous_month_snapshot&&(f={total_income:t.previous_month_snapshot.total_income??0,account_balances_end:t.previous_month_snapshot.account_balances_end??{},category_balances_end:t.previous_month_snapshot.category_balances_end??{},snapshot_taken_at:t.previous_month_snapshot.snapshot_taken_at}),{budget_id:e,year:n,month:i,income:a,total_income:t.total_income??a.reduce((p,_)=>p+_.amount,0),expenses:l,total_expenses:t.total_expenses??l.reduce((p,_)=>p+_.amount,0),allocations:c,allocations_finalized:t.allocations_finalized||!1,account_balances_start:t.account_balances_start,account_balances_end:t.account_balances_end,category_balances:d,category_balances_stale:t.category_balances_stale??!1,previous_month_snapshot:f,previous_month_snapshot_stale:t.previous_month_snapshot_stale??!1,created_at:t.created_at,updated_at:t.updated_at||t.created_at}}function Zw(t,e){let n=t,i=e-1;return i<1&&(i=12,n-=1),{prevYear:n,prevMonth:i}}function xg(t){const e={};return t.category_balances&&t.category_balances.forEach(n=>{e[n.category_id]=n.end_balance}),{total_income:t.total_income??0,account_balances_end:t.account_balances_end??{},category_balances_end:e,snapshot_taken_at:new Date().toISOString()}}async function N5(t,e,n){const i=Tt(t,e,n),{exists:a,data:l}=await Ce("months",i,"loading month document (cache miss or stale)");if(a&&l){const d=hf(l,t,e,n);return d.previous_month_snapshot_stale===!0||d.previous_month_snapshot===void 0&&n!==1?await P5(t,e,n,d):d}return await V5(t,e,n)}async function P5(t,e,n,i){const{prevYear:a,prevMonth:l}=Zw(e,n),c=Tt(t,e,n);let d=null;const f=Ne.getQueryData(ne.month(t,a,l));if(f)d=f.month;else{const b=Tt(t,a,l),{exists:T,data:S}=await Ce("months",b,"fetching previous month to rebuild stale snapshot (not in cache)");T&&S&&(d=hf(S,t,a,l),Ne.setQueryData(ne.month(t,a,l),{month:d}))}const p=d?xg(d):{total_income:0,account_balances_end:{},category_balances_end:{},snapshot_taken_at:new Date().toISOString()},_={...i,previous_month_snapshot:p,previous_month_snapshot_stale:!1,updated_at:new Date().toISOString()},v={budget_id:_.budget_id,year:_.year,month:_.month,income:_.income??[],total_income:_.total_income??0,expenses:_.expenses??[],total_expenses:_.total_expenses??0,allocations:_.allocations??[],allocations_finalized:_.allocations_finalized??!1,category_balances:_.category_balances??[],previous_month_snapshot:p,previous_month_snapshot_stale:!1,created_at:_.created_at??new Date().toISOString(),updated_at:_.updated_at};return _.account_balances_start!==void 0&&(v.account_balances_start=_.account_balances_start),_.account_balances_end!==void 0&&(v.account_balances_end=_.account_balances_end),await Ze("months",c,v,"saving month with fresh snapshot rebuilt from previous month"),_}async function V5(t,e,n){const i=new Date().toISOString(),a=Tt(t,e,n);let l;if(n>1||e>new Date().getFullYear()-10){const{prevYear:f,prevMonth:p}=Zw(e,n),_=Ne.getQueryData(ne.month(t,f,p));if(_)l=xg(_.month);else{const v=Tt(t,f,p),{exists:b,data:T}=await Ce("months",v,"fetching previous month to create snapshot for new month (not in cache)");if(b&&T){const S=hf(T,t,f,p);l=xg(S),Ne.setQueryData(ne.month(t,f,p),{month:S})}}}const c={budget_id:t,year:e,month:n,income:[],total_income:0,expenses:[],total_expenses:0,allocations:[],allocations_finalized:!1,category_balances:[],previous_month_snapshot:l,previous_month_snapshot_stale:!1,created_at:i,updated_at:i},d={budget_id:t,year:e,month:n,income:[],total_income:0,expenses:[],total_expenses:0,allocations:[],allocations_finalized:!1,category_balances:[],previous_month_snapshot_stale:!1,created_at:i,updated_at:i};return l&&(d.previous_month_snapshot=l),await Ze("months",a,d,"creating new month document (first time viewing this month)"),c}function L5(t,e,n,i){return ll({queryKey:t?ne.month(t,e,n):["month","none"],queryFn:async()=>({month:await N5(t,e,n)}),enabled:!!t&&i?.enabled!==!1})}async function B5(t){const{exists:e,data:n}=await Ce("payees",t,"loading payees for autocomplete (cache miss or stale)");return e&&n?n.payees||[]:[]}function z5(t,e){return ll({queryKey:t?ne.payees(t):["payees","none"],queryFn:()=>B5(t),enabled:!!t&&e?.enabled!==!1})}async function U5(t,e){const{exists:n,data:i}=await Ce("users",t,"loading user profile (cache miss or stale)");if(n&&i)return i;const a={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await Ze("users",t,a,"creating new user document (first login)"),a}function F5(t,e,n){return ll({queryKey:t?ne.user(t):["user","none"],queryFn:()=>U5(t,e),enabled:!!t&&n?.enabled!==!1})}async function q5(t,e){const n=await oi("budgets","loading budgets user has access to (cache miss or stale)",[{field:"user_ids",op:"array-contains",value:t}]),i=[],a=[];for(const l of n.docs){const c=l.data;c.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(l.id)?i.push({id:l.id,name:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null,isOwner:c.owner_id===t,isPending:!1}):a.push({budgetId:l.id,budgetName:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null})}return{budgets:i,pendingInvites:a}}function Q5(t,e,n){return ll({queryKey:t?ne.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?q5(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}function G5(t){if(Array.isArray(t))return t;if(t&&typeof t=="object"&&!Array.isArray(t)){const e=t;if(e._methodName==="arrayUnion"&&Array.isArray(e.vc))return console.warn("[useFeedbackQuery] Found corrupted arrayUnion in feedback document - extracting items from vc"),e.vc}return[]}async function H5(){const t=await oi("feedback","admin loading all feedback (cache miss or stale)"),e=[];for(const n of t.docs){const i=G5(n.data.items),a=n.data.user_email||n.id;i.forEach(l=>{e.push({...l,doc_id:n.id,user_email:a})})}return{items:e}}function $5(t){return ll({queryKey:ne.feedback(),queryFn:H5,enabled:t?.enabled!==!1})}function K5(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order},i.expected_balance!==void 0&&(e[n].expected_balance=i.expected_balance),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function Y5(){const t=fi(),e=pt({mutationFn:async({budgetId:a,accounts:l})=>{const{exists:c,data:d}=await Ce("budgets",a,"PRE-EDIT-READ");if(!c||!d)throw new Error("Budget not found");const f=Eg(l);return await Ze("budgets",a,{...d,accounts:f},"saving updated accounts (user edited account settings)"),l},onMutate:async({budgetId:a,accounts:l})=>{await t.cancelQueries({queryKey:ne.budget(a)});const c=t.getQueryData(ne.budget(a));return c&&t.setQueryData(ne.budget(a),{...c,accounts:l}),{previousData:c}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(ne.budget(l));c&&t.setQueryData(ne.budget(l),{...c,accounts:a})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(ne.budget(l),c.previousData)}}),n=pt({mutationFn:async({budgetId:a,accountGroups:l})=>{const{exists:c,data:d}=await Ce("budgets",a,"PRE-EDIT-READ");if(!c||!d)throw new Error("Budget not found");const f=K5(l);return await Ze("budgets",a,{...d,account_groups:f},"saving updated account groups (user edited group settings)"),l},onMutate:async({budgetId:a,accountGroups:l})=>{await t.cancelQueries({queryKey:ne.budget(a)});const c=t.getQueryData(ne.budget(a));return c&&t.setQueryData(ne.budget(a),{...c,accountGroups:l}),{previousData:c}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(ne.budget(l));c&&t.setQueryData(ne.budget(l),{...c,accountGroups:a})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(ne.budget(l),c.previousData)}}),i=pt({mutationFn:async({budgetId:a,accountId:l,delta:c})=>{const{exists:d,data:f}=await Ce("budgets",a,"PRE-EDIT-READ");if(!d||!f)throw new Error("Budget not found");const p=f.accounts||{};if(!p[l])throw new Error("Account not found");const _={...p,[l]:{...p[l],balance:p[l].balance+c}};return await Ze("budgets",a,{...f,accounts:Eg(_)},"saving updated account balance"),_},onMutate:async({budgetId:a,accountId:l,delta:c})=>{await t.cancelQueries({queryKey:ne.budget(a)});const d=t.getQueryData(ne.budget(a));if(d&&d.accounts[l]){const f={...d.accounts,[l]:{...d.accounts[l],balance:d.accounts[l].balance+c}};t.setQueryData(ne.budget(a),{...d,accounts:f})}return{previousData:d}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(ne.budget(l));c&&t.setQueryData(ne.budget(l),{...c,accounts:a})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(ne.budget(l),c.previousData)}});return{updateAccounts:e,updateAccountGroups:n,updateAccountBalance:i}}function XE(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,category_group_id:i.category_group_id??null,sort_order:i.sort_order,balance:i.balance??0},i.description!==void 0&&(e[n].description=i.description),i.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=i.default_monthly_amount),i.default_monthly_type!==void 0&&(e[n].default_monthly_type=i.default_monthly_type)}),e}function W5(){const t=fi(),e=pt({mutationFn:async({budgetId:l,categories:c})=>{const{exists:d,data:f}=await Ce("budgets",l,"PRE-EDIT-READ");if(!d||!f)throw new Error("Budget not found");const p=XE(c);return await Ze("budgets",l,{...f,categories:p},"saving updated categories (user edited category settings)"),c},onMutate:async({budgetId:l,categories:c})=>{await t.cancelQueries({queryKey:ne.budget(l)});const d=t.getQueryData(ne.budget(l));return d&&t.setQueryData(ne.budget(l),{...d,categories:c}),{previousData:d}},onSuccess:(l,{budgetId:c})=>{const d=t.getQueryData(ne.budget(c));d&&t.setQueryData(ne.budget(c),{...d,categories:l})},onError:(l,{budgetId:c},d)=>{d?.previousData&&t.setQueryData(ne.budget(c),d.previousData)}}),n=pt({mutationFn:async({budgetId:l,categoryGroups:c})=>{const{exists:d,data:f}=await Ce("budgets",l,"PRE-EDIT-READ");if(!d||!f)throw new Error("Budget not found");return await Ze("budgets",l,{...f,category_groups:c},"saving updated category groups (user edited group settings)"),c},onMutate:async({budgetId:l,categoryGroups:c})=>{await t.cancelQueries({queryKey:ne.budget(l)});const d=t.getQueryData(ne.budget(l));return d&&t.setQueryData(ne.budget(l),{...d,categoryGroups:c}),{previousData:d}},onSuccess:(l,{budgetId:c})=>{const d=t.getQueryData(ne.budget(c));d&&t.setQueryData(ne.budget(c),{...d,categoryGroups:l})},onError:(l,{budgetId:c},d)=>{d?.previousData&&t.setQueryData(ne.budget(c),d.previousData)}}),i=pt({mutationFn:async({budgetId:l,balances:c,year:d,month:f})=>{const p={computed_at:new Date().toISOString(),computed_for_year:d,computed_for_month:f,is_stale:!1,balances:c},{exists:_,data:v}=await Ce("budgets",l,"PRE-EDIT-READ");if(!_||!v)throw new Error("Budget not found");return await Ze("budgets",l,{...v,category_balances_snapshot:p},"saving category balances snapshot (caching computed balances)"),p},onMutate:async({budgetId:l,balances:c,year:d,month:f})=>{await t.cancelQueries({queryKey:ne.budget(l)});const p=t.getQueryData(ne.budget(l)),_={computed_at:new Date().toISOString(),computed_for_year:d,computed_for_month:f,is_stale:!1,balances:c};return p&&t.setQueryData(ne.budget(l),{...p,categoryBalancesSnapshot:_}),{previousData:p}},onSuccess:(l,{budgetId:c})=>{const d=t.getQueryData(ne.budget(c));d&&t.setQueryData(ne.budget(c),{...d,categoryBalancesSnapshot:l})},onError:(l,{budgetId:c},d)=>{d?.previousData&&t.setQueryData(ne.budget(c),d.previousData)}}),a=pt({mutationFn:async({budgetId:l,categories:c,balances:d,year:f,month:p})=>{const _={computed_at:new Date().toISOString(),computed_for_year:f,computed_for_month:p,is_stale:!1,balances:d},{exists:v,data:b}=await Ce("budgets",l,"PRE-EDIT-READ");if(!v||!b)throw new Error("Budget not found");return await Ze("budgets",l,{...b,categories:XE(c),category_balances_snapshot:_},"saving recalculated category balances and snapshot (user triggered recalculation)"),{categories:c,snapshot:_}},onMutate:async({budgetId:l,categories:c,balances:d,year:f,month:p})=>{await t.cancelQueries({queryKey:ne.budget(l)});const _=t.getQueryData(ne.budget(l)),v={computed_at:new Date().toISOString(),computed_for_year:f,computed_for_month:p,is_stale:!1,balances:d};return _&&t.setQueryData(ne.budget(l),{..._,categories:c,categoryBalancesSnapshot:v}),{previousData:_}},onSuccess:({categories:l,snapshot:c},{budgetId:d})=>{const f=t.getQueryData(ne.budget(d));f&&t.setQueryData(ne.budget(d),{...f,categories:l,categoryBalancesSnapshot:c})},onError:(l,{budgetId:c},d)=>{d?.previousData&&t.setQueryData(ne.budget(c),d.previousData)}});return{updateCategories:e,updateCategoryGroups:n,saveCategoryBalancesSnapshot:i,recalculateCategoryBalances:a}}function X5(){const t=fi(),e=Y5(),n=W5(),i=pt({mutationFn:async({budgetId:a,newName:l})=>{const{exists:c,data:d}=await Ce("budgets",a,"PRE-EDIT-READ");if(!c||!d)throw new Error("Budget not found");return await Ze("budgets",a,{...d,name:l.trim()},`renaming budget to "${l.trim()}"`),l.trim()},onMutate:async({budgetId:a,newName:l})=>{await t.cancelQueries({queryKey:ne.budget(a)});const c=t.getQueryData(ne.budget(a));return c&&t.setQueryData(ne.budget(a),{...c,budget:{...c.budget,name:l.trim()}}),{previousData:c}},onSuccess:(a,{budgetId:l})=>{const c=t.getQueryData(ne.budget(l));c&&t.setQueryData(ne.budget(l),{...c,budget:{...c.budget,name:a}})},onError:(a,{budgetId:l},c)=>{c?.previousData&&t.setQueryData(ne.budget(l),c.previousData)}});return{updateAccounts:e.updateAccounts,updateAccountGroups:e.updateAccountGroups,updateAccountBalance:e.updateAccountBalance,updateCategories:n.updateCategories,updateCategoryGroups:n.updateCategoryGroups,saveCategoryBalancesSnapshot:n.saveCategoryBalancesSnapshot,recalculateCategoryBalances:n.recalculateCategoryBalances,renameBudget:i}}function Np(t){const e=ne.budget(t),n=Ne.getQueryData(e);n?.categoryBalancesSnapshot&&!n.categoryBalancesSnapshot.is_stale&&Ne.setQueryData(e,{...n,categoryBalancesSnapshot:{...n.categoryBalancesSnapshot,is_stale:!0}})}async function zo(t){try{const e=ne.budget(t),n=Ne.getQueryData(e);if(n?.categoryBalancesSnapshot?.is_stale)return;const{exists:i,data:a}=await Ce("budgets",t,"checking if budget category snapshot needs stale flag");i&&a&&a.category_balances_snapshot&&!a.category_balances_snapshot.is_stale&&(await Ze("budgets",t,{...a,category_balances_snapshot:{...a.category_balances_snapshot,is_stale:!0}},"marking budget category balances snapshot as stale (expense or allocation changed)"),n&&Ne.setQueryData(e,{...n,categoryBalancesSnapshot:n.categoryBalancesSnapshot?{...n.categoryBalancesSnapshot,is_stale:!0}:null}))}catch(e){console.error("Error marking category balances snapshot stale in Firestore:",e)}}function Uo(t,e,n){const i=ne.month(t,e,n),a=Ne.getQueryData(i);a?.month&&!a.month.category_balances_stale&&Ne.setQueryData(i,{...a,month:{...a.month,category_balances_stale:!0}})}async function Pp(t,e,n){const i=ne.month(t,e,n),a=Tt(t,e,n);try{const l=await Ne.fetchQuery({queryKey:i,queryFn:async()=>{const{exists:c,data:d}=await Ce("months",a,`checking if ${e}/${n} category balances need stale flag`);if(!c||!d)throw new Error("MONTH_NOT_EXISTS");return{month:d}}});if(l.month.category_balances_stale)return;await Ze("months",a,{...l.month,category_balances_stale:!0},`marking ${e}/${n} category balances as stale`),Ne.setQueryData(i,{month:{...l.month,category_balances_stale:!0}})}catch(l){if(l instanceof Error&&l.message==="MONTH_NOT_EXISTS")return;console.error("Error marking month category balances stale in Firestore:",l)}}function Fo(t,e,n){const a=Ne.getQueryCache().findAll({predicate:l=>{const c=l.queryKey;return c[0]==="month"&&c[1]===t}});for(const l of a){const c=l.queryKey,d=c[2],f=c[3];if(d>e||d===e&&f>n){const _=Ne.getQueryData(c);_?.month&&!_.month.category_balances_stale&&Ne.setQueryData(c,{..._,month:{..._.month,category_balances_stale:!0}})}}}async function qo(t,e,n){try{const a=Ne.getQueryCache().findAll({predicate:f=>{const p=f.queryKey;return p[0]==="month"&&p[1]===t}});let l=!1,c=!1;for(const f of a){const p=f.queryKey,_=p[2],v=p[3];if(_>e||_===e&&v>n){c=!0;const T=Ne.getQueryData(p);if(T?.month&&!T.month.category_balances_stale){l=!0;break}}}if(c&&!l)return;const d=await oi("months",`finding months >= ${e} to mark category balances stale`,[{field:"budget_id",op:"==",value:t},{field:"year",op:">=",value:e}]);for(const f of d.docs){const p=f.data.year,_=f.data.month;if((p>e||p===e&&_>n)&&!f.data.category_balances_stale){await Ze("months",f.id,{...f.data,budget_id:t,category_balances_stale:!0},`marking ${p}/${_} category balances as stale (earlier month was edited)`);const b=ne.month(t,p,_),T=Ne.getQueryData(b);T&&Ne.setQueryData(b,{month:{...T.month,category_balances_stale:!0}})}}}catch(i){console.error("Error marking future months category balances stale in Firestore:",i)}}async function Cr(t,e,n){const i=Tt(t,e.year,e.month),a={budget_id:e.budget_id,year:e.year,month:e.month,income:S5(e.income),total_income:e.total_income,updated_at:new Date().toISOString()};e.created_at&&(a.created_at=e.created_at),e.expenses&&(a.expenses=T5(e.expenses)),e.total_expenses!==void 0&&(a.total_expenses=e.total_expenses),e.allocations&&(a.allocations=w5(e.allocations)),e.allocations_finalized!==void 0&&(a.allocations_finalized=e.allocations_finalized),e.category_balances&&(a.category_balances=A5(e.category_balances)),e.category_balances_stale!==void 0&&(a.category_balances_stale=e.category_balances_stale),e.account_balances_start&&(a.account_balances_start=e.account_balances_start),e.account_balances_end&&(a.account_balances_end=e.account_balances_end),e.previous_month_snapshot&&(a.previous_month_snapshot=e.previous_month_snapshot),e.previous_month_snapshot_stale!==void 0&&(a.previous_month_snapshot_stale=e.previous_month_snapshot_stale),await Ze("months",i,a,"saveMonthToFirestore: saving month document after mutation"),n?.skipNextMonthStale||await k5(t,e.year,e.month)}async function ni(t,e,n){const{exists:i,data:a}=await Ce("budgets",t,`reading budget to update account balance (delta: ${n})`);if(!i||!a)return null;const l=a.accounts||{};if(!l[e])return null;const c={...l,[e]:{...l[e],balance:l[e].balance+n}};return await Ze("budgets",t,{...a,accounts:Eg(c)},"saving updated account balance after income/expense change"),c}async function Ih(t,e,n){const i=e.trim();if(!i||n.includes(i))return null;const a=[...n,i].sort((l,c)=>l.toLowerCase().localeCompare(c.toLowerCase()));return await Ze("payees",t,{budget_id:t,payees:a,updated_at:new Date().toISOString()},`adding new payee "${i}" to autocomplete list`),a}function Vp(t,e,n,i){const a=t.previous_month_snapshot?.category_balances_end??{},l=t.expenses??[];return e.map(c=>{const d=a[c]??0;let f=0;if(i){const _=n.find(v=>v.category_id===c);_&&(f=_.amount)}const p=l.filter(_=>_.category_id===c).reduce((_,v)=>_+v.amount,0);return{category_id:c,start_balance:d,allocated:f,spent:p,end_balance:d+f-p}})}function J5(){const t=fi(),e=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,amount:f,accountId:p,date:_,payee:v,description:b}=a,T=Tt(l,c,d),{exists:S,data:A}=await Ce("months",T,"PRE-EDIT-READ");if(!S||!A)throw new Error("Month data not found in Firestore");const R={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:f,account_id:p,date:_,created_at:new Date().toISOString()};v?.trim()&&(R.payee=v.trim()),b&&(R.description=b);const z=[...A.income||[],R],F={...A,income:z,total_income:z.reduce((Z,oe)=>Z+oe.amount,0),updated_at:new Date().toISOString()};await Cr(l,F);const U=await ni(l,p,f);let X=null;if(v?.trim()){const{data:Z}=await Ce("payees",l,"checking existing payees to see if new payee should be added"),oe=Z?.payees||[];X=await Ih(l,v,oe)}return{updatedMonth:F,newIncome:R,updatedAccounts:U,updatedPayees:X}},onMutate:async a=>{const{budgetId:l,year:c,month:d,amount:f,accountId:p,date:_,payee:v,description:b}=a,T=ne.month(l,c,d),S=ne.budget(l);await t.cancelQueries({queryKey:T}),await t.cancelQueries({queryKey:S});const A=t.getQueryData(T),R=t.getQueryData(S);if(A){const z={id:`income_optimistic_${Date.now()}`,amount:f,account_id:p,date:_,created_at:new Date().toISOString()};v?.trim()&&(z.payee=v.trim()),b&&(z.description=b);const F=[...A.month.income,z];t.setQueryData(T,{...A,month:{...A.month,income:F,total_income:F.reduce((U,X)=>U+X.amount,0)}})}return R&&R.accounts[p]&&t.setQueryData(S,{...R,accounts:{...R.accounts,[p]:{...R.accounts[p],balance:R.accounts[p].balance+f}}}),Li(l,c,d),{previousMonth:A,previousBudget:R}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ne.month(c,d,f),_=ne.budget(c),v=ne.payees(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const b=t.getQueryData(_);b&&t.setQueryData(_,{...b,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ne.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ne.budget(d),c.previousBudget)}}),n=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,incomeId:f,amount:p,accountId:_,date:v,payee:b,description:T,oldAmount:S,oldAccountId:A}=a,R=Tt(l,c,d),{exists:z,data:F}=await Ce("months",R,"PRE-EDIT-READ");if(!z||!F)throw new Error("Month data not found in Firestore");const U={id:f,amount:p,account_id:_,date:v,created_at:(F.income||[]).find(C=>C.id===f)?.created_at||new Date().toISOString()};b?.trim()&&(U.payee=b.trim()),T&&(U.description=T);const X=(F.income||[]).map(C=>C.id===f?U:C),Z={...F,income:X,total_income:X.reduce((C,D)=>C+D.amount,0),updated_at:new Date().toISOString()};await Cr(l,Z);let oe=null;_!==A?(await ni(l,A,-S),oe=await ni(l,_,p)):p!==S&&(oe=await ni(l,_,p-S));let M=null;if(b?.trim()){const{data:C}=await Ce("payees",l,"checking existing payees to see if new payee should be added"),D=C?.payees||[];M=await Ih(l,b,D)}return{updatedMonth:Z,updatedAccounts:oe,updatedPayees:M}},onMutate:async a=>{const{budgetId:l,year:c,month:d,incomeId:f,amount:p,accountId:_,date:v,payee:b,description:T,oldAmount:S,oldAccountId:A}=a,R=ne.month(l,c,d),z=ne.budget(l);await t.cancelQueries({queryKey:R}),await t.cancelQueries({queryKey:z});const F=t.getQueryData(R),U=t.getQueryData(z);if(F){const X={id:f,amount:p,account_id:_,date:v,created_at:F.month.income.find(oe=>oe.id===f)?.created_at||new Date().toISOString()};b?.trim()&&(X.payee=b.trim()),T&&(X.description=T);const Z=F.month.income.map(oe=>oe.id===f?X:oe);t.setQueryData(R,{...F,month:{...F.month,income:Z,total_income:Z.reduce((oe,M)=>oe+M.amount,0)}})}if(U){const X={...U.accounts};_!==A?(X[A]&&(X[A]={...X[A],balance:X[A].balance-S}),X[_]&&(X[_]={...X[_],balance:X[_].balance+p})):p!==S&&X[_]&&(X[_]={...X[_],balance:X[_].balance+(p-S)}),t.setQueryData(z,{...U,accounts:X})}return Li(l,c,d),{previousMonth:F,previousBudget:U}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ne.month(c,d,f),_=ne.budget(c),v=ne.payees(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const b=t.getQueryData(_);b&&t.setQueryData(_,{...b,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ne.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ne.budget(d),c.previousBudget)}}),i=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,incomeId:f,amount:p,accountId:_}=a,v=Tt(l,c,d),{exists:b,data:T}=await Ce("months",v,"PRE-EDIT-READ");if(!b||!T)throw new Error("Month data not found in Firestore");const S=(T.income||[]).filter(z=>z.id!==f),A={...T,income:S,total_income:S.reduce((z,F)=>z+F.amount,0),updated_at:new Date().toISOString()};await Cr(l,A);const R=await ni(l,_,-p);return{updatedMonth:A,updatedAccounts:R}},onMutate:async a=>{const{budgetId:l,year:c,month:d,incomeId:f,amount:p,accountId:_}=a,v=ne.month(l,c,d),b=ne.budget(l);await t.cancelQueries({queryKey:v}),await t.cancelQueries({queryKey:b});const T=t.getQueryData(v),S=t.getQueryData(b);if(T){const A=T.month.income.filter(R=>R.id!==f);t.setQueryData(v,{...T,month:{...T.month,income:A,total_income:A.reduce((R,z)=>R+z.amount,0)}})}return S&&S.accounts[_]&&t.setQueryData(b,{...S,accounts:{...S.accounts,[_]:{...S.accounts[_],balance:S.accounts[_].balance-p}}}),Li(l,c,d),{previousMonth:T,previousBudget:S}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ne.month(c,d,f),_=ne.budget(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const v=t.getQueryData(_);v&&t.setQueryData(_,{...v,accounts:a.updatedAccounts})}},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ne.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ne.budget(d),c.previousBudget)}});return{addIncome:e,updateIncome:n,deleteIncome:i}}function Z5(){const t=fi(),e=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,amount:f,categoryId:p,accountId:_,date:v,payee:b,description:T}=a,S=Tt(l,c,d),{exists:A,data:R}=await Ce("months",S,"PRE-EDIT-READ");if(!A||!R)throw new Error("Month data not found in Firestore");const z={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:f,category_id:p,account_id:_,date:v,created_at:new Date().toISOString()};b?.trim()&&(z.payee=b.trim()),T&&(z.description=T);const F=[...R.expenses||[],z],U={...R,expenses:F,total_expenses:F.reduce((oe,M)=>oe+M.amount,0),updated_at:new Date().toISOString()};await Cr(l,U);const X=await ni(l,_,-f);let Z=null;if(b?.trim()){const{data:oe}=await Ce("payees",l,"checking existing payees to see if new payee should be added"),M=oe?.payees||[];Z=await Ih(l,b,M)}return await zo(l),await Pp(l,c,d),await qo(l,c,d),{updatedMonth:U,newExpense:z,updatedAccounts:X,updatedPayees:Z}},onMutate:async a=>{const{budgetId:l,year:c,month:d,amount:f,categoryId:p,accountId:_,date:v,payee:b,description:T}=a,S=ne.month(l,c,d),A=ne.budget(l);await t.cancelQueries({queryKey:S}),await t.cancelQueries({queryKey:A});const R=t.getQueryData(S),z=t.getQueryData(A);if(R){const F={id:`expense_optimistic_${Date.now()}`,amount:f,category_id:p,account_id:_,date:v,created_at:new Date().toISOString()};b?.trim()&&(F.payee=b.trim()),T&&(F.description=T);const U=[...R.month.expenses||[],F];t.setQueryData(S,{...R,month:{...R.month,expenses:U,total_expenses:U.reduce((X,Z)=>X+Z.amount,0)}})}return z&&z.accounts[_]&&t.setQueryData(A,{...z,accounts:{...z.accounts,[_]:{...z.accounts[_],balance:z.accounts[_].balance-f}}}),Li(l,c,d),Np(l),Uo(l,c,d),Fo(l,c,d),{previousMonth:R,previousBudget:z}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ne.month(c,d,f),_=ne.budget(c),v=ne.payees(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const b=t.getQueryData(_);b&&t.setQueryData(_,{...b,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ne.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ne.budget(d),c.previousBudget)}}),n=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,expenseId:f,amount:p,categoryId:_,accountId:v,date:b,payee:T,description:S,oldAmount:A,oldAccountId:R}=a,z=Tt(l,c,d),{exists:F,data:U}=await Ce("months",z,"PRE-EDIT-READ");if(!F||!U)throw new Error("Month data not found in Firestore");const X={id:f,amount:p,category_id:_,account_id:v,date:b,created_at:U.expenses?.find(D=>D.id===f)?.created_at||new Date().toISOString()};T?.trim()&&(X.payee=T.trim()),S&&(X.description=S);const Z=(U.expenses||[]).map(D=>D.id===f?X:D),oe={...U,expenses:Z,total_expenses:Z.reduce((D,N)=>D+N.amount,0),updated_at:new Date().toISOString()};await Cr(l,oe);let M=null;v!==R?(await ni(l,R,A),M=await ni(l,v,-p)):p!==A&&(M=await ni(l,v,A-p));let C=null;if(T?.trim()){const{data:D}=await Ce("payees",l,"checking existing payees to see if new payee should be added"),N=D?.payees||[];C=await Ih(l,T,N)}return await zo(l),await Pp(l,c,d),await qo(l,c,d),{updatedMonth:oe,updatedAccounts:M,updatedPayees:C}},onMutate:async a=>{const{budgetId:l,year:c,month:d,expenseId:f,amount:p,categoryId:_,accountId:v,date:b,payee:T,description:S,oldAmount:A,oldAccountId:R}=a,z=ne.month(l,c,d),F=ne.budget(l);await t.cancelQueries({queryKey:z}),await t.cancelQueries({queryKey:F});const U=t.getQueryData(z),X=t.getQueryData(F);if(U){const Z={id:f,amount:p,category_id:_,account_id:v,date:b,created_at:U.month.expenses?.find(M=>M.id===f)?.created_at||new Date().toISOString()};T?.trim()&&(Z.payee=T.trim()),S&&(Z.description=S);const oe=(U.month.expenses||[]).map(M=>M.id===f?Z:M);t.setQueryData(z,{...U,month:{...U.month,expenses:oe,total_expenses:oe.reduce((M,C)=>M+C.amount,0)}})}if(X){const Z={...X.accounts};v!==R?(Z[R]&&(Z[R]={...Z[R],balance:Z[R].balance+A}),Z[v]&&(Z[v]={...Z[v],balance:Z[v].balance-p})):p!==A&&Z[v]&&(Z[v]={...Z[v],balance:Z[v].balance+(A-p)}),t.setQueryData(F,{...X,accounts:Z})}return Li(l,c,d),Np(l),Uo(l,c,d),Fo(l,c,d),{previousMonth:U,previousBudget:X}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ne.month(c,d,f),_=ne.budget(c),v=ne.payees(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const b=t.getQueryData(_);b&&t.setQueryData(_,{...b,accounts:a.updatedAccounts})}a.updatedPayees&&t.setQueryData(v,a.updatedPayees)},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ne.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ne.budget(d),c.previousBudget)}}),i=pt({mutationFn:async a=>{const{budgetId:l,year:c,month:d,expenseId:f,amount:p,accountId:_}=a,v=Tt(l,c,d),{exists:b,data:T}=await Ce("months",v,"PRE-EDIT-READ");if(!b||!T)throw new Error("Month data not found in Firestore");const S=(T.expenses||[]).filter(z=>z.id!==f),A={...T,expenses:S,total_expenses:S.reduce((z,F)=>z+F.amount,0),updated_at:new Date().toISOString()};await Cr(l,A);const R=await ni(l,_,p);return await zo(l),await Pp(l,c,d),await qo(l,c,d),{updatedMonth:A,updatedAccounts:R}},onMutate:async a=>{const{budgetId:l,year:c,month:d,expenseId:f,amount:p,accountId:_}=a,v=ne.month(l,c,d),b=ne.budget(l);await t.cancelQueries({queryKey:v}),await t.cancelQueries({queryKey:b});const T=t.getQueryData(v),S=t.getQueryData(b);if(T){const A=(T.month.expenses||[]).filter(R=>R.id!==f);t.setQueryData(v,{...T,month:{...T.month,expenses:A,total_expenses:A.reduce((R,z)=>R+z.amount,0)}})}return S&&S.accounts[_]&&t.setQueryData(b,{...S,accounts:{...S.accounts,[_]:{...S.accounts[_],balance:S.accounts[_].balance+p}}}),Li(l,c,d),Np(l),Uo(l,c,d),Fo(l,c,d),{previousMonth:T,previousBudget:S}},onSuccess:(a,l)=>{const{budgetId:c,year:d,month:f}=l,p=ne.month(c,d,f),_=ne.budget(c);if(t.setQueryData(p,{month:a.updatedMonth}),a.updatedAccounts){const v=t.getQueryData(_);v&&t.setQueryData(_,{...v,accounts:a.updatedAccounts})}},onError:(a,l,c)=>{const{budgetId:d,year:f,month:p}=l;c?.previousMonth&&t.setQueryData(ne.month(d,f,p),c.previousMonth),c?.previousBudget&&t.setQueryData(ne.budget(d),c.previousBudget)}});return{addExpense:e,updateExpense:n,deleteExpense:i}}function eM(){const t=fi(),e=pt({mutationFn:async l=>{const{budgetId:c,year:d,month:f,allocations:p}=l,_=Tt(c,d,f),{exists:v,data:b}=await Ce("months",_,"PRE-EDIT-READ");if(!v||!b)throw new Error("Month data not found in Firestore");const T={...b,allocations:p,updated_at:new Date().toISOString()};return await Cr(c,T,{skipNextMonthStale:!0}),{updatedMonth:T}},onMutate:async l=>{const{budgetId:c,year:d,month:f,allocations:p}=l,_=ne.month(c,d,f);await t.cancelQueries({queryKey:_});const v=t.getQueryData(_);return v&&t.setQueryData(_,{...v,month:{...v.month,allocations:p}}),{previousMonth:v}},onSuccess:(l,c)=>{const{budgetId:d,year:f,month:p}=c;t.setQueryData(ne.month(d,f,p),{month:l.updatedMonth})},onError:(l,c,d)=>{d?.previousMonth&&t.setQueryData(ne.month(c.budgetId,c.year,c.month),d.previousMonth)}}),n=pt({mutationFn:async l=>{const{budgetId:c,year:d,month:f,allocations:p}=l,_=Tt(c,d,f),{exists:v,data:b}=await Ce("months",_,"PRE-EDIT-READ");if(!v||!b)throw new Error("Month data not found in Firestore");const T=b.category_balances?.map(R=>R.category_id)??Object.keys(b.previous_month_snapshot?.category_balances_end??{}),S=T.length>0?Vp(b,T,p,!0):b.category_balances,A={...b,allocations:p,allocations_finalized:!0,category_balances:S,category_balances_stale:!1,updated_at:new Date().toISOString()};return await Cr(c,A),await zo(c),await qo(c,d,f),{updatedMonth:A}},onMutate:async l=>{const{budgetId:c,year:d,month:f,allocations:p}=l,_=ne.month(c,d,f),v=ne.budget(c);await t.cancelQueries({queryKey:_}),await t.cancelQueries({queryKey:v});const b=t.getQueryData(_),T=t.getQueryData(v);if(b&&t.setQueryData(_,{...b,month:{...b.month,allocations:p,allocations_finalized:!0}}),T){const S=b?.month?.allocations_finalized?b.month.allocations||[]:[],A={};for(const z of p)A[z.category_id]=(A[z.category_id]||0)+z.amount;for(const z of S)A[z.category_id]=(A[z.category_id]||0)-z.amount;const R={};Object.entries(T.categories).forEach(([z,F])=>{R[z]={...F,balance:F.balance+(A[z]||0)}}),t.setQueryData(v,{...T,categories:R,categoryBalancesSnapshot:T.categoryBalancesSnapshot?{...T.categoryBalancesSnapshot,is_stale:!0}:null})}return Li(c,d,f),Uo(c,d,f),Fo(c,d,f),{previousMonth:b,previousBudget:T}},onSuccess:(l,c)=>{const{budgetId:d,year:f,month:p}=c,_=ne.month(d,f,p);t.setQueryData(_,{month:l.updatedMonth})},onError:(l,c,d)=>{d?.previousMonth&&t.setQueryData(ne.month(c.budgetId,c.year,c.month),d.previousMonth),d?.previousBudget&&t.setQueryData(ne.budget(c.budgetId),d.previousBudget)}}),i=pt({mutationFn:async l=>{const{budgetId:c,year:d,month:f}=l,p=Tt(c,d,f),{exists:_,data:v}=await Ce("months",p,"PRE-EDIT-READ");if(!_||!v)throw new Error("Month data not found in Firestore");const b=v.category_balances?.map(A=>A.category_id)??Object.keys(v.previous_month_snapshot?.category_balances_end??{}),T=b.length>0?Vp(v,b,v.allocations??[],!1):v.category_balances,S={...v,allocations_finalized:!1,category_balances:T,category_balances_stale:!1,updated_at:new Date().toISOString()};return await Cr(c,S),await zo(c),await qo(c,d,f),{updatedMonth:S}},onMutate:async l=>{const{budgetId:c,year:d,month:f}=l,p=ne.month(c,d,f),_=ne.budget(c);await t.cancelQueries({queryKey:p}),await t.cancelQueries({queryKey:_});const v=t.getQueryData(p),b=t.getQueryData(_);if(v&&t.setQueryData(p,{...v,month:{...v.month,allocations_finalized:!1}}),b&&v?.month?.allocations_finalized){const T=v.month.allocations||[],S={};for(const R of T)S[R.category_id]=(S[R.category_id]||0)-R.amount;const A={};Object.entries(b.categories).forEach(([R,z])=>{A[R]={...z,balance:z.balance+(S[R]||0)}}),t.setQueryData(_,{...b,categories:A,categoryBalancesSnapshot:b.categoryBalancesSnapshot?{...b.categoryBalancesSnapshot,is_stale:!0}:null})}return Li(c,d,f),Uo(c,d,f),Fo(c,d,f),{previousMonth:v,previousBudget:b}},onSuccess:(l,c)=>{const{budgetId:d,year:f,month:p}=c;t.setQueryData(ne.month(d,f,p),{month:l.updatedMonth})},onError:(l,c,d)=>{d?.previousMonth&&t.setQueryData(ne.month(c.budgetId,c.year,c.month),d.previousMonth),d?.previousBudget&&t.setQueryData(ne.budget(c.budgetId),d.previousBudget)}}),a=pt({mutationFn:async l=>{const{budgetId:c,year:d,month:f}=l,p=Tt(c,d,f),{exists:_,data:v}=await Ce("months",p,"PRE-EDIT-READ");if(!_||!v)throw new Error("Month data not found in Firestore");const b=v.category_balances?.map(A=>A.category_id)??Object.keys(v.previous_month_snapshot?.category_balances_end??{}),T=b.length>0?Vp(v,b,[],!1):v.category_balances,S={...v,allocations:[],allocations_finalized:!1,category_balances:T,category_balances_stale:!1,updated_at:new Date().toISOString()};return await Cr(c,S),await zo(c),await qo(c,d,f),{updatedMonth:S}},onMutate:async l=>{const{budgetId:c,year:d,month:f}=l,p=ne.month(c,d,f),_=ne.budget(c);await t.cancelQueries({queryKey:p}),await t.cancelQueries({queryKey:_});const v=t.getQueryData(p),b=t.getQueryData(_);if(v&&t.setQueryData(p,{...v,month:{...v.month,allocations:[],allocations_finalized:!1}}),b&&v?.month?.allocations_finalized){const T=v.month.allocations||[],S={};for(const R of T)S[R.category_id]=(S[R.category_id]||0)-R.amount;const A={};Object.entries(b.categories).forEach(([R,z])=>{A[R]={...z,balance:z.balance+(S[R]||0)}}),t.setQueryData(_,{...b,categories:A,categoryBalancesSnapshot:b.categoryBalancesSnapshot?{...b.categoryBalancesSnapshot,is_stale:!0}:null})}return Li(c,d,f),Uo(c,d,f),Fo(c,d,f),{previousMonth:v,previousBudget:b}},onSuccess:(l,c)=>{const{budgetId:d,year:f,month:p}=c;t.setQueryData(ne.month(d,f,p),{month:l.updatedMonth})},onError:(l,c,d)=>{d?.previousMonth&&t.setQueryData(ne.month(c.budgetId,c.year,c.month),d.previousMonth),d?.previousBudget&&t.setQueryData(ne.budget(c.budgetId),d.previousBudget)}});return{saveAllocations:e,finalizeAllocations:n,unfinalizeAllocations:i,deleteAllocations:a}}function tM(){const{addIncome:t,updateIncome:e,deleteIncome:n}=J5(),{addExpense:i,updateExpense:a,deleteExpense:l}=Z5(),{saveAllocations:c,finalizeAllocations:d,unfinalizeAllocations:f,deleteAllocations:p}=eM();return{addIncome:t,updateIncome:e,deleteIncome:n,addExpense:i,updateExpense:a,deleteExpense:l,saveAllocations:c,finalizeAllocations:d,unfinalizeAllocations:f,deleteAllocations:p}}function nM(){const t=fi(),e=pt({mutationFn:async({name:d,userId:f,userEmail:p})=>{const _=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,v=new Date().toISOString(),b={name:d.trim()||"My Budget",user_ids:[f],accepted_user_ids:[f],owner_id:f,owner_email:p,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:v,updated_at:v};await Ze("budgets",_,b,"creating new budget document");const{exists:T,data:S}=await Ce("users",f,"reading user document to add new budget to their list");return T&&S?await Ze("users",f,{...S,budget_ids:[_,...S.budget_ids],updated_at:v},"adding new budget to user's budget list"):await Ze("users",f,{uid:f,email:p,budget_ids:[_],created_at:v,updated_at:v},"creating new user document with first budget"),{budgetId:_,budget:{id:_,...b}}},onSuccess:(d,{userId:f})=>{t.invalidateQueries({queryKey:ne.user(f)}),t.invalidateQueries({queryKey:ne.accessibleBudgets(f)})}}),n=pt({mutationFn:async({budgetId:d,userId:f})=>{const p=new Date().toISOString(),{exists:_,data:v}=await Ce("budgets",d,"verifying user was invited to this budget");if(!_||!v)throw new Error("Budget not found");if(!v.user_ids?.includes(f))throw new Error("You have not been invited to this budget");const{data:b}=await Ce("users",f,"PRE-EDIT-READ");if(b?.budget_ids?.includes(d))throw new Error("You have already accepted this invite");return await Ze("users",f,{...b||{uid:f,email:null},budget_ids:[d,...b?.budget_ids||[]],updated_at:p},"adding accepted budget to user's budget list"),await Ze("budgets",d,{...v,accepted_user_ids:[...v.accepted_user_ids||[],f]},"marking user as accepted in budget's accepted_user_ids"),{budgetId:d}},onSuccess:(d,{userId:f})=>{t.invalidateQueries({queryKey:ne.user(f)}),t.invalidateQueries({queryKey:ne.accessibleBudgets(f)}),t.invalidateQueries({queryKey:ne.budget(d.budgetId)})}}),i=pt({mutationFn:async({budgetId:d,userId:f})=>{const{exists:p,data:_}=await Ce("budgets",d,"PRE-EDIT-READ");if(!p||!_)throw new Error("Budget not found");if(_.user_ids?.includes(f))throw new Error("User is already invited");return await Ze("budgets",d,{..._,user_ids:[..._.user_ids||[],f]},"adding user to budget's invited users list"),{budgetId:d}},onMutate:async({budgetId:d,userId:f})=>{await t.cancelQueries({queryKey:ne.budget(d)});const p=t.getQueryData(ne.budget(d));return p&&t.setQueryData(ne.budget(d),{...p,budget:{...p.budget,user_ids:[...p.budget.user_ids,f]}}),{previousData:p}},onSuccess:(d,{budgetId:f})=>{const p=t.getQueryData(ne.budget(f));p&&t.setQueryData(ne.budget(f),p)},onError:(d,{budgetId:f},p)=>{p?.previousData&&t.setQueryData(ne.budget(f),p.previousData)}}),a=pt({mutationFn:async({budgetId:d,userId:f})=>{const{exists:p,data:_}=await Ce("budgets",d,"PRE-EDIT-READ");if(!p||!_)throw new Error("Budget not found");return await Ze("budgets",d,{..._,user_ids:(_.user_ids||[]).filter(v=>v!==f),accepted_user_ids:(_.accepted_user_ids||[]).filter(v=>v!==f)},"removing user from budget's access lists"),{budgetId:d}},onMutate:async({budgetId:d,userId:f})=>{await t.cancelQueries({queryKey:ne.budget(d)});const p=t.getQueryData(ne.budget(d));return p&&t.setQueryData(ne.budget(d),{...p,budget:{...p.budget,user_ids:p.budget.user_ids.filter(_=>_!==f),accepted_user_ids:p.budget.accepted_user_ids.filter(_=>_!==f)}}),{previousData:p}},onSuccess:(d,{budgetId:f})=>{const p=t.getQueryData(ne.budget(f));p&&t.setQueryData(ne.budget(f),p)},onError:(d,{budgetId:f},p)=>{p?.previousData&&t.setQueryData(ne.budget(f),p.previousData)}}),l=pt({mutationFn:async({budgetId:d,userId:f})=>{const{exists:p,data:_}=await Ce("users",f,"PRE-EDIT-READ");if(!p||!_)throw new Error("User document not found");const v=[d,..._.budget_ids.filter(b=>b!==d)];return await Ze("users",f,{..._,budget_ids:v,updated_at:new Date().toISOString()},"reordering budget list to make selected budget active"),{budgetId:d}},onMutate:async({budgetId:d,userId:f})=>{await t.cancelQueries({queryKey:ne.user(f)});const p=t.getQueryData(ne.user(f));return p&&t.setQueryData(ne.user(f),{...p,budget_ids:[d,...p.budget_ids.filter(_=>_!==d)]}),{previousData:p}},onSuccess:(d,{userId:f})=>{const p=t.getQueryData(ne.user(f));p&&t.setQueryData(ne.user(f),p)},onError:(d,{userId:f},p)=>{p?.previousData&&t.setQueryData(ne.user(f),p.previousData)}}),c=pt({mutationFn:async({budgetId:d,userId:f,userBudgetIds:p})=>{const{exists:_,data:v}=await Ce("budgets",d,"checking if user has pending invite for this budget");return!_||!v||!v.user_ids?.includes(f)||p.includes(d)?null:{budgetId:d,budgetName:v.name,ownerEmail:v.owner_email||null}}});return{createBudget:e,acceptInvite:n,inviteUser:i,revokeUser:a,switchBudget:l,checkInvite:c}}function eT(){const t=fi(),e=pt({mutationFn:async({userId:a,userEmail:l,text:c,feedbackType:d,currentPath:f})=>{const p=l||a,_={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`${c}

(Submitted from: ${f})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:d},{exists:v}=await Ce("feedback",p,"checking if user has existing feedback document");return v?await Ze("feedback",p,{items:v5(_),user_email:l,updated_at:new Date().toISOString()},"adding new feedback item to existing document",{merge:!0}):await Ze("feedback",p,{items:[_],user_email:l,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},"creating new feedback document for user"),{feedbackItem:_,docId:p}},onMutate:async({userId:a,userEmail:l,text:c,feedbackType:d,currentPath:f})=>{await t.cancelQueries({queryKey:ne.feedback()});const p=t.getQueryData(ne.feedback()),_=l||a,v={id:`feedback_optimistic_${Date.now()}`,text:`${c}

(Submitted from: ${f})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:d,doc_id:_,user_email:l};return t.setQueryData(ne.feedback(),b=>b?{items:[...b.items,v]}:{items:[v]}),{previousData:p,optimisticItemId:v.id}},onSuccess:(a,l,c)=>{t.setQueryData(ne.feedback(),d=>d&&{items:d.items.map(f=>f.id===c?.optimisticItemId?{...a.feedbackItem,doc_id:a.docId,user_email:l.userEmail}:f)})},onError:(a,l,c)=>{c?.previousData&&t.setQueryData(ne.feedback(),c.previousData)}}),n=pt({mutationFn:async({item:a})=>{const{exists:l,data:c}=await Ce("feedback",a.doc_id,"PRE-EDIT-READ");if(!l||!c)throw new Error(`Feedback document not found: ${a.doc_id}`);const d=!a.is_done,f=d?new Date().toISOString():null,p=c.items||[];let _=!1;const v=p.map(b=>b.id===a.id?(_=!0,{...b,is_done:d,completed_at:f}):b);if(!_)throw console.error("[toggleFeedback] Item not found in document",{searchingFor:a.id,inDocument:a.doc_id,availableIds:p.map(b=>b.id)}),new Error(`Feedback item not found in document. Item ID: ${a.id}, Doc ID: ${a.doc_id}`);return await Ze("feedback",a.doc_id,{...c,items:v,updated_at:new Date().toISOString()},`marking feedback item as ${d?"done":"not done"}`),{itemId:a.id,isDone:d,completedAt:f}},onMutate:async({item:a})=>{await t.cancelQueries({queryKey:ne.feedback()});const l=t.getQueryData(ne.feedback()),c=!a.is_done,d=c?new Date().toISOString():null;return t.setQueryData(ne.feedback(),f=>f&&{items:f.items.map(p=>p.id===a.id?{...p,is_done:c,completed_at:d}:p)}),{previousData:l}},onError:(a,l,c)=>{c?.previousData&&t.setQueryData(ne.feedback(),c.previousData)}}),i=pt({mutationFn:async({docId:a,items:l})=>{const{exists:c,data:d}=await Ce("feedback",a,"PRE-EDIT-READ");if(!c||!d)throw new Error("Feedback document not found");return await Ze("feedback",a,{...d,items:l,updated_at:new Date().toISOString()},"saving reordered feedback items"),{docId:a,items:l}},onMutate:async({docId:a,items:l})=>{await t.cancelQueries({queryKey:ne.feedback()});const c=t.getQueryData(ne.feedback());return t.setQueryData(ne.feedback(),d=>{if(!d)return d;const f=new Map;return l.forEach(p=>{f.set(p.id,p.sort_order)}),{items:d.items.map(p=>p.doc_id===a&&f.has(p.id)?{...p,sort_order:f.get(p.id)}:p)}}),{previousData:c}},onError:(a,l,c)=>{c?.previousData&&t.setQueryData(ne.feedback(),c.previousData)}});return{submitFeedback:e,toggleFeedback:n,updateSortOrder:i}}async function rM(t,e){return Ne.fetchQuery({queryKey:["budgetInvite",t,e],queryFn:async()=>{const{exists:n,data:i}=await Ce("budgets",t,"checking if user has pending invite for budget");return!n||!i?null:{isInvited:i.user_ids?.includes(e)??!1,hasAccepted:i.accepted_user_ids?.includes(e)??!1,budgetName:i.name||"Unnamed Budget",ownerEmail:i.owner_email||null}},staleTime:60*1e3})}async function Sg(t,e,n){const i=Tt(t,e,n),a=Ne.getQueryData(ne.month(t,e,n));if(a?.month)return{year:a.month.year,month:a.month.month,category_balances:a.month.category_balances,category_balances_stale:a.month.category_balances_stale,allocations_finalized:a.month.allocations_finalized,allocations:a.month.allocations,expenses:a.month.expenses};const{exists:l,data:c}=await Ce("months",i,`fetching month for balance calculation (not in cache, walking ${e}/${n})`);if(!l||!c)return null;const d=hf(c,t,e,n);return Ne.setQueryData(ne.month(t,e,n),{month:d}),{year:d.year,month:d.month,category_balances:d.category_balances,category_balances_stale:d.category_balances_stale,allocations_finalized:d.allocations_finalized,allocations:d.allocations,expenses:d.expenses}}function iM(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function sM(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}async function aM(t,e,n,i){const a={};e.forEach(b=>{a[b]=0});const l=await Sg(t,n,i);if(l?.category_balances&&!l.category_balances_stale){for(const b of l.category_balances)e.includes(b.category_id)&&(a[b.category_id]=b.end_balance);return a}const c={};e.forEach(b=>{c[b]=0});const d=[];l&&d.push(l);let f=n,p=i,_=!1;const v=120;for(let b=0;b<v&&!_;b++){const T=iM(f,p);f=T.year,p=T.month;const S=await Sg(t,f,p);if(!S)_=!0;else if(S.category_balances&&!S.category_balances_stale){_=!0;for(const A of S.category_balances)e.includes(A.category_id)&&(c[A.category_id]=A.end_balance)}else d.push(S)}d.reverse(),Object.assign(a,c);for(const b of d){if(b.allocations_finalized&&b.allocations)for(const T of b.allocations)e.includes(T.category_id)&&(a[T.category_id]=(a[T.category_id]||0)+T.amount);if(b.expenses)for(const T of b.expenses)e.includes(T.category_id)&&(a[T.category_id]=(a[T.category_id]||0)-T.amount)}return a}async function oM(t,e,n,i,a){const l={...n};let c=i,d=a;const f=24;for(let p=0;p<f;p++){const _=sM(c,d);c=_.year,d=_.month;const v=await Sg(t,c,d);if(!v)break;if(v.allocations_finalized&&v.allocations)for(const b of v.allocations)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)+b.amount);if(v.expenses)for(const b of v.expenses)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)-b.amount)}return l}async function Lp(t,e,n,i,a){const l=await aM(t,e,n,i);let c;return a&&!a.is_stale&&a.computed_for_year===n&&a.computed_for_month===i?(c={},e.forEach(f=>{c[f]=a.balances[f]?.total??l[f]??0})):c=await oM(t,e,l,n,i),{current:l,total:c}}function tT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const lM=tT,nT=new tu("auth","Firebase",tT());const jh=new Ug("@firebase/auth");function cM(t,...e){jh.logLevel<=Ke.WARN&&jh.warn(`Auth (${ul}): ${t}`,...e)}function oh(t,...e){jh.logLevel<=Ke.ERROR&&jh.error(`Auth (${ul}): ${t}`,...e)}function jr(t,...e){throw Ty(t,...e)}function li(t,...e){return Ty(t,...e)}function rT(t,e,n){const i={...lM(),[e]:n};return new tu("auth","Firebase",i).create(e,{appName:t.name})}function Ps(t){return rT(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ty(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return nT.create(t,...e)}function Oe(t,e,...n){if(!t)throw Ty(e,...n)}function ki(t){const e="INTERNAL ASSERTION FAILED: "+t;throw oh(e),new Error(e)}function qi(t,e){t||ki(e)}function wg(){return typeof self<"u"&&self.location?.href||""}function uM(){return JE()==="http:"||JE()==="https:"}function JE(){return typeof self<"u"&&self.location?.protocol||null}function dM(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(uM()||DD()||"connection"in navigator)?navigator.onLine:!0}function hM(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class du{constructor(e,n){this.shortDelay=e,this.longDelay=n,qi(n>e,"Short delay should be less than long delay!"),this.isMobile=AD()||ID()}get(){return dM()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ay(t,e){qi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class iT{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ki("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ki("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ki("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const fM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const mM=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],pM=new du(3e4,6e4);function La(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function $s(t,e,n,i,a={}){return sT(t,a,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const d=nu({key:t.config.apiKey,...c}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const p={method:e,headers:f,...l};return RD()||(p.referrerPolicy="no-referrer"),t.emulatorConfig&&cl(t.emulatorConfig.host)&&(p.credentials="include"),iT.fetch()(await aT(t,t.config.apiHost,n,d),p)})}async function sT(t,e,n){t._canInitEmulator=!1;const i={...fM,...e};try{const a=new yM(t),l=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Jd(t,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const d=l.ok?c.errorMessage:c.error.message,[f,p]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jd(t,"credential-already-in-use",c);if(f==="EMAIL_EXISTS")throw Jd(t,"email-already-in-use",c);if(f==="USER_DISABLED")throw Jd(t,"user-disabled",c);const _=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw rT(t,_,p);jr(t,_)}}catch(a){if(a instanceof Gi)throw a;jr(t,"network-request-failed",{message:String(a)})}}async function ff(t,e,n,i,a={}){const l=await $s(t,e,n,i,a);return"mfaPendingCredential"in l&&jr(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function aT(t,e,n,i){const a=`${e}${n}?${i}`,l=t,c=l.config.emulator?Ay(t.config,a):`${t.config.apiScheme}://${a}`;return mM.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function gM(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class yM{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(li(this.auth,"network-request-failed")),pM.get())})}}function Jd(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=li(t,e,i);return a.customData._tokenResponse=n,a}function ZE(t){return t!==void 0&&t.enterprise!==void 0}class _M{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return gM(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function vM(t,e){return $s(t,"GET","/v2/recaptchaConfig",La(t,e))}async function bM(t,e){return $s(t,"POST","/v1/accounts:delete",e)}async function Oh(t,e){return $s(t,"POST","/v1/accounts:lookup",e)}function zc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function EM(t,e=!1){const n=an(t),i=await n.getIdToken(e),a=Cy(i);Oe(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l?.sign_in_provider;return{claims:a,token:i,authTime:zc(Bp(a.auth_time)),issuedAtTime:zc(Bp(a.iat)),expirationTime:zc(Bp(a.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Bp(t){return Number(t)*1e3}function Cy(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return oh("JWT malformed, contained fewer than 3 sections"),null;try{const a=lS(n);return a?JSON.parse(a):(oh("Failed to decode base64 JWT payload"),null)}catch(a){return oh("Caught error parsing JWT payload as JSON",a?.toString()),null}}function ex(t){const e=Cy(t);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Yc(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Gi&&xM(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function xM({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class SM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Tg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=zc(this.lastLoginAt),this.creationTime=zc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Mh(t){const e=t.auth,n=await t.getIdToken(),i=await Yc(t,Oh(e,{idToken:n}));Oe(i?.users.length,e,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=a.providerUserInfo?.length?oT(a.providerUserInfo):[],c=TM(t.providerData,l),d=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!c?.length,p=d?f:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Tg(a.createdAt,a.lastLoginAt),isAnonymous:p};Object.assign(t,_)}async function wM(t){const e=an(t);await Mh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function TM(t,e){return[...t.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function oT(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function AM(t,e){const n=await sT(t,{},async()=>{const i=nu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,c=await aT(t,a,"/v1/token",`key=${l}`),d=await t._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:i};return t.emulatorConfig&&cl(t.emulatorConfig.host)&&(f.credentials="include"),iT.fetch()(c,f)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function CM(t,e){return $s(t,"POST","/v2/accounts:revokeToken",La(t,e))}class Qo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ex(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const n=ex(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:a,expiresIn:l}=await AM(e,n);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:a,expirationTime:l}=n,c=new Qo;return i&&(Oe(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),a&&(Oe(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Oe(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Qo,this.toJSON())}_performRefresh(){return ki("not implemented")}}function ws(t,e){Oe(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Rr{constructor({uid:e,auth:n,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new SM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Tg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await Yc(this,this.stsTokenManager.getToken(this.auth,e));return Oe(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return EM(this,e)}reload(){return wM(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Rr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Mh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ar(this.auth.app))return Promise.reject(Ps(this.auth));const e=await this.getIdToken();return await Yc(this,bM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,a=n.email??void 0,l=n.phoneNumber??void 0,c=n.photoURL??void 0,d=n.tenantId??void 0,f=n._redirectEventId??void 0,p=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:v,emailVerified:b,isAnonymous:T,providerData:S,stsTokenManager:A}=n;Oe(v&&A,e,"internal-error");const R=Qo.fromJSON(this.name,A);Oe(typeof v=="string",e,"internal-error"),ws(i,e.name),ws(a,e.name),Oe(typeof b=="boolean",e,"internal-error"),Oe(typeof T=="boolean",e,"internal-error"),ws(l,e.name),ws(c,e.name),ws(d,e.name),ws(f,e.name),ws(p,e.name),ws(_,e.name);const z=new Rr({uid:v,auth:e,email:a,emailVerified:b,displayName:i,isAnonymous:T,photoURL:c,phoneNumber:l,tenantId:d,stsTokenManager:R,createdAt:p,lastLoginAt:_});return S&&Array.isArray(S)&&(z.providerData=S.map(F=>({...F}))),f&&(z._redirectEventId=f),z}static async _fromIdTokenResponse(e,n,i=!1){const a=new Qo;a.updateFromServerResponse(n);const l=new Rr({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Mh(l),l}static async _fromGetAccountInfoResponse(e,n,i){const a=n.users[0];Oe(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?oT(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!l?.length,d=new Qo;d.updateFromIdToken(i);const f=new Rr({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:c}),p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Tg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(f,p),f}}const tx=new Map;function Ni(t){qi(t instanceof Function,"Expected a class definition");let e=tx.get(t);return e?(qi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,tx.set(t,e),e)}class lT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}lT.type="NONE";const nx=lT;function lh(t,e,n){return`firebase:${t}:${e}:${n}`}class Go{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=lh(this.userKey,a.apiKey,l),this.fullPersistenceKey=lh("persistence",a.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Oh(this.auth,{idToken:e}).catch(()=>{});return n?Rr._fromGetAccountInfoResponse(this.auth,n,e):null}return Rr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Go(Ni(nx),e,i);const a=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let l=a[0]||Ni(nx);const c=lh(i,e.config.apiKey,e.name);let d=null;for(const p of n)try{const _=await p._get(c);if(_){let v;if(typeof _=="string"){const b=await Oh(e,{idToken:_}).catch(()=>{});if(!b)break;v=await Rr._fromGetAccountInfoResponse(e,b,_)}else v=Rr._fromJSON(e,_);p!==l&&(d=v),l=p;break}}catch{}const f=a.filter(p=>p._shouldAllowMigration);return!l._shouldAllowMigration||!f.length?new Go(l,e,i):(l=f[0],d&&await l._set(c,d.toJSON()),await Promise.all(n.map(async p=>{if(p!==l)try{await p._remove(c)}catch{}})),new Go(l,e,i))}}function rx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(hT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(cT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mT(e))return"Blackberry";if(pT(e))return"Webos";if(uT(e))return"Safari";if((e.includes("chrome/")||dT(e))&&!e.includes("edge/"))return"Chrome";if(fT(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function cT(t=Sn()){return/firefox\//i.test(t)}function uT(t=Sn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dT(t=Sn()){return/crios\//i.test(t)}function hT(t=Sn()){return/iemobile/i.test(t)}function fT(t=Sn()){return/android/i.test(t)}function mT(t=Sn()){return/blackberry/i.test(t)}function pT(t=Sn()){return/webos/i.test(t)}function Ry(t=Sn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function RM(t=Sn()){return Ry(t)&&!!window.navigator?.standalone}function DM(){return jD()&&document.documentMode===10}function gT(t=Sn()){return Ry(t)||fT(t)||pT(t)||mT(t)||/windows phone/i.test(t)||hT(t)}function yT(t,e=[]){let n;switch(t){case"Browser":n=rx(Sn());break;case"Worker":n=`${rx(Sn())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ul}/${i}`}class IM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=l=>new Promise((c,d)=>{try{const f=e(l);c(f)}catch(f){d(f)}});i.onAbort=n,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function jM(t,e={}){return $s(t,"GET","/v2/passwordPolicy",La(t,e))}const OM=6;class MM{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??OM,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class kM{constructor(e,n,i,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ix(this),this.idTokenSubscription=new ix(this),this.beforeStateQueue=new IM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ni(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Go.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Oh(this,{idToken:e}),i=await Rr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ar(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,c=i?._redirectEventId,d=await this.tryRedirectSignIn(e);(!l||l===c)&&d?.user&&(i=d.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Mh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=hM()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ar(this.app))return Promise.reject(Ps(this));const n=e?an(e):null;return n&&Oe(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ar(this.app)?Promise.reject(Ps(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ar(this.app)?Promise.reject(Ps(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ni(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await jM(this),n=new MM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new tu("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await CM(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ni(e)||this._popupRedirectResolver;Oe(n,this,"argument-error"),this.redirectPersistenceManager=await Go.create(this,[Ni(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,a){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(d,this,"internal-error"),d.then(()=>{c||l(this.currentUser)}),typeof n=="function"){const f=e.addObserver(n,i,a);return()=>{c=!0,f()}}else{const f=e.addObserver(n);return()=>{c=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Ar(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&cM(`Error while retrieving App Check token: ${e.error}`),e?.token}}function _l(t){return an(t)}class ix{constructor(e){this.auth=e,this.observer=null,this.addObserver=BD(n=>this.observer=n)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let mf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function NM(t){mf=t}function _T(t){return mf.loadJS(t)}function PM(){return mf.recaptchaEnterpriseScript}function VM(){return mf.gapiScript}function LM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class BM{constructor(){this.enterprise=new zM}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class zM{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const UM="recaptcha-enterprise",vT="NO_RECAPTCHA";class FM{constructor(e){this.type=UM,this.auth=_l(e)}async verify(e="verify",n=!1){async function i(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,d)=>{vM(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const p=new _M(f);return l.tenantId==null?l._agentRecaptchaConfig=p:l._tenantRecaptchaConfigs[l.tenantId]=p,c(p.siteKey)}}).catch(f=>{d(f)})})}function a(l,c,d){const f=window.grecaptcha;ZE(f)?f.enterprise.ready(()=>{f.enterprise.execute(l,{action:e}).then(p=>{c(p)}).catch(()=>{c(vT)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new BM().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(d=>{if(!n&&ZE(window.grecaptcha))a(d,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let f=PM();f.length!==0&&(f+=d),_T(f).then(()=>{a(d,l,c)}).catch(p=>{c(p)})}}).catch(d=>{c(d)})})}}async function sx(t,e,n,i=!1,a=!1){const l=new FM(t);let c;if(a)c=vT;else try{c=await l.verify(n)}catch{c=await l.verify(n,!0)}const d={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const f=d.phoneEnrollmentInfo.phoneNumber,p=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const f=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function ax(t,e,n,i,a){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await sx(t,e,n,n==="getOobCode");return i(t,l)}else return i(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await sx(t,e,n,n==="getOobCode");return i(t,c)}else return Promise.reject(l)})}function qM(t,e){const n=qg(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),l=n.getOptions();if(Vs(l,e??{}))return a;jr(a,"already-initialized")}return n.initialize({options:e})}function QM(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(Ni);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function GM(t,e,n){const i=_l(t);Oe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=bT(e),{host:c,port:d}=HM(e),f=d===null?"":`:${d}`,p={url:`${l}//${c}${f}/`},_=Object.freeze({host:c,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Oe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Oe(Vs(p,i.config.emulator)&&Vs(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,cl(c)?(hS(`${l}//${c}${f}`),fS("Auth",!0)):$M()}function bT(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function HM(t){const e=bT(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:ox(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:ox(c)}}}function ox(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function $M(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Dy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ki("not implemented")}_getIdTokenResponse(e){return ki("not implemented")}_linkToIdToken(e,n){return ki("not implemented")}_getReauthenticationResolver(e){return ki("not implemented")}}async function KM(t,e){return $s(t,"POST","/v1/accounts:signUp",e)}async function YM(t,e){return ff(t,"POST","/v1/accounts:signInWithPassword",La(t,e))}async function WM(t,e){return ff(t,"POST","/v1/accounts:signInWithEmailLink",La(t,e))}async function XM(t,e){return ff(t,"POST","/v1/accounts:signInWithEmailLink",La(t,e))}class Wc extends Dy{constructor(e,n,i,a=null){super("password",i),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new Wc(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new Wc(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ax(e,n,"signInWithPassword",YM);case"emailLink":return WM(e,{email:this._email,oobCode:this._password});default:jr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ax(e,i,"signUpPassword",KM);case"emailLink":return XM(e,{idToken:n,email:this._email,oobCode:this._password});default:jr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ho(t,e){return ff(t,"POST","/v1/accounts:signInWithIdp",La(t,e))}const JM="http://localhost";class ka extends Dy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ka(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):jr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=n;if(!i||!a)return null;const c=new ka(i,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const n=this.buildRequest();return Ho(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,Ho(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ho(e,n)}buildRequest(){const e={requestUri:JM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=nu(n)}return e}}function ZM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ek(t){const e=Dc(Ic(t)).link,n=e?Dc(Ic(e)).deep_link_id:null,i=Dc(Ic(t)).deep_link_id;return(i?Dc(Ic(i)).link:null)||i||n||e||t}class Iy{constructor(e){const n=Dc(Ic(e)),i=n.apiKey??null,a=n.oobCode??null,l=ZM(n.mode??null);Oe(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=ek(e);try{return new Iy(n)}catch{return null}}}class vl{constructor(){this.providerId=vl.PROVIDER_ID}static credential(e,n){return Wc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Iy.parseLink(n);return Oe(i,"argument-error"),Wc._fromEmailAndCode(e,i.code,i.tenantId)}}vl.PROVIDER_ID="password";vl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";vl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ET{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class hu extends ET{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ts extends hu{constructor(){super("facebook.com")}static credential(e){return ka._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ts.PROVIDER_ID="facebook.com";class As extends hu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ka._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return As.credential(n,i)}catch{return null}}}As.GOOGLE_SIGN_IN_METHOD="google.com";As.PROVIDER_ID="google.com";class Cs extends hu{constructor(){super("github.com")}static credential(e){return ka._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Cs.credential(e.oauthAccessToken)}catch{return null}}}Cs.GITHUB_SIGN_IN_METHOD="github.com";Cs.PROVIDER_ID="github.com";class Rs extends hu{constructor(){super("twitter.com")}static credential(e,n){return ka._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Rs.credential(n,i)}catch{return null}}}Rs.TWITTER_SIGN_IN_METHOD="twitter.com";Rs.PROVIDER_ID="twitter.com";class nl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,a=!1){const l=await Rr._fromIdTokenResponse(e,i,a),c=lx(i);return new nl({user:l,providerId:c,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const a=lx(i);return new nl({user:e,providerId:a,_tokenResponse:i,operationType:n})}}function lx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class kh extends Gi{constructor(e,n,i,a){super(n.code,n.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,kh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,a){return new kh(e,n,i,a)}}function xT(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?kh._fromErrorAndOperation(t,l,e,i):l})}async function tk(t,e,n=!1){const i=await Yc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return nl._forOperation(t,"link",i)}async function nk(t,e,n=!1){const{auth:i}=t;if(Ar(i.app))return Promise.reject(Ps(i));const a="reauthenticate";try{const l=await Yc(t,xT(i,a,e,t),n);Oe(l.idToken,i,"internal-error");const c=Cy(l.idToken);Oe(c,i,"internal-error");const{sub:d}=c;return Oe(t.uid===d,i,"user-mismatch"),nl._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&jr(i,"user-mismatch"),l}}async function ST(t,e,n=!1){if(Ar(t.app))return Promise.reject(Ps(t));const i="signIn",a=await xT(t,i,e),l=await nl._fromIdTokenResponse(t,i,a);return n||await t._updateCurrentUser(l.user),l}async function rk(t,e){return ST(_l(t),e)}async function ik(t){const e=_l(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function sk(t,e,n){return Ar(t.app)?Promise.reject(Ps(t)):rk(an(t),vl.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&ik(t),i})}function ak(t,e,n,i){return an(t).onIdTokenChanged(e,n,i)}function ok(t,e,n){return an(t).beforeAuthStateChanged(e,n)}function lk(t,e,n,i){return an(t).onAuthStateChanged(e,n,i)}function ck(t){return an(t).signOut()}const Nh="__sak";class wT{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Nh,"1"),this.storage.removeItem(Nh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const uk=1e3,dk=10;class TT extends wT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=gT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),a=this.localCache[n];i!==a&&e(n,a,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((c,d,f)=>{this.notifyListeners(c,f)});return}const i=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(i);!n&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);DM()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,dk):a()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},uk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}TT.type="LOCAL";const hk=TT;class AT extends wT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}AT.type="SESSION";const CT=AT;function fk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class pf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const i=new pf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:a,data:l}=n.data,c=this.handlersMap[a];if(!c?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const d=Array.from(c).map(async p=>p(n.origin,l)),f=await fk(d);n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:f})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pf.receivers=[];function jy(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class mk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((d,f)=>{const p=jy("",20);a.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},i);c={messageChannel:a,onMessage(v){const b=v;if(b.data.eventId===p)switch(b.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(b.data.response);break;default:clearTimeout(_),clearTimeout(l),f(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:n},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function ci(){return window}function pk(t){ci().location.href=t}function RT(){return typeof ci().WorkerGlobalScope<"u"&&typeof ci().importScripts=="function"}async function gk(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function yk(){return navigator?.serviceWorker?.controller||null}function _k(){return RT()?self:null}const DT="firebaseLocalStorageDb",vk=1,Ph="firebaseLocalStorage",IT="fbase_key";class fu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function gf(t,e){return t.transaction([Ph],e?"readwrite":"readonly").objectStore(Ph)}function bk(){const t=indexedDB.deleteDatabase(DT);return new fu(t).toPromise()}function Ag(){const t=indexedDB.open(DT,vk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Ph,{keyPath:IT})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Ph)?e(i):(i.close(),await bk(),e(await Ag()))})})}async function cx(t,e,n){const i=gf(t,!0).put({[IT]:e,value:n});return new fu(i).toPromise()}async function Ek(t,e){const n=gf(t,!1).get(e),i=await new fu(n).toPromise();return i===void 0?null:i.value}function ux(t,e){const n=gf(t,!0).delete(e);return new fu(n).toPromise()}const xk=800,Sk=3;class jT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ag(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>Sk)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return RT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pf._getInstance(_k()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await gk(),!this.activeServiceWorker)return;this.sender=new mk(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||yk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ag();return await cx(e,Nh,"1"),await ux(e,Nh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>cx(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>Ek(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ux(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=gf(a,!1).getAll();return new fu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),xk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}jT.type="LOCAL";const wk=jT;new du(3e4,6e4);function Tk(t,e){return e?Ni(e):(Oe(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Oy extends Dy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ho(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ho(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ho(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Ak(t){return ST(t.auth,new Oy(t),t.bypassAuthState)}function Ck(t){const{auth:e,user:n}=t;return Oe(n,e,"internal-error"),nk(n,new Oy(t),t.bypassAuthState)}async function Rk(t){const{auth:e,user:n}=t;return Oe(n,e,"internal-error"),tk(n,new Oy(t),t.bypassAuthState)}class OT{constructor(e,n,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:a,tenantId:l,error:c,type:d}=e;if(c){this.reject(c);return}const f={auth:this.auth,requestUri:n,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ak;case"linkViaPopup":case"linkViaRedirect":return Rk;case"reauthViaPopup":case"reauthViaRedirect":return Ck;default:jr(this.auth,"internal-error")}}resolve(e){qi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Dk=new du(2e3,1e4);class Vo extends OT{constructor(e,n,i,a,l){super(e,n,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Vo.currentPopupAction&&Vo.currentPopupAction.cancel(),Vo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){qi(this.filter.length===1,"Popup operations only handle one event");const e=jy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(li(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(li(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(li(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Dk.get())};e()}}Vo.currentPopupAction=null;const Ik="pendingRedirect",ch=new Map;class jk extends OT{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=ch.get(this.auth._key());if(!e){try{const i=await Ok(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}ch.set(this.auth._key(),e)}return this.bypassAuthState||ch.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Ok(t,e){const n=Nk(e),i=kk(t);if(!await i._isAvailable())return!1;const a=await i._get(n)==="true";return await i._remove(n),a}function Mk(t,e){ch.set(t._key(),e)}function kk(t){return Ni(t._redirectPersistence)}function Nk(t){return lh(Ik,t.config.apiKey,t.name)}async function Pk(t,e,n=!1){if(Ar(t.app))return Promise.reject(Ps(t));const i=_l(t),a=Tk(i,e),c=await new jk(i,a,n).execute();return c&&!n&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}const Vk=600*1e3;class Lk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Bk(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!MT(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(li(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Vk&&this.cachedEventUids.clear(),this.cachedEventUids.has(dx(e))}saveEventToCache(e){this.cachedEventUids.add(dx(e)),this.lastProcessedEventTime=Date.now()}}function dx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function MT({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function Bk(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return MT(t);default:return!1}}async function zk(t,e={}){return $s(t,"GET","/v1/projects",e)}const Uk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Fk=/^https?/;async function qk(t){if(t.config.emulator)return;const{authorizedDomains:e}=await zk(t);for(const n of e)try{if(Qk(n))return}catch{}jr(t,"unauthorized-domain")}function Qk(t){const e=wg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&c.hostname===i}if(!Fk.test(n))return!1;if(Uk.test(t))return i===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const Gk=new du(3e4,6e4);function hx(){const t=ci().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Hk(t){return new Promise((e,n)=>{function i(){hx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{hx(),n(li(t,"network-request-failed"))},timeout:Gk.get()})}if(ci().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ci().gapi?.load)i();else{const a=LM("iframefcb");return ci()[a]=()=>{gapi.load?i():n(li(t,"network-request-failed"))},_T(`${VM()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw uh=null,e})}let uh=null;function $k(t){return uh=uh||Hk(t),uh}const Kk=new du(5e3,15e3),Yk="__/auth/iframe",Wk="emulator/auth/iframe",Xk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Jk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Zk(t){const e=t.config;Oe(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ay(e,Wk):`https://${t.config.authDomain}/${Yk}`,i={apiKey:e.apiKey,appName:t.name,v:ul},a=Jk.get(t.config.apiHost);a&&(i.eid=a);const l=t._getFrameworks();return l.length&&(i.fw=l.join(",")),`${n}?${nu(i).slice(1)}`}async function eN(t){const e=await $k(t),n=ci().gapi;return Oe(n,t,"internal-error"),e.open({where:document.body,url:Zk(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Xk,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const c=li(t,"network-request-failed"),d=ci().setTimeout(()=>{l(c)},Kk.get());function f(){ci().clearTimeout(d),a(i)}i.ping(f).then(f,()=>{l(c)})}))}const tN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},nN=500,rN=600,iN="_blank",sN="http://localhost";class fx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aN(t,e,n,i=nN,a=rN){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const f={...tN,width:i.toString(),height:a.toString(),top:l,left:c},p=Sn().toLowerCase();n&&(d=dT(p)?iN:n),cT(p)&&(e=e||sN,f.scrollbars="yes");const _=Object.entries(f).reduce((b,[T,S])=>`${b}${T}=${S},`,"");if(RM(p)&&d!=="_self")return oN(e||"",d),new fx(null);const v=window.open(e||"",d,_);Oe(v,t,"popup-blocked");try{v.focus()}catch{}return new fx(v)}function oN(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const lN="__/auth/handler",cN="emulator/auth/handler",uN=encodeURIComponent("fac");async function mx(t,e,n,i,a,l){Oe(t.config.authDomain,t,"auth-domain-config-required"),Oe(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:ul,eventId:a};if(e instanceof ET){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",LD(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))c[_]=v}if(e instanceof hu){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(c.scopes=_.join(","))}t.tenantId&&(c.tid=t.tenantId);const d=c;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const f=await t._getAppCheckToken(),p=f?`#${uN}=${encodeURIComponent(f)}`:"";return`${dN(t)}?${nu(d).slice(1)}${p}`}function dN({config:t}){return t.emulator?Ay(t,cN):`https://${t.authDomain}/${lN}`}const zp="webStorageSupport";class hN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=CT,this._completeRedirectFn=Pk,this._overrideRedirectResult=Mk}async _openPopup(e,n,i,a){qi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await mx(e,n,i,wg(),a);return aN(e,l,jy())}async _openRedirect(e,n,i,a){await this._originValidation(e);const l=await mx(e,n,i,wg(),a);return pk(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:l}=this.eventManagers[n];return a?Promise.resolve(a):(qi(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await eN(e),i=new Lk(e);return n.register("authEvent",a=>(Oe(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(zp,{type:zp},a=>{const l=a?.[0]?.[zp];l!==void 0&&n(!!l),jr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=qk(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return gT()||uT()||Ry()}}const fN=hN;var px="@firebase/auth",gx="1.12.0";class mN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function pN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function gN(t){Ko(new ja("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=i.options;Oe(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:c,authDomain:d,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yT(t)},p=new kM(i,a,l,f);return QM(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Ko(new ja("auth-internal",e=>{const n=_l(e.getProvider("auth").getImmediate());return(i=>new mN(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ms(px,gx,pN(t)),Ms(px,gx,"esm2020")}const yN=300,_N=dS("authIdTokenMaxAge")||yN;let yx=null;const vN=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>_N)return;const a=n?.token;yx!==a&&(yx=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function bN(t=yS()){const e=qg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=qM(t,{popupRedirectResolver:fN,persistence:[wk,hk,CT]}),i=dS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=vN(l.toString());ok(n,c,()=>c(n.currentUser)),ak(n,d=>c(d))}}const a=cS("auth");return a&&GM(n,`http://${a}`),n}function EN(){return document.getElementsByTagName("head")?.[0]??document}NM({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=a=>{const l=li("internal-error");l.customData=a,n(l)},i.type="text/javascript",i.charset="UTF-8",EN().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});gN("Browser");function Ba(){const t=bN(Xw);async function e(){return!1}async function n(d,f){return sk(t,d,f)}function i(){return ck(t)}function a(d){lk(t,f=>{d(f)})}function l(){return t.currentUser}return{set_user_listener:a,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:i,get_current_firebase_user:l}}const xN={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,lastActiveTab:"balances",lastSettingsTab:"accounts",lastAdminTab:"budget",setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},setLastActiveTab:()=>{},setLastSettingsTab:()=>{},setLastAdminTab:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},kT=I.createContext(xN);function SN({children:t}){const n=Ba().get_current_firebase_user(),[i,a]=I.useState(null),[l,c]=I.useState(new Date().getFullYear()),[d,f]=I.useState(new Date().getMonth()+1),[p,_]=I.useState("balances"),[v,b]=I.useState("accounts"),[T,S]=I.useState("budget"),[A,R]=I.useState(!1),[z,F]=I.useState(!1),U=F5(n?.uid||null,n?.email||null),X=Q5(n?.uid||null,U.data||null,{enabled:!!n?.uid&&!!U.data}),Z=U.data?.permission_flags?.is_admin===!0,oe=U.data?.permission_flags?.is_test===!0,M=X.data?.pendingInvites||[],C=X.data?.budgets||[],D=M.length>0;I.useEffect(()=>{if(!n||A||U.isLoading||X.isLoading)return;const Q=U.data,H=X.data;!Q&&!U.isError||(Q&&Q.budget_ids.length>0?(a(Q.budget_ids[0]),F(!1)):H?.pendingInvites&&H.pendingInvites.length>0?F(!1):F(!0),R(!0))},[n,A,U.data,U.isLoading,U.isError,X.data,X.isLoading]);const N=I.useCallback(()=>{f(Q=>Q===1?(c(H=>H-1),12):Q-1)},[]),j=I.useCallback(()=>{f(Q=>Q===12?(c(H=>H+1),1):Q+1)},[]),B=I.useCallback(async()=>{await X.refetch()},[X]),O=I.useCallback(Q=>{a(Q)},[]),Y=I.useCallback(async Q=>{if(!n)return null;try{const H=await rM(Q,n.uid);return H&&H.isInvited&&!H.hasAccepted?{budgetId:Q,budgetName:H.budgetName,ownerEmail:H.ownerEmail}:null}catch(H){return console.error("[BudgetContext] Error checking budget invite:",H),null}},[n]),q=I.useCallback(()=>{Ne.clear(),localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),P={currentUserId:n?.uid||null,selectedBudgetId:i,currentYear:l,currentMonthNumber:d,lastActiveTab:p,lastSettingsTab:v,lastAdminTab:T,setSelectedBudgetId:a,setCurrentYear:c,setCurrentMonthNumber:f,setLastActiveTab:_,setLastSettingsTab:b,setLastAdminTab:S,isInitialized:A,needsFirstBudget:z,goToPreviousMonth:N,goToNextMonth:j,pendingInvites:M,hasPendingInvites:D,accessibleBudgets:C,isAdmin:Z,isTest:oe,loadAccessibleBudgets:B,switchToBudget:O,checkBudgetInvite:Y,clearCache:q};return h.jsx(kT.Provider,{value:P,children:t})}function on(){const t=I.useContext(kT);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}function wN(){return h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx("nav",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:h.jsx(wt,{to:"/",style:{display:"flex",alignItems:"center"},title:"Tarron Lane Home",children:h.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane Home",style:{width:"2rem",height:"2rem"}})})}),h.jsx("h1",{children:"Tarron Lane Homepage"}),h.jsx("nav",{children:h.jsxs("ul",{children:[h.jsx("li",{children:h.jsx(wt,{to:"/sql-test",children:"SQL Test"})}),h.jsx("li",{children:h.jsx(wt,{to:"/budget",children:"Budget"})}),h.jsx("li",{children:h.jsx(wt,{to:"/account",children:"Account"})})]})})]})}const TN={mobile:640},AN=TN.mobile,My=["January","February","March","April","May","June","July","August","September","October","November","December"],ve={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15"},CN={maxWidth:"60rem",margin:"0 auto",padding:"2rem"},mu={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},RN={...mu,padding:"0.6rem 0.875rem",gap:"0.5rem"},DN={background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1rem 1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},IN={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},jN={display:"flex",flexDirection:"column",gap:"0.5rem"},ON={fontSize:"0.9rem",fontWeight:500},pu={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit"},MN={...pu,cursor:"pointer"},ky={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},NT={...ky,background:ve.primary,color:"white",border:"none"},kN={...NT,padding:"0.75rem 1.5rem",borderRadius:"8px"},NN={...ky,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},PN={...ky,background:"transparent",border:`1px solid ${ve.errorBorder}`,color:ve.error},VN={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},LN={display:"flex",gap:"0.5rem"},BN={display:"flex",gap:"0.25rem"},PT={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},zN={...PT,borderColor:ve.errorBorder,color:ve.error},rl={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},Ny={display:"flex",flexDirection:"column",gap:"2px"},UN={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},VT={opacity:.4,cursor:"grab"},LT={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:ve.primary,borderRadius:"2px",transition:"opacity 0.15s"},FN={position:"relative",height:"2rem",marginTop:"-0.25rem"},qN={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ve.primary,borderRadius:"2px",transition:"opacity 0.15s"},QN={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},GN={background:ve.errorBg,border:`1px solid ${ve.errorBorder}`,color:ve.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},HN={background:"transparent",border:"none",color:ve.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},Xc={opacity:.7,marginBottom:"1.5rem"},bl={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},Py={fontWeight:500,fontSize:"1.1rem"},Qs={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function $o({children:t}){return h.jsx("div",{style:CN,children:t})}function El({message:t,children:e,onDismiss:n,style:i}){return h.jsxs("div",{style:{...GN,...i},children:[h.jsx("span",{children:e??t}),n&&h.jsx("button",{onClick:n,style:HN,children:""})]})}const $N={primary:NT,"primary-large":kN,secondary:NN,danger:PN,small:VN};function ke({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:i,disabled:a,style:l,...c}){const d=$N[t],f=a||e;return h.jsx("button",{disabled:f,style:{...d,cursor:f?"not-allowed":"pointer",opacity:f?.7:1,...l},...c,children:e?n:i})}function za({children:t,onSubmit:e}){return h.jsx("form",{onSubmit:e,style:IN,children:t})}function Ht({label:t,htmlFor:e,children:n,hint:i}){return h.jsxs("div",{style:jN,children:[h.jsx("label",{htmlFor:e,style:ON,children:t}),n,i&&h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:i})]})}function Qi(t){return h.jsx("input",{style:pu,...t})}function Na({children:t,...e}){return h.jsx("select",{style:MN,...e,children:t})}function Vy({minHeight:t="6rem",style:e,...n}){return h.jsx("textarea",{style:{...pu,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function Ks({children:t}){return h.jsx("div",{style:UN,children:t})}function Up(t){const n=t.replace(/[^\d.]/g,"").split("."),i=n[0]||"",a=n[1],l=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return a!==void 0?`$${l}.${a.slice(0,2)}`:l?`$${l}`:""}function KN(t){return t.replace(/[$,]/g,"")}function Ly({id:t,value:e,onChange:n,placeholder:i="$0.00",required:a,autoFocus:l}){const[c,d]=I.useState(()=>Up(e)),f=I.useRef(null);I.useEffect(()=>{const _=Up(e);KN(c)!==e&&d(_)},[e]);function p(_){const v=_.target.value;if(!v||v==="$"){d(""),n("");return}const T=v.replace(/[^\d.]/g,"").split(".");let S=T[0];T.length>1&&(S+="."+T.slice(1).join("").slice(0,2));const A=Up(S);d(A),n(S)}return h.jsx("input",{ref:f,id:t,type:"text",inputMode:"decimal",value:c,onChange:p,placeholder:i,required:a,autoFocus:l,style:pu})}function YN(t,e){const n=t.toLowerCase(),i=e.toLowerCase();if(i.includes(n)){const d=i.indexOf(n);return{match:!0,score:d===0||/\s/.test(i[d-1])?100:90}}let a=0,l=0,c=0;for(let d=0;d<i.length&&a<n.length;d++)i[d]===n[a]?(a++,c++,l+=c*2):c=0;return a===n.length?{match:!0,score:l}:{match:!1,score:0}}function BT({id:t,value:e,onChange:n,payees:i,placeholder:a="Enter payee name"}){const[l,c]=I.useState(!1),[d,f]=I.useState(-1),p=I.useRef(null),_=I.useRef(null),v=e.trim()?i.map(S=>({payee:S,...YN(e,S)})).filter(S=>S.match).sort((S,A)=>A.score-S.score).slice(0,8).map(S=>S.payee):[];I.useEffect(()=>{function S(A){p.current&&!p.current.contains(A.target)&&c(!1)}return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]);function b(S){!l||v.length===0||(S.key==="ArrowDown"?(S.preventDefault(),f(A=>Math.min(A+1,v.length-1))):S.key==="ArrowUp"?(S.preventDefault(),f(A=>Math.max(A-1,-1))):S.key==="Enter"&&d>=0?(S.preventDefault(),n(v[d]),c(!1),f(-1)):S.key==="Escape"&&(c(!1),f(-1)))}function T(S){n(S),c(!1),f(-1),_.current?.focus()}return h.jsxs("div",{ref:p,style:{position:"relative"},children:[h.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:S=>{n(S.target.value),c(!0),f(-1)},onFocus:()=>c(!0),onKeyDown:b,placeholder:a,autoComplete:"off",style:pu}),l&&v.length>0&&h.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:v.map((S,A)=>h.jsx("div",{onClick:()=>T(S),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:A===d?`color-mix(in srgb, ${ve.primary} 20%, transparent)`:"transparent",borderBottom:A<v.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>f(A),children:S},S))})]})}function Ys(t=AN){const[e,n]=I.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return I.useEffect(()=>{function i(){n(window.innerWidth<t)}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[t]),e}function yf({children:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:d,onEdit:f,onDelete:p,onMoveUp:_,onMoveDown:v,canMoveUp:b=!0,canMoveDown:T=!0}){const S=Ys(),A=_||v;return h.jsxs("div",{onDragOver:R=>{R.stopPropagation(),a(R)},onDragLeave:R=>{R.stopPropagation(),l()},onDrop:R=>{R.stopPropagation(),d(R)},style:{position:"relative"},children:[h.jsx("div",{style:{...LT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),h.jsxs("div",{style:{...S?RN:mu,opacity:e?.5:1},children:[h.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:S?"0.5rem":"0.75rem",minWidth:0},children:[h.jsx("span",{draggable:!0,onDragStart:i,onDragEnd:c,style:{...VT,fontSize:S?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),h.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),h.jsxs("div",{style:S?BN:LN,children:[S?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:f,style:PT,title:"Edit","aria-label":"Edit",children:""}),h.jsx("button",{onClick:p,style:zN,title:"Delete","aria-label":"Delete",children:""})]}):h.jsxs(h.Fragment,{children:[h.jsx(ke,{variant:"secondary",onClick:f,children:"Edit"}),h.jsx(ke,{variant:"danger",onClick:p,children:"Delete"})]}),A&&h.jsxs("div",{style:Ny,children:[h.jsx("button",{onClick:R=>{R.stopPropagation(),_?.()},disabled:!b,style:{...rl,opacity:b?.6:.2,cursor:b?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),h.jsx("button",{onClick:R=>{R.stopPropagation(),v?.()},disabled:!T,style:{...rl,opacity:T?.6:.2,cursor:T?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function By({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i,label:a="Move to end"}){return h.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:FN,children:[h.jsx("div",{style:{...qN,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&h.jsx("span",{style:QN,children:a})]})}function Rc({children:t,style:e}){return h.jsx("div",{style:{...DN,...e},children:t})}function qe(t){return`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function yn(t){return t>=0?ve.success:ve.danger}function Vh({isOpen:t,onClose:e,title:n,children:i,width:a="28rem"}){return t?h.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:e,children:h.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:a,maxWidth:"calc(100vw - 2rem)",flexShrink:0,boxSizing:"border-box",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:l=>l.stopPropagation(),children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[h.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),h.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),i]})}):null}const WN={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function XN(){const[t,e]=I.useState(!1),[n,i]=I.useState(""),[a,l]=I.useState("bug"),c=I.useContext(eu),f=Ba().get_current_firebase_user(),p=Vn(),_=eT();if(p.pathname.includes("/settings/feedback")||!c.is_logged_in)return null;function b(T){T.preventDefault(),!(!n.trim()||!c.username||!f)&&(_.submitFeedback.mutate({userId:f.uid,userEmail:c.username,text:n.trim(),feedbackType:a,currentPath:p.pathname}),i(""),l("bug"),e(!1))}return h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>e(!0),style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:ve.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:T=>{T.currentTarget.style.transform="scale(1.1)",T.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:T=>{T.currentTarget.style.transform="scale(1)",T.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),h.jsx(Vh,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:h.jsxs("form",{onSubmit:b,children:[h.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(T=>{const S=WN[T],A=a===T;return h.jsxs("button",{type:"button",onClick:()=>l(T),style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${S.color}`,borderRadius:"0.5rem",background:A?S.bgColor:"transparent",color:A?S.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:A?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:A?1:.5,boxShadow:A?`0 0 12px ${S.bgColor}`:"none",position:"relative"},children:[S.label,A&&h.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},T)})}),h.jsx(Vy,{value:n,onChange:T=>i(T.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),h.jsxs(Ks,{children:[h.jsx(ke,{type:"button",variant:"secondary",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),h.jsx(ke,{type:"submit",disabled:!n.trim(),children:"Submit"})]})]})})]})}function Do({children:t,labelStyle:e,...n}){return h.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[h.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:ve.primary},...n}),t]})}function JN({title:t,count:e,children:n,defaultExpanded:i=!1}){const[a,l]=I.useState(i);return h.jsxs("div",{style:{marginTop:"2rem"},children:[h.jsxs("button",{onClick:()=>l(!a),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[h.jsx("span",{style:{transition:"transform 0.2s",transform:a?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),a&&n]})}const ZN=t=>{switch(t){case 2:return 220;case 3:return 320;case 4:return 420;case 5:return 520;case 6:return 620;default:return t*100+20}},e6=t=>t<=4?2:t<=6?3:Math.ceil(t/2);function zy(t){const{tabs:e,activeTab:n}=t,i=e.filter(v=>!v.hidden),a=i.length,l=ZN(a),c=e6(a),d=Math.floor(100/c),f=`tab-nav-${a}`,p=v=>({flex:"1 1 0",padding:"0.6rem 0.5rem",border:"none",borderRadius:0,background:"transparent",cursor:"pointer",fontWeight:v?600:400,fontSize:"0.9rem",color:"inherit",opacity:v?1:.5,transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem",position:"relative",boxSizing:"border-box",outline:"none"}),_=(v,b)=>h.jsxs(h.Fragment,{children:[h.jsx("span",{children:v.label}),v.checkmark&&h.jsx("span",{style:{color:ve.success,fontWeight:600},children:""}),b&&h.jsx("span",{style:{position:"absolute",bottom:"-1px",left:"15%",right:"15%",height:"3px",background:"white",borderRadius:"2px"}})]});return h.jsxs(h.Fragment,{children:[h.jsx("style",{children:`
        .${f} {
          display: flex;
          flex-wrap: wrap;
          margin-bottom: 1.5rem;
          border-bottom: 1px solid color-mix(in srgb, currentColor 15%, transparent);
        }
        .${f} > button,
        .${f} > a {
          border: none !important;
          border-radius: 0 !important;
          outline: none !important;
        }
        .${f} > button:hover,
        .${f} > button:focus,
        .${f} > a:hover,
        .${f} > a:focus {
          border: none !important;
          border-color: transparent !important;
        }
        @media (max-width: ${l}px) {
          .${f} > * {
            flex: 1 1 ${d}% !important;
            min-width: ${d}% !important;
          }
        }
      `}),h.jsx("div",{className:f,children:i.map(v=>{const b=n===v.id;return t.mode==="link"?h.jsx(wt,{to:`${t.linkPrefix}/${v.id}`,style:p(b),children:_(v,b)},v.id):h.jsx("button",{onClick:()=>t.onTabChange(v.id),style:p(b),children:_(v,b)},v.id)})})]})}function Uy({items:t}){const[e,n]=I.useState(!1),i=I.useRef(null),l=Vn().pathname;I.useEffect(()=>{function d(f){i.current&&!i.current.contains(f.target)&&n(!1)}if(e)return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[e]),I.useEffect(()=>{function d(f){f.key==="Escape"&&n(!1)}if(e)return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[e]);const c=t.filter(d=>d.hidden?!1:d.to?d.to==="/budget"?!(l==="/budget"||/^\/budget\/\d{4}\/\d{1,2}\/\w+$/.test(l)):d.to==="/account"||d.to==="/"?l!==d.to:!l.startsWith(d.to):!0);return h.jsxs("div",{ref:i,style:{position:"relative"},children:[h.jsx("button",{onClick:()=>n(!e),style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:e?"color-mix(in srgb, currentColor 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:"none",cursor:"pointer",fontSize:"1.25rem",color:"inherit",transition:"background 0.15s",lineHeight:1},title:"Menu","aria-expanded":e,"aria-haspopup":"true",children:""}),e&&h.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",minWidth:"180px",background:"#1a1a2e",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",zIndex:1e3,overflow:"hidden"},children:c.map((d,f)=>{if(d.divider)return h.jsx("div",{style:{height:"1px",background:"color-mix(in srgb, currentColor 15%, transparent)",margin:"0.25rem 0"}},f);const p=h.jsxs(h.Fragment,{children:[d.icon&&h.jsx("span",{style:{width:"1.5rem",textAlign:"center"},children:d.icon}),h.jsx("span",{children:d.label})]}),_={display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",fontSize:"0.95rem",color:"inherit",textDecoration:"none",cursor:"pointer",transition:"background 0.15s",background:"transparent",border:"none",width:"100%",textAlign:"left"},v={background:"color-mix(in srgb, currentColor 10%, transparent)"};return d.to?h.jsx(wt,{to:d.to,style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",onClick:()=>n(!1),children:p},f):h.jsx("button",{onClick:()=>{d.onClick?.(),n(!1)},style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",children:p},f)})})]})}function ui({title:t,showBackArrow:e=!1,hideMenu:n=!1}){const{isAdmin:i}=on(),a=[{label:"Budget",icon:"",to:"/budget"},{label:"Budget Settings",icon:"",to:"/budget/settings"},{label:"Analytics",icon:"",to:"/budget/analytics"},...i?[{label:"Admin",icon:"",to:"/budget/admin"}]:[],{label:"Switch Budgets",icon:"",to:"/budget/my-budgets"},{divider:!0,label:""},{label:"Exit Budget App",icon:"",to:"/"}];return h.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[h.jsx("div",{children:e?h.jsx(wt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none"},title:"Back to Home",children:""}):h.jsx(wt,{to:"/budget",title:"Budget Home",children:h.jsx("img",{src:"/budget-icon.svg",alt:"Budget",style:{width:"1.5rem",height:"1.5rem"}})})}),h.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem",textAlign:"center"},children:t}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:!n&&h.jsx(Uy,{items:a})})]})}const t6="900px";function n6({children:t,style:e}){return h.jsx("div",{style:{width:"100%",maxWidth:t6,marginLeft:"auto",marginRight:"auto",...e},children:t})}function Cg(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function r6(){return h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[h.jsx("div",{style:{display:"flex",alignItems:"center"},children:h.jsx(wt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),h.jsxs(wt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[h.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),h.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"SQL Test"})]}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:h.jsx(Uy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),h.jsx("h1",{children:"SQL Test"}),h.jsx("h2",{children:"Setup"}),h.jsxs("h3",{children:["1. Open up your preferred web browser to ",h.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),h.jsxs("ul",{children:[h.jsx("li",{children:"This is a basic online sql query editor"}),h.jsxs("li",{children:["It will include three tables: ",h.jsx("b",{children:'"Customer"'}),", ",h.jsx("b",{children:'"Orders"'}),", and ",h.jsx("b",{children:'"Shippings"'})]})]}),h.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),h.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:h.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),h.jsx("h2",{children:"SQL Problems"}),h.jsx("p",{children:"Write queries in the online editor to answer these questions."}),h.jsx("h3",{children:"Question #1"}),h.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),h.jsx("h3",{children:"Question #2"}),h.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function i6(){const t=I.useContext(eu),e=Ba(),[n,i]=I.useState(!1),a=Vn(),l=Uh(),c=a.state?.from||"/";I.useEffect(()=>{t.is_logged_in&&c!=="/"&&l(c,{replace:!0})},[t.is_logged_in,c,l]);function d(){i(!0),e.logout_firebase_user().then(function(){i(!1)})}return h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[h.jsx("div",{style:{display:"flex",alignItems:"center"},children:h.jsx(wt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),h.jsxs(wt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[h.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),h.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"Account"})]}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:h.jsx(Uy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),h.jsx("h1",{children:"Account"}),t.is_logged_in?n?h.jsx("p",{children:"Logging Out..."}):h.jsxs(h.Fragment,{children:[h.jsxs("p",{children:["You are logged in as ",t.username]}),h.jsx("button",{onClick:d,style:{marginTop:"1rem"},children:"Logout"})]}):h.jsx(s6,{})]})}function s6(){const t=Ba(),[e,n]=I.useState(""),[i,a]=I.useState(""),[l,c]=I.useState(!1),[d,f]=I.useState("");function p(b){n(b.target.value)}function _(b){a(b.target.value)}function v(b){b.preventDefault(),c(!0),f(""),t.login_firebase_user(e,i).then(function(){}).catch(function(){f("Incorrect login credentials")}).finally(function(){c(!1)})}return h.jsxs("form",{onSubmit:v,children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"username",children:"Email: "}),h.jsx("input",{id:"username",type:"email",value:e,onChange:p})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"password",children:"Password: "}),h.jsx("input",{id:"password",type:"password",value:i,onChange:_})]}),l?h.jsx("p",{children:"Logging in..."}):h.jsx("button",{children:"Login"}),d&&h.jsx("p",{style:{color:"red"},children:d})]})}function An(t,e){const n=M5(t),i=X5(),a=nM(),l=n.data,c=l?.budget||null,d=I.useMemo(()=>l?.accounts||{},[l?.accounts]),f=I.useMemo(()=>l?.accountGroups||{},[l?.accountGroups]),p=I.useMemo(()=>l?.categories||{},[l?.categories]),_=I.useMemo(()=>l?.categoryGroups||[],[l?.categoryGroups]),v=l?.categoryBalancesSnapshot||null,b=c?.owner_id===e,T=I.useMemo(()=>c?.user_ids||[],[c?.user_ids]),S=I.useMemo(()=>c?.accepted_user_ids||[],[c?.accepted_user_ids]),A=I.useCallback(async K=>{if(!t)throw new Error("No budget selected");await i.updateAccounts.mutateAsync({budgetId:t,accounts:K})},[t,i.updateAccounts]),R=I.useCallback(async K=>{if(!t)throw new Error("No budget selected");await i.updateAccountGroups.mutateAsync({budgetId:t,accountGroups:K})},[t,i.updateAccountGroups]),z=I.useCallback(async K=>{if(!t)throw new Error("No budget selected");await i.updateCategories.mutateAsync({budgetId:t,categories:K})},[t,i.updateCategories]),F=I.useCallback(async K=>{if(!t)throw new Error("No budget selected");await i.updateCategoryGroups.mutateAsync({budgetId:t,categoryGroups:K})},[t,i.updateCategoryGroups]),U=I.useCallback(async(K,te)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.updateAccounts.mutateAsync({budgetId:t,accounts:K}),i.updateAccountGroups.mutateAsync({budgetId:t,accountGroups:te})])},[t,i]),X=I.useCallback(async(K,te)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.updateCategories.mutateAsync({budgetId:t,categories:K}),i.updateCategoryGroups.mutateAsync({budgetId:t,categoryGroups:te})])},[t,i]),Z=I.useCallback(async K=>{if(!t)throw new Error("No budget selected");await i.renameBudget.mutateAsync({budgetId:t,newName:K})},[t,i.renameBudget]),oe=I.useCallback(async K=>{if(!e)throw new Error("Not authenticated");return await a.createBudget.mutateAsync({name:K.trim()||"My Budget",userId:e,userEmail:null})},[e,a.createBudget]),M=I.useCallback(async K=>{if(!t)throw new Error("No budget selected");await a.inviteUser.mutateAsync({budgetId:t,userId:K})},[t,a.inviteUser]),C=I.useCallback(async K=>{if(!t)throw new Error("No budget selected");await a.revokeUser.mutateAsync({budgetId:t,userId:K})},[t,a.revokeUser]),D=I.useCallback(async K=>{if(!e)throw new Error("Not authenticated");await a.acceptInvite.mutateAsync({budgetId:K,userId:e})},[e,a.acceptInvite]),N=I.useCallback(async(K,te,L)=>{if(!t)throw new Error("No budget selected");await i.saveCategoryBalancesSnapshot.mutateAsync({budgetId:t,balances:K,year:te,month:L})},[t,i.saveCategoryBalancesSnapshot]),j=I.useCallback(async(K,te,L,G)=>{if(!t)throw new Error("No budget selected");await i.recalculateCategoryBalances.mutateAsync({budgetId:t,categories:K,balances:te,year:L,month:G})},[t,i.recalculateCategoryBalances]),B=I.useCallback(K=>{if(!t)return;const te=Ne.getQueryData(ne.budget(t));te&&Ne.setQueryData(ne.budget(t),{...te,accounts:K})},[t]),O=I.useCallback(K=>{if(!t)return;const te=Ne.getQueryData(ne.budget(t));te&&Ne.setQueryData(ne.budget(t),{...te,accountGroups:K})},[t]),Y=I.useCallback(K=>{if(!t)return;const te=Ne.getQueryData(ne.budget(t));te&&Ne.setQueryData(ne.budget(t),{...te,categories:K})},[t]),q=I.useCallback(K=>{if(!t)return;const te=Ne.getQueryData(ne.budget(t));te&&Ne.setQueryData(ne.budget(t),{...te,categoryGroups:K})},[t]),P=I.useCallback(K=>{if(!t)return;const te=Ne.getQueryData(ne.budget(t));te&&Ne.setQueryData(ne.budget(t),{...te,categoryBalancesSnapshot:K})},[t]),Q=I.useCallback(async()=>{t&&await Ne.invalidateQueries({queryKey:ne.budget(t)})},[t]),H=I.useCallback(()=>Object.entries(d).filter(([,K])=>{const te=K.account_group_id?f[K.account_group_id]:void 0,L=te?.on_budget!==void 0?te.on_budget:K.on_budget!==!1,G=te?.is_active!==void 0?te.is_active:K.is_active!==!1;return L&&G}).reduce((K,[,te])=>K+te.balance,0),[d,f]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:c,accounts:d,accountGroups:f,categories:p,categoryGroups:_,categoryBalancesSnapshot:v,isOwner:b,budgetUserIds:T,acceptedUserIds:S,saveAccounts:A,saveAccountGroups:R,saveCategories:z,saveCategoryGroups:F,saveAccountsAndGroups:U,saveCategoriesAndGroups:X,renameBudget:Z,createBudget:oe,inviteUser:M,revokeUser:C,acceptInvite:D,saveCategoryBalancesSnapshot:N,recalculateCategoryBalances:j,setAccountsOptimistic:B,setAccountGroupsOptimistic:O,setCategoriesOptimistic:Y,setCategoryGroupsOptimistic:q,setCategoryBalancesSnapshotOptimistic:P,refreshBudget:Q,getOnBudgetTotal:H}}function xl(t,e,n){const i=L5(t,e,n,{enabled:!!t}),a=z5(t,{enabled:!!t}),l=tM(),c=i.data?.month||null,d=c?.income||[],f=c?.expenses||[],p=c?.allocations||[],_=c?.category_balances||[],v=c?.total_income||0,b=c?.total_expenses||0,T=c?.allocations_finalized||!1,S=I.useMemo(()=>{if(c?.previous_month_snapshot?.total_income!==void 0)return c.previous_month_snapshot.total_income;if(!t)return 0;let j=e,B=n-1;return B<1&&(B=12,j-=1),Ne.getQueryData(ne.month(t,j,B))?.month?.total_income||0},[c,t,e,n]),A=a.data||[],R=I.useCallback(async(j,B,O,Y,q)=>{if(!t)throw new Error("No budget selected");const[P,Q]=O.split("-").map(Number);await l.addIncome.mutateAsync({budgetId:t,year:P,month:Q,amount:j,accountId:B,date:O,payee:Y,description:q})},[t,l.addIncome]),z=I.useCallback(async(j,B,O,Y,q,P)=>{if(!t||!c)throw new Error("No budget or month loaded");const Q=c.income.find(H=>H.id===j);if(!Q)throw new Error("Income not found");await l.updateIncome.mutateAsync({budgetId:t,year:e,month:n,incomeId:j,amount:B,accountId:O,date:Y,payee:q,description:P,oldAmount:Q.amount,oldAccountId:Q.account_id})},[t,c,e,n,l.updateIncome]),F=I.useCallback(async j=>{if(!t||!c)throw new Error("No budget or month loaded");const B=c.income.find(O=>O.id===j);if(!B)throw new Error("Income not found");await l.deleteIncome.mutateAsync({budgetId:t,year:e,month:n,incomeId:j,amount:B.amount,accountId:B.account_id})},[t,c,e,n,l.deleteIncome]),U=I.useCallback(async(j,B,O,Y,q,P)=>{if(!t)throw new Error("No budget selected");const[Q,H]=Y.split("-").map(Number);await l.addExpense.mutateAsync({budgetId:t,year:Q,month:H,amount:j,categoryId:B,accountId:O,date:Y,payee:q,description:P})},[t,l.addExpense]),X=I.useCallback(async(j,B,O,Y,q,P,Q)=>{if(!t||!c)throw new Error("No budget or month loaded");const H=c.expenses?.find(K=>K.id===j);if(!H)throw new Error("Expense not found");await l.updateExpense.mutateAsync({budgetId:t,year:e,month:n,expenseId:j,amount:B,categoryId:O,accountId:Y,date:q,payee:P,description:Q,oldAmount:H.amount,oldAccountId:H.account_id})},[t,c,e,n,l.updateExpense]),Z=I.useCallback(async j=>{if(!t||!c)throw new Error("No budget or month loaded");const B=c.expenses?.find(O=>O.id===j);if(!B)throw new Error("Expense not found");await l.deleteExpense.mutateAsync({budgetId:t,year:e,month:n,expenseId:j,amount:B.amount,accountId:B.account_id})},[t,c,e,n,l.deleteExpense]),oe=I.useCallback(async j=>{if(!t)throw new Error("No budget selected");await l.saveAllocations.mutateAsync({budgetId:t,year:e,month:n,allocations:j})},[t,e,n,l.saveAllocations]),M=I.useCallback(async j=>{if(!t)throw new Error("No budget selected");await l.finalizeAllocations.mutateAsync({budgetId:t,year:e,month:n,allocations:j})},[t,e,n,l.finalizeAllocations]),C=I.useCallback(async()=>{if(!t)throw new Error("No budget selected");await l.unfinalizeAllocations.mutateAsync({budgetId:t,year:e,month:n})},[t,e,n,l.unfinalizeAllocations]),D=I.useCallback(async()=>{if(!t)throw new Error("No budget selected");await l.deleteAllocations.mutateAsync({budgetId:t,year:e,month:n})},[t,e,n,l.deleteAllocations]),N=I.useCallback(async()=>{t&&await Ne.invalidateQueries({queryKey:ne.month(t,e,n)})},[t,e,n]);return{isLoading:i.isLoading,isFetching:i.isFetching,error:i.error,month:c,income:d,expenses:f,allocations:p,categoryBalances:_,totalIncome:v,totalExpenses:b,allocationsFinalized:T,previousMonthIncome:S,payees:A,payeesLoading:a.isLoading,addIncome:R,updateIncome:z,deleteIncome:F,addExpense:U,updateExpense:X,deleteExpense:Z,saveAllocations:oe,finalizeAllocations:M,unfinalizeAllocations:C,deleteAllocations:D,refreshMonth:N}}function a6(){const{selectedBudgetId:t,currentUserId:e}=on(),{budget:n,accounts:i,accountGroups:a,saveAccounts:l,saveAccountGroups:c,saveAccountsAndGroups:d,setAccountsOptimistic:f,setAccountGroupsOptimistic:p}=An(t,e),[_,v]=I.useState(null),b=I.useMemo(()=>Object.entries(i).reduce((C,[D,N])=>{const j=N.account_group_id||"ungrouped";return C[j]||(C[j]=[]),C[j].push({...N,id:D}),C},{}),[i]),T=I.useMemo(()=>Object.entries(a).sort(([,C],[,D])=>C.sort_order-D.sort_order).map(([C,D])=>({...D,id:C})),[a]),S=I.useCallback((C,D)=>{if(!n)return;const N=Object.values(i).filter(q=>D==="ungrouped"?!q.account_group_id:q.account_group_id===D),j=N.length>0?Math.max(...N.map(q=>q.sort_order)):-1,B=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,O={nickname:C.nickname,balance:0,account_group_id:D==="ungrouped"?null:D,sort_order:j+1,is_income_account:C.is_income_account,is_income_default:C.is_income_default,is_outgo_account:C.is_outgo_account,is_outgo_default:C.is_outgo_default,on_budget:C.on_budget!==!1,is_active:C.is_active!==!1},Y={...i};C.is_income_default&&Object.keys(Y).forEach(q=>{Y[q]={...Y[q],is_income_default:!1}}),C.is_outgo_default&&Object.keys(Y).forEach(q=>{Y[q]={...Y[q],is_outgo_default:!1}}),Y[B]=O,f(Y),l(Y).catch(q=>{console.error("[useAccountHandlers] Error creating account:",q),v(q instanceof Error?q.message:"Failed to create account.")})},[n,i,f,l]),A=I.useCallback((C,D)=>{if(!n)return;const N=i[C];if(!N)return;const j=N.account_group_id||"ungrouped",B=D.account_group_id;let O=N.sort_order;if(j!==(B||"ungrouped")){const q=Object.values(i).filter(P=>(P.account_group_id||"ungrouped")===(B||"ungrouped"));O=q.length>0?Math.max(...q.map(P=>P.sort_order))+1:0}const Y={};Object.entries(i).forEach(([q,P])=>{q===C?Y[q]={...P,nickname:D.nickname,account_group_id:B,sort_order:O,is_income_account:D.is_income_account,is_income_default:D.is_income_default,is_outgo_account:D.is_outgo_account,is_outgo_default:D.is_outgo_default,on_budget:D.on_budget!==!1,is_active:D.is_active!==!1}:(Y[q]={...P},D.is_income_default&&!N.is_income_default&&(Y[q].is_income_default=!1),D.is_outgo_default&&!N.is_outgo_default&&(Y[q].is_outgo_default=!1))}),f(Y),l(Y).catch(q=>{console.error("[useAccountHandlers] Error saving account:",q),v(q instanceof Error?q.message:"Failed to save account.")})},[n,i,f,l]),R=I.useCallback(C=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[C]:D,...N}=i;f(N),l(N).catch(j=>{console.error("[useAccountHandlers] Error deleting account:",j),v(j instanceof Error?j.message:"Failed to delete account.")})},[n,i,f,l]),z=I.useCallback(async(C,D)=>{const N=i[C];if(!N)return;const j=N.account_group_id||"ungrouped",B=Object.entries(i).filter(([,H])=>(H.account_group_id||"ungrouped")===j).sort(([,H],[,K])=>H.sort_order-K.sort_order),O=B.findIndex(([H])=>H===C),Y=D==="up"?O-1:O+1;if(Y<0||Y>=B.length)return;const[q,P]=B[Y],Q={};if(Object.entries(i).forEach(([H,K])=>{H===C?Q[H]={...K,sort_order:P.sort_order}:H===q?Q[H]={...K,sort_order:N.sort_order}:Q[H]={...K}}),f(Q),!!n)try{await l(Q)}catch(H){f(i),v(H instanceof Error?H.message:"Failed to move account")}},[n,i,f,l]),F=I.useCallback(C=>{if(!n)return;const D=Object.values(a).map(Y=>Y.sort_order),N=D.length>0?Math.max(...D):-1,j=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,B={name:C.name,sort_order:N+1,expected_balance:C.expected_balance,on_budget:C.on_budget,is_active:C.is_active},O={...a,[j]:B};p(O),c(O).catch(Y=>{console.error("[useAccountHandlers] Error creating group:",Y),v(Y instanceof Error?Y.message:"Failed to create account type.")})},[n,a,p,c]),U=I.useCallback((C,D)=>{if(!n)return;const N={...a,[C]:{...a[C],name:D.name,expected_balance:D.expected_balance,on_budget:D.on_budget,is_active:D.is_active}};p(N),c(N).catch(j=>{console.error("[useAccountHandlers] Error updating group:",j),v(j instanceof Error?j.message:"Failed to update account type.")})},[n,a,p,c]),X=I.useCallback(C=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const D={};Object.entries(i).forEach(([B,O])=>{D[B]=O.account_group_id===C?{...O,account_group_id:null}:O});const{[C]:N,...j}=a;f(D),p(j),d(D,j).catch(B=>{console.error("[useAccountHandlers] Error deleting group:",B),v(B instanceof Error?B.message:"Failed to delete account type.")})},[n,i,a,f,p,d]),Z=I.useCallback(async(C,D)=>{const N=Object.entries(a).sort(([,q],[,P])=>q.sort_order-P.sort_order),j=N.findIndex(([q])=>q===C),B=D==="up"?j-1:j+1;if(B<0||B>=N.length)return;const[O]=N.splice(j,1);N.splice(B,0,O);const Y={};if(N.forEach(([q,P],Q)=>{Y[q]={...P,sort_order:Q}}),p(Y),!!n)try{await c(Y)}catch(q){p(a),v(q instanceof Error?q.message:"Failed to move account type")}},[n,a,p,c]),oe=I.useCallback(async(C,D,N)=>{const j=i[C];if(!j)return;const B=N==="ungrouped"?null:N,O=Object.entries(i).filter(([,P])=>(P.account_group_id||"ungrouped")===N),Y={};Object.entries(i).forEach(([P,Q])=>{P!==C&&(Y[P]={...Q})});let q;if(D==="__group_end__"||O.length===0||!O.find(([P])=>P===D))q=(O.length>0?Math.max(...O.filter(([Q])=>Q!==C).map(([,Q])=>Q.sort_order)):-1)+1;else{const P=O.find(([Q])=>Q===D);if(P){const[,Q]=P;q=Q.sort_order,Object.entries(Y).forEach(([H,K])=>{(K.account_group_id||"ungrouped")===N&&K.sort_order>=q&&(Y[H]={...K,sort_order:K.sort_order+1})})}else q=0}if(Y[C]={...j,account_group_id:B,sort_order:q},f(Y),!!n)try{await l(Y)}catch(P){v(P instanceof Error?P.message:"Failed to save changes")}},[n,i,f,l]),M=I.useCallback(async(C,D)=>{if(C===D)return;const N=Object.entries(a).sort(([,q],[,P])=>q.sort_order-P.sort_order),j=N.findIndex(([q])=>q===C),B=[...N],[O]=B.splice(j,1);if(D==="__end__")B.push(O);else{const q=B.findIndex(([P])=>P===D);B.splice(q,0,O)}const Y={};if(B.forEach(([q,P],Q)=>{Y[q]={...P,sort_order:Q}}),p(Y),!!n)try{await c(Y)}catch(q){v(q instanceof Error?q.message:"Failed to save new order")}},[n,a,p,c]);return{accounts:i,accountGroups:a,accountsByGroup:b,sortedGroups:T,currentBudget:n,error:_,setError:v,handleCreateAccount:S,handleUpdateAccount:A,handleDeleteAccount:R,handleMoveAccount:z,handleCreateGroup:F,handleUpdateGroup:U,handleDeleteGroup:X,handleMoveGroup:Z,reorderAccountsInGroup:oe,reorderGroups:M}}function _x(t,e){if(!t)return{};const n={};return Object.entries(e).forEach(([i,a])=>{if(a.default_monthly_type==="percentage")return;const l=t.allocations?.find(c=>c.category_id===i);l?n[i]=l.amount.toString():a.default_monthly_amount!==void 0&&a.default_monthly_amount>0?n[i]=a.default_monthly_amount.toString():n[i]=""}),n}function o6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=on(),{categories:a,categoryBalancesSnapshot:l,getOnBudgetTotal:c}=An(t,e),{month:d,isLoading:f,previousMonthIncome:p,saveAllocations:_,finalizeAllocations:v,deleteAllocations:b}=xl(t,n,i),T=I.useMemo(()=>_x(d,a),[d,a]),[S,A]=I.useState(T),[R,z]=I.useState(!1),[F,U]=I.useState(!1),[X,Z]=I.useState(!1),[oe,M]=I.useState(!1),[C,D]=I.useState(null),N=I.useRef(null),j=I.useMemo(()=>l&&!l.is_stale?Object.values(l.balances).reduce((J,ie)=>J+(ie?.current??0),0):Object.values(a).reduce((J,ie)=>J+ie.balance,0),[a,l]);I.useEffect(()=>{if(!d)return;const J=`${d.year}-${d.month}`;N.current!==J&&(A(_x(d,a)),N.current=J)},[d,a]);const B=I.useCallback((J,ie)=>{if(ie.default_monthly_type==="percentage"&&ie.default_monthly_amount!==void 0)return ie.default_monthly_amount/100*p;const _e=S[J],Ee=parseFloat(_e||"0");return isNaN(Ee)?0:Ee},[S,p]),O=I.useMemo(()=>Object.entries(a).reduce((J,[ie,_e])=>J+B(ie,_e),0),[a,B]),Y=c(),q=d?.allocations_finalized?(d.allocations||[]).reduce((J,ie)=>J+ie.amount,0):0,P=Y-j,Q=I.useMemo(()=>P-O+q,[P,O,q]),H=I.useCallback((J,ie)=>{A(_e=>({..._e,[J]:ie}))},[]),K=I.useCallback(()=>{if(!d)return;const J={};Object.entries(a).forEach(([ie,_e])=>{if(_e.default_monthly_type==="percentage")return;const Ee=d.allocations?.find(be=>be.category_id===ie);Ee?J[ie]=Ee.amount.toString():_e.default_monthly_amount!==void 0&&_e.default_monthly_amount>0?J[ie]=_e.default_monthly_amount.toString():J[ie]=""}),A(J),M(!1)},[d,a]),te=I.useCallback(()=>{const J=[];return Object.entries(a).forEach(([ie,_e])=>{const Ee=B(ie,_e);Ee>0&&J.push({category_id:ie,amount:Ee})}),J},[a,B]),L=I.useCallback(async()=>{D(null),z(!0);try{await _(te()),M(!1)}catch(J){D(J instanceof Error?J.message:"Failed to save allocations")}finally{z(!1)}},[_,te]),G=I.useCallback(async()=>{D(null),U(!0);try{await v(te()),M(!1)}catch(J){D(J instanceof Error?J.message:"Failed to finalize allocations")}finally{U(!1)}},[v,te]),ce=I.useCallback(async()=>{D(null),Z(!0);try{await b();const J={};Object.entries(a).forEach(([ie,_e])=>{_e.default_monthly_type!=="percentage"&&(_e.default_monthly_amount!==void 0&&_e.default_monthly_amount>0?J[ie]=_e.default_monthly_amount.toString():J[ie]="")}),A(J),M(!1)}catch(J){D(J instanceof Error?J.message:"Failed to delete allocations")}finally{Z(!1)}},[b,a]);return{localAllocations:S,isSavingAllocations:R,isFinalizingAllocations:F,isDeletingAllocations:X,isEditingAppliedAllocations:oe,error:C,monthLoading:f,onBudgetTotal:Y,availableNow:P,currentDraftTotal:O,availableAfterApply:Q,previousMonthIncome:p,allocationsFinalized:d?.allocations_finalized??!1,getAllocationAmount:B,handleAllocationChange:H,resetAllocationsToSaved:K,handleSaveAllocations:L,handleFinalizeAllocations:G,handleDeleteAllocations:ce,setIsEditingAppliedAllocations:M,setError:D}}function l6({budgetId:t,categories:e,categoryBalancesSnapshot:n,currentYear:i,currentMonth:a,saveCategoryBalancesSnapshot:l,recalculateCategoryBalancesMutation:c}){const d=I.useCallback(F=>!(!F||F.is_stale||F.computed_for_year!==i||F.computed_for_month!==a),[i,a]),f=I.useMemo(()=>{if(!d(n))return{};const F={};return Object.keys(e).forEach(U=>{const X=n.balances[U];F[U]=X||{current:0,total:0}}),F},[n,e,d]),[p,_]=I.useState(f),[v,b]=I.useState(!1),[T,S]=I.useState(null),A=I.useRef(null);I.useEffect(()=>{if(!t||Object.keys(e).length===0)return;const F=`${t}_${i}_${a}`;if(A.current===F)return;if(d(n)){const X={};Object.keys(e).forEach(Z=>{const oe=n.balances[Z];X[Z]=oe||{current:0,total:0}}),_(X),A.current=F;return}(async()=>{b(!0);try{const X=Object.keys(e),{current:Z,total:oe}=await Lp(t,X,i,a,n),M={};X.forEach(C=>{M[C]={current:Z[C]??0,total:oe[C]??0}}),_(M),A.current=F,await l(M,i,a)}catch(X){console.error("Error loading category balances:",X)}finally{b(!1)}})()},[t,e,i,a,n,d,l]);const R=I.useCallback(async()=>{if(!t||Object.keys(e).length===0)return null;const F=Object.keys(e),{total:U}=await Lp(t,F,i,a,null),X={};Object.entries(e).forEach(([oe,M])=>{const C=M.balance,D=U[oe]??0;Math.abs(C-D)>.01&&(X[oe]={stored:C,calculated:D})});const Z=Object.keys(X).length>0?X:null;return S(Z),Z},[t,e,i,a]),z=I.useCallback(async()=>{if(!(!t||Object.keys(e).length===0)){b(!0);try{const F=Object.keys(e),{current:U,total:X}=await Lp(t,F,i,a,null),Z={};Object.entries(e).forEach(([M,C])=>{Z[M]={...C,balance:X[M]??0}});const oe={};F.forEach(M=>{oe[M]={current:U[M]??0,total:X[M]??0}}),await c(Z,oe,i,a),_(oe),S(null)}finally{b(!1)}}},[t,e,c,i,a]);return{categoryBalances:p,loadingBalances:v,categoryBalanceMismatch:T,checkCategoryBalanceMismatch:R,recalculateAndSaveCategoryBalances:z}}function c6({categories:t,categoryGroups:e,currentBudget:n,setCategoriesOptimistic:i,setCategoryGroupsOptimistic:a,saveCategories:l,saveCategoryGroups:c,setError:d}){const[f,p]=I.useState(null),[_,v]=I.useState(null),[b,T]=I.useState(null),[S,A]=I.useState(null);function R(N,j){p("category"),v(j),N.dataTransfer.effectAllowed="move"}function z(N,j,B){N.preventDefault(),f==="category"&&(j!==_&&T(j),A(B))}function F(N,j){N.preventDefault(),f==="category"?(A(j),T(null)):f==="group"&&j!==_&&T(j)}function U(){T(null)}function X(){A(null)}function Z(){p(null),v(null),T(null),A(null)}async function oe(N,j,B){if(N.preventDefault(),N.stopPropagation(),!_||f!=="category"){Z();return}const O=t[_];if(!O)return;const Y=B==="ungrouped"?null:B,q=Object.entries(t).filter(([,H])=>(H.category_group_id||"ungrouped")===B),P={};Object.entries(t).forEach(([H,K])=>{H!==_&&(P[H]=K)});let Q;if(j==="__group_end__"||q.length===0||!q.find(([H])=>H===j))Q=(q.length>0?Math.max(...q.filter(([K])=>K!==_).map(([,K])=>K.sort_order)):-1)+1;else{const H=q.find(([K])=>K===j);H?(Q=H[1].sort_order,Object.entries(P).forEach(([K,te])=>{(te.category_group_id||"ungrouped")===B&&te.sort_order>=Q&&(P[K]={...te,sort_order:te.sort_order+1})})):Q=0}if(P[_]={...O,category_group_id:Y,sort_order:Q},i(P),Z(),!!n)try{await l(P)}catch(H){d(H instanceof Error?H.message:"Failed to save changes")}}async function M(N,j){N.preventDefault(),f==="category"?await oe(N,"__group_end__",j):f==="group"&&await D(N,j)}function C(N,j){N.stopPropagation(),p("group"),v(j),N.dataTransfer.effectAllowed="move"}async function D(N,j){if(N.preventDefault(),!_||f!=="group"||_===j){Z();return}const B=e.findIndex(P=>P.id===_),O=[...e],[Y]=O.splice(B,1);if(j==="__end__")O.push(Y);else{const P=O.findIndex(Q=>Q.id===j);O.splice(P,0,Y)}const q=O.map((P,Q)=>({...P,sort_order:Q}));if(a(q),Z(),!!n)try{await c(q)}catch(P){d(P instanceof Error?P.message:"Failed to save new order")}}return{dragType:f,draggedId:_,dragOverId:b,dragOverGroupId:S,setDragOverId:T,setDragOverGroupId:A,handleCategoryDragStart:R,handleCategoryDragOver:z,handleDragOverGroup:F,handleDragLeave:U,handleDragLeaveGroup:X,handleDragEnd:Z,handleCategoryDrop:oe,handleDropOnGroup:M,handleGroupDragStart:C,handleGroupDrop:D}}function u6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=on(),{budget:a,categories:l,categoryGroups:c,categoryBalancesSnapshot:d,isLoading:f,saveCategories:p,saveCategoryGroups:_,saveCategoriesAndGroups:v,setCategoriesOptimistic:b,setCategoryGroupsOptimistic:T,saveCategoryBalancesSnapshot:S,recalculateCategoryBalances:A,getOnBudgetTotal:R}=An(t,e),[z,F]=I.useState(null),{categoryBalances:U,loadingBalances:X,categoryBalanceMismatch:Z,checkCategoryBalanceMismatch:oe,recalculateAndSaveCategoryBalances:M}=l6({budgetId:t,categories:l,categoryBalancesSnapshot:d,currentYear:n,currentMonth:i,saveCategoryBalancesSnapshot:S,recalculateCategoryBalancesMutation:A}),C=c6({categories:l,categoryGroups:c,currentBudget:a,setCategoriesOptimistic:b,setCategoryGroupsOptimistic:T,saveCategories:p,saveCategoryGroups:_,setError:F});async function D(K,te){if(!a)return;const L=te==="ungrouped"?null:te,G=Object.values(l).filter(Ee=>te==="ungrouped"?!Ee.category_group_id:Ee.category_group_id===te),ce=G.length>0?Math.max(...G.map(Ee=>Ee.sort_order)):-1,J=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,ie={name:K.name,description:K.description,category_group_id:L,sort_order:ce+1,default_monthly_amount:K.default_monthly_amount,default_monthly_type:K.default_monthly_type,balance:0},_e={...l,[J]:ie};b(_e);try{await p(_e)}catch(Ee){b(l),F(Ee instanceof Error?Ee.message:"Failed to create category")}}async function N(K,te){if(a)try{const L=l[K];if(!L)return;const G=L.category_group_id||"ungrouped",ce=te.category_group_id;let J=L.sort_order;if(G!==(ce||"ungrouped")){const _e=Object.values(l).filter(Ee=>(Ee.category_group_id||"ungrouped")===(ce||"ungrouped")).filter((Ee,be,xe)=>l[K]!==xe[be]);J=_e.length>0?Math.max(..._e.map(Ee=>Ee.sort_order))+1:0}const ie={...l,[K]:{...L,name:te.name,description:te.description,category_group_id:ce,sort_order:J,default_monthly_amount:te.default_monthly_amount,default_monthly_type:te.default_monthly_type}};b(ie),await p(ie)}catch(L){F(L instanceof Error?L.message:"Failed to update category")}}async function j(K){if(confirm("Are you sure you want to delete this category?")&&a)try{const{[K]:te,...L}=l;b(L),await p(L)}catch(te){F(te instanceof Error?te.message:"Failed to delete category")}}async function B(K,te){const L=l[K];if(!L)return;const G=L.category_group_id||"ungrouped",ce=Object.entries(l).filter(([,xe])=>(xe.category_group_id||"ungrouped")===G).sort((xe,he)=>xe[1].sort_order-he[1].sort_order),J=ce.findIndex(([xe])=>xe===K),ie=te==="up"?J-1:J+1;if(ie<0||ie>=ce.length)return;const[_e,Ee]=ce[ie],be={};if(Object.entries(l).forEach(([xe,he])=>{xe===K?be[xe]={...he,sort_order:Ee.sort_order}:xe===_e?be[xe]={...he,sort_order:L.sort_order}:be[xe]=he}),b(be),!!a)try{await p(be)}catch(xe){b(l),F(xe instanceof Error?xe.message:"Failed to move category")}}async function O(K){if(a)try{const te=c.length>0?Math.max(...c.map(ce=>ce.sort_order)):-1,L={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:K.name,sort_order:te+1},G=[...c,L];T(G),await _(G)}catch(te){F(te instanceof Error?te.message:"Failed to create group")}}async function Y(K,te){if(a)try{const L=c.map(G=>G.id===K?{...G,name:te.name}:G);T(L),await _(L)}catch(L){F(L instanceof Error?L.message:"Failed to update group")}}async function q(K){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&a)try{const te={};Object.entries(l).forEach(([G,ce])=>{te[G]=ce.category_group_id===K?{...ce,category_group_id:null}:ce});const L=c.filter(G=>G.id!==K);b(te),T(L),await v(te,L)}catch(te){F(te instanceof Error?te.message:"Failed to delete group")}}async function P(K,te){const L=[...c].sort((_e,Ee)=>_e.sort_order-Ee.sort_order),G=L.findIndex(_e=>_e.id===K),ce=te==="up"?G-1:G+1;if(ce<0||ce>=L.length)return;const[J]=L.splice(G,1);L.splice(ce,0,J);const ie=L.map((_e,Ee)=>({..._e,sort_order:Ee}));if(T(ie),!!a)try{await _(ie)}catch(_e){T(c),F(_e instanceof Error?_e.message:"Failed to move group")}}const Q=Object.entries(l).reduce((K,[te,L])=>{const G=L.category_group_id||"ungrouped";return K[G]||(K[G]=[]),K[G].push([te,L]),K},{}),H=[...c].sort((K,te)=>K.sort_order-te.sort_order);return{currentBudget:a,categories:l,categoryGroups:c,categoriesByGroup:Q,sortedGroups:H,categoryBalances:U,isLoading:f,loadingBalances:X,error:z,setError:F,getOnBudgetTotal:R,categoryBalanceMismatch:Z,checkCategoryBalanceMismatch:oe,recalculateAndSaveCategoryBalances:M,handleCreateCategory:D,handleUpdateCategory:N,handleDeleteCategory:j,handleMoveCategory:B,handleCreateGroup:O,handleUpdateGroup:Y,handleDeleteGroup:q,handleMoveGroup:P,dragType:C.dragType,draggedId:C.draggedId,dragOverId:C.dragOverId,dragOverGroupId:C.dragOverGroupId,setDragOverId:C.setDragOverId,setDragOverGroupId:C.setDragOverGroupId,handleCategoryDragStart:C.handleCategoryDragStart,handleCategoryDragOver:C.handleCategoryDragOver,handleDragOverGroup:C.handleDragOverGroup,handleDragLeave:C.handleDragLeave,handleDragLeaveGroup:C.handleDragLeaveGroup,handleDragEnd:C.handleDragEnd,handleCategoryDrop:C.handleCategoryDrop,handleDropOnGroup:C.handleDropOnGroup,handleGroupDragStart:C.handleGroupDragStart,handleGroupDrop:C.handleGroupDrop}}function d6({currentUser:t,onComplete:e}){const[n,i]=I.useState(!1),[a,l]=I.useState(!1),[c,d]=I.useState(null),[f,p]=I.useState(null);async function _(){if(t){l(!0);try{const S=await oi("budgets","budget data migration: scanning all budgets for migration status");let A=0,R=0,z=0;for(const F of S.docs){const U=F.data;if(Array.isArray(U.categories)&&A++,Array.isArray(U.accounts)&&R++,U.categories&&typeof U.categories=="object"&&!Array.isArray(U.categories)){const X=U.categories;Object.values(X).some(oe=>oe.balance===void 0)&&z++}}p({categoriesArrayMigrationNeeded:A>0,accountsArrayMigrationNeeded:R>0,budgetsToMigrateCategories:A,budgetsToMigrateAccounts:R,budgetsNeedingCategoryBalance:z,totalBudgetsChecked:S.docs.length})}catch(S){console.error("Failed to scan migration status:",S)}finally{l(!1)}}}async function v(S,A){const R={};A.forEach(z=>{R[z]=0});try{const z=await oi("months",`budget data migration: calculating category balances for budget ${S}`,[{field:"budget_id",op:"==",value:S}]);for(const F of z.docs){const U=F.data;if(U.allocations_finalized&&U.allocations)for(const X of U.allocations)R[X.category_id]=(R[X.category_id]||0)+X.amount}}catch(z){console.error("Error calculating balances for budget:",S,z)}return R}async function b(S){try{const{exists:A,data:R}=await Ce("budgets",S,"budget data migration: reading budget to check if migration needed");if(!A||!R)return{budgetId:S,budgetName:"Unknown",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Budget not found"};const z=R.name||"Unnamed Budget",F=Array.isArray(R.categories),U=Array.isArray(R.accounts),X=Array.isArray(R.account_groups);if(!F&&!U&&!X)return{budgetId:S,budgetName:z,categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"Already migrated"};let Z=R.categories,oe=R.accounts,M=R.account_groups,C=0,D=0,N=0,j=!1;if(F){const Y=R.categories,q={},P=[];for(const K of Y){const te=K.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;P.push(te),q[te]={name:K.name,description:K.description,category_group_id:K.category_group_id??null,sort_order:K.sort_order??0,default_monthly_amount:K.default_monthly_amount,default_monthly_type:K.default_monthly_type,balance:0}}const Q=await v(S,P);for(const K of P)q[K]&&(q[K].balance=Q[K]||0);const H={};Object.entries(q).forEach(([K,te])=>{H[K]={name:te.name,category_group_id:te.category_group_id??null,sort_order:te.sort_order,balance:te.balance},te.description&&(H[K].description=te.description),te.default_monthly_amount!==void 0&&(H[K].default_monthly_amount=te.default_monthly_amount),te.default_monthly_type!==void 0&&(H[K].default_monthly_type=te.default_monthly_type)}),Z=H,C=Y.length,j=!0}if(U){const Y=R.accounts,q={};for(const P of Y){const Q=P.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;q[Q]={nickname:P.nickname,balance:P.balance??0,account_group_id:P.account_group_id??null,sort_order:P.sort_order??0},P.is_income_account!==void 0&&(q[Q].is_income_account=P.is_income_account),P.is_income_default!==void 0&&(q[Q].is_income_default=P.is_income_default),P.is_outgo_account!==void 0&&(q[Q].is_outgo_account=P.is_outgo_account),P.is_outgo_default!==void 0&&(q[Q].is_outgo_default=P.is_outgo_default),P.on_budget!==void 0&&(q[Q].on_budget=P.on_budget),P.is_active!==void 0&&(q[Q].is_active=P.is_active)}oe=q,D=Y.length}if(X){const Y=R.account_groups,q={};for(const P of Y){const Q=P.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;q[Q]={name:P.name,sort_order:P.sort_order??0},P.expected_balance!==void 0&&(q[Q].expected_balance=P.expected_balance),P.on_budget!==void 0&&(q[Q].on_budget=P.on_budget),P.is_active!==void 0&&(q[Q].is_active=P.is_active)}if(U&&oe){const P=oe,Q=R.account_groups,H={};Q.forEach((K,te)=>{const L=K.id||String(te),G=Object.keys(q)[te];G&&(H[L]=G)}),Object.entries(P).forEach(([K,te])=>{te.account_group_id&&H[te.account_group_id]&&(P[K].account_group_id=H[te.account_group_id])})}M=q,N=Y.length}const{category_balances:B,...O}=R;return await Ze("budgets",S,{...O,categories:Z,accounts:oe,account_groups:M},`budget data migration: saving migrated budget data (categories: ${C}, accounts: ${D}, groups: ${N})`),{budgetId:S,budgetName:z,categoriesMigrated:C,accountsMigrated:D,accountGroupsMigrated:N,balancesCalculated:j}}catch(A){return{budgetId:S,budgetName:"Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:A instanceof Error?A.message:"Migration failed"}}}async function T(){if(!t)return;i(!0),d(null);const S=[];try{const A=await oi("budgets","budget data migration: listing all budgets in system to migrate");if(A.docs.length===0){d([{budgetId:"",budgetName:"No budgets found",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:"No budgets in system"}]),i(!1);return}for(const R of A.docs){const z=await b(R.id);S.push(z)}d(S),e?.()}catch(A){d([{budgetId:"",budgetName:"Migration Error",categoriesMigrated:0,accountsMigrated:0,accountGroupsMigrated:0,balancesCalculated:!1,error:A instanceof Error?A.message:"Migration failed"}])}finally{i(!1)}}return{status:f,isScanning:a,scanStatus:_,isMigrating:n,migrationResults:c,runMigration:T}}function h6(){const t=new Date,e=t.getFullYear();let i=t.getMonth()+1+2,a=e;return i>12&&(i-=12,a+=1),{year:a,month:i}}function f6(t,e,n){return t>n.year||t===n.year&&e>n.month}function m6({currentUser:t,onComplete:e}){const[n,i]=I.useState(!1),[a,l]=I.useState(!1),[c,d]=I.useState(null),[f,p]=I.useState(null);async function _(){if(t){i(!0);try{const b=h6(),T=await oi("months","future months cleanup: scanning for future months"),S=[];for(const A of T.docs){const{budget_id:R,year:z,month:F}=A.data;f6(z,F,b)&&S.push({docId:A.id,budgetId:R,year:z,month:F})}S.sort((A,R)=>A.year!==R.year?A.year-R.year:A.month-R.month),d({futureMonthsToDelete:S,futureMonthsCount:S.length})}catch(b){console.error("Failed to scan future months:",b)}finally{i(!1)}}}async function v(){if(!t||!c||c.futureMonthsToDelete.length===0)return;l(!0),p(null);let b=0;const T=[];for(const S of c.futureMonthsToDelete)try{await Jw("months",S.docId,`future months cleanup: deleting future month ${S.year}-${S.month}`),b++}catch(A){T.push(`Failed to delete ${S.docId}: ${A instanceof Error?A.message:"Unknown error"}`)}p({deleted:b,errors:T}),l(!1),e?.()}return{status:c,isScanning:n,scanStatus:_,isCleaningFutureMonths:a,futureMonthsCleanupResult:f,cleanupFutureMonths:v}}function Fp(t){return t.includes("@")?!1:!!(/_[a-z0-9]+_(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=2||/_[a-z0-9]+\.(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=1)}function p6(t){let e=t;const n=/^(.+)_(gmail|yahoo|hotmail|outlook|icloud|aol|proton|protonmail)\.(.+)$/i,i=e.match(n);return i?`${i[1]}@${i[2]}.${i[3]}`:(e=e.replace(/_com$/,".com").replace(/_net$/,".net").replace(/_org$/,".org").replace(/_edu$/,".edu").replace(/_io$/,".io"),e=e.replace(/_gmail_/,"@gmail.").replace(/_yahoo_/,"@yahoo.").replace(/_hotmail_/,"@hotmail.").replace(/_outlook_/,"@outlook.").replace(/_icloud_/,"@icloud."),e)}function dh(t){if(t===null||typeof t!="object"||Array.isArray(t))return!1;const e=t;return e._methodName==="arrayUnion"&&Array.isArray(e.vc)}function zT(t){return t.vc||[]}function vx(t){return Array.isArray(t.items)?t.items:dh(t.items)?zT(t.items):[]}function g6({currentUser:t}){const[e,n]=I.useState(!1),[i,a]=I.useState(!1),[l,c]=I.useState(null),[d,f]=I.useState(null);async function p(){if(!t)return;n(!0);const v={documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],isHealthy:!0};try{const b=await oi("feedback","feedback migration: scanning for issues");v.documentsFound=b.docs.length;for(const T of b.docs)Fp(T.id)&&v.sanitizedDocuments.push(T.id),dh(T.data.items)&&v.corruptedDocuments.push(T.id);v.isHealthy=v.sanitizedDocuments.length===0&&v.corruptedDocuments.length===0,c(v)}catch(b){console.error("Failed to scan feedback:",b)}finally{n(!1)}}async function _(){if(!t)return;a(!0);const v=d?{...d,mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]}:{documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]};try{const b=await oi("feedback","feedback migration: listing all documents");v.documentsFound=b.docs.length,v.sanitizedDocuments=[],v.corruptedDocuments=[];for(const T of b.docs){const S=Fp(T.id);if(dh(T.data.items)&&!S){v.corruptedDocuments.push(T.id);const R=zT(T.data.items);try{await Ze("feedback",T.id,{items:R,user_email:T.data.user_email||T.id,created_at:T.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: fixing corrupted arrayUnion in ${T.id}`),v.fixedDocuments++}catch(z){v.errors.push(`Failed to fix ${T.id}: ${z instanceof Error?z.message:"Unknown error"}`)}}}for(const T of b.docs)if(Fp(T.id)){v.sanitizedDocuments.push(T.id);const S=T.id,A=p6(S),R=vx(T.data),{exists:z,data:F}=await Ce("feedback",A,`feedback migration: checking if ${A} exists`);if(z&&F){const U=vx(F),X=new Set(U.map(oe=>oe.id)),Z=R.filter(oe=>!X.has(oe.id));if(Z.length>0||dh(F.items)){const oe=[...U,...Z];await Ze("feedback",A,{...F,items:oe,updated_at:new Date().toISOString()},`feedback migration: merging ${Z.length} items from ${S}`),v.mergedItems+=Z.length}}else R.length>0&&(await Ze("feedback",A,{items:R,user_email:A,created_at:T.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: creating ${A} from ${S}`),v.mergedItems+=R.length);try{await Jw("feedback",S,`feedback migration: deleting sanitized document ${S}`),v.deletedDocuments++}catch(U){v.errors.push(`Failed to delete ${S}: ${U instanceof Error?U.message:"Unknown error"}`)}}f(v)}catch(b){v.errors.push(b instanceof Error?b.message:"Migration failed"),f(v)}finally{a(!1)}}return{status:l,isScanning:e,scanStatus:p,isMigratingFeedback:i,feedbackMigrationResult:d,migrateFeedbackDocuments:_}}function y6({onCreateNew:t}){const[e,n]=I.useState(""),[i,a]=I.useState(!1),[l,c]=I.useState(null);async function d(f){f.preventDefault(),a(!0),c(null);try{await t(e.trim()||void 0)}catch(p){c(p instanceof Error?p.message:"Failed to create budget"),a(!1)}}return h.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[h.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),h.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&h.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:l}),h.jsx("button",{onClick:()=>c(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[h.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""})," Create Your Budget"]}),h.jsxs("form",{onSubmit:d,children:[h.jsxs("div",{style:{marginBottom:"1.5rem"},children:[h.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),h.jsx("input",{type:"text",value:e,onChange:f=>n(f.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),h.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),h.jsx("button",{type:"submit",disabled:i,style:{width:"100%",background:ve.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontWeight:600,opacity:i?.7:1,fontSize:"1rem"},children:i?"Creating...":"Create Budget"})]})]}),h.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function _6({invites:t,onAccept:e,onCreateNew:n}){const[i,a]=I.useState(null),[l,c]=I.useState(!1),[d,f]=I.useState(""),[p,_]=I.useState(!1),[v,b]=I.useState(null);async function T(A){a(A),b(null);try{await e(A)}catch(R){b(R instanceof Error?R.message:"Failed to accept invitation"),a(null)}}async function S(A){A.preventDefault(),_(!0),b(null);try{await n(d.trim()||void 0)}catch(R){b(R instanceof Error?R.message:"Failed to create new budget"),_(!1)}}return h.jsxs("div",{children:[h.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),h.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),v&&h.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:v}),h.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[h.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""})," Budget Invitations"]}),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(A=>h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[h.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[h.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:A.budgetName}),A.ownerEmail&&h.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",A.ownerEmail]})]}),h.jsx("button",{onClick:()=>T(A.budgetId),disabled:i!==null||p,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null||p?"not-allowed":"pointer",fontWeight:500,opacity:i!==null||p?.7:1,fontSize:"0.9rem"},children:i===A.budgetId?"Joining...":"Accept & Join"})]},A.budgetId))})]}),h.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?h.jsxs("form",{onSubmit:S,children:[h.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),h.jsxs("div",{style:{marginBottom:"1rem"},children:[h.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),h.jsx("input",{type:"text",value:d,onChange:A=>f(A.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),h.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[h.jsx("button",{type:"submit",disabled:p||i!==null,style:{background:ve.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p||i!==null?"not-allowed":"pointer",fontWeight:500,opacity:p||i!==null?.7:1,fontSize:"0.9rem"},children:p?"Creating...":"Create Budget"}),h.jsx("button",{type:"button",onClick:()=>{c(!1),f("")},disabled:p,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p?"not-allowed":"pointer",fontWeight:500,opacity:p?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):h.jsxs("div",{style:{textAlign:"center"},children:[h.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),h.jsx("button",{onClick:()=>c(!0),disabled:i!==null,style:{background:ve.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null?"not-allowed":"pointer",fontWeight:500,opacity:i!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function v6({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const i=I.useMemo(()=>[{id:"income",label:"Income"},{id:"allocations",label:"Allocations",checkmark:n},{id:"spend",label:"Spend"},{id:"balances",label:"Balances"}],[n]);return h.jsx(zy,{mode:"button",tabs:i,activeTab:t,onTabChange:a=>e(a)})}function b6({isOpen:t,onClose:e,onProceed:n,results:i}){const a=!i||i.status==="confirming",l=i&&!["confirming","done","error"].includes(i.status),c=a||i?.status==="done"||i?.status==="error";function d(){c&&e()}return h.jsx(Vh,{isOpen:t,onClose:d,title:"Recalculate Balances",width:"540px",children:h.jsxs("div",{style:{padding:"0.5rem 0"},children:[a&&h.jsxs(h.Fragment,{children:[h.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",lineHeight:1.5},children:["This will recalculate category balances and account balances from the ",h.jsx("strong",{children:"current month forward"}),"."]}),h.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Use this if your data seems out of sync or after fixing bugs. Past months will not be modified."}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginBottom:"1.5rem"},children:[h.jsx(Io,{status:"waiting",label:"Find all months to process"}),h.jsx(Io,{status:"waiting",label:"Process months"}),h.jsx(Io,{status:"waiting",label:"Update budget totals"})]}),h.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[h.jsx(ke,{variant:"secondary",onClick:e,children:"Cancel"}),h.jsx(ke,{onClick:n,children:"Proceed"})]})]}),!a&&h.jsxs(h.Fragment,{children:[h.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Recalculating category balances and account balances..."}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[h.jsx(Io,{status:i?.status==="pending"?"waiting":"complete",label:"Find all months to process",detail:i&&i.status!=="pending"?`Found ${i.monthsFound||0} month${i.monthsFound!==1?"s":""}`:void 0}),h.jsx(Io,{status:bx(i?.status,["pending","finding_months"],"processing_months"),label:"Process months",detail:i?.status==="processing_months"?`Processing: ${i.currentMonthLabel} (${(i.currentMonthIndex||0)+1}/${i.monthsFound||0})`:i?.monthsProcessed!==void 0?`Processed ${i.monthsProcessed} month${i.monthsProcessed!==1?"s":""}`:void 0}),h.jsx(Io,{status:i?.status==="error"?"error":bx(i?.status,["pending","finding_months","processing_months"],"updating_budget"),label:"Update budget totals",detail:i?.status==="error"?i.error:void 0,isError:i?.status==="error"})]}),i?.status==="done"&&h.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${ve.success} 10%, transparent)`,border:`1px solid ${ve.success}`,borderRadius:"8px",textAlign:"center"},children:[h.jsx("p",{style:{margin:0,fontWeight:600,color:ve.success},children:" Recalculation complete!"}),h.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:[i.monthsProcessed," month",i.monthsProcessed!==1?"s":""," processed",h.jsx("br",{}),"Total Income: ",qe(i.totalIncomeRecalculated||0),h.jsx("br",{}),"Total Expenses: ",qe(i.totalExpensesRecalculated||0)]})]}),(i?.status==="done"||i?.status==="error")&&h.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"center"},children:h.jsx(ke,{onClick:e,children:"Done"})}),l&&h.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"Please wait, do not close this window..."})]})]})})}function bx(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function Io({status:t,label:e,detail:n,isError:i}){const a=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[h.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:a}),h.jsxs("div",{style:{flex:1},children:[h.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:i?1:.6,color:i?ve.error:"inherit"},children:n})]})]})}function Fy({isDisabled:t}){const{selectedBudgetId:e,currentUserId:n,currentYear:i,currentMonthNumber:a}=on(),{categories:l,accounts:c,recalculateCategoryBalances:d,saveAccounts:f}=An(e,n),[p,_]=I.useState(!1),[v,b]=I.useState(!1),[T,S]=I.useState(null);function A(){b(!0),S({status:"confirming"})}async function R(){if(e){_(!0),S({status:"pending"});try{S({status:"finding_months"});const U=(await oi("months","recalculate: finding all months for budget",[{field:"budget_id",op:"==",value:e}])).docs.map(G=>({id:G.id,...G.data})).sort((G,ce)=>G.year!==ce.year?G.year-ce.year:G.month-ce.month),X=new Date,Z=i||X.getFullYear(),oe=a||X.getMonth()+1,M=U.filter(G=>G.year>Z||G.year===Z&&G.month>=oe),C=U.filter(G=>G.year<Z||G.year===Z&&G.month<oe),D=C.length>0?C[C.length-1]:null,N=Object.keys(l);S({status:"finding_months",monthsFound:M.length}),await new Promise(G=>setTimeout(G,100));const j={};if(D){const G=Tt(e,D.year,D.month),{exists:ce,data:J}=await Ce("months",G,"recalculate: reading previous month for starting balances");if(ce&&J?.category_balances)for(const ie of J.category_balances)j[ie.category_id]=ie.end_balance??0}N.forEach(G=>{j[G]===void 0&&(j[G]=0)});let B=0,O=0;for(let G=0;G<M.length;G++){const ce=M[G],J=`${My[ce.month-1]} ${ce.year}`;S({status:"processing_months",monthsFound:M.length,currentMonthIndex:G,currentMonthLabel:J});const ie=Tt(e,ce.year,ce.month),{exists:_e,data:Ee}=await Ce("months",ie,`recalculate: reading full month data for ${J}`);if(!_e||!Ee){console.warn(`Month ${J} not found, skipping`);continue}const be=Ee.income||[],xe=Ee.expenses||[],he=Ee.allocations||[],nt=Ee.allocations_finalized||!1,Fe=be.reduce((Ct,st)=>Ct+st.amount,0),ln=xe.reduce((Ct,st)=>Ct+st.amount,0);B+=Fe,O+=ln;const en=N.map(Ct=>{const st=j[Ct]??0;let St=0;if(nt&&he.length>0){const fr=he.find(Yt=>Yt.category_id===Ct);fr&&(St=fr.amount)}let Yn=0;xe.length>0&&(Yn=xe.filter(fr=>fr.category_id===Ct).reduce((fr,Yt)=>fr+Yt.amount,0));const Sl=st+St-Yn;return{category_id:Ct,start_balance:st,allocated:St,spent:Yn,end_balance:Sl}});en.forEach(Ct=>{j[Ct.category_id]=Ct.end_balance});let Or=Ee.previous_month_snapshot;const Mr=G===0?D:M[G-1];if(Mr){const Ct={};en.forEach(st=>{Ct[st.category_id]=st.start_balance}),Or={...Or||{},total_income:Mr.total_income||0,account_balances_end:Or?.account_balances_end||{},category_balances_end:Ct,snapshot_taken_at:new Date().toISOString()}}const Ws={budget_id:e,year:ce.year,month:ce.month,income:be,total_income:Fe,expenses:xe,total_expenses:ln,allocations:he,allocations_finalized:nt,category_balances:en,category_balances_stale:!1,previous_month_snapshot:Or,previous_month_snapshot_stale:!1,account_balances_start:Ee.account_balances_start,account_balances_end:Ee.account_balances_end,created_at:Ee.created_at||new Date().toISOString(),updated_at:new Date().toISOString()};await Cr(e,Ws),await new Promise(Ct=>setTimeout(Ct,50))}const Y={};Object.keys(c).forEach(G=>{Y[G]=0});for(const G of U){const ce=Tt(e,G.year,G.month),{exists:J,data:ie}=await Ce("months",ce,`recalculate: reading month ${G.year}/${G.month} for account balances`);if(!J||!ie)continue;const _e=ie.income||[],Ee=ie.expenses||[];for(const be of _e)be.account_id&&Y[be.account_id]!==void 0&&(Y[be.account_id]+=be.amount);for(const be of Ee)be.account_id&&Y[be.account_id]!==void 0&&(Y[be.account_id]-=be.amount)}const q={};Object.entries(c).forEach(([G,ce])=>{q[G]={...ce,balance:Y[G]??0}}),await f(q),S({status:"updating_budget",monthsFound:M.length,monthsProcessed:M.length,totalIncomeRecalculated:B,totalExpensesRecalculated:O});const P=M.findIndex(G=>G.year===i&&G.month===a),Q={},H={};if(D){const G=Tt(e,D.year,D.month),{exists:ce,data:J}=await Ce("months",G,"recalculate: reading previous month for current balance calculation");if(ce&&J?.category_balances)for(const ie of J.category_balances)H[ie.category_id]=ie.end_balance??0}N.forEach(G=>{H[G]===void 0&&(H[G]=0)});for(let G=0;G<=P&&G<M.length;G++){const ce=M[G];N.forEach(J=>{const ie=H[J]??0;let _e=0;if(ce.allocations_finalized&&ce.allocations){const be=ce.allocations.find(xe=>xe.category_id===J);be&&(_e=be.amount)}let Ee=0;ce.expenses&&(Ee=ce.expenses.filter(be=>be.category_id===J).reduce((be,xe)=>be+xe.amount,0)),H[J]=ie+_e-Ee})}N.forEach(G=>{Q[G]=H[G]??0});const K={...j},te={};Object.entries(l).forEach(([G,ce])=>{te[G]={...ce,balance:K[G]??0}});const L={};N.forEach(G=>{L[G]={current:Q[G]??0,total:K[G]??0}}),await d(te,L,i,a);for(const G of M)Ne.invalidateQueries({queryKey:ne.month(e,G.year,G.month)});S({status:"done",monthsFound:M.length,monthsProcessed:M.length,totalIncomeRecalculated:B,totalExpensesRecalculated:O})}catch(F){console.error("Recalculate error:",F),S({status:"error",error:F instanceof Error?F.message:"Failed to recalculate"})}finally{_(!1)}}}function z(){b(!1),S(null)}return h.jsxs(h.Fragment,{children:[h.jsxs("button",{onClick:A,disabled:t||p,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:t||p?"not-allowed":"pointer",opacity:t||p?.5:1,fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},title:"Recalculate balances from this month forward",children:[p?"":""," Recalculate"]}),h.jsx(b6,{isOpen:v,onClose:z,onProceed:R,results:T})]})}function E6({isLoading:t,onPreviousMonth:e,onNextMonth:n}){const{currentYear:i,currentMonthNumber:a,isAdmin:l,selectedBudgetId:c,currentUserId:d}=on(),{budget:f}=An(c,d),{month:p}=xl(c,i,a),[_,v]=I.useState(!1),b=I.useRef(null);I.useEffect(()=>{if(!_)return;function S(A){b.current&&!b.current.contains(A.target)&&v(!1)}return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[_]);function T(){if(!p||!f)return;const S={...p,_meta:{downloaded_at:new Date().toISOString(),budget_id:f.id,budget_name:f.name}},A=new Blob([JSON.stringify(S,null,2)],{type:"application/json"}),R=URL.createObjectURL(A),z=document.createElement("a");z.href=R,z.download=`month_${i}_${String(a).padStart(2,"0")}.json`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(R),v(!1)}return h.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[h.jsx("button",{onClick:e,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Previous month",children:""}),h.jsxs("div",{ref:b,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[h.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[My[a-1]," ",i]}),h.jsx("button",{onClick:()=>v(!_),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:_?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),t&&h.jsxs(h.Fragment,{children:[h.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),h.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[h.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:ve.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),h.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),_&&h.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[h.jsx(Fy,{isDisabled:t}),l&&p&&h.jsx("button",{onClick:T,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),h.jsx("button",{onClick:n,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Next month",children:""})]})}function Ex({accounts:t,accountGroups:e,payees:n,initialData:i,defaultAccountId:a,defaultDate:l,onSubmit:c,onCancel:d,onDelete:f,submitLabel:p,isMobile:_}){const v=new Date().toISOString().split("T")[0],[b,T]=I.useState(i?.amount?.toString()||""),[S,A]=I.useState(i?.account_id||a||(t[0]?t[0][0]:"")),[R,z]=I.useState(i?.date||l||v),[F,U]=I.useState(i?.payee||""),[X,Z]=I.useState(i?.description||""),oe={},M=[];t.forEach(([N,j])=>{j.account_group_id?(oe[j.account_group_id]||(oe[j.account_group_id]=[]),oe[j.account_group_id].push([N,j])):M.push([N,j])});function C(N){N.preventDefault();const j=parseFloat(b);isNaN(j)||j<=0||S&&R&&c(j,S,R,F.trim()||void 0,X.trim()||void 0)}const D=_?{display:"flex",flexDirection:"column",gap:"1rem"}:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"};return h.jsxs(za,{onSubmit:C,children:[h.jsxs("div",{style:D,children:[h.jsx(Ht,{label:"Amount",htmlFor:"income-amount",children:h.jsx(Ly,{id:"income-amount",value:b,onChange:T,placeholder:"$0.00",required:!0,autoFocus:!0})}),h.jsx(Ht,{label:"Date",htmlFor:"income-date",children:h.jsx(Qi,{id:"income-date",type:"date",value:R,onChange:N=>z(N.target.value),required:!0})})]}),h.jsxs("div",{style:D,children:[h.jsx(Ht,{label:"Deposit To",htmlFor:"income-account",children:h.jsxs(Na,{id:"income-account",value:S,onChange:N=>A(N.target.value),required:!0,children:[Object.entries(e).map(([N,j])=>{const B=oe[N];return!B||B.length===0?null:h.jsx("optgroup",{label:j.name,children:B.map(([O,Y])=>h.jsx("option",{value:O,children:Y.nickname},O))},N)}),M.length>0&&h.jsx("optgroup",{label:"Other",children:M.map(([N,j])=>h.jsx("option",{value:N,children:j.nickname},N))})]})}),h.jsx(Ht,{label:"Payee",htmlFor:"income-payee",children:h.jsx(BT,{id:"income-payee",value:F,onChange:U,payees:n,placeholder:"e.g., Employer, Client name"})})]}),h.jsx(Ht,{label:"Description (optional)",htmlFor:"income-description",children:h.jsx(Qi,{id:"income-description",value:X,onChange:N=>Z(N.target.value),placeholder:"e.g., January paycheck, Project bonus"})}),h.jsxs(Ks,{children:[h.jsx(ke,{type:"submit",children:p}),h.jsx(ke,{type:"button",variant:"secondary",onClick:d,children:"Cancel"}),f&&h.jsx(ke,{type:"button",variant:"danger",onClick:f,style:{marginLeft:"auto"},children:" Delete"})]})]})}function x6({income:t,accountName:e,accountGroupName:n,onEdit:i,onDelete:a,isMobile:l}){return h.jsxs("div",{onClick:l?i:void 0,style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:l?"0.875rem 1rem":"1rem 1.25rem",borderRadius:"8px",display:"flex",flexDirection:l?"column":"row",justifyContent:"space-between",alignItems:l?"stretch":"center",gap:l?"0.5rem":"1rem",cursor:l?"pointer":"default",transition:l?"background 0.15s":"none"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"0.75rem",marginBottom:t.payee?"0.25rem":0},children:[t.date&&h.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,fontFamily:"monospace"},children:new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}),h.jsxs("span",{style:{fontSize:"1.15rem",fontWeight:600,color:ve.success},children:["+",qe(t.amount)]})]}),t.payee&&h.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,marginBottom:"0.25rem"},children:t.payee}),h.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:[" ",e,n?` / ${n}`:""]}),t.description&&h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",opacity:.7},children:t.description})]}),!l&&h.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[h.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit",children:""}),h.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete",children:""})]})]})}function S6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=on(),{accounts:a,accountGroups:l}=An(t,e),{month:c,isLoading:d,payees:f,addIncome:p,updateIncome:_,deleteIncome:v}=xl(t,n,i),b=Ys(),[T,S]=I.useState(null),[A,R]=I.useState(!1),[z,F]=I.useState(null);function U(Y){const q=Y.account_group_id?l[Y.account_group_id]:void 0;return q?.is_active!==void 0?q.is_active:Y.is_active!==!1}function X(Y){const q=Y.account_group_id?l[Y.account_group_id]:void 0;return q?.on_budget!==void 0?q.on_budget:Y.on_budget!==!1}const Z=Object.entries(a).filter(([,Y])=>U(Y)&&X(Y)),oe=Z.filter(([,Y])=>Y.is_income_account),M=oe.length>0?oe:Z,C=Z.find(([,Y])=>Y.is_income_default),D=C?C[0]:void 0,N=c?.income.reduce((Y,q)=>Y+q.amount,0)||0;function j(Y,q,P,Q,H){S(null),R(!1),p(Y,q,P,Q,H).catch(K=>{S(K instanceof Error?K.message:"Failed to add income")})}function B(Y,q,P,Q,H,K){S(null),F(null),_(Y,q,P,Q,H,K).catch(te=>{S(te instanceof Error?te.message:"Failed to update income")})}function O(Y){confirm("Are you sure you want to delete this income entry?")&&(S(null),v(Y).catch(q=>{S(q instanceof Error?q.message:"Failed to delete income")}))}return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:d?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:d?"none":"auto"},children:[T&&h.jsx("div",{style:{background:`color-mix(in srgb, ${ve.error} 15%, transparent)`,border:`1px solid ${ve.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ve.error},children:T}),h.jsxs("div",{style:{display:"flex",flexDirection:b?"column":"row",justifyContent:"space-between",alignItems:b?"stretch":"center",gap:b?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("div",{children:[h.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:"Total"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.25rem",fontWeight:600,color:yn(N)},children:qe(N)})]}),!A&&h.jsx(ke,{onClick:()=>R(!0),disabled:M.length===0,children:"+ Add Income"})]}),M.length===0&&h.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",h.jsx(wt,{to:"/budget/accounts",style:{color:ve.primaryLight},children:"Manage accounts "})]}),A&&h.jsx("div",{style:{marginBottom:"1rem"},children:h.jsx(Ex,{accounts:M,accountGroups:l,payees:f,defaultAccountId:D,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:j,onCancel:()=>R(!1),submitLabel:"Add Income",isMobile:b})}),h.jsxs("div",{style:Qs,children:[c?.income.slice().sort((Y,q)=>(Y.date||"").localeCompare(q.date||"")).map(Y=>z===Y.id?h.jsx(Ex,{accounts:M,accountGroups:l,payees:f,initialData:Y,onSubmit:(q,P,Q,H,K)=>B(Y.id,q,P,Q,H,K),onCancel:()=>F(null),onDelete:()=>O(Y.id),submitLabel:"Save",isMobile:b},Y.id):h.jsx(x6,{income:Y,accountName:a[Y.account_id]?.nickname||"Unknown Account",accountGroupName:a[Y.account_id]?.account_group_id?l[a[Y.account_id].account_group_id]?.name:void 0,onEdit:()=>F(Y.id),onDelete:()=>O(Y.id),isMobile:b},Y.id)),(!c?.income||c.income.length===0)&&!A&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1rem"},children:"No income recorded for this month"})]})]})}function xx({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:c,defaultDate:d,onSubmit:f,onCancel:p,onDelete:_,submitLabel:v,isMobile:b}){const T=new Date().toISOString().split("T")[0],[S,A]=I.useState(l?.amount?.toString()||""),[R,z]=I.useState(l?.category_id||""),[F,U]=I.useState(l?.account_id||c||(t[0]?t[0][0]:"")),[X,Z]=I.useState(l?.date||d||T),[oe,M]=I.useState(l?.payee||""),[C,D]=I.useState(l?.description||""),N={},j=[];t.forEach(([Q,H])=>{H.account_group_id?(N[H.account_group_id]||(N[H.account_group_id]=[]),N[H.account_group_id].push([Q,H])):j.push([Q,H])});const B={},O=[];Object.entries(n).forEach(([Q,H])=>{H.category_group_id?(B[H.category_group_id]||(B[H.category_group_id]=[]),B[H.category_group_id].push([Q,H])):O.push([Q,H])}),Object.values(B).forEach(Q=>{Q.sort((H,K)=>H[1].sort_order-K[1].sort_order)}),O.sort((Q,H)=>Q[1].sort_order-H[1].sort_order);const Y=[...i].sort((Q,H)=>Q.sort_order-H.sort_order);function q(Q){Q.preventDefault();const H=parseFloat(S);isNaN(H)||H<=0||R&&F&&X&&f(H,R,F,X,oe.trim()||void 0,C.trim()||void 0)}const P=b?{display:"flex",flexDirection:"column",gap:"1rem"}:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"};return h.jsxs(za,{onSubmit:q,children:[h.jsxs("div",{style:P,children:[h.jsx(Ht,{label:"Amount",htmlFor:"expense-amount",children:h.jsx(Ly,{id:"expense-amount",value:S,onChange:A,placeholder:"$0.00",required:!0,autoFocus:!0})}),h.jsx(Ht,{label:"Date",htmlFor:"expense-date",children:h.jsx(Qi,{id:"expense-date",type:"date",value:X,onChange:Q=>Z(Q.target.value),required:!0})})]}),h.jsxs("div",{style:P,children:[h.jsx(Ht,{label:"Category",htmlFor:"expense-category",children:h.jsxs(Na,{id:"expense-category",value:R,onChange:Q=>z(Q.target.value),required:!0,children:[h.jsx("option",{value:"",children:"Select category..."}),Y.map(Q=>{const H=B[Q.id];return!H||H.length===0?null:h.jsx("optgroup",{label:Q.name,children:H.map(([K,te])=>h.jsx("option",{value:K,children:te.name},K))},Q.id)}),O.length>0&&h.jsx("optgroup",{label:"Other",children:O.map(([Q,H])=>h.jsx("option",{value:Q,children:H.name},Q))})]})}),h.jsx(Ht,{label:"Pay From",htmlFor:"expense-account",children:h.jsxs(Na,{id:"expense-account",value:F,onChange:Q=>U(Q.target.value),required:!0,children:[Object.entries(e).map(([Q,H])=>{const K=N[Q];return!K||K.length===0?null:h.jsx("optgroup",{label:H.name,children:K.map(([te,L])=>h.jsx("option",{value:te,children:L.nickname},te))},Q)}),j.length>0&&h.jsx("optgroup",{label:"Other",children:j.map(([Q,H])=>h.jsx("option",{value:Q,children:H.nickname},Q))})]})})]}),h.jsx(Ht,{label:"Payee",htmlFor:"expense-payee",children:h.jsx(BT,{id:"expense-payee",value:oe,onChange:M,payees:a,placeholder:"e.g., Grocery Store, Restaurant"})}),h.jsx(Ht,{label:"Description (optional)",htmlFor:"expense-description",children:h.jsx(Qi,{id:"expense-description",value:C,onChange:Q=>D(Q.target.value),placeholder:"e.g., Weekly groceries, Dinner with friends"})}),h.jsxs(Ks,{children:[h.jsx(ke,{type:"submit",children:v}),h.jsx(ke,{type:"button",variant:"secondary",onClick:p,children:"Cancel"}),_&&h.jsx(ke,{type:"button",variant:"danger",onClick:_,style:{marginLeft:"auto"},children:" Delete"})]})]})}function w6({expense:t,categoryName:e,accountName:n,accountGroupName:i,onEdit:a,onDelete:l,isMobile:c}){return h.jsxs("div",{onClick:c?a:void 0,style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:c?"0.875rem 1rem":"1rem 1.25rem",borderRadius:"8px",display:"flex",flexDirection:c?"column":"row",justifyContent:"space-between",alignItems:c?"stretch":"center",gap:c?"0.5rem":"1rem",cursor:c?"pointer":"default",transition:c?"background 0.15s":"none"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:"0.75rem",marginBottom:t.payee?"0.25rem":0},children:[t.date&&h.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,fontFamily:"monospace"},children:new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}),h.jsxs("span",{style:{fontSize:"1.15rem",fontWeight:600,color:ve.error},children:["-",qe(t.amount)]})]}),t.payee&&h.jsx("div",{style:{fontSize:"0.95rem",fontWeight:500,marginBottom:"0.25rem"},children:t.payee}),h.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center"},children:[h.jsx("div",{style:{fontSize:"0.85rem",background:`color-mix(in srgb, ${ve.primary} 20%, transparent)`,color:ve.primaryLight,padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:e}),h.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.5rem",borderRadius:"4px",display:"inline-block"},children:[" ",n,i?` / ${i}`:""]})]}),t.description&&h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.9rem",opacity:.7},children:t.description})]}),!c&&h.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[h.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit",children:""}),h.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete",children:""})]})]})}function T6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=on(),{accounts:a,accountGroups:l,categories:c,categoryGroups:d}=An(t,e),{month:f,isLoading:p,payees:_,addExpense:v,updateExpense:b,deleteExpense:T}=xl(t,n,i),S=Ys(),[A,R]=I.useState(null),[z,F]=I.useState(!1),[U,X]=I.useState(null);function Z(P){const Q=P.account_group_id?l[P.account_group_id]:void 0;return Q?.is_active!==void 0?Q.is_active:P.is_active!==!1}function oe(P){const Q=P.account_group_id?l[P.account_group_id]:void 0;return Q?.on_budget!==void 0?Q.on_budget:P.on_budget!==!1}const M=Object.entries(a).filter(([,P])=>Z(P)&&oe(P)),C=M.filter(([,P])=>P.is_outgo_account),D=C.length>0?C:M,N=M.find(([,P])=>P.is_outgo_default),j=N?N[0]:void 0,B=f?.expenses?.reduce((P,Q)=>P+Q.amount,0)||0;function O(P,Q,H,K,te,L){R(null),F(!1),v(P,Q,H,K,te,L).catch(G=>{R(G instanceof Error?G.message:"Failed to add expense")})}function Y(P,Q,H,K,te,L,G){R(null),X(null),b(P,Q,H,K,te,L,G).catch(ce=>{R(ce instanceof Error?ce.message:"Failed to update expense")})}function q(P){confirm("Are you sure you want to delete this expense?")&&(R(null),T(P).catch(Q=>{R(Q instanceof Error?Q.message:"Failed to delete expense")}))}return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:p?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:p?"none":"auto"},children:[A&&h.jsx("div",{style:{background:`color-mix(in srgb, ${ve.error} 15%, transparent)`,border:`1px solid ${ve.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ve.error},children:A}),h.jsxs("div",{style:{display:"flex",flexDirection:S?"column":"row",justifyContent:"space-between",alignItems:S?"stretch":"center",gap:S?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("div",{children:[h.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:"Total Expenses"}),h.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.25rem",fontWeight:600,color:B>0?ve.error:"inherit"},children:[B>0?"-":"",qe(B)]})]}),!z&&h.jsx(ke,{onClick:()=>F(!0),disabled:D.length===0||Object.keys(c).length===0,children:"+ Add Expense"})]}),D.length===0&&h.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",h.jsx(wt,{to:"/budget/accounts",style:{color:ve.primaryLight},children:"Manage accounts "})]}),Object.keys(c).length===0&&h.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:["You need to create at least one category before adding expenses."," ",h.jsx(wt,{to:"/budget/settings/categories",style:{color:ve.primaryLight},children:"Create categories "})]}),z&&h.jsx("div",{style:{marginBottom:"1rem"},children:h.jsx(xx,{accounts:D,accountGroups:l,categories:c,categoryGroups:d,payees:_,defaultAccountId:j,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:O,onCancel:()=>F(!1),submitLabel:"Add Expense",isMobile:S})}),h.jsxs("div",{style:Qs,children:[f?.expenses?.slice().sort((P,Q)=>(P.date||"").localeCompare(Q.date||"")).map(P=>U===P.id?h.jsx(xx,{accounts:D,accountGroups:l,categories:c,categoryGroups:d,payees:_,initialData:P,onSubmit:(Q,H,K,te,L,G)=>Y(P.id,Q,H,K,te,L,G),onCancel:()=>X(null),onDelete:()=>q(P.id),submitLabel:"Save",isMobile:S},P.id):h.jsx(w6,{expense:P,categoryName:c[P.category_id]?.name||"Unknown Category",accountName:a[P.account_id]?.nickname||"Unknown Account",accountGroupName:a[P.account_id]?.account_group_id?l[a[P.account_id].account_group_id]?.name:void 0,onEdit:()=>X(P.id),onDelete:()=>q(P.id),isMobile:S},P.id)),(!f?.expenses||f.expenses.length===0)&&!z&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1rem"},children:"No expenses recorded for this month"})]})]})}function A6({category:t,value:e,onChange:n,previousMonthIncome:i,disabled:a}){const l=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,c=l?t.default_monthly_amount/100*i:0,d=l?c.toFixed(2):e;let f=null;return!l&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&(f=qe(t.default_monthly_amount)),h.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",padding:"0.6rem 0.75rem",background:l?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",maxWidth:"100%",boxSizing:"border-box",opacity:l?.8:1},children:[h.jsxs("div",{style:{flex:"1 1 auto",minWidth:0,overflow:"hidden"},children:[h.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),l?h.jsxs("span",{style:{fontSize:"0.7rem",opacity:.6,display:"block",marginTop:"0.15rem",color:ve.primary},children:[t.default_monthly_amount,"% of prev month income"]}):f&&h.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5,display:"block",marginTop:"0.15rem"},children:["Suggested: ",f]})]}),h.jsx("div",{style:{flexShrink:0,width:"110px"},children:l?h.jsx("div",{style:{width:"100%",padding:"0.5rem 0.6rem",borderRadius:"6px",border:"1px dashed color-mix(in srgb, currentColor 15%, transparent)",background:"color-mix(in srgb, currentColor 3%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box",textAlign:"right",opacity:.9},title:"Auto-calculated from previous month's income",children:qe(c)}):h.jsx("input",{type:"text",inputMode:"decimal",value:d?`$${d}`:"",onChange:p=>{const _=p.target.value.replace(/[^\d.]/g,"");n(_)},placeholder:"$0.00",disabled:a,style:{width:"100%",padding:"0.5rem 0.6rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box",opacity:a?.6:1,cursor:a?"not-allowed":"text"}})})]})}function C6(){const{selectedBudgetId:t,currentUserId:e}=on(),{categories:n,categoryGroups:i}=An(t,e),{localAllocations:a,isSavingAllocations:l,isFinalizingAllocations:c,isDeletingAllocations:d,isEditingAppliedAllocations:f,error:p,monthLoading:_,onBudgetTotal:v,availableNow:b,currentDraftTotal:T,availableAfterApply:S,previousMonthIncome:A,allocationsFinalized:R,getAllocationAmount:z,handleAllocationChange:F,resetAllocationsToSaved:U,handleSaveAllocations:X,handleFinalizeAllocations:Z,handleDeleteAllocations:oe,setIsEditingAppliedAllocations:M,setError:C}=o6(),D=Ys(),N=[...i].sort((O,Y)=>O.sort_order-Y.sort_order),j=I.useMemo(()=>{const O=Object.entries(n).reduce((Y,[q,P])=>{const Q=P.category_group_id||"ungrouped";return Y[Q]||(Y[Q]=[]),Y[Q].push([q,P]),Y},{});return Object.keys(O).forEach(Y=>{O[Y].sort((q,P)=>q[1].sort_order-P[1].sort_order)}),O},[n]),B=Object.values(n).some(O=>O.default_monthly_type==="percentage");return h.jsxs("div",{style:{opacity:_?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:_?"none":"auto"},children:[p&&h.jsx(El,{message:p,onDismiss:()=>C(null)}),h.jsxs("div",{style:{display:"flex",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",marginBottom:"1.5rem",overflow:"hidden",flexDirection:D?"column":"row"},children:[h.jsxs("div",{style:{flex:1,padding:"0.75rem 1rem",borderRight:D?"none":"1px solid color-mix(in srgb, currentColor 10%, transparent)",borderBottom:D?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"On-Budget Total"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:yn(v)},children:qe(v)})]}),h.jsxs("div",{style:{flex:1,padding:"0.75rem 1rem",borderRight:D?"none":"1px solid color-mix(in srgb, currentColor 10%, transparent)",borderBottom:D?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Available Now"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:yn(b)},children:qe(b)}),h.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.65rem",opacity:.5},children:"applied only"})]}),h.jsxs("div",{style:{flex:1,padding:"0.75rem 1rem",borderRight:D?"none":"1px solid color-mix(in srgb, currentColor 10%, transparent)",borderBottom:D?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Draft Total"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:ve.primary},children:qe(T)})]}),h.jsxs("div",{style:{flex:1,padding:"0.75rem 1rem",textAlign:"center"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"After Apply"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:yn(S)},children:qe(S)}),h.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.65rem",opacity:.5},children:"if applied"})]})]}),B&&h.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.6rem 1rem",marginBottom:"1rem",fontSize:"0.85rem"},children:h.jsxs("span",{style:{opacity:.7},children:["Percentage allocations based on prev month income: ",h.jsx("strong",{style:{color:ve.primary},children:qe(A)})]})}),h.jsx(R6,{allocationsFinalized:R,isEditingAppliedAllocations:f,isSavingAllocations:l,isFinalizingAllocations:c,isDeletingAllocations:d,monthLoading:_,onCancel:U,onSave:X,onFinalize:Z,onDelete:oe,onStartEdit:()=>M(!0)}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(n).length===0&&h.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",h.jsx(wt,{to:"/budget/settings/categories",style:{color:ve.primaryLight},children:"Create categories "})]}),N.map(O=>{const Y=j[O.id]||[];if(Y.length===0)return null;const q=Y.reduce((P,[Q,H])=>P+z(Q,H),0);return h.jsx(Sx,{name:O.name,categories:Y,groupTotal:q,localAllocations:a,previousMonthIncome:A,disabled:R&&!f,onAllocationChange:F},O.id)}),j.ungrouped?.length>0&&h.jsx(Sx,{name:"Uncategorized",categories:j.ungrouped,groupTotal:j.ungrouped.reduce((O,[Y,q])=>O+z(Y,q),0),localAllocations:a,previousMonthIncome:A,disabled:R&&!f,onAllocationChange:F,isUngrouped:!0})]})]})}function R6({allocationsFinalized:t,isEditingAppliedAllocations:e,isSavingAllocations:n,isFinalizingAllocations:i,isDeletingAllocations:a,monthLoading:l,onCancel:c,onSave:d,onFinalize:f,onDelete:p,onStartEdit:_}){const v=t?e?ve.primary:ve.success:ve.warning;return h.jsxs("div",{style:{background:`color-mix(in srgb, ${v} 12%, transparent)`,border:`1px solid ${v}`,borderRadius:"8px",padding:"0.75rem 1rem",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.75rem"},children:[h.jsxs("div",{children:[h.jsx("p",{style:{margin:0,fontWeight:600,color:v},children:t?e?" Editing Applied Allocations":" Allocations Applied":" Allocations Not Applied"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:t?e?"Make changes and save, or cancel to revert.":"Click Edit to make changes to allocations.":"Save and apply to update category balances."})]}),h.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:t?e?h.jsxs(h.Fragment,{children:[h.jsx(ke,{onClick:c,disabled:i||a||l,variant:"secondary",children:"Cancel"}),h.jsx(ke,{onClick:f,disabled:i||a||l,children:i?" Saving...":" Save Changes"})]}):h.jsxs(h.Fragment,{children:[h.jsx(ke,{onClick:_,disabled:a||l,variant:"secondary",children:" Edit Allocations"}),h.jsx(ke,{onClick:p,disabled:a||l,variant:"danger",children:a?" Deleting...":" Delete Allocations"})]}):h.jsxs(h.Fragment,{children:[h.jsx(ke,{onClick:d,disabled:n||l,variant:"secondary",children:n?" Saving...":" Save Allocation Draft"}),h.jsx(ke,{onClick:f,disabled:i||l,children:i?" Applying...":" Save & Apply"})]})})]})}function Sx({name:t,categories:e,groupTotal:n,localAllocations:i,previousMonthIncome:a,disabled:l,onAllocationChange:c,isUngrouped:d}){return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("h3",{style:{...bl,margin:0,opacity:d?.7:1},children:[t,h.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),h.jsx("span",{style:{fontWeight:600,color:ve.primary},children:qe(n)})]}),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:e.map(([f,p])=>h.jsx(A6,{category:p,value:i[f]||"",onChange:_=>c(f,_),previousMonthIncome:a,disabled:l},f))})]})}function D6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=on(),{categories:a,categoryGroups:l}=An(t,e),{month:c,isLoading:d}=xl(t,n,i),f=Ys(),p=I.useMemo(()=>{if(c?.category_balances&&c.category_balances.length>0)return c.category_balances;const S=c?.previous_month_snapshot?.category_balances_end??{},A=[];return Object.entries(a).forEach(([R])=>{const z=S[R]??0;let F=0;if(c?.allocations_finalized&&c.allocations){const X=c.allocations.find(Z=>Z.category_id===R);X&&(F=X.amount)}let U=0;c?.expenses&&(U=c.expenses.filter(X=>X.category_id===R).reduce((X,Z)=>X+Z.amount,0)),A.push({category_id:R,start_balance:z,allocated:F,spent:U,end_balance:z+F-U})}),A},[c,a]),_=S=>p.find(A=>A.category_id===S),v=I.useMemo(()=>p.reduce((S,A)=>({start:S.start+A.start_balance,allocated:S.allocated+A.allocated,spent:S.spent+A.spent,end:S.end+A.end_balance}),{start:0,allocated:0,spent:0,end:0}),[p]),b=[...l].sort((S,A)=>S.sort_order-A.sort_order),T=I.useMemo(()=>{const S=Object.entries(a).reduce((A,[R,z])=>{const F=z.category_group_id||"ungrouped";return A[F]||(A[F]=[]),A[F].push([R,z]),A},{});return Object.keys(S).forEach(A=>{S[A].sort((R,z)=>R[1].sort_order-z[1].sort_order)}),S},[a]);return h.jsxs("div",{style:{opacity:d?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:d?"none":"auto"},children:[h.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr 1fr":"repeat(4, 1fr)",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",marginBottom:"1.5rem",overflow:"hidden"},children:[h.jsxs("div",{style:{padding:"0.75rem 1rem",borderRight:"1px solid color-mix(in srgb, currentColor 10%, transparent)",borderBottom:f?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center",order:1},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Start of Month"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:yn(v.start)},children:qe(v.start)})]}),h.jsxs("div",{style:{padding:"0.75rem 1rem",borderRight:"1px solid color-mix(in srgb, currentColor 10%, transparent)",textAlign:"center",order:f?3:2},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Allocated"}),h.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:ve.success},children:["+",qe(v.allocated)]})]}),h.jsxs("div",{style:{padding:"0.75rem 1rem",borderRight:f?"none":"1px solid color-mix(in srgb, currentColor 10%, transparent)",textAlign:"center",order:f?4:3},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Spent"}),h.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:ve.error},children:["-",qe(v.spent)]})]}),h.jsxs("div",{style:{padding:"0.75rem 1rem",borderBottom:f?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center",order:f?2:4},children:[h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"End of Month"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:yn(v.end)},children:qe(v.end)})]})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(a).length===0&&h.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",h.jsx(wt,{to:"/budget/settings/categories",style:{color:ve.primaryLight},children:"Create categories "})]}),b.map(S=>{const A=T[S.id]||[];if(A.length===0)return null;const R=A.reduce((z,[F])=>{const U=_(F);return U?{start:z.start+U.start_balance,allocated:z.allocated+U.allocated,spent:z.spent+U.spent,end:z.end+U.end_balance}:z},{start:0,allocated:0,spent:0,end:0});return h.jsx(wx,{name:S.name,categories:A,groupEndBalance:R.end,getCategoryBalance:_,isMobile:f},S.id)}),T.ungrouped?.length>0&&(()=>{const S=T.ungrouped,A=S.reduce((R,[z])=>{const F=_(z);return F?{start:R.start+F.start_balance,allocated:R.allocated+F.allocated,spent:R.spent+F.spent,end:R.end+F.end_balance}:R},{start:0,allocated:0,spent:0,end:0});return h.jsx(wx,{name:"Uncategorized",categories:S,groupEndBalance:A.end,getCategoryBalance:_,isMobile:f,isUngrouped:!0},"ungrouped")})()]})]})}function wx({name:t,categories:e,groupEndBalance:n,getCategoryBalance:i,isMobile:a,isUngrouped:l}){return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("h3",{style:{...bl,margin:0,opacity:l?.7:1},children:[t,h.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),h.jsx("span",{style:{fontWeight:600,color:yn(n)},children:qe(n)})]}),!a&&h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[h.jsx("span",{children:"Category"}),h.jsx("span",{style:{textAlign:"right"},children:"Start"}),h.jsx("span",{style:{textAlign:"right"},children:"Allocated"}),h.jsx("span",{style:{textAlign:"right"},children:"Spent"}),h.jsx("span",{style:{textAlign:"right"},children:"End"})]}),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:e.map(([c,d])=>{const f=i(c);return f?a?h.jsx(I6,{category:d,balance:f},c):h.jsx(j6,{category:d,balance:f},c):null})})]})}function I6({category:t,balance:e}){return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[h.jsx("span",{style:{fontWeight:500},children:t.name}),h.jsx("span",{style:{fontWeight:600,color:yn(e.end_balance)},children:qe(e.end_balance)})]}),h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.5rem",fontSize:"0.8rem"},children:[h.jsxs("div",{children:[h.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),h.jsx("span",{children:qe(e.start_balance)})]}),h.jsxs("div",{children:[h.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),h.jsxs("span",{style:{color:e.allocated>0?ve.success:"inherit"},children:[e.allocated>0?"+":"",qe(e.allocated)]})]}),h.jsxs("div",{children:[h.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),h.jsxs("span",{style:{color:e.spent>0?ve.error:"inherit"},children:[e.spent>0?"-":"",qe(e.spent)]})]})]})]})}function j6({category:t,balance:e}){return h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[h.jsx("span",{style:{fontWeight:500},children:t.name}),h.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:qe(e.start_balance)}),h.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.allocated>0?ve.success:"inherit"},children:[e.allocated>0?"+":"",qe(e.allocated)]}),h.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.spent>0?ve.error:"inherit"},children:[e.spent>0?"-":"",qe(e.spent)]}),h.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:yn(e.end_balance)},children:qe(e.end_balance)})]})}const O6=["income","allocations","spend","balances"];function Tx(t){const e=t.year?parseInt(t.year,10):null,n=t.month?parseInt(t.month,10):null,i=t.tab&&O6.includes(t.tab)?t.tab:null;return{year:e&&!isNaN(e)&&e>=2e3&&e<=2100?e:null,month:n&&!isNaN(n)&&n>=1&&n<=12?n:null,tab:i}}function Ax(){const t=_C(),e=Uh(),{currentUserId:n,selectedBudgetId:i,currentYear:a,currentMonthNumber:l,lastActiveTab:c,setCurrentYear:d,setCurrentMonthNumber:f,setLastActiveTab:p,goToPreviousMonth:_,goToNextMonth:v,hasPendingInvites:b,pendingInvites:T,needsFirstBudget:S}=on(),{budget:A,createBudget:R,acceptInvite:z}=An(i,n),{month:F,isLoading:U}=xl(i,a,l),[X,Z]=I.useState(null),oe=I.useRef(!1),[M,C]=I.useState(()=>{const{tab:Y}=Tx(t);return Y??c}),D=Y=>{C(Y),p(Y)};I.useEffect(()=>{if(oe.current)return;const{year:Y,month:q}=Tx(t);Y&&d(Y),q&&f(q),oe.current=!0},[t,d,f]),I.useEffect(()=>{if(!oe.current)return;const Y=`/budget/${a}/${l}/${M}`,q=`/budget/${t.year}/${t.month}/${t.tab}`;Y!==q&&e(Y,{replace:!0})},[a,l,M,e,t]);async function N(Y){try{await z(Y)}catch(q){Z(q instanceof Error?q.message:"Failed to accept invite")}}async function j(Y){try{await R(Y||"My Budget")}catch(q){Z(q instanceof Error?q.message:"Failed to create budget")}}if(!A&&b)return h.jsxs($o,{children:[h.jsx(ui,{title:"Budget",showBackArrow:!0,hideMenu:!0}),h.jsx(_6,{invites:T,onAccept:N,onCreateNew:j})]});if(!A&&S)return h.jsxs($o,{children:[h.jsx(ui,{title:"Budget",showBackArrow:!0,hideMenu:!0}),h.jsx(y6,{onCreateNew:j})]});function B(){Z(null),_()}function O(){Z(null),v()}return h.jsxs($o,{children:[h.jsx(ui,{title:A?.name||"Budget"}),h.jsxs(n6,{children:[X&&h.jsx(El,{message:X,onDismiss:()=>Z(null)}),h.jsx(E6,{isLoading:U,onPreviousMonth:B,onNextMonth:O}),h.jsx(v6,{activeTab:M,setActiveTab:D,allocationsFinalized:F?.allocations_finalized}),M==="income"&&h.jsx(S6,{}),M==="allocations"&&h.jsx(C6,{}),M==="spend"&&h.jsx(T6,{}),M==="balances"&&h.jsx(D6,{})]})]})}function M6(){return h.jsxs($o,{children:[h.jsx(ui,{title:"Analytics"}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[h.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),h.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),h.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),h.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),h.jsx(wt,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:ve.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})]})}function Lh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,accountGroups:a,showGroupSelector:l=!1,showIncomeSettings:c=!1,hasExistingIncomeDefault:d=!1,hasExistingOutgoDefault:f=!1,currentGroupId:p}){const[_,v]=I.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),b=_.account_group_id||p,T=b?a.find(U=>U.id===b):null,S=T?.is_active!==void 0,A=T?.on_budget!==void 0;function R(U){U.preventDefault(),_.nickname.trim()&&e(_)}function z(U){v({..._,is_income_account:U,is_income_default:U?_.is_income_default:!1})}function F(U){v({..._,is_outgo_account:U,is_outgo_default:U?_.is_outgo_default:!1})}return h.jsxs(za,{onSubmit:R,children:[h.jsx(Ht,{label:"Account Nickname",htmlFor:"account-nickname",children:h.jsx(Qi,{id:"account-nickname",type:"text",value:_.nickname,onChange:U=>v({..._,nickname:U.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&h.jsx(Ht,{label:"Account Type",htmlFor:"account-group",children:h.jsxs(Na,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:U=>v({..._,account_group_id:U.target.value==="ungrouped"?null:U.target.value}),children:[h.jsx("option",{value:"ungrouped",children:"Ungrouped"}),a.map(U=>h.jsx("option",{value:U.id,children:U.name},U.id))]})}),c&&h.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[h.jsx(Do,{id:"is-active",checked:S?T.is_active:_.is_active!==!1,onChange:U=>v({..._,is_active:U.target.checked}),disabled:S,children:h.jsx("span",{style:{opacity:S?.5:1},children:"Active account"})}),S&&h.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ve.warning},children:['Set by account type "',T.name,'"']})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[h.jsx(Do,{id:"on-budget",checked:A?T.on_budget:_.on_budget!==!1,onChange:U=>v({..._,on_budget:U.target.checked}),disabled:A,children:h.jsx("span",{style:{opacity:A?.5:1},children:"On budget (affects budget totals)"})}),A&&h.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ve.warning},children:['Set by account type "',T.name,'"']})]})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),h.jsx(Do,{id:"is-income-account",checked:_.is_income_account||!1,onChange:U=>z(U.target.checked),children:"Show in income deposit list"}),_.is_income_account&&h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[h.jsx(Do,{id:"is-income-default",checked:_.is_income_default||!1,onChange:U=>v({..._,is_income_default:U.target.checked}),disabled:d&&!t?.is_income_default,children:"Default account for new income"}),d&&!t?.is_income_default&&h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),h.jsx(Do,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:U=>F(U.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[h.jsx(Do,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:U=>v({..._,is_outgo_default:U.target.checked}),disabled:f&&!t?.is_outgo_default,children:"Default account for new expenses"}),f&&!t?.is_outgo_default&&h.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),h.jsxs(Ks,{children:[h.jsx(ke,{type:"submit",children:i}),h.jsx(ke,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function Cx({label:t,value:e,onChange:n,trueLabel:i,falseLabel:a,undefinedLabel:l}){function c(){n(e===void 0?!0:e===!0?!1:void 0)}const d=e===!0?i:e===!1?a:l,f=e===!0?ve.success:e===!1?ve.warning:"inherit",p=e===!0?"":e===!1?"":"";return h.jsxs("button",{type:"button",onClick:c,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${f} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${f} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[h.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?f:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:p}),h.jsxs("span",{style:{flex:1},children:[h.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",h.jsx("span",{style:{fontWeight:500,color:f},children:d})]}),h.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function UT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=I.useState(t||{name:"",expected_balance:"positive"});function c(d){d.preventDefault(),a.name.trim()&&e(a)}return h.jsxs(za,{onSubmit:c,children:[h.jsx(Ht,{label:"Account Type Name",htmlFor:"group-name",children:h.jsx(Qi,{id:"group-name",type:"text",value:a.name,onChange:d=>l({...a,name:d.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),h.jsx(Ht,{label:"Expected Balance",htmlFor:"expected-balance",children:h.jsxs(Na,{id:"expected-balance",value:a.expected_balance,onChange:d=>l({...a,expected_balance:d.target.value}),children:[h.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),h.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),h.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),h.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",h.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),h.jsx(Cx,{label:"Active status",value:a.is_active,onChange:d=>l({...a,is_active:d}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),h.jsx(Cx,{label:"Budget status",value:a.on_budget,onChange:d=>l({...a,on_budget:d}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),h.jsxs(Ks,{children:[h.jsx(ke,{type:"submit",children:i}),h.jsx(ke,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function jo({icon:t,label:e,variant:n,title:i}){const l={success:{background:`color-mix(in srgb, ${ve.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${ve.success} 40%, transparent)`,color:ve.success,opacity:1},warning:{background:`color-mix(in srgb, ${ve.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${ve.warning} 35%, transparent)`,color:ve.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${ve.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ve.success} 25%, transparent)`,color:ve.success,opacity:.7},expense:{background:`color-mix(in srgb, ${ve.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ve.warning} 25%, transparent)`,color:ve.warning,opacity:.7}}[n];return h.jsxs("span",{title:i||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[h.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function FT({account:t,accountGroups:e}){const n=[],i=t.account_group_id?e.find(c=>c.id===t.account_group_id):null,a=i?.is_active!==void 0?i.is_active:t.is_active!==!1,l=i?.on_budget!==void 0?i.on_budget:t.on_budget!==!1;if(!a){const c=i?.is_active!==void 0;n.push(h.jsx(jo,{icon:"",label:c?"Inactive (type)":"Inactive",variant:"warning",title:c?`Set by "${i.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const c=i?.on_budget!==void 0;n.push(h.jsx(jo,{icon:"",label:c?"Off Budget (type)":"Off Budget",variant:"warning",title:c?`Set by "${i.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(h.jsx(jo,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(h.jsx(jo,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(h.jsx(jo,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(h.jsx(jo,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:h.jsx(h.Fragment,{children:n})}function k6({group:t}){const e=[];return t.is_active===!1?e.push(h.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ve.warning} 20%, transparent)`,color:ve.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(h.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ve.success} 20%, transparent)`,color:ve.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(h.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ve.warning} 20%, transparent)`,color:ve.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(h.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ve.success} 20%, transparent)`,color:ve.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:h.jsx(h.Fragment,{children:e})}function qT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return h.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[h.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ve.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&h.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function N6(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function P6(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function V6({group:t,groupIndex:e,totalGroups:n,accounts:i,allGroups:a,allAccounts:l,editingAccountId:c,editingGroupId:d,createForGroupId:f,setEditingAccountId:p,setEditingGroupId:_,setCreateForGroupId:v,dragType:b,draggedId:T,dragOverId:S,dragOverGroupId:A,setDragOverId:R,setDragOverGroupId:z,onAccountDragStart:F,onAccountDragOver:U,onAccountDrop:X,onGroupDragStart:Z,onGroupDragOver:oe,onGroupDrop:M,onDragLeave:C,onDragLeaveGroup:D,onDragEnd:N,onDropOnGroup:j,onCreateAccount:B,onUpdateAccount:O,onDeleteAccount:Y,onMoveAccount:q,onUpdateGroup:P,onDeleteGroup:Q,onMoveGroup:H}){const K=Ys(),te=[...i].sort((he,nt)=>he.sort_order-nt.sort_order),L=b==="group"&&T===t.id,G=b==="group"&&S===t.id,ce=b==="account"&&A===t.id,ie=(T&&b==="account"?l[T]:null)&&Object.entries(l).find(([he])=>he===T)?.[1]&&Object.entries(l).find(([he])=>he===T)?.[1]?.account_group_id!==t.id,_e=b==="group"&&G&&T!==t.id,Ee=e>0,be=e<n-1,xe=te.reduce((he,nt)=>he+nt.balance,0);return h.jsxs("div",{children:[b==="group"&&!L&&h.jsxs("div",{onDragOver:he=>{he.preventDefault(),R(t.id)},onDragLeave:C,onDrop:he=>M(he,t.id),style:{position:"relative",height:_e?"2.5rem":"0.5rem",marginBottom:_e?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[h.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ve.primary,borderRadius:"2px",opacity:_e?1:0,transition:"opacity 0.15s",boxShadow:_e?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),_e&&h.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),h.jsx("div",{draggable:d!==t.id,onDragStart:he=>Z(he,t.id),onDragOver:he=>oe(he,t.id),onDragLeave:D,onDragEnd:N,onDrop:he=>j(he,t.id),style:{background:L?"color-mix(in srgb, currentColor 3%, transparent)":ce&&ie?`color-mix(in srgb, ${ve.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:L?.5:1,border:ce&&ie?`2px dashed ${ve.primary}`:"2px solid transparent",cursor:d===t.id?"default":"grab",transition:"all 0.15s"},children:d===t.id?h.jsx(UT,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:he=>P(t.id,he),onCancel:()=>_(null),submitLabel:"Save"}):h.jsxs(h.Fragment,{children:[h.jsx(L6,{group:t,accountCount:te.length,groupTotal:xe,canMoveUp:Ee,canMoveDown:be,isMobile:K,createForGroupId:f,onEdit:()=>_(t.id),onDelete:()=>Q(t.id),onMoveUp:()=>H(t.id,"up"),onMoveDown:()=>H(t.id,"down"),onAddAccount:()=>v(t.id)}),K&&h.jsx("div",{style:{marginBottom:"0.5rem"},children:h.jsx(ke,{variant:"small",onClick:()=>v(t.id),disabled:f!==null,children:"+ Account"})}),h.jsxs("div",{style:Qs,children:[te.map((he,nt)=>c===he.id?h.jsx(Lh,{initialData:{nickname:he.nickname,account_group_id:he.account_group_id,is_income_account:he.is_income_account,is_income_default:he.is_income_default,is_outgo_account:he.is_outgo_account,is_outgo_default:he.is_outgo_default,on_budget:he.on_budget,is_active:he.is_active},onSubmit:Fe=>O(he.id,Fe),onCancel:()=>p(null),submitLabel:"Save",accountGroups:a,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:he.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([Fe,ln])=>ln.is_income_default&&Fe!==he.id),hasExistingOutgoDefault:Object.entries(l).some(([Fe,ln])=>ln.is_outgo_default&&Fe!==he.id)},he.id):h.jsx(yf,{isDragging:b==="account"&&T===he.id,isDragOver:S===he.id,onDragStart:Fe=>{Fe.stopPropagation(),F(Fe,he.id)},onDragOver:Fe=>U(Fe,he.id,t.id),onDragLeave:C,onDragEnd:N,onDrop:Fe=>X(Fe,he.id,t.id),onEdit:()=>p(he.id),onDelete:()=>Y(he.id),onMoveUp:()=>q(he.id,"up"),onMoveDown:()=>q(he.id,"down"),canMoveUp:nt>0,canMoveDown:nt<te.length-1,children:h.jsxs("div",{children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[h.jsx("span",{style:Py,children:he.nickname}),h.jsx(FT,{account:he,accountGroups:a})]}),h.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:yn(he.balance)},children:[qe(he.balance),N6(he.balance,t.expected_balance)&&h.jsx("span",{title:P6(he.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},he.id)),te.length===0&&!f&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),b==="account"&&te.length>0&&h.jsx(qT,{groupId:t.id,isActive:S===`__end__${t.id}`,onDragOver:he=>{he.preventDefault(),he.stopPropagation(),R(`__end__${t.id}`),z(t.id)},onDragLeave:he=>{he.stopPropagation(),R(null)},onDrop:he=>{he.stopPropagation(),X(he,"__group_end__",t.id)}}),f===t.id&&h.jsx(Lh,{initialData:{nickname:"",account_group_id:t.id},onSubmit:he=>B(he,t.id),onCancel:()=>v(null),submitLabel:"Create",accountGroups:a,showIncomeSettings:!0,currentGroupId:t.id})]}),f!==t.id&&h.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:h.jsx(ke,{variant:"small",onClick:()=>v(t.id),disabled:f!==null,children:"+ Add Account"})})]})})]})}function L6({group:t,accountCount:e,groupTotal:n,canMoveUp:i,canMoveDown:a,isMobile:l,createForGroupId:c,onEdit:d,onDelete:f,onMoveUp:p,onMoveDown:_,onAddAccount:v}){return h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[h.jsxs("h3",{style:{...bl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&h.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),h.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),h.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),h.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:yn(n),flexShrink:0},children:qe(n)}),h.jsx(k6,{group:t})]}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&h.jsx(ke,{variant:"small",onClick:v,disabled:c!==null,children:"+ Account"}),h.jsx("button",{onClick:d,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),h.jsx("button",{onClick:f,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),h.jsxs("div",{style:Ny,children:[h.jsx("button",{onClick:p,disabled:!i,style:{...rl,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),h.jsx("button",{onClick:_,disabled:!a,style:{...rl,opacity:a?.6:.2,cursor:a?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function B6({accounts:t,allGroups:e,allAccounts:n,hasGroups:i,editingAccountId:a,createForGroupId:l,setEditingAccountId:c,setCreateForGroupId:d,dragType:f,draggedId:p,dragOverId:_,dragOverGroupId:v,setDragOverId:b,setDragOverGroupId:T,onAccountDragStart:S,onAccountDragOver:A,onAccountDrop:R,onDragOverGroup:z,onDropOnGroup:F,onDragLeave:U,onDragLeaveGroup:X,onDragEnd:Z,onCreateAccount:oe,onUpdateAccount:M,onDeleteAccount:C,onMoveAccount:D}){const N=[...t].sort((q,P)=>q.sort_order-P.sort_order),j=f==="account"&&v==="ungrouped",O=(p&&f==="account"?n[p]:null)&&Object.entries(n).find(([q])=>q===p)?.[1]&&Object.entries(n).find(([q])=>q===p)?.[1]?.account_group_id!==null;if(N.length===0&&!l&&i&&f!=="account")return null;const Y=N.reduce((q,P)=>q+P.balance,0);return h.jsxs("div",{onDragOver:q=>z(q,"ungrouped"),onDragLeave:X,onDrop:q=>F(q,"ungrouped"),style:{background:j&&O?`color-mix(in srgb, ${ve.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:j&&O?`2px dashed ${ve.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("h3",{style:{...bl,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",h.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",N.length,")"]}),N.length>0&&h.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:yn(Y)},children:qe(Y)})]}),h.jsx(ke,{variant:"small",onClick:()=>d("ungrouped"),disabled:l!==null,children:"+ Account"})]}),h.jsxs("div",{style:Qs,children:[N.map((q,P)=>a===q.id?h.jsx(Lh,{initialData:{nickname:q.nickname,account_group_id:q.account_group_id,is_income_account:q.is_income_account,is_income_default:q.is_income_default,is_outgo_account:q.is_outgo_account,is_outgo_default:q.is_outgo_default,on_budget:q.on_budget,is_active:q.is_active},onSubmit:Q=>M(q.id,Q),onCancel:()=>c(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([Q,H])=>H.is_income_default&&Q!==q.id),hasExistingOutgoDefault:Object.entries(n).some(([Q,H])=>H.is_outgo_default&&Q!==q.id)},q.id):h.jsx(yf,{isDragging:f==="account"&&p===q.id,isDragOver:_===q.id,onDragStart:Q=>S(Q,q.id),onDragOver:Q=>A(Q,q.id,"ungrouped"),onDragLeave:U,onDragEnd:Z,onDrop:Q=>R(Q,q.id,"ungrouped"),onEdit:()=>c(q.id),onDelete:()=>C(q.id),onMoveUp:()=>D(q.id,"up"),onMoveDown:()=>D(q.id,"down"),canMoveUp:P>0,canMoveDown:P<N.length-1,children:h.jsxs("div",{children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[h.jsx("span",{style:Py,children:q.nickname}),h.jsx(FT,{account:q,accountGroups:e})]}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:yn(q.balance)},children:qe(q.balance)})]})},q.id)),N.length===0&&f==="account"&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),f==="account"&&N.length>0&&h.jsx(qT,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:q=>{q.preventDefault(),q.stopPropagation(),b("__end__ungrouped"),T("ungrouped")},onDragLeave:q=>{q.stopPropagation(),b(null)},onDrop:q=>{q.stopPropagation(),R(q,"__group_end__","ungrouped")}}),l==="ungrouped"&&h.jsx(Lh,{initialData:{nickname:"",account_group_id:null},onSubmit:q=>oe(q,"ungrouped"),onCancel:()=>d(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&h.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:h.jsx(ke,{variant:"small",onClick:()=>d("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function z6(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:i,error:a,setError:l,handleCreateAccount:c,handleUpdateAccount:d,handleDeleteAccount:f,handleMoveAccount:p,handleCreateGroup:_,handleUpdateGroup:v,handleDeleteGroup:b,handleMoveGroup:T,reorderAccountsInGroup:S,reorderGroups:A}=a6(),R=Ys(),[z,F]=I.useState(null),[U,X]=I.useState(null),[Z,oe]=I.useState(null),[M,C]=I.useState(!1),[D,N]=I.useState(null),[j,B]=I.useState(null),[O,Y]=I.useState(null),[q,P]=I.useState(null);function Q(be,xe){N("account"),B(xe),be.dataTransfer.effectAllowed="move"}function H(be,xe,he){be.preventDefault(),D==="account"&&(xe!==j&&Y(xe),P(he))}function K(be,xe){be.preventDefault(),D==="account"?(P(xe),Y(null)):D==="group"&&xe!==j&&Y(xe)}function te(){Y(null)}function L(){P(null)}function G(){N(null),B(null),Y(null),P(null)}async function ce(be,xe,he){if(be.preventDefault(),be.stopPropagation(),!j||D!=="account"){G();return}await S(j,xe,he),G()}async function J(be,xe){be.preventDefault(),D==="account"?await ce(be,"__group_end__",xe):D==="group"&&await _e(be,xe)}function ie(be,xe){be.stopPropagation(),N("group"),B(xe),be.dataTransfer.effectAllowed="move"}async function _e(be,xe){if(be.preventDefault(),!j||D!=="group"||j===xe){G();return}await A(j,xe),G()}if(!i)return h.jsx("p",{children:"No budget found. Please log in."});const Ee=e.ungrouped||[];return h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Accounts"}),h.jsxs("p",{style:Xc,children:["Organize your financial accounts by type.",h.jsx("br",{}),h.jsx("span",{style:{fontSize:"0.9rem"},children:R?"Use  buttons to reorder items, or drag to move between types.":"Drag accounts between types, or use  buttons to reorder."})]}),a&&h.jsx(El,{message:a,onDismiss:()=>l(null)}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:h.jsx(Fy,{})}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(t).length===0&&n.length===0&&h.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((be,xe)=>h.jsx(V6,{group:be,groupIndex:xe,totalGroups:n.length,accounts:e[be.id]||[],allGroups:n,allAccounts:t,editingAccountId:z,editingGroupId:Z,createForGroupId:U,setEditingAccountId:F,setEditingGroupId:oe,setCreateForGroupId:X,dragType:D,draggedId:j,dragOverId:O,dragOverGroupId:q,setDragOverId:Y,setDragOverGroupId:P,onAccountDragStart:Q,onAccountDragOver:H,onAccountDrop:ce,onGroupDragStart:ie,onGroupDragOver:K,onGroupDrop:_e,onDragLeave:te,onDragLeaveGroup:L,onDragEnd:G,onDropOnGroup:J,onCreateAccount:c,onUpdateAccount:(he,nt)=>{d(he,nt),F(null)},onDeleteAccount:f,onMoveAccount:p,onUpdateGroup:(he,nt)=>{v(he,nt),oe(null)},onDeleteGroup:b,onMoveGroup:T},be.id)),D==="group"&&n.length>0&&h.jsx(By,{isActive:O==="__end__",onDragOver:be=>{be.preventDefault(),Y("__end__")},onDragLeave:te,onDrop:be=>_e(be,"__end__"),label:"Move account type to end"}),h.jsx(B6,{accounts:Ee,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:z,createForGroupId:U,setEditingAccountId:F,setCreateForGroupId:X,dragType:D,draggedId:j,dragOverId:O,dragOverGroupId:q,setDragOverId:Y,setDragOverGroupId:P,onAccountDragStart:Q,onAccountDragOver:H,onAccountDrop:ce,onDragOverGroup:K,onDropOnGroup:J,onDragLeave:te,onDragLeaveGroup:L,onDragEnd:G,onCreateAccount:c,onUpdateAccount:(be,xe)=>{d(be,xe),F(null)},onDeleteAccount:f,onMoveAccount:p})]}),M?h.jsx(UT,{onSubmit:be=>{_(be),C(!1)},onCancel:()=>C(!1),submitLabel:"Create Account Type"}):h.jsx(ke,{variant:"primary-large",onClick:()=>C(!0),children:"+ Add Account Type"})]})}function Bh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,categoryGroups:a=[],showGroupSelector:l=!1}){const[c,d]=I.useState(t||{name:"",category_group_id:null}),[f,p]=I.useState(t?.default_monthly_amount?.toString()||""),[_,v]=I.useState(t?.default_monthly_type||"fixed"),[b,T]=I.useState(!1);function S(A){if(A.preventDefault(),!c.name.trim())return;T(!0);const R=parseFloat(f),z=!isNaN(R)&&R>0;e({...c,description:c.description?.trim()||void 0,default_monthly_amount:z?R:void 0,default_monthly_type:z?_:void 0})}return h.jsxs(za,{onSubmit:S,children:[h.jsx(Ht,{label:"Category Name",htmlFor:"category-name",children:h.jsx(Qi,{id:"category-name",type:"text",value:c.name,onChange:A=>d({...c,name:A.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),h.jsx(Ht,{label:"Description (optional)",htmlFor:"category-description",children:h.jsx(Vy,{id:"category-description",value:c.description||"",onChange:A=>d({...c,description:A.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&h.jsx(Ht,{label:"Category Group",htmlFor:"category-group",children:h.jsxs(Na,{id:"category-group",value:c.category_group_id||"ungrouped",onChange:A=>d({...c,category_group_id:A.target.value==="ungrouped"?null:A.target.value}),children:[h.jsx("option",{value:"ungrouped",children:"Uncategorized"}),a.map(A=>h.jsx("option",{value:A.id,children:A.name},A.id))]})}),h.jsxs(Ht,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[h.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[h.jsxs(Na,{id:"default-type",value:_,onChange:A=>v(A.target.value),style:{width:"auto",flex:"0 0 auto"},children:[h.jsx("option",{value:"fixed",children:"Fixed $"}),h.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?h.jsx(Ly,{id:"default-amount",value:f,onChange:p,placeholder:"$0.00"}):h.jsx(Qi,{id:"default-amount",type:"number",value:f,onChange:A=>p(A.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&h.jsx("span",{style:{opacity:.6},children:"%"})]}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),h.jsxs(Ks,{children:[h.jsx(ke,{type:"submit",isLoading:b,children:i}),h.jsx(ke,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function QT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=I.useState(t||{name:""}),[c,d]=I.useState(!1);function f(p){p.preventDefault(),a.name.trim()&&(d(!0),e(a))}return h.jsxs(za,{onSubmit:f,children:[h.jsx(Ht,{label:"Group Name",htmlFor:"group-name",children:h.jsx(Qi,{id:"group-name",type:"text",value:a.name,onChange:p=>l({...a,name:p.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),h.jsxs(Ks,{children:[h.jsx(ke,{type:"submit",isLoading:c,children:i}),h.jsx(ke,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function GT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return h.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[h.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ve.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&h.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function U6({group:t,groupIndex:e,groupCategories:n,sortedGroups:i,categoryGroups:a,categoryBalances:l,loadingBalances:c,dragType:d,draggedId:f,dragOverId:p,dragOverGroupId:_,editingCategoryId:v,setEditingCategoryId:b,createForGroupId:T,setCreateForGroupId:S,editingGroupId:A,setEditingGroupId:R,handleCreateCategory:z,handleUpdateCategory:F,handleDeleteCategory:U,handleMoveCategory:X,handleUpdateGroup:Z,handleDeleteGroup:oe,handleMoveGroup:M,handleCategoryDragStart:C,handleCategoryDragOver:D,handleDragOverGroup:N,handleDragLeave:j,handleDragLeaveGroup:B,handleDragEnd:O,handleCategoryDrop:Y,handleDropOnGroup:q,handleGroupDragStart:P,handleGroupDrop:Q,setDragOverId:H,setDragOverGroupId:K,isMobile:te,categories:L}){const G=d==="group"&&f===t.id,ce=d==="group"&&p===t.id,J=d==="category"&&_===t.id,ie=f&&d==="category"?L[f]:null,_e=ie&&(ie.category_group_id||"ungrouped")!==t.id,Ee=d==="group"&&ce&&f!==t.id,be=e>0,xe=e<i.length-1;return h.jsxs("div",{children:[d==="group"&&!G&&h.jsxs("div",{onDragOver:he=>{he.preventDefault(),H(t.id)},onDragLeave:j,onDrop:he=>Q(he,t.id),style:{position:"relative",height:Ee?"2.5rem":"0.5rem",marginBottom:Ee?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[h.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ve.primary,borderRadius:"2px",opacity:Ee?1:0,transition:"opacity 0.15s",boxShadow:Ee?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),Ee&&h.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),h.jsx("div",{onDragOver:he=>N(he,t.id),onDragLeave:B,onDrop:he=>q(he,t.id),style:{background:G?"color-mix(in srgb, currentColor 3%, transparent)":J&&_e?`color-mix(in srgb, ${ve.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:G?.5:1,border:J&&_e?`2px dashed ${ve.primary}`:"2px solid transparent",transition:"all 0.15s"},children:A===t.id?h.jsx(QT,{initialData:{name:t.name},onSubmit:he=>Z(t.id,he),onCancel:()=>R(null),submitLabel:"Save"}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:te?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:te?"wrap":"nowrap"},children:[h.jsxs("h3",{style:{...bl,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!te&&h.jsx("span",{draggable:!0,onDragStart:he=>P(he,t.id),onDragEnd:O,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),h.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),h.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",n.length,")"]})]}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!te&&h.jsx(ke,{variant:"small",onClick:()=>S(t.id),disabled:T!==null,children:"+ Category"}),h.jsx("button",{onClick:()=>R(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),h.jsx("button",{onClick:()=>oe(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),h.jsxs("div",{style:Ny,children:[h.jsx("button",{onClick:()=>M(t.id,"up"),disabled:!be,style:{...rl,opacity:be?.6:.2,cursor:be?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),h.jsx("button",{onClick:()=>M(t.id,"down"),disabled:!xe,style:{...rl,opacity:xe?.6:.2,cursor:xe?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),te&&h.jsx("div",{style:{marginBottom:"0.5rem"},children:h.jsx(ke,{variant:"small",onClick:()=>S(t.id),disabled:T!==null,children:"+ Category"})}),h.jsxs("div",{style:Qs,children:[n.map(([he,nt])=>v===he?h.jsx(Bh,{initialData:{name:nt.name,description:nt.description,category_group_id:nt.category_group_id,default_monthly_amount:nt.default_monthly_amount,default_monthly_type:nt.default_monthly_type},onSubmit:Fe=>F(he,Fe),onCancel:()=>b(null),submitLabel:"Save",categoryGroups:a,showGroupSelector:!0},he):h.jsx(yf,{isDragging:d==="category"&&f===he,isDragOver:p===he,onDragStart:Fe=>{Fe.stopPropagation(),C(Fe,he)},onDragOver:Fe=>D(Fe,he,t.id),onDragLeave:j,onDragEnd:O,onDrop:Fe=>Y(Fe,he,t.id),onEdit:()=>b(he),onDelete:()=>U(he),onMoveUp:()=>X(he,"up"),onMoveDown:()=>X(he,"down"),canMoveUp:n.findIndex(([Fe])=>Fe===he)>0,canMoveDown:n.findIndex(([Fe])=>Fe===he)<n.length-1,children:h.jsx(HT,{category:nt,catId:he,categoryBalances:l,loadingBalances:c})},he)),n.length===0&&!T&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),d==="category"&&n.length>0&&h.jsx(GT,{groupId:t.id,isActive:p===`__end__${t.id}`,onDragOver:he=>{he.preventDefault(),he.stopPropagation(),H(`__end__${t.id}`),K(t.id)},onDragLeave:he=>{he.stopPropagation(),H(null)},onDrop:he=>{he.stopPropagation(),Y(he,"__group_end__",t.id)}}),T===t.id&&h.jsx(Bh,{initialData:{name:"",category_group_id:t.id},onSubmit:he=>z(he,t.id),onCancel:()=>S(null),submitLabel:"Create",categoryGroups:a})]}),T!==t.id&&h.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:h.jsx(ke,{variant:"small",onClick:()=>S(t.id),disabled:T!==null,children:"+ Add Category"})})]})})]})}function HT({category:t,catId:e,categoryBalances:n,loadingBalances:i}){const a=n[e]||{current:0,total:0};return h.jsxs("div",{children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[h.jsx("span",{style:Py,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&h.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?h.jsxs(h.Fragment,{children:[h.jsxs("span",{style:{color:ve.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):h.jsxs(h.Fragment,{children:[h.jsx("span",{style:{color:ve.success,fontWeight:500},children:qe(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),h.jsxs("div",{style:{marginTop:"0.25rem"},children:[h.jsxs("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:yn(a.current)},children:[i?"...":qe(a.current),h.jsx("span",{style:{fontSize:"0.75rem",fontWeight:400,opacity:.6,marginLeft:"0.35rem"},children:"available now"})]}),h.jsxs("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.85rem",fontWeight:500,color:yn(a.total),opacity:.75},children:[i?"...":qe(a.total),h.jsx("span",{style:{fontSize:"0.7rem",fontWeight:400,opacity:.7,marginLeft:"0.35rem"},children:"total allocated"})]})]})]})}function F6({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:i,dragType:a,draggedId:l,dragOverId:c,dragOverGroupId:d,editingCategoryId:f,setEditingCategoryId:p,createForGroupId:_,setCreateForGroupId:v,handleCreateCategory:b,handleUpdateCategory:T,handleDeleteCategory:S,handleMoveCategory:A,handleCategoryDragStart:R,handleCategoryDragOver:z,handleDragOverGroup:F,handleDragLeaveGroup:U,handleDragLeave:X,handleDragEnd:Z,handleCategoryDrop:oe,handleDropOnGroup:M,setDragOverId:C,setDragOverGroupId:D,categories:N,hasGroups:j}){const B=a==="category"&&d==="ungrouped",O=l&&a==="category"?N[l]:null,Y=O&&O.category_group_id!==null;return t.length===0&&!_&&j&&a!=="category"?null:h.jsxs("div",{onDragOver:q=>F(q,"ungrouped"),onDragLeave:U,onDrop:q=>M(q,"ungrouped"),style:{background:B&&Y?`color-mix(in srgb, ${ve.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:B&&Y?`2px dashed ${ve.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[h.jsxs("h3",{style:{...bl,margin:0,opacity:.7},children:["Uncategorized",h.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),h.jsx(ke,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Category"})]}),h.jsxs("div",{style:Qs,children:[t.map(([q,P])=>f===q?h.jsx(Bh,{initialData:{name:P.name,description:P.description,category_group_id:P.category_group_id,default_monthly_amount:P.default_monthly_amount,default_monthly_type:P.default_monthly_type},onSubmit:Q=>T(q,Q),onCancel:()=>p(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},q):h.jsx(yf,{isDragging:a==="category"&&l===q,isDragOver:c===q,onDragStart:Q=>R(Q,q),onDragOver:Q=>z(Q,q,"ungrouped"),onDragLeave:X,onDragEnd:Z,onDrop:Q=>oe(Q,q,"ungrouped"),onEdit:()=>p(q),onDelete:()=>S(q),onMoveUp:()=>A(q,"up"),onMoveDown:()=>A(q,"down"),canMoveUp:t.findIndex(([Q])=>Q===q)>0,canMoveDown:t.findIndex(([Q])=>Q===q)<t.length-1,children:h.jsx(HT,{category:P,catId:q,categoryBalances:n,loadingBalances:i})},q)),t.length===0&&a==="category"&&h.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),a==="category"&&t.length>0&&h.jsx(GT,{groupId:"ungrouped",isActive:c==="__end__ungrouped",onDragOver:q=>{q.preventDefault(),q.stopPropagation(),C("__end__ungrouped"),D("ungrouped")},onDragLeave:q=>{q.stopPropagation(),C(null)},onDrop:q=>{q.stopPropagation(),oe(q,"__group_end__","ungrouped")}}),_==="ungrouped"&&h.jsx(Bh,{initialData:{name:"",category_group_id:null},onSubmit:q=>b(q,"ungrouped"),onCancel:()=>v(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&h.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:h.jsx(ke,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function q6(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:i,sortedGroups:a,categoryBalances:l,isLoading:c,loadingBalances:d,error:f,setError:p,getOnBudgetTotal:_,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:T,handleMoveCategory:S,handleCreateGroup:A,handleUpdateGroup:R,handleDeleteGroup:z,handleMoveGroup:F,dragType:U,draggedId:X,dragOverId:Z,dragOverGroupId:oe,setDragOverId:M,setDragOverGroupId:C,handleCategoryDragStart:D,handleCategoryDragOver:N,handleDragOverGroup:j,handleDragLeave:B,handleDragLeaveGroup:O,handleDragEnd:Y,handleCategoryDrop:q,handleDropOnGroup:P,handleGroupDragStart:Q,handleGroupDrop:H}=u6(),K=Ys(),[te,L]=I.useState(null),[G,ce]=I.useState(null),[J,ie]=I.useState(null),[_e,Ee]=I.useState(!1);return t?c?h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),h.jsx("p",{style:Xc,children:"Organize your spending categories into groups."}),h.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",opacity:.7},children:h.jsx("p",{children:"Loading..."})})]}):h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),h.jsxs("p",{style:Xc,children:["Organize your spending categories into groups.",h.jsx("br",{}),h.jsx("span",{style:{fontSize:"0.9rem"},children:K?"Use  buttons to reorder items, or drag to move between groups.":"Drag categories between groups, or use  buttons to reorder."})]}),f&&h.jsx(El,{message:f,onDismiss:()=>p(null)}),h.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:h.jsx(Fy,{})}),(()=>{const be=Object.values(l).reduce((ln,en)=>ln+en.current,0),xe=Object.values(l).reduce((ln,en)=>ln+en.total,0),he=_()-be,nt=_()-xe,Fe=Math.abs(xe-be)>.01;return h.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[h.jsxs(Rc,{style:{flex:1,minWidth:"120px"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Categories"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:Object.keys(e).length})]}),h.jsxs(Rc,{style:{flex:1,minWidth:"120px"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Groups"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:n.length})]}),h.jsxs(Rc,{style:{flex:1,minWidth:"120px"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"On-Budget"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:yn(_())},children:qe(_())})]}),h.jsxs(Rc,{style:{flex:1,minWidth:"120px"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Allocated Now"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:ve.primary},children:d?"...":qe(be)}),Fe&&h.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:d?"":`${qe(xe)} total`})]}),h.jsxs(Rc,{style:{flex:1,minWidth:"120px"},children:[h.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Available Now"}),h.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:yn(he)},children:d?"...":qe(he)}),Fe&&h.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:d?"":`${qe(nt)} after future`})]})]})})(),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(e).length===0&&n.length===0&&h.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),a.map((be,xe)=>{const he=(i[be.id]||[]).sort((nt,Fe)=>nt[1].sort_order-Fe[1].sort_order);return h.jsx(U6,{group:be,groupIndex:xe,groupCategories:he,sortedGroups:a,categoryGroups:n,categoryBalances:l,loadingBalances:d,dragType:U,draggedId:X,dragOverId:Z,dragOverGroupId:oe,editingCategoryId:te,setEditingCategoryId:L,createForGroupId:G,setCreateForGroupId:ce,editingGroupId:J,setEditingGroupId:ie,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:T,handleMoveCategory:S,handleUpdateGroup:R,handleDeleteGroup:z,handleMoveGroup:F,handleCategoryDragStart:D,handleCategoryDragOver:N,handleDragOverGroup:j,handleDragLeave:B,handleDragLeaveGroup:O,handleDragEnd:Y,handleCategoryDrop:q,handleDropOnGroup:P,handleGroupDragStart:Q,handleGroupDrop:H,setDragOverId:M,setDragOverGroupId:C,isMobile:K,categories:e},be.id)}),U==="group"&&a.length>0&&h.jsx(By,{isActive:Z==="__end__",onDragOver:be=>{be.preventDefault(),M("__end__")},onDragLeave:B,onDrop:be=>H(be,"__end__"),label:"Move group to end"}),h.jsx(F6,{ungroupedCategories:(i.ungrouped||[]).sort((be,xe)=>be[1].sort_order-xe[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:d,dragType:U,draggedId:X,dragOverId:Z,dragOverGroupId:oe,editingCategoryId:te,setEditingCategoryId:L,createForGroupId:G,setCreateForGroupId:ce,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:T,handleMoveCategory:S,handleCategoryDragStart:D,handleCategoryDragOver:N,handleDragOverGroup:j,handleDragLeaveGroup:O,handleDragLeave:B,handleDragEnd:Y,handleCategoryDrop:q,handleDropOnGroup:P,setDragOverId:M,setDragOverGroupId:C,categories:e,hasGroups:n.length>0})]}),_e?h.jsx(QT,{onSubmit:be=>{A(be),Ee(!1)},onCancel:()=>Ee(!1),submitLabel:"Create Group"}):h.jsx(ke,{variant:"primary-large",onClick:()=>Ee(!0),children:"+ Add Category Group"})]}):h.jsx("p",{children:"No budget found. Please log in."})}const Q6=["accounts","categories","users"];function G6(){const{selectedBudgetId:t,currentUserId:e,lastSettingsTab:n,setLastSettingsTab:i}=on(),{isOwner:a,isLoading:l}=An(t,e),c=Vn(),d=c.pathname==="/budget/settings",f=I.useMemo(()=>{const T=c.pathname;return T.includes("/settings/accounts")?"accounts":T.includes("/settings/categories")?"categories":T.includes("/settings/users")?"users":"accounts"},[c.pathname]),p=f==="users";I.useEffect(()=>{d||i(f)},[f,d,i]);function _(){return!Q6.includes(n)||n==="users"&&!a?"accounts":n}const v=I.useMemo(()=>[{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!a}],[a]);return l?h.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:h.jsx("p",{children:"Loading..."})}):!a&&p?h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx(ui,{title:"Budget Settings"}),h.jsx("h1",{children:"Access Denied"}),h.jsx("p",{style:{opacity:.7},children:"Only the budget owner can access this section."}),h.jsx("p",{style:{marginTop:"1rem"},children:h.jsx(wt,{to:"/budget/settings/accounts",style:{color:"#646cff"},children:"Go to Accounts "})})]}):h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx(ui,{title:"Budget Settings"}),h.jsx(zy,{mode:"link",linkPrefix:"/budget/settings",tabs:v,activeTab:d?_():f}),d?h.jsx(Fh,{to:`/budget/settings/${_()}`,replace:!0}):h.jsx(qh,{})]})}function H6(){const{selectedBudgetId:t,currentUserId:e}=on(),{budget:n,budgetUserIds:i,acceptedUserIds:a,inviteUser:l,revokeUser:c}=An(t,e),[d,f]=I.useState(""),[p,_]=I.useState(!1),[v,b]=I.useState(null),[T,S]=I.useState(null);if(!n)return h.jsx("p",{children:"No budget found."});async function A(U){if(U.preventDefault(),!(!d.trim()||!n)){_(!0),b(null),S(null);try{await l(d.trim()),f(""),S("Invite sent! The user can now accept the invitation from their account.")}catch(X){b(X instanceof Error?X.message:"Failed to invite user")}finally{_(!1)}}}async function R(U){if(!n)return;if(U===n.owner_id){b("Cannot revoke the budget owner");return}if(U===e){b("Cannot revoke yourself from the budget");return}const X=a.includes(U);if(confirm(X?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){b(null),S(null);try{await c(U),S(X?"User access revoked.":"Invitation cancelled.")}catch(oe){b(oe instanceof Error?oe.message:"Failed to revoke user")}}}const z=i.filter(U=>a.includes(U)),F=i.filter(U=>!a.includes(U));return h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),h.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),v&&h.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:v}),h.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),T&&h.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:T}),h.jsx("button",{onClick:()=>S(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[h.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",z.length,")"]}),z.length===0?h.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:z.map(U=>{const X=U===n.owner_id,Z=U===e;return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[h.jsx("div",{style:{flex:1,minWidth:0},children:h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[h.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:U}),X&&h.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),Z&&h.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!X&&!Z&&h.jsx("button",{onClick:()=>R(U),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},U)})})]}),F.length>0&&h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[h.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",F.length,")"]}),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:F.map(U=>h.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[h.jsx("div",{style:{flex:1,minWidth:0},children:h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[h.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:U}),h.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),h.jsx("button",{onClick:()=>R(U),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},U))})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[h.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),h.jsxs("form",{onSubmit:A,style:{display:"flex",gap:"0.75rem"},children:[h.jsx("input",{type:"text",value:d,onChange:U=>f(U.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),h.jsx("button",{type:"submit",disabled:p||!d.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p||!d.trim()?"not-allowed":"pointer",fontWeight:500,opacity:p||!d.trim()?.7:1,whiteSpace:"nowrap"},children:p?"Inviting...":"Send Invite"})]}),h.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),h.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}const $6=["budget","feedback","migration","tests"];function K6(){const{isAdmin:t,isTest:e,lastAdminTab:n,setLastAdminTab:i}=on(),a=Vn(),l=a.pathname==="/budget/admin",c=I.useMemo(()=>{const _=a.pathname;return _.includes("/admin/budget")?"budget":_.includes("/admin/feedback")?"feedback":_.includes("/admin/migration")?"migration":_.includes("/admin/tests")?"tests":"budget"},[a.pathname]),d=c==="tests";I.useEffect(()=>{l||i(c)},[c,l,i]);function f(){return!$6.includes(n)||n==="tests"&&!e?"budget":n}const p=I.useMemo(()=>[{id:"budget",label:"Budget",icon:""},{id:"feedback",label:"Feedback",icon:""},{id:"migration",label:"Migration",icon:""},{id:"tests",label:"Tests",icon:"",hidden:!e}],[e]);return t?!e&&d?h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx(ui,{title:"Budget Admin"}),h.jsx("h1",{children:"Access Denied"}),h.jsx("p",{style:{opacity:.7},children:"Only test users can access this section."}),h.jsx("p",{style:{marginTop:"1rem"},children:h.jsx(wt,{to:"/budget/admin/budget",style:{color:"#646cff"},children:"Go to Admin "})})]}):h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx(ui,{title:"Budget Admin"}),h.jsx(zy,{mode:"link",linkPrefix:"/budget/admin",tabs:p,activeTab:c}),l?h.jsx(Fh,{to:`/budget/admin/${f()}`,replace:!0}):h.jsx(qh,{})]}):h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx(ui,{title:"Budget Admin"}),h.jsx("h1",{children:"Access Denied"}),h.jsx("p",{style:{opacity:.7},children:"Only administrators can access this section."}),h.jsx("p",{style:{marginTop:"1rem"},children:h.jsx(wt,{to:"/budget",style:{color:"#646cff"},children:"Go to Budget "})})]})}function Y6(){const{selectedBudgetId:t,currentUserId:e,isAdmin:n}=on(),{budget:i,accounts:a,accountGroups:l,categories:c,categoryGroups:d,isOwner:f,isLoading:p}=An(t,e);return p?h.jsx("p",{children:"Loading budget info..."}):i?h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Budget Summary"}),h.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Information about the currently selected budget."}),h.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",fontSize:"0.95rem"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""}),h.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Name:"}),h.jsx("strong",{children:i.name})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""}),h.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"ID:"}),h.jsx("code",{style:{background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:i.id})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""}),h.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Owner:"}),h.jsx("strong",{children:i.owner_email||i.owner_id})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""}),h.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Users:"}),h.jsxs("span",{children:[i.user_ids.length," user",i.user_ids.length!==1?"s":"",h.jsxs("span",{style:{opacity:.7},children:["  ",f?"You are the owner":"Shared with you"]})]})]})]})}),n&&h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[h.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem"},children:"Admin Tools"}),h.jsx("button",{onClick:()=>{const _={...i,accounts:a,account_groups:l,categories:c,category_groups:d,_meta:{downloaded_at:new Date().toISOString()}},v=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),b=URL.createObjectURL(v),T=document.createElement("a");T.href=b,T.download=`budget_${i.id}.json`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(b)},style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",transition:"background 0.15s"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]})]}):h.jsx("p",{style:{opacity:.7},children:"No budget selected."})}function Rx({budget:t,isCurrent:e,isAccepting:n,isSwitching:i,isEditing:a,editName:l,isRenaming:c,onAccept:d,onSwitch:f,onStartEdit:p,onCancelEdit:_,onEditNameChange:v,onSaveEdit:b}){const T=e&&t.isOwner;return h.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:a?h.jsxs("form",{onSubmit:b,children:[h.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:h.jsx("input",{type:"text",value:l,onChange:S=>v(S.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[h.jsx("button",{type:"submit",disabled:c||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:c||!l.trim()?.7:1,fontSize:"0.8rem"},children:c?"Saving...":"Save"}),h.jsx("button",{type:"button",onClick:_,disabled:c,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c?"not-allowed":"pointer",fontWeight:500,opacity:c?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[h.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[h.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&h.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&h.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&h.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),T&&h.jsx("button",{onClick:p,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),h.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),h.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?h.jsx("button",{onClick:d,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:h.jsx("button",{onClick:f,disabled:i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,fontSize:"0.85rem"},children:i?"Switching...":"Switch"})})]})})}const Rg={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function $T({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,i=n&&n in Rg?n:"bug",a=Rg[i];return h.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:a.bgColor,color:a.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:a.label})}function W6({item:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:d,onToggleDone:f,onTypeClick:p}){return h.jsxs("div",{onDragOver:_=>{_.stopPropagation(),a(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),d(_)},style:{position:"relative"},children:[h.jsx("div",{style:{...LT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),h.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:c,style:{...mu,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[h.jsx("span",{style:{...VT},children:""}),h.jsx("input",{type:"checkbox",checked:t.is_done,onChange:f,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ve.primary,flexShrink:0}}),h.jsx($T,{type:t.feedback_type,onClick:p})]}),h.jsxs("div",{style:{marginLeft:"3.25rem"},children:[h.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),h.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",Cg(t.created_at)]})]})]})]})}function X6({item:t,onToggleDone:e,onTypeClick:n}){return h.jsxs("div",{style:{...mu,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[h.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ve.primary,flexShrink:0}}),h.jsx($T,{type:t.feedback_type,onClick:n})]}),h.jsxs("div",{style:{marginLeft:"2rem"},children:[h.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),h.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",Cg(t.created_at)]}),t.completed_at&&h.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:ve.success},children:[" Completed: ",Cg(t.completed_at)]})]})]})}function _f({noMargin:t}={}){return h.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:t?0:"0.5rem",verticalAlign:"middle"}})}function qy({title:t,description:e,status:n,statusText:i,onRefresh:a,isRefreshing:l,isBusy:c=!1,children:d}){const p=(()=>{switch(n){case"unknown":return{color:"#9ca3af",text:i??"Unknown"};case"clean":case"complete":return{color:"#22c55e",text:i??" Clean"};case"needs-action":return{color:"#f59e0b",text:i??"Action Needed"}}})(),_=l||c;return h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:t}),h.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.9rem"},children:e})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexShrink:0},children:[n!=="unknown"&&h.jsx("span",{style:{color:p.color,fontWeight:600,fontSize:"0.9rem"},children:p.text}),h.jsxs("button",{onClick:a,disabled:_,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem 0.65rem",borderRadius:"6px",cursor:_?"not-allowed":"pointer",fontWeight:500,fontSize:"0.85rem",opacity:_?.6:1,display:"flex",alignItems:"center",gap:"0.3rem"},title:"Refresh status",children:[l?h.jsx(_f,{noMargin:!0}):""," Refresh"]})]})]}),d]})}const J6={unknown:{bg:"rgba(100, 100, 100, 0.1)",border:"rgba(100, 100, 100, 0.3)",color:"#9ca3af"},clean:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"},warning:{bg:"rgba(245, 158, 11, 0.1)",border:"rgba(245, 158, 11, 0.3)",color:"#fbbf24"},running:{bg:"rgba(100, 108, 255, 0.1)",border:"rgba(100, 108, 255, 0.3)",color:"#a5b4fc"},success:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"}};function Pn({type:t,children:e}){const n=J6[t];return h.jsx("div",{style:{background:n.bg,border:`1px solid ${n.border}`,color:n.color,padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:e})}function Qy({onClick:t,disabled:e,isBusy:n,busyText:i,children:a}){const l=e||n;return h.jsx("button",{onClick:t,disabled:l,style:{marginTop:"1rem",background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:l?"not-allowed":"pointer",fontWeight:500,opacity:l?.7:1,display:"flex",alignItems:"center",gap:"0.4rem"},children:n?h.jsxs(h.Fragment,{children:[h.jsx(_f,{noMargin:!0})," ",i??"Running..."]}):a})}function Z6({title:t,description:e,isComplete:n,isMigrating:i,needsMigration:a,totalBudgetsToMigrate:l,budgetsToMigrateCategories:c,budgetsToMigrateAccounts:d,onRunMigration:f,onRefresh:p,isRefreshing:_,disabled:v,isUnknown:b,children:T}){const S=()=>b?"unknown":n?"complete":a?"needs-action":"clean",A=()=>b?"Unknown":n?" Complete":a?"Required":" Clean";return h.jsxs(qy,{title:t,description:e,status:S(),statusText:A(),onRefresh:p,isRefreshing:_,isBusy:i,children:[i?h.jsxs(Pn,{type:"running",children:[h.jsx(_f,{})," Running migration across all budgets..."]}):b?h.jsx(Pn,{type:"unknown",children:" Status unknown  click Refresh to check migration status"}):n?h.jsx(Pn,{type:"clean",children:" All budgets are using the new map structure"}):a?h.jsxs(h.Fragment,{children:[h.jsx(Pn,{type:"warning",children:h.jsxs("div",{children:[h.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",l," budget(s) needing migration:"]}),h.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[c>0&&h.jsxs("li",{children:[c," with categories to migrate"]}),d>0&&h.jsxs("li",{children:[d," with accounts to migrate"]})]})]})}),h.jsx(Qy,{onClick:f,disabled:v,children:"Migrate All Budgets"})]}):null,T]})}function e4({results:t}){return h.jsxs("div",{style:{marginTop:"1rem"},children:[h.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem"},children:"Migration Results:"}),h.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:t.map((e,n)=>h.jsx(t4,{result:e,isLast:n===t.length-1},n))})]})}function t4({result:t,isLast:e}){const n=t.error&&t.error!=="Already migrated",i=t.error==="Already migrated";return h.jsxs("div",{style:{padding:"0.5rem",marginBottom:e?0:"0.5rem",borderRadius:"4px",background:n?"rgba(220, 38, 38, 0.1)":i?"rgba(100, 100, 100, 0.1)":"rgba(34, 197, 94, 0.1)",border:n?"1px solid rgba(220, 38, 38, 0.3)":i?"1px solid rgba(100, 100, 100, 0.3)":"1px solid rgba(34, 197, 94, 0.3)"},children:[h.jsxs("div",{style:{fontWeight:500},children:[n?"":i?"":""," ",t.budgetName]}),n?h.jsxs("div",{style:{fontSize:"0.85rem",opacity:.8,color:"#f87171"},children:["Error: ",t.error]}):i?h.jsx("div",{style:{fontSize:"0.85rem",opacity:.6},children:"Already using map structure"}):h.jsxs("div",{style:{fontSize:"0.85rem",opacity:.7},children:[t.categoriesMigrated>0&&`Migrated ${t.categoriesMigrated} categories`,t.categoriesMigrated>0&&(t.accountsMigrated>0||t.accountGroupsMigrated>0)&&", ",t.accountsMigrated>0&&`${t.accountsMigrated} accounts`,t.accountsMigrated>0&&t.accountGroupsMigrated>0&&", ",t.accountGroupsMigrated>0&&`${t.accountGroupsMigrated} account groups`,t.balancesCalculated&&" with calculated balances"]})]})}function n4({hasData:t,futureMonthsCount:e,futureMonthsToDelete:n,isCleaningFutureMonths:i,onCleanup:a,onRefresh:l,isRefreshing:c,disabled:d,cleanupResult:f}){const p=()=>t?f&&f.deleted>0?"complete":e===0?"clean":"needs-action":"unknown";return h.jsx(qy,{title:" Clean Up Future Months",description:"Deletes month documents that are more than 2 months in the future. These can be created accidentally when navigating too far ahead.",status:p(),onRefresh:l,isRefreshing:c,isBusy:i,children:i?h.jsx(Pn,{type:"running",children:"Deleting future months..."}):f?h.jsx(Pn,{type:f.errors.length>0?"warning":"success",children:h.jsxs("div",{children:[f.errors.length>0?"":""," Deleted ",f.deleted," month",f.deleted!==1?"s":"",f.errors.length>0&&h.jsx("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem"},children:f.errors.map((_,v)=>h.jsx("li",{children:_},v))})]})}):t?e>0?h.jsxs(h.Fragment,{children:[h.jsx(Pn,{type:"warning",children:h.jsxs("div",{children:[h.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e," month",e!==1?"s":""," to delete:"]}),h.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[n.slice(0,10).map(_=>h.jsxs("li",{children:[My[_.month-1]," ",_.year," (budget: ",_.budgetId.slice(0,8),"...)"]},_.docId)),e>10&&h.jsxs("li",{style:{opacity:.7},children:["...and ",e-10," more"]})]})]})}),h.jsxs(Qy,{onClick:a,disabled:d,isBusy:i,busyText:"Deleting...",children:[" Delete ",e," Future Month",e!==1?"s":""]})]}):h.jsx(Pn,{type:"clean",children:" No future months found beyond 2 months from now."}):h.jsx(Pn,{type:"unknown",children:" Status unknown  click Refresh to check for future months"})})}function r4({hasData:t,status:e,isMigrating:n,onMigrate:i,onRefresh:a,isRefreshing:l,disabled:c,migrationResult:d}){const f=e&&(e.sanitizedDocuments.length>0||e.corruptedDocuments.length>0),p=d&&(d.deletedDocuments>0||d.fixedDocuments>0),_=()=>t?p?"complete":f?"needs-action":"clean":"unknown";return h.jsx(qy,{title:" Consolidate Feedback Documents",description:"Fixes corrupted feedback data and merges documents with sanitized IDs into proper email format.",status:_(),onRefresh:a,isRefreshing:l,isBusy:n,children:n?h.jsx(Pn,{type:"running",children:"Migrating feedback documents..."}):t?p?h.jsx(Pn,{type:"success",children:h.jsxs("div",{children:[" Migration complete:",h.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[d.fixedDocuments>0&&h.jsxs("li",{children:["Fixed ",d.fixedDocuments," corrupted document(s)"]}),d.deletedDocuments>0&&h.jsxs("li",{children:["Merged & deleted ",d.deletedDocuments," sanitized document(s)"]}),d.mergedItems>0&&h.jsxs("li",{children:["Merged ",d.mergedItems," feedback item(s)"]})]}),d.errors.length>0&&h.jsxs(h.Fragment,{children:[h.jsx("div",{style:{marginTop:"0.5rem"},children:" Errors:"}),h.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:d.errors.map((v,b)=>h.jsx("li",{children:v},b))})]})]})}):f?h.jsxs(h.Fragment,{children:[h.jsx(Pn,{type:"warning",children:h.jsxs("div",{children:[e?.corruptedDocuments&&e.corruptedDocuments.length>0&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.corruptedDocuments.length," corrupted document(s):"]}),h.jsx("ul",{style:{margin:"0 0 0.75rem 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.corruptedDocuments.map(v=>h.jsxs("li",{children:[v," ",h.jsx("span",{style:{opacity:.6},children:"(broken arrayUnion)"})]},v))})]}),e?.sanitizedDocuments&&e.sanitizedDocuments.length>0&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.sanitizedDocuments.length," sanitized document(s) to merge:"]}),h.jsx("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.sanitizedDocuments.map(v=>h.jsx("li",{children:v},v))})]})]})}),h.jsx(Qy,{onClick:i,disabled:c,isBusy:n,busyText:"Migrating...",children:"Run Migration"})]}):h.jsxs(Pn,{type:"clean",children:[" No issues found. All feedback documents are healthy.",h.jsxs("span",{style:{display:"block",fontSize:"0.85rem",opacity:.7,marginTop:"0.25rem"},children:["Found ",e?.documentsFound??0," document(s) total."]})]}):h.jsx(Pn,{type:"unknown",children:" Status unknown  click Refresh to scan for issues"})})}function i4(){Ne.clear();try{localStorage.removeItem("BUDGET_APP_QUERY_CACHE"),console.log("[Cache] Cleared all React Query caches from memory and localStorage")}catch(t){console.warn("Failed to clear localStorage cache:",t)}window.location.reload()}function s4(){const e=Ba().get_current_firebase_user(),n=d6({currentUser:e}),i=m6({currentUser:e}),a=g6({currentUser:e}),l=n.status?.categoriesArrayMigrationNeeded||n.status?.accountsArrayMigrationNeeded,c=Math.max(n.status?.budgetsToMigrateCategories??0,n.status?.budgetsToMigrateAccounts??0),d=n.isScanning||i.isScanning||a.isScanning,f=n.isMigrating||i.isCleaningFutureMonths||a.isMigratingFeedback,p=async()=>{await Promise.all([n.scanStatus(),i.scanStatus(),a.scanStatus()])};return h.jsxs("div",{children:[h.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[h.jsx("h2",{style:{margin:0},children:"Data Migrations"}),h.jsxs("button",{onClick:p,disabled:d||f,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:d||f?"not-allowed":"pointer",fontWeight:500,opacity:d||f?.7:1,display:"flex",alignItems:"center",gap:"0.4rem",minWidth:"130px",minHeight:"36px"},children:[h.jsx("span",{style:{width:"18px",height:"18px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:d?h.jsx(_f,{noMargin:!0}):""}),"Refresh All"]})]}),h.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:'Run migrations to update your budget data structure. Click "Refresh All" to scan Firestore directly.'}),h.jsx(Z6,{title:"Migrate Data to Map Structure",description:"Converts categories, accounts, and account groups from array format to map structure. This improves performance and enables direct lookup by ID.",isComplete:n.status?!l:!1,isMigrating:n.isMigrating,needsMigration:n.status?!!l:!1,totalBudgetsToMigrate:c,budgetsToMigrateCategories:n.status?.budgetsToMigrateCategories??0,budgetsToMigrateAccounts:n.status?.budgetsToMigrateAccounts??0,onRunMigration:n.runMigration,onRefresh:n.scanStatus,isRefreshing:n.isScanning,disabled:!e,isUnknown:!n.status,children:n.migrationResults&&h.jsx(e4,{results:n.migrationResults})}),h.jsx(n4,{hasData:!!i.status,futureMonthsCount:i.status?.futureMonthsCount??0,futureMonthsToDelete:i.status?.futureMonthsToDelete??[],isCleaningFutureMonths:i.isCleaningFutureMonths,onCleanup:i.cleanupFutureMonths,onRefresh:i.scanStatus,isRefreshing:i.isScanning,disabled:!e,cleanupResult:i.futureMonthsCleanupResult}),h.jsx(r4,{hasData:!!a.status,status:a.status,isMigrating:a.isMigratingFeedback,onMigrate:a.migrateFeedbackDocuments,onRefresh:a.scanStatus,isRefreshing:a.isScanning,disabled:!e,migrationResult:a.feedbackMigrationResult}),h.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:h.jsxs("p",{style:{margin:0,opacity:.7},children:[h.jsx("strong",{children:"Note:"})," This migration will process ",h.jsxs("strong",{children:["all ",n.status?.totalBudgetsChecked??"?"," budgets"]})," in the system, not just the ones you own or are invited to."]})}),h.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, #ff6b6b 10%, transparent)",borderRadius:"8px",border:"1px solid color-mix(in srgb, #ff6b6b 30%, transparent)"},children:[h.jsxs("p",{style:{margin:"0 0 0.75rem 0",fontSize:"0.9rem"},children:[h.jsx("strong",{children:" Clear All Caches"}),h.jsx("span",{style:{opacity:.7,display:"block",marginTop:"0.25rem"},children:"If you're seeing stale data after running migrations, clear all cached data and reload to fetch fresh data from Firestore."})]}),h.jsx("button",{onClick:i4,style:{background:"#dc2626",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,display:"flex",alignItems:"center",gap:"0.4rem"},children:" Clear All Caches & Reload"})]})]})}function a4(){const[t,e]=I.useState(null),[n,i]=I.useState(null),[a,l]=I.useState(null),[c,d]=I.useState(!1),[f,p]=I.useState(""),[_,v]=I.useState("bug"),[b,T]=I.useState(null),[S,A]=I.useState(null),R=I.useContext(eu),F=Ba().get_current_firebase_user(),U=$5(),X=eT(),Z=U.data?.items||[];function oe(H){H.preventDefault(),!(!f.trim()||!R.username||!F)&&(X.submitFeedback.mutate({userId:F.uid,userEmail:R.username,text:f.trim(),feedbackType:_,currentPath:"/settings/feedback"}),p(""),v("bug"),d(!1))}function M(H){H.is_done?C(H):T(H)}async function C(H){try{await X.toggleFeedback.mutateAsync({item:H})}catch(K){e(K instanceof Error?K.message:"Failed to update feedback")}}function D(){b&&(C(b),T(null))}async function N(H){if(S){try{const te=Z.filter(L=>L.doc_id===S.doc_id).map(L=>L.id===S.id?{id:L.id,text:L.text,created_at:L.created_at,is_done:L.is_done,completed_at:L.completed_at,sort_order:L.sort_order,feedback_type:H}:{id:L.id,text:L.text,created_at:L.created_at,is_done:L.is_done,completed_at:L.completed_at,sort_order:L.sort_order,feedback_type:L.feedback_type});await X.updateSortOrder.mutateAsync({docId:S.doc_id,items:te})}catch(K){e(K instanceof Error?K.message:"Failed to update feedback type")}A(null)}}const j=Z.filter(H=>!H.is_done).sort((H,K)=>H.sort_order-K.sort_order),B=Z.filter(H=>H.is_done).sort((H,K)=>{const te=H.completed_at?new Date(H.completed_at).getTime():0;return(K.completed_at?new Date(K.completed_at).getTime():0)-te});function O(H,K){i(K),H.dataTransfer.effectAllowed="move"}function Y(H,K){H.preventDefault(),K!==n&&l(K)}function q(){l(null)}function P(){i(null),l(null)}async function Q(H,K){if(H.preventDefault(),!n||n===K){P();return}const te=j.findIndex(ie=>ie.id===n),L=[...j],[G]=L.splice(te,1);if(K==="__end__")L.push(G);else{const ie=L.findIndex(_e=>_e.id===K);L.splice(ie,0,G)}const ce=L.map((ie,_e)=>({...ie,sort_order:_e}));P();const J=new Map;for(const ie of ce)J.has(ie.doc_id)||J.set(ie.doc_id,[]),J.get(ie.doc_id).push({id:ie.id,text:ie.text,created_at:ie.created_at,is_done:ie.is_done,completed_at:ie.completed_at,sort_order:ie.sort_order,feedback_type:ie.feedback_type});for(const ie of B)J.has(ie.doc_id)||J.set(ie.doc_id,[]),J.get(ie.doc_id).push({id:ie.id,text:ie.text,created_at:ie.created_at,is_done:ie.is_done,completed_at:ie.completed_at,sort_order:ie.sort_order,feedback_type:ie.feedback_type});try{for(const[ie,_e]of J)await X.updateSortOrder.mutateAsync({docId:ie,items:_e})}catch(ie){e(ie instanceof Error?ie.message:"Failed to save order")}}return U.isLoading?h.jsx("p",{children:"Loading feedback..."}):h.jsxs("div",{children:[h.jsx("h2",{style:{marginTop:0},children:"Feedback"}),h.jsx("p",{style:{...Xc,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&h.jsx(El,{message:t,onDismiss:()=>e(null)}),h.jsxs("div",{style:Qs,children:[j.length===0&&!c&&h.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),j.map(H=>h.jsx(W6,{item:H,isDragging:n===H.id,isDragOver:a===H.id,onDragStart:K=>O(K,H.id),onDragOver:K=>Y(K,H.id),onDragLeave:q,onDragEnd:P,onDrop:K=>Q(K,H.id),onToggleDone:()=>M(H),onTypeClick:()=>A(H)},H.id)),n&&j.length>0&&h.jsx(By,{isActive:a==="__end__",onDragOver:H=>Y(H,"__end__"),onDragLeave:q,onDrop:H=>Q(H,"__end__")})]}),c?h.jsxs(za,{onSubmit:oe,children:[h.jsx(Dx,{selectedType:_,onSelect:v}),h.jsx(Vy,{value:f,onChange:H=>p(H.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),h.jsxs(Ks,{children:[h.jsx(ke,{type:"submit",disabled:!f.trim(),children:"Add Feedback"}),h.jsx(ke,{type:"button",variant:"secondary",onClick:()=>{d(!1),p(""),v("bug")},children:"Cancel"})]})]}):h.jsx(ke,{variant:"primary-large",onClick:()=>d(!0),children:"+ Add Feedback"}),B.length>0&&h.jsx(JN,{title:"Completed",count:B.length,children:h.jsx("div",{style:{...Qs,marginTop:"0.5rem"},children:B.map(H=>h.jsx(X6,{item:H,onToggleDone:()=>M(H),onTypeClick:()=>A(H)},H.id))})}),h.jsxs(Vh,{isOpen:b!==null,onClose:()=>T(null),title:"Mark as Complete",children:[h.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),b&&h.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',b.text,'"']}),h.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[h.jsx(ke,{variant:"secondary",onClick:()=>T(null),children:"Cancel"}),h.jsx(ke,{variant:"primary",onClick:D,children:"Mark Complete"})]})]}),h.jsxs(Vh,{isOpen:S!==null,onClose:()=>A(null),title:"Change Feedback Type",children:[h.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),h.jsx(Dx,{selectedType:S?.feedback_type||"bug",onSelect:N}),h.jsx(ke,{variant:"secondary",onClick:()=>A(null),style:{width:"100%"},children:"Cancel"})]})]})}function Dx({selectedType:t,onSelect:e}){return h.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const i=Rg[n],a=t==="feature"?"new_feature":t,l=a===n||!a&&n==="bug";return h.jsxs("button",{type:"button",onClick:()=>e(n),style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${i.color}`,borderRadius:"0.5rem",background:l?i.bgColor:"transparent",color:l?i.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${i.bgColor}`:"none",position:"relative"},children:[i.label,l&&h.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function o4(){const{currentUserId:t}=on(),[e,n]=I.useState([]),[i,a]=I.useState(!1);function l(b,T){n(S=>S.map(A=>A.name===b?{...A,...T}:A))}async function c(){a(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await d("Read unauthorized budget",async()=>(await Ce("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0),await d("Read another user's document",async()=>(await Ce("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0),await d("Read unauthorized budget month",async()=>(await Ce("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0),await d("Toggle is_admin in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:T}=await Ce("users",t,"security test: reading own user to get current is_admin value"),S=T?.permission_flags?.is_admin??!1;return await Xd("users",t,{"permission_flags.is_admin":!S},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${S} to ${!S} (SECURITY ISSUE!)`},!0),await d("Toggle is_test in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:T}=await Ce("users",t,"security test: reading own user to get current is_test value"),S=T?.permission_flags?.is_test??!1;return await Xd("users",t,{"permission_flags.is_test":!S},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${S} to ${!S} (SECURITY ISSUE!)`},!0),await d("Read own user document",async()=>{if(!t)throw new Error("Not authenticated");const{exists:T}=await Ce("users",t,"security test: reading own user document (should succeed)");if(T)return"Successfully read own document";throw new Error("Document does not exist")},!1),a(!1)}async function d(b,T,S){l(b,{status:"running",message:"Running..."});try{const A=await T();S?l(b,{status:"failed",message:` ${A}`}):l(b,{status:"passed",message:` ${A}`})}catch(A){const R=A instanceof Error?A.message:"Unknown error";S?l(b,{status:"passed",message:` Blocked as expected: ${R}`}):l(b,{status:"failed",message:` ${R}`})}}async function f(b){switch(e.find(S=>S.name===b)||n(S=>[...S,{name:b,status:"pending",message:"",expectedToFail:!0}]),a(!0),b){case"Read unauthorized budget":await d(b,async()=>(await Ce("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0);break;case"Read another user's document":await d(b,async()=>(await Ce("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0);break;case"Read unauthorized budget month":await d(b,async()=>(await Ce("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0);break;case"Toggle is_admin in own permission_flags":await d(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:S}=await Ce("users",t,"security test: reading own user to get current is_admin value"),A=S?.permission_flags?.is_admin??!1;return await Xd("users",t,{"permission_flags.is_admin":!A},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${A} to ${!A} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await d(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:S}=await Ce("users",t,"security test: reading own user to get current is_test value"),A=S?.permission_flags?.is_test??!1;return await Xd("users",t,{"permission_flags.is_test":!A},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${A} to ${!A} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await d(b,async()=>{if(!t)throw new Error("Not authenticated");const{exists:S}=await Ce("users",t,"security test: reading own user document (should succeed)");if(S)return"Successfully read own document";throw new Error("Document does not exist")},!1);break}a(!1)}const p=e.filter(b=>b.status==="passed").length,_=e.filter(b=>b.status==="failed").length,v=e.length;return h.jsxs("div",{children:[h.jsx("p",{style:Xc,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),h.jsx("div",{style:{marginBottom:"1.5rem"},children:h.jsx(ke,{onClick:c,disabled:i,variant:"primary",children:i?"Running Tests...":"Run All Tests"})}),e.length>0&&h.jsx("div",{style:{marginBottom:"1.5rem"},children:h.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[h.jsxs("span",{children:["Total: ",h.jsx("strong",{children:v})]}),h.jsxs("span",{style:{color:ve.success},children:["Passed: ",h.jsx("strong",{children:p})]}),h.jsxs("span",{style:{color:ve.danger},children:["Failed: ",h.jsx("strong",{children:_})]})]})}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[h.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),h.jsx(Oo,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read unauthorized budget"),onRun:()=>f("Read unauthorized budget"),disabled:i}),h.jsx(Oo,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read another user's document"),onRun:()=>f("Read another user's document"),disabled:i}),h.jsx(Oo,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(b=>b.name==="Read unauthorized budget month"),onRun:()=>f("Read unauthorized budget month"),disabled:i}),h.jsx(Oo,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_admin in own permission_flags"),onRun:()=>f("Toggle is_admin in own permission_flags"),disabled:i}),h.jsx(Oo,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_test in own permission_flags"),onRun:()=>f("Toggle is_test in own permission_flags"),disabled:i}),h.jsx(Oo,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(b=>b.name==="Read own user document"),onRun:()=>f("Read own user document"),disabled:i,expectedToSucceed:!0})]}),_>0&&h.jsxs(El,{style:{marginTop:"1.5rem"},children:[" ",_," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function Oo({name:t,description:e,expectedBehavior:n,result:i,onRun:a,disabled:l,expectedToSucceed:c}){const d=i?.status==="passed"?ve.success:i?.status==="failed"?ve.danger:i?.status==="running"?ve.warning:"inherit";return h.jsxs("div",{style:{...mu,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),h.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),h.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:c?ve.success:ve.warning},children:["Expected: ",n]})]}),h.jsx(ke,{onClick:a,disabled:l,variant:"secondary",style:{flexShrink:0},children:i?.status==="running"?"":"Run"})]}),i&&i.status!=="pending"&&h.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${d} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${d} 30%, transparent)`,fontSize:"0.85rem",color:d},children:i.message})]})}function l4(){const{selectedBudgetId:t,currentUserId:e,accessibleBudgets:n,loadAccessibleBudgets:i,switchToBudget:a,checkBudgetInvite:l,isInitialized:c}=on(),{budget:d,renameBudget:f,acceptInvite:p,isLoading:_}=An(t,e),[v,b]=I.useState(null),[T,S]=I.useState(null),[A,R]=I.useState(null),[z,F]=I.useState(null),[U,X]=I.useState(null),[Z,oe]=I.useState(""),[M,C]=I.useState(!1),[D,N]=I.useState(""),[j,B]=I.useState(!1),[O,Y]=I.useState(null);async function q(J){if(J!==d?.id){b(J),R(null),F(null);try{await a(J),F("Switched to budget successfully!"),await i()}catch(ie){R(ie instanceof Error?ie.message:"Failed to switch budget")}finally{b(null)}}}async function P(J){S(J),R(null),F(null);try{await p(J),F("Invitation accepted! You now have access to this budget."),await i()}catch(ie){R(ie instanceof Error?ie.message:"Failed to accept invitation")}finally{S(null)}}async function Q(J){if(J.preventDefault(),!!D.trim()){B(!0),R(null),Y(null);try{const ie=await l(D.trim());ie?Y(ie):R("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(ie){R(ie instanceof Error?ie.message:"Failed to check invitation")}finally{B(!1)}}}async function H(){if(O){S(O.budgetId),R(null);try{await p(O.budgetId),F(`Successfully joined "${O.budgetName}"!`),Y(null),N(""),await i()}catch(J){R(J instanceof Error?J.message:"Failed to accept invitation")}finally{S(null)}}}function K(J,ie){oe(ie),X(J)}function te(){X(null),oe("")}async function L(J){if(J.preventDefault(),!(!Z.trim()||!U)){C(!0),R(null),F(null);try{await f(Z.trim()),F("Budget renamed successfully!"),X(null),await i()}catch(ie){R(ie instanceof Error?ie.message:"Failed to rename budget")}finally{C(!1)}}}const G=n.filter(J=>!J.isPending),ce=n.filter(J=>J.isPending);return _||!c?h.jsx($o,{children:h.jsx("p",{children:"Loading your budgets..."})}):h.jsxs($o,{children:[h.jsx(ui,{title:"My Budgets"}),h.jsx("h1",{children:"My Budgets"}),h.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Switch between budgets, accept invitations, or join a budget by ID."}),A&&h.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:A}),h.jsx("button",{onClick:()=>R(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),z&&h.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("span",{children:z}),h.jsx("button",{onClick:()=>F(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),ce.length>0&&h.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[h.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""})," Pending Invitations (",ce.length,")"]}),h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:ce.map(J=>h.jsx(Rx,{budget:J,isCurrent:!1,isAccepting:T===J.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>P(J.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},J.id))})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[h.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""})," Your Budgets (",G.length,")"]}),G.length===0?h.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):h.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:G.map(J=>{const ie=J.id===d?.id,_e=U===J.id;return h.jsx(Rx,{budget:J,isCurrent:ie,isAccepting:!1,isSwitching:v===J.id,isEditing:_e,editName:_e?Z:"",isRenaming:M,onAccept:()=>{},onSwitch:()=>q(J.id),onStartEdit:()=>K(J.id,J.name),onCancelEdit:te,onEditNameChange:oe,onSaveEdit:L},J.id)})})]}),h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[h.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("span",{children:""})," Join Budget by ID"]}),h.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),O?h.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[h.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),h.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[h.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:O.budgetName}),O.ownerEmail&&h.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",O.ownerEmail]})]}),h.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[h.jsx("button",{onClick:H,disabled:T===O.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:T===O.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:T===O.budgetId?.7:1},children:T===O.budgetId?"Accepting...":"Accept Invitation"}),h.jsx("button",{onClick:()=>{Y(null),N("")},disabled:T===O.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:T===O.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:T===O.budgetId?.7:.8},children:"Cancel"})]})]}):h.jsxs("form",{onSubmit:Q,style:{display:"flex",gap:"0.75rem"},children:[h.jsx("input",{type:"text",value:D,onChange:J=>N(J.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),h.jsx("button",{type:"submit",disabled:j||!D.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:j||!D.trim()?"not-allowed":"pointer",fontWeight:500,opacity:j||!D.trim()?.7:1,whiteSpace:"nowrap"},children:j?"Checking...":"Check Invite"})]})]}),e&&h.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[h.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),h.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:e})]})]})}function c4({children:t}){const e=I.useContext(eu),n=Vn();return e.is_auth_checked?e.is_logged_in?t?h.jsx(h.Fragment,{children:t}):h.jsx(qh,{}):h.jsx(Fh,{to:"/account",state:{from:n.pathname},replace:!0}):h.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:h.jsx("p",{children:"Loading..."})})}function u4(){const{selectedBudgetId:t,currentUserId:e,isInitialized:n}=on(),{isLoading:i,error:a}=An(t,e);return n?a?(console.error("[BudgetLayout] Error:",a),h.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:h.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",a.message]})})):h.jsx("div",{style:{paddingBottom:"5rem"},children:h.jsx(qh,{})}):h.jsxs("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:[h.jsx("p",{children:"Loading budget..."}),i&&h.jsx("p",{style:{opacity:.6},children:"Fetching data from server..."})]})}const d4={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function h4(){const[t,e]=I.useState(d4),n=Ba(),i=I.useRef(!1);return I.useEffect(function(){i.current||(i.current=!0,n.set_user_listener(a=>{e({is_logged_in:a!=null,is_auth_checked:!0,username:a?.email??"",set_user_context:e})}))},[n]),t.is_auth_checked?h.jsx(eu.Provider,{value:t,children:h.jsx(hD,{children:h.jsx(SN,{children:h.jsxs(rR,{children:[h.jsxs(MC,{children:[h.jsx(Qt,{path:"/",element:h.jsx(wN,{})}),h.jsx(Qt,{path:"/account",element:h.jsx(i6,{})}),h.jsx(Qt,{path:"/sql-test",element:h.jsx(r6,{})}),h.jsx(Qt,{path:"/budget",element:h.jsx(c4,{}),children:h.jsxs(Qt,{element:h.jsx(u4,{}),children:[h.jsx(Qt,{index:!0,element:h.jsx(Ax,{})}),h.jsx(Qt,{path:":year/:month/:tab",element:h.jsx(Ax,{})}),h.jsx(Qt,{path:"analytics",element:h.jsx(M6,{})}),h.jsx(Qt,{path:"my-budgets",element:h.jsx(l4,{})}),h.jsxs(Qt,{path:"settings",element:h.jsx(G6,{}),children:[h.jsx(Qt,{index:!0,element:h.jsx(Fh,{to:"categories",replace:!0})}),h.jsx(Qt,{path:"accounts",element:h.jsx(z6,{})}),h.jsx(Qt,{path:"categories",element:h.jsx(q6,{})}),h.jsx(Qt,{path:"users",element:h.jsx(H6,{})})]}),h.jsxs(Qt,{path:"admin",element:h.jsx(K6,{}),children:[h.jsx(Qt,{path:"budget",element:h.jsx(Y6,{})}),h.jsx(Qt,{path:"feedback",element:h.jsx(a4,{})}),h.jsx(Qt,{path:"migration",element:h.jsx(s4,{})}),h.jsx(Qt,{path:"tests",element:h.jsx(o4,{})})]})]})})]}),h.jsx(XN,{})]})})})}):h.jsx("div",{style:{maxWidth:"60rem",margin:"0 auto",padding:"2rem"},children:h.jsx("p",{children:"Loading..."})})}MA.createRoot(document.getElementById("root")).render(h.jsx(I.StrictMode,{children:h.jsx(h4,{})}));
