(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var Fp={exports:{}},Fc={};var Nv;function zA(){if(Nv)return Fc;Nv=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var h in a)h!=="key"&&(l[h]=a[h])}else l=a;return a=l.ref,{$$typeof:t,type:i,key:c,ref:a!==void 0?a:null,props:l}}return Fc.Fragment=e,Fc.jsx=n,Fc.jsxs=n,Fc}var Pv;function FA(){return Pv||(Pv=1,Fp.exports=zA()),Fp.exports}var u=FA(),qp={exports:{}},Ue={};var Lv;function qA(){if(Lv)return Ue;Lv=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),v=Symbol.iterator;function E(V){return V===null||typeof V!="object"?null:(V=v&&V[v]||V["@@iterator"],typeof V=="function"?V:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,D={};function N(V,q,Y){this.props=V,this.context=q,this.refs=D,this.updater=Y||C}N.prototype.isReactComponent={},N.prototype.setState=function(V,q){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,q,"setState")},N.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function U(){}U.prototype=N.prototype;function k(V,q,Y){this.props=V,this.context=q,this.refs=D,this.updater=Y||C}var X=k.prototype=new U;X.constructor=k,w(X,N.prototype),X.isPureReactComponent=!0;var G=Array.isArray;function K(){}var O={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function j(V,q,Y){var J=Y.ref;return{$$typeof:t,type:V,key:q,ref:J!==void 0?J:null,props:Y}}function I(V,q){return j(V.type,q,V.props)}function M(V){return typeof V=="object"&&V!==null&&V.$$typeof===t}function H(V){var q={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(Y){return q[Y]})}var P=/\/+/g;function ue(V,q){return typeof V=="object"&&V!==null&&V.key!=null?H(""+V.key):q.toString(36)}function F(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(K,K):(V.status="pending",V.then(function(q){V.status==="pending"&&(V.status="fulfilled",V.value=q)},function(q){V.status==="pending"&&(V.status="rejected",V.reason=q)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function B(V,q,Y,J,ne){var re=typeof V;(re==="undefined"||re==="boolean")&&(V=null);var ge=!1;if(V===null)ge=!0;else switch(re){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(V.$$typeof){case t:case e:ge=!0;break;case _:return ge=V._init,B(ge(V._payload),q,Y,J,ne)}}if(ge)return ne=ne(V),ge=J===""?"."+ue(V,0):J,G(ne)?(Y="",ge!=null&&(Y=ge.replace(P,"$&/")+"/"),B(ne,q,Y,"",function(ie){return ie})):ne!=null&&(M(ne)&&(ne=I(ne,Y+(ne.key==null||V&&V.key===ne.key?"":(""+ne.key).replace(P,"$&/")+"/")+ge)),q.push(ne)),1;ge=0;var Ae=J===""?".":J+":";if(G(V))for(var pe=0;pe<V.length;pe++)J=V[pe],re=Ae+ue(J,pe),ge+=B(J,q,Y,re,ne);else if(pe=E(V),typeof pe=="function")for(V=pe.call(V),pe=0;!(J=V.next()).done;)J=J.value,re=Ae+ue(J,pe++),ge+=B(J,q,Y,re,ne);else if(re==="object"){if(typeof V.then=="function")return B(F(V),q,Y,J,ne);throw q=String(V),Error("Objects are not valid as a React child (found: "+(q==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":q)+"). If you meant to render a collection of children, use an array instead.")}return ge}function $(V,q,Y){if(V==null)return V;var J=[],ne=0;return B(V,J,"","",function(re){return q.call(Y,re,ne++)}),J}function Q(V){if(V._status===-1){var q=V._result;q=q(),q.then(function(Y){(V._status===0||V._status===-1)&&(V._status=1,V._result=Y)},function(Y){(V._status===0||V._status===-1)&&(V._status=2,V._result=Y)}),V._status===-1&&(V._status=0,V._result=q)}if(V._status===1)return V._result.default;throw V._result}var se=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},ee={map:$,forEach:function(V,q,Y){$(V,function(){q.apply(this,arguments)},Y)},count:function(V){var q=0;return $(V,function(){q++}),q},toArray:function(V){return $(V,function(q){return q})||[]},only:function(V){if(!M(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Ue.Activity=b,Ue.Children=ee,Ue.Component=N,Ue.Fragment=n,Ue.Profiler=a,Ue.PureComponent=k,Ue.StrictMode=i,Ue.Suspense=f,Ue.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,Ue.__COMPILER_RUNTIME={__proto__:null,c:function(V){return O.H.useMemoCache(V)}},Ue.cache=function(V){return function(){return V.apply(null,arguments)}},Ue.cacheSignal=function(){return null},Ue.cloneElement=function(V,q,Y){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var J=w({},V.props),ne=V.key;if(q!=null)for(re in q.key!==void 0&&(ne=""+q.key),q)!R.call(q,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&q.ref===void 0||(J[re]=q[re]);var re=arguments.length-2;if(re===1)J.children=Y;else if(1<re){for(var ge=Array(re),Ae=0;Ae<re;Ae++)ge[Ae]=arguments[Ae+2];J.children=ge}return j(V.type,ne,J)},Ue.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:l,_context:V},V},Ue.createElement=function(V,q,Y){var J,ne={},re=null;if(q!=null)for(J in q.key!==void 0&&(re=""+q.key),q)R.call(q,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(ne[J]=q[J]);var ge=arguments.length-2;if(ge===1)ne.children=Y;else if(1<ge){for(var Ae=Array(ge),pe=0;pe<ge;pe++)Ae[pe]=arguments[pe+2];ne.children=Ae}if(V&&V.defaultProps)for(J in ge=V.defaultProps,ge)ne[J]===void 0&&(ne[J]=ge[J]);return j(V,re,ne)},Ue.createRef=function(){return{current:null}},Ue.forwardRef=function(V){return{$$typeof:h,render:V}},Ue.isValidElement=M,Ue.lazy=function(V){return{$$typeof:_,_payload:{_status:-1,_result:V},_init:Q}},Ue.memo=function(V,q){return{$$typeof:p,type:V,compare:q===void 0?null:q}},Ue.startTransition=function(V){var q=O.T,Y={};O.T=Y;try{var J=V(),ne=O.S;ne!==null&&ne(Y,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(K,se)}catch(re){se(re)}finally{q!==null&&Y.types!==null&&(q.types=Y.types),O.T=q}},Ue.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},Ue.use=function(V){return O.H.use(V)},Ue.useActionState=function(V,q,Y){return O.H.useActionState(V,q,Y)},Ue.useCallback=function(V,q){return O.H.useCallback(V,q)},Ue.useContext=function(V){return O.H.useContext(V)},Ue.useDebugValue=function(){},Ue.useDeferredValue=function(V,q){return O.H.useDeferredValue(V,q)},Ue.useEffect=function(V,q){return O.H.useEffect(V,q)},Ue.useEffectEvent=function(V){return O.H.useEffectEvent(V)},Ue.useId=function(){return O.H.useId()},Ue.useImperativeHandle=function(V,q,Y){return O.H.useImperativeHandle(V,q,Y)},Ue.useInsertionEffect=function(V,q){return O.H.useInsertionEffect(V,q)},Ue.useLayoutEffect=function(V,q){return O.H.useLayoutEffect(V,q)},Ue.useMemo=function(V,q){return O.H.useMemo(V,q)},Ue.useOptimistic=function(V,q){return O.H.useOptimistic(V,q)},Ue.useReducer=function(V,q,Y){return O.H.useReducer(V,q,Y)},Ue.useRef=function(V){return O.H.useRef(V)},Ue.useState=function(V){return O.H.useState(V)},Ue.useSyncExternalStore=function(V,q,Y){return O.H.useSyncExternalStore(V,q,Y)},Ue.useTransition=function(){return O.H.useTransition()},Ue.version="19.2.3",Ue}var Bv;function ny(){return Bv||(Bv=1,qp.exports=qA()),qp.exports}var A=ny(),Hp={exports:{}},qc={},Gp={exports:{}},$p={};var Vv;function HA(){return Vv||(Vv=1,(function(t){function e(B,$){var Q=B.length;B.push($);e:for(;0<Q;){var se=Q-1>>>1,ee=B[se];if(0<a(ee,$))B[se]=$,B[Q]=ee,Q=se;else break e}}function n(B){return B.length===0?null:B[0]}function i(B){if(B.length===0)return null;var $=B[0],Q=B.pop();if(Q!==$){B[0]=Q;e:for(var se=0,ee=B.length,V=ee>>>1;se<V;){var q=2*(se+1)-1,Y=B[q],J=q+1,ne=B[J];if(0>a(Y,Q))J<ee&&0>a(ne,Y)?(B[se]=ne,B[J]=Q,se=J):(B[se]=Y,B[q]=Q,se=q);else if(J<ee&&0>a(ne,Q))B[se]=ne,B[J]=Q,se=J;else break e}}return $}function a(B,$){var Q=B.sortIndex-$.sortIndex;return Q!==0?Q:B.id-$.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,h=c.now();t.unstable_now=function(){return c.now()-h}}var f=[],p=[],_=1,b=null,v=3,E=!1,C=!1,w=!1,D=!1,N=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function X(B){for(var $=n(p);$!==null;){if($.callback===null)i(p);else if($.startTime<=B)i(p),$.sortIndex=$.expirationTime,e(f,$);else break;$=n(p)}}function G(B){if(w=!1,X(B),!C)if(n(f)!==null)C=!0,K||(K=!0,H());else{var $=n(p);$!==null&&F(G,$.startTime-B)}}var K=!1,O=-1,R=5,j=-1;function I(){return D?!0:!(t.unstable_now()-j<R)}function M(){if(D=!1,K){var B=t.unstable_now();j=B;var $=!0;try{e:{C=!1,w&&(w=!1,U(O),O=-1),E=!0;var Q=v;try{t:{for(X(B),b=n(f);b!==null&&!(b.expirationTime>B&&I());){var se=b.callback;if(typeof se=="function"){b.callback=null,v=b.priorityLevel;var ee=se(b.expirationTime<=B);if(B=t.unstable_now(),typeof ee=="function"){b.callback=ee,X(B),$=!0;break t}b===n(f)&&i(f),X(B)}else i(f);b=n(f)}if(b!==null)$=!0;else{var V=n(p);V!==null&&F(G,V.startTime-B),$=!1}}break e}finally{b=null,v=Q,E=!1}$=void 0}}finally{$?H():K=!1}}}var H;if(typeof k=="function")H=function(){k(M)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,ue=P.port2;P.port1.onmessage=M,H=function(){ue.postMessage(null)}}else H=function(){N(M,0)};function F(B,$){O=N(function(){B(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(B){switch(v){case 1:case 2:case 3:var $=3;break;default:$=v}var Q=v;v=$;try{return B()}finally{v=Q}},t.unstable_requestPaint=function(){D=!0},t.unstable_runWithPriority=function(B,$){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var Q=v;v=B;try{return $()}finally{v=Q}},t.unstable_scheduleCallback=function(B,$,Q){var se=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?se+Q:se):Q=se,B){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Q+ee,B={id:_++,callback:$,priorityLevel:B,startTime:Q,expirationTime:ee,sortIndex:-1},Q>se?(B.sortIndex=Q,e(p,B),n(f)===null&&B===n(p)&&(w?(U(O),O=-1):w=!0,F(G,Q-se))):(B.sortIndex=ee,e(f,B),C||E||(C=!0,K||(K=!0,H()))),B},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(B){var $=v;return function(){var Q=v;v=$;try{return B.apply(this,arguments)}finally{v=Q}}}})($p)),$p}var Uv;function GA(){return Uv||(Uv=1,Gp.exports=HA()),Gp.exports}var Qp={exports:{}},xn={};var zv;function $A(){if(zv)return xn;zv=1;var t=ny();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(f,p,_){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:f,containerInfo:p,implementation:_}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return xn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,xn.createPortal=function(f,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return l(f,p,null,_)},xn.flushSync=function(f){var p=c.T,_=i.p;try{if(c.T=null,i.p=2,f)return f()}finally{c.T=p,i.p=_,i.d.f()}},xn.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(f,p))},xn.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},xn.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var _=p.as,b=h(_,p.crossOrigin),v=typeof p.integrity=="string"?p.integrity:void 0,E=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;_==="style"?i.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:b,integrity:v,fetchPriority:E}):_==="script"&&i.d.X(f,{crossOrigin:b,integrity:v,fetchPriority:E,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},xn.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var _=h(p.as,p.crossOrigin);i.d.M(f,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(f)},xn.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var _=p.as,b=h(_,p.crossOrigin);i.d.L(f,_,{crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},xn.preloadModule=function(f,p){if(typeof f=="string")if(p){var _=h(p.as,p.crossOrigin);i.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(f)},xn.requestFormReset=function(f){i.d.r(f)},xn.unstable_batchedUpdates=function(f,p){return f(p)},xn.useFormState=function(f,p,_){return c.H.useFormState(f,p,_)},xn.useFormStatus=function(){return c.H.useHostTransitionStatus()},xn.version="19.2.3",xn}var Fv;function QA(){if(Fv)return Qp.exports;Fv=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Qp.exports=$A(),Qp.exports}var qv;function WA(){if(qv)return qc;qv=1;var t=GA(),e=ny(),n=QA();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var s=r,o=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(o=s.return),r=s.return;while(r)}return s.tag===3?o:null}function c(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function h(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function f(r){if(l(r)!==r)throw Error(i(188))}function p(r){var s=r.alternate;if(!s){if(s=l(r),s===null)throw Error(i(188));return s!==r?null:r}for(var o=r,d=s;;){var g=o.return;if(g===null)break;var y=g.alternate;if(y===null){if(d=g.return,d!==null){o=d;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===o)return f(g),r;if(y===d)return f(g),s;y=y.sibling}throw Error(i(188))}if(o.return!==d.return)o=g,d=y;else{for(var S=!1,L=g.child;L;){if(L===o){S=!0,o=g,d=y;break}if(L===d){S=!0,d=g,o=y;break}L=L.sibling}if(!S){for(L=y.child;L;){if(L===o){S=!0,o=y,d=g;break}if(L===d){S=!0,d=y,o=g;break}L=L.sibling}if(!S)throw Error(i(189))}}if(o.alternate!==d)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?r:s}function _(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=_(r),s!==null)return s;r=r.sibling}return null}var b=Object.assign,v=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),k=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function H(r){return r===null||typeof r!="object"?null:(r=M&&r[M]||r["@@iterator"],typeof r=="function"?r:null)}var P=Symbol.for("react.client.reference");function ue(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===P?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case w:return"Fragment";case N:return"Profiler";case D:return"StrictMode";case G:return"Suspense";case K:return"SuspenseList";case j:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case C:return"Portal";case k:return r.displayName||"Context";case U:return(r._context.displayName||"Context")+".Consumer";case X:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case O:return s=r.displayName||null,s!==null?s:ue(r.type)||"Memo";case R:s=r._payload,r=r._init;try{return ue(r(s))}catch{}}return null}var F=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},se=[],ee=-1;function V(r){return{current:r}}function q(r){0>ee||(r.current=se[ee],se[ee]=null,ee--)}function Y(r,s){ee++,se[ee]=r.current,r.current=s}var J=V(null),ne=V(null),re=V(null),ge=V(null);function Ae(r,s){switch(Y(re,s),Y(ne,r),Y(J,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?iv(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=iv(s),r=sv(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}q(J),Y(J,r)}function pe(){q(J),q(ne),q(re)}function ie(r){r.memoizedState!==null&&Y(ge,r);var s=J.current,o=sv(s,r.type);s!==o&&(Y(ne,r),Y(J,o))}function Ce(r){ne.current===r&&(q(J),q(ne)),ge.current===r&&(q(ge),Bc._currentValue=Q)}var Oe,yt;function Se(r){if(Oe===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Oe=s&&s[1]||"",yt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Oe+r+yt}var ke=!1;function Jt(r,s){if(!r||ke)return"";ke=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(s){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(fe){var de=fe}Reflect.construct(r,[],be)}else{try{be.call()}catch(fe){de=fe}r.call(be.prototype)}}else{try{throw Error()}catch(fe){de=fe}(be=r())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(fe){if(fe&&de&&typeof fe.stack=="string")return[fe.stack,de.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),S=y[0],L=y[1];if(S&&L){var W=S.split(`
`),ce=L.split(`
`);for(g=d=0;d<W.length&&!W[d].includes("DetermineComponentFrameRoot");)d++;for(;g<ce.length&&!ce[g].includes("DetermineComponentFrameRoot");)g++;if(d===W.length||g===ce.length)for(d=W.length-1,g=ce.length-1;1<=d&&0<=g&&W[d]!==ce[g];)g--;for(;1<=d&&0<=g;d--,g--)if(W[d]!==ce[g]){if(d!==1||g!==1)do if(d--,g--,0>g||W[d]!==ce[g]){var me=`
`+W[d].replace(" at new "," at ");return r.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",r.displayName)),me}while(1<=d&&0<=g);break}}}finally{ke=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?Se(o):""}function Er(r,s){switch(r.tag){case 26:case 27:case 5:return Se(r.type);case 16:return Se("Lazy");case 13:return r.child!==s&&s!==null?Se("Suspense Fallback"):Se("Suspense");case 19:return Se("SuspenseList");case 0:case 15:return Jt(r.type,!1);case 11:return Jt(r.type.render,!1);case 1:return Jt(r.type,!0);case 31:return Se("Activity");default:return""}}function bi(r){try{var s="",o=null;do s+=Er(r,o),o=r,r=r.return;while(r);return s}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Lt=Object.prototype.hasOwnProperty,Zt=t.unstable_scheduleCallback,Ji=t.unstable_cancelCallback,Hf=t.unstable_shouldYield,Nu=t.unstable_requestPaint,An=t.unstable_now,oa=t.unstable_getCurrentPriorityLevel,zl=t.unstable_ImmediatePriority,Fl=t.unstable_UserBlockingPriority,Zi=t.unstable_NormalPriority,Gf=t.unstable_LowPriority,Pu=t.unstable_IdlePriority,Lu=t.log,Bu=t.unstable_setDisableYieldValue,wr=null,hn=null;function sr(r){if(typeof Lu=="function"&&Bu(r),hn&&typeof hn.setStrictMode=="function")try{hn.setStrictMode(wr,r)}catch{}}var jt=Math.clz32?Math.clz32:Uu,Vu=Math.log,oo=Math.LN2;function Uu(r){return r>>>=0,r===0?32:31-(Vu(r)/oo|0)|0}var zr=256,la=262144,Bt=4194304;function Fr(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function qr(r,s,o){var d=r.pendingLanes;if(d===0)return 0;var g=0,y=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var L=d&134217727;return L!==0?(d=L&~y,d!==0?g=Fr(d):(S&=L,S!==0?g=Fr(S):o||(o=L&~r,o!==0&&(g=Fr(o))))):(L=d&~y,L!==0?g=Fr(L):S!==0?g=Fr(S):o||(o=d&~r,o!==0&&(g=Fr(o)))),g===0?0:s!==0&&s!==g&&(s&y)===0&&(y=g&-g,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:g}function Cr(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function $f(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zu(){var r=Bt;return Bt<<=1,(Bt&62914560)===0&&(Bt=4194304),r}function Hr(r){for(var s=[],o=0;31>o;o++)s.push(r);return s}function ca(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Qf(r,s,o,d,g,y){var S=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var L=r.entanglements,W=r.expirationTimes,ce=r.hiddenUpdates;for(o=S&~o;0<o;){var me=31-jt(o),be=1<<me;L[me]=0,W[me]=-1;var de=ce[me];if(de!==null)for(ce[me]=null,me=0;me<de.length;me++){var fe=de[me];fe!==null&&(fe.lane&=-536870913)}o&=~be}d!==0&&ua(r,d,0),y!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=y&~(S&~s))}function ua(r,s,o){r.pendingLanes|=s,r.suspendedLanes&=~s;var d=31-jt(s);r.entangledLanes|=s,r.entanglements[d]=r.entanglements[d]|1073741824|o&261930}function ql(r,s){var o=r.entangledLanes|=s;for(r=r.entanglements;o;){var d=31-jt(o),g=1<<d;g&s|r[d]&s&&(r[d]|=s),o&=~g}}function Hl(r,s){var o=s&-s;return o=(o&42)!==0?1:da(o),(o&(r.suspendedLanes|s))!==0?0:o}function da(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function vi(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Fu(){var r=$.p;return r!==0?r:(r=window.event,r===void 0?32:Rv(r.type))}function Tr(r,s){var o=$.p;try{return $.p=r,s()}finally{$.p=o}}var Ar=Math.random().toString(36).slice(2),Vt="__reactFiber$"+Ar,an="__reactProps$"+Ar,Gr="__reactContainer$"+Ar,lo="__reactEvents$"+Ar,Wf="__reactListeners$"+Ar,qu="__reactHandles$"+Ar,Hu="__reactResources$"+Ar,$r="__reactMarker$"+Ar;function co(r){delete r[Vt],delete r[an],delete r[lo],delete r[Wf],delete r[qu]}function Qr(r){var s=r[Vt];if(s)return s;for(var o=r.parentNode;o;){if(s=o[Gr]||o[Vt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(r=hv(r);r!==null;){if(o=r[Vt])return o;r=hv(r)}return s}r=o,o=r.parentNode}return null}function ar(r){if(r=r[Vt]||r[Gr]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function Hn(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function Wr(r){var s=r[Hu];return s||(s=r[Hu]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ut(r){r[$r]=!0}var Gl=new Set,$l={};function Kr(r,s){Yr(r,s),Yr(r+"Capture",s)}function Yr(r,s){for($l[r]=s,r=0;r<s.length;r++)Gl.add(s[r])}var Ql=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wl={},Kl={};function Gu(r){return Lt.call(Kl,r)?!0:Lt.call(Wl,r)?!1:Ql.test(r)?Kl[r]=!0:(Wl[r]=!0,!1)}function uo(r,s,o){if(Gu(s))if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var d=s.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+o)}}function Gn(r,s,o){if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+o)}}function zt(r,s,o,d){if(d===null)r.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(s,o,""+d)}}function on(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function es(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Yl(r,s,o){var d=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var g=d.get,y=d.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return g.call(this)},set:function(S){o=""+S,y.call(this,S)}}),Object.defineProperty(r,s,{enumerable:d.enumerable}),{getValue:function(){return o},setValue:function(S){o=""+S},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function lt(r){if(!r._valueTracker){var s=es(r)?"checked":"value";r._valueTracker=Yl(r,s,""+r[s])}}function ha(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var o=s.getValue(),d="";return r&&(d=es(r)?r.checked?"true":"false":r.value),r=d,r!==o?(s.setValue(r),!0):!1}function Xr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var fa=/[\n"\\]/g;function On(r){return r.replace(fa,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function ho(r,s,o,d,g,y,S,L){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),s!=null?S==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+on(s)):r.value!==""+on(s)&&(r.value=""+on(s)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),s!=null?Xl(r,S,on(s)):o!=null?Xl(r,S,on(o)):d!=null&&r.removeAttribute("value"),g==null&&y!=null&&(r.defaultChecked=!!y),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?r.name=""+on(L):r.removeAttribute("name")}function $u(r,s,o,d,g,y,S,L){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){lt(r);return}o=o!=null?""+on(o):"",s=s!=null?""+on(s):o,L||s===r.value||(r.value=s),r.defaultValue=s}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=L?r.checked:!!d,r.defaultChecked=!!d,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S),lt(r)}function Xl(r,s,o){s==="number"&&Xr(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function ts(r,s,o,d){if(r=r.options,s){s={};for(var g=0;g<o.length;g++)s["$"+o[g]]=!0;for(o=0;o<r.length;o++)g=s.hasOwnProperty("$"+r[o].value),r[o].selected!==g&&(r[o].selected=g),g&&d&&(r[o].defaultSelected=!0)}else{for(o=""+on(o),s=null,g=0;g<r.length;g++){if(r[g].value===o){r[g].selected=!0,d&&(r[g].defaultSelected=!0);return}s!==null||r[g].disabled||(s=r[g])}s!==null&&(s.selected=!0)}}function Qu(r,s,o){if(s!=null&&(s=""+on(s),s!==r.value&&(r.value=s),o==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=o!=null?""+on(o):""}function ns(r,s,o,d){if(s==null){if(d!=null){if(o!=null)throw Error(i(92));if(F(d)){if(1<d.length)throw Error(i(93));d=d[0]}o=d}o==null&&(o=""),s=o}o=on(s),r.defaultValue=o,d=r.textContent,d===o&&d!==""&&d!==null&&(r.value=d),lt(r)}function kn(r,s){if(s){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=s;return}}r.textContent=s}var Wu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Jl(r,s,o){var d=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?d?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":d?r.setProperty(s,o):typeof o!="number"||o===0||Wu.has(s)?s==="float"?r.cssFloat=o:r[s]=(""+o).trim():r[s]=o+"px"}function Zl(r,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,o!=null){for(var d in o)!o.hasOwnProperty(d)||s!=null&&s.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var g in s)d=s[g],s.hasOwnProperty(g)&&o[g]!==d&&Jl(r,g,d)}else for(var y in s)s.hasOwnProperty(y)&&Jl(r,y,s[y])}function fo(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ku=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),rs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mo(r){return rs.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Rr(){}var ec=null;function or(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var is=null,Jr=null;function ma(r){var s=ar(r);if(s&&(r=s.stateNode)){var o=r[an]||null;e:switch(r=s.stateNode,s.type){case"input":if(ho(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+On(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var d=o[s];if(d!==r&&d.form===r.form){var g=d[an]||null;if(!g)throw Error(i(90));ho(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<o.length;s++)d=o[s],d.form===r.form&&ha(d)}break e;case"textarea":Qu(r,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&ts(r,!!o.multiple,s,!1)}}}var po=!1;function ss(r,s,o){if(po)return r(s,o);po=!0;try{var d=r(s);return d}finally{if(po=!1,(is!==null||Jr!==null)&&(Fd(),is&&(s=is,r=Jr,Jr=is=null,ma(s),r)))for(s=0;s<r.length;s++)ma(r[s])}}function Dr(r,s){var o=r.stateNode;if(o===null)return null;var d=o[an]||null;if(d===null)return null;o=d[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var lr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pa=!1;if(lr)try{var dt={};Object.defineProperty(dt,"passive",{get:function(){pa=!0}}),window.addEventListener("test",dt,dt),window.removeEventListener("test",dt,dt)}catch{pa=!1}var Zr=null,tc=null,ga=null;function nc(){if(ga)return ga;var r,s=tc,o=s.length,d,g="value"in Zr?Zr.value:Zr.textContent,y=g.length;for(r=0;r<o&&s[r]===g[r];r++);var S=o-r;for(d=1;d<=S&&s[o-d]===g[y-d];d++);return ga=g.slice(r,1<d?1-d:void 0)}function ya(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function xi(){return!0}function jr(){return!1}function fn(r){function s(o,d,g,y,S){this._reactName=o,this._targetInst=g,this.type=d,this.nativeEvent=y,this.target=S,this.currentTarget=null;for(var L in r)r.hasOwnProperty(L)&&(o=r[L],this[L]=o?o(y):y[L]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?xi:jr,this.isPropagationStopped=jr,this}return b(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=xi)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=xi)},persist:function(){},isPersistent:xi}),s}var Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ei=fn(Si),as=b({},Si,{view:0,detail:0}),rc=fn(as),os,go,ti,yo=b({},as,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ls,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ti&&(ti&&r.type==="mousemove"?(os=r.screenX-ti.screenX,go=r.screenY-ti.screenY):go=os=0,ti=r),os)},movementY:function(r){return"movementY"in r?r.movementY:go}}),ic=fn(yo),_a=b({},yo,{dataTransfer:0}),Yu=fn(_a),Xu=b({},as,{relatedTarget:0}),ba=fn(Xu),sc=b({},Si,{animationName:0,elapsedTime:0,pseudoElement:0}),Ju=fn(sc),_o=b({},Si,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Zu=fn(_o),ed=b({},Si,{data:0}),ni=fn(ed),td={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function id(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=rd[r])?!!s[r]:!1}function ls(){return id}var Rn=b({},as,{key:function(r){if(r.key){var s=td[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=ya(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?nd[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ls,charCode:function(r){return r.type==="keypress"?ya(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ya(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),sd=fn(Rn),ad=b({},yo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ei=fn(ad),m=b({},as,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ls}),x=fn(m),T=b({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0}),z=fn(T),ae=b({},yo,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),he=fn(ae),Ee=b({},Si,{newState:0,oldState:0}),Fe=fn(Ee),It=[9,13,27,32],it=lr&&"CompositionEvent"in window,Et=null;lr&&"documentMode"in document&&(Et=document.documentMode);var cr=lr&&"TextEvent"in window&&!Et,ri=lr&&(!it||Et&&8<Et&&11>=Et),Ir=" ",Mr=!1;function va(r,s){switch(r){case"keyup":return It.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bo(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var vo=!1;function dT(r,s){switch(r){case"compositionend":return bo(s);case"keypress":return s.which!==32?null:(Mr=!0,Ir);case"textInput":return r=s.data,r===Ir&&Mr?null:r;default:return null}}function hT(r,s){if(vo)return r==="compositionend"||!it&&va(r,s)?(r=nc(),ga=tc=Zr=null,vo=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ri&&s.locale!=="ko"?null:s.data;default:return null}}var fT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function p_(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!fT[r.type]:s==="textarea"}function g_(r,s,o,d){is?Jr?Jr.push(d):Jr=[d]:is=d,s=Kd(s,"onChange"),0<s.length&&(o=new ei("onChange","change",null,o,d),r.push({event:o,listeners:s}))}var ac=null,oc=null;function mT(r){Jb(r,0)}function od(r){var s=Hn(r);if(ha(s))return r}function y_(r,s){if(r==="change")return s}var __=!1;if(lr){var Kf;if(lr){var Yf="oninput"in document;if(!Yf){var b_=document.createElement("div");b_.setAttribute("oninput","return;"),Yf=typeof b_.oninput=="function"}Kf=Yf}else Kf=!1;__=Kf&&(!document.documentMode||9<document.documentMode)}function v_(){ac&&(ac.detachEvent("onpropertychange",x_),oc=ac=null)}function x_(r){if(r.propertyName==="value"&&od(oc)){var s=[];g_(s,oc,r,or(r)),ss(mT,s)}}function pT(r,s,o){r==="focusin"?(v_(),ac=s,oc=o,ac.attachEvent("onpropertychange",x_)):r==="focusout"&&v_()}function gT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return od(oc)}function yT(r,s){if(r==="click")return od(s)}function _T(r,s){if(r==="input"||r==="change")return od(s)}function bT(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var $n=typeof Object.is=="function"?Object.is:bT;function lc(r,s){if($n(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var o=Object.keys(r),d=Object.keys(s);if(o.length!==d.length)return!1;for(d=0;d<o.length;d++){var g=o[d];if(!Lt.call(s,g)||!$n(r[g],s[g]))return!1}return!0}function S_(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function E_(r,s){var o=S_(r);r=0;for(var d;o;){if(o.nodeType===3){if(d=r+o.textContent.length,r<=s&&d>=s)return{node:o,offset:s-r};r=d}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=S_(o)}}function w_(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?w_(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function C_(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=Xr(r.document);s instanceof r.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)r=s.contentWindow;else break;s=Xr(r.document)}return s}function Xf(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var vT=lr&&"documentMode"in document&&11>=document.documentMode,xo=null,Jf=null,cc=null,Zf=!1;function T_(r,s,o){var d=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Zf||xo==null||xo!==Xr(d)||(d=xo,"selectionStart"in d&&Xf(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),cc&&lc(cc,d)||(cc=d,d=Kd(Jf,"onSelect"),0<d.length&&(s=new ei("onSelect","select",null,s,o),r.push({event:s,listeners:d}),s.target=xo)))}function xa(r,s){var o={};return o[r.toLowerCase()]=s.toLowerCase(),o["Webkit"+r]="webkit"+s,o["Moz"+r]="moz"+s,o}var So={animationend:xa("Animation","AnimationEnd"),animationiteration:xa("Animation","AnimationIteration"),animationstart:xa("Animation","AnimationStart"),transitionrun:xa("Transition","TransitionRun"),transitionstart:xa("Transition","TransitionStart"),transitioncancel:xa("Transition","TransitionCancel"),transitionend:xa("Transition","TransitionEnd")},em={},A_={};lr&&(A_=document.createElement("div").style,"AnimationEvent"in window||(delete So.animationend.animation,delete So.animationiteration.animation,delete So.animationstart.animation),"TransitionEvent"in window||delete So.transitionend.transition);function Sa(r){if(em[r])return em[r];if(!So[r])return r;var s=So[r],o;for(o in s)if(s.hasOwnProperty(o)&&o in A_)return em[r]=s[o];return r}var R_=Sa("animationend"),D_=Sa("animationiteration"),j_=Sa("animationstart"),xT=Sa("transitionrun"),ST=Sa("transitionstart"),ET=Sa("transitioncancel"),I_=Sa("transitionend"),M_=new Map,tm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");tm.push("scrollEnd");function Or(r,s){M_.set(r,s),Kr(s,[r])}var ld=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},ur=[],Eo=0,nm=0;function cd(){for(var r=Eo,s=nm=Eo=0;s<r;){var o=ur[s];ur[s++]=null;var d=ur[s];ur[s++]=null;var g=ur[s];ur[s++]=null;var y=ur[s];if(ur[s++]=null,d!==null&&g!==null){var S=d.pending;S===null?g.next=g:(g.next=S.next,S.next=g),d.pending=g}y!==0&&O_(o,g,y)}}function ud(r,s,o,d){ur[Eo++]=r,ur[Eo++]=s,ur[Eo++]=o,ur[Eo++]=d,nm|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function rm(r,s,o,d){return ud(r,s,o,d),dd(r)}function Ea(r,s){return ud(r,null,null,s),dd(r)}function O_(r,s,o){r.lanes|=o;var d=r.alternate;d!==null&&(d.lanes|=o);for(var g=!1,y=r.return;y!==null;)y.childLanes|=o,d=y.alternate,d!==null&&(d.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(g=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,g&&s!==null&&(g=31-jt(o),r=y.hiddenUpdates,d=r[g],d===null?r[g]=[s]:d.push(s),s.lane=o|536870912),y):null}function dd(r){if(50<Ic)throw Ic=0,hp=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var wo={};function wT(r,s,o,d){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qn(r,s,o,d){return new wT(r,s,o,d)}function im(r){return r=r.prototype,!(!r||!r.isReactComponent)}function wi(r,s){var o=r.alternate;return o===null?(o=Qn(r.tag,s,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=s,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,s=r.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function k_(r,s){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,s=o.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function hd(r,s,o,d,g,y){var S=0;if(d=r,typeof r=="function")im(r)&&(S=1);else if(typeof r=="string")S=DA(r,o,J.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case j:return r=Qn(31,o,s,g),r.elementType=j,r.lanes=y,r;case w:return wa(o.children,g,y,s);case D:S=8,g|=24;break;case N:return r=Qn(12,o,s,g|2),r.elementType=N,r.lanes=y,r;case G:return r=Qn(13,o,s,g),r.elementType=G,r.lanes=y,r;case K:return r=Qn(19,o,s,g),r.elementType=K,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case k:S=10;break e;case U:S=9;break e;case X:S=11;break e;case O:S=14;break e;case R:S=16,d=null;break e}S=29,o=Error(i(130,r===null?"null":typeof r,"")),d=null}return s=Qn(S,o,s,g),s.elementType=r,s.type=d,s.lanes=y,s}function wa(r,s,o,d){return r=Qn(7,r,d,s),r.lanes=o,r}function sm(r,s,o){return r=Qn(6,r,null,s),r.lanes=o,r}function N_(r){var s=Qn(18,null,null,0);return s.stateNode=r,s}function am(r,s,o){return s=Qn(4,r.children!==null?r.children:[],r.key,s),s.lanes=o,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var P_=new WeakMap;function dr(r,s){if(typeof r=="object"&&r!==null){var o=P_.get(r);return o!==void 0?o:(s={value:r,source:s,stack:bi(s)},P_.set(r,s),s)}return{value:r,source:s,stack:bi(s)}}var Co=[],To=0,fd=null,uc=0,hr=[],fr=0,cs=null,ii=1,si="";function Ci(r,s){Co[To++]=uc,Co[To++]=fd,fd=r,uc=s}function L_(r,s,o){hr[fr++]=ii,hr[fr++]=si,hr[fr++]=cs,cs=r;var d=ii;r=si;var g=32-jt(d)-1;d&=~(1<<g),o+=1;var y=32-jt(s)+g;if(30<y){var S=g-g%5;y=(d&(1<<S)-1).toString(32),d>>=S,g-=S,ii=1<<32-jt(s)+g|o<<g|d,si=y+r}else ii=1<<y|o<<g|d,si=r}function om(r){r.return!==null&&(Ci(r,1),L_(r,1,0))}function lm(r){for(;r===fd;)fd=Co[--To],Co[To]=null,uc=Co[--To],Co[To]=null;for(;r===cs;)cs=hr[--fr],hr[fr]=null,si=hr[--fr],hr[fr]=null,ii=hr[--fr],hr[fr]=null}function B_(r,s){hr[fr++]=ii,hr[fr++]=si,hr[fr++]=cs,ii=s.id,si=s.overflow,cs=r}var mn=null,_t=null,et=!1,us=null,mr=!1,cm=Error(i(519));function ds(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw dc(dr(s,r)),cm}function V_(r){var s=r.stateNode,o=r.type,d=r.memoizedProps;switch(s[Vt]=r,s[an]=d,o){case"dialog":We("cancel",s),We("close",s);break;case"iframe":case"object":case"embed":We("load",s);break;case"video":case"audio":for(o=0;o<Oc.length;o++)We(Oc[o],s);break;case"source":We("error",s);break;case"img":case"image":case"link":We("error",s),We("load",s);break;case"details":We("toggle",s);break;case"input":We("invalid",s),$u(s,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":We("invalid",s);break;case"textarea":We("invalid",s),ns(s,d.value,d.defaultValue,d.children)}o=d.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||d.suppressHydrationWarning===!0||nv(s.textContent,o)?(d.popover!=null&&(We("beforetoggle",s),We("toggle",s)),d.onScroll!=null&&We("scroll",s),d.onScrollEnd!=null&&We("scrollend",s),d.onClick!=null&&(s.onclick=Rr),s=!0):s=!1,s||ds(r,!0)}function U_(r){for(mn=r.return;mn;)switch(mn.tag){case 5:case 31:case 13:mr=!1;return;case 27:case 3:mr=!0;return;default:mn=mn.return}}function Ao(r){if(r!==mn)return!1;if(!et)return U_(r),et=!0,!1;var s=r.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||Ap(r.type,r.memoizedProps)),o=!o),o&&_t&&ds(r),U_(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));_t=dv(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));_t=dv(r)}else s===27?(s=_t,Cs(r.type)?(r=Mp,Mp=null,_t=r):_t=s):_t=mn?gr(r.stateNode.nextSibling):null;return!0}function Ca(){_t=mn=null,et=!1}function um(){var r=us;return r!==null&&(Bn===null?Bn=r:Bn.push.apply(Bn,r),us=null),r}function dc(r){us===null?us=[r]:us.push(r)}var dm=V(null),Ta=null,Ti=null;function hs(r,s,o){Y(dm,s._currentValue),s._currentValue=o}function Ai(r){r._currentValue=dm.current,q(dm)}function hm(r,s,o){for(;r!==null;){var d=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,d!==null&&(d.childLanes|=s)):d!==null&&(d.childLanes&s)!==s&&(d.childLanes|=s),r===o)break;r=r.return}}function fm(r,s,o,d){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var y=g.dependencies;if(y!==null){var S=g.child;y=y.firstContext;e:for(;y!==null;){var L=y;y=g;for(var W=0;W<s.length;W++)if(L.context===s[W]){y.lanes|=o,L=y.alternate,L!==null&&(L.lanes|=o),hm(y.return,o,r),d||(S=null);break e}y=L.next}}else if(g.tag===18){if(S=g.return,S===null)throw Error(i(341));S.lanes|=o,y=S.alternate,y!==null&&(y.lanes|=o),hm(S,o,r),S=null}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===r){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}}function Ro(r,s,o,d){r=null;for(var g=s,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var S=g.alternate;if(S===null)throw Error(i(387));if(S=S.memoizedProps,S!==null){var L=g.type;$n(g.pendingProps.value,S.value)||(r!==null?r.push(L):r=[L])}}else if(g===ge.current){if(S=g.alternate,S===null)throw Error(i(387));S.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(Bc):r=[Bc])}g=g.return}r!==null&&fm(s,r,o,d),s.flags|=262144}function md(r){for(r=r.firstContext;r!==null;){if(!$n(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Aa(r){Ta=r,Ti=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function pn(r){return z_(Ta,r)}function pd(r,s){return Ta===null&&Aa(r),z_(r,s)}function z_(r,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Ti===null){if(r===null)throw Error(i(308));Ti=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else Ti=Ti.next=s;return o}var CT=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(o,d){r.push(d)}};this.abort=function(){s.aborted=!0,r.forEach(function(o){return o()})}},TT=t.unstable_scheduleCallback,AT=t.unstable_NormalPriority,Ft={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function mm(){return{controller:new CT,data:new Map,refCount:0}}function hc(r){r.refCount--,r.refCount===0&&TT(AT,function(){r.controller.abort()})}var fc=null,pm=0,Do=0,jo=null;function RT(r,s){if(fc===null){var o=fc=[];pm=0,Do=_p(),jo={status:"pending",value:void 0,then:function(d){o.push(d)}}}return pm++,s.then(F_,F_),s}function F_(){if(--pm===0&&fc!==null){jo!==null&&(jo.status="fulfilled");var r=fc;fc=null,Do=0,jo=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function DT(r,s){var o=[],d={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return r.then(function(){d.status="fulfilled",d.value=s;for(var g=0;g<o.length;g++)(0,o[g])(s)},function(g){for(d.status="rejected",d.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),d}var q_=B.S;B.S=function(r,s){Tb=An(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&RT(r,s),q_!==null&&q_(r,s)};var Ra=V(null);function gm(){var r=Ra.current;return r!==null?r:pt.pooledCache}function gd(r,s){s===null?Y(Ra,Ra.current):Y(Ra,s.pool)}function H_(){var r=gm();return r===null?null:{parent:Ft._currentValue,pool:r}}var Io=Error(i(460)),ym=Error(i(474)),yd=Error(i(542)),_d={then:function(){}};function G_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function $_(r,s,o){switch(o=r[o],o===void 0?r.push(s):o!==s&&(s.then(Rr,Rr),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,W_(r),r;default:if(typeof s.status=="string")s.then(Rr,Rr);else{if(r=pt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(d){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=d}},function(d){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=d}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,W_(r),r}throw ja=s,Io}}function Da(r){try{var s=r._init;return s(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ja=o,Io):o}}var ja=null;function Q_(){if(ja===null)throw Error(i(459));var r=ja;return ja=null,r}function W_(r){if(r===Io||r===yd)throw Error(i(483))}var Mo=null,mc=0;function bd(r){var s=mc;return mc+=1,Mo===null&&(Mo=[]),$_(Mo,r,s)}function pc(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function vd(r,s){throw s.$$typeof===v?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function K_(r){function s(te,Z){if(r){var le=te.deletions;le===null?(te.deletions=[Z],te.flags|=16):le.push(Z)}}function o(te,Z){if(!r)return null;for(;Z!==null;)s(te,Z),Z=Z.sibling;return null}function d(te){for(var Z=new Map;te!==null;)te.key!==null?Z.set(te.key,te):Z.set(te.index,te),te=te.sibling;return Z}function g(te,Z){return te=wi(te,Z),te.index=0,te.sibling=null,te}function y(te,Z,le){return te.index=le,r?(le=te.alternate,le!==null?(le=le.index,le<Z?(te.flags|=67108866,Z):le):(te.flags|=67108866,Z)):(te.flags|=1048576,Z)}function S(te){return r&&te.alternate===null&&(te.flags|=67108866),te}function L(te,Z,le,ye){return Z===null||Z.tag!==6?(Z=sm(le,te.mode,ye),Z.return=te,Z):(Z=g(Z,le),Z.return=te,Z)}function W(te,Z,le,ye){var je=le.type;return je===w?me(te,Z,le.props.children,ye,le.key):Z!==null&&(Z.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===R&&Da(je)===Z.type)?(Z=g(Z,le.props),pc(Z,le),Z.return=te,Z):(Z=hd(le.type,le.key,le.props,null,te.mode,ye),pc(Z,le),Z.return=te,Z)}function ce(te,Z,le,ye){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==le.containerInfo||Z.stateNode.implementation!==le.implementation?(Z=am(le,te.mode,ye),Z.return=te,Z):(Z=g(Z,le.children||[]),Z.return=te,Z)}function me(te,Z,le,ye,je){return Z===null||Z.tag!==7?(Z=wa(le,te.mode,ye,je),Z.return=te,Z):(Z=g(Z,le),Z.return=te,Z)}function be(te,Z,le){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Z=sm(""+Z,te.mode,le),Z.return=te,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case E:return le=hd(Z.type,Z.key,Z.props,null,te.mode,le),pc(le,Z),le.return=te,le;case C:return Z=am(Z,te.mode,le),Z.return=te,Z;case R:return Z=Da(Z),be(te,Z,le)}if(F(Z)||H(Z))return Z=wa(Z,te.mode,le,null),Z.return=te,Z;if(typeof Z.then=="function")return be(te,bd(Z),le);if(Z.$$typeof===k)return be(te,pd(te,Z),le);vd(te,Z)}return null}function de(te,Z,le,ye){var je=Z!==null?Z.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return je!==null?null:L(te,Z,""+le,ye);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case E:return le.key===je?W(te,Z,le,ye):null;case C:return le.key===je?ce(te,Z,le,ye):null;case R:return le=Da(le),de(te,Z,le,ye)}if(F(le)||H(le))return je!==null?null:me(te,Z,le,ye,null);if(typeof le.then=="function")return de(te,Z,bd(le),ye);if(le.$$typeof===k)return de(te,Z,pd(te,le),ye);vd(te,le)}return null}function fe(te,Z,le,ye,je){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return te=te.get(le)||null,L(Z,te,""+ye,je);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case E:return te=te.get(ye.key===null?le:ye.key)||null,W(Z,te,ye,je);case C:return te=te.get(ye.key===null?le:ye.key)||null,ce(Z,te,ye,je);case R:return ye=Da(ye),fe(te,Z,le,ye,je)}if(F(ye)||H(ye))return te=te.get(le)||null,me(Z,te,ye,je,null);if(typeof ye.then=="function")return fe(te,Z,le,bd(ye),je);if(ye.$$typeof===k)return fe(te,Z,le,pd(Z,ye),je);vd(Z,ye)}return null}function Re(te,Z,le,ye){for(var je=null,nt=null,De=Z,Ge=Z=0,Ye=null;De!==null&&Ge<le.length;Ge++){De.index>Ge?(Ye=De,De=null):Ye=De.sibling;var rt=de(te,De,le[Ge],ye);if(rt===null){De===null&&(De=Ye);break}r&&De&&rt.alternate===null&&s(te,De),Z=y(rt,Z,Ge),nt===null?je=rt:nt.sibling=rt,nt=rt,De=Ye}if(Ge===le.length)return o(te,De),et&&Ci(te,Ge),je;if(De===null){for(;Ge<le.length;Ge++)De=be(te,le[Ge],ye),De!==null&&(Z=y(De,Z,Ge),nt===null?je=De:nt.sibling=De,nt=De);return et&&Ci(te,Ge),je}for(De=d(De);Ge<le.length;Ge++)Ye=fe(De,te,Ge,le[Ge],ye),Ye!==null&&(r&&Ye.alternate!==null&&De.delete(Ye.key===null?Ge:Ye.key),Z=y(Ye,Z,Ge),nt===null?je=Ye:nt.sibling=Ye,nt=Ye);return r&&De.forEach(function(js){return s(te,js)}),et&&Ci(te,Ge),je}function Ne(te,Z,le,ye){if(le==null)throw Error(i(151));for(var je=null,nt=null,De=Z,Ge=Z=0,Ye=null,rt=le.next();De!==null&&!rt.done;Ge++,rt=le.next()){De.index>Ge?(Ye=De,De=null):Ye=De.sibling;var js=de(te,De,rt.value,ye);if(js===null){De===null&&(De=Ye);break}r&&De&&js.alternate===null&&s(te,De),Z=y(js,Z,Ge),nt===null?je=js:nt.sibling=js,nt=js,De=Ye}if(rt.done)return o(te,De),et&&Ci(te,Ge),je;if(De===null){for(;!rt.done;Ge++,rt=le.next())rt=be(te,rt.value,ye),rt!==null&&(Z=y(rt,Z,Ge),nt===null?je=rt:nt.sibling=rt,nt=rt);return et&&Ci(te,Ge),je}for(De=d(De);!rt.done;Ge++,rt=le.next())rt=fe(De,te,Ge,rt.value,ye),rt!==null&&(r&&rt.alternate!==null&&De.delete(rt.key===null?Ge:rt.key),Z=y(rt,Z,Ge),nt===null?je=rt:nt.sibling=rt,nt=rt);return r&&De.forEach(function(UA){return s(te,UA)}),et&&Ci(te,Ge),je}function mt(te,Z,le,ye){if(typeof le=="object"&&le!==null&&le.type===w&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case E:e:{for(var je=le.key;Z!==null;){if(Z.key===je){if(je=le.type,je===w){if(Z.tag===7){o(te,Z.sibling),ye=g(Z,le.props.children),ye.return=te,te=ye;break e}}else if(Z.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===R&&Da(je)===Z.type){o(te,Z.sibling),ye=g(Z,le.props),pc(ye,le),ye.return=te,te=ye;break e}o(te,Z);break}else s(te,Z);Z=Z.sibling}le.type===w?(ye=wa(le.props.children,te.mode,ye,le.key),ye.return=te,te=ye):(ye=hd(le.type,le.key,le.props,null,te.mode,ye),pc(ye,le),ye.return=te,te=ye)}return S(te);case C:e:{for(je=le.key;Z!==null;){if(Z.key===je)if(Z.tag===4&&Z.stateNode.containerInfo===le.containerInfo&&Z.stateNode.implementation===le.implementation){o(te,Z.sibling),ye=g(Z,le.children||[]),ye.return=te,te=ye;break e}else{o(te,Z);break}else s(te,Z);Z=Z.sibling}ye=am(le,te.mode,ye),ye.return=te,te=ye}return S(te);case R:return le=Da(le),mt(te,Z,le,ye)}if(F(le))return Re(te,Z,le,ye);if(H(le)){if(je=H(le),typeof je!="function")throw Error(i(150));return le=je.call(le),Ne(te,Z,le,ye)}if(typeof le.then=="function")return mt(te,Z,bd(le),ye);if(le.$$typeof===k)return mt(te,Z,pd(te,le),ye);vd(te,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,Z!==null&&Z.tag===6?(o(te,Z.sibling),ye=g(Z,le),ye.return=te,te=ye):(o(te,Z),ye=sm(le,te.mode,ye),ye.return=te,te=ye),S(te)):o(te,Z)}return function(te,Z,le,ye){try{mc=0;var je=mt(te,Z,le,ye);return Mo=null,je}catch(De){if(De===Io||De===yd)throw De;var nt=Qn(29,De,null,te.mode);return nt.lanes=ye,nt.return=te,nt}}}var Ia=K_(!0),Y_=K_(!1),fs=!1;function _m(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bm(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ms(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ps(r,s,o){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(st&2)!==0){var g=d.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),d.pending=s,s=dd(r),O_(r,null,o),s}return ud(r,d,s,o),dd(r)}function gc(r,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var d=s.lanes;d&=r.pendingLanes,o|=d,s.lanes=o,ql(r,o)}}function vm(r,s){var o=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,o===d)){var g=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var S={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?g=y=S:y=y.next=S,o=o.next}while(o!==null);y===null?g=y=s:y=y.next=s}else g=y=s;o={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=s:r.next=s,o.lastBaseUpdate=s}var xm=!1;function yc(){if(xm){var r=jo;if(r!==null)throw r}}function _c(r,s,o,d){xm=!1;var g=r.updateQueue;fs=!1;var y=g.firstBaseUpdate,S=g.lastBaseUpdate,L=g.shared.pending;if(L!==null){g.shared.pending=null;var W=L,ce=W.next;W.next=null,S===null?y=ce:S.next=ce,S=W;var me=r.alternate;me!==null&&(me=me.updateQueue,L=me.lastBaseUpdate,L!==S&&(L===null?me.firstBaseUpdate=ce:L.next=ce,me.lastBaseUpdate=W))}if(y!==null){var be=g.baseState;S=0,me=ce=W=null,L=y;do{var de=L.lane&-536870913,fe=de!==L.lane;if(fe?(Ke&de)===de:(d&de)===de){de!==0&&de===Do&&(xm=!0),me!==null&&(me=me.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var Re=r,Ne=L;de=s;var mt=o;switch(Ne.tag){case 1:if(Re=Ne.payload,typeof Re=="function"){be=Re.call(mt,be,de);break e}be=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Ne.payload,de=typeof Re=="function"?Re.call(mt,be,de):Re,de==null)break e;be=b({},be,de);break e;case 2:fs=!0}}de=L.callback,de!==null&&(r.flags|=64,fe&&(r.flags|=8192),fe=g.callbacks,fe===null?g.callbacks=[de]:fe.push(de))}else fe={lane:de,tag:L.tag,payload:L.payload,callback:L.callback,next:null},me===null?(ce=me=fe,W=be):me=me.next=fe,S|=de;if(L=L.next,L===null){if(L=g.shared.pending,L===null)break;fe=L,L=fe.next,fe.next=null,g.lastBaseUpdate=fe,g.shared.pending=null}}while(!0);me===null&&(W=be),g.baseState=W,g.firstBaseUpdate=ce,g.lastBaseUpdate=me,y===null&&(g.shared.lanes=0),vs|=S,r.lanes=S,r.memoizedState=be}}function X_(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function J_(r,s){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)X_(o[r],s)}var Oo=V(null),xd=V(0);function Z_(r,s){r=Pi,Y(xd,r),Y(Oo,s),Pi=r|s.baseLanes}function Sm(){Y(xd,Pi),Y(Oo,Oo.current)}function Em(){Pi=xd.current,q(Oo),q(xd)}var Wn=V(null),pr=null;function gs(r){var s=r.alternate;Y(Mt,Mt.current&1),Y(Wn,r),pr===null&&(s===null||Oo.current!==null||s.memoizedState!==null)&&(pr=r)}function wm(r){Y(Mt,Mt.current),Y(Wn,r),pr===null&&(pr=r)}function e0(r){r.tag===22?(Y(Mt,Mt.current),Y(Wn,r),pr===null&&(pr=r)):ys()}function ys(){Y(Mt,Mt.current),Y(Wn,Wn.current)}function Kn(r){q(Wn),pr===r&&(pr=null),q(Mt)}var Mt=V(0);function Sd(r){for(var s=r;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||jp(o)||Ip(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ri=0,qe=null,ht=null,qt=null,Ed=!1,ko=!1,Ma=!1,wd=0,bc=0,No=null,jT=0;function Rt(){throw Error(i(321))}function Cm(r,s){if(s===null)return!1;for(var o=0;o<s.length&&o<r.length;o++)if(!$n(r[o],s[o]))return!1;return!0}function Tm(r,s,o,d,g,y){return Ri=y,qe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,B.H=r===null||r.memoizedState===null?L0:zm,Ma=!1,y=o(d,g),Ma=!1,ko&&(y=n0(s,o,d,g)),t0(r),y}function t0(r){B.H=Sc;var s=ht!==null&&ht.next!==null;if(Ri=0,qt=ht=qe=null,Ed=!1,bc=0,No=null,s)throw Error(i(300));r===null||Ht||(r=r.dependencies,r!==null&&md(r)&&(Ht=!0))}function n0(r,s,o,d){qe=r;var g=0;do{if(ko&&(No=null),bc=0,ko=!1,25<=g)throw Error(i(301));if(g+=1,qt=ht=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}B.H=B0,y=s(o,d)}while(ko);return y}function IT(){var r=B.H,s=r.useState()[0];return s=typeof s.then=="function"?vc(s):s,r=r.useState()[0],(ht!==null?ht.memoizedState:null)!==r&&(qe.flags|=1024),s}function Am(){var r=wd!==0;return wd=0,r}function Rm(r,s,o){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~o}function Dm(r){if(Ed){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ed=!1}Ri=0,qt=ht=qe=null,ko=!1,bc=wd=0,No=null}function Dn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?qe.memoizedState=qt=r:qt=qt.next=r,qt}function Ot(){if(ht===null){var r=qe.alternate;r=r!==null?r.memoizedState:null}else r=ht.next;var s=qt===null?qe.memoizedState:qt.next;if(s!==null)qt=s,ht=r;else{if(r===null)throw qe.alternate===null?Error(i(467)):Error(i(310));ht=r,r={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},qt===null?qe.memoizedState=qt=r:qt=qt.next=r}return qt}function Cd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function vc(r){var s=bc;return bc+=1,No===null&&(No=[]),r=$_(No,r,s),s=qe,(qt===null?s.memoizedState:qt.next)===null&&(s=s.alternate,B.H=s===null||s.memoizedState===null?L0:zm),r}function Td(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return vc(r);if(r.$$typeof===k)return pn(r)}throw Error(i(438,String(r)))}function jm(r){var s=null,o=qe.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var d=qe.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(s={data:d.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Cd(),qe.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(r),d=0;d<r;d++)o[d]=I;return s.index++,o}function Di(r,s){return typeof s=="function"?s(r):s}function Ad(r){var s=Ot();return Im(s,ht,r)}function Im(r,s,o){var d=r.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=o;var g=r.baseQueue,y=d.pending;if(y!==null){if(g!==null){var S=g.next;g.next=y.next,y.next=S}s.baseQueue=g=y,d.pending=null}if(y=r.baseState,g===null)r.memoizedState=y;else{s=g.next;var L=S=null,W=null,ce=s,me=!1;do{var be=ce.lane&-536870913;if(be!==ce.lane?(Ke&be)===be:(Ri&be)===be){var de=ce.revertLane;if(de===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),be===Do&&(me=!0);else if((Ri&de)===de){ce=ce.next,de===Do&&(me=!0);continue}else be={lane:0,revertLane:ce.revertLane,gesture:null,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},W===null?(L=W=be,S=y):W=W.next=be,qe.lanes|=de,vs|=de;be=ce.action,Ma&&o(y,be),y=ce.hasEagerState?ce.eagerState:o(y,be)}else de={lane:be,revertLane:ce.revertLane,gesture:ce.gesture,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null},W===null?(L=W=de,S=y):W=W.next=de,qe.lanes|=be,vs|=be;ce=ce.next}while(ce!==null&&ce!==s);if(W===null?S=y:W.next=L,!$n(y,r.memoizedState)&&(Ht=!0,me&&(o=jo,o!==null)))throw o;r.memoizedState=y,r.baseState=S,r.baseQueue=W,d.lastRenderedState=y}return g===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function Mm(r){var s=Ot(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var d=o.dispatch,g=o.pending,y=s.memoizedState;if(g!==null){o.pending=null;var S=g=g.next;do y=r(y,S.action),S=S.next;while(S!==g);$n(y,s.memoizedState)||(Ht=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,d]}function r0(r,s,o){var d=qe,g=Ot(),y=et;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var S=!$n((ht||g).memoizedState,o);if(S&&(g.memoizedState=o,Ht=!0),g=g.queue,Nm(a0.bind(null,d,g,r),[r]),g.getSnapshot!==s||S||qt!==null&&qt.memoizedState.tag&1){if(d.flags|=2048,Po(9,{destroy:void 0},s0.bind(null,d,g,o,s),null),pt===null)throw Error(i(349));y||(Ri&127)!==0||i0(d,s,o)}return o}function i0(r,s,o){r.flags|=16384,r={getSnapshot:s,value:o},s=qe.updateQueue,s===null?(s=Cd(),qe.updateQueue=s,s.stores=[r]):(o=s.stores,o===null?s.stores=[r]:o.push(r))}function s0(r,s,o,d){s.value=o,s.getSnapshot=d,o0(s)&&l0(r)}function a0(r,s,o){return o(function(){o0(s)&&l0(r)})}function o0(r){var s=r.getSnapshot;r=r.value;try{var o=s();return!$n(r,o)}catch{return!0}}function l0(r){var s=Ea(r,2);s!==null&&Vn(s,r,2)}function Om(r){var s=Dn();if(typeof r=="function"){var o=r;if(r=o(),Ma){sr(!0);try{o()}finally{sr(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Di,lastRenderedState:r},s}function c0(r,s,o,d){return r.baseState=o,Im(r,ht,typeof d=="function"?d:Di)}function MT(r,s,o,d,g){if(jd(r))throw Error(i(485));if(r=s.action,r!==null){var y={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){y.listeners.push(S)}};B.T!==null?o(!0):y.isTransition=!1,d(y),o=s.pending,o===null?(y.next=s.pending=y,u0(s,y)):(y.next=o.next,s.pending=o.next=y)}}function u0(r,s){var o=s.action,d=s.payload,g=r.state;if(s.isTransition){var y=B.T,S={};B.T=S;try{var L=o(g,d),W=B.S;W!==null&&W(S,L),d0(r,s,L)}catch(ce){km(r,s,ce)}finally{y!==null&&S.types!==null&&(y.types=S.types),B.T=y}}else try{y=o(g,d),d0(r,s,y)}catch(ce){km(r,s,ce)}}function d0(r,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(d){h0(r,s,d)},function(d){return km(r,s,d)}):h0(r,s,o)}function h0(r,s,o){s.status="fulfilled",s.value=o,f0(s),r.state=o,s=r.pending,s!==null&&(o=s.next,o===s?r.pending=null:(o=o.next,s.next=o,u0(r,o)))}function km(r,s,o){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do s.status="rejected",s.reason=o,f0(s),s=s.next;while(s!==d)}r.action=null}function f0(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function m0(r,s){return s}function p0(r,s){if(et){var o=pt.formState;if(o!==null){e:{var d=qe;if(et){if(_t){t:{for(var g=_t,y=mr;g.nodeType!==8;){if(!y){g=null;break t}if(g=gr(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){_t=gr(g.nextSibling),d=g.data==="F!";break e}}ds(d)}d=!1}d&&(s=o[0])}}return o=Dn(),o.memoizedState=o.baseState=s,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m0,lastRenderedState:s},o.queue=d,o=k0.bind(null,qe,d),d.dispatch=o,d=Om(!1),y=Um.bind(null,qe,!1,d.queue),d=Dn(),g={state:s,dispatch:null,action:r,pending:null},d.queue=g,o=MT.bind(null,qe,g,y,o),g.dispatch=o,d.memoizedState=r,[s,o,!1]}function g0(r){var s=Ot();return y0(s,ht,r)}function y0(r,s,o){if(s=Im(r,s,m0)[0],r=Ad(Di)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var d=vc(s)}catch(S){throw S===Io?yd:S}else d=s;s=Ot();var g=s.queue,y=g.dispatch;return o!==s.memoizedState&&(qe.flags|=2048,Po(9,{destroy:void 0},OT.bind(null,g,o),null)),[d,y,r]}function OT(r,s){r.action=s}function _0(r){var s=Ot(),o=ht;if(o!==null)return y0(s,o,r);Ot(),s=s.memoizedState,o=Ot();var d=o.queue.dispatch;return o.memoizedState=r,[s,d,!1]}function Po(r,s,o,d){return r={tag:r,create:o,deps:d,inst:s,next:null},s=qe.updateQueue,s===null&&(s=Cd(),qe.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=r.next=r:(d=o.next,o.next=r,r.next=d,s.lastEffect=r),r}function b0(){return Ot().memoizedState}function Rd(r,s,o,d){var g=Dn();qe.flags|=r,g.memoizedState=Po(1|s,{destroy:void 0},o,d===void 0?null:d)}function Dd(r,s,o,d){var g=Ot();d=d===void 0?null:d;var y=g.memoizedState.inst;ht!==null&&d!==null&&Cm(d,ht.memoizedState.deps)?g.memoizedState=Po(s,y,o,d):(qe.flags|=r,g.memoizedState=Po(1|s,y,o,d))}function v0(r,s){Rd(8390656,8,r,s)}function Nm(r,s){Dd(2048,8,r,s)}function kT(r){qe.flags|=4;var s=qe.updateQueue;if(s===null)s=Cd(),qe.updateQueue=s,s.events=[r];else{var o=s.events;o===null?s.events=[r]:o.push(r)}}function x0(r){var s=Ot().memoizedState;return kT({ref:s,nextImpl:r}),function(){if((st&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function S0(r,s){return Dd(4,2,r,s)}function E0(r,s){return Dd(4,4,r,s)}function w0(r,s){if(typeof s=="function"){r=r();var o=s(r);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function C0(r,s,o){o=o!=null?o.concat([r]):null,Dd(4,4,w0.bind(null,s,r),o)}function Pm(){}function T0(r,s){var o=Ot();s=s===void 0?null:s;var d=o.memoizedState;return s!==null&&Cm(s,d[1])?d[0]:(o.memoizedState=[r,s],r)}function A0(r,s){var o=Ot();s=s===void 0?null:s;var d=o.memoizedState;if(s!==null&&Cm(s,d[1]))return d[0];if(d=r(),Ma){sr(!0);try{r()}finally{sr(!1)}}return o.memoizedState=[d,s],d}function Lm(r,s,o){return o===void 0||(Ri&1073741824)!==0&&(Ke&261930)===0?r.memoizedState=s:(r.memoizedState=o,r=Rb(),qe.lanes|=r,vs|=r,o)}function R0(r,s,o,d){return $n(o,s)?o:Oo.current!==null?(r=Lm(r,o,d),$n(r,s)||(Ht=!0),r):(Ri&42)===0||(Ri&1073741824)!==0&&(Ke&261930)===0?(Ht=!0,r.memoizedState=o):(r=Rb(),qe.lanes|=r,vs|=r,s)}function D0(r,s,o,d,g){var y=$.p;$.p=y!==0&&8>y?y:8;var S=B.T,L={};B.T=L,Um(r,!1,s,o);try{var W=g(),ce=B.S;if(ce!==null&&ce(L,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var me=DT(W,d);xc(r,s,me,Jn(r))}else xc(r,s,d,Jn(r))}catch(be){xc(r,s,{then:function(){},status:"rejected",reason:be},Jn())}finally{$.p=y,S!==null&&L.types!==null&&(S.types=L.types),B.T=S}}function NT(){}function Bm(r,s,o,d){if(r.tag!==5)throw Error(i(476));var g=j0(r).queue;D0(r,g,s,Q,o===null?NT:function(){return I0(r),o(d)})}function j0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Di,lastRenderedState:Q},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Di,lastRenderedState:o},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function I0(r){var s=j0(r);s.next===null&&(s=r.alternate.memoizedState),xc(r,s.next.queue,{},Jn())}function Vm(){return pn(Bc)}function M0(){return Ot().memoizedState}function O0(){return Ot().memoizedState}function PT(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var o=Jn();r=ms(o);var d=ps(s,r,o);d!==null&&(Vn(d,s,o),gc(d,s,o)),s={cache:mm()},r.payload=s;return}s=s.return}}function LT(r,s,o){var d=Jn();o={lane:d,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},jd(r)?N0(s,o):(o=rm(r,s,o,d),o!==null&&(Vn(o,r,d),P0(o,s,d)))}function k0(r,s,o){var d=Jn();xc(r,s,o,d)}function xc(r,s,o,d){var g={lane:d,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(jd(r))N0(s,g);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var S=s.lastRenderedState,L=y(S,o);if(g.hasEagerState=!0,g.eagerState=L,$n(L,S))return ud(r,s,g,0),pt===null&&cd(),!1}catch{}if(o=rm(r,s,g,d),o!==null)return Vn(o,r,d),P0(o,s,d),!0}return!1}function Um(r,s,o,d){if(d={lane:2,revertLane:_p(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},jd(r)){if(s)throw Error(i(479))}else s=rm(r,o,d,2),s!==null&&Vn(s,r,2)}function jd(r){var s=r.alternate;return r===qe||s!==null&&s===qe}function N0(r,s){ko=Ed=!0;var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}function P0(r,s,o){if((o&4194048)!==0){var d=s.lanes;d&=r.pendingLanes,o|=d,s.lanes=o,ql(r,o)}}var Sc={readContext:pn,use:Td,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useLayoutEffect:Rt,useInsertionEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useSyncExternalStore:Rt,useId:Rt,useHostTransitionStatus:Rt,useFormState:Rt,useActionState:Rt,useOptimistic:Rt,useMemoCache:Rt,useCacheRefresh:Rt};Sc.useEffectEvent=Rt;var L0={readContext:pn,use:Td,useCallback:function(r,s){return Dn().memoizedState=[r,s===void 0?null:s],r},useContext:pn,useEffect:v0,useImperativeHandle:function(r,s,o){o=o!=null?o.concat([r]):null,Rd(4194308,4,w0.bind(null,s,r),o)},useLayoutEffect:function(r,s){return Rd(4194308,4,r,s)},useInsertionEffect:function(r,s){Rd(4,2,r,s)},useMemo:function(r,s){var o=Dn();s=s===void 0?null:s;var d=r();if(Ma){sr(!0);try{r()}finally{sr(!1)}}return o.memoizedState=[d,s],d},useReducer:function(r,s,o){var d=Dn();if(o!==void 0){var g=o(s);if(Ma){sr(!0);try{o(s)}finally{sr(!1)}}}else g=s;return d.memoizedState=d.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},d.queue=r,r=r.dispatch=LT.bind(null,qe,r),[d.memoizedState,r]},useRef:function(r){var s=Dn();return r={current:r},s.memoizedState=r},useState:function(r){r=Om(r);var s=r.queue,o=k0.bind(null,qe,s);return s.dispatch=o,[r.memoizedState,o]},useDebugValue:Pm,useDeferredValue:function(r,s){var o=Dn();return Lm(o,r,s)},useTransition:function(){var r=Om(!1);return r=D0.bind(null,qe,r.queue,!0,!1),Dn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,o){var d=qe,g=Dn();if(et){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),pt===null)throw Error(i(349));(Ke&127)!==0||i0(d,s,o)}g.memoizedState=o;var y={value:o,getSnapshot:s};return g.queue=y,v0(a0.bind(null,d,y,r),[r]),d.flags|=2048,Po(9,{destroy:void 0},s0.bind(null,d,y,o,s),null),o},useId:function(){var r=Dn(),s=pt.identifierPrefix;if(et){var o=si,d=ii;o=(d&~(1<<32-jt(d)-1)).toString(32)+o,s="_"+s+"R_"+o,o=wd++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=jT++,s="_"+s+"r_"+o.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:Vm,useFormState:p0,useActionState:p0,useOptimistic:function(r){var s=Dn();s.memoizedState=s.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=Um.bind(null,qe,!0,o),o.dispatch=s,[r,s]},useMemoCache:jm,useCacheRefresh:function(){return Dn().memoizedState=PT.bind(null,qe)},useEffectEvent:function(r){var s=Dn(),o={impl:r};return s.memoizedState=o,function(){if((st&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},zm={readContext:pn,use:Td,useCallback:T0,useContext:pn,useEffect:Nm,useImperativeHandle:C0,useInsertionEffect:S0,useLayoutEffect:E0,useMemo:A0,useReducer:Ad,useRef:b0,useState:function(){return Ad(Di)},useDebugValue:Pm,useDeferredValue:function(r,s){var o=Ot();return R0(o,ht.memoizedState,r,s)},useTransition:function(){var r=Ad(Di)[0],s=Ot().memoizedState;return[typeof r=="boolean"?r:vc(r),s]},useSyncExternalStore:r0,useId:M0,useHostTransitionStatus:Vm,useFormState:g0,useActionState:g0,useOptimistic:function(r,s){var o=Ot();return c0(o,ht,r,s)},useMemoCache:jm,useCacheRefresh:O0};zm.useEffectEvent=x0;var B0={readContext:pn,use:Td,useCallback:T0,useContext:pn,useEffect:Nm,useImperativeHandle:C0,useInsertionEffect:S0,useLayoutEffect:E0,useMemo:A0,useReducer:Mm,useRef:b0,useState:function(){return Mm(Di)},useDebugValue:Pm,useDeferredValue:function(r,s){var o=Ot();return ht===null?Lm(o,r,s):R0(o,ht.memoizedState,r,s)},useTransition:function(){var r=Mm(Di)[0],s=Ot().memoizedState;return[typeof r=="boolean"?r:vc(r),s]},useSyncExternalStore:r0,useId:M0,useHostTransitionStatus:Vm,useFormState:_0,useActionState:_0,useOptimistic:function(r,s){var o=Ot();return ht!==null?c0(o,ht,r,s):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:jm,useCacheRefresh:O0};B0.useEffectEvent=x0;function Fm(r,s,o,d){s=r.memoizedState,o=o(d,s),o=o==null?s:b({},s,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var qm={enqueueSetState:function(r,s,o){r=r._reactInternals;var d=Jn(),g=ms(d);g.payload=s,o!=null&&(g.callback=o),s=ps(r,g,d),s!==null&&(Vn(s,r,d),gc(s,r,d))},enqueueReplaceState:function(r,s,o){r=r._reactInternals;var d=Jn(),g=ms(d);g.tag=1,g.payload=s,o!=null&&(g.callback=o),s=ps(r,g,d),s!==null&&(Vn(s,r,d),gc(s,r,d))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var o=Jn(),d=ms(o);d.tag=2,s!=null&&(d.callback=s),s=ps(r,d,o),s!==null&&(Vn(s,r,o),gc(s,r,o))}};function V0(r,s,o,d,g,y,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,y,S):s.prototype&&s.prototype.isPureReactComponent?!lc(o,d)||!lc(g,y):!0}function U0(r,s,o,d){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,d),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,d),s.state!==r&&qm.enqueueReplaceState(s,s.state,null)}function Oa(r,s){var o=s;if("ref"in s){o={};for(var d in s)d!=="ref"&&(o[d]=s[d])}if(r=r.defaultProps){o===s&&(o=b({},o));for(var g in r)o[g]===void 0&&(o[g]=r[g])}return o}function z0(r){ld(r)}function F0(r){console.error(r)}function q0(r){ld(r)}function Id(r,s){try{var o=r.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(d){setTimeout(function(){throw d})}}function H0(r,s,o){try{var d=r.onCaughtError;d(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Hm(r,s,o){return o=ms(o),o.tag=3,o.payload={element:null},o.callback=function(){Id(r,s)},o}function G0(r){return r=ms(r),r.tag=3,r}function $0(r,s,o,d){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var y=d.value;r.payload=function(){return g(y)},r.callback=function(){H0(s,o,d)}}var S=o.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){H0(s,o,d),typeof g!="function"&&(xs===null?xs=new Set([this]):xs.add(this));var L=d.stack;this.componentDidCatch(d.value,{componentStack:L!==null?L:""})})}function BT(r,s,o,d,g){if(o.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(s=o.alternate,s!==null&&Ro(s,o,g,!0),o=Wn.current,o!==null){switch(o.tag){case 31:case 13:return pr===null?qd():o.alternate===null&&Dt===0&&(Dt=3),o.flags&=-257,o.flags|=65536,o.lanes=g,d===_d?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([d]):s.add(d),pp(r,d,g)),!1;case 22:return o.flags|=65536,d===_d?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([d])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([d]):o.add(d)),pp(r,d,g)),!1}throw Error(i(435,o.tag))}return pp(r,d,g),qd(),!1}if(et)return s=Wn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,d!==cm&&(r=Error(i(422),{cause:d}),dc(dr(r,o)))):(d!==cm&&(s=Error(i(423),{cause:d}),dc(dr(s,o))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,d=dr(d,o),g=Hm(r.stateNode,d,g),vm(r,g),Dt!==4&&(Dt=2)),!1;var y=Error(i(520),{cause:d});if(y=dr(y,o),jc===null?jc=[y]:jc.push(y),Dt!==4&&(Dt=2),s===null)return!0;d=dr(d,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,r=g&-g,o.lanes|=r,r=Hm(o.stateNode,d,r),vm(o,r),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(xs===null||!xs.has(y))))return o.flags|=65536,g&=-g,o.lanes|=g,g=G0(g),$0(g,r,o,d),vm(o,g),!1}o=o.return}while(o!==null);return!1}var Gm=Error(i(461)),Ht=!1;function gn(r,s,o,d){s.child=r===null?Y_(s,null,o,d):Ia(s,r.child,o,d)}function Q0(r,s,o,d,g){o=o.render;var y=s.ref;if("ref"in d){var S={};for(var L in d)L!=="ref"&&(S[L]=d[L])}else S=d;return Aa(s),d=Tm(r,s,o,S,y,g),L=Am(),r!==null&&!Ht?(Rm(r,s,g),ji(r,s,g)):(et&&L&&om(s),s.flags|=1,gn(r,s,d,g),s.child)}function W0(r,s,o,d,g){if(r===null){var y=o.type;return typeof y=="function"&&!im(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,K0(r,s,y,d,g)):(r=hd(o.type,null,d,s,s.mode,g),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,!Zm(r,g)){var S=y.memoizedProps;if(o=o.compare,o=o!==null?o:lc,o(S,d)&&r.ref===s.ref)return ji(r,s,g)}return s.flags|=1,r=wi(y,d),r.ref=s.ref,r.return=s,s.child=r}function K0(r,s,o,d,g){if(r!==null){var y=r.memoizedProps;if(lc(y,d)&&r.ref===s.ref)if(Ht=!1,s.pendingProps=d=y,Zm(r,g))(r.flags&131072)!==0&&(Ht=!0);else return s.lanes=r.lanes,ji(r,s,g)}return $m(r,s,o,d,g)}function Y0(r,s,o,d){var g=d.children,y=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(d=s.child=r.child,g=0;d!==null;)g=g|d.lanes|d.childLanes,d=d.sibling;d=g&~y}else d=0,s.child=null;return X0(r,s,y,o,d)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&gd(s,y!==null?y.cachePool:null),y!==null?Z_(s,y):Sm(),e0(s);else return d=s.lanes=536870912,X0(r,s,y!==null?y.baseLanes|o:o,o,d)}else y!==null?(gd(s,y.cachePool),Z_(s,y),ys(),s.memoizedState=null):(r!==null&&gd(s,null),Sm(),ys());return gn(r,s,g,o),s.child}function Ec(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function X0(r,s,o,d,g){var y=gm();return y=y===null?null:{parent:Ft._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},r!==null&&gd(s,null),Sm(),e0(s),r!==null&&Ro(r,s,d,!0),s.childLanes=g,null}function Md(r,s){return s=kd({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function J0(r,s,o){return Ia(s,r.child,null,o),r=Md(s,s.pendingProps),r.flags|=2,Kn(s),s.memoizedState=null,r}function VT(r,s,o){var d=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(et){if(d.mode==="hidden")return r=Md(s,d),s.lanes=536870912,Ec(null,r);if(wm(s),(r=_t)?(r=uv(r,mr),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:cs!==null?{id:ii,overflow:si}:null,retryLane:536870912,hydrationErrors:null},o=N_(r),o.return=s,s.child=o,mn=s,_t=null)):r=null,r===null)throw ds(s);return s.lanes=536870912,null}return Md(s,d)}var y=r.memoizedState;if(y!==null){var S=y.dehydrated;if(wm(s),g)if(s.flags&256)s.flags&=-257,s=J0(r,s,o);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(Ht||Ro(r,s,o,!1),g=(o&r.childLanes)!==0,Ht||g){if(d=pt,d!==null&&(S=Hl(d,o),S!==0&&S!==y.retryLane))throw y.retryLane=S,Ea(r,S),Vn(d,r,S),Gm;qd(),s=J0(r,s,o)}else r=y.treeContext,_t=gr(S.nextSibling),mn=s,et=!0,us=null,mr=!1,r!==null&&B_(s,r),s=Md(s,d),s.flags|=4096;return s}return r=wi(r.child,{mode:d.mode,children:d.children}),r.ref=s.ref,s.child=r,r.return=s,r}function Od(r,s){var o=s.ref;if(o===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(r===null||r.ref!==o)&&(s.flags|=4194816)}}function $m(r,s,o,d,g){return Aa(s),o=Tm(r,s,o,d,void 0,g),d=Am(),r!==null&&!Ht?(Rm(r,s,g),ji(r,s,g)):(et&&d&&om(s),s.flags|=1,gn(r,s,o,g),s.child)}function Z0(r,s,o,d,g,y){return Aa(s),s.updateQueue=null,o=n0(s,d,o,g),t0(r),d=Am(),r!==null&&!Ht?(Rm(r,s,y),ji(r,s,y)):(et&&d&&om(s),s.flags|=1,gn(r,s,o,y),s.child)}function eb(r,s,o,d,g){if(Aa(s),s.stateNode===null){var y=wo,S=o.contextType;typeof S=="object"&&S!==null&&(y=pn(S)),y=new o(d,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=qm,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=d,y.state=s.memoizedState,y.refs={},_m(s),S=o.contextType,y.context=typeof S=="object"&&S!==null?pn(S):wo,y.state=s.memoizedState,S=o.getDerivedStateFromProps,typeof S=="function"&&(Fm(s,o,S,d),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(S=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),S!==y.state&&qm.enqueueReplaceState(y,y.state,null),_c(s,d,y,g),yc(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),d=!0}else if(r===null){y=s.stateNode;var L=s.memoizedProps,W=Oa(o,L);y.props=W;var ce=y.context,me=o.contextType;S=wo,typeof me=="object"&&me!==null&&(S=pn(me));var be=o.getDerivedStateFromProps;me=typeof be=="function"||typeof y.getSnapshotBeforeUpdate=="function",L=s.pendingProps!==L,me||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(L||ce!==S)&&U0(s,y,d,S),fs=!1;var de=s.memoizedState;y.state=de,_c(s,d,y,g),yc(),ce=s.memoizedState,L||de!==ce||fs?(typeof be=="function"&&(Fm(s,o,be,d),ce=s.memoizedState),(W=fs||V0(s,o,W,d,de,ce,S))?(me||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=d,s.memoizedState=ce),y.props=d,y.state=ce,y.context=S,d=W):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),d=!1)}else{y=s.stateNode,bm(r,s),S=s.memoizedProps,me=Oa(o,S),y.props=me,be=s.pendingProps,de=y.context,ce=o.contextType,W=wo,typeof ce=="object"&&ce!==null&&(W=pn(ce)),L=o.getDerivedStateFromProps,(ce=typeof L=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S!==be||de!==W)&&U0(s,y,d,W),fs=!1,de=s.memoizedState,y.state=de,_c(s,d,y,g),yc();var fe=s.memoizedState;S!==be||de!==fe||fs||r!==null&&r.dependencies!==null&&md(r.dependencies)?(typeof L=="function"&&(Fm(s,o,L,d),fe=s.memoizedState),(me=fs||V0(s,o,me,d,de,fe,W)||r!==null&&r.dependencies!==null&&md(r.dependencies))?(ce||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,fe,W),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,fe,W)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||S===r.memoizedProps&&de===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&de===r.memoizedState||(s.flags|=1024),s.memoizedProps=d,s.memoizedState=fe),y.props=d,y.state=fe,y.context=W,d=me):(typeof y.componentDidUpdate!="function"||S===r.memoizedProps&&de===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&de===r.memoizedState||(s.flags|=1024),d=!1)}return y=d,Od(r,s),d=(s.flags&128)!==0,y||d?(y=s.stateNode,o=d&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,r!==null&&d?(s.child=Ia(s,r.child,null,g),s.child=Ia(s,null,o,g)):gn(r,s,o,g),s.memoizedState=y.state,r=s.child):r=ji(r,s,g),r}function tb(r,s,o,d){return Ca(),s.flags|=256,gn(r,s,o,d),s.child}var Qm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Wm(r){return{baseLanes:r,cachePool:H_()}}function Km(r,s,o){return r=r!==null?r.childLanes&~o:0,s&&(r|=Xn),r}function nb(r,s,o){var d=s.pendingProps,g=!1,y=(s.flags&128)!==0,S;if((S=y)||(S=r!==null&&r.memoizedState===null?!1:(Mt.current&2)!==0),S&&(g=!0,s.flags&=-129),S=(s.flags&32)!==0,s.flags&=-33,r===null){if(et){if(g?gs(s):ys(),(r=_t)?(r=uv(r,mr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:cs!==null?{id:ii,overflow:si}:null,retryLane:536870912,hydrationErrors:null},o=N_(r),o.return=s,s.child=o,mn=s,_t=null)):r=null,r===null)throw ds(s);return Ip(r)?s.lanes=32:s.lanes=536870912,null}var L=d.children;return d=d.fallback,g?(ys(),g=s.mode,L=kd({mode:"hidden",children:L},g),d=wa(d,g,o,null),L.return=s,d.return=s,L.sibling=d,s.child=L,d=s.child,d.memoizedState=Wm(o),d.childLanes=Km(r,S,o),s.memoizedState=Qm,Ec(null,d)):(gs(s),Ym(s,L))}var W=r.memoizedState;if(W!==null&&(L=W.dehydrated,L!==null)){if(y)s.flags&256?(gs(s),s.flags&=-257,s=Xm(r,s,o)):s.memoizedState!==null?(ys(),s.child=r.child,s.flags|=128,s=null):(ys(),L=d.fallback,g=s.mode,d=kd({mode:"visible",children:d.children},g),L=wa(L,g,o,null),L.flags|=2,d.return=s,L.return=s,d.sibling=L,s.child=d,Ia(s,r.child,null,o),d=s.child,d.memoizedState=Wm(o),d.childLanes=Km(r,S,o),s.memoizedState=Qm,s=Ec(null,d));else if(gs(s),Ip(L)){if(S=L.nextSibling&&L.nextSibling.dataset,S)var ce=S.dgst;S=ce,d=Error(i(419)),d.stack="",d.digest=S,dc({value:d,source:null,stack:null}),s=Xm(r,s,o)}else if(Ht||Ro(r,s,o,!1),S=(o&r.childLanes)!==0,Ht||S){if(S=pt,S!==null&&(d=Hl(S,o),d!==0&&d!==W.retryLane))throw W.retryLane=d,Ea(r,d),Vn(S,r,d),Gm;jp(L)||qd(),s=Xm(r,s,o)}else jp(L)?(s.flags|=192,s.child=r.child,s=null):(r=W.treeContext,_t=gr(L.nextSibling),mn=s,et=!0,us=null,mr=!1,r!==null&&B_(s,r),s=Ym(s,d.children),s.flags|=4096);return s}return g?(ys(),L=d.fallback,g=s.mode,W=r.child,ce=W.sibling,d=wi(W,{mode:"hidden",children:d.children}),d.subtreeFlags=W.subtreeFlags&65011712,ce!==null?L=wi(ce,L):(L=wa(L,g,o,null),L.flags|=2),L.return=s,d.return=s,d.sibling=L,s.child=d,Ec(null,d),d=s.child,L=r.child.memoizedState,L===null?L=Wm(o):(g=L.cachePool,g!==null?(W=Ft._currentValue,g=g.parent!==W?{parent:W,pool:W}:g):g=H_(),L={baseLanes:L.baseLanes|o,cachePool:g}),d.memoizedState=L,d.childLanes=Km(r,S,o),s.memoizedState=Qm,Ec(r.child,d)):(gs(s),o=r.child,r=o.sibling,o=wi(o,{mode:"visible",children:d.children}),o.return=s,o.sibling=null,r!==null&&(S=s.deletions,S===null?(s.deletions=[r],s.flags|=16):S.push(r)),s.child=o,s.memoizedState=null,o)}function Ym(r,s){return s=kd({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function kd(r,s){return r=Qn(22,r,null,s),r.lanes=0,r}function Xm(r,s,o){return Ia(s,r.child,null,o),r=Ym(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function rb(r,s,o){r.lanes|=s;var d=r.alternate;d!==null&&(d.lanes|=s),hm(r.return,s,o)}function Jm(r,s,o,d,g,y){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:d,tail:o,tailMode:g,treeForkCount:y}:(S.isBackwards=s,S.rendering=null,S.renderingStartTime=0,S.last=d,S.tail=o,S.tailMode=g,S.treeForkCount=y)}function ib(r,s,o){var d=s.pendingProps,g=d.revealOrder,y=d.tail;d=d.children;var S=Mt.current,L=(S&2)!==0;if(L?(S=S&1|2,s.flags|=128):S&=1,Y(Mt,S),gn(r,s,d,o),d=et?uc:0,!L&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&rb(r,o,s);else if(r.tag===19)rb(r,o,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(g){case"forwards":for(o=s.child,g=null;o!==null;)r=o.alternate,r!==null&&Sd(r)===null&&(g=o),o=o.sibling;o=g,o===null?(g=s.child,s.child=null):(g=o.sibling,o.sibling=null),Jm(s,!1,g,o,y,d);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=s.child,s.child=null;g!==null;){if(r=g.alternate,r!==null&&Sd(r)===null){s.child=g;break}r=g.sibling,g.sibling=o,o=g,g=r}Jm(s,!0,o,null,y,d);break;case"together":Jm(s,!1,null,null,void 0,d);break;default:s.memoizedState=null}return s.child}function ji(r,s,o){if(r!==null&&(s.dependencies=r.dependencies),vs|=s.lanes,(o&s.childLanes)===0)if(r!==null){if(Ro(r,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,o=wi(r,r.pendingProps),s.child=o,o.return=s;r.sibling!==null;)r=r.sibling,o=o.sibling=wi(r,r.pendingProps),o.return=s;o.sibling=null}return s.child}function Zm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&md(r)))}function UT(r,s,o){switch(s.tag){case 3:Ae(s,s.stateNode.containerInfo),hs(s,Ft,r.memoizedState.cache),Ca();break;case 27:case 5:ie(s);break;case 4:Ae(s,s.stateNode.containerInfo);break;case 10:hs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,wm(s),null;break;case 13:var d=s.memoizedState;if(d!==null)return d.dehydrated!==null?(gs(s),s.flags|=128,null):(o&s.child.childLanes)!==0?nb(r,s,o):(gs(s),r=ji(r,s,o),r!==null?r.sibling:null);gs(s);break;case 19:var g=(r.flags&128)!==0;if(d=(o&s.childLanes)!==0,d||(Ro(r,s,o,!1),d=(o&s.childLanes)!==0),g){if(d)return ib(r,s,o);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Y(Mt,Mt.current),d)break;return null;case 22:return s.lanes=0,Y0(r,s,o,s.pendingProps);case 24:hs(s,Ft,r.memoizedState.cache)}return ji(r,s,o)}function sb(r,s,o){if(r!==null)if(r.memoizedProps!==s.pendingProps)Ht=!0;else{if(!Zm(r,o)&&(s.flags&128)===0)return Ht=!1,UT(r,s,o);Ht=(r.flags&131072)!==0}else Ht=!1,et&&(s.flags&1048576)!==0&&L_(s,uc,s.index);switch(s.lanes=0,s.tag){case 16:e:{var d=s.pendingProps;if(r=Da(s.elementType),s.type=r,typeof r=="function")im(r)?(d=Oa(r,d),s.tag=1,s=eb(null,s,r,d,o)):(s.tag=0,s=$m(null,s,r,d,o));else{if(r!=null){var g=r.$$typeof;if(g===X){s.tag=11,s=Q0(null,s,r,d,o);break e}else if(g===O){s.tag=14,s=W0(null,s,r,d,o);break e}}throw s=ue(r)||r,Error(i(306,s,""))}}return s;case 0:return $m(r,s,s.type,s.pendingProps,o);case 1:return d=s.type,g=Oa(d,s.pendingProps),eb(r,s,d,g,o);case 3:e:{if(Ae(s,s.stateNode.containerInfo),r===null)throw Error(i(387));d=s.pendingProps;var y=s.memoizedState;g=y.element,bm(r,s),_c(s,d,null,o);var S=s.memoizedState;if(d=S.cache,hs(s,Ft,d),d!==y.cache&&fm(s,[Ft],o,!0),yc(),d=S.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:S.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=tb(r,s,d,o);break e}else if(d!==g){g=dr(Error(i(424)),s),dc(g),s=tb(r,s,d,o);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,_t=gr(r.firstChild),mn=s,et=!0,us=null,mr=!0,o=Y_(s,null,d,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ca(),d===g){s=ji(r,s,o);break e}gn(r,s,d,o)}s=s.child}return s;case 26:return Od(r,s),r===null?(o=gv(s.type,null,s.pendingProps,null))?s.memoizedState=o:et||(o=s.type,r=s.pendingProps,d=Yd(re.current).createElement(o),d[Vt]=s,d[an]=r,yn(d,o,r),Ut(d),s.stateNode=d):s.memoizedState=gv(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return ie(s),r===null&&et&&(d=s.stateNode=fv(s.type,s.pendingProps,re.current),mn=s,mr=!0,g=_t,Cs(s.type)?(Mp=g,_t=gr(d.firstChild)):_t=g),gn(r,s,s.pendingProps.children,o),Od(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&et&&((g=d=_t)&&(d=gA(d,s.type,s.pendingProps,mr),d!==null?(s.stateNode=d,mn=s,_t=gr(d.firstChild),mr=!1,g=!0):g=!1),g||ds(s)),ie(s),g=s.type,y=s.pendingProps,S=r!==null?r.memoizedProps:null,d=y.children,Ap(g,y)?d=null:S!==null&&Ap(g,S)&&(s.flags|=32),s.memoizedState!==null&&(g=Tm(r,s,IT,null,null,o),Bc._currentValue=g),Od(r,s),gn(r,s,d,o),s.child;case 6:return r===null&&et&&((r=o=_t)&&(o=yA(o,s.pendingProps,mr),o!==null?(s.stateNode=o,mn=s,_t=null,r=!0):r=!1),r||ds(s)),null;case 13:return nb(r,s,o);case 4:return Ae(s,s.stateNode.containerInfo),d=s.pendingProps,r===null?s.child=Ia(s,null,d,o):gn(r,s,d,o),s.child;case 11:return Q0(r,s,s.type,s.pendingProps,o);case 7:return gn(r,s,s.pendingProps,o),s.child;case 8:return gn(r,s,s.pendingProps.children,o),s.child;case 12:return gn(r,s,s.pendingProps.children,o),s.child;case 10:return d=s.pendingProps,hs(s,s.type,d.value),gn(r,s,d.children,o),s.child;case 9:return g=s.type._context,d=s.pendingProps.children,Aa(s),g=pn(g),d=d(g),s.flags|=1,gn(r,s,d,o),s.child;case 14:return W0(r,s,s.type,s.pendingProps,o);case 15:return K0(r,s,s.type,s.pendingProps,o);case 19:return ib(r,s,o);case 31:return VT(r,s,o);case 22:return Y0(r,s,o,s.pendingProps);case 24:return Aa(s),d=pn(Ft),r===null?(g=gm(),g===null&&(g=pt,y=mm(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=o),g=y),s.memoizedState={parent:d,cache:g},_m(s),hs(s,Ft,g)):((r.lanes&o)!==0&&(bm(r,s),_c(s,null,null,o),yc()),g=r.memoizedState,y=s.memoizedState,g.parent!==d?(g={parent:d,cache:d},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),hs(s,Ft,d)):(d=y.cache,hs(s,Ft,d),d!==g.cache&&fm(s,[Ft],o,!0))),gn(r,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Ii(r){r.flags|=4}function ep(r,s,o,d,g){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(g&335544128)===g)if(r.stateNode.complete)r.flags|=8192;else if(Mb())r.flags|=8192;else throw ja=_d,ym}else r.flags&=-16777217}function ab(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!xv(s))if(Mb())r.flags|=8192;else throw ja=_d,ym}function Nd(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?zu():536870912,r.lanes|=s,Uo|=s)}function wc(r,s){if(!et)switch(r.tailMode){case"hidden":s=r.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function bt(r){var s=r.alternate!==null&&r.alternate.child===r.child,o=0,d=0;if(s)for(var g=r.child;g!==null;)o|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)o|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=d,r.childLanes=o,s}function zT(r,s,o){var d=s.pendingProps;switch(lm(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(s),null;case 1:return bt(s),null;case 3:return o=s.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),s.memoizedState.cache!==d&&(s.flags|=2048),Ai(Ft),pe(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(Ao(s)?Ii(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,um())),bt(s),null;case 26:var g=s.type,y=s.memoizedState;return r===null?(Ii(s),y!==null?(bt(s),ab(s,y)):(bt(s),ep(s,g,null,d,o))):y?y!==r.memoizedState?(Ii(s),bt(s),ab(s,y)):(bt(s),s.flags&=-16777217):(r=r.memoizedProps,r!==d&&Ii(s),bt(s),ep(s,g,r,d,o)),null;case 27:if(Ce(s),o=re.current,g=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==d&&Ii(s);else{if(!d){if(s.stateNode===null)throw Error(i(166));return bt(s),null}r=J.current,Ao(s)?V_(s):(r=fv(g,d,o),s.stateNode=r,Ii(s))}return bt(s),null;case 5:if(Ce(s),g=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==d&&Ii(s);else{if(!d){if(s.stateNode===null)throw Error(i(166));return bt(s),null}if(y=J.current,Ao(s))V_(s);else{var S=Yd(re.current);switch(y){case 1:y=S.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=S.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=S.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof d.is=="string"?S.createElement("select",{is:d.is}):S.createElement("select"),d.multiple?y.multiple=!0:d.size&&(y.size=d.size);break;default:y=typeof d.is=="string"?S.createElement(g,{is:d.is}):S.createElement(g)}}y[Vt]=s,y[an]=d;e:for(S=s.child;S!==null;){if(S.tag===5||S.tag===6)y.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===s)break e;for(;S.sibling===null;){if(S.return===null||S.return===s)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}s.stateNode=y;e:switch(yn(y,g,d),g){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Ii(s)}}return bt(s),ep(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,o),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==d&&Ii(s);else{if(typeof d!="string"&&s.stateNode===null)throw Error(i(166));if(r=re.current,Ao(s)){if(r=s.stateNode,o=s.memoizedProps,d=null,g=mn,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}r[Vt]=s,r=!!(r.nodeValue===o||d!==null&&d.suppressHydrationWarning===!0||nv(r.nodeValue,o)),r||ds(s,!0)}else r=Yd(r).createTextNode(d),r[Vt]=s,s.stateNode=r}return bt(s),null;case 31:if(o=s.memoizedState,r===null||r.memoizedState!==null){if(d=Ao(s),o!==null){if(r===null){if(!d)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Vt]=s}else Ca(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;bt(s),r=!1}else o=um(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return s.flags&256?(Kn(s),s):(Kn(s),null);if((s.flags&128)!==0)throw Error(i(558))}return bt(s),null;case 13:if(d=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=Ao(s),d!==null&&d.dehydrated!==null){if(r===null){if(!g)throw Error(i(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[Vt]=s}else Ca(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;bt(s),g=!1}else g=um(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(Kn(s),s):(Kn(s),null)}return Kn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=d!==null,r=r!==null&&r.memoizedState!==null,o&&(d=s.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool),y=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==g&&(d.flags|=2048)),o!==r&&o&&(s.child.flags|=8192),Nd(s,s.updateQueue),bt(s),null);case 4:return pe(),r===null&&Sp(s.stateNode.containerInfo),bt(s),null;case 10:return Ai(s.type),bt(s),null;case 19:if(q(Mt),d=s.memoizedState,d===null)return bt(s),null;if(g=(s.flags&128)!==0,y=d.rendering,y===null)if(g)wc(d,!1);else{if(Dt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(y=Sd(r),y!==null){for(s.flags|=128,wc(d,!1),r=y.updateQueue,s.updateQueue=r,Nd(s,r),s.subtreeFlags=0,r=o,o=s.child;o!==null;)k_(o,r),o=o.sibling;return Y(Mt,Mt.current&1|2),et&&Ci(s,d.treeForkCount),s.child}r=r.sibling}d.tail!==null&&An()>Ud&&(s.flags|=128,g=!0,wc(d,!1),s.lanes=4194304)}else{if(!g)if(r=Sd(y),r!==null){if(s.flags|=128,g=!0,r=r.updateQueue,s.updateQueue=r,Nd(s,r),wc(d,!0),d.tail===null&&d.tailMode==="hidden"&&!y.alternate&&!et)return bt(s),null}else 2*An()-d.renderingStartTime>Ud&&o!==536870912&&(s.flags|=128,g=!0,wc(d,!1),s.lanes=4194304);d.isBackwards?(y.sibling=s.child,s.child=y):(r=d.last,r!==null?r.sibling=y:s.child=y,d.last=y)}return d.tail!==null?(r=d.tail,d.rendering=r,d.tail=r.sibling,d.renderingStartTime=An(),r.sibling=null,o=Mt.current,Y(Mt,g?o&1|2:o&1),et&&Ci(s,d.treeForkCount),r):(bt(s),null);case 22:case 23:return Kn(s),Em(),d=s.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(s.flags|=8192):d&&(s.flags|=8192),d?(o&536870912)!==0&&(s.flags&128)===0&&(bt(s),s.subtreeFlags&6&&(s.flags|=8192)):bt(s),o=s.updateQueue,o!==null&&Nd(s,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),d=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(d=s.memoizedState.cachePool.pool),d!==o&&(s.flags|=2048),r!==null&&q(Ra),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Ai(Ft),bt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function FT(r,s){switch(lm(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Ai(Ft),pe(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return Ce(s),null;case 31:if(s.memoizedState!==null){if(Kn(s),s.alternate===null)throw Error(i(340));Ca()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(Kn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));Ca()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return q(Mt),null;case 4:return pe(),null;case 10:return Ai(s.type),null;case 22:case 23:return Kn(s),Em(),r!==null&&q(Ra),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return Ai(Ft),null;case 25:return null;default:return null}}function ob(r,s){switch(lm(s),s.tag){case 3:Ai(Ft),pe();break;case 26:case 27:case 5:Ce(s);break;case 4:pe();break;case 31:s.memoizedState!==null&&Kn(s);break;case 13:Kn(s);break;case 19:q(Mt);break;case 10:Ai(s.type);break;case 22:case 23:Kn(s),Em(),r!==null&&q(Ra);break;case 24:Ai(Ft)}}function Cc(r,s){try{var o=s.updateQueue,d=o!==null?o.lastEffect:null;if(d!==null){var g=d.next;o=g;do{if((o.tag&r)===r){d=void 0;var y=o.create,S=o.inst;d=y(),S.destroy=d}o=o.next}while(o!==g)}}catch(L){ut(s,s.return,L)}}function _s(r,s,o){try{var d=s.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var y=g.next;d=y;do{if((d.tag&r)===r){var S=d.inst,L=S.destroy;if(L!==void 0){S.destroy=void 0,g=s;var W=o,ce=L;try{ce()}catch(me){ut(g,W,me)}}}d=d.next}while(d!==y)}}catch(me){ut(s,s.return,me)}}function lb(r){var s=r.updateQueue;if(s!==null){var o=r.stateNode;try{J_(s,o)}catch(d){ut(r,r.return,d)}}}function cb(r,s,o){o.props=Oa(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(d){ut(r,s,d)}}function Tc(r,s){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof o=="function"?r.refCleanup=o(d):o.current=d}}catch(g){ut(r,s,g)}}function ai(r,s){var o=r.ref,d=r.refCleanup;if(o!==null)if(typeof d=="function")try{d()}catch(g){ut(r,s,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){ut(r,s,g)}else o.current=null}function ub(r){var s=r.type,o=r.memoizedProps,d=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&d.focus();break e;case"img":o.src?d.src=o.src:o.srcSet&&(d.srcset=o.srcSet)}}catch(g){ut(r,r.return,g)}}function tp(r,s,o){try{var d=r.stateNode;uA(d,r.type,o,s),d[an]=s}catch(g){ut(r,r.return,g)}}function db(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Cs(r.type)||r.tag===4}function np(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||db(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Cs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function rp(r,s,o){var d=r.tag;if(d===5||d===6)r=r.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(r),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=Rr));else if(d!==4&&(d===27&&Cs(r.type)&&(o=r.stateNode,s=null),r=r.child,r!==null))for(rp(r,s,o),r=r.sibling;r!==null;)rp(r,s,o),r=r.sibling}function Pd(r,s,o){var d=r.tag;if(d===5||d===6)r=r.stateNode,s?o.insertBefore(r,s):o.appendChild(r);else if(d!==4&&(d===27&&Cs(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(Pd(r,s,o),r=r.sibling;r!==null;)Pd(r,s,o),r=r.sibling}function hb(r){var s=r.stateNode,o=r.memoizedProps;try{for(var d=r.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);yn(s,d,o),s[Vt]=r,s[an]=o}catch(y){ut(r,r.return,y)}}var Mi=!1,Gt=!1,ip=!1,fb=typeof WeakSet=="function"?WeakSet:Set,ln=null;function qT(r,s){if(r=r.containerInfo,Cp=rh,r=C_(r),Xf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var d=o.getSelection&&o.getSelection();if(d&&d.rangeCount!==0){o=d.anchorNode;var g=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var S=0,L=-1,W=-1,ce=0,me=0,be=r,de=null;t:for(;;){for(var fe;be!==o||g!==0&&be.nodeType!==3||(L=S+g),be!==y||d!==0&&be.nodeType!==3||(W=S+d),be.nodeType===3&&(S+=be.nodeValue.length),(fe=be.firstChild)!==null;)de=be,be=fe;for(;;){if(be===r)break t;if(de===o&&++ce===g&&(L=S),de===y&&++me===d&&(W=S),(fe=be.nextSibling)!==null)break;be=de,de=be.parentNode}be=fe}o=L===-1||W===-1?null:{start:L,end:W}}else o=null}o=o||{start:0,end:0}}else o=null;for(Tp={focusedElem:r,selectionRange:o},rh=!1,ln=s;ln!==null;)if(s=ln,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,ln=r;else for(;ln!==null;){switch(s=ln,y=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)g=r[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=s,g=y.memoizedProps,y=y.memoizedState,d=o.stateNode;try{var Re=Oa(o.type,g);r=d.getSnapshotBeforeUpdate(Re,y),d.__reactInternalSnapshotBeforeUpdate=r}catch(Ne){ut(o,o.return,Ne)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,o=r.nodeType,o===9)Dp(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Dp(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,ln=r;break}ln=s.return}}function mb(r,s,o){var d=o.flags;switch(o.tag){case 0:case 11:case 15:ki(r,o),d&4&&Cc(5,o);break;case 1:if(ki(r,o),d&4)if(r=o.stateNode,s===null)try{r.componentDidMount()}catch(S){ut(o,o.return,S)}else{var g=Oa(o.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(g,s,r.__reactInternalSnapshotBeforeUpdate)}catch(S){ut(o,o.return,S)}}d&64&&lb(o),d&512&&Tc(o,o.return);break;case 3:if(ki(r,o),d&64&&(r=o.updateQueue,r!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{J_(r,s)}catch(S){ut(o,o.return,S)}}break;case 27:s===null&&d&4&&hb(o);case 26:case 5:ki(r,o),s===null&&d&4&&ub(o),d&512&&Tc(o,o.return);break;case 12:ki(r,o);break;case 31:ki(r,o),d&4&&yb(r,o);break;case 13:ki(r,o),d&4&&_b(r,o),d&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=JT.bind(null,o),_A(r,o))));break;case 22:if(d=o.memoizedState!==null||Mi,!d){s=s!==null&&s.memoizedState!==null||Gt,g=Mi;var y=Gt;Mi=d,(Gt=s)&&!y?Ni(r,o,(o.subtreeFlags&8772)!==0):ki(r,o),Mi=g,Gt=y}break;case 30:break;default:ki(r,o)}}function pb(r){var s=r.alternate;s!==null&&(r.alternate=null,pb(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&co(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var wt=null,Nn=!1;function Oi(r,s,o){for(o=o.child;o!==null;)gb(r,s,o),o=o.sibling}function gb(r,s,o){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(wr,o)}catch{}switch(o.tag){case 26:Gt||ai(o,s),Oi(r,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Gt||ai(o,s);var d=wt,g=Nn;Cs(o.type)&&(wt=o.stateNode,Nn=!1),Oi(r,s,o),Nc(o.stateNode),wt=d,Nn=g;break;case 5:Gt||ai(o,s);case 6:if(d=wt,g=Nn,wt=null,Oi(r,s,o),wt=d,Nn=g,wt!==null)if(Nn)try{(wt.nodeType===9?wt.body:wt.nodeName==="HTML"?wt.ownerDocument.body:wt).removeChild(o.stateNode)}catch(y){ut(o,s,y)}else try{wt.removeChild(o.stateNode)}catch(y){ut(o,s,y)}break;case 18:wt!==null&&(Nn?(r=wt,lv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),Wo(r)):lv(wt,o.stateNode));break;case 4:d=wt,g=Nn,wt=o.stateNode.containerInfo,Nn=!0,Oi(r,s,o),wt=d,Nn=g;break;case 0:case 11:case 14:case 15:_s(2,o,s),Gt||_s(4,o,s),Oi(r,s,o);break;case 1:Gt||(ai(o,s),d=o.stateNode,typeof d.componentWillUnmount=="function"&&cb(o,s,d)),Oi(r,s,o);break;case 21:Oi(r,s,o);break;case 22:Gt=(d=Gt)||o.memoizedState!==null,Oi(r,s,o),Gt=d;break;default:Oi(r,s,o)}}function yb(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Wo(r)}catch(o){ut(s,s.return,o)}}}function _b(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Wo(r)}catch(o){ut(s,s.return,o)}}function HT(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new fb),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new fb),s;default:throw Error(i(435,r.tag))}}function Ld(r,s){var o=HT(r);s.forEach(function(d){if(!o.has(d)){o.add(d);var g=ZT.bind(null,r,d);d.then(g,g)}})}function Pn(r,s){var o=s.deletions;if(o!==null)for(var d=0;d<o.length;d++){var g=o[d],y=r,S=s,L=S;e:for(;L!==null;){switch(L.tag){case 27:if(Cs(L.type)){wt=L.stateNode,Nn=!1;break e}break;case 5:wt=L.stateNode,Nn=!1;break e;case 3:case 4:wt=L.stateNode.containerInfo,Nn=!0;break e}L=L.return}if(wt===null)throw Error(i(160));gb(y,S,g),wt=null,Nn=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)bb(s,r),s=s.sibling}var kr=null;function bb(r,s){var o=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Pn(s,r),Ln(r),d&4&&(_s(3,r,r.return),Cc(3,r),_s(5,r,r.return));break;case 1:Pn(s,r),Ln(r),d&512&&(Gt||o===null||ai(o,o.return)),d&64&&Mi&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?d:o.concat(d))));break;case 26:var g=kr;if(Pn(s,r),Ln(r),d&512&&(Gt||o===null||ai(o,o.return)),d&4){var y=o!==null?o.memoizedState:null;if(d=r.memoizedState,o===null)if(d===null)if(r.stateNode===null){e:{d=r.type,o=r.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":y=g.getElementsByTagName("title")[0],(!y||y[$r]||y[Vt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(d),g.head.insertBefore(y,g.querySelector("head > title"))),yn(y,d,o),y[Vt]=r,Ut(y),d=y;break e;case"link":var S=bv("link","href",g).get(d+(o.href||""));if(S){for(var L=0;L<S.length;L++)if(y=S[L],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){S.splice(L,1);break t}}y=g.createElement(d),yn(y,d,o),g.head.appendChild(y);break;case"meta":if(S=bv("meta","content",g).get(d+(o.content||""))){for(L=0;L<S.length;L++)if(y=S[L],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){S.splice(L,1);break t}}y=g.createElement(d),yn(y,d,o),g.head.appendChild(y);break;default:throw Error(i(468,d))}y[Vt]=r,Ut(y),d=y}r.stateNode=d}else vv(g,r.type,r.stateNode);else r.stateNode=_v(g,d,r.memoizedProps);else y!==d?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,d===null?vv(g,r.type,r.stateNode):_v(g,d,r.memoizedProps)):d===null&&r.stateNode!==null&&tp(r,r.memoizedProps,o.memoizedProps)}break;case 27:Pn(s,r),Ln(r),d&512&&(Gt||o===null||ai(o,o.return)),o!==null&&d&4&&tp(r,r.memoizedProps,o.memoizedProps);break;case 5:if(Pn(s,r),Ln(r),d&512&&(Gt||o===null||ai(o,o.return)),r.flags&32){g=r.stateNode;try{kn(g,"")}catch(Re){ut(r,r.return,Re)}}d&4&&r.stateNode!=null&&(g=r.memoizedProps,tp(r,g,o!==null?o.memoizedProps:g)),d&1024&&(ip=!0);break;case 6:if(Pn(s,r),Ln(r),d&4){if(r.stateNode===null)throw Error(i(162));d=r.memoizedProps,o=r.stateNode;try{o.nodeValue=d}catch(Re){ut(r,r.return,Re)}}break;case 3:if(Zd=null,g=kr,kr=Xd(s.containerInfo),Pn(s,r),kr=g,Ln(r),d&4&&o!==null&&o.memoizedState.isDehydrated)try{Wo(s.containerInfo)}catch(Re){ut(r,r.return,Re)}ip&&(ip=!1,vb(r));break;case 4:d=kr,kr=Xd(r.stateNode.containerInfo),Pn(s,r),Ln(r),kr=d;break;case 12:Pn(s,r),Ln(r);break;case 31:Pn(s,r),Ln(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Ld(r,d)));break;case 13:Pn(s,r),Ln(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Vd=An()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Ld(r,d)));break;case 22:g=r.memoizedState!==null;var W=o!==null&&o.memoizedState!==null,ce=Mi,me=Gt;if(Mi=ce||g,Gt=me||W,Pn(s,r),Gt=me,Mi=ce,Ln(r),d&8192)e:for(s=r.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(o===null||W||Mi||Gt||ka(r)),o=null,s=r;;){if(s.tag===5||s.tag===26){if(o===null){W=o=s;try{if(y=W.stateNode,g)S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{L=W.stateNode;var be=W.memoizedProps.style,de=be!=null&&be.hasOwnProperty("display")?be.display:null;L.style.display=de==null||typeof de=="boolean"?"":(""+de).trim()}}catch(Re){ut(W,W.return,Re)}}}else if(s.tag===6){if(o===null){W=s;try{W.stateNode.nodeValue=g?"":W.memoizedProps}catch(Re){ut(W,W.return,Re)}}}else if(s.tag===18){if(o===null){W=s;try{var fe=W.stateNode;g?cv(fe,!0):cv(W.stateNode,!1)}catch(Re){ut(W,W.return,Re)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}d&4&&(d=r.updateQueue,d!==null&&(o=d.retryQueue,o!==null&&(d.retryQueue=null,Ld(r,o))));break;case 19:Pn(s,r),Ln(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,Ld(r,d)));break;case 30:break;case 21:break;default:Pn(s,r),Ln(r)}}function Ln(r){var s=r.flags;if(s&2){try{for(var o,d=r.return;d!==null;){if(db(d)){o=d;break}d=d.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var g=o.stateNode,y=np(r);Pd(r,y,g);break;case 5:var S=o.stateNode;o.flags&32&&(kn(S,""),o.flags&=-33);var L=np(r);Pd(r,L,S);break;case 3:case 4:var W=o.stateNode.containerInfo,ce=np(r);rp(r,ce,W);break;default:throw Error(i(161))}}catch(me){ut(r,r.return,me)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function vb(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;vb(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function ki(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)mb(r,s.alternate,s),s=s.sibling}function ka(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:_s(4,s,s.return),ka(s);break;case 1:ai(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&cb(s,s.return,o),ka(s);break;case 27:Nc(s.stateNode);case 26:case 5:ai(s,s.return),ka(s);break;case 22:s.memoizedState===null&&ka(s);break;case 30:ka(s);break;default:ka(s)}r=r.sibling}}function Ni(r,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var d=s.alternate,g=r,y=s,S=y.flags;switch(y.tag){case 0:case 11:case 15:Ni(g,y,o),Cc(4,y);break;case 1:if(Ni(g,y,o),d=y,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ce){ut(d,d.return,ce)}if(d=y,g=d.updateQueue,g!==null){var L=d.stateNode;try{var W=g.shared.hiddenCallbacks;if(W!==null)for(g.shared.hiddenCallbacks=null,g=0;g<W.length;g++)X_(W[g],L)}catch(ce){ut(d,d.return,ce)}}o&&S&64&&lb(y),Tc(y,y.return);break;case 27:hb(y);case 26:case 5:Ni(g,y,o),o&&d===null&&S&4&&ub(y),Tc(y,y.return);break;case 12:Ni(g,y,o);break;case 31:Ni(g,y,o),o&&S&4&&yb(g,y);break;case 13:Ni(g,y,o),o&&S&4&&_b(g,y);break;case 22:y.memoizedState===null&&Ni(g,y,o),Tc(y,y.return);break;case 30:break;default:Ni(g,y,o)}s=s.sibling}}function sp(r,s){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&hc(o))}function ap(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&hc(r))}function Nr(r,s,o,d){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)xb(r,s,o,d),s=s.sibling}function xb(r,s,o,d){var g=s.flags;switch(s.tag){case 0:case 11:case 15:Nr(r,s,o,d),g&2048&&Cc(9,s);break;case 1:Nr(r,s,o,d);break;case 3:Nr(r,s,o,d),g&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&hc(r)));break;case 12:if(g&2048){Nr(r,s,o,d),r=s.stateNode;try{var y=s.memoizedProps,S=y.id,L=y.onPostCommit;typeof L=="function"&&L(S,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(W){ut(s,s.return,W)}}else Nr(r,s,o,d);break;case 31:Nr(r,s,o,d);break;case 13:Nr(r,s,o,d);break;case 23:break;case 22:y=s.stateNode,S=s.alternate,s.memoizedState!==null?y._visibility&2?Nr(r,s,o,d):Ac(r,s):y._visibility&2?Nr(r,s,o,d):(y._visibility|=2,Lo(r,s,o,d,(s.subtreeFlags&10256)!==0||!1)),g&2048&&sp(S,s);break;case 24:Nr(r,s,o,d),g&2048&&ap(s.alternate,s);break;default:Nr(r,s,o,d)}}function Lo(r,s,o,d,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=r,S=s,L=o,W=d,ce=S.flags;switch(S.tag){case 0:case 11:case 15:Lo(y,S,L,W,g),Cc(8,S);break;case 23:break;case 22:var me=S.stateNode;S.memoizedState!==null?me._visibility&2?Lo(y,S,L,W,g):Ac(y,S):(me._visibility|=2,Lo(y,S,L,W,g)),g&&ce&2048&&sp(S.alternate,S);break;case 24:Lo(y,S,L,W,g),g&&ce&2048&&ap(S.alternate,S);break;default:Lo(y,S,L,W,g)}s=s.sibling}}function Ac(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=r,d=s,g=d.flags;switch(d.tag){case 22:Ac(o,d),g&2048&&sp(d.alternate,d);break;case 24:Ac(o,d),g&2048&&ap(d.alternate,d);break;default:Ac(o,d)}s=s.sibling}}var Rc=8192;function Bo(r,s,o){if(r.subtreeFlags&Rc)for(r=r.child;r!==null;)Sb(r,s,o),r=r.sibling}function Sb(r,s,o){switch(r.tag){case 26:Bo(r,s,o),r.flags&Rc&&r.memoizedState!==null&&jA(o,kr,r.memoizedState,r.memoizedProps);break;case 5:Bo(r,s,o);break;case 3:case 4:var d=kr;kr=Xd(r.stateNode.containerInfo),Bo(r,s,o),kr=d;break;case 22:r.memoizedState===null&&(d=r.alternate,d!==null&&d.memoizedState!==null?(d=Rc,Rc=16777216,Bo(r,s,o),Rc=d):Bo(r,s,o));break;default:Bo(r,s,o)}}function Eb(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function Dc(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var d=s[o];ln=d,Cb(d,r)}Eb(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)wb(r),r=r.sibling}function wb(r){switch(r.tag){case 0:case 11:case 15:Dc(r),r.flags&2048&&_s(9,r,r.return);break;case 3:Dc(r);break;case 12:Dc(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,Bd(r)):Dc(r);break;default:Dc(r)}}function Bd(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var d=s[o];ln=d,Cb(d,r)}Eb(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:_s(8,s,s.return),Bd(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,Bd(s));break;default:Bd(s)}r=r.sibling}}function Cb(r,s){for(;ln!==null;){var o=ln;switch(o.tag){case 0:case 11:case 15:_s(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var d=o.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:hc(o.memoizedState.cache)}if(d=o.child,d!==null)d.return=o,ln=d;else e:for(o=r;ln!==null;){d=ln;var g=d.sibling,y=d.return;if(pb(d),d===o){ln=null;break e}if(g!==null){g.return=y,ln=g;break e}ln=y}}}var GT={getCacheForType:function(r){var s=pn(Ft),o=s.data.get(r);return o===void 0&&(o=r(),s.data.set(r,o)),o},cacheSignal:function(){return pn(Ft).controller.signal}},$T=typeof WeakMap=="function"?WeakMap:Map,st=0,pt=null,Qe=null,Ke=0,ct=0,Yn=null,bs=!1,Vo=!1,op=!1,Pi=0,Dt=0,vs=0,Na=0,lp=0,Xn=0,Uo=0,jc=null,Bn=null,cp=!1,Vd=0,Tb=0,Ud=1/0,zd=null,xs=null,en=0,Ss=null,zo=null,Li=0,up=0,dp=null,Ab=null,Ic=0,hp=null;function Jn(){return(st&2)!==0&&Ke!==0?Ke&-Ke:B.T!==null?_p():Fu()}function Rb(){if(Xn===0)if((Ke&536870912)===0||et){var r=la;la<<=1,(la&3932160)===0&&(la=262144),Xn=r}else Xn=536870912;return r=Wn.current,r!==null&&(r.flags|=32),Xn}function Vn(r,s,o){(r===pt&&(ct===2||ct===9)||r.cancelPendingCommit!==null)&&(Fo(r,0),Es(r,Ke,Xn,!1)),ca(r,o),((st&2)===0||r!==pt)&&(r===pt&&((st&2)===0&&(Na|=o),Dt===4&&Es(r,Ke,Xn,!1)),oi(r))}function Db(r,s,o){if((st&6)!==0)throw Error(i(327));var d=!o&&(s&127)===0&&(s&r.expiredLanes)===0||Cr(r,s),g=d?KT(r,s):mp(r,s,!0),y=d;do{if(g===0){Vo&&!d&&Es(r,s,0,!1);break}else{if(o=r.current.alternate,y&&!QT(o)){g=mp(r,s,!1),y=!1;continue}if(g===2){if(y=s,r.errorRecoveryDisabledLanes&y)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){s=S;e:{var L=r;g=jc;var W=L.current.memoizedState.isDehydrated;if(W&&(Fo(L,S).flags|=256),S=mp(L,S,!1),S!==2){if(op&&!W){L.errorRecoveryDisabledLanes|=y,Na|=y,g=4;break e}y=Bn,Bn=g,y!==null&&(Bn===null?Bn=y:Bn.push.apply(Bn,y))}g=S}if(y=!1,g!==2)continue}}if(g===1){Fo(r,0),Es(r,s,0,!0);break}e:{switch(d=r,y=g,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Es(d,s,Xn,!bs);break e;case 2:Bn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(g=Vd+300-An(),10<g)){if(Es(d,s,Xn,!bs),qr(d,0,!0)!==0)break e;Li=s,d.timeoutHandle=av(jb.bind(null,d,o,Bn,zd,cp,s,Xn,Na,Uo,bs,y,"Throttled",-0,0),g);break e}jb(d,o,Bn,zd,cp,s,Xn,Na,Uo,bs,y,null,-0,0)}}break}while(!0);oi(r)}function jb(r,s,o,d,g,y,S,L,W,ce,me,be,de,fe){if(r.timeoutHandle=-1,be=s.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Rr},Sb(s,y,be);var Re=(y&62914560)===y?Vd-An():(y&4194048)===y?Tb-An():0;if(Re=IA(be,Re),Re!==null){Li=y,r.cancelPendingCommit=Re(Bb.bind(null,r,s,y,o,d,g,S,L,W,me,be,null,de,fe)),Es(r,y,S,!ce);return}}Bb(r,s,y,o,d,g,S,L,W)}function QT(r){for(var s=r;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var d=0;d<o.length;d++){var g=o[d],y=g.getSnapshot;g=g.value;try{if(!$n(y(),g))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Es(r,s,o,d){s&=~lp,s&=~Na,r.suspendedLanes|=s,r.pingedLanes&=~s,d&&(r.warmLanes|=s),d=r.expirationTimes;for(var g=s;0<g;){var y=31-jt(g),S=1<<y;d[y]=-1,g&=~S}o!==0&&ua(r,o,s)}function Fd(){return(st&6)===0?(Mc(0),!1):!0}function fp(){if(Qe!==null){if(ct===0)var r=Qe.return;else r=Qe,Ti=Ta=null,Dm(r),Mo=null,mc=0,r=Qe;for(;r!==null;)ob(r.alternate,r),r=r.return;Qe=null}}function Fo(r,s){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,fA(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),Li=0,fp(),pt=r,Qe=o=wi(r.current,null),Ke=s,ct=0,Yn=null,bs=!1,Vo=Cr(r,s),op=!1,Uo=Xn=lp=Na=vs=Dt=0,Bn=jc=null,cp=!1,(s&8)!==0&&(s|=s&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=s;0<d;){var g=31-jt(d),y=1<<g;s|=r[g],d&=~y}return Pi=s,cd(),o}function Ib(r,s){qe=null,B.H=Sc,s===Io||s===yd?(s=Q_(),ct=3):s===ym?(s=Q_(),ct=4):ct=s===Gm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Yn=s,Qe===null&&(Dt=1,Id(r,dr(s,r.current)))}function Mb(){var r=Wn.current;return r===null?!0:(Ke&4194048)===Ke?pr===null:(Ke&62914560)===Ke||(Ke&536870912)!==0?r===pr:!1}function Ob(){var r=B.H;return B.H=Sc,r===null?Sc:r}function kb(){var r=B.A;return B.A=GT,r}function qd(){Dt=4,bs||(Ke&4194048)!==Ke&&Wn.current!==null||(Vo=!0),(vs&134217727)===0&&(Na&134217727)===0||pt===null||Es(pt,Ke,Xn,!1)}function mp(r,s,o){var d=st;st|=2;var g=Ob(),y=kb();(pt!==r||Ke!==s)&&(zd=null,Fo(r,s)),s=!1;var S=Dt;e:do try{if(ct!==0&&Qe!==null){var L=Qe,W=Yn;switch(ct){case 8:fp(),S=6;break e;case 3:case 2:case 9:case 6:Wn.current===null&&(s=!0);var ce=ct;if(ct=0,Yn=null,qo(r,L,W,ce),o&&Vo){S=0;break e}break;default:ce=ct,ct=0,Yn=null,qo(r,L,W,ce)}}WT(),S=Dt;break}catch(me){Ib(r,me)}while(!0);return s&&r.shellSuspendCounter++,Ti=Ta=null,st=d,B.H=g,B.A=y,Qe===null&&(pt=null,Ke=0,cd()),S}function WT(){for(;Qe!==null;)Nb(Qe)}function KT(r,s){var o=st;st|=2;var d=Ob(),g=kb();pt!==r||Ke!==s?(zd=null,Ud=An()+500,Fo(r,s)):Vo=Cr(r,s);e:do try{if(ct!==0&&Qe!==null){s=Qe;var y=Yn;t:switch(ct){case 1:ct=0,Yn=null,qo(r,s,y,1);break;case 2:case 9:if(G_(y)){ct=0,Yn=null,Pb(s);break}s=function(){ct!==2&&ct!==9||pt!==r||(ct=7),oi(r)},y.then(s,s);break e;case 3:ct=7;break e;case 4:ct=5;break e;case 7:G_(y)?(ct=0,Yn=null,Pb(s)):(ct=0,Yn=null,qo(r,s,y,7));break;case 5:var S=null;switch(Qe.tag){case 26:S=Qe.memoizedState;case 5:case 27:var L=Qe;if(S?xv(S):L.stateNode.complete){ct=0,Yn=null;var W=L.sibling;if(W!==null)Qe=W;else{var ce=L.return;ce!==null?(Qe=ce,Hd(ce)):Qe=null}break t}}ct=0,Yn=null,qo(r,s,y,5);break;case 6:ct=0,Yn=null,qo(r,s,y,6);break;case 8:fp(),Dt=6;break e;default:throw Error(i(462))}}YT();break}catch(me){Ib(r,me)}while(!0);return Ti=Ta=null,B.H=d,B.A=g,st=o,Qe!==null?0:(pt=null,Ke=0,cd(),Dt)}function YT(){for(;Qe!==null&&!Hf();)Nb(Qe)}function Nb(r){var s=sb(r.alternate,r,Pi);r.memoizedProps=r.pendingProps,s===null?Hd(r):Qe=s}function Pb(r){var s=r,o=s.alternate;switch(s.tag){case 15:case 0:s=Z0(o,s,s.pendingProps,s.type,void 0,Ke);break;case 11:s=Z0(o,s,s.pendingProps,s.type.render,s.ref,Ke);break;case 5:Dm(s);default:ob(o,s),s=Qe=k_(s,Pi),s=sb(o,s,Pi)}r.memoizedProps=r.pendingProps,s===null?Hd(r):Qe=s}function qo(r,s,o,d){Ti=Ta=null,Dm(s),Mo=null,mc=0;var g=s.return;try{if(BT(r,g,s,o,Ke)){Dt=1,Id(r,dr(o,r.current)),Qe=null;return}}catch(y){if(g!==null)throw Qe=g,y;Dt=1,Id(r,dr(o,r.current)),Qe=null;return}s.flags&32768?(et||d===1?r=!0:Vo||(Ke&536870912)!==0?r=!1:(bs=r=!0,(d===2||d===9||d===3||d===6)&&(d=Wn.current,d!==null&&d.tag===13&&(d.flags|=16384))),Lb(s,r)):Hd(s)}function Hd(r){var s=r;do{if((s.flags&32768)!==0){Lb(s,bs);return}r=s.return;var o=zT(s.alternate,s,Pi);if(o!==null){Qe=o;return}if(s=s.sibling,s!==null){Qe=s;return}Qe=s=r}while(s!==null);Dt===0&&(Dt=5)}function Lb(r,s){do{var o=FT(r.alternate,r);if(o!==null){o.flags&=32767,Qe=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(r=r.sibling,r!==null)){Qe=r;return}Qe=r=o}while(r!==null);Dt=6,Qe=null}function Bb(r,s,o,d,g,y,S,L,W){r.cancelPendingCommit=null;do Gd();while(en!==0);if((st&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=nm,Qf(r,o,y,S,L,W),r===pt&&(Qe=pt=null,Ke=0),zo=s,Ss=r,Li=o,up=y,dp=g,Ab=d,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,eA(Zi,function(){return qb(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||d){d=B.T,B.T=null,g=$.p,$.p=2,S=st,st|=4;try{qT(r,s,o)}finally{st=S,$.p=g,B.T=d}}en=1,Vb(),Ub(),zb()}}function Vb(){if(en===1){en=0;var r=Ss,s=zo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=B.T,B.T=null;var d=$.p;$.p=2;var g=st;st|=4;try{bb(s,r);var y=Tp,S=C_(r.containerInfo),L=y.focusedElem,W=y.selectionRange;if(S!==L&&L&&L.ownerDocument&&w_(L.ownerDocument.documentElement,L)){if(W!==null&&Xf(L)){var ce=W.start,me=W.end;if(me===void 0&&(me=ce),"selectionStart"in L)L.selectionStart=ce,L.selectionEnd=Math.min(me,L.value.length);else{var be=L.ownerDocument||document,de=be&&be.defaultView||window;if(de.getSelection){var fe=de.getSelection(),Re=L.textContent.length,Ne=Math.min(W.start,Re),mt=W.end===void 0?Ne:Math.min(W.end,Re);!fe.extend&&Ne>mt&&(S=mt,mt=Ne,Ne=S);var te=E_(L,Ne),Z=E_(L,mt);if(te&&Z&&(fe.rangeCount!==1||fe.anchorNode!==te.node||fe.anchorOffset!==te.offset||fe.focusNode!==Z.node||fe.focusOffset!==Z.offset)){var le=be.createRange();le.setStart(te.node,te.offset),fe.removeAllRanges(),Ne>mt?(fe.addRange(le),fe.extend(Z.node,Z.offset)):(le.setEnd(Z.node,Z.offset),fe.addRange(le))}}}}for(be=[],fe=L;fe=fe.parentNode;)fe.nodeType===1&&be.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<be.length;L++){var ye=be[L];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}rh=!!Cp,Tp=Cp=null}finally{st=g,$.p=d,B.T=o}}r.current=s,en=2}}function Ub(){if(en===2){en=0;var r=Ss,s=zo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=B.T,B.T=null;var d=$.p;$.p=2;var g=st;st|=4;try{mb(r,s.alternate,s)}finally{st=g,$.p=d,B.T=o}}en=3}}function zb(){if(en===4||en===3){en=0,Nu();var r=Ss,s=zo,o=Li,d=Ab;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?en=5:(en=0,zo=Ss=null,Fb(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(xs=null),vi(o),s=s.stateNode,hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(wr,s,void 0,(s.current.flags&128)===128)}catch{}if(d!==null){s=B.T,g=$.p,$.p=2,B.T=null;try{for(var y=r.onRecoverableError,S=0;S<d.length;S++){var L=d[S];y(L.value,{componentStack:L.stack})}}finally{B.T=s,$.p=g}}(Li&3)!==0&&Gd(),oi(r),g=r.pendingLanes,(o&261930)!==0&&(g&42)!==0?r===hp?Ic++:(Ic=0,hp=r):Ic=0,Mc(0)}}function Fb(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,hc(s)))}function Gd(){return Vb(),Ub(),zb(),qb()}function qb(){if(en!==5)return!1;var r=Ss,s=up;up=0;var o=vi(Li),d=B.T,g=$.p;try{$.p=32>o?32:o,B.T=null,o=dp,dp=null;var y=Ss,S=Li;if(en=0,zo=Ss=null,Li=0,(st&6)!==0)throw Error(i(331));var L=st;if(st|=4,wb(y.current),xb(y,y.current,S,o),st=L,Mc(0,!1),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(wr,y)}catch{}return!0}finally{$.p=g,B.T=d,Fb(r,s)}}function Hb(r,s,o){s=dr(o,s),s=Hm(r.stateNode,s,2),r=ps(r,s,2),r!==null&&(ca(r,2),oi(r))}function ut(r,s,o){if(r.tag===3)Hb(r,r,o);else for(;s!==null;){if(s.tag===3){Hb(s,r,o);break}else if(s.tag===1){var d=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(xs===null||!xs.has(d))){r=dr(o,r),o=G0(2),d=ps(s,o,2),d!==null&&($0(o,d,s,r),ca(d,2),oi(d));break}}s=s.return}}function pp(r,s,o){var d=r.pingCache;if(d===null){d=r.pingCache=new $T;var g=new Set;d.set(s,g)}else g=d.get(s),g===void 0&&(g=new Set,d.set(s,g));g.has(o)||(op=!0,g.add(o),r=XT.bind(null,r,s,o),s.then(r,r))}function XT(r,s,o){var d=r.pingCache;d!==null&&d.delete(s),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,pt===r&&(Ke&o)===o&&(Dt===4||Dt===3&&(Ke&62914560)===Ke&&300>An()-Vd?(st&2)===0&&Fo(r,0):lp|=o,Uo===Ke&&(Uo=0)),oi(r)}function Gb(r,s){s===0&&(s=zu()),r=Ea(r,s),r!==null&&(ca(r,s),oi(r))}function JT(r){var s=r.memoizedState,o=0;s!==null&&(o=s.retryLane),Gb(r,o)}function ZT(r,s){var o=0;switch(r.tag){case 31:case 13:var d=r.stateNode,g=r.memoizedState;g!==null&&(o=g.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(s),Gb(r,o)}function eA(r,s){return Zt(r,s)}var $d=null,Ho=null,gp=!1,Qd=!1,yp=!1,ws=0;function oi(r){r!==Ho&&r.next===null&&(Ho===null?$d=Ho=r:Ho=Ho.next=r),Qd=!0,gp||(gp=!0,nA())}function Mc(r,s){if(!yp&&Qd){yp=!0;do for(var o=!1,d=$d;d!==null;){if(r!==0){var g=d.pendingLanes;if(g===0)var y=0;else{var S=d.suspendedLanes,L=d.pingedLanes;y=(1<<31-jt(42|r)+1)-1,y&=g&~(S&~L),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,Kb(d,y))}else y=Ke,y=qr(d,d===pt?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||Cr(d,y)||(o=!0,Kb(d,y));d=d.next}while(o);yp=!1}}function tA(){$b()}function $b(){Qd=gp=!1;var r=0;ws!==0&&hA()&&(r=ws);for(var s=An(),o=null,d=$d;d!==null;){var g=d.next,y=Qb(d,s);y===0?(d.next=null,o===null?$d=g:o.next=g,g===null&&(Ho=o)):(o=d,(r!==0||(y&3)!==0)&&(Qd=!0)),d=g}en!==0&&en!==5||Mc(r),ws!==0&&(ws=0)}function Qb(r,s){for(var o=r.suspendedLanes,d=r.pingedLanes,g=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var S=31-jt(y),L=1<<S,W=g[S];W===-1?((L&o)===0||(L&d)!==0)&&(g[S]=$f(L,s)):W<=s&&(r.expiredLanes|=L),y&=~L}if(s=pt,o=Ke,o=qr(r,r===s?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,o===0||r===s&&(ct===2||ct===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&Ji(d),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||Cr(r,o)){if(s=o&-o,s===r.callbackPriority)return s;switch(d!==null&&Ji(d),vi(o)){case 2:case 8:o=Fl;break;case 32:o=Zi;break;case 268435456:o=Pu;break;default:o=Zi}return d=Wb.bind(null,r),o=Zt(o,d),r.callbackPriority=s,r.callbackNode=o,s}return d!==null&&d!==null&&Ji(d),r.callbackPriority=2,r.callbackNode=null,2}function Wb(r,s){if(en!==0&&en!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(Gd()&&r.callbackNode!==o)return null;var d=Ke;return d=qr(r,r===pt?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(Db(r,d,s),Qb(r,An()),r.callbackNode!=null&&r.callbackNode===o?Wb.bind(null,r):null)}function Kb(r,s){if(Gd())return null;Db(r,s,!0)}function nA(){mA(function(){(st&6)!==0?Zt(zl,tA):$b()})}function _p(){if(ws===0){var r=Do;r===0&&(r=zr,zr<<=1,(zr&261888)===0&&(zr=256)),ws=r}return ws}function Yb(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:mo(""+r)}function Xb(r,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,r.id&&o.setAttribute("form",r.id),s.parentNode.insertBefore(o,s),r=new FormData(r),o.parentNode.removeChild(o),r}function rA(r,s,o,d,g){if(s==="submit"&&o&&o.stateNode===g){var y=Yb((g[an]||null).action),S=d.submitter;S&&(s=(s=S[an]||null)?Yb(s.formAction):S.getAttribute("formAction"),s!==null&&(y=s,S=null));var L=new ei("action","action",null,d,g);r.push({event:L,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(ws!==0){var W=S?Xb(g,S):new FormData(g);Bm(o,{pending:!0,data:W,method:g.method,action:y},null,W)}}else typeof y=="function"&&(L.preventDefault(),W=S?Xb(g,S):new FormData(g),Bm(o,{pending:!0,data:W,method:g.method,action:y},y,W))},currentTarget:g}]})}}for(var bp=0;bp<tm.length;bp++){var vp=tm[bp],iA=vp.toLowerCase(),sA=vp[0].toUpperCase()+vp.slice(1);Or(iA,"on"+sA)}Or(R_,"onAnimationEnd"),Or(D_,"onAnimationIteration"),Or(j_,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(xT,"onTransitionRun"),Or(ST,"onTransitionStart"),Or(ET,"onTransitionCancel"),Or(I_,"onTransitionEnd"),Yr("onMouseEnter",["mouseout","mouseover"]),Yr("onMouseLeave",["mouseout","mouseover"]),Yr("onPointerEnter",["pointerout","pointerover"]),Yr("onPointerLeave",["pointerout","pointerover"]),Kr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Kr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Kr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Kr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Kr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Kr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Oc));function Jb(r,s){s=(s&4)!==0;for(var o=0;o<r.length;o++){var d=r[o],g=d.event;d=d.listeners;e:{var y=void 0;if(s)for(var S=d.length-1;0<=S;S--){var L=d[S],W=L.instance,ce=L.currentTarget;if(L=L.listener,W!==y&&g.isPropagationStopped())break e;y=L,g.currentTarget=ce;try{y(g)}catch(me){ld(me)}g.currentTarget=null,y=W}else for(S=0;S<d.length;S++){if(L=d[S],W=L.instance,ce=L.currentTarget,L=L.listener,W!==y&&g.isPropagationStopped())break e;y=L,g.currentTarget=ce;try{y(g)}catch(me){ld(me)}g.currentTarget=null,y=W}}}}function We(r,s){var o=s[lo];o===void 0&&(o=s[lo]=new Set);var d=r+"__bubble";o.has(d)||(Zb(s,r,2,!1),o.add(d))}function xp(r,s,o){var d=0;s&&(d|=4),Zb(o,r,d,s)}var Wd="_reactListening"+Math.random().toString(36).slice(2);function Sp(r){if(!r[Wd]){r[Wd]=!0,Gl.forEach(function(o){o!=="selectionchange"&&(aA.has(o)||xp(o,!1,r),xp(o,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Wd]||(s[Wd]=!0,xp("selectionchange",!1,s))}}function Zb(r,s,o,d){switch(Rv(s)){case 2:var g=kA;break;case 8:g=NA;break;default:g=Lp}o=g.bind(null,s,o,r),g=void 0,!pa||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),d?g!==void 0?r.addEventListener(s,o,{capture:!0,passive:g}):r.addEventListener(s,o,!0):g!==void 0?r.addEventListener(s,o,{passive:g}):r.addEventListener(s,o,!1)}function Ep(r,s,o,d,g){var y=d;if((s&1)===0&&(s&2)===0&&d!==null)e:for(;;){if(d===null)return;var S=d.tag;if(S===3||S===4){var L=d.stateNode.containerInfo;if(L===g)break;if(S===4)for(S=d.return;S!==null;){var W=S.tag;if((W===3||W===4)&&S.stateNode.containerInfo===g)return;S=S.return}for(;L!==null;){if(S=Qr(L),S===null)return;if(W=S.tag,W===5||W===6||W===26||W===27){d=y=S;continue e}L=L.parentNode}}d=d.return}ss(function(){var ce=y,me=or(o),be=[];e:{var de=M_.get(r);if(de!==void 0){var fe=ei,Re=r;switch(r){case"keypress":if(ya(o)===0)break e;case"keydown":case"keyup":fe=sd;break;case"focusin":Re="focus",fe=ba;break;case"focusout":Re="blur",fe=ba;break;case"beforeblur":case"afterblur":fe=ba;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=ic;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=Yu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=x;break;case R_:case D_:case j_:fe=Ju;break;case I_:fe=z;break;case"scroll":case"scrollend":fe=rc;break;case"wheel":fe=he;break;case"copy":case"cut":case"paste":fe=Zu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Ei;break;case"toggle":case"beforetoggle":fe=Fe}var Ne=(s&4)!==0,mt=!Ne&&(r==="scroll"||r==="scrollend"),te=Ne?de!==null?de+"Capture":null:de;Ne=[];for(var Z=ce,le;Z!==null;){var ye=Z;if(le=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||le===null||te===null||(ye=Dr(Z,te),ye!=null&&Ne.push(kc(Z,ye,le))),mt)break;Z=Z.return}0<Ne.length&&(de=new fe(de,Re,null,o,me),be.push({event:de,listeners:Ne}))}}if((s&7)===0){e:{if(de=r==="mouseover"||r==="pointerover",fe=r==="mouseout"||r==="pointerout",de&&o!==ec&&(Re=o.relatedTarget||o.fromElement)&&(Qr(Re)||Re[Gr]))break e;if((fe||de)&&(de=me.window===me?me:(de=me.ownerDocument)?de.defaultView||de.parentWindow:window,fe?(Re=o.relatedTarget||o.toElement,fe=ce,Re=Re?Qr(Re):null,Re!==null&&(mt=l(Re),Ne=Re.tag,Re!==mt||Ne!==5&&Ne!==27&&Ne!==6)&&(Re=null)):(fe=null,Re=ce),fe!==Re)){if(Ne=ic,ye="onMouseLeave",te="onMouseEnter",Z="mouse",(r==="pointerout"||r==="pointerover")&&(Ne=Ei,ye="onPointerLeave",te="onPointerEnter",Z="pointer"),mt=fe==null?de:Hn(fe),le=Re==null?de:Hn(Re),de=new Ne(ye,Z+"leave",fe,o,me),de.target=mt,de.relatedTarget=le,ye=null,Qr(me)===ce&&(Ne=new Ne(te,Z+"enter",Re,o,me),Ne.target=le,Ne.relatedTarget=mt,ye=Ne),mt=ye,fe&&Re)t:{for(Ne=oA,te=fe,Z=Re,le=0,ye=te;ye;ye=Ne(ye))le++;ye=0;for(var je=Z;je;je=Ne(je))ye++;for(;0<le-ye;)te=Ne(te),le--;for(;0<ye-le;)Z=Ne(Z),ye--;for(;le--;){if(te===Z||Z!==null&&te===Z.alternate){Ne=te;break t}te=Ne(te),Z=Ne(Z)}Ne=null}else Ne=null;fe!==null&&ev(be,de,fe,Ne,!1),Re!==null&&mt!==null&&ev(be,mt,Re,Ne,!0)}}e:{if(de=ce?Hn(ce):window,fe=de.nodeName&&de.nodeName.toLowerCase(),fe==="select"||fe==="input"&&de.type==="file")var nt=y_;else if(p_(de))if(__)nt=_T;else{nt=gT;var De=pT}else fe=de.nodeName,!fe||fe.toLowerCase()!=="input"||de.type!=="checkbox"&&de.type!=="radio"?ce&&fo(ce.elementType)&&(nt=y_):nt=yT;if(nt&&(nt=nt(r,ce))){g_(be,nt,o,me);break e}De&&De(r,de,ce),r==="focusout"&&ce&&de.type==="number"&&ce.memoizedProps.value!=null&&Xl(de,"number",de.value)}switch(De=ce?Hn(ce):window,r){case"focusin":(p_(De)||De.contentEditable==="true")&&(xo=De,Jf=ce,cc=null);break;case"focusout":cc=Jf=xo=null;break;case"mousedown":Zf=!0;break;case"contextmenu":case"mouseup":case"dragend":Zf=!1,T_(be,o,me);break;case"selectionchange":if(vT)break;case"keydown":case"keyup":T_(be,o,me)}var Ge;if(it)e:{switch(r){case"compositionstart":var Ye="onCompositionStart";break e;case"compositionend":Ye="onCompositionEnd";break e;case"compositionupdate":Ye="onCompositionUpdate";break e}Ye=void 0}else vo?va(r,o)&&(Ye="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ye="onCompositionStart");Ye&&(ri&&o.locale!=="ko"&&(vo||Ye!=="onCompositionStart"?Ye==="onCompositionEnd"&&vo&&(Ge=nc()):(Zr=me,tc="value"in Zr?Zr.value:Zr.textContent,vo=!0)),De=Kd(ce,Ye),0<De.length&&(Ye=new ni(Ye,r,null,o,me),be.push({event:Ye,listeners:De}),Ge?Ye.data=Ge:(Ge=bo(o),Ge!==null&&(Ye.data=Ge)))),(Ge=cr?dT(r,o):hT(r,o))&&(Ye=Kd(ce,"onBeforeInput"),0<Ye.length&&(De=new ni("onBeforeInput","beforeinput",null,o,me),be.push({event:De,listeners:Ye}),De.data=Ge)),rA(be,r,ce,o,me)}Jb(be,s)})}function kc(r,s,o){return{instance:r,listener:s,currentTarget:o}}function Kd(r,s){for(var o=s+"Capture",d=[];r!==null;){var g=r,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=Dr(r,o),g!=null&&d.unshift(kc(r,g,y)),g=Dr(r,s),g!=null&&d.push(kc(r,g,y))),r.tag===3)return d;r=r.return}return[]}function oA(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function ev(r,s,o,d,g){for(var y=s._reactName,S=[];o!==null&&o!==d;){var L=o,W=L.alternate,ce=L.stateNode;if(L=L.tag,W!==null&&W===d)break;L!==5&&L!==26&&L!==27||ce===null||(W=ce,g?(ce=Dr(o,y),ce!=null&&S.unshift(kc(o,ce,W))):g||(ce=Dr(o,y),ce!=null&&S.push(kc(o,ce,W)))),o=o.return}S.length!==0&&r.push({event:s,listeners:S})}var lA=/\r\n?/g,cA=/\u0000|\uFFFD/g;function tv(r){return(typeof r=="string"?r:""+r).replace(lA,`
`).replace(cA,"")}function nv(r,s){return s=tv(s),tv(r)===s}function ft(r,s,o,d,g,y){switch(o){case"children":typeof d=="string"?s==="body"||s==="textarea"&&d===""||kn(r,d):(typeof d=="number"||typeof d=="bigint")&&s!=="body"&&kn(r,""+d);break;case"className":Gn(r,"class",d);break;case"tabIndex":Gn(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Gn(r,o,d);break;case"style":Zl(r,d,y);break;case"data":if(s!=="object"){Gn(r,"data",d);break}case"src":case"href":if(d===""&&(s!=="a"||o!=="href")){r.removeAttribute(o);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(o);break}d=mo(""+d),r.setAttribute(o,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&ft(r,s,"name",g.name,g,null),ft(r,s,"formEncType",g.formEncType,g,null),ft(r,s,"formMethod",g.formMethod,g,null),ft(r,s,"formTarget",g.formTarget,g,null)):(ft(r,s,"encType",g.encType,g,null),ft(r,s,"method",g.method,g,null),ft(r,s,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(o);break}d=mo(""+d),r.setAttribute(o,d);break;case"onClick":d!=null&&(r.onclick=Rr);break;case"onScroll":d!=null&&We("scroll",r);break;case"onScrollEnd":d!=null&&We("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(o=d.__html,o!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}o=mo(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(o,""+d):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":d===!0?r.setAttribute(o,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(o,d):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(o,d):r.removeAttribute(o);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(o):r.setAttribute(o,d);break;case"popover":We("beforetoggle",r),We("toggle",r),uo(r,"popover",d);break;case"xlinkActuate":zt(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":zt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":zt(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":zt(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":zt(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":zt(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":zt(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":zt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":zt(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":uo(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Ku.get(o)||o,uo(r,o,d))}}function wp(r,s,o,d,g,y){switch(o){case"style":Zl(r,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(o=d.__html,o!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"children":typeof d=="string"?kn(r,d):(typeof d=="number"||typeof d=="bigint")&&kn(r,""+d);break;case"onScroll":d!=null&&We("scroll",r);break;case"onScrollEnd":d!=null&&We("scrollend",r);break;case"onClick":d!=null&&(r.onclick=Rr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$l.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),s=o.slice(2,g?o.length-7:void 0),y=r[an]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(s,y,g),typeof d=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(s,d,g);break e}o in r?r[o]=d:d===!0?r.setAttribute(o,""):uo(r,o,d)}}}function yn(r,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":We("error",r),We("load",r);var d=!1,g=!1,y;for(y in o)if(o.hasOwnProperty(y)){var S=o[y];if(S!=null)switch(y){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ft(r,s,y,S,o,null)}}g&&ft(r,s,"srcSet",o.srcSet,o,null),d&&ft(r,s,"src",o.src,o,null);return;case"input":We("invalid",r);var L=y=S=g=null,W=null,ce=null;for(d in o)if(o.hasOwnProperty(d)){var me=o[d];if(me!=null)switch(d){case"name":g=me;break;case"type":S=me;break;case"checked":W=me;break;case"defaultChecked":ce=me;break;case"value":y=me;break;case"defaultValue":L=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,s));break;default:ft(r,s,d,me,o,null)}}$u(r,y,L,W,ce,S,g,!1);return;case"select":We("invalid",r),d=S=y=null;for(g in o)if(o.hasOwnProperty(g)&&(L=o[g],L!=null))switch(g){case"value":y=L;break;case"defaultValue":S=L;break;case"multiple":d=L;default:ft(r,s,g,L,o,null)}s=y,o=S,r.multiple=!!d,s!=null?ts(r,!!d,s,!1):o!=null&&ts(r,!!d,o,!0);return;case"textarea":We("invalid",r),y=g=d=null;for(S in o)if(o.hasOwnProperty(S)&&(L=o[S],L!=null))switch(S){case"value":d=L;break;case"defaultValue":g=L;break;case"children":y=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(i(91));break;default:ft(r,s,S,L,o,null)}ns(r,d,g,y);return;case"option":for(W in o)o.hasOwnProperty(W)&&(d=o[W],d!=null)&&(W==="selected"?r.selected=d&&typeof d!="function"&&typeof d!="symbol":ft(r,s,W,d,o,null));return;case"dialog":We("beforetoggle",r),We("toggle",r),We("cancel",r),We("close",r);break;case"iframe":case"object":We("load",r);break;case"video":case"audio":for(d=0;d<Oc.length;d++)We(Oc[d],r);break;case"image":We("error",r),We("load",r);break;case"details":We("toggle",r);break;case"embed":case"source":case"link":We("error",r),We("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ce in o)if(o.hasOwnProperty(ce)&&(d=o[ce],d!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:ft(r,s,ce,d,o,null)}return;default:if(fo(s)){for(me in o)o.hasOwnProperty(me)&&(d=o[me],d!==void 0&&wp(r,s,me,d,o,void 0));return}}for(L in o)o.hasOwnProperty(L)&&(d=o[L],d!=null&&ft(r,s,L,d,o,null))}function uA(r,s,o,d){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,S=null,L=null,W=null,ce=null,me=null;for(fe in o){var be=o[fe];if(o.hasOwnProperty(fe)&&be!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":W=be;default:d.hasOwnProperty(fe)||ft(r,s,fe,null,d,be)}}for(var de in d){var fe=d[de];if(be=o[de],d.hasOwnProperty(de)&&(fe!=null||be!=null))switch(de){case"type":y=fe;break;case"name":g=fe;break;case"checked":ce=fe;break;case"defaultChecked":me=fe;break;case"value":S=fe;break;case"defaultValue":L=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,s));break;default:fe!==be&&ft(r,s,de,fe,d,be)}}ho(r,S,L,W,ce,me,y,g);return;case"select":fe=S=L=de=null;for(y in o)if(W=o[y],o.hasOwnProperty(y)&&W!=null)switch(y){case"value":break;case"multiple":fe=W;default:d.hasOwnProperty(y)||ft(r,s,y,null,d,W)}for(g in d)if(y=d[g],W=o[g],d.hasOwnProperty(g)&&(y!=null||W!=null))switch(g){case"value":de=y;break;case"defaultValue":L=y;break;case"multiple":S=y;default:y!==W&&ft(r,s,g,y,d,W)}s=L,o=S,d=fe,de!=null?ts(r,!!o,de,!1):!!d!=!!o&&(s!=null?ts(r,!!o,s,!0):ts(r,!!o,o?[]:"",!1));return;case"textarea":fe=de=null;for(L in o)if(g=o[L],o.hasOwnProperty(L)&&g!=null&&!d.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:ft(r,s,L,null,d,g)}for(S in d)if(g=d[S],y=o[S],d.hasOwnProperty(S)&&(g!=null||y!=null))switch(S){case"value":de=g;break;case"defaultValue":fe=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==y&&ft(r,s,S,g,d,y)}Qu(r,de,fe);return;case"option":for(var Re in o)de=o[Re],o.hasOwnProperty(Re)&&de!=null&&!d.hasOwnProperty(Re)&&(Re==="selected"?r.selected=!1:ft(r,s,Re,null,d,de));for(W in d)de=d[W],fe=o[W],d.hasOwnProperty(W)&&de!==fe&&(de!=null||fe!=null)&&(W==="selected"?r.selected=de&&typeof de!="function"&&typeof de!="symbol":ft(r,s,W,de,d,fe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ne in o)de=o[Ne],o.hasOwnProperty(Ne)&&de!=null&&!d.hasOwnProperty(Ne)&&ft(r,s,Ne,null,d,de);for(ce in d)if(de=d[ce],fe=o[ce],d.hasOwnProperty(ce)&&de!==fe&&(de!=null||fe!=null))switch(ce){case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,s));break;default:ft(r,s,ce,de,d,fe)}return;default:if(fo(s)){for(var mt in o)de=o[mt],o.hasOwnProperty(mt)&&de!==void 0&&!d.hasOwnProperty(mt)&&wp(r,s,mt,void 0,d,de);for(me in d)de=d[me],fe=o[me],!d.hasOwnProperty(me)||de===fe||de===void 0&&fe===void 0||wp(r,s,me,de,d,fe);return}}for(var te in o)de=o[te],o.hasOwnProperty(te)&&de!=null&&!d.hasOwnProperty(te)&&ft(r,s,te,null,d,de);for(be in d)de=d[be],fe=o[be],!d.hasOwnProperty(be)||de===fe||de==null&&fe==null||ft(r,s,be,de,d,fe)}function rv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function dA(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,o=performance.getEntriesByType("resource"),d=0;d<o.length;d++){var g=o[d],y=g.transferSize,S=g.initiatorType,L=g.duration;if(y&&L&&rv(S)){for(S=0,L=g.responseEnd,d+=1;d<o.length;d++){var W=o[d],ce=W.startTime;if(ce>L)break;var me=W.transferSize,be=W.initiatorType;me&&rv(be)&&(W=W.responseEnd,S+=me*(W<L?1:(L-ce)/(W-ce)))}if(--d,s+=8*(y+S)/(g.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Cp=null,Tp=null;function Yd(r){return r.nodeType===9?r:r.ownerDocument}function iv(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sv(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function Ap(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Rp=null;function hA(){var r=window.event;return r&&r.type==="popstate"?r===Rp?!1:(Rp=r,!0):(Rp=null,!1)}var av=typeof setTimeout=="function"?setTimeout:void 0,fA=typeof clearTimeout=="function"?clearTimeout:void 0,ov=typeof Promise=="function"?Promise:void 0,mA=typeof queueMicrotask=="function"?queueMicrotask:typeof ov<"u"?function(r){return ov.resolve(null).then(r).catch(pA)}:av;function pA(r){setTimeout(function(){throw r})}function Cs(r){return r==="head"}function lv(r,s){var o=s,d=0;do{var g=o.nextSibling;if(r.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(d===0){r.removeChild(g),Wo(s);return}d--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")d++;else if(o==="html")Nc(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,Nc(o);for(var y=o.firstChild;y;){var S=y.nextSibling,L=y.nodeName;y[$r]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=S}}else o==="body"&&Nc(r.ownerDocument.body);o=g}while(o);Wo(s)}function cv(r,s){var o=r;r=0;do{var d=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),d&&d.nodeType===8)if(o=d.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=d}while(o)}function Dp(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Dp(o),co(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function gA(r,s,o,d){for(;r.nodeType===1;){var g=o;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[$r])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=gr(r.nextSibling),r===null)break}return null}function yA(r,s,o){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=gr(r.nextSibling),r===null))return null;return r}function uv(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=gr(r.nextSibling),r===null))return null;return r}function jp(r){return r.data==="$?"||r.data==="$~"}function Ip(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function _A(r,s){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||o.readyState!=="loading")s();else{var d=function(){s(),o.removeEventListener("DOMContentLoaded",d)};o.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function gr(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var Mp=null;function dv(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(s===0)return gr(r.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}r=r.nextSibling}return null}function hv(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return r;s--}else o!=="/$"&&o!=="/&"||s++}r=r.previousSibling}return null}function fv(r,s,o){switch(s=Yd(o),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Nc(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);co(r)}var yr=new Map,mv=new Set;function Xd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Bi=$.d;$.d={f:bA,r:vA,D:xA,C:SA,L:EA,m:wA,X:TA,S:CA,M:AA};function bA(){var r=Bi.f(),s=Fd();return r||s}function vA(r){var s=ar(r);s!==null&&s.tag===5&&s.type==="form"?I0(s):Bi.r(r)}var Go=typeof document>"u"?null:document;function pv(r,s,o){var d=Go;if(d&&typeof s=="string"&&s){var g=On(s);g='link[rel="'+r+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),mv.has(g)||(mv.add(g),r={rel:r,crossOrigin:o,href:s},d.querySelector(g)===null&&(s=d.createElement("link"),yn(s,"link",r),Ut(s),d.head.appendChild(s)))}}function xA(r){Bi.D(r),pv("dns-prefetch",r,null)}function SA(r,s){Bi.C(r,s),pv("preconnect",r,s)}function EA(r,s,o){Bi.L(r,s,o);var d=Go;if(d&&r&&s){var g='link[rel="preload"][as="'+On(s)+'"]';s==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+On(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+On(o.imageSizes)+'"]')):g+='[href="'+On(r)+'"]';var y=g;switch(s){case"style":y=$o(r);break;case"script":y=Qo(r)}yr.has(y)||(r=b({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:r,as:s},o),yr.set(y,r),d.querySelector(g)!==null||s==="style"&&d.querySelector(Pc(y))||s==="script"&&d.querySelector(Lc(y))||(s=d.createElement("link"),yn(s,"link",r),Ut(s),d.head.appendChild(s)))}}function wA(r,s){Bi.m(r,s);var o=Go;if(o&&r){var d=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+On(d)+'"][href="'+On(r)+'"]',y=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Qo(r)}if(!yr.has(y)&&(r=b({rel:"modulepreload",href:r},s),yr.set(y,r),o.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Lc(y)))return}d=o.createElement("link"),yn(d,"link",r),Ut(d),o.head.appendChild(d)}}}function CA(r,s,o){Bi.S(r,s,o);var d=Go;if(d&&r){var g=Wr(d).hoistableStyles,y=$o(r);s=s||"default";var S=g.get(y);if(!S){var L={loading:0,preload:null};if(S=d.querySelector(Pc(y)))L.loading=5;else{r=b({rel:"stylesheet",href:r,"data-precedence":s},o),(o=yr.get(y))&&Op(r,o);var W=S=d.createElement("link");Ut(W),yn(W,"link",r),W._p=new Promise(function(ce,me){W.onload=ce,W.onerror=me}),W.addEventListener("load",function(){L.loading|=1}),W.addEventListener("error",function(){L.loading|=2}),L.loading|=4,Jd(S,s,d)}S={type:"stylesheet",instance:S,count:1,state:L},g.set(y,S)}}}function TA(r,s){Bi.X(r,s);var o=Go;if(o&&r){var d=Wr(o).hoistableScripts,g=Qo(r),y=d.get(g);y||(y=o.querySelector(Lc(g)),y||(r=b({src:r,async:!0},s),(s=yr.get(g))&&kp(r,s),y=o.createElement("script"),Ut(y),yn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function AA(r,s){Bi.M(r,s);var o=Go;if(o&&r){var d=Wr(o).hoistableScripts,g=Qo(r),y=d.get(g);y||(y=o.querySelector(Lc(g)),y||(r=b({src:r,async:!0,type:"module"},s),(s=yr.get(g))&&kp(r,s),y=o.createElement("script"),Ut(y),yn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function gv(r,s,o,d){var g=(g=re.current)?Xd(g):null;if(!g)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=$o(o.href),o=Wr(g).hoistableStyles,d=o.get(s),d||(d={type:"style",instance:null,count:0,state:null},o.set(s,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=$o(o.href);var y=Wr(g).hoistableStyles,S=y.get(r);if(S||(g=g.ownerDocument||g,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,S),(y=g.querySelector(Pc(r)))&&!y._p&&(S.instance=y,S.state.loading=5),yr.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},yr.set(r,o),y||RA(g,r,o,S.state))),s&&d===null)throw Error(i(528,""));return S}if(s&&d!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Qo(o),o=Wr(g).hoistableScripts,d=o.get(s),d||(d={type:"script",instance:null,count:0,state:null},o.set(s,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function $o(r){return'href="'+On(r)+'"'}function Pc(r){return'link[rel="stylesheet"]['+r+"]"}function yv(r){return b({},r,{"data-precedence":r.precedence,precedence:null})}function RA(r,s,o,d){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?d.loading=1:(s=r.createElement("link"),d.preload=s,s.addEventListener("load",function(){return d.loading|=1}),s.addEventListener("error",function(){return d.loading|=2}),yn(s,"link",o),Ut(s),r.head.appendChild(s))}function Qo(r){return'[src="'+On(r)+'"]'}function Lc(r){return"script[async]"+r}function _v(r,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var d=r.querySelector('style[data-href~="'+On(o.href)+'"]');if(d)return s.instance=d,Ut(d),d;var g=b({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),Ut(d),yn(d,"style",g),Jd(d,o.precedence,r),s.instance=d;case"stylesheet":g=$o(o.href);var y=r.querySelector(Pc(g));if(y)return s.state.loading|=4,s.instance=y,Ut(y),y;d=yv(o),(g=yr.get(g))&&Op(d,g),y=(r.ownerDocument||r).createElement("link"),Ut(y);var S=y;return S._p=new Promise(function(L,W){S.onload=L,S.onerror=W}),yn(y,"link",d),s.state.loading|=4,Jd(y,o.precedence,r),s.instance=y;case"script":return y=Qo(o.src),(g=r.querySelector(Lc(y)))?(s.instance=g,Ut(g),g):(d=o,(g=yr.get(y))&&(d=b({},o),kp(d,g)),r=r.ownerDocument||r,g=r.createElement("script"),Ut(g),yn(g,"link",d),r.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(d=s.instance,s.state.loading|=4,Jd(d,o.precedence,r));return s.instance}function Jd(r,s,o){for(var d=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,y=g,S=0;S<d.length;S++){var L=d[S];if(L.dataset.precedence===s)y=L;else if(y!==g)break}y?y.parentNode.insertBefore(r,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(r,s.firstChild))}function Op(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function kp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var Zd=null;function bv(r,s,o){if(Zd===null){var d=new Map,g=Zd=new Map;g.set(o,d)}else g=Zd,d=g.get(o),d||(d=new Map,g.set(o,d));if(d.has(r))return d;for(d.set(r,null),o=o.getElementsByTagName(r),g=0;g<o.length;g++){var y=o[g];if(!(y[$r]||y[Vt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var S=y.getAttribute(s)||"";S=r+S;var L=d.get(S);L?L.push(y):d.set(S,[y])}}return d}function vv(r,s,o){r=r.ownerDocument||r,r.head.insertBefore(o,s==="title"?r.querySelector("head > title"):null)}function DA(r,s,o){if(o===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function xv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function jA(r,s,o,d){if(o.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=$o(d.href),y=s.querySelector(Pc(g));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=eh.bind(r),s.then(r,r)),o.state.loading|=4,o.instance=y,Ut(y);return}y=s.ownerDocument||s,d=yv(d),(g=yr.get(g))&&Op(d,g),y=y.createElement("link"),Ut(y);var S=y;S._p=new Promise(function(L,W){S.onload=L,S.onerror=W}),yn(y,"link",d),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=eh.bind(r),s.addEventListener("load",o),s.addEventListener("error",o))}}var Np=0;function IA(r,s){return r.stylesheets&&r.count===0&&nh(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var d=setTimeout(function(){if(r.stylesheets&&nh(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+s);0<r.imgBytes&&Np===0&&(Np=62500*dA());var g=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&nh(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>Np?50:800)+s);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(d),clearTimeout(g)}}:null}function eh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)nh(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var th=null;function nh(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,th=new Map,s.forEach(MA,r),th=null,eh.call(r))}function MA(r,s){if(!(s.state.loading&4)){var o=th.get(r);if(o)var d=o.get(null);else{o=new Map,th.set(r,o);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var S=g[y];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(o.set(S.dataset.precedence,S),d=S)}d&&o.set(null,d)}g=s.instance,S=g.getAttribute("data-precedence"),y=o.get(S)||d,y===d&&o.set(null,g),o.set(S,g),this.count++,d=eh.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),y?y.parentNode.insertBefore(g,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),s.state.loading|=4}}var Bc={$$typeof:k,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function OA(r,s,o,d,g,y,S,L,W){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Hr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hr(0),this.hiddenUpdates=Hr(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function Sv(r,s,o,d,g,y,S,L,W,ce,me,be){return r=new OA(r,s,o,S,W,ce,me,be,L),s=1,y===!0&&(s|=24),y=Qn(3,null,null,s),r.current=y,y.stateNode=r,s=mm(),s.refCount++,r.pooledCache=s,s.refCount++,y.memoizedState={element:d,isDehydrated:o,cache:s},_m(y),r}function Ev(r){return r?(r=wo,r):wo}function wv(r,s,o,d,g,y){g=Ev(g),d.context===null?d.context=g:d.pendingContext=g,d=ms(s),d.payload={element:o},y=y===void 0?null:y,y!==null&&(d.callback=y),o=ps(r,d,s),o!==null&&(Vn(o,r,s),gc(o,r,s))}function Cv(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<s?o:s}}function Pp(r,s){Cv(r,s),(r=r.alternate)&&Cv(r,s)}function Tv(r){if(r.tag===13||r.tag===31){var s=Ea(r,67108864);s!==null&&Vn(s,r,67108864),Pp(r,67108864)}}function Av(r){if(r.tag===13||r.tag===31){var s=Jn();s=da(s);var o=Ea(r,s);o!==null&&Vn(o,r,s),Pp(r,s)}}var rh=!0;function kA(r,s,o,d){var g=B.T;B.T=null;var y=$.p;try{$.p=2,Lp(r,s,o,d)}finally{$.p=y,B.T=g}}function NA(r,s,o,d){var g=B.T;B.T=null;var y=$.p;try{$.p=8,Lp(r,s,o,d)}finally{$.p=y,B.T=g}}function Lp(r,s,o,d){if(rh){var g=Bp(d);if(g===null)Ep(r,s,d,ih,o),Dv(r,d);else if(LA(g,r,s,o,d))d.stopPropagation();else if(Dv(r,d),s&4&&-1<PA.indexOf(r)){for(;g!==null;){var y=ar(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var S=Fr(y.pendingLanes);if(S!==0){var L=y;for(L.pendingLanes|=2,L.entangledLanes|=2;S;){var W=1<<31-jt(S);L.entanglements[1]|=W,S&=~W}oi(y),(st&6)===0&&(Ud=An()+500,Mc(0))}}break;case 31:case 13:L=Ea(y,2),L!==null&&Vn(L,y,2),Fd(),Pp(y,2)}if(y=Bp(d),y===null&&Ep(r,s,d,ih,o),y===g)break;g=y}g!==null&&d.stopPropagation()}else Ep(r,s,d,null,o)}}function Bp(r){return r=or(r),Vp(r)}var ih=null;function Vp(r){if(ih=null,r=Qr(r),r!==null){var s=l(r);if(s===null)r=null;else{var o=s.tag;if(o===13){if(r=c(s),r!==null)return r;r=null}else if(o===31){if(r=h(s),r!==null)return r;r=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return ih=r,null}function Rv(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(oa()){case zl:return 2;case Fl:return 8;case Zi:case Gf:return 32;case Pu:return 268435456;default:return 32}default:return 32}}var Up=!1,Ts=null,As=null,Rs=null,Vc=new Map,Uc=new Map,Ds=[],PA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dv(r,s){switch(r){case"focusin":case"focusout":Ts=null;break;case"dragenter":case"dragleave":As=null;break;case"mouseover":case"mouseout":Rs=null;break;case"pointerover":case"pointerout":Vc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Uc.delete(s.pointerId)}}function zc(r,s,o,d,g,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:o,eventSystemFlags:d,nativeEvent:y,targetContainers:[g]},s!==null&&(s=ar(s),s!==null&&Tv(s)),r):(r.eventSystemFlags|=d,s=r.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),r)}function LA(r,s,o,d,g){switch(s){case"focusin":return Ts=zc(Ts,r,s,o,d,g),!0;case"dragenter":return As=zc(As,r,s,o,d,g),!0;case"mouseover":return Rs=zc(Rs,r,s,o,d,g),!0;case"pointerover":var y=g.pointerId;return Vc.set(y,zc(Vc.get(y)||null,r,s,o,d,g)),!0;case"gotpointercapture":return y=g.pointerId,Uc.set(y,zc(Uc.get(y)||null,r,s,o,d,g)),!0}return!1}function jv(r){var s=Qr(r.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){r.blockedOn=s,Tr(r.priority,function(){Av(o)});return}}else if(s===31){if(s=h(o),s!==null){r.blockedOn=s,Tr(r.priority,function(){Av(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function sh(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var o=Bp(r.nativeEvent);if(o===null){o=r.nativeEvent;var d=new o.constructor(o.type,o);ec=d,o.target.dispatchEvent(d),ec=null}else return s=ar(o),s!==null&&Tv(s),r.blockedOn=o,!1;s.shift()}return!0}function Iv(r,s,o){sh(r)&&o.delete(s)}function BA(){Up=!1,Ts!==null&&sh(Ts)&&(Ts=null),As!==null&&sh(As)&&(As=null),Rs!==null&&sh(Rs)&&(Rs=null),Vc.forEach(Iv),Uc.forEach(Iv)}function ah(r,s){r.blockedOn===s&&(r.blockedOn=null,Up||(Up=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,BA)))}var oh=null;function Mv(r){oh!==r&&(oh=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){oh===r&&(oh=null);for(var s=0;s<r.length;s+=3){var o=r[s],d=r[s+1],g=r[s+2];if(typeof d!="function"){if(Vp(d||o)===null)continue;break}var y=ar(o);y!==null&&(r.splice(s,3),s-=3,Bm(y,{pending:!0,data:g,method:o.method,action:d},d,g))}}))}function Wo(r){function s(W){return ah(W,r)}Ts!==null&&ah(Ts,r),As!==null&&ah(As,r),Rs!==null&&ah(Rs,r),Vc.forEach(s),Uc.forEach(s);for(var o=0;o<Ds.length;o++){var d=Ds[o];d.blockedOn===r&&(d.blockedOn=null)}for(;0<Ds.length&&(o=Ds[0],o.blockedOn===null);)jv(o),o.blockedOn===null&&Ds.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(d=0;d<o.length;d+=3){var g=o[d],y=o[d+1],S=g[an]||null;if(typeof y=="function")S||Mv(o);else if(S){var L=null;if(y&&y.hasAttribute("formAction")){if(g=y,S=y[an]||null)L=S.formAction;else if(Vp(g)!==null)continue}else L=S.action;typeof L=="function"?o[d+1]=L:(o.splice(d,3),d-=3),Mv(o)}}}function Ov(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(S){return g=S})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),d||setTimeout(o,20)}function o(){if(!d&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,g=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){d=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function zp(r){this._internalRoot=r}lh.prototype.render=zp.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,d=Jn();wv(o,d,r,s,null,null)},lh.prototype.unmount=zp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;wv(r.current,2,null,r,null,null),Fd(),s[Gr]=null}};function lh(r){this._internalRoot=r}lh.prototype.unstable_scheduleHydration=function(r){if(r){var s=Fu();r={blockedOn:null,target:r,priority:s};for(var o=0;o<Ds.length&&s!==0&&s<Ds[o].priority;o++);Ds.splice(o,0,r),o===0&&jv(r)}};var kv=e.version;if(kv!=="19.2.3")throw Error(i(527,kv,"19.2.3"));$.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=p(s),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var VA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ch=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ch.isDisabled&&ch.supportsFiber)try{wr=ch.inject(VA),hn=ch}catch{}}return qc.createRoot=function(r,s){if(!a(r))throw Error(i(299));var o=!1,d="",g=z0,y=F0,S=q0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(d=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(S=s.onRecoverableError)),s=Sv(r,1,!1,null,null,o,d,null,g,y,S,Ov),r[Gr]=s.current,Sp(r),new zp(s)},qc.hydrateRoot=function(r,s,o){if(!a(r))throw Error(i(299));var d=!1,g="",y=z0,S=F0,L=q0,W=null;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(S=o.onCaughtError),o.onRecoverableError!==void 0&&(L=o.onRecoverableError),o.formState!==void 0&&(W=o.formState)),s=Sv(r,1,!0,s,o??null,d,g,W,y,S,L,Ov),s.context=Ev(null),o=s.current,d=Jn(),d=da(d),g=ms(d),g.callback=null,ps(o,g,d),o=d,s.current.lanes=o,ca(s,o),oi(s),r[Gr]=s.current,Sp(r),new lh(s)},qc.version="19.2.3",qc}var Hv;function KA(){if(Hv)return Hp.exports;Hv=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Hp.exports=WA(),Hp.exports}var YA=KA();var Gv="popstate";function XA(t={}){function e(i,a){let{pathname:l,search:c,hash:h}=i.location;return fg("",{pathname:l,search:c,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:ru(a)}return ZA(e,n,null,t)}function Ct(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function tr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function JA(){return Math.random().toString(36).substring(2,10)}function $v(t,e){return{usr:t.state,key:t.key,idx:e}}function fg(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?wl(e):e,state:n,key:e&&e.key||i||JA()}}function ru({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function wl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function ZA(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,h="POP",f=null,p=_();p==null&&(p=0,c.replaceState({...c.state,idx:p},""));function _(){return(c.state||{idx:null}).idx}function b(){h="POP";let D=_(),N=D==null?null:D-p;p=D,f&&f({action:h,location:w.location,delta:N})}function v(D,N){h="PUSH";let U=fg(w.location,D,N);p=_()+1;let k=$v(U,p),X=w.createHref(U);try{c.pushState(k,"",X)}catch(G){if(G instanceof DOMException&&G.name==="DataCloneError")throw G;a.location.assign(X)}l&&f&&f({action:h,location:w.location,delta:1})}function E(D,N){h="REPLACE";let U=fg(w.location,D,N);p=_();let k=$v(U,p),X=w.createHref(U);c.replaceState(k,"",X),l&&f&&f({action:h,location:w.location,delta:0})}function C(D){return eR(D)}let w={get action(){return h},get location(){return t(a,c)},listen(D){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Gv,b),f=D,()=>{a.removeEventListener(Gv,b),f=null}},createHref(D){return e(a,D)},createURL:C,encodeLocation(D){let N=C(D);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:v,replace:E,go(D){return c.go(D)}};return w}function eR(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ct(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:ru(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function uE(t,e,n="/"){return tR(t,e,n,!1)}function tR(t,e,n,i){let a=typeof e=="string"?wl(e):e,l=Gi(a.pathname||"/",n);if(l==null)return null;let c=dE(t);nR(c);let h=null;for(let f=0;h==null&&f<c.length;++f){let p=fR(l);h=dR(c[f],p,i)}return h}function dE(t,e=[],n=[],i="",a=!1){let l=(c,h,f=a,p)=>{let _={relativePath:p===void 0?c.path||"":p,caseSensitive:c.caseSensitive===!0,childrenIndex:h,route:c};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&f)return;Ct(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let b=qi([i,_.relativePath]),v=n.concat(_);c.children&&c.children.length>0&&(Ct(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),dE(c.children,e,v,b,f)),!(c.path==null&&!c.index)&&e.push({path:b,score:cR(b,c.index),routesMeta:v})};return t.forEach((c,h)=>{if(c.path===""||!c.path?.includes("?"))l(c,h);else for(let f of hE(c.path))l(c,h,!0,f)}),e}function hE(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=hE(i.join("/")),h=[];return h.push(...c.map(f=>f===""?l:[l,f].join("/"))),a&&h.push(...c),h.map(f=>t.startsWith("/")&&f===""?"/":f)}function nR(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:uR(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var rR=/^:[\w-]+$/,iR=3,sR=2,aR=1,oR=10,lR=-2,Qv=t=>t==="*";function cR(t,e){let n=t.split("/"),i=n.length;return n.some(Qv)&&(i+=lR),e&&(i+=sR),n.filter(a=>!Qv(a)).reduce((a,l)=>a+(rR.test(l)?iR:l===""?aR:oR),i)}function uR(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function dR(t,e,n=!1){let{routesMeta:i}=t,a={},l="/",c=[];for(let h=0;h<i.length;++h){let f=i[h],p=h===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",b=Mh({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},_),v=f.route;if(!b&&p&&n&&!i[i.length-1].route.index&&(b=Mh({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},_)),!b)return null;Object.assign(a,b.params),c.push({params:a,pathname:qi([l,b.pathname]),pathnameBase:yR(qi([l,b.pathnameBase])),route:v}),b.pathnameBase!=="/"&&(l=qi([l,b.pathnameBase]))}return c}function Mh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=hR(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:i.reduce((p,{paramName:_,isOptional:b},v)=>{if(_==="*"){let C=h[v]||"";c=l.slice(0,l.length-C.length).replace(/(.)\/+$/,"$1")}const E=h[v];return b&&!E?p[_]=void 0:p[_]=(E||"").replace(/%2F/g,"/"),p},{}),pathname:l,pathnameBase:c,pattern:t}}function hR(t,e=!1,n=!0){tr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,h,f)=>(i.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function fR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return tr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Gi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var fE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mR=t=>fE.test(t);function pR(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?wl(t):t,l;if(n)if(mR(n))l=n;else{if(n.includes("//")){let c=n;n=n.replace(/\/\/+/g,"/"),tr(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${n}`)}n.startsWith("/")?l=Wv(n.substring(1),"/"):l=Wv(n,e)}else l=e;return{pathname:l,search:_R(i),hash:bR(a)}}function Wv(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Wp(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function gR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ry(t){let e=gR(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function iy(t,e,n,i=!1){let a;typeof t=="string"?a=wl(t):(a={...t},Ct(!a.pathname||!a.pathname.includes("?"),Wp("?","pathname","search",a)),Ct(!a.pathname||!a.pathname.includes("#"),Wp("#","pathname","hash",a)),Ct(!a.search||!a.search.includes("#"),Wp("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,h;if(c==null)h=n;else{let b=e.length-1;if(!i&&c.startsWith("..")){let v=c.split("/");for(;v[0]==="..";)v.shift(),b-=1;a.pathname=v.join("/")}h=b>=0?e[b]:"/"}let f=pR(a,h),p=c&&c!=="/"&&c.endsWith("/"),_=(l||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(p||_)&&(f.pathname+="/"),f}var qi=t=>t.join("/").replace(/\/\/+/g,"/"),yR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),_R=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,bR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,vR=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function xR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function SR(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var mE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function pE(t,e){let n=t;if(typeof n!="string"||!fE.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if(mE)try{let l=new URL(window.location.href),c=n.startsWith("//")?new URL(l.protocol+n):new URL(n),h=Gi(c.pathname,e);c.origin===l.origin&&h!=null?n=h+c.search+c.hash:a=!0}catch{tr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var gE=["POST","PUT","PATCH","DELETE"];new Set(gE);var ER=["GET",...gE];new Set(ER);var Cl=A.createContext(null);Cl.displayName="DataRouter";var sf=A.createContext(null);sf.displayName="DataRouterState";var wR=A.createContext(!1),yE=A.createContext({isTransitioning:!1});yE.displayName="ViewTransition";var CR=A.createContext(new Map);CR.displayName="Fetchers";var TR=A.createContext(null);TR.displayName="Await";var rr=A.createContext(null);rr.displayName="Navigation";var gu=A.createContext(null);gu.displayName="Location";var Sr=A.createContext({outlet:null,matches:[],isDataRoute:!1});Sr.displayName="Route";var sy=A.createContext(null);sy.displayName="RouteError";var _E="REACT_ROUTER_ERROR",AR="REDIRECT",RR="ROUTE_ERROR_RESPONSE";function DR(t){if(t.startsWith(`${_E}:${AR}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function jR(t){if(t.startsWith(`${_E}:${RR}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new vR(e.status,e.statusText,e.data)}catch{}}function IR(t,{relative:e}={}){Ct(Tl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=A.useContext(rr),{hash:a,pathname:l,search:c}=_u(t,{relative:e}),h=l;return n!=="/"&&(h=l==="/"?n:qi([n,l])),i.createHref({pathname:h,search:c,hash:a})}function Tl(){return A.useContext(gu)!=null}function Tn(){return Ct(Tl(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(gu).location}var bE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function vE(t){A.useContext(rr).static||A.useLayoutEffect(t)}function yu(){let{isDataRoute:t}=A.useContext(Sr);return t?QR():MR()}function MR(){Ct(Tl(),"useNavigate() may be used only in the context of a <Router> component.");let t=A.useContext(Cl),{basename:e,navigator:n}=A.useContext(rr),{matches:i}=A.useContext(Sr),{pathname:a}=Tn(),l=JSON.stringify(ry(i)),c=A.useRef(!1);return vE(()=>{c.current=!0}),A.useCallback((f,p={})=>{if(tr(c.current,bE),!c.current)return;if(typeof f=="number"){n.go(f);return}let _=iy(f,JSON.parse(l),a,p.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:qi([e,_.pathname])),(p.replace?n.replace:n.push)(_,p.state,p)},[e,n,l,a,t])}var OR=A.createContext(null);function kR(t){let e=A.useContext(Sr).outlet;return A.useMemo(()=>e&&A.createElement(OR.Provider,{value:t},e),[e,t])}function NR(){let{matches:t}=A.useContext(Sr),e=t[t.length-1];return e?e.params:{}}function _u(t,{relative:e}={}){let{matches:n}=A.useContext(Sr),{pathname:i}=Tn(),a=JSON.stringify(ry(n));return A.useMemo(()=>iy(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function PR(t,e){return xE(t,e)}function xE(t,e,n,i,a){Ct(Tl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=A.useContext(rr),{matches:c}=A.useContext(Sr),h=c[c.length-1],f=h?h.params:{},p=h?h.pathname:"/",_=h?h.pathnameBase:"/",b=h&&h.route;{let U=b&&b.path||"";EE(p,!b||U.endsWith("*")||U.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${U}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${U}"> to <Route path="${U==="/"?"*":`${U}/*`}">.`)}let v=Tn(),E;if(e){let U=typeof e=="string"?wl(e):e;Ct(_==="/"||U.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${U.pathname}" was given in the \`location\` prop.`),E=U}else E=v;let C=E.pathname||"/",w=C;if(_!=="/"){let U=_.replace(/^\//,"").split("/");w="/"+C.replace(/^\//,"").split("/").slice(U.length).join("/")}let D=uE(t,{pathname:w});tr(b||D!=null,`No routes matched location "${E.pathname}${E.search}${E.hash}" `),tr(D==null||D[D.length-1].route.element!==void 0||D[D.length-1].route.Component!==void 0||D[D.length-1].route.lazy!==void 0,`Matched leaf route at location "${E.pathname}${E.search}${E.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=zR(D&&D.map(U=>Object.assign({},U,{params:Object.assign({},f,U.params),pathname:qi([_,l.encodeLocation?l.encodeLocation(U.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:U.pathname]),pathnameBase:U.pathnameBase==="/"?_:qi([_,l.encodeLocation?l.encodeLocation(U.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:U.pathnameBase])})),c,n,i,a);return e&&N?A.createElement(gu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...E},navigationType:"POP"}},N):N}function LR(){let t=$R(),e=xR(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:l},"ErrorBoundary")," or"," ",A.createElement("code",{style:l},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:a},n):null,c)}var BR=A.createElement(LR,null),SE=class extends A.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=jR(t.digest);n&&(t=n)}let e=t!==void 0?A.createElement(Sr.Provider,{value:this.props.routeContext},A.createElement(sy.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?A.createElement(VR,{error:t},e):e}};SE.contextType=wR;var Kp=new WeakMap;function VR({children:t,error:e}){let{basename:n}=A.useContext(rr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=DR(e.digest);if(i){let a=Kp.get(e);if(a)throw a;let l=pE(i.location,n);if(mE&&!Kp.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw Kp.set(e,c),c}return A.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function UR({routeContext:t,match:e,children:n}){let i=A.useContext(Cl);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),A.createElement(Sr.Provider,{value:t},n)}function zR(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,c=n?.errors;if(c!=null){let _=l.findIndex(b=>b.route.id&&c?.[b.route.id]!==void 0);Ct(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let h=!1,f=-1;if(n)for(let _=0;_<l.length;_++){let b=l[_];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(f=_),b.route.id){let{loaderData:v,errors:E}=n,C=b.route.loader&&!v.hasOwnProperty(b.route.id)&&(!E||E[b.route.id]===void 0);if(b.route.lazy||C){h=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}let p=n&&i?(_,b)=>{i(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:SR(n.matches),errorInfo:b})}:void 0;return l.reduceRight((_,b,v)=>{let E,C=!1,w=null,D=null;n&&(E=c&&b.route.id?c[b.route.id]:void 0,w=b.route.errorElement||BR,h&&(f<0&&v===0?(EE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),C=!0,D=null):f===v&&(C=!0,D=b.route.hydrateFallbackElement||null)));let N=e.concat(l.slice(0,v+1)),U=()=>{let k;return E?k=w:C?k=D:b.route.Component?k=A.createElement(b.route.Component,null):b.route.element?k=b.route.element:k=_,A.createElement(UR,{match:b,routeContext:{outlet:_,matches:N,isDataRoute:n!=null},children:k})};return n&&(b.route.ErrorBoundary||b.route.errorElement||v===0)?A.createElement(SE,{location:n.location,revalidation:n.revalidation,component:w,error:E,children:U(),routeContext:{outlet:null,matches:N,isDataRoute:!0},onError:p}):U()},null)}function ay(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function FR(t){let e=A.useContext(Cl);return Ct(e,ay(t)),e}function qR(t){let e=A.useContext(sf);return Ct(e,ay(t)),e}function HR(t){let e=A.useContext(Sr);return Ct(e,ay(t)),e}function oy(t){let e=HR(t),n=e.matches[e.matches.length-1];return Ct(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function GR(){return oy("useRouteId")}function $R(){let t=A.useContext(sy),e=qR("useRouteError"),n=oy("useRouteError");return t!==void 0?t:e.errors?.[n]}function QR(){let{router:t}=FR("useNavigate"),e=oy("useNavigate"),n=A.useRef(!1);return vE(()=>{n.current=!0}),A.useCallback(async(a,l={})=>{tr(n.current,bE),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var Kv={};function EE(t,e,n){!e&&!Kv[t]&&(Kv[t]=!0,tr(!1,n))}A.memo(WR);function WR({routes:t,future:e,state:n,onError:i}){return xE(t,void 0,n,i,e)}function af({to:t,replace:e,state:n,relative:i}){Ct(Tl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=A.useContext(rr);tr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=A.useContext(Sr),{pathname:c}=Tn(),h=yu(),f=iy(t,ry(l),c,i==="path"),p=JSON.stringify(f);return A.useEffect(()=>{h(JSON.parse(p),{replace:e,state:n,relative:i})},[h,p,i,e,n]),null}function of(t){return kR(t.context)}function $t(t){Ct(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function KR({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){Ct(!Tl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=t.replace(/^\/*/,"/"),f=A.useMemo(()=>({basename:h,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[h,a,l,c]);typeof n=="string"&&(n=wl(n));let{pathname:p="/",search:_="",hash:b="",state:v=null,key:E="default"}=n,C=A.useMemo(()=>{let w=Gi(p,h);return w==null?null:{location:{pathname:w,search:_,hash:b,state:v,key:E},navigationType:i}},[h,p,_,b,v,E,i]);return tr(C!=null,`<Router basename="${h}"> is not able to match the URL "${p}${_}${b}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:A.createElement(rr.Provider,{value:f},A.createElement(gu.Provider,{children:e,value:C}))}function YR({children:t,location:e}){return PR(mg(t),e)}function mg(t,e=[]){let n=[];return A.Children.forEach(t,(i,a)=>{if(!A.isValidElement(i))return;let l=[...e,a];if(i.type===A.Fragment){n.push.apply(n,mg(i.props.children,l));return}Ct(i.type===$t,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ct(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=mg(i.props.children,l)),n.push(c)}),n}var bh="get",vh="application/x-www-form-urlencoded";function lf(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function XR(t){return lf(t)&&t.tagName.toLowerCase()==="button"}function JR(t){return lf(t)&&t.tagName.toLowerCase()==="form"}function ZR(t){return lf(t)&&t.tagName.toLowerCase()==="input"}function eD(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function tD(t,e){return t.button===0&&(!e||e==="_self")&&!eD(t)}function pg(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(a=>[n,a]):[[n,i]])},[]))}function nD(t,e){let n=pg(t);return e&&e.forEach((i,a)=>{n.has(a)||e.getAll(a).forEach(l=>{n.append(a,l)})}),n}var uh=null;function rD(){if(uh===null)try{new FormData(document.createElement("form"),0),uh=!1}catch{uh=!0}return uh}var iD=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Yp(t){return t!=null&&!iD.has(t)?(tr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${vh}"`),null):t}function sD(t,e){let n,i,a,l,c;if(JR(t)){let h=t.getAttribute("action");i=h?Gi(h,e):null,n=t.getAttribute("method")||bh,a=Yp(t.getAttribute("enctype"))||vh,l=new FormData(t)}else if(XR(t)||ZR(t)&&(t.type==="submit"||t.type==="image")){let h=t.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||h.getAttribute("action");if(i=f?Gi(f,e):null,n=t.getAttribute("formmethod")||h.getAttribute("method")||bh,a=Yp(t.getAttribute("formenctype"))||Yp(h.getAttribute("enctype"))||vh,l=new FormData(h,t),!rD()){let{name:p,type:_,value:b}=t;if(_==="image"){let v=p?`${p}.`:"";l.append(`${v}x`,"0"),l.append(`${v}y`,"0")}else p&&l.append(p,b)}}else{if(lf(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=bh,i=null,a=vh,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ly(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function aD(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Gi(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function oD(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function lD(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function cD(t,e,n){let i=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let c=await oD(l,n);return c.links?c.links():[]}return[]}));return fD(i.flat(1).filter(lD).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Yv(t,e,n,i,a,l){let c=(f,p)=>n[p]?f.route.id!==n[p].route.id:!0,h=(f,p)=>n[p].pathname!==f.pathname||n[p].route.path?.endsWith("*")&&n[p].params["*"]!==f.params["*"];return l==="assets"?e.filter((f,p)=>c(f,p)||h(f,p)):l==="data"?e.filter((f,p)=>{let _=i.routes[f.route.id];if(!_||!_.hasLoader)return!1;if(c(f,p)||h(f,p))return!0;if(f.route.shouldRevalidate){let b=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function uD(t,e,{includeHydrateFallback:n}={}){return dD(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function dD(t){return[...new Set(t)]}function hD(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function fD(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let l=JSON.stringify(hD(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function wE(){let t=A.useContext(Cl);return ly(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function mD(){let t=A.useContext(sf);return ly(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var cy=A.createContext(void 0);cy.displayName="FrameworkContext";function CE(){let t=A.useContext(cy);return ly(t,"You must render this element inside a <HydratedRouter> element"),t}function pD(t,e){let n=A.useContext(cy),[i,a]=A.useState(!1),[l,c]=A.useState(!1),{onFocus:h,onBlur:f,onMouseEnter:p,onMouseLeave:_,onTouchStart:b}=e,v=A.useRef(null);A.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let w=N=>{N.forEach(U=>{c(U.isIntersecting)})},D=new IntersectionObserver(w,{threshold:.5});return v.current&&D.observe(v.current),()=>{D.disconnect()}}},[t]),A.useEffect(()=>{if(i){let w=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(w)}}},[i]);let E=()=>{a(!0)},C=()=>{a(!1),c(!1)};return n?t!=="intent"?[l,v,{}]:[l,v,{onFocus:Hc(h,E),onBlur:Hc(f,C),onMouseEnter:Hc(p,E),onMouseLeave:Hc(_,C),onTouchStart:Hc(b,E)}]:[!1,v,{}]}function Hc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function gD({page:t,...e}){let{router:n}=wE(),i=A.useMemo(()=>uE(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?A.createElement(_D,{page:t,matches:i,...e}):null}function yD(t){let{manifest:e,routeModules:n}=CE(),[i,a]=A.useState([]);return A.useEffect(()=>{let l=!1;return cD(t,e,n).then(c=>{l||a(c)}),()=>{l=!0}},[t,e,n]),i}function _D({page:t,matches:e,...n}){let i=Tn(),{manifest:a,routeModules:l}=CE(),{basename:c}=wE(),{loaderData:h,matches:f}=mD(),p=A.useMemo(()=>Yv(t,e,f,a,i,"data"),[t,e,f,a,i]),_=A.useMemo(()=>Yv(t,e,f,a,i,"assets"),[t,e,f,a,i]),b=A.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let C=new Set,w=!1;if(e.forEach(N=>{let U=a.routes[N.route.id];!U||!U.hasLoader||(!p.some(k=>k.route.id===N.route.id)&&N.route.id in h&&l[N.route.id]?.shouldRevalidate||U.hasClientLoader?w=!0:C.add(N.route.id))}),C.size===0)return[];let D=aD(t,c,"data");return w&&C.size>0&&D.searchParams.set("_routes",e.filter(N=>C.has(N.route.id)).map(N=>N.route.id).join(",")),[D.pathname+D.search]},[c,h,i,a,p,e,t,l]),v=A.useMemo(()=>uD(_,a),[_,a]),E=yD(_);return A.createElement(A.Fragment,null,b.map(C=>A.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...n})),v.map(C=>A.createElement("link",{key:C,rel:"modulepreload",href:C,...n})),E.map(({key:C,link:w})=>A.createElement("link",{key:C,nonce:n.nonce,...w})))}function bD(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var vD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{vD&&(window.__reactRouterVersion="7.11.0")}catch{}function xD({basename:t,children:e,unstable_useTransitions:n,window:i}){let a=A.useRef();a.current==null&&(a.current=XA({window:i,v5Compat:!0}));let l=a.current,[c,h]=A.useState({action:l.action,location:l.location}),f=A.useCallback(p=>{n===!1?h(p):A.startTransition(()=>h(p))},[n]);return A.useLayoutEffect(()=>l.listen(f),[l,f]),A.createElement(KR,{basename:t,children:e,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:n})}var TE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tt=A.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,state:h,target:f,to:p,preventScrollReset:_,viewTransition:b,unstable_defaultShouldRevalidate:v,...E},C){let{basename:w,unstable_useTransitions:D}=A.useContext(rr),N=typeof p=="string"&&TE.test(p),U=pE(p,w);p=U.to;let k=IR(p,{relative:a}),[X,G,K]=pD(i,E),O=CD(p,{replace:c,state:h,target:f,preventScrollReset:_,relative:a,viewTransition:b,unstable_defaultShouldRevalidate:v,unstable_useTransitions:D});function R(I){e&&e(I),I.defaultPrevented||O(I)}let j=A.createElement("a",{...E,...K,href:U.absoluteURL||k,onClick:U.isExternal||l?e:R,ref:bD(C,G),target:f,"data-discover":!N&&n==="render"?"true":void 0});return X&&!N?A.createElement(A.Fragment,null,j,A.createElement(gD,{page:k})):j});Tt.displayName="Link";var SD=A.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:h,children:f,...p},_){let b=_u(c,{relative:p.relative}),v=Tn(),E=A.useContext(sf),{navigator:C,basename:w}=A.useContext(rr),D=E!=null&&ID(b)&&h===!0,N=C.encodeLocation?C.encodeLocation(b).pathname:b.pathname,U=v.pathname,k=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;n||(U=U.toLowerCase(),k=k?k.toLowerCase():null,N=N.toLowerCase()),k&&w&&(k=Gi(k,w)||k);const X=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let G=U===N||!a&&U.startsWith(N)&&U.charAt(X)==="/",K=k!=null&&(k===N||!a&&k.startsWith(N)&&k.charAt(N.length)==="/"),O={isActive:G,isPending:K,isTransitioning:D},R=G?e:void 0,j;typeof i=="function"?j=i(O):j=[i,G?"active":null,K?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let I=typeof l=="function"?l(O):l;return A.createElement(Tt,{...p,"aria-current":R,className:j,ref:_,style:I,to:c,viewTransition:h},typeof f=="function"?f(O):f)});SD.displayName="NavLink";var ED=A.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:l,method:c=bh,action:h,onSubmit:f,relative:p,preventScrollReset:_,viewTransition:b,unstable_defaultShouldRevalidate:v,...E},C)=>{let{unstable_useTransitions:w}=A.useContext(rr),D=DD(),N=jD(h,{relative:p}),U=c.toLowerCase()==="get"?"get":"post",k=typeof h=="string"&&TE.test(h),X=G=>{if(f&&f(G),G.defaultPrevented)return;G.preventDefault();let K=G.nativeEvent.submitter,O=K?.getAttribute("formmethod")||c,R=()=>D(K||G.currentTarget,{fetcherKey:e,method:O,navigate:n,replace:a,state:l,relative:p,preventScrollReset:_,viewTransition:b,unstable_defaultShouldRevalidate:v});w&&n!==!1?A.startTransition(()=>R()):R()};return A.createElement("form",{ref:C,method:U,action:N,onSubmit:i?f:X,...E,"data-discover":!k&&t==="render"?"true":void 0})});ED.displayName="Form";function wD(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AE(t){let e=A.useContext(Cl);return Ct(e,wD(t)),e}function CD(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:h,unstable_useTransitions:f}={}){let p=yu(),_=Tn(),b=_u(t,{relative:l});return A.useCallback(v=>{if(tD(v,e)){v.preventDefault();let E=n!==void 0?n:ru(_)===ru(b),C=()=>p(t,{replace:E,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:h});f?A.startTransition(()=>C()):C()}},[_,p,b,n,i,e,t,a,l,c,h,f])}function TD(t){tr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=A.useRef(pg(t)),n=A.useRef(!1),i=Tn(),a=A.useMemo(()=>nD(i.search,n.current?null:e.current),[i.search]),l=yu(),c=A.useCallback((h,f)=>{const p=pg(typeof h=="function"?h(new URLSearchParams(a)):h);n.current=!0,l("?"+p,f)},[l,a]);return[a,c]}var AD=0,RD=()=>`__${String(++AD)}__`;function DD(){let{router:t}=AE("useSubmit"),{basename:e}=A.useContext(rr),n=GR(),i=t.fetch,a=t.navigate;return A.useCallback(async(l,c={})=>{let{action:h,method:f,encType:p,formData:_,body:b}=sD(l,e);if(c.navigate===!1){let v=c.fetcherKey||RD();await i(v,n,c.action||h,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:b,formMethod:c.method||f,formEncType:c.encType||p,flushSync:c.flushSync})}else await a(c.action||h,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:_,body:b,formMethod:c.method||f,formEncType:c.encType||p,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,e,n])}function jD(t,{relative:e}={}){let{basename:n}=A.useContext(rr),i=A.useContext(Sr);Ct(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={..._u(t||".",{relative:e})},c=Tn();if(t==null){l.search=c.search;let h=new URLSearchParams(l.search),f=h.getAll("index");if(f.some(_=>_==="")){h.delete("index"),f.filter(b=>b).forEach(b=>h.append("index",b));let _=h.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:qi([n,l.pathname])),ru(l)}function ID(t,{relative:e}={}){let n=A.useContext(yE);Ct(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=AE("useViewTransitionState"),a=_u(t,{relative:e});if(!n.isTransitioning)return!1;let l=Gi(n.currentLocation.pathname,i)||n.currentLocation.pathname,c=Gi(n.nextLocation.pathname,i)||n.nextLocation.pathname;return Mh(a.pathname,c)!=null||Mh(a.pathname,l)!=null}const MD={isLoading:!1,loadingMessage:"Loading...",addLoadingHold:()=>{},removeLoadingHold:()=>{}},RE=A.createContext(MD);function OD({children:t}){const[e,n]=A.useState(new Map),i=A.useCallback((f,p)=>{n(_=>new Map(_).set(f,p))},[]),a=A.useCallback(f=>{n(p=>{const _=new Map(p);return _.delete(f),_})},[]),l=e.size>0,c=e.size>0&&Array.from(e.values()).pop()||"Loading...",h={isLoading:l,loadingMessage:c,addLoadingHold:i,removeLoadingHold:a};return u.jsx(RE.Provider,{value:h,children:t})}function qn(){const t=A.useContext(RE);if(!t)throw new Error("useApp must be used within an AppProvider");return t}const kD=function(){},ND={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:kD},bu=A.createContext(ND);var Al=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},PD={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},LD=class{#e=PD;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Vi=new LD;function BD(t){setTimeout(t,0)}var Fa=typeof window>"u"||"Deno"in globalThis;function tn(){}function VD(t,e){return typeof t=="function"?t(e):t}function gg(t){return typeof t=="number"&&t>=0&&t!==1/0}function DE(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Vs(t,e){return typeof t=="function"?t(e):t}function _r(t,e){return typeof t=="function"?t(e):t}function Xv(t,e){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:c,stale:h}=t;if(c){if(i){if(e.queryHash!==uy(c,e.options))return!1}else if(!iu(e.queryKey,c))return!1}if(n!=="all"){const f=e.isActive();if(n==="active"&&!f||n==="inactive"&&f)return!1}return!(typeof h=="boolean"&&e.isStale()!==h||a&&a!==e.state.fetchStatus||l&&!l(e))}function Jv(t,e){const{exact:n,status:i,predicate:a,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(qa(e.options.mutationKey)!==qa(l))return!1}else if(!iu(e.options.mutationKey,l))return!1}return!(i&&e.state.status!==i||a&&!a(e))}function uy(t,e){return(e?.queryKeyHashFn||qa)(t)}function qa(t){return JSON.stringify(t,(e,n)=>yg(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function iu(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>iu(t[n],e[n])):!1}var UD=Object.prototype.hasOwnProperty;function jE(t,e){if(t===e)return t;const n=Zv(t)&&Zv(e);if(!n&&!(yg(t)&&yg(e)))return e;const a=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),c=l.length,h=n?new Array(c):{};let f=0;for(let p=0;p<c;p++){const _=n?p:l[p],b=t[_],v=e[_];if(b===v){h[_]=b,(n?p<a:UD.call(t,_))&&f++;continue}if(b===null||v===null||typeof b!="object"||typeof v!="object"){h[_]=v;continue}const E=jE(b,v);h[_]=E,E===b&&f++}return a===c&&f===a?t:h}function Oh(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Zv(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function yg(t){if(!ex(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!ex(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function ex(t){return Object.prototype.toString.call(t)==="[object Object]"}function zD(t){return new Promise(e=>{Vi.setTimeout(e,t)})}function _g(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?jE(t,e):e}function FD(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function qD(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var dy=Symbol();function IE(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===dy?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function ME(t,e){return typeof t=="function"?t(...e):!!t}var HD=class extends Al{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!Fa&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},hy=new HD;function bg(){let t,e;const n=new Promise((a,l)=>{t=a,e=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),e(a)},n}function GD(t){let e;if(t.then(n=>(e=n,n),tn)?.catch(tn),e!==void 0)return{data:e}}function OE(t){return t}function $D(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function QD(t,e,n){const i=()=>{const a=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return a?.catch(tn),a};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:i()},...t.meta&&{meta:t.meta}}}function WD(t){return t.state.isPaused}function KD(t){return t.state.status==="success"}function YD(t){return!0}function XD(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??WD,i=t.getMutationCache().getAll().flatMap(f=>n(f)?[$D(f)]:[]),a=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??KD,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??YD,c=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??OE,h=t.getQueryCache().getAll().flatMap(f=>a(f)?[QD(f,c,l)]:[]);return{mutations:i,queries:h}}function JD(t,e,n){if(typeof e!="object"||e===null)return;const i=t.getMutationCache(),a=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??OE,c=e.mutations||[],h=e.queries||[];c.forEach(({state:f,...p})=>{i.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...p},f)}),h.forEach(({queryKey:f,state:p,queryHash:_,meta:b,promise:v,dehydratedAt:E})=>{const C=v?GD(v):void 0,w=p.data===void 0?C?.data:p.data,D=w===void 0?w:l(w);let N=a.get(_);const U=N?.state.status==="pending",k=N?.state.fetchStatus==="fetching";if(N){const X=C&&E!==void 0&&E>N.state.dataUpdatedAt;if(p.dataUpdatedAt>N.state.dataUpdatedAt||X){const{fetchStatus:G,...K}=p;N.setState({...K,data:D})}}else N=a.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:f,queryHash:_,meta:b},{...p,data:D,fetchStatus:"idle",status:D!==void 0?"success":p.status});v&&!U&&!k&&(E===void 0||E>N.state.dataUpdatedAt)&&N.fetch(void 0,{initialPromise:Promise.resolve(v).then(l)}).catch(tn)})}var ZD=BD;function ej(){let t=[],e=0,n=h=>{h()},i=h=>{h()},a=ZD;const l=h=>{e?t.push(h):a(()=>{n(h)})},c=()=>{const h=t;t=[],h.length&&a(()=>{i(()=>{h.forEach(f=>{n(f)})})})};return{batch:h=>{let f;e++;try{f=h()}finally{e--,e||c()}return f},batchCalls:h=>(...f)=>{l(()=>{h(...f)})},schedule:l,setNotifyFunction:h=>{n=h},setBatchNotifyFunction:h=>{i=h},setScheduler:h=>{a=h}}}var nn=ej(),tj=class extends Al{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!Fa&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},kh=new tj;function nj(t){return Math.min(1e3*2**t,3e4)}function kE(t){return(t??"online")==="online"?kh.isOnline():!0}var vg=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function NE(t){let e=!1,n=0,i;const a=bg(),l=()=>a.status!=="pending",c=w=>{if(!l()){const D=new vg(w);v(D),t.onCancel?.(D)}},h=()=>{e=!0},f=()=>{e=!1},p=()=>hy.isFocused()&&(t.networkMode==="always"||kh.isOnline())&&t.canRun(),_=()=>kE(t.networkMode)&&t.canRun(),b=w=>{l()||(i?.(),a.resolve(w))},v=w=>{l()||(i?.(),a.reject(w))},E=()=>new Promise(w=>{i=D=>{(l()||p())&&w(D)},t.onPause?.()}).then(()=>{i=void 0,l()||t.onContinue?.()}),C=()=>{if(l())return;let w;const D=n===0?t.initialPromise:void 0;try{w=D??t.fn()}catch(N){w=Promise.reject(N)}Promise.resolve(w).then(b).catch(N=>{if(l())return;const U=t.retry??(Fa?0:3),k=t.retryDelay??nj,X=typeof k=="function"?k(n,N):k,G=U===!0||typeof U=="number"&&n<U||typeof U=="function"&&U(n,N);if(e||!G){v(N);return}n++,t.onFail?.(n,N),zD(X).then(()=>p()?void 0:E()).then(()=>{e?v(N):C()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(i?.(),a),cancelRetry:h,continueRetry:f,canStart:_,start:()=>(_()?C():E().then(C),a)}}var PE=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),gg(this.gcTime)&&(this.#e=Vi.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Fa?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Vi.clearTimeout(this.#e),this.#e=void 0)}},rj=class extends PE{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=nx(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=nx(this.options);n.data!==void 0&&(this.setState(tx(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const i=_g(this.state.data,e,this.options);return this.#s({data:i,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),i}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then(tn).catch(tn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>_r(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===dy||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Vs(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!DE(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const i=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(this.#o=!0,i.signal)})},l=()=>{const f=IE(this.options,n),_=(()=>{const b={client:this.#i,queryKey:this.queryKey,meta:this.meta};return a(b),b})();return this.#o=!1,this.options.persister?this.options.persister(f,_,this):f(_)},h=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return a(f),f})();this.options.behavior?.onFetch(h,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==h.fetchOptions?.meta)&&this.#s({type:"fetch",meta:h.fetchOptions?.meta}),this.#r=NE({initialPromise:n?.initialPromise,fn:h.fetchFn,onCancel:f=>{f instanceof vg&&f.revert&&this.setState({...this.#t,fetchStatus:"idle"}),i.abort()},onFail:(f,p)=>{this.#s({type:"failed",failureCount:f,error:p})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0});try{const f=await this.#r.start();if(f===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(f),this.#n.config.onSuccess?.(f,this),this.#n.config.onSettled?.(f,this.state.error,this),f}catch(f){if(f instanceof vg){if(f.silent)return this.#r.promise;if(f.revert){if(this.state.data===void 0)throw f;return this.state.data}}throw this.#s({type:"error",error:f}),this.#n.config.onError?.(f,this),this.#n.config.onSettled?.(this.state.data,f,this),f}finally{this.scheduleGc()}}#s(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...LE(i.data,this.options),fetchMeta:e.meta??null};case"success":const a={...i,...tx(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const l=e.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),nn.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function LE(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:kE(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function tx(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function nx(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var ij=class extends Al{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=bg(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),rx(this.#t,this.options)?this.#d():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return xg(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return xg(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#v(),this.#x(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof _r(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#S(),this.#t.setOptions(this.options),e._defaulted&&!Oh(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&ix(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),i&&(this.#t!==n||_r(this.options.enabled,this.#t)!==_r(e.enabled,this.#t)||Vs(this.options.staleTime,this.#t)!==Vs(e.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||_r(this.options.enabled,this.#t)!==_r(e.enabled,this.#t)||a!==this.#l)&&this.#_(a)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return aj(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),e?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#S();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(tn)),e}#g(){this.#v();const t=Vs(this.options.staleTime,this.#t);if(Fa||this.#i.isStale||!gg(t))return;const n=DE(this.#i.dataUpdatedAt,t)+1;this.#c=Vi.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#x(),this.#l=t,!(Fa||_r(this.options.enabled,this.#t)===!1||!gg(this.#l)||this.#l===0)&&(this.#u=Vi.setInterval(()=>{(this.options.refetchIntervalInBackground||hy.isFocused())&&this.#d()},this.#l))}#b(){this.#g(),this.#_(this.#y())}#v(){this.#c&&(Vi.clearTimeout(this.#c),this.#c=void 0)}#x(){this.#u&&(Vi.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,i=this.options,a=this.#i,l=this.#r,c=this.#a,f=t!==n?t.state:this.#n,{state:p}=t;let _={...p},b=!1,v;if(e._optimisticResults){const R=this.hasListeners(),j=!R&&rx(t,e),I=R&&ix(t,n,e,i);(j||I)&&(_={..._,...LE(p.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:E,errorUpdatedAt:C,status:w}=_;v=_.data;let D=!1;if(e.placeholderData!==void 0&&v===void 0&&w==="pending"){let R;a?.isPlaceholderData&&e.placeholderData===c?.placeholderData?(R=a.data,D=!0):R=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,R!==void 0&&(w="success",v=_g(a?.data,R,e),b=!0)}if(e.select&&v!==void 0&&!D)if(a&&v===l?.data&&e.select===this.#p)v=this.#h;else try{this.#p=e.select,v=e.select(v),v=_g(a?.data,v,e),this.#h=v,this.#s=null}catch(R){this.#s=R}this.#s&&(E=this.#s,v=this.#h,C=Date.now(),w="error");const N=_.fetchStatus==="fetching",U=w==="pending",k=w==="error",X=U&&N,G=v!==void 0,O={status:w,fetchStatus:_.fetchStatus,isPending:U,isSuccess:w==="success",isError:k,isInitialLoading:X,isLoading:X,data:v,dataUpdatedAt:_.dataUpdatedAt,error:E,errorUpdatedAt:C,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>f.dataUpdateCount||_.errorUpdateCount>f.errorUpdateCount,isFetching:N,isRefetching:N&&!U,isLoadingError:k&&!G,isPaused:_.fetchStatus==="paused",isPlaceholderData:b,isRefetchError:k&&G,isStale:fy(t,e),refetch:this.refetch,promise:this.#o,isEnabled:_r(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const R=M=>{O.status==="error"?M.reject(O.error):O.data!==void 0&&M.resolve(O.data)},j=()=>{const M=this.#o=O.promise=bg();R(M)},I=this.#o;switch(I.status){case"pending":t.queryHash===n.queryHash&&R(I);break;case"fulfilled":(O.status==="error"||O.data!==I.value)&&j();break;case"rejected":(O.status!=="error"||O.error!==I.reason)&&j();break}}return O}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),Oh(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(c=>{const h=c;return this.#i[h]!==t[h]&&l.has(h)})};this.#E({listeners:n()})}#S(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#E(t){nn.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function sj(t,e){return _r(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function rx(t,e){return sj(t,e)||t.state.data!==void 0&&xg(t,e,e.refetchOnMount)}function xg(t,e,n){if(_r(e.enabled,t)!==!1&&Vs(e.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&fy(t,e)}return!1}function ix(t,e,n,i){return(t!==e||_r(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&fy(t,n)}function fy(t,e){return _r(e.enabled,t)!==!1&&t.isStaleByTime(Vs(e.staleTime,t))}function aj(t,e){return!Oh(t.getCurrentResult(),e)}function sx(t){return{onFetch:(e,n)=>{const i=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],c=e.state.data?.pageParams||[];let h={pages:[],pageParams:[]},f=0;const p=async()=>{let _=!1;const b=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},v=IE(e.options,e.fetchOptions),E=async(C,w,D)=>{if(_)return Promise.reject();if(w==null&&C.pages.length)return Promise.resolve(C);const U=(()=>{const K={client:e.client,queryKey:e.queryKey,pageParam:w,direction:D?"backward":"forward",meta:e.options.meta};return b(K),K})(),k=await v(U),{maxPages:X}=e.options,G=D?qD:FD;return{pages:G(C.pages,k,X),pageParams:G(C.pageParams,w,X)}};if(a&&l.length){const C=a==="backward",w=C?oj:ax,D={pages:l,pageParams:c},N=w(i,D);h=await E(D,N,C)}else{const C=t??l.length;do{const w=f===0?c[0]??i.initialPageParam:ax(i,h);if(f>0&&w==null)break;h=await E(h,w),f++}while(f<C)}return h};e.options.persister?e.fetchFn=()=>e.options.persister?.(p,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=p}}}function ax(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function oj(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var lj=class extends PE{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||BE(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=NE({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(c,h)=>{this.#r({type:"failed",failureCount:c,error:h})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",l=!this.#i.canStart();try{if(a)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,i);const h=await this.options.onMutate?.(e,i);h!==this.state.context&&this.#r({type:"pending",context:h,variables:e,isPaused:l})}const c=await this.#i.start();return await this.#n.config.onSuccess?.(c,e,this.state.context,this,i),await this.options.onSuccess?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(c,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(c,null,e,this.state.context,i),this.#r({type:"success",data:c}),c}catch(c){try{throw await this.#n.config.onError?.(c,e,this.state.context,this,i),await this.options.onError?.(c,e,this.state.context,i),await this.#n.config.onSettled?.(void 0,c,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,c,e,this.state.context,i),c}finally{this.#r({type:"error",error:c})}}finally{this.#n.runNext(this)}}#r(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),nn.batch(()=>{this.#t.forEach(i=>{i.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function BE(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var cj=class extends Al{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const i=new lj({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){this.#e.add(t);const e=dh(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=dh(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=dh(t);if(typeof e=="string"){const i=this.#t.get(e)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const e=dh(t);return typeof e=="string"?this.#t.get(e)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){nn.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Jv(e,n))}findAll(t={}){return this.getAll().filter(e=>Jv(t,e))}notify(t){nn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return nn.batch(()=>Promise.all(t.map(e=>e.continue().catch(tn))))}};function dh(t){return t.options.scope?.id}var uj=class extends Al{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),Oh(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&qa(n.mutationKey)!==qa(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??BE();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){nn.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,i,a),this.#i.onSettled?.(e.data,null,n,i,a)):e?.type==="error"&&(this.#i.onError?.(e.error,n,i,a),this.#i.onSettled?.(void 0,e.error,n,i,a))}this.listeners.forEach(n=>{n(this.#t)})})}},dj=class extends Al{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const i=e.queryKey,a=e.queryHash??uy(i,e);let l=this.get(a);return l||(l=new rj({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){nn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Xv(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>Xv(t,n)):e}notify(t){nn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){nn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){nn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},hj=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new dj,this.#t=t.mutationCache||new cj,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=hy.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=kh.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Vs(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(i.queryHash)?.state.data,c=VD(e,l);if(c!==void 0)return this.#e.build(this,i).setData(c,{...n,manual:!0})}setQueriesData(t,e,n){return nn.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;nn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return nn.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=nn.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then(tn).catch(tn)}invalidateQueries(t,e={}){return nn.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=nn.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(tn)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(tn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Vs(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(tn).catch(tn)}fetchInfiniteQuery(t){return t.behavior=sx(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(tn).catch(tn)}ensureInfiniteQueryData(t){return t.behavior=sx(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return kh.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(qa(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(i=>{iu(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(qa(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(i=>{iu(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=uy(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===dy&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},VE=A.createContext(void 0),sn=t=>{const e=A.useContext(VE);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},fj=({client:t,children:e})=>(A.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),u.jsx(VE.Provider,{value:t,children:e})),UE=A.createContext(!1),mj=()=>A.useContext(UE),pj=UE.Provider;function gj(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var yj=A.createContext(gj()),_j=()=>A.useContext(yj),bj=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},vj=t=>{A.useEffect(()=>{t.clearReset()},[t])},xj=({result:t,errorResetBoundary:e,throwOnError:n,query:i,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||ME(n,[t.error,i])),Sj=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},Ej=(t,e)=>t.isLoading&&t.isFetching&&!e,wj=(t,e)=>t?.suspense&&e.isPending,ox=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function Cj(t,e,n){const i=mj(),a=_j(),l=sn(),c=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c),c._optimisticResults=i?"isRestoring":"optimistic",Sj(c),bj(c,a),vj(a);const h=!l.getQueryCache().get(c.queryHash),[f]=A.useState(()=>new e(l,c)),p=f.getOptimisticResult(c),_=!i&&t.subscribed!==!1;if(A.useSyncExternalStore(A.useCallback(b=>{const v=_?f.subscribe(nn.batchCalls(b)):tn;return f.updateResult(),v},[f,_]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),A.useEffect(()=>{f.setOptions(c)},[c,f]),wj(c,p))throw ox(c,f,a);if(xj({result:p,errorResetBoundary:a,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw p.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,p),c.experimental_prefetchInRender&&!Fa&&Ej(p,i)&&(h?ox(c,f,a):l.getQueryCache().get(c.queryHash)?.promise)?.catch(tn).finally(()=>{f.updateResult()}),c.notifyOnChangeProps?p:f.trackResult(p)}function Rl(t,e){return Cj(t,ij)}function ir(t,e){const n=sn(),[i]=A.useState(()=>new uj(n,t));A.useEffect(()=>{i.setOptions(t)},[i,t]);const a=A.useSyncExternalStore(A.useCallback(c=>i.subscribe(nn.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=A.useCallback((c,h)=>{i.mutate(c,h).catch(tn)},[i]);if(a.error&&ME(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}function Sg(){}function Tj(t,{interval:e=1e3,onError:n=Sg}={}){if(typeof t!="function")throw new Error("argument is not function.");let i=0,a=null,l=!1,c=!1;return async(...h)=>{if(a=h,!c){for(c=!0;l;)await new Promise(f=>Vi.setTimeout(f,e));for(;Date.now()<i;)await new Promise(f=>Vi.setTimeout(f,i-Date.now()));c=!1,l=!0;try{await t(...a)}catch(f){try{n(f)}catch{}}i=Date.now()+e,l=!1}}}var Aj=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:i=JSON.stringify,deserialize:a=JSON.parse,retry:l})=>{if(t){const c=async h=>{try{const f=await i(h);await t.setItem(e,f);return}catch(f){return f}};return{persistClient:Tj(async h=>{let f=h,p=await c(f),_=0;for(;p&&f;)_++,f=await l?.({persistedClient:f,error:p,errorCount:_}),f&&(p=await c(f))},{interval:n}),restoreClient:async()=>{const h=await t.getItem(e);if(h)return await a(h)},removeClient:()=>t.removeItem(e)}}return{persistClient:Sg,restoreClient:()=>Promise.resolve(void 0),removeClient:Sg}};const zE=300*1e3,Rj=1440*60*1e3,$e=new hj({defaultOptions:{queries:{staleTime:zE,gcTime:Rj,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}});$e.getQueryCache().subscribe(t=>{const e=t?.query;if(e&&t.type==="updated"){const{state:n}=e;n.status==="error"&&n.error&&console.error("[RQ] Query FAILED:",e.queryKey,n.error)}});const Dj=Aj({storage:typeof window<"u"?{getItem:t=>Promise.resolve(localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(localStorage.removeItem(t))}:void 0,key:"BUDGET_APP_QUERY_CACHE"}),xe={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};var jj=["added","removed","updated"];function lx(t){return jj.includes(t)}async function Ij({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:i="",hydrateOptions:a}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const c=Date.now()-l.timestamp>n,h=l.buster!==i;if(c||h)return e.removeClient();JD(t,l.clientState,a)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function cx({queryClient:t,persister:e,buster:n="",dehydrateOptions:i}){const a={buster:n,timestamp:Date.now(),clientState:XD(t,i)};await e.persistClient(a)}function Mj(t){const e=t.queryClient.getQueryCache().subscribe(i=>{lx(i.type)&&cx(t)}),n=t.queryClient.getMutationCache().subscribe(i=>{lx(i.type)&&cx(t)});return()=>{e(),n()}}var Oj=({children:t,persistOptions:e,onSuccess:n,onError:i,...a})=>{const[l,c]=A.useState(!0),h=A.useRef({persistOptions:e,onSuccess:n,onError:i}),f=A.useRef(!1);return A.useEffect(()=>{h.current={persistOptions:e,onSuccess:n,onError:i}}),A.useEffect(()=>{const p={...h.current.persistOptions,queryClient:a.client};return f.current||(f.current=!0,Ij(p).then(()=>h.current.onSuccess?.()).catch(()=>h.current.onError?.()).finally(()=>{c(!1)})),l?void 0:Mj(p)},[a.client,l]),u.jsx(fj,{...a,children:u.jsx(pj,{value:l,children:t})})};function kj({children:t}){return u.jsx(Oj,{client:$e,persistOptions:{persister:Dj,maxAge:1440*60*1e3,buster:"v1"},children:t})}const Nj=()=>{};var ux={};const FE=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},Pj=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],c=t[n++],h=t[n++],f=((a&7)<<18|(l&63)<<12|(c&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const l=t[n++],c=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},qE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],c=a+1<t.length,h=c?t[a+1]:0,f=a+2<t.length,p=f?t[a+2]:0,_=l>>2,b=(l&3)<<4|h>>4;let v=(h&15)<<2|p>>6,E=p&63;f||(E=64,c||(v=64)),i.push(n[_],n[b],n[v],n[E])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(FE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Pj(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],h=a<t.length?n[t.charAt(a)]:0;++a;const p=a<t.length?n[t.charAt(a)]:64;++a;const b=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||h==null||p==null||b==null)throw new Lj;const v=l<<2|h>>4;if(i.push(v),p!==64){const E=h<<4&240|p>>2;if(i.push(E),b!==64){const C=p<<6&192|b;i.push(C)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Lj extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Bj=function(t){const e=FE(t);return qE.encodeByteArray(e,!0)},Nh=function(t){return Bj(t).replace(/\./g,"")},HE=function(t){try{return qE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Vj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Uj=()=>Vj().__FIREBASE_DEFAULTS__,zj=()=>{if(typeof process>"u"||typeof ux>"u")return;const t=ux.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Fj=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&HE(t[1]);return e&&JSON.parse(e)},cf=()=>{try{return Nj()||Uj()||zj()||Fj()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},GE=t=>cf()?.emulatorHosts?.[t],qj=t=>{const e=GE(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},$E=()=>cf()?.config,QE=t=>cf()?.[`_${t}`];class Hj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function Dl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function WE(t){return(await fetch(t,{credentials:"include"})).ok}function Gj(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Nh(JSON.stringify(n)),Nh(JSON.stringify(c)),""].join(".")}const Xc={};function $j(){const t={prod:[],emulator:[]};for(const e of Object.keys(Xc))Xc[e]?t.emulator.push(e):t.prod.push(e);return t}function Qj(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let dx=!1;function KE(t,e){if(typeof window>"u"||typeof document>"u"||!Dl(window.location.host)||Xc[t]===e||Xc[t]||dx)return;Xc[t]=e;function n(v){return`__firebase__banner__${v}`}const i="__firebase__banner",l=$j().prod.length>0;function c(){const v=document.getElementById(i);v&&v.remove()}function h(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function f(v,E){v.setAttribute("width","24"),v.setAttribute("id",E),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function p(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{dx=!0,c()},v}function _(v,E){v.setAttribute("id",E),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function b(){const v=Qj(i),E=n("text"),C=document.getElementById(E)||document.createElement("span"),w=n("learnmore"),D=document.getElementById(w)||document.createElement("a"),N=n("preprendIcon"),U=document.getElementById(N)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const k=v.element;h(k),_(D,w);const X=p();f(U,N),k.append(U,C,D,X),document.body.appendChild(k)}l?(C.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}function Cn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Wj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Cn())}function Kj(){const t=cf()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Yj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Xj(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Jj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Zj(){const t=Cn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function eI(){return!Kj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function tI(){try{return typeof indexedDB=="object"}catch{return!1}}function nI(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const rI="FirebaseError";class Yi extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=rI,Object.setPrototypeOf(this,Yi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vu.prototype.create)}}class vu{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?iI(l,i):"Error",h=`${this.serviceName}: ${c} (${a}).`;return new Yi(a,h,i)}}function iI(t,e){return t.replace(sI,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const sI=/\{\$([^}]+)}/g;function aI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function $s(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],c=e[a];if(hx(l)&&hx(c)){if(!$s(l,c))return!1}else if(l!==c)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function hx(t){return t!==null&&typeof t=="object"}function xu(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Gc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function $c(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function oI(t,e){const n=new lI(t,e);return n.subscribe.bind(n)}class lI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");cI(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=Xp),a.error===void 0&&(a.error=Xp),a.complete===void 0&&(a.complete=Xp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Xp(){}function Xt(t){return t&&t._delegate?t._delegate:t}class Ha{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const La="[DEFAULT]";class uI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new Hj;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hI(e))try{this.getOrInitializeService({instanceIdentifier:La})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=La){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=La){return this.instances.has(e)}getOptions(e=La){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(l);i===h&&c.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:dI(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=La){return this.component?this.component.multipleInstances?e:La:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function dI(t){return t===La?void 0:t}function hI(t){return t.instantiationMode==="EAGER"}class fI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new uI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Xe||(Xe={}));const mI={debug:Xe.DEBUG,verbose:Xe.VERBOSE,info:Xe.INFO,warn:Xe.WARN,error:Xe.ERROR,silent:Xe.SILENT},pI=Xe.INFO,gI={[Xe.DEBUG]:"log",[Xe.VERBOSE]:"log",[Xe.INFO]:"info",[Xe.WARN]:"warn",[Xe.ERROR]:"error"},yI=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=gI[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class my{constructor(e){this.name=e,this._logLevel=pI,this._logHandler=yI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xe.DEBUG,...e),this._logHandler(this,Xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xe.VERBOSE,...e),this._logHandler(this,Xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xe.INFO,...e),this._logHandler(this,Xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xe.WARN,...e),this._logHandler(this,Xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xe.ERROR,...e),this._logHandler(this,Xe.ERROR,...e)}}const _I=(t,e)=>e.some(n=>t instanceof n);let fx,mx;function bI(){return fx||(fx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vI(){return mx||(mx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const YE=new WeakMap,Eg=new WeakMap,XE=new WeakMap,Jp=new WeakMap,py=new WeakMap;function xI(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",c)},l=()=>{n(Us(t.result)),a()},c=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",c)});return e.then(n=>{n instanceof IDBCursor&&YE.set(n,t)}).catch(()=>{}),py.set(e,t),e}function SI(t){if(Eg.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",c),t.removeEventListener("abort",c)},l=()=>{n(),a()},c=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",c),t.addEventListener("abort",c)});Eg.set(t,e)}let wg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Eg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||XE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Us(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function EI(t){wg=t(wg)}function wI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(Zp(this),e,...n);return XE.set(i,e.sort?e.sort():[e]),Us(i)}:vI().includes(t)?function(...e){return t.apply(Zp(this),e),Us(YE.get(this))}:function(...e){return Us(t.apply(Zp(this),e))}}function CI(t){return typeof t=="function"?wI(t):(t instanceof IDBTransaction&&SI(t),_I(t,bI())?new Proxy(t,wg):t)}function Us(t){if(t instanceof IDBRequest)return xI(t);if(Jp.has(t))return Jp.get(t);const e=CI(t);return e!==t&&(Jp.set(t,e),py.set(e,t)),e}const Zp=t=>py.get(t);function TI(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const c=indexedDB.open(t,e),h=Us(c);return i&&c.addEventListener("upgradeneeded",f=>{i(Us(c.result),f.oldVersion,f.newVersion,Us(c.transaction),f)}),n&&c.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),h.then(f=>{l&&f.addEventListener("close",()=>l()),a&&f.addEventListener("versionchange",p=>a(p.oldVersion,p.newVersion,p))}).catch(()=>{}),h}const AI=["get","getKey","getAll","getAllKeys","count"],RI=["put","add","delete","clear"],eg=new Map;function px(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(eg.get(e))return eg.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=RI.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||AI.includes(n)))return;const l=async function(c,...h){const f=this.transaction(c,a?"readwrite":"readonly");let p=f.store;return i&&(p=p.index(h.shift())),(await Promise.all([p[n](...h),a&&f.done]))[0]};return eg.set(e,l),l}EI(t=>({...t,get:(e,n,i)=>px(e,n)||t.get(e,n,i),has:(e,n)=>!!px(e,n)||t.has(e,n)}));class DI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(jI(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function jI(t){return t.getComponent()?.type==="VERSION"}const Cg="@firebase/app",gx="0.14.6";const $i=new my("@firebase/app"),II="@firebase/app-compat",MI="@firebase/analytics-compat",OI="@firebase/analytics",kI="@firebase/app-check-compat",NI="@firebase/app-check",PI="@firebase/auth",LI="@firebase/auth-compat",BI="@firebase/database",VI="@firebase/data-connect",UI="@firebase/database-compat",zI="@firebase/functions",FI="@firebase/functions-compat",qI="@firebase/installations",HI="@firebase/installations-compat",GI="@firebase/messaging",$I="@firebase/messaging-compat",QI="@firebase/performance",WI="@firebase/performance-compat",KI="@firebase/remote-config",YI="@firebase/remote-config-compat",XI="@firebase/storage",JI="@firebase/storage-compat",ZI="@firebase/firestore",e5="@firebase/ai",t5="@firebase/firestore-compat",n5="firebase",r5="12.6.0";const Tg="[DEFAULT]",i5={[Cg]:"fire-core",[II]:"fire-core-compat",[OI]:"fire-analytics",[MI]:"fire-analytics-compat",[NI]:"fire-app-check",[kI]:"fire-app-check-compat",[PI]:"fire-auth",[LI]:"fire-auth-compat",[BI]:"fire-rtdb",[VI]:"fire-data-connect",[UI]:"fire-rtdb-compat",[zI]:"fire-fn",[FI]:"fire-fn-compat",[qI]:"fire-iid",[HI]:"fire-iid-compat",[GI]:"fire-fcm",[$I]:"fire-fcm-compat",[QI]:"fire-perf",[WI]:"fire-perf-compat",[KI]:"fire-rc",[YI]:"fire-rc-compat",[XI]:"fire-gcs",[JI]:"fire-gcs-compat",[ZI]:"fire-fst",[t5]:"fire-fst-compat",[e5]:"fire-vertex","fire-js":"fire-js",[n5]:"fire-js-all"};const Ph=new Map,s5=new Map,Ag=new Map;function yx(t,e){try{t.container.addComponent(e)}catch(n){$i.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function fl(t){const e=t.name;if(Ag.has(e))return $i.debug(`There were multiple attempts to register component ${e}.`),!1;Ag.set(e,t);for(const n of Ph.values())yx(n,t);for(const n of s5.values())yx(n,t);return!0}function gy(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Pr(t){return t==null?!1:t.settings!==void 0}const a5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},zs=new vu("app","Firebase",a5);class o5{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Ha("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw zs.create("app-deleted",{appName:this._name})}}const jl=r5;function JE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:Tg,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw zs.create("bad-app-name",{appName:String(a)});if(n||(n=$E()),!n)throw zs.create("no-options");const l=Ph.get(a);if(l){if($s(n,l.options)&&$s(i,l.config))return l;throw zs.create("duplicate-app",{appName:a})}const c=new fI(a);for(const f of Ag.values())c.addComponent(f);const h=new o5(n,i,c);return Ph.set(a,h),h}function ZE(t=Tg){const e=Ph.get(t);if(!e&&t===Tg&&$E())return JE();if(!e)throw zs.create("no-app",{appName:t});return e}function Fs(t,e,n){let i=i5[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$i.warn(c.join(" "));return}fl(new Ha(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const l5="firebase-heartbeat-database",c5=1,su="firebase-heartbeat-store";let tg=null;function ew(){return tg||(tg=TI(l5,c5,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(su)}catch(n){console.warn(n)}}}}).catch(t=>{throw zs.create("idb-open",{originalErrorMessage:t.message})})),tg}async function u5(t){try{const n=(await ew()).transaction(su),i=await n.objectStore(su).get(tw(t));return await n.done,i}catch(e){if(e instanceof Yi)$i.warn(e.message);else{const n=zs.create("idb-get",{originalErrorMessage:e?.message});$i.warn(n.message)}}}async function _x(t,e){try{const i=(await ew()).transaction(su,"readwrite");await i.objectStore(su).put(e,tw(t)),await i.done}catch(n){if(n instanceof Yi)$i.warn(n.message);else{const i=zs.create("idb-set",{originalErrorMessage:n?.message});$i.warn(i.message)}}}function tw(t){return`${t.name}!${t.options.appId}`}const d5=1024,h5=30;class f5{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new p5(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=bx();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>h5){const a=g5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){$i.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=bx(),{heartbeatsToSend:n,unsentEntries:i}=m5(this._heartbeatsCache.heartbeats),a=Nh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return $i.warn(e),""}}}function bx(){return new Date().toISOString().substring(0,10)}function m5(t,e=d5){const n=[];let i=t.slice();for(const a of t){const l=n.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),vx(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),vx(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class p5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return tI()?nI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await u5(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return _x(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return _x(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function vx(t){return Nh(JSON.stringify({version:2,heartbeats:t})).length}function g5(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function y5(t){fl(new Ha("platform-logger",e=>new DI(e),"PRIVATE")),fl(new Ha("heartbeat",e=>new f5(e),"PRIVATE")),Fs(Cg,gx,t),Fs(Cg,gx,"esm2020"),Fs("fire-js","")}y5("");var _5="firebase",b5="12.7.0";Fs(_5,b5,"app");const v5={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},yy=JE(v5);var xx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var qs,nw;(function(){var t;function e(O,R){function j(){}j.prototype=R.prototype,O.F=R.prototype,O.prototype=new j,O.prototype.constructor=O,O.D=function(I,M,H){for(var P=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)P[ue-2]=arguments[ue];return R.prototype[M].apply(I,P)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(O,R,j){j||(j=0);const I=Array(16);if(typeof R=="string")for(var M=0;M<16;++M)I[M]=R.charCodeAt(j++)|R.charCodeAt(j++)<<8|R.charCodeAt(j++)<<16|R.charCodeAt(j++)<<24;else for(M=0;M<16;++M)I[M]=R[j++]|R[j++]<<8|R[j++]<<16|R[j++]<<24;R=O.g[0],j=O.g[1],M=O.g[2];let H=O.g[3],P;P=R+(H^j&(M^H))+I[0]+3614090360&4294967295,R=j+(P<<7&4294967295|P>>>25),P=H+(M^R&(j^M))+I[1]+3905402710&4294967295,H=R+(P<<12&4294967295|P>>>20),P=M+(j^H&(R^j))+I[2]+606105819&4294967295,M=H+(P<<17&4294967295|P>>>15),P=j+(R^M&(H^R))+I[3]+3250441966&4294967295,j=M+(P<<22&4294967295|P>>>10),P=R+(H^j&(M^H))+I[4]+4118548399&4294967295,R=j+(P<<7&4294967295|P>>>25),P=H+(M^R&(j^M))+I[5]+1200080426&4294967295,H=R+(P<<12&4294967295|P>>>20),P=M+(j^H&(R^j))+I[6]+2821735955&4294967295,M=H+(P<<17&4294967295|P>>>15),P=j+(R^M&(H^R))+I[7]+4249261313&4294967295,j=M+(P<<22&4294967295|P>>>10),P=R+(H^j&(M^H))+I[8]+1770035416&4294967295,R=j+(P<<7&4294967295|P>>>25),P=H+(M^R&(j^M))+I[9]+2336552879&4294967295,H=R+(P<<12&4294967295|P>>>20),P=M+(j^H&(R^j))+I[10]+4294925233&4294967295,M=H+(P<<17&4294967295|P>>>15),P=j+(R^M&(H^R))+I[11]+2304563134&4294967295,j=M+(P<<22&4294967295|P>>>10),P=R+(H^j&(M^H))+I[12]+1804603682&4294967295,R=j+(P<<7&4294967295|P>>>25),P=H+(M^R&(j^M))+I[13]+4254626195&4294967295,H=R+(P<<12&4294967295|P>>>20),P=M+(j^H&(R^j))+I[14]+2792965006&4294967295,M=H+(P<<17&4294967295|P>>>15),P=j+(R^M&(H^R))+I[15]+1236535329&4294967295,j=M+(P<<22&4294967295|P>>>10),P=R+(M^H&(j^M))+I[1]+4129170786&4294967295,R=j+(P<<5&4294967295|P>>>27),P=H+(j^M&(R^j))+I[6]+3225465664&4294967295,H=R+(P<<9&4294967295|P>>>23),P=M+(R^j&(H^R))+I[11]+643717713&4294967295,M=H+(P<<14&4294967295|P>>>18),P=j+(H^R&(M^H))+I[0]+3921069994&4294967295,j=M+(P<<20&4294967295|P>>>12),P=R+(M^H&(j^M))+I[5]+3593408605&4294967295,R=j+(P<<5&4294967295|P>>>27),P=H+(j^M&(R^j))+I[10]+38016083&4294967295,H=R+(P<<9&4294967295|P>>>23),P=M+(R^j&(H^R))+I[15]+3634488961&4294967295,M=H+(P<<14&4294967295|P>>>18),P=j+(H^R&(M^H))+I[4]+3889429448&4294967295,j=M+(P<<20&4294967295|P>>>12),P=R+(M^H&(j^M))+I[9]+568446438&4294967295,R=j+(P<<5&4294967295|P>>>27),P=H+(j^M&(R^j))+I[14]+3275163606&4294967295,H=R+(P<<9&4294967295|P>>>23),P=M+(R^j&(H^R))+I[3]+4107603335&4294967295,M=H+(P<<14&4294967295|P>>>18),P=j+(H^R&(M^H))+I[8]+1163531501&4294967295,j=M+(P<<20&4294967295|P>>>12),P=R+(M^H&(j^M))+I[13]+2850285829&4294967295,R=j+(P<<5&4294967295|P>>>27),P=H+(j^M&(R^j))+I[2]+4243563512&4294967295,H=R+(P<<9&4294967295|P>>>23),P=M+(R^j&(H^R))+I[7]+1735328473&4294967295,M=H+(P<<14&4294967295|P>>>18),P=j+(H^R&(M^H))+I[12]+2368359562&4294967295,j=M+(P<<20&4294967295|P>>>12),P=R+(j^M^H)+I[5]+4294588738&4294967295,R=j+(P<<4&4294967295|P>>>28),P=H+(R^j^M)+I[8]+2272392833&4294967295,H=R+(P<<11&4294967295|P>>>21),P=M+(H^R^j)+I[11]+1839030562&4294967295,M=H+(P<<16&4294967295|P>>>16),P=j+(M^H^R)+I[14]+4259657740&4294967295,j=M+(P<<23&4294967295|P>>>9),P=R+(j^M^H)+I[1]+2763975236&4294967295,R=j+(P<<4&4294967295|P>>>28),P=H+(R^j^M)+I[4]+1272893353&4294967295,H=R+(P<<11&4294967295|P>>>21),P=M+(H^R^j)+I[7]+4139469664&4294967295,M=H+(P<<16&4294967295|P>>>16),P=j+(M^H^R)+I[10]+3200236656&4294967295,j=M+(P<<23&4294967295|P>>>9),P=R+(j^M^H)+I[13]+681279174&4294967295,R=j+(P<<4&4294967295|P>>>28),P=H+(R^j^M)+I[0]+3936430074&4294967295,H=R+(P<<11&4294967295|P>>>21),P=M+(H^R^j)+I[3]+3572445317&4294967295,M=H+(P<<16&4294967295|P>>>16),P=j+(M^H^R)+I[6]+76029189&4294967295,j=M+(P<<23&4294967295|P>>>9),P=R+(j^M^H)+I[9]+3654602809&4294967295,R=j+(P<<4&4294967295|P>>>28),P=H+(R^j^M)+I[12]+3873151461&4294967295,H=R+(P<<11&4294967295|P>>>21),P=M+(H^R^j)+I[15]+530742520&4294967295,M=H+(P<<16&4294967295|P>>>16),P=j+(M^H^R)+I[2]+3299628645&4294967295,j=M+(P<<23&4294967295|P>>>9),P=R+(M^(j|~H))+I[0]+4096336452&4294967295,R=j+(P<<6&4294967295|P>>>26),P=H+(j^(R|~M))+I[7]+1126891415&4294967295,H=R+(P<<10&4294967295|P>>>22),P=M+(R^(H|~j))+I[14]+2878612391&4294967295,M=H+(P<<15&4294967295|P>>>17),P=j+(H^(M|~R))+I[5]+4237533241&4294967295,j=M+(P<<21&4294967295|P>>>11),P=R+(M^(j|~H))+I[12]+1700485571&4294967295,R=j+(P<<6&4294967295|P>>>26),P=H+(j^(R|~M))+I[3]+2399980690&4294967295,H=R+(P<<10&4294967295|P>>>22),P=M+(R^(H|~j))+I[10]+4293915773&4294967295,M=H+(P<<15&4294967295|P>>>17),P=j+(H^(M|~R))+I[1]+2240044497&4294967295,j=M+(P<<21&4294967295|P>>>11),P=R+(M^(j|~H))+I[8]+1873313359&4294967295,R=j+(P<<6&4294967295|P>>>26),P=H+(j^(R|~M))+I[15]+4264355552&4294967295,H=R+(P<<10&4294967295|P>>>22),P=M+(R^(H|~j))+I[6]+2734768916&4294967295,M=H+(P<<15&4294967295|P>>>17),P=j+(H^(M|~R))+I[13]+1309151649&4294967295,j=M+(P<<21&4294967295|P>>>11),P=R+(M^(j|~H))+I[4]+4149444226&4294967295,R=j+(P<<6&4294967295|P>>>26),P=H+(j^(R|~M))+I[11]+3174756917&4294967295,H=R+(P<<10&4294967295|P>>>22),P=M+(R^(H|~j))+I[2]+718787259&4294967295,M=H+(P<<15&4294967295|P>>>17),P=j+(H^(M|~R))+I[9]+3951481745&4294967295,O.g[0]=O.g[0]+R&4294967295,O.g[1]=O.g[1]+(M+(P<<21&4294967295|P>>>11))&4294967295,O.g[2]=O.g[2]+M&4294967295,O.g[3]=O.g[3]+H&4294967295}i.prototype.v=function(O,R){R===void 0&&(R=O.length);const j=R-this.blockSize,I=this.C;let M=this.h,H=0;for(;H<R;){if(M==0)for(;H<=j;)a(this,O,H),H+=this.blockSize;if(typeof O=="string"){for(;H<R;)if(I[M++]=O.charCodeAt(H++),M==this.blockSize){a(this,I),M=0;break}}else for(;H<R;)if(I[M++]=O[H++],M==this.blockSize){a(this,I),M=0;break}}this.h=M,this.o+=R},i.prototype.A=function(){var O=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);O[0]=128;for(var R=1;R<O.length-8;++R)O[R]=0;R=this.o*8;for(var j=O.length-8;j<O.length;++j)O[j]=R&255,R/=256;for(this.v(O),O=Array(16),R=0,j=0;j<4;++j)for(let I=0;I<32;I+=8)O[R++]=this.g[j]>>>I&255;return O};function l(O,R){var j=h;return Object.prototype.hasOwnProperty.call(j,O)?j[O]:j[O]=R(O)}function c(O,R){this.h=R;const j=[];let I=!0;for(let M=O.length-1;M>=0;M--){const H=O[M]|0;I&&H==R||(j[M]=H,I=!1)}this.g=j}var h={};function f(O){return-128<=O&&O<128?l(O,function(R){return new c([R|0],R<0?-1:0)}):new c([O|0],O<0?-1:0)}function p(O){if(isNaN(O)||!isFinite(O))return b;if(O<0)return D(p(-O));const R=[];let j=1;for(let I=0;O>=j;I++)R[I]=O/j|0,j*=4294967296;return new c(R,0)}function _(O,R){if(O.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(O.charAt(0)=="-")return D(_(O.substring(1),R));if(O.indexOf("-")>=0)throw Error('number format error: interior "-" character');const j=p(Math.pow(R,8));let I=b;for(let H=0;H<O.length;H+=8){var M=Math.min(8,O.length-H);const P=parseInt(O.substring(H,H+M),R);M<8?(M=p(Math.pow(R,M)),I=I.j(M).add(p(P))):(I=I.j(j),I=I.add(p(P)))}return I}var b=f(0),v=f(1),E=f(16777216);t=c.prototype,t.m=function(){if(w(this))return-D(this).m();let O=0,R=1;for(let j=0;j<this.g.length;j++){const I=this.i(j);O+=(I>=0?I:4294967296+I)*R,R*=4294967296}return O},t.toString=function(O){if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(C(this))return"0";if(w(this))return"-"+D(this).toString(O);const R=p(Math.pow(O,6));var j=this;let I="";for(;;){const M=X(j,R).g;j=N(j,M.j(R));let H=((j.g.length>0?j.g[0]:j.h)>>>0).toString(O);if(j=M,C(j))return H+I;for(;H.length<6;)H="0"+H;I=H+I}},t.i=function(O){return O<0?0:O<this.g.length?this.g[O]:this.h};function C(O){if(O.h!=0)return!1;for(let R=0;R<O.g.length;R++)if(O.g[R]!=0)return!1;return!0}function w(O){return O.h==-1}t.l=function(O){return O=N(this,O),w(O)?-1:C(O)?0:1};function D(O){const R=O.g.length,j=[];for(let I=0;I<R;I++)j[I]=~O.g[I];return new c(j,~O.h).add(v)}t.abs=function(){return w(this)?D(this):this},t.add=function(O){const R=Math.max(this.g.length,O.g.length),j=[];let I=0;for(let M=0;M<=R;M++){let H=I+(this.i(M)&65535)+(O.i(M)&65535),P=(H>>>16)+(this.i(M)>>>16)+(O.i(M)>>>16);I=P>>>16,H&=65535,P&=65535,j[M]=P<<16|H}return new c(j,j[j.length-1]&-2147483648?-1:0)};function N(O,R){return O.add(D(R))}t.j=function(O){if(C(this)||C(O))return b;if(w(this))return w(O)?D(this).j(D(O)):D(D(this).j(O));if(w(O))return D(this.j(D(O)));if(this.l(E)<0&&O.l(E)<0)return p(this.m()*O.m());const R=this.g.length+O.g.length,j=[];for(var I=0;I<2*R;I++)j[I]=0;for(I=0;I<this.g.length;I++)for(let M=0;M<O.g.length;M++){const H=this.i(I)>>>16,P=this.i(I)&65535,ue=O.i(M)>>>16,F=O.i(M)&65535;j[2*I+2*M]+=P*F,U(j,2*I+2*M),j[2*I+2*M+1]+=H*F,U(j,2*I+2*M+1),j[2*I+2*M+1]+=P*ue,U(j,2*I+2*M+1),j[2*I+2*M+2]+=H*ue,U(j,2*I+2*M+2)}for(O=0;O<R;O++)j[O]=j[2*O+1]<<16|j[2*O];for(O=R;O<2*R;O++)j[O]=0;return new c(j,0)};function U(O,R){for(;(O[R]&65535)!=O[R];)O[R+1]+=O[R]>>>16,O[R]&=65535,R++}function k(O,R){this.g=O,this.h=R}function X(O,R){if(C(R))throw Error("division by zero");if(C(O))return new k(b,b);if(w(O))return R=X(D(O),R),new k(D(R.g),D(R.h));if(w(R))return R=X(O,D(R)),new k(D(R.g),R.h);if(O.g.length>30){if(w(O)||w(R))throw Error("slowDivide_ only works with positive integers.");for(var j=v,I=R;I.l(O)<=0;)j=G(j),I=G(I);var M=K(j,1),H=K(I,1);for(I=K(I,2),j=K(j,2);!C(I);){var P=H.add(I);P.l(O)<=0&&(M=M.add(j),H=P),I=K(I,1),j=K(j,1)}return R=N(O,M.j(R)),new k(M,R)}for(M=b;O.l(R)>=0;){for(j=Math.max(1,Math.floor(O.m()/R.m())),I=Math.ceil(Math.log(j)/Math.LN2),I=I<=48?1:Math.pow(2,I-48),H=p(j),P=H.j(R);w(P)||P.l(O)>0;)j-=I,H=p(j),P=H.j(R);C(H)&&(H=v),M=M.add(H),O=N(O,P)}return new k(M,O)}t.B=function(O){return X(this,O).h},t.and=function(O){const R=Math.max(this.g.length,O.g.length),j=[];for(let I=0;I<R;I++)j[I]=this.i(I)&O.i(I);return new c(j,this.h&O.h)},t.or=function(O){const R=Math.max(this.g.length,O.g.length),j=[];for(let I=0;I<R;I++)j[I]=this.i(I)|O.i(I);return new c(j,this.h|O.h)},t.xor=function(O){const R=Math.max(this.g.length,O.g.length),j=[];for(let I=0;I<R;I++)j[I]=this.i(I)^O.i(I);return new c(j,this.h^O.h)};function G(O){const R=O.g.length+1,j=[];for(let I=0;I<R;I++)j[I]=O.i(I)<<1|O.i(I-1)>>>31;return new c(j,O.h)}function K(O,R){const j=R>>5;R%=32;const I=O.g.length-j,M=[];for(let H=0;H<I;H++)M[H]=R>0?O.i(H+j)>>>R|O.i(H+j+1)<<32-R:O.i(H+j);return new c(M,O.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,nw=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=_,qs=c}).apply(typeof xx<"u"?xx:typeof self<"u"?self:typeof window<"u"?window:{});var hh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var rw,Qc,iw,xh,Rg,sw,aw,ow;(function(){var t,e=Object.defineProperty;function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof hh=="object"&&hh];for(var x=0;x<m.length;++x){var T=m[x];if(T&&T.Math==Math)return T}throw Error("Cannot find global object")}var i=n(this);function a(m,x){if(x)e:{var T=i;m=m.split(".");for(var z=0;z<m.length-1;z++){var ae=m[z];if(!(ae in T))break e;T=T[ae]}m=m[m.length-1],z=T[m],x=x(z),x!=z&&x!=null&&e(T,m,{configurable:!0,writable:!0,value:x})}}a("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(m){return m||function(x){var T=[],z;for(z in x)Object.prototype.hasOwnProperty.call(x,z)&&T.push([z,x[z]]);return T}});var l=l||{},c=this||self;function h(m){var x=typeof m;return x=="object"&&m!=null||x=="function"}function f(m,x,T){return m.call.apply(m.bind,arguments)}function p(m,x,T){return p=f,p.apply(null,arguments)}function _(m,x){var T=Array.prototype.slice.call(arguments,1);return function(){var z=T.slice();return z.push.apply(z,arguments),m.apply(this,z)}}function b(m,x){function T(){}T.prototype=x.prototype,m.Z=x.prototype,m.prototype=new T,m.prototype.constructor=m,m.Ob=function(z,ae,he){for(var Ee=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)Ee[Fe-2]=arguments[Fe];return x.prototype[ae].apply(z,Ee)}}var v=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function E(m){const x=m.length;if(x>0){const T=Array(x);for(let z=0;z<x;z++)T[z]=m[z];return T}return[]}function C(m,x){for(let z=1;z<arguments.length;z++){const ae=arguments[z];var T=typeof ae;if(T=T!="object"?T:ae?Array.isArray(ae)?"array":T:"null",T=="array"||T=="object"&&typeof ae.length=="number"){T=m.length||0;const he=ae.length||0;m.length=T+he;for(let Ee=0;Ee<he;Ee++)m[T+Ee]=ae[Ee]}else m.push(ae)}}class w{constructor(x,T){this.i=x,this.j=T,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function D(m){c.setTimeout(()=>{throw m},0)}function N(){var m=O;let x=null;return m.g&&(x=m.g,m.g=m.g.next,m.g||(m.h=null),x.next=null),x}class U{constructor(){this.h=this.g=null}add(x,T){const z=k.get();z.set(x,T),this.h?this.h.next=z:this.g=z,this.h=z}}var k=new w(()=>new X,m=>m.reset());class X{constructor(){this.next=this.g=this.h=null}set(x,T){this.h=x,this.g=T,this.next=null}reset(){this.next=this.g=this.h=null}}let G,K=!1,O=new U,R=()=>{const m=Promise.resolve(void 0);G=()=>{m.then(j)}};function j(){for(var m;m=N();){try{m.h.call(m.g)}catch(T){D(T)}var x=k;x.j(m),x.h<100&&(x.h++,m.next=x.g,x.g=m)}K=!1}function I(){this.u=this.u,this.C=this.C}I.prototype.u=!1,I.prototype.dispose=function(){this.u||(this.u=!0,this.N())},I.prototype[Symbol.dispose]=function(){this.dispose()},I.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(m,x){this.type=m,this.g=this.target=x,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var H=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var m=!1,x=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const T=()=>{};c.addEventListener("test",T,x),c.removeEventListener("test",T,x)}catch{}return m})();function P(m){return/^[\s\xa0]*$/.test(m)}function ue(m,x){M.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,x)}b(ue,M),ue.prototype.init=function(m,x){const T=this.type=m.type,z=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=x,x=m.relatedTarget,x||(T=="mouseover"?x=m.fromElement:T=="mouseout"&&(x=m.toElement)),this.relatedTarget=x,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&ue.Z.h.call(this)},ue.prototype.h=function(){ue.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var F="closure_listenable_"+(Math.random()*1e6|0),B=0;function $(m,x,T,z,ae){this.listener=m,this.proxy=null,this.src=x,this.type=T,this.capture=!!z,this.ha=ae,this.key=++B,this.da=this.fa=!1}function Q(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function se(m,x,T){for(const z in m)x.call(T,m[z],z,m)}function ee(m,x){for(const T in m)x.call(void 0,m[T],T,m)}function V(m){const x={};for(const T in m)x[T]=m[T];return x}const q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Y(m,x){let T,z;for(let ae=1;ae<arguments.length;ae++){z=arguments[ae];for(T in z)m[T]=z[T];for(let he=0;he<q.length;he++)T=q[he],Object.prototype.hasOwnProperty.call(z,T)&&(m[T]=z[T])}}function J(m){this.src=m,this.g={},this.h=0}J.prototype.add=function(m,x,T,z,ae){const he=m.toString();m=this.g[he],m||(m=this.g[he]=[],this.h++);const Ee=re(m,x,z,ae);return Ee>-1?(x=m[Ee],T||(x.fa=!1)):(x=new $(x,this.src,he,!!z,ae),x.fa=T,m.push(x)),x};function ne(m,x){const T=x.type;if(T in m.g){var z=m.g[T],ae=Array.prototype.indexOf.call(z,x,void 0),he;(he=ae>=0)&&Array.prototype.splice.call(z,ae,1),he&&(Q(x),m.g[T].length==0&&(delete m.g[T],m.h--))}}function re(m,x,T,z){for(let ae=0;ae<m.length;++ae){const he=m[ae];if(!he.da&&he.listener==x&&he.capture==!!T&&he.ha==z)return ae}return-1}var ge="closure_lm_"+(Math.random()*1e6|0),Ae={};function pe(m,x,T,z,ae){if(Array.isArray(x)){for(let he=0;he<x.length;he++)pe(m,x[he],T,z,ae);return null}return T=bi(T),m&&m[F]?m.J(x,T,h(z)?!!z.capture:!1,ae):ie(m,x,T,!1,z,ae)}function ie(m,x,T,z,ae,he){if(!x)throw Error("Invalid event type");const Ee=h(ae)?!!ae.capture:!!ae;let Fe=Jt(m);if(Fe||(m[ge]=Fe=new J(m)),T=Fe.add(x,T,z,Ee,he),T.proxy)return T;if(z=Ce(),T.proxy=z,z.src=m,z.listener=T,m.addEventListener)H||(ae=Ee),ae===void 0&&(ae=!1),m.addEventListener(x.toString(),z,ae);else if(m.attachEvent)m.attachEvent(Se(x.toString()),z);else if(m.addListener&&m.removeListener)m.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return T}function Ce(){function m(T){return x.call(m.src,m.listener,T)}const x=ke;return m}function Oe(m,x,T,z,ae){if(Array.isArray(x))for(var he=0;he<x.length;he++)Oe(m,x[he],T,z,ae);else z=h(z)?!!z.capture:!!z,T=bi(T),m&&m[F]?(m=m.i,he=String(x).toString(),he in m.g&&(x=m.g[he],T=re(x,T,z,ae),T>-1&&(Q(x[T]),Array.prototype.splice.call(x,T,1),x.length==0&&(delete m.g[he],m.h--)))):m&&(m=Jt(m))&&(x=m.g[x.toString()],m=-1,x&&(m=re(x,T,z,ae)),(T=m>-1?x[m]:null)&&yt(T))}function yt(m){if(typeof m!="number"&&m&&!m.da){var x=m.src;if(x&&x[F])ne(x.i,m);else{var T=m.type,z=m.proxy;x.removeEventListener?x.removeEventListener(T,z,m.capture):x.detachEvent?x.detachEvent(Se(T),z):x.addListener&&x.removeListener&&x.removeListener(z),(T=Jt(x))?(ne(T,m),T.h==0&&(T.src=null,x[ge]=null)):Q(m)}}}function Se(m){return m in Ae?Ae[m]:Ae[m]="on"+m}function ke(m,x){if(m.da)m=!0;else{x=new ue(x,this);const T=m.listener,z=m.ha||m.src;m.fa&&yt(m),m=T.call(z,x)}return m}function Jt(m){return m=m[ge],m instanceof J?m:null}var Er="__closure_events_fn_"+(Math.random()*1e9>>>0);function bi(m){return typeof m=="function"?m:(m[Er]||(m[Er]=function(x){return m.handleEvent(x)}),m[Er])}function Lt(){I.call(this),this.i=new J(this),this.M=this,this.G=null}b(Lt,I),Lt.prototype[F]=!0,Lt.prototype.removeEventListener=function(m,x,T,z){Oe(this,m,x,T,z)};function Zt(m,x){var T,z=m.G;if(z)for(T=[];z;z=z.G)T.push(z);if(m=m.M,z=x.type||x,typeof x=="string")x=new M(x,m);else if(x instanceof M)x.target=x.target||m;else{var ae=x;x=new M(z,m),Y(x,ae)}ae=!0;let he,Ee;if(T)for(Ee=T.length-1;Ee>=0;Ee--)he=x.g=T[Ee],ae=Ji(he,z,!0,x)&&ae;if(he=x.g=m,ae=Ji(he,z,!0,x)&&ae,ae=Ji(he,z,!1,x)&&ae,T)for(Ee=0;Ee<T.length;Ee++)he=x.g=T[Ee],ae=Ji(he,z,!1,x)&&ae}Lt.prototype.N=function(){if(Lt.Z.N.call(this),this.i){var m=this.i;for(const x in m.g){const T=m.g[x];for(let z=0;z<T.length;z++)Q(T[z]);delete m.g[x],m.h--}}this.G=null},Lt.prototype.J=function(m,x,T,z){return this.i.add(String(m),x,!1,T,z)},Lt.prototype.K=function(m,x,T,z){return this.i.add(String(m),x,!0,T,z)};function Ji(m,x,T,z){if(x=m.i.g[String(x)],!x)return!0;x=x.concat();let ae=!0;for(let he=0;he<x.length;++he){const Ee=x[he];if(Ee&&!Ee.da&&Ee.capture==T){const Fe=Ee.listener,It=Ee.ha||Ee.src;Ee.fa&&ne(m.i,Ee),ae=Fe.call(It,z)!==!1&&ae}}return ae&&!z.defaultPrevented}function Hf(m,x){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=p(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:c.setTimeout(m,x||0)}function Nu(m){m.g=Hf(()=>{m.g=null,m.i&&(m.i=!1,Nu(m))},m.l);const x=m.h;m.h=null,m.m.apply(null,x)}class An extends I{constructor(x,T){super(),this.m=x,this.l=T,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Nu(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oa(m){I.call(this),this.h=m,this.g={}}b(oa,I);var zl=[];function Fl(m){se(m.g,function(x,T){this.g.hasOwnProperty(T)&&yt(x)},m),m.g={}}oa.prototype.N=function(){oa.Z.N.call(this),Fl(this)},oa.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Zi=c.JSON.stringify,Gf=c.JSON.parse,Pu=class{stringify(m){return c.JSON.stringify(m,void 0)}parse(m){return c.JSON.parse(m,void 0)}};function Lu(){}function Bu(){}var wr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function hn(){M.call(this,"d")}b(hn,M);function sr(){M.call(this,"c")}b(sr,M);var jt={},Vu=null;function oo(){return Vu=Vu||new Lt}jt.Ia="serverreachability";function Uu(m){M.call(this,jt.Ia,m)}b(Uu,M);function zr(m){const x=oo();Zt(x,new Uu(x))}jt.STAT_EVENT="statevent";function la(m,x){M.call(this,jt.STAT_EVENT,m),this.stat=x}b(la,M);function Bt(m){const x=oo();Zt(x,new la(x,m))}jt.Ja="timingevent";function Fr(m,x){M.call(this,jt.Ja,m),this.size=x}b(Fr,M);function qr(m,x){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){m()},x)}function Cr(){this.g=!0}Cr.prototype.ua=function(){this.g=!1};function $f(m,x,T,z,ae,he){m.info(function(){if(m.g)if(he){var Ee="",Fe=he.split("&");for(let it=0;it<Fe.length;it++){var It=Fe[it].split("=");if(It.length>1){const Et=It[0];It=It[1];const cr=Et.split("_");Ee=cr.length>=2&&cr[1]=="type"?Ee+(Et+"="+It+"&"):Ee+(Et+"=redacted&")}}}else Ee=null;else Ee=he;return"XMLHTTP REQ ("+z+") [attempt "+ae+"]: "+x+`
`+T+`
`+Ee})}function zu(m,x,T,z,ae,he,Ee){m.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+ae+"]: "+x+`
`+T+`
`+he+" "+Ee})}function Hr(m,x,T,z){m.info(function(){return"XMLHTTP TEXT ("+x+"): "+Qf(m,T)+(z?" "+z:"")})}function ca(m,x){m.info(function(){return"TIMEOUT: "+x})}Cr.prototype.info=function(){};function Qf(m,x){if(!m.g)return x;if(!x)return null;try{const he=JSON.parse(x);if(he){for(m=0;m<he.length;m++)if(Array.isArray(he[m])){var T=he[m];if(!(T.length<2)){var z=T[1];if(Array.isArray(z)&&!(z.length<1)){var ae=z[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(let Ee=1;Ee<z.length;Ee++)z[Ee]=""}}}}return Zi(he)}catch{return x}}var ua={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ql={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Hl;function da(){}b(da,Lu),da.prototype.g=function(){return new XMLHttpRequest},Hl=new da;function vi(m){return encodeURIComponent(String(m))}function Fu(m){var x=1;m=m.split(":");const T=[];for(;x>0&&m.length;)T.push(m.shift()),x--;return m.length&&T.push(m.join(":")),T}function Tr(m,x,T,z){this.j=m,this.i=x,this.l=T,this.S=z||1,this.V=new oa(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ar}function Ar(){this.i=null,this.g="",this.h=!1}var Vt={},an={};function Gr(m,x,T){m.M=1,m.A=ha(zt(x)),m.u=T,m.R=!0,lo(m,null)}function lo(m,x){m.F=Date.now(),$r(m),m.B=zt(m.A);var T=m.B,z=m.S;Array.isArray(z)||(z=[String(z)]),fo(T.i,"t",z),m.C=0,T=m.j.L,m.h=new Ar,m.g=rd(m.j,T?x:null,!m.u),m.P>0&&(m.O=new An(p(m.Y,m,m.g),m.P)),x=m.V,T=m.g,z=m.ba;var ae="readystatechange";Array.isArray(ae)||(ae&&(zl[0]=ae.toString()),ae=zl);for(let he=0;he<ae.length;he++){const Ee=pe(T,ae[he],z||x.handleEvent,!1,x.h||x);if(!Ee)break;x.g[Ee.key]=Ee}x=m.J?V(m.J):{},m.u?(m.v||(m.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,x)):(m.v="GET",m.g.ea(m.B,m.v,null,x)),zr(),$f(m.i,m.v,m.B,m.l,m.S,m.u)}Tr.prototype.ba=function(m){m=m.target;const x=this.O;x&&jr(m)==3?x.j():this.Y(m)},Tr.prototype.Y=function(m){try{if(m==this.g)e:{const Fe=jr(this.g),It=this.g.ya(),it=this.g.ca();if(!(Fe<3)&&(Fe!=3||this.g&&(this.h.h||this.g.la()||fn(this.g)))){this.K||Fe!=4||It==7||(It==8||it<=0?zr(3):zr(2)),Qr(this);var x=this.g.ca();this.X=x;var T=Wf(this);if(this.o=x==200,zu(this.i,this.v,this.B,this.l,this.S,Fe,x),this.o){if(this.U&&!this.L){t:{if(this.g){var z,ae=this.g;if((z=ae.g?ae.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(z)){var he=z;break t}}he=null}if(m=he)Hr(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Wr(this,m);else{this.o=!1,this.m=3,Bt(12),Hn(this),ar(this);break e}}if(this.R){m=!0;let Et;for(;!this.K&&this.C<T.length;)if(Et=Hu(this,T),Et==an){Fe==4&&(this.m=4,Bt(14),m=!1),Hr(this.i,this.l,null,"[Incomplete Response]");break}else if(Et==Vt){this.m=4,Bt(15),Hr(this.i,this.l,T,"[Invalid Chunk]"),m=!1;break}else Hr(this.i,this.l,Et,null),Wr(this,Et);if(qu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fe!=4||T.length!=0||this.h.h||(this.m=1,Bt(16),m=!1),this.o=this.o&&m,!m)Hr(this.i,this.l,T,"[Invalid Chunked Response]"),Hn(this),ar(this);else if(T.length>0&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.aa&&!Ee.P&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+T.length),sc(Ee),Ee.P=!0,Bt(11))}}else Hr(this.i,this.l,T,null),Wr(this,T);Fe==4&&Hn(this),this.o&&!this.K&&(Fe==4?Zu(this.j,this):(this.o=!1,$r(this)))}else Si(this.g),x==400&&T.indexOf("Unknown SID")>0?(this.m=3,Bt(12)):(this.m=0,Bt(13)),Hn(this),ar(this)}}}catch{}};function Wf(m){if(!qu(m))return m.g.la();const x=fn(m.g);if(x==="")return"";let T="";const z=x.length,ae=jr(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return Hn(m),ar(m),"";m.h.i=new c.TextDecoder}for(let he=0;he<z;he++)m.h.h=!0,T+=m.h.i.decode(x[he],{stream:!(ae&&he==z-1)});return x.length=0,m.h.g+=T,m.C=0,m.h.g}function qu(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function Hu(m,x){var T=m.C,z=x.indexOf(`
`,T);return z==-1?an:(T=Number(x.substring(T,z)),isNaN(T)?Vt:(z+=1,z+T>x.length?an:(x=x.slice(z,z+T),m.C=z+T,x)))}Tr.prototype.cancel=function(){this.K=!0,Hn(this)};function $r(m){m.T=Date.now()+m.H,co(m,m.H)}function co(m,x){if(m.D!=null)throw Error("WatchDog timer not null");m.D=qr(p(m.aa,m),x)}function Qr(m){m.D&&(c.clearTimeout(m.D),m.D=null)}Tr.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(ca(this.i,this.B),this.M!=2&&(zr(),Bt(17)),Hn(this),this.m=2,ar(this)):co(this,this.T-m)};function ar(m){m.j.I==0||m.K||Zu(m.j,m)}function Hn(m){Qr(m);var x=m.O;x&&typeof x.dispose=="function"&&x.dispose(),m.O=null,Fl(m.V),m.g&&(x=m.g,m.g=null,x.abort(),x.dispose())}function Wr(m,x){try{var T=m.j;if(T.I!=0&&(T.g==m||Yr(T.h,m))){if(!m.L&&Yr(T.h,m)&&T.I==3){try{var z=T.Ba.g.parse(x)}catch{z=null}if(Array.isArray(z)&&z.length==3){var ae=z;if(ae[0]==0){e:if(!T.v){if(T.g)if(T.g.F+3e3<m.F)_o(T),os(T);else break e;ba(T),Bt(18)}}else T.xa=ae[1],0<T.xa-T.K&&ae[2]<37500&&T.F&&T.A==0&&!T.C&&(T.C=qr(p(T.Va,T),6e3));Kr(T.h)<=1&&T.ta&&(T.ta=void 0)}else ni(T,11)}else if((m.L||T.g==m)&&_o(T),!P(x))for(ae=T.Ba.g.parse(x),x=0;x<ae.length;x++){let it=ae[x];const Et=it[0];if(!(Et<=T.K))if(T.K=Et,it=it[1],T.I==2)if(it[0]=="c"){T.M=it[1],T.ba=it[2];const cr=it[3];cr!=null&&(T.ka=cr,T.j.info("VER="+T.ka));const ri=it[4];ri!=null&&(T.za=ri,T.j.info("SVER="+T.za));const Ir=it[5];Ir!=null&&typeof Ir=="number"&&Ir>0&&(z=1.5*Ir,T.O=z,T.j.info("backChannelRequestTimeoutMs_="+z)),z=T;const Mr=m.g;if(Mr){const va=Mr.g?Mr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(va){var he=z.h;he.g||va.indexOf("spdy")==-1&&va.indexOf("quic")==-1&&va.indexOf("h2")==-1||(he.j=he.l,he.g=new Set,he.h&&(Ql(he,he.h),he.h=null))}if(z.G){const bo=Mr.g?Mr.g.getResponseHeader("X-HTTP-Session-Id"):null;bo&&(z.wa=bo,lt(z.J,z.G,bo))}}T.I=3,T.l&&T.l.ra(),T.aa&&(T.T=Date.now()-m.F,T.j.info("Handshake RTT: "+T.T+"ms")),z=T;var Ee=m;if(z.na=nd(z,z.L?z.ba:null,z.W),Ee.L){Wl(z.h,Ee);var Fe=Ee,It=z.O;It&&(Fe.H=It),Fe.D&&(Qr(Fe),$r(Fe)),z.g=Ee}else Xu(z);T.i.length>0&&ti(T)}else it[0]!="stop"&&it[0]!="close"||ni(T,7);else T.I==3&&(it[0]=="stop"||it[0]=="close"?it[0]=="stop"?ni(T,7):rc(T):it[0]!="noop"&&T.l&&T.l.qa(it),T.A=0)}}zr(4)}catch{}}var Ut=class{constructor(m,x){this.g=m,this.map=x}};function Gl(m){this.l=m||10,c.PerformanceNavigationTiming?(m=c.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $l(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function Kr(m){return m.h?1:m.g?m.g.size:0}function Yr(m,x){return m.h?m.h==x:m.g?m.g.has(x):!1}function Ql(m,x){m.g?m.g.add(x):m.h=x}function Wl(m,x){m.h&&m.h==x?m.h=null:m.g&&m.g.has(x)&&m.g.delete(x)}Gl.prototype.cancel=function(){if(this.i=Kl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function Kl(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let x=m.i;for(const T of m.g.values())x=x.concat(T.G);return x}return E(m.i)}var Gu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uo(m,x){if(m){m=m.split("&");for(let T=0;T<m.length;T++){const z=m[T].indexOf("=");let ae,he=null;z>=0?(ae=m[T].substring(0,z),he=m[T].substring(z+1)):ae=m[T],x(ae,he?decodeURIComponent(he.replace(/\+/g," ")):"")}}}function Gn(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;m instanceof Gn?(this.l=m.l,on(this,m.j),this.o=m.o,this.g=m.g,es(this,m.u),this.h=m.h,Yl(this,Ku(m.i)),this.m=m.m):m&&(x=String(m).match(Gu))?(this.l=!1,on(this,x[1]||"",!0),this.o=Xr(x[2]||""),this.g=Xr(x[3]||"",!0),es(this,x[4]),this.h=Xr(x[5]||"",!0),Yl(this,x[6]||"",!0),this.m=Xr(x[7]||"")):(this.l=!1,this.i=new ns(null,this.l))}Gn.prototype.toString=function(){const m=[];var x=this.j;x&&m.push(fa(x,ho,!0),":");var T=this.g;return(T||x=="file")&&(m.push("//"),(x=this.o)&&m.push(fa(x,ho,!0),"@"),m.push(vi(T).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T=this.u,T!=null&&m.push(":",String(T))),(T=this.h)&&(this.g&&T.charAt(0)!="/"&&m.push("/"),m.push(fa(T,T.charAt(0)=="/"?Xl:$u,!0))),(T=this.i.toString())&&m.push("?",T),(T=this.m)&&m.push("#",fa(T,Qu)),m.join("")},Gn.prototype.resolve=function(m){const x=zt(this);let T=!!m.j;T?on(x,m.j):T=!!m.o,T?x.o=m.o:T=!!m.g,T?x.g=m.g:T=m.u!=null;var z=m.h;if(T)es(x,m.u);else if(T=!!m.h){if(z.charAt(0)!="/")if(this.g&&!this.h)z="/"+z;else{var ae=x.h.lastIndexOf("/");ae!=-1&&(z=x.h.slice(0,ae+1)+z)}if(ae=z,ae==".."||ae==".")z="";else if(ae.indexOf("./")!=-1||ae.indexOf("/.")!=-1){z=ae.lastIndexOf("/",0)==0,ae=ae.split("/");const he=[];for(let Ee=0;Ee<ae.length;){const Fe=ae[Ee++];Fe=="."?z&&Ee==ae.length&&he.push(""):Fe==".."?((he.length>1||he.length==1&&he[0]!="")&&he.pop(),z&&Ee==ae.length&&he.push("")):(he.push(Fe),z=!0)}z=he.join("/")}else z=ae}return T?x.h=z:T=m.i.toString()!=="",T?Yl(x,Ku(m.i)):T=!!m.m,T&&(x.m=m.m),x};function zt(m){return new Gn(m)}function on(m,x,T){m.j=T?Xr(x,!0):x,m.j&&(m.j=m.j.replace(/:$/,""))}function es(m,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);m.u=x}else m.u=null}function Yl(m,x,T){x instanceof ns?(m.i=x,mo(m.i,m.l)):(T||(x=fa(x,ts)),m.i=new ns(x,m.l))}function lt(m,x,T){m.i.set(x,T)}function ha(m){return lt(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Xr(m,x){return m?x?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function fa(m,x,T){return typeof m=="string"?(m=encodeURI(m).replace(x,On),T&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function On(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var ho=/[#\/\?@]/g,$u=/[#\?:]/g,Xl=/[#\?]/g,ts=/[#\?@]/g,Qu=/#/g;function ns(m,x){this.h=this.g=null,this.i=m||null,this.j=!!x}function kn(m){m.g||(m.g=new Map,m.h=0,m.i&&uo(m.i,function(x,T){m.add(decodeURIComponent(x.replace(/\+/g," ")),T)}))}t=ns.prototype,t.add=function(m,x){kn(this),this.i=null,m=rs(this,m);let T=this.g.get(m);return T||this.g.set(m,T=[]),T.push(x),this.h+=1,this};function Wu(m,x){kn(m),x=rs(m,x),m.g.has(x)&&(m.i=null,m.h-=m.g.get(x).length,m.g.delete(x))}function Jl(m,x){return kn(m),x=rs(m,x),m.g.has(x)}t.forEach=function(m,x){kn(this),this.g.forEach(function(T,z){T.forEach(function(ae){m.call(x,ae,z,this)},this)},this)};function Zl(m,x){kn(m);let T=[];if(typeof x=="string")Jl(m,x)&&(T=T.concat(m.g.get(rs(m,x))));else for(m=Array.from(m.g.values()),x=0;x<m.length;x++)T=T.concat(m[x]);return T}t.set=function(m,x){return kn(this),this.i=null,m=rs(this,m),Jl(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[x]),this.h+=1,this},t.get=function(m,x){return m?(m=Zl(this,m),m.length>0?String(m[0]):x):x};function fo(m,x,T){Wu(m,x),T.length>0&&(m.i=null,m.g.set(rs(m,x),E(T)),m.h+=T.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],x=Array.from(this.g.keys());for(let z=0;z<x.length;z++){var T=x[z];const ae=vi(T);T=Zl(this,T);for(let he=0;he<T.length;he++){let Ee=ae;T[he]!==""&&(Ee+="="+vi(T[he])),m.push(Ee)}}return this.i=m.join("&")};function Ku(m){const x=new ns;return x.i=m.i,m.g&&(x.g=new Map(m.g),x.h=m.h),x}function rs(m,x){return x=String(x),m.j&&(x=x.toLowerCase()),x}function mo(m,x){x&&!m.j&&(kn(m),m.i=null,m.g.forEach(function(T,z){const ae=z.toLowerCase();z!=ae&&(Wu(this,z),fo(this,ae,T))},m)),m.j=x}function Rr(m,x){const T=new Cr;if(c.Image){const z=new Image;z.onload=_(or,T,"TestLoadImage: loaded",!0,x,z),z.onerror=_(or,T,"TestLoadImage: error",!1,x,z),z.onabort=_(or,T,"TestLoadImage: abort",!1,x,z),z.ontimeout=_(or,T,"TestLoadImage: timeout",!1,x,z),c.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=m}else x(!1)}function ec(m,x){const T=new Cr,z=new AbortController,ae=setTimeout(()=>{z.abort(),or(T,"TestPingServer: timeout",!1,x)},1e4);fetch(m,{signal:z.signal}).then(he=>{clearTimeout(ae),he.ok?or(T,"TestPingServer: ok",!0,x):or(T,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(ae),or(T,"TestPingServer: error",!1,x)})}function or(m,x,T,z,ae){try{ae&&(ae.onload=null,ae.onerror=null,ae.onabort=null,ae.ontimeout=null),z(T)}catch{}}function is(){this.g=new Pu}function Jr(m){this.i=m.Sb||null,this.h=m.ab||!1}b(Jr,Lu),Jr.prototype.g=function(){return new ma(this.i,this.h)};function ma(m,x){Lt.call(this),this.H=m,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(ma,Lt),t=ma.prototype,t.open=function(m,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=x,this.readyState=1,Dr(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(x.body=m),(this.H||c).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,ss(this)),this.readyState=0},t.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Dr(this)),this.g&&(this.readyState=3,Dr(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;po(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function po(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}t.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var x=m.value?m.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!m.done}))&&(this.response=this.responseText+=x)}m.done?ss(this):Dr(this),this.readyState==3&&po(this)}},t.Oa=function(m){this.g&&(this.response=this.responseText=m,ss(this))},t.Na=function(m){this.g&&(this.response=m,ss(this))},t.ga=function(){this.g&&ss(this)};function ss(m){m.readyState=4,m.l=null,m.j=null,m.B=null,Dr(m)}t.setRequestHeader=function(m,x){this.A.append(m,x)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],x=this.h.entries();for(var T=x.next();!T.done;)T=T.value,m.push(T[0]+": "+T[1]),T=x.next();return m.join(`\r
`)};function Dr(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(ma.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function lr(m){let x="";return se(m,function(T,z){x+=z,x+=":",x+=T,x+=`\r
`}),x}function pa(m,x,T){e:{for(z in T){var z=!1;break e}z=!0}z||(T=lr(T),typeof m=="string"?T!=null&&vi(T):lt(m,x,T))}function dt(m){Lt.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(dt,Lt);var Zr=/^https?$/i,tc=["POST","PUT"];t=dt.prototype,t.Fa=function(m){this.H=m},t.ea=function(m,x,T,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);x=x?x.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Hl.g(),this.g.onreadystatechange=v(p(this.Ca,this));try{this.B=!0,this.g.open(x,String(m),!0),this.B=!1}catch(he){ga(this,he);return}if(m=T||"",T=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var ae in z)T.set(ae,z[ae]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const he of z.keys())T.set(he,z.get(he));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(T.keys()).find(he=>he.toLowerCase()=="content-type"),ae=c.FormData&&m instanceof c.FormData,!(Array.prototype.indexOf.call(tc,x,void 0)>=0)||z||ae||T.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[he,Ee]of T)this.g.setRequestHeader(he,Ee);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(he){ga(this,he)}};function ga(m,x){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=x,m.o=5,nc(m),xi(m)}function nc(m){m.A||(m.A=!0,Zt(m,"complete"),Zt(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,Zt(this,"complete"),Zt(this,"abort"),xi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xi(this,!0)),dt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ya(this):this.Xa())},t.Xa=function(){ya(this)};function ya(m){if(m.h&&typeof l<"u"){if(m.v&&jr(m)==4)setTimeout(m.Ca.bind(m),0);else if(Zt(m,"readystatechange"),jr(m)==4){m.h=!1;try{const he=m.ca();e:switch(he){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var T;if(!(T=x)){var z;if(z=he===0){let Ee=String(m.D).match(Gu)[1]||null;!Ee&&c.self&&c.self.location&&(Ee=c.self.location.protocol.slice(0,-1)),z=!Zr.test(Ee?Ee.toLowerCase():"")}T=z}if(T)Zt(m,"complete"),Zt(m,"success");else{m.o=6;try{var ae=jr(m)>2?m.g.statusText:""}catch{ae=""}m.l=ae+" ["+m.ca()+"]",nc(m)}}finally{xi(m)}}}}function xi(m,x){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const T=m.g;m.g=null,x||Zt(m,"ready");try{T.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function jr(m){return m.g?m.g.readyState:0}t.ca=function(){try{return jr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(m){if(this.g){var x=this.g.responseText;return m&&x.indexOf(m)==0&&(x=x.substring(m.length)),Gf(x)}};function fn(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function Si(m){const x={};m=(m.g&&jr(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<m.length;z++){if(P(m[z]))continue;var T=Fu(m[z]);const ae=T[0];if(T=T[1],typeof T!="string")continue;T=T.trim();const he=x[ae]||[];x[ae]=he,he.push(T)}ee(x,function(z){return z.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ei(m,x,T){return T&&T.internalChannelParams&&T.internalChannelParams[m]||x}function as(m){this.za=0,this.i=[],this.j=new Cr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ei("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ei("baseRetryDelayMs",5e3,m),this.Za=ei("retryDelaySeedMs",1e4,m),this.Ta=ei("forwardChannelMaxRetries",2,m),this.va=ei("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new Gl(m&&m.concurrentRequestLimit),this.Ba=new is,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=as.prototype,t.ka=8,t.I=1,t.connect=function(m,x,T,z){Bt(0),this.W=m,this.H=x||{},T&&z!==void 0&&(this.H.OSID=T,this.H.OAID=z),this.F=this.X,this.J=nd(this,null,this.W),ti(this)};function rc(m){if(go(m),m.I==3){var x=m.V++,T=zt(m.J);if(lt(T,"SID",m.M),lt(T,"RID",x),lt(T,"TYPE","terminate"),_a(m,T),x=new Tr(m,m.j,x),x.M=2,x.A=ha(zt(T)),T=!1,c.navigator&&c.navigator.sendBeacon)try{T=c.navigator.sendBeacon(x.A.toString(),"")}catch{}!T&&c.Image&&(new Image().src=x.A,T=!0),T||(x.g=rd(x.j,null),x.g.ea(x.A)),x.F=Date.now(),$r(x)}td(m)}function os(m){m.g&&(sc(m),m.g.cancel(),m.g=null)}function go(m){os(m),m.v&&(c.clearTimeout(m.v),m.v=null),_o(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&c.clearTimeout(m.m),m.m=null)}function ti(m){if(!$l(m.h)&&!m.m){m.m=!0;var x=m.Ea;G||R(),K||(G(),K=!0),O.add(x,m),m.D=0}}function yo(m,x){return Kr(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=x.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=qr(p(m.Ea,m,x),ed(m,m.D)),m.D++,!0)}t.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const ae=new Tr(this,this.j,m);let he=this.o;if(this.U&&(he?(he=V(he),Y(he,this.U)):he=this.U),this.u!==null||this.R||(ae.J=he,he=null),this.S)e:{for(var x=0,T=0;T<this.i.length;T++){t:{var z=this.i[T];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break t}z=void 0}if(z===void 0)break;if(x+=z,x>4096){x=T;break e}if(x===4096||T===this.i.length-1){x=T+1;break e}}x=1e3}else x=1e3;x=Yu(this,ae,x),T=zt(this.J),lt(T,"RID",m),lt(T,"CVER",22),this.G&&lt(T,"X-HTTP-Session-Id",this.G),_a(this,T),he&&(this.R?x="headers="+vi(lr(he))+"&"+x:this.u&&pa(T,this.u,he)),Ql(this.h,ae),this.Ra&&lt(T,"TYPE","init"),this.S?(lt(T,"$req",x),lt(T,"SID","null"),ae.U=!0,Gr(ae,T,null)):Gr(ae,T,x),this.I=2}}else this.I==3&&(m?ic(this,m):this.i.length==0||$l(this.h)||ic(this))};function ic(m,x){var T;x?T=x.l:T=m.V++;const z=zt(m.J);lt(z,"SID",m.M),lt(z,"RID",T),lt(z,"AID",m.K),_a(m,z),m.u&&m.o&&pa(z,m.u,m.o),T=new Tr(m,m.j,T,m.D+1),m.u===null&&(T.J=m.o),x&&(m.i=x.G.concat(m.i)),x=Yu(m,T,1e3),T.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),Ql(m.h,T),Gr(T,z,x)}function _a(m,x){m.H&&se(m.H,function(T,z){lt(x,z,T)}),m.l&&se({},function(T,z){lt(x,z,T)})}function Yu(m,x,T){T=Math.min(m.i.length,T);const z=m.l?p(m.l.Ka,m.l,m):null;e:{var ae=m.i;let Fe=-1;for(;;){const It=["count="+T];Fe==-1?T>0?(Fe=ae[0].g,It.push("ofs="+Fe)):Fe=0:It.push("ofs="+Fe);let it=!0;for(let Et=0;Et<T;Et++){var he=ae[Et].g;const cr=ae[Et].map;if(he-=Fe,he<0)Fe=Math.max(0,ae[Et].g-100),it=!1;else try{he="req"+he+"_"||"";try{var Ee=cr instanceof Map?cr:Object.entries(cr);for(const[ri,Ir]of Ee){let Mr=Ir;h(Ir)&&(Mr=Zi(Ir)),It.push(he+ri+"="+encodeURIComponent(Mr))}}catch(ri){throw It.push(he+"type="+encodeURIComponent("_badmap")),ri}}catch{z&&z(cr)}}if(it){Ee=It.join("&");break e}}Ee=void 0}return m=m.i.splice(0,T),x.G=m,Ee}function Xu(m){if(!m.g&&!m.v){m.Y=1;var x=m.Da;G||R(),K||(G(),K=!0),O.add(x,m),m.A=0}}function ba(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=qr(p(m.Da,m),ed(m,m.A)),m.A++,!0)}t.Da=function(){if(this.v=null,Ju(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=qr(p(this.Wa,this),m)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Bt(10),os(this),Ju(this))};function sc(m){m.B!=null&&(c.clearTimeout(m.B),m.B=null)}function Ju(m){m.g=new Tr(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var x=zt(m.na);lt(x,"RID","rpc"),lt(x,"SID",m.M),lt(x,"AID",m.K),lt(x,"CI",m.F?"0":"1"),!m.F&&m.ia&&lt(x,"TO",m.ia),lt(x,"TYPE","xmlhttp"),_a(m,x),m.u&&m.o&&pa(x,m.u,m.o),m.O&&(m.g.H=m.O);var T=m.g;m=m.ba,T.M=1,T.A=ha(zt(x)),T.u=null,T.R=!0,lo(T,m)}t.Va=function(){this.C!=null&&(this.C=null,os(this),ba(this),Bt(19))};function _o(m){m.C!=null&&(c.clearTimeout(m.C),m.C=null)}function Zu(m,x){var T=null;if(m.g==x){_o(m),sc(m),m.g=null;var z=2}else if(Yr(m.h,x))T=x.G,Wl(m.h,x),z=1;else return;if(m.I!=0){if(x.o)if(z==1){T=x.u?x.u.length:0,x=Date.now()-x.F;var ae=m.D;z=oo(),Zt(z,new Fr(z,T)),ti(m)}else Xu(m);else if(ae=x.m,ae==3||ae==0&&x.X>0||!(z==1&&yo(m,x)||z==2&&ba(m)))switch(T&&T.length>0&&(x=m.h,x.i=x.i.concat(T)),ae){case 1:ni(m,5);break;case 4:ni(m,10);break;case 3:ni(m,6);break;default:ni(m,2)}}}function ed(m,x){let T=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(T*=2),T*x}function ni(m,x){if(m.j.info("Error code "+x),x==2){var T=p(m.bb,m),z=m.Ua;const ae=!z;z=new Gn(z||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||on(z,"https"),ha(z),ae?Rr(z.toString(),T):ec(z.toString(),T)}else Bt(2);m.I=0,m.l&&m.l.pa(x),td(m),go(m)}t.bb=function(m){m?(this.j.info("Successfully pinged google.com"),Bt(2)):(this.j.info("Failed to ping google.com"),Bt(1))};function td(m){if(m.I=0,m.ja=[],m.l){const x=Kl(m.h);(x.length!=0||m.i.length!=0)&&(C(m.ja,x),C(m.ja,m.i),m.h.i.length=0,E(m.i),m.i.length=0),m.l.oa()}}function nd(m,x,T){var z=T instanceof Gn?zt(T):new Gn(T);if(z.g!="")x&&(z.g=x+"."+z.g),es(z,z.u);else{var ae=c.location;z=ae.protocol,x=x?x+"."+ae.hostname:ae.hostname,ae=+ae.port;const he=new Gn(null);z&&on(he,z),x&&(he.g=x),ae&&es(he,ae),T&&(he.h=T),z=he}return T=m.G,x=m.wa,T&&x&&lt(z,T,x),lt(z,"VER",m.ka),_a(m,z),z}function rd(m,x,T){if(x&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=m.Aa&&!m.ma?new dt(new Jr({ab:T})):new dt(m.ma),x.Fa(m.L),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function id(){}t=id.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ls(){}ls.prototype.g=function(m,x){return new Rn(m,x)};function Rn(m,x){Lt.call(this),this.g=new as(x),this.l=m,this.h=x&&x.messageUrlParams||null,m=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(m?m["X-WebChannel-Content-Type"]=x.messageContentType:m={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(m?m["X-WebChannel-Client-Profile"]=x.sa:m={"X-WebChannel-Client-Profile":x.sa}),this.g.U=m,(m=x&&x.Qb)&&!P(m)&&(this.g.u=m),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!P(x)&&(this.g.G=x,m=this.h,m!==null&&x in m&&(m=this.h,x in m&&delete m[x])),this.j=new Ei(this)}b(Rn,Lt),Rn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Rn.prototype.close=function(){rc(this.g)},Rn.prototype.o=function(m){var x=this.g;if(typeof m=="string"){var T={};T.__data__=m,m=T}else this.v&&(T={},T.__data__=Zi(m),m=T);x.i.push(new Ut(x.Ya++,m)),x.I==3&&ti(x)},Rn.prototype.N=function(){this.g.l=null,delete this.j,rc(this.g),delete this.g,Rn.Z.N.call(this)};function sd(m){hn.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var x=m.__sm__;if(x){e:{for(const T in x){m=T;break e}m=void 0}(this.i=m)&&(m=this.i,x=x!==null&&m in x?x[m]:void 0),this.data=x}else this.data=m}b(sd,hn);function ad(){sr.call(this),this.status=1}b(ad,sr);function Ei(m){this.g=m}b(Ei,id),Ei.prototype.ra=function(){Zt(this.g,"a")},Ei.prototype.qa=function(m){Zt(this.g,new sd(m))},Ei.prototype.pa=function(m){Zt(this.g,new ad)},Ei.prototype.oa=function(){Zt(this.g,"b")},ls.prototype.createWebChannel=ls.prototype.g,Rn.prototype.send=Rn.prototype.o,Rn.prototype.open=Rn.prototype.m,Rn.prototype.close=Rn.prototype.close,ow=function(){return new ls},aw=function(){return oo()},sw=jt,Rg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ua.NO_ERROR=0,ua.TIMEOUT=8,ua.HTTP_ERROR=6,xh=ua,ql.COMPLETE="complete",iw=ql,Bu.EventType=wr,wr.OPEN="a",wr.CLOSE="b",wr.ERROR="c",wr.MESSAGE="d",Lt.prototype.listen=Lt.prototype.J,Qc=Bu,dt.prototype.listenOnce=dt.prototype.K,dt.prototype.getLastError=dt.prototype.Ha,dt.prototype.getLastErrorCode=dt.prototype.ya,dt.prototype.getStatus=dt.prototype.ca,dt.prototype.getResponseJson=dt.prototype.La,dt.prototype.getResponseText=dt.prototype.la,dt.prototype.send=dt.prototype.ea,dt.prototype.setWithCredentials=dt.prototype.Fa,rw=dt}).apply(typeof hh<"u"?hh:typeof self<"u"?self:typeof window<"u"?window:{});const Sx="@firebase/firestore",Ex="4.9.3";class En{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}En.UNAUTHENTICATED=new En(null),En.GOOGLE_CREDENTIALS=new En("google-credentials-uid"),En.FIRST_PARTY=new En("first-party-uid"),En.MOCK_USER=new En("mock-user");let Il="12.7.0";const Ga=new my("@firebase/firestore");function el(){return Ga.logLevel}function Te(t,...e){if(Ga.logLevel<=Xe.DEBUG){const n=e.map(_y);Ga.debug(`Firestore (${Il}): ${t}`,...n)}}function Qi(t,...e){if(Ga.logLevel<=Xe.ERROR){const n=e.map(_y);Ga.error(`Firestore (${Il}): ${t}`,...n)}}function ml(t,...e){if(Ga.logLevel<=Xe.WARN){const n=e.map(_y);Ga.warn(`Firestore (${Il}): ${t}`,...n)}}function _y(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Be(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,lw(t,i,n)}function lw(t,e,n){let i=`FIRESTORE (${Il}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Qi(i),new Error(i)}function ot(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||lw(e,a,i)}function ze(t,e){return t}const _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends Yi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Hi{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class cw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class x5{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(En.UNAUTHENTICATED)))}shutdown(){}}class S5{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class E5{constructor(e){this.t=e,this.currentUser=En.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ot(this.o===void 0,42304);let i=this.i;const a=f=>this.i!==i?(i=this.i,n(f)):Promise.resolve();let l=new Hi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Hi,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const f=l;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},h=f=>{Te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((f=>h(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?h(f):(Te("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Hi)}}),0),c()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(Te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ot(typeof i.accessToken=="string",31837,{l:i}),new cw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ot(e===null||typeof e=="string",2055,{h:e}),new En(e)}}class w5{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=En.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class C5{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new w5(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(En.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class T5{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Pr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ot(this.o===void 0,3512);const i=l=>{l.error!=null&&Te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Te("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{Te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(ot(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new wx(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function A5(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class by{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=A5(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function Je(t,e){return t<e?-1:t>e?1:0}function Dg(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return ng(a)===ng(l)?Je(a,l):ng(a)?1:-1}return Je(t.length,e.length)}const R5=55296,D5=57343;function ng(t){const e=t.charCodeAt(0);return e>=R5&&e<=D5}function pl(t,e,n){return t.length===e.length&&t.every(((i,a)=>n(i,e[a])))}const Cx="__name__";class li{constructor(e,n,i){n===void 0?n=0:n>e.length&&Be(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Be(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return li.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof li?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=li.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return Je(e.length,n.length)}static compareSegments(e,n){const i=li.isNumericId(e),a=li.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?li.extractNumericId(e).compare(li.extractNumericId(n)):Dg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return qs.fromString(e.substring(4,e.length-2))}}class gt extends li{construct(e,n,i){return new gt(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new we(_e.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((a=>a.length>0)))}return new gt(n)}static emptyPath(){return new gt([])}}const j5=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bn extends li{construct(e,n,i){return new bn(e,n,i)}static isValidIdentifier(e){return j5.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Cx}static keyField(){return new bn([Cx])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new we(_e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let c=!1;for(;a<e.length;){const h=e[a];if(h==="\\"){if(a+1===e.length)throw new we(_e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new we(_e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,a+=2}else h==="`"?(c=!c,a++):h!=="."||c?(i+=h,a++):(l(),a++)}if(l(),c)throw new we(_e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bn(n)}static emptyPath(){return new bn([])}}class Me{constructor(e){this.path=e}static fromPath(e){return new Me(gt.fromString(e))}static fromName(e){return new Me(gt.fromString(e).popFirst(5))}static empty(){return new Me(gt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return gt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Me(new gt(e.slice()))}}function uw(t,e,n){if(!n)throw new we(_e.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function I5(t,e,n,i){if(e===!0&&i===!0)throw new we(_e.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Tx(t){if(!Me.isDocumentKey(t))throw new we(_e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ax(t){if(Me.isDocumentKey(t))throw new we(_e.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function dw(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function uf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Be(12329,{type:typeof t})}function Br(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new we(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=uf(t);throw new we(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Yt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Su(t,e){if(!dw(t))throw new we(_e.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const c=t[i];if(a&&typeof c!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new we(_e.INVALID_ARGUMENT,n);return!0}const Rx=-62135596800,Dx=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*Dx);return new vt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new we(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new we(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Rx)throw new we(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Dx}_compareTo(e){return this.seconds===e.seconds?Je(this.nanoseconds,e.nanoseconds):Je(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Su(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Rx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:Yt("string",vt._jsonSchemaVersion),seconds:Yt("number"),nanoseconds:Yt("number")};class Ve{static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new vt(0,0))}static max(){return new Ve(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const au=-1;function M5(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Ve.fromTimestamp(i===1e9?new vt(n+1,0):new vt(n,i));return new Qs(a,Me.empty(),e)}function O5(t){return new Qs(t.readTime,t.key,au)}class Qs{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Qs(Ve.min(),Me.empty(),au)}static max(){return new Qs(Ve.max(),Me.empty(),au)}}function k5(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Me.comparator(t.documentKey,e.documentKey),n!==0?n:Je(t.largestBatchId,e.largestBatchId))}const N5="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class P5{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ml(t){if(t.code!==_e.FAILED_PRECONDITION||t.message!==N5)throw t;Te("LocalStore","Unexpectedly lost primary lease")}class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Be(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ve(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof ve?n:ve.resolve(n)}catch(n){return ve.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):ve.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):ve.reject(n)}static resolve(e){return new ve(((n,i)=>{n(e)}))}static reject(e){return new ve(((n,i)=>{i(e)}))}static waitFor(e){return new ve(((n,i)=>{let a=0,l=0,c=!1;e.forEach((h=>{++a,h.next((()=>{++l,c&&l===a&&n()}),(f=>i(f)))})),c=!0,l===a&&n()}))}static or(e){let n=ve.resolve(!1);for(const i of e)n=n.next((a=>a?ve.resolve(a):i()));return n}static forEach(e,n){const i=[];return e.forEach(((a,l)=>{i.push(n.call(this,a,l))})),this.waitFor(i)}static mapArray(e,n){return new ve(((i,a)=>{const l=e.length,c=new Array(l);let h=0;for(let f=0;f<l;f++){const p=f;n(e[p]).next((_=>{c[p]=_,++h,h===l&&i(c)}),(_=>a(_)))}}))}static doWhile(e,n){return new ve(((i,a)=>{const l=()=>{e()===!0?n().next((()=>{l()}),a):i()};l()}))}}function L5(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ol(t){return t.name==="IndexedDbTransactionError"}class df{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}df.ce=-1;const vy=-1;function hf(t){return t==null}function Lh(t){return t===0&&1/t==-1/0}function B5(t){return typeof t=="number"&&Number.isInteger(t)&&!Lh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const hw="";function V5(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=jx(e)),e=U5(t.get(n),e);return jx(e)}function U5(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case hw:n+="";break;default:n+=l}}return n}function jx(t){return t+hw+""}function Ix(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ta(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function fw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class At{constructor(e,n){this.comparator=e,this.root=n||_n.EMPTY}insert(e,n){return new At(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new At(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fh(this.root,e,this.comparator,!1)}getReverseIterator(){return new fh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fh(this.root,e,this.comparator,!0)}}class fh{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _n{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??_n.RED,this.left=a??_n.EMPTY,this.right=l??_n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new _n(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return _n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return _n.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Be(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Be(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Be(27949);return e+(this.isRed()?0:1)}}_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw Be(57766)}get value(){throw Be(16141)}get color(){throw Be(16727)}get left(){throw Be(29726)}get right(){throw Be(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new _n(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class rn{constructor(e){this.comparator=e,this.data=new At(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Mx(this.data.getIterator())}getIteratorFrom(e){return new Mx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof rn)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new rn(this.comparator);return n.data=e,n}}class Mx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Zn{constructor(e){this.fields=e,e.sort(bn.comparator)}static empty(){return new Zn([])}unionWith(e){let n=new rn(bn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new Zn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return pl(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class mw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class vn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new mw("Invalid base64 string: "+l):l}})(e);return new vn(n)}static fromUint8Array(e){const n=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new vn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Je(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vn.EMPTY_BYTE_STRING=new vn("");const z5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ws(t){if(ot(!!t,39018),typeof t=="string"){let e=0;const n=z5.exec(t);if(ot(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:kt(t.seconds),nanos:kt(t.nanos)}}function kt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ks(t){return typeof t=="string"?vn.fromBase64String(t):vn.fromUint8Array(t)}const pw="server_timestamp",gw="__type__",yw="__previous_value__",_w="__local_write_time__";function xy(t){return(t?.mapValue?.fields||{})[gw]?.stringValue===pw}function ff(t){const e=t.mapValue.fields[yw];return xy(e)?ff(e):e}function ou(t){const e=Ws(t.mapValue.fields[_w].timestampValue);return new vt(e.seconds,e.nanos)}class F5{constructor(e,n,i,a,l,c,h,f,p,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=h,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=_}}const Bh="(default)";class lu{constructor(e,n){this.projectId=e,this.database=n||Bh}static empty(){return new lu("","")}get isDefaultDatabase(){return this.database===Bh}isEqual(e){return e instanceof lu&&e.projectId===this.projectId&&e.database===this.database}}const bw="__type__",q5="__max__",mh={mapValue:{}},vw="__vector__",Vh="value";function Ys(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xy(t)?4:G5(t)?9007199254740991:H5(t)?10:11:Be(28295,{value:t})}function gi(t,e){if(t===e)return!0;const n=Ys(t);if(n!==Ys(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ou(t).isEqual(ou(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=Ws(a.timestampValue),h=Ws(l.timestampValue);return c.seconds===h.seconds&&c.nanos===h.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return Ks(a.bytesValue).isEqual(Ks(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return kt(a.geoPointValue.latitude)===kt(l.geoPointValue.latitude)&&kt(a.geoPointValue.longitude)===kt(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return kt(a.integerValue)===kt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=kt(a.doubleValue),h=kt(l.doubleValue);return c===h?Lh(c)===Lh(h):isNaN(c)&&isNaN(h)}return!1})(t,e);case 9:return pl(t.arrayValue.values||[],e.arrayValue.values||[],gi);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},h=l.mapValue.fields||{};if(Ix(c)!==Ix(h))return!1;for(const f in c)if(c.hasOwnProperty(f)&&(h[f]===void 0||!gi(c[f],h[f])))return!1;return!0})(t,e);default:return Be(52216,{left:t})}}function cu(t,e){return(t.values||[]).find((n=>gi(n,e)))!==void 0}function gl(t,e){if(t===e)return 0;const n=Ys(t),i=Ys(e);if(n!==i)return Je(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Je(t.booleanValue,e.booleanValue);case 2:return(function(l,c){const h=kt(l.integerValue||l.doubleValue),f=kt(c.integerValue||c.doubleValue);return h<f?-1:h>f?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1})(t,e);case 3:return Ox(t.timestampValue,e.timestampValue);case 4:return Ox(ou(t),ou(e));case 5:return Dg(t.stringValue,e.stringValue);case 6:return(function(l,c){const h=Ks(l),f=Ks(c);return h.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(l,c){const h=l.split("/"),f=c.split("/");for(let p=0;p<h.length&&p<f.length;p++){const _=Je(h[p],f[p]);if(_!==0)return _}return Je(h.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,c){const h=Je(kt(l.latitude),kt(c.latitude));return h!==0?h:Je(kt(l.longitude),kt(c.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return kx(t.arrayValue,e.arrayValue);case 10:return(function(l,c){const h=l.fields||{},f=c.fields||{},p=h[Vh]?.arrayValue,_=f[Vh]?.arrayValue,b=Je(p?.values?.length||0,_?.values?.length||0);return b!==0?b:kx(p,_)})(t.mapValue,e.mapValue);case 11:return(function(l,c){if(l===mh.mapValue&&c===mh.mapValue)return 0;if(l===mh.mapValue)return 1;if(c===mh.mapValue)return-1;const h=l.fields||{},f=Object.keys(h),p=c.fields||{},_=Object.keys(p);f.sort(),_.sort();for(let b=0;b<f.length&&b<_.length;++b){const v=Dg(f[b],_[b]);if(v!==0)return v;const E=gl(h[f[b]],p[_[b]]);if(E!==0)return E}return Je(f.length,_.length)})(t.mapValue,e.mapValue);default:throw Be(23264,{he:n})}}function Ox(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Je(t,e);const n=Ws(t),i=Ws(e),a=Je(n.seconds,i.seconds);return a!==0?a:Je(n.nanos,i.nanos)}function kx(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=gl(n[a],i[a]);if(l)return l}return Je(n.length,i.length)}function yl(t){return jg(t)}function jg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=Ws(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Ks(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return Me.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=jg(l);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const c of i)l?l=!1:a+=",",a+=`${c}:${jg(n.fields[c])}`;return a+"}"})(t.mapValue):Be(61005,{value:t})}function Sh(t){switch(Ys(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ff(t);return e?16+Sh(e):16;case 5:return 2*t.stringValue.length;case 6:return Ks(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+Sh(l)),0)})(t.arrayValue);case 10:case 11:return(function(i){let a=0;return ta(i.fields,((l,c)=>{a+=l.length+Sh(c)})),a})(t.mapValue);default:throw Be(13486,{value:t})}}function Nx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ig(t){return!!t&&"integerValue"in t}function Sy(t){return!!t&&"arrayValue"in t}function Px(t){return!!t&&"nullValue"in t}function Lx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Eh(t){return!!t&&"mapValue"in t}function H5(t){return(t?.mapValue?.fields||{})[bw]?.stringValue===vw}function Jc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return ta(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=Jc(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Jc(t.arrayValue.values[n]);return e}return{...t}}function G5(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===q5}class zn{constructor(e){this.value=e}static empty(){return new zn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!Eh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jc(n)}setAll(e){let n=bn.emptyPath(),i={},a=[];e.forEach(((c,h)=>{if(!n.isImmediateParentOf(h)){const f=this.getFieldsMap(n);this.applyChanges(f,i,a),i={},a=[],n=h.popLast()}c?i[h.lastSegment()]=Jc(c):a.push(h.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());Eh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return gi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];Eh(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){ta(n,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new zn(Jc(this.value))}}function xw(t){const e=[];return ta(t.fields,((n,i)=>{const a=new bn([n]);if(Eh(i)){const l=xw(i.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new Zn(e)}class wn{constructor(e,n,i,a,l,c,h){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=c,this.documentState=h}static newInvalidDocument(e){return new wn(e,0,Ve.min(),Ve.min(),Ve.min(),zn.empty(),0)}static newFoundDocument(e,n,i,a){return new wn(e,1,n,Ve.min(),i,a,0)}static newNoDocument(e,n){return new wn(e,2,n,Ve.min(),Ve.min(),zn.empty(),0)}static newUnknownDocument(e,n){return new wn(e,3,n,Ve.min(),Ve.min(),zn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Uh{constructor(e,n){this.position=e,this.inclusive=n}}function Bx(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],c=t.position[a];if(l.field.isKeyField()?i=Me.comparator(Me.fromName(c.referenceValue),n.key):i=gl(c,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function Vx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!gi(t.position[n],e.position[n]))return!1;return!0}class zh{constructor(e,n="asc"){this.field=e,this.dir=n}}function $5(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Sw{}class Kt extends Sw{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new W5(e,n,i):n==="array-contains"?new X5(e,i):n==="in"?new J5(e,i):n==="not-in"?new Z5(e,i):n==="array-contains-any"?new e2(e,i):new Kt(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new K5(e,i):new Y5(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(gl(n,this.value)):n!==null&&Ys(this.value)===Ys(n)&&this.matchesComparison(gl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Be(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vr extends Sw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Vr(e,n)}matches(e){return Ew(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ew(t){return t.op==="and"}function ww(t){return Q5(t)&&Ew(t)}function Q5(t){for(const e of t.filters)if(e instanceof Vr)return!1;return!0}function Mg(t){if(t instanceof Kt)return t.field.canonicalString()+t.op.toString()+yl(t.value);if(ww(t))return t.filters.map((e=>Mg(e))).join(",");{const e=t.filters.map((n=>Mg(n))).join(",");return`${t.op}(${e})`}}function Cw(t,e){return t instanceof Kt?(function(i,a){return a instanceof Kt&&i.op===a.op&&i.field.isEqual(a.field)&&gi(i.value,a.value)})(t,e):t instanceof Vr?(function(i,a){return a instanceof Vr&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,c,h)=>l&&Cw(c,a.filters[h])),!0):!1})(t,e):void Be(19439)}function Tw(t){return t instanceof Kt?(function(n){return`${n.field.canonicalString()} ${n.op} ${yl(n.value)}`})(t):t instanceof Vr?(function(n){return n.op.toString()+" {"+n.getFilters().map(Tw).join(" ,")+"}"})(t):"Filter"}class W5 extends Kt{constructor(e,n,i){super(e,n,i),this.key=Me.fromName(i.referenceValue)}matches(e){const n=Me.comparator(e.key,this.key);return this.matchesComparison(n)}}class K5 extends Kt{constructor(e,n){super(e,"in",n),this.keys=Aw("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class Y5 extends Kt{constructor(e,n){super(e,"not-in",n),this.keys=Aw("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function Aw(t,e){return(e.arrayValue?.values||[]).map((n=>Me.fromName(n.referenceValue)))}class X5 extends Kt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Sy(n)&&cu(n.arrayValue,this.value)}}class J5 extends Kt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&cu(this.value.arrayValue,n)}}class Z5 extends Kt{constructor(e,n){super(e,"not-in",n)}matches(e){if(cu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!cu(this.value.arrayValue,n)}}class e2 extends Kt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Sy(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>cu(this.value.arrayValue,i)))}}class t2{constructor(e,n=null,i=[],a=[],l=null,c=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=c,this.endAt=h,this.Te=null}}function Ux(t,e=null,n=[],i=[],a=null,l=null,c=null){return new t2(t,e,n,i,a,l,c)}function Ey(t){const e=ze(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>Mg(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),hf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>yl(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>yl(i))).join(",")),e.Te=n}return e.Te}function wy(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!$5(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Cw(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Vx(t.startAt,e.startAt)&&Vx(t.endAt,e.endAt)}function Og(t){return Me.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Eu{constructor(e,n=null,i=[],a=[],l=null,c="F",h=null,f=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=c,this.startAt=h,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function n2(t,e,n,i,a,l,c,h){return new Eu(t,e,n,i,a,l,c,h)}function Cy(t){return new Eu(t)}function zx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Rw(t){return t.collectionGroup!==null}function Zc(t){const e=ze(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let h=new rn(bn.comparator);return c.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(h=h.add(p.field))}))})),h})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new zh(l,i))})),n.has(bn.keyField().canonicalString())||e.Ie.push(new zh(bn.keyField(),i))}return e.Ie}function ui(t){const e=ze(t);return e.Ee||(e.Ee=r2(e,Zc(t))),e.Ee}function r2(t,e){if(t.limitType==="F")return Ux(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new zh(a.field,l)}));const n=t.endAt?new Uh(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Uh(t.startAt.position,t.startAt.inclusive):null;return Ux(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function kg(t,e){const n=t.filters.concat([e]);return new Eu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ng(t,e,n){return new Eu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mf(t,e){return wy(ui(t),ui(e))&&t.limitType===e.limitType}function Dw(t){return`${Ey(ui(t))}|lt:${t.limitType}`}function tl(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((a=>Tw(a))).join(", ")}]`),hf(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((a=>yl(a))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((a=>yl(a))).join(",")),`Target(${i})`})(ui(t))}; limitType=${t.limitType})`}function pf(t,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Me.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(t,e)&&(function(i,a){for(const l of Zc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(i,a){return!(i.startAt&&!(function(c,h,f){const p=Bx(c,h,f);return c.inclusive?p<=0:p<0})(i.startAt,Zc(i),a)||i.endAt&&!(function(c,h,f){const p=Bx(c,h,f);return c.inclusive?p>=0:p>0})(i.endAt,Zc(i),a))})(t,e)}function i2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function jw(t){return(e,n)=>{let i=!1;for(const a of Zc(t)){const l=s2(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function s2(t,e,n){const i=t.field.isKeyField()?Me.comparator(e.key,n.key):(function(l,c,h){const f=c.data.field(l),p=h.data.field(l);return f!==null&&p!==null?gl(f,p):Be(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Be(19790,{direction:t.dir})}}class Xa{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){ta(this.inner,((n,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return fw(this.inner)}size(){return this.innerSize}}const a2=new At(Me.comparator);function Wi(){return a2}const Iw=new At(Me.comparator);function Wc(...t){let e=Iw;for(const n of t)e=e.insert(n.key,n);return e}function Mw(t){let e=Iw;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function Ua(){return eu()}function Ow(){return eu()}function eu(){return new Xa((t=>t.toString()),((t,e)=>t.isEqual(e)))}const o2=new At(Me.comparator),l2=new rn(Me.comparator);function Ze(...t){let e=l2;for(const n of t)e=e.add(n);return e}const c2=new rn(Je);function u2(){return c2}function Ty(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lh(e)?"-0":e}}function kw(t){return{integerValue:""+t}}function d2(t,e){return B5(e)?kw(e):Ty(t,e)}class gf{constructor(){this._=void 0}}function h2(t,e,n){return t instanceof Fh?(function(a,l){const c={fields:{[gw]:{stringValue:pw},[_w]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&xy(l)&&(l=ff(l)),l&&(c.fields[yw]=l),{mapValue:c}})(n,e):t instanceof _l?Pw(t,e):t instanceof uu?Lw(t,e):(function(a,l){const c=Nw(a,l),h=Fx(c)+Fx(a.Ae);return Ig(c)&&Ig(a.Ae)?kw(h):Ty(a.serializer,h)})(t,e)}function f2(t,e,n){return t instanceof _l?Pw(t,e):t instanceof uu?Lw(t,e):n}function Nw(t,e){return t instanceof qh?(function(i){return Ig(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Fh extends gf{}class _l extends gf{constructor(e){super(),this.elements=e}}function Pw(t,e){const n=Bw(e);for(const i of t.elements)n.some((a=>gi(a,i)))||n.push(i);return{arrayValue:{values:n}}}class uu extends gf{constructor(e){super(),this.elements=e}}function Lw(t,e){let n=Bw(e);for(const i of t.elements)n=n.filter((a=>!gi(a,i)));return{arrayValue:{values:n}}}class qh extends gf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Fx(t){return kt(t.integerValue||t.doubleValue)}function Bw(t){return Sy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class m2{constructor(e,n){this.field=e,this.transform=n}}function p2(t,e){return t.field.isEqual(e.field)&&(function(i,a){return i instanceof _l&&a instanceof _l||i instanceof uu&&a instanceof uu?pl(i.elements,a.elements,gi):i instanceof qh&&a instanceof qh?gi(i.Ae,a.Ae):i instanceof Fh&&a instanceof Fh})(t.transform,e.transform)}class g2{constructor(e,n){this.version=e,this.transformResults=n}}class Fn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Fn}static exists(e){return new Fn(void 0,e)}static updateTime(e){return new Fn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class yf{}function Vw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new _f(t.key,Fn.none()):new wu(t.key,t.data,Fn.none());{const n=t.data,i=zn.empty();let a=new rn(bn.comparator);for(let l of e.fields)if(!a.has(l)){let c=n.field(l);c===null&&l.length>1&&(l=l.popLast(),c=n.field(l)),c===null?i.delete(l):i.set(l,c),a=a.add(l)}return new na(t.key,i,new Zn(a.toArray()),Fn.none())}}function y2(t,e,n){t instanceof wu?(function(a,l,c){const h=a.value.clone(),f=Hx(a.fieldTransforms,l,c.transformResults);h.setAll(f),l.convertToFoundDocument(c.version,h).setHasCommittedMutations()})(t,e,n):t instanceof na?(function(a,l,c){if(!wh(a.precondition,l))return void l.convertToUnknownDocument(c.version);const h=Hx(a.fieldTransforms,l,c.transformResults),f=l.data;f.setAll(Uw(a)),f.setAll(h),l.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(t,e,n):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,n)}function tu(t,e,n,i){return t instanceof wu?(function(l,c,h,f){if(!wh(l.precondition,c))return h;const p=l.value.clone(),_=Gx(l.fieldTransforms,f,c);return p.setAll(_),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(t,e,n,i):t instanceof na?(function(l,c,h,f){if(!wh(l.precondition,c))return h;const p=Gx(l.fieldTransforms,f,c),_=c.data;return _.setAll(Uw(l)),_.setAll(p),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),h===null?null:h.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((b=>b.field)))})(t,e,n,i):(function(l,c,h){return wh(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):h})(t,e,n)}function _2(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=Nw(i.transform,a||null);l!=null&&(n===null&&(n=zn.empty()),n.set(i.field,l))}return n||null}function qx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&pl(i,a,((l,c)=>p2(l,c)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class wu extends yf{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class na extends yf{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function Uw(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Hx(t,e,n){const i=new Map;ot(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],c=l.transform,h=e.data.field(l.field);i.set(l.field,f2(c,h,n[a]))}return i}function Gx(t,e,n){const i=new Map;for(const a of t){const l=a.transform,c=n.data.field(a.field);i.set(a.field,h2(l,c,e))}return i}class _f extends yf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class b2 extends yf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class v2{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&y2(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=tu(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=tu(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=Ow();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let h=this.applyToLocalView(c,l.mutatedFields);h=n.has(a.key)?null:h;const f=Vw(c,h);f!==null&&i.set(a.key,f),c.isValidDocument()||c.convertToNoDocument(Ve.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),Ze())}isEqual(e){return this.batchId===e.batchId&&pl(this.mutations,e.mutations,((n,i)=>qx(n,i)))&&pl(this.baseMutations,e.baseMutations,((n,i)=>qx(n,i)))}}class Ay{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){ot(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return o2})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,i[c].version);return new Ay(e,n,i,a)}}class x2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class S2{constructor(e,n){this.count=e,this.unchangedNames=n}}var Qt,tt;function E2(t){switch(t){case _e.OK:return Be(64938);case _e.CANCELLED:case _e.UNKNOWN:case _e.DEADLINE_EXCEEDED:case _e.RESOURCE_EXHAUSTED:case _e.INTERNAL:case _e.UNAVAILABLE:case _e.UNAUTHENTICATED:return!1;case _e.INVALID_ARGUMENT:case _e.NOT_FOUND:case _e.ALREADY_EXISTS:case _e.PERMISSION_DENIED:case _e.FAILED_PRECONDITION:case _e.ABORTED:case _e.OUT_OF_RANGE:case _e.UNIMPLEMENTED:case _e.DATA_LOSS:return!0;default:return Be(15467,{code:t})}}function zw(t){if(t===void 0)return Qi("GRPC error has no .code"),_e.UNKNOWN;switch(t){case Qt.OK:return _e.OK;case Qt.CANCELLED:return _e.CANCELLED;case Qt.UNKNOWN:return _e.UNKNOWN;case Qt.DEADLINE_EXCEEDED:return _e.DEADLINE_EXCEEDED;case Qt.RESOURCE_EXHAUSTED:return _e.RESOURCE_EXHAUSTED;case Qt.INTERNAL:return _e.INTERNAL;case Qt.UNAVAILABLE:return _e.UNAVAILABLE;case Qt.UNAUTHENTICATED:return _e.UNAUTHENTICATED;case Qt.INVALID_ARGUMENT:return _e.INVALID_ARGUMENT;case Qt.NOT_FOUND:return _e.NOT_FOUND;case Qt.ALREADY_EXISTS:return _e.ALREADY_EXISTS;case Qt.PERMISSION_DENIED:return _e.PERMISSION_DENIED;case Qt.FAILED_PRECONDITION:return _e.FAILED_PRECONDITION;case Qt.ABORTED:return _e.ABORTED;case Qt.OUT_OF_RANGE:return _e.OUT_OF_RANGE;case Qt.UNIMPLEMENTED:return _e.UNIMPLEMENTED;case Qt.DATA_LOSS:return _e.DATA_LOSS;default:return Be(39323,{code:t})}}(tt=Qt||(Qt={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";function w2(){return new TextEncoder}const C2=new qs([4294967295,4294967295],0);function $x(t){const e=w2().encode(t),n=new nw;return n.update(e),new Uint8Array(n.digest())}function Qx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new qs([n,i],0),new qs([a,l],0)]}class Ry{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Kc(`Invalid padding: ${n}`);if(i<0)throw new Kc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Kc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Kc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=qs.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(qs.fromNumber(i)));return a.compare(C2)===1&&(a=new qs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=$x(e),[i,a]=Qx(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);if(!this.we(c))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new Ry(l,a,n);return i.forEach((h=>c.insert(h))),c}insert(e){if(this.ge===0)return;const n=$x(e),[i,a]=Qx(n);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,a,l);this.Se(c)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Kc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class bf{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,Cu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new bf(Ve.min(),a,new At(Je),Wi(),Ze())}}class Cu{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new Cu(i,n,Ze(),Ze(),Ze())}}class Ch{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class Fw{constructor(e,n){this.targetId=e,this.Ce=n}}class qw{constructor(e,n,i=vn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class Wx{constructor(){this.ve=0,this.Fe=Kx(),this.Me=vn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ze(),n=Ze(),i=Ze();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:Be(38017,{changeType:l})}})),new Cu(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=Kx()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class T2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Wi(),this.Je=ph(),this.He=ph(),this.Ye=new At(Je)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Be(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(Og(l))if(i===0){const c=new Me(l.path);this.et(n,c,wn.newNoDocument(c,Ve.min()))}else ot(i===1,20013,{expectedCount:i});else{const c=this._t(n);if(c!==i){const h=this.ut(e),f=h?this.ct(h,e,c):1;if(f!==0){this.it(n);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,p)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let c,h;try{c=Ks(i).toUint8Array()}catch(f){if(f instanceof mw)return ml("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{h=new Ry(c,a,l)}catch(f){return ml(f instanceof Kc?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return h.ge===0?null:h}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach((l=>{const c=this.Ge.ht(),h=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(h)||(this.et(n,l,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((l,c)=>{const h=this.ot(c);if(h){if(l.current&&Og(h.target)){const f=new Me(h.target.path);this.It(f).has(c)||this.Et(c,f)||this.et(c,f,wn.newNoDocument(f,e))}l.Be&&(n.set(c,l.ke()),l.qe())}}));let i=Ze();this.He.forEach(((l,c)=>{let h=!0;c.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new bf(e,n,this.Ye,this.je,i);return this.je=Wi(),this.Je=ph(),this.He=ph(),this.Ye=new At(Je),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Wx,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new rn(Je),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new rn(Je),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Te("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Wx),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function ph(){return new At(Me.comparator)}function Kx(){return new At(Me.comparator)}const A2={asc:"ASCENDING",desc:"DESCENDING"},R2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},D2={and:"AND",or:"OR"};class j2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Pg(t,e){return t.useProto3Json||hf(e)?e:{value:e}}function Hh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Hw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function I2(t,e){return Hh(t,e.toTimestamp())}function di(t){return ot(!!t,49232),Ve.fromTimestamp((function(n){const i=Ws(n);return new vt(i.seconds,i.nanos)})(t))}function Dy(t,e){return Lg(t,e).canonicalString()}function Lg(t,e){const n=(function(a){return new gt(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function Gw(t){const e=gt.fromString(t);return ot(Yw(e),10190,{key:e.toString()}),e}function Bg(t,e){return Dy(t.databaseId,e.path)}function rg(t,e){const n=Gw(e);if(n.get(1)!==t.databaseId.projectId)throw new we(_e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new we(_e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Me(Qw(n))}function $w(t,e){return Dy(t.databaseId,e)}function M2(t){const e=Gw(t);return e.length===4?gt.emptyPath():Qw(e)}function Vg(t){return new gt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Qw(t){return ot(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Yx(t,e,n){return{name:Bg(t,e),fields:n.value.mapValue.fields}}function O2(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Be(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(p,_){return p.useProto3Json?(ot(_===void 0||typeof _=="string",58123),vn.fromBase64String(_||"")):(ot(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),vn.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),c=e.targetChange.cause,h=c&&(function(p){const _=p.code===void 0?_e.UNKNOWN:zw(p.code);return new we(_,p.message||"")})(c);n=new qw(i,a,l,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=rg(t,i.document.name),l=di(i.document.updateTime),c=i.document.createTime?di(i.document.createTime):Ve.min(),h=new zn({mapValue:{fields:i.document.fields}}),f=wn.newFoundDocument(a,l,c,h),p=i.targetIds||[],_=i.removedTargetIds||[];n=new Ch(p,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=rg(t,i.document),l=i.readTime?di(i.readTime):Ve.min(),c=wn.newNoDocument(a,l),h=i.removedTargetIds||[];n=new Ch([],h,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=rg(t,i.document),l=i.removedTargetIds||[];n=new Ch([],l,a,null)}else{if(!("filter"in e))return Be(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,c=new S2(a,l),h=i.targetId;n=new Fw(h,c)}}return n}function k2(t,e){let n;if(e instanceof wu)n={update:Yx(t,e.key,e.value)};else if(e instanceof _f)n={delete:Bg(t,e.key)};else if(e instanceof na)n={update:Yx(t,e.key,e.data),updateMask:q2(e.fieldMask)};else{if(!(e instanceof b2))return Be(16599,{Vt:e.type});n={verify:Bg(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const h=c.transform;if(h instanceof Fh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof _l)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof uu)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof qh)return{fieldPath:c.field.canonicalString(),increment:h.Ae};throw Be(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:I2(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Be(27497)})(t,e.precondition)),n}function N2(t,e){return t&&t.length>0?(ot(e!==void 0,14353),t.map((n=>(function(a,l){let c=a.updateTime?di(a.updateTime):di(l);return c.isEqual(Ve.min())&&(c=di(l)),new g2(c,a.transformResults||[])})(n,e)))):[]}function P2(t,e){return{documents:[$w(t,e.path)]}}function L2(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=$w(t,a);const l=(function(p){if(p.length!==0)return Kw(Vr.create(p,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const c=(function(p){if(p.length!==0)return p.map((_=>(function(v){return{field:nl(v.field),direction:U2(v.dir)}})(_)))})(e.orderBy);c&&(n.structuredQuery.orderBy=c);const h=Pg(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:n,parent:a}}function B2(t){let e=M2(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){ot(i===1,65062);const _=n.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(b){const v=Ww(b);return v instanceof Vr&&ww(v)?v.getFilters():[v]})(n.where));let c=[];n.orderBy&&(c=(function(b){return b.map((v=>(function(C){return new zh(rl(C.field),(function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(C.direction))})(v)))})(n.orderBy));let h=null;n.limit&&(h=(function(b){let v;return v=typeof b=="object"?b.value:b,hf(v)?null:v})(n.limit));let f=null;n.startAt&&(f=(function(b){const v=!!b.before,E=b.values||[];return new Uh(E,v)})(n.startAt));let p=null;return n.endAt&&(p=(function(b){const v=!b.before,E=b.values||[];return new Uh(E,v)})(n.endAt)),n2(e,a,c,l,h,"F",f,p)}function V2(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Be(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Ww(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=rl(n.unaryFilter.field);return Kt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=rl(n.unaryFilter.field);return Kt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=rl(n.unaryFilter.field);return Kt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=rl(n.unaryFilter.field);return Kt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Be(61313);default:return Be(60726)}})(t):t.fieldFilter!==void 0?(function(n){return Kt.create(rl(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Be(58110);default:return Be(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Vr.create(n.compositeFilter.filters.map((i=>Ww(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Be(1026)}})(n.compositeFilter.op))})(t):Be(30097,{filter:t})}function U2(t){return A2[t]}function z2(t){return R2[t]}function F2(t){return D2[t]}function nl(t){return{fieldPath:t.canonicalString()}}function rl(t){return bn.fromServerFormat(t.fieldPath)}function Kw(t){return t instanceof Kt?(function(n){if(n.op==="=="){if(Lx(n.value))return{unaryFilter:{field:nl(n.field),op:"IS_NAN"}};if(Px(n.value))return{unaryFilter:{field:nl(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Lx(n.value))return{unaryFilter:{field:nl(n.field),op:"IS_NOT_NAN"}};if(Px(n.value))return{unaryFilter:{field:nl(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nl(n.field),op:z2(n.op),value:n.value}}})(t):t instanceof Vr?(function(n){const i=n.getFilters().map((a=>Kw(a)));return i.length===1?i[0]:{compositeFilter:{op:F2(n.op),filters:i}}})(t):Be(54877,{filter:t})}function q2(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function Yw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Bs{constructor(e,n,i,a,l=Ve.min(),c=Ve.min(),h=vn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=h,this.expectedCount=f}withSequenceNumber(e){return new Bs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class H2{constructor(e){this.yt=e}}function G2(t){const e=B2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ng(e,e.limit,"L"):e}class $2{constructor(){this.Cn=new Q2}addToCollectionParentIndex(e,n){return this.Cn.add(n),ve.resolve()}getCollectionParents(e,n){return ve.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ve.resolve()}deleteFieldIndex(e,n){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,n){return ve.resolve()}getDocumentsMatchingTarget(e,n){return ve.resolve(null)}getIndexType(e,n){return ve.resolve(0)}getFieldIndexes(e,n){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,n){return ve.resolve(Qs.min())}getMinOffsetFromCollectionGroup(e,n){return ve.resolve(Qs.min())}updateCollectionGroup(e,n,i){return ve.resolve()}updateIndexEntries(e,n){return ve.resolve()}}class Q2{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new rn(gt.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new rn(gt.comparator)).toArray()}}const Xx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Xw=41943040;class Un{static withCacheSize(e){return new Un(e,Un.DEFAULT_COLLECTION_PERCENTILE,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}Un.DEFAULT_COLLECTION_PERCENTILE=10,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Un.DEFAULT=new Un(Xw,Un.DEFAULT_COLLECTION_PERCENTILE,Un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Un.DISABLED=new Un(-1,0,0);class bl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new bl(0)}static cr(){return new bl(-1)}}const Jx="LruGarbageCollector",W2=1048576;function Zx([t,e],[n,i]){const a=Je(t,n);return a===0?Je(e,i):a}class K2{constructor(e){this.Ir=e,this.buffer=new rn(Zx),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Zx(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Y2{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Te(Jx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ol(n)?Te(Jx,"Ignoring IndexedDB error during garbage collection: ",n):await Ml(n)}await this.Vr(3e5)}))}}class X2{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return ve.resolve(df.ce);const i=new K2(n);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Te("LruGarbageCollector","Garbage collection skipped; disabled"),ve.resolve(Xx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Te("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Xx):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,c,h,f,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(Te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),a=this.params.maximumSequenceNumbersToCollect):a=b,c=Date.now(),this.nthSequenceNumber(e,a)))).next((b=>(i=b,h=Date.now(),this.removeTargets(e,i,n)))).next((b=>(l=b,f=Date.now(),this.removeOrphanedDocuments(e,i)))).next((b=>(p=Date.now(),el()<=Xe.DEBUG&&Te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${a} in `+(h-c)+`ms
	Removed ${l} targets in `+(f-h)+`ms
	Removed ${b} documents in `+(p-f)+`ms
Total Duration: ${p-_}ms`),ve.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:b}))))}}function J2(t,e){return new X2(t,e)}class Z2{constructor(){this.changes=new Xa((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,wn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?ve.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class eM{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class tM{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(i!==null&&tu(i.mutation,a,Zn.empty(),vt.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,Ze()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=Ze()){const a=Ua();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,i).next((l=>{let c=Wc();return l.forEach(((h,f)=>{c=c.insert(h,f.overlayedDocument)})),c}))))}getOverlayedDocuments(e,n){const i=Ua();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,Ze())))}populateOverlays(e,n,i){const a=[];return i.forEach((l=>{n.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,h)=>{n.set(c,h)}))}))}computeViews(e,n,i,a){let l=Wi();const c=eu(),h=(function(){return eu()})();return n.forEach(((f,p)=>{const _=i.get(p.key);a.has(p.key)&&(_===void 0||_.mutation instanceof na)?l=l.insert(p.key,p):_!==void 0?(c.set(p.key,_.mutation.getFieldMask()),tu(_.mutation,p,_.mutation.getFieldMask(),vt.now())):c.set(p.key,Zn.empty())})),this.recalculateAndSaveOverlays(e,l).next((f=>(f.forEach(((p,_)=>c.set(p,_))),n.forEach(((p,_)=>h.set(p,new eM(_,c.get(p)??null)))),h)))}recalculateAndSaveOverlays(e,n){const i=eu();let a=new At(((c,h)=>c-h)),l=Ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((c=>{for(const h of c)h.keys().forEach((f=>{const p=n.get(f);if(p===null)return;let _=i.get(f)||Zn.empty();_=h.applyToLocalView(p,_),i.set(f,_);const b=(a.get(h.batchId)||Ze()).add(f);a=a.insert(h.batchId,b)}))})).next((()=>{const c=[],h=a.getReverseIterator();for(;h.hasNext();){const f=h.getNext(),p=f.key,_=f.value,b=Ow();_.forEach((v=>{if(!l.has(v)){const E=Vw(n.get(v),i.get(v));E!==null&&b.set(v,E),l=l.add(v)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,b))}return ve.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,a){return(function(c){return Me.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Rw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):ve.resolve(Ua());let h=au,f=l;return c.next((p=>ve.forEach(p,((_,b)=>(h<b.largestBatchId&&(h=b.largestBatchId),l.get(_)?ve.resolve():this.remoteDocumentCache.getEntry(e,_).next((v=>{f=f.insert(_,v)}))))).next((()=>this.populateOverlays(e,p,l))).next((()=>this.computeViews(e,f,p,Ze()))).next((_=>({batchId:h,changes:Mw(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Me(n)).next((i=>{let a=Wc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let c=Wc();return this.indexManager.getCollectionParents(e,l).next((h=>ve.forEach(h,(f=>{const p=(function(b,v){return new Eu(v,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(n,f.child(l));return this.getDocumentsMatchingCollectionQuery(e,p,i,a).next((_=>{_.forEach(((b,v)=>{c=c.insert(b,v)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a)))).next((c=>{l.forEach(((f,p)=>{const _=p.getKey();c.get(_)===null&&(c=c.insert(_,wn.newInvalidDocument(_)))}));let h=Wc();return c.forEach(((f,p)=>{const _=l.get(f);_!==void 0&&tu(_.mutation,p,Zn.empty(),vt.now()),pf(n,p)&&(h=h.insert(f,p))})),h}))}}class nM{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ve.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:di(a.createTime)}})(n)),ve.resolve()}getNamedQuery(e,n){return ve.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:G2(a.bundledQuery),readTime:di(a.readTime)}})(n)),ve.resolve()}}class rM{constructor(){this.overlays=new At(Me.comparator),this.qr=new Map}getOverlay(e,n){return ve.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Ua();return ve.forEach(n,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((a,l)=>{this.St(e,n,l)})),ve.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),ve.resolve()}getOverlaysForCollection(e,n,i){const a=Ua(),l=n.length+1,c=new Me(n.child("")),h=this.overlays.getIteratorFrom(c);for(;h.hasNext();){const f=h.getNext().value,p=f.getKey();if(!n.isPrefixOf(p.path))break;p.path.length===l&&f.largestBatchId>i&&a.set(f.getKey(),f)}return ve.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new At(((p,_)=>p-_));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===n&&p.largestBatchId>i){let _=l.get(p.largestBatchId);_===null&&(_=Ua(),l=l.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const h=Ua(),f=l.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,_)=>h.set(p,_))),!(h.size()>=a)););return ve.resolve(h)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const c=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new x2(n,i));let l=this.qr.get(n);l===void 0&&(l=Ze(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}class iM{constructor(){this.sessionToken=vn.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ve.resolve()}}class jy{constructor(){this.Qr=new rn(cn.$r),this.Ur=new rn(cn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new cn(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new cn(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new Me(new gt([])),i=new cn(n,e),a=new cn(n,e+1),l=[];return this.Ur.forEachInRange([i,a],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Me(new gt([])),i=new cn(n,e),a=new cn(n,e+1);let l=Ze();return this.Ur.forEachInRange([i,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const n=new cn(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class cn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Me.comparator(e.key,n.key)||Je(e.Yr,n.Yr)}static Kr(e,n){return Je(e.Yr,n.Yr)||Me.comparator(e.key,n.key)}}class sM{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new rn(cn.$r)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new v2(l,n,i,a);this.mutationQueue.push(c);for(const h of a)this.Zr=this.Zr.add(new cn(h.key,l)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return ve.resolve(c)}lookupMutationBatch(e,n){return ve.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return ve.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?vy:this.tr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new cn(n,0),a=new cn(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(c=>{const h=this.Xr(c.Yr);l.push(h)})),ve.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new rn(Je);return n.forEach((a=>{const l=new cn(a,0),c=new cn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(h=>{i=i.add(h.Yr)}))})),ve.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;Me.isDocumentKey(l)||(l=l.child(""));const c=new cn(new Me(l),0);let h=new rn(Je);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!i.isPrefixOf(p)&&(p.length===a&&(h=h.add(f.Yr)),!0)}),c),ve.resolve(this.ti(h))}ti(e){const n=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){ot(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ve.forEach(n.mutations,(a=>{const l=new cn(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new cn(n,0),a=this.Zr.firstAfterOrEqual(i);return ve.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class aM{constructor(e){this.ri=e,this.docs=(function(){return new At(Me.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,c=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return ve.resolve(i?i.document.mutableCopy():wn.newInvalidDocument(n))}getEntries(e,n){let i=Wi();return n.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():wn.newInvalidDocument(a))})),ve.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=Wi();const c=n.path,h=new Me(c.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(h);for(;f.hasNext();){const{key:p,value:{document:_}}=f.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||k5(O5(_),i)<=0||(a.has(_.key)||pf(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return ve.resolve(l)}getAllFromCollectionGroup(e,n,i,a){Be(9500)}ii(e,n){return ve.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new oM(this)}getSize(e){return ve.resolve(this.size)}}class oM extends Z2{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),ve.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class lM{constructor(e){this.persistence=e,this.si=new Xa((n=>Ey(n)),wy),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.oi=0,this._i=new jy,this.targetCount=0,this.ai=bl.ur()}forEachTarget(e,n){return this.si.forEach(((i,a)=>n(a))),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),ve.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new bl(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ve.resolve()}updateTargetData(e,n){return this.Pr(n),ve.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach(((c,h)=>{h.sequenceNumber<=n&&i.get(h.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,h.targetId)),a++)})),ve.waitFor(l).next((()=>a))}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return ve.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),ve.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),ve.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ve.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return ve.resolve(i)}containsKey(e,n){return ve.resolve(this._i.containsKey(n))}}class Jw{constructor(e,n){this.ui={},this.overlays={},this.ci=new df(0),this.li=!1,this.li=!0,this.hi=new iM,this.referenceDelegate=e(this),this.Pi=new lM(this),this.indexManager=new $2,this.remoteDocumentCache=(function(a){return new aM(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new H2(n),this.Ii=new nM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new rM,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new sM(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){Te("MemoryPersistence","Starting transaction:",e);const a=new cM(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,n){return ve.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class cM extends P5{constructor(e){super(),this.currentSequenceNumber=e}}class Iy{constructor(e){this.persistence=e,this.Ri=new jy,this.Vi=null}static mi(e){return new Iy(e)}get fi(){if(this.Vi)return this.Vi;throw Be(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),ve.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),ve.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ve.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.fi,(i=>{const a=Me.fromPath(i);return this.gi(e,a).next((l=>{l||n.removeEntry(a,Ve.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return ve.or([()=>ve.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Gh{constructor(e,n){this.persistence=e,this.pi=new Xa((i=>V5(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=J2(this,n)}static mi(e,n){return new Gh(e,n)}Ei(){}di(e){return ve.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((a=>i+a))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return ve.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?ve.resolve():n(a)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(c=>this.br(e,c,n).next((h=>{h||(i++,l.removeEntry(c,Ve.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ve.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ve.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ve.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ve.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Sh(e.data.value)),n}br(e,n,i){return ve.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return ve.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class My{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=Ze(),a=Ze();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new My(e,n.fromCache,i,a)}}class uM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class dM{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return eI()?8:L5(Cn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,n,a,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new uM;return this.Ss(e,n,c).next((h=>{if(l.result=h,this.Vs)return this.bs(e,n,c,h.size)}))})).next((()=>l.result))}bs(e,n,i,a){return i.documentReadCount<this.fs?(el()<=Xe.DEBUG&&Te("QueryEngine","SDK will not create cache indexes for query:",tl(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ve.resolve()):(el()<=Xe.DEBUG&&Te("QueryEngine","Query:",tl(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(el()<=Xe.DEBUG&&Te("QueryEngine","The SDK decides to create cache indexes for query:",tl(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ui(n))):ve.resolve())}ys(e,n){if(zx(n))return ve.resolve(null);let i=ui(n);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=Ng(n,null,"F"),i=ui(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=Ze(...l);return this.ps.getDocuments(e,c).next((h=>this.indexManager.getMinOffset(e,i).next((f=>{const p=this.Ds(n,h);return this.Cs(n,p,c,f.readTime)?this.ys(e,Ng(n,null,"F")):this.vs(e,p,n,f)}))))})))))}ws(e,n,i,a){return zx(n)||a.isEqual(Ve.min())?ve.resolve(null):this.ps.getDocuments(e,i).next((l=>{const c=this.Ds(n,l);return this.Cs(n,c,i,a)?ve.resolve(null):(el()<=Xe.DEBUG&&Te("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),tl(n)),this.vs(e,c,n,M5(a,au)).next((h=>h)))}))}Ds(e,n){let i=new rn(jw(e));return n.forEach(((a,l)=>{pf(e,l)&&(i=i.add(l))})),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return el()<=Xe.DEBUG&&Te("QueryEngine","Using full collection scan to execute query:",tl(n)),this.ps.getDocumentsMatchingQuery(e,n,Qs.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(n.forEach((c=>{l=l.insert(c.key,c)})),l)))}}const Oy="LocalStore",hM=3e8;class fM{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new At(Je),this.xs=new Xa((l=>Ey(l)),wy),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tM(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function mM(t,e,n,i){return new fM(t,e,n,i)}async function Zw(t,e){const n=ze(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],h=[];let f=Ze();for(const p of a){c.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}for(const p of l){h.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}return n.localDocuments.getDocuments(i,f).next((p=>({Ls:p,removedBatchIds:c,addedBatchIds:h})))}))}))}function pM(t,e){const n=ze(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,f,p,_){const b=p.batch,v=b.keys();let E=ve.resolve();return v.forEach((C=>{E=E.next((()=>_.getEntry(f,C))).next((w=>{const D=p.docVersions.get(C);ot(D!==null,48541),w.version.compareTo(D)<0&&(b.applyToRemoteDocument(w,p),w.isValidDocument()&&(w.setReadTime(p.commitVersion),_.addEntry(w)))}))})),E.next((()=>h.mutationQueue.removeMutationBatch(f,b)))})(n,i,e,l).next((()=>l.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(h){let f=Ze();for(let p=0;p<h.mutationResults.length;++p)h.mutationResults[p].transformResults.length>0&&(f=f.add(h.batch.mutations[p].key));return f})(e)))).next((()=>n.localDocuments.getDocuments(i,a)))}))}function e1(t){const e=ze(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function gM(t,e){const n=ze(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const h=[];e.targetChanges.forEach(((_,b)=>{const v=a.get(b);if(!v)return;h.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,b).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,b))));let E=v.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(b)!==null?E=E.withResumeToken(vn.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):_.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(_.resumeToken,i)),a=a.insert(b,E),(function(w,D,N){return w.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=hM?!0:N.addedDocuments.size+N.modifiedDocuments.size+N.removedDocuments.size>0})(v,E,_)&&h.push(n.Pi.updateTargetData(l,E))}));let f=Wi(),p=Ze();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),h.push(yM(l,c,e.documentUpdates).next((_=>{f=_.ks,p=_.qs}))),!i.isEqual(Ve.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((b=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));h.push(_)}return ve.waitFor(h).next((()=>c.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,f,p))).next((()=>f))})).then((l=>(n.Ms=a,l)))}function yM(t,e,n){let i=Ze(),a=Ze();return n.forEach((l=>i=i.add(l))),e.getEntries(t,i).next((l=>{let c=Wi();return n.forEach(((h,f)=>{const p=l.get(h);f.isFoundDocument()!==p.isFoundDocument()&&(a=a.add(h)),f.isNoDocument()&&f.version.isEqual(Ve.min())?(e.removeEntry(h,f.readTime),c=c.insert(h,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),c=c.insert(h,f)):Te(Oy,"Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",f.version)})),{ks:c,qs:a}}))}function _M(t,e){const n=ze(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=vy),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function bM(t,e){const n=ze(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return n.Pi.getTargetData(i,e).next((l=>l?(a=l,ve.resolve(a)):n.Pi.allocateTargetId(i).next((c=>(a=new Bs(e,c,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function Ug(t,e,n){const i=ze(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!Ol(c))throw c;Te(Oy,`Failed to update sequence numbers for target ${e}: ${c}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function eS(t,e,n){const i=ze(t);let a=Ve.min(),l=Ze();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(f,p,_){const b=ze(f),v=b.xs.get(_);return v!==void 0?ve.resolve(b.Ms.get(v)):b.Pi.getTargetData(p,_)})(i,c,ui(e)).next((h=>{if(h)return a=h.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(c,h.targetId).next((f=>{l=f}))})).next((()=>i.Fs.getDocumentsMatchingQuery(c,e,n?a:Ve.min(),n?l:Ze()))).next((h=>(vM(i,i2(e),h),{documents:h,Qs:l})))))}function vM(t,e,n){let i=t.Os.get(e)||Ve.min();n.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),t.Os.set(e,i)}class tS{constructor(){this.activeTargetIds=u2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class xM{constructor(){this.Mo=new tS,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new tS,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class SM{Oo(e){}shutdown(){}}const nS="ConnectivityMonitor";class rS{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Te(nS,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Te(nS,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let gh=null;function zg(){return gh===null?gh=(function(){return 268435456+Math.round(2147483648*Math.random())})():gh++,"0x"+gh.toString(16)}const ig="RestConnection",EM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wM{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===Bh?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const c=zg(),h=this.zo(e,n.toUriEncodedString());Te(ig,`Sending RPC '${e}' ${c}:`,h,i);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,l);const{host:p}=new URL(h),_=Dl(p);return this.Jo(e,h,f,i,_).then((b=>(Te(ig,`Received RPC '${e}' ${c}: `,b),b)),(b=>{throw ml(ig,`RPC '${e}' ${c} failed with error: `,b,"url: ",h,"request:",i),b}))}Ho(e,n,i,a,l,c){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Il})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,n){const i=EM[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class CM{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Sn="WebChannelConnection";class TM extends wM{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const c=zg();return new Promise(((h,f)=>{const p=new rw;p.setWithCredentials(!0),p.listenOnce(iw.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case xh.NO_ERROR:const b=p.getResponseJson();Te(Sn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(b)),h(b);break;case xh.TIMEOUT:Te(Sn,`RPC '${e}' ${c} timed out`),f(new we(_e.DEADLINE_EXCEEDED,"Request time out"));break;case xh.HTTP_ERROR:const v=p.getStatus();if(Te(Sn,`RPC '${e}' ${c} failed with status:`,v,"response text:",p.getResponseText()),v>0){let E=p.getResponseJson();Array.isArray(E)&&(E=E[0]);const C=E?.error;if(C&&C.status&&C.message){const w=(function(N){const U=N.toLowerCase().replace(/_/g,"-");return Object.values(_e).indexOf(U)>=0?U:_e.UNKNOWN})(C.status);f(new we(w,C.message))}else f(new we(_e.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new we(_e.UNAVAILABLE,"Connection failed."));break;default:Be(9055,{l_:e,streamId:c,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Te(Sn,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(a);Te(Sn,`RPC '${e}' ${c} sending request:`,a),p.send(n,"POST",_,i,15)}))}T_(e,n,i){const a=zg(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=ow(),h=aw(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,n,i),f.encodeInitMessageHeaders=!0;const _=l.join("");Te(Sn,`Creating RPC '${e}' stream ${a}: ${_}`,f);const b=c.createWebChannel(_,f);this.I_(b);let v=!1,E=!1;const C=new CM({Yo:D=>{E?Te(Sn,`Not sending because RPC '${e}' stream ${a} is closed:`,D):(v||(Te(Sn,`Opening RPC '${e}' stream ${a} transport.`),b.open(),v=!0),Te(Sn,`RPC '${e}' stream ${a} sending:`,D),b.send(D))},Zo:()=>b.close()}),w=(D,N,U)=>{D.listen(N,(k=>{try{U(k)}catch(X){setTimeout((()=>{throw X}),0)}}))};return w(b,Qc.EventType.OPEN,(()=>{E||(Te(Sn,`RPC '${e}' stream ${a} transport opened.`),C.o_())})),w(b,Qc.EventType.CLOSE,(()=>{E||(E=!0,Te(Sn,`RPC '${e}' stream ${a} transport closed`),C.a_(),this.E_(b))})),w(b,Qc.EventType.ERROR,(D=>{E||(E=!0,ml(Sn,`RPC '${e}' stream ${a} transport errored. Name:`,D.name,"Message:",D.message),C.a_(new we(_e.UNAVAILABLE,"The operation could not be completed")))})),w(b,Qc.EventType.MESSAGE,(D=>{if(!E){const N=D.data[0];ot(!!N,16349);const U=N,k=U?.error||U[0]?.error;if(k){Te(Sn,`RPC '${e}' stream ${a} received error:`,k);const X=k.status;let G=(function(R){const j=Qt[R];if(j!==void 0)return zw(j)})(X),K=k.message;G===void 0&&(G=_e.INTERNAL,K="Unknown error status: "+X+" with message "+k.message),E=!0,C.a_(new we(G,K)),b.close()}else Te(Sn,`RPC '${e}' stream ${a} received:`,N),C.u_(N)}})),w(h,sw.STAT_EVENT,(D=>{D.stat===Rg.PROXY?Te(Sn,`RPC '${e}' stream ${a} detected buffering proxy`):D.stat===Rg.NOPROXY&&Te(Sn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{C.__()}),0),C}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function sg(){return typeof document<"u"?document:null}function vf(t){return new j2(t,!0)}class t1{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&Te("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const iS="PersistentStream";class n1{constructor(e,n,i,a,l,c,h,f){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=h,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new t1(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===_e.RESOURCE_EXHAUSTED?(Qi(n.toString()),Qi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===_e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===n&&this.G_(i,a)}),(i=>{e((()=>{const a=new we(_e.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Te(iS,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Te(iS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class AM extends n1{constructor(e,n,i,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=O2(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Ve.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Ve.min():c.readTime?di(c.readTime):Ve.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=Vg(this.serializer),n.addTarget=(function(l,c){let h;const f=c.target;if(h=Og(f)?{documents:P2(l,f)}:{query:L2(l,f).ft},h.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){h.resumeToken=Hw(l,c.resumeToken);const p=Pg(l,c.expectedCount);p!==null&&(h.expectedCount=p)}else if(c.snapshotVersion.compareTo(Ve.min())>0){h.readTime=Hh(l,c.snapshotVersion.toTimestamp());const p=Pg(l,c.expectedCount);p!==null&&(h.expectedCount=p)}return h})(this.serializer,e);const i=V2(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=Vg(this.serializer),n.removeTarget=e,this.q_(n)}}class RM extends n1{constructor(e,n,i,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=N2(e.writeResults,e.commitTime),i=di(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=Vg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>k2(this.serializer,i)))};this.q_(n)}}class DM{}class jM extends DM{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new we(_e.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,Lg(n,i),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new we(_e.UNKNOWN,l.toString())}))}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,h])=>this.connection.Ho(e,Lg(n,i),a,c,h,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new we(_e.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class IM{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Qi(n),this.aa=!1):Te("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const $a="RemoteStore";class MM{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{i.enqueueAndForget((async()=>{Ja(this)&&(Te($a,"Restarting streams for network reachability change."),await(async function(f){const p=ze(f);p.Ea.add(4),await Tu(p),p.Ra.set("Unknown"),p.Ea.delete(4),await xf(p)})(this))}))})),this.Ra=new IM(i,a)}}async function xf(t){if(Ja(t))for(const e of t.da)await e(!0)}async function Tu(t){for(const e of t.da)await e(!1)}function r1(t,e){const n=ze(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Ly(n)?Py(n):kl(n).O_()&&Ny(n,e))}function ky(t,e){const n=ze(t),i=kl(n);n.Ia.delete(e),i.O_()&&i1(n,e),n.Ia.size===0&&(i.O_()?i.L_():Ja(n)&&n.Ra.set("Unknown"))}function Ny(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}kl(t).Y_(e)}function i1(t,e){t.Va.Ue(e),kl(t).Z_(e)}function Py(t){t.Va=new T2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),kl(t).start(),t.Ra.ua()}function Ly(t){return Ja(t)&&!kl(t).x_()&&t.Ia.size>0}function Ja(t){return ze(t).Ea.size===0}function s1(t){t.Va=void 0}async function OM(t){t.Ra.set("Online")}async function kM(t){t.Ia.forEach(((e,n)=>{Ny(t,e)}))}async function NM(t,e){s1(t),Ly(t)?(t.Ra.ha(e),Py(t)):t.Ra.set("Unknown")}async function PM(t,e,n){if(t.Ra.set("Online"),e instanceof qw&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const h of l.targetIds)a.Ia.has(h)&&(await a.remoteSyncer.rejectListen(h,c),a.Ia.delete(h),a.Va.removeTarget(h))})(t,e)}catch(i){Te($a,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await $h(t,i)}else if(e instanceof Ch?t.Va.Ze(e):e instanceof Fw?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ve.min()))try{const i=await e1(t.localStore);n.compareTo(i)>=0&&await(function(l,c){const h=l.Va.Tt(c);return h.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const _=l.Ia.get(p);_&&l.Ia.set(p,_.withResumeToken(f.resumeToken,c))}})),h.targetMismatches.forEach(((f,p)=>{const _=l.Ia.get(f);if(!_)return;l.Ia.set(f,_.withResumeToken(vn.EMPTY_BYTE_STRING,_.snapshotVersion)),i1(l,f);const b=new Bs(_.target,f,p,_.sequenceNumber);Ny(l,b)})),l.remoteSyncer.applyRemoteEvent(h)})(t,n)}catch(i){Te($a,"Failed to raise snapshot:",i),await $h(t,i)}}async function $h(t,e,n){if(!Ol(e))throw e;t.Ea.add(1),await Tu(t),t.Ra.set("Offline"),n||(n=()=>e1(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Te($a,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await xf(t)}))}function a1(t,e){return e().catch((n=>$h(t,n,e)))}async function Sf(t){const e=ze(t),n=Xs(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vy;for(;LM(e);)try{const a=await _M(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,BM(e,a)}catch(a){await $h(e,a)}o1(e)&&l1(e)}function LM(t){return Ja(t)&&t.Ta.length<10}function BM(t,e){t.Ta.push(e);const n=Xs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function o1(t){return Ja(t)&&!Xs(t).x_()&&t.Ta.length>0}function l1(t){Xs(t).start()}async function VM(t){Xs(t).ra()}async function UM(t){const e=Xs(t);for(const n of t.Ta)e.ea(n.mutations)}async function zM(t,e,n){const i=t.Ta.shift(),a=Ay.from(i,e,n);await a1(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await Sf(t)}async function FM(t,e){e&&Xs(t).X_&&await(async function(i,a){if((function(c){return E2(c)&&c!==_e.ABORTED})(a.code)){const l=i.Ta.shift();Xs(i).B_(),await a1(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Sf(i)}})(t,e),o1(t)&&l1(t)}async function sS(t,e){const n=ze(t);n.asyncQueue.verifyOperationInProgress(),Te($a,"RemoteStore received new credentials");const i=Ja(n);n.Ea.add(3),await Tu(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await xf(n)}async function qM(t,e){const n=ze(t);e?(n.Ea.delete(2),await xf(n)):e||(n.Ea.add(2),await Tu(n),n.Ra.set("Unknown"))}function kl(t){return t.ma||(t.ma=(function(n,i,a){const l=ze(n);return l.sa(),new AM(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:OM.bind(null,t),t_:kM.bind(null,t),r_:NM.bind(null,t),H_:PM.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Ly(t)?Py(t):t.Ra.set("Unknown")):(await t.ma.stop(),s1(t))}))),t.ma}function Xs(t){return t.fa||(t.fa=(function(n,i,a){const l=ze(n);return l.sa(),new RM(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:VM.bind(null,t),r_:FM.bind(null,t),ta:UM.bind(null,t),na:zM.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await Sf(t)):(await t.fa.stop(),t.Ta.length>0&&(Te($a,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class By{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Hi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const c=Date.now()+i,h=new By(e,n,c,a,l);return h.start(i),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vy(t,e){if(Qi("AsyncQueue",`${e}: ${t}`),Ol(t))return new we(_e.UNAVAILABLE,`${e}: ${t}`);throw t}class sl{static emptySet(e){return new sl(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||Me.comparator(n.key,i.key):(n,i)=>Me.comparator(n.key,i.key),this.keyedMap=Wc(),this.sortedSet=new At(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof sl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new sl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class aS{constructor(){this.ga=new At(Me.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Be(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class vl{constructor(e,n,i,a,l,c,h,f,p){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=h,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,n,i,a,l){const c=[];return n.forEach((h=>{c.push({type:0,doc:h})})),new vl(e,n,sl.emptySet(n),c,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}class HM{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class GM{constructor(){this.queries=oS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=ze(n),l=a.queries;a.queries=oS(),l.forEach(((c,h)=>{for(const f of h.Sa)f.onError(i)}))})(this,new we(_e.ABORTED,"Firestore shutting down"))}}function oS(){return new Xa((t=>Dw(t)),mf)}async function c1(t,e){const n=ze(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new HM,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(c){const h=Vy(c,`Initialization of query '${tl(e.query)}' failed`);return void e.onError(h)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&Uy(n)}async function u1(t,e){const n=ze(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function $M(t,e){const n=ze(t);let i=!1;for(const a of e){const l=a.query,c=n.queries.get(l);if(c){for(const h of c.Sa)h.Fa(a)&&(i=!0);c.wa=a}}i&&Uy(n)}function QM(t,e,n){const i=ze(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function Uy(t){t.Ca.forEach((e=>{e.next()}))}var Fg,lS;(lS=Fg||(Fg={})).Ma="default",lS.Cache="cache";class d1{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new vl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=vl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Fg.Cache}}class h1{constructor(e){this.key=e}}class f1{constructor(e){this.key=e}}class WM{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ze(),this.mutatedKeys=Ze(),this.eu=jw(e),this.tu=new sl(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new aS,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,c=a,h=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,p=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,b)=>{const v=a.get(_),E=pf(this.query,b)?b:null,C=!!v&&this.mutatedKeys.has(v.key),w=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let D=!1;v&&E?v.data.isEqual(E.data)?C!==w&&(i.track({type:3,doc:E}),D=!0):this.su(v,E)||(i.track({type:2,doc:E}),D=!0,(f&&this.eu(E,f)>0||p&&this.eu(E,p)<0)&&(h=!0)):!v&&E?(i.track({type:0,doc:E}),D=!0):v&&!E&&(i.track({type:1,doc:v}),D=!0,(f||p)&&(h=!0)),D&&(E?(c=c.add(E),l=w?l.add(_):l.delete(_)):(c=c.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:c,iu:i,Cs:h,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,b)=>(function(E,C){const w=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Be(20277,{Rt:D})}};return w(E)-w(C)})(_.type,b.type)||this.eu(_.doc,b.doc))),this.ou(i),a=a??!1;const h=n&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,p=f!==this.Za;return this.Za=f,c.length!==0||p?{snapshot:new vl(this.query,e.tu,l,c,e.mutatedKeys,f===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new aS,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ze(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new f1(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new h1(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=Ze();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return vl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const zy="SyncEngine";class KM{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class YM{constructor(e){this.key=e,this.hu=!1}}class XM{constructor(e,n,i,a,l,c){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new Xa((h=>Dw(h)),mf),this.Iu=new Map,this.Eu=new Set,this.du=new At(Me.comparator),this.Au=new Map,this.Ru=new jy,this.Vu={},this.mu=new Map,this.fu=bl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function JM(t,e,n=!0){const i=b1(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await m1(i,e,n,!0),a}async function ZM(t,e){const n=b1(t);await m1(n,e,!0,!1)}async function m1(t,e,n,i){const a=await bM(t.localStore,ui(e)),l=a.targetId,c=t.sharedClientState.addLocalQueryTarget(l,n);let h;return i&&(h=await eO(t,e,l,c==="current",a.resumeToken)),t.isPrimaryClient&&n&&r1(t.remoteStore,a),h}async function eO(t,e,n,i,a){t.pu=(b,v,E)=>(async function(w,D,N,U){let k=D.view.ru(N);k.Cs&&(k=await eS(w.localStore,D.query,!1).then((({documents:O})=>D.view.ru(O,k))));const X=U&&U.targetChanges.get(D.targetId),G=U&&U.targetMismatches.get(D.targetId)!=null,K=D.view.applyChanges(k,w.isPrimaryClient,X,G);return uS(w,D.targetId,K.au),K.snapshot})(t,b,v,E);const l=await eS(t.localStore,e,!0),c=new WM(e,l.Qs),h=c.ru(l.documents),f=Cu.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),p=c.applyChanges(h,t.isPrimaryClient,f);uS(t,n,p.au);const _=new KM(e,n,c);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),p.snapshot}async function tO(t,e,n){const i=ze(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((c=>!mf(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await Ug(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&ky(i.remoteStore,a.targetId),qg(i,a.targetId)})).catch(Ml)):(qg(i,a.targetId),await Ug(i.localStore,a.targetId,!0))}async function nO(t,e){const n=ze(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),ky(n.remoteStore,i.targetId))}async function rO(t,e,n){const i=uO(t);try{const a=await(function(c,h){const f=ze(c),p=vt.now(),_=h.reduce(((E,C)=>E.add(C.key)),Ze());let b,v;return f.persistence.runTransaction("Locally write mutations","readwrite",(E=>{let C=Wi(),w=Ze();return f.Ns.getEntries(E,_).next((D=>{C=D,C.forEach(((N,U)=>{U.isValidDocument()||(w=w.add(N))}))})).next((()=>f.localDocuments.getOverlayedDocuments(E,C))).next((D=>{b=D;const N=[];for(const U of h){const k=_2(U,b.get(U.key).overlayedDocument);k!=null&&N.push(new na(U.key,k,xw(k.value.mapValue),Fn.exists(!0)))}return f.mutationQueue.addMutationBatch(E,p,N,h)})).next((D=>{v=D;const N=D.applyToLocalDocumentSet(b,w);return f.documentOverlayCache.saveOverlays(E,D.batchId,N)}))})).then((()=>({batchId:v.batchId,changes:Mw(b)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(c,h,f){let p=c.Vu[c.currentUser.toKey()];p||(p=new At(Je)),p=p.insert(h,f),c.Vu[c.currentUser.toKey()]=p})(i,a.batchId,n),await Au(i,a.changes),await Sf(i.remoteStore)}catch(a){const l=Vy(a,"Failed to persist write");n.reject(l)}}async function p1(t,e){const n=ze(t);try{const i=await gM(n.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=n.Au.get(l);c&&(ot(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?ot(c.hu,14607):a.removedDocuments.size>0&&(ot(c.hu,42227),c.hu=!1))})),await Au(n,i,e)}catch(i){await Ml(i)}}function cS(t,e,n){const i=ze(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach(((l,c)=>{const h=c.view.va(e);h.snapshot&&a.push(h.snapshot)})),(function(c,h){const f=ze(c);f.onlineState=h;let p=!1;f.queries.forEach(((_,b)=>{for(const v of b.Sa)v.va(h)&&(p=!0)})),p&&Uy(f)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function iO(t,e,n){const i=ze(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let c=new At(Me.comparator);c=c.insert(l,wn.newNoDocument(l,Ve.min()));const h=Ze().add(l),f=new bf(Ve.min(),new Map,new At(Je),c,h);await p1(i,f),i.du=i.du.remove(l),i.Au.delete(e),Fy(i)}else await Ug(i.localStore,e,!1).then((()=>qg(i,e,n))).catch(Ml)}async function sO(t,e){const n=ze(t),i=e.batch.batchId;try{const a=await pM(n.localStore,e);y1(n,i,null),g1(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Au(n,a)}catch(a){await Ml(a)}}async function aO(t,e,n){const i=ze(t);try{const a=await(function(c,h){const f=ze(c);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let _;return f.mutationQueue.lookupMutationBatch(p,h).next((b=>(ot(b!==null,37113),_=b.keys(),f.mutationQueue.removeMutationBatch(p,b)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,_,h))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_))).next((()=>f.localDocuments.getDocuments(p,_)))}))})(i.localStore,e);y1(i,e,n),g1(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Au(i,a)}catch(a){await Ml(a)}}function g1(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function y1(t,e,n){const i=ze(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function qg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||_1(t,i)}))}function _1(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(ky(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Fy(t))}function uS(t,e,n){for(const i of n)i instanceof h1?(t.Ru.addReference(i.key,e),oO(t,i)):i instanceof f1?(Te(zy,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||_1(t,i.key)):Be(19791,{wu:i})}function oO(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(Te(zy,"New document in limbo: "+n),t.Eu.add(i),Fy(t))}function Fy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Me(gt.fromString(e)),i=t.fu.next();t.Au.set(i,new YM(n)),t.du=t.du.insert(n,i),r1(t.remoteStore,new Bs(ui(Cy(n.path)),i,"TargetPurposeLimboResolution",df.ce))}}async function Au(t,e,n){const i=ze(t),a=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((h,f)=>{c.push(i.pu(f,e,n).then((p=>{if((p||n)&&i.isPrimaryClient){const _=p?!p.fromCache:n?.targetChanges.get(f.targetId)?.current;i.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(p){a.push(p);const _=My.As(f.targetId,p);l.push(_)}})))})),await Promise.all(c),i.Pu.H_(a),await(async function(f,p){const _=ze(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>ve.forEach(p,(v=>ve.forEach(v.Es,(E=>_.persistence.referenceDelegate.addReference(b,v.targetId,E))).next((()=>ve.forEach(v.ds,(E=>_.persistence.referenceDelegate.removeReference(b,v.targetId,E)))))))))}catch(b){if(!Ol(b))throw b;Te(Oy,"Failed to update sequence numbers: "+b)}for(const b of p){const v=b.targetId;if(!b.fromCache){const E=_.Ms.get(v),C=E.snapshotVersion,w=E.withLastLimboFreeSnapshotVersion(C);_.Ms=_.Ms.insert(v,w)}}})(i.localStore,l))}async function lO(t,e){const n=ze(t);if(!n.currentUser.isEqual(e)){Te(zy,"User change. New user:",e.toKey());const i=await Zw(n.localStore,e);n.currentUser=e,(function(l,c){l.mu.forEach((h=>{h.forEach((f=>{f.reject(new we(_e.CANCELLED,c))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Au(n,i.Ls)}}function cO(t,e){const n=ze(t),i=n.Au.get(e);if(i&&i.hu)return Ze().add(i.key);{let a=Ze();const l=n.Iu.get(e);if(!l)return a;for(const c of l){const h=n.Tu.get(c);a=a.unionWith(h.view.nu)}return a}}function b1(t){const e=ze(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=p1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=cO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=iO.bind(null,e),e.Pu.H_=$M.bind(null,e.eventManager),e.Pu.yu=QM.bind(null,e.eventManager),e}function uO(t){const e=ze(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aO.bind(null,e),e}class Qh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return mM(this.persistence,new dM,e.initialUser,this.serializer)}Cu(e){return new Jw(Iy.mi,this.serializer)}Du(e){return new xM}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qh.provider={build:()=>new Qh};class dO extends Qh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ot(this.persistence.referenceDelegate instanceof Gh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new Y2(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Un.withCacheSize(this.cacheSizeBytes):Un.DEFAULT;return new Jw((i=>Gh.mi(i,n)),this.serializer)}}class Hg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>cS(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=lO.bind(null,this.syncEngine),await qM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new GM})()}createDatastore(e){const n=vf(e.databaseInfo.databaseId),i=(function(l){return new TM(l)})(e.databaseInfo);return(function(l,c,h,f){return new jM(l,c,h,f)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,a,l,c,h){return new MM(i,a,l,c,h)})(this.localStore,this.datastore,e.asyncQueue,(n=>cS(this.syncEngine,n,0)),(function(){return rS.v()?new rS:new SM})())}createSyncEngine(e,n){return(function(a,l,c,h,f,p,_){const b=new XM(a,l,c,h,f,p);return _&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=ze(n);Te($a,"RemoteStore shutting down."),i.Ea.add(5),await Tu(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Hg.provider={build:()=>new Hg};class v1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Qi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Js="FirestoreClient";class hO{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=En.UNAUTHENTICATED,this.clientId=by.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{Te(Js,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Te(Js,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=Vy(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function ag(t,e){t.asyncQueue.verifyOperationInProgress(),Te(Js,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async a=>{i.isEqual(a)||(await Zw(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function dS(t,e){t.asyncQueue.verifyOperationInProgress();const n=await fO(t);Te(Js,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>sS(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,a)=>sS(e.remoteStore,a))),t._onlineComponents=e}async function fO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Te(Js,"Using user provided OfflineComponentProvider");try{await ag(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===_e.FAILED_PRECONDITION||a.code===_e.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;ml("Error using user provided cache. Falling back to memory cache: "+n),await ag(t,new Qh)}}else Te(Js,"Using default OfflineComponentProvider"),await ag(t,new dO(void 0));return t._offlineComponents}async function x1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Te(Js,"Using user provided OnlineComponentProvider"),await dS(t,t._uninitializedComponentsProvider._online)):(Te(Js,"Using default OnlineComponentProvider"),await dS(t,new Hg))),t._onlineComponents}function mO(t){return x1(t).then((e=>e.syncEngine))}async function S1(t){const e=await x1(t),n=e.eventManager;return n.onListen=JM.bind(null,e.syncEngine),n.onUnlisten=tO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=ZM.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=nO.bind(null,e.syncEngine),n}function pO(t,e,n={}){const i=new Hi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,h,f,p){const _=new v1({next:v=>{_.Nu(),c.enqueueAndForget((()=>u1(l,b)));const E=v.docs.has(h);!E&&v.fromCache?p.reject(new we(_e.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&v.fromCache&&f&&f.source==="server"?p.reject(new we(_e.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(v)},error:v=>p.reject(v)}),b=new d1(Cy(h.path),_,{includeMetadataChanges:!0,qa:!0});return c1(l,b)})(await S1(t),t.asyncQueue,e,n,i))),i.promise}function gO(t,e,n={}){const i=new Hi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,c,h,f,p){const _=new v1({next:v=>{_.Nu(),c.enqueueAndForget((()=>u1(l,b))),v.fromCache&&f.source==="server"?p.reject(new we(_e.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(v)},error:v=>p.reject(v)}),b=new d1(h,_,{includeMetadataChanges:!0,qa:!0});return c1(l,b)})(await S1(t),t.asyncQueue,e,n,i))),i.promise}function E1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const hS=new Map;const w1="firestore.googleapis.com",fS=!0;class mS{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new we(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=w1,this.ssl=fS}else this.host=e.host,this.ssl=e.ssl??fS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Xw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<W2)throw new we(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}I5("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=E1(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new we(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new we(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new we(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ef{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new x5;switch(i.type){case"firstParty":return new C5(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new we(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=hS.get(n);i&&(Te("ComponentProvider","Removing Datastore"),hS.delete(n),i.terminate())})(this),Promise.resolve()}}function yO(t,e,n,i={}){t=Br(t,Ef);const a=Dl(e),l=t._getSettings(),c={...l,emulatorOptions:t._getEmulatorOptions()},h=`${e}:${n}`;a&&(WE(`https://${h}`),KE("Firestore",!0)),l.host!==w1&&l.host!==h&&ml("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...l,host:h,ssl:a,emulatorOptions:i};if(!$s(f,c)&&(t._setSettings(f),i.mockUserToken)){let p,_;if(typeof i.mockUserToken=="string")p=i.mockUserToken,_=En.MOCK_USER;else{p=Gj(i.mockUserToken,t._app?.options.projectId);const b=i.mockUserToken.sub||i.mockUserToken.user_id;if(!b)throw new we(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new En(b)}t._authCredentials=new S5(new cw(p,_))}}class Nl{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Nl(this.firestore,e,this._query)}}class Nt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nt(this.firestore,e,this._key)}toJSON(){return{type:Nt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(Su(n,Nt._jsonSchema))return new Nt(e,i||null,new Me(gt.fromString(n.referencePath)))}}Nt._jsonSchemaVersion="firestore/documentReference/1.0",Nt._jsonSchema={type:Yt("string",Nt._jsonSchemaVersion),referencePath:Yt("string")};class Hs extends Nl{constructor(e,n,i){super(e,n,Cy(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nt(this.firestore,null,new Me(e))}withConverter(e){return new Hs(this.firestore,e,this._path)}}function _O(t,e,...n){if(t=Xt(t),uw("collection","path",e),t instanceof Ef){const i=gt.fromString(e,...n);return Ax(i),new Hs(t,null,i)}{if(!(t instanceof Nt||t instanceof Hs))throw new we(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(gt.fromString(e,...n));return Ax(i),new Hs(t.firestore,null,i)}}function Pl(t,e,...n){if(t=Xt(t),arguments.length===1&&(e=by.newId()),uw("doc","path",e),t instanceof Ef){const i=gt.fromString(e,...n);return Tx(i),new Nt(t,null,new Me(i))}{if(!(t instanceof Nt||t instanceof Hs))throw new we(_e.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(gt.fromString(e,...n));return Tx(i),new Nt(t.firestore,t instanceof Hs?t.converter:null,new Me(i))}}const pS="AsyncQueue";class gS{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new t1(this,"async_queue_retry"),this._c=()=>{const i=sg();i&&Te(pS,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=sg();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=sg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Hi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ol(e))throw e;Te(pS,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Qi("INTERNAL UNHANDLED ERROR: ",yS(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=By.createAndSchedule(this,e,n,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Be(47125,{Pc:yS(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function yS(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Za extends Ef{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new gS,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new gS(e),this._firestoreClient=void 0,await e}}}function bO(t,e){const n=typeof t=="object"?t:ZE(),i=typeof t=="string"?t:Bh,a=gy(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=qj("firestore");l&&yO(a,...l)}return a}function wf(t){if(t._terminated)throw new we(_e.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||vO(t),t._firestoreClient}function vO(t){const e=t._freezeSettings(),n=(function(a,l,c,h){return new F5(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,E1(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new hO(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(t._componentsProvider))}class br{constructor(e){this._byteString=e}static fromBase64String(e){try{return new br(vn.fromBase64String(e))}catch(n){throw new we(_e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new br(vn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:br._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Su(e,br._jsonSchema))return br.fromBase64String(e.bytes)}}br._jsonSchemaVersion="firestore/bytes/1.0",br._jsonSchema={type:Yt("string",br._jsonSchemaVersion),bytes:Yt("string")};class Ru{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new we(_e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Cf{constructor(e){this._methodName=e}}class hi{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new we(_e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new we(_e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Je(this._lat,e._lat)||Je(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:hi._jsonSchemaVersion}}static fromJSON(e){if(Su(e,hi._jsonSchema))return new hi(e.latitude,e.longitude)}}hi._jsonSchemaVersion="firestore/geoPoint/1.0",hi._jsonSchema={type:Yt("string",hi._jsonSchemaVersion),latitude:Yt("number"),longitude:Yt("number")};class fi{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Su(e,fi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new fi(e.vectorValues);throw new we(_e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fi._jsonSchemaVersion="firestore/vectorValue/1.0",fi._jsonSchema={type:Yt("string",fi._jsonSchemaVersion),vectorValues:Yt("object")};const xO=/^__.*__$/;class SO{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new na(e,this.data,this.fieldMask,n,this.fieldTransforms):new wu(e,this.data,n,this.fieldTransforms)}}class C1{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new na(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function T1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Be(40011,{Ac:t})}}class Tf{constructor(e,n,i,a,l,c){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Tf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Wh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(T1(this.Ac)&&xO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class EO{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||vf(e)}Cc(e,n,i,a=!1){return new Tf({Ac:e,methodName:n,Dc:i,path:bn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Af(t){const e=t._freezeSettings(),n=vf(t._databaseId);return new EO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function A1(t,e,n,i,a,l={}){const c=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);Hy("Data must be an object, but it was:",c,i);const h=j1(i,c);let f,p;if(l.merge)f=new Zn(c.fieldMask),p=c.fieldTransforms;else if(l.mergeFields){const _=[];for(const b of l.mergeFields){const v=Gg(e,b,n);if(!c.contains(v))throw new we(_e.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);M1(_,v)||_.push(v)}f=new Zn(_),p=c.fieldTransforms.filter((b=>f.covers(b.field)))}else f=null,p=c.fieldTransforms;return new SO(new zn(h),f,p)}class Du extends Cf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Du}}function wO(t,e,n){return new Tf({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class qy extends Cf{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=wO(this,e,!0),i=this.vc.map((l=>Ll(l,n))),a=new _l(i);return new m2(e.path,a)}isEqual(e){return e instanceof qy&&$s(this.vc,e.vc)}}function R1(t,e,n,i){const a=t.Cc(1,e,n);Hy("Data must be an object, but it was:",a,i);const l=[],c=zn.empty();ta(i,((f,p)=>{const _=Gy(e,f,n);p=Xt(p);const b=a.yc(_);if(p instanceof Du)l.push(_);else{const v=Ll(p,b);v!=null&&(l.push(_),c.set(_,v))}}));const h=new Zn(l);return new C1(c,h,a.fieldTransforms)}function D1(t,e,n,i,a,l){const c=t.Cc(1,e,n),h=[Gg(e,i,n)],f=[a];if(l.length%2!=0)throw new we(_e.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<l.length;v+=2)h.push(Gg(e,l[v])),f.push(l[v+1]);const p=[],_=zn.empty();for(let v=h.length-1;v>=0;--v)if(!M1(p,h[v])){const E=h[v];let C=f[v];C=Xt(C);const w=c.yc(E);if(C instanceof Du)p.push(E);else{const D=Ll(C,w);D!=null&&(p.push(E),_.set(E,D))}}const b=new Zn(p);return new C1(_,b,c.fieldTransforms)}function CO(t,e,n,i=!1){return Ll(n,t.Cc(i?4:3,e))}function Ll(t,e){if(I1(t=Xt(t)))return Hy("Unsupported field value:",e,t),j1(t,e);if(t instanceof Cf)return(function(i,a){if(!T1(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let c=0;for(const h of i){let f=Ll(h,a.wc(c));f==null&&(f={nullValue:"NULL_VALUE"}),l.push(f),c++}return{arrayValue:{values:l}}})(t,e)}return(function(i,a){if((i=Xt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return d2(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=vt.fromDate(i);return{timestampValue:Hh(a.serializer,l)}}if(i instanceof vt){const l=new vt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Hh(a.serializer,l)}}if(i instanceof hi)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof br)return{bytesValue:Hw(a.serializer,i._byteString)};if(i instanceof Nt){const l=a.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw a.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Dy(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof fi)return(function(c,h){return{mapValue:{fields:{[bw]:{stringValue:vw},[Vh]:{arrayValue:{values:c.toArray().map((p=>{if(typeof p!="number")throw h.Sc("VectorValues must only contain numeric values.");return Ty(h.serializer,p)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${uf(i)}`)})(t,e)}function j1(t,e){const n={};return fw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ta(t,((i,a)=>{const l=Ll(a,e.mc(i));l!=null&&(n[i]=l)})),{mapValue:{fields:n}}}function I1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vt||t instanceof hi||t instanceof br||t instanceof Nt||t instanceof Cf||t instanceof fi)}function Hy(t,e,n){if(!I1(n)||!dw(n)){const i=uf(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function Gg(t,e,n){if((e=Xt(e))instanceof Ru)return e._internalPath;if(typeof e=="string")return Gy(t,e);throw Wh("Field path arguments must be of type string or ",t,!1,void 0,n)}const TO=new RegExp("[~\\*/\\[\\]]");function Gy(t,e,n){if(e.search(TO)>=0)throw Wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ru(...e.split("."))._internalPath}catch{throw Wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Wh(t,e,n,i,a){const l=i&&!i.isEmpty(),c=a!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let f="";return(l||c)&&(f+=" (found",l&&(f+=` in field ${i}`),c&&(f+=` in document ${a}`),f+=")"),new we(_e.INVALID_ARGUMENT,h+t+f)}function M1(t,e){return t.some((n=>n.isEqual(e)))}class O1{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Nt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new AO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field($y("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class AO extends O1{data(){return super.data()}}function $y(t,e){return typeof e=="string"?Gy(t,e):e instanceof Ru?e._internalPath:e._delegate._internalPath}function RO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new we(_e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Qy{}class DO extends Qy{}function jO(t,e,...n){let i=[];e instanceof Qy&&i.push(e),i=i.concat(n),(function(l){const c=l.filter((f=>f instanceof Wy)).length,h=l.filter((f=>f instanceof Rf)).length;if(c>1||c>0&&h>0)throw new we(_e.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)t=a._apply(t);return t}class Rf extends DO{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new Rf(e,n,i)}_apply(e){const n=this._parse(e);return k1(e._query,n),new Nl(e.firestore,e.converter,kg(e._query,n))}_parse(e){const n=Af(e.firestore);return(function(l,c,h,f,p,_,b){let v;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new we(_e.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){bS(b,_);const C=[];for(const w of b)C.push(_S(f,l,w));v={arrayValue:{values:C}}}else v=_S(f,l,b)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||bS(b,_),v=CO(h,c,b,_==="in"||_==="not-in");return Kt.create(p,_,v)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function IO(t,e,n){const i=e,a=$y("where",t);return Rf._create(a,i,n)}class Wy extends Qy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Wy(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Vr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,l){let c=a;const h=l.getFlattenedFilters();for(const f of h)k1(c,f),c=kg(c,f)})(e._query,n),new Nl(e.firestore,e.converter,kg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function _S(t,e,n){if(typeof(n=Xt(n))=="string"){if(n==="")throw new we(_e.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rw(e)&&n.indexOf("/")!==-1)throw new we(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(gt.fromString(n));if(!Me.isDocumentKey(i))throw new we(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Nx(t,new Me(i))}if(n instanceof Nt)return Nx(t,n._key);throw new we(_e.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uf(n)}.`)}function bS(t,e){if(!Array.isArray(t)||t.length===0)throw new we(_e.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function k1(t,e){const n=(function(a,l){for(const c of a)for(const h of c.getFlattenedFilters())if(l.indexOf(h.op)>=0)return h.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new we(_e.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new we(_e.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class MO{convertValue(e,n="none"){switch(Ys(e)){case 0:return null;case 1:return e.booleanValue;case 2:return kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ks(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Be(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return ta(e,((a,l)=>{i[a]=this.convertValue(l,n)})),i}convertVectorValue(e){const n=e.fields?.[Vh].arrayValue?.values?.map((i=>kt(i.doubleValue)));return new fi(n)}convertGeoPoint(e){return new hi(kt(e.latitude),kt(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=ff(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(ou(e));default:return null}}convertTimestamp(e){const n=Ws(e);return new vt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=gt.fromString(e);ot(Yw(i),9688,{name:e});const a=new lu(i.get(1),i.get(3)),l=new Me(i.popFirst(5));return a.isEqual(n)||Qi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function N1(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Yc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class za extends O1{constructor(e,n,i,a,l,c){super(e,n,i,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Th(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field($y("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new we(_e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=za._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}za._jsonSchemaVersion="firestore/documentSnapshot/1.0",za._jsonSchema={type:Yt("string",za._jsonSchemaVersion),bundleSource:Yt("string","DocumentSnapshot"),bundleName:Yt("string"),bundle:Yt("string")};class Th extends za{data(e={}){return super.data(e)}}class al{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Yc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new Th(this._firestore,this._userDataWriter,i.key,i,new Yc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new we(_e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((h=>{const f=new Th(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Yc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);return h.doc,{type:"added",doc:f,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((h=>l||h.type!==3)).map((h=>{const f=new Th(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Yc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);let p=-1,_=-1;return h.type!==0&&(p=c.indexOf(h.doc.key),c=c.delete(h.doc.key)),h.type!==1&&(c=c.add(h.doc),_=c.indexOf(h.doc.key)),{type:OO(h.type),doc:f,oldIndex:p,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new we(_e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=al._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=by.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function OO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Be(61501,{type:t})}}function kO(t){t=Br(t,Nt);const e=Br(t.firestore,Za);return pO(wf(e),t._key).then((n=>VO(e,t,n)))}al._jsonSchemaVersion="firestore/querySnapshot/1.0",al._jsonSchema={type:Yt("string",al._jsonSchemaVersion),bundleSource:Yt("string","QuerySnapshot"),bundleName:Yt("string"),bundle:Yt("string")};class P1 extends MO{constructor(e){super(),this.firestore=e}convertBytes(e){return new br(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Nt(this.firestore,null,n)}}function NO(t){t=Br(t,Nl);const e=Br(t.firestore,Za),n=wf(e),i=new P1(e);return RO(t._query),gO(n,t._query).then((a=>new al(e,i,t,a)))}function PO(t,e,n){t=Br(t,Nt);const i=Br(t.firestore,Za),a=N1(t.converter,e,n);return Df(i,[A1(Af(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,Fn.none())])}function LO(t,e,n,...i){t=Br(t,Nt);const a=Br(t.firestore,Za),l=Af(a);let c;return c=typeof(e=Xt(e))=="string"||e instanceof Ru?D1(l,"updateDoc",t._key,e,n,i):R1(l,"updateDoc",t._key,e),Df(a,[c.toMutation(t._key,Fn.exists(!0))])}function BO(t){return Df(Br(t.firestore,Za),[new _f(t._key,Fn.none())])}function Df(t,e){return(function(i,a){const l=new Hi;return i.asyncQueue.enqueueAndForget((async()=>rO(await mO(i),a,l))),l.promise})(wf(t),e)}function VO(t,e,n){const i=n.docs.get(e._key),a=new P1(t);return new za(t,a,e._key,i,new Yc(n.hasPendingWrites,n.fromCache),e.converter)}class UO{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Af(e)}set(e,n,i){this._verifyNotCommitted();const a=og(e,this._firestore),l=N1(a.converter,n,i),c=A1(this._dataReader,"WriteBatch.set",a._key,l,a.converter!==null,i);return this._mutations.push(c.toMutation(a._key,Fn.none())),this}update(e,n,i,...a){this._verifyNotCommitted();const l=og(e,this._firestore);let c;return c=typeof(n=Xt(n))=="string"||n instanceof Ru?D1(this._dataReader,"WriteBatch.update",l._key,n,i,a):R1(this._dataReader,"WriteBatch.update",l._key,n),this._mutations.push(c.toMutation(l._key,Fn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=og(e,this._firestore);return this._mutations=this._mutations.concat(new _f(n._key,Fn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new we(_e.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function og(t,e){if((t=Xt(t)).firestore!==e)throw new we(_e.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function vS(){return new Du("deleteField")}function L1(...t){return new qy("arrayUnion",t)}function B1(t){return wf(t=Br(t,Za)),new UO(t,(e=>Df(t,e)))}(function(e,n=!0){(function(a){Il=a})(jl),fl(new Ha("firestore",((i,{instanceIdentifier:a,options:l})=>{const c=i.getProvider("app").getImmediate(),h=new Za(new E5(i.getProvider("auth-internal")),new T5(c,i.getProvider("app-check-internal")),(function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new we(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new lu(p.options.projectId,_)})(c,a),c);return l={useFetchStreams:n,...l},h._setSettings(l),h}),"PUBLIC").setMultipleInstances(!0)),Fs(Sx,Ex,e),Fs(Sx,Ex,"esm2020")})();function ra(){return bO(yy)}function eo(t,e,n,i=1,a){{let l=e;if(e.startsWith("budgets/"))l="budgets";else if(e.startsWith("months/")){const f=e.replace("months/","").split("_");if(f.length>=2){const p=f[f.length-1];l=`months/${f[f.length-2]}/${p}`}}console.log(`[Firebase] ${t}(${i}): ${l}${a===!1?" [NOT FOUND]":""}  ${n}`)}}async function He(t,e,n){const i=Pl(ra(),t,e),a=`${t}/${e}`,l=await kO(i),c=l.exists();return eo("READ",a,n,1,c),{exists:c,data:c?l.data():null,ref:i}}async function vr(t,e,n){const i=ra(),a=_O(i,t);let l;if(n&&n.length>0){const f=n.map(p=>IO(p.field,p.op,p.value));l=jO(a,...f)}else l=a;const c=await NO(l);let h=t;if(n&&n.length>0){const f=n.map(p=>`${p.field} ${p.op} ${JSON.stringify(p.value)}`).join(", ");h+=` WHERE ${f}`}return eo("QUERY",h,e,c.docs.length),{docs:c.docs.map(f=>({id:f.id,data:f.data()}))}}async function at(t,e,n,i,a){const l=Pl(ra(),t,e),c=`${t}/${e}`;return eo("WRITE",c,i),PO(l,n,a??{})}async function Ky(t,e){const i=ra();for(let a=0;a<t.length;a+=500){const l=t.slice(a,a+500),c=B1(i);for(const{collectionPath:h,docId:f,data:p}of l){const _=Pl(i,h,f);c.set(_,p)}eo("BATCH_WRITE",`${l.length} docs`,e,l.length),await c.commit()}}async function Qa(t,e,n,i){const a=Pl(ra(),t,e),l=`${t}/${e}`;return eo("UPDATE",l,i),LO(a,n)}async function Yy(t,e,n){const i=Pl(ra(),t,e),a=`${t}/${e}`;return eo("DELETE",a,n),BO(i)}async function V1(t,e,n){const a=ra();for(let l=0;l<t.length;l+=500){const c=t.slice(l,l+500),h=B1(a);for(const{collectionPath:f,docId:p}of c){const _=Pl(a,f,p);h.delete(_)}eo("BATCH_DELETE",`${c.length} docs`,e,c.length),await h.commit(),n?.(l+c.length)}}const zO=Object.freeze(Object.defineProperty({__proto__:null,app:yy,arrayUnion:L1,batchDeleteDocs:V1,batchWriteDocs:Ky,deleteDocByPath:Yy,getDb:ra,queryCollection:vr,readDocByPath:He,updateDocByPath:Qa,writeDocByPath:at},Symbol.toStringTag,{value:"Module"}));function FO(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname??"",description:i.description??"",balance:i.balance??0,account_group_id:i.account_group_id??null,sort_order:i.sort_order??0,is_income_account:i.is_income_account??!1,is_income_default:i.is_income_default??!1,is_outgo_account:i.is_outgo_account??!1,is_outgo_default:i.is_outgo_default??!1,on_budget:i.on_budget??!0,is_active:i.is_active??!0}}),e}function qO(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order??0,expected_balance:i.expected_balance??"positive",on_budget:i.on_budget,is_active:i.is_active}}),e}function HO(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,description:i.description,category_group_id:i.category_group_id??null,sort_order:i.sort_order??0,default_monthly_amount:i.default_monthly_amount,default_monthly_type:i.default_monthly_type,balance:i.balance??0}}),e}function GO(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,i)=>n.sort_order-i.sort_order),e}function $O(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={needs_recalculation:i?.needs_recalculation??!1}}),e}async function QO(t){const{exists:e,data:n}=await He("budgets",t,"loading budget data (cache miss or stale)");if(!e||!n)throw new Error(`Budget ${t} not found`);const i=FO(n.accounts),a=qO(n.account_groups),l=HO(n.categories),c=GO(n.category_groups),h=n.total_available??0,f=$O(n.month_map),p=n.is_needs_recalculation??!1;return{budget:{id:t,name:n.name,user_ids:n.user_ids||[],accepted_user_ids:n.accepted_user_ids||[],owner_id:n.owner_id||n.user_ids?.[0]||"",owner_email:n.owner_email||"",accounts:i,account_groups:a,categories:l,category_groups:c,total_available:h,is_needs_recalculation:p,month_map:f},accounts:i,accountGroups:a,categories:l,categoryGroups:c,isNeedsRecalculation:p,monthMap:f}}function U1(t,e){return Rl({queryKey:t?xe.budget(t):["budget","none"],queryFn:()=>QO(t),enabled:!!t&&e?.enabled!==!1})}function xr(t,e,n){const i=n.toString().padStart(2,"0");return`${t}_${e}_${i}`}function Xy(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function WO(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}function xt(t,e){return`${t}${e.toString().padStart(2,"0")}`}function KO(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??xt(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at,updated_at:t.updated_at}}async function YO(t,e,n,i){const a=xr(t,e,n);return(await $e.fetchQuery({queryKey:xe.month(t,e,n),queryFn:async()=>{const{exists:c,data:h}=await He("months",a,i?.description??`reading month ${e}/${n}`);return!c||!h?null:{month:KO(h,t,e,n)}},staleTime:zE}))?.month??null}async function yi(t,e,n,i){const a=xr(t,e,n),l=i?`PRE-EDIT-READ: ${i}`:"PRE-EDIT-READ",{exists:c,data:h}=await He("months",a,l);if(!c||!h)throw new Error(`Month data not found for ${e}/${n}`);return h}async function XO(t,e,n){const i=xt(e,n);return(await vr("months","getFutureMonths: querying months after specified month",[{field:"budget_id",op:"==",value:t},{field:"year_month_ordinal",op:">",value:i}])).docs.map(c=>({id:c.id,...c.data})).sort((c,h)=>c.year!==h.year?c.year-h.year:c.month-h.month)}function JO(t){const e={},n={};return t.category_balances&&t.category_balances.forEach(i=>{e[i.category_id]=i.end_balance}),t.account_balances&&t.account_balances.forEach(i=>{n[i.account_id]=i.end_balance}),{categoryEndBalances:e,accountEndBalances:n}}const ci="__NO_CATEGORY__",Va="No Category";function Ui(t){return t===ci}const ol="__NO_ACCOUNT__",du="No Account";function er(t){return t===ol}const z1={categoryEndBalances:{},accountEndBalances:{},totalIncome:0};function F1(t,e){const n=ZO(t.category_balances,e.categoryEndBalances),i=ek(t,e.accountEndBalances);return{...t,previous_month_income:e.totalIncome,category_balances:n,account_balances:i,updated_at:new Date().toISOString()}}function ZO(t,e){const n=new Map;for(const a of t)Ui(a.category_id)||n.set(a.category_id,a);const i=t.filter(a=>!Ui(a.category_id)).map(a=>{const l=e[a.category_id]??0;return{...a,start_balance:l,end_balance:l+a.allocated+a.spent}});for(const[a,l]of Object.entries(e))Ui(a)||n.has(a)||i.push({category_id:a,start_balance:l,allocated:0,spent:0,end_balance:l});return i}function ek(t,e){const n=new Set;for(const a of t.income||[])er(a.account_id)||n.add(a.account_id);for(const a of t.expenses||[])er(a.account_id)||n.add(a.account_id);for(const a of Object.keys(e))er(a)||n.add(a);for(const a of t.account_balances||[])er(a.account_id)||n.add(a.account_id);const i=[];for(const a of n){const l=e[a]??0,c=(t.income||[]).filter(p=>p.account_id===a).reduce((p,_)=>p+_.amount,0),h=(t.expenses||[]).filter(p=>p.account_id===a).reduce((p,_)=>p+_.amount,0),f=c+h;i.push({account_id:a,start_balance:l,income:c,expenses:h,net_change:f,end_balance:l+f})}return i}function $g(t){const e={},n={};for(const i of t.category_balances||[])Ui(i.category_id)||(e[i.category_id]=i.end_balance);for(const i of t.account_balances||[])er(i.account_id)||(n[i.account_id]=i.end_balance);return{categoryEndBalances:e,accountEndBalances:n,totalIncome:t.total_income}}const tk=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function nk(t){return{year:parseInt(t.slice(0,4),10),month:parseInt(t.slice(4,6),10)}}function rk(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={needs_recalculation:i?.needs_recalculation??!1}}),e}function ik(t){return Object.entries(t).filter(([,e])=>e.needs_recalculation).map(([e])=>e).sort()}function sk(t){return Object.keys(t).sort()}async function ak(t,e){const{year:n,month:i}=nk(e),a=xr(t,n,i),{exists:l,data:c}=await He("months",a,`[recalc] fetching month ${n}/${i}`);return!l||!c?null:{id:a,budget_id:t,year_month_ordinal:c.year_month_ordinal??xt(n,i),year:c.year??n,month:c.month??i,income:c.income||[],total_income:c.total_income??0,previous_month_income:c.previous_month_income??0,expenses:c.expenses||[],total_expenses:c.total_expenses??0,account_balances:c.account_balances||[],category_balances:c.category_balances||[],are_allocations_finalized:c.are_allocations_finalized??!1,created_at:c.created_at,updated_at:c.updated_at}}async function ok(t,e,n){n?.(0,e.length);const i=await Promise.all(e.map(a=>ak(t,a)));return n?.(e.length,e.length),i.filter(a=>a!==null)}function q1(t){const e={};for(const n of Object.keys(t))e[n]={needs_recalculation:!1};return e}function H1(t,e,n){const i=Object.entries(t).reduce((l,[,c])=>{const h=c.account_group_id?n[c.account_group_id]:void 0,f=h?.on_budget!==void 0?h.on_budget:c.on_budget!==!1,p=h?.is_active!==void 0?h.is_active:c.is_active!==!1;return f&&p?l+(c.balance??0):l},0),a=Object.values(e).reduce((l,c)=>{const h=c.balance??0;return l+(h>0?h:0)},0);return i-a}async function lk(t,e,n,i){const{exists:a,data:l}=await He("budgets",t,"[recalc] reading budget for balance update");if(!a||!l)return;const c={...l.accounts};for(const[_,b]of Object.entries(e))c[_]&&(c[_]={...c[_],balance:b});const h={...l.categories};for(const[_,b]of Object.entries(n))h[_]&&(h[_]={...h[_],balance:b});const f=q1(i),p=H1(c,h,l.account_groups||{});await at("budgets",t,{...l,accounts:c,categories:h,total_available:p,is_needs_recalculation:!1,month_map:f,updated_at:new Date().toISOString()},"[recalc] saving balances and clearing flags"),uk(t,c,h,p,f)}function ck(t,e){const n=$e.getQueryData(xe.budget(t));n&&$e.setQueryData(xe.budget(t),{...n,isNeedsRecalculation:!1,monthMap:e,budget:{...n.budget,is_needs_recalculation:!1,month_map:e}})}function uk(t,e,n,i,a){const l=$e.getQueryData(xe.budget(t));if(l){const c={};for(const[f,p]of Object.entries(l.accounts)){const _=e[f];c[f]=_?{...p,balance:_.balance??p.balance}:p}const h={};for(const[f,p]of Object.entries(l.categories)){const _=n[f];h[f]=_?{...p,balance:_.balance??p.balance}:p}$e.setQueryData(xe.budget(t),{...l,accounts:c,categories:h,isNeedsRecalculation:!1,monthMap:a,budget:{...l.budget,accounts:e,categories:n,total_available:i,is_needs_recalculation:!1,month_map:a}})}}async function xS(t,e){const{exists:n,data:i}=await He("budgets",t,"[recalc] reading budget to clear flags");if(!n||!i)return;const a=q1(e);await at("budgets",t,{...i,total_available:H1(i.accounts||{},i.categories||{},i.account_groups||{}),is_needs_recalculation:!1,month_map:a,updated_at:new Date().toISOString()},"[recalc] clearing flags"),ck(t,a)}const lg=new Map;async function jf(t,e={}){const n=lg.get(t);if(n)return n;const i=dk(t,e);lg.set(t,i);try{return await i}finally{lg.delete(t)}}async function dk(t,e={}){const{onProgress:n}=e;n?.({phase:"reading-budget",monthsProcessed:0,totalMonths:0,percentComplete:5});const{exists:i,data:a}=await He("budgets",t,"[recalc] reading budget for month_map");if(!i||!a)return n?.({phase:"complete",monthsProcessed:0,totalMonths:0,percentComplete:100}),{monthsRecalculated:0,budgetUpdated:!1};const l=rk(a.month_map),c=ik(l);if(c.length===0&&!a.is_needs_recalculation)return n?.({phase:"complete",monthsProcessed:0,totalMonths:0,percentComplete:100}),{monthsRecalculated:0,budgetUpdated:!1};const h=sk(l),f=c.length>0?c[0]:null;if(!f)return await xS(t,l),n?.({phase:"complete",monthsProcessed:0,totalMonths:0,percentComplete:100}),{monthsRecalculated:0,budgetUpdated:!0};const p=h.indexOf(f),_=p>0,b=_?h.slice(p-1):h.slice(p),v=_?b.length-1:b.length;n?.({phase:"fetching-months",monthsFetched:0,totalMonthsToFetch:b.length,monthsProcessed:0,totalMonths:v,percentComplete:10});const E=await ok(t,b,(O,R)=>{n?.({phase:"fetching-months",monthsFetched:O,totalMonthsToFetch:R,monthsProcessed:0,totalMonths:v,percentComplete:O===0?10:30})});if(E.length===0)return await xS(t,l),n?.({phase:"complete",monthsProcessed:0,totalMonths:0,percentComplete:100}),{monthsRecalculated:0,budgetUpdated:!0};const C=_?1:0,w=E.length-1,D=w-C+1;let N=z1;_&&E.length>0&&(N=$g(E[0]));const U=[];let k=0;for(let O=C;O<=w;O++){const R=E[O],j=`${tk[R.month-1]} ${R.year}`;n?.({phase:"recalculating",currentMonth:j,monthsProcessed:k,totalMonths:D,percentComplete:Math.round(30+k/D*40)});const I=F1(R,N);U.push(I),N=$g(I),k++}n?.({phase:"saving",monthsProcessed:k,totalMonths:D,percentComplete:75});const X=U.map(O=>({collectionPath:"months",docId:xr(t,O.year,O.month),data:O}));await Ky(X,`[recalc] batch write ${U.length} months`);for(const O of U)$e.setQueryData(xe.month(t,O.year,O.month),{month:O});n?.({phase:"saving",monthsProcessed:k,totalMonths:D,percentComplete:92});const G=N.accountEndBalances,K=N.categoryEndBalances;return await lk(t,G,K,l),n?.({phase:"complete",monthsProcessed:k,totalMonths:D,percentComplete:100}),{monthsRecalculated:k,budgetUpdated:!0,finalAccountBalances:G}}const hk="modulepreload",fk=function(t){return"/"+t},SS={},mk=function(e,n,i){let a=Promise.resolve();if(n&&n.length>0){let p=function(_){return Promise.all(_.map(b=>Promise.resolve(b).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};var c=p;document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),f=h?.nonce||h?.getAttribute("nonce");a=p(n.map(_=>{if(_=fk(_),_ in SS)return;SS[_]=!0;const b=_.endsWith(".css"),v=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${v}`))return;const E=document.createElement("link");if(E.rel=b?"stylesheet":hk,b||(E.as="script"),E.crossOrigin="",E.href=_,f&&E.setAttribute("nonce",f),document.head.appendChild(E),b)return new Promise((C,w)=>{E.addEventListener("load",C),E.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(h){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=h,window.dispatchEvent(f),!f.defaultPrevented)throw h}return a.then(h=>{for(const f of h||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function pk(){const t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=[];for(let a=3;a>0;a--){let l=e,c=n-a;for(;c<1;)c+=12,l-=1;i.push(xt(l,c))}i.push(xt(e,n));for(let a=1;a<=3;a++){let l=e,c=n+a;for(;c>12;)c-=12,l+=1;i.push(xt(l,c))}return i}function gk(t,e){const n=xe.budget(t),i=$e.getQueryData(n);if(!i?.monthMap)return!1;for(const[a,l]of Object.entries(i.monthMap))if(a>e&&!l.needs_recalculation)return!1;return!0}function yk(t,e,n){const i=xe.budget(t),a=$e.getQueryData(i);a&&$e.setQueryData(i,{...a,isNeedsRecalculation:!0,monthMap:n,budget:{...a.budget,is_needs_recalculation:!0,month_map:n}})}function _k(t,e){const n=xe.budget(t),i=$e.getQueryData(n);i&&$e.setQueryData(n,{...i,monthMap:e,budget:{...i.budget,month_map:e}})}async function bk(t,e,n){const i=xt(e,n);if(gk(t,i))return console.log("[markMonthsNeedRecalculation] All future months already marked in cache, skipping write"),{markedCount:0,budgetUpdated:!1};const{exists:a,data:l}=await He("budgets",t,"reading budget for month_map update");if(!a||!l)return console.warn(`[markMonthsNeedRecalculation] Budget ${t} not found`),{markedCount:0,budgetUpdated:!1};const h={...l.month_map||{}},f=pk();for(const v of f)h[v]||(h[v]={needs_recalculation:!1});let p=0;for(const v of f)v>i&&(h[v]?.needs_recalculation||(h[v]={needs_recalculation:!0},p++));const _=l.is_needs_recalculation===!0;if(p===0&&_)return console.log("[markMonthsNeedRecalculation] No new months to mark and budget already marked, skipping write"),{markedCount:0,budgetUpdated:!1};const b=h;return yk(t,i,b),await Qa("budgets",t,{is_needs_recalculation:!0,month_map:b,updated_at:new Date().toISOString()},`marking budget and ${p} future months as needing recalculation`),{markedCount:p,budgetUpdated:!0}}async function vk(t,e,n,i=!1){const a=xt(e,n),{exists:l,data:c}=await He("budgets",t,"reading budget for month_map update (add month)");if(!l||!c){console.warn(`[setMonthInBudgetMap] Budget ${t} not found`);return}const f={...c.month_map||{},[a]:{needs_recalculation:i}},p=f;_k(t,p),await Qa("budgets",t,{month_map:p,updated_at:new Date().toISOString()},`adding month ${e}/${n} to budget month_map`)}async function G1(t,e,n,i){const{bypassDateLimit:a=!1}=i??{},l=new Date,c=l.getFullYear(),h=l.getMonth()+1,f=(e-c)*12+(n-h);if(!a&&f>3){const U=`[createMonth] Refusing to create month ${e}/${n} - it's ${f} months in the future (max allowed: 3). This likely indicates a bug in month navigation.`;throw console.error(U),new Error(U)}if(!a&&f<-3){const U=`[createMonth] Refusing to create month ${e}/${n} - it's ${Math.abs(f)} months in the past (max allowed: 3). Existing months can still be viewed, but new months cannot be created this far back.`;throw console.error(U),new Error(U)}const p=l.toISOString(),_=xr(t,e,n);let b=0,v={},E={};if(n>1||e>new Date().getFullYear()-10){const{year:U,month:k}=Xy(e,n),X=xr(t,U,k),{exists:G,data:K}=await He("months",X,"fetching previous month to create start balances for new month");if(G&&K){const O={year_month_ordinal:K.year_month_ordinal??xt(U,k),year:K.year??U,month:K.month??k,income:K.income||[],total_income:K.total_income??0,previous_month_income:K.previous_month_income??0,expenses:K.expenses||[],total_expenses:K.total_expenses??0,account_balances:K.account_balances||[],category_balances:K.category_balances||[],are_allocations_finalized:K.are_allocations_finalized??!1,created_at:K.created_at,updated_at:K.updated_at};b=O.total_income;const{categoryEndBalances:R,accountEndBalances:j}=JO(O);v=R,E=j}}const C=Object.entries(v).map(([U,k])=>({category_id:U,start_balance:k,allocated:0,spent:0,end_balance:k})),w=Object.entries(E).map(([U,k])=>({account_id:U,start_balance:k,income:0,expenses:0,net_change:0,end_balance:k})),D={budget_id:t,year_month_ordinal:xt(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:b,expenses:[],total_expenses:0,account_balances:w,category_balances:C,are_allocations_finalized:!1,created_at:p,updated_at:p},N={budget_id:t,year_month_ordinal:xt(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:b,expenses:[],total_expenses:0,account_balances:w,category_balances:C,are_allocations_finalized:!1,created_at:p,updated_at:p};return await at("months",_,N,"creating new month document (first time viewing this month)"),$e.setQueryData(xe.month(t,e,n),{month:D}),await vk(t,e,n,!1),D}function xk(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??xt(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at,updated_at:t.updated_at}}async function Sk(t,e,n){const i=xr(t,e,n),{exists:a,data:l}=await He("months",i,`loading month ${e}/${n}`);return!a||!l?null:xk(l,t,e,n)}async function Ek(t,e,n){const i=await Sk(t,e,n);return i||G1(t,e,n)}function wk(t,e,n,i){return Rl({queryKey:t?xe.month(t,e,n):["month","none"],queryFn:async()=>({month:await Ek(t,e,n)}),enabled:!!t&&i?.enabled!==!1})}async function Ck(t){const{exists:e,data:n}=await He("payees",t,"loading payees for autocomplete (cache miss or stale)");return e&&n?n.payees||[]:[]}function $1(t,e){return Rl({queryKey:t?xe.payees(t):["payees","none"],queryFn:()=>Ck(t),enabled:!!t&&e?.enabled!==!1})}async function Tk(t,e){const{exists:n,data:i}=await He("users",t,"loading user profile (cache miss or stale)");if(n&&i)return i;const a={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await at("users",t,a,"creating new user document (first login)"),a}function Ak(t,e,n){return Rl({queryKey:t?xe.user(t):["user","none"],queryFn:()=>Tk(t,e),enabled:!!t&&n?.enabled!==!1})}async function Rk(t,e){const n=await vr("budgets","loading budgets user has access to (cache miss or stale)",[{field:"user_ids",op:"array-contains",value:t}]),i=[],a=[];for(const l of n.docs){const c=l.data;c.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(l.id)?i.push({id:l.id,name:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null,isOwner:c.owner_id===t,isPending:!1}):a.push({budgetId:l.id,budgetName:c.name||"Unnamed Budget",ownerEmail:c.owner_email||null})}return{budgets:i,pendingInvites:a}}function Dk(t,e,n){return Rl({queryKey:t?xe.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?Rk(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}function jk(t){if(Array.isArray(t))return t;if(t&&typeof t=="object"&&!Array.isArray(t)){const e=t;if(e._methodName==="arrayUnion"&&Array.isArray(e.vc))return console.warn("[fetchFeedback] Found corrupted arrayUnion in feedback document - extracting items from vc"),e.vc}return[]}async function Ik(){const t=await vr("feedback","admin loading all feedback (cache miss or stale)"),e=[];for(const n of t.docs){const i=jk(n.data.items),a=n.data.user_email||n.id;i.forEach(l=>{e.push({...l,doc_id:n.id,user_email:a})})}return{items:e}}function Mk(t){return Rl({queryKey:xe.feedback(),queryFn:Ik,enabled:t?.enabled!==!1})}async function Ok(t,e){return $e.fetchQuery({queryKey:["budgetInvite",t,e],queryFn:async()=>{const{exists:n,data:i}=await He("budgets",t,"checking if user has pending invite for budget");return!n||!i?null:{isInvited:i.user_ids?.includes(e)??!1,hasAccepted:i.accepted_user_ids?.includes(e)??!1,budgetName:i.name||"Unnamed Budget",ownerEmail:i.owner_email||null}},staleTime:60*1e3})}async function Qg(t,e,n){const i=await YO(t,e,n,{description:`fetching month for balance calculation (walking ${e}/${n})`});return i?{year:i.year,month:i.month,category_balances:i.category_balances,are_allocations_finalized:i.are_allocations_finalized,expenses:i.expenses}:null}async function kk(t,e,n,i){const a={};e.forEach(v=>{a[v]=0});const l=await Qg(t,n,i);if(l?.category_balances){for(const v of l.category_balances)e.includes(v.category_id)&&(a[v.category_id]=v.end_balance);return a}const c={};e.forEach(v=>{c[v]=0});const h=[];l&&h.push(l);let f=n,p=i,_=!1;const b=120;for(let v=0;v<b&&!_;v++){const E=Xy(f,p);f=E.year,p=E.month;const C=await Qg(t,f,p);if(!C)_=!0;else if(C.category_balances){_=!0;for(const w of C.category_balances)e.includes(w.category_id)&&(c[w.category_id]=w.end_balance)}else h.push(C)}h.reverse(),Object.assign(a,c);for(const v of h){if(v.are_allocations_finalized&&v.category_balances)for(const E of v.category_balances)e.includes(E.category_id)&&(a[E.category_id]=(a[E.category_id]||0)+E.allocated);if(v.expenses)for(const E of v.expenses)e.includes(E.category_id)&&(a[E.category_id]=(a[E.category_id]||0)-E.amount)}return a}async function Nk(t,e,n,i,a){const l={...n};let c=i,h=a;const f=24;for(let p=0;p<f;p++){const _=WO(c,h);c=_.year,h=_.month;const b=await Qg(t,c,h);if(!b)break;if(b.are_allocations_finalized&&b.category_balances)for(const v of b.category_balances)e.includes(v.category_id)&&(l[v.category_id]=(l[v.category_id]||0)+v.allocated);if(b.expenses)for(const v of b.expenses)e.includes(v.category_id)&&(l[v.category_id]=(l[v.category_id]||0)-v.amount)}return l}async function ES(t,e,n,i){const a=await kk(t,e,n,i),l=await Nk(t,e,a,n,i);return{current:a,total:l}}async function Q1(t,e,n){const i=xr(t,e.year,e.month);await at("months",i,e,`writeMonthData: ${n}`)}async function W1(t,e,n){await bk(t,e,n)}async function Pk(t){const{budgetId:e,month:n,description:i,cascadeRecalculation:a=!0}=t;await Q1(e,n,i||`${n.year}/${n.month}`),$e.setQueryData(xe.month(e,n.year,n.month),{month:n}),a&&await W1(e,n.year,n.month)}function Xi(){const t=sn();return{writeData:ir({mutationFn:async({budgetId:n,month:i,description:a,cascadeRecalculation:l=!0})=>(await Q1(n,i,a||`${i.year}/${i.month}`),{budgetId:n,year:i.year,month:i.month,cascadeRecalculation:l}),onMutate:async({budgetId:n,month:i})=>{const a=xe.month(n,i.year,i.month);await t.cancelQueries({queryKey:a});const l=t.getQueryData(a);return t.setQueryData(a,{month:i}),{oldMonthQueryData:l,monthKey:a}},onSuccess:async({budgetId:n,year:i,month:a,cascadeRecalculation:l})=>{l&&await W1(n,i,a)},onError:(n,i,a)=>{a?.oldMonthQueryData&&t.setQueryData(a.monthKey,a.oldMonthQueryData)}})}}function Lk(t,e,n,i){const a={};t.category_balances&&t.category_balances.forEach(c=>{a[c.category_id]=c});const l=t.expenses??[];return e.map(c=>{const f=a[c]?.start_balance??0,p=n[c]??0,_=l.filter(b=>b.category_id===c).reduce((b,v)=>b+v.amount,0);return{category_id:c,start_balance:f,allocated:p,spent:_,end_balance:f+p+_}})}function Bk(){const{writeData:t}=Xi();return{saveDraftAllocations:async(n,i,a,l)=>{const c=await yi(n,i,a,"save draft allocations"),h=c.category_balances.map(p=>({...p,allocated:l[p.category_id]??p.allocated})),f={...c,category_balances:h,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:n,month:f,cascadeRecalculation:!1}),{updatedMonth:f}},isPending:t.isPending,isError:t.isError,error:t.error}}function Vk(){const{writeData:t}=Xi();return{finalizeAllocations:async n=>{const{budgetId:i,year:a,month:l,allocations:c,onProgress:h}=n;h?.({phase:"saving",message:"Saving allocations..."});const f=await yi(i,a,l,"finalize allocations"),p=f.category_balances?.map(E=>E.category_id)??[],_=p.length>0?p:Object.keys(c),b=_.length>0?Lk(f,_,c):f.category_balances,v={...f,category_balances:b,are_allocations_finalized:!0,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:i,month:v,description:"finalize allocations"}),h?.({phase:"recalculating",message:"Recalculating month balances..."}),await jf(i,{triggeringMonthOrdinal:`${a}${String(l).padStart(2,"0")}`,onProgress:E=>{let C="Recalculating balances...";E.phase==="fetching-months"?C=`Loading month data (${E.monthsFetched}/${E.totalMonthsToFetch})...`:E.phase==="recalculating"&&E.currentMonth?C=`Recalculating ${E.currentMonth}...`:E.phase==="saving"&&(C="Saving recalculated balances..."),h?.({phase:"recalculating",message:C,recalcProgress:E})}}),await $e.refetchQueries({queryKey:xe.month(i,a,l)}),await $e.refetchQueries({queryKey:xe.budget(i)}),h?.({phase:"complete",message:"Allocations applied!"}),{updatedMonth:v}},isPending:t.isPending,isError:t.isError,error:t.error}}function K1(){const{writeData:t}=Xi();return{deleteAllocations:async n=>{const{budgetId:i,year:a,month:l,onProgress:c}=n;c?.({phase:"saving",message:"Deleting allocations..."});const h=await yi(i,a,l,"delete allocations"),f=h.category_balances.map(_=>({..._,allocated:0,end_balance:_.start_balance-_.spent})),p={...h,category_balances:f,are_allocations_finalized:!1,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:i,month:p,description:"delete allocations"}),c?.({phase:"recalculating",message:"Recalculating month balances..."}),await jf(i,{triggeringMonthOrdinal:`${a}${String(l).padStart(2,"0")}`,onProgress:_=>{let b="Recalculating balances...";_.phase==="fetching-months"?b=`Loading month data (${_.monthsFetched}/${_.totalMonthsToFetch})...`:_.phase==="recalculating"&&_.currentMonth?b=`Recalculating ${_.currentMonth}...`:_.phase==="saving"&&(b="Saving recalculated balances..."),c?.({phase:"recalculating",message:b,recalcProgress:_})}}),await $e.refetchQueries({queryKey:xe.month(i,a,l)}),await $e.refetchQueries({queryKey:xe.budget(i)}),c?.({phase:"complete",message:"Allocations deleted!"}),{updatedMonth:p}},isPending:t.isPending,isError:t.isError,error:t.error}}async function If(t,e,n){const i=e.trim();if(!i||n.includes(i))return null;const a=[...n,i].sort((l,c)=>l.toLowerCase().localeCompare(c.toLowerCase()));return await at("payees",t,{budget_id:t,payees:a,updated_at:new Date().toISOString()},`adding new payee "${i}" to autocomplete list`),a}function ia(t){const e=t.income||[],n=t.expenses||[],i=e.reduce((h,f)=>h+f.amount,0),a=n.reduce((h,f)=>h+f.amount,0),l=Uk(t),c=zk(t);return{...t,total_income:i,total_expenses:a,account_balances:l,category_balances:c}}function Uk(t){const e=t.income||[],n=t.expenses||[],i=t.account_balances||[],a=new Map;for(const h of i)er(h.account_id)||a.set(h.account_id,h);const l=new Set;for(const h of e)er(h.account_id)||l.add(h.account_id);for(const h of n)er(h.account_id)||l.add(h.account_id);for(const h of i)er(h.account_id)||l.add(h.account_id);const c=[];for(const h of l){const p=a.get(h)?.start_balance??0,_=e.filter(E=>E.account_id===h).reduce((E,C)=>E+C.amount,0),b=n.filter(E=>E.account_id===h).reduce((E,C)=>E+C.amount,0),v=_+b;c.push({account_id:h,start_balance:p,income:_,expenses:b,net_change:v,end_balance:p+v})}return c}function zk(t){const e=t.expenses||[],n=t.category_balances||[],i=new Map;for(const h of n)Ui(h.category_id)||i.set(h.category_id,h);const a=new Map;for(const h of e){if(Ui(h.category_id))continue;const f=a.get(h.category_id)||0;a.set(h.category_id,f+h.amount)}const l=new Set;for(const h of n)Ui(h.category_id)||l.add(h.category_id);for(const h of e)Ui(h.category_id)||l.add(h.category_id);const c=[];for(const h of l){const f=i.get(h),p=a.get(h)??0;f?c.push({...f,spent:p,end_balance:f.start_balance+f.allocated+p}):c.push({category_id:h,start_balance:0,allocated:0,spent:p,end_balance:p})}return c}function Fk(t,e){let n=0;for(const{accountId:i,delta:a}of e){const l=t.accounts[i];if(!l)continue;const c=l.account_group_id?t.accountGroups[l.account_group_id]:void 0,h=c?.on_budget!==void 0?c.on_budget:l.on_budget!==!1,f=c?.is_active!==void 0?c.is_active:l.is_active!==!1;h&&f&&(n+=a)}return n}async function Zs(t,e){if(e.length===0)return;const n=e.filter(h=>h.delta!==0);if(n.length===0)return;const i=$e.getQueryData(xe.budget(t));if(!i)return;const a=Fk(i,n),l={...i.accounts};for(const{accountId:h,delta:f}of n)l[h]&&(l[h]={...l[h],balance:l[h].balance+f});const c=i.budget?{...i.budget,total_available:i.budget.total_available+a}:i.budget;$e.setQueryData(xe.budget(t),{...i,accounts:l,budget:c})}function qk(){const t=sn(),{writeData:e}=Xi();return{addIncome:async(i,a,l,c,h,f,p,_)=>{const b=await yi(i,a,l,"add income"),v={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:c,account_id:h,date:f,created_at:new Date().toISOString()};p?.trim()&&(v.payee=p.trim()),_&&(v.description=_);const E=[...b.income||[],v],C=ia({...b,income:E,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:C,description:"add income"}),await Zs(i,[{accountId:h,delta:c}]),p?.trim()){const w=t.getQueryData(xe.payees(i))||[],D=await If(i,p,w);D&&t.setQueryData(xe.payees(i),D)}return{updatedMonth:C,newIncome:v}},isPending:e.isPending,isError:e.isError,error:e.error}}function Hk(){const t=sn(),{writeData:e}=Xi();return{updateIncome:async(i,a,l,c,h,f,p,_,b)=>{const v=await yi(i,a,l,"update income"),E=(v.income||[]).find(k=>k.id===c),C=E?.amount??0,w=E?.account_id??f,D={id:c,amount:h,account_id:f,date:p,created_at:(v.income||[]).find(k=>k.id===c)?.created_at||new Date().toISOString()};_?.trim()&&(D.payee=_.trim()),b&&(D.description=b);const N=(v.income||[]).map(k=>k.id===c?D:k),U=ia({...v,income:N,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:U,description:"update income"}),w===f?await Zs(i,[{accountId:f,delta:h-C}]):await Zs(i,[{accountId:w,delta:-C},{accountId:f,delta:h}]),_?.trim()){const k=t.getQueryData(xe.payees(i))||[],X=await If(i,_,k);X&&t.setQueryData(xe.payees(i),X)}return{updatedMonth:U}},isPending:e.isPending,isError:e.isError,error:e.error}}function Gk(){const{writeData:t}=Xi();return{deleteIncome:async(n,i,a,l)=>{const c=await yi(n,i,a,"delete income"),h=(c.income||[]).find(v=>v.id===l),f=h?.amount??0,p=h?.account_id,_=(c.income||[]).filter(v=>v.id!==l),b=ia({...c,income:_,updated_at:new Date().toISOString()});return await t.mutateAsync({budgetId:n,month:b,description:"delete income"}),p&&f>0&&await Zs(n,[{accountId:p,delta:-f}]),{updatedMonth:b}},isPending:t.isPending,isError:t.isError,error:t.error}}function $k(){const t=sn(),{writeData:e}=Xi();return{addExpense:async(i,a,l,c,h,f,p,_,b,v)=>{const E=await yi(i,a,l,"add expense"),C={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:c,category_id:h,account_id:f,date:p,created_at:new Date().toISOString()};_?.trim()&&(C.payee=_.trim()),b&&(C.description=b),v!==void 0&&(C.cleared=v);const w=[...E.expenses||[],C],D=ia({...E,expenses:w,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:D,description:"add expense"}),await Zs(i,[{accountId:f,delta:-c}]),_?.trim()){const N=t.getQueryData(xe.payees(i))||[],U=await If(i,_,N);U&&t.setQueryData(xe.payees(i),U)}return{updatedMonth:D,newExpense:C}},isPending:e.isPending,isError:e.isError,error:e.error}}function Qk(){const t=sn(),{writeData:e}=Xi();return{updateExpense:async(i,a,l,c,h,f,p,_,b,v,E)=>{const C=await yi(i,a,l,"update expense"),w=(C.expenses||[]).find(G=>G.id===c),D=w?.amount??0,N=w?.account_id??p,U={id:c,amount:h,category_id:f,account_id:p,date:_,created_at:C.expenses?.find(G=>G.id===c)?.created_at||new Date().toISOString()};b?.trim()&&(U.payee=b.trim()),v&&(U.description=v),E!==void 0&&(U.cleared=E);const k=(C.expenses||[]).map(G=>G.id===c?U:G),X=ia({...C,expenses:k,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:X,description:"update expense"}),N===p?await Zs(i,[{accountId:p,delta:D-h}]):await Zs(i,[{accountId:N,delta:D},{accountId:p,delta:-h}]),b?.trim()){const G=t.getQueryData(xe.payees(i))||[],K=await If(i,b,G);K&&t.setQueryData(xe.payees(i),K)}return{updatedMonth:X}},isPending:e.isPending,isError:e.isError,error:e.error}}function Wk(){const{writeData:t}=Xi();return{deleteExpense:async(n,i,a,l)=>{const c=await yi(n,i,a,"delete expense"),h=(c.expenses||[]).find(v=>v.id===l),f=h?.amount??0,p=h?.account_id,_=(c.expenses||[]).filter(v=>v.id!==l),b=ia({...c,expenses:_,updated_at:new Date().toISOString()});return await t.mutateAsync({budgetId:n,month:b,description:"delete expense"}),p&&f>0&&await Zs(n,[{accountId:p,delta:f}]),{updatedMonth:b}},isPending:t.isPending,isError:t.isError,error:t.error}}function Y1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Kk=Y1,X1=new vu("auth","Firebase",Y1());const Kh=new my("@firebase/auth");function Yk(t,...e){Kh.logLevel<=Xe.WARN&&Kh.warn(`Auth (${jl}): ${t}`,...e)}function Ah(t,...e){Kh.logLevel<=Xe.ERROR&&Kh.error(`Auth (${jl}): ${t}`,...e)}function Ur(t,...e){throw Jy(t,...e)}function mi(t,...e){return Jy(t,...e)}function J1(t,e,n){const i={...Kk(),[e]:n};return new vu("auth","Firebase",i).create(e,{appName:t.name})}function Gs(t){return J1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Jy(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return X1.create(t,...e)}function Le(t,e,...n){if(!t)throw Jy(e,...n)}function zi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ah(e),new Error(e)}function Ki(t,e){t||zi(e)}function Wg(){return typeof self<"u"&&self.location?.href||""}function Xk(){return wS()==="http:"||wS()==="https:"}function wS(){return typeof self<"u"&&self.location?.protocol||null}function Jk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xk()||Xj()||"connection"in navigator)?navigator.onLine:!0}function Zk(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class ju{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ki(n>e,"Short delay should be less than long delay!"),this.isMobile=Wj()||Jj()}get(){return Jk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Zy(t,e){Ki(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Z1{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;zi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;zi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;zi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const eN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const tN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nN=new ju(3e4,6e4);function to(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function sa(t,e,n,i,a={}){return eC(t,a,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const h=xu({key:t.config.apiKey,...c}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const p={method:e,headers:f,...l};return Yj()||(p.referrerPolicy="no-referrer"),t.emulatorConfig&&Dl(t.emulatorConfig.host)&&(p.credentials="include"),Z1.fetch()(await tC(t,t.config.apiHost,n,h),p)})}async function eC(t,e,n){t._canInitEmulator=!1;const i={...eN,...e};try{const a=new iN(t),l=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw yh(t,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const h=l.ok?c.errorMessage:c.error.message,[f,p]=h.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw yh(t,"credential-already-in-use",c);if(f==="EMAIL_EXISTS")throw yh(t,"email-already-in-use",c);if(f==="USER_DISABLED")throw yh(t,"user-disabled",c);const _=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw J1(t,_,p);Ur(t,_)}}catch(a){if(a instanceof Yi)throw a;Ur(t,"network-request-failed",{message:String(a)})}}async function Mf(t,e,n,i,a={}){const l=await sa(t,e,n,i,a);return"mfaPendingCredential"in l&&Ur(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function tC(t,e,n,i){const a=`${e}${n}?${i}`,l=t,c=l.config.emulator?Zy(t.config,a):`${t.config.apiScheme}://${a}`;return tN.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function rN(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(mi(this.auth,"network-request-failed")),nN.get())})}}function yh(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=mi(t,e,i);return a.customData._tokenResponse=n,a}function CS(t){return t!==void 0&&t.enterprise!==void 0}class sN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return rN(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function aN(t,e){return sa(t,"GET","/v2/recaptchaConfig",to(t,e))}async function oN(t,e){return sa(t,"POST","/v1/accounts:delete",e)}async function Yh(t,e){return sa(t,"POST","/v1/accounts:lookup",e)}function nu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function lN(t,e=!1){const n=Xt(t),i=await n.getIdToken(e),a=e_(i);Le(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l?.sign_in_provider;return{claims:a,token:i,authTime:nu(cg(a.auth_time)),issuedAtTime:nu(cg(a.iat)),expirationTime:nu(cg(a.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function cg(t){return Number(t)*1e3}function e_(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return Ah("JWT malformed, contained fewer than 3 sections"),null;try{const a=HE(n);return a?JSON.parse(a):(Ah("Failed to decode base64 JWT payload"),null)}catch(a){return Ah("Caught error parsing JWT payload as JSON",a?.toString()),null}}function TS(t){const e=e_(t);return Le(e,"internal-error"),Le(typeof e.exp<"u","internal-error"),Le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function hu(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Yi&&cN(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function cN({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class uN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Kg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=nu(this.lastLoginAt),this.creationTime=nu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Xh(t){const e=t.auth,n=await t.getIdToken(),i=await hu(t,Yh(e,{idToken:n}));Le(i?.users.length,e,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=a.providerUserInfo?.length?nC(a.providerUserInfo):[],c=hN(t.providerData,l),h=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!c?.length,p=h?f:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Kg(a.createdAt,a.lastLoginAt),isAnonymous:p};Object.assign(t,_)}async function dN(t){const e=Xt(t);await Xh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hN(t,e){return[...t.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function nC(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function fN(t,e){const n=await eC(t,{},async()=>{const i=xu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,c=await tC(t,a,"/v1/token",`key=${l}`),h=await t._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:h,body:i};return t.emulatorConfig&&Dl(t.emulatorConfig.host)&&(f.credentials="include"),Z1.fetch()(c,f)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function mN(t,e){return sa(t,"POST","/v2/accounts:revokeToken",to(t,e))}class ll{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Le(e.idToken,"internal-error"),Le(typeof e.idToken<"u","internal-error"),Le(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):TS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Le(e.length!==0,"internal-error");const n=TS(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:a,expiresIn:l}=await fN(e,n);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:a,expirationTime:l}=n,c=new ll;return i&&(Le(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),a&&(Le(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Le(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ll,this.toJSON())}_performRefresh(){return zi("not implemented")}}function Is(t,e){Le(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Lr{constructor({uid:e,auth:n,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new uN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Kg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await hu(this,this.stsTokenManager.getToken(this.auth,e));return Le(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return lN(this,e)}reload(){return dN(this)}_assign(e){this!==e&&(Le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Lr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Xh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Pr(this.auth.app))return Promise.reject(Gs(this.auth));const e=await this.getIdToken();return await hu(this,oN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,a=n.email??void 0,l=n.phoneNumber??void 0,c=n.photoURL??void 0,h=n.tenantId??void 0,f=n._redirectEventId??void 0,p=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:b,emailVerified:v,isAnonymous:E,providerData:C,stsTokenManager:w}=n;Le(b&&w,e,"internal-error");const D=ll.fromJSON(this.name,w);Le(typeof b=="string",e,"internal-error"),Is(i,e.name),Is(a,e.name),Le(typeof v=="boolean",e,"internal-error"),Le(typeof E=="boolean",e,"internal-error"),Is(l,e.name),Is(c,e.name),Is(h,e.name),Is(f,e.name),Is(p,e.name),Is(_,e.name);const N=new Lr({uid:b,auth:e,email:a,emailVerified:v,displayName:i,isAnonymous:E,photoURL:c,phoneNumber:l,tenantId:h,stsTokenManager:D,createdAt:p,lastLoginAt:_});return C&&Array.isArray(C)&&(N.providerData=C.map(U=>({...U}))),f&&(N._redirectEventId=f),N}static async _fromIdTokenResponse(e,n,i=!1){const a=new ll;a.updateFromServerResponse(n);const l=new Lr({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Xh(l),l}static async _fromGetAccountInfoResponse(e,n,i){const a=n.users[0];Le(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?nC(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!l?.length,h=new ll;h.updateFromIdToken(i);const f=new Lr({uid:a.localId,auth:e,stsTokenManager:h,isAnonymous:c}),p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Kg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(f,p),f}}const AS=new Map;function Fi(t){Ki(t instanceof Function,"Expected a class definition");let e=AS.get(t);return e?(Ki(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,AS.set(t,e),e)}class rC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}rC.type="NONE";const RS=rC;function Rh(t,e,n){return`firebase:${t}:${e}:${n}`}class cl{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=Rh(this.userKey,a.apiKey,l),this.fullPersistenceKey=Rh("persistence",a.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Yh(this.auth,{idToken:e}).catch(()=>{});return n?Lr._fromGetAccountInfoResponse(this.auth,n,e):null}return Lr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new cl(Fi(RS),e,i);const a=(await Promise.all(n.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let l=a[0]||Fi(RS);const c=Rh(i,e.config.apiKey,e.name);let h=null;for(const p of n)try{const _=await p._get(c);if(_){let b;if(typeof _=="string"){const v=await Yh(e,{idToken:_}).catch(()=>{});if(!v)break;b=await Lr._fromGetAccountInfoResponse(e,v,_)}else b=Lr._fromJSON(e,_);p!==l&&(h=b),l=p;break}}catch{}const f=a.filter(p=>p._shouldAllowMigration);return!l._shouldAllowMigration||!f.length?new cl(l,e,i):(l=f[0],h&&await l._set(c,h.toJSON()),await Promise.all(n.map(async p=>{if(p!==l)try{await p._remove(c)}catch{}})),new cl(l,e,i))}}function DS(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(oC(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(iC(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(cC(e))return"Blackberry";if(uC(e))return"Webos";if(sC(e))return"Safari";if((e.includes("chrome/")||aC(e))&&!e.includes("edge/"))return"Chrome";if(lC(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function iC(t=Cn()){return/firefox\//i.test(t)}function sC(t=Cn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function aC(t=Cn()){return/crios\//i.test(t)}function oC(t=Cn()){return/iemobile/i.test(t)}function lC(t=Cn()){return/android/i.test(t)}function cC(t=Cn()){return/blackberry/i.test(t)}function uC(t=Cn()){return/webos/i.test(t)}function t_(t=Cn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function pN(t=Cn()){return t_(t)&&!!window.navigator?.standalone}function gN(){return Zj()&&document.documentMode===10}function dC(t=Cn()){return t_(t)||lC(t)||uC(t)||cC(t)||/windows phone/i.test(t)||oC(t)}function hC(t,e=[]){let n;switch(t){case"Browser":n=DS(Cn());break;case"Worker":n=`${DS(Cn())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${jl}/${i}`}class yN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=l=>new Promise((c,h)=>{try{const f=e(l);c(f)}catch(f){h(f)}});i.onAbort=n,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function _N(t,e={}){return sa(t,"GET","/v2/passwordPolicy",to(t,e))}const bN=6;class vN{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??bN,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class xN{constructor(e,n,i,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jS(this),this.idTokenSubscription=new jS(this),this.beforeStateQueue=new yN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=X1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Fi(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await cl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Yh(this,{idToken:e}),i=await Lr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Pr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,c=i?._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===c)&&h?.user&&(i=h.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Xh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Zk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Pr(this.app))return Promise.reject(Gs(this));const n=e?Xt(e):null;return n&&Le(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Pr(this.app)?Promise.reject(Gs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Pr(this.app)?Promise.reject(Gs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _N(this),n=new vN(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new vu("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await mN(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Fi(e)||this._popupRedirectResolver;Le(n,this,"argument-error"),this.redirectPersistenceManager=await cl.create(this,[Fi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,a){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let c=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Le(h,this,"internal-error"),h.then(()=>{c||l(this.currentUser)}),typeof n=="function"){const f=e.addObserver(n,i,a);return()=>{c=!0,f()}}else{const f=e.addObserver(n);return()=>{c=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hC(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Pr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Yk(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Bl(t){return Xt(t)}class jS{constructor(e){this.auth=e,this.observer=null,this.addObserver=oI(n=>this.observer=n)}get next(){return Le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Of={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function SN(t){Of=t}function fC(t){return Of.loadJS(t)}function EN(){return Of.recaptchaEnterpriseScript}function wN(){return Of.gapiScript}function CN(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class TN{constructor(){this.enterprise=new AN}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class AN{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const RN="recaptcha-enterprise",mC="NO_RECAPTCHA";class DN{constructor(e){this.type=RN,this.auth=Bl(e)}async verify(e="verify",n=!1){async function i(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,h)=>{aN(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const p=new sN(f);return l.tenantId==null?l._agentRecaptchaConfig=p:l._tenantRecaptchaConfigs[l.tenantId]=p,c(p.siteKey)}}).catch(f=>{h(f)})})}function a(l,c,h){const f=window.grecaptcha;CS(f)?f.enterprise.ready(()=>{f.enterprise.execute(l,{action:e}).then(p=>{c(p)}).catch(()=>{c(mC)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new TN().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(h=>{if(!n&&CS(window.grecaptcha))a(h,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let f=EN();f.length!==0&&(f+=h),fC(f).then(()=>{a(h,l,c)}).catch(p=>{c(p)})}}).catch(h=>{c(h)})})}}async function IS(t,e,n,i=!1,a=!1){const l=new DN(t);let c;if(a)c=mC;else try{c=await l.verify(n)}catch{c=await l.verify(n,!0)}const h={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const f=h.phoneEnrollmentInfo.phoneNumber,p=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const f=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return i?Object.assign(h,{captchaResp:c}):Object.assign(h,{captchaResponse:c}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function MS(t,e,n,i,a){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await IS(t,e,n,n==="getOobCode");return i(t,l)}else return i(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await IS(t,e,n,n==="getOobCode");return i(t,c)}else return Promise.reject(l)})}function jN(t,e){const n=gy(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),l=n.getOptions();if($s(l,e??{}))return a;Ur(a,"already-initialized")}return n.initialize({options:e})}function IN(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(Fi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function MN(t,e,n){const i=Bl(t);Le(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=pC(e),{host:c,port:h}=ON(e),f=h===null?"":`:${h}`,p={url:`${l}//${c}${f}/`},_=Object.freeze({host:c,port:h,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Le(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Le($s(p,i.config.emulator)&&$s(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,Dl(c)?(WE(`${l}//${c}${f}`),KE("Auth",!0)):kN()}function pC(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function ON(t){const e=pC(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:OS(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:OS(c)}}}function OS(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function kN(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class n_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return zi("not implemented")}_getIdTokenResponse(e){return zi("not implemented")}_linkToIdToken(e,n){return zi("not implemented")}_getReauthenticationResolver(e){return zi("not implemented")}}async function NN(t,e){return sa(t,"POST","/v1/accounts:signUp",e)}async function PN(t,e){return Mf(t,"POST","/v1/accounts:signInWithPassword",to(t,e))}async function LN(t,e){return Mf(t,"POST","/v1/accounts:signInWithEmailLink",to(t,e))}async function BN(t,e){return Mf(t,"POST","/v1/accounts:signInWithEmailLink",to(t,e))}class fu extends n_{constructor(e,n,i,a=null){super("password",i),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new fu(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new fu(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return MS(e,n,"signInWithPassword",PN);case"emailLink":return LN(e,{email:this._email,oobCode:this._password});default:Ur(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return MS(e,i,"signUpPassword",NN);case"emailLink":return BN(e,{idToken:n,email:this._email,oobCode:this._password});default:Ur(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ul(t,e){return Mf(t,"POST","/v1/accounts:signInWithIdp",to(t,e))}const VN="http://localhost";class Wa extends n_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Wa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ur("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=n;if(!i||!a)return null;const c=new Wa(i,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const n=this.buildRequest();return ul(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,ul(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,ul(e,n)}buildRequest(){const e={requestUri:VN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=xu(n)}return e}}function UN(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function zN(t){const e=Gc($c(t)).link,n=e?Gc($c(e)).deep_link_id:null,i=Gc($c(t)).deep_link_id;return(i?Gc($c(i)).link:null)||i||n||e||t}class r_{constructor(e){const n=Gc($c(e)),i=n.apiKey??null,a=n.oobCode??null,l=UN(n.mode??null);Le(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=zN(e);try{return new r_(n)}catch{return null}}}class Vl{constructor(){this.providerId=Vl.PROVIDER_ID}static credential(e,n){return fu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=r_.parseLink(n);return Le(i,"argument-error"),fu._fromEmailAndCode(e,i.code,i.tenantId)}}Vl.PROVIDER_ID="password";Vl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Vl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class gC{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Iu extends gC{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ks extends Iu{constructor(){super("facebook.com")}static credential(e){return Wa._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ks.credential(e.oauthAccessToken)}catch{return null}}}ks.FACEBOOK_SIGN_IN_METHOD="facebook.com";ks.PROVIDER_ID="facebook.com";class Ns extends Iu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Wa._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ns.credentialFromTaggedObject(e)}static credentialFromError(e){return Ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return Ns.credential(n,i)}catch{return null}}}Ns.GOOGLE_SIGN_IN_METHOD="google.com";Ns.PROVIDER_ID="google.com";class Ps extends Iu{constructor(){super("github.com")}static credential(e){return Wa._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ps.credential(e.oauthAccessToken)}catch{return null}}}Ps.GITHUB_SIGN_IN_METHOD="github.com";Ps.PROVIDER_ID="github.com";class Ls extends Iu{constructor(){super("twitter.com")}static credential(e,n){return Wa._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Ls.credential(n,i)}catch{return null}}}Ls.TWITTER_SIGN_IN_METHOD="twitter.com";Ls.PROVIDER_ID="twitter.com";class xl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,a=!1){const l=await Lr._fromIdTokenResponse(e,i,a),c=kS(i);return new xl({user:l,providerId:c,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const a=kS(i);return new xl({user:e,providerId:a,_tokenResponse:i,operationType:n})}}function kS(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Jh extends Yi{constructor(e,n,i,a){super(n.code,n.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,Jh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,a){return new Jh(e,n,i,a)}}function yC(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Jh._fromErrorAndOperation(t,l,e,i):l})}async function FN(t,e,n=!1){const i=await hu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return xl._forOperation(t,"link",i)}async function qN(t,e,n=!1){const{auth:i}=t;if(Pr(i.app))return Promise.reject(Gs(i));const a="reauthenticate";try{const l=await hu(t,yC(i,a,e,t),n);Le(l.idToken,i,"internal-error");const c=e_(l.idToken);Le(c,i,"internal-error");const{sub:h}=c;return Le(t.uid===h,i,"user-mismatch"),xl._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Ur(i,"user-mismatch"),l}}async function _C(t,e,n=!1){if(Pr(t.app))return Promise.reject(Gs(t));const i="signIn",a=await yC(t,i,e),l=await xl._fromIdTokenResponse(t,i,a);return n||await t._updateCurrentUser(l.user),l}async function HN(t,e){return _C(Bl(t),e)}async function GN(t){const e=Bl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function $N(t,e,n){return Pr(t.app)?Promise.reject(Gs(t)):HN(Xt(t),Vl.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&GN(t),i})}function QN(t,e,n,i){return Xt(t).onIdTokenChanged(e,n,i)}function WN(t,e,n){return Xt(t).beforeAuthStateChanged(e,n)}function KN(t,e,n,i){return Xt(t).onAuthStateChanged(e,n,i)}function YN(t){return Xt(t).signOut()}const Zh="__sak";class bC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Zh,"1"),this.storage.removeItem(Zh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const XN=1e3,JN=10;class vC extends bC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dC(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),a=this.localCache[n];i!==a&&e(n,a,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((c,h,f)=>{this.notifyListeners(c,f)});return}const i=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(i);!n&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);gN()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,JN):a()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},XN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}vC.type="LOCAL";const ZN=vC;class xC extends bC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}xC.type="SESSION";const SC=xC;function e4(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class kf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const i=new kf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:a,data:l}=n.data,c=this.handlersMap[a];if(!c?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const h=Array.from(c).map(async p=>p(n.origin,l)),f=await e4(h);n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:f})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}kf.receivers=[];function i_(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class t4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((h,f)=>{const p=i_("",20);a.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},i);c={messageChannel:a,onMessage(b){const v=b;if(v.data.eventId===p)switch(v.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),h(v.data.response);break;default:clearTimeout(_),clearTimeout(l),f(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:n},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function pi(){return window}function n4(t){pi().location.href=t}function EC(){return typeof pi().WorkerGlobalScope<"u"&&typeof pi().importScripts=="function"}async function r4(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function i4(){return navigator?.serviceWorker?.controller||null}function s4(){return EC()?self:null}const wC="firebaseLocalStorageDb",a4=1,ef="firebaseLocalStorage",CC="fbase_key";class Mu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Nf(t,e){return t.transaction([ef],e?"readwrite":"readonly").objectStore(ef)}function o4(){const t=indexedDB.deleteDatabase(wC);return new Mu(t).toPromise()}function Yg(){const t=indexedDB.open(wC,a4);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(ef,{keyPath:CC})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(ef)?e(i):(i.close(),await o4(),e(await Yg()))})})}async function NS(t,e,n){const i=Nf(t,!0).put({[CC]:e,value:n});return new Mu(i).toPromise()}async function l4(t,e){const n=Nf(t,!1).get(e),i=await new Mu(n).toPromise();return i===void 0?null:i.value}function PS(t,e){const n=Nf(t,!0).delete(e);return new Mu(n).toPromise()}const c4=800,u4=3;class TC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Yg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>u4)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return EC()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=kf._getInstance(s4()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await r4(),!this.activeServiceWorker)return;this.sender=new t4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||i4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Yg();return await NS(e,Zh,"1"),await PS(e,Zh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>NS(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>l4(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>PS(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Nf(a,!1).getAll();return new Mu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),c4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}TC.type="LOCAL";const d4=TC;new ju(3e4,6e4);function h4(t,e){return e?Fi(e):(Le(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class s_ extends n_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ul(e,this._buildIdpRequest())}_linkToIdToken(e,n){return ul(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return ul(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function f4(t){return _C(t.auth,new s_(t),t.bypassAuthState)}function m4(t){const{auth:e,user:n}=t;return Le(n,e,"internal-error"),qN(n,new s_(t),t.bypassAuthState)}async function p4(t){const{auth:e,user:n}=t;return Le(n,e,"internal-error"),FN(n,new s_(t),t.bypassAuthState)}class AC{constructor(e,n,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:a,tenantId:l,error:c,type:h}=e;if(c){this.reject(c);return}const f={auth:this.auth,requestUri:n,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return f4;case"linkViaPopup":case"linkViaRedirect":return p4;case"reauthViaPopup":case"reauthViaRedirect":return m4;default:Ur(this.auth,"internal-error")}}resolve(e){Ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ki(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const g4=new ju(2e3,1e4);class il extends AC{constructor(e,n,i,a,l){super(e,n,a,l),this.provider=i,this.authWindow=null,this.pollId=null,il.currentPopupAction&&il.currentPopupAction.cancel(),il.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Le(e,this.auth,"internal-error"),e}async onExecution(){Ki(this.filter.length===1,"Popup operations only handle one event");const e=i_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(mi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(mi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,il.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(mi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,g4.get())};e()}}il.currentPopupAction=null;const y4="pendingRedirect",Dh=new Map;class _4 extends AC{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=Dh.get(this.auth._key());if(!e){try{const i=await b4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}Dh.set(this.auth._key(),e)}return this.bypassAuthState||Dh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function b4(t,e){const n=S4(e),i=x4(t);if(!await i._isAvailable())return!1;const a=await i._get(n)==="true";return await i._remove(n),a}function v4(t,e){Dh.set(t._key(),e)}function x4(t){return Fi(t._redirectPersistence)}function S4(t){return Rh(y4,t.config.apiKey,t.name)}async function E4(t,e,n=!1){if(Pr(t.app))return Promise.reject(Gs(t));const i=Bl(t),a=h4(i,e),c=await new _4(i,a,n).execute();return c&&!n&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}const w4=600*1e3;class C4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!T4(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!RC(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(mi(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=w4&&this.cachedEventUids.clear(),this.cachedEventUids.has(LS(e))}saveEventToCache(e){this.cachedEventUids.add(LS(e)),this.lastProcessedEventTime=Date.now()}}function LS(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function RC({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function T4(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return RC(t);default:return!1}}async function A4(t,e={}){return sa(t,"GET","/v1/projects",e)}const R4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,D4=/^https?/;async function j4(t){if(t.config.emulator)return;const{authorizedDomains:e}=await A4(t);for(const n of e)try{if(I4(n))return}catch{}Ur(t,"unauthorized-domain")}function I4(t){const e=Wg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&c.hostname===i}if(!D4.test(n))return!1;if(R4.test(t))return i===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const M4=new ju(3e4,6e4);function BS(){const t=pi().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function O4(t){return new Promise((e,n)=>{function i(){BS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{BS(),n(mi(t,"network-request-failed"))},timeout:M4.get()})}if(pi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(pi().gapi?.load)i();else{const a=CN("iframefcb");return pi()[a]=()=>{gapi.load?i():n(mi(t,"network-request-failed"))},fC(`${wN()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw jh=null,e})}let jh=null;function k4(t){return jh=jh||O4(t),jh}const N4=new ju(5e3,15e3),P4="__/auth/iframe",L4="emulator/auth/iframe",B4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},V4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function U4(t){const e=t.config;Le(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Zy(e,L4):`https://${t.config.authDomain}/${P4}`,i={apiKey:e.apiKey,appName:t.name,v:jl},a=V4.get(t.config.apiHost);a&&(i.eid=a);const l=t._getFrameworks();return l.length&&(i.fw=l.join(",")),`${n}?${xu(i).slice(1)}`}async function z4(t){const e=await k4(t),n=pi().gapi;return Le(n,t,"internal-error"),e.open({where:document.body,url:U4(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:B4,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const c=mi(t,"network-request-failed"),h=pi().setTimeout(()=>{l(c)},N4.get());function f(){pi().clearTimeout(h),a(i)}i.ping(f).then(f,()=>{l(c)})}))}const F4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},q4=500,H4=600,G4="_blank",$4="http://localhost";class VS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Q4(t,e,n,i=q4,a=H4){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const f={...F4,width:i.toString(),height:a.toString(),top:l,left:c},p=Cn().toLowerCase();n&&(h=aC(p)?G4:n),iC(p)&&(e=e||$4,f.scrollbars="yes");const _=Object.entries(f).reduce((v,[E,C])=>`${v}${E}=${C},`,"");if(pN(p)&&h!=="_self")return W4(e||"",h),new VS(null);const b=window.open(e||"",h,_);Le(b,t,"popup-blocked");try{b.focus()}catch{}return new VS(b)}function W4(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const K4="__/auth/handler",Y4="emulator/auth/handler",X4=encodeURIComponent("fac");async function US(t,e,n,i,a,l){Le(t.config.authDomain,t,"auth-domain-config-required"),Le(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:jl,eventId:a};if(e instanceof gC){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",aI(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,b]of Object.entries({}))c[_]=b}if(e instanceof Iu){const _=e.getScopes().filter(b=>b!=="");_.length>0&&(c.scopes=_.join(","))}t.tenantId&&(c.tid=t.tenantId);const h=c;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const f=await t._getAppCheckToken(),p=f?`#${X4}=${encodeURIComponent(f)}`:"";return`${J4(t)}?${xu(h).slice(1)}${p}`}function J4({config:t}){return t.emulator?Zy(t,Y4):`https://${t.authDomain}/${K4}`}const ug="webStorageSupport";class Z4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=SC,this._completeRedirectFn=E4,this._overrideRedirectResult=v4}async _openPopup(e,n,i,a){Ki(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await US(e,n,i,Wg(),a);return Q4(e,l,i_())}async _openRedirect(e,n,i,a){await this._originValidation(e);const l=await US(e,n,i,Wg(),a);return n4(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:l}=this.eventManagers[n];return a?Promise.resolve(a):(Ki(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await z4(e),i=new C4(e);return n.register("authEvent",a=>(Le(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ug,{type:ug},a=>{const l=a?.[0]?.[ug];l!==void 0&&n(!!l),Ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=j4(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return dC()||sC()||t_()}}const eP=Z4;var zS="@firebase/auth",FS="1.12.0";class tP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function nP(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rP(t){fl(new Ha("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:h}=i.options;Le(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:c,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hC(t)},p=new xN(i,a,l,f);return IN(p,n),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),fl(new Ha("auth-internal",e=>{const n=Bl(e.getProvider("auth").getImmediate());return(i=>new tP(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fs(zS,FS,nP(t)),Fs(zS,FS,"esm2020")}const iP=300,sP=QE("authIdTokenMaxAge")||iP;let qS=null;const aP=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>sP)return;const a=n?.token;qS!==a&&(qS=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function oP(t=ZE()){const e=gy(t,"auth");if(e.isInitialized())return e.getImmediate();const n=jN(t,{popupRedirectResolver:eP,persistence:[d4,ZN,SC]}),i=QE("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=aP(l.toString());WN(n,c,()=>c(n.currentUser)),QN(n,h=>c(h))}}const a=GE("auth");return a&&MN(n,`http://${a}`),n}function lP(){return document.getElementsByTagName("head")?.[0]??document}SN({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=a=>{const l=mi("internal-error");l.customData=a,n(l)},i.type="text/javascript",i.charset="UTF-8",lP().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});rP("Browser");function no(){const t=oP(yy);async function e(){return!1}async function n(h,f){return $N(t,h,f)}function i(){return YN(t)}function a(h){KN(t,f=>{h(f)})}function l(){return t.currentUser}return{set_user_listener:a,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:i,get_current_firebase_user:l}}const cP={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,lastActiveTab:"categories",lastSettingsTab:"categories",lastAdminTab:"budget",setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},setLastActiveTab:()=>{},setLastSettingsTab:()=>{},setLastAdminTab:()=>{},pageTitle:"Budget",setPageTitle:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},DC=A.createContext(cP);function uP({children:t}){const n=no().get_current_firebase_user(),[i,a]=A.useState(null),[l,c]=A.useState(new Date().getFullYear()),[h,f]=A.useState(new Date().getMonth()+1),[p,_]=A.useState("categories"),[b,v]=A.useState("categories"),[E,C]=A.useState("budget"),[w,D]=A.useState("Budget"),N=A.useCallback(V=>{D(q=>q===V?q:V)},[]),[U,k]=A.useState(!1),[X,G]=A.useState(!1),K=Ak(n?.uid||null,n?.email||null),O=K.data&&K.data.budget_ids.length===0,R=Dk(n?.uid||null,K.data||null,{enabled:!!n?.uid&&!!K.data&&O}),j=K.data?.permission_flags?.is_admin===!0,I=K.data?.permission_flags?.is_test===!0,M=R.data?.pendingInvites||[],H=R.data?.budgets||[],P=M.length>0;A.useEffect(()=>{if(!n||U||K.isLoading)return;const V=K.data;if(!(!V&&!K.isError))if(V&&V.budget_ids.length>0)a(V.budget_ids[0]),G(!1),k(!0);else{if(R.isLoading)return;const q=R.data;q?.pendingInvites&&q.pendingInvites.length>0?G(!1):G(!0),k(!0)}},[n,U,K.data,K.isLoading,K.isError,R.data,R.isLoading]);const ue=A.useCallback(()=>{h===1?(c(V=>V-1),f(12)):f(V=>V-1)},[h]),F=A.useCallback(()=>{h===12?(c(V=>V+1),f(1)):f(V=>V+1)},[h]),B=A.useCallback(async()=>{await R.refetch()},[R]),$=A.useCallback(V=>{a(V)},[]),Q=A.useCallback(async V=>{if(!n)return null;try{const q=await Ok(V,n.uid);return q&&q.isInvited&&!q.hasAccepted?{budgetId:V,budgetName:q.budgetName,ownerEmail:q.ownerEmail}:null}catch(q){return console.error("[BudgetContext] Error checking budget invite:",q),null}},[n]),se=A.useCallback(()=>{localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),ee={currentUserId:n?.uid||null,selectedBudgetId:i,currentYear:l,currentMonthNumber:h,lastActiveTab:p,lastSettingsTab:b,lastAdminTab:E,setSelectedBudgetId:a,setCurrentYear:c,setCurrentMonthNumber:f,setLastActiveTab:_,setLastSettingsTab:v,setLastAdminTab:C,pageTitle:w,setPageTitle:N,isInitialized:U,needsFirstBudget:X,goToPreviousMonth:ue,goToNextMonth:F,pendingInvites:M,hasPendingInvites:P,accessibleBudgets:H,isAdmin:j,isTest:I,loadAccessibleBudgets:B,switchToBudget:$,checkBudgetInvite:Q,clearCache:se};return u.jsx(DC.Provider,{value:ee,children:t})}function Pt(){const t=A.useContext(DC);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}const Ba={mobile:640,tablet:768,wide:1200},dP=Ba.mobile,dl=["January","February","March","April","May","June","July","August","September","October","November","December"],oe={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15",debt:"#fb923c",zero:"rgba(255, 255, 255, 0.4)"},mu={maxWidth:"var(--page-max-width, 85rem)",margin:"0 auto",padding:"var(--page-padding, 2rem)"},Ou={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},hP={...Ou,padding:"0.6rem 0.875rem",gap:"0.5rem"},fP={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},mP={display:"flex",flexDirection:"column",gap:"0.5rem"},pP={fontSize:"0.9rem",fontWeight:500},ro={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",width:"100%",boxSizing:"border-box"},gP={...ro,cursor:"pointer"},a_={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},jC={...a_,background:oe.primary,color:"white",border:"none"},yP={...jC,padding:"0.75rem 1.5rem",borderRadius:"8px"},_P={...a_,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},bP={...a_,background:"transparent",border:`1px solid ${oe.errorBorder}`,color:oe.error},vP={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},xP={display:"flex",gap:"0.5rem"},SP={display:"flex",gap:"0.25rem"},IC={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},EP={...IC,borderColor:oe.errorBorder,color:oe.error},Sl={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},o_={display:"flex",flexDirection:"column",gap:"2px"},wP={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},MC={opacity:.4,cursor:"grab"},OC={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:oe.primary,borderRadius:"2px",transition:"opacity 0.15s"},CP={position:"relative",height:"2rem",marginTop:"-0.25rem"},TP={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:oe.primary,borderRadius:"2px",transition:"opacity 0.15s"},AP={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},RP={background:oe.errorBg,border:`1px solid ${oe.errorBorder}`,color:oe.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},DP={background:"transparent",border:"none",color:oe.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},kC={opacity:.7,marginBottom:"1.5rem"},Pf={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},l_={fontWeight:500,fontSize:"1.1rem"},El={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function jP(){return u.jsxs("div",{style:mu,children:[u.jsx("nav",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:u.jsx(Tt,{to:"/",style:{display:"flex",alignItems:"center"},title:"Tarron Lane Home",children:u.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane Home",style:{width:"2rem",height:"2rem"}})})}),u.jsx("h1",{children:"Tarron Lane Homepage"}),u.jsx("nav",{children:u.jsxs("ul",{children:[u.jsx("li",{children:u.jsx(Tt,{to:"/sql-test",children:"SQL Test"})}),u.jsx("li",{children:u.jsx(Tt,{to:"/budget",children:"Budget"})}),u.jsx("li",{children:u.jsx(Tt,{to:"/account",children:"Account"})})]})})]})}function io({message:t,children:e,onDismiss:n,style:i}){return u.jsxs("div",{style:{...RP,...i},children:[u.jsx("span",{children:e??t}),n&&u.jsx("button",{onClick:n,style:DP,children:""})]})}const IP={primary:jC,"primary-large":yP,secondary:_P,danger:bP,small:vP};function Ie({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:i,disabled:a,style:l,actionName:c,onClick:h,...f}){const p=IP[t],_=a||e;function b(v){h?.(v)}return u.jsx("button",{disabled:_,style:{...p,cursor:_?"not-allowed":"pointer",opacity:_?.7:1,...l},onClick:b,...f,children:e?n:i})}function Xg(t,e){const n=t.toLowerCase(),i=e.toLowerCase();if(i.includes(n)){const h=i.indexOf(n);return{match:!0,score:h===0||/\s/.test(i[h-1])?100:90}}let a=0,l=0,c=0;for(let h=0;h<i.length&&a<n.length;h++)i[h]===n[a]?(a++,c++,l+=c*2):c=0;return a===n.length?{match:!0,score:l}:{match:!1,score:0}}const Jg={position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3},NC={padding:"0.6rem 0.8rem",cursor:"pointer",transition:"background 0.1s"};function HS({id:t,value:e,onChange:n,payees:i,placeholder:a="Enter payee name"}){const[l,c]=A.useState(!1),[h,f]=A.useState(-1),p=A.useRef(null),_=A.useRef(null),b=e.trim()?i.map(C=>({payee:C,...Xg(e,C)})).filter(C=>C.match).sort((C,w)=>w.score-C.score).slice(0,8).map(C=>C.payee):[];A.useEffect(()=>{function C(w){p.current&&!p.current.contains(w.target)&&c(!1)}return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);function v(C){!l||b.length===0||(C.key==="ArrowDown"?(C.preventDefault(),f(w=>Math.min(w+1,b.length-1))):C.key==="ArrowUp"?(C.preventDefault(),f(w=>Math.max(w-1,-1))):C.key==="Enter"&&h>=0?(C.preventDefault(),n(b[h]),c(!1),f(-1)):C.key==="Escape"&&(c(!1),f(-1)))}function E(C){n(C),c(!1),f(-1),_.current?.focus()}return u.jsxs("div",{ref:p,style:{position:"relative"},children:[u.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:C=>{n(C.target.value),c(!0),f(-1)},onFocus:()=>c(!0),onKeyDown:v,placeholder:a,autoComplete:"off",style:ro}),l&&b.length>0&&u.jsx("div",{style:{...Jg,maxHeight:"200px",overflowY:"auto"},children:b.map((C,w)=>u.jsx("div",{onClick:()=>E(C),style:{...NC,background:w===h?`color-mix(in srgb, ${oe.primary} 20%, transparent)`:"transparent",borderBottom:w<b.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none"},onMouseEnter:()=>f(w),children:C},C))})]})}function MP({id:t,value:e,onChange:n,categories:i,categoryGroups:a,placeholder:l="Search categories...",required:c,showNoCategoryOption:h=!1}){const f=Object.fromEntries(a.map(F=>[F.id,F.name])),p=Object.entries(i).map(([F,B])=>({id:F,name:B.name,groupId:B.category_group_id,groupName:B.category_group_id&&f[B.category_group_id]||null,sortOrder:B.sort_order}));h&&p.unshift({id:ci,name:Va,groupId:null,groupName:null,sortOrder:-1});const _=e===ci,b=_?null:e?i[e]:null,v=_?Va:b?.name||"",[E,C]=A.useState(v),[w,D]=A.useState(!1),[N,U]=A.useState(-1),k=A.useRef(null),X=A.useRef(null);A.useEffect(()=>{if(e===ci)C(Va);else{const F=e?i[e]:null;C(F?.name||"")}},[e,i]);const G=F=>F.sort((B,$)=>{if(B.groupId!==$.groupId){if(!B.groupId)return 1;if(!$.groupId)return-1;const Q=(B.groupName||"").localeCompare($.groupName||"");return Q!==0?Q:B.groupId.localeCompare($.groupId)}return B.sortOrder-$.sortOrder}),K=E.trim()?p.map(F=>({...F,...Xg(E,F.name),groupMatch:F.groupName?Xg(E,F.groupName):{match:!1,score:0}})).filter(F=>F.match||F.groupMatch.match).sort((F,B)=>{const $=Math.max(F.score,F.groupMatch.score*.5),Q=Math.max(B.score,B.groupMatch.score*.5);if(Q!==$)return Q-$;if(F.groupId!==B.groupId){if(!F.groupId)return 1;if(!B.groupId)return-1;const se=(F.groupName||"").localeCompare(B.groupName||"");return se!==0?se:F.groupId.localeCompare(B.groupId)}return F.sortOrder-B.sortOrder}).slice(0,10):G([...p]).slice(0,10);A.useEffect(()=>{function F(B){if(k.current&&!k.current.contains(B.target))if(D(!1),e===ci)C(Va);else{const $=e?i[e]:null;C($?.name||"")}}return document.addEventListener("mousedown",F),()=>document.removeEventListener("mousedown",F)},[e,i]);function O(F){if(F.key==="ArrowDown")F.preventDefault(),w?U(B=>Math.min(B+1,K.length-1)):(D(!0),U(0));else if(F.key==="ArrowUp")F.preventDefault(),U(B=>Math.max(B-1,0));else if(F.key==="Enter")F.preventDefault(),w&&N>=0&&K[N]&&R(K[N]);else if(F.key==="Escape")if(D(!1),U(-1),e===ci)C(Va);else{const B=e?i[e]:null;C(B?.name||"")}else if(F.key==="Tab"&&w&&K.length>0){const B=N>=0?N:0;R(K[B])}}function R(F){n(F.id),C(F.name),D(!1),U(-1),X.current?.focus()}function j(F){const B=F.target.value;C(B),D(!0),U(-1),B!==v&&n("")}function I(){D(!0),K.length>0&&U(0)}const M=[];let H="__initial__";K.forEach(F=>{F.groupId!==H&&(H=F.groupId,M.push({groupId:F.groupId,groupName:F.groupName,items:[]})),M[M.length-1].items.push(F)});let P=-1;const ue=()=>++P;return u.jsxs("div",{ref:k,style:{position:"relative"},children:[u.jsx("input",{ref:X,id:t,type:"text",value:E,onChange:j,onFocus:I,onKeyDown:O,placeholder:l,autoComplete:"off",required:c,style:{...ro,borderColor:c&&!e?oe.error:void 0}}),w&&K.length>0&&u.jsx("div",{style:{...Jg,maxHeight:"250px",overflowY:"auto"},children:M.map((F,B)=>u.jsxs("div",{children:[F.groupName&&u.jsx("div",{style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6,background:"color-mix(in srgb, currentColor 5%, transparent)",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:F.groupName}),F.items.map($=>{const Q=ue();return u.jsx("div",{onClick:()=>R($),style:{...NC,paddingLeft:F.groupName?"1.2rem":"0.8rem",background:Q===N?`color-mix(in srgb, ${oe.primary} 20%, transparent)`:"transparent",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},onMouseEnter:()=>U(Q),children:$.name},$.id)})]},`group-${B}`))}),w&&K.length===0&&E.trim()&&u.jsx("div",{style:{...Jg,padding:"0.6rem 0.8rem",opacity:.6,fontStyle:"italic"},children:"No matching categories"})]})}function Ka({children:t,onSubmit:e,actionName:n}){function i(a){e(a)}return u.jsx("form",{onSubmit:i,style:fP,children:t})}function Wt({label:t,htmlFor:e,children:n,hint:i,style:a}){return u.jsxs("div",{style:{...mP,...a},children:[u.jsx("label",{htmlFor:e,style:pP,children:t}),n,i&&u.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:i})]})}function Ya(t){return u.jsx("input",{style:ro,...t})}function OP(t){if(!t)return"";try{return new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return t}}function GS({value:t,onChange:e,style:n,...i}){const a=A.useRef(null),l=OP(t);function c(){a.current?.showPicker?.()}return u.jsxs("div",{style:{position:"relative"},children:[u.jsx("input",{ref:a,type:"date",value:t||"",onChange:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,pointerEvents:"none"},...i}),u.jsx("div",{onClick:c,style:{...ro,cursor:"pointer",display:"flex",alignItems:"center",fontSize:"0.85rem",fontFamily:"monospace",color:t?"inherit":"color-mix(in srgb, currentColor 50%, transparent)",...n},children:l||"Select date"})]})}function pu({children:t,...e}){return u.jsx("select",{style:gP,...e,children:t})}function c_({minHeight:t="6rem",style:e,...n}){return u.jsx("textarea",{style:{...ro,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function so({children:t}){return u.jsx("div",{style:wP,children:t})}function dg(t){const n=t.replace(/[^\d.]/g,"").split("."),i=n[0]||"",a=n[1],l=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return a!==void 0?`$${l}.${a.slice(0,2)}`:l?`$${l}`:""}function kP(t){return t.replace(/[$,]/g,"")}function Zg({id:t,value:e,onChange:n,placeholder:i="$0.00",required:a,autoFocus:l}){const[c,h]=A.useState(()=>dg(e)),f=A.useRef(null);A.useEffect(()=>{const _=dg(e);kP(c)!==e&&h(_)},[e]);function p(_){const b=_.target.value;if(!b||b==="$"){h(""),n("");return}const E=b.replace(/[^\d.]/g,"").split(".");let C=E[0];E.length>1&&(C+="."+E.slice(1).join("").slice(0,2));const w=dg(C);h(w),n(C)}return u.jsx("input",{ref:f,id:t,type:"text",inputMode:"decimal",value:c,onChange:p,placeholder:i,required:a,autoFocus:l,style:ro})}function aa(t=dP){const[e,n]=A.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return A.useEffect(()=>{const i=window.matchMedia(`(max-width: ${t-1}px)`);function a(c){n(c.matches)}a(i),i.addEventListener("change",a);function l(){n(window.innerWidth<t)}return window.addEventListener("resize",l),()=>{i.removeEventListener("change",a),window.removeEventListener("resize",l)}},[t]),e}function Lf({children:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:h,onEdit:f,onDelete:p,onMoveUp:_,onMoveDown:b,canMoveUp:v=!0,canMoveDown:E=!0,itemName:C}){const w=aa(),D=_||b;return u.jsxs("div",{onDragOver:N=>{N.stopPropagation(),a(N)},onDragLeave:N=>{N.stopPropagation(),l()},onDrop:N=>{N.stopPropagation(),h(N)},style:{position:"relative"},children:[u.jsx("div",{style:{...OC,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),u.jsxs("div",{style:{...w?hP:Ou,opacity:e?.5:1},children:[u.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:w?"0.5rem":"0.75rem",minWidth:0},children:[u.jsx("span",{draggable:!0,onDragStart:N=>{i(N)},onDragEnd:()=>{c()},style:{...MC,fontSize:w?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),u.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),u.jsxs("div",{style:w?SP:xP,children:[w?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>{f()},style:IC,title:"Edit","aria-label":"Edit",children:""}),u.jsx("button",{onClick:()=>{p()},style:EP,title:"Delete","aria-label":"Delete",children:""})]}):u.jsxs(u.Fragment,{children:[u.jsx(Ie,{variant:"secondary",actionName:`Edit ${C||"Item"}`,onClick:f,children:"Edit"}),u.jsx(Ie,{variant:"danger",actionName:`Delete ${C||"Item"}`,onClick:p,children:"Delete"})]}),D&&u.jsxs("div",{style:o_,children:[u.jsx("button",{onClick:N=>{N.stopPropagation(),_?.()},disabled:!v,style:{...Sl,opacity:v?.6:.2,cursor:v?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),u.jsx("button",{onClick:N=>{N.stopPropagation(),b?.()},disabled:!E,style:{...Sl,opacity:E?.6:.2,cursor:E?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function u_({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i,label:a="Move to end"}){return u.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:CP,children:[u.jsx("div",{style:{...TP,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&u.jsx("span",{style:AP,children:a})]})}function Pe(t){return`$${Math.abs(t).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function jn(t){return t<0?`-$${Math.abs(t).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function _i(t){return t===0?"$0.00":`${t>0?"+":"-"}${Pe(t)}`}function nr(t){return`${t>=0?"+":"-"}${Pe(t)}`}function St(t){return t===0?oe.zero:t>0?oe.success:oe.danger}function In(t){return t===0?oe.zero:t>0?oe.success:oe.debt}function Ul(t){return t===0?oe.zero:t<0?oe.error:oe.success}function Bf(t){return t===0?oe.zero:t>0?oe.success:oe.error}function PC(){const t=sn();return{submitFeedback:ir({mutationFn:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:c})=>{const h=i||n,f={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`${a}

(Submitted from: ${c})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l},{exists:p}=await He("feedback",h,"checking if user has existing feedback document");return p?await at("feedback",h,{items:L1(f),user_email:i,updated_at:new Date().toISOString()},"adding new feedback item to existing document",{merge:!0}):await at("feedback",h,{items:[f],user_email:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},"creating new feedback document for user"),{feedbackItem:f,docId:h}},onMutate:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:c})=>{await t.cancelQueries({queryKey:xe.feedback()});const h=t.getQueryData(xe.feedback()),f=i||n,p={id:`feedback_optimistic_${Date.now()}`,text:`${a}

(Submitted from: ${c})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l,doc_id:f,user_email:i};return t.setQueryData(xe.feedback(),_=>_?{items:[..._.items,p]}:{items:[p]}),{previousData:h,optimisticItemId:p.id}},onSuccess:(n,i,a)=>{t.setQueryData(xe.feedback(),l=>l&&{items:l.items.map(c=>c.id===a?.optimisticItemId?{...n.feedbackItem,doc_id:n.docId,user_email:i.userEmail}:c)})},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function NP(){const t=sn();return{toggleFeedback:ir({mutationFn:async({item:n})=>{const{exists:i,data:a}=await He("feedback",n.doc_id,"PRE-EDIT-READ");if(!i||!a)throw new Error(`Feedback document not found: ${n.doc_id}`);const l=!n.is_done,c=l?new Date().toISOString():null,h=a.items||[];let f=!1;const p=h.map(_=>_.id===n.id?(f=!0,{..._,is_done:l,completed_at:c}):_);if(!f)throw console.error("[toggleFeedback] Item not found in document",{searchingFor:n.id,inDocument:n.doc_id,availableIds:h.map(_=>_.id)}),new Error(`Feedback item not found in document. Item ID: ${n.id}, Doc ID: ${n.doc_id}`);return await at("feedback",n.doc_id,{...a,items:p,updated_at:new Date().toISOString()},`marking feedback item as ${l?"done":"not done"}`),{itemId:n.id,isDone:l,completedAt:c}},onMutate:async({item:n})=>{await t.cancelQueries({queryKey:xe.feedback()});const i=t.getQueryData(xe.feedback()),a=!n.is_done,l=a?new Date().toISOString():null;return t.setQueryData(xe.feedback(),c=>c&&{items:c.items.map(h=>h.id===n.id?{...h,is_done:a,completed_at:l}:h)}),{previousData:i}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function PP(){const t=sn();return{updateSortOrder:ir({mutationFn:async({docId:n,items:i})=>{const{exists:a,data:l}=await He("feedback",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Feedback document not found");return await at("feedback",n,{...l,items:i,updated_at:new Date().toISOString()},"saving reordered feedback items"),{docId:n,items:i}},onMutate:async({docId:n,items:i})=>{await t.cancelQueries({queryKey:xe.feedback()});const a=t.getQueryData(xe.feedback());return t.setQueryData(xe.feedback(),l=>{if(!l)return l;const c=new Map;return i.forEach(h=>{c.set(h.id,h.sort_order)}),{items:l.items.map(h=>h.doc_id===n&&c.has(h.id)?{...h,sort_order:c.get(h.id)}:h)}}),{previousData:a}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function ea({isOpen:t,onClose:e,title:n,children:i,width:a="28rem"}){if(!t)return null;function l(){e()}return u.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:l,children:u.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:a,maxWidth:"calc(100vw - 2rem)",flexShrink:0,boxSizing:"border-box",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:c=>c.stopPropagation(),children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[u.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),u.jsx("button",{onClick:l,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),i]})})}const LP=2e3,BP={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function VP(){const[t,e]=A.useState(!1),[n,i]=A.useState(""),[a,l]=A.useState("bug"),[c,h]=A.useState(!1),f=A.useContext(bu),_=no().get_current_firebase_user(),b=Tn(),{submitFeedback:v}=PC();if(A.useEffect(()=>{if(c){const w=setTimeout(()=>h(!1),LP);return()=>clearTimeout(w)}},[c]),b.pathname.includes("/admin/feedback")||!f.is_logged_in)return null;function C(w){w.preventDefault(),!(!n.trim()||!f.username||!_)&&(v.mutate({userId:_.uid,userEmail:f.username,text:n.trim(),feedbackType:a,currentPath:b.pathname}),i(""),l("bug"),e(!1),h(!0))}return u.jsxs(u.Fragment,{children:[c&&u.jsxs("div",{style:{position:"fixed",bottom:"5rem",right:"1.5rem",background:"rgba(46, 213, 115, 0.95)",color:"white",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1001,display:"flex",alignItems:"center",gap:"0.5rem",animation:"fadeInUp 0.2s ease-out"},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Feedback submitted!"})]}),u.jsx("button",{onClick:()=>{e(!0)},style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:oe.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:w=>{w.currentTarget.style.transform="scale(1.1)",w.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:w=>{w.currentTarget.style.transform="scale(1)",w.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),u.jsx(ea,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:u.jsxs("form",{onSubmit:C,children:[u.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(w=>{const D=BP[w],N=a===w;return u.jsxs("button",{type:"button",onClick:()=>{D.label,l(w)},style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${D.color}`,borderRadius:"0.5rem",background:N?D.bgColor:"transparent",color:N?D.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:N?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:N?1:.5,boxShadow:N?`0 0 12px ${D.bgColor}`:"none",position:"relative"},children:[D.label,N&&u.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},w)})}),u.jsx(c_,{value:n,onChange:w=>i(w.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),u.jsxs(so,{children:[u.jsx(Ie,{type:"button",variant:"secondary",actionName:"Cancel Feedback",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),u.jsx(Ie,{type:"submit",actionName:"Submit Feedback",disabled:!n.trim(),children:"Submit"})]})]})})]})}function Os({children:t,labelStyle:e,...n}){return u.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[u.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:oe.primary},...n}),t]})}function UP({title:t,count:e,children:n,defaultExpanded:i=!1}){const[a,l]=A.useState(i);return u.jsxs("div",{style:{marginTop:"2rem"},children:[u.jsxs("button",{onClick:()=>l(!a),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[u.jsx("span",{style:{transition:"transform 0.2s",transform:a?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),a&&n]})}const zP=t=>{switch(t){case 2:return 220;case 3:return 320;case 4:return 420;case 5:return 520;case 6:return 620;default:return t*100+20}},FP=t=>t<=4?2:t<=6?3:Math.ceil(t/2);function d_(t){const{tabs:e,activeTab:n}=t,i=e.filter(b=>!b.hidden),a=i.length,l=zP(a),c=FP(a),h=Math.floor(100/c),f=`tab-nav-${a}`,p=b=>({flex:"1 1 0",padding:"0.6rem 0.5rem",border:"none",borderRadius:0,background:"transparent",cursor:"pointer",fontWeight:b?600:400,fontSize:"0.9rem",color:"inherit",opacity:b?1:.5,transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem",position:"relative",boxSizing:"border-box",outline:"none"}),_=(b,v)=>u.jsxs(u.Fragment,{children:[u.jsx("span",{children:b.label}),b.checkmark&&u.jsx("span",{style:{color:oe.success,fontWeight:600},children:""}),v&&u.jsx("span",{style:{position:"absolute",bottom:"-1px",left:"15%",right:"15%",height:"3px",background:"white",borderRadius:"2px"}})]});return u.jsxs(u.Fragment,{children:[u.jsx("style",{children:`
        .${f} {
          display: flex;
          flex-wrap: wrap;
          margin-bottom: 1.5rem;
          border-bottom: 1px solid color-mix(in srgb, currentColor 15%, transparent);
        }
        .${f} > button,
        .${f} > a {
          border: none !important;
          border-radius: 0 !important;
          outline: none !important;
        }
        .${f} > button:hover,
        .${f} > button:focus,
        .${f} > a:hover,
        .${f} > a:focus {
          border: none !important;
          border-color: transparent !important;
        }
        @media (max-width: ${l}px) {
          .${f} > * {
            flex: 1 1 ${h}% !important;
            min-width: ${h}% !important;
          }
        }
      `}),u.jsx("div",{className:f,children:i.map(b=>{const v=n===b.id;return t.mode==="link"?u.jsx(Tt,{to:`${t.linkPrefix}/${b.id}`,onClick:()=>(`${b.label}`,void 0),style:p(v),children:_(b,v)},b.id):u.jsx("button",{onClick:()=>{`${b.label}`,t.onTabChange(b.id)},style:p(v),children:_(b,v)},b.id)})})]})}function h_({items:t}){const[e,n]=A.useState(!1),i=A.useRef(null),l=Tn().pathname;A.useEffect(()=>{function h(f){i.current&&!i.current.contains(f.target)&&n(!1)}if(e)return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[e]),A.useEffect(()=>{function h(f){f.key==="Escape"&&n(!1)}if(e)return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[e]);const c=t.filter(h=>h.hidden?!1:h.to?h.to==="/budget"?!(l==="/budget"||/^\/budget\/\d{4}\/\d{1,2}\/\w+$/.test(l)):h.to==="/account"||h.to==="/"?l!==h.to:!l.startsWith(h.to):!0);return u.jsxs("div",{ref:i,style:{position:"relative"},children:[u.jsx("button",{onClick:()=>{n(!e)},style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:e?"color-mix(in srgb, currentColor 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:"none",cursor:"pointer",fontSize:"1.25rem",color:"inherit",transition:"background 0.15s",lineHeight:1},title:"Menu","aria-expanded":e,"aria-haspopup":"true",children:""}),e&&u.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",minWidth:"180px",background:"#1a1a2e",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",zIndex:1e3,overflow:"hidden"},children:c.map((h,f)=>{if(h.divider)return u.jsx("div",{style:{height:"1px",background:"color-mix(in srgb, currentColor 15%, transparent)",margin:"0.25rem 0"}},f);const p=u.jsxs(u.Fragment,{children:[h.icon&&u.jsx("span",{style:{width:"1.5rem",textAlign:"center"},children:h.icon}),u.jsx("span",{children:h.label})]}),_={display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",fontSize:"0.95rem",color:"inherit",textDecoration:"none",cursor:"pointer",transition:"background 0.15s",background:"transparent",border:"none",width:"100%",textAlign:"left"},b={background:"color-mix(in srgb, currentColor 10%, transparent)"};return h.to?u.jsx(Tt,{to:h.to,style:_,onMouseEnter:v=>Object.assign(v.currentTarget.style,b),onMouseLeave:v=>v.currentTarget.style.background="transparent",onClick:()=>{`${h.label}`,n(!1)},children:p},f):u.jsx("button",{onClick:()=>{`${h.label}`,h.onClick?.(),n(!1)},style:_,onMouseEnter:v=>Object.assign(v.currentTarget.style,b),onMouseLeave:v=>v.currentTarget.style.background="transparent",children:p},f)})})]})}function qP({title:t,showBackArrow:e=!1,hideMenu:n=!1}){const{isAdmin:i}=Pt(),a=Tn(),c=[...a.pathname==="/budget"||a.pathname.startsWith("/budget/")&&!a.pathname.startsWith("/budget/settings")&&!a.pathname.startsWith("/budget/admin")&&!a.pathname.startsWith("/budget/analytics")&&!a.pathname.startsWith("/budget/my-budgets")?[]:[{label:"Budget",icon:"",to:"/budget"}],{label:"Budget Settings",icon:"",to:"/budget/settings"},{label:"Analytics",icon:"",to:"/budget/analytics"},...i?[{label:"Admin",icon:"",to:"/budget/admin"}]:[],{label:"Switch Budgets",icon:"",to:"/budget/my-budgets"},{divider:!0,label:""},{label:"Exit Budget App",icon:"",to:"/"}];return u.jsxs("nav",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[u.jsx("div",{style:{flex:"0 0 auto"},children:e?u.jsx(Tt,{to:"/",onClick:()=>void 0,style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none"},title:"Back to Home",children:""}):u.jsx(Tt,{to:"/budget",onClick:()=>void 0,title:"Budget Home",children:u.jsx("img",{src:"/budget-icon.svg",alt:"Budget",style:{width:"1.5rem",height:"1.5rem"}})})}),u.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem",textAlign:"center",flex:"1 1 auto"},children:t}),u.jsx("div",{style:{flex:"0 0 auto"},children:n?u.jsx("div",{style:{width:"1.5rem"}}):u.jsx(h_,{items:c})})]})}function LC({children:t,style:e}){return u.jsx("div",{style:{width:"100%",maxWidth:"var(--content-max-width, 900px)",marginLeft:"auto",marginRight:"auto",...e},children:t})}function ey(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function HP(){return u.jsxs("div",{style:mu,children:[u.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[u.jsx("div",{style:{display:"flex",alignItems:"center"},children:u.jsx(Tt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),u.jsxs(Tt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[u.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),u.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"SQL Test"})]}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:u.jsx(h_,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),u.jsx("h1",{children:"SQL Test"}),u.jsx("h2",{children:"Setup"}),u.jsxs("h3",{children:["1. Open up your preferred web browser to ",u.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),u.jsxs("ul",{children:[u.jsx("li",{children:"This is a basic online sql query editor"}),u.jsxs("li",{children:["It will include three tables: ",u.jsx("b",{children:'"Customer"'}),", ",u.jsx("b",{children:'"Orders"'}),", and ",u.jsx("b",{children:'"Shippings"'})]})]}),u.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),u.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:u.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),u.jsx("h2",{children:"SQL Problems"}),u.jsx("p",{children:"Write queries in the online editor to answer these questions."}),u.jsx("h3",{children:"Question #1"}),u.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),u.jsx("h3",{children:"Question #2"}),u.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function GP(){const t=A.useContext(bu),e=no(),[n,i]=A.useState(!1),a=Tn(),l=yu(),c=a.state?.from||"/";A.useEffect(()=>{t.is_logged_in&&c!=="/"&&l(c,{replace:!0})},[t.is_logged_in,c,l]);function h(){i(!0),e.logout_firebase_user().then(function(){i(!1)})}return u.jsxs("div",{style:mu,children:[u.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[u.jsx("div",{style:{display:"flex",alignItems:"center"},children:u.jsx(Tt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),u.jsxs(Tt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[u.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),u.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"Account"})]}),u.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:u.jsx(h_,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),u.jsx("h1",{children:"Account"}),t.is_logged_in?n?u.jsx("p",{children:"Logging Out..."}):u.jsxs(u.Fragment,{children:[u.jsxs("p",{children:["You are logged in as ",t.username]}),u.jsx("button",{onClick:h,style:{marginTop:"1rem"},children:"Logout"})]}):u.jsx($P,{})]})}function $P(){const t=no(),[e,n]=A.useState(""),[i,a]=A.useState(""),[l,c]=A.useState(!1),[h,f]=A.useState("");function p(v){n(v.target.value)}function _(v){a(v.target.value)}function b(v){v.preventDefault(),c(!0),f(""),t.login_firebase_user(e,i).then(function(){}).catch(function(){f("Incorrect login credentials")}).finally(function(){c(!1)})}return u.jsxs("form",{onSubmit:b,children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"username",children:"Email: "}),u.jsx("input",{id:"username",type:"email",value:e,onChange:p})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",children:"Password: "}),u.jsx("input",{id:"password",type:"password",value:i,onChange:_})]}),l?u.jsx("p",{children:"Logging in..."}):u.jsx("button",{children:"Login"}),h&&u.jsx("p",{style:{color:"red"},children:h})]})}function QP(){const[t,e]=A.useState(()=>typeof window>"u"?1200:window.innerWidth);return A.useEffect(()=>{function n(){e(window.innerWidth)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),{width:t,isWide:t>=Ba.wide,isMedium:t>=Ba.tablet&&t<Ba.wide,isNarrowMedium:t>=Ba.mobile&&t<Ba.tablet,isMobile:t<Ba.mobile}}function WP(){const t=sn();return{updateAccounts:ir({mutationFn:async({budgetId:n,accounts:i})=>{const{exists:a,data:l}=await He("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await at("budgets",n,{...l,accounts:i},"saving updated accounts (user edited account settings)"),i},onMutate:async({budgetId:n,accounts:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,accounts:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,accounts:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function KP(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order},i.expected_balance!==void 0&&(e[n].expected_balance=i.expected_balance),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function YP(){const t=sn();return{updateAccountGroups:ir({mutationFn:async({budgetId:n,accountGroups:i})=>{const{exists:a,data:l}=await He("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const c=KP(i);return await at("budgets",n,{...l,account_groups:c},"saving updated account groups (user edited group settings)"),i},onMutate:async({budgetId:n,accountGroups:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,accountGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,accountGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function XP(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,category_group_id:i.category_group_id??null,sort_order:i.sort_order,balance:i.balance??0},i.description!==void 0&&(e[n].description=i.description),i.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=i.default_monthly_amount),i.default_monthly_type!==void 0&&(e[n].default_monthly_type=i.default_monthly_type)}),e}function JP(){const t=sn();return{updateCategories:ir({mutationFn:async({budgetId:n,categories:i})=>{const{exists:a,data:l}=await He("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const c=XP(i);return await at("budgets",n,{...l,categories:c},"saving updated categories (user edited category settings)"),i},onMutate:async({budgetId:n,categories:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,categories:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,categories:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function ZP(){const t=sn();return{updateCategoryGroups:ir({mutationFn:async({budgetId:n,categoryGroups:i})=>{const{exists:a,data:l}=await He("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await at("budgets",n,{...l,category_groups:i},"saving updated category groups (user edited group settings)"),i},onMutate:async({budgetId:n,categoryGroups:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,categoryGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,categoryGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function eL(){const t=sn();return{renameBudget:ir({mutationFn:async({budgetId:n,newName:i})=>{const{exists:a,data:l}=await He("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await at("budgets",n,{...l,name:i.trim()},`renaming budget to "${i.trim()}"`),i.trim()},onMutate:async({budgetId:n,newName:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,name:i.trim()}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,budget:{...a.budget,name:n}})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function tL(){const t=sn();return{createBudget:ir({mutationFn:async({name:n,userId:i,userEmail:a})=>{const l=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,c=new Date().toISOString(),h={name:n.trim()||"My Budget",user_ids:[i],accepted_user_ids:[i],owner_id:i,owner_email:a,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:c,updated_at:c};await at("budgets",l,h,"creating new budget document");const{exists:f,data:p}=await He("users",i,"reading user document to add new budget to their list");return f&&p?await at("users",i,{...p,budget_ids:[l,...p.budget_ids],updated_at:c},"adding new budget to user's budget list"):await at("users",i,{uid:i,email:a,budget_ids:[l],created_at:c,updated_at:c},"creating new user document with first budget"),{budgetId:l,budget:{id:l,...h}}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:xe.user(i)}),t.invalidateQueries({queryKey:xe.accessibleBudgets(i)})}})}}function nL(){const t=sn();return{acceptInvite:ir({mutationFn:async({budgetId:n,userId:i})=>{const a=new Date().toISOString(),{exists:l,data:c}=await He("budgets",n,"verifying user was invited to this budget");if(!l||!c)throw new Error("Budget not found");if(!c.user_ids?.includes(i))throw new Error("You have not been invited to this budget");const{data:h}=await He("users",i,"PRE-EDIT-READ");if(h?.budget_ids?.includes(n))throw new Error("You have already accepted this invite");return await at("users",i,{...h||{uid:i,email:null},budget_ids:[n,...h?.budget_ids||[]],updated_at:a},"adding accepted budget to user's budget list"),await at("budgets",n,{...c,accepted_user_ids:[...c.accepted_user_ids||[],i]},"marking user as accepted in budget's accepted_user_ids"),{budgetId:n}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:xe.user(i)}),t.invalidateQueries({queryKey:xe.accessibleBudgets(i)}),t.invalidateQueries({queryKey:xe.budget(n.budgetId)})}})}}function rL(){const t=sn();return{inviteUser:ir({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await He("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");if(l.user_ids?.includes(i))throw new Error("User is already invited");return await at("budgets",n,{...l,user_ids:[...l.user_ids||[],i]},"adding user to budget's invited users list"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,user_ids:[...a.budget.user_ids,i]}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function iL(){const t=sn();return{revokeUser:ir({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await He("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await at("budgets",n,{...l,user_ids:(l.user_ids||[]).filter(c=>c!==i),accepted_user_ids:(l.accepted_user_ids||[]).filter(c=>c!==i)},"removing user from budget's access lists"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,user_ids:a.budget.user_ids.filter(l=>l!==i),accepted_user_ids:a.budget.accepted_user_ids.filter(l=>l!==i)}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function Mn(t,e){const n=U1(t),{updateAccounts:i}=WP(),{updateAccountGroups:a}=YP(),{updateCategories:l}=JP(),{updateCategoryGroups:c}=ZP(),{renameBudget:h}=eL(),{createBudget:f}=tL(),{acceptInvite:p}=nL(),{inviteUser:_}=rL(),{revokeUser:b}=iL(),v=n.data,E=v?.budget||null,C=A.useMemo(()=>v?.accounts||{},[v?.accounts]),w=A.useMemo(()=>v?.accountGroups||{},[v?.accountGroups]),D=A.useMemo(()=>v?.categories||{},[v?.categories]),N=A.useMemo(()=>v?.categoryGroups||[],[v?.categoryGroups]),U=E?.owner_id===e,k=A.useMemo(()=>E?.user_ids||[],[E?.user_ids]),X=A.useMemo(()=>E?.accepted_user_ids||[],[E?.accepted_user_ids]),G=E?.total_available??0,K=A.useMemo(()=>v?.monthMap||{},[v?.monthMap]),O=A.useCallback(async J=>{if(!t)throw new Error("No budget selected");await i.mutateAsync({budgetId:t,accounts:J})},[t,i]),R=A.useCallback(async J=>{if(!t)throw new Error("No budget selected");await a.mutateAsync({budgetId:t,accountGroups:J})},[t,a]),j=A.useCallback(async J=>{if(!t)throw new Error("No budget selected");await l.mutateAsync({budgetId:t,categories:J})},[t,l]),I=A.useCallback(async J=>{if(!t)throw new Error("No budget selected");await c.mutateAsync({budgetId:t,categoryGroups:J})},[t,c]),M=A.useCallback(async(J,ne)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.mutateAsync({budgetId:t,accounts:J}),a.mutateAsync({budgetId:t,accountGroups:ne})])},[t,i,a]),H=A.useCallback(async(J,ne)=>{if(!t)throw new Error("No budget selected");await Promise.all([l.mutateAsync({budgetId:t,categories:J}),c.mutateAsync({budgetId:t,categoryGroups:ne})])},[t,l,c]),P=A.useCallback(async J=>{if(!t)throw new Error("No budget selected");await h.mutateAsync({budgetId:t,newName:J})},[t,h]),ue=A.useCallback(async J=>{if(!e)throw new Error("Not authenticated");return await f.mutateAsync({name:J.trim()||"My Budget",userId:e,userEmail:null})},[e,f]),F=A.useCallback(async J=>{if(!t)throw new Error("No budget selected");await _.mutateAsync({budgetId:t,userId:J})},[t,_]),B=A.useCallback(async J=>{if(!t)throw new Error("No budget selected");await b.mutateAsync({budgetId:t,userId:J})},[t,b]),$=A.useCallback(async J=>{if(!e)throw new Error("Not authenticated");await p.mutateAsync({budgetId:J,userId:e})},[e,p]),Q=A.useCallback(J=>{if(!t)return;const ne=$e.getQueryData(xe.budget(t));ne&&$e.setQueryData(xe.budget(t),{...ne,accounts:J})},[t]),se=A.useCallback(J=>{if(!t)return;const ne=$e.getQueryData(xe.budget(t));ne&&$e.setQueryData(xe.budget(t),{...ne,accountGroups:J})},[t]),ee=A.useCallback(J=>{if(!t)return;const ne=$e.getQueryData(xe.budget(t));ne&&$e.setQueryData(xe.budget(t),{...ne,categories:J})},[t]),V=A.useCallback(J=>{if(!t)return;const ne=$e.getQueryData(xe.budget(t));ne&&$e.setQueryData(xe.budget(t),{...ne,categoryGroups:J})},[t]),q=A.useCallback(async()=>{t&&await $e.invalidateQueries({queryKey:xe.budget(t)})},[t]),Y=A.useCallback(()=>Object.entries(C).filter(([,J])=>{const ne=J.account_group_id?w[J.account_group_id]:void 0,re=ne?.on_budget!==void 0?ne.on_budget:J.on_budget!==!1,ge=ne?.is_active!==void 0?ne.is_active:J.is_active!==!1;return re&&ge}).reduce((J,[,ne])=>J+ne.balance,0),[C,w]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:E,accounts:C,accountGroups:w,categories:D,categoryGroups:N,isOwner:U,budgetUserIds:k,acceptedUserIds:X,totalAvailable:G,monthMap:K,saveAccounts:O,saveAccountGroups:R,saveCategories:j,saveCategoryGroups:I,saveAccountsAndGroups:M,saveCategoriesAndGroups:H,renameBudget:P,createBudget:ue,inviteUser:F,revokeUser:B,acceptInvite:$,setAccountsOptimistic:Q,setAccountGroupsOptimistic:se,setCategoriesOptimistic:ee,setCategoryGroupsOptimistic:V,refreshBudget:q,getOnBudgetTotal:Y}}function ao(t,e,n){const{addLoadingHold:i,removeLoadingHold:a}=qn(),l=wk(t,e,n,{enabled:!!t});A.useEffect(()=>(l.isLoading?i("month-query","Loading month data..."):a("month-query"),()=>a("month-query")),[l.isLoading,i,a]);const{addIncome:c}=qk(),{updateIncome:h}=Hk(),{deleteIncome:f}=Gk(),{addExpense:p}=$k(),{updateExpense:_}=Qk(),{deleteExpense:b}=Wk(),v=l.data?.month||null,E=v?.income||[],C=v?.expenses||[],w=v?.category_balances||[],D=v?.total_income||0,N=v?.total_expenses||0,U=v?.are_allocations_finalized||!1,k=v?.previous_month_income??0,X=A.useCallback(async(M,H,P,ue,F)=>{if(!t)throw new Error("No budget selected");const[B,$]=P.split("-").map(Number);await c(t,B,$,M,H,P,ue,F)},[t,c]),G=A.useCallback(async(M,H,P,ue,F,B)=>{if(!t)throw new Error("No budget selected");await h(t,e,n,M,H,P,ue,F,B)},[t,e,n,h]),K=A.useCallback(async M=>{if(!t)throw new Error("No budget selected");await f(t,e,n,M)},[t,e,n,f]),O=A.useCallback(async(M,H,P,ue,F,B,$)=>{if(!t)throw new Error("No budget selected");const[Q,se]=ue.split("-").map(Number);await p(t,Q,se,M,H,P,ue,F,B,$)},[t,p]),R=A.useCallback(async(M,H,P,ue,F,B,$,Q)=>{if(!t)throw new Error("No budget selected");await _(t,e,n,M,H,P,ue,F,B,$,Q)},[t,e,n,_]),j=A.useCallback(async M=>{if(!t)throw new Error("No budget selected");await b(t,e,n,M)},[t,e,n,b]),I=A.useCallback(async()=>{t&&await $e.invalidateQueries({queryKey:xe.month(t,e,n)})},[t,e,n]);return{isLoading:l.isLoading,isFetching:l.isFetching,error:l.error,month:v,income:E,expenses:C,categoryBalances:w,totalIncome:D,totalExpenses:N,areAllocationsFinalized:U,previousMonthIncome:k,addIncome:X,updateIncome:G,deleteIncome:K,addExpense:O,updateExpense:R,deleteExpense:j,refreshMonth:I}}function sL({currentBudget:t,accounts:e,accountGroups:n,setAccountsOptimistic:i,setAccountGroupsOptimistic:a,saveAccounts:l,saveAccountGroups:c,setError:h}){const f=A.useCallback(async(_,b,v)=>{const E=e[_];if(!E)return;const C=v==="ungrouped"?null:v,w=Object.entries(e).filter(([,U])=>(U.account_group_id||"ungrouped")===v),D={};Object.entries(e).forEach(([U,k])=>{U!==_&&(D[U]={...k})});let N;if(b==="__group_end__"||w.length===0||!w.find(([U])=>U===b))N=(w.length>0?Math.max(...w.filter(([k])=>k!==_).map(([,k])=>k.sort_order)):-1)+1;else{const U=w.find(([k])=>k===b);if(U){const[,k]=U;N=k.sort_order,Object.entries(D).forEach(([X,G])=>{(G.account_group_id||"ungrouped")===v&&G.sort_order>=N&&(D[X]={...G,sort_order:G.sort_order+1})})}else N=0}if(D[_]={...E,account_group_id:C,sort_order:N},i(D),!!t)try{await l(D)}catch(U){h(U instanceof Error?U.message:"Failed to save changes")}},[t,e,i,l,h]),p=A.useCallback(async(_,b)=>{if(_===b)return;const v=Object.entries(n).sort(([,N],[,U])=>N.sort_order-U.sort_order),E=v.findIndex(([N])=>N===_),C=[...v],[w]=C.splice(E,1);if(b==="__end__")C.push(w);else{const N=C.findIndex(([U])=>U===b);C.splice(N,0,w)}const D={};if(C.forEach(([N,U],k)=>{D[N]={...U,sort_order:k}}),a(D),!!t)try{await c(D)}catch(N){h(N instanceof Error?N.message:"Failed to save new order")}},[t,n,a,c,h]);return{reorderAccountsInGroup:f,reorderGroups:p}}function aL(){const{selectedBudgetId:t,currentUserId:e}=Pt(),{budget:n,accounts:i,accountGroups:a,saveAccounts:l,saveAccountGroups:c,saveAccountsAndGroups:h,setAccountsOptimistic:f,setAccountGroupsOptimistic:p}=Mn(t,e),[_,b]=A.useState(null),v=A.useMemo(()=>Object.entries(i).reduce((R,[j,I])=>{const M=I.account_group_id||"ungrouped";return R[M]||(R[M]=[]),R[M].push({...I,id:j}),R},{}),[i]),E=A.useMemo(()=>Object.entries(a).sort(([,R],[,j])=>R.sort_order-j.sort_order).map(([R,j])=>({...j,id:R})),[a]),C=A.useCallback((R,j)=>{if(!n)return;const I=Object.values(i).filter(F=>j==="ungrouped"?!F.account_group_id:F.account_group_id===j),M=I.length>0?Math.max(...I.map(F=>F.sort_order)):-1,H=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,P={nickname:R.nickname,description:"",balance:0,account_group_id:j==="ungrouped"?null:j,sort_order:M+1,is_income_account:R.is_income_account??!1,is_income_default:R.is_income_default??!1,is_outgo_account:R.is_outgo_account??!1,is_outgo_default:R.is_outgo_default??!1,on_budget:R.on_budget!==!1,is_active:R.is_active!==!1},ue={...i};R.is_income_default&&Object.keys(ue).forEach(F=>{ue[F]={...ue[F],is_income_default:!1}}),R.is_outgo_default&&Object.keys(ue).forEach(F=>{ue[F]={...ue[F],is_outgo_default:!1}}),ue[H]=P,f(ue),l(ue).catch(F=>b(F instanceof Error?F.message:"Failed to create account."))},[n,i,f,l]),w=A.useCallback((R,j)=>{if(!n)return;const I=i[R];if(!I)return;const M=I.account_group_id||"ungrouped",H=j.account_group_id;let P=I.sort_order;if(M!==(H||"ungrouped")){const F=Object.values(i).filter(B=>(B.account_group_id||"ungrouped")===(H||"ungrouped"));P=F.length>0?Math.max(...F.map(B=>B.sort_order))+1:0}const ue={};Object.entries(i).forEach(([F,B])=>{F===R?ue[F]={...B,nickname:j.nickname,account_group_id:H,sort_order:P,is_income_account:j.is_income_account??!1,is_income_default:j.is_income_default??!1,is_outgo_account:j.is_outgo_account??!1,is_outgo_default:j.is_outgo_default??!1,on_budget:j.on_budget!==!1,is_active:j.is_active!==!1}:(ue[F]={...B},j.is_income_default&&!I.is_income_default&&(ue[F].is_income_default=!1),j.is_outgo_default&&!I.is_outgo_default&&(ue[F].is_outgo_default=!1))}),f(ue),l(ue).catch(F=>b(F instanceof Error?F.message:"Failed to save account."))},[n,i,f,l]),D=A.useCallback(R=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[R]:j,...I}=i;f(I),l(I).catch(M=>b(M instanceof Error?M.message:"Failed to delete account."))},[n,i,f,l]),N=A.useCallback(async(R,j)=>{const I=i[R];if(!I)return;const M=I.account_group_id||"ungrouped",H=Object.entries(i).filter(([,Q])=>(Q.account_group_id||"ungrouped")===M).sort(([,Q],[,se])=>Q.sort_order-se.sort_order),P=H.findIndex(([Q])=>Q===R),ue=j==="up"?P-1:P+1;if(ue<0||ue>=H.length)return;const[F,B]=H[ue],$={};if(Object.entries(i).forEach(([Q,se])=>{Q===R?$[Q]={...se,sort_order:B.sort_order}:Q===F?$[Q]={...se,sort_order:I.sort_order}:$[Q]={...se}}),f($),!!n)try{await l($)}catch(Q){f(i),b(Q instanceof Error?Q.message:"Failed to move account")}},[n,i,f,l]),U=A.useCallback(R=>{if(!n)return;const j=Object.values(a).map(ue=>ue.sort_order),I=j.length>0?Math.max(...j):-1,M=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,H={name:R.name,sort_order:I+1,expected_balance:R.expected_balance,on_budget:R.on_budget,is_active:R.is_active},P={...a,[M]:H};p(P),c(P).catch(ue=>b(ue instanceof Error?ue.message:"Failed to create account type."))},[n,a,p,c]),k=A.useCallback((R,j)=>{if(!n)return;const I={...a,[R]:{...a[R],name:j.name,expected_balance:j.expected_balance,on_budget:j.on_budget,is_active:j.is_active}};p(I),c(I).catch(M=>b(M instanceof Error?M.message:"Failed to update account type."))},[n,a,p,c]),X=A.useCallback(R=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const j={};Object.entries(i).forEach(([H,P])=>{j[H]=P.account_group_id===R?{...P,account_group_id:null}:P});const{[R]:I,...M}=a;f(j),p(M),h(j,M).catch(H=>b(H instanceof Error?H.message:"Failed to delete account type."))},[n,i,a,f,p,h]),G=A.useCallback(async(R,j)=>{const I=Object.entries(a).sort(([,F],[,B])=>F.sort_order-B.sort_order),M=I.findIndex(([F])=>F===R),H=j==="up"?M-1:M+1;if(H<0||H>=I.length)return;const[P]=I.splice(M,1);I.splice(H,0,P);const ue={};if(I.forEach(([F,B],$)=>{ue[F]={...B,sort_order:$}}),p(ue),!!n)try{await c(ue)}catch(F){p(a),b(F instanceof Error?F.message:"Failed to move account type")}},[n,a,p,c]),{reorderAccountsInGroup:K,reorderGroups:O}=sL({currentBudget:n,accounts:i,accountGroups:a,setAccountsOptimistic:f,setAccountGroupsOptimistic:p,saveAccounts:l,saveAccountGroups:c,setError:b});return{accounts:i,accountGroups:a,accountsByGroup:v,sortedGroups:E,currentBudget:n,error:_,setError:b,handleCreateAccount:C,handleUpdateAccount:w,handleDeleteAccount:D,handleMoveAccount:N,handleCreateGroup:U,handleUpdateGroup:k,handleDeleteGroup:X,handleMoveGroup:G,reorderAccountsInGroup:K,reorderGroups:O}}function $S(t,e){if(!t)return{};const n={};return Object.entries(e).forEach(([i,a])=>{if(a.default_monthly_type==="percentage")return;const l=t.category_balances?.find(c=>c.category_id===i);l&&l.allocated>0?n[i]=l.allocated.toString():a.default_monthly_amount!==void 0&&a.default_monthly_amount>0?n[i]=a.default_monthly_amount.toString():n[i]=""}),n}function oL(){const{addLoadingHold:t,removeLoadingHold:e}=qn(),{selectedBudgetId:n,currentUserId:i,currentYear:a,currentMonthNumber:l}=Pt(),{categories:c,getOnBudgetTotal:h,totalAvailable:f}=Mn(n,i),{month:p,isLoading:_,previousMonthIncome:b,areAllocationsFinalized:v}=ao(n,a,l),E=A.useMemo(()=>p?.income?p.income.reduce((q,Y)=>q+Y.amount,0):0,[p]),{saveDraftAllocations:C}=Bk(),{finalizeAllocations:w}=Vk(),{deleteAllocations:D}=K1(),N=A.useMemo(()=>$S(p,c),[p,c]),[U,k]=A.useState(N),[X,G]=A.useState(!1),[K,O]=A.useState(null),R=A.useRef(null);A.useMemo(()=>Object.values(c).reduce((q,Y)=>q+(Y.balance??0),0),[c]),A.useEffect(()=>{if(!p)return;const q=`${p.year}-${p.month}`;R.current!==q&&(G(!1),k($S(p,c)),R.current=q)},[p,c]);const j=A.useCallback((q,Y)=>{if(Y.default_monthly_type==="percentage"&&Y.default_monthly_amount!==void 0)return Y.default_monthly_amount/100*b;const J=U[q],ne=parseFloat(J||"0");return isNaN(ne)?0:ne},[U,b]),I=A.useMemo(()=>Object.entries(c).reduce((q,[Y,J])=>{const ne=j(Y,J),re=J.balance??0;if(re<0){const ge=Math.abs(re),Ae=Math.max(0,ne-ge);return q+Ae}return q+ne},0),[c,j]),M=h(),H=v?(p?.category_balances||[]).reduce((q,Y)=>{const J=c[Y.category_id]?.balance??0,ne=Y.allocated,re=J-ne;if(re<0){const ge=Math.abs(re);return q+Math.max(0,ne-ge)}return q+ne},0):0,P=X?f+H:f,ue=A.useMemo(()=>X?P-I:P-I+H,[P,I,H,X]),F=A.useCallback((q,Y)=>{k(J=>({...J,[q]:Y}))},[]),B=A.useCallback(()=>{if(!p)return;const q={};Object.entries(c).forEach(([Y,J])=>{if(J.default_monthly_type==="percentage")return;const ne=p.category_balances?.find(re=>re.category_id===Y);ne&&ne.allocated>0?q[Y]=ne.allocated.toString():J.default_monthly_amount!==void 0&&J.default_monthly_amount>0?q[Y]=J.default_monthly_amount.toString():q[Y]=""}),k(q),G(!1)},[p,c]),$=A.useCallback(()=>{const q={};return Object.entries(c).forEach(([Y,J])=>{const ne=j(Y,J);ne>0&&(q[Y]=ne)}),q},[c,j]),Q=A.useCallback(async()=>{if(n){O(null),t("allocations-save","Saving allocations...");try{await C(n,a,l,$()),G(!1)}catch(q){O(q instanceof Error?q.message:"Failed to save allocations")}finally{e("allocations-save")}}},[n,a,l,C,$,t,e]),se=A.useCallback(async()=>{if(n){O(null),t("allocations-finalize","Applying allocations...");try{await w({budgetId:n,year:a,month:l,allocations:$(),onProgress:q=>{t("allocations-finalize",q.message)}}),G(!1)}catch(q){O(q instanceof Error?q.message:"Failed to finalize allocations")}finally{e("allocations-finalize")}}},[n,a,l,w,$,t,e]),ee=A.useCallback(async()=>{if(n){O(null),t("allocations-delete","Deleting allocations...");try{await D({budgetId:n,year:a,month:l,onProgress:Y=>{t("allocations-delete",Y.message)}});const q={};Object.entries(c).forEach(([Y,J])=>{J.default_monthly_type!=="percentage"&&(J.default_monthly_amount!==void 0&&J.default_monthly_amount>0?q[Y]=J.default_monthly_amount.toString():q[Y]="")}),k(q),G(!1)}catch(q){O(q instanceof Error?q.message:"Failed to delete allocations")}finally{e("allocations-delete")}}},[n,a,l,D,c,t,e]),V=I-H;return{localAllocations:U,isEditingAppliedAllocations:X,error:K,monthLoading:_,onBudgetTotal:M,availableNow:P,currentDraftTotal:I,draftChangeAmount:V,availableAfterApply:ue,previousMonthIncome:b,currentMonthIncome:E,allocationsFinalized:v,getAllocationAmount:j,handleAllocationChange:F,resetAllocationsToSaved:B,handleSaveAllocations:Q,handleFinalizeAllocations:se,handleDeleteAllocations:ee,setIsEditingAppliedAllocations:G,setError:O}}function lL({budgetId:t,categories:e,currentYear:n,currentMonth:i,updateCategoriesWithBalances:a}){const l=A.useMemo(()=>{const v={};return Object.entries(e).forEach(([E,C])=>{v[E]={current:C.balance??0,total:C.balance??0}}),v},[e]),[c,h]=A.useState(!1),[f,p]=A.useState(null),_=A.useCallback(async()=>{if(!t||Object.keys(e).length===0)return null;const v=Object.keys(e),{total:E}=await ES(t,v,n,i),C={};Object.entries(e).forEach(([D,N])=>{const U=N.balance,k=E[D]??0;Math.abs(U-k)>.01&&(C[D]={stored:U,calculated:k})});const w=Object.keys(C).length>0?C:null;return p(w),w},[t,e,n,i]),b=A.useCallback(async()=>{if(!(!t||Object.keys(e).length===0)){h(!0);try{const v=Object.keys(e),{total:E}=await ES(t,v,n,i),C={};Object.entries(e).forEach(([w,D])=>{C[w]={...D,balance:E[w]??0}}),await a(C),p(null)}finally{h(!1)}}},[t,e,a,n,i]);return{categoryBalances:l,loadingBalances:c,categoryBalanceMismatch:f,checkCategoryBalanceMismatch:_,recalculateAndSaveCategoryBalances:b}}function cL({categories:t,categoryGroups:e,currentBudget:n,setCategoriesOptimistic:i,setCategoryGroupsOptimistic:a,saveCategories:l,saveCategoryGroups:c,setError:h}){const[f,p]=A.useState(null),[_,b]=A.useState(null),[v,E]=A.useState(null),[C,w]=A.useState(null);function D(I,M){p("category"),b(M),I.dataTransfer.effectAllowed="move"}function N(I,M,H){I.preventDefault(),f==="category"&&(M!==_&&E(M),w(H))}function U(I,M){I.preventDefault(),f==="category"?(w(M),E(null)):f==="group"&&M!==_&&E(M)}function k(){E(null)}function X(){w(null)}function G(){p(null),b(null),E(null),w(null)}async function K(I,M,H){if(I.preventDefault(),I.stopPropagation(),!_||f!=="category"){G();return}const P=t[_];if(!P)return;const ue=H==="ungrouped"?null:H,F=Object.entries(t).filter(([,Q])=>(Q.category_group_id||"ungrouped")===H),B={};Object.entries(t).forEach(([Q,se])=>{Q!==_&&(B[Q]=se)});let $;if(M==="__group_end__"||F.length===0||!F.find(([Q])=>Q===M))$=(F.length>0?Math.max(...F.filter(([se])=>se!==_).map(([,se])=>se.sort_order)):-1)+1;else{const Q=F.find(([se])=>se===M);Q?($=Q[1].sort_order,Object.entries(B).forEach(([se,ee])=>{(ee.category_group_id||"ungrouped")===H&&ee.sort_order>=$&&(B[se]={...ee,sort_order:ee.sort_order+1})})):$=0}if(B[_]={...P,category_group_id:ue,sort_order:$},i(B),G(),!!n)try{await l(B)}catch(Q){h(Q instanceof Error?Q.message:"Failed to save changes")}}async function O(I,M){I.preventDefault(),f==="category"?await K(I,"__group_end__",M):f==="group"&&await j(I,M)}function R(I,M){I.stopPropagation(),p("group"),b(M),I.dataTransfer.effectAllowed="move"}async function j(I,M){if(I.preventDefault(),!_||f!=="group"||_===M){G();return}const H=e.findIndex(B=>B.id===_),P=[...e],[ue]=P.splice(H,1);if(M==="__end__")P.push(ue);else{const B=P.findIndex($=>$.id===M);P.splice(B,0,ue)}const F=P.map((B,$)=>({...B,sort_order:$}));if(a(F),G(),!!n)try{await c(F)}catch(B){h(B instanceof Error?B.message:"Failed to save new order")}}return{dragType:f,draggedId:_,dragOverId:v,dragOverGroupId:C,setDragOverId:E,setDragOverGroupId:w,handleCategoryDragStart:D,handleCategoryDragOver:N,handleDragOverGroup:U,handleDragLeave:k,handleDragLeaveGroup:X,handleDragEnd:G,handleCategoryDrop:K,handleDropOnGroup:O,handleGroupDragStart:R,handleGroupDrop:j}}function uL(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Pt(),{budget:a,categories:l,categoryGroups:c,isLoading:h,saveCategories:f,saveCategoryGroups:p,saveCategoriesAndGroups:_,setCategoriesOptimistic:b,setCategoryGroupsOptimistic:v,getOnBudgetTotal:E}=Mn(t,e),[C,w]=A.useState(null),{categoryBalances:D,loadingBalances:N,categoryBalanceMismatch:U,checkCategoryBalanceMismatch:k,recalculateAndSaveCategoryBalances:X}=lL({budgetId:t,categories:l,currentYear:n,currentMonth:i,updateCategoriesWithBalances:f}),G=cL({categories:l,categoryGroups:c,currentBudget:a,setCategoriesOptimistic:b,setCategoryGroupsOptimistic:v,saveCategories:f,saveCategoryGroups:p,setError:w});async function K(B,$){if(!a)return;const Q=$==="ungrouped"?null:$,se=Object.values(l).filter(J=>$==="ungrouped"?!J.category_group_id:J.category_group_id===$),ee=se.length>0?Math.max(...se.map(J=>J.sort_order)):-1,V=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,q={name:B.name,description:B.description??"",category_group_id:Q,sort_order:ee+1,default_monthly_amount:B.default_monthly_amount??0,default_monthly_type:B.default_monthly_type??"fixed",balance:0},Y={...l,[V]:q};b(Y);try{await f(Y)}catch(J){b(l),w(J instanceof Error?J.message:"Failed to create category")}}async function O(B,$){if(a)try{const Q=l[B];if(!Q)return;const se=Q.category_group_id||"ungrouped",ee=$.category_group_id;let V=Q.sort_order;if(se!==(ee||"ungrouped")){const Y=Object.values(l).filter(J=>(J.category_group_id||"ungrouped")===(ee||"ungrouped")).filter((J,ne,re)=>l[B]!==re[ne]);V=Y.length>0?Math.max(...Y.map(J=>J.sort_order))+1:0}const q={...l,[B]:{...Q,name:$.name,description:$.description??"",category_group_id:ee,sort_order:V,default_monthly_amount:$.default_monthly_amount??0,default_monthly_type:$.default_monthly_type??"fixed"}};b(q),await f(q)}catch(Q){w(Q instanceof Error?Q.message:"Failed to update category")}}async function R(B){if(confirm("Are you sure you want to delete this category?")&&a)try{const{[B]:$,...Q}=l;b(Q),await f(Q)}catch($){w($ instanceof Error?$.message:"Failed to delete category")}}async function j(B,$){const Q=l[B];if(!Q)return;const se=Q.category_group_id||"ungrouped",ee=Object.entries(l).filter(([,re])=>(re.category_group_id||"ungrouped")===se).sort((re,ge)=>re[1].sort_order-ge[1].sort_order),V=ee.findIndex(([re])=>re===B),q=$==="up"?V-1:V+1;if(q<0||q>=ee.length)return;const[Y,J]=ee[q],ne={};if(Object.entries(l).forEach(([re,ge])=>{re===B?ne[re]={...ge,sort_order:J.sort_order}:re===Y?ne[re]={...ge,sort_order:Q.sort_order}:ne[re]=ge}),b(ne),!!a)try{await f(ne)}catch(re){b(l),w(re instanceof Error?re.message:"Failed to move category")}}async function I(B){if(a)try{const $=c.length>0?Math.max(...c.map(ee=>ee.sort_order)):-1,Q={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:B.name,sort_order:$+1},se=[...c,Q];v(se),await p(se)}catch($){w($ instanceof Error?$.message:"Failed to create group")}}async function M(B,$){if(a)try{const Q=c.map(se=>se.id===B?{...se,name:$.name}:se);v(Q),await p(Q)}catch(Q){w(Q instanceof Error?Q.message:"Failed to update group")}}async function H(B){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&a)try{const $={};Object.entries(l).forEach(([se,ee])=>{$[se]=ee.category_group_id===B?{...ee,category_group_id:null}:ee});const Q=c.filter(se=>se.id!==B);b($),v(Q),await _($,Q)}catch($){w($ instanceof Error?$.message:"Failed to delete group")}}async function P(B,$){const Q=[...c].sort((Y,J)=>Y.sort_order-J.sort_order),se=Q.findIndex(Y=>Y.id===B),ee=$==="up"?se-1:se+1;if(ee<0||ee>=Q.length)return;const[V]=Q.splice(se,1);Q.splice(ee,0,V);const q=Q.map((Y,J)=>({...Y,sort_order:J}));if(v(q),!!a)try{await p(q)}catch(Y){v(c),w(Y instanceof Error?Y.message:"Failed to move group")}}const ue=Object.entries(l).reduce((B,[$,Q])=>{const se=Q.category_group_id||"ungrouped";return B[se]||(B[se]=[]),B[se].push([$,Q]),B},{}),F=[...c].sort((B,$)=>B.sort_order-$.sort_order);return{currentBudget:a,categories:l,categoryGroups:c,categoriesByGroup:ue,sortedGroups:F,categoryBalances:D,isLoading:h,loadingBalances:N,error:C,setError:w,getOnBudgetTotal:E,categoryBalanceMismatch:U,checkCategoryBalanceMismatch:k,recalculateAndSaveCategoryBalances:X,handleCreateCategory:K,handleUpdateCategory:O,handleDeleteCategory:R,handleMoveCategory:j,handleCreateGroup:I,handleUpdateGroup:M,handleDeleteGroup:H,handleMoveGroup:P,dragType:G.dragType,draggedId:G.draggedId,dragOverId:G.dragOverId,dragOverGroupId:G.dragOverGroupId,setDragOverId:G.setDragOverId,setDragOverGroupId:G.setDragOverGroupId,handleCategoryDragStart:G.handleCategoryDragStart,handleCategoryDragOver:G.handleCategoryDragOver,handleDragOverGroup:G.handleDragOverGroup,handleDragLeave:G.handleDragLeave,handleDragLeaveGroup:G.handleDragLeaveGroup,handleDragEnd:G.handleDragEnd,handleCategoryDrop:G.handleCategoryDrop,handleDropOnGroup:G.handleDropOnGroup,handleGroupDragStart:G.handleGroupDragStart,handleGroupDrop:G.handleGroupDrop}}function BC(t){return t.nickname===void 0||t.description===void 0||t.balance===void 0||t.sort_order===void 0||t.is_income_account===void 0||t.is_income_default===void 0||t.is_outgo_account===void 0||t.is_outgo_default===void 0||t.on_budget===void 0||t.is_active===void 0}function VC(t){return t.name===void 0||t.description===void 0||t.sort_order===void 0||t.default_monthly_amount===void 0||t.default_monthly_type===void 0||t.balance===void 0}function UC(t){return t.name===void 0||t.sort_order===void 0}function zC(t){return t.budget_id===void 0||t.year_month_ordinal===void 0||t.year===void 0||t.month===void 0||!Array.isArray(t.income)||t.total_income===void 0||t.previous_month_income===void 0||!Array.isArray(t.expenses)||t.total_expenses===void 0||!Array.isArray(t.account_balances)||!Array.isArray(t.category_balances)||t.are_allocations_finalized===void 0||t.created_at===void 0||t.updated_at===void 0}function FC(){const t=new Date,e=t.getFullYear();let i=t.getMonth()+1+2,a=e;return i>12&&(i-=12,a+=1),{year:a,month:i}}function qC(t,e,n){return t>n.year||t===n.year&&e>n.month}async function dL(){const t=await vr("budgets","database cleanup: scanning all budgets");let e=0,n=0,i=0,a=0,l=0,c=0,h=0,f=0,p=0;const _=new Set;for(const D of t.docs){const N=D.data;if(Array.isArray(N.accounts)||Array.isArray(N.categories)||Array.isArray(N.account_groups)){e++;continue}_.add(D.id),N.month_map===void 0&&f++,N.earliest_month!==void 0&&p++;const U=N.accounts;if(U&&typeof U=="object"){let G=!1;for(const K of Object.values(U))BC(K)&&(l++,G=!0);G&&n++}const k=N.categories;if(k&&typeof k=="object"){let G=!1;for(const K of Object.values(k))VC(K)&&(c++,G=!0);G&&i++}const X=N.account_groups;if(X&&typeof X=="object"){let G=!1;for(const K of Object.values(X))UC(K)&&(h++,G=!0);G&&a++}}const b=await vr("months","database cleanup: scanning all months"),v=FC(),E=[];let C=0,w=0;for(const D of b.docs){const N=D.data,U=N.year,k=N.month;U&&k&&qC(U,k,v)&&E.push({docId:D.id,budgetId:N.budget_id,year:U,month:k}),zC(N)&&C++,N.is_needs_recalculation!==void 0&&w++}return E.sort((D,N)=>D.year!==N.year?D.year-N.year:D.month-N.month),{totalBudgets:t.docs.length,budgetsWithArrays:e,budgetsWithMissingAccountDefaults:n,budgetsWithMissingCategoryDefaults:i,budgetsWithMissingGroupDefaults:a,accountsNeedingDefaults:l,categoriesNeedingDefaults:c,groupsNeedingDefaults:h,budgetsNeedingMonthMapUpdate:f,budgetsWithDeprecatedEarliestMonth:p,totalMonths:b.docs.length,futureMonthsToDelete:E,monthsWithSchemaIssues:C,monthsWithOldRecalcField:w}}function QS(t){return{nickname:t.nickname??"",description:t.description??"",balance:t.balance??0,account_group_id:t.account_group_id??null,sort_order:t.sort_order??0,is_income_account:t.is_income_account??!1,is_income_default:t.is_income_default??!1,is_outgo_account:t.is_outgo_account??!1,is_outgo_default:t.is_outgo_default??!1,on_budget:t.on_budget??!0,is_active:t.is_active??!0}}function WS(t){return{name:t.name??"",description:t.description??"",category_group_id:t.category_group_id??null,sort_order:t.sort_order??0,default_monthly_amount:t.default_monthly_amount??0,default_monthly_type:t.default_monthly_type??"fixed",balance:t.balance??0}}function KS(t){return{name:t.name??"",sort_order:t.sort_order??0,...t.expected_balance!==void 0&&{expected_balance:t.expected_balance},...t.on_budget!==void 0&&{on_budget:t.on_budget},...t.is_active!==void 0&&{is_active:t.is_active}}}function hL(t,e){const n=e.match(/_(\d{4})(\d{2})$/),i=n?parseInt(n[1]):new Date().getFullYear(),a=n?parseInt(n[2]):new Date().getMonth()+1,l=`${i}${String(a).padStart(2,"0")}`;return{budget_id:t.budget_id??"",year_month_ordinal:t.year_month_ordinal??l,year:t.year??i,month:t.month??a,income:Array.isArray(t.income)?t.income:[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:Array.isArray(t.expenses)?t.expenses:[],total_expenses:t.total_expenses??0,account_balances:Array.isArray(t.account_balances)?t.account_balances:[],category_balances:Array.isArray(t.category_balances)?t.category_balances:[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at??new Date().toISOString(),updated_at:t.updated_at??new Date().toISOString()}}async function fL(t){const e={},n=await vr("months",`database cleanup: querying all months for budget ${t}`,[{field:"budget_id",op:"==",value:t}]);for(const i of n.docs){const a=i.data;if(a.year&&a.month){const l=xt(a.year,a.month);e[l]={needs_recalculation:!1}}}return e}async function mL(){const t=[];let e=0,n=0,i=0,a=0,l=0,c=0,h=0,f=0,p=0,_=0;const b=await vr("budgets","database cleanup: reading all budgets to fix");for(const C of b.docs)try{const{exists:w,data:D}=await He("budgets",C.id,"database cleanup: reading budget for update");if(!w||!D)continue;let N=!1;const U={...D};if(Array.isArray(D.accounts)){const k=D.accounts,X={};for(const G of k){const K=G.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;X[K]=QS(G),n++}U.accounts=X,N=!0,l++}if(Array.isArray(D.categories)){const k=D.categories,X={};for(const G of k){const K=G.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;X[K]=WS(G),i++}U.categories=X,N=!0,l++}if(Array.isArray(D.account_groups)){const k=D.account_groups,X={};for(const G of k){const K=G.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;X[K]=KS(G),a++}U.account_groups=X,N=!0,l++}if(!Array.isArray(D.accounts)&&D.accounts&&typeof D.accounts=="object"){const k=D.accounts,X={};for(const[G,K]of Object.entries(k))BC(K)?(X[G]=QS(K),n++,N=!0):X[G]=K;N&&(U.accounts=X)}if(!Array.isArray(D.categories)&&D.categories&&typeof D.categories=="object"){const k=D.categories,X={};let G=!1;for(const[K,O]of Object.entries(k))VC(O)?(X[K]=WS(O),i++,G=!0):X[K]=O;G&&(U.categories=X,N=!0)}if(!Array.isArray(D.account_groups)&&D.account_groups&&typeof D.account_groups=="object"){const k=D.account_groups,X={};let G=!1;for(const[K,O]of Object.entries(k))UC(O)?(X[K]=KS(O),a++,G=!0):X[K]=O;G&&(U.account_groups=X,N=!0)}if(D.month_map===void 0){const k=await fL(C.id);U.month_map=k,N=!0,c++,console.log(`[DatabaseCleanup] Added complete month_map to budget ${C.id} with ${Object.keys(k).length} months`)}delete U.category_balances,delete U.allocations,delete U.allocations_finalized,delete U.is_needs_recalculation,delete U.earliest_month,N&&(await at("budgets",C.id,U,"database cleanup: saving fixed budget"),e++),D.earliest_month!==void 0&&(await Qa("budgets",C.id,{earliest_month:vS(),updated_at:new Date().toISOString()},`database cleanup: removing deprecated earliest_month from budget ${C.id}`),h++,console.log(`[DatabaseCleanup] Removed deprecated earliest_month from budget ${C.id}`))}catch(w){t.push(`Budget ${C.id}: ${w instanceof Error?w.message:"Unknown error"}`)}const v=await vr("months","database cleanup: reading all months"),E=FC();for(const C of v.docs)try{const w=C.data,D=w.year,N=w.month;if(D&&N&&qC(D,N,E)){await Yy("months",C.id,`database cleanup: deleting future month ${D}-${N}`),f++;continue}if(zC(w)){const U=hL(w,C.id);await at("months",C.id,U,"database cleanup: saving fixed month"),p++}w.is_needs_recalculation!==void 0&&(await Qa("months",C.id,{is_needs_recalculation:vS(),updated_at:new Date().toISOString()},`database cleanup: removing is_needs_recalculation from month ${D}/${N}`),_++,console.log(`[DatabaseCleanup] Removed is_needs_recalculation from month ${D}/${N}`))}catch(w){t.push(`Month ${C.id}: ${w instanceof Error?w.message:"Unknown error"}`)}return{budgetsProcessed:e,accountsFixed:n,categoriesFixed:i,groupsFixed:a,arraysConverted:l,monthMapsUpdated:c,deprecatedFieldsRemoved:h,futureMonthsDeleted:f,monthsFixed:p,oldRecalcFieldsRemoved:_,errors:t}}function pL({currentUser:t,onComplete:e}){const[n,i]=A.useState(!1),[a,l]=A.useState(!1),[c,h]=A.useState(null),[f,p]=A.useState(null);async function _(){if(t){i(!0);try{const C=await dL();h(C)}catch(C){console.error("Failed to scan database:",C)}finally{i(!1)}}}async function b(){if(t){l(!0),p(null);try{const C=await mL();p(C),e?.()}catch(C){p({budgetsProcessed:0,accountsFixed:0,categoriesFixed:0,groupsFixed:0,arraysConverted:0,monthMapsUpdated:0,deprecatedFieldsRemoved:0,futureMonthsDeleted:0,monthsFixed:0,oldRecalcFieldsRemoved:0,errors:[C instanceof Error?C.message:"Unknown error"]})}finally{l(!1)}}}const v=c!==null&&(c.budgetsWithArrays>0||c.accountsNeedingDefaults>0||c.categoriesNeedingDefaults>0||c.groupsNeedingDefaults>0||c.budgetsNeedingMonthMapUpdate>0||c.budgetsWithDeprecatedEarliestMonth>0||c.futureMonthsToDelete.length>0||c.monthsWithSchemaIssues>0||c.monthsWithOldRecalcField>0),E=c!==null?c.budgetsWithArrays+c.accountsNeedingDefaults+c.categoriesNeedingDefaults+c.groupsNeedingDefaults+c.budgetsNeedingMonthMapUpdate+c.budgetsWithDeprecatedEarliestMonth+c.futureMonthsToDelete.length+c.monthsWithSchemaIssues+c.monthsWithOldRecalcField:0;return{status:c,isScanning:n,scanStatus:_,hasIssues:v,totalIssues:E,isRunning:a,result:f,runCleanup:b}}function hg(t){return t.includes("@")?!1:!!(/_[a-z0-9]+_(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=2||/_[a-z0-9]+\.(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=1)}function gL(t){let e=t;const n=/^(.+)_(gmail|yahoo|hotmail|outlook|icloud|aol|proton|protonmail)\.(.+)$/i,i=e.match(n);return i?`${i[1]}@${i[2]}.${i[3]}`:(e=e.replace(/_com$/,".com").replace(/_net$/,".net").replace(/_org$/,".org").replace(/_edu$/,".edu").replace(/_io$/,".io"),e=e.replace(/_gmail_/,"@gmail.").replace(/_yahoo_/,"@yahoo.").replace(/_hotmail_/,"@hotmail.").replace(/_outlook_/,"@outlook.").replace(/_icloud_/,"@icloud."),e)}function Ih(t){if(t===null||typeof t!="object"||Array.isArray(t))return!1;const e=t;return e._methodName==="arrayUnion"&&Array.isArray(e.vc)}function HC(t){return t.vc||[]}function YS(t){return Array.isArray(t.items)?t.items:Ih(t.items)?HC(t.items):[]}function yL({currentUser:t}){const[e,n]=A.useState(!1),[i,a]=A.useState(!1),[l,c]=A.useState(null),[h,f]=A.useState(null);async function p(){if(!t)return;n(!0);const b={documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],isHealthy:!0};try{const v=await vr("feedback","feedback migration: scanning for issues");b.documentsFound=v.docs.length;for(const E of v.docs)hg(E.id)&&b.sanitizedDocuments.push(E.id),Ih(E.data.items)&&b.corruptedDocuments.push(E.id);b.isHealthy=b.sanitizedDocuments.length===0&&b.corruptedDocuments.length===0,c(b)}catch(v){console.error("Failed to scan feedback:",v)}finally{n(!1)}}async function _(){if(!t)return;a(!0);const b=h?{...h,mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]}:{documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]};try{const v=await vr("feedback","feedback migration: listing all documents");b.documentsFound=v.docs.length,b.sanitizedDocuments=[],b.corruptedDocuments=[];for(const E of v.docs){const C=hg(E.id);if(Ih(E.data.items)&&!C){b.corruptedDocuments.push(E.id);const D=HC(E.data.items);try{await at("feedback",E.id,{items:D,user_email:E.data.user_email||E.id,created_at:E.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: fixing corrupted arrayUnion in ${E.id}`),b.fixedDocuments++}catch(N){b.errors.push(`Failed to fix ${E.id}: ${N instanceof Error?N.message:"Unknown error"}`)}}}for(const E of v.docs)if(hg(E.id)){b.sanitizedDocuments.push(E.id);const C=E.id,w=gL(C),D=YS(E.data),{exists:N,data:U}=await He("feedback",w,`feedback migration: checking if ${w} exists`);if(N&&U){const k=YS(U),X=new Set(k.map(K=>K.id)),G=D.filter(K=>!X.has(K.id));if(G.length>0||Ih(U.items)){const K=[...k,...G];await at("feedback",w,{...U,items:K,updated_at:new Date().toISOString()},`feedback migration: merging ${G.length} items from ${C}`),b.mergedItems+=G.length}}else D.length>0&&(await at("feedback",w,{items:D,user_email:w,created_at:E.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: creating ${w} from ${C}`),b.mergedItems+=D.length);try{await Yy("feedback",C,`feedback migration: deleting sanitized document ${C}`),b.deletedDocuments++}catch(k){b.errors.push(`Failed to delete ${C}: ${k instanceof Error?k.message:"Unknown error"}`)}}f(b)}catch(v){b.errors.push(v instanceof Error?v.message:"Migration failed"),f(b)}finally{a(!1)}}return{status:l,isScanning:e,scanStatus:p,isMigratingFeedback:i,feedbackMigrationResult:h,migrateFeedbackDocuments:_}}async function _L(t){const{exists:e,data:n}=await He("budgets",t,`[delete all months] reading budget ${t} for reset`);if(!e||!n)return;const i={...n.accounts};for(const l of Object.keys(i))i[l]&&typeof i[l]=="object"&&(i[l]={...i[l],balance:0});const a={...n.categories};for(const l of Object.keys(a))a[l]&&typeof a[l]=="object"&&(a[l]={...a[l],balance:0});await at("budgets",t,{...n,accounts:i,categories:a,month_map:{},total_available:0,is_needs_recalculation:!1,updated_at:new Date().toISOString()},`[delete all months] resetting budget ${t} balances to zero`)}function bL({currentUser:t,onComplete:e}){const[n,i]=A.useState(!1),[a,l]=A.useState(!1),[c,h]=A.useState(null),[f,p]=A.useState(null),[_,b]=A.useState(null);async function v(){if(t){i(!0);try{const C=await vr("months","delete all months: scanning for all months"),w=[],D=new Set;for(const N of C.docs){const{budget_id:U,year:k,month:X}=N.data;D.add(U),w.push({docId:N.id,budgetId:U,year:k,month:X})}w.sort((N,U)=>N.budgetId!==U.budgetId?N.budgetId.localeCompare(U.budgetId):N.year!==U.year?N.year-U.year:N.month-U.month),h({monthsToDelete:w,monthsCount:w.length,budgetCount:D.size})}catch{}finally{i(!1)}}}async function E(){if(!t||!c||c.monthsToDelete.length===0)return;l(!0),p(null);const C=c.monthsToDelete.length,w=new Set,D=[];for(const G of c.monthsToDelete)w.add(G.budgetId);b({phase:"deleting",deleted:0,total:C,currentMonth:null,budgetsRecalculated:0,totalBudgets:c.budgetCount,percentComplete:0});const N=c.monthsToDelete.map(G=>({collectionPath:"months",docId:G.docId}));let U=0;try{await V1(N,"delete all months: batch deleting all month documents",G=>{U=G,b({phase:"deleting",deleted:G,total:C,currentMonth:`Batch ${Math.ceil(G/500)} of ${Math.ceil(C/500)}`,budgetsRecalculated:0,totalBudgets:c.budgetCount,percentComplete:Math.round(G/C*70)})}),U=C}catch(G){D.push(`Batch delete failed: ${G instanceof Error?G.message:"Unknown error"}`)}const k=Array.from(w);let X=0;for(const G of k){b({phase:"resetting-budgets",deleted:U,total:C,currentMonth:`Budget ${X+1}/${k.length}`,budgetsRecalculated:X,totalBudgets:k.length,percentComplete:70+Math.round(X/k.length*25)});try{await _L(G),X++}catch{X++}}b({phase:"clearing-cache",deleted:U,total:C,currentMonth:null,budgetsRecalculated:X,totalBudgets:k.length,percentComplete:95});try{$e.removeQueries({queryKey:["budget"]}),$e.removeQueries({queryKey:["month"]}),localStorage.removeItem("BUDGET_APP_QUERY_CACHE")}catch{}b({phase:"complete",deleted:U,total:C,currentMonth:null,budgetsRecalculated:X,totalBudgets:k.length,percentComplete:100}),p({deleted:U,errors:D,budgetsRecalculated:X}),l(!1),b(null),D.length===0&&(h({monthsToDelete:[],monthsCount:0,budgetCount:0}),e?.())}return{status:c,isScanning:n,scanStatus:v,isDeleting:a,deleteResult:f,deleteProgress:_,deleteAllMonths:E}}function GC(t){const e=[];let n="",i=!1;for(let a=0;a<t.length;a++){const l=t[a];l==='"'?i=!i:l===","&&!i?(e.push(n.trim()),n=""):n+=l}return e.push(n.trim()),e}function $C(t){if(!t)return 0;let e=t.replace(/[$\s]/g,"");const n=e.startsWith("(")||e.startsWith("-");e=e.replace(/[()]/g,"").replace("-",""),e=e.replace(/,/g,"");const i=parseFloat(e);return isNaN(i)?0:n?-i:i}function QC(t){if(!t)return null;const e=t.split("/");if(e.length!==3)return null;const n=parseInt(e[0],10),i=parseInt(e[1],10),a=parseInt(e[2],10);return isNaN(n)||isNaN(i)||isNaN(a)||n<1||n>12||i<1||i>31?null:{year:a,month:n,day:i}}function vL(t){const e=t.toLowerCase().trim();return e==="income"?"income":e==="spend"?"spend":e==="allocation"||e==="allocations"?"allocation":null}function WC(t){if(!t)return!1;const e=t.toLowerCase().trim();return e==="true"||e==="1"||e==="yes"}function xL(t){const e=t.split(`
`).filter(i=>i.trim()),n=[];for(const i of e){const a=GC(i);if(a.length<6)continue;const[l,c,h,f,p,_,b,v]=a;if(l.toLowerCase()==="type")continue;const E=vL(l);if(!E)continue;const C=QC(c);if(!C)continue;const w=$C(_),D=WC(v||"");n.push({recordType:E,date:c,year:C.year,month:C.month,day:C.day,payee:h,category:f,account:p,amount:w,description:b||"",cleared:D,rawLine:i})}return n}function KC(t,e,n){const i=e.toString().padStart(2,"0"),a=n.toString().padStart(2,"0");return`${t}-${i}-${a}`}function SL(t,e){return e.toLowerCase()==="income"?"income":t.toLowerCase()==="budget allocation"?"allocation":"spend"}function EL(t){const e=t.split(`
`).filter(i=>i.trim()),n=[];for(const i of e){const a=GC(i);if(a.length<5)continue;const[l,c,h,f,p,_,b]=a;if(l.toLowerCase()==="cash flow"||l.toLowerCase()==="date")continue;const v=QC(l);if(!v)continue;const E=SL(c,h),C=$C(p),w=WC(b||"");n.push({recordType:E,date:l,year:v.year,month:v.month,day:v.day,payee:c,category:h,account:f,amount:C,description:_||"",cleared:w,rawLine:i})}return n}const tf=["n/a","na","none","-",""];function YC(t,e,n){const i=t.toLowerCase();for(const[a,l]of Object.entries(e))if((n?l.nickname:l.name).toLowerCase()===i)return a;return null}function XC(t,e,n){if(tf.includes(t.toLowerCase().trim()))return ci;const i=n.get(t);return i?i.newId:YC(t,e,!1)}function JC(t,e,n){if(tf.includes(t.toLowerCase().trim()))return ol;const i=n.get(t);return i?i.newId:YC(t,e,!0)}function wL(t,e,n,i){const a=[];let l=0,c=0;const h=e.income.length,f=[];for(const _ of t){const b=JC(_.account,n,i);if(!b){a.push(`Unknown account "${_.account}" for income on ${_.date}`),c++;continue}const v={id:`income_import_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:_.amount,account_id:b,date:KC(_.year,_.month,_.day),payee:_.payee,description:_.description,cleared:_.cleared,created_at:new Date().toISOString()};f.push(v),l++}return{monthData:ia({...e,income:f,updated_at:new Date().toISOString()}),imported:l,skipped:c,errors:a,cleared:h}}function CL(t,e,n,i,a,l){const c=[];let h=0,f=0;const p=e.expenses.length,_=[];for(const v of t){const E=XC(v.category,n,a);if(!E){c.push(`Unknown category "${v.category}" for expense on ${v.date}`),f++;continue}const C=JC(v.account,i,l);if(!C){c.push(`Unknown account "${v.account}" for expense on ${v.date}`),f++;continue}const w={id:`expense_import_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:v.amount,category_id:E,account_id:C,date:KC(v.year,v.month,v.day),payee:v.payee,description:v.description,cleared:v.cleared,created_at:new Date().toISOString()};_.push(w),h++}return{monthData:ia({...e,expenses:_,updated_at:new Date().toISOString()}),imported:h,skipped:f,errors:c,cleared:p}}function TL(t,e,n,i){const a=[];let l=0,c=0;const h=e.category_balances.filter(_=>_.allocated>0).length,f=new Map;for(const _ of t){const b=XC(_.category,n,i);if(!b){a.push(`Unknown category "${_.category}" for allocation on ${_.date}`),c++;continue}const v=f.get(b)||0;f.set(b,v+_.amount),l++}const p=e.category_balances.map(_=>{const b=f.get(_.category_id);return b!==void 0?{..._,allocated:b,end_balance:_.start_balance+b-_.spent}:{..._,allocated:0,end_balance:_.start_balance-_.spent}});for(const[_,b]of f)p.find(v=>v.category_id===_)||p.push({category_id:_,start_balance:0,allocated:b,spent:0,end_balance:b});return{monthData:{...e,category_balances:p,are_allocations_finalized:!0,updated_at:new Date().toISOString()},imported:l,skipped:c,errors:a,cleared:h}}function AL(t,e,n,i,a){const l=new Set(Object.values(e).map(p=>p.name.toLowerCase())),c=new Set(Object.values(n).map(p=>p.nickname.toLowerCase())),h=new Set,f=new Set;for(const p of t){if(p.recordType==="spend"||p.recordType==="allocation"){const _=p.category.toLowerCase().trim(),b=l.has(_),v=i.has(p.category),E=tf.includes(_);!b&&!v&&!E&&p.category&&h.add(p.category)}if(p.recordType==="spend"||p.recordType==="income"){const _=p.account.toLowerCase().trim(),b=c.has(_),v=a.has(p.account),E=tf.includes(_);!b&&!v&&!E&&p.account&&f.add(p.account)}}return{unmappedCategories:Array.from(h).sort(),unmappedAccounts:Array.from(f).sort()}}const XS=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function RL(t,e,n){const i=Object.entries(t).reduce((l,[,c])=>{const h=c.account_group_id?n[c.account_group_id]:void 0,f=h?.on_budget!==void 0?h.on_budget:c.on_budget!==!1,p=h?.is_active!==void 0?h.is_active:c.is_active!==!1;return f&&p?l+(c.balance??0):l},0),a=Object.values(e).reduce((l,c)=>{const h=c.balance??0;return l+(h>0?h:0)},0);return i-a}async function DL(t,e,n){const{exists:i,data:a}=await He("budgets",t,"[seed import] reading budget for final update");if(!i||!a)throw new Error(`Budget ${t} not found`);const l={...a.accounts};for(const[b,v]of Object.entries(e.accountEndBalances))l[b]&&(l[b]={...l[b],balance:v});const c={...a.categories};for(const[b,v]of Object.entries(e.categoryEndBalances))c[b]&&(c[b]={...c[b],balance:v});const f={...a.month_map||{}};for(const{info:b}of n)f[b.ordinal]={needs_recalculation:!1};const p=RL(l,c,a.account_groups||{});await at("budgets",t,{...a,accounts:l,categories:c,total_available:p,is_needs_recalculation:!1,month_map:f,updated_at:new Date().toISOString()},"[seed import] saving final balances");const _=$e.getQueryData(xe.budget(t));if(_){const b={};for(const[E,C]of Object.entries(_.accounts)){const w=l[E];b[E]=w?{...C,balance:w.balance??C.balance}:C}const v={};for(const[E,C]of Object.entries(_.categories)){const w=c[E];v[E]=w?{...C,balance:w.balance??C.balance}:C}$e.setQueryData(xe.budget(t),{..._,accounts:b,categories:v,isNeedsRecalculation:!1,monthMap:f,budget:{..._.budget,accounts:l,categories:c,total_available:p,is_needs_recalculation:!1,month_map:f}})}}async function jL(t,e,n,i,a,l,c){const h=[];let f=0,p=0,_=0,b=0,v=0,E=0;const C=[],w=new Map;for(const I of e){const M=`${I.year}-${I.month}`;w.has(M)||w.set(M,[]),w.get(M).push(I)}for(const[I,M]of w){const[H,P]=I.split("-"),ue=parseInt(H,10),F=parseInt(P,10);C.push({key:I,year:ue,month:F,ordinal:xt(ue,F),name:`${XS[F-1]} ${ue}`,rows:M})}if(C.sort((I,M)=>I.ordinal.localeCompare(M.ordinal)),C.length>0){const I=new Set(C.map(F=>F.ordinal)),M=C[0],H=C[C.length-1];let P=M.year,ue=M.month;for(;P<H.year||P===H.year&&ue<=H.month;){const F=xt(P,ue);I.has(F)||C.push({key:`${P}-${ue}`,year:P,month:ue,ordinal:F,name:`${XS[ue-1]} ${P}`,rows:[]}),ue++,ue>12&&(ue=1,P++)}C.sort((F,B)=>F.ordinal.localeCompare(B.ordinal))}const D=C.filter(I=>I.rows.length===0).length,N=C.length;c({phase:"reading-months",currentMonth:null,monthsProcessed:0,totalMonths:N,recordsImported:0,totalRecords:e.length,monthsCreated:0,monthsToCreate:0,gapMonths:D,percentComplete:5,incomeImported:0,spendImported:0,allocationsImported:0});const U=await Promise.all(C.map(async I=>{try{const M=await yi(t,I.year,I.month,"seed import combined");return{info:I,data:M,needsCreation:!1}}catch{return{info:I,data:null,needsCreation:!0}}})),k=new Map(U.map(I=>[I.info.ordinal,I])),X=C.map(I=>k.get(I.ordinal)),G=X.filter(I=>I.needsCreation).length;if(G>0){c({phase:"creating-months",currentMonth:null,monthsProcessed:0,totalMonths:N,recordsImported:0,totalRecords:e.length,monthsCreated:0,monthsToCreate:G,gapMonths:D,percentComplete:15,incomeImported:0,spendImported:0,allocationsImported:0});for(const I of X)if(I.needsCreation)try{I.data=await G1(t,I.info.year,I.info.month,{bypassDateLimit:!0}),_++,c({phase:"creating-months",currentMonth:I.info.name,monthsProcessed:0,totalMonths:N,recordsImported:0,totalRecords:e.length,monthsCreated:_,monthsToCreate:G,gapMonths:D,percentComplete:15+Math.round(_/G*10),incomeImported:0,spendImported:0,allocationsImported:0})}catch(M){I.error=`Failed to create month ${I.info.month}/${I.info.year}: ${M instanceof Error?M.message:"Unknown error"}`,h.push(I.error),p+=I.info.rows.length}}c({phase:"processing-months",currentMonth:null,monthsProcessed:0,totalMonths:N,recordsImported:0,totalRecords:e.length,monthsCreated:_,monthsToCreate:G,gapMonths:D,percentComplete:30,incomeImported:0,spendImported:0,allocationsImported:0});const K=[];let O=0,R=z1;for(const I of X){if(!I.data||I.error){O++;continue}let M=I.data;const H=I.info.rows,P=H.filter(B=>B.recordType==="income"),ue=H.filter(B=>B.recordType==="spend"),F=H.filter(B=>B.recordType==="allocation");if(P.length>0){const B=wL(P,M,i,l);M=B.monthData,f+=B.imported,b+=B.imported,p+=B.skipped,h.push(...B.errors)}if(ue.length>0){const B=CL(ue,M,n,i,a,l);M=B.monthData,f+=B.imported,v+=B.imported,p+=B.skipped,h.push(...B.errors)}if(F.length>0){const B=TL(F,M,n,a);M=B.monthData,f+=B.imported,E+=B.imported,p+=B.skipped,h.push(...B.errors)}M=F1(M,R),R=$g(M),K.push({info:I.info,data:M}),O++,c({phase:"processing-months",currentMonth:I.info.name,monthsProcessed:O,totalMonths:N,recordsImported:f,totalRecords:e.length,monthsCreated:_,monthsToCreate:G,gapMonths:D,percentComplete:30+Math.round(O/N*30),incomeImported:b,spendImported:v,allocationsImported:E})}c({phase:"saving-months",currentMonth:null,monthsProcessed:K.length,totalMonths:K.length,recordsImported:f,totalRecords:e.length,monthsCreated:_,monthsToCreate:G,gapMonths:D,percentComplete:65,incomeImported:b,spendImported:v,allocationsImported:E});const j=K.map(({info:I,data:M})=>({collectionPath:"months",docId:xr(t,I.year,I.month),data:M}));try{await Ky(j,`seed import combined (${K.length} months)`)}catch(I){h.push(`Error batch saving months: ${I instanceof Error?I.message:"Unknown error"}`)}c({phase:"updating-budget",currentMonth:null,monthsProcessed:K.length,totalMonths:K.length,recordsImported:f,totalRecords:e.length,monthsCreated:_,monthsToCreate:G,gapMonths:D,percentComplete:85,incomeImported:b,spendImported:v,allocationsImported:E});try{await DL(t,R,K)}catch(I){h.push(`Error updating budget: ${I instanceof Error?I.message:"Unknown error"}`)}return{success:h.length===0,imported:f,skipped:p,errors:h}}function IL(t){const e=t.split(`
`)[0]?.toLowerCase().trim()||"";return e.startsWith("cash flow")||e.startsWith("date,")?"raw_cash_flow":(e.startsWith("type,")||e.startsWith("income,")||e.startsWith("spend,")||e.startsWith("allocation,"),"combined")}async function ML(t){if(!t)return{categoryMappings:new Map,accountMappings:new Map};try{const{exists:e,data:n}=await He("data_mappings",`${t}_import_data_map`,"loading existing import mappings");if(!e||!n)return{categoryMappings:new Map,accountMappings:new Map};const i=new Map,a=new Map;if(n.category_mappings)for(const[l,c]of Object.entries(n.category_mappings))i.set(l,{oldName:l,newId:c.id,newName:c.name});if(n.account_mappings)for(const[l,c]of Object.entries(n.account_mappings))a.set(l,{oldName:l,newId:c.id,newName:c.name});return{categoryMappings:i,accountMappings:a}}catch(e){return console.error("[useSeedImport] Failed to load existing mappings:",e),{categoryMappings:new Map,accountMappings:new Map}}}async function OL(t,e,n){if(!t)return;const i={},a={};for(const[c,h]of e)i[c]={id:h.newId,name:h.newName};for(const[c,h]of n)a[c]={id:h.newId,name:h.newName};const l={category_mappings:i,account_mappings:a,last_updated:new Date().toISOString()};await at("data_mappings",`${t}_import_data_map`,l,"saving import mappings")}function kL(t){const[e,n]=A.useState("idle"),[i,a]=A.useState(null),[l,c]=A.useState([]),[h,f]=A.useState([]),[p,_]=A.useState([]),[b,v]=A.useState([]),[E,C]=A.useState(new Map),[w,D]=A.useState(new Map),[N,U]=A.useState(null),[k,X]=A.useState(null),G=e==="parsing",K=e==="importing",O=l.length>0||h.length>0,R=A.useCallback(async(P,ue,F)=>{n("parsing"),U(null);try{const B=await P.text(),$=IL(B),Q=$==="raw_cash_flow"?EL(B):xL(B);if(console.log(`[useSeedImport] Detected format: ${$}, parsed ${Q.length} rows`),Q.length===0){n("error"),a(null);return}a(Q);const se=new Set,ee=new Set,V=["n/a","na","none","-",""];for(const Se of Q){if((Se.recordType==="spend"||Se.recordType==="allocation")&&Se.category){const ke=Se.category.toLowerCase().trim();V.includes(ke)||se.add(Se.category)}if((Se.recordType==="spend"||Se.recordType==="income")&&Se.account){const ke=Se.account.toLowerCase().trim();V.includes(ke)||ee.add(Se.account)}}const q=Array.from(se).sort(),Y=Array.from(ee).sort(),{categoryMappings:J,accountMappings:ne}=await ML(t),re=new Map;for(const[Se,ke]of Object.entries(ue))re.set(ke.name.toLowerCase(),{id:Se,name:ke.name});const ge=new Map;for(const[Se,ke]of Object.entries(F))ge.set(ke.nickname.toLowerCase(),{id:Se,name:ke.nickname});const Ae=[],pe=[];for(const Se of q)if(J.has(Se)){const ke=re.get(Se.toLowerCase()),Jt=J.get(Se);(!ke||ke.id!==Jt.newId)&&Ae.push(Se)}for(const Se of Y)if(ne.has(Se)){const ke=ge.get(Se.toLowerCase()),Jt=ne.get(Se);(!ke||ke.id!==Jt.newId)&&pe.push(Se)}_(Ae),v(pe);const ie=new Map(J);for(const Se of q)if(!ie.has(Se)){const ke=re.get(Se.toLowerCase());ke&&ie.set(Se,{oldName:Se,newId:ke.id,newName:ke.name})}const Ce=new Map(ne);for(const Se of Y)if(!Ce.has(Se)){const ke=ge.get(Se.toLowerCase());ke&&Ce.set(Se,{oldName:Se,newId:ke.id,newName:ke.name})}C(ie),D(Ce);const{unmappedCategories:Oe,unmappedAccounts:yt}=AL(Q,ue,F,ie,Ce);c(Oe),f(yt),Oe.length>0||yt.length>0?n("mapping"):n("ready")}catch(B){console.error("[useSeedImport] Parse error:",B),n("error"),a(null)}},[t]),j=A.useCallback((P,ue,F)=>{C(B=>{const $=new Map(B);return $.set(P,{oldName:P,newId:ue,newName:F}),$}),c(B=>{const $=B.filter(Q=>Q===P?!1:!E.has(Q));return $.length===0&&h.length===0&&n("ready"),$})},[E,h.length]),I=A.useCallback((P,ue,F)=>{D(B=>{const $=new Map(B);return $.set(P,{oldName:P,newId:ue,newName:F}),$}),f(B=>{const $=B.filter(Q=>Q===P?!1:!w.has(Q));return $.length===0&&l.length===0&&n("ready"),$})},[w,l.length]),M=A.useCallback(async(P,ue)=>{if(!t||!i)return;n("importing"),X({phase:"saving-mappings",currentMonth:null,monthsProcessed:0,totalMonths:0,recordsImported:0,totalRecords:i.length,monthsCreated:0,monthsToCreate:0,gapMonths:0,percentComplete:0,incomeImported:0,spendImported:0,allocationsImported:0}),await OL(t,E,w);const F=await jL(t,i,P,ue,E,w,B=>X(B));$e.removeQueries({queryKey:["month"]}),$e.removeQueries({queryKey:xe.budget(t)}),X(B=>B?{...B,phase:"complete",percentComplete:100}:null),U(F),n(F.success?"complete":"error")},[t,i,E,w]),H=A.useCallback(()=>{n("idle"),a(null),c([]),f([]),_([]),v([]),U(null),X(null)},[]);return{status:e,parsedData:i,unmappedCategories:l,unmappedAccounts:h,customMappedCategories:p,customMappedAccounts:b,categoryMappings:E,accountMappings:w,importResult:N,importProgress:k,parseFile:R,setCategoryMapping:j,setAccountMapping:I,runImport:M,reset:H,isParsing:G,isImporting:K,hasUnmappedEntities:O}}function NL({onCreateNew:t}){const[e,n]=A.useState(""),[i,a]=A.useState(!1),[l,c]=A.useState(null);async function h(f){f.preventDefault(),a(!0),c(null);try{await t(e.trim()||void 0)}catch(p){c(p instanceof Error?p.message:"Failed to create budget"),a(!1)}}return u.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[u.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),u.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&u.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:l}),u.jsx("button",{onClick:()=>c(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),u.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[u.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{children:""})," Create Your Budget"]}),u.jsxs("form",{onSubmit:h,children:[u.jsxs("div",{style:{marginBottom:"1.5rem"},children:[u.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),u.jsx("input",{type:"text",value:e,onChange:f=>n(f.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),u.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),u.jsx("button",{type:"submit",disabled:i,style:{width:"100%",background:oe.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontWeight:600,opacity:i?.7:1,fontSize:"1rem"},children:i?"Creating...":"Create Budget"})]})]}),u.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function PL({invites:t,onAccept:e,onCreateNew:n}){const[i,a]=A.useState(null),[l,c]=A.useState(!1),[h,f]=A.useState(""),[p,_]=A.useState(!1),[b,v]=A.useState(null);async function E(w){a(w),v(null);try{await e(w)}catch(D){v(D instanceof Error?D.message:"Failed to accept invitation"),a(null)}}async function C(w){w.preventDefault(),_(!0),v(null);try{await n(h.trim()||void 0)}catch(D){v(D instanceof Error?D.message:"Failed to create new budget"),_(!1)}}return u.jsxs("div",{children:[u.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),u.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),b&&u.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:b}),u.jsx("button",{onClick:()=>v(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),u.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[u.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{children:""})," Budget Invitations"]}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(w=>u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[u.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[u.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:w.budgetName}),w.ownerEmail&&u.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",w.ownerEmail]})]}),u.jsx("button",{onClick:()=>E(w.budgetId),disabled:i!==null||p,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null||p?"not-allowed":"pointer",fontWeight:500,opacity:i!==null||p?.7:1,fontSize:"0.9rem"},children:i===w.budgetId?"Joining...":"Accept & Join"})]},w.budgetId))})]}),u.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?u.jsxs("form",{onSubmit:C,children:[u.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),u.jsx("input",{type:"text",value:h,onChange:w=>f(w.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[u.jsx("button",{type:"submit",disabled:p||i!==null,style:{background:oe.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p||i!==null?"not-allowed":"pointer",fontWeight:500,opacity:p||i!==null?.7:1,fontSize:"0.9rem"},children:p?"Creating...":"Create Budget"}),u.jsx("button",{type:"button",onClick:()=>{c(!1),f("")},disabled:p,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p?"not-allowed":"pointer",fontWeight:500,opacity:p?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),u.jsx("button",{onClick:()=>c(!0),disabled:i!==null,style:{background:oe.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null?"not-allowed":"pointer",fontWeight:500,opacity:i!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function LL({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const i=A.useMemo(()=>[{id:"categories",label:"Categories",checkmark:n},{id:"accounts",label:"Accounts"},{id:"income",label:"Income"},{id:"spend",label:"Spend"}],[n]);return u.jsx(d_,{mode:"button",tabs:i,activeTab:t,onTabChange:a=>e(a)})}function BL({isOpen:t,onClose:e,onProceed:n,results:i}){const a=!i||i.status==="confirming",l=i&&!["confirming","done","error"].includes(i.status),c=a||i?.status==="done"||i?.status==="error";function h(){c&&e()}return u.jsx(ea,{isOpen:t,onClose:h,title:"Recalculate Balances",width:"540px",children:u.jsxs("div",{style:{padding:"0.5rem 0"},children:[a&&u.jsxs(u.Fragment,{children:[u.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",lineHeight:1.5},children:["This will recalculate category balances and account balances from the ",u.jsx("strong",{children:"current month forward"}),"."]}),u.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Use this if your data seems out of sync or after fixing bugs. Past months will not be modified."}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginBottom:"1.5rem"},children:[u.jsx(Ko,{status:"waiting",label:"Find all months to process"}),u.jsx(Ko,{status:"waiting",label:"Process months"}),u.jsx(Ko,{status:"waiting",label:"Update budget totals"})]}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[u.jsx(Ie,{variant:"secondary",actionName:"Cancel Recalculation",onClick:e,children:"Cancel"}),u.jsx(Ie,{actionName:"Proceed with Recalculation",onClick:n,children:"Proceed"})]})]}),!a&&u.jsxs(u.Fragment,{children:[u.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Recalculating category balances and account balances..."}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[u.jsx(Ko,{status:i?.status==="pending"?"waiting":"complete",label:"Find all months to process",detail:i&&i.status!=="pending"?`Found ${i.monthsFound||0} month${i.monthsFound!==1?"s":""}`:void 0}),u.jsx(Ko,{status:JS(i?.status,["pending","finding_months"],"processing_months"),label:"Process months",detail:i?.status==="processing_months"?`Processing: ${i.currentMonthLabel} (${(i.currentMonthIndex||0)+1}/${i.monthsFound||0})`:i?.monthsProcessed!==void 0?`Processed ${i.monthsProcessed} month${i.monthsProcessed!==1?"s":""}`:void 0}),u.jsx(Ko,{status:i?.status==="error"?"error":JS(i?.status,["pending","finding_months","processing_months"],"updating_budget"),label:"Update budget totals",detail:i?.status==="error"?i.error:void 0,isError:i?.status==="error"})]}),i?.status==="done"&&u.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${oe.success} 10%, transparent)`,border:`1px solid ${oe.success}`,borderRadius:"8px",textAlign:"center"},children:[u.jsx("p",{style:{margin:0,fontWeight:600,color:oe.success},children:" Recalculation complete!"}),u.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:[i.monthsProcessed," month",i.monthsProcessed!==1?"s":""," processed",u.jsx("br",{}),"Total Income: ",Pe(i.totalIncomeRecalculated||0),u.jsx("br",{}),"Total Expenses: ",Pe(i.totalExpensesRecalculated||0)]})]}),(i?.status==="done"||i?.status==="error")&&u.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"center"},children:u.jsx(Ie,{actionName:"Close Recalculation Modal",onClick:e,children:"Done"})}),l&&u.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"Please wait, do not close this window..."})]})]})})}function JS(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function Ko({status:t,label:e,detail:n,isError:i}){const a=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[u.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:a}),u.jsxs("div",{style:{flex:1},children:[u.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&u.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:i?1:.6,color:i?oe.error:"inherit"},children:n})]})]})}async function VL(t,e,n,i,a,l){const c=xr(t,e.year,e.month),{exists:h,data:f}=await He("months",c,"recalculate: reading full month data");if(!h||!f)return null;const p=f.income||[],_=f.expenses||[],b=f.are_allocations_finalized||!1,v=p.reduce((k,X)=>k+X.amount,0),E=_.reduce((k,X)=>k+X.amount,0),C={};if(f.category_balances)for(const k of f.category_balances)C[k.category_id]={allocated:k.allocated??0};const w=n.map(k=>{const X=a[k]??0;let G=0;b&&C[k]&&(G=C[k].allocated);let K=0;_.length>0&&(K=_.filter(R=>R.category_id===k).reduce((R,j)=>R+j.amount,0));const O=X+G+K;return{category_id:k,start_balance:X,allocated:G,spent:K,end_balance:O}});w.forEach(k=>{a[k.category_id]=k.end_balance});const N=Object.keys(i).map(k=>{const X=p.filter(R=>R.account_id===k).reduce((R,j)=>R+j.amount,0),G=_.filter(R=>R.account_id===k).reduce((R,j)=>R+j.amount,0),K=X+G;let O=0;if(f.account_balances){const R=f.account_balances.find(j=>j.account_id===k);R&&(O=R.start_balance??0)}return{account_id:k,start_balance:O,income:X,expenses:G,net_change:K,end_balance:O+K}});return{updatedMonth:{budget_id:t,year_month_ordinal:xt(e.year,e.month),year:e.year,month:e.month,income:p,total_income:v,previous_month_income:l,expenses:_,total_expenses:E,account_balances:N,category_balances:w,are_allocations_finalized:b,created_at:f.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},totalIncome:v,totalExpenses:E}}async function UL(t,e){const{queryCollection:n}=await mk(async()=>{const{queryCollection:l}=await Promise.resolve().then(()=>zO);return{queryCollection:l}},[]),i={};Object.keys(e).forEach(l=>{i[l]=0});const a=await n("months","recalculate: querying all months for account balances",[{field:"budget_id",op:"==",value:t}]);for(const l of a.docs){const c=xr(t,l.data.year,l.data.month),{exists:h,data:f}=await He("months",c,"recalculate: reading month for account balances");if(!h||!f)continue;const p=f.income||[],_=f.expenses||[];for(const b of p)b.account_id&&i[b.account_id]!==void 0&&(i[b.account_id]+=b.amount);for(const b of _)b.account_id&&i[b.account_id]!==void 0&&(i[b.account_id]-=b.amount)}return i}function f_({isDisabled:t,onCloseMenu:e}){const{selectedBudgetId:n,currentUserId:i,currentYear:a,currentMonthNumber:l}=Pt(),{categories:c,accounts:h,saveCategories:f,saveAccounts:p}=Mn(n,i),[_,b]=A.useState(!1),[v,E]=A.useState(!1),[C,w]=A.useState(null);function D(){E(!0),w({status:"confirming"})}async function N(){if(n){b(!0),w({status:"pending"});try{w({status:"finding_months"});const k=new Date,X=a||k.getFullYear(),G=l||k.getMonth()+1,{year:K,month:O}=Xy(X,G),R=await XO(n,K,O),j=Object.keys(c);w({status:"finding_months",monthsFound:R.length}),await new Promise(ee=>setTimeout(ee,100));const I={},M=xr(n,K,O),{exists:H,data:P}=await He("months",M,"recalculate: reading previous month for starting balances");if(H&&P?.category_balances)for(const ee of P.category_balances)I[ee.category_id]=ee.end_balance??0;j.forEach(ee=>{I[ee]===void 0&&(I[ee]=0)});let ue=0,F=0,B=P?.total_income??0;for(let ee=0;ee<R.length;ee++){const V=R[ee],q=`${dl[V.month-1]} ${V.year}`;w({status:"processing_months",monthsFound:R.length,currentMonthIndex:ee,currentMonthLabel:q});const Y=await VL(n,V,j,h,I,ee===0?P?.total_income??0:B);Y&&(ue+=Y.totalIncome,F+=Y.totalExpenses,B=Y.totalIncome,await Pk({budgetId:n,month:Y.updatedMonth,description:"recalculate all months"}),await new Promise(J=>setTimeout(J,50)))}const $=await UL(n,h),Q={};Object.entries(h).forEach(([ee,V])=>{Q[ee]={...V,balance:$[ee]??0}}),await p(Q),w({status:"updating_budget",monthsFound:R.length,monthsProcessed:R.length,totalIncomeRecalculated:ue,totalExpensesRecalculated:F});const se={};Object.entries(c).forEach(([ee,V])=>{se[ee]={...V,balance:I[ee]??0}}),await f(se);for(const ee of R)$e.invalidateQueries({queryKey:xe.month(n,ee.year,ee.month)});w({status:"done",monthsFound:R.length,monthsProcessed:R.length,totalIncomeRecalculated:ue,totalExpensesRecalculated:F})}catch(k){console.error("Recalculate error:",k),w({status:"error",error:k instanceof Error?k.message:"Failed to recalculate"})}finally{b(!1)}}}function U(){E(!1),w(null),e?.()}return u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:D,disabled:t||_,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:t||_?"not-allowed":"pointer",opacity:t||_?.5:1,fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},title:"Recalculate balances from this month forward",children:[_?"":""," Recalculate"]}),u.jsx(BL,{isOpen:v,onClose:U,onProceed:N,results:C})]})}function ZS({direction:t,isDisabled:e,isLoading:n,disabledReason:i,onNavigate:a}){const[l,c]=A.useState(!1),h=n||e,f=t==="prev"?"":"",p=t==="prev"?"Previous month":"Next month",_=()=>{n||(e?(c(!0),setTimeout(()=>c(!1),2e3)):a())};return u.jsxs("div",{style:{position:"relative"},children:[u.jsx("button",{onClick:_,onMouseEnter:()=>e&&c(!0),onMouseLeave:()=>c(!1),style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:h?"not-allowed":"pointer",fontSize:"1.25rem",opacity:h?.5:1,transition:"opacity 0.15s, background 0.15s"},title:e?void 0:p,children:f}),l&&e&&u.jsx("div",{style:{position:"absolute",top:"100%",...t==="prev"?{left:0}:{right:0},marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:oe.warning,color:"#000",borderRadius:"6px",fontSize:"0.75rem",fontWeight:500,width:"max-content",maxWidth:"min(300px, 50vw)",textAlign:"center",zIndex:20,boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:i})]})}function zL(){const t=new Date;let e=t.getFullYear(),n=t.getMonth()+1+3;for(;n>12;)n-=12,e+=1;return{year:e,month:n}}function FL(){const t=new Date;let e=t.getFullYear(),n=t.getMonth()+1-3;for(;n<1;)n+=12,e-=1;return{year:e,month:n}}function qL(t){return Object.keys(t).sort()[0]}function HL(t){const e=parseInt(t.slice(0,4),10),n=parseInt(t.slice(4,6),10);return{year:e,month:n}}function GL(t){const e=FL(),n=qL(t);if(!n)return e;const i=xt(e.year,e.month);return n<i?HL(n):e}function $L(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function QL(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}function WL({onPreviousMonth:t,onNextMonth:e}){const{isLoading:n}=qn(),{currentYear:i,currentMonthNumber:a,isAdmin:l,selectedBudgetId:c,currentUserId:h,setCurrentYear:f,setCurrentMonthNumber:p}=Pt(),{budget:_,monthMap:b}=Mn(c,h),{month:v}=ao(c,i,a),E=$L(i,a),C=QL(i,a),w=GL(b),D=zL(),N=xt(w.year,w.month),U=xt(D.year,D.month),k=xt(E.year,E.month),X=xt(C.year,C.month),G=k<N,K=X>U,[O,R]=A.useState(!1),[j,I]=A.useState(!1),[M,H]=A.useState(i),[P,ue]=A.useState(a),F=A.useRef(null);A.useEffect(()=>{if(!O)return;function se(ee){F.current&&!F.current.contains(ee.target)&&(R(!1),I(!1))}return document.addEventListener("mousedown",se),()=>document.removeEventListener("mousedown",se)},[O]);function B(){j||(H(i),ue(a)),I(!j)}function $(){f(M),p(P),I(!1),R(!1)}function Q(){if(!v||!_)return;const se={...v,_meta:{downloaded_at:new Date().toISOString(),budget_id:_.id,budget_name:_.name}},ee=new Blob([JSON.stringify(se,null,2)],{type:"application/json"}),V=URL.createObjectURL(ee),q=document.createElement("a");q.href=V,q.download=`month_${i}_${String(a).padStart(2,"0")}.json`,document.body.appendChild(q),q.click(),document.body.removeChild(q),URL.revokeObjectURL(V),R(!1)}return u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[u.jsx(ZS,{direction:"prev",isDisabled:G,isLoading:n,disabledReason:"Cannot create months more than 3 months into the past",onNavigate:t}),u.jsxs("div",{ref:F,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[u.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[dl[a-1]," ",i]}),u.jsx("button",{onClick:()=>R(!O),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:O?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),n&&u.jsxs(u.Fragment,{children:[u.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[u.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:oe.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),u.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),O&&u.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:100,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[u.jsx(f_,{isDisabled:n,onCloseMenu:()=>R(!1)}),u.jsx("button",{onClick:B,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Jump to a specific month",children:" Go to Month"}),j&&(()=>{const se=w.year,ee=D.year,V=M>se,q=M<ee;return u.jsxs("div",{style:{padding:"0.75rem",borderTop:"1px solid color-mix(in srgb, currentColor 15%, transparent)",marginTop:"0.25rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[u.jsx("button",{onClick:()=>H(Y=>Y-1),disabled:!V,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"4px",padding:"0.25rem 0.5rem",cursor:V?"pointer":"not-allowed",fontSize:"0.8rem",opacity:V?1:.3},title:V?"Previous year":"Cannot go further back",children:""}),u.jsx("span",{style:{flex:1,textAlign:"center",fontSize:"0.9rem",fontWeight:500},children:M}),u.jsx("button",{onClick:()=>H(Y=>Y+1),disabled:!q,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"4px",padding:"0.25rem 0.5rem",cursor:q?"pointer":"not-allowed",fontSize:"0.8rem",opacity:q?1:.3},title:q?"Next year":"Cannot go further ahead",children:""})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.25rem",marginBottom:"0.5rem"},children:dl.map((Y,J)=>{const ne=J+1,re=ne===P,ge=M===i&&ne===a,Ae=xt(M,ne),pe=Ae<N,ie=Ae>U,Ce=pe||ie;let Oe=Y;return pe?Oe="Too far in the past":ie&&(Oe="Too far in the future"),u.jsx("button",{onClick:()=>ue(ne),disabled:Ce,style:{background:re?oe.primary:"color-mix(in srgb, currentColor 8%, transparent)",border:ge?`1px solid ${oe.primary}`:"1px solid transparent",borderRadius:"4px",padding:"0.35rem 0.25rem",cursor:Ce?"not-allowed":"pointer",fontSize:"0.7rem",color:re?"#fff":"inherit",opacity:Ce?.3:1,transition:"background 0.15s"},title:Oe,children:Y.slice(0,3)},ne)})}),(()=>{const Y=xt(M,P),J=Y>=N&&Y<=U;return u.jsxs("button",{onClick:$,disabled:!J,style:{width:"100%",background:J?oe.primary:"color-mix(in srgb, currentColor 20%, transparent)",border:"none",borderRadius:"6px",padding:"0.5rem",cursor:J?"pointer":"not-allowed",fontSize:"0.85rem",color:J?"#fff":"inherit",fontWeight:500,opacity:J?1:.5},children:["Go to ",dl[P-1]," ",M]})})()]})})(),l&&v&&u.jsx("button",{onClick:()=>{Q()},style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),u.jsx(ZS,{direction:"next",isDisabled:K,isLoading:n,disabledReason:"Cannot create months more than 3 months into the future",onNavigate:e})]})}const KL={background:oe.primary,border:"none",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px",color:"white"},YL={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"},XL={background:"transparent",border:`1px solid ${oe.errorBorder}`,color:oe.error,cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"};function ZC({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:c,defaultDate:h,config:f,onSubmit:p,onCancel:_,onDelete:b,extraContent:v}){const{isWide:E}=QP(),{showCategory:C=!1,showCleared:w=!1,accountLabel:D="Account",payeePlaceholder:N="Payee name",descriptionPlaceholder:U="Optional note",submitLabel:k}=f,X=new Date().toISOString().split("T")[0],[G,K]=A.useState(l?.date||h||X),[O,R]=A.useState(l?.payee||""),[j,I]=A.useState(l?.categoryId||""),[M,H]=A.useState(l?.accountId||c||(t[0]?t[0][0]:"")),[P,ue]=A.useState(l?.amount?.toString()||""),[F,B]=A.useState(l?.description||""),[$,Q]=A.useState(l?.cleared||!1),se={},ee=[];t.forEach(([Se,ke])=>{ke.account_group_id?(se[ke.account_group_id]||(se[ke.account_group_id]=[]),se[ke.account_group_id].push([Se,ke])):ee.push([Se,ke])});function V(Se){Se.preventDefault();const ke=parseFloat(P);isNaN(ke)||ke<=0||C&&!j||!M||!G||j===ci&&M===ol||p({date:G,payee:O.trim()||void 0,categoryId:C?j:void 0,accountId:M,amount:ke,description:F.trim()||void 0,cleared:w?$:void 0})}const J=j===ci&&M===ol,ne=u.jsxs(pu,{id:"txn-account",value:M,onChange:Se=>H(Se.target.value),required:!0,style:{fontSize:"0.85rem",padding:"0.5rem"},children:[f.showNoAccountOption&&u.jsx("option",{value:ol,children:du}),Object.entries(e).map(([Se,ke])=>{const Jt=se[Se];return Jt?.length?u.jsx("optgroup",{label:ke.name,children:Jt.map(([Er,bi])=>u.jsx("option",{value:Er,children:bi.nickname},Er))},Se):null}),ee.length>0&&u.jsx("optgroup",{label:"Other",children:ee.map(([Se,ke])=>u.jsx("option",{value:Se,children:ke.nickname},Se))})]}),re=C&&n&&i?u.jsx(Wt,{label:"Category",htmlFor:"txn-category",children:u.jsx(MP,{id:"txn-category",value:j,onChange:I,categories:n,categoryGroups:i,placeholder:"Search...",required:!0,showNoCategoryOption:f.showNoCategoryOption})}):null,ge=w?u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.35rem"},children:[u.jsx("label",{htmlFor:"txn-cleared",style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:"Clr"}),u.jsx(Os,{id:"txn-cleared",checked:$,onChange:Se=>Q(Se.target.checked)})]}):null,Ae=u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.1rem"},children:[u.jsx("span",{style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:""}),u.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[u.jsx("button",{type:"submit",title:J?'Cannot select both "No Category" and "No Account"':k,style:{...KL,opacity:J?.5:1,cursor:J?"not-allowed":"pointer"},disabled:J,children:""}),u.jsx("button",{type:"button",onClick:()=>{_()},title:"Cancel",style:YL,children:""}),b&&u.jsx("button",{type:"button",onClick:()=>{b()},title:"Delete",style:XL,children:""})]})]}),pe=J?u.jsx("div",{style:{background:`color-mix(in srgb, ${oe.error} 15%, transparent)`,border:`1px solid ${oe.errorBorder}`,borderRadius:"6px",padding:"0.5rem 0.75rem",fontSize:"0.85rem",color:oe.error},children:'Cannot select both "No Category" and "No Account"  at least one must be a real category or account.'}):null,ie=u.jsxs(so,{children:[u.jsx(Ie,{type:"submit",actionName:k,disabled:J,children:k}),u.jsx(Ie,{type:"button",variant:"secondary",actionName:"Cancel Transaction Form",onClick:_,children:"Cancel"}),b&&u.jsx(Ie,{type:"button",variant:"danger",actionName:"Delete Transaction",onClick:b,children:" Delete"})]}),Ce=C&&n&&i,Oe={fontSize:"0.85rem",padding:"0.5rem"};if(!E)return u.jsxs(Ka,{actionName:k,onSubmit:V,children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[u.jsx(Wt,{label:"Date",htmlFor:"txn-date",children:u.jsx(GS,{id:"txn-date",value:G,onChange:Se=>K(Se.target.value),required:!0})}),u.jsx(Wt,{label:"Amount",htmlFor:"txn-amount",children:u.jsx(Zg,{id:"txn-amount",value:P,onChange:ue,placeholder:"$0.00",required:!0,autoFocus:!0})})]}),u.jsx(Wt,{label:"Payee",htmlFor:"txn-payee",children:u.jsx(HS,{id:"txn-payee",value:O,onChange:R,payees:a,placeholder:N})}),re,u.jsx(Wt,{label:D,htmlFor:"txn-account",children:ne}),u.jsx(Wt,{label:"Description (optional)",htmlFor:"txn-description",children:u.jsx(Ya,{id:"txn-description",value:F,onChange:Se=>B(Se.target.value),placeholder:U})}),w&&u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx(Os,{id:"txn-cleared-stacked",checked:$,onChange:Se=>Q(Se.target.checked)}),u.jsx("label",{htmlFor:"txn-cleared-stacked",style:{fontSize:"0.9rem",cursor:"pointer"},children:"Cleared (appeared in bank account)"})]}),pe,v]}),ie]});const yt=Ce?w?"6rem minmax(8rem, 1fr) minmax(8rem, 1fr) minmax(8rem, 1fr) 6rem minmax(10rem, 2fr) auto auto":"6rem minmax(8rem, 1fr) minmax(8rem, 1fr) minmax(8rem, 1fr) 6rem minmax(10rem, 2fr) auto":w?"6rem minmax(10rem, 1fr) minmax(10rem, 1fr) 6rem minmax(12rem, 2fr) auto auto":"6rem minmax(10rem, 1fr) minmax(10rem, 1fr) 6rem minmax(12rem, 2fr) auto";return u.jsxs(Ka,{actionName:k,onSubmit:V,children:[u.jsxs("div",{style:{display:"grid",gridTemplateColumns:yt,gap:"1rem",alignItems:"end"},children:[u.jsx(Wt,{label:"Date",htmlFor:"txn-date",children:u.jsx(GS,{id:"txn-date",value:G,onChange:Se=>K(Se.target.value),required:!0,style:Oe})}),u.jsx(Wt,{label:"Payee",htmlFor:"txn-payee",children:u.jsx(HS,{id:"txn-payee",value:O,onChange:R,payees:a,placeholder:N})}),re,u.jsx(Wt,{label:D,htmlFor:"txn-account",children:ne}),u.jsx(Wt,{label:"Amount",htmlFor:"txn-amount",children:u.jsx(Zg,{id:"txn-amount",value:P,onChange:ue,placeholder:"$0.00",required:!0,autoFocus:!0})}),u.jsx(Wt,{label:"Description",htmlFor:"txn-description",children:u.jsx(Ya,{id:"txn-description",value:F,onChange:Se=>B(Se.target.value),placeholder:U,style:Oe})}),ge,Ae]}),pe,v]})}function eE({accounts:t,accountGroups:e,payees:n,initialData:i,defaultAccountId:a,defaultDate:l,onSubmit:c,onCancel:h,onDelete:f,submitLabel:p}){function _(b){c(b.amount,b.accountId,b.date,b.payee,b.description)}return u.jsx(ZC,{accounts:t,accountGroups:e,payees:n,initialData:i?{date:i.date,payee:i.payee,accountId:i.account_id,amount:i.amount,description:i.description}:void 0,defaultAccountId:a,defaultDate:l,config:{showCategory:!1,showCleared:!1,accountLabel:"Deposit To",payeePlaceholder:"e.g., Employer, Client name",descriptionPlaceholder:"e.g., January paycheck",submitLabel:p},onSubmit:_,onCancel:h,onDelete:f})}function JL({income:t,accountName:e,accountGroupName:n,onEdit:i,onDelete:a,isMobile:l,isEvenRow:c}){const h=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",f=n?`${n} / ${e}`:e,p=c?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 6%, transparent)";if(l)return u.jsxs("div",{onClick:i,style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",background:p,cursor:"pointer",transition:"background 0.15s"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:h}),u.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""})]}),u.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",f]})]}),u.jsx("div",{style:{display:"flex",alignItems:"center"},children:u.jsxs("span",{style:{fontWeight:600,color:oe.success,fontFamily:"monospace"},children:["+",Pe(t.amount)]})})]});const _={padding:"0.6rem 0.25rem",background:p,display:"flex",alignItems:"center",fontSize:"0.9rem"};return u.jsxs("div",{style:{display:"contents"},children:[u.jsx("div",{style:{..._,fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:h}),u.jsx("div",{style:{..._,fontWeight:500,overflow:"hidden"},children:u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),u.jsx("div",{style:{..._,opacity:.7,overflow:"hidden"},children:u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.85rem"},children:f})}),u.jsxs("div",{style:{..._,justifyContent:"flex-end",fontWeight:600,color:oe.success,fontFamily:"monospace"},children:["+",Pe(t.amount)]}),u.jsx("div",{style:{..._,paddingLeft:"0.5rem",opacity:.6,overflow:"hidden"},children:u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.8rem"},children:t.description||""})}),u.jsxs("div",{style:{..._,justifyContent:"flex-end",gap:"0.25rem"},children:[u.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:b=>b.currentTarget.style.opacity="1",onMouseLeave:b=>b.currentTarget.style.opacity="0.5",title:"Edit",children:""}),u.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:b=>b.currentTarget.style.opacity="1",onMouseLeave:b=>b.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}const Yo={fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderTop:"1px solid rgba(255,255,255,0.1)"};function ZL(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,setCurrentYear:a,setCurrentMonthNumber:l}=Pt(),{accounts:c,accountGroups:h}=Mn(t,e),{month:f,isLoading:p,addIncome:_,updateIncome:b,deleteIncome:v}=ao(t,n,i),E=aa(),[C,w]=A.useState(null),[D,N]=A.useState(!1),[U,k]=A.useState(null),K=$1(t,{enabled:D||U!==null}).data||[];function O(Q){const se=Q.account_group_id?h[Q.account_group_id]:void 0;return se?.is_active!==void 0?se.is_active:Q.is_active!==!1}function R(Q){const se=Q.account_group_id?h[Q.account_group_id]:void 0;return se?.on_budget!==void 0?se.on_budget:Q.on_budget!==!1}const j=Object.entries(c).filter(([,Q])=>O(Q)&&R(Q)),I=j.filter(([,Q])=>Q.is_income_account),M=I.length>0?I:j,H=j.find(([,Q])=>Q.is_income_default),P=H?H[0]:void 0,ue=f?.income.reduce((Q,se)=>Q+se.amount,0)||0;function F(Q,se,ee,V,q){w(null),N(!1);const[Y,J]=ee.split("-").map(Number);_(Q,se,ee,V,q).then(()=>{(Y!==n||J!==i)&&(a(Y),l(J))}).catch(ne=>{w(ne instanceof Error?ne.message:"Failed to add income")})}function B(Q,se,ee,V,q,Y){w(null),k(null),b(Q,se,ee,V,q,Y).catch(J=>{w(J instanceof Error?J.message:"Failed to update income")})}function $(Q){confirm("Are you sure you want to delete this income entry?")&&(w(null),v(Q).catch(se=>{w(se instanceof Error?se.message:"Failed to delete income")}))}return u.jsxs("div",{style:{opacity:p?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:p?"none":"auto"},children:[C&&u.jsx("div",{style:{background:`color-mix(in srgb, ${oe.error} 15%, transparent)`,border:`1px solid ${oe.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:oe.error},children:C}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:E?"1fr":"5rem 1.5fr 2fr 7rem 1.5fr 3rem"},children:[u.jsxs("div",{style:{gridColumn:"1 / -1",position:"sticky",top:0,zIndex:49,backgroundColor:"#242424",borderBottom:"1px solid rgba(255,255,255,0.15)",display:"grid",gridTemplateColumns:"subgrid"},children:[u.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem",paddingTop:"0.5rem",paddingBottom:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[u.jsx("span",{style:{fontWeight:600},children:"Income:"}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"Total: "}),u.jsx("span",{style:{color:St(ue),fontWeight:600},children:Pe(ue)})]})]}),u.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:!D&&u.jsx(Ie,{actionName:"Open Add Income Form",onClick:()=>N(!0),disabled:M.length===0,style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:"+ Add Income"})})]}),!E&&u.jsxs(u.Fragment,{children:[u.jsx("div",{style:Yo,children:"Date"}),u.jsx("div",{style:Yo,children:"Payee"}),u.jsx("div",{style:Yo,children:"Account"}),u.jsx("div",{style:{...Yo,textAlign:"right"},children:"Amount"}),u.jsx("div",{style:Yo,children:"Description"}),u.jsx("div",{style:Yo})]})]}),u.jsx("div",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",opacity:.55,fontStyle:"italic",padding:"0.5rem 0"},children:" All income entries on this page count towards the tithing owed calculation."}),M.length===0&&u.jsxs("p",{style:{gridColumn:"1 / -1",opacity:.6,fontSize:"0.9rem",padding:"1rem 0"},children:[Object.keys(c).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",u.jsx(Tt,{to:"/budget/accounts",style:{color:oe.primaryLight},children:"Manage accounts "})]}),D&&u.jsx("div",{style:{gridColumn:"1 / -1",marginBottom:"1rem"},children:u.jsx(eE,{accounts:M,accountGroups:h,payees:K,defaultAccountId:P,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:F,onCancel:()=>N(!1),submitLabel:"Add Income",isMobile:E})}),f?.income.slice().sort((Q,se)=>(Q.date||"").localeCompare(se.date||"")).map((Q,se)=>U===Q.id?u.jsx("div",{style:{gridColumn:"1 / -1",padding:"0.5rem"},children:u.jsx(eE,{accounts:M,accountGroups:h,payees:K,initialData:Q,onSubmit:(ee,V,q,Y,J)=>B(Q.id,ee,V,q,Y,J),onCancel:()=>k(null),onDelete:()=>$(Q.id),submitLabel:"Save",isMobile:E})},Q.id):u.jsx(JL,{income:Q,accountName:er(Q.account_id)?du:c[Q.account_id]?.nickname||"Unknown Account",accountGroupName:er(Q.account_id)?void 0:c[Q.account_id]?.account_group_id?h[c[Q.account_id].account_group_id]?.name:void 0,onEdit:()=>{Q.payee||`${Q.amount}`,k(Q.id)},onDelete:()=>$(Q.id),isMobile:E,isEvenRow:se%2===0},Q.id)),(!f?.income||f.income.length===0)&&!D&&u.jsx("p",{style:{gridColumn:"1 / -1",opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No income recorded for this month"}),u.jsx("div",{style:{gridColumn:"1 / -1",height:"2rem"}})]})]})}function tE({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:c,defaultDate:h,onSubmit:f,onCancel:p,onDelete:_,submitLabel:b}){function v(E){f(E.amount,E.categoryId,E.accountId,E.date,E.payee,E.description,E.cleared)}return u.jsx(ZC,{accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l?{date:l.date,payee:l.payee,categoryId:l.category_id,accountId:l.account_id,amount:l.amount,description:l.description,cleared:l.cleared}:void 0,defaultAccountId:c,defaultDate:h,config:{showCategory:!0,showCleared:!0,showNoCategoryOption:!0,showNoAccountOption:!0,accountLabel:"Pay From",payeePlaceholder:"e.g., Grocery Store",descriptionPlaceholder:"e.g., Weekly groceries",submitLabel:b},onSubmit:v,onCancel:p,onDelete:_})}function e6({expense:t,categoryName:e,accountName:n,accountGroupName:i,onEdit:a,onDelete:l,isMobile:c,isEvenRow:h}){const f=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",p=i?`${i} / ${n}`:n,_=h?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 6%, transparent)";if(c)return u.jsxs("div",{onClick:a,style:{gridColumn:"1 / -1",display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",background:_,cursor:"pointer",transition:"background 0.15s"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:f}),u.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""}),t.cleared&&u.jsx("span",{style:{fontSize:"0.7rem",color:oe.success},title:"Cleared",children:""})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[u.jsx("span",{style:{fontSize:"0.7rem",background:`color-mix(in srgb, ${oe.primary} 20%, transparent)`,color:oe.primaryLight,padding:"0.1rem 0.4rem",borderRadius:"3px"},children:e}),u.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",p]})]})]}),u.jsx("div",{style:{display:"flex",alignItems:"center"},children:u.jsx("span",{style:{fontWeight:600,color:St(t.amount),fontFamily:"monospace"},children:nr(t.amount)})})]});const b={padding:"0.6rem 0.25rem",background:_,display:"flex",alignItems:"center",fontSize:"0.9rem"};return u.jsxs("div",{style:{display:"contents"},children:[u.jsx("div",{style:{...b,fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:f}),u.jsx("div",{style:{...b,fontWeight:500,overflow:"hidden"},children:u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),u.jsx("div",{style:{...b,justifyContent:"center"},children:u.jsx("span",{style:{fontSize:"0.8rem",background:`color-mix(in srgb, ${oe.primary} 15%, transparent)`,color:oe.primaryLight,padding:"0.2rem 0.5rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e})}),u.jsx("div",{style:{...b,opacity:.7,overflow:"hidden"},children:u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.85rem"},children:p})}),u.jsx("div",{style:{...b,justifyContent:"flex-end",fontWeight:600,color:St(t.amount),fontFamily:"monospace"},children:nr(t.amount)}),u.jsx("div",{style:{...b,paddingLeft:"0.5rem",opacity:.6,overflow:"hidden"},children:u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.8rem"},children:t.description||""})}),u.jsx("div",{style:{...b,justifyContent:"center",color:t.cleared?oe.success:"inherit",opacity:t.cleared?1:.3,fontSize:"1rem"},children:t.cleared?"":""}),u.jsxs("div",{style:{...b,justifyContent:"flex-end",gap:"0.25rem"},children:[u.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:v=>v.currentTarget.style.opacity="1",onMouseLeave:v=>v.currentTarget.style.opacity="0.5",title:"Edit",children:""}),u.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:v=>v.currentTarget.style.opacity="1",onMouseLeave:v=>v.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}const Ms={fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderTop:"1px solid rgba(255,255,255,0.1)"};function t6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,setCurrentYear:a,setCurrentMonthNumber:l}=Pt(),{accounts:c,accountGroups:h,categories:f,categoryGroups:p}=Mn(t,e),{month:_,isLoading:b,addExpense:v,updateExpense:E,deleteExpense:C}=ao(t,n,i),w=aa(),[D,N]=A.useState(null),[U,k]=A.useState(!1),[X,G]=A.useState(null),R=$1(t,{enabled:U||X!==null}).data||[];function j(ee){const V=ee.account_group_id?h[ee.account_group_id]:void 0;return V?.is_active!==void 0?V.is_active:ee.is_active!==!1}function I(ee){const V=ee.account_group_id?h[ee.account_group_id]:void 0;return V?.on_budget!==void 0?V.on_budget:ee.on_budget!==!1}const M=Object.entries(c).filter(([,ee])=>j(ee)&&I(ee)),H=M.filter(([,ee])=>ee.is_outgo_account),P=H.length>0?H:M,ue=M.find(([,ee])=>ee.is_outgo_default),F=ue?ue[0]:void 0,B=_?.expenses?.reduce((ee,V)=>ee+V.amount,0)||0;function $(ee,V,q,Y,J,ne,re){N(null),k(!1);const[ge,Ae]=Y.split("-").map(Number);v(ee,V,q,Y,J,ne,re).then(()=>{(ge!==n||Ae!==i)&&(a(ge),l(Ae))}).catch(pe=>{N(pe instanceof Error?pe.message:"Failed to add expense")})}function Q(ee,V,q,Y,J,ne,re,ge){N(null),G(null),E(ee,V,q,Y,J,ne,re,ge).catch(Ae=>{N(Ae instanceof Error?Ae.message:"Failed to update expense")})}function se(ee){confirm("Are you sure you want to delete this expense?")&&(N(null),C(ee).catch(V=>{N(V instanceof Error?V.message:"Failed to delete expense")}))}return u.jsxs("div",{style:{opacity:b?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:b?"none":"auto"},children:[D&&u.jsx("div",{style:{background:`color-mix(in srgb, ${oe.error} 15%, transparent)`,border:`1px solid ${oe.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:oe.error},children:D}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:w?"1fr":"5rem 1.5fr 7rem 1fr 6rem 1fr 3rem 4rem"},children:[u.jsxs("div",{style:{gridColumn:"1 / -1",position:"sticky",top:0,zIndex:49,backgroundColor:"#242424",borderBottom:"1px solid rgba(255,255,255,0.15)",display:"grid",gridTemplateColumns:"subgrid"},children:[u.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem",paddingTop:"0.5rem",paddingBottom:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[u.jsx("span",{style:{fontWeight:600},children:"Expenses:"}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"Total: "}),u.jsx("span",{style:{color:St(B),fontWeight:600},children:nr(B)})]})]}),u.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:!U&&u.jsx(Ie,{actionName:"Open Add Expense Form",onClick:()=>k(!0),disabled:P.length===0||Object.keys(f).length===0,style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:"+ Add Expense"})})]}),!w&&u.jsxs(u.Fragment,{children:[u.jsx("div",{style:Ms,children:"Date"}),u.jsx("div",{style:Ms,children:"Payee"}),u.jsx("div",{style:{...Ms,textAlign:"center"},children:"Category"}),u.jsx("div",{style:Ms,children:"Account"}),u.jsx("div",{style:{...Ms,textAlign:"right"},children:"Amount"}),u.jsx("div",{style:Ms,children:"Description"}),u.jsx("div",{style:{...Ms,textAlign:"center"},children:"Clr"}),u.jsx("div",{style:Ms})]})]}),P.length===0&&u.jsxs("p",{style:{gridColumn:"1 / -1",opacity:.6,fontSize:"0.9rem",padding:"1rem 0"},children:[Object.keys(c).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",u.jsx(Tt,{to:"/budget/accounts",style:{color:oe.primaryLight},children:"Manage accounts "})]}),Object.keys(f).length===0&&u.jsxs("p",{style:{gridColumn:"1 / -1",opacity:.6,fontSize:"0.9rem",padding:"1rem 0"},children:["You need to create at least one category before adding expenses."," ",u.jsx(Tt,{to:"/budget/settings/categories",style:{color:oe.primaryLight},children:"Create categories "})]}),U&&u.jsx("div",{style:{gridColumn:"1 / -1",marginBottom:"1rem"},children:u.jsx(tE,{accounts:P,accountGroups:h,categories:f,categoryGroups:p,payees:R,defaultAccountId:F,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:$,onCancel:()=>k(!1),submitLabel:"Add Expense",isMobile:w})}),_?.expenses?.slice().sort((ee,V)=>(ee.date||"").localeCompare(V.date||"")).map((ee,V)=>X===ee.id?u.jsx("div",{style:{gridColumn:"1 / -1",padding:"0.5rem"},children:u.jsx(tE,{accounts:P,accountGroups:h,categories:f,categoryGroups:p,payees:R,initialData:ee,onSubmit:(q,Y,J,ne,re,ge,Ae)=>Q(ee.id,q,Y,J,ne,re,ge,Ae),onCancel:()=>G(null),onDelete:()=>se(ee.id),submitLabel:"Save",isMobile:w})},ee.id):u.jsx(e6,{expense:ee,categoryName:Ui(ee.category_id)?Va:f[ee.category_id]?.name||"Unknown Category",accountName:er(ee.account_id)?du:c[ee.account_id]?.nickname||"Unknown Account",accountGroupName:er(ee.account_id)?void 0:c[ee.account_id]?.account_group_id?h[c[ee.account_id].account_group_id]?.name:void 0,onEdit:()=>{ee.payee||`${ee.amount}`,G(ee.id)},onDelete:()=>se(ee.id),isMobile:w,isEvenRow:V%2===0},ee.id)),(!_?.expenses||_.expenses.length===0)&&!U&&u.jsx("p",{style:{gridColumn:"1 / -1",opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No expenses recorded for this month"}),u.jsx("div",{style:{gridColumn:"1 / -1",height:"2rem"}})]})]})}function n6({isOpen:t,onClose:e,onDeleted:n}){const{addLoadingHold:i,removeLoadingHold:a}=qn(),{selectedBudgetId:l,currentYear:c,currentMonthNumber:h}=Pt(),{deleteAllocations:f}=K1(),[p,_]=A.useState(null),b=async()=>{if(l){_(null),i("allocations-delete","Deleting allocations...");try{await f({budgetId:l,year:c,month:h}),e(),n?.()}catch(v){_(v instanceof Error?v.message:"Failed to delete allocations")}finally{a("allocations-delete")}}};return u.jsxs(ea,{isOpen:t,onClose:e,title:"Delete Allocations",children:[p&&u.jsx(io,{message:p,onDismiss:()=>_(null)}),u.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to delete all allocations for this month? This will remove all allocated amounts and reset the month to unfinalized."}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[u.jsx(Ie,{actionName:"Cancel Delete Allocations",variant:"secondary",onClick:e,children:"Cancel"}),u.jsx(Ie,{actionName:"Confirm Delete Allocations",variant:"danger",onClick:b,children:"Delete Allocations"})]})]})}function eT({isDraftMode:t,isEditingAppliedAllocations:e,availableNow:n,currentMonthIncome:i,balanceTotals:a,draftChangeAmount:l,availableAfterApply:c,currentDraftTotal:h}){const f=t&&h!==void 0?h:a.allocated;return u.jsxs(u.Fragment,{children:[u.jsx("span",{style:{fontWeight:600,color:t||e?oe.primary:"inherit",marginRight:"0.25rem"},children:t||e?"Allocations Worksheet:":"Month Summary:"}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:t?"Avail: ":"Inc: "}),t?u.jsx("span",{style:{color:St(n),fontWeight:600},children:Pe(n)}):u.jsxs("span",{style:{color:oe.success,fontWeight:600},children:["+",Pe(i)]})]}),u.jsxs("span",{children:[t&&u.jsx("span",{style:{opacity:.6},children:" "}),u.jsx("span",{style:{opacity:.6},children:t?"Draft: ":"Alloc: "}),u.jsxs("span",{style:{color:t?oe.primary:oe.success,fontWeight:600},children:[t?"":"+",Pe(t?f:a.allocated)]}),e&&l!==0&&u.jsxs("span",{style:{fontSize:"0.85em",color:l>0?oe.warning:oe.success,marginLeft:"0.25rem"},children:["(",nr(l),")"]})]}),!t&&u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"Spent: "}),u.jsx("span",{style:{color:Ul(a.spent),fontWeight:600},children:_i(a.spent)})]}),u.jsxs("span",{children:[t&&u.jsx("span",{style:{opacity:.6},children:"= "}),u.jsx("span",{style:{opacity:.6},children:t?"Remaining: ":"Net: "}),t?u.jsx("span",{style:{color:St(c),fontWeight:600},children:Pe(c)}):u.jsx("span",{style:{color:St(a.allocated+a.spent),fontWeight:600},children:Pe(a.allocated+a.spent)})]})]})}function r6({totals:t}){return u.jsxs(u.Fragment,{children:[u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"Start: "}),u.jsx("span",{style:{color:St(t.start),fontWeight:600},children:Pe(t.start)})]}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"Inc: "}),u.jsxs("span",{style:{color:oe.success,fontWeight:600},children:["+",Pe(t.income)]})]}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"Exp: "}),u.jsx("span",{style:{color:Ul(t.expenses),fontWeight:600},children:_i(t.expenses)})]}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"End: "}),u.jsx("span",{style:{color:St(t.end),fontWeight:600},children:Pe(t.end)})]})]})}function m_({isDraftMode:t,isEditingAppliedAllocations:e,allocationsFinalized:n,onSave:i,onApply:a,onEdit:l,onCancel:c,onDelete:h}){return u.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:[t&&!e&&u.jsxs(u.Fragment,{children:[u.jsx(Ie,{actionName:"Save Draft Allocations",onClick:i,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Save"}),u.jsx(Ie,{actionName:"Apply Allocations",onClick:a,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Apply"})]}),!t&&n&&u.jsx(Ie,{actionName:"Edit Allocations",onClick:l,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Edit Allocations"}),e&&u.jsxs(u.Fragment,{children:[u.jsx(Ie,{actionName:"Apply Allocations",onClick:a,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:" Apply"}),u.jsx(Ie,{actionName:"Cancel Edit Allocations",onClick:c,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em"},children:""}),u.jsx(Ie,{actionName:"Open Delete Allocations Modal",onClick:h,variant:"secondary",style:{fontSize:"0.8rem",padding:"0.4em 0.8em",color:oe.error},children:""})]})]})}function i6({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l,projectedAllTime:c}){const h=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,f=h?t.default_monthly_amount/100*i:0,p=h?f.toFixed(2):n,_=a&&!h,b=a?c:t.balance??0,v=t.balance??0,E=v<0,C=E?Math.abs(v):0,w=h?f:parseFloat(n)||0,D=E?Math.min(w,C):0,N=E?Math.max(0,w-C):0,U=E&&w>0&&N>0;return u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[u.jsx("div",{style:{marginBottom:"0.5rem"},children:u.jsx("span",{style:{fontWeight:500},children:t.name})}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[u.jsxs("div",{children:[u.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),u.jsx("span",{style:{color:In(e.start_balance)},children:jn(e.start_balance)})]}),u.jsxs("div",{children:[u.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),_?u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"text",inputMode:"decimal",value:p?`$${p}`:"",onChange:k=>{const X=k.target.value.replace(/[^\d.]/g,"");l(X)},placeholder:"$0",style:{width:"100%",maxWidth:"80px",padding:"0.25rem 0.35rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 8%, transparent)",fontSize:"0.8rem",color:"inherit",boxSizing:"border-box"}}),E&&w>0&&u.jsxs("div",{style:{fontSize:"0.65rem",marginTop:"0.15rem",lineHeight:1.3},children:[u.jsxs("span",{style:{color:oe.debt,display:"block"},children:[Pe(D),"  debt"]}),U&&u.jsxs("span",{style:{color:oe.success,display:"block"},children:[Pe(N),"  balance"]})]})]}):u.jsx("span",{style:{color:Bf(e.allocated)},children:nr(e.allocated)})]}),u.jsxs("div",{children:[u.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),u.jsx("span",{style:{color:Ul(e.spent)},children:_i(e.spent)})]}),u.jsxs("div",{children:[u.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),u.jsx("span",{style:{color:In(e.end_balance)},children:jn(e.end_balance)})]}),u.jsxs("div",{children:[u.jsx("span",{style:{opacity:.6,display:"block"},children:a?"Proj. All-Time":"All-Time"}),u.jsx("span",{style:{color:a?b<0?oe.debt:oe.primary:In(b)},children:jn(b)})]})]}),a&&h&&u.jsx("div",{style:{marginTop:"0.5rem"},children:u.jsxs("span",{style:{fontSize:"0.8rem"},children:[u.jsxs("span",{style:{opacity:.6},children:[Pe(i),"  "]}),u.jsxs("span",{style:{color:oe.primary},children:[t.default_monthly_amount,"%"]}),u.jsx("span",{style:{opacity:.6},children:" = "}),u.jsx("span",{style:{color:oe.primary},children:Pe(f)})]})})]})}function nE({name:t,categories:e,groupTotals:n,getCategoryBalance:i,localAllocations:a,savedAllocations:l,previousMonthIncome:c,isDraftMode:h,onAllocationChange:f,isMobile:p,isUngrouped:_,getAllocationAmount:b}){const v={paddingTop:"0.6rem",paddingBottom:"0.6rem",paddingLeft:"0.5rem",paddingRight:"0.5rem",marginTop:"1.25rem",borderTop:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.04)",display:"flex",alignItems:"center",fontSize:"0.9rem",fontWeight:600},E=n.allocated+n.spent,C=e.reduce((w,[D,N])=>{const U=N.balance??0;if(h){const k=b(D,N),X=l[D]??0,G=k-X;return w+U+G}return w+U},0);return u.jsxs("div",{style:{display:"contents"},children:[!p&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{...v,paddingLeft:"0.5rem",opacity:_?.7:1},children:[u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:t}),u.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400},children:["(",e.length,")"]})]}),u.jsx("div",{style:{...v,justifyContent:"flex-end",color:In(n.start)},children:u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:jn(n.start)})}),u.jsx("div",{style:{...v,justifyContent:h?"center":"flex-end",color:Bf(n.allocated)},children:u.jsxs("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:["+",Pe(n.allocated)]})}),u.jsx("div",{style:{...v,justifyContent:"flex-end",color:Ul(n.spent)},children:u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:_i(n.spent)})}),u.jsx("div",{style:{...v,justifyContent:"flex-end",color:In(E)},children:u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:nr(E)})}),u.jsx("div",{style:{...v,justifyContent:"flex-end",color:In(n.end),paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:jn(n.end)})}),u.jsx("div",{style:{...v,justifyContent:"flex-end",color:C<0?oe.debt:oe.primary},children:u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:jn(C)})})]}),!h&&p&&u.jsxs("div",{style:{gridColumn:"1 / -1",paddingTop:"0.6rem",paddingBottom:"0.6rem",paddingLeft:"0.5rem",paddingRight:"0.5rem",marginTop:"1.25rem",borderTop:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.04)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsxs("span",{style:{fontWeight:600,opacity:_?.7:1},children:[u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:t}),u.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400},children:["(",e.length,")"]})]}),u.jsx("span",{style:{fontWeight:600,color:In(n.end),borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:jn(n.end)})]}),e.map(([w,D],N)=>{const U=i(w);if(!U)return null;const k=D.balance??0;let X=k;if(h){const G=b(w,D),K=l[w]??0,O=G-K;X=k+O}return p?u.jsx("div",{style:{gridColumn:"1 / -1"},children:u.jsx(i6,{category:D,balance:U,localAllocation:a[w]||"",previousMonthIncome:c,isDraftMode:h,onAllocationChange:G=>f(w,G),projectedAllTime:X})},w):u.jsx(s6,{category:D,balance:U,localAllocation:a[w]||"",previousMonthIncome:c,isDraftMode:h,onAllocationChange:G=>f(w,G),allTimeBalance:X,isEvenRow:N%2===0},w)})]})}function s6({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l,allTimeBalance:c,isEvenRow:h}){const f=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,p=f?t.default_monthly_amount/100*i:0,_=f?p.toFixed(2):n,b=t.balance??0,v=b<0,E=v?Math.abs(b):0,C=f?p:parseFloat(n)||0,w=v?Math.min(C,E):0,D=v?Math.max(0,C-E):0,N=v&&C>0&&D>0,U=h?"rgba(255,255,255,0.02)":"transparent",k={paddingTop:"0.6rem",paddingBottom:"0.6rem",paddingLeft:"0.5rem",paddingRight:"0.5rem",background:U,display:"flex",alignItems:"center",fontSize:"0.9rem",minHeight:"2.4rem",boxSizing:"border-box"},X=e.allocated+e.spent;return u.jsxs("div",{style:{display:"contents"},children:[u.jsx("div",{style:{paddingTop:"0.6rem",paddingBottom:"0.6rem",paddingRight:"0.5rem",paddingLeft:"1.5rem",background:U,display:"flex",alignItems:"center",fontSize:"0.9rem",fontWeight:500,overflow:"hidden",borderLeft:"2px solid rgba(255,255,255,0.1)",minHeight:"2.4rem",boxSizing:"border-box"},children:u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name})}),u.jsx("div",{style:{...k,justifyContent:"flex-end",color:In(e.start_balance)},children:jn(e.start_balance)}),a?u.jsx("div",{style:{...k,justifyContent:"center",flexDirection:"column",gap:"0.1rem",paddingTop:"0.35rem",paddingBottom:"0.35rem"},children:f?u.jsxs("span",{style:{fontSize:"0.85rem"},children:[u.jsxs("span",{style:{color:oe.primary},children:[t.default_monthly_amount,"%"]}),u.jsx("span",{style:{opacity:.5},children:" = "}),u.jsx("span",{style:{color:oe.primary},children:Pe(p)})]}):u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"text",inputMode:"decimal",value:_?`$${_}`:"",onChange:G=>{const K=G.target.value.replace(/[^\d.]/g,"");l(K)},placeholder:"$0.00",style:{width:"100px",padding:"0.2rem 0.5rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",lineHeight:1,color:"inherit",boxSizing:"border-box"}}),v&&C>0&&u.jsxs("div",{style:{fontSize:"0.6rem",whiteSpace:"nowrap",textAlign:"center",lineHeight:1.3,display:"flex",flexDirection:"column",alignItems:"center"},children:[u.jsxs("span",{style:{color:oe.debt},children:[Pe(w),"  debt"]}),N&&u.jsxs("span",{style:{color:oe.success},children:[Pe(D),"  bal"]})]})]})}):(()=>{const G=e.start_balance<0,K=G?Math.abs(e.start_balance):0,O=G?Math.min(e.allocated,K):0,R=G?Math.max(0,e.allocated-K):0,j=G&&e.allocated>0;return u.jsxs("div",{style:{...k,justifyContent:"flex-end",flexDirection:"column",alignItems:"flex-end",gap:"0.1rem",color:Bf(e.allocated)},children:[u.jsxs("span",{children:["+",Pe(e.allocated)]}),j&&u.jsxs("div",{style:{fontSize:"0.6rem",whiteSpace:"nowrap",textAlign:"right",lineHeight:1.3,display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[u.jsxs("span",{style:{color:oe.debt},children:[Pe(O),"  debt"]}),R>0&&u.jsxs("span",{style:{color:oe.success},children:[Pe(R),"  bal"]})]})]})})(),u.jsx("div",{style:{...k,justifyContent:"flex-end",color:Ul(e.spent)},children:_i(e.spent)}),u.jsx("div",{style:{...k,justifyContent:"flex-end",color:In(X)},children:nr(X)}),u.jsx("div",{style:{...k,justifyContent:"flex-end",fontWeight:600,color:In(e.end_balance),paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:jn(e.end_balance)}),u.jsx("div",{style:{...k,justifyContent:"flex-end",color:c<0?oe.debt:oe.primary},children:jn(c)})]})}function ku({message:t="Loading...",spinnerColor:e=oe.primary,children:n,spinnerSize:i=4}){return u.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(15, 15, 20, 0.95)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999,gap:"1.5rem",backdropFilter:"blur(4px)"},children:[u.jsx("div",{style:{width:`${i}rem`,height:`${i}rem`,border:"3px solid rgba(255, 255, 255, 0.15)",borderTopColor:e,borderRadius:"50%",animation:"loadingOverlaySpin 0.8s linear infinite"}}),u.jsx("p",{style:{color:"rgba(255, 255, 255, 0.95)",fontSize:"1.2rem",fontWeight:600,letterSpacing:"0.02em",margin:0},children:t}),n,u.jsx("style",{children:`
        @keyframes loadingOverlaySpin {
          to { transform: rotate(360deg); }
        }
      `})]})}function Vf({percent:t,gradient:e="linear-gradient(90deg, #646cff, #8b5cf6)",width:n=300}){return u.jsx("div",{style:{width:`${n}px`,height:"8px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"4px",overflow:"hidden"},children:u.jsx("div",{style:{width:`${t}%`,height:"100%",background:e,borderRadius:"4px",transition:"width 0.3s ease-out"}})})}function un({value:t,label:e,color:n="#646cff"}){return u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("p",{style:{color:n,fontSize:"1.5rem",fontWeight:700,margin:0},children:t}),u.jsx("p",{style:{color:"rgba(255, 255, 255, 0.6)",fontSize:"0.8rem",margin:"0.25rem 0 0",textTransform:"uppercase",letterSpacing:"0.05em"},children:e})]})}function hl({children:t,columns:e=3}){return u.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${e}, 1fr)`,gap:"2rem",textAlign:"center"},children:t})}function Uf({percent:t}){return u.jsxs("p",{style:{color:"rgba(255, 255, 255, 0.5)",fontSize:"0.9rem",margin:0},children:[t,"% complete"]})}function a6(t){const e=Object.entries(t).reduce((n,[i,a])=>{const l=a.category_group_id||"ungrouped";return n[l]||(n[l]=[]),n[l].push([i,a]),n},{});return Object.keys(e).forEach(n=>{e[n].sort((i,a)=>i[1].sort_order-a[1].sort_order)}),e}function o6(t,e,n,i,a){const l={};t?.category_balances&&t.category_balances.forEach(h=>{l[h.category_id]=h});const c={};return Object.entries(e).forEach(([h,f])=>{const p=l[h],_=p?.start_balance??0,b=p?.spent??0;let v=0;n?v=a(h,f):i&&p&&(v=p.allocated),c[h]={category_id:h,start_balance:_,allocated:v,spent:b,end_balance:_+v+b}}),c}function l6(t,e){const n={};t?.account_balances&&t.account_balances.forEach(a=>{n[a.account_id]=a});const i={};return Object.entries(e).forEach(([a,l])=>{const h=n[a]?.start_balance??l.balance;let f=0;t?.income&&(f=t.income.filter(b=>b.account_id===a).reduce((b,v)=>b+v.amount,0));let p=0;t?.expenses&&(p=t.expenses.filter(b=>b.account_id===a).reduce((b,v)=>b+v.amount,0));const _=f+p;i[a]={account_id:a,start_balance:h,income:f,expenses:p,net_change:_,end_balance:h+_}}),i}function c6(t){return Object.values(t).reduce((e,n)=>({start:e.start+n.start_balance,income:e.income+n.income,expenses:e.expenses+n.expenses,netChange:e.netChange+n.net_change,end:e.end+n.end_balance}),{start:0,income:0,expenses:0,netChange:0,end:0})}function u6(t){return Object.values(t).reduce((e,n)=>({start:e.start+n.start_balance,allocated:e.allocated+n.allocated,spent:e.spent+n.spent,end:e.end+n.end_balance}),{start:0,allocated:0,spent:0,end:0})}function d6({isDraftMode:t,allocationsFinalized:e,balanceTotals:n,grandAllTime:i,onSave:a,onApply:l,onEdit:c,onCancel:h,onDelete:f}){const p={paddingTop:"0.6rem",paddingBottom:"0.6rem",paddingLeft:"0.5rem",paddingRight:"0.5rem",borderTop:"2px solid rgba(255,255,255,0.3)",borderBottom:"2px solid rgba(255,255,255,0.3)",fontWeight:600,display:"flex",alignItems:"center",fontSize:"0.9rem"},_=n.allocated+n.spent;return u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{...p,gap:"0.75rem"},children:["Grand Totals",!t&&u.jsx(m_,{isDraftMode:!1,isEditingAppliedAllocations:!1,allocationsFinalized:e,onSave:a,onApply:l,onEdit:c,onCancel:h,onDelete:f})]}),u.jsx("div",{style:{...p,justifyContent:"flex-end",color:In(n.start)},children:jn(n.start)}),u.jsxs("div",{style:{...p,justifyContent:t?"center":"flex-end",color:Bf(n.allocated)},children:["+",Pe(n.allocated)]}),u.jsx("div",{style:{...p,justifyContent:"flex-end",color:Ul(n.spent)},children:_i(n.spent)}),u.jsx("div",{style:{...p,justifyContent:"flex-end",color:In(_)},children:nr(_)}),u.jsx("div",{style:{...p,justifyContent:"flex-end",color:In(n.end),paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:jn(n.end)}),u.jsx("div",{style:{...p,justifyContent:"flex-end",color:i<0?oe.debt:oe.primary},children:jn(i)})]})}function h6({allocationsFinalized:t,availableNow:e,currentMonthIncome:n,balanceTotals:i,draftChangeAmount:a,availableAfterApply:l,currentDraftTotal:c,onSave:h,onApply:f,onEdit:p,onCancel:_,onDelete:b}){return u.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderTop:"2px solid rgba(255,255,255,0.3)",borderBottom:"2px solid rgba(255,255,255,0.3)"},children:[u.jsx("span",{style:{fontWeight:600},children:"Grand Totals:"}),u.jsx(eT,{isDraftMode:!1,isEditingAppliedAllocations:!1,availableNow:e,currentMonthIncome:n,balanceTotals:i,draftChangeAmount:a,availableAfterApply:l,currentDraftTotal:c}),u.jsx(m_,{isDraftMode:!1,isEditingAppliedAllocations:!1,allocationsFinalized:t,onSave:h,onApply:f,onEdit:p,onCancel:_,onDelete:b})]})}const Pa={fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"2px solid rgba(255,255,255,0.2)"};function f6(t){if(!t)return"";switch(t.phase){case"reading-budget":return"Reading budget data...";case"fetching-months":return"Fetching months...";case"recalculating":return t.currentMonth?`Recalculating ${t.currentMonth}...`:"Recalculating...";case"saving":return"Saving results...";case"complete":return"Recalculation complete!";default:return"Recalculating balances..."}}function m6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Pt(),{categories:a,categoryGroups:l,monthMap:c}=Mn(t,e),{month:h}=ao(t,n,i),f=aa(),p=xt(n,i),_=c[p]?.needs_recalculation===!0,b=A.useRef(!1),[v,E]=A.useState(null);A.useEffect(()=>{!t||!h||!_||b.current||(b.current=!0,`${n}${String(i).padStart(2,"0")}`,jf(t,{onProgress:re=>E(re)}).then(()=>{$e.invalidateQueries({queryKey:xe.month(t,n,i)})}).catch(re=>{console.error("[MonthCategories] Recalculation failed:",re)}).finally(()=>{b.current=!1,E(null)}))},[t,_,h,n,i]);const[C,w]=A.useState(!1),{localAllocations:D,isEditingAppliedAllocations:N,error:U,availableNow:k,currentDraftTotal:X,draftChangeAmount:G,availableAfterApply:K,previousMonthIncome:O,currentMonthIncome:R,allocationsFinalized:j,getAllocationAmount:I,handleAllocationChange:M,resetAllocationsToSaved:H,handleSaveAllocations:P,handleFinalizeAllocations:ue,setIsEditingAppliedAllocations:F,setError:B}=oL(),$=[...l].sort((re,ge)=>re.sort_order-ge.sort_order),Q=A.useMemo(()=>a6(a),[a]),se=!j||N,ee=A.useMemo(()=>o6(h,a,se,j,I),[h,a,se,j,I]),V=re=>ee[re],q=A.useMemo(()=>u6(ee),[ee]),Y=A.useMemo(()=>{const re={};if(h?.category_balances)for(const ge of h.category_balances)re[ge.category_id]=ge.allocated;return re},[h]),J=A.useMemo(()=>Object.entries(a).reduce((re,[ge,Ae])=>{const pe=Ae.balance??0;if(se){const ie=I(ge,Ae),Ce=Y[ge]??0,Oe=ie-Ce;return re+pe+Oe}return re+pe},0),[a,se,I,Y]),ne={onSave:P,onApply:ue,onEdit:()=>F(!0),onCancel:H,onDelete:()=>w(!0)};return u.jsxs(u.Fragment,{children:[v&&u.jsxs(ku,{message:f6(v),spinnerColor:"#22c55e",children:[u.jsx(Vf,{percent:v.percentComplete,gradient:"linear-gradient(90deg, #22c55e, #10b981)"}),u.jsxs("div",{style:{display:"flex",gap:"2rem",justifyContent:"center",flexWrap:"wrap"},children:[(v.totalMonthsToFetch??0)>0&&u.jsx(un,{value:`${v.monthsFetched||0}/${v.totalMonthsToFetch}`,label:"Months Loaded",color:v.phase==="fetching-months"?"#22c55e":"#6b7280"}),(v.totalMonths??0)>0&&u.jsx(un,{value:`${v.monthsProcessed}/${v.totalMonths}`,label:"Months Recalculated",color:v.phase==="recalculating"?"#22c55e":"#6b7280"})]}),u.jsx(Uf,{percent:v.percentComplete})]}),U&&u.jsx(io,{message:U,onDismiss:()=>B(null)}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr":se?"2fr 1fr 200px 1fr 1fr 1fr 120px":"2fr 1fr 1fr 1fr 1fr 1fr 120px"},children:[u.jsxs("div",{style:{gridColumn:"1 / -1",position:"sticky",top:0,zIndex:49,backgroundColor:"#242424",display:f?"block":"grid",gridTemplateColumns:f?void 0:"subgrid"},children:[se&&u.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem",paddingTop:"0.5rem",paddingBottom:f?"0.5rem":"0.25rem"},children:[u.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:u.jsx(eT,{isDraftMode:se,isEditingAppliedAllocations:N,availableNow:k,currentMonthIncome:R,balanceTotals:q,draftChangeAmount:G,availableAfterApply:K,currentDraftTotal:X})}),u.jsx(m_,{isDraftMode:se,isEditingAppliedAllocations:N,allocationsFinalized:j,...ne})]}),!f&&u.jsxs(u.Fragment,{children:[u.jsx("div",{style:Pa,children:"Category"}),u.jsx("div",{style:{...Pa,textAlign:"right"},children:"Start"}),u.jsx("div",{style:{...Pa,textAlign:se?"center":"right"},children:"Allocated"}),u.jsx("div",{style:{...Pa,textAlign:"right"},children:"Spent"}),u.jsx("div",{style:{...Pa,textAlign:"right"},children:"Net Change"}),u.jsx("div",{style:{...Pa,textAlign:"right",paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:"End"}),u.jsx("div",{style:{...Pa,textAlign:"right"},children:"All-Time"})]}),!f&&u.jsx(d6,{isDraftMode:se,allocationsFinalized:j,balanceTotals:q,grandAllTime:J,...ne}),!se&&f&&u.jsx(h6,{allocationsFinalized:j,availableNow:k,currentMonthIncome:R,balanceTotals:q,draftChangeAmount:G,availableAfterApply:K,currentDraftTotal:X,...ne})]}),Object.keys(a).length===0&&u.jsxs("p",{style:{gridColumn:"1 / -1",opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet. ",u.jsx(Tt,{to:"/budget/settings/categories",style:{color:oe.primaryLight},children:"Create categories "})]}),$.map(re=>{const ge=Q[re.id]||[];if(ge.length===0)return null;const Ae=ge.reduce((pe,[ie])=>{const Ce=V(ie);return Ce?{start:pe.start+Ce.start_balance,allocated:pe.allocated+Ce.allocated,spent:pe.spent+Ce.spent,end:pe.end+Ce.end_balance}:pe},{start:0,allocated:0,spent:0,end:0});return u.jsx(nE,{name:re.name,categories:ge,groupTotals:Ae,getCategoryBalance:V,localAllocations:D,savedAllocations:Y,previousMonthIncome:O,isDraftMode:se,onAllocationChange:M,isMobile:f,getAllocationAmount:I},re.id)}),Q.ungrouped?.length>0&&(()=>{const re=Q.ungrouped,ge=re.reduce((Ae,[pe])=>{const ie=V(pe);return ie?{start:Ae.start+ie.start_balance,allocated:Ae.allocated+ie.allocated,spent:Ae.spent+ie.spent,end:Ae.end+ie.end_balance}:Ae},{start:0,allocated:0,spent:0,end:0});return u.jsx(nE,{name:"Uncategorized",categories:re,groupTotals:ge,getCategoryBalance:V,localAllocations:D,savedAllocations:Y,previousMonthIncome:O,isDraftMode:se,onAllocationChange:M,isMobile:f,isUngrouped:!0,getAllocationAmount:I},"ungrouped")})(),u.jsx("div",{style:{gridColumn:"1 / -1",height:"2rem"}})]}),u.jsx(n6,{isOpen:C,onClose:()=>w(!1),onDeleted:()=>F(!1)})]})}function tT(t){return t===0?oe.zero:t>0?oe.success:oe.error}function nT(t){return t===0?oe.zero:t<0?oe.error:oe.success}function rT(t){return t===0?oe.zero:t>0?oe.success:oe.error}function rE({name:t,accounts:e,groupTotals:n,accountBalances:i,isMobile:a,isUngrouped:l}){const c={padding:"0.6rem 0.5rem",marginTop:"1.25rem",borderTop:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.04)",display:"flex",alignItems:"center",fontSize:"0.9rem",fontWeight:600};return u.jsxs("div",{style:{display:"contents"},children:[u.jsxs("div",{style:{...c,opacity:l?.7:1},children:[u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:t}),u.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400},children:["(",e.length,")"]})]}),u.jsx("div",{style:{...c,justifyContent:"flex-end",color:St(n.start)},children:u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:Pe(n.start)})}),u.jsx("div",{style:{...c,justifyContent:"flex-end",color:tT(n.income)},children:u.jsxs("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:["+",Pe(n.income)]})}),u.jsx("div",{style:{...c,justifyContent:"flex-end",color:nT(n.expenses)},children:u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:_i(n.expenses)})}),u.jsx("div",{style:{...c,justifyContent:"flex-end",color:rT(n.netChange)},children:u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:nr(n.netChange)})}),u.jsx("div",{style:{...c,justifyContent:"flex-end",color:St(n.end)},children:u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:Pe(n.end)})}),e.map(([h,f],p)=>{const _=i[h];return _?a?u.jsx("div",{style:{gridColumn:"1 / -1"},children:u.jsx(g6,{account:f,balance:_})},h):u.jsx(p6,{account:f,balance:_,isEvenRow:p%2===0},h):null})]})}function p6({account:t,balance:e,isEvenRow:n}){const a={padding:"0.5rem 0.5rem",background:n?"rgba(255,255,255,0.02)":"transparent",display:"flex",alignItems:"center",fontSize:"0.9rem"};return u.jsxs("div",{style:{display:"contents"},children:[u.jsx("div",{style:{...a,fontWeight:500,overflow:"hidden",paddingLeft:"1.5rem",borderLeft:"2px solid rgba(255,255,255,0.1)"},children:u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.nickname})}),u.jsx("div",{style:{...a,justifyContent:"flex-end",color:St(e.start_balance)},children:Pe(e.start_balance)}),u.jsxs("div",{style:{...a,justifyContent:"flex-end",color:tT(e.income)},children:["+",Pe(e.income)]}),u.jsx("div",{style:{...a,justifyContent:"flex-end",color:nT(e.expenses)},children:_i(e.expenses)}),u.jsx("div",{style:{...a,justifyContent:"flex-end",color:rT(e.net_change)},children:nr(e.net_change)}),u.jsx("div",{style:{...a,justifyContent:"flex-end",fontWeight:600,color:St(e.end_balance)},children:Pe(e.end_balance)})]})}function g6({account:t,balance:e}){return u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem",marginBottom:"0.25rem"},children:[u.jsx("div",{style:{marginBottom:"0.5rem"},children:u.jsx("span",{style:{fontWeight:500},children:t.nickname})}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[u.jsxs("div",{children:[u.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),u.jsx("span",{children:Pe(e.start_balance)})]}),u.jsxs("div",{children:[u.jsx("span",{style:{opacity:.6,display:"block"},children:"Net Change"}),u.jsx("span",{style:{color:St(e.net_change)},children:nr(e.net_change)})]}),u.jsxs("div",{children:[u.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),u.jsx("span",{style:{color:St(e.end_balance)},children:Pe(e.end_balance)})]})]}),(e.income!==0||e.expenses!==0)&&u.jsxs("div",{style:{marginTop:"0.5rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)",display:"flex",gap:"1rem",fontSize:"0.7rem",opacity:.7},children:[e.income!==0&&u.jsxs("span",{children:[nr(e.income)," income"]}),e.expenses!==0&&u.jsxs("span",{children:[_i(e.expenses)," expenses"]})]})]})}const Xo={fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"2px solid rgba(255,255,255,0.2)"};function y6(t){return t===0?oe.zero:t>0?oe.success:oe.error}function _6(t){return t===0?oe.zero:t<0?oe.error:oe.success}function b6(t){return t===0?oe.zero:t>0?oe.success:oe.error}function v6(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Pt(),{accounts:a,accountGroups:l,monthMap:c}=Mn(t,e),{month:h}=ao(t,n,i),f=aa(),p=xt(n,i),_=c[p]?.needs_recalculation===!0,b=A.useRef(!1),[v,E]=A.useState(null);A.useEffect(()=>{!t||!h||!_||b.current||(b.current=!0,`${n}${String(i).padStart(2,"0")}`,jf(t,{onProgress:K=>E(K)}).then(()=>{$e.invalidateQueries({queryKey:xe.month(t,n,i)})}).catch(K=>{console.error("[MonthAccounts] Recalculation failed:",K)}).finally(()=>{b.current=!1,E(null)}))},[t,_,h,n,i]);const C=A.useMemo(()=>Object.entries(l).map(([K,O])=>({id:K,...O})).sort((K,O)=>K.sort_order-O.sort_order),[l]),w=A.useMemo(()=>{const K={};return Object.entries(a).forEach(([O,R])=>{const j=R.account_group_id||"ungrouped";K[j]||(K[j]=[]),K[j].push([O,R])}),Object.keys(K).forEach(O=>{K[O].sort((R,j)=>R[1].sort_order-j[1].sort_order)}),K},[a]),D=A.useMemo(()=>l6(h,a),[h,a]),N=A.useMemo(()=>c6(D),[D]),U=N.income+N.expenses,X={...{padding:"0.6rem 0.5rem",display:"flex",alignItems:"center",fontSize:"0.9rem"},borderTop:"2px solid rgba(255,255,255,0.3)",borderBottom:"2px solid rgba(255,255,255,0.3)",fontWeight:600},G=()=>{if(!v)return"";switch(v.phase){case"reading-budget":return"Reading budget data...";case"fetching-months":return"Fetching months...";case"recalculating":return v.currentMonth?`Recalculating ${v.currentMonth}...`:"Recalculating...";case"saving":return"Saving results...";case"complete":return"Recalculation complete!";default:return"Recalculating balances..."}};return u.jsxs(u.Fragment,{children:[v&&u.jsxs(ku,{message:G(),spinnerColor:"#22c55e",children:[u.jsx(Vf,{percent:v.percentComplete,gradient:"linear-gradient(90deg, #22c55e, #10b981)"}),u.jsxs("div",{style:{display:"flex",gap:"2rem",justifyContent:"center",flexWrap:"wrap"},children:[(v.totalMonthsToFetch??0)>0&&u.jsx(un,{value:`${v.monthsFetched||0}/${v.totalMonthsToFetch}`,label:"Months Loaded",color:v.phase==="fetching-months"?"#22c55e":"#6b7280"}),(v.totalMonths??0)>0&&u.jsx(un,{value:`${v.monthsProcessed}/${v.totalMonths}`,label:"Months Recalculated",color:v.phase==="recalculating"?"#22c55e":"#6b7280"})]}),u.jsx(Uf,{percent:v.percentComplete})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr":"2fr 1fr 1fr 1fr 1fr 1fr"},children:[u.jsxs("div",{style:{gridColumn:"1 / -1",position:"sticky",top:0,zIndex:49,backgroundColor:"#242424",display:"grid",gridTemplateColumns:"subgrid"},children:[!f&&u.jsxs(u.Fragment,{children:[u.jsx("div",{style:Xo,children:"Account"}),u.jsx("div",{style:{...Xo,textAlign:"right"},children:"Start"}),u.jsx("div",{style:{...Xo,textAlign:"right"},children:"Income"}),u.jsx("div",{style:{...Xo,textAlign:"right"},children:"Expenses"}),u.jsx("div",{style:{...Xo,textAlign:"right"},children:"Net Change"}),u.jsx("div",{style:{...Xo,textAlign:"right"},children:"End"})]}),f?u.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderTop:"2px solid rgba(255,255,255,0.3)",borderBottom:"2px solid rgba(255,255,255,0.3)"},children:[u.jsx("span",{style:{fontWeight:600},children:"Grand Totals:"}),u.jsx(r6,{totals:N})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{style:{...X},children:"Grand Totals"}),u.jsx("div",{style:{...X,justifyContent:"flex-end",color:St(N.start)},children:Pe(N.start)}),u.jsxs("div",{style:{...X,justifyContent:"flex-end",color:y6(N.income)},children:["+",Pe(N.income)]}),u.jsx("div",{style:{...X,justifyContent:"flex-end",color:_6(N.expenses)},children:_i(N.expenses)}),u.jsx("div",{style:{...X,justifyContent:"flex-end",color:b6(U)},children:nr(U)}),u.jsx("div",{style:{...X,justifyContent:"flex-end",color:St(N.end)},children:Pe(N.end)})]})]}),Object.keys(a).length===0&&u.jsxs("p",{style:{gridColumn:"1 / -1",opacity:.6,textAlign:"center",padding:"2rem"},children:["No accounts yet."," ",u.jsx(Tt,{to:"/budget/settings/accounts",style:{color:oe.primaryLight},children:"Add accounts "})]}),C.map(K=>{const O=w[K.id]||[];if(O.length===0)return null;const R=O.reduce((j,[I])=>{const M=D[I];return M?{start:j.start+M.start_balance,income:j.income+M.income,expenses:j.expenses+M.expenses,netChange:j.netChange+M.net_change,end:j.end+M.end_balance}:j},{start:0,income:0,expenses:0,netChange:0,end:0});return u.jsx(rE,{name:K.name,accounts:O,groupTotals:R,accountBalances:D,isMobile:f},K.id)}),w.ungrouped?.length>0&&(()=>{const K=w.ungrouped,O=K.reduce((R,[j])=>{const I=D[j];return I?{start:R.start+I.start_balance,income:R.income+I.income,expenses:R.expenses+I.expenses,netChange:R.netChange+I.net_change,end:R.end+I.end_balance}:R},{start:0,income:0,expenses:0,netChange:0,end:0});return u.jsx(rE,{name:"Ungrouped",accounts:K,groupTotals:O,accountBalances:D,isMobile:f,isUngrouped:!0},"ungrouped")})(),u.jsx("div",{style:{gridColumn:"1 / -1",height:"2rem"}})]})]})}const x6=["income","categories","accounts","spend"];function iE(t){const e=t.year?parseInt(t.year,10):null,n=t.month?parseInt(t.month,10):null,i=t.tab&&x6.includes(t.tab)?t.tab:null;return{year:e&&!isNaN(e)&&e>=2e3&&e<=2100?e:null,month:n&&!isNaN(n)&&n>=1&&n<=12?n:null,tab:i}}function S6(){const t=new Date;return{year:t.getFullYear(),month:t.getMonth()+1}}function sE(){const t=NR(),e=yu(),[n,i]=TD(),{addLoadingHold:a,removeLoadingHold:l}=qn(),{currentUserId:c,selectedBudgetId:h,currentYear:f,currentMonthNumber:p,lastActiveTab:_,setCurrentYear:b,setCurrentMonthNumber:v,setLastActiveTab:E,setPageTitle:C,goToPreviousMonth:w,goToNextMonth:D,hasPendingInvites:N,pendingInvites:U,needsFirstBudget:k}=Pt(),{budget:X,isLoading:G,createBudget:K,acceptInvite:O}=Mn(h,c),R=!G,[j,I]=A.useState(!1);A.useEffect(()=>(R||a("budget-data","Loading budget data..."),()=>l("budget-data")),[R,a,l]);const M=A.useRef(!1),H=n.get("error"),[P,ue]=A.useState(H);A.useEffect(()=>{H&&(n.delete("error"),i(n,{replace:!0}))},[H,n,i]);const[F,B]=A.useState(()=>{const{tab:ne}=iE(t);return ne??_}),$=ne=>{B(ne),E(ne)};A.useEffect(()=>{if(M.current)return;const{year:ne,month:re}=iE(t);ne&&b(ne),re&&v(re),M.current=!0},[t,b,v]),A.useEffect(()=>{if(!M.current)return;const ne=`/budget/${f}/${p}/${F}`,re=`/budget/${t.year}/${t.month}/${t.tab}`;ne!==re&&e(ne,{replace:!0})},[f,p,F,e,t]);const{month:Q,error:se,isLoading:ee}=ao(R?h:null,f,p);A.useEffect(()=>{if(!se||j)return;const ne=se.message||"";(ne.includes("months in the past")||ne.includes("Refusing to create month"))&&(console.log(`[Budget] Month creation failed: ${ne}`),queueMicrotask(()=>{a("month-redirect","Redirecting to current month..."),I(!0);const{year:re,month:ge}=S6();console.log(`[Budget] Redirecting from ${f}/${p} to current month: ${re}/${ge}`),ue(`Cannot create month ${f}/${p} - it's too far in the past. Redirected to current month.`),b(re),v(ge)}))},[se,j,f,p,b,v,a]),A.useEffect(()=>{j&&Q&&!ee&&queueMicrotask(()=>{I(!1),l("month-redirect")})},[j,Q,ee,l]),A.useLayoutEffect(()=>{C(X?.name||"Budget")},[X?.name,C]);async function V(ne){try{await O(ne)}catch(re){ue(re instanceof Error?re.message:"Failed to accept invite")}}async function q(ne){try{await K(ne||"My Budget")}catch(re){ue(re instanceof Error?re.message:"Failed to create budget")}}if(!X&&N)return u.jsx(PL,{invites:U,onAccept:V,onCreateNew:q});if(!X&&k)return u.jsx(NL,{onCreateNew:q});if(!R||j)return null;function Y(){ue(null),w()}function J(){ue(null),D()}return u.jsxs(LC,{children:[P&&u.jsx(io,{message:P,onDismiss:()=>ue(null)}),u.jsx(WL,{onPreviousMonth:Y,onNextMonth:J}),u.jsx(LL,{activeTab:F,setActiveTab:$,allocationsFinalized:Q?.are_allocations_finalized}),F==="income"&&u.jsx(ZL,{},`${f}-${p}`),F==="categories"&&u.jsx(m6,{},`${f}-${p}`),F==="accounts"&&u.jsx(v6,{},`${f}-${p}`),F==="spend"&&u.jsx(t6,{},`${f}-${p}`)]})}function E6(){const{setPageTitle:t}=Pt();return A.useLayoutEffect(()=>{t("Analytics")},[t]),u.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[u.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),u.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),u.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),u.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),u.jsx(Tt,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:oe.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})}function aE({budget:t,isCurrent:e,isAccepting:n,isSwitching:i,isEditing:a,editName:l,isRenaming:c,onAccept:h,onSwitch:f,onStartEdit:p,onCancelEdit:_,onEditNameChange:b,onSaveEdit:v}){const E=e&&t.isOwner;return u.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:a?u.jsxs("form",{onSubmit:v,children:[u.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:u.jsx("input",{type:"text",value:l,onChange:C=>b(C.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsx("button",{type:"submit",disabled:c||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:c||!l.trim()?.7:1,fontSize:"0.8rem"},children:c?"Saving...":"Save"}),u.jsx("button",{type:"button",onClick:_,disabled:c,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:c?"not-allowed":"pointer",fontWeight:500,opacity:c?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[u.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[u.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&u.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&u.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&u.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),E&&u.jsx("button",{onClick:p,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),u.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),u.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?u.jsx("button",{onClick:h,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:u.jsx("button",{onClick:f,disabled:i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,fontSize:"0.85rem"},children:i?"Switching...":"Switch"})})]})})}const ty={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function iT({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,i=n&&n in ty?n:"bug",a=ty[i];return u.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:a.bgColor,color:a.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:a.label})}function w6({item:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:c,onDrop:h,onToggleDone:f,onTypeClick:p}){return u.jsxs("div",{onDragOver:_=>{_.stopPropagation(),a(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),h(_)},style:{position:"relative"},children:[u.jsx("div",{style:{...OC,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),u.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:c,style:{...Ou,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[u.jsx("span",{style:{...MC},children:""}),u.jsx("input",{type:"checkbox",checked:t.is_done,onChange:f,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:oe.primary,flexShrink:0}}),u.jsx(iT,{type:t.feedback_type,onClick:p})]}),u.jsxs("div",{style:{marginLeft:"3.25rem"},children:[u.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),u.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",ey(t.created_at)]})]})]})]})}function C6({item:t,onToggleDone:e,onTypeClick:n}){return u.jsxs("div",{style:{...Ou,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[u.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:oe.primary,flexShrink:0}}),u.jsx(iT,{type:t.feedback_type,onClick:n})]}),u.jsxs("div",{style:{marginLeft:"2rem"},children:[u.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),u.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",ey(t.created_at)]}),t.completed_at&&u.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:oe.success},children:[" Completed: ",ey(t.completed_at)]})]})]})}function zf({noMargin:t}={}){return u.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:t?0:"0.5rem",verticalAlign:"middle"}})}function Ff({title:t,description:e,status:n,statusText:i,onRefresh:a,isRefreshing:l,isBusy:c=!1,children:h,cardName:f}){const _=(()=>{switch(n){case"unknown":return{color:"#9ca3af",text:i??"Unknown"};case"clean":case"complete":return{color:"#22c55e",text:i??" Clean"};case"needs-action":return{color:"#f59e0b",text:i??"Action Needed"}}})(),b=l||c;return u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[u.jsxs("div",{style:{flex:1},children:[u.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:t}),u.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.9rem"},children:e})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexShrink:0},children:[n!=="unknown"&&u.jsx("span",{style:{color:_.color,fontWeight:600,fontSize:"0.9rem"},children:_.text}),u.jsxs("button",{onClick:()=>{a()},disabled:b,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem 0.65rem",borderRadius:"6px",cursor:b?"not-allowed":"pointer",fontWeight:500,fontSize:"0.85rem",opacity:b?.6:1,display:"flex",alignItems:"center",gap:"0.3rem"},title:"Refresh status",children:[l?u.jsx(zf,{noMargin:!0}):""," Refresh"]})]})]}),h]})}const T6={unknown:{bg:"rgba(100, 100, 100, 0.1)",border:"rgba(100, 100, 100, 0.3)",color:"#9ca3af"},clean:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"},warning:{bg:"rgba(245, 158, 11, 0.1)",border:"rgba(245, 158, 11, 0.3)",color:"#fbbf24"},running:{bg:"rgba(100, 108, 255, 0.1)",border:"rgba(100, 108, 255, 0.3)",color:"#a5b4fc"},success:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"}};function dn({type:t,children:e}){const n=T6[t];return u.jsx("div",{style:{background:n.bg,border:`1px solid ${n.border}`,color:n.color,padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:e})}function qf({onClick:t,disabled:e,isBusy:n,busyText:i,children:a,actionName:l}){const c=e||n;return u.jsx("button",{onClick:()=>{t()},disabled:c,style:{marginTop:"1rem",background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:c?"not-allowed":"pointer",fontWeight:500,opacity:c?.7:1,display:"flex",alignItems:"center",gap:"0.4rem"},children:n?u.jsxs(u.Fragment,{children:[u.jsx(zf,{noMargin:!0})," ",i??"Running..."]}):a})}function A6({hasData:t,status:e,hasIssues:n,totalIssues:i,isRunning:a,result:l,onRunCleanup:c,onRefresh:h,isRefreshing:f,disabled:p}){const _=()=>t?l&&l.errors.length===0&&(l.accountsFixed>0||l.categoriesFixed>0||l.groupsFixed>0||l.monthMapsUpdated>0||l.deprecatedFieldsRemoved>0||l.futureMonthsDeleted>0||l.monthsFixed>0||l.oldRecalcFieldsRemoved>0)?"complete":n?"needs-action":"clean":"unknown",b=l?l.accountsFixed+l.categoriesFixed+l.groupsFixed+l.monthMapsUpdated+l.deprecatedFieldsRemoved+l.futureMonthsDeleted+l.monthsFixed+l.oldRecalcFieldsRemoved:0;return u.jsx(Ff,{title:" Database Cleanup",description:"Validates and fixes all budget and month documents to match the expected schema. Converts legacy formats, adds missing default values, and removes invalid future months.",status:_(),onRefresh:h,isRefreshing:f,isBusy:a,children:a?u.jsx(dn,{type:"running",children:"Running database cleanup..."}):l?u.jsx(dn,{type:l.errors.length>0?"warning":"success",children:u.jsxs("div",{children:[l.errors.length>0?"":""," Cleanup complete",u.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.9rem"},children:[l.budgetsProcessed>0&&u.jsxs("li",{children:[l.budgetsProcessed," budget",l.budgetsProcessed!==1?"s":""," updated"]}),l.arraysConverted>0&&u.jsxs("li",{children:[l.arraysConverted," array",l.arraysConverted!==1?"s":""," converted to maps"]}),l.accountsFixed>0&&u.jsxs("li",{children:[l.accountsFixed," account",l.accountsFixed!==1?"s":""," fixed"]}),l.categoriesFixed>0&&u.jsxs("li",{children:[l.categoriesFixed," categor",l.categoriesFixed!==1?"ies":"y"," fixed"]}),l.groupsFixed>0&&u.jsxs("li",{children:[l.groupsFixed," group",l.groupsFixed!==1?"s":""," fixed"]}),l.monthMapsUpdated>0&&u.jsxs("li",{children:[l.monthMapsUpdated," budget",l.monthMapsUpdated!==1?"s":""," got month_map updated"]}),l.deprecatedFieldsRemoved>0&&u.jsxs("li",{children:[l.deprecatedFieldsRemoved," budget",l.deprecatedFieldsRemoved!==1?"s":""," had deprecated fields removed"]}),l.futureMonthsDeleted>0&&u.jsxs("li",{children:[l.futureMonthsDeleted," future month",l.futureMonthsDeleted!==1?"s":""," deleted"]}),l.monthsFixed>0&&u.jsxs("li",{children:[l.monthsFixed," month",l.monthsFixed!==1?"s":""," schema fixed"]}),l.oldRecalcFieldsRemoved>0&&u.jsxs("li",{children:[l.oldRecalcFieldsRemoved," month",l.oldRecalcFieldsRemoved!==1?"s":""," had old recalc field removed"]}),b===0&&u.jsx("li",{children:"No changes needed"})]}),l.errors.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("p",{style:{margin:"0.75rem 0 0.25rem 0",fontWeight:500,color:"#ef4444"},children:"Errors:"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.85rem",color:"#ef4444"},children:[l.errors.slice(0,5).map((v,E)=>u.jsx("li",{children:v},E)),l.errors.length>5&&u.jsxs("li",{style:{opacity:.7},children:["...and ",l.errors.length-5," more errors"]})]})]})]})}):t?n?u.jsxs(u.Fragment,{children:[u.jsx(dn,{type:"warning",children:u.jsxs("div",{children:[u.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",i," issue",i!==1?"s":""," to fix:"]}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[e.budgetsWithArrays>0&&u.jsxs("li",{children:[e.budgetsWithArrays," budget",e.budgetsWithArrays!==1?"s":""," using legacy array format"]}),e.accountsNeedingDefaults>0&&u.jsxs("li",{children:[e.accountsNeedingDefaults," account",e.accountsNeedingDefaults!==1?"s":""," missing default values"]}),e.categoriesNeedingDefaults>0&&u.jsxs("li",{children:[e.categoriesNeedingDefaults," categor",e.categoriesNeedingDefaults!==1?"ies":"y"," missing default values"]}),e.groupsNeedingDefaults>0&&u.jsxs("li",{children:[e.groupsNeedingDefaults," account group",e.groupsNeedingDefaults!==1?"s":""," missing default values"]}),e.budgetsNeedingMonthMapUpdate>0&&u.jsxs("li",{children:[e.budgetsNeedingMonthMapUpdate," budget",e.budgetsNeedingMonthMapUpdate!==1?"s":""," missing month_map"]}),e.budgetsWithDeprecatedEarliestMonth>0&&u.jsxs("li",{children:[e.budgetsWithDeprecatedEarliestMonth," budget",e.budgetsWithDeprecatedEarliestMonth!==1?"s":""," with deprecated earliest_month field to remove"]}),e.futureMonthsToDelete.length>0&&u.jsxs("li",{children:[e.futureMonthsToDelete.length," future month",e.futureMonthsToDelete.length!==1?"s":""," to delete",u.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.85rem",opacity:.8},children:[e.futureMonthsToDelete.slice(0,3).map(v=>u.jsxs("li",{children:[dl[v.month-1]," ",v.year]},v.docId)),e.futureMonthsToDelete.length>3&&u.jsxs("li",{style:{opacity:.7},children:["...and ",e.futureMonthsToDelete.length-3," more"]})]})]}),e.monthsWithSchemaIssues>0&&u.jsxs("li",{children:[e.monthsWithSchemaIssues," month",e.monthsWithSchemaIssues!==1?"s":""," with schema issues"]}),e.monthsWithOldRecalcField>0&&u.jsxs("li",{children:[e.monthsWithOldRecalcField," month",e.monthsWithOldRecalcField!==1?"s":""," with deprecated is_needs_recalculation field"]})]}),u.jsxs("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["Scanned ",e.totalBudgets," budgets and ",e.totalMonths," months."]})]})}),u.jsxs(qf,{onClick:c,disabled:p,isBusy:a,busyText:"Running...",actionName:"Run Database Cleanup",children:[" Fix ",i," Issue",i!==1?"s":""]})]}):u.jsx(dn,{type:"clean",children:u.jsxs("div",{children:[" Database is clean",u.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["All ",e.totalBudgets," budgets and ",e.totalMonths," months match expected schema."]})]})}):u.jsx(dn,{type:"unknown",children:" Status unknown  click Refresh to scan the database"})})}function R6({hasData:t,status:e,isMigrating:n,onMigrate:i,onRefresh:a,isRefreshing:l,disabled:c,migrationResult:h}){const f=e&&(e.sanitizedDocuments.length>0||e.corruptedDocuments.length>0),p=h&&(h.deletedDocuments>0||h.fixedDocuments>0),_=()=>t?p?"complete":f?"needs-action":"clean":"unknown";return u.jsx(Ff,{title:" Consolidate Feedback Documents",description:"Fixes corrupted feedback data and merges documents with sanitized IDs into proper email format.",status:_(),onRefresh:a,isRefreshing:l,isBusy:n,children:n?u.jsx(dn,{type:"running",children:"Migrating feedback documents..."}):t?p?u.jsx(dn,{type:"success",children:u.jsxs("div",{children:[" Migration complete:",u.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[h.fixedDocuments>0&&u.jsxs("li",{children:["Fixed ",h.fixedDocuments," corrupted document(s)"]}),h.deletedDocuments>0&&u.jsxs("li",{children:["Merged & deleted ",h.deletedDocuments," sanitized document(s)"]}),h.mergedItems>0&&u.jsxs("li",{children:["Merged ",h.mergedItems," feedback item(s)"]})]}),h.errors.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{style:{marginTop:"0.5rem"},children:" Errors:"}),u.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:h.errors.map((b,v)=>u.jsx("li",{children:b},v))})]})]})}):f?u.jsxs(u.Fragment,{children:[u.jsx(dn,{type:"warning",children:u.jsxs("div",{children:[e?.corruptedDocuments&&e.corruptedDocuments.length>0&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.corruptedDocuments.length," corrupted document(s):"]}),u.jsx("ul",{style:{margin:"0 0 0.75rem 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.corruptedDocuments.map(b=>u.jsxs("li",{children:[b," ",u.jsx("span",{style:{opacity:.6},children:"(broken arrayUnion)"})]},b))})]}),e?.sanitizedDocuments&&e.sanitizedDocuments.length>0&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.sanitizedDocuments.length," sanitized document(s) to merge:"]}),u.jsx("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.sanitizedDocuments.map(b=>u.jsx("li",{children:b},b))})]})]})}),u.jsx(qf,{onClick:i,disabled:c,isBusy:n,busyText:"Migrating...",actionName:"Run Feedback Migration",children:"Run Migration"})]}):u.jsxs(dn,{type:"clean",children:[" No issues found. All feedback documents are healthy.",u.jsxs("span",{style:{display:"block",fontSize:"0.85rem",opacity:.7,marginTop:"0.25rem"},children:["Found ",e?.documentsFound??0," document(s) total."]})]}):u.jsx(dn,{type:"unknown",children:" Status unknown  click Refresh to scan for issues"})})}function D6({hasData:t,monthsCount:e,budgetCount:n,monthsToDelete:i,isDeleting:a,onDelete:l,onRefresh:c,isRefreshing:h,disabled:f,deleteResult:p,deleteProgress:_}){const[b,v]=A.useState(!1),E=()=>{v(!0)},C=()=>{v(!1),l()},w=()=>t?p&&p.deleted>0&&p.errors.length===0?"complete":e===0?"clean":"needs-action":"unknown",D=i.reduce((N,U)=>{const k=U.budgetId;return N[k]||(N[k]=[]),N[k].push(U),N},{});return u.jsxs(Ff,{title:" Delete ALL Months",description:"DESTRUCTIVE: Deletes ALL month documents from Firebase for ALL budgets. This will reset all income, expenses, and allocations. Use with extreme caution!",status:w(),onRefresh:c,isRefreshing:h,isBusy:a,children:[a?u.jsx(dn,{type:"running",children:"Deleting all months..."}):p?u.jsx(dn,{type:p.errors.length>0?"warning":"success",children:u.jsxs("div",{children:[p.errors.length>0?"":""," Deleted ",p.deleted," month",p.deleted!==1?"s":"",p.budgetsRecalculated>0&&u.jsxs("span",{children:[", reset ",p.budgetsRecalculated," budget",p.budgetsRecalculated!==1?"s":""]}),u.jsx("span",{style:{opacity:.8},children:", cache cleared"}),p.errors.length>0&&u.jsx("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem"},children:p.errors.map((N,U)=>u.jsx("li",{children:N},U))})]})}):t?e>0?u.jsxs(u.Fragment,{children:[u.jsx(dn,{type:"warning",children:u.jsxs("div",{children:[u.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",u.jsx("strong",{children:e})," month",e!==1?"s":""," across ",u.jsx("strong",{children:n})," budget",n!==1?"s":"",":"]}),u.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto"},children:[Object.entries(D).slice(0,5).map(([N,U])=>u.jsxs("div",{style:{marginBottom:"0.5rem"},children:[u.jsxs("div",{style:{fontWeight:500,fontSize:"0.85rem"},children:["Budget: ",N.slice(0,12),"..."]}),u.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.85rem"},children:[U.slice(0,3).map(k=>u.jsxs("li",{children:[dl[k.month-1]," ",k.year]},k.docId)),U.length>3&&u.jsxs("li",{style:{opacity:.7},children:["...and ",U.length-3," more"]})]})]},N)),Object.keys(D).length>5&&u.jsxs("div",{style:{opacity:.7,fontSize:"0.85rem",marginTop:"0.5rem"},children:["...and ",Object.keys(D).length-5," more budgets"]})]})]})}),u.jsxs(qf,{onClick:E,disabled:f,isBusy:a,busyText:"Deleting...",actionName:"Delete All Months",children:[" Delete ALL ",e," Month",e!==1?"s":""]}),u.jsx("p",{style:{fontSize:"0.8rem",color:"#ef4444",marginTop:"0.5rem",fontWeight:500},children:" This action cannot be undone!"})]}):u.jsx(dn,{type:"clean",children:" No month documents found in Firebase."}):u.jsx(dn,{type:"unknown",children:" Status unknown  click Refresh to scan for months"}),u.jsxs(ea,{isOpen:b,onClose:()=>v(!1),title:" Delete All Months?",children:[u.jsx("div",{style:{background:"color-mix(in srgb, #ef4444 15%, transparent)",border:"1px solid color-mix(in srgb, #ef4444 40%, transparent)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:u.jsx("p",{style:{margin:0,color:"#fca5a5",fontWeight:500,fontSize:"0.95rem"},children:" This is a destructive operation that cannot be undone!"})}),u.jsxs("p",{style:{margin:"0 0 0.75rem",opacity:.9},children:["This will permanently delete ",u.jsxs("strong",{style:{color:"#ef4444"},children:[e," month",e!==1?"s":""]})," across"," ",u.jsxs("strong",{style:{color:"#ef4444"},children:[n," budget",n!==1?"s":""]}),"."]}),u.jsx("p",{style:{margin:"0 0 1rem",opacity:.8,fontSize:"0.9rem"},children:"After deletion, all affected budgets will be reset:"}),u.jsxs("ul",{style:{margin:"0 0 1.5rem",paddingLeft:"1.5rem",opacity:.8,fontSize:"0.9rem"},children:[u.jsx("li",{children:"All account balances  $0"}),u.jsx("li",{children:"All category balances  $0"}),u.jsx("li",{children:"Month history cleared"}),u.jsx("li",{children:"Cache cleared automatically"})]}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[u.jsx(Ie,{variant:"secondary",actionName:"Cancel Delete All Months",onClick:()=>v(!1),children:"Cancel"}),u.jsxs(Ie,{variant:"danger",actionName:"Confirm Delete All Months",onClick:C,children:[" Delete All ",e," Months"]})]})]}),a&&_&&u.jsx(j6,{progress:_})]})}function j6({progress:t}){const e=()=>{switch(t.phase){case"deleting":return t.currentMonth?`Deleting ${t.currentMonth}...`:"Deleting months...";case"resetting-budgets":return t.currentMonth?`Resetting ${t.currentMonth}...`:"Resetting budgets...";case"clearing-cache":return"Clearing cache...";case"complete":return"Complete!";default:return"Processing..."}},n=()=>t.phase==="resetting-budgets"||t.phase==="clearing-cache"?"linear-gradient(90deg, #22c55e, #10b981)":"linear-gradient(90deg, #ef4444, #dc2626)",i=()=>t.phase==="resetting-budgets"||t.phase==="clearing-cache"?"#22c55e":"#ef4444";return u.jsxs(ku,{message:e(),spinnerColor:i(),children:[u.jsx(Vf,{percent:t.percentComplete,gradient:n()}),t.phase==="deleting"&&u.jsxs(hl,{columns:2,children:[u.jsx(un,{value:`${t.deleted}/${t.total}`,label:"Months Deleted",color:"#ef4444"}),u.jsx(un,{value:t.total-t.deleted,label:"Remaining",color:"rgba(255, 255, 255, 0.6)"})]}),t.phase==="resetting-budgets"&&u.jsxs(hl,{columns:2,children:[u.jsx(un,{value:t.deleted,label:"Months Deleted",color:"#ef4444"}),u.jsx(un,{value:`${t.budgetsRecalculated}/${t.totalBudgets}`,label:"Budgets Reset",color:"#22c55e"})]}),(t.phase==="clearing-cache"||t.phase==="complete")&&u.jsxs(hl,{columns:2,children:[u.jsx(un,{value:t.deleted,label:"Months Deleted",color:"#ef4444"}),u.jsx(un,{value:t.budgetsRecalculated,label:"Budgets Reset",color:"#22c55e"})]}),u.jsx(Uf,{percent:t.percentComplete})]})}function I6({result:t}){return u.jsx("div",{style:{marginTop:"1rem"},children:u.jsx(dn,{type:t.errors.length>0?"warning":"success",children:u.jsxs("div",{children:[t.errors.length>0?"":""," Import ",t.success?"complete":"finished with errors",u.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.9rem"},children:[u.jsxs("li",{children:[t.imported," records imported"]}),t.skipped>0&&u.jsxs("li",{children:[t.skipped," records skipped"]})]}),t.errors.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("p",{style:{margin:"0.75rem 0 0.25rem 0",fontWeight:500,color:"#ef4444"},children:"Errors:"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.85rem",color:"#ef4444"},children:[t.errors.slice(0,5).map((e,n)=>u.jsx("li",{children:e},n)),t.errors.length>5&&u.jsxs("li",{style:{opacity:.7},children:["...and ",t.errors.length-5," more errors"]})]})]})]})})})}function M6({recordCount:t,recordTypeCounts:e,monthRange:n,onCancel:i,onConfirm:a}){const l=()=>n?n.isSingleMonth?n.start:`${n.start} to ${n.end}`:"";return u.jsxs("div",{children:[u.jsxs("div",{style:{background:"color-mix(in srgb, #ef4444 15%, transparent)",border:"1px solid color-mix(in srgb, #ef4444 40%, transparent)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[u.jsx("p",{style:{margin:0,color:"#fca5a5",fontWeight:500,fontSize:"0.95rem"},children:" Warning: Destructive Operation"}),u.jsxs("p",{style:{margin:"0.5rem 0 0",color:"rgba(255, 255, 255, 0.8)",fontSize:"0.9rem"},children:["This will ",u.jsx("strong",{children:"REPLACE"})," all existing income, expenses, and allocations in"," ",u.jsx("strong",{style:{color:"#fbbf24"},children:n?.count===1?"1 month":`${n?.count} months`})," ","(",l(),")."]})]}),u.jsxs("p",{style:{margin:"0 0 0.5rem",opacity:.8},children:["You are about to import ",u.jsx("strong",{children:t.toLocaleString()})," records:"]}),u.jsxs("ul",{style:{margin:"0 0 1rem",paddingLeft:"1.5rem",fontSize:"0.9rem",opacity:.9},children:[e.income>0&&u.jsxs("li",{children:[e.income.toLocaleString()," income transactions"]}),e.spend>0&&u.jsxs("li",{children:[e.spend.toLocaleString()," expense transactions"]}),e.allocations>0&&u.jsxs("li",{children:[e.allocations.toLocaleString()," budget allocations"]})]}),u.jsxs("p",{style:{margin:"0 0 1.5rem",opacity:.8},children:["Any existing data of these types in the affected months will be ",u.jsx("strong",{style:{color:"#fca5a5"},children:"deleted and replaced"}),". This cannot be undone."]}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[u.jsx(Ie,{variant:"secondary",actionName:"Cancel Seed Import",onClick:i,children:"Cancel"}),u.jsx(Ie,{variant:"danger",actionName:"Confirm Seed Import",onClick:a,children:"Replace & Import"})]})]})}function O6({progress:t}){const e=()=>{switch(t.phase){case"saving-mappings":return"Saving mappings...";case"reading-months":return`Reading ${t.totalMonths} months (parallel)...`;case"creating-months":return t.currentMonth?`Creating ${t.currentMonth}...`:`Creating ${t.monthsToCreate} new months...`;case"processing-months":return t.currentMonth?`Processing & recalculating ${t.currentMonth}...`:`Processing ${t.totalRecords.toLocaleString()} records...`;case"saving-months":return`Saving ${t.totalMonths} months (batch)...`;case"updating-budget":return"Updating budget balances...";case"complete":return"Import complete!";default:return"Importing..."}},n=t.phase==="creating-months"&&t.monthsToCreate>0,i=t.phase==="processing-months"||t.phase==="saving-months"||t.phase==="updating-budget"||t.phase==="complete";return u.jsxs(ku,{message:e(),spinnerColor:"#646cff",children:[u.jsx(Vf,{percent:t.percentComplete,gradient:"linear-gradient(90deg, #646cff, #8b5cf6)"}),n&&u.jsxs(hl,{columns:2,children:[u.jsx(un,{value:`${t.monthsCreated}/${t.monthsToCreate}`,label:"Months Created",color:"#f59e0b"}),u.jsx(un,{value:t.totalMonths,label:"Total Months",color:"#646cff"})]}),!n&&u.jsxs(hl,{columns:t.gapMonths>0?3:2,children:[u.jsx(un,{value:t.totalMonths,label:"Months",color:"#646cff"}),t.monthsCreated>0&&u.jsx(un,{value:t.monthsCreated,label:"New",color:"#f59e0b"}),t.gapMonths>0&&u.jsx(un,{value:t.gapMonths,label:"Gap Filled",color:"#8b5cf6"})]}),i&&u.jsxs(hl,{columns:3,children:[u.jsx(un,{value:t.incomeImported,label:"Income",color:"#22c55e"}),u.jsx(un,{value:t.spendImported,label:"Expenses",color:"#ef4444"}),u.jsx(un,{value:t.allocationsImported,label:"Allocations",color:"#3b82f6"})]}),u.jsx(Uf,{percent:t.percentComplete})]})}function k6(t,e){return t.account_group_id&&e[t.account_group_id]?e[t.account_group_id].name:"Ungrouped"}function _h({oldName:t,currentMapping:e,options:n,onMap:i,placeholder:a,isAutoMapped:l}){const c=h=>{const f=h.target.value,p=n.find(_=>_.id===f);if(p){const _=p.rawName??p.name;i(f,_)}};return u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem",padding:"0.5rem",background:l?"color-mix(in srgb, #22c55e 8%, transparent)":"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"6px",borderLeft:l?"3px solid #22c55e":"none"},children:[u.jsxs("span",{style:{flex:"0 0 40%",fontSize:"0.85rem",fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"0.35rem"},title:t,children:['"',t,'"',l&&u.jsx("span",{style:{fontSize:"0.7rem",opacity:.6},children:"(auto)"})]}),u.jsx("span",{style:{opacity:.5},children:""}),u.jsxs("select",{value:e?.newId??"",onChange:c,style:{flex:1,padding:"0.4rem",borderRadius:"4px",border:e?"1px solid #22c55e":"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:e?"color-mix(in srgb, #22c55e 10%, transparent)":"color-mix(in srgb, currentColor 10%, transparent)",color:"inherit",fontSize:"0.85rem"},children:[u.jsx("option",{value:"",children:a}),n.map(h=>u.jsx("option",{value:h.id,children:h.name},h.id))]})]})}function N6({unmappedCategories:t,unmappedAccounts:e,customMappedCategories:n,customMappedAccounts:i,categoryMappings:a,accountMappings:l,categories:c,accounts:h,accountGroups:f,onCategoryMap:p,onAccountMap:_}){const b=A.useMemo(()=>{const C=Object.entries(c).sort((w,D)=>w[1].name.localeCompare(D[1].name));return[[ci,{name:Va,category_group_id:null,sort_order:-1}],...C]},[c]),v=A.useMemo(()=>{const C=Object.entries(h).sort((w,D)=>w[1].nickname.localeCompare(D[1].nickname)).map(([w,D])=>({id:w,acc:D,displayName:`${D.nickname} (${k6(D,f)})`}));return[{id:ol,acc:{nickname:du},displayName:du},...C]},[h,f]),E=t.length>0||e.length>0;return u.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",borderRadius:"8px",padding:"1rem",marginBottom:"1rem"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"0.95rem"},children:" Entity Mappings"}),u.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.85rem",opacity:.8},children:[E?"Map unknown entities to existing categories/accounts.":"Review saved mappings (names that don't exactly match existing entities)."," ","These mappings will be saved for future imports."]}),t.length>0&&u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsxs("h5",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",color:"#ef4444"},children:[" Unmapped Categories (",t.length,")"]}),t.map(C=>u.jsx(_h,{oldName:C,currentMapping:a.get(C),options:b.map(([w,D])=>({id:w,name:D.name})),onMap:(w,D)=>p(C,w,D),placeholder:"Select a category..."},`cat-unmapped-${C}`))]}),n.length>0&&u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsxs("h5",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",color:"#60a5fa"},children:[" Saved Category Mappings (",n.length,")"]}),n.map(C=>u.jsx(_h,{oldName:C,currentMapping:a.get(C),options:b.map(([w,D])=>({id:w,name:D.name})),onMap:(w,D)=>p(C,w,D),placeholder:"Select a category...",isAutoMapped:!0},`cat-custom-${C}`))]}),e.length>0&&u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsxs("h5",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",color:"#ef4444"},children:[" Unmapped Accounts (",e.length,")"]}),e.map(C=>u.jsx(_h,{oldName:C,currentMapping:l.get(C),options:v.map(({id:w,acc:D,displayName:N})=>({id:w,name:N,rawName:D.nickname})),onMap:(w,D)=>_(C,w,D),placeholder:"Select an account..."},`acc-unmapped-${C}`))]}),i.length>0&&u.jsxs("div",{children:[u.jsxs("h5",{style:{margin:"0 0 0.5rem 0",fontSize:"0.9rem",color:"#60a5fa"},children:[" Saved Account Mappings (",i.length,")"]}),i.map(C=>u.jsx(_h,{oldName:C,currentMapping:l.get(C),options:v.map(({id:w,acc:D,displayName:N})=>({id:w,name:N,rawName:D.nickname})),onMap:(w,D)=>_(C,w,D),placeholder:"Select an account...",isAutoMapped:!0},`acc-custom-${C}`))]})]})}function P6({disabled:t}){const{selectedBudgetId:e}=Pt(),{data:n}=U1(e),i=A.useRef(null),[a,l]=A.useState(null),[c,h]=A.useState(!1),{status:f,parsedData:p,unmappedCategories:_,unmappedAccounts:b,customMappedCategories:v,customMappedAccounts:E,categoryMappings:C,accountMappings:w,importResult:D,importProgress:N,parseFile:U,setCategoryMapping:k,setAccountMapping:X,runImport:G,reset:K,isParsing:O,isImporting:R,hasUnmappedEntities:j}=kL(e),I=v.length>0||E.length>0,M=A.useMemo(()=>n?.budget?.categories??{},[n?.budget?.categories]),H=A.useMemo(()=>n?.budget?.accounts??{},[n?.budget?.accounts]),P=A.useMemo(()=>n?.budget?.account_groups??{},[n?.budget?.account_groups]),ue=A.useCallback(q=>{const Y=q.target.files?.[0];Y&&(l(Y),U(Y,M,H))},[U,M,H]),F=A.useCallback(()=>{!e||!p||h(!0)},[e,p]),B=A.useCallback(async()=>{h(!1),!(!e||!p)&&await G(M,H)},[e,p,G,M,H]),$=A.useCallback(()=>{l(null),K(),i.current&&(i.current.value="")},[K]),Q=A.useMemo(()=>D&&D.errors.length===0?"complete":f==="ready"||f==="mapping"?"needs-action":"unknown",[f,D]),se=A.useMemo(()=>D&&D.errors.length===0?" Import Complete":f==="ready"?"Ready to Import":f==="mapping"?"Mapping Required":"Select a File",[f,D]),{monthRange:ee,recordTypeCounts:V}=A.useMemo(()=>{if(!p||p.length===0)return{monthRange:null,recordTypeCounts:{income:0,spend:0,allocations:0}};const q=new Set;let Y=1/0,J=-1/0,ne=12,re=1;const ge={income:0,spend:0,allocations:0};for(const Ce of p)q.add(`${Ce.year}-${Ce.month}`),(Ce.year<Y||Ce.year===Y&&Ce.month<ne)&&(Y=Ce.year,ne=Ce.month),(Ce.year>J||Ce.year===J&&Ce.month>re)&&(J=Ce.year,re=Ce.month),Ce.recordType==="income"?ge.income++:Ce.recordType==="spend"?ge.spend++:Ce.recordType==="allocation"&&ge.allocations++;const Ae=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pe=`${Ae[ne-1]} ${Y}`,ie=`${Ae[re-1]} ${J}`;return{monthRange:{start:pe,end:ie,count:q.size,isSingleMonth:q.size===1},recordTypeCounts:ge}},[p]);return u.jsxs(Ff,{title:" Seed Data Import",description:"Import historical data from a combined CSV file. The file should have a 'type' column (income, spend, or allocation) as the first column. Unknown categories and accounts will be mapped to existing ones.",status:Q,statusText:se,onRefresh:$,isRefreshing:!1,isBusy:O||R,cardName:"Seed Import",children:[R&&N&&u.jsx(O6,{progress:N}),u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500,fontSize:"0.9rem"},children:"CSV File"}),u.jsx("input",{ref:i,type:"file",accept:".csv",onChange:ue,disabled:t||O||R,style:{display:"block",width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",color:"inherit",cursor:t||O||R?"not-allowed":"pointer"}}),a&&u.jsxs("p",{style:{margin:"0.5rem 0 0",fontSize:"0.85rem",opacity:.7},children:["Selected: ",a.name]})]}),O&&u.jsxs(dn,{type:"running",children:[u.jsx(zf,{})," Parsing CSV file..."]}),p&&p.length>0&&!O&&u.jsx("div",{style:{marginBottom:"1rem"},children:u.jsx(dn,{type:j?"warning":"clean",children:u.jsxs("div",{children:[j?"":""," Parsed ",p.length," rows",u.jsxs("ul",{style:{margin:"0.5rem 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem"},children:[V.income>0&&u.jsxs("li",{children:[V.income," income"]}),V.spend>0&&u.jsxs("li",{children:[V.spend," spend"]}),V.allocations>0&&u.jsxs("li",{children:[V.allocations," allocations"]})]}),j&&u.jsx("span",{style:{display:"block",fontSize:"0.85rem",marginTop:"0.25rem"},children:"Some categories or accounts need to be mapped"})]})})}),(j||I)&&!O&&u.jsx(N6,{unmappedCategories:_,unmappedAccounts:b,customMappedCategories:v,customMappedAccounts:E,categoryMappings:C,accountMappings:w,categories:M,accounts:H,accountGroups:P,onCategoryMap:k,onAccountMap:X}),f==="ready"&&!O&&u.jsxs(qf,{onClick:F,disabled:t||!e,isBusy:R,busyText:"Importing...",actionName:"Run Seed Import",children:[" Import ",p?.length??0," Records"]}),D&&u.jsx(I6,{result:D}),u.jsx(ea,{isOpen:c,onClose:()=>h(!1),title:" Confirm Import",children:u.jsx(M6,{recordCount:p?.length??0,recordTypeCounts:V,monthRange:ee,onCancel:()=>h(!1),onConfirm:B})})]})}function L6({message:t,onDismiss:e}){return u.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:t}),u.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]})}function B6({message:t,onDismiss:e}){return u.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:t}),u.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]})}function V6({budgetIdInput:t,setBudgetIdInput:e,isCheckingManual:n,manualInvite:i,isAccepting:a,onCheckInvite:l,onAcceptInvite:c,onCancel:h}){return u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[u.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{children:""})," Join Budget by ID"]}),u.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),i?u.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[u.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[u.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:i.budgetName}),i.ownerEmail&&u.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",i.ownerEmail]})]}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[u.jsx("button",{onClick:c,disabled:a===i.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:a===i.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:a===i.budgetId?.7:1},children:a===i.budgetId?"Accepting...":"Accept Invitation"}),u.jsx("button",{onClick:h,disabled:a===i.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:a===i.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:a===i.budgetId?.7:.8},children:"Cancel"})]})]}):u.jsxs("form",{onSubmit:l,style:{display:"flex",gap:"0.75rem"},children:[u.jsx("input",{type:"text",value:t,onChange:f=>e(f.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),u.jsx("button",{type:"submit",disabled:n||!t.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:n||!t.trim()?"not-allowed":"pointer",fontWeight:500,opacity:n||!t.trim()?.7:1,whiteSpace:"nowrap"},children:n?"Checking...":"Check Invite"})]})]})}function U6({currentUserId:t}){return u.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[u.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),u.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:t})]})}function z6(){const{addLoadingHold:t,removeLoadingHold:e}=qn(),{selectedBudgetId:n,currentUserId:i,accessibleBudgets:a,loadAccessibleBudgets:l,switchToBudget:c,checkBudgetInvite:h,isInitialized:f,setPageTitle:p}=Pt();A.useLayoutEffect(()=>{p("My Budgets")},[p]),A.useEffect(()=>{f&&l()},[f,l]);const{budget:_,renameBudget:b,acceptInvite:v,isLoading:E}=Mn(n,i),[C,w]=A.useState(null),[D,N]=A.useState(null),[U,k]=A.useState(null),[X,G]=A.useState(null),[K,O]=A.useState(null),[R,j]=A.useState(""),[I,M]=A.useState(!1),[H,P]=A.useState(""),[ue,F]=A.useState(!1),[B,$]=A.useState(null);async function Q(re){if(re!==_?.id){w(re),k(null),G(null);try{await c(re),G("Switched to budget successfully!"),await l()}catch(ge){k(ge instanceof Error?ge.message:"Failed to switch budget")}finally{w(null)}}}async function se(re){N(re),k(null),G(null);try{await v(re),G("Invitation accepted! You now have access to this budget."),await l()}catch(ge){k(ge instanceof Error?ge.message:"Failed to accept invitation")}finally{N(null)}}async function ee(re){if(re.preventDefault(),!!H.trim()){F(!0),k(null),$(null);try{const ge=await h(H.trim());ge?$(ge):k("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(ge){k(ge instanceof Error?ge.message:"Failed to check invitation")}finally{F(!1)}}}async function V(){if(B){B.budgetName,N(B.budgetId),k(null);try{await v(B.budgetId),G(`Successfully joined "${B.budgetName}"!`),$(null),P(""),await l()}catch(re){k(re instanceof Error?re.message:"Failed to accept invitation")}finally{N(null)}}}function q(re,ge){j(ge),O(re)}async function Y(re){if(re.preventDefault(),!(!R.trim()||!K)){R.trim(),M(!0),k(null),G(null);try{await b(R.trim()),G("Budget renamed successfully!"),O(null),await l()}catch(ge){k(ge instanceof Error?ge.message:"Failed to rename budget")}finally{M(!1)}}}const J=a.filter(re=>!re.isPending),ne=a.filter(re=>re.isPending);return A.useEffect(()=>(E||!f?t("my-budgets","Loading your budgets..."):e("my-budgets"),()=>e("my-budgets")),[E,f,t,e]),E||!f?null:u.jsxs("div",{children:[u.jsx("h1",{children:"My Budgets"}),u.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Switch between budgets, accept invitations, or join a budget by ID."}),U&&u.jsx(L6,{message:U,onDismiss:()=>k(null)}),X&&u.jsx(B6,{message:X,onDismiss:()=>G(null)}),ne.length>0&&u.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[u.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{children:""})," Pending Invitations (",ne.length,")"]}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:ne.map(re=>u.jsx(aE,{budget:re,isCurrent:!1,isAccepting:D===re.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>se(re.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},re.id))})]}),u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[u.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{children:""})," Your Budgets (",J.length,")"]}),J.length===0?u.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:J.map(re=>u.jsx(aE,{budget:re,isCurrent:re.id===_?.id,isAccepting:!1,isSwitching:C===re.id,isEditing:K===re.id,editName:K===re.id?R:"",isRenaming:I,onAccept:()=>{},onSwitch:()=>Q(re.id),onStartEdit:()=>q(re.id,re.name),onCancelEdit:()=>{O(null),j("")},onEditNameChange:j,onSaveEdit:Y},re.id))})]}),u.jsx(V6,{budgetIdInput:H,setBudgetIdInput:P,isCheckingManual:ue,manualInvite:B,isAccepting:D,onCheckInvite:ee,onAcceptInvite:V,onCancel:()=>{$(null),P("")}}),i&&u.jsx(U6,{currentUserId:i})]})}const F6=["accounts","categories","users"];function q6(){const{addLoadingHold:t,removeLoadingHold:e}=qn(),{selectedBudgetId:n,currentUserId:i,lastSettingsTab:a,setLastSettingsTab:l,setPageTitle:c}=Pt();A.useLayoutEffect(()=>{c("Budget Settings")},[c]);const{isOwner:h,isLoading:f}=Mn(n,i);A.useEffect(()=>(f?t("settings","Loading settings..."):e("settings"),()=>e("settings")),[f,t,e]);const p=Tn(),_=p.pathname==="/budget/settings",b=A.useMemo(()=>{const D=p.pathname;return D.includes("/settings/accounts")?"accounts":D.includes("/settings/categories")?"categories":D.includes("/settings/users")?"users":"categories"},[p.pathname]),v=b==="users";A.useEffect(()=>{_||l(b)},[b,_,l]);function E(){return!F6.includes(a)||a==="users"&&!h?"categories":a}const C=A.useMemo(()=>[{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!h}],[h]);return f?null:!h&&v?u.jsxs("div",{children:[u.jsx("h1",{children:"Access Denied"}),u.jsx("p",{style:{opacity:.7},children:"Only the budget owner can access this section."}),u.jsx("p",{style:{marginTop:"1rem"},children:u.jsx(Tt,{to:"/budget/settings/categories",style:{color:"#646cff"},children:"Go to Categories "})})]}):u.jsxs("div",{children:[u.jsx(d_,{mode:"link",linkPrefix:"/budget/settings",tabs:C,activeTab:_?E():b}),_?u.jsx(af,{to:`/budget/settings/${E()}`,replace:!0}):u.jsx(LC,{children:u.jsx(of,{})})]})}function nf({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,accountGroups:a,showGroupSelector:l=!1,showIncomeSettings:c=!1,hasExistingIncomeDefault:h=!1,hasExistingOutgoDefault:f=!1,currentGroupId:p}){const[_,b]=A.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),v=_.account_group_id||p,E=v?a.find(k=>k.id===v):null,C=E?.is_active!==void 0,w=E?.on_budget!==void 0;function D(k){k.preventDefault(),_.nickname.trim()&&e(_)}function N(k){b({..._,is_income_account:k,is_income_default:k?_.is_income_default:!1})}function U(k){b({..._,is_outgo_account:k,is_outgo_default:k?_.is_outgo_default:!1})}return u.jsxs(Ka,{actionName:i==="Create Account"?"Create Account":"Update Account",onSubmit:D,children:[u.jsx(Wt,{label:"Account Nickname",htmlFor:"account-nickname",children:u.jsx(Ya,{id:"account-nickname",type:"text",value:_.nickname,onChange:k=>b({..._,nickname:k.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&u.jsx(Wt,{label:"Account Type",htmlFor:"account-group",children:u.jsxs(pu,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:k=>b({..._,account_group_id:k.target.value==="ungrouped"?null:k.target.value}),children:[u.jsx("option",{value:"ungrouped",children:"Ungrouped"}),a.map(k=>u.jsx("option",{value:k.id,children:k.name},k.id))]})}),c&&u.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[u.jsx(Os,{id:"is-active",checked:C?E.is_active:_.is_active!==!1,onChange:k=>b({..._,is_active:k.target.checked}),disabled:C,children:u.jsx("span",{style:{opacity:C?.5:1},children:"Active account"})}),C&&u.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:oe.warning},children:['Set by account type "',E.name,'"']})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[u.jsx(Os,{id:"on-budget",checked:w?E.on_budget:_.on_budget!==!1,onChange:k=>b({..._,on_budget:k.target.checked}),disabled:w,children:u.jsx("span",{style:{opacity:w?.5:1},children:"On budget (affects budget totals)"})}),w&&u.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:oe.warning},children:['Set by account type "',E.name,'"']})]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),u.jsx(Os,{id:"is-income-account",checked:_.is_income_account||!1,onChange:k=>N(k.target.checked),children:"Show in income deposit list"}),_.is_income_account&&u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[u.jsx(Os,{id:"is-income-default",checked:_.is_income_default||!1,onChange:k=>b({..._,is_income_default:k.target.checked}),disabled:h&&!t?.is_income_default,children:"Default account for new income"}),h&&!t?.is_income_default&&u.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),u.jsx(Os,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:k=>U(k.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[u.jsx(Os,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:k=>b({..._,is_outgo_default:k.target.checked}),disabled:f&&!t?.is_outgo_default,children:"Default account for new expenses"}),f&&!t?.is_outgo_default&&u.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),u.jsxs(so,{children:[u.jsx(Ie,{type:"submit",actionName:i,children:i}),u.jsx(Ie,{type:"button",variant:"secondary",actionName:"Cancel Account Form",onClick:n,children:"Cancel"})]})]})}function oE({label:t,value:e,onChange:n,trueLabel:i,falseLabel:a,undefinedLabel:l}){function c(){n(e===void 0?!0:e===!0?!1:void 0)}const h=e===!0?i:e===!1?a:l,f=e===!0?oe.success:e===!1?oe.warning:"inherit",p=e===!0?"":e===!1?"":"";return u.jsxs("button",{type:"button",onClick:c,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${f} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${f} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[u.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?f:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:p}),u.jsxs("span",{style:{flex:1},children:[u.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",u.jsx("span",{style:{fontWeight:500,color:f},children:h})]}),u.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function sT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=A.useState(t||{name:"",expected_balance:"positive"});function c(h){h.preventDefault(),a.name.trim()&&e(a)}return u.jsxs(Ka,{actionName:i==="Create Account Type"?"Create Account Type":"Update Account Type",onSubmit:c,children:[u.jsx(Wt,{label:"Account Type Name",htmlFor:"group-name",children:u.jsx(Ya,{id:"group-name",type:"text",value:a.name,onChange:h=>l({...a,name:h.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),u.jsx(Wt,{label:"Expected Balance",htmlFor:"expected-balance",children:u.jsxs(pu,{id:"expected-balance",value:a.expected_balance,onChange:h=>l({...a,expected_balance:h.target.value}),children:[u.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),u.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),u.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),u.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",u.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),u.jsx(oE,{label:"Active status",value:a.is_active,onChange:h=>l({...a,is_active:h}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),u.jsx(oE,{label:"Budget status",value:a.on_budget,onChange:h=>l({...a,on_budget:h}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),u.jsxs(so,{children:[u.jsx(Ie,{type:"submit",actionName:i,children:i}),u.jsx(Ie,{type:"button",variant:"secondary",actionName:"Cancel Account Type Form",onClick:n,children:"Cancel"})]})]})}function Jo({icon:t,label:e,variant:n,title:i}){const l={success:{background:`color-mix(in srgb, ${oe.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${oe.success} 40%, transparent)`,color:oe.success,opacity:1},warning:{background:`color-mix(in srgb, ${oe.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${oe.warning} 35%, transparent)`,color:oe.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${oe.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${oe.success} 25%, transparent)`,color:oe.success,opacity:.7},expense:{background:`color-mix(in srgb, ${oe.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${oe.warning} 25%, transparent)`,color:oe.warning,opacity:.7}}[n];return u.jsxs("span",{title:i||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[u.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function aT({account:t,accountGroups:e}){const n=[],i=t.account_group_id?e.find(c=>c.id===t.account_group_id):null,a=i?.is_active!==void 0?i.is_active:t.is_active!==!1,l=i?.on_budget!==void 0?i.on_budget:t.on_budget!==!1;if(!a){const c=i?.is_active!==void 0;n.push(u.jsx(Jo,{icon:"",label:c?"Inactive (type)":"Inactive",variant:"warning",title:c?`Set by "${i.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const c=i?.on_budget!==void 0;n.push(u.jsx(Jo,{icon:"",label:c?"Off Budget (type)":"Off Budget",variant:"warning",title:c?`Set by "${i.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(u.jsx(Jo,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(u.jsx(Jo,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(u.jsx(Jo,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(u.jsx(Jo,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:u.jsx(u.Fragment,{children:n})}function H6({group:t}){const e=[];return t.is_active===!1?e.push(u.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${oe.warning} 20%, transparent)`,color:oe.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(u.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${oe.success} 20%, transparent)`,color:oe.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(u.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${oe.warning} 20%, transparent)`,color:oe.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(u.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${oe.success} 20%, transparent)`,color:oe.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:u.jsx(u.Fragment,{children:e})}function oT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return u.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[u.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:oe.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&u.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function G6({group:t,accountCount:e,groupTotal:n,canMoveUp:i,canMoveDown:a,isMobile:l,createForGroupId:c,onEdit:h,onDelete:f,onMoveUp:p,onMoveDown:_,onAddAccount:b}){return u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[u.jsxs("h3",{style:{...Pf,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&u.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:t.name}),u.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),u.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:St(n),flexShrink:0,borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:Pe(n)}),u.jsx(H6,{group:t})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&u.jsx(Ie,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:b,disabled:c!==null,children:"+ Account"}),u.jsx("button",{onClick:()=>{t.name,h()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),u.jsx("button",{onClick:()=>{t.name,f()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),u.jsxs("div",{style:o_,children:[u.jsx("button",{onClick:p,disabled:!i,style:{...Sl,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),u.jsx("button",{onClick:_,disabled:!a,style:{...Sl,opacity:a?.6:.2,cursor:a?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function $6(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function Q6(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function W6({group:t,groupIndex:e,totalGroups:n,accounts:i,allGroups:a,allAccounts:l,editingAccountId:c,editingGroupId:h,createForGroupId:f,setEditingAccountId:p,setEditingGroupId:_,setCreateForGroupId:b,dragType:v,draggedId:E,dragOverId:C,dragOverGroupId:w,setDragOverId:D,setDragOverGroupId:N,onAccountDragStart:U,onAccountDragOver:k,onAccountDrop:X,onGroupDragStart:G,onGroupDragOver:K,onGroupDrop:O,onDragLeave:R,onDragLeaveGroup:j,onDragEnd:I,onDropOnGroup:M,onCreateAccount:H,onUpdateAccount:P,onDeleteAccount:ue,onMoveAccount:F,onUpdateGroup:B,onDeleteGroup:$,onMoveGroup:Q}){const se=aa(),ee=[...i].sort((ie,Ce)=>ie.sort_order-Ce.sort_order),V=v==="group"&&E===t.id,q=v==="group"&&C===t.id,Y=v==="account"&&w===t.id,ne=(E&&v==="account"?l[E]:null)&&Object.entries(l).find(([ie])=>ie===E)?.[1]&&Object.entries(l).find(([ie])=>ie===E)?.[1]?.account_group_id!==t.id,re=v==="group"&&q&&E!==t.id,ge=e>0,Ae=e<n-1,pe=ee.reduce((ie,Ce)=>ie+Ce.balance,0);return u.jsxs("div",{children:[v==="group"&&!V&&u.jsxs("div",{onDragOver:ie=>{ie.preventDefault(),D(t.id)},onDragLeave:R,onDrop:ie=>O(ie,t.id),style:{position:"relative",height:re?"2.5rem":"0.5rem",marginBottom:re?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[u.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:oe.primary,borderRadius:"2px",opacity:re?1:0,transition:"opacity 0.15s",boxShadow:re?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),re&&u.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),u.jsx("div",{draggable:h!==t.id,onDragStart:ie=>G(ie,t.id),onDragOver:ie=>K(ie,t.id),onDragLeave:j,onDragEnd:I,onDrop:ie=>M(ie,t.id),style:{background:V?"color-mix(in srgb, currentColor 3%, transparent)":Y&&ne?`color-mix(in srgb, ${oe.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:V?.5:1,border:Y&&ne?`2px dashed ${oe.primary}`:"2px solid transparent",cursor:h===t.id?"default":"grab",transition:"all 0.15s"},children:h===t.id?u.jsx(sT,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:ie=>B(t.id,ie),onCancel:()=>_(null),submitLabel:"Save"}):u.jsxs(u.Fragment,{children:[u.jsx(G6,{group:t,accountCount:ee.length,groupTotal:pe,canMoveUp:ge,canMoveDown:Ae,isMobile:se,createForGroupId:f,onEdit:()=>_(t.id),onDelete:()=>$(t.id),onMoveUp:()=>Q(t.id,"up"),onMoveDown:()=>Q(t.id,"down"),onAddAccount:()=>b(t.id)}),se&&u.jsx("div",{style:{marginBottom:"0.5rem"},children:u.jsx(Ie,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:()=>b(t.id),disabled:f!==null,children:"+ Account"})}),u.jsxs("div",{style:El,children:[ee.map((ie,Ce)=>c===ie.id?u.jsx(nf,{initialData:{nickname:ie.nickname,account_group_id:ie.account_group_id,is_income_account:ie.is_income_account,is_income_default:ie.is_income_default,is_outgo_account:ie.is_outgo_account,is_outgo_default:ie.is_outgo_default,on_budget:ie.on_budget,is_active:ie.is_active},onSubmit:Oe=>P(ie.id,Oe),onCancel:()=>p(null),submitLabel:"Save",accountGroups:a,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:ie.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([Oe,yt])=>yt.is_income_default&&Oe!==ie.id),hasExistingOutgoDefault:Object.entries(l).some(([Oe,yt])=>yt.is_outgo_default&&Oe!==ie.id)},ie.id):u.jsx(Lf,{isDragging:v==="account"&&E===ie.id,isDragOver:C===ie.id,onDragStart:Oe=>{Oe.stopPropagation(),U(Oe,ie.id)},onDragOver:Oe=>k(Oe,ie.id,t.id),onDragLeave:R,onDragEnd:I,onDrop:Oe=>X(Oe,ie.id,t.id),onEdit:()=>{ie.nickname,p(ie.id)},onDelete:()=>{ie.nickname,ue(ie.id)},onMoveUp:()=>F(ie.id,"up"),onMoveDown:()=>F(ie.id,"down"),canMoveUp:Ce>0,canMoveDown:Ce<ee.length-1,children:u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[u.jsx("span",{style:l_,children:ie.nickname}),u.jsx(aT,{account:ie,accountGroups:a})]}),u.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:St(ie.balance)},children:[Pe(ie.balance),$6(ie.balance,t.expected_balance)&&u.jsx("span",{title:Q6(ie.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},ie.id)),ee.length===0&&!f&&u.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),v==="account"&&ee.length>0&&u.jsx(oT,{groupId:t.id,isActive:C===`__end__${t.id}`,onDragOver:ie=>{ie.preventDefault(),ie.stopPropagation(),D(`__end__${t.id}`),N(t.id)},onDragLeave:ie=>{ie.stopPropagation(),D(null)},onDrop:ie=>{ie.stopPropagation(),X(ie,"__group_end__",t.id)}}),f===t.id&&u.jsx(nf,{initialData:{nickname:"",account_group_id:t.id},onSubmit:ie=>H(ie,t.id),onCancel:()=>b(null),submitLabel:"Create",accountGroups:a,showIncomeSettings:!0,currentGroupId:t.id})]}),f!==t.id&&u.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:u.jsx(Ie,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:()=>b(t.id),disabled:f!==null,children:"+ Add Account"})})]})})]})}function K6({accounts:t,allGroups:e,allAccounts:n,hasGroups:i,editingAccountId:a,createForGroupId:l,setEditingAccountId:c,setCreateForGroupId:h,dragType:f,draggedId:p,dragOverId:_,dragOverGroupId:b,setDragOverId:v,setDragOverGroupId:E,onAccountDragStart:C,onAccountDragOver:w,onAccountDrop:D,onDragOverGroup:N,onDropOnGroup:U,onDragLeave:k,onDragLeaveGroup:X,onDragEnd:G,onCreateAccount:K,onUpdateAccount:O,onDeleteAccount:R,onMoveAccount:j}){const I=[...t].sort((F,B)=>F.sort_order-B.sort_order),M=f==="account"&&b==="ungrouped",P=(p&&f==="account"?n[p]:null)&&Object.entries(n).find(([F])=>F===p)?.[1]&&Object.entries(n).find(([F])=>F===p)?.[1]?.account_group_id!==null;if(I.length===0&&!l&&i&&f!=="account")return null;const ue=I.reduce((F,B)=>F+B.balance,0);return u.jsxs("div",{onDragOver:F=>N(F,"ungrouped"),onDragLeave:X,onDrop:F=>U(F,"ungrouped"),style:{background:M&&P?`color-mix(in srgb, ${oe.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:M&&P?`2px dashed ${oe.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[u.jsxs("h3",{style:{...Pf,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{style:{borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:"Ungrouped"}),u.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",I.length,")"]}),I.length>0&&u.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:St(ue),borderBottom:"2px solid currentColor",paddingBottom:"2px"},children:Pe(ue)})]}),u.jsx(Ie,{variant:"small",actionName:"Open Add Account Form (Ungrouped)",onClick:()=>h("ungrouped"),disabled:l!==null,children:"+ Account"})]}),u.jsxs("div",{style:El,children:[I.map((F,B)=>a===F.id?u.jsx(nf,{initialData:{nickname:F.nickname,account_group_id:F.account_group_id,is_income_account:F.is_income_account,is_income_default:F.is_income_default,is_outgo_account:F.is_outgo_account,is_outgo_default:F.is_outgo_default,on_budget:F.on_budget,is_active:F.is_active},onSubmit:$=>O(F.id,$),onCancel:()=>c(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([$,Q])=>Q.is_income_default&&$!==F.id),hasExistingOutgoDefault:Object.entries(n).some(([$,Q])=>Q.is_outgo_default&&$!==F.id)},F.id):u.jsx(Lf,{isDragging:f==="account"&&p===F.id,isDragOver:_===F.id,onDragStart:$=>C($,F.id),onDragOver:$=>w($,F.id,"ungrouped"),onDragLeave:k,onDragEnd:G,onDrop:$=>D($,F.id,"ungrouped"),onEdit:()=>{F.nickname,c(F.id)},onDelete:()=>{F.nickname,R(F.id)},onMoveUp:()=>j(F.id,"up"),onMoveDown:()=>j(F.id,"down"),canMoveUp:B>0,canMoveDown:B<I.length-1,children:u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[u.jsx("span",{style:l_,children:F.nickname}),u.jsx(aT,{account:F,accountGroups:e})]}),u.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:St(F.balance)},children:Pe(F.balance)})]})},F.id)),I.length===0&&f==="account"&&u.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),f==="account"&&I.length>0&&u.jsx(oT,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:F=>{F.preventDefault(),F.stopPropagation(),v("__end__ungrouped"),E("ungrouped")},onDragLeave:F=>{F.stopPropagation(),v(null)},onDrop:F=>{F.stopPropagation(),D(F,"__group_end__","ungrouped")}}),l==="ungrouped"&&u.jsx(nf,{initialData:{nickname:"",account_group_id:null},onSubmit:F=>K(F,"ungrouped"),onCancel:()=>h(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&u.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:u.jsx(Ie,{variant:"small",actionName:"Open Add Account Form (Ungrouped)",onClick:()=>h("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function Y6(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:i,error:a,setError:l,handleCreateAccount:c,handleUpdateAccount:h,handleDeleteAccount:f,handleMoveAccount:p,handleCreateGroup:_,handleUpdateGroup:b,handleDeleteGroup:v,handleMoveGroup:E,reorderAccountsInGroup:C,reorderGroups:w}=aL(),D=aa(),[N,U]=A.useState(null),[k,X]=A.useState(null),[G,K]=A.useState(null),[O,R]=A.useState(!1),[j,I]=A.useState(null),[M,H]=A.useState(null),[P,ue]=A.useState(null),[F,B]=A.useState(null);function $(pe,ie){I("account"),H(ie),pe.dataTransfer.effectAllowed="move"}function Q(pe,ie,Ce){pe.preventDefault(),j==="account"&&(ie!==M&&ue(ie),B(Ce))}function se(pe,ie){pe.preventDefault(),j==="account"?(B(ie),ue(null)):j==="group"&&ie!==M&&ue(ie)}function ee(){ue(null)}function V(){B(null)}function q(){I(null),H(null),ue(null),B(null)}async function Y(pe,ie,Ce){if(pe.preventDefault(),pe.stopPropagation(),!M||j!=="account"){q();return}await C(M,ie,Ce),q()}async function J(pe,ie){pe.preventDefault(),j==="account"?await Y(pe,"__group_end__",ie):j==="group"&&await re(pe,ie)}function ne(pe,ie){pe.stopPropagation(),I("group"),H(ie),pe.dataTransfer.effectAllowed="move"}async function re(pe,ie){if(pe.preventDefault(),!M||j!=="group"||M===ie){q();return}await w(M,ie),q()}const ge=A.useMemo(()=>{const pe=Object.values(t),ie=pe.reduce((yt,Se)=>yt+(Se.balance??0),0);let Ce=0,Oe=0;for(const yt of pe){const Se=n.find(Jt=>Jt.id===yt.account_group_id);yt.on_budget===!0||yt.on_budget===void 0&&Se?.on_budget!==!1?Ce+=yt.balance??0:Oe+=yt.balance??0}return{count:pe.length,groupCount:n.length,totalBalance:ie,onBudgetTotal:Ce,offBudgetTotal:Oe}},[t,n]);if(!i)return u.jsx("p",{children:"No budget found. Please log in."});const Ae=e.ungrouped||[];return u.jsxs("div",{children:[a&&u.jsx(io,{message:a,onDismiss:()=>l(null)}),u.jsx("div",{style:{position:"sticky",top:0,zIndex:50,backgroundColor:"#242424",marginLeft:"calc(-1 * var(--page-padding, 2rem))",marginRight:"calc(-1 * var(--page-padding, 2rem))",paddingLeft:"var(--page-padding, 2rem)",paddingRight:"var(--page-padding, 2rem)",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"1px solid rgba(255,255,255,0.15)"},children:u.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem"},children:[u.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[u.jsx("span",{style:{fontWeight:600},children:"Accounts:"}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"On-Budget: "}),u.jsx("span",{style:{color:St(ge.onBudgetTotal),fontWeight:600},children:Pe(ge.onBudgetTotal)})]}),ge.offBudgetTotal!==0&&u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"Off-Budget: "}),u.jsx("span",{style:{fontWeight:600,opacity:.7},children:Pe(ge.offBudgetTotal)})]}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"Total: "}),u.jsx("span",{style:{color:St(ge.totalBalance),fontWeight:600},children:Pe(ge.totalBalance)})]}),u.jsx("span",{style:{opacity:.5,fontSize:"0.8rem"},children:D?"Drag to move.":"Drag between types or use  to reorder."})]}),u.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:u.jsx(f_,{})})]})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem",paddingTop:"1rem"},children:[Object.keys(t).length===0&&n.length===0&&u.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((pe,ie)=>u.jsx(W6,{group:pe,groupIndex:ie,totalGroups:n.length,accounts:e[pe.id]||[],allGroups:n,allAccounts:t,editingAccountId:N,editingGroupId:G,createForGroupId:k,setEditingAccountId:U,setEditingGroupId:K,setCreateForGroupId:X,dragType:j,draggedId:M,dragOverId:P,dragOverGroupId:F,setDragOverId:ue,setDragOverGroupId:B,onAccountDragStart:$,onAccountDragOver:Q,onAccountDrop:Y,onGroupDragStart:ne,onGroupDragOver:se,onGroupDrop:re,onDragLeave:ee,onDragLeaveGroup:V,onDragEnd:q,onDropOnGroup:J,onCreateAccount:c,onUpdateAccount:(Ce,Oe)=>{h(Ce,Oe),U(null)},onDeleteAccount:f,onMoveAccount:p,onUpdateGroup:(Ce,Oe)=>{b(Ce,Oe),K(null)},onDeleteGroup:v,onMoveGroup:E},pe.id)),j==="group"&&n.length>0&&u.jsx(u_,{isActive:P==="__end__",onDragOver:pe=>{pe.preventDefault(),ue("__end__")},onDragLeave:ee,onDrop:pe=>re(pe,"__end__"),label:"Move account type to end"}),u.jsx(K6,{accounts:Ae,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:N,createForGroupId:k,setEditingAccountId:U,setCreateForGroupId:X,dragType:j,draggedId:M,dragOverId:P,dragOverGroupId:F,setDragOverId:ue,setDragOverGroupId:B,onAccountDragStart:$,onAccountDragOver:Q,onAccountDrop:Y,onDragOverGroup:se,onDropOnGroup:J,onDragLeave:ee,onDragLeaveGroup:V,onDragEnd:q,onCreateAccount:c,onUpdateAccount:(pe,ie)=>{h(pe,ie),U(null)},onDeleteAccount:f,onMoveAccount:p})]}),O?u.jsx(sT,{onSubmit:pe=>{_(pe),R(!1)},onCancel:()=>R(!1),submitLabel:"Create Account Type"}):u.jsx(Ie,{variant:"primary-large",actionName:"Open Add Account Type Form",onClick:()=>R(!0),children:"+ Add Account Type"})]})}function rf({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,categoryGroups:a=[],showGroupSelector:l=!1}){const[c,h]=A.useState(t||{name:"",category_group_id:null}),[f,p]=A.useState(t?.default_monthly_amount?.toString()||""),[_,b]=A.useState(t?.default_monthly_type||"fixed"),[v,E]=A.useState(!1);function C(w){if(w.preventDefault(),!c.name.trim())return;E(!0);const D=parseFloat(f),N=!isNaN(D)&&D>0;e({...c,description:c.description?.trim()||void 0,default_monthly_amount:N?D:void 0,default_monthly_type:N?_:void 0})}return u.jsxs(Ka,{actionName:i==="Create"?"Create Category":"Update Category",onSubmit:C,children:[u.jsx(Wt,{label:"Category Name",htmlFor:"category-name",children:u.jsx(Ya,{id:"category-name",type:"text",value:c.name,onChange:w=>h({...c,name:w.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),u.jsx(Wt,{label:"Description (optional)",htmlFor:"category-description",children:u.jsx(c_,{id:"category-description",value:c.description||"",onChange:w=>h({...c,description:w.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&u.jsx(Wt,{label:"Category Group",htmlFor:"category-group",children:u.jsxs(pu,{id:"category-group",value:c.category_group_id||"ungrouped",onChange:w=>h({...c,category_group_id:w.target.value==="ungrouped"?null:w.target.value}),children:[u.jsx("option",{value:"ungrouped",children:"Uncategorized"}),a.map(w=>u.jsx("option",{value:w.id,children:w.name},w.id))]})}),u.jsxs(Wt,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[u.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[u.jsxs(pu,{id:"default-type",value:_,onChange:w=>b(w.target.value),style:{width:"auto",flex:"0 0 auto"},children:[u.jsx("option",{value:"fixed",children:"Fixed $"}),u.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?u.jsx(Zg,{id:"default-amount",value:f,onChange:p,placeholder:"$0.00"}):u.jsx(Ya,{id:"default-amount",type:"number",value:f,onChange:w=>p(w.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&u.jsx("span",{style:{opacity:.6},children:"%"})]}),u.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),u.jsxs(so,{children:[u.jsx(Ie,{type:"submit",actionName:i==="Create"?"Create Category":"Save Category",isLoading:v,children:i}),u.jsx(Ie,{type:"button",variant:"secondary",actionName:"Cancel Category Form",onClick:n,children:"Cancel"})]})]})}function lT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=A.useState(t||{name:""}),[c,h]=A.useState(!1);function f(p){p.preventDefault(),a.name.trim()&&(h(!0),e(a))}return u.jsxs(Ka,{actionName:i==="Create Group"?"Create Category Group":"Update Category Group",onSubmit:f,children:[u.jsx(Wt,{label:"Group Name",htmlFor:"group-name",children:u.jsx(Ya,{id:"group-name",type:"text",value:a.name,onChange:p=>l({...a,name:p.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),u.jsxs(so,{children:[u.jsx(Ie,{type:"submit",actionName:i==="Create Group"?"Create Category Group":"Save Category Group",isLoading:c,children:i}),u.jsx(Ie,{type:"button",variant:"secondary",actionName:"Cancel Category Group Form",onClick:n,children:"Cancel"})]})]})}function cT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return u.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[u.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:oe.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&u.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function uT({category:t,catId:e,categoryBalances:n,loadingBalances:i}){const a=n[e]||{current:0,total:0};return u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[u.jsx("span",{style:l_,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&u.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?u.jsxs(u.Fragment,{children:[u.jsxs("span",{style:{color:oe.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{style:{color:oe.success,fontWeight:500},children:Pe(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&u.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),u.jsxs("div",{style:{marginTop:"0.25rem"},children:[u.jsxs("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:In(a.current)},children:[i?"...":jn(a.current),u.jsx("span",{style:{fontSize:"0.75rem",fontWeight:400,opacity:.6,marginLeft:"0.35rem"},children:"available now"})]}),u.jsxs("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.85rem",fontWeight:500,color:In(a.total),opacity:.75},children:[i?"...":jn(a.total),u.jsx("span",{style:{fontSize:"0.7rem",fontWeight:400,opacity:.7,marginLeft:"0.35rem"},children:"total allocated"})]})]})]})}function X6({group:t,categoryCount:e,canMoveUp:n,canMoveDown:i,isMobile:a,createForGroupId:l,onEdit:c,onDelete:h,onMoveUp:f,onMoveDown:p,onAddCategory:_,onDragStart:b,onDragEnd:v}){return u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:a?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:a?"wrap":"nowrap"},children:[u.jsxs("h3",{style:{...Pf,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!a&&u.jsx("span",{draggable:!0,onDragStart:b,onDragEnd:v,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),u.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),u.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!a&&u.jsx(Ie,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:_,disabled:l!==null,children:"+ Category"}),u.jsx("button",{onClick:()=>{t.name,c()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),u.jsx("button",{onClick:()=>{t.name,h()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),u.jsxs("div",{style:o_,children:[u.jsx("button",{onClick:f,disabled:!n,style:{...Sl,opacity:n?.6:.2,cursor:n?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),u.jsx("button",{onClick:p,disabled:!i,style:{...Sl,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]})}function J6({group:t,groupIndex:e,groupCategories:n,sortedGroups:i,categoryGroups:a,categoryBalances:l,loadingBalances:c,dragType:h,draggedId:f,dragOverId:p,dragOverGroupId:_,editingCategoryId:b,setEditingCategoryId:v,createForGroupId:E,setCreateForGroupId:C,editingGroupId:w,setEditingGroupId:D,handleCreateCategory:N,handleUpdateCategory:U,handleDeleteCategory:k,handleMoveCategory:X,handleUpdateGroup:G,handleDeleteGroup:K,handleMoveGroup:O,handleCategoryDragStart:R,handleCategoryDragOver:j,handleDragOverGroup:I,handleDragLeave:M,handleDragLeaveGroup:H,handleDragEnd:P,handleCategoryDrop:ue,handleDropOnGroup:F,handleGroupDragStart:B,handleGroupDrop:$,setDragOverId:Q,setDragOverGroupId:se,isMobile:ee,categories:V}){const q=h==="group"&&f===t.id,Y=h==="group"&&p===t.id,J=h==="category"&&_===t.id,ne=f&&h==="category"?V[f]:null,re=ne&&(ne.category_group_id||"ungrouped")!==t.id,ge=h==="group"&&Y&&f!==t.id,Ae=e>0,pe=e<i.length-1;return u.jsxs("div",{children:[h==="group"&&!q&&u.jsxs("div",{onDragOver:ie=>{ie.preventDefault(),Q(t.id)},onDragLeave:M,onDrop:ie=>$(ie,t.id),style:{position:"relative",height:ge?"2.5rem":"0.5rem",marginBottom:ge?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[u.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:oe.primary,borderRadius:"2px",opacity:ge?1:0,transition:"opacity 0.15s",boxShadow:ge?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),ge&&u.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),u.jsx("div",{onDragOver:ie=>I(ie,t.id),onDragLeave:H,onDrop:ie=>F(ie,t.id),style:{background:q?"color-mix(in srgb, currentColor 3%, transparent)":J&&re?`color-mix(in srgb, ${oe.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:q?.5:1,border:J&&re?`2px dashed ${oe.primary}`:"2px solid transparent",transition:"all 0.15s"},children:w===t.id?u.jsx(lT,{initialData:{name:t.name},onSubmit:ie=>G(t.id,ie),onCancel:()=>D(null),submitLabel:"Save"}):u.jsxs(u.Fragment,{children:[u.jsx(X6,{group:t,categoryCount:n.length,canMoveUp:Ae,canMoveDown:pe,isMobile:ee,createForGroupId:E,onEdit:()=>D(t.id),onDelete:()=>K(t.id),onMoveUp:()=>O(t.id,"up"),onMoveDown:()=>O(t.id,"down"),onAddCategory:()=>C(t.id),onDragStart:ie=>B(ie,t.id),onDragEnd:P}),ee&&u.jsx("div",{style:{marginBottom:"0.5rem"},children:u.jsx(Ie,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>C(t.id),disabled:E!==null,children:"+ Category"})}),u.jsxs("div",{style:El,children:[n.map(([ie,Ce])=>b===ie?u.jsx(rf,{initialData:{name:Ce.name,description:Ce.description,category_group_id:Ce.category_group_id,default_monthly_amount:Ce.default_monthly_amount,default_monthly_type:Ce.default_monthly_type},onSubmit:Oe=>U(ie,Oe),onCancel:()=>v(null),submitLabel:"Save",categoryGroups:a,showGroupSelector:!0},ie):u.jsx(Lf,{isDragging:h==="category"&&f===ie,isDragOver:p===ie,onDragStart:Oe=>{Oe.stopPropagation(),R(Oe,ie)},onDragOver:Oe=>j(Oe,ie,t.id),onDragLeave:M,onDragEnd:P,onDrop:Oe=>ue(Oe,ie,t.id),onEdit:()=>{Ce.name,v(ie)},onDelete:()=>{Ce.name,k(ie)},onMoveUp:()=>X(ie,"up"),onMoveDown:()=>X(ie,"down"),canMoveUp:n.findIndex(([Oe])=>Oe===ie)>0,canMoveDown:n.findIndex(([Oe])=>Oe===ie)<n.length-1,children:u.jsx(uT,{category:Ce,catId:ie,categoryBalances:l,loadingBalances:c})},ie)),n.length===0&&!E&&u.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),h==="category"&&n.length>0&&u.jsx(cT,{groupId:t.id,isActive:p===`__end__${t.id}`,onDragOver:ie=>{ie.preventDefault(),ie.stopPropagation(),Q(`__end__${t.id}`),se(t.id)},onDragLeave:ie=>{ie.stopPropagation(),Q(null)},onDrop:ie=>{ie.stopPropagation(),ue(ie,"__group_end__",t.id)}}),E===t.id&&u.jsx(rf,{initialData:{name:"",category_group_id:t.id},onSubmit:ie=>N(ie,t.id),onCancel:()=>C(null),submitLabel:"Create",categoryGroups:a})]}),E!==t.id&&u.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:u.jsx(Ie,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>C(t.id),disabled:E!==null,children:"+ Add Category"})})]})})]})}function Z6({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:i,dragType:a,draggedId:l,dragOverId:c,dragOverGroupId:h,editingCategoryId:f,setEditingCategoryId:p,createForGroupId:_,setCreateForGroupId:b,handleCreateCategory:v,handleUpdateCategory:E,handleDeleteCategory:C,handleMoveCategory:w,handleCategoryDragStart:D,handleCategoryDragOver:N,handleDragOverGroup:U,handleDragLeaveGroup:k,handleDragLeave:X,handleDragEnd:G,handleCategoryDrop:K,handleDropOnGroup:O,setDragOverId:R,setDragOverGroupId:j,categories:I,hasGroups:M}){const H=a==="category"&&h==="ungrouped",P=l&&a==="category"?I[l]:null,ue=P&&P.category_group_id!==null;return t.length===0&&!_&&M&&a!=="category"?null:u.jsxs("div",{onDragOver:F=>U(F,"ungrouped"),onDragLeave:k,onDrop:F=>O(F,"ungrouped"),style:{background:H&&ue?`color-mix(in srgb, ${oe.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:H&&ue?`2px dashed ${oe.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[u.jsxs("h3",{style:{...Pf,margin:0,opacity:.7},children:["Uncategorized",u.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),u.jsx(Ie,{variant:"small",actionName:"Open Add Category Form (Uncategorized)",onClick:()=>b("ungrouped"),disabled:_!==null,children:"+ Category"})]}),u.jsxs("div",{style:El,children:[t.map(([F,B])=>f===F?u.jsx(rf,{initialData:{name:B.name,description:B.description,category_group_id:B.category_group_id,default_monthly_amount:B.default_monthly_amount,default_monthly_type:B.default_monthly_type},onSubmit:$=>E(F,$),onCancel:()=>p(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},F):u.jsx(Lf,{isDragging:a==="category"&&l===F,isDragOver:c===F,onDragStart:$=>D($,F),onDragOver:$=>N($,F,"ungrouped"),onDragLeave:X,onDragEnd:G,onDrop:$=>K($,F,"ungrouped"),onEdit:()=>{B.name,p(F)},onDelete:()=>{B.name,C(F)},onMoveUp:()=>w(F,"up"),onMoveDown:()=>w(F,"down"),canMoveUp:t.findIndex(([$])=>$===F)>0,canMoveDown:t.findIndex(([$])=>$===F)<t.length-1,children:u.jsx(uT,{category:B,catId:F,categoryBalances:n,loadingBalances:i})},F)),t.length===0&&a==="category"&&u.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),a==="category"&&t.length>0&&u.jsx(cT,{groupId:"ungrouped",isActive:c==="__end__ungrouped",onDragOver:F=>{F.preventDefault(),F.stopPropagation(),R("__end__ungrouped"),j("ungrouped")},onDragLeave:F=>{F.stopPropagation(),R(null)},onDrop:F=>{F.stopPropagation(),K(F,"__group_end__","ungrouped")}}),_==="ungrouped"&&u.jsx(rf,{initialData:{name:"",category_group_id:null},onSubmit:F=>v(F,"ungrouped"),onCancel:()=>b(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&u.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:u.jsx(Ie,{variant:"small",actionName:"Open Add Category Form (Uncategorized)",onClick:()=>b("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function e3(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:i,sortedGroups:a,categoryBalances:l,isLoading:c,loadingBalances:h,error:f,setError:p,getOnBudgetTotal:_,handleCreateCategory:b,handleUpdateCategory:v,handleDeleteCategory:E,handleMoveCategory:C,handleCreateGroup:w,handleUpdateGroup:D,handleDeleteGroup:N,handleMoveGroup:U,dragType:k,draggedId:X,dragOverId:G,dragOverGroupId:K,setDragOverId:O,setDragOverGroupId:R,handleCategoryDragStart:j,handleCategoryDragOver:I,handleDragOverGroup:M,handleDragLeave:H,handleDragLeaveGroup:P,handleDragEnd:ue,handleCategoryDrop:F,handleDropOnGroup:B,handleGroupDragStart:$,handleGroupDrop:Q}=uL(),se=aa(),{addLoadingHold:ee,removeLoadingHold:V}=qn();A.useEffect(()=>(c?ee("categories","Loading categories..."):V("categories"),()=>V("categories")),[c,ee,V]);const[q,Y]=A.useState(null),[J,ne]=A.useState(null),[re,ge]=A.useState(null),[Ae,pe]=A.useState(!1);if(!t)return u.jsx("p",{children:"No budget found. Please log in."});const ie=Object.values(l).reduce((Se,ke)=>Se+ke.current,0),Ce=Object.values(l).reduce((Se,ke)=>Se+ke.total,0),Oe=_()-ie,yt=Math.abs(Ce-ie)>.01;return c?null:u.jsxs("div",{children:[f&&u.jsx(io,{message:f,onDismiss:()=>p(null)}),u.jsx("div",{style:{position:"sticky",top:0,zIndex:50,backgroundColor:"#242424",marginLeft:"calc(-1 * var(--page-padding, 2rem))",marginRight:"calc(-1 * var(--page-padding, 2rem))",paddingLeft:"var(--page-padding, 2rem)",paddingRight:"var(--page-padding, 2rem)",paddingTop:"0.5rem",paddingBottom:"0.5rem",borderBottom:"1px solid rgba(255,255,255,0.15)"},children:u.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",gap:"0.5rem 1rem",fontSize:"0.85rem"},children:[u.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem 1rem",flex:1,alignItems:"center"},children:[u.jsx("span",{style:{fontWeight:600},children:"Categories:"}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"On-Budget: "}),u.jsx("span",{style:{color:St(_()),fontWeight:600},children:Pe(_())})]}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"Allocated: "}),u.jsx("span",{style:{color:oe.primary,fontWeight:600},children:h?"...":Pe(ie)}),yt&&u.jsxs("span",{style:{opacity:.5,fontSize:"0.8rem"},children:[" (",Pe(Ce)," total)"]})]}),u.jsxs("span",{children:[u.jsx("span",{style:{opacity:.6},children:"Available: "}),u.jsx("span",{style:{color:St(Oe),fontWeight:600},children:h?"...":Pe(Oe)})]}),u.jsx("span",{style:{opacity:.6},children:se?"Drag to move between groups.":"Drag categories between groups, or use  to reorder."})]}),u.jsx("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0},children:u.jsx(f_,{})})]})}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem",paddingTop:"1rem"},children:[Object.keys(e).length===0&&n.length===0&&u.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),a.map((Se,ke)=>{const Jt=(i[Se.id]||[]).sort((Er,bi)=>Er[1].sort_order-bi[1].sort_order);return u.jsx(J6,{group:Se,groupIndex:ke,groupCategories:Jt,sortedGroups:a,categoryGroups:n,categoryBalances:l,loadingBalances:h,dragType:k,draggedId:X,dragOverId:G,dragOverGroupId:K,editingCategoryId:q,setEditingCategoryId:Y,createForGroupId:J,setCreateForGroupId:ne,editingGroupId:re,setEditingGroupId:ge,handleCreateCategory:b,handleUpdateCategory:v,handleDeleteCategory:E,handleMoveCategory:C,handleUpdateGroup:D,handleDeleteGroup:N,handleMoveGroup:U,handleCategoryDragStart:j,handleCategoryDragOver:I,handleDragOverGroup:M,handleDragLeave:H,handleDragLeaveGroup:P,handleDragEnd:ue,handleCategoryDrop:F,handleDropOnGroup:B,handleGroupDragStart:$,handleGroupDrop:Q,setDragOverId:O,setDragOverGroupId:R,isMobile:se,categories:e},Se.id)}),k==="group"&&a.length>0&&u.jsx(u_,{isActive:G==="__end__",onDragOver:Se=>{Se.preventDefault(),O("__end__")},onDragLeave:H,onDrop:Se=>Q(Se,"__end__"),label:"Move group to end"}),u.jsx(Z6,{ungroupedCategories:(i.ungrouped||[]).sort((Se,ke)=>Se[1].sort_order-ke[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:h,dragType:k,draggedId:X,dragOverId:G,dragOverGroupId:K,editingCategoryId:q,setEditingCategoryId:Y,createForGroupId:J,setCreateForGroupId:ne,handleCreateCategory:b,handleUpdateCategory:v,handleDeleteCategory:E,handleMoveCategory:C,handleCategoryDragStart:j,handleCategoryDragOver:I,handleDragOverGroup:M,handleDragLeaveGroup:P,handleDragLeave:H,handleDragEnd:ue,handleCategoryDrop:F,handleDropOnGroup:B,setDragOverId:O,setDragOverGroupId:R,categories:e,hasGroups:n.length>0})]}),Ae?u.jsx(lT,{onSubmit:Se=>{w(Se),pe(!1)},onCancel:()=>pe(!1),submitLabel:"Create Group"}):u.jsx(Ie,{variant:"primary-large",actionName:"Open Add Category Group Form",onClick:()=>pe(!0),children:"+ Add Category Group"})]})}function t3(){const{selectedBudgetId:t,currentUserId:e}=Pt(),{budget:n,budgetUserIds:i,acceptedUserIds:a,inviteUser:l,revokeUser:c}=Mn(t,e),[h,f]=A.useState(""),[p,_]=A.useState(!1),[b,v]=A.useState(null),[E,C]=A.useState(null);if(!n)return u.jsx("p",{children:"No budget found."});async function w(k){if(k.preventDefault(),!(!h.trim()||!n)){_(!0),v(null),C(null);try{await l(h.trim()),f(""),C("Invite sent! The user can now accept the invitation from their account.")}catch(X){v(X instanceof Error?X.message:"Failed to invite user")}finally{_(!1)}}}async function D(k){if(!n)return;if(k===n.owner_id){v("Cannot revoke the budget owner");return}if(k===e){v("Cannot revoke yourself from the budget");return}const X=a.includes(k);if(confirm(X?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){v(null),C(null);try{await c(k),C(X?"User access revoked.":"Invitation cancelled.")}catch(K){v(K instanceof Error?K.message:"Failed to revoke user")}}}const N=i.filter(k=>a.includes(k)),U=i.filter(k=>!a.includes(k));return u.jsxs("div",{children:[u.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),u.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),b&&u.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:b}),u.jsx("button",{onClick:()=>v(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),E&&u.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("span",{children:E}),u.jsx("button",{onClick:()=>C(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[u.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",N.length,")"]}),N.length===0?u.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:N.map(k=>{const X=k===n.owner_id,G=k===e;return u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[u.jsx("div",{style:{flex:1,minWidth:0},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[u.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:k}),X&&u.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),G&&u.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!X&&!G&&u.jsx("button",{onClick:()=>D(k),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},k)})})]}),U.length>0&&u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[u.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",U.length,")"]}),u.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:U.map(k=>u.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[u.jsx("div",{style:{flex:1,minWidth:0},children:u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[u.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:k}),u.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),u.jsx("button",{onClick:()=>D(k),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},k))})]}),u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[u.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),u.jsxs("form",{onSubmit:w,style:{display:"flex",gap:"0.75rem"},children:[u.jsx("input",{type:"text",value:h,onChange:k=>f(k.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),u.jsx("button",{type:"submit",disabled:p||!h.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:p||!h.trim()?"not-allowed":"pointer",fontWeight:500,opacity:p||!h.trim()?.7:1,whiteSpace:"nowrap"},children:p?"Inviting...":"Send Invite"})]}),u.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),u.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}const n3=["budget","feedback","migration","tests"];function r3(){const{isAdmin:t,isTest:e,lastAdminTab:n,setLastAdminTab:i,setPageTitle:a}=Pt();A.useLayoutEffect(()=>{a("Budget Admin")},[a]);const l=Tn(),c=l.pathname==="/budget/admin",h=A.useMemo(()=>{const b=l.pathname;return b.includes("/admin/budget")?"budget":b.includes("/admin/feedback")?"feedback":b.includes("/admin/migration")?"migration":b.includes("/admin/tests")?"tests":"budget"},[l.pathname]),f=h==="tests";A.useEffect(()=>{c||i(h)},[h,c,i]);function p(){return!n3.includes(n)||n==="tests"&&!e?"budget":n}const _=A.useMemo(()=>[{id:"budget",label:"Budget",icon:""},{id:"feedback",label:"Feedback",icon:""},{id:"migration",label:"Migration",icon:""},{id:"tests",label:"Tests",icon:"",hidden:!e}],[e]);return t?!e&&f?u.jsxs("div",{children:[u.jsx("h1",{children:"Access Denied"}),u.jsx("p",{style:{opacity:.7},children:"Only test users can access this section."}),u.jsx("p",{style:{marginTop:"1rem"},children:u.jsx(Tt,{to:"/budget/admin/budget",style:{color:"#646cff"},children:"Go to Admin "})})]}):u.jsxs("div",{children:[u.jsx(d_,{mode:"link",linkPrefix:"/budget/admin",tabs:_,activeTab:h}),c?u.jsx(af,{to:`/budget/admin/${p()}`,replace:!0}):u.jsx(of,{})]}):u.jsxs("div",{children:[u.jsx("h1",{children:"Access Denied"}),u.jsx("p",{style:{opacity:.7},children:"Only administrators can access this section."}),u.jsx("p",{style:{marginTop:"1rem"},children:u.jsx(Tt,{to:"/budget",style:{color:"#646cff"},children:"Go to Budget "})})]})}function i3(){const{addLoadingHold:t,removeLoadingHold:e}=qn(),{selectedBudgetId:n,currentUserId:i,isAdmin:a}=Pt(),{budget:l,accounts:c,accountGroups:h,categories:f,categoryGroups:p,isOwner:_,isLoading:b}=Mn(n,i);return A.useEffect(()=>(b?t("settings-budget","Loading budget info..."):e("settings-budget"),()=>e("settings-budget")),[b,t,e]),b?null:l?u.jsxs("div",{children:[u.jsx("h2",{style:{marginTop:0},children:"Budget Summary"}),u.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Information about the currently selected budget."}),u.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",fontSize:"0.95rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{children:""}),u.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Name:"}),u.jsx("strong",{children:l.name})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{children:""}),u.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"ID:"}),u.jsx("code",{style:{background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:l.id})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{children:""}),u.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Owner:"}),u.jsx("strong",{children:l.owner_email||l.owner_id})]}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("span",{children:""}),u.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Users:"}),u.jsxs("span",{children:[l.user_ids.length," user",l.user_ids.length!==1?"s":"",u.jsxs("span",{style:{opacity:.7},children:["  ",_?"You are the owner":"Shared with you"]})]})]})]})}),a&&u.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[u.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem"},children:"Admin Tools"}),u.jsx("button",{onClick:()=>{const v={...l,accounts:c,account_groups:h,categories:f,category_groups:p,_meta:{downloaded_at:new Date().toISOString()}},E=new Blob([JSON.stringify(v,null,2)],{type:"application/json"}),C=URL.createObjectURL(E),w=document.createElement("a");w.href=C,w.download=`budget_${l.id}.json`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(C)},style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",transition:"background 0.15s"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]})]}):u.jsx("p",{style:{opacity:.7},children:"No budget selected."})}function lE({selectedType:t,onSelect:e}){return u.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const i=ty[n],a=t==="feature"?"new_feature":t,l=a===n||!a&&n==="bug";return u.jsxs("button",{type:"button",onClick:()=>{i.label,e(n)},style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${i.color}`,borderRadius:"0.5rem",background:l?i.bgColor:"transparent",color:l?i.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${i.bgColor}`:"none",position:"relative"},children:[i.label,l&&u.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function s3(){const[t,e]=A.useState(null),[n,i]=A.useState(null),[a,l]=A.useState(null),[c,h]=A.useState(!1),[f,p]=A.useState(""),[_,b]=A.useState("bug"),[v,E]=A.useState(null),[C,w]=A.useState(null),D=A.useContext(bu),U=no().get_current_firebase_user(),k=Mk(),{submitFeedback:X}=PC(),{toggleFeedback:G}=NP(),{updateSortOrder:K}=PP(),O=k.data?.items||[],{addLoadingHold:R,removeLoadingHold:j}=qn();A.useEffect(()=>(k.isLoading?R("settings-feedback","Loading feedback..."):j("settings-feedback"),()=>j("settings-feedback")),[k.isLoading,R,j]);function I(q){q.preventDefault(),!(!f.trim()||!D.username||!U)&&(X.mutate({userId:U.uid,userEmail:D.username,text:f.trim(),feedbackType:_,currentPath:"/settings/feedback"}),p(""),b("bug"),h(!1))}function M(q){q.is_done?H(q):E(q)}async function H(q){try{await G.mutateAsync({item:q})}catch(Y){e(Y instanceof Error?Y.message:"Failed to update feedback")}}function P(){v&&(H(v),E(null))}async function ue(q){if(C){try{const J=O.filter(ne=>ne.doc_id===C.doc_id).map(ne=>({id:ne.id,text:ne.text,created_at:ne.created_at,is_done:ne.is_done,completed_at:ne.completed_at,sort_order:ne.sort_order,feedback_type:ne.id===C.id?q:ne.feedback_type}));await K.mutateAsync({docId:C.doc_id,items:J})}catch(Y){e(Y instanceof Error?Y.message:"Failed to update feedback type")}w(null)}}const F=O.filter(q=>!q.is_done).sort((q,Y)=>q.sort_order-Y.sort_order),B=O.filter(q=>q.is_done).sort((q,Y)=>new Date(Y.completed_at||0).getTime()-new Date(q.completed_at||0).getTime());function $(q,Y){i(Y),q.dataTransfer.effectAllowed="move"}function Q(q,Y){q.preventDefault(),Y!==n&&l(Y)}function se(){l(null)}function ee(){i(null),l(null)}async function V(q,Y){if(q.preventDefault(),!n||n===Y){ee();return}const J=F.findIndex(pe=>pe.id===n),ne=[...F],[re]=ne.splice(J,1);if(Y==="__end__")ne.push(re);else{const pe=ne.findIndex(ie=>ie.id===Y);ne.splice(pe,0,re)}const ge=ne.map((pe,ie)=>({...pe,sort_order:ie}));ee();const Ae=new Map;for(const pe of ge)Ae.has(pe.doc_id)||Ae.set(pe.doc_id,[]),Ae.get(pe.doc_id).push({id:pe.id,text:pe.text,created_at:pe.created_at,is_done:pe.is_done,completed_at:pe.completed_at,sort_order:pe.sort_order,feedback_type:pe.feedback_type});for(const pe of B)Ae.has(pe.doc_id)||Ae.set(pe.doc_id,[]),Ae.get(pe.doc_id).push({id:pe.id,text:pe.text,created_at:pe.created_at,is_done:pe.is_done,completed_at:pe.completed_at,sort_order:pe.sort_order,feedback_type:pe.feedback_type});try{for(const[pe,ie]of Ae)await K.mutateAsync({docId:pe,items:ie})}catch(pe){e(pe instanceof Error?pe.message:"Failed to save order")}}return k.isLoading?null:u.jsxs("div",{children:[u.jsx("h2",{style:{marginTop:0},children:"Feedback"}),u.jsx("p",{style:{...kC,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&u.jsx(io,{message:t,onDismiss:()=>e(null)}),u.jsxs("div",{style:El,children:[F.length===0&&!c&&u.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),F.map(q=>u.jsx(w6,{item:q,isDragging:n===q.id,isDragOver:a===q.id,onDragStart:Y=>$(Y,q.id),onDragOver:Y=>Q(Y,q.id),onDragLeave:se,onDragEnd:ee,onDrop:Y=>V(Y,q.id),onToggleDone:()=>M(q),onTypeClick:()=>w(q)},q.id)),n&&F.length>0&&u.jsx(u_,{isActive:a==="__end__",onDragOver:q=>Q(q,"__end__"),onDragLeave:se,onDrop:q=>V(q,"__end__")})]}),c?u.jsxs(Ka,{actionName:"Add Feedback",onSubmit:I,children:[u.jsx(lE,{selectedType:_,onSelect:b}),u.jsx(c_,{value:f,onChange:q=>p(q.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),u.jsxs(so,{children:[u.jsx(Ie,{type:"submit",actionName:"Add Feedback",disabled:!f.trim(),children:"Add Feedback"}),u.jsx(Ie,{type:"button",variant:"secondary",actionName:"Cancel Add Feedback",onClick:()=>{h(!1),p(""),b("bug")},children:"Cancel"})]})]}):u.jsx(Ie,{variant:"primary-large",actionName:"Open Add Feedback Form",onClick:()=>h(!0),children:"+ Add Feedback"}),B.length>0&&u.jsx(UP,{title:"Completed",count:B.length,children:u.jsx("div",{style:{...El,marginTop:"0.5rem"},children:B.map(q=>u.jsx(C6,{item:q,onToggleDone:()=>M(q),onTypeClick:()=>w(q)},q.id))})}),u.jsxs(ea,{isOpen:v!==null,onClose:()=>E(null),title:"Mark as Complete",children:[u.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),v&&u.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',v.text,'"']}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[u.jsx(Ie,{variant:"secondary",actionName:"Cancel Mark Complete",onClick:()=>E(null),children:"Cancel"}),u.jsx(Ie,{variant:"primary",actionName:"Confirm Mark Complete",onClick:P,children:"Mark Complete"})]})]}),u.jsxs(ea,{isOpen:C!==null,onClose:()=>w(null),title:"Change Feedback Type",children:[u.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),u.jsx(lE,{selectedType:C?.feedback_type||"bug",onSelect:ue}),u.jsx(Ie,{variant:"secondary",actionName:"Cancel Change Feedback Type",onClick:()=>w(null),style:{width:"100%"},children:"Cancel"})]})]})}function a3(){try{localStorage.removeItem("BUDGET_APP_QUERY_CACHE"),console.log("[Cache] Cleared React Query cache from localStorage")}catch(t){console.warn("Failed to clear localStorage cache:",t)}window.location.reload()}function o3(){const e=no().get_current_firebase_user(),[n,i]=A.useState(!1),a=pL({currentUser:e}),l=yL({currentUser:e}),c=bL({currentUser:e}),h=a.isScanning||l.isScanning||c.isScanning,f=a.isRunning||l.isMigratingFeedback||c.isDeleting,p=async()=>{await Promise.all([a.scanStatus(),l.scanStatus(),c.scanStatus()])};return u.jsxs("div",{children:[u.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[u.jsx("h2",{style:{margin:0},children:"Data Migrations"}),u.jsxs("button",{onClick:p,disabled:h||f,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:h||f?"not-allowed":"pointer",fontWeight:500,opacity:h||f?.7:1,display:"flex",alignItems:"center",gap:"0.4rem",minWidth:"130px",minHeight:"36px"},children:[u.jsx("span",{style:{width:"18px",height:"18px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:h?u.jsx(zf,{noMargin:!0}):""}),"Refresh All"]})]}),u.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:'Run migrations to validate and fix your database. Click "Refresh All" to scan Firestore directly.'}),u.jsx(A6,{hasData:!!a.status,status:a.status,hasIssues:a.hasIssues,totalIssues:a.totalIssues,isRunning:a.isRunning,result:a.result,onRunCleanup:a.runCleanup,onRefresh:a.scanStatus,isRefreshing:a.isScanning,disabled:!e}),u.jsx(R6,{hasData:!!l.status,status:l.status,isMigrating:l.isMigratingFeedback,onMigrate:l.migrateFeedbackDocuments,onRefresh:l.scanStatus,isRefreshing:l.isScanning,disabled:!e,migrationResult:l.feedbackMigrationResult}),u.jsx(D6,{hasData:!!c.status,monthsCount:c.status?.monthsCount??0,budgetCount:c.status?.budgetCount??0,monthsToDelete:c.status?.monthsToDelete??[],isDeleting:c.isDeleting,onDelete:c.deleteAllMonths,onRefresh:c.scanStatus,isRefreshing:c.isScanning,disabled:!e,deleteResult:c.deleteResult,deleteProgress:c.deleteProgress}),u.jsx(P6,{disabled:!e}),u.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:u.jsxs("p",{style:{margin:0,opacity:.7},children:[u.jsx("strong",{children:"Note:"})," These migrations will process ",u.jsx("strong",{children:"all budgets and months"})," in the system, not just the ones you own or are invited to."]})}),u.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, #ff6b6b 10%, transparent)",borderRadius:"8px",border:"1px solid color-mix(in srgb, #ff6b6b 30%, transparent)"},children:[u.jsxs("p",{style:{margin:"0 0 0.75rem 0",fontSize:"0.9rem"},children:[u.jsx("strong",{children:" Clear All Caches"}),u.jsx("span",{style:{opacity:.7,display:"block",marginTop:"0.25rem"},children:"If you're seeing stale data after running migrations, clear all cached data and reload to fetch fresh data from Firestore."})]}),u.jsx(Ie,{variant:"danger",actionName:"Open Clear Caches Modal",onClick:()=>i(!0),style:{display:"flex",alignItems:"center",gap:"0.4rem"},children:" Clear All Caches & Reload"})]}),u.jsxs(ea,{isOpen:n,onClose:()=>i(!1),title:"Clear Caches & Reload?",children:[u.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.8},children:"This will clear all cached data from localStorage and reload the page. The app will fetch fresh data from Firestore for everything."}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[u.jsx(Ie,{variant:"secondary",actionName:"Cancel Clear Caches",onClick:()=>i(!1),children:"Cancel"}),u.jsx(Ie,{variant:"danger",actionName:"Confirm Clear Caches & Reload",onClick:a3,children:"Clear & Reload"})]})]})]})}function Zo({name:t,description:e,expectedBehavior:n,result:i,onRun:a,disabled:l,expectedToSucceed:c}){const h=i?.status==="passed"?oe.success:i?.status==="failed"?oe.danger:i?.status==="running"?oe.warning:"inherit";return u.jsxs("div",{style:{...Ou,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[u.jsxs("div",{style:{flex:1},children:[u.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),u.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),u.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:c?oe.success:oe.warning},children:["Expected: ",n]})]}),u.jsx(Ie,{onClick:a,disabled:l,variant:"secondary",style:{flexShrink:0},children:i?.status==="running"?"":"Run"})]}),i&&i.status!=="pending"&&u.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${h} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${h} 30%, transparent)`,fontSize:"0.85rem",color:h},children:i.message})]})}function l3({totalCount:t,passedCount:e,failedCount:n}){return u.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[u.jsxs("span",{children:["Total: ",u.jsx("strong",{children:t})]}),u.jsxs("span",{style:{color:oe.success},children:["Passed: ",u.jsx("strong",{children:e})]}),u.jsxs("span",{style:{color:oe.danger},children:["Failed: ",u.jsx("strong",{children:n})]})]})}const cE=[{name:"Read unauthorized budget",expectedToFail:!0},{name:"Read another user's document",expectedToFail:!0},{name:"Read unauthorized budget month",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",expectedToFail:!0},{name:"Read own user document",expectedToFail:!1}];function c3(){const{currentUserId:t}=Pt(),[e,n]=A.useState([]),[i,a]=A.useState(!1);function l(E,C){n(w=>w.map(D=>D.name===E?{...D,...C}:D))}async function c(E,C,w){l(E,{status:"running",message:"Running..."});try{const D=await C();w?l(E,{status:"failed",message:` ${D}`}):l(E,{status:"passed",message:` ${D}`})}catch(D){const N=D instanceof Error?D.message:"Unknown error";w?l(E,{status:"passed",message:` Blocked as expected: ${N}`}):l(E,{status:"failed",message:` ${N}`})}}async function h(){a(!0),n(cE.map(E=>({...E,status:"pending",message:""})));for(const E of cE)await f(E.name);a(!1)}async function f(E){switch(E){case"Read unauthorized budget":await c(E,async()=>(await He("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0);break;case"Read another user's document":await c(E,async()=>(await He("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0);break;case"Read unauthorized budget month":await c(E,async()=>(await He("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0);break;case"Toggle is_admin in own permission_flags":await c(E,async()=>{if(!t)throw new Error("Not authenticated");const{data:C}=await He("users",t,"security test: reading own user to get current is_admin value"),w=C?.permission_flags?.is_admin??!1;return await Qa("users",t,{"permission_flags.is_admin":!w},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${w} to ${!w} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await c(E,async()=>{if(!t)throw new Error("Not authenticated");const{data:C}=await He("users",t,"security test: reading own user to get current is_test value"),w=C?.permission_flags?.is_test??!1;return await Qa("users",t,{"permission_flags.is_test":!w},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${w} to ${!w} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await c(E,async()=>{if(!t)throw new Error("Not authenticated");const{exists:C}=await He("users",t,"security test: reading own user document (should succeed)");if(C)return"Successfully read own document";throw new Error("Document does not exist")},!1);break}}async function p(E){e.find(w=>w.name===E)||n(w=>[...w,{name:E,status:"pending",message:"",expectedToFail:!0}]),a(!0),await f(E),a(!1)}const _=e.filter(E=>E.status==="passed").length,b=e.filter(E=>E.status==="failed").length,v=e.length;return u.jsxs("div",{children:[u.jsx("p",{style:kC,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),u.jsx("div",{style:{marginBottom:"1.5rem"},children:u.jsx(Ie,{onClick:h,disabled:i,variant:"primary",children:i?"Running Tests...":"Run All Tests"})}),e.length>0&&u.jsx(l3,{totalCount:v,passedCount:_,failedCount:b}),u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[u.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),u.jsx(Zo,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(E=>E.name==="Read unauthorized budget"),onRun:()=>p("Read unauthorized budget"),disabled:i}),u.jsx(Zo,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(E=>E.name==="Read another user's document"),onRun:()=>p("Read another user's document"),disabled:i}),u.jsx(Zo,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(E=>E.name==="Read unauthorized budget month"),onRun:()=>p("Read unauthorized budget month"),disabled:i}),u.jsx(Zo,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(E=>E.name==="Toggle is_admin in own permission_flags"),onRun:()=>p("Toggle is_admin in own permission_flags"),disabled:i}),u.jsx(Zo,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(E=>E.name==="Toggle is_test in own permission_flags"),onRun:()=>p("Toggle is_test in own permission_flags"),disabled:i}),u.jsx(Zo,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(E=>E.name==="Read own user document"),onRun:()=>p("Read own user document"),disabled:i,expectedToSucceed:!0})]}),b>0&&u.jsxs(io,{style:{marginTop:"1.5rem"},children:[" ",b," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function u3({children:t}){const{addLoadingHold:e,removeLoadingHold:n}=qn(),i=A.useContext(bu),a=Tn();return A.useEffect(()=>(i.is_auth_checked?n("protected-route"):e("protected-route","Checking authentication..."),()=>n("protected-route")),[i.is_auth_checked,e,n]),i.is_auth_checked?i.is_logged_in?t?u.jsx(u.Fragment,{children:t}):u.jsx(of,{}):u.jsx(af,{to:"/account",state:{from:a.pathname},replace:!0}):null}function d3(){const{addLoadingHold:t,removeLoadingHold:e}=qn(),{selectedBudgetId:n,currentUserId:i,isInitialized:a,pageTitle:l}=Pt(),{isLoading:c,error:h}=Mn(n,i);return A.useEffect(()=>{a?e("budget-init"):t("budget-init",c?"Fetching data from server...":"Loading budget...")},[a,c,t,e]),A.useEffect(()=>()=>e("budget-init"),[e]),h?(console.error("[BudgetLayout] Error:",h),u.jsx("div",{style:mu,children:u.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",h.message]})})):u.jsxs("div",{style:{...mu,paddingBottom:"5rem"},children:[u.jsx(qP,{title:l}),a&&u.jsx(of,{})]})}const h3={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function f3(){const{isLoading:t,loadingMessage:e}=qn();return t?u.jsx(ku,{message:e}):null}function m3(){const[t,e]=A.useState(h3),n=no(),i=A.useRef(!1),{addLoadingHold:a,removeLoadingHold:l}=qn();return A.useEffect(function(){i.current||(i.current=!0,n.set_user_listener(c=>{e({is_logged_in:c!=null,is_auth_checked:!0,username:c?.email??"",set_user_context:e})}))},[n]),A.useEffect(()=>{t.is_auth_checked?l("auth"):a("auth","Authenticating...")},[t.is_auth_checked,a,l]),t.is_auth_checked?u.jsx(bu.Provider,{value:t,children:u.jsx(kj,{children:u.jsx(uP,{children:u.jsxs(xD,{children:[u.jsxs(YR,{children:[u.jsx($t,{path:"/",element:u.jsx(jP,{})}),u.jsx($t,{path:"/account",element:u.jsx(GP,{})}),u.jsx($t,{path:"/sql-test",element:u.jsx(HP,{})}),u.jsx($t,{path:"/budget",element:u.jsx(u3,{}),children:u.jsxs($t,{element:u.jsx(d3,{}),children:[u.jsx($t,{index:!0,element:u.jsx(sE,{})}),u.jsx($t,{path:":year/:month/:tab/:view?",element:u.jsx(sE,{})}),u.jsx($t,{path:"analytics",element:u.jsx(E6,{})}),u.jsx($t,{path:"my-budgets",element:u.jsx(z6,{})}),u.jsxs($t,{path:"settings",element:u.jsx(q6,{}),children:[u.jsx($t,{index:!0,element:u.jsx(af,{to:"categories",replace:!0})}),u.jsx($t,{path:"accounts",element:u.jsx(Y6,{})}),u.jsx($t,{path:"categories",element:u.jsx(e3,{})}),u.jsx($t,{path:"users",element:u.jsx(t3,{})})]}),u.jsxs($t,{path:"admin",element:u.jsx(r3,{}),children:[u.jsx($t,{path:"budget",element:u.jsx(i3,{})}),u.jsx($t,{path:"feedback",element:u.jsx(s3,{})}),u.jsx($t,{path:"migration",element:u.jsx(o3,{})}),u.jsx($t,{path:"tests",element:u.jsx(c3,{})})]})]})})]}),u.jsx(VP,{})]})})})}):null}function p3(){return u.jsxs(OD,{children:[u.jsx(f3,{}),u.jsx(m3,{})]})}YA.createRoot(document.getElementById("root")).render(u.jsx(A.StrictMode,{children:u.jsx(p3,{})}));
