(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var fp={exports:{}},Tc={};var ub;function FA(){if(ub)return Tc;ub=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var f in a)f!=="key"&&(l[f]=a[f])}else l=a;return a=l.ref,{$$typeof:t,type:i,key:u,ref:a!==void 0?a:null,props:l}}return Tc.Fragment=e,Tc.jsx=n,Tc.jsxs=n,Tc}var db;function qA(){return db||(db=1,fp.exports=FA()),fp.exports}var d=qA(),mp={exports:{}},Be={};var hb;function HA(){if(hb)return Be;hb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),x=Symbol.iterator;function w(z){return z===null||typeof z!="object"?null:(z=x&&z[x]||z["@@iterator"],typeof z=="function"?z:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,N={};function H(z,F,W){this.props=z,this.context=F,this.refs=N,this.updater=W||A}H.prototype.isReactComponent={},H.prototype.setState=function(z,F){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,F,"setState")},H.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function $(){}$.prototype=H.prototype;function q(z,F,W){this.props=z,this.context=F,this.refs=N,this.updater=W||A}var me=q.prototype=new $;me.constructor=q,I(me,H.prototype),me.isPureReactComponent=!0;var ie=Array.isArray;function he(){}var L={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function D(z,F,W){var ne=W.ref;return{$$typeof:t,type:z,key:F,ref:ne!==void 0?ne:null,props:W}}function M(z,F){return D(z.type,F,z.props)}function j(z){return typeof z=="object"&&z!==null&&z.$$typeof===t}function O(z){var F={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(W){return F[W]})}var C=/\/+/g;function Y(z,F){return typeof z=="object"&&z!==null&&z.key!=null?O(""+z.key):F.toString(36)}function U(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(he,he):(z.status="pending",z.then(function(F){z.status==="pending"&&(z.status="fulfilled",z.value=F)},function(F){z.status==="pending"&&(z.status="rejected",z.reason=F)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function P(z,F,W,ne,ae){var pe=typeof z;(pe==="undefined"||pe==="boolean")&&(z=null);var ue=!1;if(z===null)ue=!0;else switch(pe){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(z.$$typeof){case t:case e:ue=!0;break;case _:return ue=z._init,P(ue(z._payload),F,W,ne,ae)}}if(ue)return ae=ae(z),ue=ne===""?"."+Y(z,0):ne,ie(ae)?(W="",ue!=null&&(W=ue.replace(C,"$&/")+"/"),P(ae,F,W,"",function(de){return de})):ae!=null&&(j(ae)&&(ae=M(ae,W+(ae.key==null||z&&z.key===ae.key?"":(""+ae.key).replace(C,"$&/")+"/")+ue)),F.push(ae)),1;ue=0;var be=ne===""?".":ne+":";if(ie(z))for(var Se=0;Se<z.length;Se++)ne=z[Se],pe=be+Y(ne,Se),ue+=P(ne,F,W,pe,ae);else if(Se=w(z),typeof Se=="function")for(z=Se.call(z),Se=0;!(ne=z.next()).done;)ne=ne.value,pe=be+Y(ne,Se++),ue+=P(ne,F,W,pe,ae);else if(pe==="object"){if(typeof z.then=="function")return P(U(z),F,W,ne,ae);throw F=String(z),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return ue}function B(z,F,W){if(z==null)return z;var ne=[],ae=0;return P(z,ne,"","",function(pe){return F.call(W,pe,ae++)}),ne}function Q(z){if(z._status===-1){var F=z._result;F=F(),F.then(function(W){(z._status===0||z._status===-1)&&(z._status=1,z._result=W)},function(W){(z._status===0||z._status===-1)&&(z._status=2,z._result=W)}),z._status===-1&&(z._status=0,z._result=F)}if(z._status===1)return z._result.default;throw z._result}var le=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)},J={map:B,forEach:function(z,F,W){B(z,function(){F.apply(this,arguments)},W)},count:function(z){var F=0;return B(z,function(){F++}),F},toArray:function(z){return B(z,function(F){return F})||[]},only:function(z){if(!j(z))throw Error("React.Children.only expected to receive a single React element child.");return z}};return Be.Activity=v,Be.Children=J,Be.Component=H,Be.Fragment=n,Be.Profiler=a,Be.PureComponent=q,Be.StrictMode=i,Be.Suspense=m,Be.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Be.__COMPILER_RUNTIME={__proto__:null,c:function(z){return L.H.useMemoCache(z)}},Be.cache=function(z){return function(){return z.apply(null,arguments)}},Be.cacheSignal=function(){return null},Be.cloneElement=function(z,F,W){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var ne=I({},z.props),ae=z.key;if(F!=null)for(pe in F.key!==void 0&&(ae=""+F.key),F)!R.call(F,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&F.ref===void 0||(ne[pe]=F[pe]);var pe=arguments.length-2;if(pe===1)ne.children=W;else if(1<pe){for(var ue=Array(pe),be=0;be<pe;be++)ue[be]=arguments[be+2];ne.children=ue}return D(z.type,ae,ne)},Be.createContext=function(z){return z={$$typeof:u,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:l,_context:z},z},Be.createElement=function(z,F,W){var ne,ae={},pe=null;if(F!=null)for(ne in F.key!==void 0&&(pe=""+F.key),F)R.call(F,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(ae[ne]=F[ne]);var ue=arguments.length-2;if(ue===1)ae.children=W;else if(1<ue){for(var be=Array(ue),Se=0;Se<ue;Se++)be[Se]=arguments[Se+2];ae.children=be}if(z&&z.defaultProps)for(ne in ue=z.defaultProps,ue)ae[ne]===void 0&&(ae[ne]=ue[ne]);return D(z,pe,ae)},Be.createRef=function(){return{current:null}},Be.forwardRef=function(z){return{$$typeof:f,render:z}},Be.isValidElement=j,Be.lazy=function(z){return{$$typeof:_,_payload:{_status:-1,_result:z},_init:Q}},Be.memo=function(z,F){return{$$typeof:g,type:z,compare:F===void 0?null:F}},Be.startTransition=function(z){var F=L.T,W={};L.T=W;try{var ne=z(),ae=L.S;ae!==null&&ae(W,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(he,le)}catch(pe){le(pe)}finally{F!==null&&W.types!==null&&(F.types=W.types),L.T=F}},Be.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Be.use=function(z){return L.H.use(z)},Be.useActionState=function(z,F,W){return L.H.useActionState(z,F,W)},Be.useCallback=function(z,F){return L.H.useCallback(z,F)},Be.useContext=function(z){return L.H.useContext(z)},Be.useDebugValue=function(){},Be.useDeferredValue=function(z,F){return L.H.useDeferredValue(z,F)},Be.useEffect=function(z,F){return L.H.useEffect(z,F)},Be.useEffectEvent=function(z){return L.H.useEffectEvent(z)},Be.useId=function(){return L.H.useId()},Be.useImperativeHandle=function(z,F,W){return L.H.useImperativeHandle(z,F,W)},Be.useInsertionEffect=function(z,F){return L.H.useInsertionEffect(z,F)},Be.useLayoutEffect=function(z,F){return L.H.useLayoutEffect(z,F)},Be.useMemo=function(z,F){return L.H.useMemo(z,F)},Be.useOptimistic=function(z,F){return L.H.useOptimistic(z,F)},Be.useReducer=function(z,F,W){return L.H.useReducer(z,F,W)},Be.useRef=function(z){return L.H.useRef(z)},Be.useState=function(z){return L.H.useState(z)},Be.useSyncExternalStore=function(z,F,W){return L.H.useSyncExternalStore(z,F,W)},Be.useTransition=function(){return L.H.useTransition()},Be.version="19.2.3",Be}var fb;function Tg(){return fb||(fb=1,mp.exports=HA()),mp.exports}var T=Tg(),pp={exports:{}},Ac={},gp={exports:{}},yp={};var mb;function GA(){return mb||(mb=1,(function(t){function e(P,B){var Q=P.length;P.push(B);e:for(;0<Q;){var le=Q-1>>>1,J=P[le];if(0<a(J,B))P[le]=B,P[Q]=J,Q=le;else break e}}function n(P){return P.length===0?null:P[0]}function i(P){if(P.length===0)return null;var B=P[0],Q=P.pop();if(Q!==B){P[0]=Q;e:for(var le=0,J=P.length,z=J>>>1;le<z;){var F=2*(le+1)-1,W=P[F],ne=F+1,ae=P[ne];if(0>a(W,Q))ne<J&&0>a(ae,W)?(P[le]=ae,P[ne]=Q,le=ne):(P[le]=W,P[F]=Q,le=F);else if(ne<J&&0>a(ae,Q))P[le]=ae,P[ne]=Q,le=ne;else break e}}return B}function a(P,B){var Q=P.sortIndex-B.sortIndex;return Q!==0?Q:P.id-B.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var u=Date,f=u.now();t.unstable_now=function(){return u.now()-f}}var m=[],g=[],_=1,v=null,x=3,w=!1,A=!1,I=!1,N=!1,H=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function me(P){for(var B=n(g);B!==null;){if(B.callback===null)i(g);else if(B.startTime<=P)i(g),B.sortIndex=B.expirationTime,e(m,B);else break;B=n(g)}}function ie(P){if(I=!1,me(P),!A)if(n(m)!==null)A=!0,he||(he=!0,O());else{var B=n(g);B!==null&&U(ie,B.startTime-P)}}var he=!1,L=-1,R=5,D=-1;function M(){return N?!0:!(t.unstable_now()-D<R)}function j(){if(N=!1,he){var P=t.unstable_now();D=P;var B=!0;try{e:{A=!1,I&&(I=!1,$(L),L=-1),w=!0;var Q=x;try{t:{for(me(P),v=n(m);v!==null&&!(v.expirationTime>P&&M());){var le=v.callback;if(typeof le=="function"){v.callback=null,x=v.priorityLevel;var J=le(v.expirationTime<=P);if(P=t.unstable_now(),typeof J=="function"){v.callback=J,me(P),B=!0;break t}v===n(m)&&i(m),me(P)}else i(m);v=n(m)}if(v!==null)B=!0;else{var z=n(g);z!==null&&U(ie,z.startTime-P),B=!1}}break e}finally{v=null,x=Q,w=!1}B=void 0}}finally{B?O():he=!1}}}var O;if(typeof q=="function")O=function(){q(j)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,Y=C.port2;C.port1.onmessage=j,O=function(){Y.postMessage(null)}}else O=function(){H(j,0)};function U(P,B){L=H(function(){P(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(P){P.callback=null},t.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<P?Math.floor(1e3/P):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(P){switch(x){case 1:case 2:case 3:var B=3;break;default:B=x}var Q=x;x=B;try{return P()}finally{x=Q}},t.unstable_requestPaint=function(){N=!0},t.unstable_runWithPriority=function(P,B){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var Q=x;x=P;try{return B()}finally{x=Q}},t.unstable_scheduleCallback=function(P,B,Q){var le=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?le+Q:le):Q=le,P){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Q+J,P={id:_++,callback:B,priorityLevel:P,startTime:Q,expirationTime:J,sortIndex:-1},Q>le?(P.sortIndex=Q,e(g,P),n(m)===null&&P===n(g)&&(I?($(L),L=-1):I=!0,U(ie,Q-le))):(P.sortIndex=J,e(m,P),A||w||(A=!0,he||(he=!0,O()))),P},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(P){var B=x;return function(){var Q=x;x=B;try{return P.apply(this,arguments)}finally{x=Q}}}})(yp)),yp}var pb;function QA(){return pb||(pb=1,gp.exports=GA()),gp.exports}var _p={exports:{}},wn={};var gb;function $A(){if(gb)return wn;gb=1;var t=Tg();function e(m){var g="https://react.dev/errors/"+m;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(m,g,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:m,containerInfo:g,implementation:_}}var u=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(m,g){if(m==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,wn.createPortal=function(m,g){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return l(m,g,null,_)},wn.flushSync=function(m){var g=u.T,_=i.p;try{if(u.T=null,i.p=2,m)return m()}finally{u.T=g,i.p=_,i.d.f()}},wn.preconnect=function(m,g){typeof m=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(m,g))},wn.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},wn.preinit=function(m,g){if(typeof m=="string"&&g&&typeof g.as=="string"){var _=g.as,v=f(_,g.crossOrigin),x=typeof g.integrity=="string"?g.integrity:void 0,w=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;_==="style"?i.d.S(m,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:v,integrity:x,fetchPriority:w}):_==="script"&&i.d.X(m,{crossOrigin:v,integrity:x,fetchPriority:w,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},wn.preinitModule=function(m,g){if(typeof m=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var _=f(g.as,g.crossOrigin);i.d.M(m,{crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(m)},wn.preload=function(m,g){if(typeof m=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var _=g.as,v=f(_,g.crossOrigin);i.d.L(m,_,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},wn.preloadModule=function(m,g){if(typeof m=="string")if(g){var _=f(g.as,g.crossOrigin);i.d.m(m,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(m)},wn.requestFormReset=function(m){i.d.r(m)},wn.unstable_batchedUpdates=function(m,g){return m(g)},wn.useFormState=function(m,g,_){return u.H.useFormState(m,g,_)},wn.useFormStatus=function(){return u.H.useHostTransitionStatus()},wn.version="19.2.3",wn}var yb;function KA(){if(yb)return _p.exports;yb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),_p.exports=$A(),_p.exports}var _b;function WA(){if(_b)return Ac;_b=1;var t=QA(),e=Tg(),n=KA();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var s=r,o=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(o=s.return),r=s.return;while(r)}return s.tag===3?o:null}function u(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function f(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function m(r){if(l(r)!==r)throw Error(i(188))}function g(r){var s=r.alternate;if(!s){if(s=l(r),s===null)throw Error(i(188));return s!==r?null:r}for(var o=r,c=s;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(c=p.return,c!==null){o=c;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return m(p),r;if(y===c)return m(p),s;y=y.sibling}throw Error(i(188))}if(o.return!==c.return)o=p,c=y;else{for(var E=!1,k=p.child;k;){if(k===o){E=!0,o=p,c=y;break}if(k===c){E=!0,c=p,o=y;break}k=k.sibling}if(!E){for(k=y.child;k;){if(k===o){E=!0,o=y,c=p;break}if(k===c){E=!0,c=y,o=p;break}k=k.sibling}if(!E)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?r:s}function _(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=_(r),s!==null)return s;r=r.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),q=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),ie=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),j=Symbol.iterator;function O(r){return r===null||typeof r!="object"?null:(r=j&&r[j]||r["@@iterator"],typeof r=="function"?r:null)}var C=Symbol.for("react.client.reference");function Y(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===C?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case I:return"Fragment";case H:return"Profiler";case N:return"StrictMode";case ie:return"Suspense";case he:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case A:return"Portal";case q:return r.displayName||"Context";case $:return(r._context.displayName||"Context")+".Consumer";case me:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case L:return s=r.displayName||null,s!==null?s:Y(r.type)||"Memo";case R:s=r._payload,r=r._init;try{return Y(r(s))}catch{}}return null}var U=Array.isArray,P=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q={pending:!1,data:null,method:null,action:null},le=[],J=-1;function z(r){return{current:r}}function F(r){0>J||(r.current=le[J],le[J]=null,J--)}function W(r,s){J++,le[J]=r.current,r.current=s}var ne=z(null),ae=z(null),pe=z(null),ue=z(null);function be(r,s){switch(W(pe,s),W(ae,r),W(ne,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?kv(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=kv(s),r=Mv(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}F(ne),W(ne,r)}function Se(){F(ne),F(ae),F(pe)}function de(r){r.memoizedState!==null&&W(ue,r);var s=ne.current,o=Mv(s,r.type);s!==o&&(W(ae,r),W(ne,o))}function Ce(r){ae.current===r&&(F(ne),F(ae)),ue.current===r&&(F(ue),xc._currentValue=Q)}var De,Te;function Me(r){if(De===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);De=s&&s[1]||"",Te=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+De+r+Te}var $e=!1;function _t(r,s){if(!r||$e)return"";$e=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var ye=function(){throw Error()};if(Object.defineProperty(ye.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ye,[])}catch(oe){var re=oe}Reflect.construct(r,[],ye)}else{try{ye.call()}catch(oe){re=oe}r.call(ye.prototype)}}else{try{throw Error()}catch(oe){re=oe}(ye=r())&&typeof ye.catch=="function"&&ye.catch(function(){})}}catch(oe){if(oe&&re&&typeof oe.stack=="string")return[oe.stack,re.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=c.DetermineComponentFrameRoot(),E=y[0],k=y[1];if(E&&k){var G=E.split(`
`),te=k.split(`
`);for(p=c=0;c<G.length&&!G[c].includes("DetermineComponentFrameRoot");)c++;for(;p<te.length&&!te[p].includes("DetermineComponentFrameRoot");)p++;if(c===G.length||p===te.length)for(c=G.length-1,p=te.length-1;1<=c&&0<=p&&G[c]!==te[p];)p--;for(;1<=c&&0<=p;c--,p--)if(G[c]!==te[p]){if(c!==1||p!==1)do if(c--,p--,0>p||G[c]!==te[p]){var fe=`
`+G[c].replace(" at new "," at ");return r.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",r.displayName)),fe}while(1<=c&&0<=p);break}}}finally{$e=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?Me(o):""}function wt(r,s){switch(r.tag){case 26:case 27:case 5:return Me(r.type);case 16:return Me("Lazy");case 13:return r.child!==s&&s!==null?Me("Suspense Fallback"):Me("Suspense");case 19:return Me("SuspenseList");case 0:case 15:return _t(r.type,!1);case 11:return _t(r.type.render,!1);case 1:return _t(r.type,!0);case 31:return Me("Activity");default:return""}}function en(r){try{var s="",o=null;do s+=wt(r,o),o=r,r=r.return;while(r);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var lt=Object.prototype.hasOwnProperty,Ne=t.unstable_scheduleCallback,Mt=t.unstable_cancelCallback,ln=t.unstable_shouldYield,Dn=t.unstable_requestPaint,Nt=t.unstable_now,jt=t.unstable_getCurrentPriorityLevel,Gn=t.unstable_ImmediatePriority,Tl=t.unstable_UserBlockingPriority,Ji=t.unstable_NormalPriority,gf=t.unstable_LowPriority,yu=t.unstable_IdlePriority,_u=t.log,vu=t.unstable_setDisableYieldValue,xr=null,mn=null;function sr(r){if(typeof _u=="function"&&vu(r),mn&&typeof mn.setStrictMode=="function")try{mn.setStrictMode(xr,r)}catch{}}var Pt=Math.clz32?Math.clz32:xu,bu=Math.log,Ga=Math.LN2;function xu(r){return r>>>=0,r===0?32:31-(bu(r)/Ga|0)|0}var zr=256,na=262144,Ft=4194304;function Ur(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Br(r,s,o){var c=r.pendingLanes;if(c===0)return 0;var p=0,y=r.suspendedLanes,E=r.pingedLanes;r=r.warmLanes;var k=c&134217727;return k!==0?(c=k&~y,c!==0?p=Ur(c):(E&=k,E!==0?p=Ur(E):o||(o=k&~r,o!==0&&(p=Ur(o))))):(k=c&~y,k!==0?p=Ur(k):E!==0?p=Ur(E):o||(o=c&~r,o!==0&&(p=Ur(o)))),p===0?0:s!==0&&s!==p&&(s&y)===0&&(y=p&-p,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:p}function Er(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function yf(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Eu(){var r=Ft;return Ft<<=1,(Ft&62914560)===0&&(Ft=4194304),r}function Fr(r){for(var s=[],o=0;31>o;o++)s.push(r);return s}function ra(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function _f(r,s,o,c,p,y){var E=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var k=r.entanglements,G=r.expirationTimes,te=r.hiddenUpdates;for(o=E&~o;0<o;){var fe=31-Pt(o),ye=1<<fe;k[fe]=0,G[fe]=-1;var re=te[fe];if(re!==null)for(te[fe]=null,fe=0;fe<re.length;fe++){var oe=re[fe];oe!==null&&(oe.lane&=-536870913)}o&=~ye}c!==0&&ia(r,c,0),y!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=y&~(E&~s))}function ia(r,s,o){r.pendingLanes|=s,r.suspendedLanes&=~s;var c=31-Pt(s);r.entangledLanes|=s,r.entanglements[c]=r.entanglements[c]|1073741824|o&261930}function Al(r,s){var o=r.entangledLanes|=s;for(r=r.entanglements;o;){var c=31-Pt(o),p=1<<c;p&s|r[c]&s&&(r[c]|=s),o&=~p}}function Cl(r,s){var o=s&-s;return o=(o&42)!==0?1:sa(o),(o&(r.suspendedLanes|s))!==0?0:o}function sa(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function gi(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Su(){var r=B.p;return r!==0?r:(r=window.event,r===void 0?32:rb(r.type))}function Sr(r,s){var o=B.p;try{return B.p=r,s()}finally{B.p=o}}var wr=Math.random().toString(36).slice(2),qt="__reactFiber$"+wr,cn="__reactProps$"+wr,qr="__reactContainer$"+wr,Qa="__reactEvents$"+wr,vf="__reactListeners$"+wr,wu="__reactHandles$"+wr,Tu="__reactResources$"+wr,Hr="__reactMarker$"+wr;function $a(r){delete r[qt],delete r[cn],delete r[Qa],delete r[vf],delete r[wu]}function Gr(r){var s=r[qt];if(s)return s;for(var o=r.parentNode;o;){if(s=o[qr]||o[qt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(r=Bv(r);r!==null;){if(o=r[qt])return o;r=Bv(r)}return s}r=o,o=r.parentNode}return null}function ar(r){if(r=r[qt]||r[qr]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function Qn(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function Qr(r){var s=r[Tu];return s||(s=r[Tu]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ht(r){r[Hr]=!0}var Rl=new Set,Dl={};function $r(r,s){Kr(r,s),Kr(r+"Capture",s)}function Kr(r,s){for(Dl[r]=s,r=0;r<s.length;r++)Rl.add(s[r])}var Il=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),jl={},Ol={};function Au(r){return lt.call(Ol,r)?!0:lt.call(jl,r)?!1:Il.test(r)?Ol[r]=!0:(jl[r]=!0,!1)}function Ka(r,s,o){if(Au(s))if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+o)}}function $n(r,s,o){if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+o)}}function Gt(r,s,o,c){if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(s,o,""+c)}}function un(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Zi(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function kl(r,s,o){var c=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,y=c.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return p.call(this)},set:function(E){o=""+E,y.call(this,E)}}),Object.defineProperty(r,s,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function ct(r){if(!r._valueTracker){var s=Zi(r)?"checked":"value";r._valueTracker=kl(r,s,""+r[s])}}function aa(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var o=s.getValue(),c="";return r&&(c=Zi(r)?r.checked?"true":"false":r.value),r=c,r!==o?(s.setValue(r),!0):!1}function Wr(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var oa=/[\n"\\]/g;function Mn(r){return r.replace(oa,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Wa(r,s,o,c,p,y,E,k){r.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?r.type=E:r.removeAttribute("type"),s!=null?E==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+un(s)):r.value!==""+un(s)&&(r.value=""+un(s)):E!=="submit"&&E!=="reset"||r.removeAttribute("value"),s!=null?Ml(r,E,un(s)):o!=null?Ml(r,E,un(o)):c!=null&&r.removeAttribute("value"),p==null&&y!=null&&(r.defaultChecked=!!y),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?r.name=""+un(k):r.removeAttribute("name")}function Cu(r,s,o,c,p,y,E,k){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ct(r);return}o=o!=null?""+un(o):"",s=s!=null?""+un(s):o,k||s===r.value||(r.value=s),r.defaultValue=s}c=c??p,c=typeof c!="function"&&typeof c!="symbol"&&!!c,r.checked=k?r.checked:!!c,r.defaultChecked=!!c,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.name=E),ct(r)}function Ml(r,s,o){s==="number"&&Wr(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function es(r,s,o,c){if(r=r.options,s){s={};for(var p=0;p<o.length;p++)s["$"+o[p]]=!0;for(o=0;o<r.length;o++)p=s.hasOwnProperty("$"+r[o].value),r[o].selected!==p&&(r[o].selected=p),p&&c&&(r[o].defaultSelected=!0)}else{for(o=""+un(o),s=null,p=0;p<r.length;p++){if(r[p].value===o){r[p].selected=!0,c&&(r[p].defaultSelected=!0);return}s!==null||r[p].disabled||(s=r[p])}s!==null&&(s.selected=!0)}}function Ru(r,s,o){if(s!=null&&(s=""+un(s),s!==r.value&&(r.value=s),o==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=o!=null?""+un(o):""}function ts(r,s,o,c){if(s==null){if(c!=null){if(o!=null)throw Error(i(92));if(U(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),s=o}o=un(s),r.defaultValue=o,c=r.textContent,c===o&&c!==""&&c!==null&&(r.value=c),ct(r)}function Nn(r,s){if(s){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=s;return}}r.textContent=s}var Du=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nl(r,s,o){var c=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":c?r.setProperty(s,o):typeof o!="number"||o===0||Du.has(s)?s==="float"?r.cssFloat=o:r[s]=(""+o).trim():r[s]=o+"px"}function Pl(r,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?r.setProperty(c,""):c==="float"?r.cssFloat="":r[c]="");for(var p in s)c=s[p],s.hasOwnProperty(p)&&o[p]!==c&&Nl(r,p,c)}else for(var y in s)s.hasOwnProperty(y)&&Nl(r,y,s[y])}function Ya(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Iu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ns=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xa(r){return ns.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Tr(){}var Ll=null;function or(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var rs=null,Yr=null;function la(r){var s=ar(r);if(s&&(r=s.stateNode)){var o=r[cn]||null;e:switch(r=s.stateNode,s.type){case"input":if(Wa(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Mn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var c=o[s];if(c!==r&&c.form===r.form){var p=c[cn]||null;if(!p)throw Error(i(90));Wa(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<o.length;s++)c=o[s],c.form===r.form&&aa(c)}break e;case"textarea":Ru(r,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&es(r,!!o.multiple,s,!1)}}}var Ja=!1;function is(r,s,o){if(Ja)return r(s,o);Ja=!0;try{var c=r(s);return c}finally{if(Ja=!1,(rs!==null||Yr!==null)&&(Sd(),rs&&(s=rs,r=Yr,Yr=rs=null,la(s),r)))for(s=0;s<r.length;s++)la(r[s])}}function Ar(r,s){var o=r.stateNode;if(o===null)return null;var c=o[cn]||null;if(c===null)return null;o=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(r=r.type,c=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!c;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var lr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ca=!1;if(lr)try{var ht={};Object.defineProperty(ht,"passive",{get:function(){ca=!0}}),window.addEventListener("test",ht,ht),window.removeEventListener("test",ht,ht)}catch{ca=!1}var Xr=null,Vl=null,ua=null;function zl(){if(ua)return ua;var r,s=Vl,o=s.length,c,p="value"in Xr?Xr.value:Xr.textContent,y=p.length;for(r=0;r<o&&s[r]===p[r];r++);var E=o-r;for(c=1;c<=E&&s[o-c]===p[y-c];c++);return ua=p.slice(r,1<c?1-c:void 0)}function da(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function yi(){return!0}function Cr(){return!1}function pn(r){function s(o,c,p,y,E){this._reactName=o,this._targetInst=p,this.type=c,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var k in r)r.hasOwnProperty(k)&&(o=r[k],this[k]=o?o(y):y[k]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?yi:Cr,this.isPropagationStopped=Cr,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=yi)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=yi)},persist:function(){},isPersistent:yi}),s}var _i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jr=pn(_i),ss=v({},_i,{view:0,detail:0}),Ul=pn(ss),as,Za,Zr,eo=v({},ss,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:os,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Zr&&(Zr&&r.type==="mousemove"?(as=r.screenX-Zr.screenX,Za=r.screenY-Zr.screenY):Za=as=0,Zr=r),as)},movementY:function(r){return"movementY"in r?r.movementY:Za}}),Bl=pn(eo),ha=v({},eo,{dataTransfer:0}),ju=pn(ha),Ou=v({},ss,{relatedTarget:0}),fa=pn(Ou),Fl=v({},_i,{animationName:0,elapsedTime:0,pseudoElement:0}),ku=pn(Fl),to=v({},_i,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Mu=pn(to),Nu=v({},_i,{data:0}),ei=pn(Nu),Pu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zu(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=Vu[r])?!!s[r]:!1}function os(){return zu}var In=v({},ss,{key:function(r){if(r.key){var s=Pu[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=da(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Lu[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:os,charCode:function(r){return r.type==="keypress"?da(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?da(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Uu=pn(In),Bu=v({},eo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vi=pn(Bu),h=v({},ss,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:os}),b=pn(h),S=v({},_i,{propertyName:0,elapsedTime:0,pseudoElement:0}),V=pn(S),Z=v({},eo,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),se=pn(Z),Ee=v({},_i,{newState:0,oldState:0}),qe=pn(Ee),Lt=[9,13,27,32],st=lr&&"CompositionEvent"in window,Tt=null;lr&&"documentMode"in document&&(Tt=document.documentMode);var cr=lr&&"TextEvent"in window&&!Tt,ti=lr&&(!st||Tt&&8<Tt&&11>=Tt),Rr=" ",Dr=!1;function ma(r,s){switch(r){case"keyup":return Lt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function no(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ro=!1;function hT(r,s){switch(r){case"compositionend":return no(s);case"keypress":return s.which!==32?null:(Dr=!0,Rr);case"textInput":return r=s.data,r===Rr&&Dr?null:r;default:return null}}function fT(r,s){if(ro)return r==="compositionend"||!st&&ma(r,s)?(r=zl(),ua=Vl=Xr=null,ro=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ti&&s.locale!=="ko"?null:s.data;default:return null}}var mT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hy(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!mT[r.type]:s==="textarea"}function Gy(r,s,o,c){rs?Yr?Yr.push(c):Yr=[c]:rs=c,s=Id(s,"onChange"),0<s.length&&(o=new Jr("onChange","change",null,o,c),r.push({event:o,listeners:s}))}var ql=null,Hl=null;function pT(r){Cv(r,0)}function Fu(r){var s=Qn(r);if(aa(s))return r}function Qy(r,s){if(r==="change")return s}var $y=!1;if(lr){var bf;if(lr){var xf="oninput"in document;if(!xf){var Ky=document.createElement("div");Ky.setAttribute("oninput","return;"),xf=typeof Ky.oninput=="function"}bf=xf}else bf=!1;$y=bf&&(!document.documentMode||9<document.documentMode)}function Wy(){ql&&(ql.detachEvent("onpropertychange",Yy),Hl=ql=null)}function Yy(r){if(r.propertyName==="value"&&Fu(Hl)){var s=[];Gy(s,Hl,r,or(r)),is(pT,s)}}function gT(r,s,o){r==="focusin"?(Wy(),ql=s,Hl=o,ql.attachEvent("onpropertychange",Yy)):r==="focusout"&&Wy()}function yT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Fu(Hl)}function _T(r,s){if(r==="click")return Fu(s)}function vT(r,s){if(r==="input"||r==="change")return Fu(s)}function bT(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Kn=typeof Object.is=="function"?Object.is:bT;function Gl(r,s){if(Kn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var o=Object.keys(r),c=Object.keys(s);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var p=o[c];if(!lt.call(s,p)||!Kn(r[p],s[p]))return!1}return!0}function Xy(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Jy(r,s){var o=Xy(r);r=0;for(var c;o;){if(o.nodeType===3){if(c=r+o.textContent.length,r<=s&&c>=s)return{node:o,offset:s-r};r=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Xy(o)}}function Zy(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?Zy(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function e_(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=Wr(r.document);s instanceof r.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)r=s.contentWindow;else break;s=Wr(r.document)}return s}function Ef(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var xT=lr&&"documentMode"in document&&11>=document.documentMode,io=null,Sf=null,Ql=null,wf=!1;function t_(r,s,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;wf||io==null||io!==Wr(c)||(c=io,"selectionStart"in c&&Ef(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Ql&&Gl(Ql,c)||(Ql=c,c=Id(Sf,"onSelect"),0<c.length&&(s=new Jr("onSelect","select",null,s,o),r.push({event:s,listeners:c}),s.target=io)))}function pa(r,s){var o={};return o[r.toLowerCase()]=s.toLowerCase(),o["Webkit"+r]="webkit"+s,o["Moz"+r]="moz"+s,o}var so={animationend:pa("Animation","AnimationEnd"),animationiteration:pa("Animation","AnimationIteration"),animationstart:pa("Animation","AnimationStart"),transitionrun:pa("Transition","TransitionRun"),transitionstart:pa("Transition","TransitionStart"),transitioncancel:pa("Transition","TransitionCancel"),transitionend:pa("Transition","TransitionEnd")},Tf={},n_={};lr&&(n_=document.createElement("div").style,"AnimationEvent"in window||(delete so.animationend.animation,delete so.animationiteration.animation,delete so.animationstart.animation),"TransitionEvent"in window||delete so.transitionend.transition);function ga(r){if(Tf[r])return Tf[r];if(!so[r])return r;var s=so[r],o;for(o in s)if(s.hasOwnProperty(o)&&o in n_)return Tf[r]=s[o];return r}var r_=ga("animationend"),i_=ga("animationiteration"),s_=ga("animationstart"),ET=ga("transitionrun"),ST=ga("transitionstart"),wT=ga("transitioncancel"),a_=ga("transitionend"),o_=new Map,Af="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Af.push("scrollEnd");function Ir(r,s){o_.set(r,s),$r(s,[r])}var qu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},ur=[],ao=0,Cf=0;function Hu(){for(var r=ao,s=Cf=ao=0;s<r;){var o=ur[s];ur[s++]=null;var c=ur[s];ur[s++]=null;var p=ur[s];ur[s++]=null;var y=ur[s];if(ur[s++]=null,c!==null&&p!==null){var E=c.pending;E===null?p.next=p:(p.next=E.next,E.next=p),c.pending=p}y!==0&&l_(o,p,y)}}function Gu(r,s,o,c){ur[ao++]=r,ur[ao++]=s,ur[ao++]=o,ur[ao++]=c,Cf|=c,r.lanes|=c,r=r.alternate,r!==null&&(r.lanes|=c)}function Rf(r,s,o,c){return Gu(r,s,o,c),Qu(r)}function ya(r,s){return Gu(r,null,null,s),Qu(r)}function l_(r,s,o){r.lanes|=o;var c=r.alternate;c!==null&&(c.lanes|=o);for(var p=!1,y=r.return;y!==null;)y.childLanes|=o,c=y.alternate,c!==null&&(c.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(p=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,p&&s!==null&&(p=31-Pt(o),r=y.hiddenUpdates,c=r[p],c===null?r[p]=[s]:c.push(s),s.lane=o|536870912),y):null}function Qu(r){if(50<mc)throw mc=0,Lm=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var oo={};function TT(r,s,o,c){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(r,s,o,c){return new TT(r,s,o,c)}function Df(r){return r=r.prototype,!(!r||!r.isReactComponent)}function bi(r,s){var o=r.alternate;return o===null?(o=Wn(r.tag,s,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=s,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,s=r.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function c_(r,s){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,s=o.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function $u(r,s,o,c,p,y){var E=0;if(c=r,typeof r=="function")Df(r)&&(E=1);else if(typeof r=="string")E=IA(r,o,ne.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case D:return r=Wn(31,o,s,p),r.elementType=D,r.lanes=y,r;case I:return _a(o.children,p,y,s);case N:E=8,p|=24;break;case H:return r=Wn(12,o,s,p|2),r.elementType=H,r.lanes=y,r;case ie:return r=Wn(13,o,s,p),r.elementType=ie,r.lanes=y,r;case he:return r=Wn(19,o,s,p),r.elementType=he,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case q:E=10;break e;case $:E=9;break e;case me:E=11;break e;case L:E=14;break e;case R:E=16,c=null;break e}E=29,o=Error(i(130,r===null?"null":typeof r,"")),c=null}return s=Wn(E,o,s,p),s.elementType=r,s.type=c,s.lanes=y,s}function _a(r,s,o,c){return r=Wn(7,r,c,s),r.lanes=o,r}function If(r,s,o){return r=Wn(6,r,null,s),r.lanes=o,r}function u_(r){var s=Wn(18,null,null,0);return s.stateNode=r,s}function jf(r,s,o){return s=Wn(4,r.children!==null?r.children:[],r.key,s),s.lanes=o,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var d_=new WeakMap;function dr(r,s){if(typeof r=="object"&&r!==null){var o=d_.get(r);return o!==void 0?o:(s={value:r,source:s,stack:en(s)},d_.set(r,s),s)}return{value:r,source:s,stack:en(s)}}var lo=[],co=0,Ku=null,$l=0,hr=[],fr=0,ls=null,ni=1,ri="";function xi(r,s){lo[co++]=$l,lo[co++]=Ku,Ku=r,$l=s}function h_(r,s,o){hr[fr++]=ni,hr[fr++]=ri,hr[fr++]=ls,ls=r;var c=ni;r=ri;var p=32-Pt(c)-1;c&=~(1<<p),o+=1;var y=32-Pt(s)+p;if(30<y){var E=p-p%5;y=(c&(1<<E)-1).toString(32),c>>=E,p-=E,ni=1<<32-Pt(s)+p|o<<p|c,ri=y+r}else ni=1<<y|o<<p|c,ri=r}function Of(r){r.return!==null&&(xi(r,1),h_(r,1,0))}function kf(r){for(;r===Ku;)Ku=lo[--co],lo[co]=null,$l=lo[--co],lo[co]=null;for(;r===ls;)ls=hr[--fr],hr[fr]=null,ri=hr[--fr],hr[fr]=null,ni=hr[--fr],hr[fr]=null}function f_(r,s){hr[fr++]=ni,hr[fr++]=ri,hr[fr++]=ls,ni=s.id,ri=s.overflow,ls=r}var gn=null,bt=null,tt=!1,cs=null,mr=!1,Mf=Error(i(519));function us(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Kl(dr(s,r)),Mf}function m_(r){var s=r.stateNode,o=r.type,c=r.memoizedProps;switch(s[qt]=r,s[cn]=c,o){case"dialog":We("cancel",s),We("close",s);break;case"iframe":case"object":case"embed":We("load",s);break;case"video":case"audio":for(o=0;o<gc.length;o++)We(gc[o],s);break;case"source":We("error",s);break;case"img":case"image":case"link":We("error",s),We("load",s);break;case"details":We("toggle",s);break;case"input":We("invalid",s),Cu(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":We("invalid",s);break;case"textarea":We("invalid",s),ts(s,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||c.suppressHydrationWarning===!0||jv(s.textContent,o)?(c.popover!=null&&(We("beforetoggle",s),We("toggle",s)),c.onScroll!=null&&We("scroll",s),c.onScrollEnd!=null&&We("scrollend",s),c.onClick!=null&&(s.onclick=Tr),s=!0):s=!1,s||us(r,!0)}function p_(r){for(gn=r.return;gn;)switch(gn.tag){case 5:case 31:case 13:mr=!1;return;case 27:case 3:mr=!0;return;default:gn=gn.return}}function uo(r){if(r!==gn)return!1;if(!tt)return p_(r),tt=!0,!1;var s=r.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||Jm(r.type,r.memoizedProps)),o=!o),o&&bt&&us(r),p_(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));bt=Uv(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));bt=Uv(r)}else s===27?(s=bt,ws(r.type)?(r=rp,rp=null,bt=r):bt=s):bt=gn?gr(r.stateNode.nextSibling):null;return!0}function va(){bt=gn=null,tt=!1}function Nf(){var r=cs;return r!==null&&(zn===null?zn=r:zn.push.apply(zn,r),cs=null),r}function Kl(r){cs===null?cs=[r]:cs.push(r)}var Pf=z(null),ba=null,Ei=null;function ds(r,s,o){W(Pf,s._currentValue),s._currentValue=o}function Si(r){r._currentValue=Pf.current,F(Pf)}function Lf(r,s,o){for(;r!==null;){var c=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),r===o)break;r=r.return}}function Vf(r,s,o,c){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var y=p.dependencies;if(y!==null){var E=p.child;y=y.firstContext;e:for(;y!==null;){var k=y;y=p;for(var G=0;G<s.length;G++)if(k.context===s[G]){y.lanes|=o,k=y.alternate,k!==null&&(k.lanes|=o),Lf(y.return,o,r),c||(E=null);break e}y=k.next}}else if(p.tag===18){if(E=p.return,E===null)throw Error(i(341));E.lanes|=o,y=E.alternate,y!==null&&(y.lanes|=o),Lf(E,o,r),E=null}else E=p.child;if(E!==null)E.return=p;else for(E=p;E!==null;){if(E===r){E=null;break}if(p=E.sibling,p!==null){p.return=E.return,E=p;break}E=E.return}p=E}}function ho(r,s,o,c){r=null;for(var p=s,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var E=p.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var k=p.type;Kn(p.pendingProps.value,E.value)||(r!==null?r.push(k):r=[k])}}else if(p===ue.current){if(E=p.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(xc):r=[xc])}p=p.return}r!==null&&Vf(s,r,o,c),s.flags|=262144}function Wu(r){for(r=r.firstContext;r!==null;){if(!Kn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function xa(r){ba=r,Ei=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function yn(r){return g_(ba,r)}function Yu(r,s){return ba===null&&xa(r),g_(r,s)}function g_(r,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Ei===null){if(r===null)throw Error(i(308));Ei=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else Ei=Ei.next=s;return o}var AT=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(o,c){r.push(c)}};this.abort=function(){s.aborted=!0,r.forEach(function(o){return o()})}},CT=t.unstable_scheduleCallback,RT=t.unstable_NormalPriority,Qt={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zf(){return{controller:new AT,data:new Map,refCount:0}}function Wl(r){r.refCount--,r.refCount===0&&CT(RT,function(){r.controller.abort()})}var Yl=null,Uf=0,fo=0,mo=null;function DT(r,s){if(Yl===null){var o=Yl=[];Uf=0,fo=qm(),mo={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Uf++,s.then(y_,y_),s}function y_(){if(--Uf===0&&Yl!==null){mo!==null&&(mo.status="fulfilled");var r=Yl;Yl=null,fo=0,mo=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function IT(r,s){var o=[],c={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return r.then(function(){c.status="fulfilled",c.value=s;for(var p=0;p<o.length;p++)(0,o[p])(s)},function(p){for(c.status="rejected",c.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),c}var __=P.S;P.S=function(r,s){tv=Nt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&DT(r,s),__!==null&&__(r,s)};var Ea=z(null);function Bf(){var r=Ea.current;return r!==null?r:gt.pooledCache}function Xu(r,s){s===null?W(Ea,Ea.current):W(Ea,s.pool)}function v_(){var r=Bf();return r===null?null:{parent:Qt._currentValue,pool:r}}var po=Error(i(460)),Ff=Error(i(474)),Ju=Error(i(542)),Zu={then:function(){}};function b_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function x_(r,s,o){switch(o=r[o],o===void 0?r.push(s):o!==s&&(s.then(Tr,Tr),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,S_(r),r;default:if(typeof s.status=="string")s.then(Tr,Tr);else{if(r=gt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(c){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=c}},function(c){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,S_(r),r}throw wa=s,po}}function Sa(r){try{var s=r._init;return s(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(wa=o,po):o}}var wa=null;function E_(){if(wa===null)throw Error(i(459));var r=wa;return wa=null,r}function S_(r){if(r===po||r===Ju)throw Error(i(483))}var go=null,Xl=0;function ed(r){var s=Xl;return Xl+=1,go===null&&(go=[]),x_(go,r,s)}function Jl(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function td(r,s){throw s.$$typeof===x?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function w_(r){function s(X,K){if(r){var ee=X.deletions;ee===null?(X.deletions=[K],X.flags|=16):ee.push(K)}}function o(X,K){if(!r)return null;for(;K!==null;)s(X,K),K=K.sibling;return null}function c(X){for(var K=new Map;X!==null;)X.key!==null?K.set(X.key,X):K.set(X.index,X),X=X.sibling;return K}function p(X,K){return X=bi(X,K),X.index=0,X.sibling=null,X}function y(X,K,ee){return X.index=ee,r?(ee=X.alternate,ee!==null?(ee=ee.index,ee<K?(X.flags|=67108866,K):ee):(X.flags|=67108866,K)):(X.flags|=1048576,K)}function E(X){return r&&X.alternate===null&&(X.flags|=67108866),X}function k(X,K,ee,ge){return K===null||K.tag!==6?(K=If(ee,X.mode,ge),K.return=X,K):(K=p(K,ee),K.return=X,K)}function G(X,K,ee,ge){var Oe=ee.type;return Oe===I?fe(X,K,ee.props.children,ge,ee.key):K!==null&&(K.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===R&&Sa(Oe)===K.type)?(K=p(K,ee.props),Jl(K,ee),K.return=X,K):(K=$u(ee.type,ee.key,ee.props,null,X.mode,ge),Jl(K,ee),K.return=X,K)}function te(X,K,ee,ge){return K===null||K.tag!==4||K.stateNode.containerInfo!==ee.containerInfo||K.stateNode.implementation!==ee.implementation?(K=jf(ee,X.mode,ge),K.return=X,K):(K=p(K,ee.children||[]),K.return=X,K)}function fe(X,K,ee,ge,Oe){return K===null||K.tag!==7?(K=_a(ee,X.mode,ge,Oe),K.return=X,K):(K=p(K,ee),K.return=X,K)}function ye(X,K,ee){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=If(""+K,X.mode,ee),K.return=X,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case w:return ee=$u(K.type,K.key,K.props,null,X.mode,ee),Jl(ee,K),ee.return=X,ee;case A:return K=jf(K,X.mode,ee),K.return=X,K;case R:return K=Sa(K),ye(X,K,ee)}if(U(K)||O(K))return K=_a(K,X.mode,ee,null),K.return=X,K;if(typeof K.then=="function")return ye(X,ed(K),ee);if(K.$$typeof===q)return ye(X,Yu(X,K),ee);td(X,K)}return null}function re(X,K,ee,ge){var Oe=K!==null?K.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return Oe!==null?null:k(X,K,""+ee,ge);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case w:return ee.key===Oe?G(X,K,ee,ge):null;case A:return ee.key===Oe?te(X,K,ee,ge):null;case R:return ee=Sa(ee),re(X,K,ee,ge)}if(U(ee)||O(ee))return Oe!==null?null:fe(X,K,ee,ge,null);if(typeof ee.then=="function")return re(X,K,ed(ee),ge);if(ee.$$typeof===q)return re(X,K,Yu(X,ee),ge);td(X,ee)}return null}function oe(X,K,ee,ge,Oe){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return X=X.get(ee)||null,k(K,X,""+ge,Oe);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case w:return X=X.get(ge.key===null?ee:ge.key)||null,G(K,X,ge,Oe);case A:return X=X.get(ge.key===null?ee:ge.key)||null,te(K,X,ge,Oe);case R:return ge=Sa(ge),oe(X,K,ee,ge,Oe)}if(U(ge)||O(ge))return X=X.get(ee)||null,fe(K,X,ge,Oe,null);if(typeof ge.then=="function")return oe(X,K,ee,ed(ge),Oe);if(ge.$$typeof===q)return oe(X,K,ee,Yu(K,ge),Oe);td(K,ge)}return null}function Re(X,K,ee,ge){for(var Oe=null,rt=null,Ie=K,Ge=K=0,Xe=null;Ie!==null&&Ge<ee.length;Ge++){Ie.index>Ge?(Xe=Ie,Ie=null):Xe=Ie.sibling;var it=re(X,Ie,ee[Ge],ge);if(it===null){Ie===null&&(Ie=Xe);break}r&&Ie&&it.alternate===null&&s(X,Ie),K=y(it,K,Ge),rt===null?Oe=it:rt.sibling=it,rt=it,Ie=Xe}if(Ge===ee.length)return o(X,Ie),tt&&xi(X,Ge),Oe;if(Ie===null){for(;Ge<ee.length;Ge++)Ie=ye(X,ee[Ge],ge),Ie!==null&&(K=y(Ie,K,Ge),rt===null?Oe=Ie:rt.sibling=Ie,rt=Ie);return tt&&xi(X,Ge),Oe}for(Ie=c(Ie);Ge<ee.length;Ge++)Xe=oe(Ie,X,Ge,ee[Ge],ge),Xe!==null&&(r&&Xe.alternate!==null&&Ie.delete(Xe.key===null?Ge:Xe.key),K=y(Xe,K,Ge),rt===null?Oe=Xe:rt.sibling=Xe,rt=Xe);return r&&Ie.forEach(function(Ds){return s(X,Ds)}),tt&&xi(X,Ge),Oe}function Pe(X,K,ee,ge){if(ee==null)throw Error(i(151));for(var Oe=null,rt=null,Ie=K,Ge=K=0,Xe=null,it=ee.next();Ie!==null&&!it.done;Ge++,it=ee.next()){Ie.index>Ge?(Xe=Ie,Ie=null):Xe=Ie.sibling;var Ds=re(X,Ie,it.value,ge);if(Ds===null){Ie===null&&(Ie=Xe);break}r&&Ie&&Ds.alternate===null&&s(X,Ie),K=y(Ds,K,Ge),rt===null?Oe=Ds:rt.sibling=Ds,rt=Ds,Ie=Xe}if(it.done)return o(X,Ie),tt&&xi(X,Ge),Oe;if(Ie===null){for(;!it.done;Ge++,it=ee.next())it=ye(X,it.value,ge),it!==null&&(K=y(it,K,Ge),rt===null?Oe=it:rt.sibling=it,rt=it);return tt&&xi(X,Ge),Oe}for(Ie=c(Ie);!it.done;Ge++,it=ee.next())it=oe(Ie,X,Ge,it.value,ge),it!==null&&(r&&it.alternate!==null&&Ie.delete(it.key===null?Ge:it.key),K=y(it,K,Ge),rt===null?Oe=it:rt.sibling=it,rt=it);return r&&Ie.forEach(function(BA){return s(X,BA)}),tt&&xi(X,Ge),Oe}function pt(X,K,ee,ge){if(typeof ee=="object"&&ee!==null&&ee.type===I&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case w:e:{for(var Oe=ee.key;K!==null;){if(K.key===Oe){if(Oe=ee.type,Oe===I){if(K.tag===7){o(X,K.sibling),ge=p(K,ee.props.children),ge.return=X,X=ge;break e}}else if(K.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===R&&Sa(Oe)===K.type){o(X,K.sibling),ge=p(K,ee.props),Jl(ge,ee),ge.return=X,X=ge;break e}o(X,K);break}else s(X,K);K=K.sibling}ee.type===I?(ge=_a(ee.props.children,X.mode,ge,ee.key),ge.return=X,X=ge):(ge=$u(ee.type,ee.key,ee.props,null,X.mode,ge),Jl(ge,ee),ge.return=X,X=ge)}return E(X);case A:e:{for(Oe=ee.key;K!==null;){if(K.key===Oe)if(K.tag===4&&K.stateNode.containerInfo===ee.containerInfo&&K.stateNode.implementation===ee.implementation){o(X,K.sibling),ge=p(K,ee.children||[]),ge.return=X,X=ge;break e}else{o(X,K);break}else s(X,K);K=K.sibling}ge=jf(ee,X.mode,ge),ge.return=X,X=ge}return E(X);case R:return ee=Sa(ee),pt(X,K,ee,ge)}if(U(ee))return Re(X,K,ee,ge);if(O(ee)){if(Oe=O(ee),typeof Oe!="function")throw Error(i(150));return ee=Oe.call(ee),Pe(X,K,ee,ge)}if(typeof ee.then=="function")return pt(X,K,ed(ee),ge);if(ee.$$typeof===q)return pt(X,K,Yu(X,ee),ge);td(X,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,K!==null&&K.tag===6?(o(X,K.sibling),ge=p(K,ee),ge.return=X,X=ge):(o(X,K),ge=If(ee,X.mode,ge),ge.return=X,X=ge),E(X)):o(X,K)}return function(X,K,ee,ge){try{Xl=0;var Oe=pt(X,K,ee,ge);return go=null,Oe}catch(Ie){if(Ie===po||Ie===Ju)throw Ie;var rt=Wn(29,Ie,null,X.mode);return rt.lanes=ge,rt.return=X,rt}}}var Ta=w_(!0),T_=w_(!1),hs=!1;function qf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hf(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function fs(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ms(r,s,o){var c=r.updateQueue;if(c===null)return null;if(c=c.shared,(at&2)!==0){var p=c.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),c.pending=s,s=Qu(r),l_(r,null,o),s}return Gu(r,c,s,o),Qu(r)}function Zl(r,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var c=s.lanes;c&=r.pendingLanes,o|=c,s.lanes=o,Al(r,o)}}function Gf(r,s){var o=r.updateQueue,c=r.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?p=y=E:y=y.next=E,o=o.next}while(o!==null);y===null?p=y=s:y=y.next=s}else p=y=s;o={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:c.shared,callbacks:c.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=s:r.next=s,o.lastBaseUpdate=s}var Qf=!1;function ec(){if(Qf){var r=mo;if(r!==null)throw r}}function tc(r,s,o,c){Qf=!1;var p=r.updateQueue;hs=!1;var y=p.firstBaseUpdate,E=p.lastBaseUpdate,k=p.shared.pending;if(k!==null){p.shared.pending=null;var G=k,te=G.next;G.next=null,E===null?y=te:E.next=te,E=G;var fe=r.alternate;fe!==null&&(fe=fe.updateQueue,k=fe.lastBaseUpdate,k!==E&&(k===null?fe.firstBaseUpdate=te:k.next=te,fe.lastBaseUpdate=G))}if(y!==null){var ye=p.baseState;E=0,fe=te=G=null,k=y;do{var re=k.lane&-536870913,oe=re!==k.lane;if(oe?(Ye&re)===re:(c&re)===re){re!==0&&re===fo&&(Qf=!0),fe!==null&&(fe=fe.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Re=r,Pe=k;re=s;var pt=o;switch(Pe.tag){case 1:if(Re=Pe.payload,typeof Re=="function"){ye=Re.call(pt,ye,re);break e}ye=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Pe.payload,re=typeof Re=="function"?Re.call(pt,ye,re):Re,re==null)break e;ye=v({},ye,re);break e;case 2:hs=!0}}re=k.callback,re!==null&&(r.flags|=64,oe&&(r.flags|=8192),oe=p.callbacks,oe===null?p.callbacks=[re]:oe.push(re))}else oe={lane:re,tag:k.tag,payload:k.payload,callback:k.callback,next:null},fe===null?(te=fe=oe,G=ye):fe=fe.next=oe,E|=re;if(k=k.next,k===null){if(k=p.shared.pending,k===null)break;oe=k,k=oe.next,oe.next=null,p.lastBaseUpdate=oe,p.shared.pending=null}}while(!0);fe===null&&(G=ye),p.baseState=G,p.firstBaseUpdate=te,p.lastBaseUpdate=fe,y===null&&(p.shared.lanes=0),vs|=E,r.lanes=E,r.memoizedState=ye}}function A_(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function C_(r,s){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)A_(o[r],s)}var yo=z(null),nd=z(0);function R_(r,s){r=Oi,W(nd,r),W(yo,s),Oi=r|s.baseLanes}function $f(){W(nd,Oi),W(yo,yo.current)}function Kf(){Oi=nd.current,F(yo),F(nd)}var Yn=z(null),pr=null;function ps(r){var s=r.alternate;W(Vt,Vt.current&1),W(Yn,r),pr===null&&(s===null||yo.current!==null||s.memoizedState!==null)&&(pr=r)}function Wf(r){W(Vt,Vt.current),W(Yn,r),pr===null&&(pr=r)}function D_(r){r.tag===22?(W(Vt,Vt.current),W(Yn,r),pr===null&&(pr=r)):gs()}function gs(){W(Vt,Vt.current),W(Yn,Yn.current)}function Xn(r){F(Yn),pr===r&&(pr=null),F(Vt)}var Vt=z(0);function rd(r){for(var s=r;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||tp(o)||np(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var wi=0,He=null,ft=null,$t=null,id=!1,_o=!1,Aa=!1,sd=0,nc=0,vo=null,jT=0;function Ot(){throw Error(i(321))}function Yf(r,s){if(s===null)return!1;for(var o=0;o<s.length&&o<r.length;o++)if(!Kn(r[o],s[o]))return!1;return!0}function Xf(r,s,o,c,p,y){return wi=y,He=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,P.H=r===null||r.memoizedState===null?h0:hm,Aa=!1,y=o(c,p),Aa=!1,_o&&(y=j_(s,o,c,p)),I_(r),y}function I_(r){P.H=sc;var s=ft!==null&&ft.next!==null;if(wi=0,$t=ft=He=null,id=!1,nc=0,vo=null,s)throw Error(i(300));r===null||Kt||(r=r.dependencies,r!==null&&Wu(r)&&(Kt=!0))}function j_(r,s,o,c){He=r;var p=0;do{if(_o&&(vo=null),nc=0,_o=!1,25<=p)throw Error(i(301));if(p+=1,$t=ft=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}P.H=f0,y=s(o,c)}while(_o);return y}function OT(){var r=P.H,s=r.useState()[0];return s=typeof s.then=="function"?rc(s):s,r=r.useState()[0],(ft!==null?ft.memoizedState:null)!==r&&(He.flags|=1024),s}function Jf(){var r=sd!==0;return sd=0,r}function Zf(r,s,o){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~o}function em(r){if(id){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}id=!1}wi=0,$t=ft=He=null,_o=!1,nc=sd=0,vo=null}function jn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?He.memoizedState=$t=r:$t=$t.next=r,$t}function zt(){if(ft===null){var r=He.alternate;r=r!==null?r.memoizedState:null}else r=ft.next;var s=$t===null?He.memoizedState:$t.next;if(s!==null)$t=s,ft=r;else{if(r===null)throw He.alternate===null?Error(i(467)):Error(i(310));ft=r,r={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},$t===null?He.memoizedState=$t=r:$t=$t.next=r}return $t}function ad(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rc(r){var s=nc;return nc+=1,vo===null&&(vo=[]),r=x_(vo,r,s),s=He,($t===null?s.memoizedState:$t.next)===null&&(s=s.alternate,P.H=s===null||s.memoizedState===null?h0:hm),r}function od(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return rc(r);if(r.$$typeof===q)return yn(r)}throw Error(i(438,String(r)))}function tm(r){var s=null,o=He.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var c=He.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=ad(),He.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(r),c=0;c<r;c++)o[c]=M;return s.index++,o}function Ti(r,s){return typeof s=="function"?s(r):s}function ld(r){var s=zt();return nm(s,ft,r)}function nm(r,s,o){var c=r.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var p=r.baseQueue,y=c.pending;if(y!==null){if(p!==null){var E=p.next;p.next=y.next,y.next=E}s.baseQueue=p=y,c.pending=null}if(y=r.baseState,p===null)r.memoizedState=y;else{s=p.next;var k=E=null,G=null,te=s,fe=!1;do{var ye=te.lane&-536870913;if(ye!==te.lane?(Ye&ye)===ye:(wi&ye)===ye){var re=te.revertLane;if(re===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),ye===fo&&(fe=!0);else if((wi&re)===re){te=te.next,re===fo&&(fe=!0);continue}else ye={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},G===null?(k=G=ye,E=y):G=G.next=ye,He.lanes|=re,vs|=re;ye=te.action,Aa&&o(y,ye),y=te.hasEagerState?te.eagerState:o(y,ye)}else re={lane:ye,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},G===null?(k=G=re,E=y):G=G.next=re,He.lanes|=ye,vs|=ye;te=te.next}while(te!==null&&te!==s);if(G===null?E=y:G.next=k,!Kn(y,r.memoizedState)&&(Kt=!0,fe&&(o=mo,o!==null)))throw o;r.memoizedState=y,r.baseState=E,r.baseQueue=G,c.lastRenderedState=y}return p===null&&(c.lanes=0),[r.memoizedState,c.dispatch]}function rm(r){var s=zt(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var c=o.dispatch,p=o.pending,y=s.memoizedState;if(p!==null){o.pending=null;var E=p=p.next;do y=r(y,E.action),E=E.next;while(E!==p);Kn(y,s.memoizedState)||(Kt=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,c]}function O_(r,s,o){var c=He,p=zt(),y=tt;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var E=!Kn((ft||p).memoizedState,o);if(E&&(p.memoizedState=o,Kt=!0),p=p.queue,am(N_.bind(null,c,p,r),[r]),p.getSnapshot!==s||E||$t!==null&&$t.memoizedState.tag&1){if(c.flags|=2048,bo(9,{destroy:void 0},M_.bind(null,c,p,o,s),null),gt===null)throw Error(i(349));y||(wi&127)!==0||k_(c,s,o)}return o}function k_(r,s,o){r.flags|=16384,r={getSnapshot:s,value:o},s=He.updateQueue,s===null?(s=ad(),He.updateQueue=s,s.stores=[r]):(o=s.stores,o===null?s.stores=[r]:o.push(r))}function M_(r,s,o,c){s.value=o,s.getSnapshot=c,P_(s)&&L_(r)}function N_(r,s,o){return o(function(){P_(s)&&L_(r)})}function P_(r){var s=r.getSnapshot;r=r.value;try{var o=s();return!Kn(r,o)}catch{return!0}}function L_(r){var s=ya(r,2);s!==null&&Un(s,r,2)}function im(r){var s=jn();if(typeof r=="function"){var o=r;if(r=o(),Aa){sr(!0);try{o()}finally{sr(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:r},s}function V_(r,s,o,c){return r.baseState=o,nm(r,ft,typeof c=="function"?c:Ti)}function kT(r,s,o,c,p){if(dd(r))throw Error(i(485));if(r=s.action,r!==null){var y={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){y.listeners.push(E)}};P.T!==null?o(!0):y.isTransition=!1,c(y),o=s.pending,o===null?(y.next=s.pending=y,z_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function z_(r,s){var o=s.action,c=s.payload,p=r.state;if(s.isTransition){var y=P.T,E={};P.T=E;try{var k=o(p,c),G=P.S;G!==null&&G(E,k),U_(r,s,k)}catch(te){sm(r,s,te)}finally{y!==null&&E.types!==null&&(y.types=E.types),P.T=y}}else try{y=o(p,c),U_(r,s,y)}catch(te){sm(r,s,te)}}function U_(r,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){B_(r,s,c)},function(c){return sm(r,s,c)}):B_(r,s,o)}function B_(r,s,o){s.status="fulfilled",s.value=o,F_(s),r.state=o,s=r.pending,s!==null&&(o=s.next,o===s?r.pending=null:(o=o.next,s.next=o,z_(r,o)))}function sm(r,s,o){var c=r.pending;if(r.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=o,F_(s),s=s.next;while(s!==c)}r.action=null}function F_(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function q_(r,s){return s}function H_(r,s){if(tt){var o=gt.formState;if(o!==null){e:{var c=He;if(tt){if(bt){t:{for(var p=bt,y=mr;p.nodeType!==8;){if(!y){p=null;break t}if(p=gr(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){bt=gr(p.nextSibling),c=p.data==="F!";break e}}us(c)}c=!1}c&&(s=o[0])}}return o=jn(),o.memoizedState=o.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:q_,lastRenderedState:s},o.queue=c,o=c0.bind(null,He,c),c.dispatch=o,c=im(!1),y=dm.bind(null,He,!1,c.queue),c=jn(),p={state:s,dispatch:null,action:r,pending:null},c.queue=p,o=kT.bind(null,He,p,y,o),p.dispatch=o,c.memoizedState=r,[s,o,!1]}function G_(r){var s=zt();return Q_(s,ft,r)}function Q_(r,s,o){if(s=nm(r,s,q_)[0],r=ld(Ti)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=rc(s)}catch(E){throw E===po?Ju:E}else c=s;s=zt();var p=s.queue,y=p.dispatch;return o!==s.memoizedState&&(He.flags|=2048,bo(9,{destroy:void 0},MT.bind(null,p,o),null)),[c,y,r]}function MT(r,s){r.action=s}function $_(r){var s=zt(),o=ft;if(o!==null)return Q_(s,o,r);zt(),s=s.memoizedState,o=zt();var c=o.queue.dispatch;return o.memoizedState=r,[s,c,!1]}function bo(r,s,o,c){return r={tag:r,create:o,deps:c,inst:s,next:null},s=He.updateQueue,s===null&&(s=ad(),He.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=r.next=r:(c=o.next,o.next=r,r.next=c,s.lastEffect=r),r}function K_(){return zt().memoizedState}function cd(r,s,o,c){var p=jn();He.flags|=r,p.memoizedState=bo(1|s,{destroy:void 0},o,c===void 0?null:c)}function ud(r,s,o,c){var p=zt();c=c===void 0?null:c;var y=p.memoizedState.inst;ft!==null&&c!==null&&Yf(c,ft.memoizedState.deps)?p.memoizedState=bo(s,y,o,c):(He.flags|=r,p.memoizedState=bo(1|s,y,o,c))}function W_(r,s){cd(8390656,8,r,s)}function am(r,s){ud(2048,8,r,s)}function NT(r){He.flags|=4;var s=He.updateQueue;if(s===null)s=ad(),He.updateQueue=s,s.events=[r];else{var o=s.events;o===null?s.events=[r]:o.push(r)}}function Y_(r){var s=zt().memoizedState;return NT({ref:s,nextImpl:r}),function(){if((at&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function X_(r,s){return ud(4,2,r,s)}function J_(r,s){return ud(4,4,r,s)}function Z_(r,s){if(typeof s=="function"){r=r();var o=s(r);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function e0(r,s,o){o=o!=null?o.concat([r]):null,ud(4,4,Z_.bind(null,s,r),o)}function om(){}function t0(r,s){var o=zt();s=s===void 0?null:s;var c=o.memoizedState;return s!==null&&Yf(s,c[1])?c[0]:(o.memoizedState=[r,s],r)}function n0(r,s){var o=zt();s=s===void 0?null:s;var c=o.memoizedState;if(s!==null&&Yf(s,c[1]))return c[0];if(c=r(),Aa){sr(!0);try{r()}finally{sr(!1)}}return o.memoizedState=[c,s],c}function lm(r,s,o){return o===void 0||(wi&1073741824)!==0&&(Ye&261930)===0?r.memoizedState=s:(r.memoizedState=o,r=rv(),He.lanes|=r,vs|=r,o)}function r0(r,s,o,c){return Kn(o,s)?o:yo.current!==null?(r=lm(r,o,c),Kn(r,s)||(Kt=!0),r):(wi&42)===0||(wi&1073741824)!==0&&(Ye&261930)===0?(Kt=!0,r.memoizedState=o):(r=rv(),He.lanes|=r,vs|=r,s)}function i0(r,s,o,c,p){var y=B.p;B.p=y!==0&&8>y?y:8;var E=P.T,k={};P.T=k,dm(r,!1,s,o);try{var G=p(),te=P.S;if(te!==null&&te(k,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var fe=IT(G,c);ic(r,s,fe,er(r))}else ic(r,s,c,er(r))}catch(ye){ic(r,s,{then:function(){},status:"rejected",reason:ye},er())}finally{B.p=y,E!==null&&k.types!==null&&(E.types=k.types),P.T=E}}function PT(){}function cm(r,s,o,c){if(r.tag!==5)throw Error(i(476));var p=s0(r).queue;i0(r,p,s,Q,o===null?PT:function(){return a0(r),o(c)})}function s0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:Q,baseState:Q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:Q},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:o},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function a0(r){var s=s0(r);s.next===null&&(s=r.alternate.memoizedState),ic(r,s.next.queue,{},er())}function um(){return yn(xc)}function o0(){return zt().memoizedState}function l0(){return zt().memoizedState}function LT(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var o=er();r=fs(o);var c=ms(s,r,o);c!==null&&(Un(c,s,o),Zl(c,s,o)),s={cache:zf()},r.payload=s;return}s=s.return}}function VT(r,s,o){var c=er();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},dd(r)?u0(s,o):(o=Rf(r,s,o,c),o!==null&&(Un(o,r,c),d0(o,s,c)))}function c0(r,s,o){var c=er();ic(r,s,o,c)}function ic(r,s,o,c){var p={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(dd(r))u0(s,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var E=s.lastRenderedState,k=y(E,o);if(p.hasEagerState=!0,p.eagerState=k,Kn(k,E))return Gu(r,s,p,0),gt===null&&Hu(),!1}catch{}if(o=Rf(r,s,p,c),o!==null)return Un(o,r,c),d0(o,s,c),!0}return!1}function dm(r,s,o,c){if(c={lane:2,revertLane:qm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},dd(r)){if(s)throw Error(i(479))}else s=Rf(r,o,c,2),s!==null&&Un(s,r,2)}function dd(r){var s=r.alternate;return r===He||s!==null&&s===He}function u0(r,s){_o=id=!0;var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}function d0(r,s,o){if((o&4194048)!==0){var c=s.lanes;c&=r.pendingLanes,o|=c,s.lanes=o,Al(r,o)}}var sc={readContext:yn,use:od,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useLayoutEffect:Ot,useInsertionEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useSyncExternalStore:Ot,useId:Ot,useHostTransitionStatus:Ot,useFormState:Ot,useActionState:Ot,useOptimistic:Ot,useMemoCache:Ot,useCacheRefresh:Ot};sc.useEffectEvent=Ot;var h0={readContext:yn,use:od,useCallback:function(r,s){return jn().memoizedState=[r,s===void 0?null:s],r},useContext:yn,useEffect:W_,useImperativeHandle:function(r,s,o){o=o!=null?o.concat([r]):null,cd(4194308,4,Z_.bind(null,s,r),o)},useLayoutEffect:function(r,s){return cd(4194308,4,r,s)},useInsertionEffect:function(r,s){cd(4,2,r,s)},useMemo:function(r,s){var o=jn();s=s===void 0?null:s;var c=r();if(Aa){sr(!0);try{r()}finally{sr(!1)}}return o.memoizedState=[c,s],c},useReducer:function(r,s,o){var c=jn();if(o!==void 0){var p=o(s);if(Aa){sr(!0);try{o(s)}finally{sr(!1)}}}else p=s;return c.memoizedState=c.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},c.queue=r,r=r.dispatch=VT.bind(null,He,r),[c.memoizedState,r]},useRef:function(r){var s=jn();return r={current:r},s.memoizedState=r},useState:function(r){r=im(r);var s=r.queue,o=c0.bind(null,He,s);return s.dispatch=o,[r.memoizedState,o]},useDebugValue:om,useDeferredValue:function(r,s){var o=jn();return lm(o,r,s)},useTransition:function(){var r=im(!1);return r=i0.bind(null,He,r.queue,!0,!1),jn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,o){var c=He,p=jn();if(tt){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),gt===null)throw Error(i(349));(Ye&127)!==0||k_(c,s,o)}p.memoizedState=o;var y={value:o,getSnapshot:s};return p.queue=y,W_(N_.bind(null,c,y,r),[r]),c.flags|=2048,bo(9,{destroy:void 0},M_.bind(null,c,y,o,s),null),o},useId:function(){var r=jn(),s=gt.identifierPrefix;if(tt){var o=ri,c=ni;o=(c&~(1<<32-Pt(c)-1)).toString(32)+o,s="_"+s+"R_"+o,o=sd++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=jT++,s="_"+s+"r_"+o.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:um,useFormState:H_,useActionState:H_,useOptimistic:function(r){var s=jn();s.memoizedState=s.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=dm.bind(null,He,!0,o),o.dispatch=s,[r,s]},useMemoCache:tm,useCacheRefresh:function(){return jn().memoizedState=LT.bind(null,He)},useEffectEvent:function(r){var s=jn(),o={impl:r};return s.memoizedState=o,function(){if((at&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},hm={readContext:yn,use:od,useCallback:t0,useContext:yn,useEffect:am,useImperativeHandle:e0,useInsertionEffect:X_,useLayoutEffect:J_,useMemo:n0,useReducer:ld,useRef:K_,useState:function(){return ld(Ti)},useDebugValue:om,useDeferredValue:function(r,s){var o=zt();return r0(o,ft.memoizedState,r,s)},useTransition:function(){var r=ld(Ti)[0],s=zt().memoizedState;return[typeof r=="boolean"?r:rc(r),s]},useSyncExternalStore:O_,useId:o0,useHostTransitionStatus:um,useFormState:G_,useActionState:G_,useOptimistic:function(r,s){var o=zt();return V_(o,ft,r,s)},useMemoCache:tm,useCacheRefresh:l0};hm.useEffectEvent=Y_;var f0={readContext:yn,use:od,useCallback:t0,useContext:yn,useEffect:am,useImperativeHandle:e0,useInsertionEffect:X_,useLayoutEffect:J_,useMemo:n0,useReducer:rm,useRef:K_,useState:function(){return rm(Ti)},useDebugValue:om,useDeferredValue:function(r,s){var o=zt();return ft===null?lm(o,r,s):r0(o,ft.memoizedState,r,s)},useTransition:function(){var r=rm(Ti)[0],s=zt().memoizedState;return[typeof r=="boolean"?r:rc(r),s]},useSyncExternalStore:O_,useId:o0,useHostTransitionStatus:um,useFormState:$_,useActionState:$_,useOptimistic:function(r,s){var o=zt();return ft!==null?V_(o,ft,r,s):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:tm,useCacheRefresh:l0};f0.useEffectEvent=Y_;function fm(r,s,o,c){s=r.memoizedState,o=o(c,s),o=o==null?s:v({},s,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var mm={enqueueSetState:function(r,s,o){r=r._reactInternals;var c=er(),p=fs(c);p.payload=s,o!=null&&(p.callback=o),s=ms(r,p,c),s!==null&&(Un(s,r,c),Zl(s,r,c))},enqueueReplaceState:function(r,s,o){r=r._reactInternals;var c=er(),p=fs(c);p.tag=1,p.payload=s,o!=null&&(p.callback=o),s=ms(r,p,c),s!==null&&(Un(s,r,c),Zl(s,r,c))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var o=er(),c=fs(o);c.tag=2,s!=null&&(c.callback=s),s=ms(r,c,o),s!==null&&(Un(s,r,o),Zl(s,r,o))}};function m0(r,s,o,c,p,y,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(c,y,E):s.prototype&&s.prototype.isPureReactComponent?!Gl(o,c)||!Gl(p,y):!0}function p0(r,s,o,c){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,c),s.state!==r&&mm.enqueueReplaceState(s,s.state,null)}function Ca(r,s){var o=s;if("ref"in s){o={};for(var c in s)c!=="ref"&&(o[c]=s[c])}if(r=r.defaultProps){o===s&&(o=v({},o));for(var p in r)o[p]===void 0&&(o[p]=r[p])}return o}function g0(r){qu(r)}function y0(r){console.error(r)}function _0(r){qu(r)}function hd(r,s){try{var o=r.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function v0(r,s,o){try{var c=r.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function pm(r,s,o){return o=fs(o),o.tag=3,o.payload={element:null},o.callback=function(){hd(r,s)},o}function b0(r){return r=fs(r),r.tag=3,r}function x0(r,s,o,c){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var y=c.value;r.payload=function(){return p(y)},r.callback=function(){v0(s,o,c)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(r.callback=function(){v0(s,o,c),typeof p!="function"&&(bs===null?bs=new Set([this]):bs.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})})}function zT(r,s,o,c,p){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=o.alternate,s!==null&&ho(s,o,p,!0),o=Yn.current,o!==null){switch(o.tag){case 31:case 13:return pr===null?wd():o.alternate===null&&kt===0&&(kt=3),o.flags&=-257,o.flags|=65536,o.lanes=p,c===Zu?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([c]):s.add(c),Um(r,c,p)),!1;case 22:return o.flags|=65536,c===Zu?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([c]):o.add(c)),Um(r,c,p)),!1}throw Error(i(435,o.tag))}return Um(r,c,p),wd(),!1}if(tt)return s=Yn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,c!==Mf&&(r=Error(i(422),{cause:c}),Kl(dr(r,o)))):(c!==Mf&&(s=Error(i(423),{cause:c}),Kl(dr(s,o))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,c=dr(c,o),p=pm(r.stateNode,c,p),Gf(r,p),kt!==4&&(kt=2)),!1;var y=Error(i(520),{cause:c});if(y=dr(y,o),fc===null?fc=[y]:fc.push(y),kt!==4&&(kt=2),s===null)return!0;c=dr(c,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,r=p&-p,o.lanes|=r,r=pm(o.stateNode,c,r),Gf(o,r),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(bs===null||!bs.has(y))))return o.flags|=65536,p&=-p,o.lanes|=p,p=b0(p),x0(p,r,o,c),Gf(o,p),!1}o=o.return}while(o!==null);return!1}var gm=Error(i(461)),Kt=!1;function _n(r,s,o,c){s.child=r===null?T_(s,null,o,c):Ta(s,r.child,o,c)}function E0(r,s,o,c,p){o=o.render;var y=s.ref;if("ref"in c){var E={};for(var k in c)k!=="ref"&&(E[k]=c[k])}else E=c;return xa(s),c=Xf(r,s,o,E,y,p),k=Jf(),r!==null&&!Kt?(Zf(r,s,p),Ai(r,s,p)):(tt&&k&&Of(s),s.flags|=1,_n(r,s,c,p),s.child)}function S0(r,s,o,c,p){if(r===null){var y=o.type;return typeof y=="function"&&!Df(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,w0(r,s,y,c,p)):(r=$u(o.type,null,c,s,s.mode,p),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,!wm(r,p)){var E=y.memoizedProps;if(o=o.compare,o=o!==null?o:Gl,o(E,c)&&r.ref===s.ref)return Ai(r,s,p)}return s.flags|=1,r=bi(y,c),r.ref=s.ref,r.return=s,s.child=r}function w0(r,s,o,c,p){if(r!==null){var y=r.memoizedProps;if(Gl(y,c)&&r.ref===s.ref)if(Kt=!1,s.pendingProps=c=y,wm(r,p))(r.flags&131072)!==0&&(Kt=!0);else return s.lanes=r.lanes,Ai(r,s,p)}return ym(r,s,o,c,p)}function T0(r,s,o,c){var p=c.children,y=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(c=s.child=r.child,p=0;c!==null;)p=p|c.lanes|c.childLanes,c=c.sibling;c=p&~y}else c=0,s.child=null;return A0(r,s,y,o,c)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&Xu(s,y!==null?y.cachePool:null),y!==null?R_(s,y):$f(),D_(s);else return c=s.lanes=536870912,A0(r,s,y!==null?y.baseLanes|o:o,o,c)}else y!==null?(Xu(s,y.cachePool),R_(s,y),gs(),s.memoizedState=null):(r!==null&&Xu(s,null),$f(),gs());return _n(r,s,p,o),s.child}function ac(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function A0(r,s,o,c,p){var y=Bf();return y=y===null?null:{parent:Qt._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},r!==null&&Xu(s,null),$f(),D_(s),r!==null&&ho(r,s,c,!0),s.childLanes=p,null}function fd(r,s){return s=pd({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function C0(r,s,o){return Ta(s,r.child,null,o),r=fd(s,s.pendingProps),r.flags|=2,Xn(s),s.memoizedState=null,r}function UT(r,s,o){var c=s.pendingProps,p=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(tt){if(c.mode==="hidden")return r=fd(s,c),s.lanes=536870912,ac(null,r);if(Wf(s),(r=bt)?(r=zv(r,mr),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:ls!==null?{id:ni,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},o=u_(r),o.return=s,s.child=o,gn=s,bt=null)):r=null,r===null)throw us(s);return s.lanes=536870912,null}return fd(s,c)}var y=r.memoizedState;if(y!==null){var E=y.dehydrated;if(Wf(s),p)if(s.flags&256)s.flags&=-257,s=C0(r,s,o);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(Kt||ho(r,s,o,!1),p=(o&r.childLanes)!==0,Kt||p){if(c=gt,c!==null&&(E=Cl(c,o),E!==0&&E!==y.retryLane))throw y.retryLane=E,ya(r,E),Un(c,r,E),gm;wd(),s=C0(r,s,o)}else r=y.treeContext,bt=gr(E.nextSibling),gn=s,tt=!0,cs=null,mr=!1,r!==null&&f_(s,r),s=fd(s,c),s.flags|=4096;return s}return r=bi(r.child,{mode:c.mode,children:c.children}),r.ref=s.ref,s.child=r,r.return=s,r}function md(r,s){var o=s.ref;if(o===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(r===null||r.ref!==o)&&(s.flags|=4194816)}}function ym(r,s,o,c,p){return xa(s),o=Xf(r,s,o,c,void 0,p),c=Jf(),r!==null&&!Kt?(Zf(r,s,p),Ai(r,s,p)):(tt&&c&&Of(s),s.flags|=1,_n(r,s,o,p),s.child)}function R0(r,s,o,c,p,y){return xa(s),s.updateQueue=null,o=j_(s,c,o,p),I_(r),c=Jf(),r!==null&&!Kt?(Zf(r,s,y),Ai(r,s,y)):(tt&&c&&Of(s),s.flags|=1,_n(r,s,o,y),s.child)}function D0(r,s,o,c,p){if(xa(s),s.stateNode===null){var y=oo,E=o.contextType;typeof E=="object"&&E!==null&&(y=yn(E)),y=new o(c,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=mm,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=c,y.state=s.memoizedState,y.refs={},qf(s),E=o.contextType,y.context=typeof E=="object"&&E!==null?yn(E):oo,y.state=s.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(fm(s,o,E,c),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(E=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),E!==y.state&&mm.enqueueReplaceState(y,y.state,null),tc(s,c,y,p),ec(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(r===null){y=s.stateNode;var k=s.memoizedProps,G=Ca(o,k);y.props=G;var te=y.context,fe=o.contextType;E=oo,typeof fe=="object"&&fe!==null&&(E=yn(fe));var ye=o.getDerivedStateFromProps;fe=typeof ye=="function"||typeof y.getSnapshotBeforeUpdate=="function",k=s.pendingProps!==k,fe||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(k||te!==E)&&p0(s,y,c,E),hs=!1;var re=s.memoizedState;y.state=re,tc(s,c,y,p),ec(),te=s.memoizedState,k||re!==te||hs?(typeof ye=="function"&&(fm(s,o,ye,c),te=s.memoizedState),(G=hs||m0(s,o,G,c,re,te,E))?(fe||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=te),y.props=c,y.state=te,y.context=E,c=G):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{y=s.stateNode,Hf(r,s),E=s.memoizedProps,fe=Ca(o,E),y.props=fe,ye=s.pendingProps,re=y.context,te=o.contextType,G=oo,typeof te=="object"&&te!==null&&(G=yn(te)),k=o.getDerivedStateFromProps,(te=typeof k=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(E!==ye||re!==G)&&p0(s,y,c,G),hs=!1,re=s.memoizedState,y.state=re,tc(s,c,y,p),ec();var oe=s.memoizedState;E!==ye||re!==oe||hs||r!==null&&r.dependencies!==null&&Wu(r.dependencies)?(typeof k=="function"&&(fm(s,o,k,c),oe=s.memoizedState),(fe=hs||m0(s,o,fe,c,re,oe,G)||r!==null&&r.dependencies!==null&&Wu(r.dependencies))?(te||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(c,oe,G),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(c,oe,G)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&re===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&re===r.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=oe),y.props=c,y.state=oe,y.context=G,c=fe):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&re===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&re===r.memoizedState||(s.flags|=1024),c=!1)}return y=c,md(r,s),c=(s.flags&128)!==0,y||c?(y=s.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,r!==null&&c?(s.child=Ta(s,r.child,null,p),s.child=Ta(s,null,o,p)):_n(r,s,o,p),s.memoizedState=y.state,r=s.child):r=Ai(r,s,p),r}function I0(r,s,o,c){return va(),s.flags|=256,_n(r,s,o,c),s.child}var _m={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vm(r){return{baseLanes:r,cachePool:v_()}}function bm(r,s,o){return r=r!==null?r.childLanes&~o:0,s&&(r|=Zn),r}function j0(r,s,o){var c=s.pendingProps,p=!1,y=(s.flags&128)!==0,E;if((E=y)||(E=r!==null&&r.memoizedState===null?!1:(Vt.current&2)!==0),E&&(p=!0,s.flags&=-129),E=(s.flags&32)!==0,s.flags&=-33,r===null){if(tt){if(p?ps(s):gs(),(r=bt)?(r=zv(r,mr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:ls!==null?{id:ni,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},o=u_(r),o.return=s,s.child=o,gn=s,bt=null)):r=null,r===null)throw us(s);return np(r)?s.lanes=32:s.lanes=536870912,null}var k=c.children;return c=c.fallback,p?(gs(),p=s.mode,k=pd({mode:"hidden",children:k},p),c=_a(c,p,o,null),k.return=s,c.return=s,k.sibling=c,s.child=k,c=s.child,c.memoizedState=vm(o),c.childLanes=bm(r,E,o),s.memoizedState=_m,ac(null,c)):(ps(s),xm(s,k))}var G=r.memoizedState;if(G!==null&&(k=G.dehydrated,k!==null)){if(y)s.flags&256?(ps(s),s.flags&=-257,s=Em(r,s,o)):s.memoizedState!==null?(gs(),s.child=r.child,s.flags|=128,s=null):(gs(),k=c.fallback,p=s.mode,c=pd({mode:"visible",children:c.children},p),k=_a(k,p,o,null),k.flags|=2,c.return=s,k.return=s,c.sibling=k,s.child=c,Ta(s,r.child,null,o),c=s.child,c.memoizedState=vm(o),c.childLanes=bm(r,E,o),s.memoizedState=_m,s=ac(null,c));else if(ps(s),np(k)){if(E=k.nextSibling&&k.nextSibling.dataset,E)var te=E.dgst;E=te,c=Error(i(419)),c.stack="",c.digest=E,Kl({value:c,source:null,stack:null}),s=Em(r,s,o)}else if(Kt||ho(r,s,o,!1),E=(o&r.childLanes)!==0,Kt||E){if(E=gt,E!==null&&(c=Cl(E,o),c!==0&&c!==G.retryLane))throw G.retryLane=c,ya(r,c),Un(E,r,c),gm;tp(k)||wd(),s=Em(r,s,o)}else tp(k)?(s.flags|=192,s.child=r.child,s=null):(r=G.treeContext,bt=gr(k.nextSibling),gn=s,tt=!0,cs=null,mr=!1,r!==null&&f_(s,r),s=xm(s,c.children),s.flags|=4096);return s}return p?(gs(),k=c.fallback,p=s.mode,G=r.child,te=G.sibling,c=bi(G,{mode:"hidden",children:c.children}),c.subtreeFlags=G.subtreeFlags&65011712,te!==null?k=bi(te,k):(k=_a(k,p,o,null),k.flags|=2),k.return=s,c.return=s,c.sibling=k,s.child=c,ac(null,c),c=s.child,k=r.child.memoizedState,k===null?k=vm(o):(p=k.cachePool,p!==null?(G=Qt._currentValue,p=p.parent!==G?{parent:G,pool:G}:p):p=v_(),k={baseLanes:k.baseLanes|o,cachePool:p}),c.memoizedState=k,c.childLanes=bm(r,E,o),s.memoizedState=_m,ac(r.child,c)):(ps(s),o=r.child,r=o.sibling,o=bi(o,{mode:"visible",children:c.children}),o.return=s,o.sibling=null,r!==null&&(E=s.deletions,E===null?(s.deletions=[r],s.flags|=16):E.push(r)),s.child=o,s.memoizedState=null,o)}function xm(r,s){return s=pd({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function pd(r,s){return r=Wn(22,r,null,s),r.lanes=0,r}function Em(r,s,o){return Ta(s,r.child,null,o),r=xm(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function O0(r,s,o){r.lanes|=s;var c=r.alternate;c!==null&&(c.lanes|=s),Lf(r.return,s,o)}function Sm(r,s,o,c,p,y){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:p,treeForkCount:y}:(E.isBackwards=s,E.rendering=null,E.renderingStartTime=0,E.last=c,E.tail=o,E.tailMode=p,E.treeForkCount=y)}function k0(r,s,o){var c=s.pendingProps,p=c.revealOrder,y=c.tail;c=c.children;var E=Vt.current,k=(E&2)!==0;if(k?(E=E&1|2,s.flags|=128):E&=1,W(Vt,E),_n(r,s,c,o),c=tt?$l:0,!k&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&O0(r,o,s);else if(r.tag===19)O0(r,o,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(p){case"forwards":for(o=s.child,p=null;o!==null;)r=o.alternate,r!==null&&rd(r)===null&&(p=o),o=o.sibling;o=p,o===null?(p=s.child,s.child=null):(p=o.sibling,o.sibling=null),Sm(s,!1,p,o,y,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=s.child,s.child=null;p!==null;){if(r=p.alternate,r!==null&&rd(r)===null){s.child=p;break}r=p.sibling,p.sibling=o,o=p,p=r}Sm(s,!0,o,null,y,c);break;case"together":Sm(s,!1,null,null,void 0,c);break;default:s.memoizedState=null}return s.child}function Ai(r,s,o){if(r!==null&&(s.dependencies=r.dependencies),vs|=s.lanes,(o&s.childLanes)===0)if(r!==null){if(ho(r,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,o=bi(r,r.pendingProps),s.child=o,o.return=s;r.sibling!==null;)r=r.sibling,o=o.sibling=bi(r,r.pendingProps),o.return=s;o.sibling=null}return s.child}function wm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&Wu(r)))}function BT(r,s,o){switch(s.tag){case 3:be(s,s.stateNode.containerInfo),ds(s,Qt,r.memoizedState.cache),va();break;case 27:case 5:de(s);break;case 4:be(s,s.stateNode.containerInfo);break;case 10:ds(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Wf(s),null;break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(ps(s),s.flags|=128,null):(o&s.child.childLanes)!==0?j0(r,s,o):(ps(s),r=Ai(r,s,o),r!==null?r.sibling:null);ps(s);break;case 19:var p=(r.flags&128)!==0;if(c=(o&s.childLanes)!==0,c||(ho(r,s,o,!1),c=(o&s.childLanes)!==0),p){if(c)return k0(r,s,o);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),W(Vt,Vt.current),c)break;return null;case 22:return s.lanes=0,T0(r,s,o,s.pendingProps);case 24:ds(s,Qt,r.memoizedState.cache)}return Ai(r,s,o)}function M0(r,s,o){if(r!==null)if(r.memoizedProps!==s.pendingProps)Kt=!0;else{if(!wm(r,o)&&(s.flags&128)===0)return Kt=!1,BT(r,s,o);Kt=(r.flags&131072)!==0}else Kt=!1,tt&&(s.flags&1048576)!==0&&h_(s,$l,s.index);switch(s.lanes=0,s.tag){case 16:e:{var c=s.pendingProps;if(r=Sa(s.elementType),s.type=r,typeof r=="function")Df(r)?(c=Ca(r,c),s.tag=1,s=D0(null,s,r,c,o)):(s.tag=0,s=ym(null,s,r,c,o));else{if(r!=null){var p=r.$$typeof;if(p===me){s.tag=11,s=E0(null,s,r,c,o);break e}else if(p===L){s.tag=14,s=S0(null,s,r,c,o);break e}}throw s=Y(r)||r,Error(i(306,s,""))}}return s;case 0:return ym(r,s,s.type,s.pendingProps,o);case 1:return c=s.type,p=Ca(c,s.pendingProps),D0(r,s,c,p,o);case 3:e:{if(be(s,s.stateNode.containerInfo),r===null)throw Error(i(387));c=s.pendingProps;var y=s.memoizedState;p=y.element,Hf(r,s),tc(s,c,null,o);var E=s.memoizedState;if(c=E.cache,ds(s,Qt,c),c!==y.cache&&Vf(s,[Qt],o,!0),ec(),c=E.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:E.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=I0(r,s,c,o);break e}else if(c!==p){p=dr(Error(i(424)),s),Kl(p),s=I0(r,s,c,o);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,bt=gr(r.firstChild),gn=s,tt=!0,cs=null,mr=!0,o=T_(s,null,c,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(va(),c===p){s=Ai(r,s,o);break e}_n(r,s,c,o)}s=s.child}return s;case 26:return md(r,s),r===null?(o=Gv(s.type,null,s.pendingProps,null))?s.memoizedState=o:tt||(o=s.type,r=s.pendingProps,c=jd(pe.current).createElement(o),c[qt]=s,c[cn]=r,vn(c,o,r),Ht(c),s.stateNode=c):s.memoizedState=Gv(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return de(s),r===null&&tt&&(c=s.stateNode=Fv(s.type,s.pendingProps,pe.current),gn=s,mr=!0,p=bt,ws(s.type)?(rp=p,bt=gr(c.firstChild)):bt=p),_n(r,s,s.pendingProps.children,o),md(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&tt&&((p=c=bt)&&(c=yA(c,s.type,s.pendingProps,mr),c!==null?(s.stateNode=c,gn=s,bt=gr(c.firstChild),mr=!1,p=!0):p=!1),p||us(s)),de(s),p=s.type,y=s.pendingProps,E=r!==null?r.memoizedProps:null,c=y.children,Jm(p,y)?c=null:E!==null&&Jm(p,E)&&(s.flags|=32),s.memoizedState!==null&&(p=Xf(r,s,OT,null,null,o),xc._currentValue=p),md(r,s),_n(r,s,c,o),s.child;case 6:return r===null&&tt&&((r=o=bt)&&(o=_A(o,s.pendingProps,mr),o!==null?(s.stateNode=o,gn=s,bt=null,r=!0):r=!1),r||us(s)),null;case 13:return j0(r,s,o);case 4:return be(s,s.stateNode.containerInfo),c=s.pendingProps,r===null?s.child=Ta(s,null,c,o):_n(r,s,c,o),s.child;case 11:return E0(r,s,s.type,s.pendingProps,o);case 7:return _n(r,s,s.pendingProps,o),s.child;case 8:return _n(r,s,s.pendingProps.children,o),s.child;case 12:return _n(r,s,s.pendingProps.children,o),s.child;case 10:return c=s.pendingProps,ds(s,s.type,c.value),_n(r,s,c.children,o),s.child;case 9:return p=s.type._context,c=s.pendingProps.children,xa(s),p=yn(p),c=c(p),s.flags|=1,_n(r,s,c,o),s.child;case 14:return S0(r,s,s.type,s.pendingProps,o);case 15:return w0(r,s,s.type,s.pendingProps,o);case 19:return k0(r,s,o);case 31:return UT(r,s,o);case 22:return T0(r,s,o,s.pendingProps);case 24:return xa(s),c=yn(Qt),r===null?(p=Bf(),p===null&&(p=gt,y=zf(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=o),p=y),s.memoizedState={parent:c,cache:p},qf(s),ds(s,Qt,p)):((r.lanes&o)!==0&&(Hf(r,s),tc(s,null,null,o),ec()),p=r.memoizedState,y=s.memoizedState,p.parent!==c?(p={parent:c,cache:c},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),ds(s,Qt,c)):(c=y.cache,ds(s,Qt,c),c!==p.cache&&Vf(s,[Qt],o,!0))),_n(r,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Ci(r){r.flags|=4}function Tm(r,s,o,c,p){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(p&335544128)===p)if(r.stateNode.complete)r.flags|=8192;else if(ov())r.flags|=8192;else throw wa=Zu,Ff}else r.flags&=-16777217}function N0(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Yv(s))if(ov())r.flags|=8192;else throw wa=Zu,Ff}function gd(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?Eu():536870912,r.lanes|=s,wo|=s)}function oc(r,s){if(!tt)switch(r.tailMode){case"hidden":s=r.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:c.sibling=null}}function xt(r){var s=r.alternate!==null&&r.alternate.child===r.child,o=0,c=0;if(s)for(var p=r.child;p!==null;)o|=p.lanes|p.childLanes,c|=p.subtreeFlags&65011712,c|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)o|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=c,r.childLanes=o,s}function FT(r,s,o){var c=s.pendingProps;switch(kf(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(s),null;case 1:return xt(s),null;case 3:return o=s.stateNode,c=null,r!==null&&(c=r.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Si(Qt),Se(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(uo(s)?Ci(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Nf())),xt(s),null;case 26:var p=s.type,y=s.memoizedState;return r===null?(Ci(s),y!==null?(xt(s),N0(s,y)):(xt(s),Tm(s,p,null,c,o))):y?y!==r.memoizedState?(Ci(s),xt(s),N0(s,y)):(xt(s),s.flags&=-16777217):(r=r.memoizedProps,r!==c&&Ci(s),xt(s),Tm(s,p,r,c,o)),null;case 27:if(Ce(s),o=pe.current,p=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==c&&Ci(s);else{if(!c){if(s.stateNode===null)throw Error(i(166));return xt(s),null}r=ne.current,uo(s)?m_(s):(r=Fv(p,c,o),s.stateNode=r,Ci(s))}return xt(s),null;case 5:if(Ce(s),p=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==c&&Ci(s);else{if(!c){if(s.stateNode===null)throw Error(i(166));return xt(s),null}if(y=ne.current,uo(s))m_(s);else{var E=jd(pe.current);switch(y){case 1:y=E.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=E.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=E.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof c.is=="string"?E.createElement("select",{is:c.is}):E.createElement("select"),c.multiple?y.multiple=!0:c.size&&(y.size=c.size);break;default:y=typeof c.is=="string"?E.createElement(p,{is:c.is}):E.createElement(p)}}y[qt]=s,y[cn]=c;e:for(E=s.child;E!==null;){if(E.tag===5||E.tag===6)y.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===s)break e;for(;E.sibling===null;){if(E.return===null||E.return===s)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}s.stateNode=y;e:switch(vn(y,p,c),p){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Ci(s)}}return xt(s),Tm(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,o),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==c&&Ci(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(i(166));if(r=pe.current,uo(s)){if(r=s.stateNode,o=s.memoizedProps,c=null,p=gn,p!==null)switch(p.tag){case 27:case 5:c=p.memoizedProps}r[qt]=s,r=!!(r.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||jv(r.nodeValue,o)),r||us(s,!0)}else r=jd(r).createTextNode(c),r[qt]=s,s.stateNode=r}return xt(s),null;case 31:if(o=s.memoizedState,r===null||r.memoizedState!==null){if(c=uo(s),o!==null){if(r===null){if(!c)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[qt]=s}else va(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;xt(s),r=!1}else o=Nf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return s.flags&256?(Xn(s),s):(Xn(s),null);if((s.flags&128)!==0)throw Error(i(558))}return xt(s),null;case 13:if(c=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=uo(s),c!==null&&c.dehydrated!==null){if(r===null){if(!p)throw Error(i(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[qt]=s}else va(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;xt(s),p=!1}else p=Nf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(Xn(s),s):(Xn(s),null)}return Xn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=c!==null,r=r!==null&&r.memoizedState!==null,o&&(c=s.child,p=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(p=c.alternate.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==p&&(c.flags|=2048)),o!==r&&o&&(s.child.flags|=8192),gd(s,s.updateQueue),xt(s),null);case 4:return Se(),r===null&&$m(s.stateNode.containerInfo),xt(s),null;case 10:return Si(s.type),xt(s),null;case 19:if(F(Vt),c=s.memoizedState,c===null)return xt(s),null;if(p=(s.flags&128)!==0,y=c.rendering,y===null)if(p)oc(c,!1);else{if(kt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(y=rd(r),y!==null){for(s.flags|=128,oc(c,!1),r=y.updateQueue,s.updateQueue=r,gd(s,r),s.subtreeFlags=0,r=o,o=s.child;o!==null;)c_(o,r),o=o.sibling;return W(Vt,Vt.current&1|2),tt&&xi(s,c.treeForkCount),s.child}r=r.sibling}c.tail!==null&&Nt()>xd&&(s.flags|=128,p=!0,oc(c,!1),s.lanes=4194304)}else{if(!p)if(r=rd(y),r!==null){if(s.flags|=128,p=!0,r=r.updateQueue,s.updateQueue=r,gd(s,r),oc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!y.alternate&&!tt)return xt(s),null}else 2*Nt()-c.renderingStartTime>xd&&o!==536870912&&(s.flags|=128,p=!0,oc(c,!1),s.lanes=4194304);c.isBackwards?(y.sibling=s.child,s.child=y):(r=c.last,r!==null?r.sibling=y:s.child=y,c.last=y)}return c.tail!==null?(r=c.tail,c.rendering=r,c.tail=r.sibling,c.renderingStartTime=Nt(),r.sibling=null,o=Vt.current,W(Vt,p?o&1|2:o&1),tt&&xi(s,c.treeForkCount),r):(xt(s),null);case 22:case 23:return Xn(s),Kf(),c=s.memoizedState!==null,r!==null?r.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(o&536870912)!==0&&(s.flags&128)===0&&(xt(s),s.subtreeFlags&6&&(s.flags|=8192)):xt(s),o=s.updateQueue,o!==null&&gd(s,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==o&&(s.flags|=2048),r!==null&&F(Ea),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Si(Qt),xt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function qT(r,s){switch(kf(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Si(Qt),Se(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return Ce(s),null;case 31:if(s.memoizedState!==null){if(Xn(s),s.alternate===null)throw Error(i(340));va()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(Xn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));va()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return F(Vt),null;case 4:return Se(),null;case 10:return Si(s.type),null;case 22:case 23:return Xn(s),Kf(),r!==null&&F(Ea),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return Si(Qt),null;case 25:return null;default:return null}}function P0(r,s){switch(kf(s),s.tag){case 3:Si(Qt),Se();break;case 26:case 27:case 5:Ce(s);break;case 4:Se();break;case 31:s.memoizedState!==null&&Xn(s);break;case 13:Xn(s);break;case 19:F(Vt);break;case 10:Si(s.type);break;case 22:case 23:Xn(s),Kf(),r!==null&&F(Ea);break;case 24:Si(Qt)}}function lc(r,s){try{var o=s.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var p=c.next;o=p;do{if((o.tag&r)===r){c=void 0;var y=o.create,E=o.inst;c=y(),E.destroy=c}o=o.next}while(o!==p)}}catch(k){dt(s,s.return,k)}}function ys(r,s,o){try{var c=s.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var y=p.next;c=y;do{if((c.tag&r)===r){var E=c.inst,k=E.destroy;if(k!==void 0){E.destroy=void 0,p=s;var G=o,te=k;try{te()}catch(fe){dt(p,G,fe)}}}c=c.next}while(c!==y)}}catch(fe){dt(s,s.return,fe)}}function L0(r){var s=r.updateQueue;if(s!==null){var o=r.stateNode;try{C_(s,o)}catch(c){dt(r,r.return,c)}}}function V0(r,s,o){o.props=Ca(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(c){dt(r,s,c)}}function cc(r,s){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var c=r.stateNode;break;case 30:c=r.stateNode;break;default:c=r.stateNode}typeof o=="function"?r.refCleanup=o(c):o.current=c}}catch(p){dt(r,s,p)}}function ii(r,s){var o=r.ref,c=r.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(p){dt(r,s,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){dt(r,s,p)}else o.current=null}function z0(r){var s=r.type,o=r.memoizedProps,c=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(p){dt(r,r.return,p)}}function Am(r,s,o){try{var c=r.stateNode;dA(c,r.type,o,s),c[cn]=s}catch(p){dt(r,r.return,p)}}function U0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&ws(r.type)||r.tag===4}function Cm(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||U0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&ws(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Rm(r,s,o){var c=r.tag;if(c===5||c===6)r=r.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(r),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=Tr));else if(c!==4&&(c===27&&ws(r.type)&&(o=r.stateNode,s=null),r=r.child,r!==null))for(Rm(r,s,o),r=r.sibling;r!==null;)Rm(r,s,o),r=r.sibling}function yd(r,s,o){var c=r.tag;if(c===5||c===6)r=r.stateNode,s?o.insertBefore(r,s):o.appendChild(r);else if(c!==4&&(c===27&&ws(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(yd(r,s,o),r=r.sibling;r!==null;)yd(r,s,o),r=r.sibling}function B0(r){var s=r.stateNode,o=r.memoizedProps;try{for(var c=r.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);vn(s,c,o),s[qt]=r,s[cn]=o}catch(y){dt(r,r.return,y)}}var Ri=!1,Wt=!1,Dm=!1,F0=typeof WeakSet=="function"?WeakSet:Set,dn=null;function HT(r,s){if(r=r.containerInfo,Ym=Vd,r=e_(r),Ef(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var p=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var E=0,k=-1,G=-1,te=0,fe=0,ye=r,re=null;t:for(;;){for(var oe;ye!==o||p!==0&&ye.nodeType!==3||(k=E+p),ye!==y||c!==0&&ye.nodeType!==3||(G=E+c),ye.nodeType===3&&(E+=ye.nodeValue.length),(oe=ye.firstChild)!==null;)re=ye,ye=oe;for(;;){if(ye===r)break t;if(re===o&&++te===p&&(k=E),re===y&&++fe===c&&(G=E),(oe=ye.nextSibling)!==null)break;ye=re,re=ye.parentNode}ye=oe}o=k===-1||G===-1?null:{start:k,end:G}}else o=null}o=o||{start:0,end:0}}else o=null;for(Xm={focusedElem:r,selectionRange:o},Vd=!1,dn=s;dn!==null;)if(s=dn,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,dn=r;else for(;dn!==null;){switch(s=dn,y=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)p=r[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=s,p=y.memoizedProps,y=y.memoizedState,c=o.stateNode;try{var Re=Ca(o.type,p);r=c.getSnapshotBeforeUpdate(Re,y),c.__reactInternalSnapshotBeforeUpdate=r}catch(Pe){dt(o,o.return,Pe)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,o=r.nodeType,o===9)ep(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":ep(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,dn=r;break}dn=s.return}}function q0(r,s,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Ii(r,o),c&4&&lc(5,o);break;case 1:if(Ii(r,o),c&4)if(r=o.stateNode,s===null)try{r.componentDidMount()}catch(E){dt(o,o.return,E)}else{var p=Ca(o.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(p,s,r.__reactInternalSnapshotBeforeUpdate)}catch(E){dt(o,o.return,E)}}c&64&&L0(o),c&512&&cc(o,o.return);break;case 3:if(Ii(r,o),c&64&&(r=o.updateQueue,r!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{C_(r,s)}catch(E){dt(o,o.return,E)}}break;case 27:s===null&&c&4&&B0(o);case 26:case 5:Ii(r,o),s===null&&c&4&&z0(o),c&512&&cc(o,o.return);break;case 12:Ii(r,o);break;case 31:Ii(r,o),c&4&&Q0(r,o);break;case 13:Ii(r,o),c&4&&$0(r,o),c&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=ZT.bind(null,o),vA(r,o))));break;case 22:if(c=o.memoizedState!==null||Ri,!c){s=s!==null&&s.memoizedState!==null||Wt,p=Ri;var y=Wt;Ri=c,(Wt=s)&&!y?ji(r,o,(o.subtreeFlags&8772)!==0):Ii(r,o),Ri=p,Wt=y}break;case 30:break;default:Ii(r,o)}}function H0(r){var s=r.alternate;s!==null&&(r.alternate=null,H0(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&$a(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var At=null,Pn=!1;function Di(r,s,o){for(o=o.child;o!==null;)G0(r,s,o),o=o.sibling}function G0(r,s,o){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(xr,o)}catch{}switch(o.tag){case 26:Wt||ii(o,s),Di(r,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Wt||ii(o,s);var c=At,p=Pn;ws(o.type)&&(At=o.stateNode,Pn=!1),Di(r,s,o),_c(o.stateNode),At=c,Pn=p;break;case 5:Wt||ii(o,s);case 6:if(c=At,p=Pn,At=null,Di(r,s,o),At=c,Pn=p,At!==null)if(Pn)try{(At.nodeType===9?At.body:At.nodeName==="HTML"?At.ownerDocument.body:At).removeChild(o.stateNode)}catch(y){dt(o,s,y)}else try{At.removeChild(o.stateNode)}catch(y){dt(o,s,y)}break;case 18:At!==null&&(Pn?(r=At,Lv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),Oo(r)):Lv(At,o.stateNode));break;case 4:c=At,p=Pn,At=o.stateNode.containerInfo,Pn=!0,Di(r,s,o),At=c,Pn=p;break;case 0:case 11:case 14:case 15:ys(2,o,s),Wt||ys(4,o,s),Di(r,s,o);break;case 1:Wt||(ii(o,s),c=o.stateNode,typeof c.componentWillUnmount=="function"&&V0(o,s,c)),Di(r,s,o);break;case 21:Di(r,s,o);break;case 22:Wt=(c=Wt)||o.memoizedState!==null,Di(r,s,o),Wt=c;break;default:Di(r,s,o)}}function Q0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Oo(r)}catch(o){dt(s,s.return,o)}}}function $0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Oo(r)}catch(o){dt(s,s.return,o)}}function GT(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new F0),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new F0),s;default:throw Error(i(435,r.tag))}}function _d(r,s){var o=GT(r);s.forEach(function(c){if(!o.has(c)){o.add(c);var p=eA.bind(null,r,c);c.then(p,p)}})}function Ln(r,s){var o=s.deletions;if(o!==null)for(var c=0;c<o.length;c++){var p=o[c],y=r,E=s,k=E;e:for(;k!==null;){switch(k.tag){case 27:if(ws(k.type)){At=k.stateNode,Pn=!1;break e}break;case 5:At=k.stateNode,Pn=!1;break e;case 3:case 4:At=k.stateNode.containerInfo,Pn=!0;break e}k=k.return}if(At===null)throw Error(i(160));G0(y,E,p),At=null,Pn=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)K0(s,r),s=s.sibling}var jr=null;function K0(r,s){var o=r.alternate,c=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ln(s,r),Vn(r),c&4&&(ys(3,r,r.return),lc(3,r),ys(5,r,r.return));break;case 1:Ln(s,r),Vn(r),c&512&&(Wt||o===null||ii(o,o.return)),c&64&&Ri&&(r=r.updateQueue,r!==null&&(c=r.callbacks,c!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var p=jr;if(Ln(s,r),Vn(r),c&512&&(Wt||o===null||ii(o,o.return)),c&4){var y=o!==null?o.memoizedState:null;if(c=r.memoizedState,o===null)if(c===null)if(r.stateNode===null){e:{c=r.type,o=r.memoizedProps,p=p.ownerDocument||p;t:switch(c){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Hr]||y[qt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(c),p.head.insertBefore(y,p.querySelector("head > title"))),vn(y,c,o),y[qt]=r,Ht(y),c=y;break e;case"link":var E=Kv("link","href",p).get(c+(o.href||""));if(E){for(var k=0;k<E.length;k++)if(y=E[k],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(k,1);break t}}y=p.createElement(c),vn(y,c,o),p.head.appendChild(y);break;case"meta":if(E=Kv("meta","content",p).get(c+(o.content||""))){for(k=0;k<E.length;k++)if(y=E[k],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(k,1);break t}}y=p.createElement(c),vn(y,c,o),p.head.appendChild(y);break;default:throw Error(i(468,c))}y[qt]=r,Ht(y),c=y}r.stateNode=c}else Wv(p,r.type,r.stateNode);else r.stateNode=$v(p,c,r.memoizedProps);else y!==c?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,c===null?Wv(p,r.type,r.stateNode):$v(p,c,r.memoizedProps)):c===null&&r.stateNode!==null&&Am(r,r.memoizedProps,o.memoizedProps)}break;case 27:Ln(s,r),Vn(r),c&512&&(Wt||o===null||ii(o,o.return)),o!==null&&c&4&&Am(r,r.memoizedProps,o.memoizedProps);break;case 5:if(Ln(s,r),Vn(r),c&512&&(Wt||o===null||ii(o,o.return)),r.flags&32){p=r.stateNode;try{Nn(p,"")}catch(Re){dt(r,r.return,Re)}}c&4&&r.stateNode!=null&&(p=r.memoizedProps,Am(r,p,o!==null?o.memoizedProps:p)),c&1024&&(Dm=!0);break;case 6:if(Ln(s,r),Vn(r),c&4){if(r.stateNode===null)throw Error(i(162));c=r.memoizedProps,o=r.stateNode;try{o.nodeValue=c}catch(Re){dt(r,r.return,Re)}}break;case 3:if(Md=null,p=jr,jr=Od(s.containerInfo),Ln(s,r),jr=p,Vn(r),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Oo(s.containerInfo)}catch(Re){dt(r,r.return,Re)}Dm&&(Dm=!1,W0(r));break;case 4:c=jr,jr=Od(r.stateNode.containerInfo),Ln(s,r),Vn(r),jr=c;break;case 12:Ln(s,r),Vn(r);break;case 31:Ln(s,r),Vn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,_d(r,c)));break;case 13:Ln(s,r),Vn(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(bd=Nt()),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,_d(r,c)));break;case 22:p=r.memoizedState!==null;var G=o!==null&&o.memoizedState!==null,te=Ri,fe=Wt;if(Ri=te||p,Wt=fe||G,Ln(s,r),Wt=fe,Ri=te,Vn(r),c&8192)e:for(s=r.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(o===null||G||Ri||Wt||Ra(r)),o=null,s=r;;){if(s.tag===5||s.tag===26){if(o===null){G=o=s;try{if(y=G.stateNode,p)E=y.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{k=G.stateNode;var ye=G.memoizedProps.style,re=ye!=null&&ye.hasOwnProperty("display")?ye.display:null;k.style.display=re==null||typeof re=="boolean"?"":(""+re).trim()}}catch(Re){dt(G,G.return,Re)}}}else if(s.tag===6){if(o===null){G=s;try{G.stateNode.nodeValue=p?"":G.memoizedProps}catch(Re){dt(G,G.return,Re)}}}else if(s.tag===18){if(o===null){G=s;try{var oe=G.stateNode;p?Vv(oe,!0):Vv(G.stateNode,!1)}catch(Re){dt(G,G.return,Re)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=r.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,_d(r,o))));break;case 19:Ln(s,r),Vn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,_d(r,c)));break;case 30:break;case 21:break;default:Ln(s,r),Vn(r)}}function Vn(r){var s=r.flags;if(s&2){try{for(var o,c=r.return;c!==null;){if(U0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var p=o.stateNode,y=Cm(r);yd(r,y,p);break;case 5:var E=o.stateNode;o.flags&32&&(Nn(E,""),o.flags&=-33);var k=Cm(r);yd(r,k,E);break;case 3:case 4:var G=o.stateNode.containerInfo,te=Cm(r);Rm(r,te,G);break;default:throw Error(i(161))}}catch(fe){dt(r,r.return,fe)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function W0(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;W0(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Ii(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)q0(r,s.alternate,s),s=s.sibling}function Ra(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:ys(4,s,s.return),Ra(s);break;case 1:ii(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&V0(s,s.return,o),Ra(s);break;case 27:_c(s.stateNode);case 26:case 5:ii(s,s.return),Ra(s);break;case 22:s.memoizedState===null&&Ra(s);break;case 30:Ra(s);break;default:Ra(s)}r=r.sibling}}function ji(r,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,p=r,y=s,E=y.flags;switch(y.tag){case 0:case 11:case 15:ji(p,y,o),lc(4,y);break;case 1:if(ji(p,y,o),c=y,p=c.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(te){dt(c,c.return,te)}if(c=y,p=c.updateQueue,p!==null){var k=c.stateNode;try{var G=p.shared.hiddenCallbacks;if(G!==null)for(p.shared.hiddenCallbacks=null,p=0;p<G.length;p++)A_(G[p],k)}catch(te){dt(c,c.return,te)}}o&&E&64&&L0(y),cc(y,y.return);break;case 27:B0(y);case 26:case 5:ji(p,y,o),o&&c===null&&E&4&&z0(y),cc(y,y.return);break;case 12:ji(p,y,o);break;case 31:ji(p,y,o),o&&E&4&&Q0(p,y);break;case 13:ji(p,y,o),o&&E&4&&$0(p,y);break;case 22:y.memoizedState===null&&ji(p,y,o),cc(y,y.return);break;case 30:break;default:ji(p,y,o)}s=s.sibling}}function Im(r,s){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&Wl(o))}function jm(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Wl(r))}function Or(r,s,o,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Y0(r,s,o,c),s=s.sibling}function Y0(r,s,o,c){var p=s.flags;switch(s.tag){case 0:case 11:case 15:Or(r,s,o,c),p&2048&&lc(9,s);break;case 1:Or(r,s,o,c);break;case 3:Or(r,s,o,c),p&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&Wl(r)));break;case 12:if(p&2048){Or(r,s,o,c),r=s.stateNode;try{var y=s.memoizedProps,E=y.id,k=y.onPostCommit;typeof k=="function"&&k(E,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(G){dt(s,s.return,G)}}else Or(r,s,o,c);break;case 31:Or(r,s,o,c);break;case 13:Or(r,s,o,c);break;case 23:break;case 22:y=s.stateNode,E=s.alternate,s.memoizedState!==null?y._visibility&2?Or(r,s,o,c):uc(r,s):y._visibility&2?Or(r,s,o,c):(y._visibility|=2,xo(r,s,o,c,(s.subtreeFlags&10256)!==0||!1)),p&2048&&Im(E,s);break;case 24:Or(r,s,o,c),p&2048&&jm(s.alternate,s);break;default:Or(r,s,o,c)}}function xo(r,s,o,c,p){for(p=p&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=r,E=s,k=o,G=c,te=E.flags;switch(E.tag){case 0:case 11:case 15:xo(y,E,k,G,p),lc(8,E);break;case 23:break;case 22:var fe=E.stateNode;E.memoizedState!==null?fe._visibility&2?xo(y,E,k,G,p):uc(y,E):(fe._visibility|=2,xo(y,E,k,G,p)),p&&te&2048&&Im(E.alternate,E);break;case 24:xo(y,E,k,G,p),p&&te&2048&&jm(E.alternate,E);break;default:xo(y,E,k,G,p)}s=s.sibling}}function uc(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=r,c=s,p=c.flags;switch(c.tag){case 22:uc(o,c),p&2048&&Im(c.alternate,c);break;case 24:uc(o,c),p&2048&&jm(c.alternate,c);break;default:uc(o,c)}s=s.sibling}}var dc=8192;function Eo(r,s,o){if(r.subtreeFlags&dc)for(r=r.child;r!==null;)X0(r,s,o),r=r.sibling}function X0(r,s,o){switch(r.tag){case 26:Eo(r,s,o),r.flags&dc&&r.memoizedState!==null&&jA(o,jr,r.memoizedState,r.memoizedProps);break;case 5:Eo(r,s,o);break;case 3:case 4:var c=jr;jr=Od(r.stateNode.containerInfo),Eo(r,s,o),jr=c;break;case 22:r.memoizedState===null&&(c=r.alternate,c!==null&&c.memoizedState!==null?(c=dc,dc=16777216,Eo(r,s,o),dc=c):Eo(r,s,o));break;default:Eo(r,s,o)}}function J0(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function hc(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];dn=c,ev(c,r)}J0(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Z0(r),r=r.sibling}function Z0(r){switch(r.tag){case 0:case 11:case 15:hc(r),r.flags&2048&&ys(9,r,r.return);break;case 3:hc(r);break;case 12:hc(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,vd(r)):hc(r);break;default:hc(r)}}function vd(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];dn=c,ev(c,r)}J0(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:ys(8,s,s.return),vd(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,vd(s));break;default:vd(s)}r=r.sibling}}function ev(r,s){for(;dn!==null;){var o=dn;switch(o.tag){case 0:case 11:case 15:ys(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Wl(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,dn=c;else e:for(o=r;dn!==null;){c=dn;var p=c.sibling,y=c.return;if(H0(c),c===o){dn=null;break e}if(p!==null){p.return=y,dn=p;break e}dn=y}}}var QT={getCacheForType:function(r){var s=yn(Qt),o=s.data.get(r);return o===void 0&&(o=r(),s.data.set(r,o)),o},cacheSignal:function(){return yn(Qt).controller.signal}},$T=typeof WeakMap=="function"?WeakMap:Map,at=0,gt=null,Ke=null,Ye=0,ut=0,Jn=null,_s=!1,So=!1,Om=!1,Oi=0,kt=0,vs=0,Da=0,km=0,Zn=0,wo=0,fc=null,zn=null,Mm=!1,bd=0,tv=0,xd=1/0,Ed=null,bs=null,tn=0,xs=null,To=null,ki=0,Nm=0,Pm=null,nv=null,mc=0,Lm=null;function er(){return(at&2)!==0&&Ye!==0?Ye&-Ye:P.T!==null?qm():Su()}function rv(){if(Zn===0)if((Ye&536870912)===0||tt){var r=na;na<<=1,(na&3932160)===0&&(na=262144),Zn=r}else Zn=536870912;return r=Yn.current,r!==null&&(r.flags|=32),Zn}function Un(r,s,o){(r===gt&&(ut===2||ut===9)||r.cancelPendingCommit!==null)&&(Ao(r,0),Es(r,Ye,Zn,!1)),ra(r,o),((at&2)===0||r!==gt)&&(r===gt&&((at&2)===0&&(Da|=o),kt===4&&Es(r,Ye,Zn,!1)),si(r))}function iv(r,s,o){if((at&6)!==0)throw Error(i(327));var c=!o&&(s&127)===0&&(s&r.expiredLanes)===0||Er(r,s),p=c?YT(r,s):zm(r,s,!0),y=c;do{if(p===0){So&&!c&&Es(r,s,0,!1);break}else{if(o=r.current.alternate,y&&!KT(o)){p=zm(r,s,!1),y=!1;continue}if(p===2){if(y=s,r.errorRecoveryDisabledLanes&y)var E=0;else E=r.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){s=E;e:{var k=r;p=fc;var G=k.current.memoizedState.isDehydrated;if(G&&(Ao(k,E).flags|=256),E=zm(k,E,!1),E!==2){if(Om&&!G){k.errorRecoveryDisabledLanes|=y,Da|=y,p=4;break e}y=zn,zn=p,y!==null&&(zn===null?zn=y:zn.push.apply(zn,y))}p=E}if(y=!1,p!==2)continue}}if(p===1){Ao(r,0),Es(r,s,0,!0);break}e:{switch(c=r,y=p,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Es(c,s,Zn,!_s);break e;case 2:zn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(p=bd+300-Nt(),10<p)){if(Es(c,s,Zn,!_s),Br(c,0,!0)!==0)break e;ki=s,c.timeoutHandle=Nv(sv.bind(null,c,o,zn,Ed,Mm,s,Zn,Da,wo,_s,y,"Throttled",-0,0),p);break e}sv(c,o,zn,Ed,Mm,s,Zn,Da,wo,_s,y,null,-0,0)}}break}while(!0);si(r)}function sv(r,s,o,c,p,y,E,k,G,te,fe,ye,re,oe){if(r.timeoutHandle=-1,ye=s.subtreeFlags,ye&8192||(ye&16785408)===16785408){ye={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Tr},X0(s,y,ye);var Re=(y&62914560)===y?bd-Nt():(y&4194048)===y?tv-Nt():0;if(Re=OA(ye,Re),Re!==null){ki=y,r.cancelPendingCommit=Re(fv.bind(null,r,s,y,o,c,p,E,k,G,fe,ye,null,re,oe)),Es(r,y,E,!te);return}}fv(r,s,y,o,c,p,E,k,G)}function KT(r){for(var s=r;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var p=o[c],y=p.getSnapshot;p=p.value;try{if(!Kn(y(),p))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Es(r,s,o,c){s&=~km,s&=~Da,r.suspendedLanes|=s,r.pingedLanes&=~s,c&&(r.warmLanes|=s),c=r.expirationTimes;for(var p=s;0<p;){var y=31-Pt(p),E=1<<y;c[y]=-1,p&=~E}o!==0&&ia(r,o,s)}function Sd(){return(at&6)===0?(pc(0),!1):!0}function Vm(){if(Ke!==null){if(ut===0)var r=Ke.return;else r=Ke,Ei=ba=null,em(r),go=null,Xl=0,r=Ke;for(;r!==null;)P0(r.alternate,r),r=r.return;Ke=null}}function Ao(r,s){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,mA(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),ki=0,Vm(),gt=r,Ke=o=bi(r.current,null),Ye=s,ut=0,Jn=null,_s=!1,So=Er(r,s),Om=!1,wo=Zn=km=Da=vs=kt=0,zn=fc=null,Mm=!1,(s&8)!==0&&(s|=s&32);var c=r.entangledLanes;if(c!==0)for(r=r.entanglements,c&=s;0<c;){var p=31-Pt(c),y=1<<p;s|=r[p],c&=~y}return Oi=s,Hu(),o}function av(r,s){He=null,P.H=sc,s===po||s===Ju?(s=E_(),ut=3):s===Ff?(s=E_(),ut=4):ut=s===gm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Jn=s,Ke===null&&(kt=1,hd(r,dr(s,r.current)))}function ov(){var r=Yn.current;return r===null?!0:(Ye&4194048)===Ye?pr===null:(Ye&62914560)===Ye||(Ye&536870912)!==0?r===pr:!1}function lv(){var r=P.H;return P.H=sc,r===null?sc:r}function cv(){var r=P.A;return P.A=QT,r}function wd(){kt=4,_s||(Ye&4194048)!==Ye&&Yn.current!==null||(So=!0),(vs&134217727)===0&&(Da&134217727)===0||gt===null||Es(gt,Ye,Zn,!1)}function zm(r,s,o){var c=at;at|=2;var p=lv(),y=cv();(gt!==r||Ye!==s)&&(Ed=null,Ao(r,s)),s=!1;var E=kt;e:do try{if(ut!==0&&Ke!==null){var k=Ke,G=Jn;switch(ut){case 8:Vm(),E=6;break e;case 3:case 2:case 9:case 6:Yn.current===null&&(s=!0);var te=ut;if(ut=0,Jn=null,Co(r,k,G,te),o&&So){E=0;break e}break;default:te=ut,ut=0,Jn=null,Co(r,k,G,te)}}WT(),E=kt;break}catch(fe){av(r,fe)}while(!0);return s&&r.shellSuspendCounter++,Ei=ba=null,at=c,P.H=p,P.A=y,Ke===null&&(gt=null,Ye=0,Hu()),E}function WT(){for(;Ke!==null;)uv(Ke)}function YT(r,s){var o=at;at|=2;var c=lv(),p=cv();gt!==r||Ye!==s?(Ed=null,xd=Nt()+500,Ao(r,s)):So=Er(r,s);e:do try{if(ut!==0&&Ke!==null){s=Ke;var y=Jn;t:switch(ut){case 1:ut=0,Jn=null,Co(r,s,y,1);break;case 2:case 9:if(b_(y)){ut=0,Jn=null,dv(s);break}s=function(){ut!==2&&ut!==9||gt!==r||(ut=7),si(r)},y.then(s,s);break e;case 3:ut=7;break e;case 4:ut=5;break e;case 7:b_(y)?(ut=0,Jn=null,dv(s)):(ut=0,Jn=null,Co(r,s,y,7));break;case 5:var E=null;switch(Ke.tag){case 26:E=Ke.memoizedState;case 5:case 27:var k=Ke;if(E?Yv(E):k.stateNode.complete){ut=0,Jn=null;var G=k.sibling;if(G!==null)Ke=G;else{var te=k.return;te!==null?(Ke=te,Td(te)):Ke=null}break t}}ut=0,Jn=null,Co(r,s,y,5);break;case 6:ut=0,Jn=null,Co(r,s,y,6);break;case 8:Vm(),kt=6;break e;default:throw Error(i(462))}}XT();break}catch(fe){av(r,fe)}while(!0);return Ei=ba=null,P.H=c,P.A=p,at=o,Ke!==null?0:(gt=null,Ye=0,Hu(),kt)}function XT(){for(;Ke!==null&&!ln();)uv(Ke)}function uv(r){var s=M0(r.alternate,r,Oi);r.memoizedProps=r.pendingProps,s===null?Td(r):Ke=s}function dv(r){var s=r,o=s.alternate;switch(s.tag){case 15:case 0:s=R0(o,s,s.pendingProps,s.type,void 0,Ye);break;case 11:s=R0(o,s,s.pendingProps,s.type.render,s.ref,Ye);break;case 5:em(s);default:P0(o,s),s=Ke=c_(s,Oi),s=M0(o,s,Oi)}r.memoizedProps=r.pendingProps,s===null?Td(r):Ke=s}function Co(r,s,o,c){Ei=ba=null,em(s),go=null,Xl=0;var p=s.return;try{if(zT(r,p,s,o,Ye)){kt=1,hd(r,dr(o,r.current)),Ke=null;return}}catch(y){if(p!==null)throw Ke=p,y;kt=1,hd(r,dr(o,r.current)),Ke=null;return}s.flags&32768?(tt||c===1?r=!0:So||(Ye&536870912)!==0?r=!1:(_s=r=!0,(c===2||c===9||c===3||c===6)&&(c=Yn.current,c!==null&&c.tag===13&&(c.flags|=16384))),hv(s,r)):Td(s)}function Td(r){var s=r;do{if((s.flags&32768)!==0){hv(s,_s);return}r=s.return;var o=FT(s.alternate,s,Oi);if(o!==null){Ke=o;return}if(s=s.sibling,s!==null){Ke=s;return}Ke=s=r}while(s!==null);kt===0&&(kt=5)}function hv(r,s){do{var o=qT(r.alternate,r);if(o!==null){o.flags&=32767,Ke=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(r=r.sibling,r!==null)){Ke=r;return}Ke=r=o}while(r!==null);kt=6,Ke=null}function fv(r,s,o,c,p,y,E,k,G){r.cancelPendingCommit=null;do Ad();while(tn!==0);if((at&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=Cf,_f(r,o,y,E,k,G),r===gt&&(Ke=gt=null,Ye=0),To=s,xs=r,ki=o,Nm=y,Pm=p,nv=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,tA(Ji,function(){return _v(),null})):(r.callbackNode=null,r.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=P.T,P.T=null,p=B.p,B.p=2,E=at,at|=4;try{HT(r,s,o)}finally{at=E,B.p=p,P.T=c}}tn=1,mv(),pv(),gv()}}function mv(){if(tn===1){tn=0;var r=xs,s=To,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=P.T,P.T=null;var c=B.p;B.p=2;var p=at;at|=4;try{K0(s,r);var y=Xm,E=e_(r.containerInfo),k=y.focusedElem,G=y.selectionRange;if(E!==k&&k&&k.ownerDocument&&Zy(k.ownerDocument.documentElement,k)){if(G!==null&&Ef(k)){var te=G.start,fe=G.end;if(fe===void 0&&(fe=te),"selectionStart"in k)k.selectionStart=te,k.selectionEnd=Math.min(fe,k.value.length);else{var ye=k.ownerDocument||document,re=ye&&ye.defaultView||window;if(re.getSelection){var oe=re.getSelection(),Re=k.textContent.length,Pe=Math.min(G.start,Re),pt=G.end===void 0?Pe:Math.min(G.end,Re);!oe.extend&&Pe>pt&&(E=pt,pt=Pe,Pe=E);var X=Jy(k,Pe),K=Jy(k,pt);if(X&&K&&(oe.rangeCount!==1||oe.anchorNode!==X.node||oe.anchorOffset!==X.offset||oe.focusNode!==K.node||oe.focusOffset!==K.offset)){var ee=ye.createRange();ee.setStart(X.node,X.offset),oe.removeAllRanges(),Pe>pt?(oe.addRange(ee),oe.extend(K.node,K.offset)):(ee.setEnd(K.node,K.offset),oe.addRange(ee))}}}}for(ye=[],oe=k;oe=oe.parentNode;)oe.nodeType===1&&ye.push({element:oe,left:oe.scrollLeft,top:oe.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<ye.length;k++){var ge=ye[k];ge.element.scrollLeft=ge.left,ge.element.scrollTop=ge.top}}Vd=!!Ym,Xm=Ym=null}finally{at=p,B.p=c,P.T=o}}r.current=s,tn=2}}function pv(){if(tn===2){tn=0;var r=xs,s=To,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=P.T,P.T=null;var c=B.p;B.p=2;var p=at;at|=4;try{q0(r,s.alternate,s)}finally{at=p,B.p=c,P.T=o}}tn=3}}function gv(){if(tn===4||tn===3){tn=0,Dn();var r=xs,s=To,o=ki,c=nv;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?tn=5:(tn=0,To=xs=null,yv(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&(bs=null),gi(o),s=s.stateNode,mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(xr,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=P.T,p=B.p,B.p=2,P.T=null;try{for(var y=r.onRecoverableError,E=0;E<c.length;E++){var k=c[E];y(k.value,{componentStack:k.stack})}}finally{P.T=s,B.p=p}}(ki&3)!==0&&Ad(),si(r),p=r.pendingLanes,(o&261930)!==0&&(p&42)!==0?r===Lm?mc++:(mc=0,Lm=r):mc=0,pc(0)}}function yv(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,Wl(s)))}function Ad(){return mv(),pv(),gv(),_v()}function _v(){if(tn!==5)return!1;var r=xs,s=Nm;Nm=0;var o=gi(ki),c=P.T,p=B.p;try{B.p=32>o?32:o,P.T=null,o=Pm,Pm=null;var y=xs,E=ki;if(tn=0,To=xs=null,ki=0,(at&6)!==0)throw Error(i(331));var k=at;if(at|=4,Z0(y.current),Y0(y,y.current,E,o),at=k,pc(0,!1),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(xr,y)}catch{}return!0}finally{B.p=p,P.T=c,yv(r,s)}}function vv(r,s,o){s=dr(o,s),s=pm(r.stateNode,s,2),r=ms(r,s,2),r!==null&&(ra(r,2),si(r))}function dt(r,s,o){if(r.tag===3)vv(r,r,o);else for(;s!==null;){if(s.tag===3){vv(s,r,o);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(bs===null||!bs.has(c))){r=dr(o,r),o=b0(2),c=ms(s,o,2),c!==null&&(x0(o,c,s,r),ra(c,2),si(c));break}}s=s.return}}function Um(r,s,o){var c=r.pingCache;if(c===null){c=r.pingCache=new $T;var p=new Set;c.set(s,p)}else p=c.get(s),p===void 0&&(p=new Set,c.set(s,p));p.has(o)||(Om=!0,p.add(o),r=JT.bind(null,r,s,o),s.then(r,r))}function JT(r,s,o){var c=r.pingCache;c!==null&&c.delete(s),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,gt===r&&(Ye&o)===o&&(kt===4||kt===3&&(Ye&62914560)===Ye&&300>Nt()-bd?(at&2)===0&&Ao(r,0):km|=o,wo===Ye&&(wo=0)),si(r)}function bv(r,s){s===0&&(s=Eu()),r=ya(r,s),r!==null&&(ra(r,s),si(r))}function ZT(r){var s=r.memoizedState,o=0;s!==null&&(o=s.retryLane),bv(r,o)}function eA(r,s){var o=0;switch(r.tag){case 31:case 13:var c=r.stateNode,p=r.memoizedState;p!==null&&(o=p.retryLane);break;case 19:c=r.stateNode;break;case 22:c=r.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(s),bv(r,o)}function tA(r,s){return Ne(r,s)}var Cd=null,Ro=null,Bm=!1,Rd=!1,Fm=!1,Ss=0;function si(r){r!==Ro&&r.next===null&&(Ro===null?Cd=Ro=r:Ro=Ro.next=r),Rd=!0,Bm||(Bm=!0,rA())}function pc(r,s){if(!Fm&&Rd){Fm=!0;do for(var o=!1,c=Cd;c!==null;){if(r!==0){var p=c.pendingLanes;if(p===0)var y=0;else{var E=c.suspendedLanes,k=c.pingedLanes;y=(1<<31-Pt(42|r)+1)-1,y&=p&~(E&~k),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,wv(c,y))}else y=Ye,y=Br(c,c===gt?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(y&3)===0||Er(c,y)||(o=!0,wv(c,y));c=c.next}while(o);Fm=!1}}function nA(){xv()}function xv(){Rd=Bm=!1;var r=0;Ss!==0&&fA()&&(r=Ss);for(var s=Nt(),o=null,c=Cd;c!==null;){var p=c.next,y=Ev(c,s);y===0?(c.next=null,o===null?Cd=p:o.next=p,p===null&&(Ro=o)):(o=c,(r!==0||(y&3)!==0)&&(Rd=!0)),c=p}tn!==0&&tn!==5||pc(r),Ss!==0&&(Ss=0)}function Ev(r,s){for(var o=r.suspendedLanes,c=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var E=31-Pt(y),k=1<<E,G=p[E];G===-1?((k&o)===0||(k&c)!==0)&&(p[E]=yf(k,s)):G<=s&&(r.expiredLanes|=k),y&=~k}if(s=gt,o=Ye,o=Br(r,r===s?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c=r.callbackNode,o===0||r===s&&(ut===2||ut===9)||r.cancelPendingCommit!==null)return c!==null&&c!==null&&Mt(c),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||Er(r,o)){if(s=o&-o,s===r.callbackPriority)return s;switch(c!==null&&Mt(c),gi(o)){case 2:case 8:o=Tl;break;case 32:o=Ji;break;case 268435456:o=yu;break;default:o=Ji}return c=Sv.bind(null,r),o=Ne(o,c),r.callbackPriority=s,r.callbackNode=o,s}return c!==null&&c!==null&&Mt(c),r.callbackPriority=2,r.callbackNode=null,2}function Sv(r,s){if(tn!==0&&tn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(Ad()&&r.callbackNode!==o)return null;var c=Ye;return c=Br(r,r===gt?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c===0?null:(iv(r,c,s),Ev(r,Nt()),r.callbackNode!=null&&r.callbackNode===o?Sv.bind(null,r):null)}function wv(r,s){if(Ad())return null;iv(r,s,!0)}function rA(){pA(function(){(at&6)!==0?Ne(Gn,nA):xv()})}function qm(){if(Ss===0){var r=fo;r===0&&(r=zr,zr<<=1,(zr&261888)===0&&(zr=256)),Ss=r}return Ss}function Tv(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Xa(""+r)}function Av(r,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,r.id&&o.setAttribute("form",r.id),s.parentNode.insertBefore(o,s),r=new FormData(r),o.parentNode.removeChild(o),r}function iA(r,s,o,c,p){if(s==="submit"&&o&&o.stateNode===p){var y=Tv((p[cn]||null).action),E=c.submitter;E&&(s=(s=E[cn]||null)?Tv(s.formAction):E.getAttribute("formAction"),s!==null&&(y=s,E=null));var k=new Jr("action","action",null,c,p);r.push({event:k,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ss!==0){var G=E?Av(p,E):new FormData(p);cm(o,{pending:!0,data:G,method:p.method,action:y},null,G)}}else typeof y=="function"&&(k.preventDefault(),G=E?Av(p,E):new FormData(p),cm(o,{pending:!0,data:G,method:p.method,action:y},y,G))},currentTarget:p}]})}}for(var Hm=0;Hm<Af.length;Hm++){var Gm=Af[Hm],sA=Gm.toLowerCase(),aA=Gm[0].toUpperCase()+Gm.slice(1);Ir(sA,"on"+aA)}Ir(r_,"onAnimationEnd"),Ir(i_,"onAnimationIteration"),Ir(s_,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(ET,"onTransitionRun"),Ir(ST,"onTransitionStart"),Ir(wT,"onTransitionCancel"),Ir(a_,"onTransitionEnd"),Kr("onMouseEnter",["mouseout","mouseover"]),Kr("onMouseLeave",["mouseout","mouseover"]),Kr("onPointerEnter",["pointerout","pointerover"]),Kr("onPointerLeave",["pointerout","pointerover"]),$r("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$r("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$r("onBeforeInput",["compositionend","keypress","textInput","paste"]),$r("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$r("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$r("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gc));function Cv(r,s){s=(s&4)!==0;for(var o=0;o<r.length;o++){var c=r[o],p=c.event;c=c.listeners;e:{var y=void 0;if(s)for(var E=c.length-1;0<=E;E--){var k=c[E],G=k.instance,te=k.currentTarget;if(k=k.listener,G!==y&&p.isPropagationStopped())break e;y=k,p.currentTarget=te;try{y(p)}catch(fe){qu(fe)}p.currentTarget=null,y=G}else for(E=0;E<c.length;E++){if(k=c[E],G=k.instance,te=k.currentTarget,k=k.listener,G!==y&&p.isPropagationStopped())break e;y=k,p.currentTarget=te;try{y(p)}catch(fe){qu(fe)}p.currentTarget=null,y=G}}}}function We(r,s){var o=s[Qa];o===void 0&&(o=s[Qa]=new Set);var c=r+"__bubble";o.has(c)||(Rv(s,r,2,!1),o.add(c))}function Qm(r,s,o){var c=0;s&&(c|=4),Rv(o,r,c,s)}var Dd="_reactListening"+Math.random().toString(36).slice(2);function $m(r){if(!r[Dd]){r[Dd]=!0,Rl.forEach(function(o){o!=="selectionchange"&&(oA.has(o)||Qm(o,!1,r),Qm(o,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Dd]||(s[Dd]=!0,Qm("selectionchange",!1,s))}}function Rv(r,s,o,c){switch(rb(s)){case 2:var p=NA;break;case 8:p=PA;break;default:p=lp}o=p.bind(null,s,o,r),p=void 0,!ca||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),c?p!==void 0?r.addEventListener(s,o,{capture:!0,passive:p}):r.addEventListener(s,o,!0):p!==void 0?r.addEventListener(s,o,{passive:p}):r.addEventListener(s,o,!1)}function Km(r,s,o,c,p){var y=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var E=c.tag;if(E===3||E===4){var k=c.stateNode.containerInfo;if(k===p)break;if(E===4)for(E=c.return;E!==null;){var G=E.tag;if((G===3||G===4)&&E.stateNode.containerInfo===p)return;E=E.return}for(;k!==null;){if(E=Gr(k),E===null)return;if(G=E.tag,G===5||G===6||G===26||G===27){c=y=E;continue e}k=k.parentNode}}c=c.return}is(function(){var te=y,fe=or(o),ye=[];e:{var re=o_.get(r);if(re!==void 0){var oe=Jr,Re=r;switch(r){case"keypress":if(da(o)===0)break e;case"keydown":case"keyup":oe=Uu;break;case"focusin":Re="focus",oe=fa;break;case"focusout":Re="blur",oe=fa;break;case"beforeblur":case"afterblur":oe=fa;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Bl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=ju;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=b;break;case r_:case i_:case s_:oe=ku;break;case a_:oe=V;break;case"scroll":case"scrollend":oe=Ul;break;case"wheel":oe=se;break;case"copy":case"cut":case"paste":oe=Mu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=vi;break;case"toggle":case"beforetoggle":oe=qe}var Pe=(s&4)!==0,pt=!Pe&&(r==="scroll"||r==="scrollend"),X=Pe?re!==null?re+"Capture":null:re;Pe=[];for(var K=te,ee;K!==null;){var ge=K;if(ee=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||ee===null||X===null||(ge=Ar(K,X),ge!=null&&Pe.push(yc(K,ge,ee))),pt)break;K=K.return}0<Pe.length&&(re=new oe(re,Re,null,o,fe),ye.push({event:re,listeners:Pe}))}}if((s&7)===0){e:{if(re=r==="mouseover"||r==="pointerover",oe=r==="mouseout"||r==="pointerout",re&&o!==Ll&&(Re=o.relatedTarget||o.fromElement)&&(Gr(Re)||Re[qr]))break e;if((oe||re)&&(re=fe.window===fe?fe:(re=fe.ownerDocument)?re.defaultView||re.parentWindow:window,oe?(Re=o.relatedTarget||o.toElement,oe=te,Re=Re?Gr(Re):null,Re!==null&&(pt=l(Re),Pe=Re.tag,Re!==pt||Pe!==5&&Pe!==27&&Pe!==6)&&(Re=null)):(oe=null,Re=te),oe!==Re)){if(Pe=Bl,ge="onMouseLeave",X="onMouseEnter",K="mouse",(r==="pointerout"||r==="pointerover")&&(Pe=vi,ge="onPointerLeave",X="onPointerEnter",K="pointer"),pt=oe==null?re:Qn(oe),ee=Re==null?re:Qn(Re),re=new Pe(ge,K+"leave",oe,o,fe),re.target=pt,re.relatedTarget=ee,ge=null,Gr(fe)===te&&(Pe=new Pe(X,K+"enter",Re,o,fe),Pe.target=ee,Pe.relatedTarget=pt,ge=Pe),pt=ge,oe&&Re)t:{for(Pe=lA,X=oe,K=Re,ee=0,ge=X;ge;ge=Pe(ge))ee++;ge=0;for(var Oe=K;Oe;Oe=Pe(Oe))ge++;for(;0<ee-ge;)X=Pe(X),ee--;for(;0<ge-ee;)K=Pe(K),ge--;for(;ee--;){if(X===K||K!==null&&X===K.alternate){Pe=X;break t}X=Pe(X),K=Pe(K)}Pe=null}else Pe=null;oe!==null&&Dv(ye,re,oe,Pe,!1),Re!==null&&pt!==null&&Dv(ye,pt,Re,Pe,!0)}}e:{if(re=te?Qn(te):window,oe=re.nodeName&&re.nodeName.toLowerCase(),oe==="select"||oe==="input"&&re.type==="file")var rt=Qy;else if(Hy(re))if($y)rt=vT;else{rt=yT;var Ie=gT}else oe=re.nodeName,!oe||oe.toLowerCase()!=="input"||re.type!=="checkbox"&&re.type!=="radio"?te&&Ya(te.elementType)&&(rt=Qy):rt=_T;if(rt&&(rt=rt(r,te))){Gy(ye,rt,o,fe);break e}Ie&&Ie(r,re,te),r==="focusout"&&te&&re.type==="number"&&te.memoizedProps.value!=null&&Ml(re,"number",re.value)}switch(Ie=te?Qn(te):window,r){case"focusin":(Hy(Ie)||Ie.contentEditable==="true")&&(io=Ie,Sf=te,Ql=null);break;case"focusout":Ql=Sf=io=null;break;case"mousedown":wf=!0;break;case"contextmenu":case"mouseup":case"dragend":wf=!1,t_(ye,o,fe);break;case"selectionchange":if(xT)break;case"keydown":case"keyup":t_(ye,o,fe)}var Ge;if(st)e:{switch(r){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else ro?ma(r,o)&&(Xe="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Xe="onCompositionStart");Xe&&(ti&&o.locale!=="ko"&&(ro||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&ro&&(Ge=zl()):(Xr=fe,Vl="value"in Xr?Xr.value:Xr.textContent,ro=!0)),Ie=Id(te,Xe),0<Ie.length&&(Xe=new ei(Xe,r,null,o,fe),ye.push({event:Xe,listeners:Ie}),Ge?Xe.data=Ge:(Ge=no(o),Ge!==null&&(Xe.data=Ge)))),(Ge=cr?hT(r,o):fT(r,o))&&(Xe=Id(te,"onBeforeInput"),0<Xe.length&&(Ie=new ei("onBeforeInput","beforeinput",null,o,fe),ye.push({event:Ie,listeners:Xe}),Ie.data=Ge)),iA(ye,r,te,o,fe)}Cv(ye,s)})}function yc(r,s,o){return{instance:r,listener:s,currentTarget:o}}function Id(r,s){for(var o=s+"Capture",c=[];r!==null;){var p=r,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Ar(r,o),p!=null&&c.unshift(yc(r,p,y)),p=Ar(r,s),p!=null&&c.push(yc(r,p,y))),r.tag===3)return c;r=r.return}return[]}function lA(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Dv(r,s,o,c,p){for(var y=s._reactName,E=[];o!==null&&o!==c;){var k=o,G=k.alternate,te=k.stateNode;if(k=k.tag,G!==null&&G===c)break;k!==5&&k!==26&&k!==27||te===null||(G=te,p?(te=Ar(o,y),te!=null&&E.unshift(yc(o,te,G))):p||(te=Ar(o,y),te!=null&&E.push(yc(o,te,G)))),o=o.return}E.length!==0&&r.push({event:s,listeners:E})}var cA=/\r\n?/g,uA=/\u0000|\uFFFD/g;function Iv(r){return(typeof r=="string"?r:""+r).replace(cA,`
`).replace(uA,"")}function jv(r,s){return s=Iv(s),Iv(r)===s}function mt(r,s,o,c,p,y){switch(o){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||Nn(r,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&Nn(r,""+c);break;case"className":$n(r,"class",c);break;case"tabIndex":$n(r,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":$n(r,o,c);break;case"style":Pl(r,c,y);break;case"data":if(s!=="object"){$n(r,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||o!=="href")){r.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(o);break}c=Xa(""+c),r.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&mt(r,s,"name",p.name,p,null),mt(r,s,"formEncType",p.formEncType,p,null),mt(r,s,"formMethod",p.formMethod,p,null),mt(r,s,"formTarget",p.formTarget,p,null)):(mt(r,s,"encType",p.encType,p,null),mt(r,s,"method",p.method,p,null),mt(r,s,"target",p.target,p,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(o);break}c=Xa(""+c),r.setAttribute(o,c);break;case"onClick":c!=null&&(r.onclick=Tr);break;case"onScroll":c!=null&&We("scroll",r);break;case"onScrollEnd":c!=null&&We("scrollend",r);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"multiple":r.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":r.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){r.removeAttribute("xlink:href");break}o=Xa(""+c),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,""+c):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":c===!0?r.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,c):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?r.setAttribute(o,c):r.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?r.removeAttribute(o):r.setAttribute(o,c);break;case"popover":We("beforetoggle",r),We("toggle",r),Ka(r,"popover",c);break;case"xlinkActuate":Gt(r,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Gt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Gt(r,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Gt(r,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Gt(r,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Gt(r,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Gt(r,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Gt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Gt(r,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Ka(r,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Iu.get(o)||o,Ka(r,o,c))}}function Wm(r,s,o,c,p,y){switch(o){case"style":Pl(r,c,y);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"children":typeof c=="string"?Nn(r,c):(typeof c=="number"||typeof c=="bigint")&&Nn(r,""+c);break;case"onScroll":c!=null&&We("scroll",r);break;case"onScrollEnd":c!=null&&We("scrollend",r);break;case"onClick":c!=null&&(r.onclick=Tr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Dl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),s=o.slice(2,p?o.length-7:void 0),y=r[cn]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(s,y,p),typeof c=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(s,c,p);break e}o in r?r[o]=c:c===!0?r.setAttribute(o,""):Ka(r,o,c)}}}function vn(r,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":We("error",r),We("load",r);var c=!1,p=!1,y;for(y in o)if(o.hasOwnProperty(y)){var E=o[y];if(E!=null)switch(y){case"src":c=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:mt(r,s,y,E,o,null)}}p&&mt(r,s,"srcSet",o.srcSet,o,null),c&&mt(r,s,"src",o.src,o,null);return;case"input":We("invalid",r);var k=y=E=p=null,G=null,te=null;for(c in o)if(o.hasOwnProperty(c)){var fe=o[c];if(fe!=null)switch(c){case"name":p=fe;break;case"type":E=fe;break;case"checked":G=fe;break;case"defaultChecked":te=fe;break;case"value":y=fe;break;case"defaultValue":k=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,s));break;default:mt(r,s,c,fe,o,null)}}Cu(r,y,k,G,te,E,p,!1);return;case"select":We("invalid",r),c=E=y=null;for(p in o)if(o.hasOwnProperty(p)&&(k=o[p],k!=null))switch(p){case"value":y=k;break;case"defaultValue":E=k;break;case"multiple":c=k;default:mt(r,s,p,k,o,null)}s=y,o=E,r.multiple=!!c,s!=null?es(r,!!c,s,!1):o!=null&&es(r,!!c,o,!0);return;case"textarea":We("invalid",r),y=p=c=null;for(E in o)if(o.hasOwnProperty(E)&&(k=o[E],k!=null))switch(E){case"value":c=k;break;case"defaultValue":p=k;break;case"children":y=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(i(91));break;default:mt(r,s,E,k,o,null)}ts(r,c,p,y);return;case"option":for(G in o)o.hasOwnProperty(G)&&(c=o[G],c!=null)&&(G==="selected"?r.selected=c&&typeof c!="function"&&typeof c!="symbol":mt(r,s,G,c,o,null));return;case"dialog":We("beforetoggle",r),We("toggle",r),We("cancel",r),We("close",r);break;case"iframe":case"object":We("load",r);break;case"video":case"audio":for(c=0;c<gc.length;c++)We(gc[c],r);break;case"image":We("error",r),We("load",r);break;case"details":We("toggle",r);break;case"embed":case"source":case"link":We("error",r),We("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in o)if(o.hasOwnProperty(te)&&(c=o[te],c!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:mt(r,s,te,c,o,null)}return;default:if(Ya(s)){for(fe in o)o.hasOwnProperty(fe)&&(c=o[fe],c!==void 0&&Wm(r,s,fe,c,o,void 0));return}}for(k in o)o.hasOwnProperty(k)&&(c=o[k],c!=null&&mt(r,s,k,c,o,null))}function dA(r,s,o,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,E=null,k=null,G=null,te=null,fe=null;for(oe in o){var ye=o[oe];if(o.hasOwnProperty(oe)&&ye!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":G=ye;default:c.hasOwnProperty(oe)||mt(r,s,oe,null,c,ye)}}for(var re in c){var oe=c[re];if(ye=o[re],c.hasOwnProperty(re)&&(oe!=null||ye!=null))switch(re){case"type":y=oe;break;case"name":p=oe;break;case"checked":te=oe;break;case"defaultChecked":fe=oe;break;case"value":E=oe;break;case"defaultValue":k=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,s));break;default:oe!==ye&&mt(r,s,re,oe,c,ye)}}Wa(r,E,k,G,te,fe,y,p);return;case"select":oe=E=k=re=null;for(y in o)if(G=o[y],o.hasOwnProperty(y)&&G!=null)switch(y){case"value":break;case"multiple":oe=G;default:c.hasOwnProperty(y)||mt(r,s,y,null,c,G)}for(p in c)if(y=c[p],G=o[p],c.hasOwnProperty(p)&&(y!=null||G!=null))switch(p){case"value":re=y;break;case"defaultValue":k=y;break;case"multiple":E=y;default:y!==G&&mt(r,s,p,y,c,G)}s=k,o=E,c=oe,re!=null?es(r,!!o,re,!1):!!c!=!!o&&(s!=null?es(r,!!o,s,!0):es(r,!!o,o?[]:"",!1));return;case"textarea":oe=re=null;for(k in o)if(p=o[k],o.hasOwnProperty(k)&&p!=null&&!c.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:mt(r,s,k,null,c,p)}for(E in c)if(p=c[E],y=o[E],c.hasOwnProperty(E)&&(p!=null||y!=null))switch(E){case"value":re=p;break;case"defaultValue":oe=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==y&&mt(r,s,E,p,c,y)}Ru(r,re,oe);return;case"option":for(var Re in o)re=o[Re],o.hasOwnProperty(Re)&&re!=null&&!c.hasOwnProperty(Re)&&(Re==="selected"?r.selected=!1:mt(r,s,Re,null,c,re));for(G in c)re=c[G],oe=o[G],c.hasOwnProperty(G)&&re!==oe&&(re!=null||oe!=null)&&(G==="selected"?r.selected=re&&typeof re!="function"&&typeof re!="symbol":mt(r,s,G,re,c,oe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pe in o)re=o[Pe],o.hasOwnProperty(Pe)&&re!=null&&!c.hasOwnProperty(Pe)&&mt(r,s,Pe,null,c,re);for(te in c)if(re=c[te],oe=o[te],c.hasOwnProperty(te)&&re!==oe&&(re!=null||oe!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(i(137,s));break;default:mt(r,s,te,re,c,oe)}return;default:if(Ya(s)){for(var pt in o)re=o[pt],o.hasOwnProperty(pt)&&re!==void 0&&!c.hasOwnProperty(pt)&&Wm(r,s,pt,void 0,c,re);for(fe in c)re=c[fe],oe=o[fe],!c.hasOwnProperty(fe)||re===oe||re===void 0&&oe===void 0||Wm(r,s,fe,re,c,oe);return}}for(var X in o)re=o[X],o.hasOwnProperty(X)&&re!=null&&!c.hasOwnProperty(X)&&mt(r,s,X,null,c,re);for(ye in c)re=c[ye],oe=o[ye],!c.hasOwnProperty(ye)||re===oe||re==null&&oe==null||mt(r,s,ye,re,c,oe)}function Ov(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function hA(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var p=o[c],y=p.transferSize,E=p.initiatorType,k=p.duration;if(y&&k&&Ov(E)){for(E=0,k=p.responseEnd,c+=1;c<o.length;c++){var G=o[c],te=G.startTime;if(te>k)break;var fe=G.transferSize,ye=G.initiatorType;fe&&Ov(ye)&&(G=G.responseEnd,E+=fe*(G<k?1:(k-te)/(G-te)))}if(--c,s+=8*(y+E)/(p.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Ym=null,Xm=null;function jd(r){return r.nodeType===9?r:r.ownerDocument}function kv(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Mv(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function Jm(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Zm=null;function fA(){var r=window.event;return r&&r.type==="popstate"?r===Zm?!1:(Zm=r,!0):(Zm=null,!1)}var Nv=typeof setTimeout=="function"?setTimeout:void 0,mA=typeof clearTimeout=="function"?clearTimeout:void 0,Pv=typeof Promise=="function"?Promise:void 0,pA=typeof queueMicrotask=="function"?queueMicrotask:typeof Pv<"u"?function(r){return Pv.resolve(null).then(r).catch(gA)}:Nv;function gA(r){setTimeout(function(){throw r})}function ws(r){return r==="head"}function Lv(r,s){var o=s,c=0;do{var p=o.nextSibling;if(r.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(c===0){r.removeChild(p),Oo(s);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")_c(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,_c(o);for(var y=o.firstChild;y;){var E=y.nextSibling,k=y.nodeName;y[Hr]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=E}}else o==="body"&&_c(r.ownerDocument.body);o=p}while(o);Oo(s)}function Vv(r,s){var o=r;r=0;do{var c=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=c}while(o)}function ep(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":ep(o),$a(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function yA(r,s,o,c){for(;r.nodeType===1;){var p=o;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(c){if(!r[Hr])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=gr(r.nextSibling),r===null)break}return null}function _A(r,s,o){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=gr(r.nextSibling),r===null))return null;return r}function zv(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=gr(r.nextSibling),r===null))return null;return r}function tp(r){return r.data==="$?"||r.data==="$~"}function np(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function vA(r,s){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||o.readyState!=="loading")s();else{var c=function(){s(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),r._reactRetry=c}}function gr(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var rp=null;function Uv(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(s===0)return gr(r.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}r=r.nextSibling}return null}function Bv(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return r;s--}else o!=="/$"&&o!=="/&"||s++}r=r.previousSibling}return null}function Fv(r,s,o){switch(s=jd(o),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function _c(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);$a(r)}var yr=new Map,qv=new Set;function Od(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Mi=B.d;B.d={f:bA,r:xA,D:EA,C:SA,L:wA,m:TA,X:CA,S:AA,M:RA};function bA(){var r=Mi.f(),s=Sd();return r||s}function xA(r){var s=ar(r);s!==null&&s.tag===5&&s.type==="form"?a0(s):Mi.r(r)}var Do=typeof document>"u"?null:document;function Hv(r,s,o){var c=Do;if(c&&typeof s=="string"&&s){var p=Mn(s);p='link[rel="'+r+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),qv.has(p)||(qv.add(p),r={rel:r,crossOrigin:o,href:s},c.querySelector(p)===null&&(s=c.createElement("link"),vn(s,"link",r),Ht(s),c.head.appendChild(s)))}}function EA(r){Mi.D(r),Hv("dns-prefetch",r,null)}function SA(r,s){Mi.C(r,s),Hv("preconnect",r,s)}function wA(r,s,o){Mi.L(r,s,o);var c=Do;if(c&&r&&s){var p='link[rel="preload"][as="'+Mn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+Mn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+Mn(o.imageSizes)+'"]')):p+='[href="'+Mn(r)+'"]';var y=p;switch(s){case"style":y=Io(r);break;case"script":y=jo(r)}yr.has(y)||(r=v({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:r,as:s},o),yr.set(y,r),c.querySelector(p)!==null||s==="style"&&c.querySelector(vc(y))||s==="script"&&c.querySelector(bc(y))||(s=c.createElement("link"),vn(s,"link",r),Ht(s),c.head.appendChild(s)))}}function TA(r,s){Mi.m(r,s);var o=Do;if(o&&r){var c=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+Mn(c)+'"][href="'+Mn(r)+'"]',y=p;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=jo(r)}if(!yr.has(y)&&(r=v({rel:"modulepreload",href:r},s),yr.set(y,r),o.querySelector(p)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(bc(y)))return}c=o.createElement("link"),vn(c,"link",r),Ht(c),o.head.appendChild(c)}}}function AA(r,s,o){Mi.S(r,s,o);var c=Do;if(c&&r){var p=Qr(c).hoistableStyles,y=Io(r);s=s||"default";var E=p.get(y);if(!E){var k={loading:0,preload:null};if(E=c.querySelector(vc(y)))k.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":s},o),(o=yr.get(y))&&ip(r,o);var G=E=c.createElement("link");Ht(G),vn(G,"link",r),G._p=new Promise(function(te,fe){G.onload=te,G.onerror=fe}),G.addEventListener("load",function(){k.loading|=1}),G.addEventListener("error",function(){k.loading|=2}),k.loading|=4,kd(E,s,c)}E={type:"stylesheet",instance:E,count:1,state:k},p.set(y,E)}}}function CA(r,s){Mi.X(r,s);var o=Do;if(o&&r){var c=Qr(o).hoistableScripts,p=jo(r),y=c.get(p);y||(y=o.querySelector(bc(p)),y||(r=v({src:r,async:!0},s),(s=yr.get(p))&&sp(r,s),y=o.createElement("script"),Ht(y),vn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(p,y))}}function RA(r,s){Mi.M(r,s);var o=Do;if(o&&r){var c=Qr(o).hoistableScripts,p=jo(r),y=c.get(p);y||(y=o.querySelector(bc(p)),y||(r=v({src:r,async:!0,type:"module"},s),(s=yr.get(p))&&sp(r,s),y=o.createElement("script"),Ht(y),vn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(p,y))}}function Gv(r,s,o,c){var p=(p=pe.current)?Od(p):null;if(!p)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Io(o.href),o=Qr(p).hoistableStyles,c=o.get(s),c||(c={type:"style",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=Io(o.href);var y=Qr(p).hoistableStyles,E=y.get(r);if(E||(p=p.ownerDocument||p,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,E),(y=p.querySelector(vc(r)))&&!y._p&&(E.instance=y,E.state.loading=5),yr.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},yr.set(r,o),y||DA(p,r,o,E.state))),s&&c===null)throw Error(i(528,""));return E}if(s&&c!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=jo(o),o=Qr(p).hoistableScripts,c=o.get(s),c||(c={type:"script",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Io(r){return'href="'+Mn(r)+'"'}function vc(r){return'link[rel="stylesheet"]['+r+"]"}function Qv(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function DA(r,s,o,c){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=r.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),vn(s,"link",o),Ht(s),r.head.appendChild(s))}function jo(r){return'[src="'+Mn(r)+'"]'}function bc(r){return"script[async]"+r}function $v(r,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var c=r.querySelector('style[data-href~="'+Mn(o.href)+'"]');if(c)return s.instance=c,Ht(c),c;var p=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(r.ownerDocument||r).createElement("style"),Ht(c),vn(c,"style",p),kd(c,o.precedence,r),s.instance=c;case"stylesheet":p=Io(o.href);var y=r.querySelector(vc(p));if(y)return s.state.loading|=4,s.instance=y,Ht(y),y;c=Qv(o),(p=yr.get(p))&&ip(c,p),y=(r.ownerDocument||r).createElement("link"),Ht(y);var E=y;return E._p=new Promise(function(k,G){E.onload=k,E.onerror=G}),vn(y,"link",c),s.state.loading|=4,kd(y,o.precedence,r),s.instance=y;case"script":return y=jo(o.src),(p=r.querySelector(bc(y)))?(s.instance=p,Ht(p),p):(c=o,(p=yr.get(y))&&(c=v({},o),sp(c,p)),r=r.ownerDocument||r,p=r.createElement("script"),Ht(p),vn(p,"link",c),r.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,kd(c,o.precedence,r));return s.instance}function kd(r,s,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=c.length?c[c.length-1]:null,y=p,E=0;E<c.length;E++){var k=c[E];if(k.dataset.precedence===s)y=k;else if(y!==p)break}y?y.parentNode.insertBefore(r,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(r,s.firstChild))}function ip(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function sp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var Md=null;function Kv(r,s,o){if(Md===null){var c=new Map,p=Md=new Map;p.set(o,c)}else p=Md,c=p.get(o),c||(c=new Map,p.set(o,c));if(c.has(r))return c;for(c.set(r,null),o=o.getElementsByTagName(r),p=0;p<o.length;p++){var y=o[p];if(!(y[Hr]||y[qt]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var E=y.getAttribute(s)||"";E=r+E;var k=c.get(E);k?k.push(y):c.set(E,[y])}}return c}function Wv(r,s,o){r=r.ownerDocument||r,r.head.insertBefore(o,s==="title"?r.querySelector("head > title"):null)}function IA(r,s,o){if(o===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Yv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function jA(r,s,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=Io(c.href),y=s.querySelector(vc(p));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=Nd.bind(r),s.then(r,r)),o.state.loading|=4,o.instance=y,Ht(y);return}y=s.ownerDocument||s,c=Qv(c),(p=yr.get(p))&&ip(c,p),y=y.createElement("link"),Ht(y);var E=y;E._p=new Promise(function(k,G){E.onload=k,E.onerror=G}),vn(y,"link",c),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=Nd.bind(r),s.addEventListener("load",o),s.addEventListener("error",o))}}var ap=0;function OA(r,s){return r.stylesheets&&r.count===0&&Ld(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var c=setTimeout(function(){if(r.stylesheets&&Ld(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+s);0<r.imgBytes&&ap===0&&(ap=62500*hA());var p=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Ld(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>ap?50:800)+s);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(c),clearTimeout(p)}}:null}function Nd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ld(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Pd=null;function Ld(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Pd=new Map,s.forEach(kA,r),Pd=null,Nd.call(r))}function kA(r,s){if(!(s.state.loading&4)){var o=Pd.get(r);if(o)var c=o.get(null);else{o=new Map,Pd.set(r,o);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var E=p[y];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),c=E)}c&&o.set(null,c)}p=s.instance,E=p.getAttribute("data-precedence"),y=o.get(E)||c,y===c&&o.set(null,p),o.set(E,p),this.count++,c=Nd.bind(this),p.addEventListener("load",c),p.addEventListener("error",c),y?y.parentNode.insertBefore(p,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),s.state.loading|=4}}var xc={$$typeof:q,Provider:null,Consumer:null,_currentValue:Q,_currentValue2:Q,_threadCount:0};function MA(r,s,o,c,p,y,E,k,G){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Fr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fr(0),this.hiddenUpdates=Fr(null),this.identifierPrefix=c,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function Xv(r,s,o,c,p,y,E,k,G,te,fe,ye){return r=new MA(r,s,o,E,G,te,fe,ye,k),s=1,y===!0&&(s|=24),y=Wn(3,null,null,s),r.current=y,y.stateNode=r,s=zf(),s.refCount++,r.pooledCache=s,s.refCount++,y.memoizedState={element:c,isDehydrated:o,cache:s},qf(y),r}function Jv(r){return r?(r=oo,r):oo}function Zv(r,s,o,c,p,y){p=Jv(p),c.context===null?c.context=p:c.pendingContext=p,c=fs(s),c.payload={element:o},y=y===void 0?null:y,y!==null&&(c.callback=y),o=ms(r,c,s),o!==null&&(Un(o,r,s),Zl(o,r,s))}function eb(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<s?o:s}}function op(r,s){eb(r,s),(r=r.alternate)&&eb(r,s)}function tb(r){if(r.tag===13||r.tag===31){var s=ya(r,67108864);s!==null&&Un(s,r,67108864),op(r,67108864)}}function nb(r){if(r.tag===13||r.tag===31){var s=er();s=sa(s);var o=ya(r,s);o!==null&&Un(o,r,s),op(r,s)}}var Vd=!0;function NA(r,s,o,c){var p=P.T;P.T=null;var y=B.p;try{B.p=2,lp(r,s,o,c)}finally{B.p=y,P.T=p}}function PA(r,s,o,c){var p=P.T;P.T=null;var y=B.p;try{B.p=8,lp(r,s,o,c)}finally{B.p=y,P.T=p}}function lp(r,s,o,c){if(Vd){var p=cp(c);if(p===null)Km(r,s,c,zd,o),ib(r,c);else if(VA(p,r,s,o,c))c.stopPropagation();else if(ib(r,c),s&4&&-1<LA.indexOf(r)){for(;p!==null;){var y=ar(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var E=Ur(y.pendingLanes);if(E!==0){var k=y;for(k.pendingLanes|=2,k.entangledLanes|=2;E;){var G=1<<31-Pt(E);k.entanglements[1]|=G,E&=~G}si(y),(at&6)===0&&(xd=Nt()+500,pc(0))}}break;case 31:case 13:k=ya(y,2),k!==null&&Un(k,y,2),Sd(),op(y,2)}if(y=cp(c),y===null&&Km(r,s,c,zd,o),y===p)break;p=y}p!==null&&c.stopPropagation()}else Km(r,s,c,null,o)}}function cp(r){return r=or(r),up(r)}var zd=null;function up(r){if(zd=null,r=Gr(r),r!==null){var s=l(r);if(s===null)r=null;else{var o=s.tag;if(o===13){if(r=u(s),r!==null)return r;r=null}else if(o===31){if(r=f(s),r!==null)return r;r=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return zd=r,null}function rb(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(jt()){case Gn:return 2;case Tl:return 8;case Ji:case gf:return 32;case yu:return 268435456;default:return 32}default:return 32}}var dp=!1,Ts=null,As=null,Cs=null,Ec=new Map,Sc=new Map,Rs=[],LA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ib(r,s){switch(r){case"focusin":case"focusout":Ts=null;break;case"dragenter":case"dragleave":As=null;break;case"mouseover":case"mouseout":Cs=null;break;case"pointerover":case"pointerout":Ec.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sc.delete(s.pointerId)}}function wc(r,s,o,c,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:o,eventSystemFlags:c,nativeEvent:y,targetContainers:[p]},s!==null&&(s=ar(s),s!==null&&tb(s)),r):(r.eventSystemFlags|=c,s=r.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),r)}function VA(r,s,o,c,p){switch(s){case"focusin":return Ts=wc(Ts,r,s,o,c,p),!0;case"dragenter":return As=wc(As,r,s,o,c,p),!0;case"mouseover":return Cs=wc(Cs,r,s,o,c,p),!0;case"pointerover":var y=p.pointerId;return Ec.set(y,wc(Ec.get(y)||null,r,s,o,c,p)),!0;case"gotpointercapture":return y=p.pointerId,Sc.set(y,wc(Sc.get(y)||null,r,s,o,c,p)),!0}return!1}function sb(r){var s=Gr(r.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=u(o),s!==null){r.blockedOn=s,Sr(r.priority,function(){nb(o)});return}}else if(s===31){if(s=f(o),s!==null){r.blockedOn=s,Sr(r.priority,function(){nb(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Ud(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var o=cp(r.nativeEvent);if(o===null){o=r.nativeEvent;var c=new o.constructor(o.type,o);Ll=c,o.target.dispatchEvent(c),Ll=null}else return s=ar(o),s!==null&&tb(s),r.blockedOn=o,!1;s.shift()}return!0}function ab(r,s,o){Ud(r)&&o.delete(s)}function zA(){dp=!1,Ts!==null&&Ud(Ts)&&(Ts=null),As!==null&&Ud(As)&&(As=null),Cs!==null&&Ud(Cs)&&(Cs=null),Ec.forEach(ab),Sc.forEach(ab)}function Bd(r,s){r.blockedOn===s&&(r.blockedOn=null,dp||(dp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,zA)))}var Fd=null;function ob(r){Fd!==r&&(Fd=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Fd===r&&(Fd=null);for(var s=0;s<r.length;s+=3){var o=r[s],c=r[s+1],p=r[s+2];if(typeof c!="function"){if(up(c||o)===null)continue;break}var y=ar(o);y!==null&&(r.splice(s,3),s-=3,cm(y,{pending:!0,data:p,method:o.method,action:c},c,p))}}))}function Oo(r){function s(G){return Bd(G,r)}Ts!==null&&Bd(Ts,r),As!==null&&Bd(As,r),Cs!==null&&Bd(Cs,r),Ec.forEach(s),Sc.forEach(s);for(var o=0;o<Rs.length;o++){var c=Rs[o];c.blockedOn===r&&(c.blockedOn=null)}for(;0<Rs.length&&(o=Rs[0],o.blockedOn===null);)sb(o),o.blockedOn===null&&Rs.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var p=o[c],y=o[c+1],E=p[cn]||null;if(typeof y=="function")E||ob(o);else if(E){var k=null;if(y&&y.hasAttribute("formAction")){if(p=y,E=y[cn]||null)k=E.formAction;else if(up(p)!==null)continue}else k=E.action;typeof k=="function"?o[c+1]=k:(o.splice(c,3),c-=3),ob(o)}}}function lb(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(E){return p=E})},focusReset:"manual",scroll:"manual"})}function s(){p!==null&&(p(),p=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,p=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),p!==null&&(p(),p=null)}}}function hp(r){this._internalRoot=r}qd.prototype.render=hp.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,c=er();Zv(o,c,r,s,null,null)},qd.prototype.unmount=hp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;Zv(r.current,2,null,r,null,null),Sd(),s[qr]=null}};function qd(r){this._internalRoot=r}qd.prototype.unstable_scheduleHydration=function(r){if(r){var s=Su();r={blockedOn:null,target:r,priority:s};for(var o=0;o<Rs.length&&s!==0&&s<Rs[o].priority;o++);Rs.splice(o,0,r),o===0&&sb(r)}};var cb=e.version;if(cb!=="19.2.3")throw Error(i(527,cb,"19.2.3"));B.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=g(s),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var UA={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hd.isDisabled&&Hd.supportsFiber)try{xr=Hd.inject(UA),mn=Hd}catch{}}return Ac.createRoot=function(r,s){if(!a(r))throw Error(i(299));var o=!1,c="",p=g0,y=y0,E=_0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(E=s.onRecoverableError)),s=Xv(r,1,!1,null,null,o,c,null,p,y,E,lb),r[qr]=s.current,$m(r),new hp(s)},Ac.hydrateRoot=function(r,s,o){if(!a(r))throw Error(i(299));var c=!1,p="",y=g0,E=y0,k=_0,G=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(k=o.onRecoverableError),o.formState!==void 0&&(G=o.formState)),s=Xv(r,1,!0,s,o??null,c,p,G,y,E,k,lb),s.context=Jv(null),o=s.current,c=er(),c=sa(c),p=fs(c),p.callback=null,ms(o,p,c),o=c,s.current.lanes=o,ra(s,o),si(s),r[qr]=s.current,$m(r),new qd(s)},Ac.version="19.2.3",Ac}var vb;function YA(){if(vb)return pp.exports;vb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),pp.exports=WA(),pp.exports}var XA=YA();var bb="popstate";function JA(t={}){function e(i,a){let{pathname:l,search:u,hash:f}=i.location;return zp("",{pathname:l,search:u,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:Bc(a)}return eC(e,n,null,t)}function Ct(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function nr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ZA(){return Math.random().toString(36).substring(2,10)}function xb(t,e){return{usr:t.state,key:t.key,idx:e}}function zp(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?al(e):e,state:n,key:e&&e.key||i||ZA()}}function Bc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function al(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function eC(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,u=a.history,f="POP",m=null,g=_();g==null&&(g=0,u.replaceState({...u.state,idx:g},""));function _(){return(u.state||{idx:null}).idx}function v(){f="POP";let N=_(),H=N==null?null:N-g;g=N,m&&m({action:f,location:I.location,delta:H})}function x(N,H){f="PUSH";let $=zp(I.location,N,H);g=_()+1;let q=xb($,g),me=I.createHref($);try{u.pushState(q,"",me)}catch(ie){if(ie instanceof DOMException&&ie.name==="DataCloneError")throw ie;a.location.assign(me)}l&&m&&m({action:f,location:I.location,delta:1})}function w(N,H){f="REPLACE";let $=zp(I.location,N,H);g=_();let q=xb($,g),me=I.createHref($);u.replaceState(q,"",me),l&&m&&m({action:f,location:I.location,delta:0})}function A(N){return tC(N)}let I={get action(){return f},get location(){return t(a,u)},listen(N){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(bb,v),m=N,()=>{a.removeEventListener(bb,v),m=null}},createHref(N){return e(a,N)},createURL:A,encodeLocation(N){let H=A(N);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:x,replace:w,go(N){return u.go(N)}};return I}function tC(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ct(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Bc(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function BE(t,e,n="/"){return nC(t,e,n,!1)}function nC(t,e,n,i){let a=typeof e=="string"?al(e):e,l=qi(a.pathname||"/",n);if(l==null)return null;let u=FE(t);rC(u);let f=null;for(let m=0;f==null&&m<u.length;++m){let g=mC(l);f=hC(u[m],g,i)}return f}function FE(t,e=[],n=[],i="",a=!1){let l=(u,f,m=a,g)=>{let _={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:f,route:u};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&m)return;Ct(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let v=zi([i,_.relativePath]),x=n.concat(_);u.children&&u.children.length>0&&(Ct(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),FE(u.children,e,x,v,m)),!(u.path==null&&!u.index)&&e.push({path:v,score:uC(v,u.index),routesMeta:x})};return t.forEach((u,f)=>{if(u.path===""||!u.path?.includes("?"))l(u,f);else for(let m of qE(u.path))l(u,f,!0,m)}),e}function qE(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let u=qE(i.join("/")),f=[];return f.push(...u.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...u),f.map(m=>t.startsWith("/")&&m===""?"/":m)}function rC(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:dC(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var iC=/^:[\w-]+$/,sC=3,aC=2,oC=1,lC=10,cC=-2,Eb=t=>t==="*";function uC(t,e){let n=t.split("/"),i=n.length;return n.some(Eb)&&(i+=cC),e&&(i+=aC),n.filter(a=>!Eb(a)).reduce((a,l)=>a+(iC.test(l)?sC:l===""?oC:lC),i)}function dC(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function hC(t,e,n=!1){let{routesMeta:i}=t,a={},l="/",u=[];for(let f=0;f<i.length;++f){let m=i[f],g=f===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",v=fh({path:m.relativePath,caseSensitive:m.caseSensitive,end:g},_),x=m.route;if(!v&&g&&n&&!i[i.length-1].route.index&&(v=fh({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},_)),!v)return null;Object.assign(a,v.params),u.push({params:a,pathname:zi([l,v.pathname]),pathnameBase:_C(zi([l,v.pathnameBase])),route:x}),v.pathnameBase!=="/"&&(l=zi([l,v.pathnameBase]))}return u}function fh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=fC(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],u=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:i.reduce((g,{paramName:_,isOptional:v},x)=>{if(_==="*"){let A=f[x]||"";u=l.slice(0,l.length-A.length).replace(/(.)\/+$/,"$1")}const w=f[x];return v&&!w?g[_]=void 0:g[_]=(w||"").replace(/%2F/g,"/"),g},{}),pathname:l,pathnameBase:u,pattern:t}}function fC(t,e=!1,n=!0){nr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,f,m)=>(i.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function mC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return nr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function qi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var HE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pC=t=>HE.test(t);function gC(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?al(t):t,l;if(n)if(pC(n))l=n;else{if(n.includes("//")){let u=n;n=n.replace(/\/\/+/g,"/"),nr(!1,`Pathnames cannot have embedded double slashes - normalizing ${u} -> ${n}`)}n.startsWith("/")?l=Sb(n.substring(1),"/"):l=Sb(n,e)}else l=e;return{pathname:l,search:vC(i),hash:bC(a)}}function Sb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function vp(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function yC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Ag(t){let e=yC(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function Cg(t,e,n,i=!1){let a;typeof t=="string"?a=al(t):(a={...t},Ct(!a.pathname||!a.pathname.includes("?"),vp("?","pathname","search",a)),Ct(!a.pathname||!a.pathname.includes("#"),vp("#","pathname","hash",a)),Ct(!a.search||!a.search.includes("#"),vp("#","search","hash",a)));let l=t===""||a.pathname==="",u=l?"/":a.pathname,f;if(u==null)f=n;else{let v=e.length-1;if(!i&&u.startsWith("..")){let x=u.split("/");for(;x[0]==="..";)x.shift(),v-=1;a.pathname=x.join("/")}f=v>=0?e[v]:"/"}let m=gC(a,f),g=u&&u!=="/"&&u.endsWith("/"),_=(l||u===".")&&n.endsWith("/");return!m.pathname.endsWith("/")&&(g||_)&&(m.pathname+="/"),m}var zi=t=>t.join("/").replace(/\/\/+/g,"/"),_C=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),vC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,bC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,xC=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function EC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function SC(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var GE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function QE(t,e){let n=t;if(typeof n!="string"||!HE.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if(GE)try{let l=new URL(window.location.href),u=n.startsWith("//")?new URL(l.protocol+n):new URL(n),f=qi(u.pathname,e);u.origin===l.origin&&f!=null?n=f+u.search+u.hash:a=!0}catch{nr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var $E=["POST","PUT","PATCH","DELETE"];new Set($E);var wC=["GET",...$E];new Set(wC);var ol=T.createContext(null);ol.displayName="DataRouter";var Vh=T.createContext(null);Vh.displayName="DataRouterState";var TC=T.createContext(!1),KE=T.createContext({isTransitioning:!1});KE.displayName="ViewTransition";var AC=T.createContext(new Map);AC.displayName="Fetchers";var CC=T.createContext(null);CC.displayName="Await";var rr=T.createContext(null);rr.displayName="Navigation";var Zc=T.createContext(null);Zc.displayName="Location";var br=T.createContext({outlet:null,matches:[],isDataRoute:!1});br.displayName="Route";var Rg=T.createContext(null);Rg.displayName="RouteError";var WE="REACT_ROUTER_ERROR",RC="REDIRECT",DC="ROUTE_ERROR_RESPONSE";function IC(t){if(t.startsWith(`${WE}:${RC}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function jC(t){if(t.startsWith(`${WE}:${DC}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new xC(e.status,e.statusText,e.data)}catch{}}function OC(t,{relative:e}={}){Ct(ll(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=T.useContext(rr),{hash:a,pathname:l,search:u}=tu(t,{relative:e}),f=l;return n!=="/"&&(f=l==="/"?n:zi([n,l])),i.createHref({pathname:f,search:u,hash:a})}function ll(){return T.useContext(Zc)!=null}function kn(){return Ct(ll(),"useLocation() may be used only in the context of a <Router> component."),T.useContext(Zc).location}var YE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function XE(t){T.useContext(rr).static||T.useLayoutEffect(t)}function eu(){let{isDataRoute:t}=T.useContext(br);return t?KC():kC()}function kC(){Ct(ll(),"useNavigate() may be used only in the context of a <Router> component.");let t=T.useContext(ol),{basename:e,navigator:n}=T.useContext(rr),{matches:i}=T.useContext(br),{pathname:a}=kn(),l=JSON.stringify(Ag(i)),u=T.useRef(!1);return XE(()=>{u.current=!0}),T.useCallback((m,g={})=>{if(nr(u.current,YE),!u.current)return;if(typeof m=="number"){n.go(m);return}let _=Cg(m,JSON.parse(l),a,g.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:zi([e,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[e,n,l,a,t])}var MC=T.createContext(null);function NC(t){let e=T.useContext(br).outlet;return T.useMemo(()=>e&&T.createElement(MC.Provider,{value:t},e),[e,t])}function PC(){let{matches:t}=T.useContext(br),e=t[t.length-1];return e?e.params:{}}function tu(t,{relative:e}={}){let{matches:n}=T.useContext(br),{pathname:i}=kn(),a=JSON.stringify(Ag(n));return T.useMemo(()=>Cg(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function LC(t,e){return JE(t,e)}function JE(t,e,n,i,a){Ct(ll(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=T.useContext(rr),{matches:u}=T.useContext(br),f=u[u.length-1],m=f?f.params:{},g=f?f.pathname:"/",_=f?f.pathnameBase:"/",v=f&&f.route;{let $=v&&v.path||"";eS(g,!v||$.endsWith("*")||$.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${$}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${$}"> to <Route path="${$==="/"?"*":`${$}/*`}">.`)}let x=kn(),w;if(e){let $=typeof e=="string"?al(e):e;Ct(_==="/"||$.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${$.pathname}" was given in the \`location\` prop.`),w=$}else w=x;let A=w.pathname||"/",I=A;if(_!=="/"){let $=_.replace(/^\//,"").split("/");I="/"+A.replace(/^\//,"").split("/").slice($.length).join("/")}let N=BE(t,{pathname:I});nr(v||N!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),nr(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let H=FC(N&&N.map($=>Object.assign({},$,{params:Object.assign({},m,$.params),pathname:zi([_,l.encodeLocation?l.encodeLocation($.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:$.pathname]),pathnameBase:$.pathnameBase==="/"?_:zi([_,l.encodeLocation?l.encodeLocation($.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:$.pathnameBase])})),u,n,i,a);return e&&H?T.createElement(Zc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},H):H}function VC(){let t=$C(),e=EC(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=T.createElement(T.Fragment,null,T.createElement("p",null," Hey developer "),T.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",T.createElement("code",{style:l},"ErrorBoundary")," or"," ",T.createElement("code",{style:l},"errorElement")," prop on your route.")),T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),n?T.createElement("pre",{style:a},n):null,u)}var zC=T.createElement(VC,null),ZE=class extends T.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=jC(t.digest);n&&(t=n)}let e=t!==void 0?T.createElement(br.Provider,{value:this.props.routeContext},T.createElement(Rg.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?T.createElement(UC,{error:t},e):e}};ZE.contextType=TC;var bp=new WeakMap;function UC({children:t,error:e}){let{basename:n}=T.useContext(rr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=IC(e.digest);if(i){let a=bp.get(e);if(a)throw a;let l=QE(i.location,n);if(GE&&!bp.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw bp.set(e,u),u}return T.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function BC({routeContext:t,match:e,children:n}){let i=T.useContext(ol);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),T.createElement(br.Provider,{value:t},n)}function FC(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,u=n?.errors;if(u!=null){let _=l.findIndex(v=>v.route.id&&u?.[v.route.id]!==void 0);Ct(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let f=!1,m=-1;if(n)for(let _=0;_<l.length;_++){let v=l[_];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(m=_),v.route.id){let{loaderData:x,errors:w}=n,A=v.route.loader&&!x.hasOwnProperty(v.route.id)&&(!w||w[v.route.id]===void 0);if(v.route.lazy||A){f=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}let g=n&&i?(_,v)=>{i(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:SC(n.matches),errorInfo:v})}:void 0;return l.reduceRight((_,v,x)=>{let w,A=!1,I=null,N=null;n&&(w=u&&v.route.id?u[v.route.id]:void 0,I=v.route.errorElement||zC,f&&(m<0&&x===0?(eS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,N=null):m===x&&(A=!0,N=v.route.hydrateFallbackElement||null)));let H=e.concat(l.slice(0,x+1)),$=()=>{let q;return w?q=I:A?q=N:v.route.Component?q=T.createElement(v.route.Component,null):v.route.element?q=v.route.element:q=_,T.createElement(BC,{match:v,routeContext:{outlet:_,matches:H,isDataRoute:n!=null},children:q})};return n&&(v.route.ErrorBoundary||v.route.errorElement||x===0)?T.createElement(ZE,{location:n.location,revalidation:n.revalidation,component:I,error:w,children:$(),routeContext:{outlet:null,matches:H,isDataRoute:!0},onError:g}):$()},null)}function Dg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function qC(t){let e=T.useContext(ol);return Ct(e,Dg(t)),e}function HC(t){let e=T.useContext(Vh);return Ct(e,Dg(t)),e}function GC(t){let e=T.useContext(br);return Ct(e,Dg(t)),e}function Ig(t){let e=GC(t),n=e.matches[e.matches.length-1];return Ct(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function QC(){return Ig("useRouteId")}function $C(){let t=T.useContext(Rg),e=HC("useRouteError"),n=Ig("useRouteError");return t!==void 0?t:e.errors?.[n]}function KC(){let{router:t}=qC("useNavigate"),e=Ig("useNavigate"),n=T.useRef(!1);return XE(()=>{n.current=!0}),T.useCallback(async(a,l={})=>{nr(n.current,YE),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var wb={};function eS(t,e,n){!e&&!wb[t]&&(wb[t]=!0,nr(!1,n))}T.memo(WC);function WC({routes:t,future:e,state:n,onError:i}){return JE(t,void 0,n,i,e)}function zh({to:t,replace:e,state:n,relative:i}){Ct(ll(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=T.useContext(rr);nr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=T.useContext(br),{pathname:u}=kn(),f=eu(),m=Cg(t,Ag(l),u,i==="path"),g=JSON.stringify(m);return T.useEffect(()=>{f(JSON.parse(g),{replace:e,state:n,relative:i})},[f,g,i,e,n]),null}function Uh(t){return NC(t.context)}function Yt(t){Ct(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function YC({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:u}){Ct(!ll(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=t.replace(/^\/*/,"/"),m=T.useMemo(()=>({basename:f,navigator:a,static:l,unstable_useTransitions:u,future:{}}),[f,a,l,u]);typeof n=="string"&&(n=al(n));let{pathname:g="/",search:_="",hash:v="",state:x=null,key:w="default"}=n,A=T.useMemo(()=>{let I=qi(g,f);return I==null?null:{location:{pathname:I,search:_,hash:v,state:x,key:w},navigationType:i}},[f,g,_,v,x,w,i]);return nr(A!=null,`<Router basename="${f}"> is not able to match the URL "${g}${_}${v}" because it does not start with the basename, so the <Router> won't render anything.`),A==null?null:T.createElement(rr.Provider,{value:m},T.createElement(Zc.Provider,{children:e,value:A}))}function XC({children:t,location:e}){return LC(Up(t),e)}function Up(t,e=[]){let n=[];return T.Children.forEach(t,(i,a)=>{if(!T.isValidElement(i))return;let l=[...e,a];if(i.type===T.Fragment){n.push.apply(n,Up(i.props.children,l));return}Ct(i.type===Yt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ct(!i.props.index||!i.props.children,"An index route cannot have child routes.");let u={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(u.children=Up(i.props.children,l)),n.push(u)}),n}var Zd="get",eh="application/x-www-form-urlencoded";function Bh(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function JC(t){return Bh(t)&&t.tagName.toLowerCase()==="button"}function ZC(t){return Bh(t)&&t.tagName.toLowerCase()==="form"}function eR(t){return Bh(t)&&t.tagName.toLowerCase()==="input"}function tR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function nR(t,e){return t.button===0&&(!e||e==="_self")&&!tR(t)}function Bp(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(a=>[n,a]):[[n,i]])},[]))}function rR(t,e){let n=Bp(t);return e&&e.forEach((i,a)=>{n.has(a)||e.getAll(a).forEach(l=>{n.append(a,l)})}),n}var Gd=null;function iR(){if(Gd===null)try{new FormData(document.createElement("form"),0),Gd=!1}catch{Gd=!0}return Gd}var sR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xp(t){return t!=null&&!sR.has(t)?(nr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${eh}"`),null):t}function aR(t,e){let n,i,a,l,u;if(ZC(t)){let f=t.getAttribute("action");i=f?qi(f,e):null,n=t.getAttribute("method")||Zd,a=xp(t.getAttribute("enctype"))||eh,l=new FormData(t)}else if(JC(t)||eR(t)&&(t.type==="submit"||t.type==="image")){let f=t.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=t.getAttribute("formaction")||f.getAttribute("action");if(i=m?qi(m,e):null,n=t.getAttribute("formmethod")||f.getAttribute("method")||Zd,a=xp(t.getAttribute("formenctype"))||xp(f.getAttribute("enctype"))||eh,l=new FormData(f,t),!iR()){let{name:g,type:_,value:v}=t;if(_==="image"){let x=g?`${g}.`:"";l.append(`${x}x`,"0"),l.append(`${x}y`,"0")}else g&&l.append(g,v)}}else{if(Bh(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Zd,i=null,a=eh,u=t}return l&&a==="text/plain"&&(u=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function jg(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function oR(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&qi(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function lR(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function cR(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function uR(t,e,n){let i=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let u=await lR(l,n);return u.links?u.links():[]}return[]}));return mR(i.flat(1).filter(cR).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Tb(t,e,n,i,a,l){let u=(m,g)=>n[g]?m.route.id!==n[g].route.id:!0,f=(m,g)=>n[g].pathname!==m.pathname||n[g].route.path?.endsWith("*")&&n[g].params["*"]!==m.params["*"];return l==="assets"?e.filter((m,g)=>u(m,g)||f(m,g)):l==="data"?e.filter((m,g)=>{let _=i.routes[m.route.id];if(!_||!_.hasLoader)return!1;if(u(m,g)||f(m,g))return!0;if(m.route.shouldRevalidate){let v=m.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function dR(t,e,{includeHydrateFallback:n}={}){return hR(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function hR(t){return[...new Set(t)]}function fR(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function mR(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let l=JSON.stringify(fR(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function tS(){let t=T.useContext(ol);return jg(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function pR(){let t=T.useContext(Vh);return jg(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Og=T.createContext(void 0);Og.displayName="FrameworkContext";function nS(){let t=T.useContext(Og);return jg(t,"You must render this element inside a <HydratedRouter> element"),t}function gR(t,e){let n=T.useContext(Og),[i,a]=T.useState(!1),[l,u]=T.useState(!1),{onFocus:f,onBlur:m,onMouseEnter:g,onMouseLeave:_,onTouchStart:v}=e,x=T.useRef(null);T.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let I=H=>{H.forEach($=>{u($.isIntersecting)})},N=new IntersectionObserver(I,{threshold:.5});return x.current&&N.observe(x.current),()=>{N.disconnect()}}},[t]),T.useEffect(()=>{if(i){let I=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(I)}}},[i]);let w=()=>{a(!0)},A=()=>{a(!1),u(!1)};return n?t!=="intent"?[l,x,{}]:[l,x,{onFocus:Cc(f,w),onBlur:Cc(m,A),onMouseEnter:Cc(g,w),onMouseLeave:Cc(_,A),onTouchStart:Cc(v,w)}]:[!1,x,{}]}function Cc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function yR({page:t,...e}){let{router:n}=tS(),i=T.useMemo(()=>BE(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?T.createElement(vR,{page:t,matches:i,...e}):null}function _R(t){let{manifest:e,routeModules:n}=nS(),[i,a]=T.useState([]);return T.useEffect(()=>{let l=!1;return uR(t,e,n).then(u=>{l||a(u)}),()=>{l=!0}},[t,e,n]),i}function vR({page:t,matches:e,...n}){let i=kn(),{manifest:a,routeModules:l}=nS(),{basename:u}=tS(),{loaderData:f,matches:m}=pR(),g=T.useMemo(()=>Tb(t,e,m,a,i,"data"),[t,e,m,a,i]),_=T.useMemo(()=>Tb(t,e,m,a,i,"assets"),[t,e,m,a,i]),v=T.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let A=new Set,I=!1;if(e.forEach(H=>{let $=a.routes[H.route.id];!$||!$.hasLoader||(!g.some(q=>q.route.id===H.route.id)&&H.route.id in f&&l[H.route.id]?.shouldRevalidate||$.hasClientLoader?I=!0:A.add(H.route.id))}),A.size===0)return[];let N=oR(t,u,"data");return I&&A.size>0&&N.searchParams.set("_routes",e.filter(H=>A.has(H.route.id)).map(H=>H.route.id).join(",")),[N.pathname+N.search]},[u,f,i,a,g,e,t,l]),x=T.useMemo(()=>dR(_,a),[_,a]),w=_R(_);return T.createElement(T.Fragment,null,v.map(A=>T.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...n})),x.map(A=>T.createElement("link",{key:A,rel:"modulepreload",href:A,...n})),w.map(({key:A,link:I})=>T.createElement("link",{key:A,nonce:n.nonce,...I})))}function bR(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var xR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{xR&&(window.__reactRouterVersion="7.11.0")}catch{}function ER({basename:t,children:e,unstable_useTransitions:n,window:i}){let a=T.useRef();a.current==null&&(a.current=JA({window:i,v5Compat:!0}));let l=a.current,[u,f]=T.useState({action:l.action,location:l.location}),m=T.useCallback(g=>{n===!1?f(g):T.startTransition(()=>f(g))},[n]);return T.useLayoutEffect(()=>l.listen(m),[l,m]),T.createElement(YC,{basename:t,children:e,location:u.location,navigationType:u.action,navigator:l,unstable_useTransitions:n})}var rS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Dt=T.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:u,state:f,target:m,to:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:x,...w},A){let{basename:I,unstable_useTransitions:N}=T.useContext(rr),H=typeof g=="string"&&rS.test(g),$=QE(g,I);g=$.to;let q=OC(g,{relative:a}),[me,ie,he]=gR(i,w),L=AR(g,{replace:u,state:f,target:m,preventScrollReset:_,relative:a,viewTransition:v,unstable_defaultShouldRevalidate:x,unstable_useTransitions:N});function R(M){e&&e(M),M.defaultPrevented||L(M)}let D=T.createElement("a",{...w,...he,href:$.absoluteURL||q,onClick:$.isExternal||l?e:R,ref:bR(A,ie),target:m,"data-discover":!H&&n==="render"?"true":void 0});return me&&!H?T.createElement(T.Fragment,null,D,T.createElement(yR,{page:q})):D});Dt.displayName="Link";var SR=T.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:u,viewTransition:f,children:m,...g},_){let v=tu(u,{relative:g.relative}),x=kn(),w=T.useContext(Vh),{navigator:A,basename:I}=T.useContext(rr),N=w!=null&&OR(v)&&f===!0,H=A.encodeLocation?A.encodeLocation(v).pathname:v.pathname,$=x.pathname,q=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||($=$.toLowerCase(),q=q?q.toLowerCase():null,H=H.toLowerCase()),q&&I&&(q=qi(q,I)||q);const me=H!=="/"&&H.endsWith("/")?H.length-1:H.length;let ie=$===H||!a&&$.startsWith(H)&&$.charAt(me)==="/",he=q!=null&&(q===H||!a&&q.startsWith(H)&&q.charAt(H.length)==="/"),L={isActive:ie,isPending:he,isTransitioning:N},R=ie?e:void 0,D;typeof i=="function"?D=i(L):D=[i,ie?"active":null,he?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let M=typeof l=="function"?l(L):l;return T.createElement(Dt,{...g,"aria-current":R,className:D,ref:_,style:M,to:u,viewTransition:f},typeof m=="function"?m(L):m)});SR.displayName="NavLink";var wR=T.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:l,method:u=Zd,action:f,onSubmit:m,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:x,...w},A)=>{let{unstable_useTransitions:I}=T.useContext(rr),N=IR(),H=jR(f,{relative:g}),$=u.toLowerCase()==="get"?"get":"post",q=typeof f=="string"&&rS.test(f),me=ie=>{if(m&&m(ie),ie.defaultPrevented)return;ie.preventDefault();let he=ie.nativeEvent.submitter,L=he?.getAttribute("formmethod")||u,R=()=>N(he||ie.currentTarget,{fetcherKey:e,method:L,navigate:n,replace:a,state:l,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:x});I&&n!==!1?T.startTransition(()=>R()):R()};return T.createElement("form",{ref:A,method:$,action:H,onSubmit:i?m:me,...w,"data-discover":!q&&t==="render"?"true":void 0})});wR.displayName="Form";function TR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iS(t){let e=T.useContext(ol);return Ct(e,TR(t)),e}function AR(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:u,unstable_defaultShouldRevalidate:f,unstable_useTransitions:m}={}){let g=eu(),_=kn(),v=tu(t,{relative:l});return T.useCallback(x=>{if(nR(x,e)){x.preventDefault();let w=n!==void 0?n:Bc(_)===Bc(v),A=()=>g(t,{replace:w,state:i,preventScrollReset:a,relative:l,viewTransition:u,unstable_defaultShouldRevalidate:f});m?T.startTransition(()=>A()):A()}},[_,g,v,n,i,e,t,a,l,u,f,m])}function CR(t){nr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=T.useRef(Bp(t)),n=T.useRef(!1),i=kn(),a=T.useMemo(()=>rR(i.search,n.current?null:e.current),[i.search]),l=eu(),u=T.useCallback((f,m)=>{const g=Bp(typeof f=="function"?f(new URLSearchParams(a)):f);n.current=!0,l("?"+g,m)},[l,a]);return[a,u]}var RR=0,DR=()=>`__${String(++RR)}__`;function IR(){let{router:t}=iS("useSubmit"),{basename:e}=T.useContext(rr),n=QC(),i=t.fetch,a=t.navigate;return T.useCallback(async(l,u={})=>{let{action:f,method:m,encType:g,formData:_,body:v}=aR(l,e);if(u.navigate===!1){let x=u.fetcherKey||DR();await i(x,n,u.action||f,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:_,body:v,formMethod:u.method||m,formEncType:u.encType||g,flushSync:u.flushSync})}else await a(u.action||f,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:_,body:v,formMethod:u.method||m,formEncType:u.encType||g,replace:u.replace,state:u.state,fromRouteId:n,flushSync:u.flushSync,viewTransition:u.viewTransition})},[i,a,e,n])}function jR(t,{relative:e}={}){let{basename:n}=T.useContext(rr),i=T.useContext(br);Ct(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...tu(t||".",{relative:e})},u=kn();if(t==null){l.search=u.search;let f=new URLSearchParams(l.search),m=f.getAll("index");if(m.some(_=>_==="")){f.delete("index"),m.filter(v=>v).forEach(v=>f.append("index",v));let _=f.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:zi([n,l.pathname])),Bc(l)}function OR(t,{relative:e}={}){let n=T.useContext(KE);Ct(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=iS("useViewTransitionState"),a=tu(t,{relative:e});if(!n.isTransitioning)return!1;let l=qi(n.currentLocation.pathname,i)||n.currentLocation.pathname,u=qi(n.nextLocation.pathname,i)||n.nextLocation.pathname;return fh(a.pathname,u)!=null||fh(a.pathname,l)!=null}const kR=function(){},MR={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:kR},nu=T.createContext(MR);var cl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},NR={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},PR=class{#e=NR;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Ni=new PR;function LR(t){setTimeout(t,0)}var ka=typeof window>"u"||"Deno"in globalThis;function nn(){}function VR(t,e){return typeof t=="function"?t(e):t}function Fp(t){return typeof t=="number"&&t>=0&&t!==1/0}function sS(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Ls(t,e){return typeof t=="function"?t(e):t}function _r(t,e){return typeof t=="function"?t(e):t}function Ab(t,e){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:u,stale:f}=t;if(u){if(i){if(e.queryHash!==kg(u,e.options))return!1}else if(!Fc(e.queryKey,u))return!1}if(n!=="all"){const m=e.isActive();if(n==="active"&&!m||n==="inactive"&&m)return!1}return!(typeof f=="boolean"&&e.isStale()!==f||a&&a!==e.state.fetchStatus||l&&!l(e))}function Cb(t,e){const{exact:n,status:i,predicate:a,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(Ma(e.options.mutationKey)!==Ma(l))return!1}else if(!Fc(e.options.mutationKey,l))return!1}return!(i&&e.state.status!==i||a&&!a(e))}function kg(t,e){return(e?.queryKeyHashFn||Ma)(t)}function Ma(t){return JSON.stringify(t,(e,n)=>qp(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function Fc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Fc(t[n],e[n])):!1}var zR=Object.prototype.hasOwnProperty;function aS(t,e){if(t===e)return t;const n=Rb(t)&&Rb(e);if(!n&&!(qp(t)&&qp(e)))return e;const a=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),u=l.length,f=n?new Array(u):{};let m=0;for(let g=0;g<u;g++){const _=n?g:l[g],v=t[_],x=e[_];if(v===x){f[_]=v,(n?g<a:zR.call(t,_))&&m++;continue}if(v===null||x===null||typeof v!="object"||typeof x!="object"){f[_]=x;continue}const w=aS(v,x);f[_]=w,w===v&&m++}return a===u&&m===a?t:f}function mh(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Rb(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function qp(t){if(!Db(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Db(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Db(t){return Object.prototype.toString.call(t)==="[object Object]"}function UR(t){return new Promise(e=>{Ni.setTimeout(e,t)})}function Hp(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?aS(t,e):e}function BR(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function FR(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var Mg=Symbol();function oS(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Mg?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function lS(t,e){return typeof t=="function"?t(...e):!!t}var qR=class extends cl{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!ka&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Ng=new qR;function Gp(){let t,e;const n=new Promise((a,l)=>{t=a,e=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),e(a)},n}function HR(t){let e;if(t.then(n=>(e=n,n),nn)?.catch(nn),e!==void 0)return{data:e}}function cS(t){return t}function GR(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function QR(t,e,n){const i=()=>{const a=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return a?.catch(nn),a};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:i()},...t.meta&&{meta:t.meta}}}function $R(t){return t.state.isPaused}function KR(t){return t.state.status==="success"}function WR(t){return!0}function YR(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??$R,i=t.getMutationCache().getAll().flatMap(m=>n(m)?[GR(m)]:[]),a=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??KR,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??WR,u=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??cS,f=t.getQueryCache().getAll().flatMap(m=>a(m)?[QR(m,u,l)]:[]);return{mutations:i,queries:f}}function XR(t,e,n){if(typeof e!="object"||e===null)return;const i=t.getMutationCache(),a=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??cS,u=e.mutations||[],f=e.queries||[];u.forEach(({state:m,...g})=>{i.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...g},m)}),f.forEach(({queryKey:m,state:g,queryHash:_,meta:v,promise:x,dehydratedAt:w})=>{const A=x?HR(x):void 0,I=g.data===void 0?A?.data:g.data,N=I===void 0?I:l(I);let H=a.get(_);const $=H?.state.status==="pending",q=H?.state.fetchStatus==="fetching";if(H){const me=A&&w!==void 0&&w>H.state.dataUpdatedAt;if(g.dataUpdatedAt>H.state.dataUpdatedAt||me){const{fetchStatus:ie,...he}=g;H.setState({...he,data:N})}}else H=a.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:m,queryHash:_,meta:v},{...g,data:N,fetchStatus:"idle",status:N!==void 0?"success":g.status});x&&!$&&!q&&(w===void 0||w>H.state.dataUpdatedAt)&&H.fetch(void 0,{initialPromise:Promise.resolve(x).then(l)}).catch(nn)})}var JR=LR;function ZR(){let t=[],e=0,n=f=>{f()},i=f=>{f()},a=JR;const l=f=>{e?t.push(f):a(()=>{n(f)})},u=()=>{const f=t;t=[],f.length&&a(()=>{i(()=>{f.forEach(m=>{n(m)})})})};return{batch:f=>{let m;e++;try{m=f()}finally{e--,e||u()}return m},batchCalls:f=>(...m)=>{l(()=>{f(...m)})},schedule:l,setNotifyFunction:f=>{n=f},setBatchNotifyFunction:f=>{i=f},setScheduler:f=>{a=f}}}var rn=ZR(),eD=class extends cl{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!ka&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},ph=new eD;function tD(t){return Math.min(1e3*2**t,3e4)}function uS(t){return(t??"online")==="online"?ph.isOnline():!0}var Qp=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function dS(t){let e=!1,n=0,i;const a=Gp(),l=()=>a.status!=="pending",u=I=>{if(!l()){const N=new Qp(I);x(N),t.onCancel?.(N)}},f=()=>{e=!0},m=()=>{e=!1},g=()=>Ng.isFocused()&&(t.networkMode==="always"||ph.isOnline())&&t.canRun(),_=()=>uS(t.networkMode)&&t.canRun(),v=I=>{l()||(i?.(),a.resolve(I))},x=I=>{l()||(i?.(),a.reject(I))},w=()=>new Promise(I=>{i=N=>{(l()||g())&&I(N)},t.onPause?.()}).then(()=>{i=void 0,l()||t.onContinue?.()}),A=()=>{if(l())return;let I;const N=n===0?t.initialPromise:void 0;try{I=N??t.fn()}catch(H){I=Promise.reject(H)}Promise.resolve(I).then(v).catch(H=>{if(l())return;const $=t.retry??(ka?0:3),q=t.retryDelay??tD,me=typeof q=="function"?q(n,H):q,ie=$===!0||typeof $=="number"&&n<$||typeof $=="function"&&$(n,H);if(e||!ie){x(H);return}n++,t.onFail?.(n,H),UR(me).then(()=>g()?void 0:w()).then(()=>{e?x(H):A()})})};return{promise:a,status:()=>a.status,cancel:u,continue:()=>(i?.(),a),cancelRetry:f,continueRetry:m,canStart:_,start:()=>(_()?A():w().then(A),a)}}var hS=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Fp(this.gcTime)&&(this.#e=Ni.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(ka?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Ni.clearTimeout(this.#e),this.#e=void 0)}},nD=class extends hS{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=jb(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=jb(this.options);n.data!==void 0&&(this.setState(Ib(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const i=Hp(this.state.data,e,this.options);return this.#s({data:i,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),i}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then(nn).catch(nn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>_r(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Mg||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Ls(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!sS(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const m=this.observers.find(g=>g.options.queryFn);m&&this.setOptions(m.options)}const i=new AbortController,a=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(this.#o=!0,i.signal)})},l=()=>{const m=oS(this.options,n),_=(()=>{const v={client:this.#i,queryKey:this.queryKey,meta:this.meta};return a(v),v})();return this.#o=!1,this.options.persister?this.options.persister(m,_,this):m(_)},f=(()=>{const m={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return a(m),m})();this.options.behavior?.onFetch(f,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==f.fetchOptions?.meta)&&this.#s({type:"fetch",meta:f.fetchOptions?.meta}),this.#r=dS({initialPromise:n?.initialPromise,fn:f.fetchFn,onCancel:m=>{m instanceof Qp&&m.revert&&this.setState({...this.#t,fetchStatus:"idle"}),i.abort()},onFail:(m,g)=>{this.#s({type:"failed",failureCount:m,error:g})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:f.options.retry,retryDelay:f.options.retryDelay,networkMode:f.options.networkMode,canRun:()=>!0});try{const m=await this.#r.start();if(m===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(m),this.#n.config.onSuccess?.(m,this),this.#n.config.onSettled?.(m,this.state.error,this),m}catch(m){if(m instanceof Qp){if(m.silent)return this.#r.promise;if(m.revert){if(this.state.data===void 0)throw m;return this.state.data}}throw this.#s({type:"error",error:m}),this.#n.config.onError?.(m,this),this.#n.config.onSettled?.(this.state.data,m,this),m}finally{this.scheduleGc()}}#s(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...fS(i.data,this.options),fetchMeta:e.meta??null};case"success":const a={...i,...Ib(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const l=e.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),rn.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function fS(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:uS(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Ib(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function jb(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var rD=class extends cl{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=Gp(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Ob(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return $p(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return $p(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#x(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof _r(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#E(),this.#t.setOptions(this.options),e._defaulted&&!mh(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&kb(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),i&&(this.#t!==n||_r(this.options.enabled,this.#t)!==_r(e.enabled,this.#t)||Ls(this.options.staleTime,this.#t)!==Ls(e.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||_r(this.options.enabled,this.#t)!==_r(e.enabled,this.#t)||a!==this.#l)&&this.#_(a)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return sD(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),e?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#E();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(nn)),e}#g(){this.#b();const t=Ls(this.options.staleTime,this.#t);if(ka||this.#i.isStale||!Fp(t))return;const n=sS(this.#i.dataUpdatedAt,t)+1;this.#c=Ni.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#x(),this.#l=t,!(ka||_r(this.options.enabled,this.#t)===!1||!Fp(this.#l)||this.#l===0)&&(this.#u=Ni.setInterval(()=>{(this.options.refetchIntervalInBackground||Ng.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#b(){this.#c&&(Ni.clearTimeout(this.#c),this.#c=void 0)}#x(){this.#u&&(Ni.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,i=this.options,a=this.#i,l=this.#r,u=this.#a,m=t!==n?t.state:this.#n,{state:g}=t;let _={...g},v=!1,x;if(e._optimisticResults){const R=this.hasListeners(),D=!R&&Ob(t,e),M=R&&kb(t,n,e,i);(D||M)&&(_={..._,...fS(g.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:w,errorUpdatedAt:A,status:I}=_;x=_.data;let N=!1;if(e.placeholderData!==void 0&&x===void 0&&I==="pending"){let R;a?.isPlaceholderData&&e.placeholderData===u?.placeholderData?(R=a.data,N=!0):R=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,R!==void 0&&(I="success",x=Hp(a?.data,R,e),v=!0)}if(e.select&&x!==void 0&&!N)if(a&&x===l?.data&&e.select===this.#p)x=this.#h;else try{this.#p=e.select,x=e.select(x),x=Hp(a?.data,x,e),this.#h=x,this.#s=null}catch(R){this.#s=R}this.#s&&(w=this.#s,x=this.#h,A=Date.now(),I="error");const H=_.fetchStatus==="fetching",$=I==="pending",q=I==="error",me=$&&H,ie=x!==void 0,L={status:I,fetchStatus:_.fetchStatus,isPending:$,isSuccess:I==="success",isError:q,isInitialLoading:me,isLoading:me,data:x,dataUpdatedAt:_.dataUpdatedAt,error:w,errorUpdatedAt:A,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>m.dataUpdateCount||_.errorUpdateCount>m.errorUpdateCount,isFetching:H,isRefetching:H&&!$,isLoadingError:q&&!ie,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:q&&ie,isStale:Pg(t,e),refetch:this.refetch,promise:this.#o,isEnabled:_r(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const R=j=>{L.status==="error"?j.reject(L.error):L.data!==void 0&&j.resolve(L.data)},D=()=>{const j=this.#o=L.promise=Gp();R(j)},M=this.#o;switch(M.status){case"pending":t.queryHash===n.queryHash&&R(M);break;case"fulfilled":(L.status==="error"||L.data!==M.value)&&D();break;case"rejected":(L.status!=="error"||L.error!==M.reason)&&D();break}}return L}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),mh(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(u=>{const f=u;return this.#i[f]!==t[f]&&l.has(f)})};this.#S({listeners:n()})}#E(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#S(t){rn.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function iD(t,e){return _r(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Ob(t,e){return iD(t,e)||t.state.data!==void 0&&$p(t,e,e.refetchOnMount)}function $p(t,e,n){if(_r(e.enabled,t)!==!1&&Ls(e.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&Pg(t,e)}return!1}function kb(t,e,n,i){return(t!==e||_r(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Pg(t,n)}function Pg(t,e){return _r(e.enabled,t)!==!1&&t.isStaleByTime(Ls(e.staleTime,t))}function sD(t,e){return!mh(t.getCurrentResult(),e)}function Mb(t){return{onFetch:(e,n)=>{const i=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],u=e.state.data?.pageParams||[];let f={pages:[],pageParams:[]},m=0;const g=async()=>{let _=!1;const v=A=>{Object.defineProperty(A,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},x=oS(e.options,e.fetchOptions),w=async(A,I,N)=>{if(_)return Promise.reject();if(I==null&&A.pages.length)return Promise.resolve(A);const $=(()=>{const he={client:e.client,queryKey:e.queryKey,pageParam:I,direction:N?"backward":"forward",meta:e.options.meta};return v(he),he})(),q=await x($),{maxPages:me}=e.options,ie=N?FR:BR;return{pages:ie(A.pages,q,me),pageParams:ie(A.pageParams,I,me)}};if(a&&l.length){const A=a==="backward",I=A?aD:Nb,N={pages:l,pageParams:u},H=I(i,N);f=await w(N,H,A)}else{const A=t??l.length;do{const I=m===0?u[0]??i.initialPageParam:Nb(i,f);if(m>0&&I==null)break;f=await w(f,I),m++}while(m<A)}return f};e.options.persister?e.fetchFn=()=>e.options.persister?.(g,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=g}}}function Nb(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function aD(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var oD=class extends hS{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||mS(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=dS({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(u,f)=>{this.#r({type:"failed",failureCount:u,error:f})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",l=!this.#i.canStart();try{if(a)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,i);const f=await this.options.onMutate?.(e,i);f!==this.state.context&&this.#r({type:"pending",context:f,variables:e,isPaused:l})}const u=await this.#i.start();return await this.#n.config.onSuccess?.(u,e,this.state.context,this,i),await this.options.onSuccess?.(u,e,this.state.context,i),await this.#n.config.onSettled?.(u,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(u,null,e,this.state.context,i),this.#r({type:"success",data:u}),u}catch(u){try{throw await this.#n.config.onError?.(u,e,this.state.context,this,i),await this.options.onError?.(u,e,this.state.context,i),await this.#n.config.onSettled?.(void 0,u,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,u,e,this.state.context,i),u}finally{this.#r({type:"error",error:u})}}finally{this.#n.runNext(this)}}#r(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),rn.batch(()=>{this.#t.forEach(i=>{i.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function mS(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var lD=class extends cl{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const i=new oD({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){this.#e.add(t);const e=Qd(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Qd(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Qd(t);if(typeof e=="string"){const i=this.#t.get(e)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const e=Qd(t);return typeof e=="string"?this.#t.get(e)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){rn.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Cb(e,n))}findAll(t={}){return this.getAll().filter(e=>Cb(t,e))}notify(t){rn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return rn.batch(()=>Promise.all(t.map(e=>e.continue().catch(nn))))}};function Qd(t){return t.options.scope?.id}var cD=class extends cl{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),mh(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&Ma(n.mutationKey)!==Ma(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??mS();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){rn.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,i,a),this.#i.onSettled?.(e.data,null,n,i,a)):e?.type==="error"&&(this.#i.onError?.(e.error,n,i,a),this.#i.onSettled?.(void 0,e.error,n,i,a))}this.listeners.forEach(n=>{n(this.#t)})})}},uD=class extends cl{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const i=e.queryKey,a=e.queryHash??kg(i,e);let l=this.get(a);return l||(l=new nD({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){rn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Ab(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>Ab(t,n)):e}notify(t){rn.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){rn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){rn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},dD=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new uD,this.#t=t.mutationCache||new lD,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=Ng.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=ph.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Ls(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(i.queryHash)?.state.data,u=VR(e,l);if(u!==void 0)return this.#e.build(this,i).setData(u,{...n,manual:!0})}setQueriesData(t,e,n){return rn.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;rn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return rn.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=rn.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then(nn).catch(nn)}invalidateQueries(t,e={}){return rn.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=rn.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(nn)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(nn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Ls(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(nn).catch(nn)}fetchInfiniteQuery(t){return t.behavior=Mb(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(nn).catch(nn)}ensureInfiniteQueryData(t){return t.behavior=Mb(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return ph.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Ma(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(i=>{Fc(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Ma(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(i=>{Fc(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=kg(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Mg&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},pS=T.createContext(void 0),on=t=>{const e=T.useContext(pS);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},hD=({client:t,children:e})=>(T.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),d.jsx(pS.Provider,{value:t,children:e})),gS=T.createContext(!1),fD=()=>T.useContext(gS),mD=gS.Provider;function pD(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var gD=T.createContext(pD()),yD=()=>T.useContext(gD),_D=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},vD=t=>{T.useEffect(()=>{t.clearReset()},[t])},bD=({result:t,errorResetBoundary:e,throwOnError:n,query:i,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||lS(n,[t.error,i])),xD=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},ED=(t,e)=>t.isLoading&&t.isFetching&&!e,SD=(t,e)=>t?.suspense&&e.isPending,Pb=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function wD(t,e,n){const i=fD(),a=yD(),l=on(),u=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(u),u._optimisticResults=i?"isRestoring":"optimistic",xD(u),_D(u,a),vD(a);const f=!l.getQueryCache().get(u.queryHash),[m]=T.useState(()=>new e(l,u)),g=m.getOptimisticResult(u),_=!i&&t.subscribed!==!1;if(T.useSyncExternalStore(T.useCallback(v=>{const x=_?m.subscribe(rn.batchCalls(v)):nn;return m.updateResult(),x},[m,_]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),T.useEffect(()=>{m.setOptions(u)},[u,m]),SD(u,g))throw Pb(u,m,a);if(bD({result:g,errorResetBoundary:a,throwOnError:u.throwOnError,query:l.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw g.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(u,g),u.experimental_prefetchInRender&&!ka&&ED(g,i)&&(f?Pb(u,m,a):l.getQueryCache().get(u.queryHash)?.promise)?.catch(nn).finally(()=>{m.updateResult()}),u.notifyOnChangeProps?g:m.trackResult(g)}function ul(t,e){return wD(t,rD)}function ir(t,e){const n=on(),[i]=T.useState(()=>new cD(n,t));T.useEffect(()=>{i.setOptions(t)},[i,t]);const a=T.useSyncExternalStore(T.useCallback(u=>i.subscribe(rn.batchCalls(u)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=T.useCallback((u,f)=>{i.mutate(u,f).catch(nn)},[i]);if(a.error&&lS(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}function Kp(){}function TD(t,{interval:e=1e3,onError:n=Kp}={}){if(typeof t!="function")throw new Error("argument is not function.");let i=0,a=null,l=!1,u=!1;return async(...f)=>{if(a=f,!u){for(u=!0;l;)await new Promise(m=>Ni.setTimeout(m,e));for(;Date.now()<i;)await new Promise(m=>Ni.setTimeout(m,i-Date.now()));u=!1,l=!0;try{await t(...a)}catch(m){try{n(m)}catch{}}i=Date.now()+e,l=!1}}}var AD=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:i=JSON.stringify,deserialize:a=JSON.parse,retry:l})=>{if(t){const u=async f=>{try{const m=await i(f);await t.setItem(e,m);return}catch(m){return m}};return{persistClient:TD(async f=>{let m=f,g=await u(m),_=0;for(;g&&m;)_++,m=await l?.({persistedClient:m,error:g,errorCount:_}),m&&(g=await u(m))},{interval:n}),restoreClient:async()=>{const f=await t.getItem(e);if(f)return await a(f)},removeClient:()=>t.removeItem(e)}}return{persistClient:Kp,restoreClient:()=>Promise.resolve(void 0),removeClient:Kp}};const yS=300*1e3,CD=1440*60*1e3,Rt=new dD({defaultOptions:{queries:{staleTime:yS,gcTime:CD,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}});Rt.getQueryCache().subscribe(t=>{const e=t?.query;if(e&&t.type==="updated"){const{state:n}=e;n.status==="error"&&n.error&&console.error("[RQ] Query FAILED:",e.queryKey,n.error)}});const RD=AD({storage:typeof window<"u"?{getItem:t=>Promise.resolve(localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(localStorage.removeItem(t))}:void 0,key:"BUDGET_APP_QUERY_CACHE"}),xe={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};var DD=["added","removed","updated"];function Lb(t){return DD.includes(t)}async function ID({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:i="",hydrateOptions:a}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const u=Date.now()-l.timestamp>n,f=l.buster!==i;if(u||f)return e.removeClient();XR(t,l.clientState,a)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function Vb({queryClient:t,persister:e,buster:n="",dehydrateOptions:i}){const a={buster:n,timestamp:Date.now(),clientState:YR(t,i)};await e.persistClient(a)}function jD(t){const e=t.queryClient.getQueryCache().subscribe(i=>{Lb(i.type)&&Vb(t)}),n=t.queryClient.getMutationCache().subscribe(i=>{Lb(i.type)&&Vb(t)});return()=>{e(),n()}}var OD=({children:t,persistOptions:e,onSuccess:n,onError:i,...a})=>{const[l,u]=T.useState(!0),f=T.useRef({persistOptions:e,onSuccess:n,onError:i}),m=T.useRef(!1);return T.useEffect(()=>{f.current={persistOptions:e,onSuccess:n,onError:i}}),T.useEffect(()=>{const g={...f.current.persistOptions,queryClient:a.client};return m.current||(m.current=!0,ID(g).then(()=>f.current.onSuccess?.()).catch(()=>f.current.onError?.()).finally(()=>{u(!1)})),l?void 0:jD(g)},[a.client,l]),d.jsx(hD,{...a,children:d.jsx(mD,{value:l,children:t})})};function kD({children:t}){return d.jsx(OD,{client:Rt,persistOptions:{persister:RD,maxAge:1440*60*1e3,buster:"v1"},children:t})}const MD=()=>{};var zb={};const _S=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},ND=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],u=t[n++],f=t[n++],m=((a&7)<<18|(l&63)<<12|(u&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(m>>10)),e[i++]=String.fromCharCode(56320+(m&1023))}else{const l=t[n++],u=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},vS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],u=a+1<t.length,f=u?t[a+1]:0,m=a+2<t.length,g=m?t[a+2]:0,_=l>>2,v=(l&3)<<4|f>>4;let x=(f&15)<<2|g>>6,w=g&63;m||(w=64,u||(x=64)),i.push(n[_],n[v],n[x],n[w])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_S(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ND(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],f=a<t.length?n[t.charAt(a)]:0;++a;const g=a<t.length?n[t.charAt(a)]:64;++a;const v=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||f==null||g==null||v==null)throw new PD;const x=l<<2|f>>4;if(i.push(x),g!==64){const w=f<<4&240|g>>2;if(i.push(w),v!==64){const A=g<<6&192|v;i.push(A)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class PD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const LD=function(t){const e=_S(t);return vS.encodeByteArray(e,!0)},gh=function(t){return LD(t).replace(/\./g,"")},bS=function(t){try{return vS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function VD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const zD=()=>VD().__FIREBASE_DEFAULTS__,UD=()=>{if(typeof process>"u"||typeof zb>"u")return;const t=zb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},BD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&bS(t[1]);return e&&JSON.parse(e)},Fh=()=>{try{return MD()||zD()||UD()||BD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},xS=t=>Fh()?.emulatorHosts?.[t],FD=t=>{const e=xS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},ES=()=>Fh()?.config,SS=t=>Fh()?.[`_${t}`];class qD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function dl(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function wS(t){return(await fetch(t,{credentials:"include"})).ok}function HD(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[gh(JSON.stringify(n)),gh(JSON.stringify(u)),""].join(".")}const Nc={};function GD(){const t={prod:[],emulator:[]};for(const e of Object.keys(Nc))Nc[e]?t.emulator.push(e):t.prod.push(e);return t}function QD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Ub=!1;function TS(t,e){if(typeof window>"u"||typeof document>"u"||!dl(window.location.host)||Nc[t]===e||Nc[t]||Ub)return;Nc[t]=e;function n(x){return`__firebase__banner__${x}`}const i="__firebase__banner",l=GD().prod.length>0;function u(){const x=document.getElementById(i);x&&x.remove()}function f(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function m(x,w){x.setAttribute("width","24"),x.setAttribute("id",w),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function g(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{Ub=!0,u()},x}function _(x,w){x.setAttribute("id",w),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function v(){const x=QD(i),w=n("text"),A=document.getElementById(w)||document.createElement("span"),I=n("learnmore"),N=document.getElementById(I)||document.createElement("a"),H=n("preprendIcon"),$=document.getElementById(H)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const q=x.element;f(q),_(N,I);const me=g();m($,H),q.append($,A,N,me),document.body.appendChild(q)}l?(A.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function Rn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $D(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rn())}function KD(){const t=Fh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function WD(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function YD(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function XD(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function JD(){const t=Rn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function ZD(){return!KD()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function eI(){try{return typeof indexedDB=="object"}catch{return!1}}function tI(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const nI="FirebaseError";class Ki extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=nI,Object.setPrototypeOf(this,Ki.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ru.prototype.create)}}class ru{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?rI(l,i):"Error",f=`${this.serviceName}: ${u} (${a}).`;return new Ki(a,f,i)}}function rI(t,e){return t.replace(iI,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const iI=/\{\$([^}]+)}/g;function sI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Qs(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],u=e[a];if(Bb(l)&&Bb(u)){if(!Qs(l,u))return!1}else if(l!==u)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function Bb(t){return t!==null&&typeof t=="object"}function iu(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Dc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Ic(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function aI(t,e){const n=new oI(t,e);return n.subscribe.bind(n)}class oI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");lI(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=Ep),a.error===void 0&&(a.error=Ep),a.complete===void 0&&(a.complete=Ep);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function lI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Ep(){}function fn(t){return t&&t._delegate?t._delegate:t}class Na{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ia="[DEFAULT]";class cI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new qD;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(dI(e))try{this.getOrInitializeService({instanceIdentifier:Ia})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=Ia){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ia){return this.instances.has(e)}getOptions(e=Ia){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);i===f&&u.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:uI(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ia){return this.component?this.component.multipleInstances?e:Ia:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function uI(t){return t===Ia?void 0:t}function dI(t){return t.instantiationMode==="EAGER"}class hI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new cI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Je||(Je={}));const fI={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},mI=Je.INFO,pI={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},gI=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=pI[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Lg{constructor(e){this.name=e,this._logLevel=mI,this._logHandler=gI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}const yI=(t,e)=>e.some(n=>t instanceof n);let Fb,qb;function _I(){return Fb||(Fb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vI(){return qb||(qb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const AS=new WeakMap,Wp=new WeakMap,CS=new WeakMap,Sp=new WeakMap,Vg=new WeakMap;function bI(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",u)},l=()=>{n(Vs(t.result)),a()},u=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",u)});return e.then(n=>{n instanceof IDBCursor&&AS.set(n,t)}).catch(()=>{}),Vg.set(e,t),e}function xI(t){if(Wp.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",u),t.removeEventListener("abort",u)},l=()=>{n(),a()},u=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",u),t.addEventListener("abort",u)});Wp.set(t,e)}let Yp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Wp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||CS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Vs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function EI(t){Yp=t(Yp)}function SI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(wp(this),e,...n);return CS.set(i,e.sort?e.sort():[e]),Vs(i)}:vI().includes(t)?function(...e){return t.apply(wp(this),e),Vs(AS.get(this))}:function(...e){return Vs(t.apply(wp(this),e))}}function wI(t){return typeof t=="function"?SI(t):(t instanceof IDBTransaction&&xI(t),yI(t,_I())?new Proxy(t,Yp):t)}function Vs(t){if(t instanceof IDBRequest)return bI(t);if(Sp.has(t))return Sp.get(t);const e=wI(t);return e!==t&&(Sp.set(t,e),Vg.set(e,t)),e}const wp=t=>Vg.get(t);function TI(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const u=indexedDB.open(t,e),f=Vs(u);return i&&u.addEventListener("upgradeneeded",m=>{i(Vs(u.result),m.oldVersion,m.newVersion,Vs(u.transaction),m)}),n&&u.addEventListener("blocked",m=>n(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",g=>a(g.oldVersion,g.newVersion,g))}).catch(()=>{}),f}const AI=["get","getKey","getAll","getAllKeys","count"],CI=["put","add","delete","clear"],Tp=new Map;function Hb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Tp.get(e))return Tp.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=CI.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||AI.includes(n)))return;const l=async function(u,...f){const m=this.transaction(u,a?"readwrite":"readonly");let g=m.store;return i&&(g=g.index(f.shift())),(await Promise.all([g[n](...f),a&&m.done]))[0]};return Tp.set(e,l),l}EI(t=>({...t,get:(e,n,i)=>Hb(e,n)||t.get(e,n,i),has:(e,n)=>!!Hb(e,n)||t.has(e,n)}));class RI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(DI(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function DI(t){return t.getComponent()?.type==="VERSION"}const Xp="@firebase/app",Gb="0.14.6";const Hi=new Lg("@firebase/app"),II="@firebase/app-compat",jI="@firebase/analytics-compat",OI="@firebase/analytics",kI="@firebase/app-check-compat",MI="@firebase/app-check",NI="@firebase/auth",PI="@firebase/auth-compat",LI="@firebase/database",VI="@firebase/data-connect",zI="@firebase/database-compat",UI="@firebase/functions",BI="@firebase/functions-compat",FI="@firebase/installations",qI="@firebase/installations-compat",HI="@firebase/messaging",GI="@firebase/messaging-compat",QI="@firebase/performance",$I="@firebase/performance-compat",KI="@firebase/remote-config",WI="@firebase/remote-config-compat",YI="@firebase/storage",XI="@firebase/storage-compat",JI="@firebase/firestore",ZI="@firebase/ai",ej="@firebase/firestore-compat",tj="firebase",nj="12.6.0";const Jp="[DEFAULT]",rj={[Xp]:"fire-core",[II]:"fire-core-compat",[OI]:"fire-analytics",[jI]:"fire-analytics-compat",[MI]:"fire-app-check",[kI]:"fire-app-check-compat",[NI]:"fire-auth",[PI]:"fire-auth-compat",[LI]:"fire-rtdb",[VI]:"fire-data-connect",[zI]:"fire-rtdb-compat",[UI]:"fire-fn",[BI]:"fire-fn-compat",[FI]:"fire-iid",[qI]:"fire-iid-compat",[HI]:"fire-fcm",[GI]:"fire-fcm-compat",[QI]:"fire-perf",[$I]:"fire-perf-compat",[KI]:"fire-rc",[WI]:"fire-rc-compat",[YI]:"fire-gcs",[XI]:"fire-gcs-compat",[JI]:"fire-fst",[ej]:"fire-fst-compat",[ZI]:"fire-vertex","fire-js":"fire-js",[tj]:"fire-js-all"};const yh=new Map,ij=new Map,Zp=new Map;function Qb(t,e){try{t.container.addComponent(e)}catch(n){Hi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ko(t){const e=t.name;if(Zp.has(e))return Hi.debug(`There were multiple attempts to register component ${e}.`),!1;Zp.set(e,t);for(const n of yh.values())Qb(n,t);for(const n of ij.values())Qb(n,t);return!0}function zg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function kr(t){return t==null?!1:t.settings!==void 0}const sj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},zs=new ru("app","Firebase",sj);class aj{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Na("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw zs.create("app-deleted",{appName:this._name})}}const hl=nj;function RS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:Jp,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw zs.create("bad-app-name",{appName:String(a)});if(n||(n=ES()),!n)throw zs.create("no-options");const l=yh.get(a);if(l){if(Qs(n,l.options)&&Qs(i,l.config))return l;throw zs.create("duplicate-app",{appName:a})}const u=new hI(a);for(const m of Zp.values())u.addComponent(m);const f=new aj(n,i,u);return yh.set(a,f),f}function DS(t=Jp){const e=yh.get(t);if(!e&&t===Jp&&ES())return RS();if(!e)throw zs.create("no-app",{appName:t});return e}function Us(t,e,n){let i=rj[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${i}" with version "${e}":`];a&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hi.warn(u.join(" "));return}Ko(new Na(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const oj="firebase-heartbeat-database",lj=1,qc="firebase-heartbeat-store";let Ap=null;function IS(){return Ap||(Ap=TI(oj,lj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(qc)}catch(n){console.warn(n)}}}}).catch(t=>{throw zs.create("idb-open",{originalErrorMessage:t.message})})),Ap}async function cj(t){try{const n=(await IS()).transaction(qc),i=await n.objectStore(qc).get(jS(t));return await n.done,i}catch(e){if(e instanceof Ki)Hi.warn(e.message);else{const n=zs.create("idb-get",{originalErrorMessage:e?.message});Hi.warn(n.message)}}}async function $b(t,e){try{const i=(await IS()).transaction(qc,"readwrite");await i.objectStore(qc).put(e,jS(t)),await i.done}catch(n){if(n instanceof Ki)Hi.warn(n.message);else{const i=zs.create("idb-set",{originalErrorMessage:n?.message});Hi.warn(i.message)}}}function jS(t){return`${t.name}!${t.options.appId}`}const uj=1024,dj=30;class hj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new mj(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Kb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>dj){const a=pj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Hi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Kb(),{heartbeatsToSend:n,unsentEntries:i}=fj(this._heartbeatsCache.heartbeats),a=gh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Hi.warn(e),""}}}function Kb(){return new Date().toISOString().substring(0,10)}function fj(t,e=uj){const n=[];let i=t.slice();for(const a of t){const l=n.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),Wb(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Wb(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class mj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return eI()?tI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await cj(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return $b(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return $b(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Wb(t){return gh(JSON.stringify({version:2,heartbeats:t})).length}function pj(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function gj(t){Ko(new Na("platform-logger",e=>new RI(e),"PRIVATE")),Ko(new Na("heartbeat",e=>new hj(e),"PRIVATE")),Us(Xp,Gb,t),Us(Xp,Gb,"esm2020"),Us("fire-js","")}gj("");var yj="firebase",_j="12.7.0";Us(yj,_j,"app");const vj={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},OS=RS(vj);var Yb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Bs,kS;(function(){var t;function e(L,R){function D(){}D.prototype=R.prototype,L.F=R.prototype,L.prototype=new D,L.prototype.constructor=L,L.D=function(M,j,O){for(var C=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)C[Y-2]=arguments[Y];return R.prototype[j].apply(M,C)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(L,R,D){D||(D=0);const M=Array(16);if(typeof R=="string")for(var j=0;j<16;++j)M[j]=R.charCodeAt(D++)|R.charCodeAt(D++)<<8|R.charCodeAt(D++)<<16|R.charCodeAt(D++)<<24;else for(j=0;j<16;++j)M[j]=R[D++]|R[D++]<<8|R[D++]<<16|R[D++]<<24;R=L.g[0],D=L.g[1],j=L.g[2];let O=L.g[3],C;C=R+(O^D&(j^O))+M[0]+3614090360&4294967295,R=D+(C<<7&4294967295|C>>>25),C=O+(j^R&(D^j))+M[1]+3905402710&4294967295,O=R+(C<<12&4294967295|C>>>20),C=j+(D^O&(R^D))+M[2]+606105819&4294967295,j=O+(C<<17&4294967295|C>>>15),C=D+(R^j&(O^R))+M[3]+3250441966&4294967295,D=j+(C<<22&4294967295|C>>>10),C=R+(O^D&(j^O))+M[4]+4118548399&4294967295,R=D+(C<<7&4294967295|C>>>25),C=O+(j^R&(D^j))+M[5]+1200080426&4294967295,O=R+(C<<12&4294967295|C>>>20),C=j+(D^O&(R^D))+M[6]+2821735955&4294967295,j=O+(C<<17&4294967295|C>>>15),C=D+(R^j&(O^R))+M[7]+4249261313&4294967295,D=j+(C<<22&4294967295|C>>>10),C=R+(O^D&(j^O))+M[8]+1770035416&4294967295,R=D+(C<<7&4294967295|C>>>25),C=O+(j^R&(D^j))+M[9]+2336552879&4294967295,O=R+(C<<12&4294967295|C>>>20),C=j+(D^O&(R^D))+M[10]+4294925233&4294967295,j=O+(C<<17&4294967295|C>>>15),C=D+(R^j&(O^R))+M[11]+2304563134&4294967295,D=j+(C<<22&4294967295|C>>>10),C=R+(O^D&(j^O))+M[12]+1804603682&4294967295,R=D+(C<<7&4294967295|C>>>25),C=O+(j^R&(D^j))+M[13]+4254626195&4294967295,O=R+(C<<12&4294967295|C>>>20),C=j+(D^O&(R^D))+M[14]+2792965006&4294967295,j=O+(C<<17&4294967295|C>>>15),C=D+(R^j&(O^R))+M[15]+1236535329&4294967295,D=j+(C<<22&4294967295|C>>>10),C=R+(j^O&(D^j))+M[1]+4129170786&4294967295,R=D+(C<<5&4294967295|C>>>27),C=O+(D^j&(R^D))+M[6]+3225465664&4294967295,O=R+(C<<9&4294967295|C>>>23),C=j+(R^D&(O^R))+M[11]+643717713&4294967295,j=O+(C<<14&4294967295|C>>>18),C=D+(O^R&(j^O))+M[0]+3921069994&4294967295,D=j+(C<<20&4294967295|C>>>12),C=R+(j^O&(D^j))+M[5]+3593408605&4294967295,R=D+(C<<5&4294967295|C>>>27),C=O+(D^j&(R^D))+M[10]+38016083&4294967295,O=R+(C<<9&4294967295|C>>>23),C=j+(R^D&(O^R))+M[15]+3634488961&4294967295,j=O+(C<<14&4294967295|C>>>18),C=D+(O^R&(j^O))+M[4]+3889429448&4294967295,D=j+(C<<20&4294967295|C>>>12),C=R+(j^O&(D^j))+M[9]+568446438&4294967295,R=D+(C<<5&4294967295|C>>>27),C=O+(D^j&(R^D))+M[14]+3275163606&4294967295,O=R+(C<<9&4294967295|C>>>23),C=j+(R^D&(O^R))+M[3]+4107603335&4294967295,j=O+(C<<14&4294967295|C>>>18),C=D+(O^R&(j^O))+M[8]+1163531501&4294967295,D=j+(C<<20&4294967295|C>>>12),C=R+(j^O&(D^j))+M[13]+2850285829&4294967295,R=D+(C<<5&4294967295|C>>>27),C=O+(D^j&(R^D))+M[2]+4243563512&4294967295,O=R+(C<<9&4294967295|C>>>23),C=j+(R^D&(O^R))+M[7]+1735328473&4294967295,j=O+(C<<14&4294967295|C>>>18),C=D+(O^R&(j^O))+M[12]+2368359562&4294967295,D=j+(C<<20&4294967295|C>>>12),C=R+(D^j^O)+M[5]+4294588738&4294967295,R=D+(C<<4&4294967295|C>>>28),C=O+(R^D^j)+M[8]+2272392833&4294967295,O=R+(C<<11&4294967295|C>>>21),C=j+(O^R^D)+M[11]+1839030562&4294967295,j=O+(C<<16&4294967295|C>>>16),C=D+(j^O^R)+M[14]+4259657740&4294967295,D=j+(C<<23&4294967295|C>>>9),C=R+(D^j^O)+M[1]+2763975236&4294967295,R=D+(C<<4&4294967295|C>>>28),C=O+(R^D^j)+M[4]+1272893353&4294967295,O=R+(C<<11&4294967295|C>>>21),C=j+(O^R^D)+M[7]+4139469664&4294967295,j=O+(C<<16&4294967295|C>>>16),C=D+(j^O^R)+M[10]+3200236656&4294967295,D=j+(C<<23&4294967295|C>>>9),C=R+(D^j^O)+M[13]+681279174&4294967295,R=D+(C<<4&4294967295|C>>>28),C=O+(R^D^j)+M[0]+3936430074&4294967295,O=R+(C<<11&4294967295|C>>>21),C=j+(O^R^D)+M[3]+3572445317&4294967295,j=O+(C<<16&4294967295|C>>>16),C=D+(j^O^R)+M[6]+76029189&4294967295,D=j+(C<<23&4294967295|C>>>9),C=R+(D^j^O)+M[9]+3654602809&4294967295,R=D+(C<<4&4294967295|C>>>28),C=O+(R^D^j)+M[12]+3873151461&4294967295,O=R+(C<<11&4294967295|C>>>21),C=j+(O^R^D)+M[15]+530742520&4294967295,j=O+(C<<16&4294967295|C>>>16),C=D+(j^O^R)+M[2]+3299628645&4294967295,D=j+(C<<23&4294967295|C>>>9),C=R+(j^(D|~O))+M[0]+4096336452&4294967295,R=D+(C<<6&4294967295|C>>>26),C=O+(D^(R|~j))+M[7]+1126891415&4294967295,O=R+(C<<10&4294967295|C>>>22),C=j+(R^(O|~D))+M[14]+2878612391&4294967295,j=O+(C<<15&4294967295|C>>>17),C=D+(O^(j|~R))+M[5]+4237533241&4294967295,D=j+(C<<21&4294967295|C>>>11),C=R+(j^(D|~O))+M[12]+1700485571&4294967295,R=D+(C<<6&4294967295|C>>>26),C=O+(D^(R|~j))+M[3]+2399980690&4294967295,O=R+(C<<10&4294967295|C>>>22),C=j+(R^(O|~D))+M[10]+4293915773&4294967295,j=O+(C<<15&4294967295|C>>>17),C=D+(O^(j|~R))+M[1]+2240044497&4294967295,D=j+(C<<21&4294967295|C>>>11),C=R+(j^(D|~O))+M[8]+1873313359&4294967295,R=D+(C<<6&4294967295|C>>>26),C=O+(D^(R|~j))+M[15]+4264355552&4294967295,O=R+(C<<10&4294967295|C>>>22),C=j+(R^(O|~D))+M[6]+2734768916&4294967295,j=O+(C<<15&4294967295|C>>>17),C=D+(O^(j|~R))+M[13]+1309151649&4294967295,D=j+(C<<21&4294967295|C>>>11),C=R+(j^(D|~O))+M[4]+4149444226&4294967295,R=D+(C<<6&4294967295|C>>>26),C=O+(D^(R|~j))+M[11]+3174756917&4294967295,O=R+(C<<10&4294967295|C>>>22),C=j+(R^(O|~D))+M[2]+718787259&4294967295,j=O+(C<<15&4294967295|C>>>17),C=D+(O^(j|~R))+M[9]+3951481745&4294967295,L.g[0]=L.g[0]+R&4294967295,L.g[1]=L.g[1]+(j+(C<<21&4294967295|C>>>11))&4294967295,L.g[2]=L.g[2]+j&4294967295,L.g[3]=L.g[3]+O&4294967295}i.prototype.v=function(L,R){R===void 0&&(R=L.length);const D=R-this.blockSize,M=this.C;let j=this.h,O=0;for(;O<R;){if(j==0)for(;O<=D;)a(this,L,O),O+=this.blockSize;if(typeof L=="string"){for(;O<R;)if(M[j++]=L.charCodeAt(O++),j==this.blockSize){a(this,M),j=0;break}}else for(;O<R;)if(M[j++]=L[O++],j==this.blockSize){a(this,M),j=0;break}}this.h=j,this.o+=R},i.prototype.A=function(){var L=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);L[0]=128;for(var R=1;R<L.length-8;++R)L[R]=0;R=this.o*8;for(var D=L.length-8;D<L.length;++D)L[D]=R&255,R/=256;for(this.v(L),L=Array(16),R=0,D=0;D<4;++D)for(let M=0;M<32;M+=8)L[R++]=this.g[D]>>>M&255;return L};function l(L,R){var D=f;return Object.prototype.hasOwnProperty.call(D,L)?D[L]:D[L]=R(L)}function u(L,R){this.h=R;const D=[];let M=!0;for(let j=L.length-1;j>=0;j--){const O=L[j]|0;M&&O==R||(D[j]=O,M=!1)}this.g=D}var f={};function m(L){return-128<=L&&L<128?l(L,function(R){return new u([R|0],R<0?-1:0)}):new u([L|0],L<0?-1:0)}function g(L){if(isNaN(L)||!isFinite(L))return v;if(L<0)return N(g(-L));const R=[];let D=1;for(let M=0;L>=D;M++)R[M]=L/D|0,D*=4294967296;return new u(R,0)}function _(L,R){if(L.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(L.charAt(0)=="-")return N(_(L.substring(1),R));if(L.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=g(Math.pow(R,8));let M=v;for(let O=0;O<L.length;O+=8){var j=Math.min(8,L.length-O);const C=parseInt(L.substring(O,O+j),R);j<8?(j=g(Math.pow(R,j)),M=M.j(j).add(g(C))):(M=M.j(D),M=M.add(g(C)))}return M}var v=m(0),x=m(1),w=m(16777216);t=u.prototype,t.m=function(){if(I(this))return-N(this).m();let L=0,R=1;for(let D=0;D<this.g.length;D++){const M=this.i(D);L+=(M>=0?M:4294967296+M)*R,R*=4294967296}return L},t.toString=function(L){if(L=L||10,L<2||36<L)throw Error("radix out of range: "+L);if(A(this))return"0";if(I(this))return"-"+N(this).toString(L);const R=g(Math.pow(L,6));var D=this;let M="";for(;;){const j=me(D,R).g;D=H(D,j.j(R));let O=((D.g.length>0?D.g[0]:D.h)>>>0).toString(L);if(D=j,A(D))return O+M;for(;O.length<6;)O="0"+O;M=O+M}},t.i=function(L){return L<0?0:L<this.g.length?this.g[L]:this.h};function A(L){if(L.h!=0)return!1;for(let R=0;R<L.g.length;R++)if(L.g[R]!=0)return!1;return!0}function I(L){return L.h==-1}t.l=function(L){return L=H(this,L),I(L)?-1:A(L)?0:1};function N(L){const R=L.g.length,D=[];for(let M=0;M<R;M++)D[M]=~L.g[M];return new u(D,~L.h).add(x)}t.abs=function(){return I(this)?N(this):this},t.add=function(L){const R=Math.max(this.g.length,L.g.length),D=[];let M=0;for(let j=0;j<=R;j++){let O=M+(this.i(j)&65535)+(L.i(j)&65535),C=(O>>>16)+(this.i(j)>>>16)+(L.i(j)>>>16);M=C>>>16,O&=65535,C&=65535,D[j]=C<<16|O}return new u(D,D[D.length-1]&-2147483648?-1:0)};function H(L,R){return L.add(N(R))}t.j=function(L){if(A(this)||A(L))return v;if(I(this))return I(L)?N(this).j(N(L)):N(N(this).j(L));if(I(L))return N(this.j(N(L)));if(this.l(w)<0&&L.l(w)<0)return g(this.m()*L.m());const R=this.g.length+L.g.length,D=[];for(var M=0;M<2*R;M++)D[M]=0;for(M=0;M<this.g.length;M++)for(let j=0;j<L.g.length;j++){const O=this.i(M)>>>16,C=this.i(M)&65535,Y=L.i(j)>>>16,U=L.i(j)&65535;D[2*M+2*j]+=C*U,$(D,2*M+2*j),D[2*M+2*j+1]+=O*U,$(D,2*M+2*j+1),D[2*M+2*j+1]+=C*Y,$(D,2*M+2*j+1),D[2*M+2*j+2]+=O*Y,$(D,2*M+2*j+2)}for(L=0;L<R;L++)D[L]=D[2*L+1]<<16|D[2*L];for(L=R;L<2*R;L++)D[L]=0;return new u(D,0)};function $(L,R){for(;(L[R]&65535)!=L[R];)L[R+1]+=L[R]>>>16,L[R]&=65535,R++}function q(L,R){this.g=L,this.h=R}function me(L,R){if(A(R))throw Error("division by zero");if(A(L))return new q(v,v);if(I(L))return R=me(N(L),R),new q(N(R.g),N(R.h));if(I(R))return R=me(L,N(R)),new q(N(R.g),R.h);if(L.g.length>30){if(I(L)||I(R))throw Error("slowDivide_ only works with positive integers.");for(var D=x,M=R;M.l(L)<=0;)D=ie(D),M=ie(M);var j=he(D,1),O=he(M,1);for(M=he(M,2),D=he(D,2);!A(M);){var C=O.add(M);C.l(L)<=0&&(j=j.add(D),O=C),M=he(M,1),D=he(D,1)}return R=H(L,j.j(R)),new q(j,R)}for(j=v;L.l(R)>=0;){for(D=Math.max(1,Math.floor(L.m()/R.m())),M=Math.ceil(Math.log(D)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),O=g(D),C=O.j(R);I(C)||C.l(L)>0;)D-=M,O=g(D),C=O.j(R);A(O)&&(O=x),j=j.add(O),L=H(L,C)}return new q(j,L)}t.B=function(L){return me(this,L).h},t.and=function(L){const R=Math.max(this.g.length,L.g.length),D=[];for(let M=0;M<R;M++)D[M]=this.i(M)&L.i(M);return new u(D,this.h&L.h)},t.or=function(L){const R=Math.max(this.g.length,L.g.length),D=[];for(let M=0;M<R;M++)D[M]=this.i(M)|L.i(M);return new u(D,this.h|L.h)},t.xor=function(L){const R=Math.max(this.g.length,L.g.length),D=[];for(let M=0;M<R;M++)D[M]=this.i(M)^L.i(M);return new u(D,this.h^L.h)};function ie(L){const R=L.g.length+1,D=[];for(let M=0;M<R;M++)D[M]=L.i(M)<<1|L.i(M-1)>>>31;return new u(D,L.h)}function he(L,R){const D=R>>5;R%=32;const M=L.g.length-D,j=[];for(let O=0;O<M;O++)j[O]=R>0?L.i(O+D)>>>R|L.i(O+D+1)<<32-R:L.i(O+D);return new u(j,L.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,kS=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=g,u.fromString=_,Bs=u}).apply(typeof Yb<"u"?Yb:typeof self<"u"?self:typeof window<"u"?window:{});var $d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var MS,jc,NS,th,eg,PS,LS,VS;(function(){var t,e=Object.defineProperty;function n(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof $d=="object"&&$d];for(var b=0;b<h.length;++b){var S=h[b];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=n(this);function a(h,b){if(b)e:{var S=i;h=h.split(".");for(var V=0;V<h.length-1;V++){var Z=h[V];if(!(Z in S))break e;S=S[Z]}h=h[h.length-1],V=S[h],b=b(V),b!=V&&b!=null&&e(S,h,{configurable:!0,writable:!0,value:b})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(b){var S=[],V;for(V in b)Object.prototype.hasOwnProperty.call(b,V)&&S.push([V,b[V]]);return S}});var l=l||{},u=this||self;function f(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function m(h,b,S){return h.call.apply(h.bind,arguments)}function g(h,b,S){return g=m,g.apply(null,arguments)}function _(h,b){var S=Array.prototype.slice.call(arguments,1);return function(){var V=S.slice();return V.push.apply(V,arguments),h.apply(this,V)}}function v(h,b){function S(){}S.prototype=b.prototype,h.Z=b.prototype,h.prototype=new S,h.prototype.constructor=h,h.Ob=function(V,Z,se){for(var Ee=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)Ee[qe-2]=arguments[qe];return b.prototype[Z].apply(V,Ee)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function w(h){const b=h.length;if(b>0){const S=Array(b);for(let V=0;V<b;V++)S[V]=h[V];return S}return[]}function A(h,b){for(let V=1;V<arguments.length;V++){const Z=arguments[V];var S=typeof Z;if(S=S!="object"?S:Z?Array.isArray(Z)?"array":S:"null",S=="array"||S=="object"&&typeof Z.length=="number"){S=h.length||0;const se=Z.length||0;h.length=S+se;for(let Ee=0;Ee<se;Ee++)h[S+Ee]=Z[Ee]}else h.push(Z)}}class I{constructor(b,S){this.i=b,this.j=S,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function N(h){u.setTimeout(()=>{throw h},0)}function H(){var h=L;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class ${constructor(){this.h=this.g=null}add(b,S){const V=q.get();V.set(b,S),this.h?this.h.next=V:this.g=V,this.h=V}}var q=new I(()=>new me,h=>h.reset());class me{constructor(){this.next=this.g=this.h=null}set(b,S){this.h=b,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let ie,he=!1,L=new $,R=()=>{const h=Promise.resolve(void 0);ie=()=>{h.then(D)}};function D(){for(var h;h=H();){try{h.h.call(h.g)}catch(S){N(S)}var b=q;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}he=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const S=()=>{};u.addEventListener("test",S,b),u.removeEventListener("test",S,b)}catch{}return h})();function C(h){return/^[\s\xa0]*$/.test(h)}function Y(h,b){j.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}v(Y,j),Y.prototype.init=function(h,b){const S=this.type=h.type,V=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(S=="mouseover"?b=h.fromElement:S=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&Y.Z.h.call(this)},Y.prototype.h=function(){Y.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var U="closure_listenable_"+(Math.random()*1e6|0),P=0;function B(h,b,S,V,Z){this.listener=h,this.proxy=null,this.src=b,this.type=S,this.capture=!!V,this.ha=Z,this.key=++P,this.da=this.fa=!1}function Q(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function le(h,b,S){for(const V in h)b.call(S,h[V],V,h)}function J(h,b){for(const S in h)b.call(void 0,h[S],S,h)}function z(h){const b={};for(const S in h)b[S]=h[S];return b}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(h,b){let S,V;for(let Z=1;Z<arguments.length;Z++){V=arguments[Z];for(S in V)h[S]=V[S];for(let se=0;se<F.length;se++)S=F[se],Object.prototype.hasOwnProperty.call(V,S)&&(h[S]=V[S])}}function ne(h){this.src=h,this.g={},this.h=0}ne.prototype.add=function(h,b,S,V,Z){const se=h.toString();h=this.g[se],h||(h=this.g[se]=[],this.h++);const Ee=pe(h,b,V,Z);return Ee>-1?(b=h[Ee],S||(b.fa=!1)):(b=new B(b,this.src,se,!!V,Z),b.fa=S,h.push(b)),b};function ae(h,b){const S=b.type;if(S in h.g){var V=h.g[S],Z=Array.prototype.indexOf.call(V,b,void 0),se;(se=Z>=0)&&Array.prototype.splice.call(V,Z,1),se&&(Q(b),h.g[S].length==0&&(delete h.g[S],h.h--))}}function pe(h,b,S,V){for(let Z=0;Z<h.length;++Z){const se=h[Z];if(!se.da&&se.listener==b&&se.capture==!!S&&se.ha==V)return Z}return-1}var ue="closure_lm_"+(Math.random()*1e6|0),be={};function Se(h,b,S,V,Z){if(Array.isArray(b)){for(let se=0;se<b.length;se++)Se(h,b[se],S,V,Z);return null}return S=en(S),h&&h[U]?h.J(b,S,f(V)?!!V.capture:!1,Z):de(h,b,S,!1,V,Z)}function de(h,b,S,V,Z,se){if(!b)throw Error("Invalid event type");const Ee=f(Z)?!!Z.capture:!!Z;let qe=_t(h);if(qe||(h[ue]=qe=new ne(h)),S=qe.add(b,S,V,Ee,se),S.proxy)return S;if(V=Ce(),S.proxy=V,V.src=h,V.listener=S,h.addEventListener)O||(Z=Ee),Z===void 0&&(Z=!1),h.addEventListener(b.toString(),V,Z);else if(h.attachEvent)h.attachEvent(Me(b.toString()),V);else if(h.addListener&&h.removeListener)h.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return S}function Ce(){function h(S){return b.call(h.src,h.listener,S)}const b=$e;return h}function De(h,b,S,V,Z){if(Array.isArray(b))for(var se=0;se<b.length;se++)De(h,b[se],S,V,Z);else V=f(V)?!!V.capture:!!V,S=en(S),h&&h[U]?(h=h.i,se=String(b).toString(),se in h.g&&(b=h.g[se],S=pe(b,S,V,Z),S>-1&&(Q(b[S]),Array.prototype.splice.call(b,S,1),b.length==0&&(delete h.g[se],h.h--)))):h&&(h=_t(h))&&(b=h.g[b.toString()],h=-1,b&&(h=pe(b,S,V,Z)),(S=h>-1?b[h]:null)&&Te(S))}function Te(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[U])ae(b.i,h);else{var S=h.type,V=h.proxy;b.removeEventListener?b.removeEventListener(S,V,h.capture):b.detachEvent?b.detachEvent(Me(S),V):b.addListener&&b.removeListener&&b.removeListener(V),(S=_t(b))?(ae(S,h),S.h==0&&(S.src=null,b[ue]=null)):Q(h)}}}function Me(h){return h in be?be[h]:be[h]="on"+h}function $e(h,b){if(h.da)h=!0;else{b=new Y(b,this);const S=h.listener,V=h.ha||h.src;h.fa&&Te(h),h=S.call(V,b)}return h}function _t(h){return h=h[ue],h instanceof ne?h:null}var wt="__closure_events_fn_"+(Math.random()*1e9>>>0);function en(h){return typeof h=="function"?h:(h[wt]||(h[wt]=function(b){return h.handleEvent(b)}),h[wt])}function lt(){M.call(this),this.i=new ne(this),this.M=this,this.G=null}v(lt,M),lt.prototype[U]=!0,lt.prototype.removeEventListener=function(h,b,S,V){De(this,h,b,S,V)};function Ne(h,b){var S,V=h.G;if(V)for(S=[];V;V=V.G)S.push(V);if(h=h.M,V=b.type||b,typeof b=="string")b=new j(b,h);else if(b instanceof j)b.target=b.target||h;else{var Z=b;b=new j(V,h),W(b,Z)}Z=!0;let se,Ee;if(S)for(Ee=S.length-1;Ee>=0;Ee--)se=b.g=S[Ee],Z=Mt(se,V,!0,b)&&Z;if(se=b.g=h,Z=Mt(se,V,!0,b)&&Z,Z=Mt(se,V,!1,b)&&Z,S)for(Ee=0;Ee<S.length;Ee++)se=b.g=S[Ee],Z=Mt(se,V,!1,b)&&Z}lt.prototype.N=function(){if(lt.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const S=h.g[b];for(let V=0;V<S.length;V++)Q(S[V]);delete h.g[b],h.h--}}this.G=null},lt.prototype.J=function(h,b,S,V){return this.i.add(String(h),b,!1,S,V)},lt.prototype.K=function(h,b,S,V){return this.i.add(String(h),b,!0,S,V)};function Mt(h,b,S,V){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let Z=!0;for(let se=0;se<b.length;++se){const Ee=b[se];if(Ee&&!Ee.da&&Ee.capture==S){const qe=Ee.listener,Lt=Ee.ha||Ee.src;Ee.fa&&ae(h.i,Ee),Z=qe.call(Lt,V)!==!1&&Z}}return Z&&!V.defaultPrevented}function ln(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=g(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:u.setTimeout(h,b||0)}function Dn(h){h.g=ln(()=>{h.g=null,h.i&&(h.i=!1,Dn(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class Nt extends M{constructor(b,S){super(),this.m=b,this.l=S,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Dn(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function jt(h){M.call(this),this.h=h,this.g={}}v(jt,M);var Gn=[];function Tl(h){le(h.g,function(b,S){this.g.hasOwnProperty(S)&&Te(b)},h),h.g={}}jt.prototype.N=function(){jt.Z.N.call(this),Tl(this)},jt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ji=u.JSON.stringify,gf=u.JSON.parse,yu=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function _u(){}function vu(){}var xr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function mn(){j.call(this,"d")}v(mn,j);function sr(){j.call(this,"c")}v(sr,j);var Pt={},bu=null;function Ga(){return bu=bu||new lt}Pt.Ia="serverreachability";function xu(h){j.call(this,Pt.Ia,h)}v(xu,j);function zr(h){const b=Ga();Ne(b,new xu(b))}Pt.STAT_EVENT="statevent";function na(h,b){j.call(this,Pt.STAT_EVENT,h),this.stat=b}v(na,j);function Ft(h){const b=Ga();Ne(b,new na(b,h))}Pt.Ja="timingevent";function Ur(h,b){j.call(this,Pt.Ja,h),this.size=b}v(Ur,j);function Br(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},b)}function Er(){this.g=!0}Er.prototype.ua=function(){this.g=!1};function yf(h,b,S,V,Z,se){h.info(function(){if(h.g)if(se){var Ee="",qe=se.split("&");for(let st=0;st<qe.length;st++){var Lt=qe[st].split("=");if(Lt.length>1){const Tt=Lt[0];Lt=Lt[1];const cr=Tt.split("_");Ee=cr.length>=2&&cr[1]=="type"?Ee+(Tt+"="+Lt+"&"):Ee+(Tt+"=redacted&")}}}else Ee=null;else Ee=se;return"XMLHTTP REQ ("+V+") [attempt "+Z+"]: "+b+`
`+S+`
`+Ee})}function Eu(h,b,S,V,Z,se,Ee){h.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+Z+"]: "+b+`
`+S+`
`+se+" "+Ee})}function Fr(h,b,S,V){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+_f(h,S)+(V?" "+V:"")})}function ra(h,b){h.info(function(){return"TIMEOUT: "+b})}Er.prototype.info=function(){};function _f(h,b){if(!h.g)return b;if(!b)return null;try{const se=JSON.parse(b);if(se){for(h=0;h<se.length;h++)if(Array.isArray(se[h])){var S=se[h];if(!(S.length<2)){var V=S[1];if(Array.isArray(V)&&!(V.length<1)){var Z=V[0];if(Z!="noop"&&Z!="stop"&&Z!="close")for(let Ee=1;Ee<V.length;Ee++)V[Ee]=""}}}}return Ji(se)}catch{return b}}var ia={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Al={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Cl;function sa(){}v(sa,_u),sa.prototype.g=function(){return new XMLHttpRequest},Cl=new sa;function gi(h){return encodeURIComponent(String(h))}function Su(h){var b=1;h=h.split(":");const S=[];for(;b>0&&h.length;)S.push(h.shift()),b--;return h.length&&S.push(h.join(":")),S}function Sr(h,b,S,V){this.j=h,this.i=b,this.l=S,this.S=V||1,this.V=new jt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new wr}function wr(){this.i=null,this.g="",this.h=!1}var qt={},cn={};function qr(h,b,S){h.M=1,h.A=aa(Gt(b)),h.u=S,h.R=!0,Qa(h,null)}function Qa(h,b){h.F=Date.now(),Hr(h),h.B=Gt(h.A);var S=h.B,V=h.S;Array.isArray(V)||(V=[String(V)]),Ya(S.i,"t",V),h.C=0,S=h.j.L,h.h=new wr,h.g=Vu(h.j,S?b:null,!h.u),h.P>0&&(h.O=new Nt(g(h.Y,h,h.g),h.P)),b=h.V,S=h.g,V=h.ba;var Z="readystatechange";Array.isArray(Z)||(Z&&(Gn[0]=Z.toString()),Z=Gn);for(let se=0;se<Z.length;se++){const Ee=Se(S,Z[se],V||b.handleEvent,!1,b.h||b);if(!Ee)break;b.g[Ee.key]=Ee}b=h.J?z(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),zr(),yf(h.i,h.v,h.B,h.l,h.S,h.u)}Sr.prototype.ba=function(h){h=h.target;const b=this.O;b&&Cr(h)==3?b.j():this.Y(h)},Sr.prototype.Y=function(h){try{if(h==this.g)e:{const qe=Cr(this.g),Lt=this.g.ya(),st=this.g.ca();if(!(qe<3)&&(qe!=3||this.g&&(this.h.h||this.g.la()||pn(this.g)))){this.K||qe!=4||Lt==7||(Lt==8||st<=0?zr(3):zr(2)),Gr(this);var b=this.g.ca();this.X=b;var S=vf(this);if(this.o=b==200,Eu(this.i,this.v,this.B,this.l,this.S,qe,b),this.o){if(this.U&&!this.L){t:{if(this.g){var V,Z=this.g;if((V=Z.g?Z.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(V)){var se=V;break t}}se=null}if(h=se)Fr(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Qr(this,h);else{this.o=!1,this.m=3,Ft(12),Qn(this),ar(this);break e}}if(this.R){h=!0;let Tt;for(;!this.K&&this.C<S.length;)if(Tt=Tu(this,S),Tt==cn){qe==4&&(this.m=4,Ft(14),h=!1),Fr(this.i,this.l,null,"[Incomplete Response]");break}else if(Tt==qt){this.m=4,Ft(15),Fr(this.i,this.l,S,"[Invalid Chunk]"),h=!1;break}else Fr(this.i,this.l,Tt,null),Qr(this,Tt);if(wu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qe!=4||S.length!=0||this.h.h||(this.m=1,Ft(16),h=!1),this.o=this.o&&h,!h)Fr(this.i,this.l,S,"[Invalid Chunked Response]"),Qn(this),ar(this);else if(S.length>0&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.aa&&!Ee.P&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),Fl(Ee),Ee.P=!0,Ft(11))}}else Fr(this.i,this.l,S,null),Qr(this,S);qe==4&&Qn(this),this.o&&!this.K&&(qe==4?Mu(this.j,this):(this.o=!1,Hr(this)))}else _i(this.g),b==400&&S.indexOf("Unknown SID")>0?(this.m=3,Ft(12)):(this.m=0,Ft(13)),Qn(this),ar(this)}}}catch{}};function vf(h){if(!wu(h))return h.g.la();const b=pn(h.g);if(b==="")return"";let S="";const V=b.length,Z=Cr(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return Qn(h),ar(h),"";h.h.i=new u.TextDecoder}for(let se=0;se<V;se++)h.h.h=!0,S+=h.h.i.decode(b[se],{stream:!(Z&&se==V-1)});return b.length=0,h.h.g+=S,h.C=0,h.h.g}function wu(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function Tu(h,b){var S=h.C,V=b.indexOf(`
`,S);return V==-1?cn:(S=Number(b.substring(S,V)),isNaN(S)?qt:(V+=1,V+S>b.length?cn:(b=b.slice(V,V+S),h.C=V+S,b)))}Sr.prototype.cancel=function(){this.K=!0,Qn(this)};function Hr(h){h.T=Date.now()+h.H,$a(h,h.H)}function $a(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=Br(g(h.aa,h),b)}function Gr(h){h.D&&(u.clearTimeout(h.D),h.D=null)}Sr.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(ra(this.i,this.B),this.M!=2&&(zr(),Ft(17)),Qn(this),this.m=2,ar(this)):$a(this,this.T-h)};function ar(h){h.j.I==0||h.K||Mu(h.j,h)}function Qn(h){Gr(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,Tl(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function Qr(h,b){try{var S=h.j;if(S.I!=0&&(S.g==h||Kr(S.h,h))){if(!h.L&&Kr(S.h,h)&&S.I==3){try{var V=S.Ba.g.parse(b)}catch{V=null}if(Array.isArray(V)&&V.length==3){var Z=V;if(Z[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<h.F)to(S),as(S);else break e;fa(S),Ft(18)}}else S.xa=Z[1],0<S.xa-S.K&&Z[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=Br(g(S.Va,S),6e3));$r(S.h)<=1&&S.ta&&(S.ta=void 0)}else ei(S,11)}else if((h.L||S.g==h)&&to(S),!C(b))for(Z=S.Ba.g.parse(b),b=0;b<Z.length;b++){let st=Z[b];const Tt=st[0];if(!(Tt<=S.K))if(S.K=Tt,st=st[1],S.I==2)if(st[0]=="c"){S.M=st[1],S.ba=st[2];const cr=st[3];cr!=null&&(S.ka=cr,S.j.info("VER="+S.ka));const ti=st[4];ti!=null&&(S.za=ti,S.j.info("SVER="+S.za));const Rr=st[5];Rr!=null&&typeof Rr=="number"&&Rr>0&&(V=1.5*Rr,S.O=V,S.j.info("backChannelRequestTimeoutMs_="+V)),V=S;const Dr=h.g;if(Dr){const ma=Dr.g?Dr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ma){var se=V.h;se.g||ma.indexOf("spdy")==-1&&ma.indexOf("quic")==-1&&ma.indexOf("h2")==-1||(se.j=se.l,se.g=new Set,se.h&&(Il(se,se.h),se.h=null))}if(V.G){const no=Dr.g?Dr.g.getResponseHeader("X-HTTP-Session-Id"):null;no&&(V.wa=no,ct(V.J,V.G,no))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-h.F,S.j.info("Handshake RTT: "+S.T+"ms")),V=S;var Ee=h;if(V.na=Lu(V,V.L?V.ba:null,V.W),Ee.L){jl(V.h,Ee);var qe=Ee,Lt=V.O;Lt&&(qe.H=Lt),qe.D&&(Gr(qe),Hr(qe)),V.g=Ee}else Ou(V);S.i.length>0&&Zr(S)}else st[0]!="stop"&&st[0]!="close"||ei(S,7);else S.I==3&&(st[0]=="stop"||st[0]=="close"?st[0]=="stop"?ei(S,7):Ul(S):st[0]!="noop"&&S.l&&S.l.qa(st),S.A=0)}}zr(4)}catch{}}var Ht=class{constructor(h,b){this.g=h,this.map=b}};function Rl(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Dl(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function $r(h){return h.h?1:h.g?h.g.size:0}function Kr(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Il(h,b){h.g?h.g.add(b):h.h=b}function jl(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}Rl.prototype.cancel=function(){if(this.i=Ol(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Ol(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const S of h.g.values())b=b.concat(S.G);return b}return w(h.i)}var Au=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ka(h,b){if(h){h=h.split("&");for(let S=0;S<h.length;S++){const V=h[S].indexOf("=");let Z,se=null;V>=0?(Z=h[S].substring(0,V),se=h[S].substring(V+1)):Z=h[S],b(Z,se?decodeURIComponent(se.replace(/\+/g," ")):"")}}}function $n(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof $n?(this.l=h.l,un(this,h.j),this.o=h.o,this.g=h.g,Zi(this,h.u),this.h=h.h,kl(this,Iu(h.i)),this.m=h.m):h&&(b=String(h).match(Au))?(this.l=!1,un(this,b[1]||"",!0),this.o=Wr(b[2]||""),this.g=Wr(b[3]||"",!0),Zi(this,b[4]),this.h=Wr(b[5]||"",!0),kl(this,b[6]||"",!0),this.m=Wr(b[7]||"")):(this.l=!1,this.i=new ts(null,this.l))}$n.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(oa(b,Wa,!0),":");var S=this.g;return(S||b=="file")&&(h.push("//"),(b=this.o)&&h.push(oa(b,Wa,!0),"@"),h.push(gi(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&h.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&h.push("/"),h.push(oa(S,S.charAt(0)=="/"?Ml:Cu,!0))),(S=this.i.toString())&&h.push("?",S),(S=this.m)&&h.push("#",oa(S,Ru)),h.join("")},$n.prototype.resolve=function(h){const b=Gt(this);let S=!!h.j;S?un(b,h.j):S=!!h.o,S?b.o=h.o:S=!!h.g,S?b.g=h.g:S=h.u!=null;var V=h.h;if(S)Zi(b,h.u);else if(S=!!h.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var Z=b.h.lastIndexOf("/");Z!=-1&&(V=b.h.slice(0,Z+1)+V)}if(Z=V,Z==".."||Z==".")V="";else if(Z.indexOf("./")!=-1||Z.indexOf("/.")!=-1){V=Z.lastIndexOf("/",0)==0,Z=Z.split("/");const se=[];for(let Ee=0;Ee<Z.length;){const qe=Z[Ee++];qe=="."?V&&Ee==Z.length&&se.push(""):qe==".."?((se.length>1||se.length==1&&se[0]!="")&&se.pop(),V&&Ee==Z.length&&se.push("")):(se.push(qe),V=!0)}V=se.join("/")}else V=Z}return S?b.h=V:S=h.i.toString()!=="",S?kl(b,Iu(h.i)):S=!!h.m,S&&(b.m=h.m),b};function Gt(h){return new $n(h)}function un(h,b,S){h.j=S?Wr(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function Zi(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function kl(h,b,S){b instanceof ts?(h.i=b,Xa(h.i,h.l)):(S||(b=oa(b,es)),h.i=new ts(b,h.l))}function ct(h,b,S){h.i.set(b,S)}function aa(h){return ct(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function Wr(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function oa(h,b,S){return typeof h=="string"?(h=encodeURI(h).replace(b,Mn),S&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Mn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Wa=/[#\/\?@]/g,Cu=/[#\?:]/g,Ml=/[#\?]/g,es=/[#\?@]/g,Ru=/#/g;function ts(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Nn(h){h.g||(h.g=new Map,h.h=0,h.i&&Ka(h.i,function(b,S){h.add(decodeURIComponent(b.replace(/\+/g," ")),S)}))}t=ts.prototype,t.add=function(h,b){Nn(this),this.i=null,h=ns(this,h);let S=this.g.get(h);return S||this.g.set(h,S=[]),S.push(b),this.h+=1,this};function Du(h,b){Nn(h),b=ns(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Nl(h,b){return Nn(h),b=ns(h,b),h.g.has(b)}t.forEach=function(h,b){Nn(this),this.g.forEach(function(S,V){S.forEach(function(Z){h.call(b,Z,V,this)},this)},this)};function Pl(h,b){Nn(h);let S=[];if(typeof b=="string")Nl(h,b)&&(S=S.concat(h.g.get(ns(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)S=S.concat(h[b]);return S}t.set=function(h,b){return Nn(this),this.i=null,h=ns(this,h),Nl(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},t.get=function(h,b){return h?(h=Pl(this,h),h.length>0?String(h[0]):b):b};function Ya(h,b,S){Du(h,b),S.length>0&&(h.i=null,h.g.set(ns(h,b),w(S)),h.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let V=0;V<b.length;V++){var S=b[V];const Z=gi(S);S=Pl(this,S);for(let se=0;se<S.length;se++){let Ee=Z;S[se]!==""&&(Ee+="="+gi(S[se])),h.push(Ee)}}return this.i=h.join("&")};function Iu(h){const b=new ts;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function ns(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Xa(h,b){b&&!h.j&&(Nn(h),h.i=null,h.g.forEach(function(S,V){const Z=V.toLowerCase();V!=Z&&(Du(this,V),Ya(this,Z,S))},h)),h.j=b}function Tr(h,b){const S=new Er;if(u.Image){const V=new Image;V.onload=_(or,S,"TestLoadImage: loaded",!0,b,V),V.onerror=_(or,S,"TestLoadImage: error",!1,b,V),V.onabort=_(or,S,"TestLoadImage: abort",!1,b,V),V.ontimeout=_(or,S,"TestLoadImage: timeout",!1,b,V),u.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=h}else b(!1)}function Ll(h,b){const S=new Er,V=new AbortController,Z=setTimeout(()=>{V.abort(),or(S,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:V.signal}).then(se=>{clearTimeout(Z),se.ok?or(S,"TestPingServer: ok",!0,b):or(S,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(Z),or(S,"TestPingServer: error",!1,b)})}function or(h,b,S,V,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),V(S)}catch{}}function rs(){this.g=new yu}function Yr(h){this.i=h.Sb||null,this.h=h.ab||!1}v(Yr,_u),Yr.prototype.g=function(){return new la(this.i,this.h)};function la(h,b){lt.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(la,lt),t=la.prototype,t.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,Ar(this)},t.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||u).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,is(this)),this.readyState=0},t.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Ar(this)),this.g&&(this.readyState=3,Ar(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ja(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ja(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}t.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?is(this):Ar(this),this.readyState==3&&Ja(this)}},t.Oa=function(h){this.g&&(this.response=this.responseText=h,is(this))},t.Na=function(h){this.g&&(this.response=h,is(this))},t.ga=function(){this.g&&is(this)};function is(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Ar(h)}t.setRequestHeader=function(h,b){this.A.append(h,b)},t.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var S=b.next();!S.done;)S=S.value,h.push(S[0]+": "+S[1]),S=b.next();return h.join(`\r
`)};function Ar(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(la.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function lr(h){let b="";return le(h,function(S,V){b+=V,b+=":",b+=S,b+=`\r
`}),b}function ca(h,b,S){e:{for(V in S){var V=!1;break e}V=!0}V||(S=lr(S),typeof h=="string"?S!=null&&gi(S):ct(h,b,S))}function ht(h){lt.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(ht,lt);var Xr=/^https?$/i,Vl=["POST","PUT"];t=ht.prototype,t.Fa=function(h){this.H=h},t.ea=function(h,b,S,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Cl.g(),this.g.onreadystatechange=x(g(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(se){ua(this,se);return}if(h=S||"",S=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var Z in V)S.set(Z,V[Z]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const se of V.keys())S.set(se,V.get(se));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(S.keys()).find(se=>se.toLowerCase()=="content-type"),Z=u.FormData&&h instanceof u.FormData,!(Array.prototype.indexOf.call(Vl,b,void 0)>=0)||V||Z||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[se,Ee]of S)this.g.setRequestHeader(se,Ee);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(se){ua(this,se)}};function ua(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,zl(h),yi(h)}function zl(h){h.A||(h.A=!0,Ne(h,"complete"),Ne(h,"error"))}t.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Ne(this,"complete"),Ne(this,"abort"),yi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yi(this,!0)),ht.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?da(this):this.Xa())},t.Xa=function(){da(this)};function da(h){if(h.h&&typeof l<"u"){if(h.v&&Cr(h)==4)setTimeout(h.Ca.bind(h),0);else if(Ne(h,"readystatechange"),Cr(h)==4){h.h=!1;try{const se=h.ca();e:switch(se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var S;if(!(S=b)){var V;if(V=se===0){let Ee=String(h.D).match(Au)[1]||null;!Ee&&u.self&&u.self.location&&(Ee=u.self.location.protocol.slice(0,-1)),V=!Xr.test(Ee?Ee.toLowerCase():"")}S=V}if(S)Ne(h,"complete"),Ne(h,"success");else{h.o=6;try{var Z=Cr(h)>2?h.g.statusText:""}catch{Z=""}h.l=Z+" ["+h.ca()+"]",zl(h)}}finally{yi(h)}}}}function yi(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const S=h.g;h.g=null,b||Ne(h,"ready");try{S.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Cr(h){return h.g?h.g.readyState:0}t.ca=function(){try{return Cr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),gf(b)}};function pn(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function _i(h){const b={};h=(h.g&&Cr(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<h.length;V++){if(C(h[V]))continue;var S=Su(h[V]);const Z=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const se=b[Z]||[];b[Z]=se,se.push(S)}J(b,function(V){return V.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Jr(h,b,S){return S&&S.internalChannelParams&&S.internalChannelParams[h]||b}function ss(h){this.za=0,this.i=[],this.j=new Er,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Jr("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Jr("baseRetryDelayMs",5e3,h),this.Za=Jr("retryDelaySeedMs",1e4,h),this.Ta=Jr("forwardChannelMaxRetries",2,h),this.va=Jr("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Rl(h&&h.concurrentRequestLimit),this.Ba=new rs,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ss.prototype,t.ka=8,t.I=1,t.connect=function(h,b,S,V){Ft(0),this.W=h,this.H=b||{},S&&V!==void 0&&(this.H.OSID=S,this.H.OAID=V),this.F=this.X,this.J=Lu(this,null,this.W),Zr(this)};function Ul(h){if(Za(h),h.I==3){var b=h.V++,S=Gt(h.J);if(ct(S,"SID",h.M),ct(S,"RID",b),ct(S,"TYPE","terminate"),ha(h,S),b=new Sr(h,h.j,b),b.M=2,b.A=aa(Gt(S)),S=!1,u.navigator&&u.navigator.sendBeacon)try{S=u.navigator.sendBeacon(b.A.toString(),"")}catch{}!S&&u.Image&&(new Image().src=b.A,S=!0),S||(b.g=Vu(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Hr(b)}Pu(h)}function as(h){h.g&&(Fl(h),h.g.cancel(),h.g=null)}function Za(h){as(h),h.v&&(u.clearTimeout(h.v),h.v=null),to(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&u.clearTimeout(h.m),h.m=null)}function Zr(h){if(!Dl(h.h)&&!h.m){h.m=!0;var b=h.Ea;ie||R(),he||(ie(),he=!0),L.add(b,h),h.D=0}}function eo(h,b){return $r(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=Br(g(h.Ea,h,b),Nu(h,h.D)),h.D++,!0)}t.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const Z=new Sr(this,this.j,h);let se=this.o;if(this.U&&(se?(se=z(se),W(se,this.U)):se=this.U),this.u!==null||this.R||(Z.J=se,se=null),this.S)e:{for(var b=0,S=0;S<this.i.length;S++){t:{var V=this.i[S];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(b+=V,b>4096){b=S;break e}if(b===4096||S===this.i.length-1){b=S+1;break e}}b=1e3}else b=1e3;b=ju(this,Z,b),S=Gt(this.J),ct(S,"RID",h),ct(S,"CVER",22),this.G&&ct(S,"X-HTTP-Session-Id",this.G),ha(this,S),se&&(this.R?b="headers="+gi(lr(se))+"&"+b:this.u&&ca(S,this.u,se)),Il(this.h,Z),this.Ra&&ct(S,"TYPE","init"),this.S?(ct(S,"$req",b),ct(S,"SID","null"),Z.U=!0,qr(Z,S,null)):qr(Z,S,b),this.I=2}}else this.I==3&&(h?Bl(this,h):this.i.length==0||Dl(this.h)||Bl(this))};function Bl(h,b){var S;b?S=b.l:S=h.V++;const V=Gt(h.J);ct(V,"SID",h.M),ct(V,"RID",S),ct(V,"AID",h.K),ha(h,V),h.u&&h.o&&ca(V,h.u,h.o),S=new Sr(h,h.j,S,h.D+1),h.u===null&&(S.J=h.o),b&&(h.i=b.G.concat(h.i)),b=ju(h,S,1e3),S.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Il(h.h,S),qr(S,V,b)}function ha(h,b){h.H&&le(h.H,function(S,V){ct(b,V,S)}),h.l&&le({},function(S,V){ct(b,V,S)})}function ju(h,b,S){S=Math.min(h.i.length,S);const V=h.l?g(h.l.Ka,h.l,h):null;e:{var Z=h.i;let qe=-1;for(;;){const Lt=["count="+S];qe==-1?S>0?(qe=Z[0].g,Lt.push("ofs="+qe)):qe=0:Lt.push("ofs="+qe);let st=!0;for(let Tt=0;Tt<S;Tt++){var se=Z[Tt].g;const cr=Z[Tt].map;if(se-=qe,se<0)qe=Math.max(0,Z[Tt].g-100),st=!1;else try{se="req"+se+"_"||"";try{var Ee=cr instanceof Map?cr:Object.entries(cr);for(const[ti,Rr]of Ee){let Dr=Rr;f(Rr)&&(Dr=Ji(Rr)),Lt.push(se+ti+"="+encodeURIComponent(Dr))}}catch(ti){throw Lt.push(se+"type="+encodeURIComponent("_badmap")),ti}}catch{V&&V(cr)}}if(st){Ee=Lt.join("&");break e}}Ee=void 0}return h=h.i.splice(0,S),b.G=h,Ee}function Ou(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;ie||R(),he||(ie(),he=!0),L.add(b,h),h.A=0}}function fa(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=Br(g(h.Da,h),Nu(h,h.A)),h.A++,!0)}t.Da=function(){if(this.v=null,ku(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=Br(g(this.Wa,this),h)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ft(10),as(this),ku(this))};function Fl(h){h.B!=null&&(u.clearTimeout(h.B),h.B=null)}function ku(h){h.g=new Sr(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=Gt(h.na);ct(b,"RID","rpc"),ct(b,"SID",h.M),ct(b,"AID",h.K),ct(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&ct(b,"TO",h.ia),ct(b,"TYPE","xmlhttp"),ha(h,b),h.u&&h.o&&ca(b,h.u,h.o),h.O&&(h.g.H=h.O);var S=h.g;h=h.ba,S.M=1,S.A=aa(Gt(b)),S.u=null,S.R=!0,Qa(S,h)}t.Va=function(){this.C!=null&&(this.C=null,as(this),fa(this),Ft(19))};function to(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function Mu(h,b){var S=null;if(h.g==b){to(h),Fl(h),h.g=null;var V=2}else if(Kr(h.h,b))S=b.G,jl(h.h,b),V=1;else return;if(h.I!=0){if(b.o)if(V==1){S=b.u?b.u.length:0,b=Date.now()-b.F;var Z=h.D;V=Ga(),Ne(V,new Ur(V,S)),Zr(h)}else Ou(h);else if(Z=b.m,Z==3||Z==0&&b.X>0||!(V==1&&eo(h,b)||V==2&&fa(h)))switch(S&&S.length>0&&(b=h.h,b.i=b.i.concat(S)),Z){case 1:ei(h,5);break;case 4:ei(h,10);break;case 3:ei(h,6);break;default:ei(h,2)}}}function Nu(h,b){let S=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(S*=2),S*b}function ei(h,b){if(h.j.info("Error code "+b),b==2){var S=g(h.bb,h),V=h.Ua;const Z=!V;V=new $n(V||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||un(V,"https"),aa(V),Z?Tr(V.toString(),S):Ll(V.toString(),S)}else Ft(2);h.I=0,h.l&&h.l.pa(b),Pu(h),Za(h)}t.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function Pu(h){if(h.I=0,h.ja=[],h.l){const b=Ol(h.h);(b.length!=0||h.i.length!=0)&&(A(h.ja,b),A(h.ja,h.i),h.h.i.length=0,w(h.i),h.i.length=0),h.l.oa()}}function Lu(h,b,S){var V=S instanceof $n?Gt(S):new $n(S);if(V.g!="")b&&(V.g=b+"."+V.g),Zi(V,V.u);else{var Z=u.location;V=Z.protocol,b=b?b+"."+Z.hostname:Z.hostname,Z=+Z.port;const se=new $n(null);V&&un(se,V),b&&(se.g=b),Z&&Zi(se,Z),S&&(se.h=S),V=se}return S=h.G,b=h.wa,S&&b&&ct(V,S,b),ct(V,"VER",h.ka),ha(h,V),V}function Vu(h,b,S){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new ht(new Yr({ab:S})):new ht(h.ma),b.Fa(h.L),b}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function zu(){}t=zu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function os(){}os.prototype.g=function(h,b){return new In(h,b)};function In(h,b){lt.call(this),this.g=new ss(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!C(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!C(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new vi(this)}v(In,lt),In.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},In.prototype.close=function(){Ul(this.g)},In.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var S={};S.__data__=h,h=S}else this.v&&(S={},S.__data__=Ji(h),h=S);b.i.push(new Ht(b.Ya++,h)),b.I==3&&Zr(b)},In.prototype.N=function(){this.g.l=null,delete this.j,Ul(this.g),delete this.g,In.Z.N.call(this)};function Uu(h){mn.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const S in b){h=S;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}v(Uu,mn);function Bu(){sr.call(this),this.status=1}v(Bu,sr);function vi(h){this.g=h}v(vi,zu),vi.prototype.ra=function(){Ne(this.g,"a")},vi.prototype.qa=function(h){Ne(this.g,new Uu(h))},vi.prototype.pa=function(h){Ne(this.g,new Bu)},vi.prototype.oa=function(){Ne(this.g,"b")},os.prototype.createWebChannel=os.prototype.g,In.prototype.send=In.prototype.o,In.prototype.open=In.prototype.m,In.prototype.close=In.prototype.close,VS=function(){return new os},LS=function(){return Ga()},PS=Pt,eg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ia.NO_ERROR=0,ia.TIMEOUT=8,ia.HTTP_ERROR=6,th=ia,Al.COMPLETE="complete",NS=Al,vu.EventType=xr,xr.OPEN="a",xr.CLOSE="b",xr.ERROR="c",xr.MESSAGE="d",lt.prototype.listen=lt.prototype.J,jc=vu,ht.prototype.listenOnce=ht.prototype.K,ht.prototype.getLastError=ht.prototype.Ha,ht.prototype.getLastErrorCode=ht.prototype.ya,ht.prototype.getStatus=ht.prototype.ca,ht.prototype.getResponseJson=ht.prototype.La,ht.prototype.getResponseText=ht.prototype.la,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Fa,MS=ht}).apply(typeof $d<"u"?$d:typeof self<"u"?self:typeof window<"u"?window:{});const Xb="@firebase/firestore",Jb="4.9.3";class An{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}An.UNAUTHENTICATED=new An(null),An.GOOGLE_CREDENTIALS=new An("google-credentials-uid"),An.FIRST_PARTY=new An("first-party-uid"),An.MOCK_USER=new An("mock-user");let fl="12.7.0";const Pa=new Lg("@firebase/firestore");function Po(){return Pa.logLevel}function Ae(t,...e){if(Pa.logLevel<=Je.DEBUG){const n=e.map(Ug);Pa.debug(`Firestore (${fl}): ${t}`,...n)}}function Gi(t,...e){if(Pa.logLevel<=Je.ERROR){const n=e.map(Ug);Pa.error(`Firestore (${fl}): ${t}`,...n)}}function Wo(t,...e){if(Pa.logLevel<=Je.WARN){const n=e.map(Ug);Pa.warn(`Firestore (${fl}): ${t}`,...n)}}function Ug(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function ze(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,zS(t,i,n)}function zS(t,e,n){let i=`FIRESTORE (${fl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Gi(i),new Error(i)}function ot(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||zS(e,a,i)}function Fe(t,e){return t}const _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class we extends Ki{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ui{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class US{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class bj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(An.UNAUTHENTICATED)))}shutdown(){}}class xj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class Ej{constructor(e){this.t=e,this.currentUser=An.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ot(this.o===void 0,42304);let i=this.i;const a=m=>this.i!==i?(i=this.i,n(m)):Promise.resolve();let l=new Ui;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ui,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{Ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ui)}}),0),u()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(Ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ot(typeof i.accessToken=="string",31837,{l:i}),new US(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ot(e===null||typeof e=="string",2055,{h:e}),new An(e)}}class Sj{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=An.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class wj{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new Sj(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(An.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Zb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Tj{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,kr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ot(this.o===void 0,3512);const i=l=>{l.error!=null&&Ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,Ae("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{Ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Zb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(ot(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Zb(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Aj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class Bg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=Aj(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function Ze(t,e){return t<e?-1:t>e?1:0}function tg(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return Cp(a)===Cp(l)?Ze(a,l):Cp(a)?1:-1}return Ze(t.length,e.length)}const Cj=55296,Rj=57343;function Cp(t){const e=t.charCodeAt(0);return e>=Cj&&e<=Rj}function Yo(t,e,n){return t.length===e.length&&t.every(((i,a)=>n(i,e[a])))}const ex="__name__";class ai{constructor(e,n,i){n===void 0?n=0:n>e.length&&ze(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&ze(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return ai.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ai?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=ai.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return Ze(e.length,n.length)}static compareSegments(e,n){const i=ai.isNumericId(e),a=ai.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?ai.extractNumericId(e).compare(ai.extractNumericId(n)):tg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Bs.fromString(e.substring(4,e.length-2))}}class vt extends ai{construct(e,n,i){return new vt(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new we(_e.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((a=>a.length>0)))}return new vt(n)}static emptyPath(){return new vt([])}}const Dj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xn extends ai{construct(e,n,i){return new xn(e,n,i)}static isValidIdentifier(e){return Dj.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ex}static keyField(){return new xn([ex])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new we(_e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let u=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new we(_e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new we(_e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=m,a+=2}else f==="`"?(u=!u,a++):f!=="."||u?(i+=f,a++):(l(),a++)}if(l(),u)throw new we(_e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xn(n)}static emptyPath(){return new xn([])}}class ke{constructor(e){this.path=e}static fromPath(e){return new ke(vt.fromString(e))}static fromName(e){return new ke(vt.fromString(e).popFirst(5))}static empty(){return new ke(vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return vt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ke(new vt(e.slice()))}}function BS(t,e,n){if(!n)throw new we(_e.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Ij(t,e,n,i){if(e===!0&&i===!0)throw new we(_e.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function tx(t){if(!ke.isDocumentKey(t))throw new we(_e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function nx(t){if(ke.isDocumentKey(t))throw new we(_e.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function FS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function qh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ze(12329,{type:typeof t})}function mi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new we(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=qh(t);throw new we(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Zt(t,e){const n={typeString:t};return e&&(n.value=e),n}function su(t,e){if(!FS(t))throw new we(_e.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const u=t[i];if(a&&typeof u!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new we(_e.INVALID_ARGUMENT,n);return!0}const rx=-62135596800,ix=1e6;class St{static now(){return St.fromMillis(Date.now())}static fromDate(e){return St.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*ix);return new St(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new we(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new we(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<rx)throw new we(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new we(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ix}_compareTo(e){return this.seconds===e.seconds?Ze(this.nanoseconds,e.nanoseconds):Ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:St._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(su(e,St._jsonSchema))return new St(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-rx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}St._jsonSchemaVersion="firestore/timestamp/1.0",St._jsonSchema={type:Zt("string",St._jsonSchemaVersion),seconds:Zt("number"),nanoseconds:Zt("number")};class Ue{static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new St(0,0))}static max(){return new Ue(new St(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Hc=-1;function jj(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Ue.fromTimestamp(i===1e9?new St(n+1,0):new St(n,i));return new $s(a,ke.empty(),e)}function Oj(t){return new $s(t.readTime,t.key,Hc)}class $s{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new $s(Ue.min(),ke.empty(),Hc)}static max(){return new $s(Ue.max(),ke.empty(),Hc)}}function kj(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ke.comparator(t.documentKey,e.documentKey),n!==0?n:Ze(t.largestBatchId,e.largestBatchId))}const Mj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Nj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ml(t){if(t.code!==_e.FAILED_PRECONDITION||t.message!==Mj)throw t;Ae("LocalStore","Unexpectedly lost primary lease")}class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ve(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof ve?n:ve.resolve(n)}catch(n){return ve.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):ve.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):ve.reject(n)}static resolve(e){return new ve(((n,i)=>{n(e)}))}static reject(e){return new ve(((n,i)=>{i(e)}))}static waitFor(e){return new ve(((n,i)=>{let a=0,l=0,u=!1;e.forEach((f=>{++a,f.next((()=>{++l,u&&l===a&&n()}),(m=>i(m)))})),u=!0,l===a&&n()}))}static or(e){let n=ve.resolve(!1);for(const i of e)n=n.next((a=>a?ve.resolve(a):i()));return n}static forEach(e,n){const i=[];return e.forEach(((a,l)=>{i.push(n.call(this,a,l))})),this.waitFor(i)}static mapArray(e,n){return new ve(((i,a)=>{const l=e.length,u=new Array(l);let f=0;for(let m=0;m<l;m++){const g=m;n(e[g]).next((_=>{u[g]=_,++f,f===l&&i(u)}),(_=>a(_)))}}))}static doWhile(e,n){return new ve(((i,a)=>{const l=()=>{e()===!0?n().next((()=>{l()}),a):i()};l()}))}}function Pj(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function pl(t){return t.name==="IndexedDbTransactionError"}class Hh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Hh.ce=-1;const Fg=-1;function Gh(t){return t==null}function _h(t){return t===0&&1/t==-1/0}function Lj(t){return typeof t=="number"&&Number.isInteger(t)&&!_h(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const qS="";function Vj(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=sx(e)),e=zj(t.get(n),e);return sx(e)}function zj(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case qS:n+="";break;default:n+=l}}return n}function sx(t){return t+qS+""}function ax(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function HS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class It{constructor(e,n){this.comparator=e,this.root=n||bn.EMPTY}insert(e,n){return new It(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,bn.BLACK,null,null))}remove(e){return new It(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Kd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Kd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Kd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Kd(this.root,e,this.comparator,!0)}}class Kd{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class bn{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??bn.RED,this.left=a??bn.EMPTY,this.right=l??bn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new bn(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return bn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return bn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,bn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,bn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ze(27949);return e+(this.isRed()?0:1)}}bn.EMPTY=null,bn.RED=!0,bn.BLACK=!1;bn.EMPTY=new class{constructor(){this.size=0}get key(){throw ze(57766)}get value(){throw ze(16141)}get color(){throw ze(16727)}get left(){throw ze(29726)}get right(){throw ze(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new bn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class an{constructor(e){this.comparator=e,this.data=new It(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ox(this.data.getIterator())}getIteratorFrom(e){return new ox(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof an)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new an(this.comparator);return n.data=e,n}}class ox{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class tr{constructor(e){this.fields=e,e.sort(xn.comparator)}static empty(){return new tr([])}unionWith(e){let n=new an(xn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new tr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Yo(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class GS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class En{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new GS("Invalid base64 string: "+l):l}})(e);return new En(n)}static fromUint8Array(e){const n=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new En(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}En.EMPTY_BYTE_STRING=new En("");const Uj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ks(t){if(ot(!!t,39018),typeof t=="string"){let e=0;const n=Uj.exec(t);if(ot(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ut(t.seconds),nanos:Ut(t.nanos)}}function Ut(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ws(t){return typeof t=="string"?En.fromBase64String(t):En.fromUint8Array(t)}const QS="server_timestamp",$S="__type__",KS="__previous_value__",WS="__local_write_time__";function qg(t){return(t?.mapValue?.fields||{})[$S]?.stringValue===QS}function Qh(t){const e=t.mapValue.fields[KS];return qg(e)?Qh(e):e}function Gc(t){const e=Ks(t.mapValue.fields[WS].timestampValue);return new St(e.seconds,e.nanos)}class Bj{constructor(e,n,i,a,l,u,f,m,g,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=g,this.isUsingEmulator=_}}const vh="(default)";class Qc{constructor(e,n){this.projectId=e,this.database=n||vh}static empty(){return new Qc("","")}get isDefaultDatabase(){return this.database===vh}isEqual(e){return e instanceof Qc&&e.projectId===this.projectId&&e.database===this.database}}const YS="__type__",Fj="__max__",Wd={mapValue:{}},XS="__vector__",bh="value";function Ys(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qg(t)?4:Hj(t)?9007199254740991:qj(t)?10:11:ze(28295,{value:t})}function pi(t,e){if(t===e)return!0;const n=Ys(t);if(n!==Ys(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Gc(t).isEqual(Gc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=Ks(a.timestampValue),f=Ks(l.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return Ws(a.bytesValue).isEqual(Ws(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return Ut(a.geoPointValue.latitude)===Ut(l.geoPointValue.latitude)&&Ut(a.geoPointValue.longitude)===Ut(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Ut(a.integerValue)===Ut(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Ut(a.doubleValue),f=Ut(l.doubleValue);return u===f?_h(u)===_h(f):isNaN(u)&&isNaN(f)}return!1})(t,e);case 9:return Yo(t.arrayValue.values||[],e.arrayValue.values||[],pi);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},f=l.mapValue.fields||{};if(ax(u)!==ax(f))return!1;for(const m in u)if(u.hasOwnProperty(m)&&(f[m]===void 0||!pi(u[m],f[m])))return!1;return!0})(t,e);default:return ze(52216,{left:t})}}function $c(t,e){return(t.values||[]).find((n=>pi(n,e)))!==void 0}function Xo(t,e){if(t===e)return 0;const n=Ys(t),i=Ys(e);if(n!==i)return Ze(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ze(t.booleanValue,e.booleanValue);case 2:return(function(l,u){const f=Ut(l.integerValue||l.doubleValue),m=Ut(u.integerValue||u.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(t,e);case 3:return lx(t.timestampValue,e.timestampValue);case 4:return lx(Gc(t),Gc(e));case 5:return tg(t.stringValue,e.stringValue);case 6:return(function(l,u){const f=Ws(l),m=Ws(u);return f.compareTo(m)})(t.bytesValue,e.bytesValue);case 7:return(function(l,u){const f=l.split("/"),m=u.split("/");for(let g=0;g<f.length&&g<m.length;g++){const _=Ze(f[g],m[g]);if(_!==0)return _}return Ze(f.length,m.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,u){const f=Ze(Ut(l.latitude),Ut(u.latitude));return f!==0?f:Ze(Ut(l.longitude),Ut(u.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return cx(t.arrayValue,e.arrayValue);case 10:return(function(l,u){const f=l.fields||{},m=u.fields||{},g=f[bh]?.arrayValue,_=m[bh]?.arrayValue,v=Ze(g?.values?.length||0,_?.values?.length||0);return v!==0?v:cx(g,_)})(t.mapValue,e.mapValue);case 11:return(function(l,u){if(l===Wd.mapValue&&u===Wd.mapValue)return 0;if(l===Wd.mapValue)return 1;if(u===Wd.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),g=u.fields||{},_=Object.keys(g);m.sort(),_.sort();for(let v=0;v<m.length&&v<_.length;++v){const x=tg(m[v],_[v]);if(x!==0)return x;const w=Xo(f[m[v]],g[_[v]]);if(w!==0)return w}return Ze(m.length,_.length)})(t.mapValue,e.mapValue);default:throw ze(23264,{he:n})}}function lx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ze(t,e);const n=Ks(t),i=Ks(e),a=Ze(n.seconds,i.seconds);return a!==0?a:Ze(n.nanos,i.nanos)}function cx(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=Xo(n[a],i[a]);if(l)return l}return Ze(n.length,i.length)}function Jo(t){return ng(t)}function ng(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=Ks(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Ws(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return ke.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=ng(l);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const u of i)l?l=!1:a+=",",a+=`${u}:${ng(n.fields[u])}`;return a+"}"})(t.mapValue):ze(61005,{value:t})}function nh(t){switch(Ys(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Qh(t);return e?16+nh(e):16;case 5:return 2*t.stringValue.length;case 6:return Ws(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+nh(l)),0)})(t.arrayValue);case 10:case 11:return(function(i){let a=0;return Zs(i.fields,((l,u)=>{a+=l.length+nh(u)})),a})(t.mapValue);default:throw ze(13486,{value:t})}}function ux(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function rg(t){return!!t&&"integerValue"in t}function Hg(t){return!!t&&"arrayValue"in t}function dx(t){return!!t&&"nullValue"in t}function hx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rh(t){return!!t&&"mapValue"in t}function qj(t){return(t?.mapValue?.fields||{})[YS]?.stringValue===XS}function Pc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Zs(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=Pc(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Pc(t.arrayValue.values[n]);return e}return{...t}}function Hj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Fj}class Fn{constructor(e){this.value=e}static empty(){return new Fn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!rh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pc(n)}setAll(e){let n=xn.emptyPath(),i={},a=[];e.forEach(((u,f)=>{if(!n.isImmediateParentOf(f)){const m=this.getFieldsMap(n);this.applyChanges(m,i,a),i={},a=[],n=f.popLast()}u?i[f.lastSegment()]=Pc(u):a.push(f.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());rh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return pi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];rh(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){Zs(n,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new Fn(Pc(this.value))}}function JS(t){const e=[];return Zs(t.fields,((n,i)=>{const a=new xn([n]);if(rh(i)){const l=JS(i.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new tr(e)}class Cn{constructor(e,n,i,a,l,u,f){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=u,this.documentState=f}static newInvalidDocument(e){return new Cn(e,0,Ue.min(),Ue.min(),Ue.min(),Fn.empty(),0)}static newFoundDocument(e,n,i,a){return new Cn(e,1,n,Ue.min(),i,a,0)}static newNoDocument(e,n){return new Cn(e,2,n,Ue.min(),Ue.min(),Fn.empty(),0)}static newUnknownDocument(e,n){return new Cn(e,3,n,Ue.min(),Ue.min(),Fn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Cn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Cn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class xh{constructor(e,n){this.position=e,this.inclusive=n}}function fx(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],u=t.position[a];if(l.field.isKeyField()?i=ke.comparator(ke.fromName(u.referenceValue),n.key):i=Xo(u,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function mx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!pi(t.position[n],e.position[n]))return!1;return!0}class Eh{constructor(e,n="asc"){this.field=e,this.dir=n}}function Gj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class ZS{}class Jt extends ZS{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new $j(e,n,i):n==="array-contains"?new Yj(e,i):n==="in"?new Xj(e,i):n==="not-in"?new Jj(e,i):n==="array-contains-any"?new Zj(e,i):new Jt(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new Kj(e,i):new Wj(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Xo(n,this.value)):n!==null&&Ys(this.value)===Ys(n)&&this.matchesComparison(Xo(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Lr extends ZS{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Lr(e,n)}matches(e){return ew(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ew(t){return t.op==="and"}function tw(t){return Qj(t)&&ew(t)}function Qj(t){for(const e of t.filters)if(e instanceof Lr)return!1;return!0}function ig(t){if(t instanceof Jt)return t.field.canonicalString()+t.op.toString()+Jo(t.value);if(tw(t))return t.filters.map((e=>ig(e))).join(",");{const e=t.filters.map((n=>ig(n))).join(",");return`${t.op}(${e})`}}function nw(t,e){return t instanceof Jt?(function(i,a){return a instanceof Jt&&i.op===a.op&&i.field.isEqual(a.field)&&pi(i.value,a.value)})(t,e):t instanceof Lr?(function(i,a){return a instanceof Lr&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,u,f)=>l&&nw(u,a.filters[f])),!0):!1})(t,e):void ze(19439)}function rw(t){return t instanceof Jt?(function(n){return`${n.field.canonicalString()} ${n.op} ${Jo(n.value)}`})(t):t instanceof Lr?(function(n){return n.op.toString()+" {"+n.getFilters().map(rw).join(" ,")+"}"})(t):"Filter"}class $j extends Jt{constructor(e,n,i){super(e,n,i),this.key=ke.fromName(i.referenceValue)}matches(e){const n=ke.comparator(e.key,this.key);return this.matchesComparison(n)}}class Kj extends Jt{constructor(e,n){super(e,"in",n),this.keys=iw("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class Wj extends Jt{constructor(e,n){super(e,"not-in",n),this.keys=iw("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function iw(t,e){return(e.arrayValue?.values||[]).map((n=>ke.fromName(n.referenceValue)))}class Yj extends Jt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Hg(n)&&$c(n.arrayValue,this.value)}}class Xj extends Jt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&$c(this.value.arrayValue,n)}}class Jj extends Jt{constructor(e,n){super(e,"not-in",n)}matches(e){if($c(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!$c(this.value.arrayValue,n)}}class Zj extends Jt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Hg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>$c(this.value.arrayValue,i)))}}class e2{constructor(e,n=null,i=[],a=[],l=null,u=null,f=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=u,this.endAt=f,this.Te=null}}function px(t,e=null,n=[],i=[],a=null,l=null,u=null){return new e2(t,e,n,i,a,l,u)}function Gg(t){const e=Fe(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>ig(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),Gh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>Jo(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>Jo(i))).join(",")),e.Te=n}return e.Te}function Qg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Gj(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!nw(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!mx(t.startAt,e.startAt)&&mx(t.endAt,e.endAt)}function sg(t){return ke.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class au{constructor(e,n=null,i=[],a=[],l=null,u="F",f=null,m=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=u,this.startAt=f,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function t2(t,e,n,i,a,l,u,f){return new au(t,e,n,i,a,l,u,f)}function $g(t){return new au(t)}function gx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function sw(t){return t.collectionGroup!==null}function Lc(t){const e=Fe(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new an(xn.comparator);return u.filters.forEach((m=>{m.getFlattenedFilters().forEach((g=>{g.isInequality()&&(f=f.add(g.field))}))})),f})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Eh(l,i))})),n.has(xn.keyField().canonicalString())||e.Ie.push(new Eh(xn.keyField(),i))}return e.Ie}function oi(t){const e=Fe(t);return e.Ee||(e.Ee=n2(e,Lc(t))),e.Ee}function n2(t,e){if(t.limitType==="F")return px(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Eh(a.field,l)}));const n=t.endAt?new xh(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new xh(t.startAt.position,t.startAt.inclusive):null;return px(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function ag(t,e){const n=t.filters.concat([e]);return new au(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function og(t,e,n){return new au(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $h(t,e){return Qg(oi(t),oi(e))&&t.limitType===e.limitType}function aw(t){return`${Gg(oi(t))}|lt:${t.limitType}`}function Lo(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((a=>rw(a))).join(", ")}]`),Gh(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((a=>Jo(a))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((a=>Jo(a))).join(",")),`Target(${i})`})(oi(t))}; limitType=${t.limitType})`}function Kh(t,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):ke.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(t,e)&&(function(i,a){for(const l of Lc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(i,a){return!(i.startAt&&!(function(u,f,m){const g=fx(u,f,m);return u.inclusive?g<=0:g<0})(i.startAt,Lc(i),a)||i.endAt&&!(function(u,f,m){const g=fx(u,f,m);return u.inclusive?g>=0:g>0})(i.endAt,Lc(i),a))})(t,e)}function r2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ow(t){return(e,n)=>{let i=!1;for(const a of Lc(t)){const l=i2(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function i2(t,e,n){const i=t.field.isKeyField()?ke.comparator(e.key,n.key):(function(l,u,f){const m=u.data.field(l),g=f.data.field(l);return m!==null&&g!==null?Xo(m,g):ze(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return ze(19790,{direction:t.dir})}}class za{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Zs(this.inner,((n,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return HS(this.inner)}size(){return this.innerSize}}const s2=new It(ke.comparator);function Qi(){return s2}const lw=new It(ke.comparator);function Oc(...t){let e=lw;for(const n of t)e=e.insert(n.key,n);return e}function cw(t){let e=lw;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function ja(){return Vc()}function uw(){return Vc()}function Vc(){return new za((t=>t.toString()),((t,e)=>t.isEqual(e)))}const a2=new It(ke.comparator),o2=new an(ke.comparator);function et(...t){let e=o2;for(const n of t)e=e.add(n);return e}const l2=new an(Ze);function c2(){return l2}function Kg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_h(e)?"-0":e}}function dw(t){return{integerValue:""+t}}function u2(t,e){return Lj(e)?dw(e):Kg(t,e)}class Wh{constructor(){this._=void 0}}function d2(t,e,n){return t instanceof Sh?(function(a,l){const u={fields:{[$S]:{stringValue:QS},[WS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&qg(l)&&(l=Qh(l)),l&&(u.fields[KS]=l),{mapValue:u}})(n,e):t instanceof Zo?fw(t,e):t instanceof Kc?mw(t,e):(function(a,l){const u=hw(a,l),f=yx(u)+yx(a.Ae);return rg(u)&&rg(a.Ae)?dw(f):Kg(a.serializer,f)})(t,e)}function h2(t,e,n){return t instanceof Zo?fw(t,e):t instanceof Kc?mw(t,e):n}function hw(t,e){return t instanceof wh?(function(i){return rg(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Sh extends Wh{}class Zo extends Wh{constructor(e){super(),this.elements=e}}function fw(t,e){const n=pw(e);for(const i of t.elements)n.some((a=>pi(a,i)))||n.push(i);return{arrayValue:{values:n}}}class Kc extends Wh{constructor(e){super(),this.elements=e}}function mw(t,e){let n=pw(e);for(const i of t.elements)n=n.filter((a=>!pi(a,i)));return{arrayValue:{values:n}}}class wh extends Wh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function yx(t){return Ut(t.integerValue||t.doubleValue)}function pw(t){return Hg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class f2{constructor(e,n){this.field=e,this.transform=n}}function m2(t,e){return t.field.isEqual(e.field)&&(function(i,a){return i instanceof Zo&&a instanceof Zo||i instanceof Kc&&a instanceof Kc?Yo(i.elements,a.elements,pi):i instanceof wh&&a instanceof wh?pi(i.Ae,a.Ae):i instanceof Sh&&a instanceof Sh})(t.transform,e.transform)}class p2{constructor(e,n){this.version=e,this.transformResults=n}}class Pr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Pr}static exists(e){return new Pr(void 0,e)}static updateTime(e){return new Pr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ih(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Yh{}function gw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Wg(t.key,Pr.none()):new ou(t.key,t.data,Pr.none());{const n=t.data,i=Fn.empty();let a=new an(xn.comparator);for(let l of e.fields)if(!a.has(l)){let u=n.field(l);u===null&&l.length>1&&(l=l.popLast(),u=n.field(l)),u===null?i.delete(l):i.set(l,u),a=a.add(l)}return new ea(t.key,i,new tr(a.toArray()),Pr.none())}}function g2(t,e,n){t instanceof ou?(function(a,l,u){const f=a.value.clone(),m=vx(a.fieldTransforms,l,u.transformResults);f.setAll(m),l.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(t,e,n):t instanceof ea?(function(a,l,u){if(!ih(a.precondition,l))return void l.convertToUnknownDocument(u.version);const f=vx(a.fieldTransforms,l,u.transformResults),m=l.data;m.setAll(yw(a)),m.setAll(f),l.convertToFoundDocument(u.version,m).setHasCommittedMutations()})(t,e,n):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,n)}function zc(t,e,n,i){return t instanceof ou?(function(l,u,f,m){if(!ih(l.precondition,u))return f;const g=l.value.clone(),_=bx(l.fieldTransforms,m,u);return g.setAll(_),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),null})(t,e,n,i):t instanceof ea?(function(l,u,f,m){if(!ih(l.precondition,u))return f;const g=bx(l.fieldTransforms,m,u),_=u.data;return _.setAll(yw(l)),_.setAll(g),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,n,i):(function(l,u,f){return ih(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f})(t,e,n)}function y2(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=hw(i.transform,a||null);l!=null&&(n===null&&(n=Fn.empty()),n.set(i.field,l))}return n||null}function _x(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&Yo(i,a,((l,u)=>m2(l,u)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ou extends Yh{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ea extends Yh{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function yw(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function vx(t,e,n){const i=new Map;ot(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],u=l.transform,f=e.data.field(l.field);i.set(l.field,h2(u,f,n[a]))}return i}function bx(t,e,n){const i=new Map;for(const a of t){const l=a.transform,u=n.data.field(a.field);i.set(a.field,d2(l,u,e))}return i}class Wg extends Yh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _2 extends Yh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class v2{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&g2(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=zc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=zc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=uw();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let f=this.applyToLocalView(u,l.mutatedFields);f=n.has(a.key)?null:f;const m=gw(u,f);m!==null&&i.set(a.key,m),u.isValidDocument()||u.convertToNoDocument(Ue.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),et())}isEqual(e){return this.batchId===e.batchId&&Yo(this.mutations,e.mutations,((n,i)=>_x(n,i)))&&Yo(this.baseMutations,e.baseMutations,((n,i)=>_x(n,i)))}}class Yg{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){ot(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return a2})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,i[u].version);return new Yg(e,n,i,a)}}class b2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class x2{constructor(e,n){this.count=e,this.unchangedNames=n}}var Xt,nt;function E2(t){switch(t){case _e.OK:return ze(64938);case _e.CANCELLED:case _e.UNKNOWN:case _e.DEADLINE_EXCEEDED:case _e.RESOURCE_EXHAUSTED:case _e.INTERNAL:case _e.UNAVAILABLE:case _e.UNAUTHENTICATED:return!1;case _e.INVALID_ARGUMENT:case _e.NOT_FOUND:case _e.ALREADY_EXISTS:case _e.PERMISSION_DENIED:case _e.FAILED_PRECONDITION:case _e.ABORTED:case _e.OUT_OF_RANGE:case _e.UNIMPLEMENTED:case _e.DATA_LOSS:return!0;default:return ze(15467,{code:t})}}function _w(t){if(t===void 0)return Gi("GRPC error has no .code"),_e.UNKNOWN;switch(t){case Xt.OK:return _e.OK;case Xt.CANCELLED:return _e.CANCELLED;case Xt.UNKNOWN:return _e.UNKNOWN;case Xt.DEADLINE_EXCEEDED:return _e.DEADLINE_EXCEEDED;case Xt.RESOURCE_EXHAUSTED:return _e.RESOURCE_EXHAUSTED;case Xt.INTERNAL:return _e.INTERNAL;case Xt.UNAVAILABLE:return _e.UNAVAILABLE;case Xt.UNAUTHENTICATED:return _e.UNAUTHENTICATED;case Xt.INVALID_ARGUMENT:return _e.INVALID_ARGUMENT;case Xt.NOT_FOUND:return _e.NOT_FOUND;case Xt.ALREADY_EXISTS:return _e.ALREADY_EXISTS;case Xt.PERMISSION_DENIED:return _e.PERMISSION_DENIED;case Xt.FAILED_PRECONDITION:return _e.FAILED_PRECONDITION;case Xt.ABORTED:return _e.ABORTED;case Xt.OUT_OF_RANGE:return _e.OUT_OF_RANGE;case Xt.UNIMPLEMENTED:return _e.UNIMPLEMENTED;case Xt.DATA_LOSS:return _e.DATA_LOSS;default:return ze(39323,{code:t})}}(nt=Xt||(Xt={}))[nt.OK=0]="OK",nt[nt.CANCELLED=1]="CANCELLED",nt[nt.UNKNOWN=2]="UNKNOWN",nt[nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nt[nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nt[nt.NOT_FOUND=5]="NOT_FOUND",nt[nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",nt[nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",nt[nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",nt[nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nt[nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nt[nt.ABORTED=10]="ABORTED",nt[nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",nt[nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",nt[nt.INTERNAL=13]="INTERNAL",nt[nt.UNAVAILABLE=14]="UNAVAILABLE",nt[nt.DATA_LOSS=15]="DATA_LOSS";function S2(){return new TextEncoder}const w2=new Bs([4294967295,4294967295],0);function xx(t){const e=S2().encode(t),n=new kS;return n.update(e),new Uint8Array(n.digest())}function Ex(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Bs([n,i],0),new Bs([a,l],0)]}class Xg{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new kc(`Invalid padding: ${n}`);if(i<0)throw new kc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new kc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new kc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Bs.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(Bs.fromNumber(i)));return a.compare(w2)===1&&(a=new Bs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=xx(e),[i,a]=Ex(n);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);if(!this.we(u))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Xg(l,a,n);return i.forEach((f=>u.insert(f))),u}insert(e){if(this.ge===0)return;const n=xx(e),[i,a]=Ex(n);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);this.Se(u)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class kc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Xh{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,lu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new Xh(Ue.min(),a,new It(Ze),Qi(),et())}}class lu{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new lu(i,n,et(),et(),et())}}class sh{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class vw{constructor(e,n){this.targetId=e,this.Ce=n}}class bw{constructor(e,n,i=En.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class Sx{constructor(){this.ve=0,this.Fe=wx(),this.Me=En.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=et(),n=et(),i=et();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:ze(38017,{changeType:l})}})),new lu(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=wx()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ot(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class T2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Qi(),this.Je=Yd(),this.He=Yd(),this.Ye=new It(Ze)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:ze(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(sg(l))if(i===0){const u=new ke(l.path);this.et(n,u,Cn.newNoDocument(u,Ue.min()))}else ot(i===1,20013,{expectedCount:i});else{const u=this._t(n);if(u!==i){const f=this.ut(e),m=f?this.ct(f,e,u):1;if(m!==0){this.it(n);const g=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,g)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let u,f;try{u=Ws(i).toUint8Array()}catch(m){if(m instanceof GS)return Wo("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new Xg(u,a,l)}catch(m){return Wo(m instanceof kc?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.ge===0?null:f}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach((l=>{const u=this.Ge.ht(),f=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.et(n,l,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((l,u)=>{const f=this.ot(u);if(f){if(l.current&&sg(f.target)){const m=new ke(f.target.path);this.It(m).has(u)||this.Et(u,m)||this.et(u,m,Cn.newNoDocument(m,e))}l.Be&&(n.set(u,l.ke()),l.qe())}}));let i=et();this.He.forEach(((l,u)=>{let f=!0;u.forEachWhile((m=>{const g=this.ot(m);return!g||g.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new Xh(e,n,this.Ye,this.je,i);return this.je=Qi(),this.Je=Yd(),this.He=Yd(),this.Ye=new It(Ze),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Sx,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new an(Ze),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new an(Ze),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ae("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Sx),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Yd(){return new It(ke.comparator)}function wx(){return new It(ke.comparator)}const A2={asc:"ASCENDING",desc:"DESCENDING"},C2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},R2={and:"AND",or:"OR"};class D2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function lg(t,e){return t.useProto3Json||Gh(e)?e:{value:e}}function Th(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function I2(t,e){return Th(t,e.toTimestamp())}function li(t){return ot(!!t,49232),Ue.fromTimestamp((function(n){const i=Ks(n);return new St(i.seconds,i.nanos)})(t))}function Jg(t,e){return cg(t,e).canonicalString()}function cg(t,e){const n=(function(a){return new vt(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function Ew(t){const e=vt.fromString(t);return ot(Cw(e),10190,{key:e.toString()}),e}function ug(t,e){return Jg(t.databaseId,e.path)}function Rp(t,e){const n=Ew(e);if(n.get(1)!==t.databaseId.projectId)throw new we(_e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new we(_e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ke(ww(n))}function Sw(t,e){return Jg(t.databaseId,e)}function j2(t){const e=Ew(t);return e.length===4?vt.emptyPath():ww(e)}function dg(t){return new vt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ww(t){return ot(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Tx(t,e,n){return{name:ug(t,e),fields:n.value.mapValue.fields}}function O2(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:ze(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(g,_){return g.useProto3Json?(ot(_===void 0||typeof _=="string",58123),En.fromBase64String(_||"")):(ot(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),En.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&(function(g){const _=g.code===void 0?_e.UNKNOWN:_w(g.code);return new we(_,g.message||"")})(u);n=new bw(i,a,l,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Rp(t,i.document.name),l=li(i.document.updateTime),u=i.document.createTime?li(i.document.createTime):Ue.min(),f=new Fn({mapValue:{fields:i.document.fields}}),m=Cn.newFoundDocument(a,l,u,f),g=i.targetIds||[],_=i.removedTargetIds||[];n=new sh(g,_,m.key,m)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Rp(t,i.document),l=i.readTime?li(i.readTime):Ue.min(),u=Cn.newNoDocument(a,l),f=i.removedTargetIds||[];n=new sh([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Rp(t,i.document),l=i.removedTargetIds||[];n=new sh([],l,a,null)}else{if(!("filter"in e))return ze(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,u=new x2(a,l),f=i.targetId;n=new vw(f,u)}}return n}function k2(t,e){let n;if(e instanceof ou)n={update:Tx(t,e.key,e.value)};else if(e instanceof Wg)n={delete:ug(t,e.key)};else if(e instanceof ea)n={update:Tx(t,e.key,e.data),updateMask:F2(e.fieldMask)};else{if(!(e instanceof _2))return ze(16599,{Vt:e.type});n={verify:ug(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const f=u.transform;if(f instanceof Sh)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Zo)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Kc)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof wh)return{fieldPath:u.field.canonicalString(),increment:f.Ae};throw ze(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:I2(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:ze(27497)})(t,e.precondition)),n}function M2(t,e){return t&&t.length>0?(ot(e!==void 0,14353),t.map((n=>(function(a,l){let u=a.updateTime?li(a.updateTime):li(l);return u.isEqual(Ue.min())&&(u=li(l)),new p2(u,a.transformResults||[])})(n,e)))):[]}function N2(t,e){return{documents:[Sw(t,e.path)]}}function P2(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Sw(t,a);const l=(function(g){if(g.length!==0)return Aw(Lr.create(g,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const u=(function(g){if(g.length!==0)return g.map((_=>(function(x){return{field:Vo(x.field),direction:z2(x.dir)}})(_)))})(e.orderBy);u&&(n.structuredQuery.orderBy=u);const f=lg(t,e.limit);return f!==null&&(n.structuredQuery.limit=f),e.startAt&&(n.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:n,parent:a}}function L2(t){let e=j2(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){ot(i===1,65062);const _=n.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(v){const x=Tw(v);return x instanceof Lr&&tw(x)?x.getFilters():[x]})(n.where));let u=[];n.orderBy&&(u=(function(v){return v.map((x=>(function(A){return new Eh(zo(A.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(A.direction))})(x)))})(n.orderBy));let f=null;n.limit&&(f=(function(v){let x;return x=typeof v=="object"?v.value:v,Gh(x)?null:x})(n.limit));let m=null;n.startAt&&(m=(function(v){const x=!!v.before,w=v.values||[];return new xh(w,x)})(n.startAt));let g=null;return n.endAt&&(g=(function(v){const x=!v.before,w=v.values||[];return new xh(w,x)})(n.endAt)),t2(e,a,u,l,f,"F",m,g)}function V2(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ze(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Tw(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=zo(n.unaryFilter.field);return Jt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=zo(n.unaryFilter.field);return Jt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=zo(n.unaryFilter.field);return Jt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=zo(n.unaryFilter.field);return Jt.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ze(61313);default:return ze(60726)}})(t):t.fieldFilter!==void 0?(function(n){return Jt.create(zo(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ze(58110);default:return ze(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Lr.create(n.compositeFilter.filters.map((i=>Tw(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ze(1026)}})(n.compositeFilter.op))})(t):ze(30097,{filter:t})}function z2(t){return A2[t]}function U2(t){return C2[t]}function B2(t){return R2[t]}function Vo(t){return{fieldPath:t.canonicalString()}}function zo(t){return xn.fromServerFormat(t.fieldPath)}function Aw(t){return t instanceof Jt?(function(n){if(n.op==="=="){if(hx(n.value))return{unaryFilter:{field:Vo(n.field),op:"IS_NAN"}};if(dx(n.value))return{unaryFilter:{field:Vo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(hx(n.value))return{unaryFilter:{field:Vo(n.field),op:"IS_NOT_NAN"}};if(dx(n.value))return{unaryFilter:{field:Vo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vo(n.field),op:U2(n.op),value:n.value}}})(t):t instanceof Lr?(function(n){const i=n.getFilters().map((a=>Aw(a)));return i.length===1?i[0]:{compositeFilter:{op:B2(n.op),filters:i}}})(t):ze(54877,{filter:t})}function F2(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function Cw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Ps{constructor(e,n,i,a,l=Ue.min(),u=Ue.min(),f=En.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Ps(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class q2{constructor(e){this.yt=e}}function H2(t){const e=L2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?og(e,e.limit,"L"):e}class G2{constructor(){this.Cn=new Q2}addToCollectionParentIndex(e,n){return this.Cn.add(n),ve.resolve()}getCollectionParents(e,n){return ve.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ve.resolve()}deleteFieldIndex(e,n){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,n){return ve.resolve()}getDocumentsMatchingTarget(e,n){return ve.resolve(null)}getIndexType(e,n){return ve.resolve(0)}getFieldIndexes(e,n){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,n){return ve.resolve($s.min())}getMinOffsetFromCollectionGroup(e,n){return ve.resolve($s.min())}updateCollectionGroup(e,n,i){return ve.resolve()}updateIndexEntries(e,n){return ve.resolve()}}class Q2{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new an(vt.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new an(vt.comparator)).toArray()}}const Ax={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Rw=41943040;class Bn{static withCacheSize(e){return new Bn(e,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}Bn.DEFAULT_COLLECTION_PERCENTILE=10,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bn.DEFAULT=new Bn(Rw,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bn.DISABLED=new Bn(-1,0,0);class el{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new el(0)}static cr(){return new el(-1)}}const Cx="LruGarbageCollector",$2=1048576;function Rx([t,e],[n,i]){const a=Ze(t,n);return a===0?Ze(e,i):a}class K2{constructor(e){this.Ir=e,this.buffer=new an(Rx),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Rx(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class W2{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ae(Cx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){pl(n)?Ae(Cx,"Ignoring IndexedDB error during garbage collection: ",n):await ml(n)}await this.Vr(3e5)}))}}class Y2{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return ve.resolve(Hh.ce);const i=new K2(n);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ae("LruGarbageCollector","Garbage collection skipped; disabled"),ve.resolve(Ax)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ax):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,u,f,m,g;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,u=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(i=v,f=Date.now(),this.removeTargets(e,i,n)))).next((v=>(l=v,m=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(g=Date.now(),Po()<=Je.DEBUG&&Ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${a} in `+(f-u)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${v} documents in `+(g-m)+`ms
Total Duration: ${g-_}ms`),ve.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:v}))))}}function X2(t,e){return new Y2(t,e)}class J2{constructor(){this.changes=new za((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Cn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?ve.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Z2{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class e5{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(i!==null&&zc(i.mutation,a,tr.empty(),St.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,et()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=et()){const a=ja();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,i).next((l=>{let u=Oc();return l.forEach(((f,m)=>{u=u.insert(f,m.overlayedDocument)})),u}))))}getOverlayedDocuments(e,n){const i=ja();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,et())))}populateOverlays(e,n,i){const a=[];return i.forEach((l=>{n.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,f)=>{n.set(u,f)}))}))}computeViews(e,n,i,a){let l=Qi();const u=Vc(),f=(function(){return Vc()})();return n.forEach(((m,g)=>{const _=i.get(g.key);a.has(g.key)&&(_===void 0||_.mutation instanceof ea)?l=l.insert(g.key,g):_!==void 0?(u.set(g.key,_.mutation.getFieldMask()),zc(_.mutation,g,_.mutation.getFieldMask(),St.now())):u.set(g.key,tr.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((g,_)=>u.set(g,_))),n.forEach(((g,_)=>f.set(g,new Z2(_,u.get(g)??null)))),f)))}recalculateAndSaveOverlays(e,n){const i=Vc();let a=new It(((u,f)=>u-f)),l=et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((u=>{for(const f of u)f.keys().forEach((m=>{const g=n.get(m);if(g===null)return;let _=i.get(m)||tr.empty();_=f.applyToLocalView(g,_),i.set(m,_);const v=(a.get(f.batchId)||et()).add(m);a=a.insert(f.batchId,v)}))})).next((()=>{const u=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),g=m.key,_=m.value,v=uw();_.forEach((x=>{if(!l.has(x)){const w=gw(n.get(x),i.get(x));w!==null&&v.set(x,w),l=l.add(x)}})),u.push(this.documentOverlayCache.saveOverlays(e,g,v))}return ve.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,a){return(function(u){return ke.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):sw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):ve.resolve(ja());let f=Hc,m=l;return u.next((g=>ve.forEach(g,((_,v)=>(f<v.largestBatchId&&(f=v.largestBatchId),l.get(_)?ve.resolve():this.remoteDocumentCache.getEntry(e,_).next((x=>{m=m.insert(_,x)}))))).next((()=>this.populateOverlays(e,g,l))).next((()=>this.computeViews(e,m,g,et()))).next((_=>({batchId:f,changes:cw(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ke(n)).next((i=>{let a=Oc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let u=Oc();return this.indexManager.getCollectionParents(e,l).next((f=>ve.forEach(f,(m=>{const g=(function(v,x){return new au(x,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,g,i,a).next((_=>{_.forEach(((v,x)=>{u=u.insert(v,x)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a)))).next((u=>{l.forEach(((m,g)=>{const _=g.getKey();u.get(_)===null&&(u=u.insert(_,Cn.newInvalidDocument(_)))}));let f=Oc();return u.forEach(((m,g)=>{const _=l.get(m);_!==void 0&&zc(_.mutation,g,tr.empty(),St.now()),Kh(n,g)&&(f=f.insert(m,g))})),f}))}}class t5{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return ve.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:li(a.createTime)}})(n)),ve.resolve()}getNamedQuery(e,n){return ve.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:H2(a.bundledQuery),readTime:li(a.readTime)}})(n)),ve.resolve()}}class n5{constructor(){this.overlays=new It(ke.comparator),this.qr=new Map}getOverlay(e,n){return ve.resolve(this.overlays.get(n))}getOverlays(e,n){const i=ja();return ve.forEach(n,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((a,l)=>{this.St(e,n,l)})),ve.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),ve.resolve()}getOverlaysForCollection(e,n,i){const a=ja(),l=n.length+1,u=new ke(n.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const m=f.getNext().value,g=m.getKey();if(!n.isPrefixOf(g.path))break;g.path.length===l&&m.largestBatchId>i&&a.set(m.getKey(),m)}return ve.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new It(((g,_)=>g-_));const u=this.overlays.getIterator();for(;u.hasNext();){const g=u.getNext().value;if(g.getKey().getCollectionGroup()===n&&g.largestBatchId>i){let _=l.get(g.largestBatchId);_===null&&(_=ja(),l=l.insert(g.largestBatchId,_)),_.set(g.getKey(),g)}}const f=ja(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((g,_)=>f.set(g,_))),!(f.size()>=a)););return ve.resolve(f)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const u=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new b2(n,i));let l=this.qr.get(n);l===void 0&&(l=et(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}class r5{constructor(){this.sessionToken=En.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ve.resolve()}}class Zg{constructor(){this.Qr=new an(hn.$r),this.Ur=new an(hn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new hn(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new hn(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new ke(new vt([])),i=new hn(n,e),a=new hn(n,e+1),l=[];return this.Ur.forEachInRange([i,a],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ke(new vt([])),i=new hn(n,e),a=new hn(n,e+1);let l=et();return this.Ur.forEachInRange([i,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const n=new hn(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class hn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ke.comparator(e.key,n.key)||Ze(e.Yr,n.Yr)}static Kr(e,n){return Ze(e.Yr,n.Yr)||ke.comparator(e.key,n.key)}}class i5{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new an(hn.$r)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new v2(l,n,i,a);this.mutationQueue.push(u);for(const f of a)this.Zr=this.Zr.add(new hn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ve.resolve(u)}lookupMutationBatch(e,n){return ve.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return ve.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?Fg:this.tr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new hn(n,0),a=new hn(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(u=>{const f=this.Xr(u.Yr);l.push(f)})),ve.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new an(Ze);return n.forEach((a=>{const l=new hn(a,0),u=new hn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(f=>{i=i.add(f.Yr)}))})),ve.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;ke.isDocumentKey(l)||(l=l.child(""));const u=new hn(new ke(l),0);let f=new an(Ze);return this.Zr.forEachWhile((m=>{const g=m.key.path;return!!i.isPrefixOf(g)&&(g.length===a&&(f=f.add(m.Yr)),!0)}),u),ve.resolve(this.ti(f))}ti(e){const n=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){ot(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ve.forEach(n.mutations,(a=>{const l=new hn(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new hn(n,0),a=this.Zr.firstAfterOrEqual(i);return ve.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class s5{constructor(e){this.ri=e,this.docs=(function(){return new It(ke.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,u=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return ve.resolve(i?i.document.mutableCopy():Cn.newInvalidDocument(n))}getEntries(e,n){let i=Qi();return n.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():Cn.newInvalidDocument(a))})),ve.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=Qi();const u=n.path,f=new ke(u.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:g,value:{document:_}}=m.getNext();if(!u.isPrefixOf(g.path))break;g.path.length>u.length+1||kj(Oj(_),i)<=0||(a.has(_.key)||Kh(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return ve.resolve(l)}getAllFromCollectionGroup(e,n,i,a){ze(9500)}ii(e,n){return ve.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new a5(this)}getSize(e){return ve.resolve(this.size)}}class a5 extends J2{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),ve.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class o5{constructor(e){this.persistence=e,this.si=new za((n=>Gg(n)),Qg),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this.oi=0,this._i=new Zg,this.targetCount=0,this.ai=el.ur()}forEachTarget(e,n){return this.si.forEach(((i,a)=>n(a))),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),ve.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new el(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,ve.resolve()}updateTargetData(e,n){return this.Pr(n),ve.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach(((u,f)=>{f.sequenceNumber<=n&&i.get(f.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ve.waitFor(l).next((()=>a))}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return ve.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),ve.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),ve.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),ve.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return ve.resolve(i)}containsKey(e,n){return ve.resolve(this._i.containsKey(n))}}class Dw{constructor(e,n){this.ui={},this.overlays={},this.ci=new Hh(0),this.li=!1,this.li=!0,this.hi=new r5,this.referenceDelegate=e(this),this.Pi=new o5(this),this.indexManager=new G2,this.remoteDocumentCache=(function(a){return new s5(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new q2(n),this.Ii=new t5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new n5,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new i5(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){Ae("MemoryPersistence","Starting transaction:",e);const a=new l5(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,n){return ve.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class l5 extends Nj{constructor(e){super(),this.currentSequenceNumber=e}}class ey{constructor(e){this.persistence=e,this.Ri=new Zg,this.Vi=null}static mi(e){return new ey(e)}get fi(){if(this.Vi)return this.Vi;throw ze(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),ve.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),ve.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),ve.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.fi,(i=>{const a=ke.fromPath(i);return this.gi(e,a).next((l=>{l||n.removeEntry(a,Ue.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return ve.or([()=>ve.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Ah{constructor(e,n){this.persistence=e,this.pi=new za((i=>Vj(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=X2(this,n)}static mi(e,n){return new Ah(e,n)}Ei(){}di(e){return ve.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((a=>i+a))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return ve.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?ve.resolve():n(a)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(u=>this.br(e,u,n).next((f=>{f||(i++,l.removeEntry(u,Ue.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),ve.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ve.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),ve.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),ve.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=nh(e.data.value)),n}br(e,n,i){return ve.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return ve.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ty{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=et(),a=et();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new ty(e,n.fromCache,i,a)}}class c5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class u5{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return ZD()?8:Pj(Rn())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,n,a,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new c5;return this.Ss(e,n,u).next((f=>{if(l.result=f,this.Vs)return this.bs(e,n,u,f.size)}))})).next((()=>l.result))}bs(e,n,i,a){return i.documentReadCount<this.fs?(Po()<=Je.DEBUG&&Ae("QueryEngine","SDK will not create cache indexes for query:",Lo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ve.resolve()):(Po()<=Je.DEBUG&&Ae("QueryEngine","Query:",Lo(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(Po()<=Je.DEBUG&&Ae("QueryEngine","The SDK decides to create cache indexes for query:",Lo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,oi(n))):ve.resolve())}ys(e,n){if(gx(n))return ve.resolve(null);let i=oi(n);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=og(n,null,"F"),i=oi(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=et(...l);return this.ps.getDocuments(e,u).next((f=>this.indexManager.getMinOffset(e,i).next((m=>{const g=this.Ds(n,f);return this.Cs(n,g,u,m.readTime)?this.ys(e,og(n,null,"F")):this.vs(e,g,n,m)}))))})))))}ws(e,n,i,a){return gx(n)||a.isEqual(Ue.min())?ve.resolve(null):this.ps.getDocuments(e,i).next((l=>{const u=this.Ds(n,l);return this.Cs(n,u,i,a)?ve.resolve(null):(Po()<=Je.DEBUG&&Ae("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Lo(n)),this.vs(e,u,n,jj(a,Hc)).next((f=>f)))}))}Ds(e,n){let i=new an(ow(e));return n.forEach(((a,l)=>{Kh(e,l)&&(i=i.add(l))})),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return Po()<=Je.DEBUG&&Ae("QueryEngine","Using full collection scan to execute query:",Lo(n)),this.ps.getDocumentsMatchingQuery(e,n,$s.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(n.forEach((u=>{l=l.insert(u.key,u)})),l)))}}const ny="LocalStore",d5=3e8;class h5{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new It(Ze),this.xs=new za((l=>Gg(l)),Qg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new e5(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function f5(t,e,n,i){return new h5(t,e,n,i)}async function Iw(t,e){const n=Fe(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],f=[];let m=et();for(const g of a){u.push(g.batchId);for(const _ of g.mutations)m=m.add(_.key)}for(const g of l){f.push(g.batchId);for(const _ of g.mutations)m=m.add(_.key)}return n.localDocuments.getDocuments(i,m).next((g=>({Ls:g,removedBatchIds:u,addedBatchIds:f})))}))}))}function m5(t,e){const n=Fe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(f,m,g,_){const v=g.batch,x=v.keys();let w=ve.resolve();return x.forEach((A=>{w=w.next((()=>_.getEntry(m,A))).next((I=>{const N=g.docVersions.get(A);ot(N!==null,48541),I.version.compareTo(N)<0&&(v.applyToRemoteDocument(I,g),I.isValidDocument()&&(I.setReadTime(g.commitVersion),_.addEntry(I)))}))})),w.next((()=>f.mutationQueue.removeMutationBatch(m,v)))})(n,i,e,l).next((()=>l.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(f){let m=et();for(let g=0;g<f.mutationResults.length;++g)f.mutationResults[g].transformResults.length>0&&(m=m.add(f.batch.mutations[g].key));return m})(e)))).next((()=>n.localDocuments.getDocuments(i,a)))}))}function jw(t){const e=Fe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function p5(t,e){const n=Fe(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const f=[];e.targetChanges.forEach(((_,v)=>{const x=a.get(v);if(!x)return;f.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,v))));let w=x.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?w=w.withResumeToken(En.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):_.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(_.resumeToken,i)),a=a.insert(v,w),(function(I,N,H){return I.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=d5?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0})(x,w,_)&&f.push(n.Pi.updateTargetData(l,w))}));let m=Qi(),g=et();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&f.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),f.push(g5(l,u,e.documentUpdates).next((_=>{m=_.ks,g=_.qs}))),!i.isEqual(Ue.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));f.push(_)}return ve.waitFor(f).next((()=>u.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,m,g))).next((()=>m))})).then((l=>(n.Ms=a,l)))}function g5(t,e,n){let i=et(),a=et();return n.forEach((l=>i=i.add(l))),e.getEntries(t,i).next((l=>{let u=Qi();return n.forEach(((f,m)=>{const g=l.get(f);m.isFoundDocument()!==g.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(Ue.min())?(e.removeEntry(f,m.readTime),u=u.insert(f,m)):!g.isValidDocument()||m.version.compareTo(g.version)>0||m.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(m),u=u.insert(f,m)):Ae(ny,"Ignoring outdated watch update for ",f,". Current version:",g.version," Watch version:",m.version)})),{ks:u,qs:a}}))}function y5(t,e){const n=Fe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Fg),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function _5(t,e){const n=Fe(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return n.Pi.getTargetData(i,e).next((l=>l?(a=l,ve.resolve(a)):n.Pi.allocateTargetId(i).next((u=>(a=new Ps(e,u,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function hg(t,e,n){const i=Fe(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!pl(u))throw u;Ae(ny,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function Dx(t,e,n){const i=Fe(t);let a=Ue.min(),l=et();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(m,g,_){const v=Fe(m),x=v.xs.get(_);return x!==void 0?ve.resolve(v.Ms.get(x)):v.Pi.getTargetData(g,_)})(i,u,oi(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,f.targetId).next((m=>{l=m}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,n?a:Ue.min(),n?l:et()))).next((f=>(v5(i,r2(e),f),{documents:f,Qs:l})))))}function v5(t,e,n){let i=t.Os.get(e)||Ue.min();n.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),t.Os.set(e,i)}class Ix{constructor(){this.activeTargetIds=c2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class b5{constructor(){this.Mo=new Ix,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ix,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class x5{Oo(e){}shutdown(){}}const jx="ConnectivityMonitor";class Ox{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ae(jx,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ae(jx,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Xd=null;function fg(){return Xd===null?Xd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Xd++,"0x"+Xd.toString(16)}const Dp="RestConnection",E5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class S5{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===vh?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const u=fg(),f=this.zo(e,n.toUriEncodedString());Ae(Dp,`Sending RPC '${e}' ${u}:`,f,i);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,a,l);const{host:g}=new URL(f),_=dl(g);return this.Jo(e,f,m,i,_).then((v=>(Ae(Dp,`Received RPC '${e}' ${u}: `,v),v)),(v=>{throw Wo(Dp,`RPC '${e}' ${u} failed with error: `,v,"url: ",f,"request:",i),v}))}Ho(e,n,i,a,l,u){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+fl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,n){const i=E5[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class w5{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Tn="WebChannelConnection";class T5 extends S5{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const u=fg();return new Promise(((f,m)=>{const g=new MS;g.setWithCredentials(!0),g.listenOnce(NS.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case th.NO_ERROR:const v=g.getResponseJson();Ae(Tn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(v)),f(v);break;case th.TIMEOUT:Ae(Tn,`RPC '${e}' ${u} timed out`),m(new we(_e.DEADLINE_EXCEEDED,"Request time out"));break;case th.HTTP_ERROR:const x=g.getStatus();if(Ae(Tn,`RPC '${e}' ${u} failed with status:`,x,"response text:",g.getResponseText()),x>0){let w=g.getResponseJson();Array.isArray(w)&&(w=w[0]);const A=w?.error;if(A&&A.status&&A.message){const I=(function(H){const $=H.toLowerCase().replace(/_/g,"-");return Object.values(_e).indexOf($)>=0?$:_e.UNKNOWN})(A.status);m(new we(I,A.message))}else m(new we(_e.UNKNOWN,"Server responded with status "+g.getStatus()))}else m(new we(_e.UNAVAILABLE,"Connection failed."));break;default:ze(9055,{l_:e,streamId:u,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Ae(Tn,`RPC '${e}' ${u} completed.`)}}));const _=JSON.stringify(a);Ae(Tn,`RPC '${e}' ${u} sending request:`,a),g.send(n,"POST",_,i,15)}))}T_(e,n,i){const a=fg(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=VS(),f=LS(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(m.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,n,i),m.encodeInitMessageHeaders=!0;const _=l.join("");Ae(Tn,`Creating RPC '${e}' stream ${a}: ${_}`,m);const v=u.createWebChannel(_,m);this.I_(v);let x=!1,w=!1;const A=new w5({Yo:N=>{w?Ae(Tn,`Not sending because RPC '${e}' stream ${a} is closed:`,N):(x||(Ae(Tn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),x=!0),Ae(Tn,`RPC '${e}' stream ${a} sending:`,N),v.send(N))},Zo:()=>v.close()}),I=(N,H,$)=>{N.listen(H,(q=>{try{$(q)}catch(me){setTimeout((()=>{throw me}),0)}}))};return I(v,jc.EventType.OPEN,(()=>{w||(Ae(Tn,`RPC '${e}' stream ${a} transport opened.`),A.o_())})),I(v,jc.EventType.CLOSE,(()=>{w||(w=!0,Ae(Tn,`RPC '${e}' stream ${a} transport closed`),A.a_(),this.E_(v))})),I(v,jc.EventType.ERROR,(N=>{w||(w=!0,Wo(Tn,`RPC '${e}' stream ${a} transport errored. Name:`,N.name,"Message:",N.message),A.a_(new we(_e.UNAVAILABLE,"The operation could not be completed")))})),I(v,jc.EventType.MESSAGE,(N=>{if(!w){const H=N.data[0];ot(!!H,16349);const $=H,q=$?.error||$[0]?.error;if(q){Ae(Tn,`RPC '${e}' stream ${a} received error:`,q);const me=q.status;let ie=(function(R){const D=Xt[R];if(D!==void 0)return _w(D)})(me),he=q.message;ie===void 0&&(ie=_e.INTERNAL,he="Unknown error status: "+me+" with message "+q.message),w=!0,A.a_(new we(ie,he)),v.close()}else Ae(Tn,`RPC '${e}' stream ${a} received:`,H),A.u_(H)}})),I(f,PS.STAT_EVENT,(N=>{N.stat===eg.PROXY?Ae(Tn,`RPC '${e}' stream ${a} detected buffering proxy`):N.stat===eg.NOPROXY&&Ae(Tn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{A.__()}),0),A}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function Ip(){return typeof document<"u"?document:null}function Jh(t){return new D2(t,!0)}class Ow{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&Ae("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const kx="PersistentStream";class kw{constructor(e,n,i,a,l,u,f,m){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ow(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===_e.RESOURCE_EXHAUSTED?(Gi(n.toString()),Gi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===_e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===n&&this.G_(i,a)}),(i=>{e((()=>{const a=new we(_e.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ae(kx,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Ae(kx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class A5 extends kw{constructor(e,n,i,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,u),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=O2(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Ue.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Ue.min():u.readTime?li(u.readTime):Ue.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=dg(this.serializer),n.addTarget=(function(l,u){let f;const m=u.target;if(f=sg(m)?{documents:N2(l,m)}:{query:P2(l,m).ft},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=xw(l,u.resumeToken);const g=lg(l,u.expectedCount);g!==null&&(f.expectedCount=g)}else if(u.snapshotVersion.compareTo(Ue.min())>0){f.readTime=Th(l,u.snapshotVersion.toTimestamp());const g=lg(l,u.expectedCount);g!==null&&(f.expectedCount=g)}return f})(this.serializer,e);const i=V2(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=dg(this.serializer),n.removeTarget=e,this.q_(n)}}class C5 extends kw{constructor(e,n,i,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ot(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ot(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ot(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=M2(e.writeResults,e.commitTime),i=li(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=dg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>k2(this.serializer,i)))};this.q_(n)}}class R5{}class D5 extends R5{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new we(_e.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,cg(n,i),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new we(_e.UNKNOWN,l.toString())}))}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,f])=>this.connection.Ho(e,cg(n,i),a,u,f,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new we(_e.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class I5{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Gi(n),this.aa=!1):Ae("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const La="RemoteStore";class j5{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{Ua(this)&&(Ae(La,"Restarting streams for network reachability change."),await(async function(m){const g=Fe(m);g.Ea.add(4),await cu(g),g.Ra.set("Unknown"),g.Ea.delete(4),await Zh(g)})(this))}))})),this.Ra=new I5(i,a)}}async function Zh(t){if(Ua(t))for(const e of t.da)await e(!0)}async function cu(t){for(const e of t.da)await e(!1)}function Mw(t,e){const n=Fe(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),ay(n)?sy(n):gl(n).O_()&&iy(n,e))}function ry(t,e){const n=Fe(t),i=gl(n);n.Ia.delete(e),i.O_()&&Nw(n,e),n.Ia.size===0&&(i.O_()?i.L_():Ua(n)&&n.Ra.set("Unknown"))}function iy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}gl(t).Y_(e)}function Nw(t,e){t.Va.Ue(e),gl(t).Z_(e)}function sy(t){t.Va=new T2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),gl(t).start(),t.Ra.ua()}function ay(t){return Ua(t)&&!gl(t).x_()&&t.Ia.size>0}function Ua(t){return Fe(t).Ea.size===0}function Pw(t){t.Va=void 0}async function O5(t){t.Ra.set("Online")}async function k5(t){t.Ia.forEach(((e,n)=>{iy(t,e)}))}async function M5(t,e){Pw(t),ay(t)?(t.Ra.ha(e),sy(t)):t.Ra.set("Unknown")}async function N5(t,e,n){if(t.Ra.set("Online"),e instanceof bw&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const f of l.targetIds)a.Ia.has(f)&&(await a.remoteSyncer.rejectListen(f,u),a.Ia.delete(f),a.Va.removeTarget(f))})(t,e)}catch(i){Ae(La,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Ch(t,i)}else if(e instanceof sh?t.Va.Ze(e):e instanceof vw?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ue.min()))try{const i=await jw(t.localStore);n.compareTo(i)>=0&&await(function(l,u){const f=l.Va.Tt(u);return f.targetChanges.forEach(((m,g)=>{if(m.resumeToken.approximateByteSize()>0){const _=l.Ia.get(g);_&&l.Ia.set(g,_.withResumeToken(m.resumeToken,u))}})),f.targetMismatches.forEach(((m,g)=>{const _=l.Ia.get(m);if(!_)return;l.Ia.set(m,_.withResumeToken(En.EMPTY_BYTE_STRING,_.snapshotVersion)),Nw(l,m);const v=new Ps(_.target,m,g,_.sequenceNumber);iy(l,v)})),l.remoteSyncer.applyRemoteEvent(f)})(t,n)}catch(i){Ae(La,"Failed to raise snapshot:",i),await Ch(t,i)}}async function Ch(t,e,n){if(!pl(e))throw e;t.Ea.add(1),await cu(t),t.Ra.set("Offline"),n||(n=()=>jw(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ae(La,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Zh(t)}))}function Lw(t,e){return e().catch((n=>Ch(t,n,e)))}async function ef(t){const e=Fe(t),n=Xs(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Fg;for(;P5(e);)try{const a=await y5(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,L5(e,a)}catch(a){await Ch(e,a)}Vw(e)&&zw(e)}function P5(t){return Ua(t)&&t.Ta.length<10}function L5(t,e){t.Ta.push(e);const n=Xs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Vw(t){return Ua(t)&&!Xs(t).x_()&&t.Ta.length>0}function zw(t){Xs(t).start()}async function V5(t){Xs(t).ra()}async function z5(t){const e=Xs(t);for(const n of t.Ta)e.ea(n.mutations)}async function U5(t,e,n){const i=t.Ta.shift(),a=Yg.from(i,e,n);await Lw(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await ef(t)}async function B5(t,e){e&&Xs(t).X_&&await(async function(i,a){if((function(u){return E2(u)&&u!==_e.ABORTED})(a.code)){const l=i.Ta.shift();Xs(i).B_(),await Lw(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await ef(i)}})(t,e),Vw(t)&&zw(t)}async function Mx(t,e){const n=Fe(t);n.asyncQueue.verifyOperationInProgress(),Ae(La,"RemoteStore received new credentials");const i=Ua(n);n.Ea.add(3),await cu(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Zh(n)}async function F5(t,e){const n=Fe(t);e?(n.Ea.delete(2),await Zh(n)):e||(n.Ea.add(2),await cu(n),n.Ra.set("Unknown"))}function gl(t){return t.ma||(t.ma=(function(n,i,a){const l=Fe(n);return l.sa(),new A5(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:O5.bind(null,t),t_:k5.bind(null,t),r_:M5.bind(null,t),H_:N5.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),ay(t)?sy(t):t.Ra.set("Unknown")):(await t.ma.stop(),Pw(t))}))),t.ma}function Xs(t){return t.fa||(t.fa=(function(n,i,a){const l=Fe(n);return l.sa(),new C5(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:V5.bind(null,t),r_:B5.bind(null,t),ta:z5.bind(null,t),na:U5.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await ef(t)):(await t.fa.stop(),t.Ta.length>0&&(Ae(La,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class oy{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Ui,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const u=Date.now()+i,f=new oy(e,n,u,a,l);return f.start(i),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new we(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ly(t,e){if(Gi("AsyncQueue",`${e}: ${t}`),pl(t))return new we(_e.UNAVAILABLE,`${e}: ${t}`);throw t}class Fo{static emptySet(e){return new Fo(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||ke.comparator(n.key,i.key):(n,i)=>ke.comparator(n.key,i.key),this.keyedMap=Oc(),this.sortedSet=new It(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Fo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Fo;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class Nx{constructor(){this.ga=new It(ke.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):ze(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class tl{constructor(e,n,i,a,l,u,f,m,g){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=g}static fromInitialDocuments(e,n,i,a,l){const u=[];return n.forEach((f=>{u.push({type:0,doc:f})})),new tl(e,n,Fo.emptySet(n),u,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$h(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}class q5{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class H5{constructor(){this.queries=Px(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=Fe(n),l=a.queries;a.queries=Px(),l.forEach(((u,f)=>{for(const m of f.Sa)m.onError(i)}))})(this,new we(_e.ABORTED,"Firestore shutting down"))}}function Px(){return new za((t=>aw(t)),$h)}async function Uw(t,e){const n=Fe(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new q5,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(u){const f=ly(u,`Initialization of query '${Lo(e.query)}' failed`);return void e.onError(f)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&cy(n)}async function Bw(t,e){const n=Fe(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function G5(t,e){const n=Fe(t);let i=!1;for(const a of e){const l=a.query,u=n.queries.get(l);if(u){for(const f of u.Sa)f.Fa(a)&&(i=!0);u.wa=a}}i&&cy(n)}function Q5(t,e,n){const i=Fe(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function cy(t){t.Ca.forEach((e=>{e.next()}))}var mg,Lx;(Lx=mg||(mg={})).Ma="default",Lx.Cache="cache";class Fw{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new tl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=tl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==mg.Cache}}class qw{constructor(e){this.key=e}}class Hw{constructor(e){this.key=e}}class $5{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=et(),this.mutatedKeys=et(),this.eu=ow(e),this.tu=new Fo(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new Nx,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,u=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,g=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,v)=>{const x=a.get(_),w=Kh(this.query,v)?v:null,A=!!x&&this.mutatedKeys.has(x.key),I=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let N=!1;x&&w?x.data.isEqual(w.data)?A!==I&&(i.track({type:3,doc:w}),N=!0):this.su(x,w)||(i.track({type:2,doc:w}),N=!0,(m&&this.eu(w,m)>0||g&&this.eu(w,g)<0)&&(f=!0)):!x&&w?(i.track({type:0,doc:w}),N=!0):x&&!w&&(i.track({type:1,doc:x}),N=!0,(m||g)&&(f=!0)),N&&(w?(u=u.add(w),l=I?l.add(_):l.delete(_)):(u=u.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:u,iu:i,Cs:f,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((_,v)=>(function(w,A){const I=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ze(20277,{Rt:N})}};return I(w)-I(A)})(_.type,v.type)||this.eu(_.doc,v.doc))),this.ou(i),a=a??!1;const f=n&&!a?this._u():[],m=this.Xa.size===0&&this.current&&!a?1:0,g=m!==this.Za;return this.Za=m,u.length!==0||g?{snapshot:new tl(this.query,e.tu,l,u,e.mutatedKeys,m===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Nx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=et(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new Hw(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new qw(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=et();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return tl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const uy="SyncEngine";class K5{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class W5{constructor(e){this.key=e,this.hu=!1}}class Y5{constructor(e,n,i,a,l,u){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new za((f=>aw(f)),$h),this.Iu=new Map,this.Eu=new Set,this.du=new It(ke.comparator),this.Au=new Map,this.Ru=new Zg,this.Vu={},this.mu=new Map,this.fu=el.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function X5(t,e,n=!0){const i=Yw(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await Gw(i,e,n,!0),a}async function J5(t,e){const n=Yw(t);await Gw(n,e,!0,!1)}async function Gw(t,e,n,i){const a=await _5(t.localStore,oi(e)),l=a.targetId,u=t.sharedClientState.addLocalQueryTarget(l,n);let f;return i&&(f=await Z5(t,e,l,u==="current",a.resumeToken)),t.isPrimaryClient&&n&&Mw(t.remoteStore,a),f}async function Z5(t,e,n,i,a){t.pu=(v,x,w)=>(async function(I,N,H,$){let q=N.view.ru(H);q.Cs&&(q=await Dx(I.localStore,N.query,!1).then((({documents:L})=>N.view.ru(L,q))));const me=$&&$.targetChanges.get(N.targetId),ie=$&&$.targetMismatches.get(N.targetId)!=null,he=N.view.applyChanges(q,I.isPrimaryClient,me,ie);return zx(I,N.targetId,he.au),he.snapshot})(t,v,x,w);const l=await Dx(t.localStore,e,!0),u=new $5(e,l.Qs),f=u.ru(l.documents),m=lu.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),g=u.applyChanges(f,t.isPrimaryClient,m);zx(t,n,g.au);const _=new K5(e,n,u);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),g.snapshot}async function eO(t,e,n){const i=Fe(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((u=>!$h(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await hg(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&ry(i.remoteStore,a.targetId),pg(i,a.targetId)})).catch(ml)):(pg(i,a.targetId),await hg(i.localStore,a.targetId,!0))}async function tO(t,e){const n=Fe(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),ry(n.remoteStore,i.targetId))}async function nO(t,e,n){const i=cO(t);try{const a=await(function(u,f){const m=Fe(u),g=St.now(),_=f.reduce(((w,A)=>w.add(A.key)),et());let v,x;return m.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let A=Qi(),I=et();return m.Ns.getEntries(w,_).next((N=>{A=N,A.forEach(((H,$)=>{$.isValidDocument()||(I=I.add(H))}))})).next((()=>m.localDocuments.getOverlayedDocuments(w,A))).next((N=>{v=N;const H=[];for(const $ of f){const q=y2($,v.get($.key).overlayedDocument);q!=null&&H.push(new ea($.key,q,JS(q.value.mapValue),Pr.exists(!0)))}return m.mutationQueue.addMutationBatch(w,g,H,f)})).next((N=>{x=N;const H=N.applyToLocalDocumentSet(v,I);return m.documentOverlayCache.saveOverlays(w,N.batchId,H)}))})).then((()=>({batchId:x.batchId,changes:cw(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(u,f,m){let g=u.Vu[u.currentUser.toKey()];g||(g=new It(Ze)),g=g.insert(f,m),u.Vu[u.currentUser.toKey()]=g})(i,a.batchId,n),await uu(i,a.changes),await ef(i.remoteStore)}catch(a){const l=ly(a,"Failed to persist write");n.reject(l)}}async function Qw(t,e){const n=Fe(t);try{const i=await p5(n.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=n.Au.get(l);u&&(ot(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?ot(u.hu,14607):a.removedDocuments.size>0&&(ot(u.hu,42227),u.hu=!1))})),await uu(n,i,e)}catch(i){await ml(i)}}function Vx(t,e,n){const i=Fe(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach(((l,u)=>{const f=u.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(u,f){const m=Fe(u);m.onlineState=f;let g=!1;m.queries.forEach(((_,v)=>{for(const x of v.Sa)x.va(f)&&(g=!0)})),g&&cy(m)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function rO(t,e,n){const i=Fe(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let u=new It(ke.comparator);u=u.insert(l,Cn.newNoDocument(l,Ue.min()));const f=et().add(l),m=new Xh(Ue.min(),new Map,new It(Ze),u,f);await Qw(i,m),i.du=i.du.remove(l),i.Au.delete(e),dy(i)}else await hg(i.localStore,e,!1).then((()=>pg(i,e,n))).catch(ml)}async function iO(t,e){const n=Fe(t),i=e.batch.batchId;try{const a=await m5(n.localStore,e);Kw(n,i,null),$w(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await uu(n,a)}catch(a){await ml(a)}}async function sO(t,e,n){const i=Fe(t);try{const a=await(function(u,f){const m=Fe(u);return m.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let _;return m.mutationQueue.lookupMutationBatch(g,f).next((v=>(ot(v!==null,37113),_=v.keys(),m.mutationQueue.removeMutationBatch(g,v)))).next((()=>m.mutationQueue.performConsistencyCheck(g))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(g,_,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,_))).next((()=>m.localDocuments.getDocuments(g,_)))}))})(i.localStore,e);Kw(i,e,n),$w(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await uu(i,a)}catch(a){await ml(a)}}function $w(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Kw(t,e,n){const i=Fe(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function pg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||Ww(t,i)}))}function Ww(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(ry(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),dy(t))}function zx(t,e,n){for(const i of n)i instanceof qw?(t.Ru.addReference(i.key,e),aO(t,i)):i instanceof Hw?(Ae(uy,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||Ww(t,i.key)):ze(19791,{wu:i})}function aO(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(Ae(uy,"New document in limbo: "+n),t.Eu.add(i),dy(t))}function dy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ke(vt.fromString(e)),i=t.fu.next();t.Au.set(i,new W5(n)),t.du=t.du.insert(n,i),Mw(t.remoteStore,new Ps(oi($g(n.path)),i,"TargetPurposeLimboResolution",Hh.ce))}}async function uu(t,e,n){const i=Fe(t),a=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((f,m)=>{u.push(i.pu(m,e,n).then((g=>{if((g||n)&&i.isPrimaryClient){const _=g?!g.fromCache:n?.targetChanges.get(m.targetId)?.current;i.sharedClientState.updateQueryState(m.targetId,_?"current":"not-current")}if(g){a.push(g);const _=ty.As(m.targetId,g);l.push(_)}})))})),await Promise.all(u),i.Pu.H_(a),await(async function(m,g){const _=Fe(m);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>ve.forEach(g,(x=>ve.forEach(x.Es,(w=>_.persistence.referenceDelegate.addReference(v,x.targetId,w))).next((()=>ve.forEach(x.ds,(w=>_.persistence.referenceDelegate.removeReference(v,x.targetId,w)))))))))}catch(v){if(!pl(v))throw v;Ae(ny,"Failed to update sequence numbers: "+v)}for(const v of g){const x=v.targetId;if(!v.fromCache){const w=_.Ms.get(x),A=w.snapshotVersion,I=w.withLastLimboFreeSnapshotVersion(A);_.Ms=_.Ms.insert(x,I)}}})(i.localStore,l))}async function oO(t,e){const n=Fe(t);if(!n.currentUser.isEqual(e)){Ae(uy,"User change. New user:",e.toKey());const i=await Iw(n.localStore,e);n.currentUser=e,(function(l,u){l.mu.forEach((f=>{f.forEach((m=>{m.reject(new we(_e.CANCELLED,u))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await uu(n,i.Ls)}}function lO(t,e){const n=Fe(t),i=n.Au.get(e);if(i&&i.hu)return et().add(i.key);{let a=et();const l=n.Iu.get(e);if(!l)return a;for(const u of l){const f=n.Tu.get(u);a=a.unionWith(f.view.nu)}return a}}function Yw(t){const e=Fe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Qw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rO.bind(null,e),e.Pu.H_=G5.bind(null,e.eventManager),e.Pu.yu=Q5.bind(null,e.eventManager),e}function cO(t){const e=Fe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=iO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sO.bind(null,e),e}class Rh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Jh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return f5(this.persistence,new u5,e.initialUser,this.serializer)}Cu(e){return new Dw(ey.mi,this.serializer)}Du(e){return new b5}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Rh.provider={build:()=>new Rh};class uO extends Rh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ot(this.persistence.referenceDelegate instanceof Ah,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new W2(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Bn.withCacheSize(this.cacheSizeBytes):Bn.DEFAULT;return new Dw((i=>Ah.mi(i,n)),this.serializer)}}class gg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Vx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=oO.bind(null,this.syncEngine),await F5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new H5})()}createDatastore(e){const n=Jh(e.databaseInfo.databaseId),i=(function(l){return new T5(l)})(e.databaseInfo);return(function(l,u,f,m){return new D5(l,u,f,m)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,a,l,u,f){return new j5(i,a,l,u,f)})(this.localStore,this.datastore,e.asyncQueue,(n=>Vx(this.syncEngine,n,0)),(function(){return Ox.v()?new Ox:new x5})())}createSyncEngine(e,n){return(function(a,l,u,f,m,g,_){const v=new Y5(a,l,u,f,m,g);return _&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Fe(n);Ae(La,"RemoteStore shutting down."),i.Ea.add(5),await cu(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}gg.provider={build:()=>new gg};class Xw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Gi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Js="FirestoreClient";class dO{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=An.UNAUTHENTICATED,this.clientId=Bg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{Ae(Js,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(Ae(Js,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ui;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=ly(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function jp(t,e){t.asyncQueue.verifyOperationInProgress(),Ae(Js,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async a=>{i.isEqual(a)||(await Iw(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Ux(t,e){t.asyncQueue.verifyOperationInProgress();const n=await hO(t);Ae(Js,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>Mx(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,a)=>Mx(e.remoteStore,a))),t._onlineComponents=e}async function hO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ae(Js,"Using user provided OfflineComponentProvider");try{await jp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===_e.FAILED_PRECONDITION||a.code===_e.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;Wo("Error using user provided cache. Falling back to memory cache: "+n),await jp(t,new Rh)}}else Ae(Js,"Using default OfflineComponentProvider"),await jp(t,new uO(void 0));return t._offlineComponents}async function Jw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ae(Js,"Using user provided OnlineComponentProvider"),await Ux(t,t._uninitializedComponentsProvider._online)):(Ae(Js,"Using default OnlineComponentProvider"),await Ux(t,new gg))),t._onlineComponents}function fO(t){return Jw(t).then((e=>e.syncEngine))}async function Zw(t){const e=await Jw(t),n=e.eventManager;return n.onListen=X5.bind(null,e.syncEngine),n.onUnlisten=eO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=J5.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=tO.bind(null,e.syncEngine),n}function mO(t,e,n={}){const i=new Ui;return t.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,m,g){const _=new Xw({next:x=>{_.Nu(),u.enqueueAndForget((()=>Bw(l,v)));const w=x.docs.has(f);!w&&x.fromCache?g.reject(new we(_e.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&x.fromCache&&m&&m.source==="server"?g.reject(new we(_e.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(x)},error:x=>g.reject(x)}),v=new Fw($g(f.path),_,{includeMetadataChanges:!0,qa:!0});return Uw(l,v)})(await Zw(t),t.asyncQueue,e,n,i))),i.promise}function pO(t,e,n={}){const i=new Ui;return t.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,m,g){const _=new Xw({next:x=>{_.Nu(),u.enqueueAndForget((()=>Bw(l,v))),x.fromCache&&m.source==="server"?g.reject(new we(_e.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(x)},error:x=>g.reject(x)}),v=new Fw(f,_,{includeMetadataChanges:!0,qa:!0});return Uw(l,v)})(await Zw(t),t.asyncQueue,e,n,i))),i.promise}function e1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const Bx=new Map;const t1="firestore.googleapis.com",Fx=!0;class qx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new we(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=t1,this.ssl=Fx}else this.host=e.host,this.ssl=e.ssl??Fx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Rw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<$2)throw new we(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Ij("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=e1(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new we(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new we(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new we(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class tf{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new we(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new we(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new bj;switch(i.type){case"firstParty":return new wj(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new we(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=Bx.get(n);i&&(Ae("ComponentProvider","Removing Datastore"),Bx.delete(n),i.terminate())})(this),Promise.resolve()}}function gO(t,e,n,i={}){t=mi(t,tf);const a=dl(e),l=t._getSettings(),u={...l,emulatorOptions:t._getEmulatorOptions()},f=`${e}:${n}`;a&&(wS(`https://${f}`),TS("Firestore",!0)),l.host!==t1&&l.host!==f&&Wo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...l,host:f,ssl:a,emulatorOptions:i};if(!Qs(m,u)&&(t._setSettings(m),i.mockUserToken)){let g,_;if(typeof i.mockUserToken=="string")g=i.mockUserToken,_=An.MOCK_USER;else{g=HD(i.mockUserToken,t._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new we(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new An(v)}t._authCredentials=new xj(new US(g,_))}}class yl{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new yl(this.firestore,e,this._query)}}class Bt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Bt(this.firestore,e,this._key)}toJSON(){return{type:Bt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(su(n,Bt._jsonSchema))return new Bt(e,i||null,new ke(vt.fromString(n.referencePath)))}}Bt._jsonSchemaVersion="firestore/documentReference/1.0",Bt._jsonSchema={type:Zt("string",Bt._jsonSchemaVersion),referencePath:Zt("string")};class Fs extends yl{constructor(e,n,i){super(e,n,$g(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Bt(this.firestore,null,new ke(e))}withConverter(e){return new Fs(this.firestore,e,this._path)}}function yO(t,e,...n){if(t=fn(t),BS("collection","path",e),t instanceof tf){const i=vt.fromString(e,...n);return nx(i),new Fs(t,null,i)}{if(!(t instanceof Bt||t instanceof Fs))throw new we(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(vt.fromString(e,...n));return nx(i),new Fs(t.firestore,null,i)}}function nf(t,e,...n){if(t=fn(t),arguments.length===1&&(e=Bg.newId()),BS("doc","path",e),t instanceof tf){const i=vt.fromString(e,...n);return tx(i),new Bt(t,null,new ke(i))}{if(!(t instanceof Bt||t instanceof Fs))throw new we(_e.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(vt.fromString(e,...n));return tx(i),new Bt(t.firestore,t instanceof Fs?t.converter:null,new ke(i))}}const Hx="AsyncQueue";class Gx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ow(this,"async_queue_retry"),this._c=()=>{const i=Ip();i&&Ae(Hx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Ip();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Ip();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Ui;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!pl(e))throw e;Ae(Hx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Gi("INTERNAL UNHANDLED ERROR: ",Qx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=oy.createAndSchedule(this,e,n,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&ze(47125,{Pc:Qx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Qx(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class _l extends tf{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new Gx,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Gx(e),this._firestoreClient=void 0,await e}}}function _O(t,e){const n=typeof t=="object"?t:DS(),i=typeof t=="string"?t:vh,a=zg(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=FD("firestore");l&&gO(a,...l)}return a}function hy(t){if(t._terminated)throw new we(_e.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||vO(t),t._firestoreClient}function vO(t){const e=t._freezeSettings(),n=(function(a,l,u,f){return new Bj(a,l,u,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,e1(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new dO(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(t._componentsProvider))}class vr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vr(En.fromBase64String(e))}catch(n){throw new we(_e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new vr(En.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:vr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(su(e,vr._jsonSchema))return vr.fromBase64String(e.bytes)}}vr._jsonSchemaVersion="firestore/bytes/1.0",vr._jsonSchema={type:Zt("string",vr._jsonSchemaVersion),bytes:Zt("string")};class rf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new we(_e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class sf{constructor(e){this._methodName=e}}class ci{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new we(_e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new we(_e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ze(this._lat,e._lat)||Ze(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ci._jsonSchemaVersion}}static fromJSON(e){if(su(e,ci._jsonSchema))return new ci(e.latitude,e.longitude)}}ci._jsonSchemaVersion="firestore/geoPoint/1.0",ci._jsonSchema={type:Zt("string",ci._jsonSchemaVersion),latitude:Zt("number"),longitude:Zt("number")};class ui{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ui._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(su(e,ui._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new ui(e.vectorValues);throw new we(_e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ui._jsonSchemaVersion="firestore/vectorValue/1.0",ui._jsonSchema={type:Zt("string",ui._jsonSchemaVersion),vectorValues:Zt("object")};const bO=/^__.*__$/;class xO{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new ea(e,this.data,this.fieldMask,n,this.fieldTransforms):new ou(e,this.data,n,this.fieldTransforms)}}class n1{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new ea(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function r1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ze(40011,{Ac:t})}}class af{constructor(e,n,i,a,l,u){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new af({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Dh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(r1(this.Ac)&&bO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class EO{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||Jh(e)}Cc(e,n,i,a=!1){return new af({Ac:e,methodName:n,Dc:i,path:xn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fy(t){const e=t._freezeSettings(),n=Jh(t._databaseId);return new EO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function SO(t,e,n,i,a,l={}){const u=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);py("Data must be an object, but it was:",u,i);const f=i1(i,u);let m,g;if(l.merge)m=new tr(u.fieldMask),g=u.fieldTransforms;else if(l.mergeFields){const _=[];for(const v of l.mergeFields){const x=yg(e,v,n);if(!u.contains(x))throw new we(_e.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);a1(_,x)||_.push(x)}m=new tr(_),g=u.fieldTransforms.filter((v=>m.covers(v.field)))}else m=null,g=u.fieldTransforms;return new xO(new Fn(f),m,g)}class of extends sf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof of}}function wO(t,e,n){return new af({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class my extends sf{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=wO(this,e,!0),i=this.vc.map((l=>vl(l,n))),a=new Zo(i);return new f2(e.path,a)}isEqual(e){return e instanceof my&&Qs(this.vc,e.vc)}}function TO(t,e,n,i){const a=t.Cc(1,e,n);py("Data must be an object, but it was:",a,i);const l=[],u=Fn.empty();Zs(i,((m,g)=>{const _=gy(e,m,n);g=fn(g);const v=a.yc(_);if(g instanceof of)l.push(_);else{const x=vl(g,v);x!=null&&(l.push(_),u.set(_,x))}}));const f=new tr(l);return new n1(u,f,a.fieldTransforms)}function AO(t,e,n,i,a,l){const u=t.Cc(1,e,n),f=[yg(e,i,n)],m=[a];if(l.length%2!=0)throw new we(_e.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<l.length;x+=2)f.push(yg(e,l[x])),m.push(l[x+1]);const g=[],_=Fn.empty();for(let x=f.length-1;x>=0;--x)if(!a1(g,f[x])){const w=f[x];let A=m[x];A=fn(A);const I=u.yc(w);if(A instanceof of)g.push(w);else{const N=vl(A,I);N!=null&&(g.push(w),_.set(w,N))}}const v=new tr(g);return new n1(_,v,u.fieldTransforms)}function CO(t,e,n,i=!1){return vl(n,t.Cc(i?4:3,e))}function vl(t,e){if(s1(t=fn(t)))return py("Unsupported field value:",e,t),i1(t,e);if(t instanceof sf)return(function(i,a){if(!r1(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let u=0;for(const f of i){let m=vl(f,a.wc(u));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),u++}return{arrayValue:{values:l}}})(t,e)}return(function(i,a){if((i=fn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return u2(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=St.fromDate(i);return{timestampValue:Th(a.serializer,l)}}if(i instanceof St){const l=new St(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Th(a.serializer,l)}}if(i instanceof ci)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof vr)return{bytesValue:xw(a.serializer,i._byteString)};if(i instanceof Bt){const l=a.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw a.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Jg(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof ui)return(function(u,f){return{mapValue:{fields:{[YS]:{stringValue:XS},[bh]:{arrayValue:{values:u.toArray().map((g=>{if(typeof g!="number")throw f.Sc("VectorValues must only contain numeric values.");return Kg(f.serializer,g)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${qh(i)}`)})(t,e)}function i1(t,e){const n={};return HS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zs(t,((i,a)=>{const l=vl(a,e.mc(i));l!=null&&(n[i]=l)})),{mapValue:{fields:n}}}function s1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof St||t instanceof ci||t instanceof vr||t instanceof Bt||t instanceof sf||t instanceof ui)}function py(t,e,n){if(!s1(n)||!FS(n)){const i=qh(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function yg(t,e,n){if((e=fn(e))instanceof rf)return e._internalPath;if(typeof e=="string")return gy(t,e);throw Dh("Field path arguments must be of type string or ",t,!1,void 0,n)}const RO=new RegExp("[~\\*/\\[\\]]");function gy(t,e,n){if(e.search(RO)>=0)throw Dh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new rf(...e.split("."))._internalPath}catch{throw Dh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Dh(t,e,n,i,a){const l=i&&!i.isEmpty(),u=a!==void 0;let f=`Function ${e}() called with invalid data`;n&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||u)&&(m+=" (found",l&&(m+=` in field ${i}`),u&&(m+=` in document ${a}`),m+=")"),new we(_e.INVALID_ARGUMENT,f+t+m)}function a1(t,e){return t.some((n=>n.isEqual(e)))}class o1{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Bt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new DO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(yy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class DO extends o1{data(){return super.data()}}function yy(t,e){return typeof e=="string"?gy(t,e):e instanceof rf?e._internalPath:e._delegate._internalPath}function IO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new we(_e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _y{}class jO extends _y{}function OO(t,e,...n){let i=[];e instanceof _y&&i.push(e),i=i.concat(n),(function(l){const u=l.filter((m=>m instanceof vy)).length,f=l.filter((m=>m instanceof lf)).length;if(u>1||u>0&&f>0)throw new we(_e.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)t=a._apply(t);return t}class lf extends jO{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new lf(e,n,i)}_apply(e){const n=this._parse(e);return l1(e._query,n),new yl(e.firestore,e.converter,ag(e._query,n))}_parse(e){const n=fy(e.firestore);return(function(l,u,f,m,g,_,v){let x;if(g.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new we(_e.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){Kx(v,_);const A=[];for(const I of v)A.push($x(m,l,I));x={arrayValue:{values:A}}}else x=$x(m,l,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||Kx(v,_),x=CO(f,u,v,_==="in"||_==="not-in");return Jt.create(g,_,x)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function kO(t,e,n){const i=e,a=yy("where",t);return lf._create(a,i,n)}class vy extends _y{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new vy(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Lr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,l){let u=a;const f=l.getFlattenedFilters();for(const m of f)l1(u,m),u=ag(u,m)})(e._query,n),new yl(e.firestore,e.converter,ag(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function $x(t,e,n){if(typeof(n=fn(n))=="string"){if(n==="")throw new we(_e.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sw(e)&&n.indexOf("/")!==-1)throw new we(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(vt.fromString(n));if(!ke.isDocumentKey(i))throw new we(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return ux(t,new ke(i))}if(n instanceof Bt)return ux(t,n._key);throw new we(_e.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${qh(n)}.`)}function Kx(t,e){if(!Array.isArray(t)||t.length===0)throw new we(_e.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function l1(t,e){const n=(function(a,l){for(const u of a)for(const f of u.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new we(_e.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new we(_e.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class MO{convertValue(e,n="none"){switch(Ys(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ut(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ws(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ze(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return Zs(e,((a,l)=>{i[a]=this.convertValue(l,n)})),i}convertVectorValue(e){const n=e.fields?.[bh].arrayValue?.values?.map((i=>Ut(i.doubleValue)));return new ui(n)}convertGeoPoint(e){return new ci(Ut(e.latitude),Ut(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Qh(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Gc(e));default:return null}}convertTimestamp(e){const n=Ks(e);return new St(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=vt.fromString(e);ot(Cw(i),9688,{name:e});const a=new Qc(i.get(1),i.get(3)),l=new ke(i.popFirst(5));return a.isEqual(n)||Gi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function NO(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Mc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Oa extends o1{constructor(e,n,i,a,l,u){super(e,n,i,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ah(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(yy("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new we(_e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Oa._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Oa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Oa._jsonSchema={type:Zt("string",Oa._jsonSchemaVersion),bundleSource:Zt("string","DocumentSnapshot"),bundleName:Zt("string"),bundle:Zt("string")};class ah extends Oa{data(e={}){return super.data(e)}}class qo{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Mc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new ah(this._firestore,this._userDataWriter,i.key,i,new Mc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new we(_e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((f=>{const m=new ah(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Mc(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new ah(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Mc(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let g=-1,_=-1;return f.type!==0&&(g=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),_=u.indexOf(f.doc.key)),{type:PO(f.type),doc:m,oldIndex:g,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new we(_e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=qo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Bg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function PO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ze(61501,{type:t})}}function LO(t){t=mi(t,Bt);const e=mi(t.firestore,_l);return mO(hy(e),t._key).then((n=>FO(e,t,n)))}qo._jsonSchemaVersion="firestore/querySnapshot/1.0",qo._jsonSchema={type:Zt("string",qo._jsonSchemaVersion),bundleSource:Zt("string","QuerySnapshot"),bundleName:Zt("string"),bundle:Zt("string")};class c1 extends MO{constructor(e){super(),this.firestore=e}convertBytes(e){return new vr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Bt(this.firestore,null,n)}}function VO(t){t=mi(t,yl);const e=mi(t.firestore,_l),n=hy(e),i=new c1(e);return IO(t._query),pO(n,t._query).then((a=>new qo(e,i,t,a)))}function zO(t,e,n){t=mi(t,Bt);const i=mi(t.firestore,_l),a=NO(t.converter,e,n);return by(i,[SO(fy(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,Pr.none())])}function UO(t,e,n,...i){t=mi(t,Bt);const a=mi(t.firestore,_l),l=fy(a);let u;return u=typeof(e=fn(e))=="string"||e instanceof rf?AO(l,"updateDoc",t._key,e,n,i):TO(l,"updateDoc",t._key,e),by(a,[u.toMutation(t._key,Pr.exists(!0))])}function BO(t){return by(mi(t.firestore,_l),[new Wg(t._key,Pr.none())])}function by(t,e){return(function(i,a){const l=new Ui;return i.asyncQueue.enqueueAndForget((async()=>nO(await fO(i),a,l))),l.promise})(hy(t),e)}function FO(t,e,n){const i=n.docs.get(e._key),a=new c1(t);return new Oa(t,a,e._key,i,new Mc(n.hasPendingWrites,n.fromCache),e.converter)}function qO(...t){return new my("arrayUnion",t)}(function(e,n=!0){(function(a){fl=a})(hl),Ko(new Na("firestore",((i,{instanceIdentifier:a,options:l})=>{const u=i.getProvider("app").getImmediate(),f=new _l(new Ej(i.getProvider("auth-internal")),new Tj(u,i.getProvider("app-check-internal")),(function(g,_){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new we(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qc(g.options.projectId,_)})(u,a),u);return l={useFetchStreams:n,...l},f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Us(Xb,Jb,e),Us(Xb,Jb,"esm2020")})();function du(){return _O(OS)}function hu(t,e,n,i=1,a){{let l=e;if(e.startsWith("budgets/"))l="budgets";else if(e.startsWith("months/")){const m=e.replace("months/","").split("_");if(m.length>=2){const g=m[m.length-1];l=`months/${m[m.length-2]}/${g}`}}console.log(`[Firebase] ${t}(${i}): ${l}${a===!1?" [NOT FOUND]":""}  ${n}`)}}async function Qe(t,e,n){const i=nf(du(),t,e),a=`${t}/${e}`,l=await LO(i),u=l.exists();return hu("READ",a,n,1,u),{exists:u,data:u?l.data():null,ref:i}}async function Mr(t,e,n){const i=du(),a=yO(i,t);let l;if(n&&n.length>0){const m=n.map(g=>kO(g.field,g.op,g.value));l=OO(a,...m)}else l=a;const u=await VO(l);let f=t;if(n&&n.length>0){const m=n.map(g=>`${g.field} ${g.op} ${JSON.stringify(g.value)}`).join(", ");f+=` WHERE ${m}`}return hu("QUERY",f,e,u.docs.length),{docs:u.docs.map(m=>({id:m.id,data:m.data()}))}}async function yt(t,e,n,i,a){const l=nf(du(),t,e),u=`${t}/${e}`;return hu("WRITE",u,i),zO(l,n,a??{})}async function Uo(t,e,n,i){const a=nf(du(),t,e),l=`${t}/${e}`;return hu("UPDATE",l,i),UO(a,n)}async function xy(t,e,n){const i=nf(du(),t,e),a=`${t}/${e}`;return hu("DELETE",a,n),BO(i)}function Bi(t,e,n){const i=n.toString().padStart(2,"0");return`${t}_${e}_${i}`}function Ey(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function HO(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}function Fi(t,e){return`${t}${e.toString().padStart(2,"0")}`}async function Sy(t,e,n){const i=Fi(e,n),l=(await Mr("months","getFutureMonths: querying months after specified month",[{field:"budget_id",op:"==",value:t},{field:"year_month_ordinal",op:">",value:i}])).docs.map(u=>({id:u.id,...u.data})).sort((u,f)=>u.year!==f.year?u.year-f.year:u.month-f.month);for(const u of l)Rt.setQueryData(xe.month(t,u.year,u.month),{month:u});return l}function GO(t){const e=xe.budget(t),n=Rt.getQueryData(e);return n?n.isNeedsRecalculation===!0:!1}function QO(t){const e=xe.budget(t),n=Rt.getQueryData(e);n&&Rt.setQueryData(e,{...n,isNeedsRecalculation:!0})}async function $O(t){return GO(t)?!1:(QO(t),await Uo("budgets",t,{is_needs_recalculation:!0,updated_at:new Date().toISOString()},"marking budget as is_needs_recalculation (month data changed)"),!0)}function KO(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??Fi(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,is_needs_recalculation:t.is_needs_recalculation??!1,created_at:t.created_at,updated_at:t.updated_at}}async function u1(t,e,n,i){const a={triggerRecalc:!0,...i},l=Bi(t,e,n),f=(await Rt.fetchQuery({queryKey:xe.month(t,e,n),queryFn:async()=>{const{exists:m,data:g}=await Qe("months",l,a.description??`reading month ${e}/${n}`);return!m||!g?null:{month:KO(g,t,e,n)}},staleTime:yS}))?.month??null;if(!f)return null;if(a.triggerRecalc&&f.is_needs_recalculation){const m=Fi(e,n);return console.log(`[readMonth] Month ${m} needs recalculation, triggering...`),await wy(t,{targetMonthOrdinal:m}),await u1(t,e,n,{triggerRecalc:!1,description:"reading recalculated month"})}return f}async function Wi(t,e,n,i){const a=Bi(t,e,n),l=i?`PRE-EDIT-READ: ${i}`:"PRE-EDIT-READ",{exists:u,data:f}=await Qe("months",a,l);if(!u||!f)throw new Error(`Month data not found for ${e}/${n}`);return f}function WO(t){const e={},n={};return t.category_balances&&t.category_balances.forEach(i=>{e[i.category_id]=i.end_balance}),t.account_balances&&t.account_balances.forEach(i=>{n[i.account_id]=i.end_balance}),{categoryEndBalances:e,accountEndBalances:n}}async function YO(t,e,n){const i=new Date().toISOString(),a=Bi(t,e,n);let l=0,u={},f={};if(n>1||e>new Date().getFullYear()-10){const{year:x,month:w}=Ey(e,n),A=Bi(t,x,w),{exists:I,data:N}=await Qe("months",A,"fetching previous month to create start balances for new month");if(I&&N){const H={year_month_ordinal:N.year_month_ordinal??Fi(x,w),year:N.year??x,month:N.month??w,income:N.income||[],total_income:N.total_income??0,previous_month_income:N.previous_month_income??0,expenses:N.expenses||[],total_expenses:N.total_expenses??0,account_balances:N.account_balances||[],category_balances:N.category_balances||[],are_allocations_finalized:N.are_allocations_finalized??!1,is_needs_recalculation:N.is_needs_recalculation??!1,created_at:N.created_at,updated_at:N.updated_at};l=H.total_income;const{categoryEndBalances:$,accountEndBalances:q}=WO(H);u=$,f=q}}const m=Object.entries(u).map(([x,w])=>({category_id:x,start_balance:w,allocated:0,spent:0,end_balance:w})),g=Object.entries(f).map(([x,w])=>({account_id:x,start_balance:w,income:0,expenses:0,net_change:0,end_balance:w})),_={budget_id:t,year_month_ordinal:Fi(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:l,expenses:[],total_expenses:0,account_balances:g,category_balances:m,are_allocations_finalized:!1,is_needs_recalculation:!1,created_at:i,updated_at:i},v={budget_id:t,year_month_ordinal:Fi(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:l,expenses:[],total_expenses:0,account_balances:g,category_balances:m,are_allocations_finalized:!1,is_needs_recalculation:!1,created_at:i,updated_at:i};return await yt("months",a,v,"creating new month document (first time viewing this month)"),Rt.setQueryData(xe.month(t,e,n),{month:_}),_}function XO(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??Fi(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,is_needs_recalculation:t.is_needs_recalculation??!1,created_at:t.created_at,updated_at:t.updated_at}}async function Wx(t,e,n){const i=Bi(t,e,n),{exists:a,data:l}=await Qe("months",i,`loading month ${e}/${n}`);return!a||!l?null:XO(l,t,e,n)}async function JO(t,e,n){const i=await Wx(t,e,n);if(i){if(i.is_needs_recalculation){const a=Fi(e,n);return console.log(`[useMonthQuery] Month ${a} needs recalculation, triggering...`),await wy(t,{targetMonthOrdinal:a}),await Wx(t,e,n)||i}return i}return YO(t,e,n)}function ZO(t,e,n,i){return ul({queryKey:t?xe.month(t,e,n):["month","none"],queryFn:async()=>({month:await JO(t,e,n)}),enabled:!!t&&i?.enabled!==!1})}function ek(t,e,n){const i=xe.month(t,e,n),a=Rt.getQueryData(i);return a?.month?a.month.is_needs_recalculation===!0:!1}function tk(t,e){const n=xe.month(t,e.year,e.month),i={...e,is_needs_recalculation:!0};Rt.setQueryData(n,{month:i})}async function nk(t,e,n){const i=await Sy(t,e,n);if(i.length===0)return{markedCount:0,skippedCount:0,totalFutureMonths:0};let a=0,l=0;const u=[];for(const f of i){if(ek(t,f.year,f.month)){l++;continue}tk(t,f),u.push(Uo("months",f.id,{is_needs_recalculation:!0,updated_at:new Date().toISOString()},`marking month ${f.year}/${f.month} as is_needs_recalculation`)),a++}return u.length>0&&await Promise.all(u),{markedCount:a,skippedCount:l,totalFutureMonths:i.length}}const rk={categoryEndBalances:{},accountEndBalances:{},totalIncome:0};function ik(t,e){const n=sk(t.category_balances,e.categoryEndBalances),i=ak(t,e.accountEndBalances);return{...t,previous_month_income:e.totalIncome,category_balances:n,account_balances:i,is_needs_recalculation:!1,updated_at:new Date().toISOString()}}function sk(t,e){const n=new Map;for(const a of t)n.set(a.category_id,a);const i=t.map(a=>{const l=e[a.category_id]??0;return{...a,start_balance:l,end_balance:l+a.allocated-a.spent}});for(const[a,l]of Object.entries(e))n.has(a)||i.push({category_id:a,start_balance:l,allocated:0,spent:0,end_balance:l});return i}function ak(t,e){const n=new Set;for(const a of t.income||[])n.add(a.account_id);for(const a of t.expenses||[])n.add(a.account_id);for(const a of Object.keys(e))n.add(a);for(const a of t.account_balances||[])n.add(a.account_id);const i=[];for(const a of n){const l=e[a]??0,u=(t.income||[]).filter(g=>g.account_id===a).reduce((g,_)=>g+_.amount,0),f=(t.expenses||[]).filter(g=>g.account_id===a).reduce((g,_)=>g+_.amount,0),m=u-f;i.push({account_id:a,start_balance:l,income:u,expenses:f,net_change:m,end_balance:l+m})}return i}function Yx(t){const e={},n={};for(const i of t.category_balances||[])e[i.category_id]=i.end_balance;for(const i of t.account_balances||[])n[i.account_id]=i.end_balance;return{categoryEndBalances:e,accountEndBalances:n,totalIncome:t.total_income}}async function d1(t,e,n){const i=Bi(t,e.year,e.month);await yt("months",i,e,`writeMonthData: ${n}`)}async function h1(t,e,n){await Promise.all([nk(t,e,n),$O(t)])}async function f1(t){const{budgetId:e,month:n,description:i,cascadeRecalculation:a=!0}=t;await d1(e,n,i||`${n.year}/${n.month}`),Rt.setQueryData(xe.month(e,n.year,n.month),{month:n}),a&&await h1(e,n.year,n.month)}function Yi(){const t=on();return{writeData:ir({mutationFn:async({budgetId:n,month:i,description:a,cascadeRecalculation:l=!0})=>(await d1(n,i,a||`${i.year}/${i.month}`),{budgetId:n,year:i.year,month:i.month,cascadeRecalculation:l}),onMutate:async({budgetId:n,month:i})=>{const a=xe.month(n,i.year,i.month);await t.cancelQueries({queryKey:a});const l=t.getQueryData(a);return t.setQueryData(a,{month:i}),{oldMonthQueryData:l,monthKey:a}},onSuccess:async({budgetId:n,year:i,month:a,cascadeRecalculation:l})=>{l&&await h1(n,i,a)},onError:(n,i,a)=>{a?.oldMonthQueryData&&t.setQueryData(a.monthKey,a.oldMonthQueryData)}})}}function ok(t,e,n,i){const a={};t.category_balances&&t.category_balances.forEach(u=>{a[u.category_id]=u});const l=t.expenses??[];return e.map(u=>{const m=a[u]?.start_balance??0,g=n[u]??0,_=l.filter(v=>v.category_id===u).reduce((v,x)=>v+x.amount,0);return{category_id:u,start_balance:m,allocated:g,spent:_,end_balance:m+g-_}})}function lk(){const{writeData:t}=Yi();return{saveDraftAllocations:async(n,i,a,l)=>{const u=await Wi(n,i,a,"save draft allocations"),f=u.category_balances.map(g=>({...g,allocated:l[g.category_id]??g.allocated})),m={...u,category_balances:f,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:n,month:m,cascadeRecalculation:!1}),{updatedMonth:m}},isPending:t.isPending,isError:t.isError,error:t.error}}function ck(){const{writeData:t}=Yi();return{finalizeAllocations:async n=>{const{budgetId:i,year:a,month:l,allocations:u}=n,f=await Wi(i,a,l,"finalize allocations"),m=f.category_balances?.map(v=>v.category_id)??Object.keys(u),g=m.length>0?ok(f,m,u):f.category_balances,_={...f,category_balances:g,are_allocations_finalized:!0,is_needs_recalculation:!1,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:i,month:_,description:"finalize allocations"}),{updatedMonth:_}},isPending:t.isPending,isError:t.isError,error:t.error}}function uk(){const{writeData:t}=Yi();return{deleteAllocations:async n=>{const{budgetId:i,year:a,month:l}=n,u=await Wi(i,a,l,"delete allocations"),f=u.category_balances.map(g=>({...g,allocated:0,end_balance:g.start_balance-g.spent})),m={...u,category_balances:f,are_allocations_finalized:!1,is_needs_recalculation:!1,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:i,month:m,description:"delete allocations"}),{updatedMonth:m}},isPending:t.isPending,isError:t.isError,error:t.error}}async function cf(t,e,n){const i=e.trim();if(!i||n.includes(i))return null;const a=[...n,i].sort((l,u)=>l.toLowerCase().localeCompare(u.toLowerCase()));return await yt("payees",t,{budget_id:t,payees:a,updated_at:new Date().toISOString()},`adding new payee "${i}" to autocomplete list`),a}function dk(){const t=on(),{writeData:e}=Yi();return{addIncome:async(i,a,l,u,f,m,g,_)=>{const v=await Wi(i,a,l,"add income"),x={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:u,account_id:f,date:m,created_at:new Date().toISOString()};g?.trim()&&(x.payee=g.trim()),_&&(x.description=_);const w=[...v.income||[],x],A={...v,income:w,total_income:w.reduce((I,N)=>I+N.amount,0),updated_at:new Date().toISOString()};if(await e.mutateAsync({budgetId:i,month:A,description:"add income"}),g?.trim()){const I=t.getQueryData(xe.payees(i))||[],N=await cf(i,g,I);N&&t.setQueryData(xe.payees(i),N)}return{updatedMonth:A,newIncome:x}},isPending:e.isPending,isError:e.isError,error:e.error}}function hk(){const t=on(),{writeData:e}=Yi();return{updateIncome:async(i,a,l,u,f,m,g,_,v)=>{const x=await Wi(i,a,l,"update income"),w={id:u,amount:f,account_id:m,date:g,created_at:(x.income||[]).find(N=>N.id===u)?.created_at||new Date().toISOString()};_?.trim()&&(w.payee=_.trim()),v&&(w.description=v);const A=(x.income||[]).map(N=>N.id===u?w:N),I={...x,income:A,total_income:A.reduce((N,H)=>N+H.amount,0),updated_at:new Date().toISOString()};if(await e.mutateAsync({budgetId:i,month:I,description:"update income"}),_?.trim()){const N=t.getQueryData(xe.payees(i))||[],H=await cf(i,_,N);H&&t.setQueryData(xe.payees(i),H)}return{updatedMonth:I}},isPending:e.isPending,isError:e.isError,error:e.error}}function fk(){const{writeData:t}=Yi();return{deleteIncome:async(n,i,a,l)=>{const u=await Wi(n,i,a,"delete income"),f=(u.income||[]).filter(g=>g.id!==l),m={...u,income:f,total_income:f.reduce((g,_)=>g+_.amount,0),updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:n,month:m,description:"delete income"}),{updatedMonth:m}},isPending:t.isPending,isError:t.isError,error:t.error}}function mk(){const t=on(),{writeData:e}=Yi();return{addExpense:async(i,a,l,u,f,m,g,_,v,x)=>{const w=await Wi(i,a,l,"add expense"),A={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:u,category_id:f,account_id:m,date:g,created_at:new Date().toISOString()};_?.trim()&&(A.payee=_.trim()),v&&(A.description=v),x!==void 0&&(A.cleared=x);const I=[...w.expenses||[],A],N={...w,expenses:I,total_expenses:I.reduce((H,$)=>H+$.amount,0),updated_at:new Date().toISOString()};if(await e.mutateAsync({budgetId:i,month:N,description:"add expense"}),_?.trim()){const H=t.getQueryData(xe.payees(i))||[],$=await cf(i,_,H);$&&t.setQueryData(xe.payees(i),$)}return{updatedMonth:N,newExpense:A}},isPending:e.isPending,isError:e.isError,error:e.error}}function pk(){const t=on(),{writeData:e}=Yi();return{updateExpense:async(i,a,l,u,f,m,g,_,v,x,w)=>{const A=await Wi(i,a,l,"update expense"),I={id:u,amount:f,category_id:m,account_id:g,date:_,created_at:A.expenses?.find($=>$.id===u)?.created_at||new Date().toISOString()};v?.trim()&&(I.payee=v.trim()),x&&(I.description=x),w!==void 0&&(I.cleared=w);const N=(A.expenses||[]).map($=>$.id===u?I:$),H={...A,expenses:N,total_expenses:N.reduce(($,q)=>$+q.amount,0),updated_at:new Date().toISOString()};if(await e.mutateAsync({budgetId:i,month:H,description:"update expense"}),v?.trim()){const $=t.getQueryData(xe.payees(i))||[],q=await cf(i,v,$);q&&t.setQueryData(xe.payees(i),q)}return{updatedMonth:H}},isPending:e.isPending,isError:e.isError,error:e.error}}function gk(){const{writeData:t}=Yi();return{deleteExpense:async(n,i,a,l)=>{const u=await Wi(n,i,a,"delete expense"),f=(u.expenses||[]).filter(g=>g.id!==l),m={...u,expenses:f,total_expenses:f.reduce((g,_)=>g+_.amount,0),updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:n,month:m,description:"delete expense"}),{updatedMonth:m}},isPending:t.isPending,isError:t.isError,error:t.error}}function Op(t,e){return`${t}${e.toString().padStart(2,"0")}`}async function yk(t){return Sy(t,1900,1)}function _k(t){for(let e=t.length-1;e>=0;e--)if(!t[e].is_needs_recalculation)return e;return-1}async function wy(t,e={}){const{targetMonthOrdinal:n}=e,i=!n;console.log(`[Recalculation] Starting for budget ${t}`,{trigger:i?"budget":`month ${n}`});const a=await yk(t);if(a.length===0)return console.log("[Recalculation] No months found, nothing to recalculate"),i&&await bk(t),{monthsRecalculated:0,budgetUpdated:i};const l=_k(a);if(n){const x=l>=0?Op(a[l].year,a[l].month):"000000";if(x>n)throw new Error(`[Recalculation] Bug detected: Starting point (${x}) is after target month (${n}). This indicates markFutureMonthsNeedRecalculation may have an issue - months before the target are marked as needing recalculation.`)}const u=l+1;let f=a.length-1;if(n){const x=a.findIndex(w=>Op(w.year,w.month)===n);x>=0&&(f=x)}let m=rk;l>=0&&(m=Yx(a[l])),console.log(`[Recalculation] Recalculating months ${u} to ${f}`,{totalMonths:a.length,startingFrom:l>=0?Op(a[l].year,a[l].month):"beginning"});let g=0;for(let x=u;x<=f;x++){const w=a[x],A=ik(w,m);await f1({budgetId:t,month:A,description:`recalculating month ${w.year}/${w.month}`,cascadeRecalculation:!1}),m=Yx(A),g++,console.log(`[Recalculation] Completed ${w.year}/${w.month}`)}let _=!1,v;return i&&((g>0?f:l)>=0&&(v=m.accountEndBalances),await vk(t,v||{}),_=!0),console.log("[Recalculation] Complete",{monthsRecalculated:g,budgetUpdated:_}),{monthsRecalculated:g,budgetUpdated:_,finalAccountBalances:v}}async function vk(t,e){const{exists:n,data:i}=await Qe("budgets",t,"reading budget for balance update");if(!n||!i){console.warn(`[Recalculation] Budget ${t} not found when updating balances`);return}const a={...i.accounts};for(const[l,u]of Object.entries(e))a[l]&&(a[l]={...a[l],balance:u});await yt("budgets",t,{...i,accounts:a,is_needs_recalculation:!1,updated_at:new Date().toISOString()},"saving recalculated account balances")}async function bk(t){const{exists:e,data:n}=await Qe("budgets",t,"reading budget to clear recalc flag");!e||!n||await yt("budgets",t,{...n,is_needs_recalculation:!1,updated_at:new Date().toISOString()},"clearing budget recalc flag (no months to recalculate)")}function Xx(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname??"",description:i.description??"",balance:i.balance??0,account_group_id:i.account_group_id??null,sort_order:i.sort_order??0,is_income_account:i.is_income_account??!1,is_income_default:i.is_income_default??!1,is_outgo_account:i.is_outgo_account??!1,is_outgo_default:i.is_outgo_default??!1,on_budget:i.on_budget??!0,is_active:i.is_active??!0}}),e}function xk(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order??0,expected_balance:i.expected_balance??"positive",on_budget:i.on_budget,is_active:i.is_active}}),e}function Ek(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,description:i.description,category_group_id:i.category_group_id??null,sort_order:i.sort_order??0,default_monthly_amount:i.default_monthly_amount,default_monthly_type:i.default_monthly_type,balance:i.balance??0}}),e}function Sk(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,i)=>n.sort_order-i.sort_order),e}async function wk(t){const{exists:e,data:n}=await Qe("budgets",t,"loading budget data (cache miss or stale)");if(!e||!n)throw new Error(`Budget ${t} not found`);let i=Xx(n.accounts);if(n.is_needs_recalculation??!1){console.log("[Budget] Balances are stale, triggering full recalculation...");const m=await wy(t),{data:g}=await Qe("budgets",t,"reading budget after recalculation");g&&(i=Xx(g.accounts)),console.log("[Budget] Recalculation complete",{monthsRecalculated:m.monthsRecalculated})}const l=xk(n.account_groups),u=Ek(n.categories),f=Sk(n.category_groups);return{budget:{id:t,name:n.name,user_ids:n.user_ids||[],accepted_user_ids:n.accepted_user_ids||[],owner_id:n.owner_id||n.user_ids?.[0]||"",owner_email:n.owner_email||"",accounts:i,account_groups:l,categories:u,category_groups:f,is_needs_recalculation:!1},accounts:i,accountGroups:l,categories:u,categoryGroups:f,isNeedsRecalculation:!1}}function Tk(t,e){return ul({queryKey:t?xe.budget(t):["budget","none"],queryFn:()=>wk(t),enabled:!!t&&e?.enabled!==!1})}async function Ak(t){const{exists:e,data:n}=await Qe("payees",t,"loading payees for autocomplete (cache miss or stale)");return e&&n?n.payees||[]:[]}function m1(t,e){return ul({queryKey:t?xe.payees(t):["payees","none"],queryFn:()=>Ak(t),enabled:!!t&&e?.enabled!==!1})}async function Ck(t,e){const{exists:n,data:i}=await Qe("users",t,"loading user profile (cache miss or stale)");if(n&&i)return i;const a={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await yt("users",t,a,"creating new user document (first login)"),a}function Rk(t,e,n){return ul({queryKey:t?xe.user(t):["user","none"],queryFn:()=>Ck(t,e),enabled:!!t&&n?.enabled!==!1})}async function Dk(t,e){const n=await Mr("budgets","loading budgets user has access to (cache miss or stale)",[{field:"user_ids",op:"array-contains",value:t}]),i=[],a=[];for(const l of n.docs){const u=l.data;u.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(l.id)?i.push({id:l.id,name:u.name||"Unnamed Budget",ownerEmail:u.owner_email||null,isOwner:u.owner_id===t,isPending:!1}):a.push({budgetId:l.id,budgetName:u.name||"Unnamed Budget",ownerEmail:u.owner_email||null})}return{budgets:i,pendingInvites:a}}function Ik(t,e,n){return ul({queryKey:t?xe.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?Dk(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}function jk(t){if(Array.isArray(t))return t;if(t&&typeof t=="object"&&!Array.isArray(t)){const e=t;if(e._methodName==="arrayUnion"&&Array.isArray(e.vc))return console.warn("[fetchFeedback] Found corrupted arrayUnion in feedback document - extracting items from vc"),e.vc}return[]}async function Ok(){const t=await Mr("feedback","admin loading all feedback (cache miss or stale)"),e=[];for(const n of t.docs){const i=jk(n.data.items),a=n.data.user_email||n.id;i.forEach(l=>{e.push({...l,doc_id:n.id,user_email:a})})}return{items:e}}function kk(t){return ul({queryKey:xe.feedback(),queryFn:Ok,enabled:t?.enabled!==!1})}async function Mk(t,e){return Rt.fetchQuery({queryKey:["budgetInvite",t,e],queryFn:async()=>{const{exists:n,data:i}=await Qe("budgets",t,"checking if user has pending invite for budget");return!n||!i?null:{isInvited:i.user_ids?.includes(e)??!1,hasAccepted:i.accepted_user_ids?.includes(e)??!1,budgetName:i.name||"Unnamed Budget",ownerEmail:i.owner_email||null}},staleTime:60*1e3})}async function _g(t,e,n){const i=await u1(t,e,n,{description:`fetching month for balance calculation (walking ${e}/${n})`});return i?{year:i.year,month:i.month,category_balances:i.category_balances,is_needs_recalculation:i.is_needs_recalculation,are_allocations_finalized:i.are_allocations_finalized,expenses:i.expenses}:null}async function Nk(t,e,n,i){const a={};e.forEach(x=>{a[x]=0});const l=await _g(t,n,i);if(l?.category_balances&&!l.is_needs_recalculation){for(const x of l.category_balances)e.includes(x.category_id)&&(a[x.category_id]=x.end_balance);return a}const u={};e.forEach(x=>{u[x]=0});const f=[];l&&f.push(l);let m=n,g=i,_=!1;const v=120;for(let x=0;x<v&&!_;x++){const w=Ey(m,g);m=w.year,g=w.month;const A=await _g(t,m,g);if(!A)_=!0;else if(A.category_balances&&!A.is_needs_recalculation){_=!0;for(const I of A.category_balances)e.includes(I.category_id)&&(u[I.category_id]=I.end_balance)}else f.push(A)}f.reverse(),Object.assign(a,u);for(const x of f){if(x.are_allocations_finalized&&x.category_balances)for(const w of x.category_balances)e.includes(w.category_id)&&(a[w.category_id]=(a[w.category_id]||0)+w.allocated);if(x.expenses)for(const w of x.expenses)e.includes(w.category_id)&&(a[w.category_id]=(a[w.category_id]||0)-w.amount)}return a}async function Pk(t,e,n,i,a){const l={...n};let u=i,f=a;const m=24;for(let g=0;g<m;g++){const _=HO(u,f);u=_.year,f=_.month;const v=await _g(t,u,f);if(!v)break;if(v.are_allocations_finalized&&v.category_balances)for(const x of v.category_balances)e.includes(x.category_id)&&(l[x.category_id]=(l[x.category_id]||0)+x.allocated);if(v.expenses)for(const x of v.expenses)e.includes(x.category_id)&&(l[x.category_id]=(l[x.category_id]||0)-x.amount)}return l}async function Jx(t,e,n,i){const a=await Nk(t,e,n,i),l=await Pk(t,e,a,n,i);return{current:a,total:l}}function p1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Lk=p1,g1=new ru("auth","Firebase",p1());const Ih=new Lg("@firebase/auth");function Vk(t,...e){Ih.logLevel<=Je.WARN&&Ih.warn(`Auth (${hl}): ${t}`,...e)}function oh(t,...e){Ih.logLevel<=Je.ERROR&&Ih.error(`Auth (${hl}): ${t}`,...e)}function Vr(t,...e){throw Ty(t,...e)}function di(t,...e){return Ty(t,...e)}function y1(t,e,n){const i={...Lk(),[e]:n};return new ru("auth","Firebase",i).create(e,{appName:t.name})}function qs(t){return y1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ty(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return g1.create(t,...e)}function Ve(t,e,...n){if(!t)throw Ty(e,...n)}function Pi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw oh(e),new Error(e)}function $i(t,e){t||Pi(e)}function vg(){return typeof self<"u"&&self.location?.href||""}function zk(){return Zx()==="http:"||Zx()==="https:"}function Zx(){return typeof self<"u"&&self.location?.protocol||null}function Uk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zk()||YD()||"connection"in navigator)?navigator.onLine:!0}function Bk(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class fu{constructor(e,n){this.shortDelay=e,this.longDelay=n,$i(n>e,"Short delay should be less than long delay!"),this.isMobile=$D()||XD()}get(){return Uk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ay(t,e){$i(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class _1{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Pi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Pi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Pi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Fk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const qk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Hk=new fu(3e4,6e4);function Ba(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ta(t,e,n,i,a={}){return v1(t,a,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const f=iu({key:t.config.apiKey,...u}).slice(1),m=await t._getAdditionalHeaders();m["Content-Type"]="application/json",t.languageCode&&(m["X-Firebase-Locale"]=t.languageCode);const g={method:e,headers:m,...l};return WD()||(g.referrerPolicy="no-referrer"),t.emulatorConfig&&dl(t.emulatorConfig.host)&&(g.credentials="include"),_1.fetch()(await b1(t,t.config.apiHost,n,f),g)})}async function v1(t,e,n){t._canInitEmulator=!1;const i={...Fk,...e};try{const a=new Qk(t),l=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw Jd(t,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const f=l.ok?u.errorMessage:u.error.message,[m,g]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jd(t,"credential-already-in-use",u);if(m==="EMAIL_EXISTS")throw Jd(t,"email-already-in-use",u);if(m==="USER_DISABLED")throw Jd(t,"user-disabled",u);const _=i[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw y1(t,_,g);Vr(t,_)}}catch(a){if(a instanceof Ki)throw a;Vr(t,"network-request-failed",{message:String(a)})}}async function uf(t,e,n,i,a={}){const l=await ta(t,e,n,i,a);return"mfaPendingCredential"in l&&Vr(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function b1(t,e,n,i){const a=`${e}${n}?${i}`,l=t,u=l.config.emulator?Ay(t.config,a):`${t.config.apiScheme}://${a}`;return qk.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function Gk(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Qk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(di(this.auth,"network-request-failed")),Hk.get())})}}function Jd(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=di(t,e,i);return a.customData._tokenResponse=n,a}function eE(t){return t!==void 0&&t.enterprise!==void 0}class $k{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Gk(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Kk(t,e){return ta(t,"GET","/v2/recaptchaConfig",Ba(t,e))}async function Wk(t,e){return ta(t,"POST","/v1/accounts:delete",e)}async function jh(t,e){return ta(t,"POST","/v1/accounts:lookup",e)}function Uc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Yk(t,e=!1){const n=fn(t),i=await n.getIdToken(e),a=Cy(i);Ve(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:i,authTime:Uc(kp(a.auth_time)),issuedAtTime:Uc(kp(a.iat)),expirationTime:Uc(kp(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function kp(t){return Number(t)*1e3}function Cy(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return oh("JWT malformed, contained fewer than 3 sections"),null;try{const a=bS(n);return a?JSON.parse(a):(oh("Failed to decode base64 JWT payload"),null)}catch(a){return oh("Caught error parsing JWT payload as JSON",a?.toString()),null}}function tE(t){const e=Cy(t);return Ve(e,"internal-error"),Ve(typeof e.exp<"u","internal-error"),Ve(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Wc(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Ki&&Xk(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function Xk({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class Jk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class bg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Uc(this.lastLoginAt),this.creationTime=Uc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Oh(t){const e=t.auth,n=await t.getIdToken(),i=await Wc(t,jh(e,{idToken:n}));Ve(i?.users.length,e,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=a.providerUserInfo?.length?x1(a.providerUserInfo):[],u=eM(t.providerData,l),f=t.isAnonymous,m=!(t.email&&a.passwordHash)&&!u?.length,g=f?m:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new bg(a.createdAt,a.lastLoginAt),isAnonymous:g};Object.assign(t,_)}async function Zk(t){const e=fn(t);await Oh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function eM(t,e){return[...t.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function x1(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function tM(t,e){const n=await v1(t,{},async()=>{const i=iu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,u=await b1(t,a,"/v1/token",`key=${l}`),f=await t._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:i};return t.emulatorConfig&&dl(t.emulatorConfig.host)&&(m.credentials="include"),_1.fetch()(u,m)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function nM(t,e){return ta(t,"POST","/v2/accounts:revokeToken",Ba(t,e))}class Ho{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ve(e.idToken,"internal-error"),Ve(typeof e.idToken<"u","internal-error"),Ve(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ve(e.length!==0,"internal-error");const n=tE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ve(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:a,expiresIn:l}=await tM(e,n);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:a,expirationTime:l}=n,u=new Ho;return i&&(Ve(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),a&&(Ve(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(Ve(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ho,this.toJSON())}_performRefresh(){return Pi("not implemented")}}function Is(t,e){Ve(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Nr{constructor({uid:e,auth:n,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new Jk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new bg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await Wc(this,this.stsTokenManager.getToken(this.auth,e));return Ve(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Yk(this,e)}reload(){return Zk(this)}_assign(e){this!==e&&(Ve(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Nr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ve(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Oh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(kr(this.auth.app))return Promise.reject(qs(this.auth));const e=await this.getIdToken();return await Wc(this,Wk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,a=n.email??void 0,l=n.phoneNumber??void 0,u=n.photoURL??void 0,f=n.tenantId??void 0,m=n._redirectEventId??void 0,g=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:v,emailVerified:x,isAnonymous:w,providerData:A,stsTokenManager:I}=n;Ve(v&&I,e,"internal-error");const N=Ho.fromJSON(this.name,I);Ve(typeof v=="string",e,"internal-error"),Is(i,e.name),Is(a,e.name),Ve(typeof x=="boolean",e,"internal-error"),Ve(typeof w=="boolean",e,"internal-error"),Is(l,e.name),Is(u,e.name),Is(f,e.name),Is(m,e.name),Is(g,e.name),Is(_,e.name);const H=new Nr({uid:v,auth:e,email:a,emailVerified:x,displayName:i,isAnonymous:w,photoURL:u,phoneNumber:l,tenantId:f,stsTokenManager:N,createdAt:g,lastLoginAt:_});return A&&Array.isArray(A)&&(H.providerData=A.map($=>({...$}))),m&&(H._redirectEventId=m),H}static async _fromIdTokenResponse(e,n,i=!1){const a=new Ho;a.updateFromServerResponse(n);const l=new Nr({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Oh(l),l}static async _fromGetAccountInfoResponse(e,n,i){const a=n.users[0];Ve(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?x1(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,f=new Ho;f.updateFromIdToken(i);const m=new Nr({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:u}),g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new bg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(m,g),m}}const nE=new Map;function Li(t){$i(t instanceof Function,"Expected a class definition");let e=nE.get(t);return e?($i(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,nE.set(t,e),e)}class E1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}E1.type="NONE";const rE=E1;function lh(t,e,n){return`firebase:${t}:${e}:${n}`}class Go{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=lh(this.userKey,a.apiKey,l),this.fullPersistenceKey=lh("persistence",a.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await jh(this.auth,{idToken:e}).catch(()=>{});return n?Nr._fromGetAccountInfoResponse(this.auth,n,e):null}return Nr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Go(Li(rE),e,i);const a=(await Promise.all(n.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let l=a[0]||Li(rE);const u=lh(i,e.config.apiKey,e.name);let f=null;for(const g of n)try{const _=await g._get(u);if(_){let v;if(typeof _=="string"){const x=await jh(e,{idToken:_}).catch(()=>{});if(!x)break;v=await Nr._fromGetAccountInfoResponse(e,x,_)}else v=Nr._fromJSON(e,_);g!==l&&(f=v),l=g;break}}catch{}const m=a.filter(g=>g._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new Go(l,e,i):(l=m[0],f&&await l._set(u,f.toJSON()),await Promise.all(n.map(async g=>{if(g!==l)try{await g._remove(u)}catch{}})),new Go(l,e,i))}}function iE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(A1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(S1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(R1(e))return"Blackberry";if(D1(e))return"Webos";if(w1(e))return"Safari";if((e.includes("chrome/")||T1(e))&&!e.includes("edge/"))return"Chrome";if(C1(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function S1(t=Rn()){return/firefox\//i.test(t)}function w1(t=Rn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function T1(t=Rn()){return/crios\//i.test(t)}function A1(t=Rn()){return/iemobile/i.test(t)}function C1(t=Rn()){return/android/i.test(t)}function R1(t=Rn()){return/blackberry/i.test(t)}function D1(t=Rn()){return/webos/i.test(t)}function Ry(t=Rn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function rM(t=Rn()){return Ry(t)&&!!window.navigator?.standalone}function iM(){return JD()&&document.documentMode===10}function I1(t=Rn()){return Ry(t)||C1(t)||D1(t)||R1(t)||/windows phone/i.test(t)||A1(t)}function j1(t,e=[]){let n;switch(t){case"Browser":n=iE(Rn());break;case"Worker":n=`${iE(Rn())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${hl}/${i}`}class sM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=l=>new Promise((u,f)=>{try{const m=e(l);u(m)}catch(m){f(m)}});i.onAbort=n,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function aM(t,e={}){return ta(t,"GET","/v2/passwordPolicy",Ba(t,e))}const oM=6;class lM{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??oM,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class cM{constructor(e,n,i,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sE(this),this.idTokenSubscription=new sE(this),this.beforeStateQueue=new sM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=g1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Li(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Go.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await jh(this,{idToken:e}),i=await Nr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(kr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=i?._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===u)&&f?.user&&(i=f.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ve(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Oh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Bk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(kr(this.app))return Promise.reject(qs(this));const n=e?fn(e):null;return n&&Ve(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ve(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return kr(this.app)?Promise.reject(qs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return kr(this.app)?Promise.reject(qs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Li(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aM(this),n=new lM(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ru("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await nM(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Li(e)||this._popupRedirectResolver;Ve(n,this,"argument-error"),this.redirectPersistenceManager=await Go.create(this,[Li(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,a){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let u=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ve(f,this,"internal-error"),f.then(()=>{u||l(this.currentUser)}),typeof n=="function"){const m=e.addObserver(n,i,a);return()=>{u=!0,m()}}else{const m=e.addObserver(n);return()=>{u=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ve(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=j1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(kr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Vk(`Error while retrieving App Check token: ${e.error}`),e?.token}}function bl(t){return fn(t)}class sE{constructor(e){this.auth=e,this.observer=null,this.addObserver=aI(n=>this.observer=n)}get next(){return Ve(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let df={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uM(t){df=t}function O1(t){return df.loadJS(t)}function dM(){return df.recaptchaEnterpriseScript}function hM(){return df.gapiScript}function fM(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class mM{constructor(){this.enterprise=new pM}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class pM{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const gM="recaptcha-enterprise",k1="NO_RECAPTCHA";class yM{constructor(e){this.type=gM,this.auth=bl(e)}async verify(e="verify",n=!1){async function i(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,f)=>{Kk(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const g=new $k(m);return l.tenantId==null?l._agentRecaptchaConfig=g:l._tenantRecaptchaConfigs[l.tenantId]=g,u(g.siteKey)}}).catch(m=>{f(m)})})}function a(l,u,f){const m=window.grecaptcha;eE(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(g=>{u(g)}).catch(()=>{u(k1)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new mM().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(f=>{if(!n&&eE(window.grecaptcha))a(f,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let m=dM();m.length!==0&&(m+=f),O1(m).then(()=>{a(f,l,u)}).catch(g=>{u(g)})}}).catch(f=>{u(f)})})}}async function aE(t,e,n,i=!1,a=!1){const l=new yM(t);let u;if(a)u=k1;else try{u=await l.verify(n)}catch{u=await l.verify(n,!0)}const f={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,g=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:u}):Object.assign(f,{captchaResponse:u}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function oE(t,e,n,i,a){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await aE(t,e,n,n==="getOobCode");return i(t,l)}else return i(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await aE(t,e,n,n==="getOobCode");return i(t,u)}else return Promise.reject(l)})}function _M(t,e){const n=zg(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),l=n.getOptions();if(Qs(l,e??{}))return a;Vr(a,"already-initialized")}return n.initialize({options:e})}function vM(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(Li);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function bM(t,e,n){const i=bl(t);Ve(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=M1(e),{host:u,port:f}=xM(e),m=f===null?"":`:${f}`,g={url:`${l}//${u}${m}/`},_=Object.freeze({host:u,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Ve(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ve(Qs(g,i.config.emulator)&&Qs(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,dl(u)?(wS(`${l}//${u}${m}`),TS("Auth",!0)):EM()}function M1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function xM(t){const e=M1(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:lE(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:lE(u)}}}function lE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function EM(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Dy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Pi("not implemented")}_getIdTokenResponse(e){return Pi("not implemented")}_linkToIdToken(e,n){return Pi("not implemented")}_getReauthenticationResolver(e){return Pi("not implemented")}}async function SM(t,e){return ta(t,"POST","/v1/accounts:signUp",e)}async function wM(t,e){return uf(t,"POST","/v1/accounts:signInWithPassword",Ba(t,e))}async function TM(t,e){return uf(t,"POST","/v1/accounts:signInWithEmailLink",Ba(t,e))}async function AM(t,e){return uf(t,"POST","/v1/accounts:signInWithEmailLink",Ba(t,e))}class Yc extends Dy{constructor(e,n,i,a=null){super("password",i),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new Yc(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new Yc(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return oE(e,n,"signInWithPassword",wM);case"emailLink":return TM(e,{email:this._email,oobCode:this._password});default:Vr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return oE(e,i,"signUpPassword",SM);case"emailLink":return AM(e,{idToken:n,email:this._email,oobCode:this._password});default:Vr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Qo(t,e){return uf(t,"POST","/v1/accounts:signInWithIdp",Ba(t,e))}const CM="http://localhost";class Va extends Dy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Va(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Vr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=n;if(!i||!a)return null;const u=new Va(i,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const n=this.buildRequest();return Qo(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,Qo(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Qo(e,n)}buildRequest(){const e={requestUri:CM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=iu(n)}return e}}function RM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DM(t){const e=Dc(Ic(t)).link,n=e?Dc(Ic(e)).deep_link_id:null,i=Dc(Ic(t)).deep_link_id;return(i?Dc(Ic(i)).link:null)||i||n||e||t}class Iy{constructor(e){const n=Dc(Ic(e)),i=n.apiKey??null,a=n.oobCode??null,l=RM(n.mode??null);Ve(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=DM(e);try{return new Iy(n)}catch{return null}}}class xl{constructor(){this.providerId=xl.PROVIDER_ID}static credential(e,n){return Yc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Iy.parseLink(n);return Ve(i,"argument-error"),Yc._fromEmailAndCode(e,i.code,i.tenantId)}}xl.PROVIDER_ID="password";xl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";xl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class N1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class mu extends N1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Os extends mu{constructor(){super("facebook.com")}static credential(e){return Va._fromParams({providerId:Os.PROVIDER_ID,signInMethod:Os.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Os.credentialFromTaggedObject(e)}static credentialFromError(e){return Os.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Os.credential(e.oauthAccessToken)}catch{return null}}}Os.FACEBOOK_SIGN_IN_METHOD="facebook.com";Os.PROVIDER_ID="facebook.com";class ks extends mu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Va._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return ks.credential(n,i)}catch{return null}}}ks.GOOGLE_SIGN_IN_METHOD="google.com";ks.PROVIDER_ID="google.com";class Ms extends mu{constructor(){super("github.com")}static credential(e){return Va._fromParams({providerId:Ms.PROVIDER_ID,signInMethod:Ms.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ms.credentialFromTaggedObject(e)}static credentialFromError(e){return Ms.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ms.credential(e.oauthAccessToken)}catch{return null}}}Ms.GITHUB_SIGN_IN_METHOD="github.com";Ms.PROVIDER_ID="github.com";class Ns extends mu{constructor(){super("twitter.com")}static credential(e,n){return Va._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ns.credentialFromTaggedObject(e)}static credentialFromError(e){return Ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return Ns.credential(n,i)}catch{return null}}}Ns.TWITTER_SIGN_IN_METHOD="twitter.com";Ns.PROVIDER_ID="twitter.com";class nl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,a=!1){const l=await Nr._fromIdTokenResponse(e,i,a),u=cE(i);return new nl({user:l,providerId:u,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const a=cE(i);return new nl({user:e,providerId:a,_tokenResponse:i,operationType:n})}}function cE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class kh extends Ki{constructor(e,n,i,a){super(n.code,n.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,kh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,a){return new kh(e,n,i,a)}}function P1(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?kh._fromErrorAndOperation(t,l,e,i):l})}async function IM(t,e,n=!1){const i=await Wc(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return nl._forOperation(t,"link",i)}async function jM(t,e,n=!1){const{auth:i}=t;if(kr(i.app))return Promise.reject(qs(i));const a="reauthenticate";try{const l=await Wc(t,P1(i,a,e,t),n);Ve(l.idToken,i,"internal-error");const u=Cy(l.idToken);Ve(u,i,"internal-error");const{sub:f}=u;return Ve(t.uid===f,i,"user-mismatch"),nl._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Vr(i,"user-mismatch"),l}}async function L1(t,e,n=!1){if(kr(t.app))return Promise.reject(qs(t));const i="signIn",a=await P1(t,i,e),l=await nl._fromIdTokenResponse(t,i,a);return n||await t._updateCurrentUser(l.user),l}async function OM(t,e){return L1(bl(t),e)}async function kM(t){const e=bl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function MM(t,e,n){return kr(t.app)?Promise.reject(qs(t)):OM(fn(t),xl.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&kM(t),i})}function NM(t,e,n,i){return fn(t).onIdTokenChanged(e,n,i)}function PM(t,e,n){return fn(t).beforeAuthStateChanged(e,n)}function LM(t,e,n,i){return fn(t).onAuthStateChanged(e,n,i)}function VM(t){return fn(t).signOut()}const Mh="__sak";class V1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Mh,"1"),this.storage.removeItem(Mh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const zM=1e3,UM=10;class z1 extends V1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=I1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),a=this.localCache[n];i!==a&&e(n,a,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((u,f,m)=>{this.notifyListeners(u,m)});return}const i=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(i);!n&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);iM()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,UM):a()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},zM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}z1.type="LOCAL";const BM=z1;class U1 extends V1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}U1.type="SESSION";const B1=U1;function FM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class hf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const i=new hf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:a,data:l}=n.data,u=this.handlersMap[a];if(!u?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const f=Array.from(u).map(async g=>g(n.origin,l)),m=await FM(f);n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:m})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}hf.receivers=[];function jy(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class qM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((f,m)=>{const g=jy("",20);a.port1.start();const _=setTimeout(()=>{m(new Error("unsupported_event"))},i);u={messageChannel:a,onMessage(v){const x=v;if(x.data.eventId===g)switch(x.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(x.data.response);break;default:clearTimeout(_),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:g,data:n},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function hi(){return window}function HM(t){hi().location.href=t}function F1(){return typeof hi().WorkerGlobalScope<"u"&&typeof hi().importScripts=="function"}async function GM(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function QM(){return navigator?.serviceWorker?.controller||null}function $M(){return F1()?self:null}const q1="firebaseLocalStorageDb",KM=1,Nh="firebaseLocalStorage",H1="fbase_key";class pu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function ff(t,e){return t.transaction([Nh],e?"readwrite":"readonly").objectStore(Nh)}function WM(){const t=indexedDB.deleteDatabase(q1);return new pu(t).toPromise()}function xg(){const t=indexedDB.open(q1,KM);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Nh,{keyPath:H1})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Nh)?e(i):(i.close(),await WM(),e(await xg()))})})}async function uE(t,e,n){const i=ff(t,!0).put({[H1]:e,value:n});return new pu(i).toPromise()}async function YM(t,e){const n=ff(t,!1).get(e),i=await new pu(n).toPromise();return i===void 0?null:i.value}function dE(t,e){const n=ff(t,!0).delete(e);return new pu(n).toPromise()}const XM=800,JM=3;class G1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await xg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>JM)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return F1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=hf._getInstance($M()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await GM(),!this.activeServiceWorker)return;this.sender=new qM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||QM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await xg();return await uE(e,Mh,"1"),await dE(e,Mh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>uE(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>YM(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>dE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=ff(a,!1).getAll();return new pu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),XM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}G1.type="LOCAL";const ZM=G1;new fu(3e4,6e4);function eN(t,e){return e?Li(e):(Ve(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class Oy extends Dy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Qo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Qo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Qo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function tN(t){return L1(t.auth,new Oy(t),t.bypassAuthState)}function nN(t){const{auth:e,user:n}=t;return Ve(n,e,"internal-error"),jM(n,new Oy(t),t.bypassAuthState)}async function rN(t){const{auth:e,user:n}=t;return Ve(n,e,"internal-error"),IM(n,new Oy(t),t.bypassAuthState)}class Q1{constructor(e,n,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:a,tenantId:l,error:u,type:f}=e;if(u){this.reject(u);return}const m={auth:this.auth,requestUri:n,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tN;case"linkViaPopup":case"linkViaRedirect":return rN;case"reauthViaPopup":case"reauthViaRedirect":return nN;default:Vr(this.auth,"internal-error")}}resolve(e){$i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){$i(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const iN=new fu(2e3,1e4);class Bo extends Q1{constructor(e,n,i,a,l){super(e,n,a,l),this.provider=i,this.authWindow=null,this.pollId=null,Bo.currentPopupAction&&Bo.currentPopupAction.cancel(),Bo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ve(e,this.auth,"internal-error"),e}async onExecution(){$i(this.filter.length===1,"Popup operations only handle one event");const e=jy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(di(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(di(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(di(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,iN.get())};e()}}Bo.currentPopupAction=null;const sN="pendingRedirect",ch=new Map;class aN extends Q1{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=ch.get(this.auth._key());if(!e){try{const i=await oN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}ch.set(this.auth._key(),e)}return this.bypassAuthState||ch.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function oN(t,e){const n=uN(e),i=cN(t);if(!await i._isAvailable())return!1;const a=await i._get(n)==="true";return await i._remove(n),a}function lN(t,e){ch.set(t._key(),e)}function cN(t){return Li(t._redirectPersistence)}function uN(t){return lh(sN,t.config.apiKey,t.name)}async function dN(t,e,n=!1){if(kr(t.app))return Promise.reject(qs(t));const i=bl(t),a=eN(i,e),u=await new aN(i,a,n).execute();return u&&!n&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}const hN=600*1e3;class fN{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!mN(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!$1(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(di(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=hN&&this.cachedEventUids.clear(),this.cachedEventUids.has(hE(e))}saveEventToCache(e){this.cachedEventUids.add(hE(e)),this.lastProcessedEventTime=Date.now()}}function hE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function $1({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function mN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $1(t);default:return!1}}async function pN(t,e={}){return ta(t,"GET","/v1/projects",e)}const gN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yN=/^https?/;async function _N(t){if(t.config.emulator)return;const{authorizedDomains:e}=await pN(t);for(const n of e)try{if(vN(n))return}catch{}Vr(t,"unauthorized-domain")}function vN(t){const e=vg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const u=new URL(t);return u.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&u.hostname===i}if(!yN.test(n))return!1;if(gN.test(t))return i===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const bN=new fu(3e4,6e4);function fE(){const t=hi().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function xN(t){return new Promise((e,n)=>{function i(){fE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fE(),n(di(t,"network-request-failed"))},timeout:bN.get()})}if(hi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(hi().gapi?.load)i();else{const a=fM("iframefcb");return hi()[a]=()=>{gapi.load?i():n(di(t,"network-request-failed"))},O1(`${hM()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw uh=null,e})}let uh=null;function EN(t){return uh=uh||xN(t),uh}const SN=new fu(5e3,15e3),wN="__/auth/iframe",TN="emulator/auth/iframe",AN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function RN(t){const e=t.config;Ve(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ay(e,TN):`https://${t.config.authDomain}/${wN}`,i={apiKey:e.apiKey,appName:t.name,v:hl},a=CN.get(t.config.apiHost);a&&(i.eid=a);const l=t._getFrameworks();return l.length&&(i.fw=l.join(",")),`${n}?${iu(i).slice(1)}`}async function DN(t){const e=await EN(t),n=hi().gapi;return Ve(n,t,"internal-error"),e.open({where:document.body,url:RN(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:AN,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const u=di(t,"network-request-failed"),f=hi().setTimeout(()=>{l(u)},SN.get());function m(){hi().clearTimeout(f),a(i)}i.ping(m).then(m,()=>{l(u)})}))}const IN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},jN=500,ON=600,kN="_blank",MN="http://localhost";class mE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function NN(t,e,n,i=jN,a=ON){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const m={...IN,width:i.toString(),height:a.toString(),top:l,left:u},g=Rn().toLowerCase();n&&(f=T1(g)?kN:n),S1(g)&&(e=e||MN,m.scrollbars="yes");const _=Object.entries(m).reduce((x,[w,A])=>`${x}${w}=${A},`,"");if(rM(g)&&f!=="_self")return PN(e||"",f),new mE(null);const v=window.open(e||"",f,_);Ve(v,t,"popup-blocked");try{v.focus()}catch{}return new mE(v)}function PN(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const LN="__/auth/handler",VN="emulator/auth/handler",zN=encodeURIComponent("fac");async function pE(t,e,n,i,a,l){Ve(t.config.authDomain,t,"auth-domain-config-required"),Ve(t.config.apiKey,t,"invalid-api-key");const u={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:hl,eventId:a};if(e instanceof N1){e.setDefaultLanguage(t.languageCode),u.providerId=e.providerId||"",sI(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))u[_]=v}if(e instanceof mu){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(u.scopes=_.join(","))}t.tenantId&&(u.tid=t.tenantId);const f=u;for(const _ of Object.keys(f))f[_]===void 0&&delete f[_];const m=await t._getAppCheckToken(),g=m?`#${zN}=${encodeURIComponent(m)}`:"";return`${UN(t)}?${iu(f).slice(1)}${g}`}function UN({config:t}){return t.emulator?Ay(t,VN):`https://${t.authDomain}/${LN}`}const Mp="webStorageSupport";class BN{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=B1,this._completeRedirectFn=dN,this._overrideRedirectResult=lN}async _openPopup(e,n,i,a){$i(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await pE(e,n,i,vg(),a);return NN(e,l,jy())}async _openRedirect(e,n,i,a){await this._originValidation(e);const l=await pE(e,n,i,vg(),a);return HM(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:l}=this.eventManagers[n];return a?Promise.resolve(a):($i(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await DN(e),i=new fN(e);return n.register("authEvent",a=>(Ve(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Mp,{type:Mp},a=>{const l=a?.[0]?.[Mp];l!==void 0&&n(!!l),Vr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=_N(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return I1()||w1()||Ry()}}const FN=BN;var gE="@firebase/auth",yE="1.12.0";class qN{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ve(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function HN(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function GN(t){Ko(new Na("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:f}=i.options;Ve(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const m={apiKey:u,authDomain:f,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:j1(t)},g=new cM(i,a,l,m);return vM(g,n),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),Ko(new Na("auth-internal",e=>{const n=bl(e.getProvider("auth").getImmediate());return(i=>new qN(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Us(gE,yE,HN(t)),Us(gE,yE,"esm2020")}const QN=300,$N=SS("authIdTokenMaxAge")||QN;let _E=null;const KN=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>$N)return;const a=n?.token;_E!==a&&(_E=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function WN(t=DS()){const e=zg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=_M(t,{popupRedirectResolver:FN,persistence:[ZM,BM,B1]}),i=SS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=KN(l.toString());PM(n,u,()=>u(n.currentUser)),NM(n,f=>u(f))}}const a=xS("auth");return a&&bM(n,`http://${a}`),n}function YN(){return document.getElementsByTagName("head")?.[0]??document}uM({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=a=>{const l=di("internal-error");l.customData=a,n(l)},i.type="text/javascript",i.charset="UTF-8",YN().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});GN("Browser");function Fa(){const t=WN(OS);async function e(){return!1}async function n(f,m){return MM(t,f,m)}function i(){return VM(t)}function a(f){LM(t,m=>{f(m)})}function l(){return t.currentUser}return{set_user_listener:a,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:i,get_current_firebase_user:l}}const XN={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,lastActiveTab:"balances",lastSettingsTab:"categories",lastAdminTab:"budget",lastBalancesView:"categories",setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},setLastActiveTab:()=>{},setLastSettingsTab:()=>{},setLastAdminTab:()=>{},setLastBalancesView:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},K1=T.createContext(XN);function JN({children:t}){const n=Fa().get_current_firebase_user(),[i,a]=T.useState(null),[l,u]=T.useState(new Date().getFullYear()),[f,m]=T.useState(new Date().getMonth()+1),[g,_]=T.useState("balances"),[v,x]=T.useState("categories"),[w,A]=T.useState("budget"),[I,N]=T.useState("categories"),[H,$]=T.useState(!1),[q,me]=T.useState(!1),ie=Rk(n?.uid||null,n?.email||null),he=ie.data&&ie.data.budget_ids.length===0,L=Ik(n?.uid||null,ie.data||null,{enabled:!!n?.uid&&!!ie.data&&he}),R=ie.data?.permission_flags?.is_admin===!0,D=ie.data?.permission_flags?.is_test===!0,M=L.data?.pendingInvites||[],j=L.data?.budgets||[],O=M.length>0;T.useEffect(()=>{if(!n||H||ie.isLoading)return;const J=ie.data;if(!(!J&&!ie.isError))if(J&&J.budget_ids.length>0)a(J.budget_ids[0]),me(!1),$(!0);else{if(L.isLoading)return;const z=L.data;z?.pendingInvites&&z.pendingInvites.length>0?me(!1):me(!0),$(!0)}},[n,H,ie.data,ie.isLoading,ie.isError,L.data,L.isLoading]);const C=T.useCallback(()=>{m(J=>J===1?(u(z=>z-1),12):J-1)},[]),Y=T.useCallback(()=>{m(J=>J===12?(u(z=>z+1),1):J+1)},[]),U=T.useCallback(async()=>{await L.refetch()},[L]),P=T.useCallback(J=>{a(J)},[]),B=T.useCallback(async J=>{if(!n)return null;try{const z=await Mk(J,n.uid);return z&&z.isInvited&&!z.hasAccepted?{budgetId:J,budgetName:z.budgetName,ownerEmail:z.ownerEmail}:null}catch(z){return console.error("[BudgetContext] Error checking budget invite:",z),null}},[n]),Q=T.useCallback(()=>{localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),le={currentUserId:n?.uid||null,selectedBudgetId:i,currentYear:l,currentMonthNumber:f,lastActiveTab:g,lastSettingsTab:v,lastAdminTab:w,lastBalancesView:I,setSelectedBudgetId:a,setCurrentYear:u,setCurrentMonthNumber:m,setLastActiveTab:_,setLastSettingsTab:x,setLastAdminTab:A,setLastBalancesView:N,isInitialized:H,needsFirstBudget:q,goToPreviousMonth:C,goToNextMonth:Y,pendingInvites:M,hasPendingInvites:O,accessibleBudgets:j,isAdmin:R,isTest:D,loadAccessibleBudgets:U,switchToBudget:P,checkBudgetInvite:B,clearCache:Q};return d.jsx(K1.Provider,{value:le,children:t})}function Sn(){const t=T.useContext(K1);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}const Vi={mobile:640,wide:1200},ZN=Vi.mobile,mf=["January","February","March","April","May","June","July","August","September","October","November","December"],ce={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15"},qn={maxWidth:"var(--page-max-width, 85rem)",margin:"0 auto",padding:"var(--page-padding, 2rem)"},gu={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},eP={...gu,padding:"0.6rem 0.875rem",gap:"0.5rem"},tP={background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1rem 1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},nP={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},rP={display:"flex",flexDirection:"column",gap:"0.5rem"},iP={fontSize:"0.9rem",fontWeight:500},qa={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit"},sP={...qa,cursor:"pointer"},ky={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},W1={...ky,background:ce.primary,color:"white",border:"none"},aP={...W1,padding:"0.75rem 1.5rem",borderRadius:"8px"},oP={...ky,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},lP={...ky,background:"transparent",border:`1px solid ${ce.errorBorder}`,color:ce.error},cP={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},uP={display:"flex",gap:"0.5rem"},dP={display:"flex",gap:"0.25rem"},Y1={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},hP={...Y1,borderColor:ce.errorBorder,color:ce.error},rl={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},My={display:"flex",flexDirection:"column",gap:"2px"},fP={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},X1={opacity:.4,cursor:"grab"},J1={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",transition:"opacity 0.15s"},mP={position:"relative",height:"2rem",marginTop:"-0.25rem"},pP={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",transition:"opacity 0.15s"},gP={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},yP={background:ce.errorBg,border:`1px solid ${ce.errorBorder}`,color:ce.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},_P={background:"transparent",border:"none",color:ce.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},Xc={opacity:.7,marginBottom:"1.5rem"},El={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},Ny={fontWeight:500,fontSize:"1.1rem"},il={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function vP(){return d.jsxs("div",{style:qn,children:[d.jsx("nav",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:d.jsx(Dt,{to:"/",style:{display:"flex",alignItems:"center"},title:"Tarron Lane Home",children:d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane Home",style:{width:"2rem",height:"2rem"}})})}),d.jsx("h1",{children:"Tarron Lane Homepage"}),d.jsx("nav",{children:d.jsxs("ul",{children:[d.jsx("li",{children:d.jsx(Dt,{to:"/sql-test",children:"SQL Test"})}),d.jsx("li",{children:d.jsx(Dt,{to:"/budget",children:"Budget"})}),d.jsx("li",{children:d.jsx(Dt,{to:"/account",children:"Account"})})]})})]})}function $o({children:t}){return d.jsx("div",{style:qn,children:t})}function Sl({message:t,children:e,onDismiss:n,style:i}){return d.jsxs("div",{style:{...yP,...i},children:[d.jsx("span",{children:e??t}),n&&d.jsx("button",{onClick:n,style:_P,children:""})]})}const bP={primary:W1,"primary-large":aP,secondary:oP,danger:lP,small:cP};function Le({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:i,disabled:a,style:l,...u}){const f=bP[t],m=a||e;return d.jsx("button",{disabled:m,style:{...f,cursor:m?"not-allowed":"pointer",opacity:m?.7:1,...l},...u,children:e?n:i})}function Eg(t,e){const n=t.toLowerCase(),i=e.toLowerCase();if(i.includes(n)){const f=i.indexOf(n);return{match:!0,score:f===0||/\s/.test(i[f-1])?100:90}}let a=0,l=0,u=0;for(let f=0;f<i.length&&a<n.length;f++)i[f]===n[a]?(a++,u++,l+=u*2):u=0;return a===n.length?{match:!0,score:l}:{match:!1,score:0}}function Np({id:t,value:e,onChange:n,payees:i,placeholder:a="Enter payee name"}){const[l,u]=T.useState(!1),[f,m]=T.useState(-1),g=T.useRef(null),_=T.useRef(null),v=e.trim()?i.map(A=>({payee:A,...Eg(e,A)})).filter(A=>A.match).sort((A,I)=>I.score-A.score).slice(0,8).map(A=>A.payee):[];T.useEffect(()=>{function A(I){g.current&&!g.current.contains(I.target)&&u(!1)}return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]);function x(A){!l||v.length===0||(A.key==="ArrowDown"?(A.preventDefault(),m(I=>Math.min(I+1,v.length-1))):A.key==="ArrowUp"?(A.preventDefault(),m(I=>Math.max(I-1,-1))):A.key==="Enter"&&f>=0?(A.preventDefault(),n(v[f]),u(!1),m(-1)):A.key==="Escape"&&(u(!1),m(-1)))}function w(A){n(A),u(!1),m(-1),_.current?.focus()}return d.jsxs("div",{ref:g,style:{position:"relative"},children:[d.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:A=>{n(A.target.value),u(!0),m(-1)},onFocus:()=>u(!0),onKeyDown:x,placeholder:a,autoComplete:"off",style:qa}),l&&v.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:v.map((A,I)=>d.jsx("div",{onClick:()=>w(A),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:I===f?`color-mix(in srgb, ${ce.primary} 20%, transparent)`:"transparent",borderBottom:I<v.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>m(I),children:A},A))})]})}function xP({id:t,value:e,onChange:n,categories:i,categoryGroups:a,placeholder:l="Search categories...",required:u}){const f=Object.fromEntries(a.map(O=>[O.id,O.name])),m=Object.entries(i).map(([O,C])=>({id:O,name:C.name,groupId:C.category_group_id,groupName:C.category_group_id&&f[C.category_group_id]||null,sortOrder:C.sort_order})),_=(e?i[e]:null)?.name||"",[v,x]=T.useState(_),[w,A]=T.useState(!1),[I,N]=T.useState(-1),H=T.useRef(null),$=T.useRef(null);T.useEffect(()=>{const O=e?i[e]:null;x(O?.name||"")},[e,i]);const q=v.trim()?m.map(O=>({...O,...Eg(v,O.name),groupMatch:O.groupName?Eg(v,O.groupName):{match:!1,score:0}})).filter(O=>O.match||O.groupMatch.match).sort((O,C)=>{const Y=Math.max(O.score,O.groupMatch.score*.5),U=Math.max(C.score,C.groupMatch.score*.5);if(U!==Y)return U-Y;if(O.groupId!==C.groupId){if(!O.groupId)return 1;if(!C.groupId)return-1;const P=(O.groupName||"").localeCompare(C.groupName||"");return P!==0?P:O.groupId.localeCompare(C.groupId)}return O.sortOrder-C.sortOrder}).slice(0,10):[...m].sort((O,C)=>{if(O.groupId!==C.groupId){if(!O.groupId)return 1;if(!C.groupId)return-1;const Y=(O.groupName||"").localeCompare(C.groupName||"");return Y!==0?Y:O.groupId.localeCompare(C.groupId)}return O.sortOrder-C.sortOrder}).slice(0,10);T.useEffect(()=>{function O(C){if(H.current&&!H.current.contains(C.target)){A(!1);const Y=e?i[e]:null;x(Y?.name||"")}}return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[e,i]);function me(O){if(O.key==="ArrowDown")O.preventDefault(),w?N(C=>Math.min(C+1,q.length-1)):(A(!0),N(0));else if(O.key==="ArrowUp")O.preventDefault(),N(C=>Math.max(C-1,0));else if(O.key==="Enter")O.preventDefault(),w&&I>=0&&q[I]&&ie(q[I]);else if(O.key==="Escape"){A(!1),N(-1);const C=e?i[e]:null;x(C?.name||"")}else if(O.key==="Tab"&&w&&q.length>0){const C=I>=0?I:0;ie(q[C])}}function ie(O){n(O.id),x(O.name),A(!1),N(-1),$.current?.focus()}function he(O){const C=O.target.value;x(C),A(!0),N(-1),C!==_&&n("")}function L(){A(!0),q.length>0&&N(0)}const R=[];let D="__initial__";q.forEach(O=>{O.groupId!==D&&(D=O.groupId,R.push({groupId:O.groupId,groupName:O.groupName,items:[]})),R[R.length-1].items.push(O)});let M=-1;const j=()=>++M;return d.jsxs("div",{ref:H,style:{position:"relative"},children:[d.jsx("input",{ref:$,id:t,type:"text",value:v,onChange:he,onFocus:L,onKeyDown:me,placeholder:l,autoComplete:"off",required:u,style:{...qa,borderColor:u&&!e?ce.error:void 0}}),w&&q.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"250px",overflowY:"auto"},children:R.map((O,C)=>d.jsxs("div",{children:[O.groupName&&d.jsx("div",{style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6,background:"color-mix(in srgb, currentColor 5%, transparent)",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:O.groupName}),O.items.map(Y=>{const U=j();return d.jsx("div",{onClick:()=>ie(Y),style:{padding:"0.6rem 0.8rem",paddingLeft:O.groupName?"1.2rem":"0.8rem",cursor:"pointer",background:U===I?`color-mix(in srgb, ${ce.primary} 20%, transparent)`:"transparent",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",transition:"background 0.1s"},onMouseEnter:()=>N(U),children:Y.name},Y.id)})]},`group-${C}`))}),w&&q.length===0&&v.trim()&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,padding:"0.6rem 0.8rem",opacity:.6,fontStyle:"italic"},children:"No matching categories"})]})}function Hs({children:t,onSubmit:e}){return d.jsx("form",{onSubmit:e,style:nP,children:t})}function Et({label:t,htmlFor:e,children:n,hint:i,style:a}){return d.jsxs("div",{style:{...rP,...a},children:[d.jsx("label",{htmlFor:e,style:iP,children:t}),n,i&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:i})]})}function Gs(t){return d.jsx("input",{style:qa,...t})}function EP(t){if(!t)return"";try{return new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return t}}function Pp({value:t,onChange:e,style:n,...i}){const a=T.useRef(null),l=EP(t);function u(){a.current?.showPicker?.()}return d.jsxs("div",{style:{position:"relative"},children:[d.jsx("input",{ref:a,type:"date",value:t||"",onChange:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,pointerEvents:"none"},...i}),d.jsx("div",{onClick:u,style:{...qa,cursor:"pointer",display:"flex",alignItems:"center",fontSize:"0.85rem",fontFamily:"monospace",color:t?"inherit":"color-mix(in srgb, currentColor 50%, transparent)",...n},children:l||"Select date"})]})}function Jc({children:t,...e}){return d.jsx("select",{style:sP,...e,children:t})}function Py({minHeight:t="6rem",style:e,...n}){return d.jsx("textarea",{style:{...qa,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function Ha({children:t}){return d.jsx("div",{style:fP,children:t})}function Lp(t){const n=t.replace(/[^\d.]/g,"").split("."),i=n[0]||"",a=n[1],l=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return a!==void 0?`$${l}.${a.slice(0,2)}`:l?`$${l}`:""}function SP(t){return t.replace(/[$,]/g,"")}function dh({id:t,value:e,onChange:n,placeholder:i="$0.00",required:a,autoFocus:l}){const[u,f]=T.useState(()=>Lp(e)),m=T.useRef(null);T.useEffect(()=>{const _=Lp(e);SP(u)!==e&&f(_)},[e]);function g(_){const v=_.target.value;if(!v||v==="$"){f(""),n("");return}const w=v.replace(/[^\d.]/g,"").split(".");let A=w[0];w.length>1&&(A+="."+w.slice(1).join("").slice(0,2));const I=Lp(A);f(I),n(A)}return d.jsx("input",{ref:m,id:t,type:"text",inputMode:"decimal",value:u,onChange:g,placeholder:i,required:a,autoFocus:l,style:qa})}function Xi(t=ZN){const[e,n]=T.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return T.useEffect(()=>{function i(){n(window.innerWidth<t)}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[t]),e}function pf({children:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:u,onDrop:f,onEdit:m,onDelete:g,onMoveUp:_,onMoveDown:v,canMoveUp:x=!0,canMoveDown:w=!0}){const A=Xi(),I=_||v;return d.jsxs("div",{onDragOver:N=>{N.stopPropagation(),a(N)},onDragLeave:N=>{N.stopPropagation(),l()},onDrop:N=>{N.stopPropagation(),f(N)},style:{position:"relative"},children:[d.jsx("div",{style:{...J1,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{style:{...A?eP:gu,opacity:e?.5:1},children:[d.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:A?"0.5rem":"0.75rem",minWidth:0},children:[d.jsx("span",{draggable:!0,onDragStart:i,onDragEnd:u,style:{...X1,fontSize:A?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),d.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),d.jsxs("div",{style:A?dP:uP,children:[A?d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:m,style:Y1,title:"Edit","aria-label":"Edit",children:""}),d.jsx("button",{onClick:g,style:hP,title:"Delete","aria-label":"Delete",children:""})]}):d.jsxs(d.Fragment,{children:[d.jsx(Le,{variant:"secondary",onClick:m,children:"Edit"}),d.jsx(Le,{variant:"danger",onClick:g,children:"Delete"})]}),I&&d.jsxs("div",{style:My,children:[d.jsx("button",{onClick:N=>{N.stopPropagation(),_?.()},disabled:!x,style:{...rl,opacity:x?.6:.2,cursor:x?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:N=>{N.stopPropagation(),v?.()},disabled:!w,style:{...rl,opacity:w?.6:.2,cursor:w?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function Ly({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i,label:a="Move to end"}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:mP,children:[d.jsx("div",{style:{...pP,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:gP,children:a})]})}function Rc({children:t,style:e}){return d.jsx("div",{style:{...tP,...e},children:t})}function wP({items:t}){const e=Xi(),n=a=>e?[1,3,4,2][a]:a+1,i=a=>{if(e)switch(a){case 0:return{borderRight:!0,borderBottom:!0};case 3:return{borderRight:!1,borderBottom:!0};case 1:return{borderRight:!0,borderBottom:!1};case 2:return{borderRight:!1,borderBottom:!1};default:return{borderRight:!1,borderBottom:!1}}else return{borderRight:a<3,borderBottom:!1}};return d.jsx("div",{style:{display:"grid",gridTemplateColumns:e?"1fr 1fr":"repeat(4, 1fr)",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",marginBottom:"1.5rem",overflow:"hidden"},children:t.map((a,l)=>{const u=i(l);return d.jsxs("div",{style:{padding:"0.75rem 1rem",borderRight:u.borderRight?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",borderBottom:u.borderBottom?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center",order:n(l)},children:[d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:a.label}),d.jsx("div",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600},children:a.value}),a.subtitle&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.65rem",opacity:.5},children:a.subtitle}),a.action&&d.jsx("div",{style:{marginTop:"0.25rem"},children:a.action})]},l)})})}function je(t){return`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function sn(t){return t>=0?ce.success:ce.danger}function Z1(){const t=on();return{submitFeedback:ir({mutationFn:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:u})=>{const f=i||n,m={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`${a}

(Submitted from: ${u})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l},{exists:g}=await Qe("feedback",f,"checking if user has existing feedback document");return g?await yt("feedback",f,{items:qO(m),user_email:i,updated_at:new Date().toISOString()},"adding new feedback item to existing document",{merge:!0}):await yt("feedback",f,{items:[m],user_email:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},"creating new feedback document for user"),{feedbackItem:m,docId:f}},onMutate:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:u})=>{await t.cancelQueries({queryKey:xe.feedback()});const f=t.getQueryData(xe.feedback()),m=i||n,g={id:`feedback_optimistic_${Date.now()}`,text:`${a}

(Submitted from: ${u})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l,doc_id:m,user_email:i};return t.setQueryData(xe.feedback(),_=>_?{items:[..._.items,g]}:{items:[g]}),{previousData:f,optimisticItemId:g.id}},onSuccess:(n,i,a)=>{t.setQueryData(xe.feedback(),l=>l&&{items:l.items.map(u=>u.id===a?.optimisticItemId?{...n.feedbackItem,doc_id:n.docId,user_email:i.userEmail}:u)})},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function TP(){const t=on();return{toggleFeedback:ir({mutationFn:async({item:n})=>{const{exists:i,data:a}=await Qe("feedback",n.doc_id,"PRE-EDIT-READ");if(!i||!a)throw new Error(`Feedback document not found: ${n.doc_id}`);const l=!n.is_done,u=l?new Date().toISOString():null,f=a.items||[];let m=!1;const g=f.map(_=>_.id===n.id?(m=!0,{..._,is_done:l,completed_at:u}):_);if(!m)throw console.error("[toggleFeedback] Item not found in document",{searchingFor:n.id,inDocument:n.doc_id,availableIds:f.map(_=>_.id)}),new Error(`Feedback item not found in document. Item ID: ${n.id}, Doc ID: ${n.doc_id}`);return await yt("feedback",n.doc_id,{...a,items:g,updated_at:new Date().toISOString()},`marking feedback item as ${l?"done":"not done"}`),{itemId:n.id,isDone:l,completedAt:u}},onMutate:async({item:n})=>{await t.cancelQueries({queryKey:xe.feedback()});const i=t.getQueryData(xe.feedback()),a=!n.is_done,l=a?new Date().toISOString():null;return t.setQueryData(xe.feedback(),u=>u&&{items:u.items.map(f=>f.id===n.id?{...f,is_done:a,completed_at:l}:f)}),{previousData:i}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function AP(){const t=on();return{updateSortOrder:ir({mutationFn:async({docId:n,items:i})=>{const{exists:a,data:l}=await Qe("feedback",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Feedback document not found");return await yt("feedback",n,{...l,items:i,updated_at:new Date().toISOString()},"saving reordered feedback items"),{docId:n,items:i}},onMutate:async({docId:n,items:i})=>{await t.cancelQueries({queryKey:xe.feedback()});const a=t.getQueryData(xe.feedback());return t.setQueryData(xe.feedback(),l=>{if(!l)return l;const u=new Map;return i.forEach(f=>{u.set(f.id,f.sort_order)}),{items:l.items.map(f=>f.doc_id===n&&u.has(f.id)?{...f,sort_order:u.get(f.id)}:f)}}),{previousData:a}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function sl({isOpen:t,onClose:e,title:n,children:i,width:a="28rem"}){return t?d.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:e,children:d.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:a,maxWidth:"calc(100vw - 2rem)",flexShrink:0,boxSizing:"border-box",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:l=>l.stopPropagation(),children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[d.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),d.jsx("button",{onClick:e,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),i]})}):null}const CP=2e3,RP={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function DP(){const[t,e]=T.useState(!1),[n,i]=T.useState(""),[a,l]=T.useState("bug"),[u,f]=T.useState(!1),m=T.useContext(nu),_=Fa().get_current_firebase_user(),v=kn(),{submitFeedback:x}=Z1();if(T.useEffect(()=>{if(u){const I=setTimeout(()=>f(!1),CP);return()=>clearTimeout(I)}},[u]),v.pathname.includes("/admin/feedback")||!m.is_logged_in)return null;function A(I){I.preventDefault(),!(!n.trim()||!m.username||!_)&&(x.mutate({userId:_.uid,userEmail:m.username,text:n.trim(),feedbackType:a,currentPath:v.pathname}),i(""),l("bug"),e(!1),f(!0))}return d.jsxs(d.Fragment,{children:[u&&d.jsxs("div",{style:{position:"fixed",bottom:"5rem",right:"1.5rem",background:"rgba(46, 213, 115, 0.95)",color:"white",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1001,display:"flex",alignItems:"center",gap:"0.5rem",animation:"fadeInUp 0.2s ease-out"},children:[d.jsx("span",{children:""}),d.jsx("span",{children:"Feedback submitted!"})]}),d.jsx("button",{onClick:()=>e(!0),style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:ce.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:I=>{I.currentTarget.style.transform="scale(1.1)",I.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:I=>{I.currentTarget.style.transform="scale(1)",I.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),d.jsx(sl,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:d.jsxs("form",{onSubmit:A,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(I=>{const N=RP[I],H=a===I;return d.jsxs("button",{type:"button",onClick:()=>l(I),style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${N.color}`,borderRadius:"0.5rem",background:H?N.bgColor:"transparent",color:H?N.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:H?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:H?1:.5,boxShadow:H?`0 0 12px ${N.bgColor}`:"none",position:"relative"},children:[N.label,H&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},I)})}),d.jsx(Py,{value:n,onChange:I=>i(I.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),d.jsxs(Ha,{children:[d.jsx(Le,{type:"button",variant:"secondary",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),d.jsx(Le,{type:"submit",disabled:!n.trim(),children:"Submit"})]})]})})]})}function js({children:t,labelStyle:e,...n}){return d.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[d.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:ce.primary},...n}),t]})}function IP({title:t,count:e,children:n,defaultExpanded:i=!1}){const[a,l]=T.useState(i);return d.jsxs("div",{style:{marginTop:"2rem"},children:[d.jsxs("button",{onClick:()=>l(!a),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[d.jsx("span",{style:{transition:"transform 0.2s",transform:a?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),a&&n]})}const jP=t=>{switch(t){case 2:return 220;case 3:return 320;case 4:return 420;case 5:return 520;case 6:return 620;default:return t*100+20}},OP=t=>t<=4?2:t<=6?3:Math.ceil(t/2);function Vy(t){const{tabs:e,activeTab:n}=t,i=e.filter(v=>!v.hidden),a=i.length,l=jP(a),u=OP(a),f=Math.floor(100/u),m=`tab-nav-${a}`,g=v=>({flex:"1 1 0",padding:"0.6rem 0.5rem",border:"none",borderRadius:0,background:"transparent",cursor:"pointer",fontWeight:v?600:400,fontSize:"0.9rem",color:"inherit",opacity:v?1:.5,transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem",position:"relative",boxSizing:"border-box",outline:"none"}),_=(v,x)=>d.jsxs(d.Fragment,{children:[d.jsx("span",{children:v.label}),v.checkmark&&d.jsx("span",{style:{color:ce.success,fontWeight:600},children:""}),x&&d.jsx("span",{style:{position:"absolute",bottom:"-1px",left:"15%",right:"15%",height:"3px",background:"white",borderRadius:"2px"}})]});return d.jsxs(d.Fragment,{children:[d.jsx("style",{children:`
        .${m} {
          display: flex;
          flex-wrap: wrap;
          margin-bottom: 1.5rem;
          border-bottom: 1px solid color-mix(in srgb, currentColor 15%, transparent);
        }
        .${m} > button,
        .${m} > a {
          border: none !important;
          border-radius: 0 !important;
          outline: none !important;
        }
        .${m} > button:hover,
        .${m} > button:focus,
        .${m} > a:hover,
        .${m} > a:focus {
          border: none !important;
          border-color: transparent !important;
        }
        @media (max-width: ${l}px) {
          .${m} > * {
            flex: 1 1 ${f}% !important;
            min-width: ${f}% !important;
          }
        }
      `}),d.jsx("div",{className:m,children:i.map(v=>{const x=n===v.id;return t.mode==="link"?d.jsx(Dt,{to:`${t.linkPrefix}/${v.id}`,style:g(x),children:_(v,x)},v.id):d.jsx("button",{onClick:()=>t.onTabChange(v.id),style:g(x),children:_(v,x)},v.id)})})]})}function zy({items:t}){const[e,n]=T.useState(!1),i=T.useRef(null),l=kn().pathname;T.useEffect(()=>{function f(m){i.current&&!i.current.contains(m.target)&&n(!1)}if(e)return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[e]),T.useEffect(()=>{function f(m){m.key==="Escape"&&n(!1)}if(e)return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[e]);const u=t.filter(f=>f.hidden?!1:f.to?f.to==="/budget"?!(l==="/budget"||/^\/budget\/\d{4}\/\d{1,2}\/\w+$/.test(l)):f.to==="/account"||f.to==="/"?l!==f.to:!l.startsWith(f.to):!0);return d.jsxs("div",{ref:i,style:{position:"relative"},children:[d.jsx("button",{onClick:()=>n(!e),style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:e?"color-mix(in srgb, currentColor 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:"none",cursor:"pointer",fontSize:"1.25rem",color:"inherit",transition:"background 0.15s",lineHeight:1},title:"Menu","aria-expanded":e,"aria-haspopup":"true",children:""}),e&&d.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",minWidth:"180px",background:"#1a1a2e",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",zIndex:1e3,overflow:"hidden"},children:u.map((f,m)=>{if(f.divider)return d.jsx("div",{style:{height:"1px",background:"color-mix(in srgb, currentColor 15%, transparent)",margin:"0.25rem 0"}},m);const g=d.jsxs(d.Fragment,{children:[f.icon&&d.jsx("span",{style:{width:"1.5rem",textAlign:"center"},children:f.icon}),d.jsx("span",{children:f.label})]}),_={display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",fontSize:"0.95rem",color:"inherit",textDecoration:"none",cursor:"pointer",transition:"background 0.15s",background:"transparent",border:"none",width:"100%",textAlign:"left"},v={background:"color-mix(in srgb, currentColor 10%, transparent)"};return f.to?d.jsx(Dt,{to:f.to,style:_,onMouseEnter:x=>Object.assign(x.currentTarget.style,v),onMouseLeave:x=>x.currentTarget.style.background="transparent",onClick:()=>n(!1),children:g},m):d.jsx("button",{onClick:()=>{f.onClick?.(),n(!1)},style:_,onMouseEnter:x=>Object.assign(x.currentTarget.style,v),onMouseLeave:x=>x.currentTarget.style.background="transparent",children:g},m)})})]})}function fi({title:t,showBackArrow:e=!1,hideMenu:n=!1}){const{isAdmin:i}=Sn(),a=[{label:"Budget",icon:"",to:"/budget"},{label:"Budget Settings",icon:"",to:"/budget/settings"},{label:"Analytics",icon:"",to:"/budget/analytics"},...i?[{label:"Admin",icon:"",to:"/budget/admin"}]:[],{label:"Switch Budgets",icon:"",to:"/budget/my-budgets"},{divider:!0,label:""},{label:"Exit Budget App",icon:"",to:"/"}];return d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{children:e?d.jsx(Dt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none"},title:"Back to Home",children:""}):d.jsx(Dt,{to:"/budget",title:"Budget Home",children:d.jsx("img",{src:"/budget-icon.svg",alt:"Budget",style:{width:"1.5rem",height:"1.5rem"}})})}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem",textAlign:"center"},children:t}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:!n&&d.jsx(zy,{items:a})})]})}function kP({children:t,style:e}){return d.jsx("div",{style:{width:"100%",maxWidth:"var(--content-max-width, 900px)",marginLeft:"auto",marginRight:"auto",...e},children:t})}function eT({label:t,value:e,action:n,inlineAction:i,compact:a}){const l=Xi();return a?d.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("span",{style:{display:"flex",alignItems:"baseline",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:t}),d.jsx("span",{style:{fontSize:"1.1rem",fontWeight:600},children:e})]}),n]}),i]}):d.jsxs("div",{style:{display:"flex",flexDirection:l?"column":"row",justifyContent:"space-between",alignItems:l?"stretch":"center",gap:l?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("div",{children:[d.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:t}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0.25rem 0 0 0"},children:[d.jsx("span",{style:{fontSize:"1.25rem",fontWeight:600},children:e}),i]})]}),n]})}function MP({isVisible:t,message:e="Loading..."}){return t?d.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999,gap:"1rem"},children:[d.jsx("div",{style:{width:"3rem",height:"3rem",border:"3px solid rgba(255, 255, 255, 0.2)",borderTopColor:ce.primary,borderRadius:"50%",animation:"loadingOverlaySpin 0.8s linear infinite"}}),d.jsx("p",{style:{color:"white",fontSize:"1.1rem",fontWeight:500},children:e}),d.jsx("style",{children:`
        @keyframes loadingOverlaySpin {
          to { transform: rotate(360deg); }
        }
      `})]}):null}function Sg(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function NP(){return d.jsxs("div",{style:qn,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(Dt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(Dt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"SQL Test"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(zy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"SQL Test"}),d.jsx("h2",{children:"Setup"}),d.jsxs("h3",{children:["1. Open up your preferred web browser to ",d.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),d.jsxs("ul",{children:[d.jsx("li",{children:"This is a basic online sql query editor"}),d.jsxs("li",{children:["It will include three tables: ",d.jsx("b",{children:'"Customer"'}),", ",d.jsx("b",{children:'"Orders"'}),", and ",d.jsx("b",{children:'"Shippings"'})]})]}),d.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),d.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:d.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),d.jsx("h2",{children:"SQL Problems"}),d.jsx("p",{children:"Write queries in the online editor to answer these questions."}),d.jsx("h3",{children:"Question #1"}),d.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),d.jsx("h3",{children:"Question #2"}),d.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function PP(){const t=T.useContext(nu),e=Fa(),[n,i]=T.useState(!1),a=kn(),l=eu(),u=a.state?.from||"/";T.useEffect(()=>{t.is_logged_in&&u!=="/"&&l(u,{replace:!0})},[t.is_logged_in,u,l]);function f(){i(!0),e.logout_firebase_user().then(function(){i(!1)})}return d.jsxs("div",{style:qn,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(Dt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(Dt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"Account"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(zy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"Account"}),t.is_logged_in?n?d.jsx("p",{children:"Logging Out..."}):d.jsxs(d.Fragment,{children:[d.jsxs("p",{children:["You are logged in as ",t.username]}),d.jsx("button",{onClick:f,style:{marginTop:"1rem"},children:"Logout"})]}):d.jsx(LP,{})]})}function LP(){const t=Fa(),[e,n]=T.useState(""),[i,a]=T.useState(""),[l,u]=T.useState(!1),[f,m]=T.useState("");function g(x){n(x.target.value)}function _(x){a(x.target.value)}function v(x){x.preventDefault(),u(!0),m(""),t.login_firebase_user(e,i).then(function(){}).catch(function(){m("Incorrect login credentials")}).finally(function(){u(!1)})}return d.jsxs("form",{onSubmit:v,children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"username",children:"Email: "}),d.jsx("input",{id:"username",type:"email",value:e,onChange:g})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",children:"Password: "}),d.jsx("input",{id:"password",type:"password",value:i,onChange:_})]}),l?d.jsx("p",{children:"Logging in..."}):d.jsx("button",{children:"Login"}),f&&d.jsx("p",{style:{color:"red"},children:f})]})}function VP(){const[t,e]=T.useState(()=>typeof window>"u"?1200:window.innerWidth);return T.useEffect(()=>{function n(){e(window.innerWidth)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),{width:t,isWide:t>=Vi.wide,isMedium:t>=Vi.mobile&&t<Vi.wide,isMobile:t<Vi.mobile}}function zP(){const t=on();return{updateAccounts:ir({mutationFn:async({budgetId:n,accounts:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await yt("budgets",n,{...l,accounts:i},"saving updated accounts (user edited account settings)"),i},onMutate:async({budgetId:n,accounts:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,accounts:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,accounts:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function UP(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order},i.expected_balance!==void 0&&(e[n].expected_balance=i.expected_balance),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function BP(){const t=on();return{updateAccountGroups:ir({mutationFn:async({budgetId:n,accountGroups:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const u=UP(i);return await yt("budgets",n,{...l,account_groups:u},"saving updated account groups (user edited group settings)"),i},onMutate:async({budgetId:n,accountGroups:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,accountGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,accountGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function FP(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,category_group_id:i.category_group_id??null,sort_order:i.sort_order,balance:i.balance??0},i.description!==void 0&&(e[n].description=i.description),i.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=i.default_monthly_amount),i.default_monthly_type!==void 0&&(e[n].default_monthly_type=i.default_monthly_type)}),e}function qP(){const t=on();return{updateCategories:ir({mutationFn:async({budgetId:n,categories:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const u=FP(i);return await yt("budgets",n,{...l,categories:u},"saving updated categories (user edited category settings)"),i},onMutate:async({budgetId:n,categories:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,categories:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,categories:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function HP(){const t=on();return{updateCategoryGroups:ir({mutationFn:async({budgetId:n,categoryGroups:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await yt("budgets",n,{...l,category_groups:i},"saving updated category groups (user edited group settings)"),i},onMutate:async({budgetId:n,categoryGroups:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,categoryGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,categoryGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function GP(){const t=on();return{renameBudget:ir({mutationFn:async({budgetId:n,newName:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await yt("budgets",n,{...l,name:i.trim()},`renaming budget to "${i.trim()}"`),i.trim()},onMutate:async({budgetId:n,newName:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,name:i.trim()}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,budget:{...a.budget,name:n}})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function QP(){const t=on();return{createBudget:ir({mutationFn:async({name:n,userId:i,userEmail:a})=>{const l=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,u=new Date().toISOString(),f={name:n.trim()||"My Budget",user_ids:[i],accepted_user_ids:[i],owner_id:i,owner_email:a,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:u,updated_at:u};await yt("budgets",l,f,"creating new budget document");const{exists:m,data:g}=await Qe("users",i,"reading user document to add new budget to their list");return m&&g?await yt("users",i,{...g,budget_ids:[l,...g.budget_ids],updated_at:u},"adding new budget to user's budget list"):await yt("users",i,{uid:i,email:a,budget_ids:[l],created_at:u,updated_at:u},"creating new user document with first budget"),{budgetId:l,budget:{id:l,...f}}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:xe.user(i)}),t.invalidateQueries({queryKey:xe.accessibleBudgets(i)})}})}}function $P(){const t=on();return{acceptInvite:ir({mutationFn:async({budgetId:n,userId:i})=>{const a=new Date().toISOString(),{exists:l,data:u}=await Qe("budgets",n,"verifying user was invited to this budget");if(!l||!u)throw new Error("Budget not found");if(!u.user_ids?.includes(i))throw new Error("You have not been invited to this budget");const{data:f}=await Qe("users",i,"PRE-EDIT-READ");if(f?.budget_ids?.includes(n))throw new Error("You have already accepted this invite");return await yt("users",i,{...f||{uid:i,email:null},budget_ids:[n,...f?.budget_ids||[]],updated_at:a},"adding accepted budget to user's budget list"),await yt("budgets",n,{...u,accepted_user_ids:[...u.accepted_user_ids||[],i]},"marking user as accepted in budget's accepted_user_ids"),{budgetId:n}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:xe.user(i)}),t.invalidateQueries({queryKey:xe.accessibleBudgets(i)}),t.invalidateQueries({queryKey:xe.budget(n.budgetId)})}})}}function KP(){const t=on();return{inviteUser:ir({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");if(l.user_ids?.includes(i))throw new Error("User is already invited");return await yt("budgets",n,{...l,user_ids:[...l.user_ids||[],i]},"adding user to budget's invited users list"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,user_ids:[...a.budget.user_ids,i]}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function WP(){const t=on();return{revokeUser:ir({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await Qe("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await yt("budgets",n,{...l,user_ids:(l.user_ids||[]).filter(u=>u!==i),accepted_user_ids:(l.accepted_user_ids||[]).filter(u=>u!==i)},"removing user from budget's access lists"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,user_ids:a.budget.user_ids.filter(l=>l!==i),accepted_user_ids:a.budget.accepted_user_ids.filter(l=>l!==i)}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function Hn(t,e){const n=Tk(t),{updateAccounts:i}=zP(),{updateAccountGroups:a}=BP(),{updateCategories:l}=qP(),{updateCategoryGroups:u}=HP(),{renameBudget:f}=GP(),{createBudget:m}=QP(),{acceptInvite:g}=$P(),{inviteUser:_}=KP(),{revokeUser:v}=WP(),x=n.data,w=x?.budget||null,A=T.useMemo(()=>x?.accounts||{},[x?.accounts]),I=T.useMemo(()=>x?.accountGroups||{},[x?.accountGroups]),N=T.useMemo(()=>x?.categories||{},[x?.categories]),H=T.useMemo(()=>x?.categoryGroups||[],[x?.categoryGroups]),$=w?.owner_id===e,q=T.useMemo(()=>w?.user_ids||[],[w?.user_ids]),me=T.useMemo(()=>w?.accepted_user_ids||[],[w?.accepted_user_ids]),ie=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await i.mutateAsync({budgetId:t,accounts:F})},[t,i]),he=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await a.mutateAsync({budgetId:t,accountGroups:F})},[t,a]),L=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await l.mutateAsync({budgetId:t,categories:F})},[t,l]),R=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await u.mutateAsync({budgetId:t,categoryGroups:F})},[t,u]),D=T.useCallback(async(F,W)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.mutateAsync({budgetId:t,accounts:F}),a.mutateAsync({budgetId:t,accountGroups:W})])},[t,i,a]),M=T.useCallback(async(F,W)=>{if(!t)throw new Error("No budget selected");await Promise.all([l.mutateAsync({budgetId:t,categories:F}),u.mutateAsync({budgetId:t,categoryGroups:W})])},[t,l,u]),j=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await f.mutateAsync({budgetId:t,newName:F})},[t,f]),O=T.useCallback(async F=>{if(!e)throw new Error("Not authenticated");return await m.mutateAsync({name:F.trim()||"My Budget",userId:e,userEmail:null})},[e,m]),C=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await _.mutateAsync({budgetId:t,userId:F})},[t,_]),Y=T.useCallback(async F=>{if(!t)throw new Error("No budget selected");await v.mutateAsync({budgetId:t,userId:F})},[t,v]),U=T.useCallback(async F=>{if(!e)throw new Error("Not authenticated");await g.mutateAsync({budgetId:F,userId:e})},[e,g]),P=T.useCallback(F=>{if(!t)return;const W=Rt.getQueryData(xe.budget(t));W&&Rt.setQueryData(xe.budget(t),{...W,accounts:F})},[t]),B=T.useCallback(F=>{if(!t)return;const W=Rt.getQueryData(xe.budget(t));W&&Rt.setQueryData(xe.budget(t),{...W,accountGroups:F})},[t]),Q=T.useCallback(F=>{if(!t)return;const W=Rt.getQueryData(xe.budget(t));W&&Rt.setQueryData(xe.budget(t),{...W,categories:F})},[t]),le=T.useCallback(F=>{if(!t)return;const W=Rt.getQueryData(xe.budget(t));W&&Rt.setQueryData(xe.budget(t),{...W,categoryGroups:F})},[t]),J=T.useCallback(async()=>{t&&await Rt.invalidateQueries({queryKey:xe.budget(t)})},[t]),z=T.useCallback(()=>Object.entries(A).filter(([,F])=>{const W=F.account_group_id?I[F.account_group_id]:void 0,ne=W?.on_budget!==void 0?W.on_budget:F.on_budget!==!1,ae=W?.is_active!==void 0?W.is_active:F.is_active!==!1;return ne&&ae}).reduce((F,[,W])=>F+W.balance,0),[A,I]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:w,accounts:A,accountGroups:I,categories:N,categoryGroups:H,isOwner:$,budgetUserIds:q,acceptedUserIds:me,saveAccounts:ie,saveAccountGroups:he,saveCategories:L,saveCategoryGroups:R,saveAccountsAndGroups:D,saveCategoriesAndGroups:M,renameBudget:j,createBudget:O,inviteUser:C,revokeUser:Y,acceptInvite:U,setAccountsOptimistic:P,setAccountGroupsOptimistic:B,setCategoriesOptimistic:Q,setCategoryGroupsOptimistic:le,refreshBudget:J,getOnBudgetTotal:z}}function wl(t,e,n){const i=ZO(t,e,n,{enabled:!!t}),{addIncome:a}=dk(),{updateIncome:l}=hk(),{deleteIncome:u}=fk(),{addExpense:f}=mk(),{updateExpense:m}=pk(),{deleteExpense:g}=gk(),_=i.data?.month||null,v=_?.income||[],x=_?.expenses||[],w=_?.category_balances||[],A=_?.total_income||0,I=_?.total_expenses||0,N=_?.are_allocations_finalized||!1,H=_?.previous_month_income??0,$=T.useCallback(async(D,M,j,O,C)=>{if(!t)throw new Error("No budget selected");const[Y,U]=j.split("-").map(Number);await a(t,Y,U,D,M,j,O,C)},[t,a]),q=T.useCallback(async(D,M,j,O,C,Y)=>{if(!t)throw new Error("No budget selected");await l(t,e,n,D,M,j,O,C,Y)},[t,e,n,l]),me=T.useCallback(async D=>{if(!t)throw new Error("No budget selected");await u(t,e,n,D)},[t,e,n,u]),ie=T.useCallback(async(D,M,j,O,C,Y,U)=>{if(!t)throw new Error("No budget selected");const[P,B]=O.split("-").map(Number);await f(t,P,B,D,M,j,O,C,Y,U)},[t,f]),he=T.useCallback(async(D,M,j,O,C,Y,U,P)=>{if(!t)throw new Error("No budget selected");await m(t,e,n,D,M,j,O,C,Y,U,P)},[t,e,n,m]),L=T.useCallback(async D=>{if(!t)throw new Error("No budget selected");await g(t,e,n,D)},[t,e,n,g]),R=T.useCallback(async()=>{t&&await Rt.invalidateQueries({queryKey:xe.month(t,e,n)})},[t,e,n]);return{isLoading:i.isLoading,isFetching:i.isFetching,error:i.error,month:_,income:v,expenses:x,categoryBalances:w,totalIncome:A,totalExpenses:I,areAllocationsFinalized:N,previousMonthIncome:H,addIncome:$,updateIncome:q,deleteIncome:me,addExpense:ie,updateExpense:he,deleteExpense:L,refreshMonth:R}}function YP(){const{selectedBudgetId:t,currentUserId:e}=Sn(),{budget:n,accounts:i,accountGroups:a,saveAccounts:l,saveAccountGroups:u,saveAccountsAndGroups:f,setAccountsOptimistic:m,setAccountGroupsOptimistic:g}=Hn(t,e),[_,v]=T.useState(null),x=T.useMemo(()=>Object.entries(i).reduce((R,[D,M])=>{const j=M.account_group_id||"ungrouped";return R[j]||(R[j]=[]),R[j].push({...M,id:D}),R},{}),[i]),w=T.useMemo(()=>Object.entries(a).sort(([,R],[,D])=>R.sort_order-D.sort_order).map(([R,D])=>({...D,id:R})),[a]),A=T.useCallback((R,D)=>{if(!n)return;const M=Object.values(i).filter(U=>D==="ungrouped"?!U.account_group_id:U.account_group_id===D),j=M.length>0?Math.max(...M.map(U=>U.sort_order)):-1,O=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,C={nickname:R.nickname,description:"",balance:0,account_group_id:D==="ungrouped"?null:D,sort_order:j+1,is_income_account:R.is_income_account??!1,is_income_default:R.is_income_default??!1,is_outgo_account:R.is_outgo_account??!1,is_outgo_default:R.is_outgo_default??!1,on_budget:R.on_budget!==!1,is_active:R.is_active!==!1},Y={...i};R.is_income_default&&Object.keys(Y).forEach(U=>{Y[U]={...Y[U],is_income_default:!1}}),R.is_outgo_default&&Object.keys(Y).forEach(U=>{Y[U]={...Y[U],is_outgo_default:!1}}),Y[O]=C,m(Y),l(Y).catch(U=>{console.error("[useAccountHandlers] Error creating account:",U),v(U instanceof Error?U.message:"Failed to create account.")})},[n,i,m,l]),I=T.useCallback((R,D)=>{if(!n)return;const M=i[R];if(!M)return;const j=M.account_group_id||"ungrouped",O=D.account_group_id;let C=M.sort_order;if(j!==(O||"ungrouped")){const U=Object.values(i).filter(P=>(P.account_group_id||"ungrouped")===(O||"ungrouped"));C=U.length>0?Math.max(...U.map(P=>P.sort_order))+1:0}const Y={};Object.entries(i).forEach(([U,P])=>{U===R?Y[U]={...P,nickname:D.nickname,account_group_id:O,sort_order:C,is_income_account:D.is_income_account??!1,is_income_default:D.is_income_default??!1,is_outgo_account:D.is_outgo_account??!1,is_outgo_default:D.is_outgo_default??!1,on_budget:D.on_budget!==!1,is_active:D.is_active!==!1}:(Y[U]={...P},D.is_income_default&&!M.is_income_default&&(Y[U].is_income_default=!1),D.is_outgo_default&&!M.is_outgo_default&&(Y[U].is_outgo_default=!1))}),m(Y),l(Y).catch(U=>{console.error("[useAccountHandlers] Error saving account:",U),v(U instanceof Error?U.message:"Failed to save account.")})},[n,i,m,l]),N=T.useCallback(R=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[R]:D,...M}=i;m(M),l(M).catch(j=>{console.error("[useAccountHandlers] Error deleting account:",j),v(j instanceof Error?j.message:"Failed to delete account.")})},[n,i,m,l]),H=T.useCallback(async(R,D)=>{const M=i[R];if(!M)return;const j=M.account_group_id||"ungrouped",O=Object.entries(i).filter(([,Q])=>(Q.account_group_id||"ungrouped")===j).sort(([,Q],[,le])=>Q.sort_order-le.sort_order),C=O.findIndex(([Q])=>Q===R),Y=D==="up"?C-1:C+1;if(Y<0||Y>=O.length)return;const[U,P]=O[Y],B={};if(Object.entries(i).forEach(([Q,le])=>{Q===R?B[Q]={...le,sort_order:P.sort_order}:Q===U?B[Q]={...le,sort_order:M.sort_order}:B[Q]={...le}}),m(B),!!n)try{await l(B)}catch(Q){m(i),v(Q instanceof Error?Q.message:"Failed to move account")}},[n,i,m,l]),$=T.useCallback(R=>{if(!n)return;const D=Object.values(a).map(Y=>Y.sort_order),M=D.length>0?Math.max(...D):-1,j=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,O={name:R.name,sort_order:M+1,expected_balance:R.expected_balance,on_budget:R.on_budget,is_active:R.is_active},C={...a,[j]:O};g(C),u(C).catch(Y=>{console.error("[useAccountHandlers] Error creating group:",Y),v(Y instanceof Error?Y.message:"Failed to create account type.")})},[n,a,g,u]),q=T.useCallback((R,D)=>{if(!n)return;const M={...a,[R]:{...a[R],name:D.name,expected_balance:D.expected_balance,on_budget:D.on_budget,is_active:D.is_active}};g(M),u(M).catch(j=>{console.error("[useAccountHandlers] Error updating group:",j),v(j instanceof Error?j.message:"Failed to update account type.")})},[n,a,g,u]),me=T.useCallback(R=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const D={};Object.entries(i).forEach(([O,C])=>{D[O]=C.account_group_id===R?{...C,account_group_id:null}:C});const{[R]:M,...j}=a;m(D),g(j),f(D,j).catch(O=>{console.error("[useAccountHandlers] Error deleting group:",O),v(O instanceof Error?O.message:"Failed to delete account type.")})},[n,i,a,m,g,f]),ie=T.useCallback(async(R,D)=>{const M=Object.entries(a).sort(([,U],[,P])=>U.sort_order-P.sort_order),j=M.findIndex(([U])=>U===R),O=D==="up"?j-1:j+1;if(O<0||O>=M.length)return;const[C]=M.splice(j,1);M.splice(O,0,C);const Y={};if(M.forEach(([U,P],B)=>{Y[U]={...P,sort_order:B}}),g(Y),!!n)try{await u(Y)}catch(U){g(a),v(U instanceof Error?U.message:"Failed to move account type")}},[n,a,g,u]),he=T.useCallback(async(R,D,M)=>{const j=i[R];if(!j)return;const O=M==="ungrouped"?null:M,C=Object.entries(i).filter(([,P])=>(P.account_group_id||"ungrouped")===M),Y={};Object.entries(i).forEach(([P,B])=>{P!==R&&(Y[P]={...B})});let U;if(D==="__group_end__"||C.length===0||!C.find(([P])=>P===D))U=(C.length>0?Math.max(...C.filter(([B])=>B!==R).map(([,B])=>B.sort_order)):-1)+1;else{const P=C.find(([B])=>B===D);if(P){const[,B]=P;U=B.sort_order,Object.entries(Y).forEach(([Q,le])=>{(le.account_group_id||"ungrouped")===M&&le.sort_order>=U&&(Y[Q]={...le,sort_order:le.sort_order+1})})}else U=0}if(Y[R]={...j,account_group_id:O,sort_order:U},m(Y),!!n)try{await l(Y)}catch(P){v(P instanceof Error?P.message:"Failed to save changes")}},[n,i,m,l]),L=T.useCallback(async(R,D)=>{if(R===D)return;const M=Object.entries(a).sort(([,U],[,P])=>U.sort_order-P.sort_order),j=M.findIndex(([U])=>U===R),O=[...M],[C]=O.splice(j,1);if(D==="__end__")O.push(C);else{const U=O.findIndex(([P])=>P===D);O.splice(U,0,C)}const Y={};if(O.forEach(([U,P],B)=>{Y[U]={...P,sort_order:B}}),g(Y),!!n)try{await u(Y)}catch(U){v(U instanceof Error?U.message:"Failed to save new order")}},[n,a,g,u]);return{accounts:i,accountGroups:a,accountsByGroup:x,sortedGroups:w,currentBudget:n,error:_,setError:v,handleCreateAccount:A,handleUpdateAccount:I,handleDeleteAccount:N,handleMoveAccount:H,handleCreateGroup:$,handleUpdateGroup:q,handleDeleteGroup:me,handleMoveGroup:ie,reorderAccountsInGroup:he,reorderGroups:L}}function vE(t,e){if(!t)return{};const n={};return Object.entries(e).forEach(([i,a])=>{if(a.default_monthly_type==="percentage")return;const l=t.category_balances?.find(u=>u.category_id===i);l&&l.allocated>0?n[i]=l.allocated.toString():a.default_monthly_amount!==void 0&&a.default_monthly_amount>0?n[i]=a.default_monthly_amount.toString():n[i]=""}),n}function XP(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Sn(),{categories:a,getOnBudgetTotal:l}=Hn(t,e),{month:u,isLoading:f,previousMonthIncome:m,areAllocationsFinalized:g}=wl(t,n,i),{saveDraftAllocations:_}=lk(),{finalizeAllocations:v}=ck(),{deleteAllocations:x}=uk(),w=T.useMemo(()=>vE(u,a),[u,a]),[A,I]=T.useState(w),[N,H]=T.useState(!1),[$,q]=T.useState(!1),[me,ie]=T.useState(!1),[he,L]=T.useState(!1),[R,D]=T.useState(null),M=T.useRef(null),j=T.useMemo(()=>Object.values(a).reduce((ae,pe)=>ae+(pe.balance??0),0),[a]);T.useEffect(()=>{if(!u)return;const ae=`${u.year}-${u.month}`;M.current!==ae&&(I(vE(u,a)),M.current=ae)},[u,a]);const O=T.useCallback((ae,pe)=>{if(pe.default_monthly_type==="percentage"&&pe.default_monthly_amount!==void 0)return pe.default_monthly_amount/100*m;const ue=A[ae],be=parseFloat(ue||"0");return isNaN(be)?0:be},[A,m]),C=T.useMemo(()=>Object.entries(a).reduce((ae,[pe,ue])=>ae+O(pe,ue),0),[a,O]),Y=l(),U=g?(u?.category_balances||[]).reduce((ae,pe)=>ae+pe.allocated,0):0,P=Y-j,B=T.useMemo(()=>P-C+U,[P,C,U]),Q=T.useCallback((ae,pe)=>{I(ue=>({...ue,[ae]:pe}))},[]),le=T.useCallback(()=>{if(!u)return;const ae={};Object.entries(a).forEach(([pe,ue])=>{if(ue.default_monthly_type==="percentage")return;const be=u.category_balances?.find(Se=>Se.category_id===pe);be&&be.allocated>0?ae[pe]=be.allocated.toString():ue.default_monthly_amount!==void 0&&ue.default_monthly_amount>0?ae[pe]=ue.default_monthly_amount.toString():ae[pe]=""}),I(ae),L(!1)},[u,a]),J=T.useCallback(()=>{const ae={};return Object.entries(a).forEach(([pe,ue])=>{const be=O(pe,ue);be>0&&(ae[pe]=be)}),ae},[a,O]),z=T.useCallback(async()=>{if(t){D(null),H(!0);try{await _(t,n,i,J()),L(!1)}catch(ae){D(ae instanceof Error?ae.message:"Failed to save allocations")}finally{H(!1)}}},[t,n,i,_,J]),F=T.useCallback(async()=>{if(t){D(null),q(!0);try{await v({budgetId:t,year:n,month:i,allocations:J()}),L(!1)}catch(ae){D(ae instanceof Error?ae.message:"Failed to finalize allocations")}finally{q(!1)}}},[t,n,i,v,J]),W=T.useCallback(async()=>{if(t){D(null),ie(!0);try{await x({budgetId:t,year:n,month:i});const ae={};Object.entries(a).forEach(([pe,ue])=>{ue.default_monthly_type!=="percentage"&&(ue.default_monthly_amount!==void 0&&ue.default_monthly_amount>0?ae[pe]=ue.default_monthly_amount.toString():ae[pe]="")}),I(ae),L(!1)}catch(ae){D(ae instanceof Error?ae.message:"Failed to delete allocations")}finally{ie(!1)}}},[t,n,i,x,a]),ne=C-U;return{localAllocations:A,isSavingAllocations:N,isFinalizingAllocations:$,isDeletingAllocations:me,isEditingAppliedAllocations:he,error:R,monthLoading:f,onBudgetTotal:Y,availableNow:P,currentDraftTotal:C,draftChangeAmount:ne,availableAfterApply:B,previousMonthIncome:m,allocationsFinalized:g,getAllocationAmount:O,handleAllocationChange:Q,resetAllocationsToSaved:le,handleSaveAllocations:z,handleFinalizeAllocations:F,handleDeleteAllocations:W,setIsEditingAppliedAllocations:L,setError:D}}function JP({budgetId:t,categories:e,currentYear:n,currentMonth:i,updateCategoriesWithBalances:a}){const l=T.useMemo(()=>{const x={};return Object.entries(e).forEach(([w,A])=>{x[w]={current:A.balance??0,total:A.balance??0}}),x},[e]),[u,f]=T.useState(!1),[m,g]=T.useState(null),_=T.useCallback(async()=>{if(!t||Object.keys(e).length===0)return null;const x=Object.keys(e),{total:w}=await Jx(t,x,n,i),A={};Object.entries(e).forEach(([N,H])=>{const $=H.balance,q=w[N]??0;Math.abs($-q)>.01&&(A[N]={stored:$,calculated:q})});const I=Object.keys(A).length>0?A:null;return g(I),I},[t,e,n,i]),v=T.useCallback(async()=>{if(!(!t||Object.keys(e).length===0)){f(!0);try{const x=Object.keys(e),{total:w}=await Jx(t,x,n,i),A={};Object.entries(e).forEach(([I,N])=>{A[I]={...N,balance:w[I]??0}}),await a(A),g(null)}finally{f(!1)}}},[t,e,a,n,i]);return{categoryBalances:l,loadingBalances:u,categoryBalanceMismatch:m,checkCategoryBalanceMismatch:_,recalculateAndSaveCategoryBalances:v}}function ZP({categories:t,categoryGroups:e,currentBudget:n,setCategoriesOptimistic:i,setCategoryGroupsOptimistic:a,saveCategories:l,saveCategoryGroups:u,setError:f}){const[m,g]=T.useState(null),[_,v]=T.useState(null),[x,w]=T.useState(null),[A,I]=T.useState(null);function N(M,j){g("category"),v(j),M.dataTransfer.effectAllowed="move"}function H(M,j,O){M.preventDefault(),m==="category"&&(j!==_&&w(j),I(O))}function $(M,j){M.preventDefault(),m==="category"?(I(j),w(null)):m==="group"&&j!==_&&w(j)}function q(){w(null)}function me(){I(null)}function ie(){g(null),v(null),w(null),I(null)}async function he(M,j,O){if(M.preventDefault(),M.stopPropagation(),!_||m!=="category"){ie();return}const C=t[_];if(!C)return;const Y=O==="ungrouped"?null:O,U=Object.entries(t).filter(([,Q])=>(Q.category_group_id||"ungrouped")===O),P={};Object.entries(t).forEach(([Q,le])=>{Q!==_&&(P[Q]=le)});let B;if(j==="__group_end__"||U.length===0||!U.find(([Q])=>Q===j))B=(U.length>0?Math.max(...U.filter(([le])=>le!==_).map(([,le])=>le.sort_order)):-1)+1;else{const Q=U.find(([le])=>le===j);Q?(B=Q[1].sort_order,Object.entries(P).forEach(([le,J])=>{(J.category_group_id||"ungrouped")===O&&J.sort_order>=B&&(P[le]={...J,sort_order:J.sort_order+1})})):B=0}if(P[_]={...C,category_group_id:Y,sort_order:B},i(P),ie(),!!n)try{await l(P)}catch(Q){f(Q instanceof Error?Q.message:"Failed to save changes")}}async function L(M,j){M.preventDefault(),m==="category"?await he(M,"__group_end__",j):m==="group"&&await D(M,j)}function R(M,j){M.stopPropagation(),g("group"),v(j),M.dataTransfer.effectAllowed="move"}async function D(M,j){if(M.preventDefault(),!_||m!=="group"||_===j){ie();return}const O=e.findIndex(P=>P.id===_),C=[...e],[Y]=C.splice(O,1);if(j==="__end__")C.push(Y);else{const P=C.findIndex(B=>B.id===j);C.splice(P,0,Y)}const U=C.map((P,B)=>({...P,sort_order:B}));if(a(U),ie(),!!n)try{await u(U)}catch(P){f(P instanceof Error?P.message:"Failed to save new order")}}return{dragType:m,draggedId:_,dragOverId:x,dragOverGroupId:A,setDragOverId:w,setDragOverGroupId:I,handleCategoryDragStart:N,handleCategoryDragOver:H,handleDragOverGroup:$,handleDragLeave:q,handleDragLeaveGroup:me,handleDragEnd:ie,handleCategoryDrop:he,handleDropOnGroup:L,handleGroupDragStart:R,handleGroupDrop:D}}function e4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Sn(),{budget:a,categories:l,categoryGroups:u,isLoading:f,saveCategories:m,saveCategoryGroups:g,saveCategoriesAndGroups:_,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:x,getOnBudgetTotal:w}=Hn(t,e),[A,I]=T.useState(null),{categoryBalances:N,loadingBalances:H,categoryBalanceMismatch:$,checkCategoryBalanceMismatch:q,recalculateAndSaveCategoryBalances:me}=JP({budgetId:t,categories:l,currentYear:n,currentMonth:i,updateCategoriesWithBalances:m}),ie=ZP({categories:l,categoryGroups:u,currentBudget:a,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:x,saveCategories:m,saveCategoryGroups:g,setError:I});async function he(P,B){if(!a)return;const Q=B==="ungrouped"?null:B,le=Object.values(l).filter(ne=>B==="ungrouped"?!ne.category_group_id:ne.category_group_id===B),J=le.length>0?Math.max(...le.map(ne=>ne.sort_order)):-1,z=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,F={name:P.name,description:P.description??"",category_group_id:Q,sort_order:J+1,default_monthly_amount:P.default_monthly_amount??0,default_monthly_type:P.default_monthly_type??"fixed",balance:0},W={...l,[z]:F};v(W);try{await m(W)}catch(ne){v(l),I(ne instanceof Error?ne.message:"Failed to create category")}}async function L(P,B){if(a)try{const Q=l[P];if(!Q)return;const le=Q.category_group_id||"ungrouped",J=B.category_group_id;let z=Q.sort_order;if(le!==(J||"ungrouped")){const W=Object.values(l).filter(ne=>(ne.category_group_id||"ungrouped")===(J||"ungrouped")).filter((ne,ae,pe)=>l[P]!==pe[ae]);z=W.length>0?Math.max(...W.map(ne=>ne.sort_order))+1:0}const F={...l,[P]:{...Q,name:B.name,description:B.description??"",category_group_id:J,sort_order:z,default_monthly_amount:B.default_monthly_amount??0,default_monthly_type:B.default_monthly_type??"fixed"}};v(F),await m(F)}catch(Q){I(Q instanceof Error?Q.message:"Failed to update category")}}async function R(P){if(confirm("Are you sure you want to delete this category?")&&a)try{const{[P]:B,...Q}=l;v(Q),await m(Q)}catch(B){I(B instanceof Error?B.message:"Failed to delete category")}}async function D(P,B){const Q=l[P];if(!Q)return;const le=Q.category_group_id||"ungrouped",J=Object.entries(l).filter(([,pe])=>(pe.category_group_id||"ungrouped")===le).sort((pe,ue)=>pe[1].sort_order-ue[1].sort_order),z=J.findIndex(([pe])=>pe===P),F=B==="up"?z-1:z+1;if(F<0||F>=J.length)return;const[W,ne]=J[F],ae={};if(Object.entries(l).forEach(([pe,ue])=>{pe===P?ae[pe]={...ue,sort_order:ne.sort_order}:pe===W?ae[pe]={...ue,sort_order:Q.sort_order}:ae[pe]=ue}),v(ae),!!a)try{await m(ae)}catch(pe){v(l),I(pe instanceof Error?pe.message:"Failed to move category")}}async function M(P){if(a)try{const B=u.length>0?Math.max(...u.map(J=>J.sort_order)):-1,Q={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:P.name,sort_order:B+1},le=[...u,Q];x(le),await g(le)}catch(B){I(B instanceof Error?B.message:"Failed to create group")}}async function j(P,B){if(a)try{const Q=u.map(le=>le.id===P?{...le,name:B.name}:le);x(Q),await g(Q)}catch(Q){I(Q instanceof Error?Q.message:"Failed to update group")}}async function O(P){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&a)try{const B={};Object.entries(l).forEach(([le,J])=>{B[le]=J.category_group_id===P?{...J,category_group_id:null}:J});const Q=u.filter(le=>le.id!==P);v(B),x(Q),await _(B,Q)}catch(B){I(B instanceof Error?B.message:"Failed to delete group")}}async function C(P,B){const Q=[...u].sort((W,ne)=>W.sort_order-ne.sort_order),le=Q.findIndex(W=>W.id===P),J=B==="up"?le-1:le+1;if(J<0||J>=Q.length)return;const[z]=Q.splice(le,1);Q.splice(J,0,z);const F=Q.map((W,ne)=>({...W,sort_order:ne}));if(x(F),!!a)try{await g(F)}catch(W){x(u),I(W instanceof Error?W.message:"Failed to move group")}}const Y=Object.entries(l).reduce((P,[B,Q])=>{const le=Q.category_group_id||"ungrouped";return P[le]||(P[le]=[]),P[le].push([B,Q]),P},{}),U=[...u].sort((P,B)=>P.sort_order-B.sort_order);return{currentBudget:a,categories:l,categoryGroups:u,categoriesByGroup:Y,sortedGroups:U,categoryBalances:N,isLoading:f,loadingBalances:H,error:A,setError:I,getOnBudgetTotal:w,categoryBalanceMismatch:$,checkCategoryBalanceMismatch:q,recalculateAndSaveCategoryBalances:me,handleCreateCategory:he,handleUpdateCategory:L,handleDeleteCategory:R,handleMoveCategory:D,handleCreateGroup:M,handleUpdateGroup:j,handleDeleteGroup:O,handleMoveGroup:C,dragType:ie.dragType,draggedId:ie.draggedId,dragOverId:ie.dragOverId,dragOverGroupId:ie.dragOverGroupId,setDragOverId:ie.setDragOverId,setDragOverGroupId:ie.setDragOverGroupId,handleCategoryDragStart:ie.handleCategoryDragStart,handleCategoryDragOver:ie.handleCategoryDragOver,handleDragOverGroup:ie.handleDragOverGroup,handleDragLeave:ie.handleDragLeave,handleDragLeaveGroup:ie.handleDragLeaveGroup,handleDragEnd:ie.handleDragEnd,handleCategoryDrop:ie.handleCategoryDrop,handleDropOnGroup:ie.handleDropOnGroup,handleGroupDragStart:ie.handleGroupDragStart,handleGroupDrop:ie.handleGroupDrop}}function bE(t){return{nickname:t.nickname??"",description:t.description??"",balance:t.balance??0,account_group_id:t.account_group_id??null,sort_order:t.sort_order??0,is_income_account:t.is_income_account??!1,is_income_default:t.is_income_default??!1,is_outgo_account:t.is_outgo_account??!1,is_outgo_default:t.is_outgo_default??!1,on_budget:t.on_budget??!0,is_active:t.is_active??!0}}function xE(t){return{name:t.name??"",description:t.description??"",category_group_id:t.category_group_id??null,sort_order:t.sort_order??0,default_monthly_amount:t.default_monthly_amount??0,default_monthly_type:t.default_monthly_type??"fixed",balance:t.balance??0}}function EE(t){return{name:t.name??"",sort_order:t.sort_order??0,...t.expected_balance!==void 0&&{expected_balance:t.expected_balance},...t.on_budget!==void 0&&{on_budget:t.on_budget},...t.is_active!==void 0&&{is_active:t.is_active}}}function t4(t,e){const n=e.match(/_(\d{4})(\d{2})$/),i=n?parseInt(n[1]):new Date().getFullYear(),a=n?parseInt(n[2]):new Date().getMonth()+1,l=`${i}${String(a).padStart(2,"0")}`;return{budget_id:t.budget_id??"",year_month_ordinal:t.year_month_ordinal??l,year:t.year??i,month:t.month??a,income:Array.isArray(t.income)?t.income:[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:Array.isArray(t.expenses)?t.expenses:[],total_expenses:t.total_expenses??0,account_balances:Array.isArray(t.account_balances)?t.account_balances:[],category_balances:Array.isArray(t.category_balances)?t.category_balances:[],are_allocations_finalized:t.are_allocations_finalized??!1,is_needs_recalculation:t.is_needs_recalculation??!0,created_at:t.created_at??new Date().toISOString(),updated_at:t.updated_at??new Date().toISOString()}}function SE(t){return t.nickname===void 0||t.description===void 0||t.balance===void 0||t.sort_order===void 0||t.is_income_account===void 0||t.is_income_default===void 0||t.is_outgo_account===void 0||t.is_outgo_default===void 0||t.on_budget===void 0||t.is_active===void 0}function wE(t){return t.name===void 0||t.description===void 0||t.sort_order===void 0||t.default_monthly_amount===void 0||t.default_monthly_type===void 0||t.balance===void 0}function TE(t){return t.name===void 0||t.sort_order===void 0}function AE(t){return t.budget_id===void 0||t.year_month_ordinal===void 0||t.year===void 0||t.month===void 0||!Array.isArray(t.income)||t.total_income===void 0||t.previous_month_income===void 0||!Array.isArray(t.expenses)||t.total_expenses===void 0||!Array.isArray(t.account_balances)||!Array.isArray(t.category_balances)||t.are_allocations_finalized===void 0||t.is_needs_recalculation===void 0||t.created_at===void 0||t.updated_at===void 0}function CE(){const t=new Date,e=t.getFullYear();let i=t.getMonth()+1+2,a=e;return i>12&&(i-=12,a+=1),{year:a,month:i}}function RE(t,e,n){return t>n.year||t===n.year&&e>n.month}function n4({currentUser:t,onComplete:e}){const[n,i]=T.useState(!1),[a,l]=T.useState(!1),[u,f]=T.useState(null),[m,g]=T.useState(null);async function _(){if(t){i(!0);try{const A=await Mr("budgets","database cleanup: scanning all budgets");let I=0,N=0,H=0,$=0,q=0,me=0,ie=0;for(const M of A.docs){const j=M.data;if(Array.isArray(j.accounts)||Array.isArray(j.categories)||Array.isArray(j.account_groups)){I++;continue}const O=j.accounts;if(O&&typeof O=="object"){let U=!1;for(const P of Object.values(O))SE(P)&&(q++,U=!0);U&&N++}const C=j.categories;if(C&&typeof C=="object"){let U=!1;for(const P of Object.values(C))wE(P)&&(me++,U=!0);U&&H++}const Y=j.account_groups;if(Y&&typeof Y=="object"){let U=!1;for(const P of Object.values(Y))TE(P)&&(ie++,U=!0);U&&$++}}const he=await Mr("months","database cleanup: scanning all months"),L=CE(),R=[];let D=0;for(const M of he.docs){const j=M.data,O=j.year,C=j.month;O&&C&&RE(O,C,L)&&R.push({docId:M.id,budgetId:j.budget_id,year:O,month:C}),AE(j)&&D++}R.sort((M,j)=>M.year!==j.year?M.year-j.year:M.month-j.month),f({totalBudgets:A.docs.length,budgetsWithArrays:I,budgetsWithMissingAccountDefaults:N,budgetsWithMissingCategoryDefaults:H,budgetsWithMissingGroupDefaults:$,accountsNeedingDefaults:q,categoriesNeedingDefaults:me,groupsNeedingDefaults:ie,totalMonths:he.docs.length,futureMonthsToDelete:R,monthsWithSchemaIssues:D})}catch(A){console.error("Failed to scan database:",A)}finally{i(!1)}}}async function v(){if(!t)return;l(!0),g(null);const A=[];let I=0,N=0,H=0,$=0,q=0,me=0,ie=0;try{const he=await Mr("budgets","database cleanup: reading all budgets to fix");for(const D of he.docs)try{const{exists:M,data:j}=await Qe("budgets",D.id,"database cleanup: reading budget for update");if(!M||!j)continue;let O=!1;const C={...j};if(Array.isArray(j.accounts)){const Y=j.accounts,U={};for(const P of Y){const B=P.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;U[B]=bE(P),N++}C.accounts=U,O=!0,q++}if(Array.isArray(j.categories)){const Y=j.categories,U={};for(const P of Y){const B=P.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;U[B]=xE(P),H++}C.categories=U,O=!0,q++}if(Array.isArray(j.account_groups)){const Y=j.account_groups,U={};for(const P of Y){const B=P.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;U[B]=EE(P),$++}C.account_groups=U,O=!0,q++}if(!Array.isArray(j.accounts)&&j.accounts&&typeof j.accounts=="object"){const Y=j.accounts,U={};for(const[P,B]of Object.entries(Y))SE(B)?(U[P]=bE(B),N++,O=!0):U[P]=B;O&&(C.accounts=U)}if(!Array.isArray(j.categories)&&j.categories&&typeof j.categories=="object"){const Y=j.categories,U={};let P=!1;for(const[B,Q]of Object.entries(Y))wE(Q)?(U[B]=xE(Q),H++,P=!0):U[B]=Q;P&&(C.categories=U,O=!0)}if(!Array.isArray(j.account_groups)&&j.account_groups&&typeof j.account_groups=="object"){const Y=j.account_groups,U={};let P=!1;for(const[B,Q]of Object.entries(Y))TE(Q)?(U[B]=EE(Q),$++,P=!0):U[B]=Q;P&&(C.account_groups=U,O=!0)}C.is_needs_recalculation===void 0&&(C.is_needs_recalculation=!1,O=!0),delete C.category_balances,delete C.allocations,delete C.allocations_finalized,O&&(await yt("budgets",D.id,C,"database cleanup: saving fixed budget"),I++)}catch(M){A.push(`Budget ${D.id}: ${M instanceof Error?M.message:"Unknown error"}`)}const L=await Mr("months","database cleanup: reading all months"),R=CE();for(const D of L.docs)try{const M=D.data,j=M.year,O=M.month;if(j&&O&&RE(j,O,R)){await xy("months",D.id,`database cleanup: deleting future month ${j}-${O}`),me++;continue}if(AE(M)){const C=t4(M,D.id);await yt("months",D.id,C,"database cleanup: saving fixed month"),ie++}}catch(M){A.push(`Month ${D.id}: ${M instanceof Error?M.message:"Unknown error"}`)}g({budgetsProcessed:I,accountsFixed:N,categoriesFixed:H,groupsFixed:$,arraysConverted:q,futureMonthsDeleted:me,monthsFixed:ie,errors:A}),e?.()}catch(he){g({budgetsProcessed:0,accountsFixed:0,categoriesFixed:0,groupsFixed:0,arraysConverted:0,futureMonthsDeleted:0,monthsFixed:0,errors:[he instanceof Error?he.message:"Unknown error"]})}finally{l(!1)}}const x=u!==null&&(u.budgetsWithArrays>0||u.accountsNeedingDefaults>0||u.categoriesNeedingDefaults>0||u.groupsNeedingDefaults>0||u.futureMonthsToDelete.length>0||u.monthsWithSchemaIssues>0),w=u!==null?u.budgetsWithArrays+u.accountsNeedingDefaults+u.categoriesNeedingDefaults+u.groupsNeedingDefaults+u.futureMonthsToDelete.length+u.monthsWithSchemaIssues:0;return{status:u,isScanning:n,scanStatus:_,hasIssues:x,totalIssues:w,isRunning:a,result:m,runCleanup:v}}function Vp(t){return t.includes("@")?!1:!!(/_[a-z0-9]+_(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=2||/_[a-z0-9]+\.(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=1)}function r4(t){let e=t;const n=/^(.+)_(gmail|yahoo|hotmail|outlook|icloud|aol|proton|protonmail)\.(.+)$/i,i=e.match(n);return i?`${i[1]}@${i[2]}.${i[3]}`:(e=e.replace(/_com$/,".com").replace(/_net$/,".net").replace(/_org$/,".org").replace(/_edu$/,".edu").replace(/_io$/,".io"),e=e.replace(/_gmail_/,"@gmail.").replace(/_yahoo_/,"@yahoo.").replace(/_hotmail_/,"@hotmail.").replace(/_outlook_/,"@outlook.").replace(/_icloud_/,"@icloud."),e)}function hh(t){if(t===null||typeof t!="object"||Array.isArray(t))return!1;const e=t;return e._methodName==="arrayUnion"&&Array.isArray(e.vc)}function tT(t){return t.vc||[]}function DE(t){return Array.isArray(t.items)?t.items:hh(t.items)?tT(t.items):[]}function i4({currentUser:t}){const[e,n]=T.useState(!1),[i,a]=T.useState(!1),[l,u]=T.useState(null),[f,m]=T.useState(null);async function g(){if(!t)return;n(!0);const v={documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],isHealthy:!0};try{const x=await Mr("feedback","feedback migration: scanning for issues");v.documentsFound=x.docs.length;for(const w of x.docs)Vp(w.id)&&v.sanitizedDocuments.push(w.id),hh(w.data.items)&&v.corruptedDocuments.push(w.id);v.isHealthy=v.sanitizedDocuments.length===0&&v.corruptedDocuments.length===0,u(v)}catch(x){console.error("Failed to scan feedback:",x)}finally{n(!1)}}async function _(){if(!t)return;a(!0);const v=f?{...f,mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]}:{documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]};try{const x=await Mr("feedback","feedback migration: listing all documents");v.documentsFound=x.docs.length,v.sanitizedDocuments=[],v.corruptedDocuments=[];for(const w of x.docs){const A=Vp(w.id);if(hh(w.data.items)&&!A){v.corruptedDocuments.push(w.id);const N=tT(w.data.items);try{await yt("feedback",w.id,{items:N,user_email:w.data.user_email||w.id,created_at:w.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: fixing corrupted arrayUnion in ${w.id}`),v.fixedDocuments++}catch(H){v.errors.push(`Failed to fix ${w.id}: ${H instanceof Error?H.message:"Unknown error"}`)}}}for(const w of x.docs)if(Vp(w.id)){v.sanitizedDocuments.push(w.id);const A=w.id,I=r4(A),N=DE(w.data),{exists:H,data:$}=await Qe("feedback",I,`feedback migration: checking if ${I} exists`);if(H&&$){const q=DE($),me=new Set(q.map(he=>he.id)),ie=N.filter(he=>!me.has(he.id));if(ie.length>0||hh($.items)){const he=[...q,...ie];await yt("feedback",I,{...$,items:he,updated_at:new Date().toISOString()},`feedback migration: merging ${ie.length} items from ${A}`),v.mergedItems+=ie.length}}else N.length>0&&(await yt("feedback",I,{items:N,user_email:I,created_at:w.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: creating ${I} from ${A}`),v.mergedItems+=N.length);try{await xy("feedback",A,`feedback migration: deleting sanitized document ${A}`),v.deletedDocuments++}catch(q){v.errors.push(`Failed to delete ${A}: ${q instanceof Error?q.message:"Unknown error"}`)}}m(v)}catch(x){v.errors.push(x instanceof Error?x.message:"Migration failed"),m(v)}finally{a(!1)}}return{status:l,isScanning:e,scanStatus:g,isMigratingFeedback:i,feedbackMigrationResult:f,migrateFeedbackDocuments:_}}function s4({currentUser:t,onComplete:e}){const[n,i]=T.useState(!1),[a,l]=T.useState(!1),[u,f]=T.useState(null),[m,g]=T.useState(null);async function _(){if(t){i(!0);try{const x=await Mr("months","delete all months: scanning for all months"),w=[],A=new Set;for(const I of x.docs){const{budget_id:N,year:H,month:$}=I.data;A.add(N),w.push({docId:I.id,budgetId:N,year:H,month:$})}w.sort((I,N)=>I.budgetId!==N.budgetId?I.budgetId.localeCompare(N.budgetId):I.year!==N.year?I.year-N.year:I.month-N.month),f({monthsToDelete:w,monthsCount:w.length,budgetCount:A.size})}catch(x){console.error("Failed to scan months:",x)}finally{i(!1)}}}async function v(){if(!t||!u||u.monthsToDelete.length===0)return;l(!0),g(null);let x=0;const w=[];for(const A of u.monthsToDelete)try{await xy("months",A.docId,`delete all months: deleting month ${A.year}-${A.month} for budget ${A.budgetId}`),x++}catch(I){w.push(`Failed to delete ${A.docId}: ${I instanceof Error?I.message:"Unknown error"}`)}g({deleted:x,errors:w}),l(!1),w.length===0&&(f({monthsToDelete:[],monthsCount:0,budgetCount:0}),e?.())}return{status:u,isScanning:n,scanStatus:_,isDeleting:a,deleteResult:m,deleteAllMonths:v}}function a4({onCreateNew:t}){const[e,n]=T.useState(""),[i,a]=T.useState(!1),[l,u]=T.useState(null);async function f(m){m.preventDefault(),a(!0),u(null);try{await t(e.trim()||void 0)}catch(g){u(g instanceof Error?g.message:"Failed to create budget"),a(!1)}}return d.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:l}),d.jsx("button",{onClick:()=>u(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Create Your Budget"]}),d.jsxs("form",{onSubmit:f,children:[d.jsxs("div",{style:{marginBottom:"1.5rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:e,onChange:m=>n(m.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),d.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),d.jsx("button",{type:"submit",disabled:i,style:{width:"100%",background:ce.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontWeight:600,opacity:i?.7:1,fontSize:"1rem"},children:i?"Creating...":"Create Budget"})]})]}),d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function o4({invites:t,onAccept:e,onCreateNew:n}){const[i,a]=T.useState(null),[l,u]=T.useState(!1),[f,m]=T.useState(""),[g,_]=T.useState(!1),[v,x]=T.useState(null);async function w(I){a(I),x(null);try{await e(I)}catch(N){x(N instanceof Error?N.message:"Failed to accept invitation"),a(null)}}async function A(I){I.preventDefault(),_(!0),x(null);try{await n(f.trim()||void 0)}catch(N){x(N instanceof Error?N.message:"Failed to create new budget"),_(!1)}}return d.jsxs("div",{children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>x(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Budget Invitations"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(I=>d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:I.budgetName}),I.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",I.ownerEmail]})]}),d.jsx("button",{onClick:()=>w(I.budgetId),disabled:i!==null||g,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null||g?"not-allowed":"pointer",fontWeight:500,opacity:i!==null||g?.7:1,fontSize:"0.9rem"},children:i===I.budgetId?"Joining...":"Accept & Join"})]},I.budgetId))})]}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?d.jsxs("form",{onSubmit:A,children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),d.jsxs("div",{style:{marginBottom:"1rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:f,onChange:I=>m(I.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{type:"submit",disabled:g||i!==null,style:{background:ce.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||i!==null?"not-allowed":"pointer",fontWeight:500,opacity:g||i!==null?.7:1,fontSize:"0.9rem"},children:g?"Creating...":"Create Budget"}),d.jsx("button",{type:"button",onClick:()=>{u(!1),m("")},disabled:g,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g?"not-allowed":"pointer",fontWeight:500,opacity:g?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),d.jsx("button",{onClick:()=>u(!0),disabled:i!==null,style:{background:ce.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null?"not-allowed":"pointer",fontWeight:500,opacity:i!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function l4({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const i=T.useMemo(()=>[{id:"income",label:"Income"},{id:"balances",label:"Balances",checkmark:n},{id:"spend",label:"Spend"}],[n]);return d.jsx(Vy,{mode:"button",tabs:i,activeTab:t,onTabChange:a=>e(a)})}function c4({isOpen:t,onClose:e,onProceed:n,results:i}){const a=!i||i.status==="confirming",l=i&&!["confirming","done","error"].includes(i.status),u=a||i?.status==="done"||i?.status==="error";function f(){u&&e()}return d.jsx(sl,{isOpen:t,onClose:f,title:"Recalculate Balances",width:"540px",children:d.jsxs("div",{style:{padding:"0.5rem 0"},children:[a&&d.jsxs(d.Fragment,{children:[d.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",lineHeight:1.5},children:["This will recalculate category balances and account balances from the ",d.jsx("strong",{children:"current month forward"}),"."]}),d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Use this if your data seems out of sync or after fixing bugs. Past months will not be modified."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginBottom:"1.5rem"},children:[d.jsx(ko,{status:"waiting",label:"Find all months to process"}),d.jsx(ko,{status:"waiting",label:"Process months"}),d.jsx(ko,{status:"waiting",label:"Update budget totals"})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Le,{variant:"secondary",onClick:e,children:"Cancel"}),d.jsx(Le,{onClick:n,children:"Proceed"})]})]}),!a&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Recalculating category balances and account balances..."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx(ko,{status:i?.status==="pending"?"waiting":"complete",label:"Find all months to process",detail:i&&i.status!=="pending"?`Found ${i.monthsFound||0} month${i.monthsFound!==1?"s":""}`:void 0}),d.jsx(ko,{status:IE(i?.status,["pending","finding_months"],"processing_months"),label:"Process months",detail:i?.status==="processing_months"?`Processing: ${i.currentMonthLabel} (${(i.currentMonthIndex||0)+1}/${i.monthsFound||0})`:i?.monthsProcessed!==void 0?`Processed ${i.monthsProcessed} month${i.monthsProcessed!==1?"s":""}`:void 0}),d.jsx(ko,{status:i?.status==="error"?"error":IE(i?.status,["pending","finding_months","processing_months"],"updating_budget"),label:"Update budget totals",detail:i?.status==="error"?i.error:void 0,isError:i?.status==="error"})]}),i?.status==="done"&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${ce.success} 10%, transparent)`,border:`1px solid ${ce.success}`,borderRadius:"8px",textAlign:"center"},children:[d.jsx("p",{style:{margin:0,fontWeight:600,color:ce.success},children:" Recalculation complete!"}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:[i.monthsProcessed," month",i.monthsProcessed!==1?"s":""," processed",d.jsx("br",{}),"Total Income: ",je(i.totalIncomeRecalculated||0),d.jsx("br",{}),"Total Expenses: ",je(i.totalExpensesRecalculated||0)]})]}),(i?.status==="done"||i?.status==="error")&&d.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"center"},children:d.jsx(Le,{onClick:e,children:"Done"})}),l&&d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"Please wait, do not close this window..."})]})]})})}function IE(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function ko({status:t,label:e,detail:n,isError:i}){const a=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:a}),d.jsxs("div",{style:{flex:1},children:[d.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:i?1:.6,color:i?ce.error:"inherit"},children:n})]})]})}function Uy({isDisabled:t}){const{selectedBudgetId:e,currentUserId:n,currentYear:i,currentMonthNumber:a}=Sn(),{categories:l,accounts:u,saveCategories:f,saveAccounts:m}=Hn(e,n),[g,_]=T.useState(!1),[v,x]=T.useState(!1),[w,A]=T.useState(null);function I(){x(!0),A({status:"confirming"})}async function N(){if(e){_(!0),A({status:"pending"});try{A({status:"finding_months"});const $=new Date,q=i||$.getFullYear(),me=a||$.getMonth()+1,{year:ie,month:he}=Ey(q,me),L={year:ie,month:he},R=await Sy(e,ie,he),D=Object.keys(l);A({status:"finding_months",monthsFound:R.length}),await new Promise(F=>setTimeout(F,100));const M={};let j=null;const O=Bi(e,L.year,L.month),{exists:C,data:Y}=await Qe("months",O,"recalculate: reading previous month for starting balances");if(C&&Y&&(j=Y,Y.category_balances))for(const F of Y.category_balances)M[F.category_id]=F.end_balance??0;D.forEach(F=>{M[F]===void 0&&(M[F]=0)});let U=0,P=0;for(let F=0;F<R.length;F++){const W=R[F],ne=`${mf[W.month-1]} ${W.year}`;A({status:"processing_months",monthsFound:R.length,currentMonthIndex:F,currentMonthLabel:ne});const ae=Bi(e,W.year,W.month),{exists:pe,data:ue}=await Qe("months",ae,`recalculate: reading full month data for ${ne}`);if(!pe||!ue){console.warn(`Month ${ne} not found, skipping`);continue}const be=ue.income||[],Se=ue.expenses||[],de=ue.are_allocations_finalized||!1,Ce=be.reduce((Ne,Mt)=>Ne+Mt.amount,0),De=Se.reduce((Ne,Mt)=>Ne+Mt.amount,0);U+=Ce,P+=De;const Te={};if(ue.category_balances)for(const Ne of ue.category_balances)Te[Ne.category_id]={allocated:Ne.allocated??0};const Me=D.map(Ne=>{const Mt=M[Ne]??0;let ln=0;de&&Te[Ne]&&(ln=Te[Ne].allocated);let Dn=0;Se.length>0&&(Dn=Se.filter(jt=>jt.category_id===Ne).reduce((jt,Gn)=>jt+Gn.amount,0));const Nt=Mt+ln-Dn;return{category_id:Ne,start_balance:Mt,allocated:ln,spent:Dn,end_balance:Nt}});Me.forEach(Ne=>{M[Ne.category_id]=Ne.end_balance});const _t=(F===0?j:R[F-1])?.total_income??0,en=Object.keys(u).map(Ne=>{const Mt=be.filter(jt=>jt.account_id===Ne).reduce((jt,Gn)=>jt+Gn.amount,0),ln=Se.filter(jt=>jt.account_id===Ne).reduce((jt,Gn)=>jt+Gn.amount,0),Dn=Mt-ln;let Nt=0;if(ue.account_balances){const jt=ue.account_balances.find(Gn=>Gn.account_id===Ne);jt&&(Nt=jt.start_balance??0)}return{account_id:Ne,start_balance:Nt,income:Mt,expenses:ln,net_change:Dn,end_balance:Nt+Dn}}),lt={budget_id:e,year_month_ordinal:Fi(W.year,W.month),year:W.year,month:W.month,income:be,total_income:Ce,previous_month_income:_t,expenses:Se,total_expenses:De,account_balances:en,category_balances:Me,are_allocations_finalized:de,is_needs_recalculation:!1,created_at:ue.created_at||new Date().toISOString(),updated_at:new Date().toISOString()};await f1({budgetId:e,month:lt,description:"recalculate all months"}),await new Promise(Ne=>setTimeout(Ne,50))}const B={};Object.keys(u).forEach(F=>{B[F]=0});const Q=await Mr("months","recalculate: querying all months for account balances",[{field:"budget_id",op:"==",value:e}]);for(const F of Q.docs){const W=Bi(e,F.data.year,F.data.month),{exists:ne,data:ae}=await Qe("months",W,`recalculate: reading month ${F.data.year}/${F.data.month} for account balances`);if(!ne||!ae)continue;const pe=ae.income||[],ue=ae.expenses||[];for(const be of pe)be.account_id&&B[be.account_id]!==void 0&&(B[be.account_id]+=be.amount);for(const be of ue)be.account_id&&B[be.account_id]!==void 0&&(B[be.account_id]-=be.amount)}const le={};Object.entries(u).forEach(([F,W])=>{le[F]={...W,balance:B[F]??0}}),await m(le),A({status:"updating_budget",monthsFound:R.length,monthsProcessed:R.length,totalIncomeRecalculated:U,totalExpensesRecalculated:P});const J={...M},z={};Object.entries(l).forEach(([F,W])=>{z[F]={...W,balance:J[F]??0}}),await f(z);for(const F of R)Rt.invalidateQueries({queryKey:xe.month(e,F.year,F.month)});A({status:"done",monthsFound:R.length,monthsProcessed:R.length,totalIncomeRecalculated:U,totalExpensesRecalculated:P})}catch($){console.error("Recalculate error:",$),A({status:"error",error:$ instanceof Error?$.message:"Failed to recalculate"})}finally{_(!1)}}}function H(){x(!1),A(null)}return d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:I,disabled:t||g,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:t||g?"not-allowed":"pointer",opacity:t||g?.5:1,fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},title:"Recalculate balances from this month forward",children:[g?"":""," Recalculate"]}),d.jsx(c4,{isOpen:v,onClose:H,onProceed:N,results:w})]})}function u4({isLoading:t,onPreviousMonth:e,onNextMonth:n}){const{currentYear:i,currentMonthNumber:a,isAdmin:l,selectedBudgetId:u,currentUserId:f}=Sn(),{budget:m}=Hn(u,f),{month:g}=wl(u,i,a),[_,v]=T.useState(!1),x=T.useRef(null);T.useEffect(()=>{if(!_)return;function A(I){x.current&&!x.current.contains(I.target)&&v(!1)}return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[_]);function w(){if(!g||!m)return;const A={...g,_meta:{downloaded_at:new Date().toISOString(),budget_id:m.id,budget_name:m.name}},I=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),N=URL.createObjectURL(I),H=document.createElement("a");H.href=N,H.download=`month_${i}_${String(a).padStart(2,"0")}.json`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(N),v(!1)}return d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[d.jsx("button",{onClick:e,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Previous month",children:""}),d.jsxs("div",{ref:x,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[d.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[mf[a-1]," ",i]}),d.jsx("button",{onClick:()=>v(!_),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:_?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),t&&d.jsxs(d.Fragment,{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:ce.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),_&&d.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[d.jsx(Uy,{isDisabled:t}),l&&g&&d.jsx("button",{onClick:w,style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),d.jsx("button",{onClick:n,disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Next month",children:""})]})}const d4={background:ce.primary,border:"none",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px",color:"white"},h4={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"},f4={background:"transparent",border:`1px solid ${ce.errorBorder}`,color:ce.error,cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"};function nT({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:u,defaultDate:f,config:m,onSubmit:g,onCancel:_,onDelete:v,extraContent:x}){const{isMedium:w,isMobile:A}=VP(),{showCategory:I=!1,showCleared:N=!1,accountLabel:H="Account",payeePlaceholder:$="Payee name",descriptionPlaceholder:q="Optional note",submitLabel:me}=m,ie=new Date().toISOString().split("T")[0],[he,L]=T.useState(l?.date||f||ie),[R,D]=T.useState(l?.payee||""),[M,j]=T.useState(l?.categoryId||""),[O,C]=T.useState(l?.accountId||u||(t[0]?t[0][0]:"")),[Y,U]=T.useState(l?.amount?.toString()||""),[P,B]=T.useState(l?.description||""),[Q,le]=T.useState(l?.cleared||!1),J={},z=[];t.forEach(([Ce,De])=>{De.account_group_id?(J[De.account_group_id]||(J[De.account_group_id]=[]),J[De.account_group_id].push([Ce,De])):z.push([Ce,De])});function F(Ce){Ce.preventDefault();const De=parseFloat(Y);isNaN(De)||De<=0||I&&!M||!O||!he||g({date:he,payee:R.trim()||void 0,categoryId:I?M:void 0,accountId:O,amount:De,description:P.trim()||void 0,cleared:N?Q:void 0})}const W=d.jsxs(Jc,{id:"txn-account",value:O,onChange:Ce=>C(Ce.target.value),required:!0,style:{fontSize:"0.85rem",padding:"0.5rem"},children:[Object.entries(e).map(([Ce,De])=>{const Te=J[Ce];return Te?.length?d.jsx("optgroup",{label:De.name,children:Te.map(([Me,$e])=>d.jsx("option",{value:Me,children:$e.nickname},Me))},Ce):null}),z.length>0&&d.jsx("optgroup",{label:"Other",children:z.map(([Ce,De])=>d.jsx("option",{value:Ce,children:De.nickname},Ce))})]}),ne=I&&n&&i?d.jsx(Et,{label:"Category",htmlFor:"txn-category",children:d.jsx(xP,{id:"txn-category",value:M,onChange:j,categories:n,categoryGroups:i,placeholder:"Search...",required:!0})}):null,ae=N?d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.35rem"},children:[d.jsx("label",{htmlFor:"txn-cleared",style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:"Clr"}),d.jsx(js,{id:"txn-cleared",checked:Q,onChange:Ce=>le(Ce.target.checked)})]}):null,pe=d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.1rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[d.jsx("button",{type:"submit",title:me,style:d4,children:""}),d.jsx("button",{type:"button",onClick:_,title:"Cancel",style:h4,children:""}),v&&d.jsx("button",{type:"button",onClick:v,title:"Delete",style:f4,children:""})]})]}),ue=d.jsxs(Ha,{children:[d.jsx(Le,{type:"submit",children:me}),d.jsx(Le,{type:"button",variant:"secondary",onClick:_,children:"Cancel"}),v&&d.jsx(Le,{type:"button",variant:"danger",onClick:v,children:" Delete"})]});if(A)return d.jsxs(Hs,{onSubmit:F,children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[d.jsx(Et,{label:"Date",htmlFor:"txn-date",children:d.jsx(Pp,{id:"txn-date",value:he,onChange:Ce=>L(Ce.target.value),required:!0})}),d.jsx(Et,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(dh,{id:"txn-amount",value:Y,onChange:U,placeholder:"$0.00",required:!0,autoFocus:!0})})]}),d.jsx(Et,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(Np,{id:"txn-payee",value:R,onChange:D,payees:a,placeholder:$})}),ne,d.jsx(Et,{label:H,htmlFor:"txn-account",children:W}),d.jsx(Et,{label:"Description (optional)",htmlFor:"txn-description",children:d.jsx(Gs,{id:"txn-description",value:P,onChange:Ce=>B(Ce.target.value),placeholder:q})}),N&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx(js,{id:"txn-cleared-mobile",checked:Q,onChange:Ce=>le(Ce.target.checked)}),d.jsx("label",{htmlFor:"txn-cleared-mobile",style:{fontSize:"0.9rem",cursor:"pointer"},children:"Cleared (appeared in bank account)"})]}),x]}),ue]});const be=I&&n&&i,Se={fontSize:"0.85rem",padding:"0.5rem"};if(w){const Ce=be?"6rem 1fr 1fr 1fr":"6rem 1fr 1fr",De=be?2:1;return d.jsxs(Hs,{onSubmit:F,children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:Ce,gap:"0.75rem",alignItems:"end"},children:[d.jsx(Et,{label:"Date",htmlFor:"txn-date",children:d.jsx(Pp,{id:"txn-date",value:he,onChange:Te=>L(Te.target.value),required:!0,style:Se})}),d.jsx(Et,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(Np,{id:"txn-payee",value:R,onChange:D,payees:a,placeholder:$})}),ne,d.jsx(Et,{label:H,htmlFor:"txn-account",children:W})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:Ce,gap:"0.75rem",alignItems:"end",marginTop:"0.75rem"},children:[d.jsx(Et,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(dh,{id:"txn-amount",value:Y,onChange:U,placeholder:"$0.00",required:!0,autoFocus:!0})}),d.jsx(Et,{label:"Description",htmlFor:"txn-description",style:{gridColumn:`span ${De}`},children:d.jsx(Gs,{id:"txn-description",value:P,onChange:Te=>B(Te.target.value),placeholder:q,style:Se})}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"end",justifyContent:"flex-end"},children:[ae,pe]})]}),x]})}const de=be?N?"6rem 1fr 1fr 1fr 6rem 1fr auto auto":"6rem 1fr 1fr 1fr 6rem 1fr auto":N?"6rem 1fr 1fr 6rem 1fr auto auto":"6rem 1fr 1fr 6rem 1fr auto";return d.jsxs(Hs,{onSubmit:F,children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:de,gap:"0.75rem",alignItems:"end"},children:[d.jsx(Et,{label:"Date",htmlFor:"txn-date",children:d.jsx(Pp,{id:"txn-date",value:he,onChange:Ce=>L(Ce.target.value),required:!0,style:Se})}),d.jsx(Et,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(Np,{id:"txn-payee",value:R,onChange:D,payees:a,placeholder:$})}),ne,d.jsx(Et,{label:H,htmlFor:"txn-account",children:W}),d.jsx(Et,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(dh,{id:"txn-amount",value:Y,onChange:U,placeholder:"$0.00",required:!0,autoFocus:!0})}),d.jsx(Et,{label:"Description",htmlFor:"txn-description",children:d.jsx(Gs,{id:"txn-description",value:P,onChange:Ce=>B(Ce.target.value),placeholder:q,style:Se})}),ae,pe]}),x]})}function jE({accounts:t,accountGroups:e,payees:n,initialData:i,defaultAccountId:a,defaultDate:l,onSubmit:u,onCancel:f,onDelete:m,submitLabel:g}){function _(v){u(v.amount,v.accountId,v.date,v.payee,v.description)}return d.jsx(nT,{accounts:t,accountGroups:e,payees:n,initialData:i?{date:i.date,payee:i.payee,accountId:i.account_id,amount:i.amount,description:i.description}:void 0,defaultAccountId:a,defaultDate:l,config:{showCategory:!1,showCleared:!1,accountLabel:"Deposit To",payeePlaceholder:"e.g., Employer, Client name",descriptionPlaceholder:"e.g., January paycheck",submitLabel:g},onSubmit:_,onCancel:f,onDelete:m})}function rT(){const[t,e]=T.useState(()=>typeof window>"u"?!0:window.innerWidth>=Vi.wide);return T.useEffect(()=>{function n(){e(window.innerWidth>=Vi.wide)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}function m4({income:t,accountName:e,accountGroupName:n,onEdit:i,onDelete:a,isMobile:l}){const u=rT(),f=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",m=n?`${n} / ${e}`:e;return l?d.jsxs("div",{onClick:i,style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:f}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""})]}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",m]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:ce.success,fontFamily:"monospace"},children:["+",je(t.amount)]})})]}):u?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 6rem 1fr 4rem",gap:"0.75rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:g=>g.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:f}),d.jsx("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),d.jsx("span",{style:{fontSize:"0.85rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m}),d.jsxs("span",{style:{fontWeight:600,color:ce.success,fontFamily:"monospace",textAlign:"right"},children:["+",je(t.amount)]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description||""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 6rem 4rem",gap:"0.5rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:g=>g.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:f}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),t.description&&d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e}),d.jsxs("span",{style:{fontWeight:600,color:ce.success,fontFamily:"monospace",textAlign:"right",fontSize:"0.9rem"},children:["+",je(t.amount)]}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function p4(){return rT()?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 6rem 1fr 4rem",gap:"0.75rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{children:"Description"}),d.jsx("span",{})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 6rem 4rem",gap:"0.5rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{})]})}function g4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Sn(),{accounts:a,accountGroups:l}=Hn(t,e),{month:u,isLoading:f,addIncome:m,updateIncome:g,deleteIncome:_}=wl(t,n,i),v=Xi(),[x,w]=T.useState(null),[A,I]=T.useState(!1),[N,H]=T.useState(null),me=m1(t,{enabled:A||N!==null}).data||[];function ie(P){const B=P.account_group_id?l[P.account_group_id]:void 0;return B?.is_active!==void 0?B.is_active:P.is_active!==!1}function he(P){const B=P.account_group_id?l[P.account_group_id]:void 0;return B?.on_budget!==void 0?B.on_budget:P.on_budget!==!1}const L=Object.entries(a).filter(([,P])=>ie(P)&&he(P)),R=L.filter(([,P])=>P.is_income_account),D=R.length>0?R:L,M=L.find(([,P])=>P.is_income_default),j=M?M[0]:void 0,O=u?.income.reduce((P,B)=>P+B.amount,0)||0;function C(P,B,Q,le,J){w(null),I(!1),m(P,B,Q,le,J).catch(z=>{w(z instanceof Error?z.message:"Failed to add income")})}function Y(P,B,Q,le,J,z){w(null),H(null),g(P,B,Q,le,J,z).catch(F=>{w(F instanceof Error?F.message:"Failed to update income")})}function U(P){confirm("Are you sure you want to delete this income entry?")&&(w(null),_(P).catch(B=>{w(B instanceof Error?B.message:"Failed to delete income")}))}return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:f?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:f?"none":"auto"},children:[x&&d.jsx("div",{style:{background:`color-mix(in srgb, ${ce.error} 15%, transparent)`,border:`1px solid ${ce.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ce.error},children:x}),d.jsx(eT,{label:"Total",value:d.jsx("span",{style:{color:sn(O)},children:je(O)}),action:!A&&d.jsx(Le,{onClick:()=>I(!0),disabled:D.length===0,children:"+ Add Income"})}),D.length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",d.jsx(Dt,{to:"/budget/accounts",style:{color:ce.primaryLight},children:"Manage accounts "})]}),A&&d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx(jE,{accounts:D,accountGroups:l,payees:me,defaultAccountId:j,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:C,onCancel:()=>I(!1),submitLabel:"Add Income",isMobile:v})}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem"},children:[!v&&u?.income&&u.income.length>0&&d.jsx(p4,{}),u?.income.slice().sort((P,B)=>(P.date||"").localeCompare(B.date||"")).map(P=>N===P.id?d.jsx("div",{style:{padding:"0.5rem"},children:d.jsx(jE,{accounts:D,accountGroups:l,payees:me,initialData:P,onSubmit:(B,Q,le,J,z)=>Y(P.id,B,Q,le,J,z),onCancel:()=>H(null),onDelete:()=>U(P.id),submitLabel:"Save",isMobile:v})},P.id):d.jsx(m4,{income:P,accountName:a[P.account_id]?.nickname||"Unknown Account",accountGroupName:a[P.account_id]?.account_group_id?l[a[P.account_id].account_group_id]?.name:void 0,onEdit:()=>H(P.id),onDelete:()=>U(P.id),isMobile:v},P.id)),(!u?.income||u.income.length===0)&&!A&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No income recorded for this month"})]})]})}function OE({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:u,defaultDate:f,onSubmit:m,onCancel:g,onDelete:_,submitLabel:v}){function x(w){m(w.amount,w.categoryId,w.accountId,w.date,w.payee,w.description,w.cleared)}return d.jsx(nT,{accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l?{date:l.date,payee:l.payee,categoryId:l.category_id,accountId:l.account_id,amount:l.amount,description:l.description,cleared:l.cleared}:void 0,defaultAccountId:u,defaultDate:f,config:{showCategory:!0,showCleared:!0,accountLabel:"Pay From",payeePlaceholder:"e.g., Grocery Store",descriptionPlaceholder:"e.g., Weekly groceries",submitLabel:v},onSubmit:x,onCancel:g,onDelete:_})}function iT(){const[t,e]=T.useState(()=>typeof window>"u"?!0:window.innerWidth>=Vi.wide);return T.useEffect(()=>{function n(){e(window.innerWidth>=Vi.wide)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}function y4({expense:t,categoryName:e,accountName:n,accountGroupName:i,onEdit:a,onDelete:l,isMobile:u}){const f=iT(),m=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",g=i?`${i} / ${n}`:n;return u?d.jsxs("div",{onClick:a,style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:m}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""}),t.cleared&&d.jsx("span",{style:{fontSize:"0.7rem",color:ce.success},title:"Cleared",children:""})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:{fontSize:"0.7rem",background:`color-mix(in srgb, ${ce.primary} 20%, transparent)`,color:ce.primaryLight,padding:"0.1rem 0.4rem",borderRadius:"3px"},children:e}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",g]})]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:ce.error,fontFamily:"monospace"},children:["-",je(t.amount)]})})]}):f?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 8rem 6rem 1fr 3rem 4rem",gap:"0.75rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:_=>_.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:m}),d.jsx("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),d.jsx("span",{style:{fontSize:"0.8rem",background:`color-mix(in srgb, ${ce.primary} 15%, transparent)`,color:ce.primaryLight,padding:"0.2rem 0.5rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e}),d.jsx("span",{style:{fontSize:"0.85rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:g}),d.jsxs("span",{style:{fontWeight:600,color:ce.error,fontFamily:"monospace",textAlign:"right"},children:["-",je(t.amount)]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description||""}),d.jsx("span",{style:{textAlign:"center",color:t.cleared?ce.success:"inherit",opacity:t.cleared?1:.3,fontSize:"1rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 7rem 6rem 3rem 4rem",gap:"0.5rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:_=>_.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:m}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),t.description&&d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]}),d.jsx("span",{style:{fontSize:"0.75rem",background:`color-mix(in srgb, ${ce.primary} 15%, transparent)`,color:ce.primaryLight,padding:"0.15rem 0.4rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n}),d.jsxs("span",{style:{fontWeight:600,color:ce.error,fontFamily:"monospace",textAlign:"right",fontSize:"0.9rem"},children:["-",je(t.amount)]}),d.jsx("span",{style:{textAlign:"center",color:t.cleared?ce.success:"inherit",opacity:t.cleared?1:.3,fontSize:"0.9rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function _4(){return iT()?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 8rem 6rem 1fr 3rem 4rem",gap:"0.75rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{style:{textAlign:"center"},children:"Category"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{children:"Description"}),d.jsx("span",{style:{textAlign:"center"},children:"Clr"}),d.jsx("span",{})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 7rem 6rem 3rem 4rem",gap:"0.5rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{style:{textAlign:"center"},children:"Category"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{style:{textAlign:"center"},children:"Clr"}),d.jsx("span",{})]})}function v4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Sn(),{accounts:a,accountGroups:l,categories:u,categoryGroups:f}=Hn(t,e),{month:m,isLoading:g,addExpense:_,updateExpense:v,deleteExpense:x}=wl(t,n,i),w=Xi(),[A,I]=T.useState(null),[N,H]=T.useState(!1),[$,q]=T.useState(null),he=m1(t,{enabled:N||$!==null}).data||[];function L(Q){const le=Q.account_group_id?l[Q.account_group_id]:void 0;return le?.is_active!==void 0?le.is_active:Q.is_active!==!1}function R(Q){const le=Q.account_group_id?l[Q.account_group_id]:void 0;return le?.on_budget!==void 0?le.on_budget:Q.on_budget!==!1}const D=Object.entries(a).filter(([,Q])=>L(Q)&&R(Q)),M=D.filter(([,Q])=>Q.is_outgo_account),j=M.length>0?M:D,O=D.find(([,Q])=>Q.is_outgo_default),C=O?O[0]:void 0,Y=m?.expenses?.reduce((Q,le)=>Q+le.amount,0)||0;function U(Q,le,J,z,F,W,ne){I(null),H(!1),_(Q,le,J,z,F,W,ne).catch(ae=>{I(ae instanceof Error?ae.message:"Failed to add expense")})}function P(Q,le,J,z,F,W,ne,ae){I(null),q(null),v(Q,le,J,z,F,W,ne,ae).catch(pe=>{I(pe instanceof Error?pe.message:"Failed to update expense")})}function B(Q){confirm("Are you sure you want to delete this expense?")&&(I(null),x(Q).catch(le=>{I(le instanceof Error?le.message:"Failed to delete expense")}))}return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:g?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:g?"none":"auto"},children:[A&&d.jsx("div",{style:{background:`color-mix(in srgb, ${ce.error} 15%, transparent)`,border:`1px solid ${ce.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:ce.error},children:A}),d.jsx(eT,{label:"Total Expenses",value:d.jsxs("span",{style:{color:Y>0?ce.error:"inherit"},children:[Y>0?"-":"",je(Y)]}),action:!N&&d.jsx(Le,{onClick:()=>H(!0),disabled:j.length===0||Object.keys(u).length===0,children:"+ Add Expense"})}),j.length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(a).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",d.jsx(Dt,{to:"/budget/accounts",style:{color:ce.primaryLight},children:"Manage accounts "})]}),Object.keys(u).length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:["You need to create at least one category before adding expenses."," ",d.jsx(Dt,{to:"/budget/settings/categories",style:{color:ce.primaryLight},children:"Create categories "})]}),N&&d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx(OE,{accounts:j,accountGroups:l,categories:u,categoryGroups:f,payees:he,defaultAccountId:C,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:U,onCancel:()=>H(!1),submitLabel:"Add Expense",isMobile:w})}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem"},children:[!w&&m?.expenses&&m.expenses.length>0&&d.jsx(_4,{}),m?.expenses?.slice().sort((Q,le)=>(Q.date||"").localeCompare(le.date||"")).map(Q=>$===Q.id?d.jsx("div",{style:{padding:"0.5rem"},children:d.jsx(OE,{accounts:j,accountGroups:l,categories:u,categoryGroups:f,payees:he,initialData:Q,onSubmit:(le,J,z,F,W,ne,ae)=>P(Q.id,le,J,z,F,W,ne,ae),onCancel:()=>q(null),onDelete:()=>B(Q.id),submitLabel:"Save",isMobile:w})},Q.id):d.jsx(y4,{expense:Q,categoryName:u[Q.category_id]?.name||"Unknown Category",accountName:a[Q.account_id]?.nickname||"Unknown Account",accountGroupName:a[Q.account_id]?.account_group_id?l[a[Q.account_id].account_group_id]?.name:void 0,onEdit:()=>q(Q.id),onDelete:()=>B(Q.id),isMobile:w},Q.id)),(!m?.expenses||m.expenses.length===0)&&!N&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No expenses recorded for this month"})]})]})}function b4({accounts:t,accountGroups:e,accountBalances:n,isMobile:i}){const a=T.useMemo(()=>Object.entries(e).map(([u,f])=>({id:u,...f})).sort((u,f)=>u.sort_order-f.sort_order),[e]),l=T.useMemo(()=>{const u={};return Object.entries(t).forEach(([f,m])=>{const g=m.account_group_id||"ungrouped";u[g]||(u[g]=[]),u[g].push([f,m])}),Object.keys(u).forEach(f=>{u[f].sort((m,g)=>m[1].sort_order-g[1].sort_order)}),u},[t]);return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(t).length===0&&d.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No accounts yet."," ",d.jsx(Dt,{to:"/budget/settings/accounts",style:{color:ce.primaryLight},children:"Add accounts "})]}),a.map(u=>{const f=l[u.id]||[];if(f.length===0)return null;const m=f.reduce((g,[_])=>{const v=n[_];return v?{start:g.start+v.start_balance,income:g.income+v.income,expenses:g.expenses+v.expenses,netChange:g.netChange+v.net_change,end:g.end+v.end_balance}:g},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(kE,{name:u.name,accounts:f,groupTotals:m,accountBalances:n,isMobile:i},u.id)}),l.ungrouped?.length>0&&(()=>{const u=l.ungrouped,f=u.reduce((m,[g])=>{const _=n[g];return _?{start:m.start+_.start_balance,income:m.income+_.income,expenses:m.expenses+_.expenses,netChange:m.netChange+_.net_change,end:m.end+_.end_balance}:m},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(kE,{name:"Ungrouped",accounts:u,groupTotals:f,accountBalances:n,isMobile:i,isUngrouped:!0},"ungrouped")})()]})}function kE({name:t,accounts:e,groupTotals:n,accountBalances:i,isMobile:a,isUngrouped:l}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...El,margin:0,opacity:l?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"0.8rem",color:n.netChange>=0?ce.success:ce.error},children:[n.netChange>=0?"+":"",je(n.netChange)]}),d.jsx("span",{style:{fontWeight:600,color:sn(n.end)},children:je(n.end)})]})]}),!a&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Start"}),d.jsx("span",{style:{textAlign:"right"},children:"Net Change"}),d.jsx("span",{style:{textAlign:"right"},children:"End"}),d.jsx("span",{style:{textAlign:"right"}})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:e.map(([u,f])=>{const m=i[u];return m?a?d.jsx(x4,{account:f,balance:m},u):d.jsx(E4,{account:f,balance:m},u):null})})]})}function x4({account:t,balance:e}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.nickname})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:je(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Net Change"}),d.jsxs("span",{style:{color:e.net_change>=0?ce.success:ce.error},children:[e.net_change>=0?"+":"",je(e.net_change)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:sn(e.end_balance)},children:je(e.end_balance)})]})]}),(e.income>0||e.expenses>0)&&d.jsxs("div",{style:{marginTop:"0.5rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)",display:"flex",gap:"1rem",fontSize:"0.7rem",opacity:.7},children:[e.income>0&&d.jsxs("span",{children:["+",je(e.income)," income"]}),e.expenses>0&&d.jsxs("span",{children:["-",je(e.expenses)," expenses"]})]})]})}function E4({account:t,balance:e}){return d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[d.jsxs("div",{style:{minWidth:0,overflow:"hidden"},children:[d.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.nickname}),(e.income>0||e.expenses>0)&&d.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5},children:[e.income>0&&`+${je(e.income)}`,e.income>0&&e.expenses>0&&" / ",e.expenses>0&&`-${je(e.expenses)}`]})]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:je(e.start_balance)}),d.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.net_change>=0?ce.success:ce.error},children:[e.net_change>=0?"+":"",je(e.net_change)]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:sn(e.end_balance)},children:je(e.end_balance)}),d.jsx("span",{})]})}function ME({name:t,categories:e,groupEndBalance:n,groupAllocated:i,getCategoryBalance:a,localAllocations:l,previousMonthIncome:u,isDraftMode:f,onAllocationChange:m,isMobile:g,isUngrouped:_}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...El,margin:0,opacity:_?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"0.8rem",opacity:.6},children:["+",je(i)]}),d.jsx("span",{style:{fontWeight:600,color:sn(n)},children:je(n)})]})]}),!g&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"2fr 120px 1fr 1fr 1fr":"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[d.jsx("span",{children:"Category"}),d.jsx("span",{style:{textAlign:f?"center":"right"},children:"Allocated"}),d.jsx("span",{style:{textAlign:"right"},children:"Start"}),d.jsx("span",{style:{textAlign:"right"},children:"Spent"}),d.jsx("span",{style:{textAlign:"right"},children:"End"})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:f?"0.5rem":"0.25rem"},children:e.map(([v,x])=>{const w=a(v);return w?g?d.jsx(S4,{category:x,balance:w,localAllocation:l[v]||"",previousMonthIncome:u,isDraftMode:f,onAllocationChange:A=>m(v,A)},v):d.jsx(w4,{category:x,balance:w,localAllocation:l[v]||"",previousMonthIncome:u,isDraftMode:f,onAllocationChange:A=>m(v,A)},v):null})})]})}function S4({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l}){const u=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,f=u?t.default_monthly_amount/100*i:0,m=u?f.toFixed(2):n,g=a&&!u;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.name})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:je(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),g?d.jsx("input",{type:"text",inputMode:"decimal",value:m?`$${m}`:"",onChange:_=>{const v=_.target.value.replace(/[^\d.]/g,"");l(v)},placeholder:"$0",style:{width:"100%",maxWidth:"80px",padding:"0.25rem 0.35rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 8%, transparent)",fontSize:"0.8rem",color:"inherit",boxSizing:"border-box"}}):d.jsxs("span",{style:{color:e.allocated>0?ce.success:"inherit"},children:[e.allocated>0?"+":"",je(e.allocated)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),d.jsxs("span",{style:{color:e.spent>0?ce.error:"inherit"},children:[e.spent>0?"-":"",je(e.spent)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:sn(e.end_balance)},children:je(e.end_balance)})]})]}),a&&u&&d.jsx("div",{style:{marginTop:"0.5rem"},children:d.jsxs("span",{style:{fontSize:"0.8rem"},children:[d.jsxs("span",{style:{opacity:.6},children:[je(i),"  "]}),d.jsxs("span",{style:{color:ce.primary},children:[t.default_monthly_amount,"%"]}),d.jsx("span",{style:{opacity:.6},children:" = "}),d.jsx("span",{style:{color:ce.primary},children:je(f)})]})})]})}function w4({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l}){const u=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,f=u?t.default_monthly_amount/100*i:0,m=u?f.toFixed(2):n;let g=null;return a&&!u&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&(g=je(t.default_monthly_amount)),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:a?"2fr 120px 1fr 1fr 1fr":"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[d.jsxs("div",{style:{minWidth:0,overflow:"hidden"},children:[d.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),g&&d.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5},children:["Suggested: ",g]})]}),a?d.jsx("div",{children:u?d.jsxs("div",{style:{textAlign:"center",fontSize:"0.8rem"},children:[d.jsxs("span",{style:{opacity:.5},children:[je(i),"  "]}),d.jsxs("span",{style:{color:ce.primary},children:[t.default_monthly_amount,"%"]}),d.jsxs("span",{style:{display:"block",marginTop:"0.15rem"},children:[d.jsx("span",{style:{opacity:.5},children:"= "}),d.jsx("span",{style:{color:ce.primary},children:je(f)})]})]}):d.jsx("input",{type:"text",inputMode:"decimal",value:m?`$${m}`:"",onChange:_=>{const v=_.target.value.replace(/[^\d.]/g,"");l(v)},placeholder:"$0.00",style:{width:"100%",padding:"0.4rem 0.5rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box"}})}):d.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.allocated>0?ce.success:"inherit"},children:[e.allocated>0?"+":"",je(e.allocated)]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:je(e.start_balance)}),d.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.spent>0?ce.error:"inherit"},children:[e.spent>0?"-":"",je(e.spent)]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:sn(e.end_balance)},children:je(e.end_balance)})]})}const NE=["categories","accounts"];function T4(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,lastBalancesView:a,setLastBalancesView:l}=Sn(),{categories:u,categoryGroups:f,accounts:m,accountGroups:g}=Hn(t,e),{month:_,isLoading:v}=wl(t,n,i),x=Xi(),[w,A]=CR(),I=()=>{const Te=w.get("view");return Te&&NE.includes(Te)?Te:a},[N,H]=T.useState(I),[$,q]=T.useState(!1),me=Te=>{H(Te),l(Te),A({view:Te},{replace:!0})};T.useEffect(()=>{const Te=w.get("view");(!Te||!NE.includes(Te))&&A({view:a},{replace:!0})},[]);const{localAllocations:ie,isSavingAllocations:he,isFinalizingAllocations:L,isDeletingAllocations:R,isEditingAppliedAllocations:D,error:M,availableNow:j,draftChangeAmount:O,availableAfterApply:C,previousMonthIncome:Y,allocationsFinalized:U,getAllocationAmount:P,handleAllocationChange:B,resetAllocationsToSaved:Q,handleSaveAllocations:le,handleFinalizeAllocations:J,handleDeleteAllocations:z,setIsEditingAppliedAllocations:F,setError:W}=XP(),ne=[...f].sort((Te,Me)=>Te.sort_order-Me.sort_order),ae=T.useMemo(()=>{const Te=Object.entries(u).reduce((Me,[$e,_t])=>{const wt=_t.category_group_id||"ungrouped";return Me[wt]||(Me[wt]=[]),Me[wt].push([$e,_t]),Me},{});return Object.keys(Te).forEach(Me=>{Te[Me].sort(($e,_t)=>$e[1].sort_order-_t[1].sort_order)}),Te},[u]),pe=L||R,ue=!U||D,be=T.useMemo(()=>{const Te={};_?.category_balances&&_.category_balances.forEach($e=>{Te[$e.category_id]=$e});const Me={};return Object.entries(u).forEach(([$e,_t])=>{const wt=Te[$e],en=wt?.start_balance??0,lt=wt?.spent??0;let Ne=0;ue?Ne=P($e,_t):U&&wt&&(Ne=wt.allocated),Me[$e]={category_id:$e,start_balance:en,allocated:Ne,spent:lt,end_balance:en+Ne-lt}}),Me},[_,u,ue,U,P]),Se=Te=>be[Te],de=T.useMemo(()=>{const Te={};_?.account_balances&&_.account_balances.forEach($e=>{Te[$e.account_id]=$e});const Me={};return Object.entries(m).forEach(([$e,_t])=>{const en=Te[$e]?.start_balance??_t.balance;let lt=0;_?.income&&(lt=_.income.filter(ln=>ln.account_id===$e).reduce((ln,Dn)=>ln+Dn.amount,0));let Ne=0;_?.expenses&&(Ne=_.expenses.filter(ln=>ln.account_id===$e).reduce((ln,Dn)=>ln+Dn.amount,0));const Mt=lt-Ne;Me[$e]={account_id:$e,start_balance:en,income:lt,expenses:Ne,net_change:Mt,end_balance:en+Mt}}),Me},[_,m]),Ce=T.useMemo(()=>Object.values(de).reduce((Te,Me)=>({start:Te.start+Me.start_balance,income:Te.income+Me.income,expenses:Te.expenses+Me.expenses,netChange:Te.netChange+Me.net_change,end:Te.end+Me.end_balance}),{start:0,income:0,expenses:0,netChange:0,end:0}),[de]),De=T.useMemo(()=>Object.values(be).reduce((Te,Me)=>({start:Te.start+Me.start_balance,allocated:Te.allocated+Me.allocated,spent:Te.spent+Me.spent,end:Te.end+Me.end_balance}),{start:0,allocated:0,spent:0,end:0}),[be]);return d.jsxs("div",{style:{opacity:v?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:v?"none":"auto"},children:[d.jsx(MP,{isVisible:pe,message:R?"Deleting allocations...":"Saving allocations..."}),M&&d.jsx(Sl,{message:M,onDismiss:()=>W(null)}),d.jsx(wP,{items:N==="categories"?[{label:"Available Now",value:d.jsx("span",{style:{color:sn(j)},children:je(j)})},{label:ue?"Draft Allocations":"Allocated",value:D?d.jsxs("span",{children:[d.jsxs("span",{style:{color:ce.primary},children:["+",je(De.allocated)]}),O!==0&&d.jsxs("span",{style:{marginLeft:"0.35rem",fontSize:"0.85em",color:O>0?ce.warning:ce.success},children:["(",O>0?"+":"",je(Math.abs(O)),")"]})]}):d.jsxs("span",{style:{color:ue?ce.primary:ce.success},children:["+",je(De.allocated)]})},{label:"Spent",value:d.jsxs("span",{style:{color:ce.error},children:["-",je(De.spent)]})},{label:"Available After",value:d.jsx("span",{style:{color:sn(C)},children:je(C)})}]:[{label:"Start of Month",value:d.jsx("span",{style:{color:sn(Ce.start)},children:je(Ce.start)})},{label:"Income",value:d.jsxs("span",{style:{color:ce.success},children:["+",je(Ce.income)]})},{label:"Expenses",value:d.jsxs("span",{style:{color:ce.error},children:["-",je(Ce.expenses)]})},{label:"End of Month",value:d.jsx("span",{style:{color:sn(Ce.end)},children:je(Ce.end)})}]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap",alignItems:"center"},children:[d.jsx(Le,{onClick:()=>me(N==="categories"?"accounts":"categories"),variant:"secondary",style:{fontSize:"0.85rem"},children:N==="categories"?" Switch to Account Balances":" Switch to Category Balances"}),N==="categories"&&ue&&!D&&d.jsxs(d.Fragment,{children:[d.jsx(Le,{onClick:le,disabled:he||L||v,variant:"secondary",style:{fontSize:"0.85rem"},children:he?"...":" Save Draft"}),d.jsx(Le,{onClick:J,disabled:he||L||v,variant:"secondary",style:{fontSize:"0.85rem"},children:L?"...":" Apply Allocations"})]}),N==="categories"&&!ue&&U&&d.jsx(Le,{onClick:()=>F(!0),variant:"secondary",style:{fontSize:"0.85rem"},children:" Edit Allocations"}),N==="categories"&&D&&d.jsxs(d.Fragment,{children:[d.jsx(Le,{onClick:J,disabled:he||L||v,variant:"secondary",style:{fontSize:"0.85rem"},children:L?"...":" Apply Allocations"}),d.jsx(Le,{onClick:Q,disabled:L||R||v,variant:"secondary",style:{fontSize:"0.85rem"},children:" Cancel"}),d.jsx(Le,{onClick:()=>q(!0),disabled:R||v,variant:"secondary",style:{fontSize:"0.85rem",color:ce.error},children:" Delete"})]})]}),N==="accounts"&&d.jsx(b4,{accounts:m,accountGroups:g,accountBalances:de,isMobile:x}),N==="categories"&&d.jsx(d.Fragment,{children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(u).length===0&&d.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",d.jsx(Dt,{to:"/budget/settings/categories",style:{color:ce.primaryLight},children:"Create categories "})]}),ne.map(Te=>{const Me=ae[Te.id]||[];if(Me.length===0)return null;const $e=Me.reduce((_t,[wt])=>{const en=Se(wt);return en?{start:_t.start+en.start_balance,allocated:_t.allocated+en.allocated,spent:_t.spent+en.spent,end:_t.end+en.end_balance}:_t},{start:0,allocated:0,spent:0,end:0});return d.jsx(ME,{name:Te.name,categories:Me,groupEndBalance:$e.end,groupAllocated:$e.allocated,getCategoryBalance:Se,localAllocations:ie,previousMonthIncome:Y,isDraftMode:ue,onAllocationChange:B,isMobile:x},Te.id)}),ae.ungrouped?.length>0&&(()=>{const Te=ae.ungrouped,Me=Te.reduce(($e,[_t])=>{const wt=Se(_t);return wt?{start:$e.start+wt.start_balance,allocated:$e.allocated+wt.allocated,spent:$e.spent+wt.spent,end:$e.end+wt.end_balance}:$e},{start:0,allocated:0,spent:0,end:0});return d.jsx(ME,{name:"Uncategorized",categories:Te,groupEndBalance:Me.end,groupAllocated:Me.allocated,getCategoryBalance:Se,localAllocations:ie,previousMonthIncome:Y,isDraftMode:ue,onAllocationChange:B,isMobile:x,isUngrouped:!0},"ungrouped")})()]})}),d.jsxs(sl,{isOpen:$,onClose:()=>q(!1),title:"Delete Allocations",children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to delete all allocations for this month? This will remove all allocated amounts and reset the month to unfinalized."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Le,{variant:"secondary",onClick:()=>q(!1),children:"Cancel"}),d.jsx(Le,{variant:"danger",onClick:()=>{q(!1),z()},children:"Delete Allocations"})]})]})]})}const A4=["income","balances","spend"];function PE(t){const e=t.year?parseInt(t.year,10):null,n=t.month?parseInt(t.month,10):null,i=t.tab&&A4.includes(t.tab)?t.tab:null;return{year:e&&!isNaN(e)&&e>=2e3&&e<=2100?e:null,month:n&&!isNaN(n)&&n>=1&&n<=12?n:null,tab:i}}function LE(){const t=PC(),e=eu(),{currentUserId:n,selectedBudgetId:i,currentYear:a,currentMonthNumber:l,lastActiveTab:u,setCurrentYear:f,setCurrentMonthNumber:m,setLastActiveTab:g,goToPreviousMonth:_,goToNextMonth:v,hasPendingInvites:x,pendingInvites:w,needsFirstBudget:A}=Sn(),{budget:I,createBudget:N,acceptInvite:H}=Hn(i,n),{month:$,isLoading:q}=wl(i,a,l),[me,ie]=T.useState(null),he=T.useRef(!1),[L,R]=T.useState(()=>{const{tab:Y}=PE(t);return Y??u}),D=Y=>{R(Y),g(Y)};T.useEffect(()=>{if(he.current)return;const{year:Y,month:U}=PE(t);Y&&f(Y),U&&m(U),he.current=!0},[t,f,m]),T.useEffect(()=>{if(!he.current)return;const Y=`/budget/${a}/${l}/${L}`,U=`/budget/${t.year}/${t.month}/${t.tab}`;Y!==U&&e(Y,{replace:!0})},[a,l,L,e,t]);async function M(Y){try{await H(Y)}catch(U){ie(U instanceof Error?U.message:"Failed to accept invite")}}async function j(Y){try{await N(Y||"My Budget")}catch(U){ie(U instanceof Error?U.message:"Failed to create budget")}}if(!I&&x)return d.jsxs($o,{children:[d.jsx(fi,{title:"Budget",showBackArrow:!0,hideMenu:!0}),d.jsx(o4,{invites:w,onAccept:M,onCreateNew:j})]});if(!I&&A)return d.jsxs($o,{children:[d.jsx(fi,{title:"Budget",showBackArrow:!0,hideMenu:!0}),d.jsx(a4,{onCreateNew:j})]});function O(){ie(null),_()}function C(){ie(null),v()}return d.jsxs($o,{children:[d.jsx(fi,{title:I?.name||"Budget"}),d.jsxs(kP,{children:[me&&d.jsx(Sl,{message:me,onDismiss:()=>ie(null)}),d.jsx(u4,{isLoading:q,onPreviousMonth:O,onNextMonth:C}),d.jsx(l4,{activeTab:L,setActiveTab:D,allocationsFinalized:$?.are_allocations_finalized}),L==="income"&&d.jsx(g4,{}),L==="balances"&&d.jsx(T4,{}),L==="spend"&&d.jsx(v4,{})]})]})}function C4(){return d.jsxs($o,{children:[d.jsx(fi,{title:"Analytics"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[d.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),d.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),d.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),d.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),d.jsx(Dt,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:ce.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})]})}function Ph({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,accountGroups:a,showGroupSelector:l=!1,showIncomeSettings:u=!1,hasExistingIncomeDefault:f=!1,hasExistingOutgoDefault:m=!1,currentGroupId:g}){const[_,v]=T.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),x=_.account_group_id||g,w=x?a.find(q=>q.id===x):null,A=w?.is_active!==void 0,I=w?.on_budget!==void 0;function N(q){q.preventDefault(),_.nickname.trim()&&e(_)}function H(q){v({..._,is_income_account:q,is_income_default:q?_.is_income_default:!1})}function $(q){v({..._,is_outgo_account:q,is_outgo_default:q?_.is_outgo_default:!1})}return d.jsxs(Hs,{onSubmit:N,children:[d.jsx(Et,{label:"Account Nickname",htmlFor:"account-nickname",children:d.jsx(Gs,{id:"account-nickname",type:"text",value:_.nickname,onChange:q=>v({..._,nickname:q.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&d.jsx(Et,{label:"Account Type",htmlFor:"account-group",children:d.jsxs(Jc,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:q=>v({..._,account_group_id:q.target.value==="ungrouped"?null:q.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Ungrouped"}),a.map(q=>d.jsx("option",{value:q.id,children:q.name},q.id))]})}),u&&d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(js,{id:"is-active",checked:A?w.is_active:_.is_active!==!1,onChange:q=>v({..._,is_active:q.target.checked}),disabled:A,children:d.jsx("span",{style:{opacity:A?.5:1},children:"Active account"})}),A&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ce.warning},children:['Set by account type "',w.name,'"']})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(js,{id:"on-budget",checked:I?w.on_budget:_.on_budget!==!1,onChange:q=>v({..._,on_budget:q.target.checked}),disabled:I,children:d.jsx("span",{style:{opacity:I?.5:1},children:"On budget (affects budget totals)"})}),I&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:ce.warning},children:['Set by account type "',w.name,'"']})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),d.jsx(js,{id:"is-income-account",checked:_.is_income_account||!1,onChange:q=>H(q.target.checked),children:"Show in income deposit list"}),_.is_income_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(js,{id:"is-income-default",checked:_.is_income_default||!1,onChange:q=>v({..._,is_income_default:q.target.checked}),disabled:f&&!t?.is_income_default,children:"Default account for new income"}),f&&!t?.is_income_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),d.jsx(js,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:q=>$(q.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(js,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:q=>v({..._,is_outgo_default:q.target.checked}),disabled:m&&!t?.is_outgo_default,children:"Default account for new expenses"}),m&&!t?.is_outgo_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),d.jsxs(Ha,{children:[d.jsx(Le,{type:"submit",children:i}),d.jsx(Le,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function VE({label:t,value:e,onChange:n,trueLabel:i,falseLabel:a,undefinedLabel:l}){function u(){n(e===void 0?!0:e===!0?!1:void 0)}const f=e===!0?i:e===!1?a:l,m=e===!0?ce.success:e===!1?ce.warning:"inherit",g=e===!0?"":e===!1?"":"";return d.jsxs("button",{type:"button",onClick:u,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${m} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${m} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[d.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?m:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:g}),d.jsxs("span",{style:{flex:1},children:[d.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",d.jsx("span",{style:{fontWeight:500,color:m},children:f})]}),d.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function sT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=T.useState(t||{name:"",expected_balance:"positive"});function u(f){f.preventDefault(),a.name.trim()&&e(a)}return d.jsxs(Hs,{onSubmit:u,children:[d.jsx(Et,{label:"Account Type Name",htmlFor:"group-name",children:d.jsx(Gs,{id:"group-name",type:"text",value:a.name,onChange:f=>l({...a,name:f.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),d.jsx(Et,{label:"Expected Balance",htmlFor:"expected-balance",children:d.jsxs(Jc,{id:"expected-balance",value:a.expected_balance,onChange:f=>l({...a,expected_balance:f.target.value}),children:[d.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),d.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),d.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",d.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),d.jsx(VE,{label:"Active status",value:a.is_active,onChange:f=>l({...a,is_active:f}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),d.jsx(VE,{label:"Budget status",value:a.on_budget,onChange:f=>l({...a,on_budget:f}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),d.jsxs(Ha,{children:[d.jsx(Le,{type:"submit",children:i}),d.jsx(Le,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function Mo({icon:t,label:e,variant:n,title:i}){const l={success:{background:`color-mix(in srgb, ${ce.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.success} 40%, transparent)`,color:ce.success,opacity:1},warning:{background:`color-mix(in srgb, ${ce.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.warning} 35%, transparent)`,color:ce.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${ce.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.success} 25%, transparent)`,color:ce.success,opacity:.7},expense:{background:`color-mix(in srgb, ${ce.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${ce.warning} 25%, transparent)`,color:ce.warning,opacity:.7}}[n];return d.jsxs("span",{title:i||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[d.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function aT({account:t,accountGroups:e}){const n=[],i=t.account_group_id?e.find(u=>u.id===t.account_group_id):null,a=i?.is_active!==void 0?i.is_active:t.is_active!==!1,l=i?.on_budget!==void 0?i.on_budget:t.on_budget!==!1;if(!a){const u=i?.is_active!==void 0;n.push(d.jsx(Mo,{icon:"",label:u?"Inactive (type)":"Inactive",variant:"warning",title:u?`Set by "${i.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const u=i?.on_budget!==void 0;n.push(d.jsx(Mo,{icon:"",label:u?"Off Budget (type)":"Off Budget",variant:"warning",title:u?`Set by "${i.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(d.jsx(Mo,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(d.jsx(Mo,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(d.jsx(Mo,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(d.jsx(Mo,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:d.jsx(d.Fragment,{children:n})}function R4({group:t}){const e=[];return t.is_active===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.warning} 20%, transparent)`,color:ce.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.success} 20%, transparent)`,color:ce.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.warning} 20%, transparent)`,color:ce.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${ce.success} 20%, transparent)`,color:ce.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:d.jsx(d.Fragment,{children:e})}function oT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function D4(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function I4(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function j4({group:t,groupIndex:e,totalGroups:n,accounts:i,allGroups:a,allAccounts:l,editingAccountId:u,editingGroupId:f,createForGroupId:m,setEditingAccountId:g,setEditingGroupId:_,setCreateForGroupId:v,dragType:x,draggedId:w,dragOverId:A,dragOverGroupId:I,setDragOverId:N,setDragOverGroupId:H,onAccountDragStart:$,onAccountDragOver:q,onAccountDrop:me,onGroupDragStart:ie,onGroupDragOver:he,onGroupDrop:L,onDragLeave:R,onDragLeaveGroup:D,onDragEnd:M,onDropOnGroup:j,onCreateAccount:O,onUpdateAccount:C,onDeleteAccount:Y,onMoveAccount:U,onUpdateGroup:P,onDeleteGroup:B,onMoveGroup:Q}){const le=Xi(),J=[...i].sort((de,Ce)=>de.sort_order-Ce.sort_order),z=x==="group"&&w===t.id,F=x==="group"&&A===t.id,W=x==="account"&&I===t.id,ae=(w&&x==="account"?l[w]:null)&&Object.entries(l).find(([de])=>de===w)?.[1]&&Object.entries(l).find(([de])=>de===w)?.[1]?.account_group_id!==t.id,pe=x==="group"&&F&&w!==t.id,ue=e>0,be=e<n-1,Se=J.reduce((de,Ce)=>de+Ce.balance,0);return d.jsxs("div",{children:[x==="group"&&!z&&d.jsxs("div",{onDragOver:de=>{de.preventDefault(),N(t.id)},onDragLeave:R,onDrop:de=>L(de,t.id),style:{position:"relative",height:pe?"2.5rem":"0.5rem",marginBottom:pe?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:pe?1:0,transition:"opacity 0.15s",boxShadow:pe?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),pe&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{draggable:f!==t.id,onDragStart:de=>ie(de,t.id),onDragOver:de=>he(de,t.id),onDragLeave:D,onDragEnd:M,onDrop:de=>j(de,t.id),style:{background:z?"color-mix(in srgb, currentColor 3%, transparent)":W&&ae?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:z?.5:1,border:W&&ae?`2px dashed ${ce.primary}`:"2px solid transparent",cursor:f===t.id?"default":"grab",transition:"all 0.15s"},children:f===t.id?d.jsx(sT,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:de=>P(t.id,de),onCancel:()=>_(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsx(O4,{group:t,accountCount:J.length,groupTotal:Se,canMoveUp:ue,canMoveDown:be,isMobile:le,createForGroupId:m,onEdit:()=>_(t.id),onDelete:()=>B(t.id),onMoveUp:()=>Q(t.id,"up"),onMoveDown:()=>Q(t.id,"down"),onAddAccount:()=>v(t.id)}),le&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Le,{variant:"small",onClick:()=>v(t.id),disabled:m!==null,children:"+ Account"})}),d.jsxs("div",{style:il,children:[J.map((de,Ce)=>u===de.id?d.jsx(Ph,{initialData:{nickname:de.nickname,account_group_id:de.account_group_id,is_income_account:de.is_income_account,is_income_default:de.is_income_default,is_outgo_account:de.is_outgo_account,is_outgo_default:de.is_outgo_default,on_budget:de.on_budget,is_active:de.is_active},onSubmit:De=>C(de.id,De),onCancel:()=>g(null),submitLabel:"Save",accountGroups:a,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:de.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([De,Te])=>Te.is_income_default&&De!==de.id),hasExistingOutgoDefault:Object.entries(l).some(([De,Te])=>Te.is_outgo_default&&De!==de.id)},de.id):d.jsx(pf,{isDragging:x==="account"&&w===de.id,isDragOver:A===de.id,onDragStart:De=>{De.stopPropagation(),$(De,de.id)},onDragOver:De=>q(De,de.id,t.id),onDragLeave:R,onDragEnd:M,onDrop:De=>me(De,de.id,t.id),onEdit:()=>g(de.id),onDelete:()=>Y(de.id),onMoveUp:()=>U(de.id,"up"),onMoveDown:()=>U(de.id,"down"),canMoveUp:Ce>0,canMoveDown:Ce<J.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Ny,children:de.nickname}),d.jsx(aT,{account:de,accountGroups:a})]}),d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:sn(de.balance)},children:[je(de.balance),D4(de.balance,t.expected_balance)&&d.jsx("span",{title:I4(de.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},de.id)),J.length===0&&!m&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),x==="account"&&J.length>0&&d.jsx(oT,{groupId:t.id,isActive:A===`__end__${t.id}`,onDragOver:de=>{de.preventDefault(),de.stopPropagation(),N(`__end__${t.id}`),H(t.id)},onDragLeave:de=>{de.stopPropagation(),N(null)},onDrop:de=>{de.stopPropagation(),me(de,"__group_end__",t.id)}}),m===t.id&&d.jsx(Ph,{initialData:{nickname:"",account_group_id:t.id},onSubmit:de=>O(de,t.id),onCancel:()=>v(null),submitLabel:"Create",accountGroups:a,showIncomeSettings:!0,currentGroupId:t.id})]}),m!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Le,{variant:"small",onClick:()=>v(t.id),disabled:m!==null,children:"+ Add Account"})})]})})]})}function O4({group:t,accountCount:e,groupTotal:n,canMoveUp:i,canMoveDown:a,isMobile:l,createForGroupId:u,onEdit:f,onDelete:m,onMoveUp:g,onMoveDown:_,onAddAccount:v}){return d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{...El,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&d.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:sn(n),flexShrink:0},children:je(n)}),d.jsx(R4,{group:t})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&d.jsx(Le,{variant:"small",onClick:v,disabled:u!==null,children:"+ Account"}),d.jsx("button",{onClick:f,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),d.jsx("button",{onClick:m,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),d.jsxs("div",{style:My,children:[d.jsx("button",{onClick:g,disabled:!i,style:{...rl,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:_,disabled:!a,style:{...rl,opacity:a?.6:.2,cursor:a?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function k4({accounts:t,allGroups:e,allAccounts:n,hasGroups:i,editingAccountId:a,createForGroupId:l,setEditingAccountId:u,setCreateForGroupId:f,dragType:m,draggedId:g,dragOverId:_,dragOverGroupId:v,setDragOverId:x,setDragOverGroupId:w,onAccountDragStart:A,onAccountDragOver:I,onAccountDrop:N,onDragOverGroup:H,onDropOnGroup:$,onDragLeave:q,onDragLeaveGroup:me,onDragEnd:ie,onCreateAccount:he,onUpdateAccount:L,onDeleteAccount:R,onMoveAccount:D}){const M=[...t].sort((U,P)=>U.sort_order-P.sort_order),j=m==="account"&&v==="ungrouped",C=(g&&m==="account"?n[g]:null)&&Object.entries(n).find(([U])=>U===g)?.[1]&&Object.entries(n).find(([U])=>U===g)?.[1]?.account_group_id!==null;if(M.length===0&&!l&&i&&m!=="account")return null;const Y=M.reduce((U,P)=>U+P.balance,0);return d.jsxs("div",{onDragOver:U=>H(U,"ungrouped"),onDragLeave:me,onDrop:U=>$(U,"ungrouped"),style:{background:j&&C?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:j&&C?`2px dashed ${ce.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...El,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",M.length,")"]}),M.length>0&&d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:sn(Y)},children:je(Y)})]}),d.jsx(Le,{variant:"small",onClick:()=>f("ungrouped"),disabled:l!==null,children:"+ Account"})]}),d.jsxs("div",{style:il,children:[M.map((U,P)=>a===U.id?d.jsx(Ph,{initialData:{nickname:U.nickname,account_group_id:U.account_group_id,is_income_account:U.is_income_account,is_income_default:U.is_income_default,is_outgo_account:U.is_outgo_account,is_outgo_default:U.is_outgo_default,on_budget:U.on_budget,is_active:U.is_active},onSubmit:B=>L(U.id,B),onCancel:()=>u(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([B,Q])=>Q.is_income_default&&B!==U.id),hasExistingOutgoDefault:Object.entries(n).some(([B,Q])=>Q.is_outgo_default&&B!==U.id)},U.id):d.jsx(pf,{isDragging:m==="account"&&g===U.id,isDragOver:_===U.id,onDragStart:B=>A(B,U.id),onDragOver:B=>I(B,U.id,"ungrouped"),onDragLeave:q,onDragEnd:ie,onDrop:B=>N(B,U.id,"ungrouped"),onEdit:()=>u(U.id),onDelete:()=>R(U.id),onMoveUp:()=>D(U.id,"up"),onMoveDown:()=>D(U.id,"down"),canMoveUp:P>0,canMoveDown:P<M.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Ny,children:U.nickname}),d.jsx(aT,{account:U,accountGroups:e})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:sn(U.balance)},children:je(U.balance)})]})},U.id)),M.length===0&&m==="account"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),m==="account"&&M.length>0&&d.jsx(oT,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:U=>{U.preventDefault(),U.stopPropagation(),x("__end__ungrouped"),w("ungrouped")},onDragLeave:U=>{U.stopPropagation(),x(null)},onDrop:U=>{U.stopPropagation(),N(U,"__group_end__","ungrouped")}}),l==="ungrouped"&&d.jsx(Ph,{initialData:{nickname:"",account_group_id:null},onSubmit:U=>he(U,"ungrouped"),onCancel:()=>f(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Le,{variant:"small",onClick:()=>f("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function M4(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:i,error:a,setError:l,handleCreateAccount:u,handleUpdateAccount:f,handleDeleteAccount:m,handleMoveAccount:g,handleCreateGroup:_,handleUpdateGroup:v,handleDeleteGroup:x,handleMoveGroup:w,reorderAccountsInGroup:A,reorderGroups:I}=YP(),N=Xi(),[H,$]=T.useState(null),[q,me]=T.useState(null),[ie,he]=T.useState(null),[L,R]=T.useState(!1),[D,M]=T.useState(null),[j,O]=T.useState(null),[C,Y]=T.useState(null),[U,P]=T.useState(null);function B(be,Se){M("account"),O(Se),be.dataTransfer.effectAllowed="move"}function Q(be,Se,de){be.preventDefault(),D==="account"&&(Se!==j&&Y(Se),P(de))}function le(be,Se){be.preventDefault(),D==="account"?(P(Se),Y(null)):D==="group"&&Se!==j&&Y(Se)}function J(){Y(null)}function z(){P(null)}function F(){M(null),O(null),Y(null),P(null)}async function W(be,Se,de){if(be.preventDefault(),be.stopPropagation(),!j||D!=="account"){F();return}await A(j,Se,de),F()}async function ne(be,Se){be.preventDefault(),D==="account"?await W(be,"__group_end__",Se):D==="group"&&await pe(be,Se)}function ae(be,Se){be.stopPropagation(),M("group"),O(Se),be.dataTransfer.effectAllowed="move"}async function pe(be,Se){if(be.preventDefault(),!j||D!=="group"||j===Se){F();return}await I(j,Se),F()}if(!i)return d.jsx("p",{children:"No budget found. Please log in."});const ue=e.ungrouped||[];return d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Accounts"}),d.jsxs("p",{style:Xc,children:["Organize your financial accounts by type.",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"0.9rem"},children:N?"Use  buttons to reorder items, or drag to move between types.":"Drag accounts between types, or use  buttons to reorder."})]}),a&&d.jsx(Sl,{message:a,onDismiss:()=>l(null)}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:d.jsx(Uy,{})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(t).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((be,Se)=>d.jsx(j4,{group:be,groupIndex:Se,totalGroups:n.length,accounts:e[be.id]||[],allGroups:n,allAccounts:t,editingAccountId:H,editingGroupId:ie,createForGroupId:q,setEditingAccountId:$,setEditingGroupId:he,setCreateForGroupId:me,dragType:D,draggedId:j,dragOverId:C,dragOverGroupId:U,setDragOverId:Y,setDragOverGroupId:P,onAccountDragStart:B,onAccountDragOver:Q,onAccountDrop:W,onGroupDragStart:ae,onGroupDragOver:le,onGroupDrop:pe,onDragLeave:J,onDragLeaveGroup:z,onDragEnd:F,onDropOnGroup:ne,onCreateAccount:u,onUpdateAccount:(de,Ce)=>{f(de,Ce),$(null)},onDeleteAccount:m,onMoveAccount:g,onUpdateGroup:(de,Ce)=>{v(de,Ce),he(null)},onDeleteGroup:x,onMoveGroup:w},be.id)),D==="group"&&n.length>0&&d.jsx(Ly,{isActive:C==="__end__",onDragOver:be=>{be.preventDefault(),Y("__end__")},onDragLeave:J,onDrop:be=>pe(be,"__end__"),label:"Move account type to end"}),d.jsx(k4,{accounts:ue,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:H,createForGroupId:q,setEditingAccountId:$,setCreateForGroupId:me,dragType:D,draggedId:j,dragOverId:C,dragOverGroupId:U,setDragOverId:Y,setDragOverGroupId:P,onAccountDragStart:B,onAccountDragOver:Q,onAccountDrop:W,onDragOverGroup:le,onDropOnGroup:ne,onDragLeave:J,onDragLeaveGroup:z,onDragEnd:F,onCreateAccount:u,onUpdateAccount:(be,Se)=>{f(be,Se),$(null)},onDeleteAccount:m,onMoveAccount:g})]}),L?d.jsx(sT,{onSubmit:be=>{_(be),R(!1)},onCancel:()=>R(!1),submitLabel:"Create Account Type"}):d.jsx(Le,{variant:"primary-large",onClick:()=>R(!0),children:"+ Add Account Type"})]})}function Lh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,categoryGroups:a=[],showGroupSelector:l=!1}){const[u,f]=T.useState(t||{name:"",category_group_id:null}),[m,g]=T.useState(t?.default_monthly_amount?.toString()||""),[_,v]=T.useState(t?.default_monthly_type||"fixed"),[x,w]=T.useState(!1);function A(I){if(I.preventDefault(),!u.name.trim())return;w(!0);const N=parseFloat(m),H=!isNaN(N)&&N>0;e({...u,description:u.description?.trim()||void 0,default_monthly_amount:H?N:void 0,default_monthly_type:H?_:void 0})}return d.jsxs(Hs,{onSubmit:A,children:[d.jsx(Et,{label:"Category Name",htmlFor:"category-name",children:d.jsx(Gs,{id:"category-name",type:"text",value:u.name,onChange:I=>f({...u,name:I.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),d.jsx(Et,{label:"Description (optional)",htmlFor:"category-description",children:d.jsx(Py,{id:"category-description",value:u.description||"",onChange:I=>f({...u,description:I.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&d.jsx(Et,{label:"Category Group",htmlFor:"category-group",children:d.jsxs(Jc,{id:"category-group",value:u.category_group_id||"ungrouped",onChange:I=>f({...u,category_group_id:I.target.value==="ungrouped"?null:I.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Uncategorized"}),a.map(I=>d.jsx("option",{value:I.id,children:I.name},I.id))]})}),d.jsxs(Et,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[d.jsxs(Jc,{id:"default-type",value:_,onChange:I=>v(I.target.value),style:{width:"auto",flex:"0 0 auto"},children:[d.jsx("option",{value:"fixed",children:"Fixed $"}),d.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?d.jsx(dh,{id:"default-amount",value:m,onChange:g,placeholder:"$0.00"}):d.jsx(Gs,{id:"default-amount",type:"number",value:m,onChange:I=>g(I.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&d.jsx("span",{style:{opacity:.6},children:"%"})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),d.jsxs(Ha,{children:[d.jsx(Le,{type:"submit",isLoading:x,children:i}),d.jsx(Le,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function lT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=T.useState(t||{name:""}),[u,f]=T.useState(!1);function m(g){g.preventDefault(),a.name.trim()&&(f(!0),e(a))}return d.jsxs(Hs,{onSubmit:m,children:[d.jsx(Et,{label:"Group Name",htmlFor:"group-name",children:d.jsx(Gs,{id:"group-name",type:"text",value:a.name,onChange:g=>l({...a,name:g.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),d.jsxs(Ha,{children:[d.jsx(Le,{type:"submit",isLoading:u,children:i}),d.jsx(Le,{type:"button",variant:"secondary",onClick:n,children:"Cancel"})]})]})}function cT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function N4({group:t,groupIndex:e,groupCategories:n,sortedGroups:i,categoryGroups:a,categoryBalances:l,loadingBalances:u,dragType:f,draggedId:m,dragOverId:g,dragOverGroupId:_,editingCategoryId:v,setEditingCategoryId:x,createForGroupId:w,setCreateForGroupId:A,editingGroupId:I,setEditingGroupId:N,handleCreateCategory:H,handleUpdateCategory:$,handleDeleteCategory:q,handleMoveCategory:me,handleUpdateGroup:ie,handleDeleteGroup:he,handleMoveGroup:L,handleCategoryDragStart:R,handleCategoryDragOver:D,handleDragOverGroup:M,handleDragLeave:j,handleDragLeaveGroup:O,handleDragEnd:C,handleCategoryDrop:Y,handleDropOnGroup:U,handleGroupDragStart:P,handleGroupDrop:B,setDragOverId:Q,setDragOverGroupId:le,isMobile:J,categories:z}){const F=f==="group"&&m===t.id,W=f==="group"&&g===t.id,ne=f==="category"&&_===t.id,ae=m&&f==="category"?z[m]:null,pe=ae&&(ae.category_group_id||"ungrouped")!==t.id,ue=f==="group"&&W&&m!==t.id,be=e>0,Se=e<i.length-1;return d.jsxs("div",{children:[f==="group"&&!F&&d.jsxs("div",{onDragOver:de=>{de.preventDefault(),Q(t.id)},onDragLeave:j,onDrop:de=>B(de,t.id),style:{position:"relative",height:ue?"2.5rem":"0.5rem",marginBottom:ue?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:ce.primary,borderRadius:"2px",opacity:ue?1:0,transition:"opacity 0.15s",boxShadow:ue?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),ue&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{onDragOver:de=>M(de,t.id),onDragLeave:O,onDrop:de=>U(de,t.id),style:{background:F?"color-mix(in srgb, currentColor 3%, transparent)":ne&&pe?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:F?.5:1,border:ne&&pe?`2px dashed ${ce.primary}`:"2px solid transparent",transition:"all 0.15s"},children:I===t.id?d.jsx(lT,{initialData:{name:t.name},onSubmit:de=>ie(t.id,de),onCancel:()=>N(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:J?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:J?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{...El,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!J&&d.jsx("span",{draggable:!0,onDragStart:de=>P(de,t.id),onDragEnd:C,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",n.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!J&&d.jsx(Le,{variant:"small",onClick:()=>A(t.id),disabled:w!==null,children:"+ Category"}),d.jsx("button",{onClick:()=>N(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),d.jsx("button",{onClick:()=>he(t.id),style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),d.jsxs("div",{style:My,children:[d.jsx("button",{onClick:()=>L(t.id,"up"),disabled:!be,style:{...rl,opacity:be?.6:.2,cursor:be?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),d.jsx("button",{onClick:()=>L(t.id,"down"),disabled:!Se,style:{...rl,opacity:Se?.6:.2,cursor:Se?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),J&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Le,{variant:"small",onClick:()=>A(t.id),disabled:w!==null,children:"+ Category"})}),d.jsxs("div",{style:il,children:[n.map(([de,Ce])=>v===de?d.jsx(Lh,{initialData:{name:Ce.name,description:Ce.description,category_group_id:Ce.category_group_id,default_monthly_amount:Ce.default_monthly_amount,default_monthly_type:Ce.default_monthly_type},onSubmit:De=>$(de,De),onCancel:()=>x(null),submitLabel:"Save",categoryGroups:a,showGroupSelector:!0},de):d.jsx(pf,{isDragging:f==="category"&&m===de,isDragOver:g===de,onDragStart:De=>{De.stopPropagation(),R(De,de)},onDragOver:De=>D(De,de,t.id),onDragLeave:j,onDragEnd:C,onDrop:De=>Y(De,de,t.id),onEdit:()=>x(de),onDelete:()=>q(de),onMoveUp:()=>me(de,"up"),onMoveDown:()=>me(de,"down"),canMoveUp:n.findIndex(([De])=>De===de)>0,canMoveDown:n.findIndex(([De])=>De===de)<n.length-1,children:d.jsx(uT,{category:Ce,catId:de,categoryBalances:l,loadingBalances:u})},de)),n.length===0&&!w&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),f==="category"&&n.length>0&&d.jsx(cT,{groupId:t.id,isActive:g===`__end__${t.id}`,onDragOver:de=>{de.preventDefault(),de.stopPropagation(),Q(`__end__${t.id}`),le(t.id)},onDragLeave:de=>{de.stopPropagation(),Q(null)},onDrop:de=>{de.stopPropagation(),Y(de,"__group_end__",t.id)}}),w===t.id&&d.jsx(Lh,{initialData:{name:"",category_group_id:t.id},onSubmit:de=>H(de,t.id),onCancel:()=>A(null),submitLabel:"Create",categoryGroups:a})]}),w!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Le,{variant:"small",onClick:()=>A(t.id),disabled:w!==null,children:"+ Add Category"})})]})})]})}function uT({category:t,catId:e,categoryBalances:n,loadingBalances:i}){const a=n[e]||{current:0,total:0};return d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[d.jsx("span",{style:Ny,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?d.jsxs(d.Fragment,{children:[d.jsxs("span",{style:{color:ce.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{style:{color:ce.success,fontWeight:500},children:je(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),d.jsxs("div",{style:{marginTop:"0.25rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:sn(a.current)},children:[i?"...":je(a.current),d.jsx("span",{style:{fontSize:"0.75rem",fontWeight:400,opacity:.6,marginLeft:"0.35rem"},children:"available now"})]}),d.jsxs("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.85rem",fontWeight:500,color:sn(a.total),opacity:.75},children:[i?"...":je(a.total),d.jsx("span",{style:{fontSize:"0.7rem",fontWeight:400,opacity:.7,marginLeft:"0.35rem"},children:"total allocated"})]})]})]})}function P4({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:i,dragType:a,draggedId:l,dragOverId:u,dragOverGroupId:f,editingCategoryId:m,setEditingCategoryId:g,createForGroupId:_,setCreateForGroupId:v,handleCreateCategory:x,handleUpdateCategory:w,handleDeleteCategory:A,handleMoveCategory:I,handleCategoryDragStart:N,handleCategoryDragOver:H,handleDragOverGroup:$,handleDragLeaveGroup:q,handleDragLeave:me,handleDragEnd:ie,handleCategoryDrop:he,handleDropOnGroup:L,setDragOverId:R,setDragOverGroupId:D,categories:M,hasGroups:j}){const O=a==="category"&&f==="ungrouped",C=l&&a==="category"?M[l]:null,Y=C&&C.category_group_id!==null;return t.length===0&&!_&&j&&a!=="category"?null:d.jsxs("div",{onDragOver:U=>$(U,"ungrouped"),onDragLeave:q,onDrop:U=>L(U,"ungrouped"),style:{background:O&&Y?`color-mix(in srgb, ${ce.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:O&&Y?`2px dashed ${ce.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...El,margin:0,opacity:.7},children:["Uncategorized",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),d.jsx(Le,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Category"})]}),d.jsxs("div",{style:il,children:[t.map(([U,P])=>m===U?d.jsx(Lh,{initialData:{name:P.name,description:P.description,category_group_id:P.category_group_id,default_monthly_amount:P.default_monthly_amount,default_monthly_type:P.default_monthly_type},onSubmit:B=>w(U,B),onCancel:()=>g(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},U):d.jsx(pf,{isDragging:a==="category"&&l===U,isDragOver:u===U,onDragStart:B=>N(B,U),onDragOver:B=>H(B,U,"ungrouped"),onDragLeave:me,onDragEnd:ie,onDrop:B=>he(B,U,"ungrouped"),onEdit:()=>g(U),onDelete:()=>A(U),onMoveUp:()=>I(U,"up"),onMoveDown:()=>I(U,"down"),canMoveUp:t.findIndex(([B])=>B===U)>0,canMoveDown:t.findIndex(([B])=>B===U)<t.length-1,children:d.jsx(uT,{category:P,catId:U,categoryBalances:n,loadingBalances:i})},U)),t.length===0&&a==="category"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),a==="category"&&t.length>0&&d.jsx(cT,{groupId:"ungrouped",isActive:u==="__end__ungrouped",onDragOver:U=>{U.preventDefault(),U.stopPropagation(),R("__end__ungrouped"),D("ungrouped")},onDragLeave:U=>{U.stopPropagation(),R(null)},onDrop:U=>{U.stopPropagation(),he(U,"__group_end__","ungrouped")}}),_==="ungrouped"&&d.jsx(Lh,{initialData:{name:"",category_group_id:null},onSubmit:U=>x(U,"ungrouped"),onCancel:()=>v(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Le,{variant:"small",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function L4(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:i,sortedGroups:a,categoryBalances:l,isLoading:u,loadingBalances:f,error:m,setError:g,getOnBudgetTotal:_,handleCreateCategory:v,handleUpdateCategory:x,handleDeleteCategory:w,handleMoveCategory:A,handleCreateGroup:I,handleUpdateGroup:N,handleDeleteGroup:H,handleMoveGroup:$,dragType:q,draggedId:me,dragOverId:ie,dragOverGroupId:he,setDragOverId:L,setDragOverGroupId:R,handleCategoryDragStart:D,handleCategoryDragOver:M,handleDragOverGroup:j,handleDragLeave:O,handleDragLeaveGroup:C,handleDragEnd:Y,handleCategoryDrop:U,handleDropOnGroup:P,handleGroupDragStart:B,handleGroupDrop:Q}=e4(),le=Xi(),[J,z]=T.useState(null),[F,W]=T.useState(null),[ne,ae]=T.useState(null),[pe,ue]=T.useState(!1);return t?u?d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),d.jsx("p",{style:Xc,children:"Organize your spending categories into groups."}),d.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",opacity:.7},children:d.jsx("p",{children:"Loading..."})})]}):d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),d.jsxs("p",{style:Xc,children:["Organize your spending categories into groups.",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"0.9rem"},children:le?"Use  buttons to reorder items, or drag to move between groups.":"Drag categories between groups, or use  buttons to reorder."})]}),m&&d.jsx(Sl,{message:m,onDismiss:()=>g(null)}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:d.jsx(Uy,{})}),(()=>{const be=Object.values(l).reduce((Te,Me)=>Te+Me.current,0),Se=Object.values(l).reduce((Te,Me)=>Te+Me.total,0),de=_()-be,Ce=_()-Se,De=Math.abs(Se-be)>.01;return d.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[d.jsxs(Rc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Categories"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:Object.keys(e).length})]}),d.jsxs(Rc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Groups"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:n.length})]}),d.jsxs(Rc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"On-Budget"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:sn(_())},children:je(_())})]}),d.jsxs(Rc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Allocated Now"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:ce.primary},children:f?"...":je(be)}),De&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:f?"":`${je(Se)} total`})]}),d.jsxs(Rc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Available Now"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:sn(de)},children:f?"...":je(de)}),De&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:f?"":`${je(Ce)} after future`})]})]})})(),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(e).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),a.map((be,Se)=>{const de=(i[be.id]||[]).sort((Ce,De)=>Ce[1].sort_order-De[1].sort_order);return d.jsx(N4,{group:be,groupIndex:Se,groupCategories:de,sortedGroups:a,categoryGroups:n,categoryBalances:l,loadingBalances:f,dragType:q,draggedId:me,dragOverId:ie,dragOverGroupId:he,editingCategoryId:J,setEditingCategoryId:z,createForGroupId:F,setCreateForGroupId:W,editingGroupId:ne,setEditingGroupId:ae,handleCreateCategory:v,handleUpdateCategory:x,handleDeleteCategory:w,handleMoveCategory:A,handleUpdateGroup:N,handleDeleteGroup:H,handleMoveGroup:$,handleCategoryDragStart:D,handleCategoryDragOver:M,handleDragOverGroup:j,handleDragLeave:O,handleDragLeaveGroup:C,handleDragEnd:Y,handleCategoryDrop:U,handleDropOnGroup:P,handleGroupDragStart:B,handleGroupDrop:Q,setDragOverId:L,setDragOverGroupId:R,isMobile:le,categories:e},be.id)}),q==="group"&&a.length>0&&d.jsx(Ly,{isActive:ie==="__end__",onDragOver:be=>{be.preventDefault(),L("__end__")},onDragLeave:O,onDrop:be=>Q(be,"__end__"),label:"Move group to end"}),d.jsx(P4,{ungroupedCategories:(i.ungrouped||[]).sort((be,Se)=>be[1].sort_order-Se[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:f,dragType:q,draggedId:me,dragOverId:ie,dragOverGroupId:he,editingCategoryId:J,setEditingCategoryId:z,createForGroupId:F,setCreateForGroupId:W,handleCreateCategory:v,handleUpdateCategory:x,handleDeleteCategory:w,handleMoveCategory:A,handleCategoryDragStart:D,handleCategoryDragOver:M,handleDragOverGroup:j,handleDragLeaveGroup:C,handleDragLeave:O,handleDragEnd:Y,handleCategoryDrop:U,handleDropOnGroup:P,setDragOverId:L,setDragOverGroupId:R,categories:e,hasGroups:n.length>0})]}),pe?d.jsx(lT,{onSubmit:be=>{I(be),ue(!1)},onCancel:()=>ue(!1),submitLabel:"Create Group"}):d.jsx(Le,{variant:"primary-large",onClick:()=>ue(!0),children:"+ Add Category Group"})]}):d.jsx("p",{children:"No budget found. Please log in."})}const V4=["accounts","categories","users"];function z4(){const{selectedBudgetId:t,currentUserId:e,lastSettingsTab:n,setLastSettingsTab:i}=Sn(),{isOwner:a,isLoading:l}=Hn(t,e),u=kn(),f=u.pathname==="/budget/settings",m=T.useMemo(()=>{const w=u.pathname;return w.includes("/settings/accounts")?"accounts":w.includes("/settings/categories")?"categories":w.includes("/settings/users")?"users":"categories"},[u.pathname]),g=m==="users";T.useEffect(()=>{f||i(m)},[m,f,i]);function _(){return!V4.includes(n)||n==="users"&&!a?"categories":n}const v=T.useMemo(()=>[{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!a}],[a]);return l?d.jsx("div",{style:qn,children:d.jsx("p",{children:"Loading..."})}):!a&&g?d.jsxs("div",{style:qn,children:[d.jsx(fi,{title:"Budget Settings"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only the budget owner can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(Dt,{to:"/budget/settings/categories",style:{color:"#646cff"},children:"Go to Categories "})})]}):d.jsxs("div",{style:qn,children:[d.jsx(fi,{title:"Budget Settings"}),d.jsx(Vy,{mode:"link",linkPrefix:"/budget/settings",tabs:v,activeTab:f?_():m}),f?d.jsx(zh,{to:`/budget/settings/${_()}`,replace:!0}):d.jsx(Uh,{})]})}function U4(){const{selectedBudgetId:t,currentUserId:e}=Sn(),{budget:n,budgetUserIds:i,acceptedUserIds:a,inviteUser:l,revokeUser:u}=Hn(t,e),[f,m]=T.useState(""),[g,_]=T.useState(!1),[v,x]=T.useState(null),[w,A]=T.useState(null);if(!n)return d.jsx("p",{children:"No budget found."});async function I(q){if(q.preventDefault(),!(!f.trim()||!n)){_(!0),x(null),A(null);try{await l(f.trim()),m(""),A("Invite sent! The user can now accept the invitation from their account.")}catch(me){x(me instanceof Error?me.message:"Failed to invite user")}finally{_(!1)}}}async function N(q){if(!n)return;if(q===n.owner_id){x("Cannot revoke the budget owner");return}if(q===e){x("Cannot revoke yourself from the budget");return}const me=a.includes(q);if(confirm(me?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){x(null),A(null);try{await u(q),A(me?"User access revoked.":"Invitation cancelled.")}catch(he){x(he instanceof Error?he.message:"Failed to revoke user")}}}const H=i.filter(q=>a.includes(q)),$=i.filter(q=>!a.includes(q));return d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>x(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),w&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:w}),d.jsx("button",{onClick:()=>A(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",H.length,")"]}),H.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:H.map(q=>{const me=q===n.owner_id,ie=q===e;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:q}),me&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),ie&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!me&&!ie&&d.jsx("button",{onClick:()=>N(q),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},q)})})]}),$.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",$.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:$.map(q=>d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:q}),d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),d.jsx("button",{onClick:()=>N(q),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},q))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),d.jsxs("form",{onSubmit:I,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:f,onChange:q=>m(q.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:g||!f.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||!f.trim()?"not-allowed":"pointer",fontWeight:500,opacity:g||!f.trim()?.7:1,whiteSpace:"nowrap"},children:g?"Inviting...":"Send Invite"})]}),d.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),d.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}const B4=["budget","feedback","migration","tests"];function F4(){const{isAdmin:t,isTest:e,lastAdminTab:n,setLastAdminTab:i}=Sn(),a=kn(),l=a.pathname==="/budget/admin",u=T.useMemo(()=>{const _=a.pathname;return _.includes("/admin/budget")?"budget":_.includes("/admin/feedback")?"feedback":_.includes("/admin/migration")?"migration":_.includes("/admin/tests")?"tests":"budget"},[a.pathname]),f=u==="tests";T.useEffect(()=>{l||i(u)},[u,l,i]);function m(){return!B4.includes(n)||n==="tests"&&!e?"budget":n}const g=T.useMemo(()=>[{id:"budget",label:"Budget",icon:""},{id:"feedback",label:"Feedback",icon:""},{id:"migration",label:"Migration",icon:""},{id:"tests",label:"Tests",icon:"",hidden:!e}],[e]);return t?!e&&f?d.jsxs("div",{style:qn,children:[d.jsx(fi,{title:"Budget Admin"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only test users can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(Dt,{to:"/budget/admin/budget",style:{color:"#646cff"},children:"Go to Admin "})})]}):d.jsxs("div",{style:qn,children:[d.jsx(fi,{title:"Budget Admin"}),d.jsx(Vy,{mode:"link",linkPrefix:"/budget/admin",tabs:g,activeTab:u}),l?d.jsx(zh,{to:`/budget/admin/${m()}`,replace:!0}):d.jsx(Uh,{})]}):d.jsxs("div",{style:qn,children:[d.jsx(fi,{title:"Budget Admin"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only administrators can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(Dt,{to:"/budget",style:{color:"#646cff"},children:"Go to Budget "})})]})}function q4(){const{selectedBudgetId:t,currentUserId:e,isAdmin:n}=Sn(),{budget:i,accounts:a,accountGroups:l,categories:u,categoryGroups:f,isOwner:m,isLoading:g}=Hn(t,e);return g?d.jsx("p",{children:"Loading budget info..."}):i?d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Summary"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Information about the currently selected budget."}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",fontSize:"0.95rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Name:"}),d.jsx("strong",{children:i.name})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"ID:"}),d.jsx("code",{style:{background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:i.id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Owner:"}),d.jsx("strong",{children:i.owner_email||i.owner_id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Users:"}),d.jsxs("span",{children:[i.user_ids.length," user",i.user_ids.length!==1?"s":"",d.jsxs("span",{style:{opacity:.7},children:["  ",m?"You are the owner":"Shared with you"]})]})]})]})}),n&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem"},children:"Admin Tools"}),d.jsx("button",{onClick:()=>{const _={...i,accounts:a,account_groups:l,categories:u,category_groups:f,_meta:{downloaded_at:new Date().toISOString()}},v=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),x=URL.createObjectURL(v),w=document.createElement("a");w.href=x,w.download=`budget_${i.id}.json`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(x)},style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",transition:"background 0.15s"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]})]}):d.jsx("p",{style:{opacity:.7},children:"No budget selected."})}function zE({budget:t,isCurrent:e,isAccepting:n,isSwitching:i,isEditing:a,editName:l,isRenaming:u,onAccept:f,onSwitch:m,onStartEdit:g,onCancelEdit:_,onEditNameChange:v,onSaveEdit:x}){const w=e&&t.isOwner;return d.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:a?d.jsxs("form",{onSubmit:x,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:d.jsx("input",{type:"text",value:l,onChange:A=>v(A.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[d.jsx("button",{type:"submit",disabled:u||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:u||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:u||!l.trim()?.7:1,fontSize:"0.8rem"},children:u?"Saving...":"Save"}),d.jsx("button",{type:"button",onClick:_,disabled:u,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:u?"not-allowed":"pointer",fontWeight:500,opacity:u?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[d.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),w&&d.jsx("button",{onClick:g,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),d.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?d.jsx("button",{onClick:f,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:d.jsx("button",{onClick:m,disabled:i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,fontSize:"0.85rem"},children:i?"Switching...":"Switch"})})]})})}const wg={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function dT({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,i=n&&n in wg?n:"bug",a=wg[i];return d.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:a.bgColor,color:a.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:a.label})}function H4({item:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:u,onDrop:f,onToggleDone:m,onTypeClick:g}){return d.jsxs("div",{onDragOver:_=>{_.stopPropagation(),a(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),f(_)},style:{position:"relative"},children:[d.jsx("div",{style:{...J1,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:u,style:{...gu,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{...X1},children:""}),d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:m,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ce.primary,flexShrink:0}}),d.jsx(dT,{type:t.feedback_type,onClick:g})]}),d.jsxs("div",{style:{marginLeft:"3.25rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",Sg(t.created_at)]})]})]})]})}function G4({item:t,onToggleDone:e,onTypeClick:n}){return d.jsxs("div",{style:{...gu,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:ce.primary,flexShrink:0}}),d.jsx(dT,{type:t.feedback_type,onClick:n})]}),d.jsxs("div",{style:{marginLeft:"2rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",Sg(t.created_at)]}),t.completed_at&&d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:ce.success},children:[" Completed: ",Sg(t.completed_at)]})]})]})}function By({noMargin:t}={}){return d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:t?0:"0.5rem",verticalAlign:"middle"}})}function Fy({title:t,description:e,status:n,statusText:i,onRefresh:a,isRefreshing:l,isBusy:u=!1,children:f}){const g=(()=>{switch(n){case"unknown":return{color:"#9ca3af",text:i??"Unknown"};case"clean":case"complete":return{color:"#22c55e",text:i??" Clean"};case"needs-action":return{color:"#f59e0b",text:i??"Action Needed"}}})(),_=l||u;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:t}),d.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.9rem"},children:e})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexShrink:0},children:[n!=="unknown"&&d.jsx("span",{style:{color:g.color,fontWeight:600,fontSize:"0.9rem"},children:g.text}),d.jsxs("button",{onClick:a,disabled:_,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem 0.65rem",borderRadius:"6px",cursor:_?"not-allowed":"pointer",fontWeight:500,fontSize:"0.85rem",opacity:_?.6:1,display:"flex",alignItems:"center",gap:"0.3rem"},title:"Refresh status",children:[l?d.jsx(By,{noMargin:!0}):""," Refresh"]})]})]}),f]})}const Q4={unknown:{bg:"rgba(100, 100, 100, 0.1)",border:"rgba(100, 100, 100, 0.3)",color:"#9ca3af"},clean:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"},warning:{bg:"rgba(245, 158, 11, 0.1)",border:"rgba(245, 158, 11, 0.3)",color:"#fbbf24"},running:{bg:"rgba(100, 108, 255, 0.1)",border:"rgba(100, 108, 255, 0.3)",color:"#a5b4fc"},success:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"}};function On({type:t,children:e}){const n=Q4[t];return d.jsx("div",{style:{background:n.bg,border:`1px solid ${n.border}`,color:n.color,padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:e})}function qy({onClick:t,disabled:e,isBusy:n,busyText:i,children:a}){const l=e||n;return d.jsx("button",{onClick:t,disabled:l,style:{marginTop:"1rem",background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:l?"not-allowed":"pointer",fontWeight:500,opacity:l?.7:1,display:"flex",alignItems:"center",gap:"0.4rem"},children:n?d.jsxs(d.Fragment,{children:[d.jsx(By,{noMargin:!0})," ",i??"Running..."]}):a})}function $4({hasData:t,status:e,hasIssues:n,totalIssues:i,isRunning:a,result:l,onRunCleanup:u,onRefresh:f,isRefreshing:m,disabled:g}){const _=()=>t?l&&l.errors.length===0&&(l.accountsFixed>0||l.categoriesFixed>0||l.groupsFixed>0||l.futureMonthsDeleted>0||l.monthsFixed>0)?"complete":n?"needs-action":"clean":"unknown",v=l?l.accountsFixed+l.categoriesFixed+l.groupsFixed+l.futureMonthsDeleted+l.monthsFixed:0;return d.jsx(Fy,{title:" Database Cleanup",description:"Validates and fixes all budget and month documents to match the expected schema. Converts legacy formats, adds missing default values, and removes invalid future months.",status:_(),onRefresh:f,isRefreshing:m,isBusy:a,children:a?d.jsx(On,{type:"running",children:"Running database cleanup..."}):l?d.jsx(On,{type:l.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[l.errors.length>0?"":""," Cleanup complete",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.9rem"},children:[l.budgetsProcessed>0&&d.jsxs("li",{children:[l.budgetsProcessed," budget",l.budgetsProcessed!==1?"s":""," updated"]}),l.arraysConverted>0&&d.jsxs("li",{children:[l.arraysConverted," array",l.arraysConverted!==1?"s":""," converted to maps"]}),l.accountsFixed>0&&d.jsxs("li",{children:[l.accountsFixed," account",l.accountsFixed!==1?"s":""," fixed"]}),l.categoriesFixed>0&&d.jsxs("li",{children:[l.categoriesFixed," categor",l.categoriesFixed!==1?"ies":"y"," fixed"]}),l.groupsFixed>0&&d.jsxs("li",{children:[l.groupsFixed," group",l.groupsFixed!==1?"s":""," fixed"]}),l.futureMonthsDeleted>0&&d.jsxs("li",{children:[l.futureMonthsDeleted," future month",l.futureMonthsDeleted!==1?"s":""," deleted"]}),l.monthsFixed>0&&d.jsxs("li",{children:[l.monthsFixed," month",l.monthsFixed!==1?"s":""," schema fixed"]}),v===0&&d.jsx("li",{children:"No changes needed"})]}),l.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0.75rem 0 0.25rem 0",fontWeight:500,color:"#ef4444"},children:"Errors:"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.85rem",color:"#ef4444"},children:[l.errors.slice(0,5).map((x,w)=>d.jsx("li",{children:x},w)),l.errors.length>5&&d.jsxs("li",{style:{opacity:.7},children:["...and ",l.errors.length-5," more errors"]})]})]})]})}):t?n?d.jsxs(d.Fragment,{children:[d.jsx(On,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",i," issue",i!==1?"s":""," to fix:"]}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[e.budgetsWithArrays>0&&d.jsxs("li",{children:[e.budgetsWithArrays," budget",e.budgetsWithArrays!==1?"s":""," using legacy array format"]}),e.accountsNeedingDefaults>0&&d.jsxs("li",{children:[e.accountsNeedingDefaults," account",e.accountsNeedingDefaults!==1?"s":""," missing default values"]}),e.categoriesNeedingDefaults>0&&d.jsxs("li",{children:[e.categoriesNeedingDefaults," categor",e.categoriesNeedingDefaults!==1?"ies":"y"," missing default values"]}),e.groupsNeedingDefaults>0&&d.jsxs("li",{children:[e.groupsNeedingDefaults," account group",e.groupsNeedingDefaults!==1?"s":""," missing default values"]}),e.futureMonthsToDelete.length>0&&d.jsxs("li",{children:[e.futureMonthsToDelete.length," future month",e.futureMonthsToDelete.length!==1?"s":""," to delete",d.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.85rem",opacity:.8},children:[e.futureMonthsToDelete.slice(0,3).map(x=>d.jsxs("li",{children:[mf[x.month-1]," ",x.year]},x.docId)),e.futureMonthsToDelete.length>3&&d.jsxs("li",{style:{opacity:.7},children:["...and ",e.futureMonthsToDelete.length-3," more"]})]})]}),e.monthsWithSchemaIssues>0&&d.jsxs("li",{children:[e.monthsWithSchemaIssues," month",e.monthsWithSchemaIssues!==1?"s":""," with schema issues"]})]}),d.jsxs("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["Scanned ",e.totalBudgets," budgets and ",e.totalMonths," months."]})]})}),d.jsxs(qy,{onClick:u,disabled:g,isBusy:a,busyText:"Running...",children:[" Fix ",i," Issue",i!==1?"s":""]})]}):d.jsx(On,{type:"clean",children:d.jsxs("div",{children:[" Database is clean",d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["All ",e.totalBudgets," budgets and ",e.totalMonths," months match expected schema."]})]})}):d.jsx(On,{type:"unknown",children:" Status unknown  click Refresh to scan the database"})})}function K4({hasData:t,status:e,isMigrating:n,onMigrate:i,onRefresh:a,isRefreshing:l,disabled:u,migrationResult:f}){const m=e&&(e.sanitizedDocuments.length>0||e.corruptedDocuments.length>0),g=f&&(f.deletedDocuments>0||f.fixedDocuments>0),_=()=>t?g?"complete":m?"needs-action":"clean":"unknown";return d.jsx(Fy,{title:" Consolidate Feedback Documents",description:"Fixes corrupted feedback data and merges documents with sanitized IDs into proper email format.",status:_(),onRefresh:a,isRefreshing:l,isBusy:n,children:n?d.jsx(On,{type:"running",children:"Migrating feedback documents..."}):t?g?d.jsx(On,{type:"success",children:d.jsxs("div",{children:[" Migration complete:",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[f.fixedDocuments>0&&d.jsxs("li",{children:["Fixed ",f.fixedDocuments," corrupted document(s)"]}),f.deletedDocuments>0&&d.jsxs("li",{children:["Merged & deleted ",f.deletedDocuments," sanitized document(s)"]}),f.mergedItems>0&&d.jsxs("li",{children:["Merged ",f.mergedItems," feedback item(s)"]})]}),f.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{marginTop:"0.5rem"},children:" Errors:"}),d.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:f.errors.map((v,x)=>d.jsx("li",{children:v},x))})]})]})}):m?d.jsxs(d.Fragment,{children:[d.jsx(On,{type:"warning",children:d.jsxs("div",{children:[e?.corruptedDocuments&&e.corruptedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.corruptedDocuments.length," corrupted document(s):"]}),d.jsx("ul",{style:{margin:"0 0 0.75rem 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.corruptedDocuments.map(v=>d.jsxs("li",{children:[v," ",d.jsx("span",{style:{opacity:.6},children:"(broken arrayUnion)"})]},v))})]}),e?.sanitizedDocuments&&e.sanitizedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.sanitizedDocuments.length," sanitized document(s) to merge:"]}),d.jsx("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.sanitizedDocuments.map(v=>d.jsx("li",{children:v},v))})]})]})}),d.jsx(qy,{onClick:i,disabled:u,isBusy:n,busyText:"Migrating...",children:"Run Migration"})]}):d.jsxs(On,{type:"clean",children:[" No issues found. All feedback documents are healthy.",d.jsxs("span",{style:{display:"block",fontSize:"0.85rem",opacity:.7,marginTop:"0.25rem"},children:["Found ",e?.documentsFound??0," document(s) total."]})]}):d.jsx(On,{type:"unknown",children:" Status unknown  click Refresh to scan for issues"})})}function W4({hasData:t,monthsCount:e,budgetCount:n,monthsToDelete:i,isDeleting:a,onDelete:l,onRefresh:u,isRefreshing:f,disabled:m,deleteResult:g}){const _=()=>t?g&&g.deleted>0&&g.errors.length===0?"complete":e===0?"clean":"needs-action":"unknown",v=i.reduce((x,w)=>{const A=w.budgetId;return x[A]||(x[A]=[]),x[A].push(w),x},{});return d.jsx(Fy,{title:" Delete ALL Months",description:"DESTRUCTIVE: Deletes ALL month documents from Firebase for ALL budgets. This will reset all income, expenses, and allocations. Use with extreme caution!",status:_(),onRefresh:u,isRefreshing:f,isBusy:a,children:a?d.jsx(On,{type:"running",children:"Deleting all months..."}):g?d.jsx(On,{type:g.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[g.errors.length>0?"":""," Deleted ",g.deleted," month",g.deleted!==1?"s":"",g.errors.length>0&&d.jsx("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem"},children:g.errors.map((x,w)=>d.jsx("li",{children:x},w))})]})}):t?e>0?d.jsxs(d.Fragment,{children:[d.jsx(On,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",d.jsx("strong",{children:e})," month",e!==1?"s":""," across ",d.jsx("strong",{children:n})," budget",n!==1?"s":"",":"]}),d.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto"},children:[Object.entries(v).slice(0,5).map(([x,w])=>d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[d.jsxs("div",{style:{fontWeight:500,fontSize:"0.85rem"},children:["Budget: ",x.slice(0,12),"..."]}),d.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.85rem"},children:[w.slice(0,3).map(A=>d.jsxs("li",{children:[mf[A.month-1]," ",A.year]},A.docId)),w.length>3&&d.jsxs("li",{style:{opacity:.7},children:["...and ",w.length-3," more"]})]})]},x)),Object.keys(v).length>5&&d.jsxs("div",{style:{opacity:.7,fontSize:"0.85rem",marginTop:"0.5rem"},children:["...and ",Object.keys(v).length-5," more budgets"]})]})]})}),d.jsxs(qy,{onClick:l,disabled:m,isBusy:a,busyText:"Deleting...",children:[" Delete ALL ",e," Month",e!==1?"s":""]}),d.jsx("p",{style:{fontSize:"0.8rem",color:"#ef4444",marginTop:"0.5rem",fontWeight:500},children:" This action cannot be undone!"})]}):d.jsx(On,{type:"clean",children:" No month documents found in Firebase."}):d.jsx(On,{type:"unknown",children:" Status unknown  click Refresh to scan for months"})})}function Y4(){try{localStorage.removeItem("BUDGET_APP_QUERY_CACHE"),console.log("[Cache] Cleared React Query cache from localStorage")}catch(t){console.warn("Failed to clear localStorage cache:",t)}window.location.reload()}function X4(){const e=Fa().get_current_firebase_user(),[n,i]=T.useState(!1),a=n4({currentUser:e}),l=i4({currentUser:e}),u=s4({currentUser:e,onComplete:()=>i(!0)}),f=a.isScanning||l.isScanning||u.isScanning,m=a.isRunning||l.isMigratingFeedback||u.isDeleting,g=async()=>{await Promise.all([a.scanStatus(),l.scanStatus(),u.scanStatus()])};return d.jsxs("div",{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[d.jsx("h2",{style:{margin:0},children:"Data Migrations"}),d.jsxs("button",{onClick:g,disabled:f||m,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:f||m?"not-allowed":"pointer",fontWeight:500,opacity:f||m?.7:1,display:"flex",alignItems:"center",gap:"0.4rem",minWidth:"130px",minHeight:"36px"},children:[d.jsx("span",{style:{width:"18px",height:"18px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:f?d.jsx(By,{noMargin:!0}):""}),"Refresh All"]})]}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:'Run migrations to validate and fix your database. Click "Refresh All" to scan Firestore directly.'}),d.jsx($4,{hasData:!!a.status,status:a.status,hasIssues:a.hasIssues,totalIssues:a.totalIssues,isRunning:a.isRunning,result:a.result,onRunCleanup:a.runCleanup,onRefresh:a.scanStatus,isRefreshing:a.isScanning,disabled:!e}),d.jsx(K4,{hasData:!!l.status,status:l.status,isMigrating:l.isMigratingFeedback,onMigrate:l.migrateFeedbackDocuments,onRefresh:l.scanStatus,isRefreshing:l.isScanning,disabled:!e,migrationResult:l.feedbackMigrationResult}),d.jsx(W4,{hasData:!!u.status,monthsCount:u.status?.monthsCount??0,budgetCount:u.status?.budgetCount??0,monthsToDelete:u.status?.monthsToDelete??[],isDeleting:u.isDeleting,onDelete:u.deleteAllMonths,onRefresh:u.scanStatus,isRefreshing:u.isScanning,disabled:!e,deleteResult:u.deleteResult}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:d.jsxs("p",{style:{margin:0,opacity:.7},children:[d.jsx("strong",{children:"Note:"})," These migrations will process ",d.jsx("strong",{children:"all budgets and months"})," in the system, not just the ones you own or are invited to."]})}),d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, #ff6b6b 10%, transparent)",borderRadius:"8px",border:"1px solid color-mix(in srgb, #ff6b6b 30%, transparent)"},children:[d.jsxs("p",{style:{margin:"0 0 0.75rem 0",fontSize:"0.9rem"},children:[d.jsx("strong",{children:" Clear All Caches"}),d.jsx("span",{style:{opacity:.7,display:"block",marginTop:"0.25rem"},children:"If you're seeing stale data after running migrations, clear all cached data and reload to fetch fresh data from Firestore."})]}),d.jsx("button",{onClick:()=>i(!0),style:{background:"#dc2626",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,display:"flex",alignItems:"center",gap:"0.4rem"},children:" Clear All Caches & Reload"})]}),d.jsxs(sl,{isOpen:n,onClose:()=>i(!1),title:"Clear Caches & Reload?",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.8},children:"This will clear all cached data from localStorage and reload the page. The app will fetch fresh data from Firestore for everything."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:()=>i(!1),style:{background:"transparent",color:"inherit",border:"1px solid rgba(255, 255, 255, 0.2)",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:500},children:"Cancel"}),d.jsx("button",{onClick:Y4,style:{background:"#dc2626",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:"pointer",fontWeight:500},children:"Clear & Reload"})]})]})]})}function J4(){const[t,e]=T.useState(null),[n,i]=T.useState(null),[a,l]=T.useState(null),[u,f]=T.useState(!1),[m,g]=T.useState(""),[_,v]=T.useState("bug"),[x,w]=T.useState(null),[A,I]=T.useState(null),N=T.useContext(nu),$=Fa().get_current_firebase_user(),q=kk(),{submitFeedback:me}=Z1(),{toggleFeedback:ie}=TP(),{updateSortOrder:he}=AP(),L=q.data?.items||[];function R(J){J.preventDefault(),!(!m.trim()||!N.username||!$)&&(me.mutate({userId:$.uid,userEmail:N.username,text:m.trim(),feedbackType:_,currentPath:"/settings/feedback"}),g(""),v("bug"),f(!1))}function D(J){J.is_done?M(J):w(J)}async function M(J){try{await ie.mutateAsync({item:J})}catch(z){e(z instanceof Error?z.message:"Failed to update feedback")}}function j(){x&&(M(x),w(null))}async function O(J){if(A){try{const F=L.filter(W=>W.doc_id===A.doc_id).map(W=>W.id===A.id?{id:W.id,text:W.text,created_at:W.created_at,is_done:W.is_done,completed_at:W.completed_at,sort_order:W.sort_order,feedback_type:J}:{id:W.id,text:W.text,created_at:W.created_at,is_done:W.is_done,completed_at:W.completed_at,sort_order:W.sort_order,feedback_type:W.feedback_type});await he.mutateAsync({docId:A.doc_id,items:F})}catch(z){e(z instanceof Error?z.message:"Failed to update feedback type")}I(null)}}const C=L.filter(J=>!J.is_done).sort((J,z)=>J.sort_order-z.sort_order),Y=L.filter(J=>J.is_done).sort((J,z)=>{const F=J.completed_at?new Date(J.completed_at).getTime():0;return(z.completed_at?new Date(z.completed_at).getTime():0)-F});function U(J,z){i(z),J.dataTransfer.effectAllowed="move"}function P(J,z){J.preventDefault(),z!==n&&l(z)}function B(){l(null)}function Q(){i(null),l(null)}async function le(J,z){if(J.preventDefault(),!n||n===z){Q();return}const F=C.findIndex(ue=>ue.id===n),W=[...C],[ne]=W.splice(F,1);if(z==="__end__")W.push(ne);else{const ue=W.findIndex(be=>be.id===z);W.splice(ue,0,ne)}const ae=W.map((ue,be)=>({...ue,sort_order:be}));Q();const pe=new Map;for(const ue of ae)pe.has(ue.doc_id)||pe.set(ue.doc_id,[]),pe.get(ue.doc_id).push({id:ue.id,text:ue.text,created_at:ue.created_at,is_done:ue.is_done,completed_at:ue.completed_at,sort_order:ue.sort_order,feedback_type:ue.feedback_type});for(const ue of Y)pe.has(ue.doc_id)||pe.set(ue.doc_id,[]),pe.get(ue.doc_id).push({id:ue.id,text:ue.text,created_at:ue.created_at,is_done:ue.is_done,completed_at:ue.completed_at,sort_order:ue.sort_order,feedback_type:ue.feedback_type});try{for(const[ue,be]of pe)await he.mutateAsync({docId:ue,items:be})}catch(ue){e(ue instanceof Error?ue.message:"Failed to save order")}}return q.isLoading?d.jsx("p",{children:"Loading feedback..."}):d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Feedback"}),d.jsx("p",{style:{...Xc,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&d.jsx(Sl,{message:t,onDismiss:()=>e(null)}),d.jsxs("div",{style:il,children:[C.length===0&&!u&&d.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),C.map(J=>d.jsx(H4,{item:J,isDragging:n===J.id,isDragOver:a===J.id,onDragStart:z=>U(z,J.id),onDragOver:z=>P(z,J.id),onDragLeave:B,onDragEnd:Q,onDrop:z=>le(z,J.id),onToggleDone:()=>D(J),onTypeClick:()=>I(J)},J.id)),n&&C.length>0&&d.jsx(Ly,{isActive:a==="__end__",onDragOver:J=>P(J,"__end__"),onDragLeave:B,onDrop:J=>le(J,"__end__")})]}),u?d.jsxs(Hs,{onSubmit:R,children:[d.jsx(UE,{selectedType:_,onSelect:v}),d.jsx(Py,{value:m,onChange:J=>g(J.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),d.jsxs(Ha,{children:[d.jsx(Le,{type:"submit",disabled:!m.trim(),children:"Add Feedback"}),d.jsx(Le,{type:"button",variant:"secondary",onClick:()=>{f(!1),g(""),v("bug")},children:"Cancel"})]})]}):d.jsx(Le,{variant:"primary-large",onClick:()=>f(!0),children:"+ Add Feedback"}),Y.length>0&&d.jsx(IP,{title:"Completed",count:Y.length,children:d.jsx("div",{style:{...il,marginTop:"0.5rem"},children:Y.map(J=>d.jsx(G4,{item:J,onToggleDone:()=>D(J),onTypeClick:()=>I(J)},J.id))})}),d.jsxs(sl,{isOpen:x!==null,onClose:()=>w(null),title:"Mark as Complete",children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),x&&d.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',x.text,'"']}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Le,{variant:"secondary",onClick:()=>w(null),children:"Cancel"}),d.jsx(Le,{variant:"primary",onClick:j,children:"Mark Complete"})]})]}),d.jsxs(sl,{isOpen:A!==null,onClose:()=>I(null),title:"Change Feedback Type",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),d.jsx(UE,{selectedType:A?.feedback_type||"bug",onSelect:O}),d.jsx(Le,{variant:"secondary",onClick:()=>I(null),style:{width:"100%"},children:"Cancel"})]})]})}function UE({selectedType:t,onSelect:e}){return d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const i=wg[n],a=t==="feature"?"new_feature":t,l=a===n||!a&&n==="bug";return d.jsxs("button",{type:"button",onClick:()=>e(n),style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${i.color}`,borderRadius:"0.5rem",background:l?i.bgColor:"transparent",color:l?i.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${i.bgColor}`:"none",position:"relative"},children:[i.label,l&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function Z4(){const{currentUserId:t}=Sn(),[e,n]=T.useState([]),[i,a]=T.useState(!1);function l(x,w){n(A=>A.map(I=>I.name===x?{...I,...w}:I))}async function u(){a(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await f("Read unauthorized budget",async()=>(await Qe("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0),await f("Read another user's document",async()=>(await Qe("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0),await f("Read unauthorized budget month",async()=>(await Qe("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0),await f("Toggle is_admin in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Qe("users",t,"security test: reading own user to get current is_admin value"),A=w?.permission_flags?.is_admin??!1;return await Uo("users",t,{"permission_flags.is_admin":!A},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${A} to ${!A} (SECURITY ISSUE!)`},!0),await f("Toggle is_test in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await Qe("users",t,"security test: reading own user to get current is_test value"),A=w?.permission_flags?.is_test??!1;return await Uo("users",t,{"permission_flags.is_test":!A},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${A} to ${!A} (SECURITY ISSUE!)`},!0),await f("Read own user document",async()=>{if(!t)throw new Error("Not authenticated");const{exists:w}=await Qe("users",t,"security test: reading own user document (should succeed)");if(w)return"Successfully read own document";throw new Error("Document does not exist")},!1),a(!1)}async function f(x,w,A){l(x,{status:"running",message:"Running..."});try{const I=await w();A?l(x,{status:"failed",message:` ${I}`}):l(x,{status:"passed",message:` ${I}`})}catch(I){const N=I instanceof Error?I.message:"Unknown error";A?l(x,{status:"passed",message:` Blocked as expected: ${N}`}):l(x,{status:"failed",message:` ${N}`})}}async function m(x){switch(e.find(A=>A.name===x)||n(A=>[...A,{name:x,status:"pending",message:"",expectedToFail:!0}]),a(!0),x){case"Read unauthorized budget":await f(x,async()=>(await Qe("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0);break;case"Read another user's document":await f(x,async()=>(await Qe("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0);break;case"Read unauthorized budget month":await f(x,async()=>(await Qe("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0);break;case"Toggle is_admin in own permission_flags":await f(x,async()=>{if(!t)throw new Error("Not authenticated");const{data:A}=await Qe("users",t,"security test: reading own user to get current is_admin value"),I=A?.permission_flags?.is_admin??!1;return await Uo("users",t,{"permission_flags.is_admin":!I},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${I} to ${!I} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await f(x,async()=>{if(!t)throw new Error("Not authenticated");const{data:A}=await Qe("users",t,"security test: reading own user to get current is_test value"),I=A?.permission_flags?.is_test??!1;return await Uo("users",t,{"permission_flags.is_test":!I},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${I} to ${!I} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await f(x,async()=>{if(!t)throw new Error("Not authenticated");const{exists:A}=await Qe("users",t,"security test: reading own user document (should succeed)");if(A)return"Successfully read own document";throw new Error("Document does not exist")},!1);break}a(!1)}const g=e.filter(x=>x.status==="passed").length,_=e.filter(x=>x.status==="failed").length,v=e.length;return d.jsxs("div",{children:[d.jsx("p",{style:Xc,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsx(Le,{onClick:u,disabled:i,variant:"primary",children:i?"Running Tests...":"Run All Tests"})}),e.length>0&&d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[d.jsxs("span",{children:["Total: ",d.jsx("strong",{children:v})]}),d.jsxs("span",{style:{color:ce.success},children:["Passed: ",d.jsx("strong",{children:g})]}),d.jsxs("span",{style:{color:ce.danger},children:["Failed: ",d.jsx("strong",{children:_})]})]})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),d.jsx(No,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(x=>x.name==="Read unauthorized budget"),onRun:()=>m("Read unauthorized budget"),disabled:i}),d.jsx(No,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(x=>x.name==="Read another user's document"),onRun:()=>m("Read another user's document"),disabled:i}),d.jsx(No,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(x=>x.name==="Read unauthorized budget month"),onRun:()=>m("Read unauthorized budget month"),disabled:i}),d.jsx(No,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(x=>x.name==="Toggle is_admin in own permission_flags"),onRun:()=>m("Toggle is_admin in own permission_flags"),disabled:i}),d.jsx(No,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(x=>x.name==="Toggle is_test in own permission_flags"),onRun:()=>m("Toggle is_test in own permission_flags"),disabled:i}),d.jsx(No,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(x=>x.name==="Read own user document"),onRun:()=>m("Read own user document"),disabled:i,expectedToSucceed:!0})]}),_>0&&d.jsxs(Sl,{style:{marginTop:"1.5rem"},children:[" ",_," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function No({name:t,description:e,expectedBehavior:n,result:i,onRun:a,disabled:l,expectedToSucceed:u}){const f=i?.status==="passed"?ce.success:i?.status==="failed"?ce.danger:i?.status==="running"?ce.warning:"inherit";return d.jsxs("div",{style:{...gu,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),d.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),d.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:u?ce.success:ce.warning},children:["Expected: ",n]})]}),d.jsx(Le,{onClick:a,disabled:l,variant:"secondary",style:{flexShrink:0},children:i?.status==="running"?"":"Run"})]}),i&&i.status!=="pending"&&d.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${f} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${f} 30%, transparent)`,fontSize:"0.85rem",color:f},children:i.message})]})}function e6(){const{selectedBudgetId:t,currentUserId:e,accessibleBudgets:n,loadAccessibleBudgets:i,switchToBudget:a,checkBudgetInvite:l,isInitialized:u}=Sn();T.useEffect(()=>{u&&i()},[u,i]);const{budget:f,renameBudget:m,acceptInvite:g,isLoading:_}=Hn(t,e),[v,x]=T.useState(null),[w,A]=T.useState(null),[I,N]=T.useState(null),[H,$]=T.useState(null),[q,me]=T.useState(null),[ie,he]=T.useState(""),[L,R]=T.useState(!1),[D,M]=T.useState(""),[j,O]=T.useState(!1),[C,Y]=T.useState(null);async function U(ne){if(ne!==f?.id){x(ne),N(null),$(null);try{await a(ne),$("Switched to budget successfully!"),await i()}catch(ae){N(ae instanceof Error?ae.message:"Failed to switch budget")}finally{x(null)}}}async function P(ne){A(ne),N(null),$(null);try{await g(ne),$("Invitation accepted! You now have access to this budget."),await i()}catch(ae){N(ae instanceof Error?ae.message:"Failed to accept invitation")}finally{A(null)}}async function B(ne){if(ne.preventDefault(),!!D.trim()){O(!0),N(null),Y(null);try{const ae=await l(D.trim());ae?Y(ae):N("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(ae){N(ae instanceof Error?ae.message:"Failed to check invitation")}finally{O(!1)}}}async function Q(){if(C){A(C.budgetId),N(null);try{await g(C.budgetId),$(`Successfully joined "${C.budgetName}"!`),Y(null),M(""),await i()}catch(ne){N(ne instanceof Error?ne.message:"Failed to accept invitation")}finally{A(null)}}}function le(ne,ae){he(ae),me(ne)}function J(){me(null),he("")}async function z(ne){if(ne.preventDefault(),!(!ie.trim()||!q)){R(!0),N(null),$(null);try{await m(ie.trim()),$("Budget renamed successfully!"),me(null),await i()}catch(ae){N(ae instanceof Error?ae.message:"Failed to rename budget")}finally{R(!1)}}}const F=n.filter(ne=>!ne.isPending),W=n.filter(ne=>ne.isPending);return _||!u?d.jsx($o,{children:d.jsx("p",{children:"Loading your budgets..."})}):d.jsxs($o,{children:[d.jsx(fi,{title:"My Budgets"}),d.jsx("h1",{children:"My Budgets"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Switch between budgets, accept invitations, or join a budget by ID."}),I&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:I}),d.jsx("button",{onClick:()=>N(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),H&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:H}),d.jsx("button",{onClick:()=>$(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),W.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Pending Invitations (",W.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:W.map(ne=>d.jsx(zE,{budget:ne,isCurrent:!1,isAccepting:w===ne.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>P(ne.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},ne.id))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Your Budgets (",F.length,")"]}),F.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:F.map(ne=>{const ae=ne.id===f?.id,pe=q===ne.id;return d.jsx(zE,{budget:ne,isCurrent:ae,isAccepting:!1,isSwitching:v===ne.id,isEditing:pe,editName:pe?ie:"",isRenaming:L,onAccept:()=>{},onSwitch:()=>U(ne.id),onStartEdit:()=>le(ne.id,ne.name),onCancelEdit:J,onEditNameChange:he,onSaveEdit:z},ne.id)})})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Join Budget by ID"]}),d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),C?d.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[d.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:C.budgetName}),C.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",C.ownerEmail]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{onClick:Q,disabled:w===C.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:w===C.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:w===C.budgetId?.7:1},children:w===C.budgetId?"Accepting...":"Accept Invitation"}),d.jsx("button",{onClick:()=>{Y(null),M("")},disabled:w===C.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:w===C.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:w===C.budgetId?.7:.8},children:"Cancel"})]})]}):d.jsxs("form",{onSubmit:B,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:D,onChange:ne=>M(ne.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:j||!D.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:j||!D.trim()?"not-allowed":"pointer",fontWeight:500,opacity:j||!D.trim()?.7:1,whiteSpace:"nowrap"},children:j?"Checking...":"Check Invite"})]})]}),e&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[d.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),d.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:e})]})]})}function t6({children:t}){const e=T.useContext(nu),n=kn();return e.is_auth_checked?e.is_logged_in?t?d.jsx(d.Fragment,{children:t}):d.jsx(Uh,{}):d.jsx(zh,{to:"/account",state:{from:n.pathname},replace:!0}):d.jsx("div",{style:qn,children:d.jsx("p",{children:"Loading..."})})}function n6(){const{selectedBudgetId:t,currentUserId:e,isInitialized:n}=Sn(),{isLoading:i,error:a}=Hn(t,e);return n?a?(console.error("[BudgetLayout] Error:",a),d.jsx("div",{style:qn,children:d.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",a.message]})})):d.jsx("div",{style:{paddingBottom:"5rem"},children:d.jsx(Uh,{})}):d.jsxs("div",{style:qn,children:[d.jsx("p",{children:"Loading budget..."}),i&&d.jsx("p",{style:{opacity:.6},children:"Fetching data from server..."})]})}const r6={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function i6(){const[t,e]=T.useState(r6),n=Fa(),i=T.useRef(!1);return T.useEffect(function(){i.current||(i.current=!0,n.set_user_listener(a=>{e({is_logged_in:a!=null,is_auth_checked:!0,username:a?.email??"",set_user_context:e})}))},[n]),t.is_auth_checked?d.jsx(nu.Provider,{value:t,children:d.jsx(kD,{children:d.jsx(JN,{children:d.jsxs(ER,{children:[d.jsxs(XC,{children:[d.jsx(Yt,{path:"/",element:d.jsx(vP,{})}),d.jsx(Yt,{path:"/account",element:d.jsx(PP,{})}),d.jsx(Yt,{path:"/sql-test",element:d.jsx(NP,{})}),d.jsx(Yt,{path:"/budget",element:d.jsx(t6,{}),children:d.jsxs(Yt,{element:d.jsx(n6,{}),children:[d.jsx(Yt,{index:!0,element:d.jsx(LE,{})}),d.jsx(Yt,{path:":year/:month/:tab",element:d.jsx(LE,{})}),d.jsx(Yt,{path:"analytics",element:d.jsx(C4,{})}),d.jsx(Yt,{path:"my-budgets",element:d.jsx(e6,{})}),d.jsxs(Yt,{path:"settings",element:d.jsx(z4,{}),children:[d.jsx(Yt,{index:!0,element:d.jsx(zh,{to:"categories",replace:!0})}),d.jsx(Yt,{path:"accounts",element:d.jsx(M4,{})}),d.jsx(Yt,{path:"categories",element:d.jsx(L4,{})}),d.jsx(Yt,{path:"users",element:d.jsx(U4,{})})]}),d.jsxs(Yt,{path:"admin",element:d.jsx(F4,{}),children:[d.jsx(Yt,{path:"budget",element:d.jsx(q4,{})}),d.jsx(Yt,{path:"feedback",element:d.jsx(J4,{})}),d.jsx(Yt,{path:"migration",element:d.jsx(X4,{})}),d.jsx(Yt,{path:"tests",element:d.jsx(Z4,{})})]})]})})]}),d.jsx(DP,{})]})})})}):d.jsx("div",{style:qn,children:d.jsx("p",{children:"Loading..."})})}XA.createRoot(document.getElementById("root")).render(d.jsx(T.StrictMode,{children:d.jsx(i6,{})}));
